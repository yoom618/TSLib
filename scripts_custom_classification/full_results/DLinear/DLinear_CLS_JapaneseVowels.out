Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_DLinear_UEA_ftM_sl29_ll0_pl0_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.369447231292725
Epoch: 1, Steps: 17 | Train Loss: 2.120 Vali Loss: 2.114 Vali Acc: 0.262 Test Loss: 2.114 Test Acc: 0.262
Validation loss decreased (inf --> -0.262141).  Saving model ...
Epoch: 2 cost time: 1.6269817352294922
Epoch: 2, Steps: 17 | Train Loss: 2.032 Vali Loss: 2.009 Vali Acc: 0.311 Test Loss: 2.009 Test Acc: 0.311
Validation loss decreased (-0.262141 --> -0.310791).  Saving model ...
Epoch: 3 cost time: 1.3505237102508545
Epoch: 3, Steps: 17 | Train Loss: 1.903 Vali Loss: 1.870 Vali Acc: 0.403 Test Loss: 1.870 Test Acc: 0.403
Validation loss decreased (-0.310791 --> -0.402684).  Saving model ...
Epoch: 4 cost time: 1.7728583812713623
Epoch: 4, Steps: 17 | Train Loss: 1.746 Vali Loss: 1.705 Vali Acc: 0.559 Test Loss: 1.705 Test Acc: 0.559
Validation loss decreased (-0.402684 --> -0.559442).  Saving model ...
Epoch: 5 cost time: 1.6113927364349365
Epoch: 5, Steps: 17 | Train Loss: 1.562 Vali Loss: 1.523 Vali Acc: 0.662 Test Loss: 1.523 Test Acc: 0.662
Validation loss decreased (-0.559442 --> -0.662147).  Saving model ...
Epoch: 6 cost time: 1.5026345252990723
Epoch: 6, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.322 Vali Acc: 0.749 Test Loss: 1.322 Test Acc: 0.749
Validation loss decreased (-0.662147 --> -0.748635).  Saving model ...
Epoch: 7 cost time: 1.7650578022003174
Epoch: 7, Steps: 17 | Train Loss: 1.170 Vali Loss: 1.128 Vali Acc: 0.781 Test Loss: 1.128 Test Acc: 0.781
Validation loss decreased (-0.748635 --> -0.781070).  Saving model ...
Epoch: 8 cost time: 1.4201881885528564
Epoch: 8, Steps: 17 | Train Loss: 0.986 Vali Loss: 0.956 Vali Acc: 0.835 Test Loss: 0.956 Test Acc: 0.835
Validation loss decreased (-0.781070 --> -0.835126).  Saving model ...
Epoch: 9 cost time: 1.6476187705993652
Epoch: 9, Steps: 17 | Train Loss: 0.827 Vali Loss: 0.804 Vali Acc: 0.865 Test Loss: 0.804 Test Acc: 0.865
Validation loss decreased (-0.835126 --> -0.864857).  Saving model ...
Epoch: 10 cost time: 1.5674314498901367
Epoch: 10, Steps: 17 | Train Loss: 0.694 Vali Loss: 0.677 Vali Acc: 0.889 Test Loss: 0.677 Test Acc: 0.889
Validation loss decreased (-0.864857 --> -0.889182).  Saving model ...
Epoch: 11 cost time: 1.6294195652008057
Epoch: 11, Steps: 17 | Train Loss: 0.584 Vali Loss: 0.578 Vali Acc: 0.911 Test Loss: 0.578 Test Acc: 0.911
Validation loss decreased (-0.889182 --> -0.910805).  Saving model ...
Epoch: 12 cost time: 1.6259477138519287
Epoch: 12, Steps: 17 | Train Loss: 0.498 Vali Loss: 0.498 Vali Acc: 0.916 Test Loss: 0.498 Test Acc: 0.916
Validation loss decreased (-0.910805 --> -0.916211).  Saving model ...
Epoch: 13 cost time: 1.447007179260254
Epoch: 13, Steps: 17 | Train Loss: 0.430 Vali Loss: 0.436 Vali Acc: 0.930 Test Loss: 0.436 Test Acc: 0.930
Validation loss decreased (-0.916211 --> -0.929725).  Saving model ...
Epoch: 14 cost time: 1.30283784866333
Epoch: 14, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.381 Vali Acc: 0.932 Test Loss: 0.381 Test Acc: 0.932
Validation loss decreased (-0.929725 --> -0.932429).  Saving model ...
Epoch: 15 cost time: 1.488816261291504
Epoch: 15, Steps: 17 | Train Loss: 0.328 Vali Loss: 0.342 Vali Acc: 0.935 Test Loss: 0.342 Test Acc: 0.935
Validation loss decreased (-0.932429 --> -0.935132).  Saving model ...
Epoch: 16 cost time: 1.4873628616333008
Epoch: 16, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.305 Vali Acc: 0.935 Test Loss: 0.305 Test Acc: 0.935
Validation loss decreased (-0.935132 --> -0.935132).  Saving model ...
Epoch: 17 cost time: 1.7784755229949951
Epoch: 17, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.277 Vali Acc: 0.943 Test Loss: 0.277 Test Acc: 0.943
Validation loss decreased (-0.935132 --> -0.943240).  Saving model ...
Epoch: 18 cost time: 1.2054023742675781
Epoch: 18, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.254 Vali Acc: 0.943 Test Loss: 0.254 Test Acc: 0.943
Validation loss decreased (-0.943240 --> -0.943241).  Saving model ...
Epoch: 19 cost time: 1.168015718460083
Epoch: 19, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.233 Vali Acc: 0.954 Test Loss: 0.233 Test Acc: 0.954
Validation loss decreased (-0.943241 --> -0.954052).  Saving model ...
Epoch: 20 cost time: 1.1369438171386719
Epoch: 20, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.217 Vali Acc: 0.954 Test Loss: 0.217 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 21 cost time: 1.418036937713623
Epoch: 21, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.203 Vali Acc: 0.951 Test Loss: 0.203 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4684700965881348
Epoch: 22, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.192 Vali Acc: 0.949 Test Loss: 0.192 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4379403591156006
Epoch: 23, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.181 Vali Acc: 0.957 Test Loss: 0.181 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 24 cost time: 1.2789087295532227
Epoch: 24, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.173 Vali Acc: 0.959 Test Loss: 0.173 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 25 cost time: 1.2956840991973877
Epoch: 25, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.167 Vali Acc: 0.959 Test Loss: 0.167 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 26 cost time: 1.2380144596099854
Epoch: 26, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.162 Vali Acc: 0.957 Test Loss: 0.162 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3264739513397217
Epoch: 27, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.157 Vali Acc: 0.962 Test Loss: 0.157 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 28 cost time: 1.5595369338989258
Epoch: 28, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.151 Vali Acc: 0.965 Test Loss: 0.151 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964863).  Saving model ...
Epoch: 29 cost time: 1.6654009819030762
Epoch: 29, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.150 Vali Acc: 0.959 Test Loss: 0.150 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.716961145401001
Epoch: 30, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.145 Vali Acc: 0.959 Test Loss: 0.145 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.466808557510376
Epoch: 31, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.3760995864868164
Epoch: 32, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.716073751449585
Epoch: 33, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.515977144241333
Epoch: 34, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.5376203060150146
Epoch: 35, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.810300588607788
Epoch: 36, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.133 Vali Acc: 0.957 Test Loss: 0.133 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.607408046722412
Epoch: 37, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.386495590209961
Epoch: 38, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.131 Vali Acc: 0.957 Test Loss: 0.131 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_DLinear_UEA_ftM_sl29_ll0_pl0_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 4881
model size : 0.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         14                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_DLinear_UEA_ftM_sl29_ll0_pl0_ma14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.239231586456299
Epoch: 1, Steps: 17 | Train Loss: 2.120 Vali Loss: 2.114 Vali Acc: 0.262 Test Loss: 2.114 Test Acc: 0.262
Validation loss decreased (inf --> -0.262141).  Saving model ...
Epoch: 2 cost time: 1.4867966175079346
Epoch: 2, Steps: 17 | Train Loss: 2.032 Vali Loss: 2.009 Vali Acc: 0.311 Test Loss: 2.009 Test Acc: 0.311
Validation loss decreased (-0.262141 --> -0.310791).  Saving model ...
Epoch: 3 cost time: 1.8742144107818604
Epoch: 3, Steps: 17 | Train Loss: 1.903 Vali Loss: 1.869 Vali Acc: 0.405 Test Loss: 1.869 Test Acc: 0.405
Validation loss decreased (-0.310791 --> -0.405387).  Saving model ...
Epoch: 4 cost time: 1.8765084743499756
Epoch: 4, Steps: 17 | Train Loss: 1.746 Vali Loss: 1.704 Vali Acc: 0.559 Test Loss: 1.704 Test Acc: 0.559
Validation loss decreased (-0.405387 --> -0.559442).  Saving model ...
Epoch: 5 cost time: 1.4769666194915771
Epoch: 5, Steps: 17 | Train Loss: 1.561 Vali Loss: 1.521 Vali Acc: 0.662 Test Loss: 1.521 Test Acc: 0.662
Validation loss decreased (-0.559442 --> -0.662147).  Saving model ...
Epoch: 6 cost time: 1.8091011047363281
Epoch: 6, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.320 Vali Acc: 0.749 Test Loss: 1.320 Test Acc: 0.749
Validation loss decreased (-0.662147 --> -0.748635).  Saving model ...
Epoch: 7 cost time: 1.772979974746704
Epoch: 7, Steps: 17 | Train Loss: 1.168 Vali Loss: 1.125 Vali Acc: 0.778 Test Loss: 1.125 Test Acc: 0.778
Validation loss decreased (-0.748635 --> -0.778367).  Saving model ...
Epoch: 8 cost time: 1.937321424484253
Epoch: 8, Steps: 17 | Train Loss: 0.982 Vali Loss: 0.953 Vali Acc: 0.835 Test Loss: 0.953 Test Acc: 0.835
Validation loss decreased (-0.778367 --> -0.835126).  Saving model ...
Epoch: 9 cost time: 1.474694013595581
Epoch: 9, Steps: 17 | Train Loss: 0.824 Vali Loss: 0.801 Vali Acc: 0.865 Test Loss: 0.801 Test Acc: 0.865
Validation loss decreased (-0.835126 --> -0.864857).  Saving model ...
Epoch: 10 cost time: 1.885944128036499
Epoch: 10, Steps: 17 | Train Loss: 0.691 Vali Loss: 0.674 Vali Acc: 0.889 Test Loss: 0.674 Test Acc: 0.889
Validation loss decreased (-0.864857 --> -0.889182).  Saving model ...
Epoch: 11 cost time: 2.228806495666504
Epoch: 11, Steps: 17 | Train Loss: 0.582 Vali Loss: 0.577 Vali Acc: 0.908 Test Loss: 0.577 Test Acc: 0.908
Validation loss decreased (-0.889182 --> -0.908102).  Saving model ...
Epoch: 12 cost time: 1.914097547531128
Epoch: 12, Steps: 17 | Train Loss: 0.496 Vali Loss: 0.497 Vali Acc: 0.914 Test Loss: 0.497 Test Acc: 0.914
Validation loss decreased (-0.908102 --> -0.913509).  Saving model ...
Epoch: 13 cost time: 1.343149185180664
Epoch: 13, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.435 Vali Acc: 0.927 Test Loss: 0.435 Test Acc: 0.927
Validation loss decreased (-0.913509 --> -0.927023).  Saving model ...
Epoch: 14 cost time: 2.071789264678955
Epoch: 14, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.381 Vali Acc: 0.932 Test Loss: 0.381 Test Acc: 0.932
Validation loss decreased (-0.927023 --> -0.932429).  Saving model ...
Epoch: 15 cost time: 1.9717252254486084
Epoch: 15, Steps: 17 | Train Loss: 0.328 Vali Loss: 0.343 Vali Acc: 0.930 Test Loss: 0.343 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.734445333480835
Epoch: 16, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.306 Vali Acc: 0.935 Test Loss: 0.306 Test Acc: 0.935
Validation loss decreased (-0.932429 --> -0.935132).  Saving model ...
Epoch: 17 cost time: 1.7428362369537354
Epoch: 17, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.278 Vali Acc: 0.941 Test Loss: 0.278 Test Acc: 0.941
Validation loss decreased (-0.935132 --> -0.940538).  Saving model ...
Epoch: 18 cost time: 1.8016233444213867
Epoch: 18, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.254 Vali Acc: 0.946 Test Loss: 0.254 Test Acc: 0.946
Validation loss decreased (-0.940538 --> -0.945943).  Saving model ...
Epoch: 19 cost time: 1.6948986053466797
Epoch: 19, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.234 Vali Acc: 0.954 Test Loss: 0.234 Test Acc: 0.954
Validation loss decreased (-0.945943 --> -0.954052).  Saving model ...
Epoch: 20 cost time: 1.5707252025604248
Epoch: 20, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.217 Vali Acc: 0.954 Test Loss: 0.217 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 21 cost time: 2.1864278316497803
Epoch: 21, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.203 Vali Acc: 0.949 Test Loss: 0.203 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5143439769744873
Epoch: 22, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.192 Vali Acc: 0.949 Test Loss: 0.192 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8172621726989746
Epoch: 23, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.181 Vali Acc: 0.951 Test Loss: 0.181 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.9285070896148682
Epoch: 24, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.174 Vali Acc: 0.957 Test Loss: 0.174 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 25 cost time: 1.804356336593628
Epoch: 25, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.167 Vali Acc: 0.957 Test Loss: 0.167 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 26 cost time: 1.5891129970550537
Epoch: 26, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.162 Vali Acc: 0.954 Test Loss: 0.162 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4564340114593506
Epoch: 27, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.665175199508667
Epoch: 28, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.151 Vali Acc: 0.959 Test Loss: 0.151 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 29 cost time: 1.4394054412841797
Epoch: 29, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.602522373199463
Epoch: 30, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.6586990356445312
Epoch: 31, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.143 Vali Acc: 0.954 Test Loss: 0.143 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.6612954139709473
Epoch: 32, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 33 cost time: 1.5312097072601318
Epoch: 33, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.137 Vali Acc: 0.959 Test Loss: 0.137 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.6757757663726807
Epoch: 34, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.137 Vali Acc: 0.954 Test Loss: 0.137 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.3126602172851562
Epoch: 35, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 36 cost time: 1.852433204650879
Epoch: 36, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.997523307800293
Epoch: 37, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.66774320602417
Epoch: 38, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.6207952499389648
Epoch: 39, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.130 Vali Acc: 0.957 Test Loss: 0.130 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.9071900844573975
Epoch: 40, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.8071589469909668
Epoch: 41, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.9335989952087402
Epoch: 42, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.7775652408599854
Epoch: 43, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.8417904376983643
Epoch: 44, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.6293714046478271
Epoch: 45, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_DLinear_UEA_ftM_sl29_ll0_pl0_ma14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 4881
model size : 0.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         12                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_DLinear_UEA_ftM_sl29_ll0_pl0_ma12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.715602159500122
Epoch: 1, Steps: 17 | Train Loss: 2.120 Vali Loss: 2.114 Vali Acc: 0.262 Test Loss: 2.114 Test Acc: 0.262
Validation loss decreased (inf --> -0.262141).  Saving model ...
Epoch: 2 cost time: 1.7107596397399902
Epoch: 2, Steps: 17 | Train Loss: 2.033 Vali Loss: 2.010 Vali Acc: 0.308 Test Loss: 2.010 Test Acc: 0.308
Validation loss decreased (-0.262141 --> -0.308088).  Saving model ...
Epoch: 3 cost time: 1.39909029006958
Epoch: 3, Steps: 17 | Train Loss: 1.904 Vali Loss: 1.871 Vali Acc: 0.405 Test Loss: 1.871 Test Acc: 0.405
Validation loss decreased (-0.308088 --> -0.405387).  Saving model ...
Epoch: 4 cost time: 1.4763400554656982
Epoch: 4, Steps: 17 | Train Loss: 1.747 Vali Loss: 1.707 Vali Acc: 0.559 Test Loss: 1.707 Test Acc: 0.559
Validation loss decreased (-0.405387 --> -0.559442).  Saving model ...
Epoch: 5 cost time: 1.5689587593078613
Epoch: 5, Steps: 17 | Train Loss: 1.564 Vali Loss: 1.525 Vali Acc: 0.662 Test Loss: 1.525 Test Acc: 0.662
Validation loss decreased (-0.559442 --> -0.662147).  Saving model ...
Epoch: 6 cost time: 1.5483460426330566
Epoch: 6, Steps: 17 | Train Loss: 1.369 Vali Loss: 1.325 Vali Acc: 0.743 Test Loss: 1.325 Test Acc: 0.743
Validation loss decreased (-0.662147 --> -0.743230).  Saving model ...
Epoch: 7 cost time: 1.5802733898162842
Epoch: 7, Steps: 17 | Train Loss: 1.173 Vali Loss: 1.131 Vali Acc: 0.778 Test Loss: 1.131 Test Acc: 0.778
Validation loss decreased (-0.743230 --> -0.778367).  Saving model ...
Epoch: 8 cost time: 1.496924877166748
Epoch: 8, Steps: 17 | Train Loss: 0.989 Vali Loss: 0.961 Vali Acc: 0.830 Test Loss: 0.961 Test Acc: 0.830
Validation loss decreased (-0.778367 --> -0.829720).  Saving model ...
Epoch: 9 cost time: 1.7327766418457031
Epoch: 9, Steps: 17 | Train Loss: 0.831 Vali Loss: 0.810 Vali Acc: 0.859 Test Loss: 0.810 Test Acc: 0.859
Validation loss decreased (-0.829720 --> -0.859451).  Saving model ...
Epoch: 10 cost time: 1.249018907546997
Epoch: 10, Steps: 17 | Train Loss: 0.699 Vali Loss: 0.683 Vali Acc: 0.881 Test Loss: 0.683 Test Acc: 0.881
Validation loss decreased (-0.859451 --> -0.881074).  Saving model ...
Epoch: 11 cost time: 1.0784485340118408
Epoch: 11, Steps: 17 | Train Loss: 0.590 Vali Loss: 0.585 Vali Acc: 0.903 Test Loss: 0.585 Test Acc: 0.903
Validation loss decreased (-0.881074 --> -0.902697).  Saving model ...
Epoch: 12 cost time: 1.4131615161895752
Epoch: 12, Steps: 17 | Train Loss: 0.504 Vali Loss: 0.506 Vali Acc: 0.911 Test Loss: 0.506 Test Acc: 0.911
Validation loss decreased (-0.902697 --> -0.910806).  Saving model ...
Epoch: 13 cost time: 1.4463486671447754
Epoch: 13, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.444 Vali Acc: 0.916 Test Loss: 0.444 Test Acc: 0.916
Validation loss decreased (-0.910806 --> -0.916212).  Saving model ...
Epoch: 14 cost time: 1.5564711093902588
Epoch: 14, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.390 Vali Acc: 0.932 Test Loss: 0.390 Test Acc: 0.932
Validation loss decreased (-0.916212 --> -0.932429).  Saving model ...
Epoch: 15 cost time: 1.4162964820861816
Epoch: 15, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.351 Vali Acc: 0.930 Test Loss: 0.351 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4462940692901611
Epoch: 16, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.314 Vali Acc: 0.935 Test Loss: 0.314 Test Acc: 0.935
Validation loss decreased (-0.932429 --> -0.935132).  Saving model ...
Epoch: 17 cost time: 1.451542854309082
Epoch: 17, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.286 Vali Acc: 0.941 Test Loss: 0.286 Test Acc: 0.941
Validation loss decreased (-0.935132 --> -0.940538).  Saving model ...
Epoch: 18 cost time: 1.5255742073059082
Epoch: 18, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.261 Vali Acc: 0.941 Test Loss: 0.261 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940538).  Saving model ...
Epoch: 19 cost time: 1.5809977054595947
Epoch: 19, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.240 Vali Acc: 0.951 Test Loss: 0.240 Test Acc: 0.951
Validation loss decreased (-0.940538 --> -0.951349).  Saving model ...
Epoch: 20 cost time: 1.5981388092041016
Epoch: 20, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.223 Vali Acc: 0.954 Test Loss: 0.223 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 21 cost time: 1.172743320465088
Epoch: 21, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.209 Vali Acc: 0.949 Test Loss: 0.209 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4332282543182373
Epoch: 22, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.197 Vali Acc: 0.949 Test Loss: 0.197 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6415071487426758
Epoch: 23, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.186 Vali Acc: 0.949 Test Loss: 0.186 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.6014673709869385
Epoch: 24, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.178 Vali Acc: 0.954 Test Loss: 0.178 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 25 cost time: 1.6423592567443848
Epoch: 25, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.171 Vali Acc: 0.951 Test Loss: 0.171 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7244863510131836
Epoch: 26, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.165 Vali Acc: 0.957 Test Loss: 0.165 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 27 cost time: 1.4435019493103027
Epoch: 27, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5916047096252441
Epoch: 28, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 29 cost time: 1.5379574298858643
Epoch: 29, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4460933208465576
Epoch: 30, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.148 Vali Acc: 0.954 Test Loss: 0.148 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.3213205337524414
Epoch: 31, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 32 cost time: 1.348555326461792
Epoch: 32, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.141 Vali Acc: 0.959 Test Loss: 0.141 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 33 cost time: 1.5367417335510254
Epoch: 33, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.139 Vali Acc: 0.959 Test Loss: 0.139 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 34 cost time: 1.6333222389221191
Epoch: 34, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.139 Vali Acc: 0.954 Test Loss: 0.139 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.6538670063018799
Epoch: 35, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 36 cost time: 1.4051787853240967
Epoch: 36, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 37 cost time: 1.8635990619659424
Epoch: 37, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 38 cost time: 1.2989192008972168
Epoch: 38, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 39 cost time: 2.105159282684326
Epoch: 39, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.2773315906524658
Epoch: 40, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.3494586944580078
Epoch: 41, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.130 Vali Acc: 0.959 Test Loss: 0.130 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.3356173038482666
Epoch: 42, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.130 Vali Acc: 0.957 Test Loss: 0.130 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.2796552181243896
Epoch: 43, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.130 Vali Acc: 0.957 Test Loss: 0.130 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.5089917182922363
Epoch: 44, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.051466464996338
Epoch: 45, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.275069236755371
Epoch: 46, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.127 Vali Acc: 0.957 Test Loss: 0.127 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.6161143779754639
Epoch: 47, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.127 Vali Acc: 0.957 Test Loss: 0.127 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 2.0504136085510254
Epoch: 48, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.127 Vali Acc: 0.957 Test Loss: 0.127 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_DLinear_UEA_ftM_sl29_ll0_pl0_ma12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 4881
model size : 0.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_DLinear_UEA_ftM_sl29_ll0_pl0_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.471696376800537
Epoch: 1, Steps: 17 | Train Loss: 2.120 Vali Loss: 2.114 Vali Acc: 0.262 Test Loss: 2.114 Test Acc: 0.262
Validation loss decreased (inf --> -0.262141).  Saving model ...
Epoch: 2 cost time: 1.459761381149292
Epoch: 2, Steps: 17 | Train Loss: 2.033 Vali Loss: 2.011 Vali Acc: 0.308 Test Loss: 2.011 Test Acc: 0.308
Validation loss decreased (-0.262141 --> -0.308088).  Saving model ...
Epoch: 3 cost time: 1.433729887008667
Epoch: 3, Steps: 17 | Train Loss: 1.905 Vali Loss: 1.873 Vali Acc: 0.403 Test Loss: 1.873 Test Acc: 0.403
Validation loss decreased (-0.308088 --> -0.402684).  Saving model ...
Epoch: 4 cost time: 1.395531415939331
Epoch: 4, Steps: 17 | Train Loss: 1.750 Vali Loss: 1.710 Vali Acc: 0.557 Test Loss: 1.710 Test Acc: 0.557
Validation loss decreased (-0.402684 --> -0.556740).  Saving model ...
Epoch: 5 cost time: 1.267531156539917
Epoch: 5, Steps: 17 | Train Loss: 1.568 Vali Loss: 1.530 Vali Acc: 0.657 Test Loss: 1.530 Test Acc: 0.657
Validation loss decreased (-0.556740 --> -0.656741).  Saving model ...
Epoch: 6 cost time: 1.2466843128204346
Epoch: 6, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.333 Vali Acc: 0.743 Test Loss: 1.333 Test Acc: 0.743
Validation loss decreased (-0.656741 --> -0.743230).  Saving model ...
Epoch: 7 cost time: 1.328934907913208
Epoch: 7, Steps: 17 | Train Loss: 1.182 Vali Loss: 1.142 Vali Acc: 0.776 Test Loss: 1.142 Test Acc: 0.776
Validation loss decreased (-0.743230 --> -0.775664).  Saving model ...
Epoch: 8 cost time: 1.4337201118469238
Epoch: 8, Steps: 17 | Train Loss: 1.000 Vali Loss: 0.972 Vali Acc: 0.822 Test Loss: 0.972 Test Acc: 0.822
Validation loss decreased (-0.775664 --> -0.821612).  Saving model ...
Epoch: 9 cost time: 1.2882838249206543
Epoch: 9, Steps: 17 | Train Loss: 0.842 Vali Loss: 0.822 Vali Acc: 0.859 Test Loss: 0.822 Test Acc: 0.859
Validation loss decreased (-0.821612 --> -0.859451).  Saving model ...
Epoch: 10 cost time: 1.5510454177856445
Epoch: 10, Steps: 17 | Train Loss: 0.709 Vali Loss: 0.695 Vali Acc: 0.876 Test Loss: 0.695 Test Acc: 0.876
Validation loss decreased (-0.859451 --> -0.875669).  Saving model ...
Epoch: 11 cost time: 1.6666104793548584
Epoch: 11, Steps: 17 | Train Loss: 0.600 Vali Loss: 0.596 Vali Acc: 0.895 Test Loss: 0.596 Test Acc: 0.895
Validation loss decreased (-0.875669 --> -0.894589).  Saving model ...
Epoch: 12 cost time: 1.5670769214630127
Epoch: 12, Steps: 17 | Train Loss: 0.514 Vali Loss: 0.516 Vali Acc: 0.911 Test Loss: 0.516 Test Acc: 0.911
Validation loss decreased (-0.894589 --> -0.910806).  Saving model ...
Epoch: 13 cost time: 1.1939489841461182
Epoch: 13, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.453 Vali Acc: 0.914 Test Loss: 0.453 Test Acc: 0.914
Validation loss decreased (-0.910806 --> -0.913509).  Saving model ...
Epoch: 14 cost time: 1.5018994808197021
Epoch: 14, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.398 Vali Acc: 0.930 Test Loss: 0.398 Test Acc: 0.930
Validation loss decreased (-0.913509 --> -0.929726).  Saving model ...
Epoch: 15 cost time: 1.2071361541748047
Epoch: 15, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.359 Vali Acc: 0.932 Test Loss: 0.359 Test Acc: 0.932
Validation loss decreased (-0.929726 --> -0.932429).  Saving model ...
Epoch: 16 cost time: 1.4901275634765625
Epoch: 16, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.321 Vali Acc: 0.932 Test Loss: 0.321 Test Acc: 0.932
Validation loss decreased (-0.932429 --> -0.932429).  Saving model ...
Epoch: 17 cost time: 1.4213917255401611
Epoch: 17, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.292 Vali Acc: 0.941 Test Loss: 0.292 Test Acc: 0.941
Validation loss decreased (-0.932429 --> -0.940538).  Saving model ...
Epoch: 18 cost time: 1.0988264083862305
Epoch: 18, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.268 Vali Acc: 0.943 Test Loss: 0.268 Test Acc: 0.943
Validation loss decreased (-0.940538 --> -0.943241).  Saving model ...
Epoch: 19 cost time: 1.5102498531341553
Epoch: 19, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.246 Vali Acc: 0.943 Test Loss: 0.246 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 20 cost time: 1.5125744342803955
Epoch: 20, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.229 Vali Acc: 0.954 Test Loss: 0.229 Test Acc: 0.954
Validation loss decreased (-0.943241 --> -0.954052).  Saving model ...
Epoch: 21 cost time: 1.6942470073699951
Epoch: 21, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.214 Vali Acc: 0.946 Test Loss: 0.214 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3113346099853516
Epoch: 22, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.202 Vali Acc: 0.949 Test Loss: 0.202 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4583308696746826
Epoch: 23, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.190 Vali Acc: 0.946 Test Loss: 0.190 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.5215027332305908
Epoch: 24, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.182 Vali Acc: 0.954 Test Loss: 0.182 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 25 cost time: 1.4764134883880615
Epoch: 25, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.175 Vali Acc: 0.951 Test Loss: 0.175 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6307432651519775
Epoch: 26, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.169 Vali Acc: 0.957 Test Loss: 0.169 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 27 cost time: 1.5581238269805908
Epoch: 27, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.500913381576538
Epoch: 28, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.523362398147583
Epoch: 29, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.624946117401123
Epoch: 30, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.151 Vali Acc: 0.951 Test Loss: 0.151 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.3361992835998535
Epoch: 31, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 32 cost time: 1.4671647548675537
Epoch: 32, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 33 cost time: 1.4019043445587158
Epoch: 33, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2805373668670654
Epoch: 34, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.5379159450531006
Epoch: 35, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 36 cost time: 1.607398271560669
Epoch: 36, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.137 Vali Acc: 0.959 Test Loss: 0.137 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.6014504432678223
Epoch: 37, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.579472541809082
Epoch: 38, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 39 cost time: 1.752030611038208
Epoch: 39, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 40 cost time: 1.4389686584472656
Epoch: 40, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.6645212173461914
Epoch: 41, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.7460455894470215
Epoch: 42, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.5163204669952393
Epoch: 43, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.133 Vali Acc: 0.957 Test Loss: 0.133 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.6077256202697754
Epoch: 44, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.130 Vali Acc: 0.957 Test Loss: 0.130 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.518918514251709
Epoch: 45, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.130 Vali Acc: 0.957 Test Loss: 0.130 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.5398023128509521
Epoch: 46, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.130 Vali Acc: 0.957 Test Loss: 0.130 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.550825834274292
Epoch: 47, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.130 Vali Acc: 0.957 Test Loss: 0.130 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.161787748336792
Epoch: 48, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.4767999649047852
Epoch: 49, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.130 Vali Acc: 0.957 Test Loss: 0.130 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_DLinear_UEA_ftM_sl29_ll0_pl0_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 4881
model size : 0.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         9                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_DLinear_UEA_ftM_sl29_ll0_pl0_ma9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.215031623840332
Epoch: 1, Steps: 17 | Train Loss: 2.120 Vali Loss: 2.115 Vali Acc: 0.262 Test Loss: 2.115 Test Acc: 0.262
Validation loss decreased (inf --> -0.262141).  Saving model ...
Epoch: 2 cost time: 1.5228314399719238
Epoch: 2, Steps: 17 | Train Loss: 2.034 Vali Loss: 2.011 Vali Acc: 0.308 Test Loss: 2.011 Test Acc: 0.308
Validation loss decreased (-0.262141 --> -0.308088).  Saving model ...
Epoch: 3 cost time: 1.481407642364502
Epoch: 3, Steps: 17 | Train Loss: 1.906 Vali Loss: 1.874 Vali Acc: 0.403 Test Loss: 1.874 Test Acc: 0.403
Validation loss decreased (-0.308088 --> -0.402684).  Saving model ...
Epoch: 4 cost time: 1.536130666732788
Epoch: 4, Steps: 17 | Train Loss: 1.752 Vali Loss: 1.712 Vali Acc: 0.557 Test Loss: 1.712 Test Acc: 0.557
Validation loss decreased (-0.402684 --> -0.556740).  Saving model ...
Epoch: 5 cost time: 1.308924674987793
Epoch: 5, Steps: 17 | Train Loss: 1.571 Vali Loss: 1.534 Vali Acc: 0.657 Test Loss: 1.534 Test Acc: 0.657
Validation loss decreased (-0.556740 --> -0.656741).  Saving model ...
Epoch: 6 cost time: 1.343562364578247
Epoch: 6, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.338 Vali Acc: 0.743 Test Loss: 1.338 Test Acc: 0.743
Validation loss decreased (-0.656741 --> -0.743230).  Saving model ...
Epoch: 7 cost time: 1.269580364227295
Epoch: 7, Steps: 17 | Train Loss: 1.187 Vali Loss: 1.148 Vali Acc: 0.773 Test Loss: 1.148 Test Acc: 0.773
Validation loss decreased (-0.743230 --> -0.772961).  Saving model ...
Epoch: 8 cost time: 1.2341399192810059
Epoch: 8, Steps: 17 | Train Loss: 1.006 Vali Loss: 0.980 Vali Acc: 0.822 Test Loss: 0.980 Test Acc: 0.822
Validation loss decreased (-0.772961 --> -0.821612).  Saving model ...
Epoch: 9 cost time: 1.5019817352294922
Epoch: 9, Steps: 17 | Train Loss: 0.850 Vali Loss: 0.830 Vali Acc: 0.859 Test Loss: 0.830 Test Acc: 0.859
Validation loss decreased (-0.821612 --> -0.859451).  Saving model ...
Epoch: 10 cost time: 1.293358564376831
Epoch: 10, Steps: 17 | Train Loss: 0.717 Vali Loss: 0.704 Vali Acc: 0.873 Test Loss: 0.704 Test Acc: 0.873
Validation loss decreased (-0.859451 --> -0.872966).  Saving model ...
Epoch: 11 cost time: 1.5045671463012695
Epoch: 11, Steps: 17 | Train Loss: 0.608 Vali Loss: 0.605 Vali Acc: 0.892 Test Loss: 0.605 Test Acc: 0.892
Validation loss decreased (-0.872966 --> -0.891886).  Saving model ...
Epoch: 12 cost time: 1.5442767143249512
Epoch: 12, Steps: 17 | Train Loss: 0.521 Vali Loss: 0.525 Vali Acc: 0.911 Test Loss: 0.525 Test Acc: 0.911
Validation loss decreased (-0.891886 --> -0.910806).  Saving model ...
Epoch: 13 cost time: 1.404054880142212
Epoch: 13, Steps: 17 | Train Loss: 0.453 Vali Loss: 0.462 Vali Acc: 0.911 Test Loss: 0.462 Test Acc: 0.911
Validation loss decreased (-0.910806 --> -0.910806).  Saving model ...
Epoch: 14 cost time: 1.5554907321929932
Epoch: 14, Steps: 17 | Train Loss: 0.400 Vali Loss: 0.407 Vali Acc: 0.927 Test Loss: 0.407 Test Acc: 0.927
Validation loss decreased (-0.910806 --> -0.927023).  Saving model ...
Epoch: 15 cost time: 1.4383602142333984
Epoch: 15, Steps: 17 | Train Loss: 0.351 Vali Loss: 0.368 Vali Acc: 0.930 Test Loss: 0.368 Test Acc: 0.930
Validation loss decreased (-0.927023 --> -0.929726).  Saving model ...
Epoch: 16 cost time: 1.2304446697235107
Epoch: 16, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.330 Vali Acc: 0.930 Test Loss: 0.330 Test Acc: 0.930
Validation loss decreased (-0.929726 --> -0.929726).  Saving model ...
Epoch: 17 cost time: 1.5240328311920166
Epoch: 17, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.301 Vali Acc: 0.938 Test Loss: 0.301 Test Acc: 0.938
Validation loss decreased (-0.929726 --> -0.937835).  Saving model ...
Epoch: 18 cost time: 1.6519381999969482
Epoch: 18, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.276 Vali Acc: 0.941 Test Loss: 0.276 Test Acc: 0.941
Validation loss decreased (-0.937835 --> -0.940538).  Saving model ...
Epoch: 19 cost time: 1.5807158946990967
Epoch: 19, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.254 Vali Acc: 0.943 Test Loss: 0.254 Test Acc: 0.943
Validation loss decreased (-0.940538 --> -0.943241).  Saving model ...
Epoch: 20 cost time: 1.4842193126678467
Epoch: 20, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.236 Vali Acc: 0.943 Test Loss: 0.236 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 21 cost time: 1.453735589981079
Epoch: 21, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.221 Vali Acc: 0.949 Test Loss: 0.221 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948646).  Saving model ...
Epoch: 22 cost time: 1.8819518089294434
Epoch: 22, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.208 Vali Acc: 0.949 Test Loss: 0.208 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948647).  Saving model ...
Epoch: 23 cost time: 1.4918482303619385
Epoch: 23, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.195 Vali Acc: 0.949 Test Loss: 0.195 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 24 cost time: 1.5361037254333496
Epoch: 24, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.187 Vali Acc: 0.951 Test Loss: 0.187 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951349).  Saving model ...
Epoch: 25 cost time: 1.6571629047393799
Epoch: 25, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.180 Vali Acc: 0.954 Test Loss: 0.180 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 26 cost time: 1.618150234222412
Epoch: 26, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.173 Vali Acc: 0.954 Test Loss: 0.173 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 27 cost time: 1.5729880332946777
Epoch: 27, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.168 Vali Acc: 0.954 Test Loss: 0.168 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 28 cost time: 1.4840998649597168
Epoch: 28, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4213981628417969
Epoch: 29, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.9672057628631592
Epoch: 30, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.7238643169403076
Epoch: 31, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 32 cost time: 1.6069540977478027
Epoch: 32, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 33 cost time: 1.7316968441009521
Epoch: 33, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.145 Vali Acc: 0.954 Test Loss: 0.145 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.825510025024414
Epoch: 34, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 35 cost time: 1.6296632289886475
Epoch: 35, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 36 cost time: 1.6138269901275635
Epoch: 36, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964863).  Saving model ...
Epoch: 37 cost time: 1.9472174644470215
Epoch: 37, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.764620065689087
Epoch: 38, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.7863428592681885
Epoch: 39, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 40 cost time: 1.7537074089050293
Epoch: 40, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.6793301105499268
Epoch: 41, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.6235888004302979
Epoch: 42, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.8244047164916992
Epoch: 43, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.134 Vali Acc: 0.959 Test Loss: 0.134 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.8061614036560059
Epoch: 44, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.680213451385498
Epoch: 45, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.906209945678711
Epoch: 46, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.7023100852966309
Epoch: 47, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.131 Vali Acc: 0.957 Test Loss: 0.131 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.9068355560302734
Epoch: 48, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.130 Vali Acc: 0.959 Test Loss: 0.130 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.6681621074676514
Epoch: 49, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.131 Vali Acc: 0.957 Test Loss: 0.131 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_DLinear_UEA_ftM_sl29_ll0_pl0_ma9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 4881
model size : 0.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         8                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_DLinear_UEA_ftM_sl29_ll0_pl0_ma8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.409177303314209
Epoch: 1, Steps: 17 | Train Loss: 2.120 Vali Loss: 2.115 Vali Acc: 0.262 Test Loss: 2.115 Test Acc: 0.262
Validation loss decreased (inf --> -0.262141).  Saving model ...
Epoch: 2 cost time: 1.9507319927215576
Epoch: 2, Steps: 17 | Train Loss: 2.033 Vali Loss: 2.011 Vali Acc: 0.308 Test Loss: 2.011 Test Acc: 0.308
Validation loss decreased (-0.262141 --> -0.308088).  Saving model ...
Epoch: 3 cost time: 1.417149543762207
Epoch: 3, Steps: 17 | Train Loss: 1.905 Vali Loss: 1.873 Vali Acc: 0.403 Test Loss: 1.873 Test Acc: 0.403
Validation loss decreased (-0.308088 --> -0.402684).  Saving model ...
Epoch: 4 cost time: 1.6461820602416992
Epoch: 4, Steps: 17 | Train Loss: 1.750 Vali Loss: 1.711 Vali Acc: 0.557 Test Loss: 1.711 Test Acc: 0.557
Validation loss decreased (-0.402684 --> -0.556740).  Saving model ...
Epoch: 5 cost time: 1.8407726287841797
Epoch: 5, Steps: 17 | Train Loss: 1.569 Vali Loss: 1.531 Vali Acc: 0.657 Test Loss: 1.531 Test Acc: 0.657
Validation loss decreased (-0.556740 --> -0.656741).  Saving model ...
Epoch: 6 cost time: 1.8086183071136475
Epoch: 6, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.335 Vali Acc: 0.741 Test Loss: 1.335 Test Acc: 0.741
Validation loss decreased (-0.656741 --> -0.740527).  Saving model ...
Epoch: 7 cost time: 1.6472032070159912
Epoch: 7, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.144 Vali Acc: 0.773 Test Loss: 1.144 Test Acc: 0.773
Validation loss decreased (-0.740527 --> -0.772962).  Saving model ...
Epoch: 8 cost time: 1.2828710079193115
Epoch: 8, Steps: 17 | Train Loss: 1.002 Vali Loss: 0.976 Vali Acc: 0.822 Test Loss: 0.976 Test Acc: 0.822
Validation loss decreased (-0.772962 --> -0.821612).  Saving model ...
Epoch: 9 cost time: 1.7387011051177979
Epoch: 9, Steps: 17 | Train Loss: 0.845 Vali Loss: 0.826 Vali Acc: 0.859 Test Loss: 0.826 Test Acc: 0.859
Validation loss decreased (-0.821612 --> -0.859451).  Saving model ...
Epoch: 10 cost time: 1.5181772708892822
Epoch: 10, Steps: 17 | Train Loss: 0.712 Vali Loss: 0.699 Vali Acc: 0.873 Test Loss: 0.699 Test Acc: 0.873
Validation loss decreased (-0.859451 --> -0.872966).  Saving model ...
Epoch: 11 cost time: 1.6747689247131348
Epoch: 11, Steps: 17 | Train Loss: 0.604 Vali Loss: 0.602 Vali Acc: 0.892 Test Loss: 0.602 Test Acc: 0.892
Validation loss decreased (-0.872966 --> -0.891886).  Saving model ...
Epoch: 12 cost time: 1.9274747371673584
Epoch: 12, Steps: 17 | Train Loss: 0.517 Vali Loss: 0.522 Vali Acc: 0.911 Test Loss: 0.522 Test Acc: 0.911
Validation loss decreased (-0.891886 --> -0.910806).  Saving model ...
Epoch: 13 cost time: 1.5989408493041992
Epoch: 13, Steps: 17 | Train Loss: 0.450 Vali Loss: 0.460 Vali Acc: 0.911 Test Loss: 0.460 Test Acc: 0.911
Validation loss decreased (-0.910806 --> -0.910806).  Saving model ...
Epoch: 14 cost time: 1.5351638793945312
Epoch: 14, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.406 Vali Acc: 0.927 Test Loss: 0.406 Test Acc: 0.927
Validation loss decreased (-0.910806 --> -0.927023).  Saving model ...
Epoch: 15 cost time: 1.5968949794769287
Epoch: 15, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.366 Vali Acc: 0.927 Test Loss: 0.366 Test Acc: 0.927
Validation loss decreased (-0.927023 --> -0.927023).  Saving model ...
Epoch: 16 cost time: 1.5597481727600098
Epoch: 16, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.329 Vali Acc: 0.932 Test Loss: 0.329 Test Acc: 0.932
Validation loss decreased (-0.927023 --> -0.932429).  Saving model ...
Epoch: 17 cost time: 1.6661591529846191
Epoch: 17, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.300 Vali Acc: 0.932 Test Loss: 0.300 Test Acc: 0.932
Validation loss decreased (-0.932429 --> -0.932429).  Saving model ...
Epoch: 18 cost time: 1.5365269184112549
Epoch: 18, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.275 Vali Acc: 0.938 Test Loss: 0.275 Test Acc: 0.938
Validation loss decreased (-0.932429 --> -0.937835).  Saving model ...
Epoch: 19 cost time: 1.636003017425537
Epoch: 19, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.253 Vali Acc: 0.943 Test Loss: 0.253 Test Acc: 0.943
Validation loss decreased (-0.937835 --> -0.943241).  Saving model ...
Epoch: 20 cost time: 1.8500208854675293
Epoch: 20, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.235 Vali Acc: 0.943 Test Loss: 0.235 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 21 cost time: 1.5143089294433594
Epoch: 21, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.220 Vali Acc: 0.949 Test Loss: 0.220 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948646).  Saving model ...
Epoch: 22 cost time: 1.3878898620605469
Epoch: 22, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.207 Vali Acc: 0.949 Test Loss: 0.207 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948647).  Saving model ...
Epoch: 23 cost time: 1.5918235778808594
Epoch: 23, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.194 Vali Acc: 0.949 Test Loss: 0.194 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 24 cost time: 1.4979584217071533
Epoch: 24, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.186 Vali Acc: 0.951 Test Loss: 0.186 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951349).  Saving model ...
Epoch: 25 cost time: 1.8991472721099854
Epoch: 25, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.178 Vali Acc: 0.954 Test Loss: 0.178 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 26 cost time: 1.5156795978546143
Epoch: 26, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.172 Vali Acc: 0.954 Test Loss: 0.172 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 27 cost time: 1.8693690299987793
Epoch: 27, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.167 Vali Acc: 0.957 Test Loss: 0.167 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 28 cost time: 1.5595440864562988
Epoch: 28, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 29 cost time: 1.513375997543335
Epoch: 29, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5726361274719238
Epoch: 30, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.748305082321167
Epoch: 31, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 32 cost time: 1.3454742431640625
Epoch: 32, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.145 Vali Acc: 0.954 Test Loss: 0.145 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.6260647773742676
Epoch: 33, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.143 Vali Acc: 0.954 Test Loss: 0.143 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.4412689208984375
Epoch: 34, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.142 Vali Acc: 0.957 Test Loss: 0.142 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 35 cost time: 1.3098104000091553
Epoch: 35, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.139 Vali Acc: 0.959 Test Loss: 0.139 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 36 cost time: 1.8321657180786133
Epoch: 36, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 37 cost time: 1.558058738708496
Epoch: 37, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 38 cost time: 1.687140941619873
Epoch: 38, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 39 cost time: 1.5443789958953857
Epoch: 39, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 40 cost time: 1.537445306777954
Epoch: 40, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 41 cost time: 1.660839557647705
Epoch: 41, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.7483510971069336
Epoch: 42, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.7733256816864014
Epoch: 43, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.59954833984375
Epoch: 44, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.7359542846679688
Epoch: 45, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.8994579315185547
Epoch: 46, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.7450222969055176
Epoch: 47, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 2.1880738735198975
Epoch: 48, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.127 Vali Acc: 0.957 Test Loss: 0.127 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.6448261737823486
Epoch: 49, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.128 Vali Acc: 0.954 Test Loss: 0.128 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.8114054203033447
Epoch: 50, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.128 Vali Acc: 0.954 Test Loss: 0.128 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_DLinear_UEA_ftM_sl29_ll0_pl0_ma8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 4881
model size : 0.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         6                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_DLinear_UEA_ftM_sl29_ll0_pl0_ma6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.154021501541138
Epoch: 1, Steps: 17 | Train Loss: 2.120 Vali Loss: 2.115 Vali Acc: 0.262 Test Loss: 2.115 Test Acc: 0.262
Validation loss decreased (inf --> -0.262141).  Saving model ...
Epoch: 2 cost time: 1.7783432006835938
Epoch: 2, Steps: 17 | Train Loss: 2.034 Vali Loss: 2.011 Vali Acc: 0.308 Test Loss: 2.011 Test Acc: 0.308
Validation loss decreased (-0.262141 --> -0.308088).  Saving model ...
Epoch: 3 cost time: 1.8322432041168213
Epoch: 3, Steps: 17 | Train Loss: 1.906 Vali Loss: 1.874 Vali Acc: 0.403 Test Loss: 1.874 Test Acc: 0.403
Validation loss decreased (-0.308088 --> -0.402684).  Saving model ...
Epoch: 4 cost time: 1.7514722347259521
Epoch: 4, Steps: 17 | Train Loss: 1.751 Vali Loss: 1.712 Vali Acc: 0.557 Test Loss: 1.712 Test Acc: 0.557
Validation loss decreased (-0.402684 --> -0.556740).  Saving model ...
Epoch: 5 cost time: 1.4935088157653809
Epoch: 5, Steps: 17 | Train Loss: 1.570 Vali Loss: 1.533 Vali Acc: 0.657 Test Loss: 1.533 Test Acc: 0.657
Validation loss decreased (-0.556740 --> -0.656741).  Saving model ...
Epoch: 6 cost time: 1.7942969799041748
Epoch: 6, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.338 Vali Acc: 0.741 Test Loss: 1.338 Test Acc: 0.741
Validation loss decreased (-0.656741 --> -0.740527).  Saving model ...
Epoch: 7 cost time: 1.860576868057251
Epoch: 7, Steps: 17 | Train Loss: 1.187 Vali Loss: 1.148 Vali Acc: 0.773 Test Loss: 1.148 Test Acc: 0.773
Validation loss decreased (-0.740527 --> -0.772961).  Saving model ...
Epoch: 8 cost time: 1.7994706630706787
Epoch: 8, Steps: 17 | Train Loss: 1.006 Vali Loss: 0.981 Vali Acc: 0.814 Test Loss: 0.981 Test Acc: 0.814
Validation loss decreased (-0.772961 --> -0.813504).  Saving model ...
Epoch: 9 cost time: 1.5512175559997559
Epoch: 9, Steps: 17 | Train Loss: 0.850 Vali Loss: 0.831 Vali Acc: 0.859 Test Loss: 0.831 Test Acc: 0.859
Validation loss decreased (-0.813504 --> -0.859451).  Saving model ...
Epoch: 10 cost time: 1.6196064949035645
Epoch: 10, Steps: 17 | Train Loss: 0.717 Vali Loss: 0.705 Vali Acc: 0.870 Test Loss: 0.705 Test Acc: 0.870
Validation loss decreased (-0.859451 --> -0.870263).  Saving model ...
Epoch: 11 cost time: 1.8799800872802734
Epoch: 11, Steps: 17 | Train Loss: 0.608 Vali Loss: 0.607 Vali Acc: 0.892 Test Loss: 0.607 Test Acc: 0.892
Validation loss decreased (-0.870263 --> -0.891886).  Saving model ...
Epoch: 12 cost time: 1.84352445602417
Epoch: 12, Steps: 17 | Train Loss: 0.522 Vali Loss: 0.527 Vali Acc: 0.905 Test Loss: 0.527 Test Acc: 0.905
Validation loss decreased (-0.891886 --> -0.905400).  Saving model ...
Epoch: 13 cost time: 1.7254650592803955
Epoch: 13, Steps: 17 | Train Loss: 0.454 Vali Loss: 0.465 Vali Acc: 0.911 Test Loss: 0.465 Test Acc: 0.911
Validation loss decreased (-0.905400 --> -0.910806).  Saving model ...
Epoch: 14 cost time: 1.537400484085083
Epoch: 14, Steps: 17 | Train Loss: 0.401 Vali Loss: 0.410 Vali Acc: 0.924 Test Loss: 0.410 Test Acc: 0.924
Validation loss decreased (-0.910806 --> -0.924320).  Saving model ...
Epoch: 15 cost time: 1.889655590057373
Epoch: 15, Steps: 17 | Train Loss: 0.352 Vali Loss: 0.371 Vali Acc: 0.930 Test Loss: 0.371 Test Acc: 0.930
Validation loss decreased (-0.924320 --> -0.929726).  Saving model ...
Epoch: 16 cost time: 1.907653570175171
Epoch: 16, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.333 Vali Acc: 0.932 Test Loss: 0.333 Test Acc: 0.932
Validation loss decreased (-0.929726 --> -0.932429).  Saving model ...
Epoch: 17 cost time: 2.0332653522491455
Epoch: 17, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.304 Vali Acc: 0.932 Test Loss: 0.304 Test Acc: 0.932
Validation loss decreased (-0.932429 --> -0.932429).  Saving model ...
Epoch: 18 cost time: 1.8240275382995605
Epoch: 18, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.279 Vali Acc: 0.941 Test Loss: 0.279 Test Acc: 0.941
Validation loss decreased (-0.932429 --> -0.940538).  Saving model ...
Epoch: 19 cost time: 2.4308509826660156
Epoch: 19, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.256 Vali Acc: 0.943 Test Loss: 0.256 Test Acc: 0.943
Validation loss decreased (-0.940538 --> -0.943241).  Saving model ...
Epoch: 20 cost time: 1.8513388633728027
Epoch: 20, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.238 Vali Acc: 0.946 Test Loss: 0.238 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 21 cost time: 1.973233699798584
Epoch: 21, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.223 Vali Acc: 0.949 Test Loss: 0.223 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948646).  Saving model ...
Epoch: 22 cost time: 1.8499603271484375
Epoch: 22, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.210 Vali Acc: 0.949 Test Loss: 0.210 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948647).  Saving model ...
Epoch: 23 cost time: 1.787125825881958
Epoch: 23, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.197 Vali Acc: 0.949 Test Loss: 0.197 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 24 cost time: 2.138258695602417
Epoch: 24, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.188 Vali Acc: 0.949 Test Loss: 0.188 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 25 cost time: 2.2130422592163086
Epoch: 25, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.180 Vali Acc: 0.954 Test Loss: 0.180 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 26 cost time: 2.0517306327819824
Epoch: 26, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.174 Vali Acc: 0.954 Test Loss: 0.174 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 27 cost time: 1.8894038200378418
Epoch: 27, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.169 Vali Acc: 0.957 Test Loss: 0.169 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 28 cost time: 1.7680201530456543
Epoch: 28, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 29 cost time: 1.888824701309204
Epoch: 29, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.001704216003418
Epoch: 30, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.1669561862945557
Epoch: 31, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 32 cost time: 1.546670913696289
Epoch: 32, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 33 cost time: 1.723123550415039
Epoch: 33, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.144 Vali Acc: 0.954 Test Loss: 0.144 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.239488124847412
Epoch: 34, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 35 cost time: 1.9543819427490234
Epoch: 35, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.139 Vali Acc: 0.959 Test Loss: 0.139 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 36 cost time: 1.7200520038604736
Epoch: 36, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 37 cost time: 1.8805110454559326
Epoch: 37, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 38 cost time: 1.9866313934326172
Epoch: 38, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.6921336650848389
Epoch: 39, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 40 cost time: 2.0626230239868164
Epoch: 40, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 41 cost time: 2.4395132064819336
Epoch: 41, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.441591739654541
Epoch: 42, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.9956724643707275
Epoch: 43, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.6128690242767334
Epoch: 44, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 2.2474632263183594
Epoch: 45, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 2.221203088760376
Epoch: 46, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 2.1022939682006836
Epoch: 47, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 2.084146022796631
Epoch: 48, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.127 Vali Acc: 0.957 Test Loss: 0.127 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 2.026216983795166
Epoch: 49, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 2.4372801780700684
Epoch: 50, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.127 Vali Acc: 0.954 Test Loss: 0.127 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_DLinear_UEA_ftM_sl29_ll0_pl0_ma6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 4881
model size : 0.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_DLinear_UEA_ftM_sl29_ll0_pl0_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.2983434200286865
Epoch: 1, Steps: 17 | Train Loss: 2.120 Vali Loss: 2.115 Vali Acc: 0.262 Test Loss: 2.115 Test Acc: 0.262
Validation loss decreased (inf --> -0.262141).  Saving model ...
Epoch: 2 cost time: 1.5176186561584473
Epoch: 2, Steps: 17 | Train Loss: 2.034 Vali Loss: 2.012 Vali Acc: 0.308 Test Loss: 2.012 Test Acc: 0.308
Validation loss decreased (-0.262141 --> -0.308088).  Saving model ...
Epoch: 3 cost time: 2.2601239681243896
Epoch: 3, Steps: 17 | Train Loss: 1.907 Vali Loss: 1.876 Vali Acc: 0.397 Test Loss: 1.876 Test Acc: 0.397
Validation loss decreased (-0.308088 --> -0.397279).  Saving model ...
Epoch: 4 cost time: 2.6653778553009033
Epoch: 4, Steps: 17 | Train Loss: 1.754 Vali Loss: 1.716 Vali Acc: 0.557 Test Loss: 1.716 Test Acc: 0.557
Validation loss decreased (-0.397279 --> -0.556740).  Saving model ...
Epoch: 5 cost time: 2.0724196434020996
Epoch: 5, Steps: 17 | Train Loss: 1.575 Vali Loss: 1.539 Vali Acc: 0.657 Test Loss: 1.539 Test Acc: 0.657
Validation loss decreased (-0.556740 --> -0.656741).  Saving model ...
Epoch: 6 cost time: 1.8379898071289062
Epoch: 6, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.346 Vali Acc: 0.741 Test Loss: 1.346 Test Acc: 0.741
Validation loss decreased (-0.656741 --> -0.740527).  Saving model ...
Epoch: 7 cost time: 1.7668275833129883
Epoch: 7, Steps: 17 | Train Loss: 1.196 Vali Loss: 1.159 Vali Acc: 0.773 Test Loss: 1.159 Test Acc: 0.773
Validation loss decreased (-0.740527 --> -0.772961).  Saving model ...
Epoch: 8 cost time: 1.6792428493499756
Epoch: 8, Steps: 17 | Train Loss: 1.017 Vali Loss: 0.992 Vali Acc: 0.811 Test Loss: 0.992 Test Acc: 0.811
Validation loss decreased (-0.772961 --> -0.810801).  Saving model ...
Epoch: 9 cost time: 1.8836851119995117
Epoch: 9, Steps: 17 | Train Loss: 0.861 Vali Loss: 0.843 Vali Acc: 0.859 Test Loss: 0.843 Test Acc: 0.859
Validation loss decreased (-0.810801 --> -0.859451).  Saving model ...
Epoch: 10 cost time: 2.011854648590088
Epoch: 10, Steps: 17 | Train Loss: 0.729 Vali Loss: 0.717 Vali Acc: 0.868 Test Loss: 0.717 Test Acc: 0.868
Validation loss decreased (-0.859451 --> -0.867560).  Saving model ...
Epoch: 11 cost time: 2.170562267303467
Epoch: 11, Steps: 17 | Train Loss: 0.619 Vali Loss: 0.618 Vali Acc: 0.886 Test Loss: 0.618 Test Acc: 0.886
Validation loss decreased (-0.867560 --> -0.886480).  Saving model ...
Epoch: 12 cost time: 2.239161252975464
Epoch: 12, Steps: 17 | Train Loss: 0.533 Vali Loss: 0.538 Vali Acc: 0.905 Test Loss: 0.538 Test Acc: 0.905
Validation loss decreased (-0.886480 --> -0.905400).  Saving model ...
Epoch: 13 cost time: 2.167835235595703
Epoch: 13, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.475 Vali Acc: 0.911 Test Loss: 0.475 Test Acc: 0.911
Validation loss decreased (-0.905400 --> -0.910806).  Saving model ...
Epoch: 14 cost time: 1.8734326362609863
Epoch: 14, Steps: 17 | Train Loss: 0.411 Vali Loss: 0.420 Vali Acc: 0.922 Test Loss: 0.420 Test Acc: 0.922
Validation loss decreased (-0.910806 --> -0.921617).  Saving model ...
Epoch: 15 cost time: 1.9656822681427002
Epoch: 15, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.380 Vali Acc: 0.927 Test Loss: 0.380 Test Acc: 0.927
Validation loss decreased (-0.921617 --> -0.927023).  Saving model ...
Epoch: 16 cost time: 1.8559937477111816
Epoch: 16, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.342 Vali Acc: 0.930 Test Loss: 0.342 Test Acc: 0.930
Validation loss decreased (-0.927023 --> -0.929726).  Saving model ...
Epoch: 17 cost time: 2.060605525970459
Epoch: 17, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.312 Vali Acc: 0.930 Test Loss: 0.312 Test Acc: 0.930
Validation loss decreased (-0.929726 --> -0.929727).  Saving model ...
Epoch: 18 cost time: 2.104774236679077
Epoch: 18, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.287 Vali Acc: 0.935 Test Loss: 0.287 Test Acc: 0.935
Validation loss decreased (-0.929727 --> -0.935132).  Saving model ...
Epoch: 19 cost time: 2.272063732147217
Epoch: 19, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.264 Vali Acc: 0.941 Test Loss: 0.264 Test Acc: 0.941
Validation loss decreased (-0.935132 --> -0.940538).  Saving model ...
Epoch: 20 cost time: 1.9021055698394775
Epoch: 20, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.245 Vali Acc: 0.943 Test Loss: 0.245 Test Acc: 0.943
Validation loss decreased (-0.940538 --> -0.943241).  Saving model ...
Epoch: 21 cost time: 2.1662042140960693
Epoch: 21, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.230 Vali Acc: 0.946 Test Loss: 0.230 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 22 cost time: 1.7578763961791992
Epoch: 22, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.217 Vali Acc: 0.949 Test Loss: 0.217 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948646).  Saving model ...
Epoch: 23 cost time: 2.0831961631774902
Epoch: 23, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.203 Vali Acc: 0.949 Test Loss: 0.203 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948647).  Saving model ...
Epoch: 24 cost time: 1.6006267070770264
Epoch: 24, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.195 Vali Acc: 0.949 Test Loss: 0.195 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 25 cost time: 1.9882612228393555
Epoch: 25, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.187 Vali Acc: 0.954 Test Loss: 0.187 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 26 cost time: 2.4130465984344482
Epoch: 26, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.180 Vali Acc: 0.954 Test Loss: 0.180 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 27 cost time: 2.108374834060669
Epoch: 27, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.174 Vali Acc: 0.954 Test Loss: 0.174 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 28 cost time: 2.0389890670776367
Epoch: 28, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.166 Vali Acc: 0.957 Test Loss: 0.166 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 29 cost time: 2.0916404724121094
Epoch: 29, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.165 Vali Acc: 0.954 Test Loss: 0.165 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.963395595550537
Epoch: 30, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 31 cost time: 1.629892110824585
Epoch: 31, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.156 Vali Acc: 0.957 Test Loss: 0.156 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 32 cost time: 1.921020746231079
Epoch: 32, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 33 cost time: 1.9806256294250488
Epoch: 33, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 34 cost time: 2.1280627250671387
Epoch: 34, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.148 Vali Acc: 0.957 Test Loss: 0.148 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 35 cost time: 1.903191089630127
Epoch: 35, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 36 cost time: 1.9278240203857422
Epoch: 36, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.142 Vali Acc: 0.957 Test Loss: 0.142 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 37 cost time: 1.9199905395507812
Epoch: 37, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.141 Vali Acc: 0.959 Test Loss: 0.141 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 38 cost time: 1.8513860702514648
Epoch: 38, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.140 Vali Acc: 0.959 Test Loss: 0.140 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 39 cost time: 1.9601564407348633
Epoch: 39, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 40 cost time: 1.7938752174377441
Epoch: 40, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 41 cost time: 2.166877269744873
Epoch: 41, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.107776403427124
Epoch: 42, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.5456414222717285
Epoch: 43, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.137 Vali Acc: 0.965 Test Loss: 0.137 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.7875821590423584
Epoch: 44, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 2.431037664413452
Epoch: 45, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.952430248260498
Epoch: 46, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.9016809463500977
Epoch: 47, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.5493383407592773
Epoch: 48, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.5480635166168213
Epoch: 49, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.7115728855133057
Epoch: 50, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_DLinear_UEA_ftM_sl29_ll0_pl0_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 4881
model size : 0.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_DLinear_UEA_ftM_sl29_ll0_pl0_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.888875961303711
Epoch: 1, Steps: 17 | Train Loss: 2.120 Vali Loss: 2.115 Vali Acc: 0.262 Test Loss: 2.115 Test Acc: 0.262
Validation loss decreased (inf --> -0.262141).  Saving model ...
Epoch: 2 cost time: 1.7482941150665283
Epoch: 2, Steps: 17 | Train Loss: 2.034 Vali Loss: 2.012 Vali Acc: 0.308 Test Loss: 2.012 Test Acc: 0.308
Validation loss decreased (-0.262141 --> -0.308088).  Saving model ...
Epoch: 3 cost time: 1.4360976219177246
Epoch: 3, Steps: 17 | Train Loss: 1.908 Vali Loss: 1.876 Vali Acc: 0.395 Test Loss: 1.876 Test Acc: 0.395
Validation loss decreased (-0.308088 --> -0.394576).  Saving model ...
Epoch: 4 cost time: 2.048022508621216
Epoch: 4, Steps: 17 | Train Loss: 1.754 Vali Loss: 1.716 Vali Acc: 0.557 Test Loss: 1.716 Test Acc: 0.557
Validation loss decreased (-0.394576 --> -0.556740).  Saving model ...
Epoch: 5 cost time: 1.7477617263793945
Epoch: 5, Steps: 17 | Train Loss: 1.576 Vali Loss: 1.540 Vali Acc: 0.657 Test Loss: 1.540 Test Acc: 0.657
Validation loss decreased (-0.556740 --> -0.656741).  Saving model ...
Epoch: 6 cost time: 1.9298560619354248
Epoch: 6, Steps: 17 | Train Loss: 1.388 Vali Loss: 1.348 Vali Acc: 0.741 Test Loss: 1.348 Test Acc: 0.741
Validation loss decreased (-0.656741 --> -0.740527).  Saving model ...
Epoch: 7 cost time: 1.8092091083526611
Epoch: 7, Steps: 17 | Train Loss: 1.198 Vali Loss: 1.161 Vali Acc: 0.770 Test Loss: 1.161 Test Acc: 0.770
Validation loss decreased (-0.740527 --> -0.770259).  Saving model ...
Epoch: 8 cost time: 2.0524120330810547
Epoch: 8, Steps: 17 | Train Loss: 1.020 Vali Loss: 0.996 Vali Acc: 0.811 Test Loss: 0.996 Test Acc: 0.811
Validation loss decreased (-0.770259 --> -0.810801).  Saving model ...
Epoch: 9 cost time: 1.9005577564239502
Epoch: 9, Steps: 17 | Train Loss: 0.865 Vali Loss: 0.847 Vali Acc: 0.857 Test Loss: 0.847 Test Acc: 0.857
Validation loss decreased (-0.810801 --> -0.856748).  Saving model ...
Epoch: 10 cost time: 1.8716866970062256
Epoch: 10, Steps: 17 | Train Loss: 0.732 Vali Loss: 0.720 Vali Acc: 0.868 Test Loss: 0.720 Test Acc: 0.868
Validation loss decreased (-0.856748 --> -0.867560).  Saving model ...
Epoch: 11 cost time: 2.6709702014923096
Epoch: 11, Steps: 17 | Train Loss: 0.623 Vali Loss: 0.622 Vali Acc: 0.886 Test Loss: 0.622 Test Acc: 0.886
Validation loss decreased (-0.867560 --> -0.886480).  Saving model ...
Epoch: 12 cost time: 1.7756290435791016
Epoch: 12, Steps: 17 | Train Loss: 0.536 Vali Loss: 0.541 Vali Acc: 0.903 Test Loss: 0.541 Test Acc: 0.903
Validation loss decreased (-0.886480 --> -0.902697).  Saving model ...
Epoch: 13 cost time: 1.626922369003296
Epoch: 13, Steps: 17 | Train Loss: 0.467 Vali Loss: 0.478 Vali Acc: 0.911 Test Loss: 0.478 Test Acc: 0.911
Validation loss decreased (-0.902697 --> -0.910806).  Saving model ...
Epoch: 14 cost time: 1.768122673034668
Epoch: 14, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.423 Vali Acc: 0.919 Test Loss: 0.423 Test Acc: 0.919
Validation loss decreased (-0.910806 --> -0.918915).  Saving model ...
Epoch: 15 cost time: 1.7513482570648193
Epoch: 15, Steps: 17 | Train Loss: 0.364 Vali Loss: 0.382 Vali Acc: 0.927 Test Loss: 0.382 Test Acc: 0.927
Validation loss decreased (-0.918915 --> -0.927023).  Saving model ...
Epoch: 16 cost time: 2.072566032409668
Epoch: 16, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.344 Vali Acc: 0.930 Test Loss: 0.344 Test Acc: 0.930
Validation loss decreased (-0.927023 --> -0.929726).  Saving model ...
Epoch: 17 cost time: 2.019075393676758
Epoch: 17, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.314 Vali Acc: 0.927 Test Loss: 0.314 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.1477608680725098
Epoch: 18, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.289 Vali Acc: 0.935 Test Loss: 0.289 Test Acc: 0.935
Validation loss decreased (-0.929726 --> -0.935132).  Saving model ...
Epoch: 19 cost time: 1.5446510314941406
Epoch: 19, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.266 Vali Acc: 0.938 Test Loss: 0.266 Test Acc: 0.938
Validation loss decreased (-0.935132 --> -0.937835).  Saving model ...
Epoch: 20 cost time: 1.8519377708435059
Epoch: 20, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.247 Vali Acc: 0.943 Test Loss: 0.247 Test Acc: 0.943
Validation loss decreased (-0.937835 --> -0.943241).  Saving model ...
Epoch: 21 cost time: 1.7682101726531982
Epoch: 21, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.232 Vali Acc: 0.946 Test Loss: 0.232 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 22 cost time: 1.850628137588501
Epoch: 22, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.218 Vali Acc: 0.946 Test Loss: 0.218 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 23 cost time: 2.19217586517334
Epoch: 23, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.205 Vali Acc: 0.949 Test Loss: 0.205 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 24 cost time: 1.618617057800293
Epoch: 24, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.196 Vali Acc: 0.949 Test Loss: 0.196 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 25 cost time: 1.698319435119629
Epoch: 25, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.188 Vali Acc: 0.951 Test Loss: 0.188 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951349).  Saving model ...
Epoch: 26 cost time: 1.9915673732757568
Epoch: 26, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.181 Vali Acc: 0.951 Test Loss: 0.181 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951350).  Saving model ...
Epoch: 27 cost time: 1.6582989692687988
Epoch: 27, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.176 Vali Acc: 0.954 Test Loss: 0.176 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 28 cost time: 1.7007534503936768
Epoch: 28, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.167 Vali Acc: 0.957 Test Loss: 0.167 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 29 cost time: 2.2633790969848633
Epoch: 29, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.166 Vali Acc: 0.954 Test Loss: 0.166 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.1728217601776123
Epoch: 30, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 31 cost time: 1.830345869064331
Epoch: 31, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 32 cost time: 2.065211772918701
Epoch: 32, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 33 cost time: 1.7861762046813965
Epoch: 33, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 34 cost time: 2.2078723907470703
Epoch: 34, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 35 cost time: 1.973792552947998
Epoch: 35, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.145 Vali Acc: 0.959 Test Loss: 0.145 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 36 cost time: 1.9364039897918701
Epoch: 36, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 37 cost time: 1.9578468799591064
Epoch: 37, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 38 cost time: 1.3925137519836426
Epoch: 38, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 39 cost time: 1.9767413139343262
Epoch: 39, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 40 cost time: 1.8658971786499023
Epoch: 40, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 41 cost time: 2.1002893447875977
Epoch: 41, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.813340187072754
Epoch: 42, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 43 cost time: 1.9643213748931885
Epoch: 43, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.9129810333251953
Epoch: 44, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.133 Vali Acc: 0.965 Test Loss: 0.133 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 45 cost time: 2.1452109813690186
Epoch: 45, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.6579878330230713
Epoch: 46, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.7290897369384766
Epoch: 47, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.7414307594299316
Epoch: 48, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 2.8535308837890625
Epoch: 49, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 2.11651349067688
Epoch: 50, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.7854952812194824
Epoch: 51, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.131 Vali Acc: 0.957 Test Loss: 0.131 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.88568115234375
Epoch: 52, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.130 Vali Acc: 0.957 Test Loss: 0.130 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.9134852886199951
Epoch: 53, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.131 Vali Acc: 0.957 Test Loss: 0.131 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.9481518268585205
Epoch: 54, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.131 Vali Acc: 0.957 Test Loss: 0.131 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_DLinear_UEA_ftM_sl29_ll0_pl0_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 4881
model size : 0.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_DLinear_UEA_ftM_sl29_ll0_pl0_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.404361248016357
Epoch: 1, Steps: 17 | Train Loss: 2.120 Vali Loss: 2.115 Vali Acc: 0.262 Test Loss: 2.115 Test Acc: 0.262
Validation loss decreased (inf --> -0.262141).  Saving model ...
Epoch: 2 cost time: 1.9928719997406006
Epoch: 2, Steps: 17 | Train Loss: 2.034 Vali Loss: 2.011 Vali Acc: 0.308 Test Loss: 2.011 Test Acc: 0.308
Validation loss decreased (-0.262141 --> -0.308088).  Saving model ...
Epoch: 3 cost time: 1.747474193572998
Epoch: 3, Steps: 17 | Train Loss: 1.906 Vali Loss: 1.874 Vali Acc: 0.400 Test Loss: 1.874 Test Acc: 0.400
Validation loss decreased (-0.308088 --> -0.399981).  Saving model ...
Epoch: 4 cost time: 2.0812604427337646
Epoch: 4, Steps: 17 | Train Loss: 1.752 Vali Loss: 1.712 Vali Acc: 0.557 Test Loss: 1.712 Test Acc: 0.557
Validation loss decreased (-0.399981 --> -0.556740).  Saving model ...
Epoch: 5 cost time: 2.042778730392456
Epoch: 5, Steps: 17 | Train Loss: 1.571 Vali Loss: 1.534 Vali Acc: 0.657 Test Loss: 1.534 Test Acc: 0.657
Validation loss decreased (-0.556740 --> -0.656741).  Saving model ...
Epoch: 6 cost time: 1.8718435764312744
Epoch: 6, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.340 Vali Acc: 0.741 Test Loss: 1.340 Test Acc: 0.741
Validation loss decreased (-0.656741 --> -0.740527).  Saving model ...
Epoch: 7 cost time: 2.0002756118774414
Epoch: 7, Steps: 17 | Train Loss: 1.190 Vali Loss: 1.151 Vali Acc: 0.773 Test Loss: 1.151 Test Acc: 0.773
Validation loss decreased (-0.740527 --> -0.772961).  Saving model ...
Epoch: 8 cost time: 1.7583563327789307
Epoch: 8, Steps: 17 | Train Loss: 1.010 Vali Loss: 0.984 Vali Acc: 0.819 Test Loss: 0.984 Test Acc: 0.819
Validation loss decreased (-0.772961 --> -0.818909).  Saving model ...
Epoch: 9 cost time: 1.860562801361084
Epoch: 9, Steps: 17 | Train Loss: 0.854 Vali Loss: 0.834 Vali Acc: 0.859 Test Loss: 0.834 Test Acc: 0.859
Validation loss decreased (-0.818909 --> -0.859451).  Saving model ...
Epoch: 10 cost time: 1.569453239440918
Epoch: 10, Steps: 17 | Train Loss: 0.721 Vali Loss: 0.708 Vali Acc: 0.876 Test Loss: 0.708 Test Acc: 0.876
Validation loss decreased (-0.859451 --> -0.875669).  Saving model ...
Epoch: 11 cost time: 1.8692495822906494
Epoch: 11, Steps: 17 | Train Loss: 0.612 Vali Loss: 0.609 Vali Acc: 0.892 Test Loss: 0.609 Test Acc: 0.892
Validation loss decreased (-0.875669 --> -0.891886).  Saving model ...
Epoch: 12 cost time: 1.7386682033538818
Epoch: 12, Steps: 17 | Train Loss: 0.525 Vali Loss: 0.528 Vali Acc: 0.905 Test Loss: 0.528 Test Acc: 0.905
Validation loss decreased (-0.891886 --> -0.905400).  Saving model ...
Epoch: 13 cost time: 1.7370834350585938
Epoch: 13, Steps: 17 | Train Loss: 0.456 Vali Loss: 0.466 Vali Acc: 0.914 Test Loss: 0.466 Test Acc: 0.914
Validation loss decreased (-0.905400 --> -0.913509).  Saving model ...
Epoch: 14 cost time: 1.8310112953186035
Epoch: 14, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.411 Vali Acc: 0.924 Test Loss: 0.411 Test Acc: 0.924
Validation loss decreased (-0.913509 --> -0.924320).  Saving model ...
Epoch: 15 cost time: 1.5555064678192139
Epoch: 15, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.370 Vali Acc: 0.930 Test Loss: 0.370 Test Acc: 0.930
Validation loss decreased (-0.924320 --> -0.929726).  Saving model ...
Epoch: 16 cost time: 1.6666591167449951
Epoch: 16, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.332 Vali Acc: 0.932 Test Loss: 0.332 Test Acc: 0.932
Validation loss decreased (-0.929726 --> -0.932429).  Saving model ...
Epoch: 17 cost time: 1.7802491188049316
Epoch: 17, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.303 Vali Acc: 0.932 Test Loss: 0.303 Test Acc: 0.932
Validation loss decreased (-0.932429 --> -0.932429).  Saving model ...
Epoch: 18 cost time: 1.623373031616211
Epoch: 18, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.277 Vali Acc: 0.935 Test Loss: 0.277 Test Acc: 0.935
Validation loss decreased (-0.932429 --> -0.935132).  Saving model ...
Epoch: 19 cost time: 1.7260780334472656
Epoch: 19, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.255 Vali Acc: 0.946 Test Loss: 0.255 Test Acc: 0.946
Validation loss decreased (-0.935132 --> -0.945943).  Saving model ...
Epoch: 20 cost time: 1.8210623264312744
Epoch: 20, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.236 Vali Acc: 0.946 Test Loss: 0.236 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945944).  Saving model ...
Epoch: 21 cost time: 1.7443695068359375
Epoch: 21, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.221 Vali Acc: 0.946 Test Loss: 0.221 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 22 cost time: 1.6448545455932617
Epoch: 22, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.208 Vali Acc: 0.946 Test Loss: 0.208 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 23 cost time: 1.845780372619629
Epoch: 23, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.195 Vali Acc: 0.949 Test Loss: 0.195 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 24 cost time: 1.9794297218322754
Epoch: 24, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.186 Vali Acc: 0.949 Test Loss: 0.186 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 25 cost time: 2.2955684661865234
Epoch: 25, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.179 Vali Acc: 0.954 Test Loss: 0.179 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 26 cost time: 1.776411771774292
Epoch: 26, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.172 Vali Acc: 0.954 Test Loss: 0.172 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 27 cost time: 1.8626880645751953
Epoch: 27, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.167 Vali Acc: 0.957 Test Loss: 0.167 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 28 cost time: 2.1638786792755127
Epoch: 28, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 29 cost time: 1.5651988983154297
Epoch: 29, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.9178147315979004
Epoch: 30, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.151 Vali Acc: 0.959 Test Loss: 0.151 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 31 cost time: 2.078474998474121
Epoch: 31, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.149 Vali Acc: 0.959 Test Loss: 0.149 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 32 cost time: 1.8185718059539795
Epoch: 32, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.143 Vali Acc: 0.959 Test Loss: 0.143 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 33 cost time: 2.3043110370635986
Epoch: 33, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.141 Vali Acc: 0.959 Test Loss: 0.141 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 34 cost time: 2.376828908920288
Epoch: 34, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 35 cost time: 1.800976276397705
Epoch: 35, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 36 cost time: 1.8509225845336914
Epoch: 36, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 37 cost time: 1.8948533535003662
Epoch: 37, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 38 cost time: 1.6250889301300049
Epoch: 38, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 39 cost time: 1.5781702995300293
Epoch: 39, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.2338430881500244
Epoch: 40, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.7857964038848877
Epoch: 41, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.9100966453552246
Epoch: 42, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.7809748649597168
Epoch: 43, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.649703025817871
Epoch: 44, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.9186861515045166
Epoch: 45, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.7008264064788818
Epoch: 46, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.6804211139678955
Epoch: 47, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.8893778324127197
Epoch: 48, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_DLinear_UEA_ftM_sl29_ll0_pl0_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 4881
model size : 0.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_DLinear_UEA_ftM_sl29_ll0_pl0_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.7864272594451904
Epoch: 1, Steps: 17 | Train Loss: 2.120 Vali Loss: 2.115 Vali Acc: 0.262 Test Loss: 2.115 Test Acc: 0.262
Validation loss decreased (inf --> -0.262141).  Saving model ...
Epoch: 2 cost time: 1.5245246887207031
Epoch: 2, Steps: 17 | Train Loss: 2.034 Vali Loss: 2.013 Vali Acc: 0.308 Test Loss: 2.013 Test Acc: 0.308
Validation loss decreased (-0.262141 --> -0.308088).  Saving model ...
Epoch: 3 cost time: 1.529064655303955
Epoch: 3, Steps: 17 | Train Loss: 1.908 Vali Loss: 1.877 Vali Acc: 0.395 Test Loss: 1.877 Test Acc: 0.395
Validation loss decreased (-0.308088 --> -0.394576).  Saving model ...
Epoch: 4 cost time: 1.681833028793335
Epoch: 4, Steps: 17 | Train Loss: 1.755 Vali Loss: 1.717 Vali Acc: 0.557 Test Loss: 1.717 Test Acc: 0.557
Validation loss decreased (-0.394576 --> -0.556740).  Saving model ...
Epoch: 5 cost time: 1.396970510482788
Epoch: 5, Steps: 17 | Train Loss: 1.577 Vali Loss: 1.541 Vali Acc: 0.657 Test Loss: 1.541 Test Acc: 0.657
Validation loss decreased (-0.556740 --> -0.656741).  Saving model ...
Epoch: 6 cost time: 1.4705209732055664
Epoch: 6, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.350 Vali Acc: 0.741 Test Loss: 1.350 Test Acc: 0.741
Validation loss decreased (-0.656741 --> -0.740527).  Saving model ...
Epoch: 7 cost time: 1.6224219799041748
Epoch: 7, Steps: 17 | Train Loss: 1.202 Vali Loss: 1.164 Vali Acc: 0.773 Test Loss: 1.164 Test Acc: 0.773
Validation loss decreased (-0.740527 --> -0.772961).  Saving model ...
Epoch: 8 cost time: 1.3782837390899658
Epoch: 8, Steps: 17 | Train Loss: 1.023 Vali Loss: 0.998 Vali Acc: 0.811 Test Loss: 0.998 Test Acc: 0.811
Validation loss decreased (-0.772961 --> -0.810801).  Saving model ...
Epoch: 9 cost time: 1.6009619235992432
Epoch: 9, Steps: 17 | Train Loss: 0.868 Vali Loss: 0.849 Vali Acc: 0.857 Test Loss: 0.849 Test Acc: 0.857
Validation loss decreased (-0.810801 --> -0.856748).  Saving model ...
Epoch: 10 cost time: 1.576685905456543
Epoch: 10, Steps: 17 | Train Loss: 0.736 Vali Loss: 0.723 Vali Acc: 0.868 Test Loss: 0.723 Test Acc: 0.868
Validation loss decreased (-0.856748 --> -0.867560).  Saving model ...
Epoch: 11 cost time: 1.5942192077636719
Epoch: 11, Steps: 17 | Train Loss: 0.627 Vali Loss: 0.624 Vali Acc: 0.886 Test Loss: 0.624 Test Acc: 0.886
Validation loss decreased (-0.867560 --> -0.886480).  Saving model ...
Epoch: 12 cost time: 1.638916015625
Epoch: 12, Steps: 17 | Train Loss: 0.539 Vali Loss: 0.542 Vali Acc: 0.900 Test Loss: 0.542 Test Acc: 0.900
Validation loss decreased (-0.886480 --> -0.899995).  Saving model ...
Epoch: 13 cost time: 1.5170695781707764
Epoch: 13, Steps: 17 | Train Loss: 0.470 Vali Loss: 0.479 Vali Acc: 0.911 Test Loss: 0.479 Test Acc: 0.911
Validation loss decreased (-0.899995 --> -0.910806).  Saving model ...
Epoch: 14 cost time: 1.4188506603240967
Epoch: 14, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.424 Vali Acc: 0.919 Test Loss: 0.424 Test Acc: 0.919
Validation loss decreased (-0.910806 --> -0.918915).  Saving model ...
Epoch: 15 cost time: 1.3785877227783203
Epoch: 15, Steps: 17 | Train Loss: 0.367 Vali Loss: 0.383 Vali Acc: 0.927 Test Loss: 0.383 Test Acc: 0.927
Validation loss decreased (-0.918915 --> -0.927023).  Saving model ...
Epoch: 16 cost time: 1.2731754779815674
Epoch: 16, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.345 Vali Acc: 0.930 Test Loss: 0.345 Test Acc: 0.930
Validation loss decreased (-0.927023 --> -0.929726).  Saving model ...
Epoch: 17 cost time: 1.3490345478057861
Epoch: 17, Steps: 17 | Train Loss: 0.293 Vali Loss: 0.315 Vali Acc: 0.927 Test Loss: 0.315 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5166912078857422
Epoch: 18, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.289 Vali Acc: 0.935 Test Loss: 0.289 Test Acc: 0.935
Validation loss decreased (-0.929726 --> -0.935132).  Saving model ...
Epoch: 19 cost time: 1.708191156387329
Epoch: 19, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.266 Vali Acc: 0.935 Test Loss: 0.266 Test Acc: 0.935
Validation loss decreased (-0.935132 --> -0.935132).  Saving model ...
Epoch: 20 cost time: 1.5029776096343994
Epoch: 20, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.247 Vali Acc: 0.943 Test Loss: 0.247 Test Acc: 0.943
Validation loss decreased (-0.935132 --> -0.943241).  Saving model ...
Epoch: 21 cost time: 1.5329980850219727
Epoch: 21, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.232 Vali Acc: 0.946 Test Loss: 0.232 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 22 cost time: 1.540813684463501
Epoch: 22, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.219 Vali Acc: 0.946 Test Loss: 0.219 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 23 cost time: 1.4469845294952393
Epoch: 23, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.205 Vali Acc: 0.949 Test Loss: 0.205 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 24 cost time: 1.4535744190216064
Epoch: 24, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.196 Vali Acc: 0.949 Test Loss: 0.196 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 25 cost time: 1.4657566547393799
Epoch: 25, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.188 Vali Acc: 0.951 Test Loss: 0.188 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951349).  Saving model ...
Epoch: 26 cost time: 1.4026808738708496
Epoch: 26, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.181 Vali Acc: 0.951 Test Loss: 0.181 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951350).  Saving model ...
Epoch: 27 cost time: 1.4687154293060303
Epoch: 27, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.176 Vali Acc: 0.954 Test Loss: 0.176 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 28 cost time: 1.6972379684448242
Epoch: 28, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.167 Vali Acc: 0.957 Test Loss: 0.167 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 29 cost time: 1.5284476280212402
Epoch: 29, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3952915668487549
Epoch: 30, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 31 cost time: 1.5688512325286865
Epoch: 31, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 32 cost time: 1.466456413269043
Epoch: 32, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 33 cost time: 1.5546047687530518
Epoch: 33, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 34 cost time: 1.4723985195159912
Epoch: 34, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.548353672027588
Epoch: 35, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 36 cost time: 1.9520890712738037
Epoch: 36, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 37 cost time: 1.5988860130310059
Epoch: 37, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.141 Vali Acc: 0.959 Test Loss: 0.141 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 38 cost time: 1.6390364170074463
Epoch: 38, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.140 Vali Acc: 0.959 Test Loss: 0.140 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 39 cost time: 1.4200379848480225
Epoch: 39, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 40 cost time: 1.769240379333496
Epoch: 40, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 41 cost time: 1.2401366233825684
Epoch: 41, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.5159530639648438
Epoch: 42, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.6427552700042725
Epoch: 43, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.559622049331665
Epoch: 44, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 45 cost time: 1.5231983661651611
Epoch: 45, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.7651269435882568
Epoch: 46, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.133 Vali Acc: 0.957 Test Loss: 0.133 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.672478199005127
Epoch: 47, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.3560237884521484
Epoch: 48, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.5166523456573486
Epoch: 49, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.5102076530456543
Epoch: 50, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.317317247390747
Epoch: 51, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.130 Vali Acc: 0.957 Test Loss: 0.130 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.3083994388580322
Epoch: 52, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.130 Vali Acc: 0.957 Test Loss: 0.130 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.6018080711364746
Epoch: 53, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.131 Vali Acc: 0.957 Test Loss: 0.131 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.3034584522247314
Epoch: 54, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.130 Vali Acc: 0.957 Test Loss: 0.130 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_DLinear_UEA_ftM_sl29_ll0_pl0_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 4881
model size : 0.02MB
