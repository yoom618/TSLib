Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         50                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_DLinear_UEA_ftM_sl100_ll0_pl0_ma50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.849501132965088
Epoch: 1, Steps: 3 | Train Loss: 1.392 Vali Loss: 1.398 Vali Acc: 0.100 Test Loss: 1.398 Test Acc: 0.100
Validation loss decreased (inf --> -0.099986).  Saving model ...
Epoch: 2 cost time: 0.48167991638183594
Epoch: 2, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.381 Vali Acc: 0.275 Test Loss: 1.381 Test Acc: 0.275
Validation loss decreased (-0.099986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.4965970516204834
Epoch: 3, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.368 Vali Acc: 0.375 Test Loss: 1.368 Test Acc: 0.375
Validation loss decreased (-0.274986 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 0.534576416015625
Epoch: 4, Steps: 3 | Train Loss: 1.324 Vali Loss: 1.349 Vali Acc: 0.375 Test Loss: 1.349 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.6483306884765625
Epoch: 5, Steps: 3 | Train Loss: 1.302 Vali Loss: 1.327 Vali Acc: 0.525 Test Loss: 1.327 Test Acc: 0.525
Validation loss decreased (-0.374987 --> -0.524987).  Saving model ...
Epoch: 6 cost time: 0.5606346130371094
Epoch: 6, Steps: 3 | Train Loss: 1.274 Vali Loss: 1.303 Vali Acc: 0.625 Test Loss: 1.303 Test Acc: 0.625
Validation loss decreased (-0.524987 --> -0.624987).  Saving model ...
Epoch: 7 cost time: 0.5558357238769531
Epoch: 7, Steps: 3 | Train Loss: 1.234 Vali Loss: 1.276 Vali Acc: 0.650 Test Loss: 1.276 Test Acc: 0.650
Validation loss decreased (-0.624987 --> -0.649987).  Saving model ...
Epoch: 8 cost time: 0.5761399269104004
Epoch: 8, Steps: 3 | Train Loss: 1.191 Vali Loss: 1.248 Vali Acc: 0.650 Test Loss: 1.248 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649988).  Saving model ...
Epoch: 9 cost time: 0.5266890525817871
Epoch: 9, Steps: 3 | Train Loss: 1.160 Vali Loss: 1.219 Vali Acc: 0.675 Test Loss: 1.219 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674988).  Saving model ...
Epoch: 10 cost time: 0.450239896774292
Epoch: 10, Steps: 3 | Train Loss: 1.109 Vali Loss: 1.189 Vali Acc: 0.675 Test Loss: 1.189 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 11 cost time: 0.46564650535583496
Epoch: 11, Steps: 3 | Train Loss: 1.076 Vali Loss: 1.158 Vali Acc: 0.675 Test Loss: 1.158 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 12 cost time: 0.5874049663543701
Epoch: 12, Steps: 3 | Train Loss: 1.062 Vali Loss: 1.127 Vali Acc: 0.675 Test Loss: 1.127 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674989).  Saving model ...
Epoch: 13 cost time: 0.5140769481658936
Epoch: 13, Steps: 3 | Train Loss: 0.981 Vali Loss: 1.097 Vali Acc: 0.700 Test Loss: 1.097 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 14 cost time: 0.5708942413330078
Epoch: 14, Steps: 3 | Train Loss: 0.938 Vali Loss: 1.067 Vali Acc: 0.700 Test Loss: 1.067 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 15 cost time: 0.6528966426849365
Epoch: 15, Steps: 3 | Train Loss: 0.908 Vali Loss: 1.038 Vali Acc: 0.700 Test Loss: 1.038 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699990).  Saving model ...
Epoch: 16 cost time: 0.8402674198150635
Epoch: 16, Steps: 3 | Train Loss: 0.866 Vali Loss: 1.010 Vali Acc: 0.725 Test Loss: 1.010 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 17 cost time: 0.632035493850708
Epoch: 17, Steps: 3 | Train Loss: 0.836 Vali Loss: 0.982 Vali Acc: 0.750 Test Loss: 0.982 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 18 cost time: 0.7136032581329346
Epoch: 18, Steps: 3 | Train Loss: 0.785 Vali Loss: 0.956 Vali Acc: 0.750 Test Loss: 0.956 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 19 cost time: 0.5296506881713867
Epoch: 19, Steps: 3 | Train Loss: 0.742 Vali Loss: 0.930 Vali Acc: 0.750 Test Loss: 0.930 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 20 cost time: 0.5461986064910889
Epoch: 20, Steps: 3 | Train Loss: 0.744 Vali Loss: 0.905 Vali Acc: 0.750 Test Loss: 0.905 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 21 cost time: 0.6759727001190186
Epoch: 21, Steps: 3 | Train Loss: 0.701 Vali Loss: 0.882 Vali Acc: 0.750 Test Loss: 0.882 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 22 cost time: 0.7381134033203125
Epoch: 22, Steps: 3 | Train Loss: 0.666 Vali Loss: 0.860 Vali Acc: 0.750 Test Loss: 0.860 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 23 cost time: 0.674304723739624
Epoch: 23, Steps: 3 | Train Loss: 0.652 Vali Loss: 0.838 Vali Acc: 0.800 Test Loss: 0.838 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799992).  Saving model ...
Epoch: 24 cost time: 0.6004278659820557
Epoch: 24, Steps: 3 | Train Loss: 0.629 Vali Loss: 0.818 Vali Acc: 0.800 Test Loss: 0.818 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 25 cost time: 0.7035062313079834
Epoch: 25, Steps: 3 | Train Loss: 0.597 Vali Loss: 0.799 Vali Acc: 0.800 Test Loss: 0.799 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 26 cost time: 0.6501185894012451
Epoch: 26, Steps: 3 | Train Loss: 0.570 Vali Loss: 0.781 Vali Acc: 0.825 Test Loss: 0.781 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 27 cost time: 0.5228557586669922
Epoch: 27, Steps: 3 | Train Loss: 0.583 Vali Loss: 0.765 Vali Acc: 0.825 Test Loss: 0.765 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 28 cost time: 0.6541073322296143
Epoch: 28, Steps: 3 | Train Loss: 0.537 Vali Loss: 0.749 Vali Acc: 0.850 Test Loss: 0.749 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 29 cost time: 0.6108577251434326
Epoch: 29, Steps: 3 | Train Loss: 0.536 Vali Loss: 0.735 Vali Acc: 0.850 Test Loss: 0.735 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 30 cost time: 0.6347687244415283
Epoch: 30, Steps: 3 | Train Loss: 0.503 Vali Loss: 0.720 Vali Acc: 0.850 Test Loss: 0.720 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 31 cost time: 0.6087148189544678
Epoch: 31, Steps: 3 | Train Loss: 0.496 Vali Loss: 0.707 Vali Acc: 0.850 Test Loss: 0.707 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 32 cost time: 0.680612325668335
Epoch: 32, Steps: 3 | Train Loss: 0.468 Vali Loss: 0.694 Vali Acc: 0.850 Test Loss: 0.694 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 33 cost time: 0.7190113067626953
Epoch: 33, Steps: 3 | Train Loss: 0.449 Vali Loss: 0.683 Vali Acc: 0.850 Test Loss: 0.683 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 34 cost time: 0.5955758094787598
Epoch: 34, Steps: 3 | Train Loss: 0.450 Vali Loss: 0.672 Vali Acc: 0.850 Test Loss: 0.672 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 35 cost time: 0.6640214920043945
Epoch: 35, Steps: 3 | Train Loss: 0.425 Vali Loss: 0.662 Vali Acc: 0.850 Test Loss: 0.662 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 36 cost time: 0.7895381450653076
Epoch: 36, Steps: 3 | Train Loss: 0.421 Vali Loss: 0.652 Vali Acc: 0.850 Test Loss: 0.652 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 37 cost time: 0.7269601821899414
Epoch: 37, Steps: 3 | Train Loss: 0.377 Vali Loss: 0.643 Vali Acc: 0.850 Test Loss: 0.643 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 38 cost time: 0.788811206817627
Epoch: 38, Steps: 3 | Train Loss: 0.372 Vali Loss: 0.635 Vali Acc: 0.850 Test Loss: 0.635 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 39 cost time: 0.7584652900695801
Epoch: 39, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.627 Vali Acc: 0.850 Test Loss: 0.627 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 40 cost time: 0.65740966796875
Epoch: 40, Steps: 3 | Train Loss: 0.370 Vali Loss: 0.620 Vali Acc: 0.850 Test Loss: 0.620 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 41 cost time: 0.691420316696167
Epoch: 41, Steps: 3 | Train Loss: 0.369 Vali Loss: 0.613 Vali Acc: 0.850 Test Loss: 0.613 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 42 cost time: 0.721776008605957
Epoch: 42, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.606 Vali Acc: 0.850 Test Loss: 0.606 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 43 cost time: 0.9137518405914307
Epoch: 43, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.600 Vali Acc: 0.850 Test Loss: 0.600 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 44 cost time: 0.89742112159729
Epoch: 44, Steps: 3 | Train Loss: 0.326 Vali Loss: 0.595 Vali Acc: 0.875 Test Loss: 0.595 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 45 cost time: 0.8073272705078125
Epoch: 45, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.590 Vali Acc: 0.875 Test Loss: 0.590 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 46 cost time: 0.7208456993103027
Epoch: 46, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.585 Vali Acc: 0.875 Test Loss: 0.585 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 47 cost time: 0.8364953994750977
Epoch: 47, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.581 Vali Acc: 0.875 Test Loss: 0.581 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 48 cost time: 0.9144372940063477
Epoch: 48, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.577 Vali Acc: 0.875 Test Loss: 0.577 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 49 cost time: 0.9845764636993408
Epoch: 49, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.573 Vali Acc: 0.875 Test Loss: 0.573 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 50 cost time: 0.8019673824310303
Epoch: 50, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.569 Vali Acc: 0.875 Test Loss: 0.569 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 51 cost time: 0.8476216793060303
Epoch: 51, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.566 Vali Acc: 0.875 Test Loss: 0.566 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 52 cost time: 0.7887461185455322
Epoch: 52, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.562 Vali Acc: 0.875 Test Loss: 0.562 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 53 cost time: 0.8860750198364258
Epoch: 53, Steps: 3 | Train Loss: 0.254 Vali Loss: 0.559 Vali Acc: 0.875 Test Loss: 0.559 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 54 cost time: 0.7692601680755615
Epoch: 54, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.557 Vali Acc: 0.875 Test Loss: 0.557 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 55 cost time: 0.7506747245788574
Epoch: 55, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.555 Vali Acc: 0.875 Test Loss: 0.555 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 56 cost time: 0.6711390018463135
Epoch: 56, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.554 Vali Acc: 0.875 Test Loss: 0.554 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 57 cost time: 0.8997793197631836
Epoch: 57, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.553 Vali Acc: 0.875 Test Loss: 0.553 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 58 cost time: 0.6150810718536377
Epoch: 58, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.552 Vali Acc: 0.850 Test Loss: 0.552 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.8410050868988037
Epoch: 59, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.551 Vali Acc: 0.850 Test Loss: 0.551 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.7065403461456299
Epoch: 60, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.551 Vali Acc: 0.850 Test Loss: 0.551 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.741518497467041
Epoch: 61, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.551 Vali Acc: 0.850 Test Loss: 0.551 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.7066247463226318
Epoch: 62, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.551 Vali Acc: 0.850 Test Loss: 0.551 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.8191089630126953
Epoch: 63, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.552 Vali Acc: 0.850 Test Loss: 0.552 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.8544039726257324
Epoch: 64, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.553 Vali Acc: 0.850 Test Loss: 0.553 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 0.7520840167999268
Epoch: 65, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.554 Vali Acc: 0.850 Test Loss: 0.554 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 0.9199814796447754
Epoch: 66, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.557 Vali Acc: 0.850 Test Loss: 0.557 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 0.7288165092468262
Epoch: 67, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.559 Vali Acc: 0.850 Test Loss: 0.559 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_DLinear_UEA_ftM_sl100_ll0_pl0_ma50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 22604
model size : 0.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         45                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_DLinear_UEA_ftM_sl100_ll0_pl0_ma45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.1062910556793213
Epoch: 1, Steps: 3 | Train Loss: 1.392 Vali Loss: 1.398 Vali Acc: 0.100 Test Loss: 1.398 Test Acc: 0.100
Validation loss decreased (inf --> -0.099986).  Saving model ...
Epoch: 2 cost time: 0.7234518527984619
Epoch: 2, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.381 Vali Acc: 0.275 Test Loss: 1.381 Test Acc: 0.275
Validation loss decreased (-0.099986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.8299987316131592
Epoch: 3, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.368 Vali Acc: 0.375 Test Loss: 1.368 Test Acc: 0.375
Validation loss decreased (-0.274986 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 0.7905833721160889
Epoch: 4, Steps: 3 | Train Loss: 1.324 Vali Loss: 1.349 Vali Acc: 0.375 Test Loss: 1.349 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.7741580009460449
Epoch: 5, Steps: 3 | Train Loss: 1.301 Vali Loss: 1.327 Vali Acc: 0.550 Test Loss: 1.327 Test Acc: 0.550
Validation loss decreased (-0.374987 --> -0.549987).  Saving model ...
Epoch: 6 cost time: 0.9731099605560303
Epoch: 6, Steps: 3 | Train Loss: 1.274 Vali Loss: 1.302 Vali Acc: 0.625 Test Loss: 1.302 Test Acc: 0.625
Validation loss decreased (-0.549987 --> -0.624987).  Saving model ...
Epoch: 7 cost time: 1.1715805530548096
Epoch: 7, Steps: 3 | Train Loss: 1.233 Vali Loss: 1.276 Vali Acc: 0.650 Test Loss: 1.276 Test Acc: 0.650
Validation loss decreased (-0.624987 --> -0.649987).  Saving model ...
Epoch: 8 cost time: 1.0918638706207275
Epoch: 8, Steps: 3 | Train Loss: 1.190 Vali Loss: 1.248 Vali Acc: 0.650 Test Loss: 1.248 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649988).  Saving model ...
Epoch: 9 cost time: 1.2462260723114014
Epoch: 9, Steps: 3 | Train Loss: 1.159 Vali Loss: 1.218 Vali Acc: 0.675 Test Loss: 1.218 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674988).  Saving model ...
Epoch: 10 cost time: 0.8113682270050049
Epoch: 10, Steps: 3 | Train Loss: 1.108 Vali Loss: 1.188 Vali Acc: 0.675 Test Loss: 1.188 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 11 cost time: 0.9595658779144287
Epoch: 11, Steps: 3 | Train Loss: 1.075 Vali Loss: 1.157 Vali Acc: 0.675 Test Loss: 1.157 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 12 cost time: 0.6756417751312256
Epoch: 12, Steps: 3 | Train Loss: 1.061 Vali Loss: 1.126 Vali Acc: 0.650 Test Loss: 1.126 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9229922294616699
Epoch: 13, Steps: 3 | Train Loss: 0.979 Vali Loss: 1.096 Vali Acc: 0.675 Test Loss: 1.096 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674989).  Saving model ...
Epoch: 14 cost time: 0.8993844985961914
Epoch: 14, Steps: 3 | Train Loss: 0.935 Vali Loss: 1.066 Vali Acc: 0.675 Test Loss: 1.066 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 15 cost time: 0.8661496639251709
Epoch: 15, Steps: 3 | Train Loss: 0.906 Vali Loss: 1.037 Vali Acc: 0.700 Test Loss: 1.037 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699990).  Saving model ...
Epoch: 16 cost time: 0.8806500434875488
Epoch: 16, Steps: 3 | Train Loss: 0.865 Vali Loss: 1.008 Vali Acc: 0.725 Test Loss: 1.008 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 17 cost time: 0.9984872341156006
Epoch: 17, Steps: 3 | Train Loss: 0.834 Vali Loss: 0.981 Vali Acc: 0.750 Test Loss: 0.981 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 18 cost time: 1.2650623321533203
Epoch: 18, Steps: 3 | Train Loss: 0.784 Vali Loss: 0.954 Vali Acc: 0.750 Test Loss: 0.954 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 19 cost time: 1.0257267951965332
Epoch: 19, Steps: 3 | Train Loss: 0.741 Vali Loss: 0.928 Vali Acc: 0.775 Test Loss: 0.928 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774991).  Saving model ...
Epoch: 20 cost time: 0.8967516422271729
Epoch: 20, Steps: 3 | Train Loss: 0.742 Vali Loss: 0.903 Vali Acc: 0.775 Test Loss: 0.903 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 21 cost time: 0.9942173957824707
Epoch: 21, Steps: 3 | Train Loss: 0.699 Vali Loss: 0.880 Vali Acc: 0.800 Test Loss: 0.880 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 22 cost time: 0.9924640655517578
Epoch: 22, Steps: 3 | Train Loss: 0.664 Vali Loss: 0.858 Vali Acc: 0.800 Test Loss: 0.858 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 23 cost time: 0.8053743839263916
Epoch: 23, Steps: 3 | Train Loss: 0.650 Vali Loss: 0.837 Vali Acc: 0.800 Test Loss: 0.837 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 24 cost time: 0.9696037769317627
Epoch: 24, Steps: 3 | Train Loss: 0.627 Vali Loss: 0.816 Vali Acc: 0.800 Test Loss: 0.816 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 25 cost time: 0.8490841388702393
Epoch: 25, Steps: 3 | Train Loss: 0.596 Vali Loss: 0.797 Vali Acc: 0.800 Test Loss: 0.797 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 26 cost time: 0.8819215297698975
Epoch: 26, Steps: 3 | Train Loss: 0.568 Vali Loss: 0.780 Vali Acc: 0.825 Test Loss: 0.780 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 27 cost time: 0.774846076965332
Epoch: 27, Steps: 3 | Train Loss: 0.581 Vali Loss: 0.763 Vali Acc: 0.825 Test Loss: 0.763 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 28 cost time: 0.7728092670440674
Epoch: 28, Steps: 3 | Train Loss: 0.534 Vali Loss: 0.747 Vali Acc: 0.850 Test Loss: 0.747 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 29 cost time: 0.735149621963501
Epoch: 29, Steps: 3 | Train Loss: 0.534 Vali Loss: 0.733 Vali Acc: 0.850 Test Loss: 0.733 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 30 cost time: 0.7070443630218506
Epoch: 30, Steps: 3 | Train Loss: 0.501 Vali Loss: 0.719 Vali Acc: 0.850 Test Loss: 0.719 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 31 cost time: 0.6901223659515381
Epoch: 31, Steps: 3 | Train Loss: 0.494 Vali Loss: 0.705 Vali Acc: 0.850 Test Loss: 0.705 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 32 cost time: 0.6996004581451416
Epoch: 32, Steps: 3 | Train Loss: 0.466 Vali Loss: 0.693 Vali Acc: 0.850 Test Loss: 0.693 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 33 cost time: 0.7877213954925537
Epoch: 33, Steps: 3 | Train Loss: 0.446 Vali Loss: 0.681 Vali Acc: 0.850 Test Loss: 0.681 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 34 cost time: 0.8477165699005127
Epoch: 34, Steps: 3 | Train Loss: 0.447 Vali Loss: 0.670 Vali Acc: 0.850 Test Loss: 0.670 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 35 cost time: 0.8308084011077881
Epoch: 35, Steps: 3 | Train Loss: 0.422 Vali Loss: 0.660 Vali Acc: 0.850 Test Loss: 0.660 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 36 cost time: 0.9896080493927002
Epoch: 36, Steps: 3 | Train Loss: 0.419 Vali Loss: 0.651 Vali Acc: 0.850 Test Loss: 0.651 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 37 cost time: 1.0989136695861816
Epoch: 37, Steps: 3 | Train Loss: 0.375 Vali Loss: 0.642 Vali Acc: 0.850 Test Loss: 0.642 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 38 cost time: 0.7719626426696777
Epoch: 38, Steps: 3 | Train Loss: 0.369 Vali Loss: 0.633 Vali Acc: 0.850 Test Loss: 0.633 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 39 cost time: 0.8229584693908691
Epoch: 39, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.625 Vali Acc: 0.850 Test Loss: 0.625 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 40 cost time: 0.828209638595581
Epoch: 40, Steps: 3 | Train Loss: 0.367 Vali Loss: 0.618 Vali Acc: 0.850 Test Loss: 0.618 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 41 cost time: 0.7657077312469482
Epoch: 41, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.611 Vali Acc: 0.850 Test Loss: 0.611 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 42 cost time: 0.9153232574462891
Epoch: 42, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.605 Vali Acc: 0.850 Test Loss: 0.605 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 43 cost time: 0.8874948024749756
Epoch: 43, Steps: 3 | Train Loss: 0.344 Vali Loss: 0.599 Vali Acc: 0.850 Test Loss: 0.599 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 44 cost time: 0.86842942237854
Epoch: 44, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.593 Vali Acc: 0.875 Test Loss: 0.593 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 45 cost time: 0.7777161598205566
Epoch: 45, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.588 Vali Acc: 0.875 Test Loss: 0.588 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 46 cost time: 0.705268383026123
Epoch: 46, Steps: 3 | Train Loss: 0.313 Vali Loss: 0.583 Vali Acc: 0.875 Test Loss: 0.583 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 47 cost time: 0.7809450626373291
Epoch: 47, Steps: 3 | Train Loss: 0.300 Vali Loss: 0.579 Vali Acc: 0.875 Test Loss: 0.579 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 48 cost time: 0.8694770336151123
Epoch: 48, Steps: 3 | Train Loss: 0.278 Vali Loss: 0.575 Vali Acc: 0.875 Test Loss: 0.575 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 49 cost time: 0.7730505466461182
Epoch: 49, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.572 Vali Acc: 0.875 Test Loss: 0.572 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 50 cost time: 0.8836302757263184
Epoch: 50, Steps: 3 | Train Loss: 0.276 Vali Loss: 0.568 Vali Acc: 0.875 Test Loss: 0.568 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 51 cost time: 0.9738845825195312
Epoch: 51, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.564 Vali Acc: 0.875 Test Loss: 0.564 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 52 cost time: 0.8851869106292725
Epoch: 52, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.560 Vali Acc: 0.875 Test Loss: 0.560 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 53 cost time: 0.6883628368377686
Epoch: 53, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.558 Vali Acc: 0.875 Test Loss: 0.558 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 54 cost time: 0.8985466957092285
Epoch: 54, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.555 Vali Acc: 0.875 Test Loss: 0.555 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 55 cost time: 0.8756844997406006
Epoch: 55, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.553 Vali Acc: 0.875 Test Loss: 0.553 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 56 cost time: 0.728400468826294
Epoch: 56, Steps: 3 | Train Loss: 0.218 Vali Loss: 0.552 Vali Acc: 0.875 Test Loss: 0.552 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 57 cost time: 0.956383228302002
Epoch: 57, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.551 Vali Acc: 0.875 Test Loss: 0.551 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 58 cost time: 0.8085532188415527
Epoch: 58, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.550 Vali Acc: 0.850 Test Loss: 0.550 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.8610219955444336
Epoch: 59, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.550 Vali Acc: 0.850 Test Loss: 0.550 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.9540538787841797
Epoch: 60, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.549 Vali Acc: 0.850 Test Loss: 0.549 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.765547513961792
Epoch: 61, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.549 Vali Acc: 0.850 Test Loss: 0.549 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.7680225372314453
Epoch: 62, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.549 Vali Acc: 0.850 Test Loss: 0.549 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.7885406017303467
Epoch: 63, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.550 Vali Acc: 0.850 Test Loss: 0.550 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.9447479248046875
Epoch: 64, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.551 Vali Acc: 0.850 Test Loss: 0.551 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 0.9992859363555908
Epoch: 65, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.552 Vali Acc: 0.850 Test Loss: 0.552 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 0.916689395904541
Epoch: 66, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.554 Vali Acc: 0.850 Test Loss: 0.554 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 1.2040815353393555
Epoch: 67, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.556 Vali Acc: 0.850 Test Loss: 0.556 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_DLinear_UEA_ftM_sl100_ll0_pl0_ma45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 22604
model size : 0.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         40                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_DLinear_UEA_ftM_sl100_ll0_pl0_ma40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6946325302124023
Epoch: 1, Steps: 3 | Train Loss: 1.392 Vali Loss: 1.398 Vali Acc: 0.100 Test Loss: 1.398 Test Acc: 0.100
Validation loss decreased (inf --> -0.099986).  Saving model ...
Epoch: 2 cost time: 0.9879231452941895
Epoch: 2, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.381 Vali Acc: 0.275 Test Loss: 1.381 Test Acc: 0.275
Validation loss decreased (-0.099986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.9400801658630371
Epoch: 3, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.368 Vali Acc: 0.375 Test Loss: 1.368 Test Acc: 0.375
Validation loss decreased (-0.274986 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 0.9097781181335449
Epoch: 4, Steps: 3 | Train Loss: 1.324 Vali Loss: 1.349 Vali Acc: 0.375 Test Loss: 1.349 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.9793932437896729
Epoch: 5, Steps: 3 | Train Loss: 1.302 Vali Loss: 1.327 Vali Acc: 0.525 Test Loss: 1.327 Test Acc: 0.525
Validation loss decreased (-0.374987 --> -0.524987).  Saving model ...
Epoch: 6 cost time: 0.9129636287689209
Epoch: 6, Steps: 3 | Train Loss: 1.274 Vali Loss: 1.302 Vali Acc: 0.625 Test Loss: 1.302 Test Acc: 0.625
Validation loss decreased (-0.524987 --> -0.624987).  Saving model ...
Epoch: 7 cost time: 1.177642583847046
Epoch: 7, Steps: 3 | Train Loss: 1.234 Vali Loss: 1.276 Vali Acc: 0.650 Test Loss: 1.276 Test Acc: 0.650
Validation loss decreased (-0.624987 --> -0.649987).  Saving model ...
Epoch: 8 cost time: 0.953911542892456
Epoch: 8, Steps: 3 | Train Loss: 1.191 Vali Loss: 1.247 Vali Acc: 0.650 Test Loss: 1.247 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649988).  Saving model ...
Epoch: 9 cost time: 1.0247893333435059
Epoch: 9, Steps: 3 | Train Loss: 1.160 Vali Loss: 1.218 Vali Acc: 0.675 Test Loss: 1.218 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674988).  Saving model ...
Epoch: 10 cost time: 1.0906476974487305
Epoch: 10, Steps: 3 | Train Loss: 1.109 Vali Loss: 1.187 Vali Acc: 0.675 Test Loss: 1.187 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 11 cost time: 0.7799789905548096
Epoch: 11, Steps: 3 | Train Loss: 1.076 Vali Loss: 1.156 Vali Acc: 0.675 Test Loss: 1.156 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 12 cost time: 0.962153434753418
Epoch: 12, Steps: 3 | Train Loss: 1.062 Vali Loss: 1.126 Vali Acc: 0.675 Test Loss: 1.126 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674989).  Saving model ...
Epoch: 13 cost time: 1.1791157722473145
Epoch: 13, Steps: 3 | Train Loss: 0.981 Vali Loss: 1.095 Vali Acc: 0.700 Test Loss: 1.095 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 14 cost time: 1.0625228881835938
Epoch: 14, Steps: 3 | Train Loss: 0.939 Vali Loss: 1.065 Vali Acc: 0.700 Test Loss: 1.065 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 15 cost time: 0.8301761150360107
Epoch: 15, Steps: 3 | Train Loss: 0.909 Vali Loss: 1.036 Vali Acc: 0.700 Test Loss: 1.036 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699990).  Saving model ...
Epoch: 16 cost time: 0.8817729949951172
Epoch: 16, Steps: 3 | Train Loss: 0.867 Vali Loss: 1.007 Vali Acc: 0.750 Test Loss: 1.007 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749990).  Saving model ...
Epoch: 17 cost time: 0.8028542995452881
Epoch: 17, Steps: 3 | Train Loss: 0.836 Vali Loss: 0.979 Vali Acc: 0.750 Test Loss: 0.979 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 18 cost time: 0.9311652183532715
Epoch: 18, Steps: 3 | Train Loss: 0.786 Vali Loss: 0.952 Vali Acc: 0.775 Test Loss: 0.952 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774990).  Saving model ...
Epoch: 19 cost time: 0.9106800556182861
Epoch: 19, Steps: 3 | Train Loss: 0.742 Vali Loss: 0.926 Vali Acc: 0.775 Test Loss: 0.926 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 20 cost time: 1.237053394317627
Epoch: 20, Steps: 3 | Train Loss: 0.745 Vali Loss: 0.901 Vali Acc: 0.775 Test Loss: 0.901 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 21 cost time: 1.1284821033477783
Epoch: 21, Steps: 3 | Train Loss: 0.701 Vali Loss: 0.878 Vali Acc: 0.775 Test Loss: 0.878 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 22 cost time: 1.0042085647583008
Epoch: 22, Steps: 3 | Train Loss: 0.667 Vali Loss: 0.856 Vali Acc: 0.775 Test Loss: 0.856 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 23 cost time: 0.8689496517181396
Epoch: 23, Steps: 3 | Train Loss: 0.652 Vali Loss: 0.834 Vali Acc: 0.800 Test Loss: 0.834 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799992).  Saving model ...
Epoch: 24 cost time: 0.9225828647613525
Epoch: 24, Steps: 3 | Train Loss: 0.629 Vali Loss: 0.814 Vali Acc: 0.800 Test Loss: 0.814 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 25 cost time: 1.126298189163208
Epoch: 25, Steps: 3 | Train Loss: 0.598 Vali Loss: 0.794 Vali Acc: 0.800 Test Loss: 0.794 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 26 cost time: 1.3297057151794434
Epoch: 26, Steps: 3 | Train Loss: 0.570 Vali Loss: 0.777 Vali Acc: 0.825 Test Loss: 0.777 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 27 cost time: 0.8994333744049072
Epoch: 27, Steps: 3 | Train Loss: 0.583 Vali Loss: 0.760 Vali Acc: 0.825 Test Loss: 0.760 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 28 cost time: 1.1578974723815918
Epoch: 28, Steps: 3 | Train Loss: 0.537 Vali Loss: 0.744 Vali Acc: 0.850 Test Loss: 0.744 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 29 cost time: 1.0705981254577637
Epoch: 29, Steps: 3 | Train Loss: 0.536 Vali Loss: 0.729 Vali Acc: 0.850 Test Loss: 0.729 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 30 cost time: 1.0806224346160889
Epoch: 30, Steps: 3 | Train Loss: 0.503 Vali Loss: 0.715 Vali Acc: 0.850 Test Loss: 0.715 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 31 cost time: 1.2191050052642822
Epoch: 31, Steps: 3 | Train Loss: 0.495 Vali Loss: 0.701 Vali Acc: 0.850 Test Loss: 0.701 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 32 cost time: 1.062835454940796
Epoch: 32, Steps: 3 | Train Loss: 0.469 Vali Loss: 0.688 Vali Acc: 0.850 Test Loss: 0.688 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 33 cost time: 0.9449858665466309
Epoch: 33, Steps: 3 | Train Loss: 0.449 Vali Loss: 0.677 Vali Acc: 0.850 Test Loss: 0.677 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 34 cost time: 1.1613788604736328
Epoch: 34, Steps: 3 | Train Loss: 0.449 Vali Loss: 0.666 Vali Acc: 0.850 Test Loss: 0.666 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 35 cost time: 1.3267996311187744
Epoch: 35, Steps: 3 | Train Loss: 0.424 Vali Loss: 0.655 Vali Acc: 0.850 Test Loss: 0.655 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 36 cost time: 1.5187175273895264
Epoch: 36, Steps: 3 | Train Loss: 0.420 Vali Loss: 0.645 Vali Acc: 0.850 Test Loss: 0.645 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 37 cost time: 1.1593499183654785
Epoch: 37, Steps: 3 | Train Loss: 0.377 Vali Loss: 0.636 Vali Acc: 0.850 Test Loss: 0.636 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 38 cost time: 1.0662305355072021
Epoch: 38, Steps: 3 | Train Loss: 0.372 Vali Loss: 0.627 Vali Acc: 0.875 Test Loss: 0.627 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 39 cost time: 1.0760986804962158
Epoch: 39, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.619 Vali Acc: 0.875 Test Loss: 0.619 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 40 cost time: 1.35369873046875
Epoch: 40, Steps: 3 | Train Loss: 0.369 Vali Loss: 0.612 Vali Acc: 0.875 Test Loss: 0.612 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 41 cost time: 1.3823745250701904
Epoch: 41, Steps: 3 | Train Loss: 0.370 Vali Loss: 0.605 Vali Acc: 0.875 Test Loss: 0.605 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 42 cost time: 1.1640639305114746
Epoch: 42, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.598 Vali Acc: 0.875 Test Loss: 0.598 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 43 cost time: 1.2925970554351807
Epoch: 43, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.591 Vali Acc: 0.875 Test Loss: 0.591 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 44 cost time: 1.095818281173706
Epoch: 44, Steps: 3 | Train Loss: 0.326 Vali Loss: 0.586 Vali Acc: 0.875 Test Loss: 0.586 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 45 cost time: 1.136413812637329
Epoch: 45, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.580 Vali Acc: 0.875 Test Loss: 0.580 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 46 cost time: 1.1448564529418945
Epoch: 46, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.575 Vali Acc: 0.875 Test Loss: 0.575 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 47 cost time: 1.5835273265838623
Epoch: 47, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.570 Vali Acc: 0.875 Test Loss: 0.570 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 48 cost time: 1.0650897026062012
Epoch: 48, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.566 Vali Acc: 0.875 Test Loss: 0.566 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 49 cost time: 1.0483450889587402
Epoch: 49, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.562 Vali Acc: 0.875 Test Loss: 0.562 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 50 cost time: 1.0247225761413574
Epoch: 50, Steps: 3 | Train Loss: 0.278 Vali Loss: 0.557 Vali Acc: 0.875 Test Loss: 0.557 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 51 cost time: 0.9094598293304443
Epoch: 51, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.553 Vali Acc: 0.875 Test Loss: 0.553 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 52 cost time: 0.8292655944824219
Epoch: 52, Steps: 3 | Train Loss: 0.268 Vali Loss: 0.549 Vali Acc: 0.875 Test Loss: 0.549 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 53 cost time: 0.9188659191131592
Epoch: 53, Steps: 3 | Train Loss: 0.254 Vali Loss: 0.546 Vali Acc: 0.875 Test Loss: 0.546 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 54 cost time: 1.0304279327392578
Epoch: 54, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.543 Vali Acc: 0.875 Test Loss: 0.543 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 55 cost time: 1.040006160736084
Epoch: 55, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.541 Vali Acc: 0.875 Test Loss: 0.541 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 56 cost time: 1.0226852893829346
Epoch: 56, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.539 Vali Acc: 0.875 Test Loss: 0.539 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 57 cost time: 0.8763246536254883
Epoch: 57, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.537 Vali Acc: 0.875 Test Loss: 0.537 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 58 cost time: 1.1069140434265137
Epoch: 58, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.535 Vali Acc: 0.875 Test Loss: 0.535 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 59 cost time: 0.8715083599090576
Epoch: 59, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.534 Vali Acc: 0.875 Test Loss: 0.534 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 60 cost time: 0.9089059829711914
Epoch: 60, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.533 Vali Acc: 0.875 Test Loss: 0.533 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 61 cost time: 1.0063772201538086
Epoch: 61, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.533 Vali Acc: 0.875 Test Loss: 0.533 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 62 cost time: 0.9304542541503906
Epoch: 62, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.532 Vali Acc: 0.850 Test Loss: 0.532 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.1971430778503418
Epoch: 63, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.532 Vali Acc: 0.850 Test Loss: 0.532 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.2078332901000977
Epoch: 64, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.532 Vali Acc: 0.850 Test Loss: 0.532 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 1.1840674877166748
Epoch: 65, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.533 Vali Acc: 0.850 Test Loss: 0.533 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 1.1122167110443115
Epoch: 66, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.535 Vali Acc: 0.850 Test Loss: 0.535 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 1.0857195854187012
Epoch: 67, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.536 Vali Acc: 0.850 Test Loss: 0.536 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 1.0103952884674072
Epoch: 68, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.538 Vali Acc: 0.850 Test Loss: 0.538 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 1.1453142166137695
Epoch: 69, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.538 Vali Acc: 0.850 Test Loss: 0.538 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 1.3088593482971191
Epoch: 70, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.539 Vali Acc: 0.850 Test Loss: 0.539 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 1.0404503345489502
Epoch: 71, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.540 Vali Acc: 0.850 Test Loss: 0.540 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_DLinear_UEA_ftM_sl100_ll0_pl0_ma40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 22604
model size : 0.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         35                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_DLinear_UEA_ftM_sl100_ll0_pl0_ma35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.8692169189453125
Epoch: 1, Steps: 3 | Train Loss: 1.392 Vali Loss: 1.398 Vali Acc: 0.100 Test Loss: 1.398 Test Acc: 0.100
Validation loss decreased (inf --> -0.099986).  Saving model ...
Epoch: 2 cost time: 0.946831226348877
Epoch: 2, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.381 Vali Acc: 0.300 Test Loss: 1.381 Test Acc: 0.300
Validation loss decreased (-0.099986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 1.1210293769836426
Epoch: 3, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.367 Vali Acc: 0.375 Test Loss: 1.367 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 1.1666765213012695
Epoch: 4, Steps: 3 | Train Loss: 1.324 Vali Loss: 1.349 Vali Acc: 0.375 Test Loss: 1.349 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.9435338973999023
Epoch: 5, Steps: 3 | Train Loss: 1.302 Vali Loss: 1.327 Vali Acc: 0.525 Test Loss: 1.327 Test Acc: 0.525
Validation loss decreased (-0.374987 --> -0.524987).  Saving model ...
Epoch: 6 cost time: 0.9667482376098633
Epoch: 6, Steps: 3 | Train Loss: 1.275 Vali Loss: 1.302 Vali Acc: 0.650 Test Loss: 1.302 Test Acc: 0.650
Validation loss decreased (-0.524987 --> -0.649987).  Saving model ...
Epoch: 7 cost time: 0.9074528217315674
Epoch: 7, Steps: 3 | Train Loss: 1.234 Vali Loss: 1.275 Vali Acc: 0.650 Test Loss: 1.275 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 8 cost time: 0.8408396244049072
Epoch: 8, Steps: 3 | Train Loss: 1.192 Vali Loss: 1.247 Vali Acc: 0.650 Test Loss: 1.247 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649988).  Saving model ...
Epoch: 9 cost time: 0.9905874729156494
Epoch: 9, Steps: 3 | Train Loss: 1.161 Vali Loss: 1.218 Vali Acc: 0.650 Test Loss: 1.218 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 10 cost time: 0.9586188793182373
Epoch: 10, Steps: 3 | Train Loss: 1.110 Vali Loss: 1.187 Vali Acc: 0.675 Test Loss: 1.187 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674988).  Saving model ...
Epoch: 11 cost time: 1.0245044231414795
Epoch: 11, Steps: 3 | Train Loss: 1.078 Vali Loss: 1.157 Vali Acc: 0.675 Test Loss: 1.157 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 12 cost time: 0.9826009273529053
Epoch: 12, Steps: 3 | Train Loss: 1.064 Vali Loss: 1.126 Vali Acc: 0.675 Test Loss: 1.126 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674989).  Saving model ...
Epoch: 13 cost time: 0.854264497756958
Epoch: 13, Steps: 3 | Train Loss: 0.983 Vali Loss: 1.096 Vali Acc: 0.675 Test Loss: 1.096 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 14 cost time: 0.8990941047668457
Epoch: 14, Steps: 3 | Train Loss: 0.941 Vali Loss: 1.066 Vali Acc: 0.675 Test Loss: 1.066 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 15 cost time: 0.9328110218048096
Epoch: 15, Steps: 3 | Train Loss: 0.911 Vali Loss: 1.036 Vali Acc: 0.700 Test Loss: 1.036 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699990).  Saving model ...
Epoch: 16 cost time: 0.8950107097625732
Epoch: 16, Steps: 3 | Train Loss: 0.870 Vali Loss: 1.007 Vali Acc: 0.725 Test Loss: 1.007 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 17 cost time: 0.6676089763641357
Epoch: 17, Steps: 3 | Train Loss: 0.840 Vali Loss: 0.980 Vali Acc: 0.725 Test Loss: 0.980 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 18 cost time: 1.1262898445129395
Epoch: 18, Steps: 3 | Train Loss: 0.789 Vali Loss: 0.953 Vali Acc: 0.725 Test Loss: 0.953 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 19 cost time: 0.9538731575012207
Epoch: 19, Steps: 3 | Train Loss: 0.745 Vali Loss: 0.927 Vali Acc: 0.750 Test Loss: 0.927 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749991).  Saving model ...
Epoch: 20 cost time: 0.7946720123291016
Epoch: 20, Steps: 3 | Train Loss: 0.749 Vali Loss: 0.902 Vali Acc: 0.800 Test Loss: 0.902 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799991).  Saving model ...
Epoch: 21 cost time: 0.9076492786407471
Epoch: 21, Steps: 3 | Train Loss: 0.704 Vali Loss: 0.878 Vali Acc: 0.800 Test Loss: 0.878 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 22 cost time: 0.7719829082489014
Epoch: 22, Steps: 3 | Train Loss: 0.672 Vali Loss: 0.856 Vali Acc: 0.775 Test Loss: 0.856 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9721715450286865
Epoch: 23, Steps: 3 | Train Loss: 0.656 Vali Loss: 0.834 Vali Acc: 0.775 Test Loss: 0.834 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9724349975585938
Epoch: 24, Steps: 3 | Train Loss: 0.634 Vali Loss: 0.814 Vali Acc: 0.775 Test Loss: 0.814 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8361458778381348
Epoch: 25, Steps: 3 | Train Loss: 0.602 Vali Loss: 0.795 Vali Acc: 0.800 Test Loss: 0.795 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 26 cost time: 0.8486888408660889
Epoch: 26, Steps: 3 | Train Loss: 0.574 Vali Loss: 0.777 Vali Acc: 0.800 Test Loss: 0.777 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 27 cost time: 1.2030088901519775
Epoch: 27, Steps: 3 | Train Loss: 0.588 Vali Loss: 0.760 Vali Acc: 0.825 Test Loss: 0.760 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 28 cost time: 0.8773353099822998
Epoch: 28, Steps: 3 | Train Loss: 0.542 Vali Loss: 0.744 Vali Acc: 0.850 Test Loss: 0.744 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 29 cost time: 1.0724215507507324
Epoch: 29, Steps: 3 | Train Loss: 0.541 Vali Loss: 0.729 Vali Acc: 0.850 Test Loss: 0.729 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 30 cost time: 0.7154781818389893
Epoch: 30, Steps: 3 | Train Loss: 0.508 Vali Loss: 0.714 Vali Acc: 0.850 Test Loss: 0.714 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 31 cost time: 0.9327404499053955
Epoch: 31, Steps: 3 | Train Loss: 0.501 Vali Loss: 0.701 Vali Acc: 0.850 Test Loss: 0.701 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 32 cost time: 0.9486570358276367
Epoch: 32, Steps: 3 | Train Loss: 0.474 Vali Loss: 0.688 Vali Acc: 0.850 Test Loss: 0.688 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 33 cost time: 0.8725161552429199
Epoch: 33, Steps: 3 | Train Loss: 0.455 Vali Loss: 0.675 Vali Acc: 0.850 Test Loss: 0.675 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 34 cost time: 0.7702856063842773
Epoch: 34, Steps: 3 | Train Loss: 0.454 Vali Loss: 0.664 Vali Acc: 0.850 Test Loss: 0.664 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 35 cost time: 0.8812329769134521
Epoch: 35, Steps: 3 | Train Loss: 0.430 Vali Loss: 0.654 Vali Acc: 0.850 Test Loss: 0.654 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 36 cost time: 0.9060225486755371
Epoch: 36, Steps: 3 | Train Loss: 0.425 Vali Loss: 0.644 Vali Acc: 0.850 Test Loss: 0.644 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 37 cost time: 0.9467506408691406
Epoch: 37, Steps: 3 | Train Loss: 0.383 Vali Loss: 0.634 Vali Acc: 0.850 Test Loss: 0.634 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 38 cost time: 1.063964605331421
Epoch: 38, Steps: 3 | Train Loss: 0.378 Vali Loss: 0.625 Vali Acc: 0.850 Test Loss: 0.625 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 39 cost time: 0.7926795482635498
Epoch: 39, Steps: 3 | Train Loss: 0.381 Vali Loss: 0.617 Vali Acc: 0.875 Test Loss: 0.617 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 40 cost time: 0.7081470489501953
Epoch: 40, Steps: 3 | Train Loss: 0.376 Vali Loss: 0.609 Vali Acc: 0.875 Test Loss: 0.609 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 41 cost time: 0.8513185977935791
Epoch: 41, Steps: 3 | Train Loss: 0.377 Vali Loss: 0.602 Vali Acc: 0.850 Test Loss: 0.602 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7019970417022705
Epoch: 42, Steps: 3 | Train Loss: 0.345 Vali Loss: 0.595 Vali Acc: 0.875 Test Loss: 0.595 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 43 cost time: 0.8851983547210693
Epoch: 43, Steps: 3 | Train Loss: 0.355 Vali Loss: 0.588 Vali Acc: 0.875 Test Loss: 0.588 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 44 cost time: 0.76955246925354
Epoch: 44, Steps: 3 | Train Loss: 0.333 Vali Loss: 0.582 Vali Acc: 0.875 Test Loss: 0.582 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 45 cost time: 0.7311420440673828
Epoch: 45, Steps: 3 | Train Loss: 0.322 Vali Loss: 0.576 Vali Acc: 0.875 Test Loss: 0.576 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 46 cost time: 0.8178877830505371
Epoch: 46, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.570 Vali Acc: 0.875 Test Loss: 0.570 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 47 cost time: 0.7593650817871094
Epoch: 47, Steps: 3 | Train Loss: 0.307 Vali Loss: 0.565 Vali Acc: 0.875 Test Loss: 0.565 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 48 cost time: 0.7549917697906494
Epoch: 48, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.561 Vali Acc: 0.875 Test Loss: 0.561 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 49 cost time: 0.8809459209442139
Epoch: 49, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.556 Vali Acc: 0.875 Test Loss: 0.556 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 50 cost time: 0.865332841873169
Epoch: 50, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.551 Vali Acc: 0.875 Test Loss: 0.551 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 51 cost time: 0.862429141998291
Epoch: 51, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.546 Vali Acc: 0.875 Test Loss: 0.546 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 52 cost time: 0.7907850742340088
Epoch: 52, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.542 Vali Acc: 0.875 Test Loss: 0.542 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 53 cost time: 1.0084919929504395
Epoch: 53, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.538 Vali Acc: 0.875 Test Loss: 0.538 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 54 cost time: 1.313234806060791
Epoch: 54, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.534 Vali Acc: 0.875 Test Loss: 0.534 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 55 cost time: 0.941948652267456
Epoch: 55, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.531 Vali Acc: 0.875 Test Loss: 0.531 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 56 cost time: 0.8796272277832031
Epoch: 56, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.529 Vali Acc: 0.875 Test Loss: 0.529 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 57 cost time: 0.8412690162658691
Epoch: 57, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.527 Vali Acc: 0.875 Test Loss: 0.527 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 58 cost time: 0.7257199287414551
Epoch: 58, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.524 Vali Acc: 0.875 Test Loss: 0.524 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 59 cost time: 0.6661264896392822
Epoch: 59, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.522 Vali Acc: 0.875 Test Loss: 0.522 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 60 cost time: 0.7127652168273926
Epoch: 60, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.521 Vali Acc: 0.875 Test Loss: 0.521 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 61 cost time: 0.6909120082855225
Epoch: 61, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.519 Vali Acc: 0.875 Test Loss: 0.519 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 62 cost time: 0.7543988227844238
Epoch: 62, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.518 Vali Acc: 0.875 Test Loss: 0.518 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 63 cost time: 0.7978203296661377
Epoch: 63, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.518 Vali Acc: 0.875 Test Loss: 0.518 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 64 cost time: 0.7152888774871826
Epoch: 64, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.517 Vali Acc: 0.875 Test Loss: 0.517 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 65 cost time: 0.768784761428833
Epoch: 65, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.517 Vali Acc: 0.875 Test Loss: 0.517 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.8371658325195312
Epoch: 66, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.518 Vali Acc: 0.850 Test Loss: 0.518 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.9344449043273926
Epoch: 67, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.519 Vali Acc: 0.850 Test Loss: 0.519 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 1.1657121181488037
Epoch: 68, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.520 Vali Acc: 0.850 Test Loss: 0.520 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 1.0226476192474365
Epoch: 69, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.520 Vali Acc: 0.850 Test Loss: 0.520 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 0.937354564666748
Epoch: 70, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.520 Vali Acc: 0.850 Test Loss: 0.520 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 1.0715265274047852
Epoch: 71, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.521 Vali Acc: 0.850 Test Loss: 0.521 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 0.9579620361328125
Epoch: 72, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.522 Vali Acc: 0.850 Test Loss: 0.522 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 0.9954781532287598
Epoch: 73, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.523 Vali Acc: 0.850 Test Loss: 0.523 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 0.8325650691986084
Epoch: 74, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.525 Vali Acc: 0.850 Test Loss: 0.525 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_DLinear_UEA_ftM_sl100_ll0_pl0_ma35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 22604
model size : 0.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_DLinear_UEA_ftM_sl100_ll0_pl0_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.6647751331329346
Epoch: 1, Steps: 3 | Train Loss: 1.392 Vali Loss: 1.398 Vali Acc: 0.100 Test Loss: 1.398 Test Acc: 0.100
Validation loss decreased (inf --> -0.099986).  Saving model ...
Epoch: 2 cost time: 0.8758535385131836
Epoch: 2, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.381 Vali Acc: 0.300 Test Loss: 1.381 Test Acc: 0.300
Validation loss decreased (-0.099986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.9141643047332764
Epoch: 3, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.368 Vali Acc: 0.375 Test Loss: 1.368 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 0.8395678997039795
Epoch: 4, Steps: 3 | Train Loss: 1.324 Vali Loss: 1.349 Vali Acc: 0.375 Test Loss: 1.349 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.9548921585083008
Epoch: 5, Steps: 3 | Train Loss: 1.302 Vali Loss: 1.327 Vali Acc: 0.550 Test Loss: 1.327 Test Acc: 0.550
Validation loss decreased (-0.374987 --> -0.549987).  Saving model ...
Epoch: 6 cost time: 0.8896379470825195
Epoch: 6, Steps: 3 | Train Loss: 1.275 Vali Loss: 1.302 Vali Acc: 0.625 Test Loss: 1.302 Test Acc: 0.625
Validation loss decreased (-0.549987 --> -0.624987).  Saving model ...
Epoch: 7 cost time: 0.8828203678131104
Epoch: 7, Steps: 3 | Train Loss: 1.234 Vali Loss: 1.276 Vali Acc: 0.650 Test Loss: 1.276 Test Acc: 0.650
Validation loss decreased (-0.624987 --> -0.649987).  Saving model ...
Epoch: 8 cost time: 0.9103579521179199
Epoch: 8, Steps: 3 | Train Loss: 1.191 Vali Loss: 1.248 Vali Acc: 0.650 Test Loss: 1.248 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649988).  Saving model ...
Epoch: 9 cost time: 1.052105188369751
Epoch: 9, Steps: 3 | Train Loss: 1.161 Vali Loss: 1.219 Vali Acc: 0.650 Test Loss: 1.219 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 10 cost time: 0.8505430221557617
Epoch: 10, Steps: 3 | Train Loss: 1.110 Vali Loss: 1.188 Vali Acc: 0.675 Test Loss: 1.188 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674988).  Saving model ...
Epoch: 11 cost time: 1.0830821990966797
Epoch: 11, Steps: 3 | Train Loss: 1.078 Vali Loss: 1.158 Vali Acc: 0.700 Test Loss: 1.158 Test Acc: 0.700
Validation loss decreased (-0.674988 --> -0.699988).  Saving model ...
Epoch: 12 cost time: 0.939399242401123
Epoch: 12, Steps: 3 | Train Loss: 1.064 Vali Loss: 1.127 Vali Acc: 0.675 Test Loss: 1.127 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0481929779052734
Epoch: 13, Steps: 3 | Train Loss: 0.982 Vali Loss: 1.097 Vali Acc: 0.650 Test Loss: 1.097 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0085670948028564
Epoch: 14, Steps: 3 | Train Loss: 0.940 Vali Loss: 1.067 Vali Acc: 0.650 Test Loss: 1.067 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1039323806762695
Epoch: 15, Steps: 3 | Train Loss: 0.912 Vali Loss: 1.038 Vali Acc: 0.675 Test Loss: 1.038 Test Acc: 0.675
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7815485000610352
Epoch: 16, Steps: 3 | Train Loss: 0.870 Vali Loss: 1.009 Vali Acc: 0.700 Test Loss: 1.009 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699990).  Saving model ...
Epoch: 17 cost time: 0.9192790985107422
Epoch: 17, Steps: 3 | Train Loss: 0.841 Vali Loss: 0.982 Vali Acc: 0.700 Test Loss: 0.982 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 18 cost time: 1.324038028717041
Epoch: 18, Steps: 3 | Train Loss: 0.790 Vali Loss: 0.955 Vali Acc: 0.750 Test Loss: 0.955 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749990).  Saving model ...
Epoch: 19 cost time: 1.1923739910125732
Epoch: 19, Steps: 3 | Train Loss: 0.746 Vali Loss: 0.930 Vali Acc: 0.750 Test Loss: 0.930 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 20 cost time: 1.2961008548736572
Epoch: 20, Steps: 3 | Train Loss: 0.749 Vali Loss: 0.905 Vali Acc: 0.775 Test Loss: 0.905 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774991).  Saving model ...
Epoch: 21 cost time: 0.9554133415222168
Epoch: 21, Steps: 3 | Train Loss: 0.705 Vali Loss: 0.881 Vali Acc: 0.775 Test Loss: 0.881 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 22 cost time: 0.9720778465270996
Epoch: 22, Steps: 3 | Train Loss: 0.673 Vali Loss: 0.859 Vali Acc: 0.750 Test Loss: 0.859 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.117211103439331
Epoch: 23, Steps: 3 | Train Loss: 0.657 Vali Loss: 0.838 Vali Acc: 0.800 Test Loss: 0.838 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799992).  Saving model ...
Epoch: 24 cost time: 1.091050148010254
Epoch: 24, Steps: 3 | Train Loss: 0.636 Vali Loss: 0.817 Vali Acc: 0.800 Test Loss: 0.817 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 25 cost time: 1.287705898284912
Epoch: 25, Steps: 3 | Train Loss: 0.602 Vali Loss: 0.798 Vali Acc: 0.775 Test Loss: 0.798 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0531764030456543
Epoch: 26, Steps: 3 | Train Loss: 0.576 Vali Loss: 0.780 Vali Acc: 0.800 Test Loss: 0.780 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 27 cost time: 0.9172930717468262
Epoch: 27, Steps: 3 | Train Loss: 0.589 Vali Loss: 0.763 Vali Acc: 0.800 Test Loss: 0.763 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 28 cost time: 0.8679652214050293
Epoch: 28, Steps: 3 | Train Loss: 0.544 Vali Loss: 0.747 Vali Acc: 0.850 Test Loss: 0.747 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849993).  Saving model ...
Epoch: 29 cost time: 1.133669137954712
Epoch: 29, Steps: 3 | Train Loss: 0.543 Vali Loss: 0.732 Vali Acc: 0.850 Test Loss: 0.732 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 30 cost time: 1.391624927520752
Epoch: 30, Steps: 3 | Train Loss: 0.509 Vali Loss: 0.718 Vali Acc: 0.850 Test Loss: 0.718 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 31 cost time: 0.7767274379730225
Epoch: 31, Steps: 3 | Train Loss: 0.504 Vali Loss: 0.704 Vali Acc: 0.850 Test Loss: 0.704 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 32 cost time: 0.9018161296844482
Epoch: 32, Steps: 3 | Train Loss: 0.475 Vali Loss: 0.691 Vali Acc: 0.850 Test Loss: 0.691 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 33 cost time: 0.9817581176757812
Epoch: 33, Steps: 3 | Train Loss: 0.457 Vali Loss: 0.679 Vali Acc: 0.850 Test Loss: 0.679 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 34 cost time: 0.7579574584960938
Epoch: 34, Steps: 3 | Train Loss: 0.456 Vali Loss: 0.668 Vali Acc: 0.850 Test Loss: 0.668 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 35 cost time: 1.1106891632080078
Epoch: 35, Steps: 3 | Train Loss: 0.432 Vali Loss: 0.657 Vali Acc: 0.850 Test Loss: 0.657 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 36 cost time: 0.8499219417572021
Epoch: 36, Steps: 3 | Train Loss: 0.427 Vali Loss: 0.647 Vali Acc: 0.850 Test Loss: 0.647 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 37 cost time: 1.1249701976776123
Epoch: 37, Steps: 3 | Train Loss: 0.385 Vali Loss: 0.637 Vali Acc: 0.850 Test Loss: 0.637 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 38 cost time: 0.8896257877349854
Epoch: 38, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.628 Vali Acc: 0.850 Test Loss: 0.628 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 39 cost time: 0.8784205913543701
Epoch: 39, Steps: 3 | Train Loss: 0.382 Vali Loss: 0.619 Vali Acc: 0.850 Test Loss: 0.619 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 40 cost time: 0.903724193572998
Epoch: 40, Steps: 3 | Train Loss: 0.378 Vali Loss: 0.611 Vali Acc: 0.850 Test Loss: 0.611 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 41 cost time: 0.7391185760498047
Epoch: 41, Steps: 3 | Train Loss: 0.378 Vali Loss: 0.604 Vali Acc: 0.875 Test Loss: 0.604 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 42 cost time: 0.9606869220733643
Epoch: 42, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.597 Vali Acc: 0.875 Test Loss: 0.597 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 43 cost time: 0.7154207229614258
Epoch: 43, Steps: 3 | Train Loss: 0.356 Vali Loss: 0.590 Vali Acc: 0.875 Test Loss: 0.590 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 44 cost time: 0.9025692939758301
Epoch: 44, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.583 Vali Acc: 0.875 Test Loss: 0.583 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 45 cost time: 0.9712820053100586
Epoch: 45, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.577 Vali Acc: 0.875 Test Loss: 0.577 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 46 cost time: 0.7097032070159912
Epoch: 46, Steps: 3 | Train Loss: 0.322 Vali Loss: 0.571 Vali Acc: 0.875 Test Loss: 0.571 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 47 cost time: 1.0047814846038818
Epoch: 47, Steps: 3 | Train Loss: 0.308 Vali Loss: 0.566 Vali Acc: 0.875 Test Loss: 0.566 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 48 cost time: 0.913226842880249
Epoch: 48, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.561 Vali Acc: 0.875 Test Loss: 0.561 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 49 cost time: 0.8339402675628662
Epoch: 49, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.557 Vali Acc: 0.875 Test Loss: 0.557 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 50 cost time: 1.2615206241607666
Epoch: 50, Steps: 3 | Train Loss: 0.285 Vali Loss: 0.551 Vali Acc: 0.875 Test Loss: 0.551 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 51 cost time: 0.7747106552124023
Epoch: 51, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.547 Vali Acc: 0.875 Test Loss: 0.547 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 52 cost time: 0.8340659141540527
Epoch: 52, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.542 Vali Acc: 0.875 Test Loss: 0.542 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 53 cost time: 1.331907033920288
Epoch: 53, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.538 Vali Acc: 0.875 Test Loss: 0.538 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 54 cost time: 0.9530808925628662
Epoch: 54, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.534 Vali Acc: 0.875 Test Loss: 0.534 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 55 cost time: 0.8853363990783691
Epoch: 55, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.531 Vali Acc: 0.875 Test Loss: 0.531 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 56 cost time: 1.0165300369262695
Epoch: 56, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.528 Vali Acc: 0.875 Test Loss: 0.528 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 57 cost time: 1.0082123279571533
Epoch: 57, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.526 Vali Acc: 0.875 Test Loss: 0.526 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 58 cost time: 0.9974431991577148
Epoch: 58, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.523 Vali Acc: 0.875 Test Loss: 0.523 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 59 cost time: 0.9964380264282227
Epoch: 59, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.521 Vali Acc: 0.875 Test Loss: 0.521 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 60 cost time: 0.995936393737793
Epoch: 60, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.519 Vali Acc: 0.875 Test Loss: 0.519 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 61 cost time: 0.7938790321350098
Epoch: 61, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.518 Vali Acc: 0.875 Test Loss: 0.518 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 62 cost time: 1.0790305137634277
Epoch: 62, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.516 Vali Acc: 0.875 Test Loss: 0.516 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 63 cost time: 1.0501987934112549
Epoch: 63, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.516 Vali Acc: 0.875 Test Loss: 0.516 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 64 cost time: 1.1964006423950195
Epoch: 64, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.515 Vali Acc: 0.850 Test Loss: 0.515 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.3731071949005127
Epoch: 65, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.515 Vali Acc: 0.850 Test Loss: 0.515 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.4051697254180908
Epoch: 66, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.516 Vali Acc: 0.850 Test Loss: 0.516 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 1.0729119777679443
Epoch: 67, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.516 Vali Acc: 0.850 Test Loss: 0.516 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 1.2337830066680908
Epoch: 68, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.517 Vali Acc: 0.850 Test Loss: 0.517 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 1.1495940685272217
Epoch: 69, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.518 Vali Acc: 0.850 Test Loss: 0.518 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 1.1402390003204346
Epoch: 70, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.518 Vali Acc: 0.850 Test Loss: 0.518 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 0.917025089263916
Epoch: 71, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.518 Vali Acc: 0.850 Test Loss: 0.518 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 0.9812123775482178
Epoch: 72, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.520 Vali Acc: 0.850 Test Loss: 0.520 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 1.30904221534729
Epoch: 73, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.521 Vali Acc: 0.850 Test Loss: 0.521 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_DLinear_UEA_ftM_sl100_ll0_pl0_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 22604
model size : 0.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_DLinear_UEA_ftM_sl100_ll0_pl0_ma25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.2346785068511963
Epoch: 1, Steps: 3 | Train Loss: 1.392 Vali Loss: 1.398 Vali Acc: 0.100 Test Loss: 1.398 Test Acc: 0.100
Validation loss decreased (inf --> -0.099986).  Saving model ...
Epoch: 2 cost time: 0.8975241184234619
Epoch: 2, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.381 Vali Acc: 0.300 Test Loss: 1.381 Test Acc: 0.300
Validation loss decreased (-0.099986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.9583935737609863
Epoch: 3, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.368 Vali Acc: 0.375 Test Loss: 1.368 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 1.4269592761993408
Epoch: 4, Steps: 3 | Train Loss: 1.325 Vali Loss: 1.349 Vali Acc: 0.375 Test Loss: 1.349 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.9490654468536377
Epoch: 5, Steps: 3 | Train Loss: 1.302 Vali Loss: 1.327 Vali Acc: 0.525 Test Loss: 1.327 Test Acc: 0.525
Validation loss decreased (-0.374987 --> -0.524987).  Saving model ...
Epoch: 6 cost time: 1.0622918605804443
Epoch: 6, Steps: 3 | Train Loss: 1.275 Vali Loss: 1.303 Vali Acc: 0.625 Test Loss: 1.303 Test Acc: 0.625
Validation loss decreased (-0.524987 --> -0.624987).  Saving model ...
Epoch: 7 cost time: 0.7757828235626221
Epoch: 7, Steps: 3 | Train Loss: 1.235 Vali Loss: 1.276 Vali Acc: 0.650 Test Loss: 1.276 Test Acc: 0.650
Validation loss decreased (-0.624987 --> -0.649987).  Saving model ...
Epoch: 8 cost time: 0.9109516143798828
Epoch: 8, Steps: 3 | Train Loss: 1.192 Vali Loss: 1.248 Vali Acc: 0.650 Test Loss: 1.248 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649988).  Saving model ...
Epoch: 9 cost time: 1.0761313438415527
Epoch: 9, Steps: 3 | Train Loss: 1.162 Vali Loss: 1.218 Vali Acc: 0.675 Test Loss: 1.218 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674988).  Saving model ...
Epoch: 10 cost time: 0.9405708312988281
Epoch: 10, Steps: 3 | Train Loss: 1.111 Vali Loss: 1.188 Vali Acc: 0.675 Test Loss: 1.188 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 11 cost time: 0.9084558486938477
Epoch: 11, Steps: 3 | Train Loss: 1.078 Vali Loss: 1.157 Vali Acc: 0.675 Test Loss: 1.157 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 12 cost time: 1.3664278984069824
Epoch: 12, Steps: 3 | Train Loss: 1.063 Vali Loss: 1.126 Vali Acc: 0.675 Test Loss: 1.126 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674989).  Saving model ...
Epoch: 13 cost time: 1.2179303169250488
Epoch: 13, Steps: 3 | Train Loss: 0.983 Vali Loss: 1.096 Vali Acc: 0.700 Test Loss: 1.096 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 14 cost time: 0.8086872100830078
Epoch: 14, Steps: 3 | Train Loss: 0.940 Vali Loss: 1.066 Vali Acc: 0.700 Test Loss: 1.066 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 15 cost time: 0.8735194206237793
Epoch: 15, Steps: 3 | Train Loss: 0.911 Vali Loss: 1.037 Vali Acc: 0.725 Test Loss: 1.037 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724990).  Saving model ...
Epoch: 16 cost time: 0.7822387218475342
Epoch: 16, Steps: 3 | Train Loss: 0.869 Vali Loss: 1.008 Vali Acc: 0.750 Test Loss: 1.008 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 17 cost time: 0.8981785774230957
Epoch: 17, Steps: 3 | Train Loss: 0.839 Vali Loss: 0.981 Vali Acc: 0.775 Test Loss: 0.981 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774990).  Saving model ...
Epoch: 18 cost time: 0.6722583770751953
Epoch: 18, Steps: 3 | Train Loss: 0.788 Vali Loss: 0.954 Vali Acc: 0.750 Test Loss: 0.954 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9494454860687256
Epoch: 19, Steps: 3 | Train Loss: 0.745 Vali Loss: 0.929 Vali Acc: 0.750 Test Loss: 0.929 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0345563888549805
Epoch: 20, Steps: 3 | Train Loss: 0.747 Vali Loss: 0.904 Vali Acc: 0.750 Test Loss: 0.904 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8705601692199707
Epoch: 21, Steps: 3 | Train Loss: 0.703 Vali Loss: 0.880 Vali Acc: 0.750 Test Loss: 0.880 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0297012329101562
Epoch: 22, Steps: 3 | Train Loss: 0.669 Vali Loss: 0.858 Vali Acc: 0.750 Test Loss: 0.858 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0185308456420898
Epoch: 23, Steps: 3 | Train Loss: 0.652 Vali Loss: 0.837 Vali Acc: 0.750 Test Loss: 0.837 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9636423587799072
Epoch: 24, Steps: 3 | Train Loss: 0.630 Vali Loss: 0.816 Vali Acc: 0.775 Test Loss: 0.816 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774992).  Saving model ...
Epoch: 25 cost time: 1.1702418327331543
Epoch: 25, Steps: 3 | Train Loss: 0.598 Vali Loss: 0.797 Vali Acc: 0.800 Test Loss: 0.797 Test Acc: 0.800
Validation loss decreased (-0.774992 --> -0.799992).  Saving model ...
Epoch: 26 cost time: 0.9961223602294922
Epoch: 26, Steps: 3 | Train Loss: 0.571 Vali Loss: 0.779 Vali Acc: 0.800 Test Loss: 0.779 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 27 cost time: 1.0267333984375
Epoch: 27, Steps: 3 | Train Loss: 0.583 Vali Loss: 0.763 Vali Acc: 0.825 Test Loss: 0.763 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 28 cost time: 0.8518764972686768
Epoch: 28, Steps: 3 | Train Loss: 0.537 Vali Loss: 0.747 Vali Acc: 0.825 Test Loss: 0.747 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 29 cost time: 0.8152828216552734
Epoch: 29, Steps: 3 | Train Loss: 0.534 Vali Loss: 0.732 Vali Acc: 0.825 Test Loss: 0.732 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 30 cost time: 0.8520808219909668
Epoch: 30, Steps: 3 | Train Loss: 0.503 Vali Loss: 0.718 Vali Acc: 0.850 Test Loss: 0.718 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
Epoch: 31 cost time: 0.9268088340759277
Epoch: 31, Steps: 3 | Train Loss: 0.496 Vali Loss: 0.704 Vali Acc: 0.850 Test Loss: 0.704 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 32 cost time: 0.8784821033477783
Epoch: 32, Steps: 3 | Train Loss: 0.467 Vali Loss: 0.691 Vali Acc: 0.850 Test Loss: 0.691 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 33 cost time: 1.0435752868652344
Epoch: 33, Steps: 3 | Train Loss: 0.449 Vali Loss: 0.679 Vali Acc: 0.850 Test Loss: 0.679 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 34 cost time: 0.8399567604064941
Epoch: 34, Steps: 3 | Train Loss: 0.446 Vali Loss: 0.668 Vali Acc: 0.850 Test Loss: 0.668 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 35 cost time: 0.7421879768371582
Epoch: 35, Steps: 3 | Train Loss: 0.423 Vali Loss: 0.657 Vali Acc: 0.850 Test Loss: 0.657 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 36 cost time: 1.0758681297302246
Epoch: 36, Steps: 3 | Train Loss: 0.419 Vali Loss: 0.647 Vali Acc: 0.850 Test Loss: 0.647 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 37 cost time: 0.7524709701538086
Epoch: 37, Steps: 3 | Train Loss: 0.375 Vali Loss: 0.638 Vali Acc: 0.875 Test Loss: 0.638 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 38 cost time: 0.9376404285430908
Epoch: 38, Steps: 3 | Train Loss: 0.369 Vali Loss: 0.629 Vali Acc: 0.875 Test Loss: 0.629 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 39 cost time: 1.1421780586242676
Epoch: 39, Steps: 3 | Train Loss: 0.370 Vali Loss: 0.621 Vali Acc: 0.875 Test Loss: 0.621 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 40 cost time: 1.1295843124389648
Epoch: 40, Steps: 3 | Train Loss: 0.368 Vali Loss: 0.613 Vali Acc: 0.875 Test Loss: 0.613 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 41 cost time: 0.8729758262634277
Epoch: 41, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.605 Vali Acc: 0.875 Test Loss: 0.605 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 42 cost time: 1.47945237159729
Epoch: 42, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.599 Vali Acc: 0.875 Test Loss: 0.599 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 43 cost time: 1.189577341079712
Epoch: 43, Steps: 3 | Train Loss: 0.343 Vali Loss: 0.592 Vali Acc: 0.875 Test Loss: 0.592 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 44 cost time: 0.990239143371582
Epoch: 44, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.586 Vali Acc: 0.875 Test Loss: 0.586 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 45 cost time: 1.1370084285736084
Epoch: 45, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.580 Vali Acc: 0.875 Test Loss: 0.580 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 46 cost time: 0.9970312118530273
Epoch: 46, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.575 Vali Acc: 0.875 Test Loss: 0.575 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 47 cost time: 1.1734864711761475
Epoch: 47, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.570 Vali Acc: 0.875 Test Loss: 0.570 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 48 cost time: 0.9027135372161865
Epoch: 48, Steps: 3 | Train Loss: 0.278 Vali Loss: 0.566 Vali Acc: 0.875 Test Loss: 0.566 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 49 cost time: 0.7860040664672852
Epoch: 49, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.561 Vali Acc: 0.875 Test Loss: 0.561 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 50 cost time: 0.8391983509063721
Epoch: 50, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.557 Vali Acc: 0.875 Test Loss: 0.557 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 51 cost time: 0.906782865524292
Epoch: 51, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.553 Vali Acc: 0.875 Test Loss: 0.553 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 52 cost time: 0.7964341640472412
Epoch: 52, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.549 Vali Acc: 0.875 Test Loss: 0.549 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 53 cost time: 0.9843120574951172
Epoch: 53, Steps: 3 | Train Loss: 0.249 Vali Loss: 0.546 Vali Acc: 0.875 Test Loss: 0.546 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 54 cost time: 1.0306956768035889
Epoch: 54, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.542 Vali Acc: 0.875 Test Loss: 0.542 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 55 cost time: 0.8632121086120605
Epoch: 55, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.540 Vali Acc: 0.875 Test Loss: 0.540 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 56 cost time: 0.8932290077209473
Epoch: 56, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.538 Vali Acc: 0.875 Test Loss: 0.538 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 57 cost time: 1.027076005935669
Epoch: 57, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.537 Vali Acc: 0.875 Test Loss: 0.537 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 58 cost time: 0.8322470188140869
Epoch: 58, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.535 Vali Acc: 0.850 Test Loss: 0.535 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.9999954700469971
Epoch: 59, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.534 Vali Acc: 0.850 Test Loss: 0.534 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.1165649890899658
Epoch: 60, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.533 Vali Acc: 0.850 Test Loss: 0.533 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.1329996585845947
Epoch: 61, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.532 Vali Acc: 0.850 Test Loss: 0.532 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.8594474792480469
Epoch: 62, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.532 Vali Acc: 0.850 Test Loss: 0.532 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.0463716983795166
Epoch: 63, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.532 Vali Acc: 0.850 Test Loss: 0.532 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.0150716304779053
Epoch: 64, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.533 Vali Acc: 0.850 Test Loss: 0.533 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 1.0704245567321777
Epoch: 65, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.534 Vali Acc: 0.850 Test Loss: 0.534 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 0.8732988834381104
Epoch: 66, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.536 Vali Acc: 0.850 Test Loss: 0.536 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 0.913853645324707
Epoch: 67, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.537 Vali Acc: 0.850 Test Loss: 0.537 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_DLinear_UEA_ftM_sl100_ll0_pl0_ma25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 22604
model size : 0.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_DLinear_UEA_ftM_sl100_ll0_pl0_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.847489595413208
Epoch: 1, Steps: 3 | Train Loss: 1.392 Vali Loss: 1.398 Vali Acc: 0.100 Test Loss: 1.398 Test Acc: 0.100
Validation loss decreased (inf --> -0.099986).  Saving model ...
Epoch: 2 cost time: 1.0025815963745117
Epoch: 2, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.381 Vali Acc: 0.300 Test Loss: 1.381 Test Acc: 0.300
Validation loss decreased (-0.099986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.9395403861999512
Epoch: 3, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.367 Vali Acc: 0.375 Test Loss: 1.367 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 1.0939233303070068
Epoch: 4, Steps: 3 | Train Loss: 1.325 Vali Loss: 1.349 Vali Acc: 0.375 Test Loss: 1.349 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.861562967300415
Epoch: 5, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.327 Vali Acc: 0.525 Test Loss: 1.327 Test Acc: 0.525
Validation loss decreased (-0.374987 --> -0.524987).  Saving model ...
Epoch: 6 cost time: 0.9161267280578613
Epoch: 6, Steps: 3 | Train Loss: 1.276 Vali Loss: 1.302 Vali Acc: 0.650 Test Loss: 1.302 Test Acc: 0.650
Validation loss decreased (-0.524987 --> -0.649987).  Saving model ...
Epoch: 7 cost time: 1.0109076499938965
Epoch: 7, Steps: 3 | Train Loss: 1.235 Vali Loss: 1.275 Vali Acc: 0.650 Test Loss: 1.275 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 8 cost time: 1.1514861583709717
Epoch: 8, Steps: 3 | Train Loss: 1.192 Vali Loss: 1.247 Vali Acc: 0.675 Test Loss: 1.247 Test Acc: 0.675
Validation loss decreased (-0.649987 --> -0.674988).  Saving model ...
Epoch: 9 cost time: 1.027841567993164
Epoch: 9, Steps: 3 | Train Loss: 1.162 Vali Loss: 1.218 Vali Acc: 0.675 Test Loss: 1.218 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 10 cost time: 0.9685535430908203
Epoch: 10, Steps: 3 | Train Loss: 1.112 Vali Loss: 1.187 Vali Acc: 0.700 Test Loss: 1.187 Test Acc: 0.700
Validation loss decreased (-0.674988 --> -0.699988).  Saving model ...
Epoch: 11 cost time: 0.8500003814697266
Epoch: 11, Steps: 3 | Train Loss: 1.077 Vali Loss: 1.156 Vali Acc: 0.725 Test Loss: 1.156 Test Acc: 0.725
Validation loss decreased (-0.699988 --> -0.724988).  Saving model ...
Epoch: 12 cost time: 0.896418571472168
Epoch: 12, Steps: 3 | Train Loss: 1.063 Vali Loss: 1.125 Vali Acc: 0.725 Test Loss: 1.125 Test Acc: 0.725
Validation loss decreased (-0.724988 --> -0.724989).  Saving model ...
Epoch: 13 cost time: 1.047623872756958
Epoch: 13, Steps: 3 | Train Loss: 0.983 Vali Loss: 1.095 Vali Acc: 0.700 Test Loss: 1.095 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9554719924926758
Epoch: 14, Steps: 3 | Train Loss: 0.940 Vali Loss: 1.065 Vali Acc: 0.725 Test Loss: 1.065 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 15 cost time: 1.065943717956543
Epoch: 15, Steps: 3 | Train Loss: 0.909 Vali Loss: 1.035 Vali Acc: 0.775 Test Loss: 1.035 Test Acc: 0.775
Validation loss decreased (-0.724989 --> -0.774990).  Saving model ...
Epoch: 16 cost time: 1.2231013774871826
Epoch: 16, Steps: 3 | Train Loss: 0.867 Vali Loss: 1.006 Vali Acc: 0.775 Test Loss: 1.006 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774990).  Saving model ...
Epoch: 17 cost time: 1.1168720722198486
Epoch: 17, Steps: 3 | Train Loss: 0.836 Vali Loss: 0.979 Vali Acc: 0.775 Test Loss: 0.979 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774990).  Saving model ...
Epoch: 18 cost time: 1.0655381679534912
Epoch: 18, Steps: 3 | Train Loss: 0.785 Vali Loss: 0.952 Vali Acc: 0.775 Test Loss: 0.952 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774990).  Saving model ...
Epoch: 19 cost time: 1.1299514770507812
Epoch: 19, Steps: 3 | Train Loss: 0.744 Vali Loss: 0.926 Vali Acc: 0.800 Test Loss: 0.926 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799991).  Saving model ...
Epoch: 20 cost time: 1.106116533279419
Epoch: 20, Steps: 3 | Train Loss: 0.744 Vali Loss: 0.901 Vali Acc: 0.800 Test Loss: 0.901 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 21 cost time: 1.1799631118774414
Epoch: 21, Steps: 3 | Train Loss: 0.701 Vali Loss: 0.877 Vali Acc: 0.800 Test Loss: 0.877 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 22 cost time: 1.260488510131836
Epoch: 22, Steps: 3 | Train Loss: 0.665 Vali Loss: 0.855 Vali Acc: 0.800 Test Loss: 0.855 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 23 cost time: 1.1701018810272217
Epoch: 23, Steps: 3 | Train Loss: 0.647 Vali Loss: 0.833 Vali Acc: 0.800 Test Loss: 0.833 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 24 cost time: 1.371264934539795
Epoch: 24, Steps: 3 | Train Loss: 0.623 Vali Loss: 0.812 Vali Acc: 0.825 Test Loss: 0.812 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 25 cost time: 1.0028893947601318
Epoch: 25, Steps: 3 | Train Loss: 0.593 Vali Loss: 0.793 Vali Acc: 0.825 Test Loss: 0.793 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 26 cost time: 1.2884101867675781
Epoch: 26, Steps: 3 | Train Loss: 0.568 Vali Loss: 0.775 Vali Acc: 0.850 Test Loss: 0.775 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 27 cost time: 0.8724868297576904
Epoch: 27, Steps: 3 | Train Loss: 0.576 Vali Loss: 0.758 Vali Acc: 0.850 Test Loss: 0.758 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 28 cost time: 0.8096849918365479
Epoch: 28, Steps: 3 | Train Loss: 0.530 Vali Loss: 0.742 Vali Acc: 0.850 Test Loss: 0.742 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 29 cost time: 0.8298814296722412
Epoch: 29, Steps: 3 | Train Loss: 0.525 Vali Loss: 0.727 Vali Acc: 0.850 Test Loss: 0.727 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 30 cost time: 1.3773775100708008
Epoch: 30, Steps: 3 | Train Loss: 0.498 Vali Loss: 0.713 Vali Acc: 0.850 Test Loss: 0.713 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 31 cost time: 0.9517307281494141
Epoch: 31, Steps: 3 | Train Loss: 0.486 Vali Loss: 0.699 Vali Acc: 0.850 Test Loss: 0.699 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 32 cost time: 1.1005356311798096
Epoch: 32, Steps: 3 | Train Loss: 0.458 Vali Loss: 0.686 Vali Acc: 0.850 Test Loss: 0.686 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 33 cost time: 1.387105941772461
Epoch: 33, Steps: 3 | Train Loss: 0.439 Vali Loss: 0.674 Vali Acc: 0.850 Test Loss: 0.674 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 34 cost time: 0.9240584373474121
Epoch: 34, Steps: 3 | Train Loss: 0.435 Vali Loss: 0.662 Vali Acc: 0.850 Test Loss: 0.662 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 35 cost time: 1.1186931133270264
Epoch: 35, Steps: 3 | Train Loss: 0.413 Vali Loss: 0.652 Vali Acc: 0.850 Test Loss: 0.652 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 36 cost time: 0.8526268005371094
Epoch: 36, Steps: 3 | Train Loss: 0.411 Vali Loss: 0.642 Vali Acc: 0.850 Test Loss: 0.642 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 37 cost time: 1.2065973281860352
Epoch: 37, Steps: 3 | Train Loss: 0.364 Vali Loss: 0.632 Vali Acc: 0.850 Test Loss: 0.632 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 38 cost time: 1.0511524677276611
Epoch: 38, Steps: 3 | Train Loss: 0.358 Vali Loss: 0.623 Vali Acc: 0.875 Test Loss: 0.623 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 39 cost time: 0.9249458312988281
Epoch: 39, Steps: 3 | Train Loss: 0.357 Vali Loss: 0.615 Vali Acc: 0.875 Test Loss: 0.615 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 40 cost time: 0.973848819732666
Epoch: 40, Steps: 3 | Train Loss: 0.355 Vali Loss: 0.607 Vali Acc: 0.875 Test Loss: 0.607 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 41 cost time: 0.8804163932800293
Epoch: 41, Steps: 3 | Train Loss: 0.353 Vali Loss: 0.600 Vali Acc: 0.875 Test Loss: 0.600 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 42 cost time: 0.803769588470459
Epoch: 42, Steps: 3 | Train Loss: 0.319 Vali Loss: 0.593 Vali Acc: 0.875 Test Loss: 0.593 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 43 cost time: 0.9565653800964355
Epoch: 43, Steps: 3 | Train Loss: 0.328 Vali Loss: 0.587 Vali Acc: 0.875 Test Loss: 0.587 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 44 cost time: 0.8158330917358398
Epoch: 44, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.581 Vali Acc: 0.875 Test Loss: 0.581 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 45 cost time: 0.9630627632141113
Epoch: 45, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.576 Vali Acc: 0.875 Test Loss: 0.576 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 46 cost time: 0.9909579753875732
Epoch: 46, Steps: 3 | Train Loss: 0.303 Vali Loss: 0.571 Vali Acc: 0.875 Test Loss: 0.571 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 47 cost time: 1.0526177883148193
Epoch: 47, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.567 Vali Acc: 0.875 Test Loss: 0.567 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 48 cost time: 1.0697898864746094
Epoch: 48, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.563 Vali Acc: 0.875 Test Loss: 0.563 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 49 cost time: 1.193354845046997
Epoch: 49, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.560 Vali Acc: 0.875 Test Loss: 0.560 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 50 cost time: 1.0725431442260742
Epoch: 50, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.556 Vali Acc: 0.875 Test Loss: 0.556 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 51 cost time: 1.194007158279419
Epoch: 51, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.553 Vali Acc: 0.875 Test Loss: 0.553 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 52 cost time: 1.014808177947998
Epoch: 52, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.550 Vali Acc: 0.875 Test Loss: 0.550 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 53 cost time: 0.9242253303527832
Epoch: 53, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.548 Vali Acc: 0.850 Test Loss: 0.548 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.0469744205474854
Epoch: 54, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.545 Vali Acc: 0.850 Test Loss: 0.545 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.9626045227050781
Epoch: 55, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.544 Vali Acc: 0.850 Test Loss: 0.544 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.8536710739135742
Epoch: 56, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.543 Vali Acc: 0.850 Test Loss: 0.543 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.3662331104278564
Epoch: 57, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.543 Vali Acc: 0.850 Test Loss: 0.543 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.869938850402832
Epoch: 58, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.542 Vali Acc: 0.850 Test Loss: 0.542 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.9125912189483643
Epoch: 59, Steps: 3 | Train Loss: 0.218 Vali Loss: 0.542 Vali Acc: 0.850 Test Loss: 0.542 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 1.002429723739624
Epoch: 60, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.542 Vali Acc: 0.850 Test Loss: 0.542 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 1.0281026363372803
Epoch: 61, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.543 Vali Acc: 0.825 Test Loss: 0.543 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 1.1198835372924805
Epoch: 62, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.543 Vali Acc: 0.825 Test Loss: 0.543 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_DLinear_UEA_ftM_sl100_ll0_pl0_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 22604
model size : 0.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         15                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_DLinear_UEA_ftM_sl100_ll0_pl0_ma15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.2965028285980225
Epoch: 1, Steps: 3 | Train Loss: 1.392 Vali Loss: 1.398 Vali Acc: 0.100 Test Loss: 1.398 Test Acc: 0.100
Validation loss decreased (inf --> -0.099986).  Saving model ...
Epoch: 2 cost time: 1.074155330657959
Epoch: 2, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.381 Vali Acc: 0.275 Test Loss: 1.381 Test Acc: 0.275
Validation loss decreased (-0.099986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 1.035503625869751
Epoch: 3, Steps: 3 | Train Loss: 1.348 Vali Loss: 1.367 Vali Acc: 0.375 Test Loss: 1.367 Test Acc: 0.375
Validation loss decreased (-0.274986 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 1.1656768321990967
Epoch: 4, Steps: 3 | Train Loss: 1.324 Vali Loss: 1.349 Vali Acc: 0.375 Test Loss: 1.349 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 1.085402011871338
Epoch: 5, Steps: 3 | Train Loss: 1.301 Vali Loss: 1.327 Vali Acc: 0.550 Test Loss: 1.327 Test Acc: 0.550
Validation loss decreased (-0.374987 --> -0.549987).  Saving model ...
Epoch: 6 cost time: 0.892930269241333
Epoch: 6, Steps: 3 | Train Loss: 1.274 Vali Loss: 1.302 Vali Acc: 0.625 Test Loss: 1.302 Test Acc: 0.625
Validation loss decreased (-0.549987 --> -0.624987).  Saving model ...
Epoch: 7 cost time: 1.1976027488708496
Epoch: 7, Steps: 3 | Train Loss: 1.233 Vali Loss: 1.276 Vali Acc: 0.650 Test Loss: 1.276 Test Acc: 0.650
Validation loss decreased (-0.624987 --> -0.649987).  Saving model ...
Epoch: 8 cost time: 0.8754432201385498
Epoch: 8, Steps: 3 | Train Loss: 1.189 Vali Loss: 1.248 Vali Acc: 0.675 Test Loss: 1.248 Test Acc: 0.675
Validation loss decreased (-0.649987 --> -0.674988).  Saving model ...
Epoch: 9 cost time: 1.3045997619628906
Epoch: 9, Steps: 3 | Train Loss: 1.161 Vali Loss: 1.219 Vali Acc: 0.675 Test Loss: 1.219 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674988).  Saving model ...
Epoch: 10 cost time: 0.9129922389984131
Epoch: 10, Steps: 3 | Train Loss: 1.109 Vali Loss: 1.188 Vali Acc: 0.700 Test Loss: 1.188 Test Acc: 0.700
Validation loss decreased (-0.674988 --> -0.699988).  Saving model ...
Epoch: 11 cost time: 0.7992706298828125
Epoch: 11, Steps: 3 | Train Loss: 1.075 Vali Loss: 1.158 Vali Acc: 0.700 Test Loss: 1.158 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699988).  Saving model ...
Epoch: 12 cost time: 0.8670744895935059
Epoch: 12, Steps: 3 | Train Loss: 1.062 Vali Loss: 1.127 Vali Acc: 0.725 Test Loss: 1.127 Test Acc: 0.725
Validation loss decreased (-0.699988 --> -0.724989).  Saving model ...
Epoch: 13 cost time: 0.853295087814331
Epoch: 13, Steps: 3 | Train Loss: 0.979 Vali Loss: 1.097 Vali Acc: 0.725 Test Loss: 1.097 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 14 cost time: 0.9419231414794922
Epoch: 14, Steps: 3 | Train Loss: 0.937 Vali Loss: 1.067 Vali Acc: 0.725 Test Loss: 1.067 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 15 cost time: 0.909682035446167
Epoch: 15, Steps: 3 | Train Loss: 0.909 Vali Loss: 1.038 Vali Acc: 0.700 Test Loss: 1.038 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1484558582305908
Epoch: 16, Steps: 3 | Train Loss: 0.867 Vali Loss: 1.009 Vali Acc: 0.750 Test Loss: 1.009 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749990).  Saving model ...
Epoch: 17 cost time: 0.890744686126709
Epoch: 17, Steps: 3 | Train Loss: 0.838 Vali Loss: 0.982 Vali Acc: 0.775 Test Loss: 0.982 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774990).  Saving model ...
Epoch: 18 cost time: 0.8063383102416992
Epoch: 18, Steps: 3 | Train Loss: 0.787 Vali Loss: 0.956 Vali Acc: 0.800 Test Loss: 0.956 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799990).  Saving model ...
Epoch: 19 cost time: 0.9916396141052246
Epoch: 19, Steps: 3 | Train Loss: 0.746 Vali Loss: 0.930 Vali Acc: 0.800 Test Loss: 0.930 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799991).  Saving model ...
Epoch: 20 cost time: 1.177692174911499
Epoch: 20, Steps: 3 | Train Loss: 0.748 Vali Loss: 0.905 Vali Acc: 0.800 Test Loss: 0.905 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 21 cost time: 0.9690473079681396
Epoch: 21, Steps: 3 | Train Loss: 0.704 Vali Loss: 0.882 Vali Acc: 0.800 Test Loss: 0.882 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 22 cost time: 1.047292709350586
Epoch: 22, Steps: 3 | Train Loss: 0.671 Vali Loss: 0.860 Vali Acc: 0.800 Test Loss: 0.860 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 23 cost time: 1.1270525455474854
Epoch: 23, Steps: 3 | Train Loss: 0.655 Vali Loss: 0.839 Vali Acc: 0.800 Test Loss: 0.839 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 24 cost time: 0.9994175434112549
Epoch: 24, Steps: 3 | Train Loss: 0.631 Vali Loss: 0.818 Vali Acc: 0.775 Test Loss: 0.818 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.911787748336792
Epoch: 25, Steps: 3 | Train Loss: 0.599 Vali Loss: 0.799 Vali Acc: 0.800 Test Loss: 0.799 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 26 cost time: 0.8712306022644043
Epoch: 26, Steps: 3 | Train Loss: 0.575 Vali Loss: 0.781 Vali Acc: 0.800 Test Loss: 0.781 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 27 cost time: 0.908191442489624
Epoch: 27, Steps: 3 | Train Loss: 0.585 Vali Loss: 0.764 Vali Acc: 0.825 Test Loss: 0.764 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 28 cost time: 0.7927348613739014
Epoch: 28, Steps: 3 | Train Loss: 0.538 Vali Loss: 0.748 Vali Acc: 0.825 Test Loss: 0.748 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 29 cost time: 0.9032707214355469
Epoch: 29, Steps: 3 | Train Loss: 0.536 Vali Loss: 0.733 Vali Acc: 0.825 Test Loss: 0.733 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 30 cost time: 0.8544156551361084
Epoch: 30, Steps: 3 | Train Loss: 0.506 Vali Loss: 0.718 Vali Acc: 0.825 Test Loss: 0.718 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 31 cost time: 1.0276298522949219
Epoch: 31, Steps: 3 | Train Loss: 0.498 Vali Loss: 0.704 Vali Acc: 0.825 Test Loss: 0.704 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 32 cost time: 0.9465951919555664
Epoch: 32, Steps: 3 | Train Loss: 0.468 Vali Loss: 0.691 Vali Acc: 0.825 Test Loss: 0.691 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 33 cost time: 1.0887706279754639
Epoch: 33, Steps: 3 | Train Loss: 0.450 Vali Loss: 0.679 Vali Acc: 0.825 Test Loss: 0.679 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 34 cost time: 1.3127620220184326
Epoch: 34, Steps: 3 | Train Loss: 0.446 Vali Loss: 0.668 Vali Acc: 0.825 Test Loss: 0.668 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 35 cost time: 0.8216297626495361
Epoch: 35, Steps: 3 | Train Loss: 0.424 Vali Loss: 0.657 Vali Acc: 0.825 Test Loss: 0.657 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 36 cost time: 0.8848135471343994
Epoch: 36, Steps: 3 | Train Loss: 0.421 Vali Loss: 0.647 Vali Acc: 0.850 Test Loss: 0.647 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849994).  Saving model ...
Epoch: 37 cost time: 1.2836170196533203
Epoch: 37, Steps: 3 | Train Loss: 0.375 Vali Loss: 0.638 Vali Acc: 0.850 Test Loss: 0.638 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 38 cost time: 1.06884765625
Epoch: 38, Steps: 3 | Train Loss: 0.369 Vali Loss: 0.629 Vali Acc: 0.850 Test Loss: 0.629 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 39 cost time: 1.224806308746338
Epoch: 39, Steps: 3 | Train Loss: 0.369 Vali Loss: 0.620 Vali Acc: 0.850 Test Loss: 0.620 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 40 cost time: 1.0934374332427979
Epoch: 40, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.613 Vali Acc: 0.850 Test Loss: 0.613 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 41 cost time: 1.1351191997528076
Epoch: 41, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.605 Vali Acc: 0.850 Test Loss: 0.605 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 42 cost time: 1.0483989715576172
Epoch: 42, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.599 Vali Acc: 0.850 Test Loss: 0.599 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 43 cost time: 1.030611515045166
Epoch: 43, Steps: 3 | Train Loss: 0.340 Vali Loss: 0.592 Vali Acc: 0.850 Test Loss: 0.592 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 44 cost time: 1.0244343280792236
Epoch: 44, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.586 Vali Acc: 0.850 Test Loss: 0.586 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 45 cost time: 1.2372517585754395
Epoch: 45, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.581 Vali Acc: 0.850 Test Loss: 0.581 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 46 cost time: 1.1715025901794434
Epoch: 46, Steps: 3 | Train Loss: 0.310 Vali Loss: 0.575 Vali Acc: 0.850 Test Loss: 0.575 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 47 cost time: 0.9522843360900879
Epoch: 47, Steps: 3 | Train Loss: 0.297 Vali Loss: 0.571 Vali Acc: 0.850 Test Loss: 0.571 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 48 cost time: 0.9926877021789551
Epoch: 48, Steps: 3 | Train Loss: 0.274 Vali Loss: 0.567 Vali Acc: 0.850 Test Loss: 0.567 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 49 cost time: 0.9308986663818359
Epoch: 49, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.563 Vali Acc: 0.850 Test Loss: 0.563 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 50 cost time: 0.9293673038482666
Epoch: 50, Steps: 3 | Train Loss: 0.272 Vali Loss: 0.559 Vali Acc: 0.850 Test Loss: 0.559 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 51 cost time: 0.8339779376983643
Epoch: 51, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.555 Vali Acc: 0.850 Test Loss: 0.555 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 52 cost time: 0.9302060604095459
Epoch: 52, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.552 Vali Acc: 0.850 Test Loss: 0.552 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 53 cost time: 1.0475976467132568
Epoch: 53, Steps: 3 | Train Loss: 0.246 Vali Loss: 0.549 Vali Acc: 0.850 Test Loss: 0.549 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 54 cost time: 1.0078315734863281
Epoch: 54, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.547 Vali Acc: 0.850 Test Loss: 0.547 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 55 cost time: 0.9550552368164062
Epoch: 55, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.545 Vali Acc: 0.850 Test Loss: 0.545 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 56 cost time: 1.1793768405914307
Epoch: 56, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.544 Vali Acc: 0.850 Test Loss: 0.544 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 57 cost time: 1.0653712749481201
Epoch: 57, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.543 Vali Acc: 0.850 Test Loss: 0.543 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 58 cost time: 1.5086207389831543
Epoch: 58, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.542 Vali Acc: 0.825 Test Loss: 0.542 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.8910346031188965
Epoch: 59, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.542 Vali Acc: 0.825 Test Loss: 0.542 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.1551661491394043
Epoch: 60, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.541 Vali Acc: 0.825 Test Loss: 0.541 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.9677503108978271
Epoch: 61, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.542 Vali Acc: 0.825 Test Loss: 0.542 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.8155951499938965
Epoch: 62, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.542 Vali Acc: 0.825 Test Loss: 0.542 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.2306442260742188
Epoch: 63, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.544 Vali Acc: 0.825 Test Loss: 0.544 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.362389087677002
Epoch: 64, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.545 Vali Acc: 0.825 Test Loss: 0.545 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 1.2158010005950928
Epoch: 65, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.547 Vali Acc: 0.825 Test Loss: 0.547 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 1.2460267543792725
Epoch: 66, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.549 Vali Acc: 0.825 Test Loss: 0.549 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 1.24233078956604
Epoch: 67, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.552 Vali Acc: 0.825 Test Loss: 0.552 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_DLinear_UEA_ftM_sl100_ll0_pl0_ma15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 22604
model size : 0.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_DLinear_UEA_ftM_sl100_ll0_pl0_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.9103596210479736
Epoch: 1, Steps: 3 | Train Loss: 1.392 Vali Loss: 1.398 Vali Acc: 0.100 Test Loss: 1.398 Test Acc: 0.100
Validation loss decreased (inf --> -0.099986).  Saving model ...
Epoch: 2 cost time: 0.8743610382080078
Epoch: 2, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.381 Vali Acc: 0.300 Test Loss: 1.381 Test Acc: 0.300
Validation loss decreased (-0.099986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.9886431694030762
Epoch: 3, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.368 Vali Acc: 0.375 Test Loss: 1.368 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 0.9389598369598389
Epoch: 4, Steps: 3 | Train Loss: 1.325 Vali Loss: 1.350 Vali Acc: 0.375 Test Loss: 1.350 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 5 cost time: 1.0355124473571777
Epoch: 5, Steps: 3 | Train Loss: 1.302 Vali Loss: 1.329 Vali Acc: 0.550 Test Loss: 1.329 Test Acc: 0.550
Validation loss decreased (-0.374986 --> -0.549987).  Saving model ...
Epoch: 6 cost time: 0.9076361656188965
Epoch: 6, Steps: 3 | Train Loss: 1.277 Vali Loss: 1.305 Vali Acc: 0.625 Test Loss: 1.305 Test Acc: 0.625
Validation loss decreased (-0.549987 --> -0.624987).  Saving model ...
Epoch: 7 cost time: 1.0096321105957031
Epoch: 7, Steps: 3 | Train Loss: 1.236 Vali Loss: 1.279 Vali Acc: 0.650 Test Loss: 1.279 Test Acc: 0.650
Validation loss decreased (-0.624987 --> -0.649987).  Saving model ...
Epoch: 8 cost time: 0.9824526309967041
Epoch: 8, Steps: 3 | Train Loss: 1.193 Vali Loss: 1.252 Vali Acc: 0.650 Test Loss: 1.252 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649987).  Saving model ...
Epoch: 9 cost time: 0.8955423831939697
Epoch: 9, Steps: 3 | Train Loss: 1.165 Vali Loss: 1.223 Vali Acc: 0.650 Test Loss: 1.223 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649988).  Saving model ...
Epoch: 10 cost time: 1.018064260482788
Epoch: 10, Steps: 3 | Train Loss: 1.115 Vali Loss: 1.194 Vali Acc: 0.650 Test Loss: 1.194 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 11 cost time: 0.7556383609771729
Epoch: 11, Steps: 3 | Train Loss: 1.084 Vali Loss: 1.164 Vali Acc: 0.650 Test Loss: 1.164 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 12 cost time: 0.9039046764373779
Epoch: 12, Steps: 3 | Train Loss: 1.071 Vali Loss: 1.134 Vali Acc: 0.650 Test Loss: 1.134 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649989).  Saving model ...
Epoch: 13 cost time: 1.335005283355713
Epoch: 13, Steps: 3 | Train Loss: 0.988 Vali Loss: 1.105 Vali Acc: 0.650 Test Loss: 1.105 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 14 cost time: 0.9307093620300293
Epoch: 14, Steps: 3 | Train Loss: 0.946 Vali Loss: 1.076 Vali Acc: 0.650 Test Loss: 1.076 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 15 cost time: 0.7738146781921387
Epoch: 15, Steps: 3 | Train Loss: 0.922 Vali Loss: 1.047 Vali Acc: 0.675 Test Loss: 1.047 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674990).  Saving model ...
Epoch: 16 cost time: 0.9232566356658936
Epoch: 16, Steps: 3 | Train Loss: 0.881 Vali Loss: 1.020 Vali Acc: 0.675 Test Loss: 1.020 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 17 cost time: 0.9487104415893555
Epoch: 17, Steps: 3 | Train Loss: 0.853 Vali Loss: 0.994 Vali Acc: 0.675 Test Loss: 0.994 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 18 cost time: 0.9104034900665283
Epoch: 18, Steps: 3 | Train Loss: 0.802 Vali Loss: 0.968 Vali Acc: 0.725 Test Loss: 0.968 Test Acc: 0.725
Validation loss decreased (-0.674990 --> -0.724990).  Saving model ...
Epoch: 19 cost time: 0.783085823059082
Epoch: 19, Steps: 3 | Train Loss: 0.760 Vali Loss: 0.943 Vali Acc: 0.725 Test Loss: 0.943 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 20 cost time: 1.0000064373016357
Epoch: 20, Steps: 3 | Train Loss: 0.762 Vali Loss: 0.919 Vali Acc: 0.775 Test Loss: 0.919 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774991).  Saving model ...
Epoch: 21 cost time: 1.1639840602874756
Epoch: 21, Steps: 3 | Train Loss: 0.719 Vali Loss: 0.896 Vali Acc: 0.775 Test Loss: 0.896 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 22 cost time: 0.8468942642211914
Epoch: 22, Steps: 3 | Train Loss: 0.688 Vali Loss: 0.874 Vali Acc: 0.750 Test Loss: 0.874 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0478339195251465
Epoch: 23, Steps: 3 | Train Loss: 0.671 Vali Loss: 0.853 Vali Acc: 0.775 Test Loss: 0.853 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 24 cost time: 1.0230340957641602
Epoch: 24, Steps: 3 | Train Loss: 0.651 Vali Loss: 0.833 Vali Acc: 0.750 Test Loss: 0.833 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1007120609283447
Epoch: 25, Steps: 3 | Train Loss: 0.616 Vali Loss: 0.814 Vali Acc: 0.750 Test Loss: 0.814 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.4601316452026367
Epoch: 26, Steps: 3 | Train Loss: 0.591 Vali Loss: 0.797 Vali Acc: 0.800 Test Loss: 0.797 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799992).  Saving model ...
Epoch: 27 cost time: 1.1051585674285889
Epoch: 27, Steps: 3 | Train Loss: 0.603 Vali Loss: 0.780 Vali Acc: 0.800 Test Loss: 0.780 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 28 cost time: 0.9403116703033447
Epoch: 28, Steps: 3 | Train Loss: 0.558 Vali Loss: 0.764 Vali Acc: 0.800 Test Loss: 0.764 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 29 cost time: 1.1830878257751465
Epoch: 29, Steps: 3 | Train Loss: 0.555 Vali Loss: 0.749 Vali Acc: 0.825 Test Loss: 0.749 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824993).  Saving model ...
Epoch: 30 cost time: 1.6109588146209717
Epoch: 30, Steps: 3 | Train Loss: 0.524 Vali Loss: 0.735 Vali Acc: 0.850 Test Loss: 0.735 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
Epoch: 31 cost time: 1.4099452495574951
Epoch: 31, Steps: 3 | Train Loss: 0.520 Vali Loss: 0.721 Vali Acc: 0.850 Test Loss: 0.721 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 32 cost time: 1.0251648426055908
Epoch: 32, Steps: 3 | Train Loss: 0.487 Vali Loss: 0.708 Vali Acc: 0.850 Test Loss: 0.708 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 33 cost time: 0.9296207427978516
Epoch: 33, Steps: 3 | Train Loss: 0.471 Vali Loss: 0.697 Vali Acc: 0.850 Test Loss: 0.697 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 34 cost time: 1.154193639755249
Epoch: 34, Steps: 3 | Train Loss: 0.466 Vali Loss: 0.686 Vali Acc: 0.850 Test Loss: 0.686 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 35 cost time: 1.3024086952209473
Epoch: 35, Steps: 3 | Train Loss: 0.444 Vali Loss: 0.675 Vali Acc: 0.850 Test Loss: 0.675 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 36 cost time: 1.2967610359191895
Epoch: 36, Steps: 3 | Train Loss: 0.438 Vali Loss: 0.665 Vali Acc: 0.825 Test Loss: 0.665 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8748657703399658
Epoch: 37, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.656 Vali Acc: 0.825 Test Loss: 0.656 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.3917105197906494
Epoch: 38, Steps: 3 | Train Loss: 0.391 Vali Loss: 0.647 Vali Acc: 0.825 Test Loss: 0.647 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.1497747898101807
Epoch: 39, Steps: 3 | Train Loss: 0.392 Vali Loss: 0.639 Vali Acc: 0.825 Test Loss: 0.639 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.8336348533630371
Epoch: 40, Steps: 3 | Train Loss: 0.390 Vali Loss: 0.631 Vali Acc: 0.825 Test Loss: 0.631 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.0129637718200684
Epoch: 41, Steps: 3 | Train Loss: 0.390 Vali Loss: 0.624 Vali Acc: 0.825 Test Loss: 0.624 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.194075584411621
Epoch: 42, Steps: 3 | Train Loss: 0.357 Vali Loss: 0.617 Vali Acc: 0.825 Test Loss: 0.617 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.9728460311889648
Epoch: 43, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.611 Vali Acc: 0.850 Test Loss: 0.611 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 44 cost time: 1.0538976192474365
Epoch: 44, Steps: 3 | Train Loss: 0.343 Vali Loss: 0.605 Vali Acc: 0.850 Test Loss: 0.605 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 45 cost time: 1.1487059593200684
Epoch: 45, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.599 Vali Acc: 0.850 Test Loss: 0.599 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 46 cost time: 0.7402024269104004
Epoch: 46, Steps: 3 | Train Loss: 0.328 Vali Loss: 0.594 Vali Acc: 0.850 Test Loss: 0.594 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 47 cost time: 1.1382930278778076
Epoch: 47, Steps: 3 | Train Loss: 0.314 Vali Loss: 0.589 Vali Acc: 0.850 Test Loss: 0.589 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 48 cost time: 1.211573600769043
Epoch: 48, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.584 Vali Acc: 0.850 Test Loss: 0.584 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 49 cost time: 1.4185113906860352
Epoch: 49, Steps: 3 | Train Loss: 0.311 Vali Loss: 0.580 Vali Acc: 0.850 Test Loss: 0.580 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 50 cost time: 0.9310235977172852
Epoch: 50, Steps: 3 | Train Loss: 0.293 Vali Loss: 0.576 Vali Acc: 0.850 Test Loss: 0.576 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 51 cost time: 0.855959415435791
Epoch: 51, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.572 Vali Acc: 0.850 Test Loss: 0.572 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 52 cost time: 0.7699048519134521
Epoch: 52, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.568 Vali Acc: 0.850 Test Loss: 0.568 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 53 cost time: 1.0772147178649902
Epoch: 53, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.564 Vali Acc: 0.850 Test Loss: 0.564 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 54 cost time: 0.8016819953918457
Epoch: 54, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.561 Vali Acc: 0.850 Test Loss: 0.561 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 55 cost time: 1.0370128154754639
Epoch: 55, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.558 Vali Acc: 0.850 Test Loss: 0.558 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 56 cost time: 0.9656710624694824
Epoch: 56, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.556 Vali Acc: 0.850 Test Loss: 0.556 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 57 cost time: 1.0034832954406738
Epoch: 57, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.555 Vali Acc: 0.850 Test Loss: 0.555 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 58 cost time: 1.0992217063903809
Epoch: 58, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.553 Vali Acc: 0.850 Test Loss: 0.553 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 59 cost time: 1.2914791107177734
Epoch: 59, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.551 Vali Acc: 0.850 Test Loss: 0.551 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 60 cost time: 1.1886928081512451
Epoch: 60, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.550 Vali Acc: 0.850 Test Loss: 0.550 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 61 cost time: 1.1517014503479004
Epoch: 61, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.549 Vali Acc: 0.850 Test Loss: 0.549 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 62 cost time: 1.2628288269042969
Epoch: 62, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.549 Vali Acc: 0.850 Test Loss: 0.549 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 63 cost time: 1.1025516986846924
Epoch: 63, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.549 Vali Acc: 0.825 Test Loss: 0.549 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.784543752670288
Epoch: 64, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.549 Vali Acc: 0.825 Test Loss: 0.549 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.188866138458252
Epoch: 65, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.550 Vali Acc: 0.825 Test Loss: 0.550 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.1201257705688477
Epoch: 66, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.552 Vali Acc: 0.825 Test Loss: 0.552 Test Acc: 0.825
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.9383947849273682
Epoch: 67, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.553 Vali Acc: 0.825 Test Loss: 0.553 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 1.0583467483520508
Epoch: 68, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.555 Vali Acc: 0.825 Test Loss: 0.555 Test Acc: 0.825
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 1.321336030960083
Epoch: 69, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.557 Vali Acc: 0.825 Test Loss: 0.557 Test Acc: 0.825
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 1.0183980464935303
Epoch: 70, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.558 Vali Acc: 0.825 Test Loss: 0.558 Test Acc: 0.825
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 1.0260803699493408
Epoch: 71, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.559 Vali Acc: 0.825 Test Loss: 0.559 Test Acc: 0.825
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 1.076857089996338
Epoch: 72, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.562 Vali Acc: 0.825 Test Loss: 0.562 Test Acc: 0.825
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_DLinear_UEA_ftM_sl100_ll0_pl0_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.85
model parameter : 22604
model size : 0.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_DLinear_UEA_ftM_sl100_ll0_pl0_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.1216752529144287
Epoch: 1, Steps: 3 | Train Loss: 1.392 Vali Loss: 1.398 Vali Acc: 0.100 Test Loss: 1.398 Test Acc: 0.100
Validation loss decreased (inf --> -0.099986).  Saving model ...
Epoch: 2 cost time: 0.8119063377380371
Epoch: 2, Steps: 3 | Train Loss: 1.364 Vali Loss: 1.382 Vali Acc: 0.275 Test Loss: 1.382 Test Acc: 0.275
Validation loss decreased (-0.099986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.8765468597412109
Epoch: 3, Steps: 3 | Train Loss: 1.350 Vali Loss: 1.369 Vali Acc: 0.375 Test Loss: 1.369 Test Acc: 0.375
Validation loss decreased (-0.274986 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 0.8939666748046875
Epoch: 4, Steps: 3 | Train Loss: 1.328 Vali Loss: 1.352 Vali Acc: 0.375 Test Loss: 1.352 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 5 cost time: 0.8018813133239746
Epoch: 5, Steps: 3 | Train Loss: 1.308 Vali Loss: 1.332 Vali Acc: 0.525 Test Loss: 1.332 Test Acc: 0.525
Validation loss decreased (-0.374986 --> -0.524987).  Saving model ...
Epoch: 6 cost time: 0.8045787811279297
Epoch: 6, Steps: 3 | Train Loss: 1.282 Vali Loss: 1.310 Vali Acc: 0.650 Test Loss: 1.310 Test Acc: 0.650
Validation loss decreased (-0.524987 --> -0.649987).  Saving model ...
Epoch: 7 cost time: 1.021867275238037
Epoch: 7, Steps: 3 | Train Loss: 1.245 Vali Loss: 1.285 Vali Acc: 0.675 Test Loss: 1.285 Test Acc: 0.675
Validation loss decreased (-0.649987 --> -0.674987).  Saving model ...
Epoch: 8 cost time: 0.9046845436096191
Epoch: 8, Steps: 3 | Train Loss: 1.205 Vali Loss: 1.260 Vali Acc: 0.675 Test Loss: 1.260 Test Acc: 0.675
Validation loss decreased (-0.674987 --> -0.674987).  Saving model ...
Epoch: 9 cost time: 0.8336501121520996
Epoch: 9, Steps: 3 | Train Loss: 1.177 Vali Loss: 1.233 Vali Acc: 0.700 Test Loss: 1.233 Test Acc: 0.700
Validation loss decreased (-0.674987 --> -0.699988).  Saving model ...
Epoch: 10 cost time: 1.0934669971466064
Epoch: 10, Steps: 3 | Train Loss: 1.131 Vali Loss: 1.204 Vali Acc: 0.700 Test Loss: 1.204 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699988).  Saving model ...
Epoch: 11 cost time: 1.0575006008148193
Epoch: 11, Steps: 3 | Train Loss: 1.099 Vali Loss: 1.176 Vali Acc: 0.700 Test Loss: 1.176 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699988).  Saving model ...
Epoch: 12 cost time: 1.1275081634521484
Epoch: 12, Steps: 3 | Train Loss: 1.083 Vali Loss: 1.148 Vali Acc: 0.700 Test Loss: 1.148 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699989).  Saving model ...
Epoch: 13 cost time: 0.8061158657073975
Epoch: 13, Steps: 3 | Train Loss: 1.010 Vali Loss: 1.120 Vali Acc: 0.725 Test Loss: 1.120 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724989).  Saving model ...
Epoch: 14 cost time: 0.916344404220581
Epoch: 14, Steps: 3 | Train Loss: 0.969 Vali Loss: 1.092 Vali Acc: 0.725 Test Loss: 1.092 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 15 cost time: 1.0059781074523926
Epoch: 15, Steps: 3 | Train Loss: 0.939 Vali Loss: 1.064 Vali Acc: 0.725 Test Loss: 1.064 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 16 cost time: 0.9039342403411865
Epoch: 16, Steps: 3 | Train Loss: 0.900 Vali Loss: 1.037 Vali Acc: 0.750 Test Loss: 1.037 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749990).  Saving model ...
Epoch: 17 cost time: 0.7928454875946045
Epoch: 17, Steps: 3 | Train Loss: 0.870 Vali Loss: 1.012 Vali Acc: 0.750 Test Loss: 1.012 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 18 cost time: 0.8873593807220459
Epoch: 18, Steps: 3 | Train Loss: 0.821 Vali Loss: 0.986 Vali Acc: 0.800 Test Loss: 0.986 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799990).  Saving model ...
Epoch: 19 cost time: 0.730902910232544
Epoch: 19, Steps: 3 | Train Loss: 0.777 Vali Loss: 0.962 Vali Acc: 0.825 Test Loss: 0.962 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824990).  Saving model ...
Epoch: 20 cost time: 0.7428760528564453
Epoch: 20, Steps: 3 | Train Loss: 0.782 Vali Loss: 0.938 Vali Acc: 0.825 Test Loss: 0.938 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824991).  Saving model ...
Epoch: 21 cost time: 0.778954267501831
Epoch: 21, Steps: 3 | Train Loss: 0.739 Vali Loss: 0.915 Vali Acc: 0.825 Test Loss: 0.915 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 22 cost time: 0.8344378471374512
Epoch: 22, Steps: 3 | Train Loss: 0.706 Vali Loss: 0.893 Vali Acc: 0.825 Test Loss: 0.893 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 23 cost time: 0.7698409557342529
Epoch: 23, Steps: 3 | Train Loss: 0.686 Vali Loss: 0.872 Vali Acc: 0.825 Test Loss: 0.872 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 24 cost time: 0.725121259689331
Epoch: 24, Steps: 3 | Train Loss: 0.665 Vali Loss: 0.852 Vali Acc: 0.825 Test Loss: 0.852 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 25 cost time: 1.094346046447754
Epoch: 25, Steps: 3 | Train Loss: 0.633 Vali Loss: 0.832 Vali Acc: 0.825 Test Loss: 0.832 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 26 cost time: 1.0126888751983643
Epoch: 26, Steps: 3 | Train Loss: 0.606 Vali Loss: 0.814 Vali Acc: 0.850 Test Loss: 0.814 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 27 cost time: 0.9085712432861328
Epoch: 27, Steps: 3 | Train Loss: 0.618 Vali Loss: 0.797 Vali Acc: 0.850 Test Loss: 0.797 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 28 cost time: 0.9428560733795166
Epoch: 28, Steps: 3 | Train Loss: 0.571 Vali Loss: 0.780 Vali Acc: 0.875 Test Loss: 0.780 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874992).  Saving model ...
Epoch: 29 cost time: 0.7079501152038574
Epoch: 29, Steps: 3 | Train Loss: 0.566 Vali Loss: 0.765 Vali Acc: 0.875 Test Loss: 0.765 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 30 cost time: 0.8163259029388428
Epoch: 30, Steps: 3 | Train Loss: 0.537 Vali Loss: 0.750 Vali Acc: 0.875 Test Loss: 0.750 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 31 cost time: 0.9835693836212158
Epoch: 31, Steps: 3 | Train Loss: 0.529 Vali Loss: 0.735 Vali Acc: 0.875 Test Loss: 0.735 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 32 cost time: 0.8070516586303711
Epoch: 32, Steps: 3 | Train Loss: 0.498 Vali Loss: 0.721 Vali Acc: 0.875 Test Loss: 0.721 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 33 cost time: 0.882845401763916
Epoch: 33, Steps: 3 | Train Loss: 0.481 Vali Loss: 0.708 Vali Acc: 0.875 Test Loss: 0.708 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 34 cost time: 0.7574701309204102
Epoch: 34, Steps: 3 | Train Loss: 0.474 Vali Loss: 0.696 Vali Acc: 0.875 Test Loss: 0.696 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 35 cost time: 0.8099558353424072
Epoch: 35, Steps: 3 | Train Loss: 0.454 Vali Loss: 0.684 Vali Acc: 0.875 Test Loss: 0.684 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 36 cost time: 0.7728846073150635
Epoch: 36, Steps: 3 | Train Loss: 0.447 Vali Loss: 0.673 Vali Acc: 0.875 Test Loss: 0.673 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 37 cost time: 0.9017579555511475
Epoch: 37, Steps: 3 | Train Loss: 0.405 Vali Loss: 0.662 Vali Acc: 0.875 Test Loss: 0.662 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 38 cost time: 0.8965208530426025
Epoch: 38, Steps: 3 | Train Loss: 0.397 Vali Loss: 0.652 Vali Acc: 0.875 Test Loss: 0.652 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 39 cost time: 1.023526668548584
Epoch: 39, Steps: 3 | Train Loss: 0.400 Vali Loss: 0.642 Vali Acc: 0.875 Test Loss: 0.642 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 40 cost time: 0.880610466003418
Epoch: 40, Steps: 3 | Train Loss: 0.397 Vali Loss: 0.633 Vali Acc: 0.875 Test Loss: 0.633 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 41 cost time: 0.9778537750244141
Epoch: 41, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.625 Vali Acc: 0.875 Test Loss: 0.625 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 42 cost time: 0.7988815307617188
Epoch: 42, Steps: 3 | Train Loss: 0.362 Vali Loss: 0.616 Vali Acc: 0.875 Test Loss: 0.616 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 43 cost time: 0.7664093971252441
Epoch: 43, Steps: 3 | Train Loss: 0.370 Vali Loss: 0.609 Vali Acc: 0.850 Test Loss: 0.609 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8862364292144775
Epoch: 44, Steps: 3 | Train Loss: 0.349 Vali Loss: 0.601 Vali Acc: 0.850 Test Loss: 0.601 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.8983988761901855
Epoch: 45, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.594 Vali Acc: 0.850 Test Loss: 0.594 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.00412917137146
Epoch: 46, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.588 Vali Acc: 0.850 Test Loss: 0.588 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.9697706699371338
Epoch: 47, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.582 Vali Acc: 0.850 Test Loss: 0.582 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.9908814430236816
Epoch: 48, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.576 Vali Acc: 0.850 Test Loss: 0.576 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.9488091468811035
Epoch: 49, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.570 Vali Acc: 0.850 Test Loss: 0.570 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.8105049133300781
Epoch: 50, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.565 Vali Acc: 0.850 Test Loss: 0.565 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.7149462699890137
Epoch: 51, Steps: 3 | Train Loss: 0.293 Vali Loss: 0.560 Vali Acc: 0.850 Test Loss: 0.560 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.005077838897705
Epoch: 52, Steps: 3 | Train Loss: 0.287 Vali Loss: 0.555 Vali Acc: 0.850 Test Loss: 0.555 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_DLinear_UEA_ftM_sl100_ll0_pl0_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 22604
model size : 0.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_DLinear_UEA_ftM_sl100_ll0_pl0_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.985790252685547
Epoch: 1, Steps: 3 | Train Loss: 1.392 Vali Loss: 1.398 Vali Acc: 0.100 Test Loss: 1.398 Test Acc: 0.100
Validation loss decreased (inf --> -0.099986).  Saving model ...
Epoch: 2 cost time: 0.9178297519683838
Epoch: 2, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.381 Vali Acc: 0.275 Test Loss: 1.381 Test Acc: 0.275
Validation loss decreased (-0.099986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 1.0194880962371826
Epoch: 3, Steps: 3 | Train Loss: 1.350 Vali Loss: 1.369 Vali Acc: 0.375 Test Loss: 1.369 Test Acc: 0.375
Validation loss decreased (-0.274986 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 0.7282726764678955
Epoch: 4, Steps: 3 | Train Loss: 1.328 Vali Loss: 1.353 Vali Acc: 0.375 Test Loss: 1.353 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 5 cost time: 0.9288225173950195
Epoch: 5, Steps: 3 | Train Loss: 1.308 Vali Loss: 1.333 Vali Acc: 0.525 Test Loss: 1.333 Test Acc: 0.525
Validation loss decreased (-0.374986 --> -0.524987).  Saving model ...
Epoch: 6 cost time: 0.880669355392456
Epoch: 6, Steps: 3 | Train Loss: 1.283 Vali Loss: 1.311 Vali Acc: 0.625 Test Loss: 1.311 Test Acc: 0.625
Validation loss decreased (-0.524987 --> -0.624987).  Saving model ...
Epoch: 7 cost time: 1.0398004055023193
Epoch: 7, Steps: 3 | Train Loss: 1.245 Vali Loss: 1.287 Vali Acc: 0.675 Test Loss: 1.287 Test Acc: 0.675
Validation loss decreased (-0.624987 --> -0.674987).  Saving model ...
Epoch: 8 cost time: 0.8061196804046631
Epoch: 8, Steps: 3 | Train Loss: 1.206 Vali Loss: 1.262 Vali Acc: 0.675 Test Loss: 1.262 Test Acc: 0.675
Validation loss decreased (-0.674987 --> -0.674987).  Saving model ...
Epoch: 9 cost time: 0.8883216381072998
Epoch: 9, Steps: 3 | Train Loss: 1.178 Vali Loss: 1.235 Vali Acc: 0.700 Test Loss: 1.235 Test Acc: 0.700
Validation loss decreased (-0.674987 --> -0.699988).  Saving model ...
Epoch: 10 cost time: 0.8071067333221436
Epoch: 10, Steps: 3 | Train Loss: 1.131 Vali Loss: 1.207 Vali Acc: 0.700 Test Loss: 1.207 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699988).  Saving model ...
Epoch: 11 cost time: 0.9259114265441895
Epoch: 11, Steps: 3 | Train Loss: 1.099 Vali Loss: 1.179 Vali Acc: 0.700 Test Loss: 1.179 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699988).  Saving model ...
Epoch: 12 cost time: 0.9683852195739746
Epoch: 12, Steps: 3 | Train Loss: 1.085 Vali Loss: 1.151 Vali Acc: 0.725 Test Loss: 1.151 Test Acc: 0.725
Validation loss decreased (-0.699988 --> -0.724988).  Saving model ...
Epoch: 13 cost time: 0.8020353317260742
Epoch: 13, Steps: 3 | Train Loss: 1.011 Vali Loss: 1.123 Vali Acc: 0.725 Test Loss: 1.123 Test Acc: 0.725
Validation loss decreased (-0.724988 --> -0.724989).  Saving model ...
Epoch: 14 cost time: 0.8476555347442627
Epoch: 14, Steps: 3 | Train Loss: 0.969 Vali Loss: 1.096 Vali Acc: 0.725 Test Loss: 1.096 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 15 cost time: 0.8147857189178467
Epoch: 15, Steps: 3 | Train Loss: 0.941 Vali Loss: 1.069 Vali Acc: 0.725 Test Loss: 1.069 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 16 cost time: 0.6885995864868164
Epoch: 16, Steps: 3 | Train Loss: 0.901 Vali Loss: 1.042 Vali Acc: 0.775 Test Loss: 1.042 Test Acc: 0.775
Validation loss decreased (-0.724989 --> -0.774990).  Saving model ...
Epoch: 17 cost time: 0.7268526554107666
Epoch: 17, Steps: 3 | Train Loss: 0.871 Vali Loss: 1.017 Vali Acc: 0.825 Test Loss: 1.017 Test Acc: 0.825
Validation loss decreased (-0.774990 --> -0.824990).  Saving model ...
Epoch: 18 cost time: 0.7973232269287109
Epoch: 18, Steps: 3 | Train Loss: 0.823 Vali Loss: 0.992 Vali Acc: 0.825 Test Loss: 0.992 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824990).  Saving model ...
Epoch: 19 cost time: 0.9283857345581055
Epoch: 19, Steps: 3 | Train Loss: 0.781 Vali Loss: 0.968 Vali Acc: 0.825 Test Loss: 0.968 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824990).  Saving model ...
Epoch: 20 cost time: 0.7391979694366455
Epoch: 20, Steps: 3 | Train Loss: 0.784 Vali Loss: 0.944 Vali Acc: 0.825 Test Loss: 0.944 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824991).  Saving model ...
Epoch: 21 cost time: 0.941119909286499
Epoch: 21, Steps: 3 | Train Loss: 0.742 Vali Loss: 0.921 Vali Acc: 0.825 Test Loss: 0.921 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 22 cost time: 0.8561911582946777
Epoch: 22, Steps: 3 | Train Loss: 0.709 Vali Loss: 0.900 Vali Acc: 0.825 Test Loss: 0.900 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 23 cost time: 0.8412213325500488
Epoch: 23, Steps: 3 | Train Loss: 0.690 Vali Loss: 0.879 Vali Acc: 0.825 Test Loss: 0.879 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 24 cost time: 0.6448945999145508
Epoch: 24, Steps: 3 | Train Loss: 0.668 Vali Loss: 0.858 Vali Acc: 0.825 Test Loss: 0.858 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 25 cost time: 0.6448953151702881
Epoch: 25, Steps: 3 | Train Loss: 0.635 Vali Loss: 0.839 Vali Acc: 0.850 Test Loss: 0.839 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849992).  Saving model ...
Epoch: 26 cost time: 0.7926387786865234
Epoch: 26, Steps: 3 | Train Loss: 0.609 Vali Loss: 0.821 Vali Acc: 0.850 Test Loss: 0.821 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 27 cost time: 0.7635595798492432
Epoch: 27, Steps: 3 | Train Loss: 0.621 Vali Loss: 0.804 Vali Acc: 0.875 Test Loss: 0.804 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874992).  Saving model ...
Epoch: 28 cost time: 0.8342800140380859
Epoch: 28, Steps: 3 | Train Loss: 0.574 Vali Loss: 0.787 Vali Acc: 0.875 Test Loss: 0.787 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 29 cost time: 0.7600891590118408
Epoch: 29, Steps: 3 | Train Loss: 0.568 Vali Loss: 0.772 Vali Acc: 0.875 Test Loss: 0.772 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 30 cost time: 0.7694189548492432
Epoch: 30, Steps: 3 | Train Loss: 0.539 Vali Loss: 0.756 Vali Acc: 0.875 Test Loss: 0.756 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 31 cost time: 0.7945997714996338
Epoch: 31, Steps: 3 | Train Loss: 0.532 Vali Loss: 0.741 Vali Acc: 0.875 Test Loss: 0.741 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 32 cost time: 0.8361799716949463
Epoch: 32, Steps: 3 | Train Loss: 0.500 Vali Loss: 0.728 Vali Acc: 0.875 Test Loss: 0.728 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 33 cost time: 0.9159786701202393
Epoch: 33, Steps: 3 | Train Loss: 0.482 Vali Loss: 0.714 Vali Acc: 0.875 Test Loss: 0.714 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 34 cost time: 0.9332640171051025
Epoch: 34, Steps: 3 | Train Loss: 0.474 Vali Loss: 0.702 Vali Acc: 0.875 Test Loss: 0.702 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 35 cost time: 1.0814619064331055
Epoch: 35, Steps: 3 | Train Loss: 0.455 Vali Loss: 0.690 Vali Acc: 0.875 Test Loss: 0.690 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 36 cost time: 0.8387057781219482
Epoch: 36, Steps: 3 | Train Loss: 0.449 Vali Loss: 0.679 Vali Acc: 0.875 Test Loss: 0.679 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 37 cost time: 0.68076491355896
Epoch: 37, Steps: 3 | Train Loss: 0.405 Vali Loss: 0.668 Vali Acc: 0.875 Test Loss: 0.668 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 38 cost time: 0.8201568126678467
Epoch: 38, Steps: 3 | Train Loss: 0.397 Vali Loss: 0.657 Vali Acc: 0.875 Test Loss: 0.657 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 39 cost time: 0.6926603317260742
Epoch: 39, Steps: 3 | Train Loss: 0.398 Vali Loss: 0.648 Vali Acc: 0.875 Test Loss: 0.648 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 40 cost time: 0.6862301826477051
Epoch: 40, Steps: 3 | Train Loss: 0.397 Vali Loss: 0.639 Vali Acc: 0.875 Test Loss: 0.639 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 41 cost time: 0.7211871147155762
Epoch: 41, Steps: 3 | Train Loss: 0.395 Vali Loss: 0.630 Vali Acc: 0.875 Test Loss: 0.630 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 42 cost time: 0.7184271812438965
Epoch: 42, Steps: 3 | Train Loss: 0.360 Vali Loss: 0.622 Vali Acc: 0.875 Test Loss: 0.622 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 43 cost time: 0.7152788639068604
Epoch: 43, Steps: 3 | Train Loss: 0.369 Vali Loss: 0.614 Vali Acc: 0.875 Test Loss: 0.614 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 44 cost time: 0.6675693988800049
Epoch: 44, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.606 Vali Acc: 0.850 Test Loss: 0.606 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6256513595581055
Epoch: 45, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.599 Vali Acc: 0.850 Test Loss: 0.599 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.7406051158905029
Epoch: 46, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.592 Vali Acc: 0.850 Test Loss: 0.592 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.6762778759002686
Epoch: 47, Steps: 3 | Train Loss: 0.319 Vali Loss: 0.586 Vali Acc: 0.850 Test Loss: 0.586 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.8222317695617676
Epoch: 48, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.580 Vali Acc: 0.850 Test Loss: 0.580 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.8673486709594727
Epoch: 49, Steps: 3 | Train Loss: 0.311 Vali Loss: 0.575 Vali Acc: 0.850 Test Loss: 0.575 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.9355010986328125
Epoch: 50, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.569 Vali Acc: 0.850 Test Loss: 0.569 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.7594945430755615
Epoch: 51, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.564 Vali Acc: 0.850 Test Loss: 0.564 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.7705426216125488
Epoch: 52, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.559 Vali Acc: 0.850 Test Loss: 0.559 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.7898004055023193
Epoch: 53, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.555 Vali Acc: 0.850 Test Loss: 0.555 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_DLinear_UEA_ftM_sl100_ll0_pl0_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 22604
model size : 0.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_DLinear_UEA_ftM_sl100_ll0_pl0_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.7905361652374268
Epoch: 1, Steps: 3 | Train Loss: 1.392 Vali Loss: 1.398 Vali Acc: 0.100 Test Loss: 1.398 Test Acc: 0.100
Validation loss decreased (inf --> -0.099986).  Saving model ...
Epoch: 2 cost time: 0.8588838577270508
Epoch: 2, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.382 Vali Acc: 0.250 Test Loss: 1.382 Test Acc: 0.250
Validation loss decreased (-0.099986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 0.8632380962371826
Epoch: 3, Steps: 3 | Train Loss: 1.350 Vali Loss: 1.370 Vali Acc: 0.375 Test Loss: 1.370 Test Acc: 0.375
Validation loss decreased (-0.249986 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 0.7803707122802734
Epoch: 4, Steps: 3 | Train Loss: 1.329 Vali Loss: 1.354 Vali Acc: 0.375 Test Loss: 1.354 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 5 cost time: 0.6655011177062988
Epoch: 5, Steps: 3 | Train Loss: 1.309 Vali Loss: 1.334 Vali Acc: 0.475 Test Loss: 1.334 Test Acc: 0.475
Validation loss decreased (-0.374986 --> -0.474987).  Saving model ...
Epoch: 6 cost time: 0.7614006996154785
Epoch: 6, Steps: 3 | Train Loss: 1.284 Vali Loss: 1.313 Vali Acc: 0.625 Test Loss: 1.313 Test Acc: 0.625
Validation loss decreased (-0.474987 --> -0.624987).  Saving model ...
Epoch: 7 cost time: 0.7186522483825684
Epoch: 7, Steps: 3 | Train Loss: 1.247 Vali Loss: 1.289 Vali Acc: 0.675 Test Loss: 1.289 Test Acc: 0.675
Validation loss decreased (-0.624987 --> -0.674987).  Saving model ...
Epoch: 8 cost time: 0.8189480304718018
Epoch: 8, Steps: 3 | Train Loss: 1.210 Vali Loss: 1.265 Vali Acc: 0.700 Test Loss: 1.265 Test Acc: 0.700
Validation loss decreased (-0.674987 --> -0.699987).  Saving model ...
Epoch: 9 cost time: 0.9117705821990967
Epoch: 9, Steps: 3 | Train Loss: 1.182 Vali Loss: 1.239 Vali Acc: 0.700 Test Loss: 1.239 Test Acc: 0.700
Validation loss decreased (-0.699987 --> -0.699988).  Saving model ...
Epoch: 10 cost time: 0.6750860214233398
Epoch: 10, Steps: 3 | Train Loss: 1.136 Vali Loss: 1.211 Vali Acc: 0.700 Test Loss: 1.211 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699988).  Saving model ...
Epoch: 11 cost time: 0.7900290489196777
Epoch: 11, Steps: 3 | Train Loss: 1.103 Vali Loss: 1.184 Vali Acc: 0.700 Test Loss: 1.184 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699988).  Saving model ...
Epoch: 12 cost time: 0.7679681777954102
Epoch: 12, Steps: 3 | Train Loss: 1.090 Vali Loss: 1.157 Vali Acc: 0.725 Test Loss: 1.157 Test Acc: 0.725
Validation loss decreased (-0.699988 --> -0.724988).  Saving model ...
Epoch: 13 cost time: 0.7424671649932861
Epoch: 13, Steps: 3 | Train Loss: 1.017 Vali Loss: 1.129 Vali Acc: 0.725 Test Loss: 1.129 Test Acc: 0.725
Validation loss decreased (-0.724988 --> -0.724989).  Saving model ...
Epoch: 14 cost time: 0.6700518131256104
Epoch: 14, Steps: 3 | Train Loss: 0.975 Vali Loss: 1.102 Vali Acc: 0.725 Test Loss: 1.102 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 15 cost time: 0.8042178153991699
Epoch: 15, Steps: 3 | Train Loss: 0.946 Vali Loss: 1.076 Vali Acc: 0.750 Test Loss: 1.076 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749989).  Saving model ...
Epoch: 16 cost time: 0.6622469425201416
Epoch: 16, Steps: 3 | Train Loss: 0.908 Vali Loss: 1.050 Vali Acc: 0.750 Test Loss: 1.050 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749990).  Saving model ...
Epoch: 17 cost time: 0.8769409656524658
Epoch: 17, Steps: 3 | Train Loss: 0.877 Vali Loss: 1.024 Vali Acc: 0.825 Test Loss: 1.024 Test Acc: 0.825
Validation loss decreased (-0.749990 --> -0.824990).  Saving model ...
Epoch: 18 cost time: 0.9416978359222412
Epoch: 18, Steps: 3 | Train Loss: 0.829 Vali Loss: 1.000 Vali Acc: 0.825 Test Loss: 1.000 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824990).  Saving model ...
Epoch: 19 cost time: 1.1037955284118652
Epoch: 19, Steps: 3 | Train Loss: 0.788 Vali Loss: 0.976 Vali Acc: 0.825 Test Loss: 0.976 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824990).  Saving model ...
Epoch: 20 cost time: 1.0821893215179443
Epoch: 20, Steps: 3 | Train Loss: 0.790 Vali Loss: 0.953 Vali Acc: 0.825 Test Loss: 0.953 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824990).  Saving model ...
Epoch: 21 cost time: 0.9638354778289795
Epoch: 21, Steps: 3 | Train Loss: 0.749 Vali Loss: 0.930 Vali Acc: 0.825 Test Loss: 0.930 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824991).  Saving model ...
Epoch: 22 cost time: 0.9714124202728271
Epoch: 22, Steps: 3 | Train Loss: 0.717 Vali Loss: 0.909 Vali Acc: 0.825 Test Loss: 0.909 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 23 cost time: 0.9506900310516357
Epoch: 23, Steps: 3 | Train Loss: 0.697 Vali Loss: 0.888 Vali Acc: 0.825 Test Loss: 0.888 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 24 cost time: 1.0368022918701172
Epoch: 24, Steps: 3 | Train Loss: 0.674 Vali Loss: 0.868 Vali Acc: 0.825 Test Loss: 0.868 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 25 cost time: 0.958423376083374
Epoch: 25, Steps: 3 | Train Loss: 0.642 Vali Loss: 0.849 Vali Acc: 0.850 Test Loss: 0.849 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849992).  Saving model ...
Epoch: 26 cost time: 0.9987671375274658
Epoch: 26, Steps: 3 | Train Loss: 0.615 Vali Loss: 0.831 Vali Acc: 0.850 Test Loss: 0.831 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 27 cost time: 0.9260945320129395
Epoch: 27, Steps: 3 | Train Loss: 0.628 Vali Loss: 0.813 Vali Acc: 0.875 Test Loss: 0.813 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874992).  Saving model ...
Epoch: 28 cost time: 0.9949429035186768
Epoch: 28, Steps: 3 | Train Loss: 0.580 Vali Loss: 0.797 Vali Acc: 0.875 Test Loss: 0.797 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 29 cost time: 0.7301876544952393
Epoch: 29, Steps: 3 | Train Loss: 0.574 Vali Loss: 0.781 Vali Acc: 0.875 Test Loss: 0.781 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 30 cost time: 1.103708267211914
Epoch: 30, Steps: 3 | Train Loss: 0.546 Vali Loss: 0.766 Vali Acc: 0.875 Test Loss: 0.766 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 31 cost time: 1.0982465744018555
Epoch: 31, Steps: 3 | Train Loss: 0.539 Vali Loss: 0.751 Vali Acc: 0.875 Test Loss: 0.751 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 32 cost time: 0.9399027824401855
Epoch: 32, Steps: 3 | Train Loss: 0.506 Vali Loss: 0.737 Vali Acc: 0.875 Test Loss: 0.737 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 33 cost time: 0.7115845680236816
Epoch: 33, Steps: 3 | Train Loss: 0.488 Vali Loss: 0.724 Vali Acc: 0.875 Test Loss: 0.724 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 34 cost time: 1.2102558612823486
Epoch: 34, Steps: 3 | Train Loss: 0.480 Vali Loss: 0.712 Vali Acc: 0.875 Test Loss: 0.712 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 35 cost time: 1.2505905628204346
Epoch: 35, Steps: 3 | Train Loss: 0.462 Vali Loss: 0.700 Vali Acc: 0.875 Test Loss: 0.700 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 36 cost time: 0.8486506938934326
Epoch: 36, Steps: 3 | Train Loss: 0.456 Vali Loss: 0.689 Vali Acc: 0.875 Test Loss: 0.689 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 37 cost time: 0.7045533657073975
Epoch: 37, Steps: 3 | Train Loss: 0.411 Vali Loss: 0.678 Vali Acc: 0.875 Test Loss: 0.678 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 38 cost time: 0.8338158130645752
Epoch: 38, Steps: 3 | Train Loss: 0.403 Vali Loss: 0.667 Vali Acc: 0.875 Test Loss: 0.667 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 39 cost time: 1.0517537593841553
Epoch: 39, Steps: 3 | Train Loss: 0.405 Vali Loss: 0.658 Vali Acc: 0.875 Test Loss: 0.658 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 40 cost time: 0.9529383182525635
Epoch: 40, Steps: 3 | Train Loss: 0.403 Vali Loss: 0.649 Vali Acc: 0.875 Test Loss: 0.649 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 41 cost time: 1.0116424560546875
Epoch: 41, Steps: 3 | Train Loss: 0.401 Vali Loss: 0.640 Vali Acc: 0.875 Test Loss: 0.640 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 42 cost time: 0.7821550369262695
Epoch: 42, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.632 Vali Acc: 0.875 Test Loss: 0.632 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 43 cost time: 0.8931000232696533
Epoch: 43, Steps: 3 | Train Loss: 0.376 Vali Loss: 0.624 Vali Acc: 0.850 Test Loss: 0.624 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9153149127960205
Epoch: 44, Steps: 3 | Train Loss: 0.353 Vali Loss: 0.616 Vali Acc: 0.850 Test Loss: 0.616 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.9605505466461182
Epoch: 45, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.609 Vali Acc: 0.850 Test Loss: 0.609 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.6806528568267822
Epoch: 46, Steps: 3 | Train Loss: 0.340 Vali Loss: 0.602 Vali Acc: 0.850 Test Loss: 0.602 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.8909180164337158
Epoch: 47, Steps: 3 | Train Loss: 0.325 Vali Loss: 0.596 Vali Acc: 0.850 Test Loss: 0.596 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.7582595348358154
Epoch: 48, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.590 Vali Acc: 0.850 Test Loss: 0.590 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.880446195602417
Epoch: 49, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.584 Vali Acc: 0.850 Test Loss: 0.584 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.1373116970062256
Epoch: 50, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.579 Vali Acc: 0.850 Test Loss: 0.579 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.0928404331207275
Epoch: 51, Steps: 3 | Train Loss: 0.295 Vali Loss: 0.573 Vali Acc: 0.850 Test Loss: 0.573 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.1880438327789307
Epoch: 52, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.568 Vali Acc: 0.850 Test Loss: 0.568 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_DLinear_UEA_ftM_sl100_ll0_pl0_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 22604
model size : 0.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_DLinear_UEA_ftM_sl100_ll0_pl0_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 2.9673051834106445
Epoch: 1, Steps: 3 | Train Loss: 1.392 Vali Loss: 1.398 Vali Acc: 0.100 Test Loss: 1.398 Test Acc: 0.100
Validation loss decreased (inf --> -0.099986).  Saving model ...
Epoch: 2 cost time: 0.9645040035247803
Epoch: 2, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.381 Vali Acc: 0.250 Test Loss: 1.381 Test Acc: 0.250
Validation loss decreased (-0.099986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 0.7688305377960205
Epoch: 3, Steps: 3 | Train Loss: 1.350 Vali Loss: 1.370 Vali Acc: 0.375 Test Loss: 1.370 Test Acc: 0.375
Validation loss decreased (-0.249986 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 0.791658878326416
Epoch: 4, Steps: 3 | Train Loss: 1.328 Vali Loss: 1.354 Vali Acc: 0.375 Test Loss: 1.354 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 5 cost time: 0.8025987148284912
Epoch: 5, Steps: 3 | Train Loss: 1.307 Vali Loss: 1.335 Vali Acc: 0.500 Test Loss: 1.335 Test Acc: 0.500
Validation loss decreased (-0.374986 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 0.9651226997375488
Epoch: 6, Steps: 3 | Train Loss: 1.283 Vali Loss: 1.313 Vali Acc: 0.625 Test Loss: 1.313 Test Acc: 0.625
Validation loss decreased (-0.499987 --> -0.624987).  Saving model ...
Epoch: 7 cost time: 0.9446144104003906
Epoch: 7, Steps: 3 | Train Loss: 1.245 Vali Loss: 1.290 Vali Acc: 0.675 Test Loss: 1.290 Test Acc: 0.675
Validation loss decreased (-0.624987 --> -0.674987).  Saving model ...
Epoch: 8 cost time: 1.18448805809021
Epoch: 8, Steps: 3 | Train Loss: 1.206 Vali Loss: 1.266 Vali Acc: 0.700 Test Loss: 1.266 Test Acc: 0.700
Validation loss decreased (-0.674987 --> -0.699987).  Saving model ...
Epoch: 9 cost time: 1.095989465713501
Epoch: 9, Steps: 3 | Train Loss: 1.179 Vali Loss: 1.240 Vali Acc: 0.700 Test Loss: 1.240 Test Acc: 0.700
Validation loss decreased (-0.699987 --> -0.699988).  Saving model ...
Epoch: 10 cost time: 0.7642455101013184
Epoch: 10, Steps: 3 | Train Loss: 1.133 Vali Loss: 1.214 Vali Acc: 0.700 Test Loss: 1.214 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699988).  Saving model ...
Epoch: 11 cost time: 0.7922477722167969
Epoch: 11, Steps: 3 | Train Loss: 1.100 Vali Loss: 1.187 Vali Acc: 0.725 Test Loss: 1.187 Test Acc: 0.725
Validation loss decreased (-0.699988 --> -0.724988).  Saving model ...
Epoch: 12 cost time: 1.1834707260131836
Epoch: 12, Steps: 3 | Train Loss: 1.088 Vali Loss: 1.160 Vali Acc: 0.725 Test Loss: 1.160 Test Acc: 0.725
Validation loss decreased (-0.724988 --> -0.724988).  Saving model ...
Epoch: 13 cost time: 1.1423940658569336
Epoch: 13, Steps: 3 | Train Loss: 1.012 Vali Loss: 1.133 Vali Acc: 0.700 Test Loss: 1.133 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0331907272338867
Epoch: 14, Steps: 3 | Train Loss: 0.969 Vali Loss: 1.106 Vali Acc: 0.700 Test Loss: 1.106 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8939149379730225
Epoch: 15, Steps: 3 | Train Loss: 0.943 Vali Loss: 1.080 Vali Acc: 0.725 Test Loss: 1.080 Test Acc: 0.725
Validation loss decreased (-0.724988 --> -0.724989).  Saving model ...
Epoch: 16 cost time: 1.1542601585388184
Epoch: 16, Steps: 3 | Train Loss: 0.903 Vali Loss: 1.055 Vali Acc: 0.800 Test Loss: 1.055 Test Acc: 0.800
Validation loss decreased (-0.724989 --> -0.799989).  Saving model ...
Epoch: 17 cost time: 1.309251070022583
Epoch: 17, Steps: 3 | Train Loss: 0.874 Vali Loss: 1.030 Vali Acc: 0.800 Test Loss: 1.030 Test Acc: 0.800
Validation loss decreased (-0.799989 --> -0.799990).  Saving model ...
Epoch: 18 cost time: 0.9055202007293701
Epoch: 18, Steps: 3 | Train Loss: 0.826 Vali Loss: 1.006 Vali Acc: 0.800 Test Loss: 1.006 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799990).  Saving model ...
Epoch: 19 cost time: 0.8957774639129639
Epoch: 19, Steps: 3 | Train Loss: 0.786 Vali Loss: 0.983 Vali Acc: 0.800 Test Loss: 0.983 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799990).  Saving model ...
Epoch: 20 cost time: 0.9001760482788086
Epoch: 20, Steps: 3 | Train Loss: 0.787 Vali Loss: 0.960 Vali Acc: 0.800 Test Loss: 0.960 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799990).  Saving model ...
Epoch: 21 cost time: 1.1426939964294434
Epoch: 21, Steps: 3 | Train Loss: 0.747 Vali Loss: 0.938 Vali Acc: 0.800 Test Loss: 0.938 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799991).  Saving model ...
Epoch: 22 cost time: 0.6746804714202881
Epoch: 22, Steps: 3 | Train Loss: 0.714 Vali Loss: 0.917 Vali Acc: 0.800 Test Loss: 0.917 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 23 cost time: 0.7617530822753906
Epoch: 23, Steps: 3 | Train Loss: 0.697 Vali Loss: 0.897 Vali Acc: 0.800 Test Loss: 0.897 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 24 cost time: 1.1083807945251465
Epoch: 24, Steps: 3 | Train Loss: 0.674 Vali Loss: 0.877 Vali Acc: 0.800 Test Loss: 0.877 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 25 cost time: 1.2294881343841553
Epoch: 25, Steps: 3 | Train Loss: 0.638 Vali Loss: 0.859 Vali Acc: 0.825 Test Loss: 0.859 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824991).  Saving model ...
Epoch: 26 cost time: 1.085864782333374
Epoch: 26, Steps: 3 | Train Loss: 0.615 Vali Loss: 0.841 Vali Acc: 0.825 Test Loss: 0.841 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 27 cost time: 0.8104450702667236
Epoch: 27, Steps: 3 | Train Loss: 0.626 Vali Loss: 0.824 Vali Acc: 0.875 Test Loss: 0.824 Test Acc: 0.875
Validation loss decreased (-0.824992 --> -0.874992).  Saving model ...
Epoch: 28 cost time: 1.250629186630249
Epoch: 28, Steps: 3 | Train Loss: 0.579 Vali Loss: 0.808 Vali Acc: 0.875 Test Loss: 0.808 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 29 cost time: 1.2056341171264648
Epoch: 29, Steps: 3 | Train Loss: 0.573 Vali Loss: 0.793 Vali Acc: 0.875 Test Loss: 0.793 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 30 cost time: 1.0517799854278564
Epoch: 30, Steps: 3 | Train Loss: 0.545 Vali Loss: 0.778 Vali Acc: 0.875 Test Loss: 0.778 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 31 cost time: 0.8452000617980957
Epoch: 31, Steps: 3 | Train Loss: 0.538 Vali Loss: 0.764 Vali Acc: 0.875 Test Loss: 0.764 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 32 cost time: 1.0499792098999023
Epoch: 32, Steps: 3 | Train Loss: 0.504 Vali Loss: 0.750 Vali Acc: 0.875 Test Loss: 0.750 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 33 cost time: 1.0959193706512451
Epoch: 33, Steps: 3 | Train Loss: 0.486 Vali Loss: 0.738 Vali Acc: 0.875 Test Loss: 0.738 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 34 cost time: 0.9862334728240967
Epoch: 34, Steps: 3 | Train Loss: 0.477 Vali Loss: 0.726 Vali Acc: 0.875 Test Loss: 0.726 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 35 cost time: 0.9681026935577393
Epoch: 35, Steps: 3 | Train Loss: 0.459 Vali Loss: 0.714 Vali Acc: 0.875 Test Loss: 0.714 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 36 cost time: 0.9798643589019775
Epoch: 36, Steps: 3 | Train Loss: 0.455 Vali Loss: 0.703 Vali Acc: 0.875 Test Loss: 0.703 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 37 cost time: 1.0405325889587402
Epoch: 37, Steps: 3 | Train Loss: 0.409 Vali Loss: 0.693 Vali Acc: 0.875 Test Loss: 0.693 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 38 cost time: 0.9223182201385498
Epoch: 38, Steps: 3 | Train Loss: 0.401 Vali Loss: 0.683 Vali Acc: 0.875 Test Loss: 0.683 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 39 cost time: 0.9923708438873291
Epoch: 39, Steps: 3 | Train Loss: 0.401 Vali Loss: 0.674 Vali Acc: 0.875 Test Loss: 0.674 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 40 cost time: 0.9479968547821045
Epoch: 40, Steps: 3 | Train Loss: 0.400 Vali Loss: 0.665 Vali Acc: 0.875 Test Loss: 0.665 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 41 cost time: 0.9579353332519531
Epoch: 41, Steps: 3 | Train Loss: 0.398 Vali Loss: 0.657 Vali Acc: 0.850 Test Loss: 0.657 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9104666709899902
Epoch: 42, Steps: 3 | Train Loss: 0.362 Vali Loss: 0.648 Vali Acc: 0.850 Test Loss: 0.648 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.816178560256958
Epoch: 43, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.641 Vali Acc: 0.850 Test Loss: 0.641 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.0372495651245117
Epoch: 44, Steps: 3 | Train Loss: 0.349 Vali Loss: 0.634 Vali Acc: 0.850 Test Loss: 0.634 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.3009262084960938
Epoch: 45, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.627 Vali Acc: 0.850 Test Loss: 0.627 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.0559978485107422
Epoch: 46, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.620 Vali Acc: 0.850 Test Loss: 0.620 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.1285781860351562
Epoch: 47, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.614 Vali Acc: 0.850 Test Loss: 0.614 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.8136806488037109
Epoch: 48, Steps: 3 | Train Loss: 0.303 Vali Loss: 0.609 Vali Acc: 0.850 Test Loss: 0.609 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.0895349979400635
Epoch: 49, Steps: 3 | Train Loss: 0.313 Vali Loss: 0.604 Vali Acc: 0.850 Test Loss: 0.604 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.8243212699890137
Epoch: 50, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.599 Vali Acc: 0.850 Test Loss: 0.599 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_DLinear_UEA_ftM_sl100_ll0_pl0_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 22604
model size : 0.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_DLinear_UEA_ftM_sl100_ll0_pl0_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 3.769556760787964
Epoch: 1, Steps: 3 | Train Loss: 1.392 Vali Loss: 1.398 Vali Acc: 0.100 Test Loss: 1.398 Test Acc: 0.100
Validation loss decreased (inf --> -0.099986).  Saving model ...
Epoch: 2 cost time: 1.3772311210632324
Epoch: 2, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.382 Vali Acc: 0.250 Test Loss: 1.382 Test Acc: 0.250
Validation loss decreased (-0.099986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 1.0475420951843262
Epoch: 3, Steps: 3 | Train Loss: 1.350 Vali Loss: 1.370 Vali Acc: 0.375 Test Loss: 1.370 Test Acc: 0.375
Validation loss decreased (-0.249986 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 1.1597633361816406
Epoch: 4, Steps: 3 | Train Loss: 1.331 Vali Loss: 1.355 Vali Acc: 0.375 Test Loss: 1.355 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 5 cost time: 1.190962553024292
Epoch: 5, Steps: 3 | Train Loss: 1.312 Vali Loss: 1.336 Vali Acc: 0.450 Test Loss: 1.336 Test Acc: 0.450
Validation loss decreased (-0.374986 --> -0.449987).  Saving model ...
Epoch: 6 cost time: 1.0725562572479248
Epoch: 6, Steps: 3 | Train Loss: 1.290 Vali Loss: 1.315 Vali Acc: 0.600 Test Loss: 1.315 Test Acc: 0.600
Validation loss decreased (-0.449987 --> -0.599987).  Saving model ...
Epoch: 7 cost time: 0.9515423774719238
Epoch: 7, Steps: 3 | Train Loss: 1.256 Vali Loss: 1.293 Vali Acc: 0.675 Test Loss: 1.293 Test Acc: 0.675
Validation loss decreased (-0.599987 --> -0.674987).  Saving model ...
Epoch: 8 cost time: 1.2251098155975342
Epoch: 8, Steps: 3 | Train Loss: 1.220 Vali Loss: 1.269 Vali Acc: 0.700 Test Loss: 1.269 Test Acc: 0.700
Validation loss decreased (-0.674987 --> -0.699987).  Saving model ...
Epoch: 9 cost time: 1.1540594100952148
Epoch: 9, Steps: 3 | Train Loss: 1.195 Vali Loss: 1.244 Vali Acc: 0.700 Test Loss: 1.244 Test Acc: 0.700
Validation loss decreased (-0.699987 --> -0.699988).  Saving model ...
Epoch: 10 cost time: 1.4104204177856445
Epoch: 10, Steps: 3 | Train Loss: 1.152 Vali Loss: 1.218 Vali Acc: 0.700 Test Loss: 1.218 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699988).  Saving model ...
Epoch: 11 cost time: 0.9548580646514893
Epoch: 11, Steps: 3 | Train Loss: 1.123 Vali Loss: 1.191 Vali Acc: 0.700 Test Loss: 1.191 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699988).  Saving model ...
Epoch: 12 cost time: 1.0052378177642822
Epoch: 12, Steps: 3 | Train Loss: 1.111 Vali Loss: 1.164 Vali Acc: 0.725 Test Loss: 1.164 Test Acc: 0.725
Validation loss decreased (-0.699988 --> -0.724988).  Saving model ...
Epoch: 13 cost time: 0.930851936340332
Epoch: 13, Steps: 3 | Train Loss: 1.040 Vali Loss: 1.138 Vali Acc: 0.725 Test Loss: 1.138 Test Acc: 0.725
Validation loss decreased (-0.724988 --> -0.724989).  Saving model ...
Epoch: 14 cost time: 0.9900424480438232
Epoch: 14, Steps: 3 | Train Loss: 1.004 Vali Loss: 1.112 Vali Acc: 0.725 Test Loss: 1.112 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 15 cost time: 0.8611459732055664
Epoch: 15, Steps: 3 | Train Loss: 0.978 Vali Loss: 1.086 Vali Acc: 0.750 Test Loss: 1.086 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749989).  Saving model ...
Epoch: 16 cost time: 0.8592648506164551
Epoch: 16, Steps: 3 | Train Loss: 0.940 Vali Loss: 1.060 Vali Acc: 0.775 Test Loss: 1.060 Test Acc: 0.775
Validation loss decreased (-0.749989 --> -0.774989).  Saving model ...
Epoch: 17 cost time: 0.8463969230651855
Epoch: 17, Steps: 3 | Train Loss: 0.915 Vali Loss: 1.036 Vali Acc: 0.825 Test Loss: 1.036 Test Acc: 0.825
Validation loss decreased (-0.774989 --> -0.824990).  Saving model ...
Epoch: 18 cost time: 1.1070618629455566
Epoch: 18, Steps: 3 | Train Loss: 0.866 Vali Loss: 1.012 Vali Acc: 0.825 Test Loss: 1.012 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824990).  Saving model ...
Epoch: 19 cost time: 0.9555666446685791
Epoch: 19, Steps: 3 | Train Loss: 0.827 Vali Loss: 0.989 Vali Acc: 0.825 Test Loss: 0.989 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824990).  Saving model ...
Epoch: 20 cost time: 1.1039562225341797
Epoch: 20, Steps: 3 | Train Loss: 0.829 Vali Loss: 0.966 Vali Acc: 0.800 Test Loss: 0.966 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.484816551208496
Epoch: 21, Steps: 3 | Train Loss: 0.786 Vali Loss: 0.944 Vali Acc: 0.800 Test Loss: 0.944 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.90165114402771
Epoch: 22, Steps: 3 | Train Loss: 0.757 Vali Loss: 0.923 Vali Acc: 0.800 Test Loss: 0.923 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1102168560028076
Epoch: 23, Steps: 3 | Train Loss: 0.739 Vali Loss: 0.902 Vali Acc: 0.800 Test Loss: 0.902 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9285900592803955
Epoch: 24, Steps: 3 | Train Loss: 0.716 Vali Loss: 0.882 Vali Acc: 0.800 Test Loss: 0.882 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.817258358001709
Epoch: 25, Steps: 3 | Train Loss: 0.683 Vali Loss: 0.864 Vali Acc: 0.825 Test Loss: 0.864 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824991).  Saving model ...
Epoch: 26 cost time: 1.1538128852844238
Epoch: 26, Steps: 3 | Train Loss: 0.657 Vali Loss: 0.846 Vali Acc: 0.850 Test Loss: 0.846 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849992).  Saving model ...
Epoch: 27 cost time: 0.8809158802032471
Epoch: 27, Steps: 3 | Train Loss: 0.668 Vali Loss: 0.829 Vali Acc: 0.875 Test Loss: 0.829 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874992).  Saving model ...
Epoch: 28 cost time: 0.9819188117980957
Epoch: 28, Steps: 3 | Train Loss: 0.624 Vali Loss: 0.812 Vali Acc: 0.875 Test Loss: 0.812 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 29 cost time: 0.9211294651031494
Epoch: 29, Steps: 3 | Train Loss: 0.620 Vali Loss: 0.797 Vali Acc: 0.875 Test Loss: 0.797 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 30 cost time: 0.7865257263183594
Epoch: 30, Steps: 3 | Train Loss: 0.588 Vali Loss: 0.782 Vali Acc: 0.875 Test Loss: 0.782 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 31 cost time: 1.0584068298339844
Epoch: 31, Steps: 3 | Train Loss: 0.583 Vali Loss: 0.767 Vali Acc: 0.850 Test Loss: 0.767 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9825754165649414
Epoch: 32, Steps: 3 | Train Loss: 0.548 Vali Loss: 0.753 Vali Acc: 0.875 Test Loss: 0.753 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 33 cost time: 0.8439223766326904
Epoch: 33, Steps: 3 | Train Loss: 0.530 Vali Loss: 0.740 Vali Acc: 0.875 Test Loss: 0.740 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 34 cost time: 0.8215177059173584
Epoch: 34, Steps: 3 | Train Loss: 0.526 Vali Loss: 0.728 Vali Acc: 0.875 Test Loss: 0.728 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 35 cost time: 0.8038785457611084
Epoch: 35, Steps: 3 | Train Loss: 0.505 Vali Loss: 0.716 Vali Acc: 0.875 Test Loss: 0.716 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 36 cost time: 1.0475034713745117
Epoch: 36, Steps: 3 | Train Loss: 0.497 Vali Loss: 0.704 Vali Acc: 0.875 Test Loss: 0.704 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 37 cost time: 0.8862910270690918
Epoch: 37, Steps: 3 | Train Loss: 0.448 Vali Loss: 0.693 Vali Acc: 0.875 Test Loss: 0.693 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 38 cost time: 0.9443368911743164
Epoch: 38, Steps: 3 | Train Loss: 0.440 Vali Loss: 0.683 Vali Acc: 0.875 Test Loss: 0.683 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 39 cost time: 1.1307871341705322
Epoch: 39, Steps: 3 | Train Loss: 0.443 Vali Loss: 0.673 Vali Acc: 0.875 Test Loss: 0.673 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 40 cost time: 0.8715114593505859
Epoch: 40, Steps: 3 | Train Loss: 0.440 Vali Loss: 0.664 Vali Acc: 0.875 Test Loss: 0.664 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 41 cost time: 1.1131303310394287
Epoch: 41, Steps: 3 | Train Loss: 0.436 Vali Loss: 0.655 Vali Acc: 0.850 Test Loss: 0.655 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8823997974395752
Epoch: 42, Steps: 3 | Train Loss: 0.401 Vali Loss: 0.646 Vali Acc: 0.850 Test Loss: 0.646 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.8427910804748535
Epoch: 43, Steps: 3 | Train Loss: 0.412 Vali Loss: 0.638 Vali Acc: 0.850 Test Loss: 0.638 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.323164463043213
Epoch: 44, Steps: 3 | Train Loss: 0.386 Vali Loss: 0.630 Vali Acc: 0.850 Test Loss: 0.630 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.0029423236846924
Epoch: 45, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.623 Vali Acc: 0.850 Test Loss: 0.623 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.1769177913665771
Epoch: 46, Steps: 3 | Train Loss: 0.375 Vali Loss: 0.616 Vali Acc: 0.850 Test Loss: 0.616 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.992241621017456
Epoch: 47, Steps: 3 | Train Loss: 0.358 Vali Loss: 0.610 Vali Acc: 0.850 Test Loss: 0.610 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.9689843654632568
Epoch: 48, Steps: 3 | Train Loss: 0.340 Vali Loss: 0.603 Vali Acc: 0.850 Test Loss: 0.603 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.0081334114074707
Epoch: 49, Steps: 3 | Train Loss: 0.349 Vali Loss: 0.598 Vali Acc: 0.850 Test Loss: 0.598 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.006302833557129
Epoch: 50, Steps: 3 | Train Loss: 0.331 Vali Loss: 0.592 Vali Acc: 0.850 Test Loss: 0.592 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_DLinear_UEA_ftM_sl100_ll0_pl0_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 22604
model size : 0.09MB
