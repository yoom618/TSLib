Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         33                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_DLinear_UEA_ftM_sl65_ll0_pl0_ma33_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4900131225585938
Epoch: 1, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.790 Vali Acc: 0.167 Test Loss: 1.790 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 0.6742186546325684
Epoch: 2, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.787 Vali Acc: 0.167 Test Loss: 1.787 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 0.7879881858825684
Epoch: 3, Steps: 2 | Train Loss: 1.785 Vali Loss: 1.784 Vali Acc: 0.293 Test Loss: 1.784 Test Acc: 0.293
Validation loss decreased (-0.166649 --> -0.292575).  Saving model ...
Epoch: 4 cost time: 0.5093662738800049
Epoch: 4, Steps: 2 | Train Loss: 1.782 Vali Loss: 1.779 Vali Acc: 0.333 Test Loss: 1.779 Test Acc: 0.333
Validation loss decreased (-0.292575 --> -0.333316).  Saving model ...
Epoch: 5 cost time: 0.6135604381561279
Epoch: 5, Steps: 2 | Train Loss: 1.773 Vali Loss: 1.772 Vali Acc: 0.333 Test Loss: 1.772 Test Acc: 0.333
Validation loss decreased (-0.333316 --> -0.333316).  Saving model ...
Epoch: 6 cost time: 0.6060492992401123
Epoch: 6, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.765 Vali Acc: 0.385 Test Loss: 1.765 Test Acc: 0.385
Validation loss decreased (-0.333316 --> -0.385168).  Saving model ...
Epoch: 7 cost time: 0.6328225135803223
Epoch: 7, Steps: 2 | Train Loss: 1.756 Vali Loss: 1.756 Vali Acc: 0.515 Test Loss: 1.756 Test Acc: 0.515
Validation loss decreased (-0.385168 --> -0.514797).  Saving model ...
Epoch: 8 cost time: 0.838815450668335
Epoch: 8, Steps: 2 | Train Loss: 1.745 Vali Loss: 1.746 Vali Acc: 0.607 Test Loss: 1.746 Test Acc: 0.607
Validation loss decreased (-0.514797 --> -0.607390).  Saving model ...
Epoch: 9 cost time: 0.6531033515930176
Epoch: 9, Steps: 2 | Train Loss: 1.732 Vali Loss: 1.735 Vali Acc: 0.656 Test Loss: 1.735 Test Acc: 0.656
Validation loss decreased (-0.607390 --> -0.655538).  Saving model ...
Epoch: 10 cost time: 0.6336781978607178
Epoch: 10, Steps: 2 | Train Loss: 1.720 Vali Loss: 1.723 Vali Acc: 0.715 Test Loss: 1.723 Test Acc: 0.715
Validation loss decreased (-0.655538 --> -0.714798).  Saving model ...
Epoch: 11 cost time: 0.6541674137115479
Epoch: 11, Steps: 2 | Train Loss: 1.703 Vali Loss: 1.710 Vali Acc: 0.726 Test Loss: 1.710 Test Acc: 0.726
Validation loss decreased (-0.714798 --> -0.725909).  Saving model ...
Epoch: 12 cost time: 0.7131855487823486
Epoch: 12, Steps: 2 | Train Loss: 1.689 Vali Loss: 1.696 Vali Acc: 0.737 Test Loss: 1.696 Test Acc: 0.737
Validation loss decreased (-0.725909 --> -0.737020).  Saving model ...
Epoch: 13 cost time: 0.8162195682525635
Epoch: 13, Steps: 2 | Train Loss: 1.675 Vali Loss: 1.681 Vali Acc: 0.744 Test Loss: 1.681 Test Acc: 0.744
Validation loss decreased (-0.737020 --> -0.744428).  Saving model ...
Epoch: 14 cost time: 0.6498446464538574
Epoch: 14, Steps: 2 | Train Loss: 1.656 Vali Loss: 1.666 Vali Acc: 0.756 Test Loss: 1.666 Test Acc: 0.756
Validation loss decreased (-0.744428 --> -0.755539).  Saving model ...
Epoch: 15 cost time: 0.5918266773223877
Epoch: 15, Steps: 2 | Train Loss: 1.638 Vali Loss: 1.649 Vali Acc: 0.763 Test Loss: 1.649 Test Acc: 0.763
Validation loss decreased (-0.755539 --> -0.762946).  Saving model ...
Epoch: 16 cost time: 0.8538901805877686
Epoch: 16, Steps: 2 | Train Loss: 1.617 Vali Loss: 1.631 Vali Acc: 0.759 Test Loss: 1.631 Test Acc: 0.759
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5800800323486328
Epoch: 17, Steps: 2 | Train Loss: 1.597 Vali Loss: 1.612 Vali Acc: 0.767 Test Loss: 1.612 Test Acc: 0.767
Validation loss decreased (-0.762946 --> -0.766651).  Saving model ...
Epoch: 18 cost time: 0.672008752822876
Epoch: 18, Steps: 2 | Train Loss: 1.574 Vali Loss: 1.593 Vali Acc: 0.770 Test Loss: 1.593 Test Acc: 0.770
Validation loss decreased (-0.766651 --> -0.770354).  Saving model ...
Epoch: 19 cost time: 0.5094964504241943
Epoch: 19, Steps: 2 | Train Loss: 1.545 Vali Loss: 1.572 Vali Acc: 0.767 Test Loss: 1.572 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6694536209106445
Epoch: 20, Steps: 2 | Train Loss: 1.526 Vali Loss: 1.550 Vali Acc: 0.770 Test Loss: 1.550 Test Acc: 0.770
Validation loss decreased (-0.770354 --> -0.770355).  Saving model ...
Epoch: 21 cost time: 0.6342799663543701
Epoch: 21, Steps: 2 | Train Loss: 1.498 Vali Loss: 1.527 Vali Acc: 0.778 Test Loss: 1.527 Test Acc: 0.778
Validation loss decreased (-0.770355 --> -0.777763).  Saving model ...
Epoch: 22 cost time: 0.6099050045013428
Epoch: 22, Steps: 2 | Train Loss: 1.471 Vali Loss: 1.503 Vali Acc: 0.781 Test Loss: 1.503 Test Acc: 0.781
Validation loss decreased (-0.777763 --> -0.781466).  Saving model ...
Epoch: 23 cost time: 0.6330380439758301
Epoch: 23, Steps: 2 | Train Loss: 1.438 Vali Loss: 1.478 Vali Acc: 0.793 Test Loss: 1.478 Test Acc: 0.793
Validation loss decreased (-0.781466 --> -0.792578).  Saving model ...
Epoch: 24 cost time: 0.6449928283691406
Epoch: 24, Steps: 2 | Train Loss: 1.412 Vali Loss: 1.451 Vali Acc: 0.793 Test Loss: 1.451 Test Acc: 0.793
Validation loss decreased (-0.792578 --> -0.792578).  Saving model ...
Epoch: 25 cost time: 0.6897032260894775
Epoch: 25, Steps: 2 | Train Loss: 1.382 Vali Loss: 1.424 Vali Acc: 0.793 Test Loss: 1.424 Test Acc: 0.793
Validation loss decreased (-0.792578 --> -0.792578).  Saving model ...
Epoch: 26 cost time: 0.6104345321655273
Epoch: 26, Steps: 2 | Train Loss: 1.352 Vali Loss: 1.395 Vali Acc: 0.793 Test Loss: 1.395 Test Acc: 0.793
Validation loss decreased (-0.792578 --> -0.792579).  Saving model ...
Epoch: 27 cost time: 0.9494926929473877
Epoch: 27, Steps: 2 | Train Loss: 1.317 Vali Loss: 1.366 Vali Acc: 0.804 Test Loss: 1.366 Test Acc: 0.804
Validation loss decreased (-0.792579 --> -0.803690).  Saving model ...
Epoch: 28 cost time: 0.9309473037719727
Epoch: 28, Steps: 2 | Train Loss: 1.288 Vali Loss: 1.335 Vali Acc: 0.807 Test Loss: 1.335 Test Acc: 0.807
Validation loss decreased (-0.803690 --> -0.807394).  Saving model ...
Epoch: 29 cost time: 0.9157092571258545
Epoch: 29, Steps: 2 | Train Loss: 1.256 Vali Loss: 1.305 Vali Acc: 0.815 Test Loss: 1.305 Test Acc: 0.815
Validation loss decreased (-0.807394 --> -0.814802).  Saving model ...
Epoch: 30 cost time: 0.9360246658325195
Epoch: 30, Steps: 2 | Train Loss: 1.217 Vali Loss: 1.273 Vali Acc: 0.815 Test Loss: 1.273 Test Acc: 0.815
Validation loss decreased (-0.814802 --> -0.814802).  Saving model ...
Epoch: 31 cost time: 0.7288517951965332
Epoch: 31, Steps: 2 | Train Loss: 1.181 Vali Loss: 1.241 Vali Acc: 0.815 Test Loss: 1.241 Test Acc: 0.815
Validation loss decreased (-0.814802 --> -0.814802).  Saving model ...
Epoch: 32 cost time: 0.6781730651855469
Epoch: 32, Steps: 2 | Train Loss: 1.140 Vali Loss: 1.209 Vali Acc: 0.819 Test Loss: 1.209 Test Acc: 0.819
Validation loss decreased (-0.814802 --> -0.818506).  Saving model ...
Epoch: 33 cost time: 0.6961612701416016
Epoch: 33, Steps: 2 | Train Loss: 1.098 Vali Loss: 1.176 Vali Acc: 0.826 Test Loss: 1.176 Test Acc: 0.826
Validation loss decreased (-0.818506 --> -0.825914).  Saving model ...
Epoch: 34 cost time: 0.6465249061584473
Epoch: 34, Steps: 2 | Train Loss: 1.061 Vali Loss: 1.144 Vali Acc: 0.830 Test Loss: 1.144 Test Acc: 0.830
Validation loss decreased (-0.825914 --> -0.829618).  Saving model ...
Epoch: 35 cost time: 0.6504373550415039
Epoch: 35, Steps: 2 | Train Loss: 1.029 Vali Loss: 1.111 Vali Acc: 0.830 Test Loss: 1.111 Test Acc: 0.830
Validation loss decreased (-0.829618 --> -0.829619).  Saving model ...
Epoch: 36 cost time: 0.7478530406951904
Epoch: 36, Steps: 2 | Train Loss: 0.987 Vali Loss: 1.079 Vali Acc: 0.830 Test Loss: 1.079 Test Acc: 0.830
Validation loss decreased (-0.829619 --> -0.829619).  Saving model ...
Epoch: 37 cost time: 0.733180046081543
Epoch: 37, Steps: 2 | Train Loss: 0.952 Vali Loss: 1.047 Vali Acc: 0.830 Test Loss: 1.047 Test Acc: 0.830
Validation loss decreased (-0.829619 --> -0.829619).  Saving model ...
Epoch: 38 cost time: 1.0227866172790527
Epoch: 38, Steps: 2 | Train Loss: 0.922 Vali Loss: 1.015 Vali Acc: 0.833 Test Loss: 1.015 Test Acc: 0.833
Validation loss decreased (-0.829619 --> -0.833323).  Saving model ...
Epoch: 39 cost time: 1.0266332626342773
Epoch: 39, Steps: 2 | Train Loss: 0.884 Vali Loss: 0.983 Vali Acc: 0.841 Test Loss: 0.983 Test Acc: 0.841
Validation loss decreased (-0.833323 --> -0.840731).  Saving model ...
Epoch: 40 cost time: 0.8098852634429932
Epoch: 40, Steps: 2 | Train Loss: 0.851 Vali Loss: 0.953 Vali Acc: 0.852 Test Loss: 0.953 Test Acc: 0.852
Validation loss decreased (-0.840731 --> -0.851842).  Saving model ...
Epoch: 41 cost time: 0.6597588062286377
Epoch: 41, Steps: 2 | Train Loss: 0.811 Vali Loss: 0.923 Vali Acc: 0.856 Test Loss: 0.923 Test Acc: 0.856
Validation loss decreased (-0.851842 --> -0.855546).  Saving model ...
Epoch: 42 cost time: 0.7637150287628174
Epoch: 42, Steps: 2 | Train Loss: 0.773 Vali Loss: 0.894 Vali Acc: 0.859 Test Loss: 0.894 Test Acc: 0.859
Validation loss decreased (-0.855546 --> -0.859250).  Saving model ...
Epoch: 43 cost time: 0.9107143878936768
Epoch: 43, Steps: 2 | Train Loss: 0.739 Vali Loss: 0.865 Vali Acc: 0.859 Test Loss: 0.865 Test Acc: 0.859
Validation loss decreased (-0.859250 --> -0.859251).  Saving model ...
Epoch: 44 cost time: 0.7286736965179443
Epoch: 44, Steps: 2 | Train Loss: 0.717 Vali Loss: 0.838 Vali Acc: 0.859 Test Loss: 0.838 Test Acc: 0.859
Validation loss decreased (-0.859251 --> -0.859251).  Saving model ...
Epoch: 45 cost time: 0.726658821105957
Epoch: 45, Steps: 2 | Train Loss: 0.684 Vali Loss: 0.811 Vali Acc: 0.867 Test Loss: 0.811 Test Acc: 0.867
Validation loss decreased (-0.859251 --> -0.866659).  Saving model ...
Epoch: 46 cost time: 1.0173046588897705
Epoch: 46, Steps: 2 | Train Loss: 0.655 Vali Loss: 0.785 Vali Acc: 0.867 Test Loss: 0.785 Test Acc: 0.867
Validation loss decreased (-0.866659 --> -0.866659).  Saving model ...
Epoch: 47 cost time: 0.7747750282287598
Epoch: 47, Steps: 2 | Train Loss: 0.624 Vali Loss: 0.760 Vali Acc: 0.874 Test Loss: 0.760 Test Acc: 0.874
Validation loss decreased (-0.866659 --> -0.874066).  Saving model ...
Epoch: 48 cost time: 0.8476643562316895
Epoch: 48, Steps: 2 | Train Loss: 0.595 Vali Loss: 0.736 Vali Acc: 0.878 Test Loss: 0.736 Test Acc: 0.878
Validation loss decreased (-0.874066 --> -0.877770).  Saving model ...
Epoch: 49 cost time: 0.7445542812347412
Epoch: 49, Steps: 2 | Train Loss: 0.570 Vali Loss: 0.713 Vali Acc: 0.881 Test Loss: 0.713 Test Acc: 0.881
Validation loss decreased (-0.877770 --> -0.881474).  Saving model ...
Epoch: 50 cost time: 1.0169718265533447
Epoch: 50, Steps: 2 | Train Loss: 0.548 Vali Loss: 0.691 Vali Acc: 0.881 Test Loss: 0.691 Test Acc: 0.881
Validation loss decreased (-0.881474 --> -0.881475).  Saving model ...
Epoch: 51 cost time: 0.570157527923584
Epoch: 51, Steps: 2 | Train Loss: 0.514 Vali Loss: 0.669 Vali Acc: 0.893 Test Loss: 0.669 Test Acc: 0.893
Validation loss decreased (-0.881475 --> -0.892586).  Saving model ...
Epoch: 52 cost time: 0.5773520469665527
Epoch: 52, Steps: 2 | Train Loss: 0.498 Vali Loss: 0.649 Vali Acc: 0.900 Test Loss: 0.649 Test Acc: 0.900
Validation loss decreased (-0.892586 --> -0.899994).  Saving model ...
Epoch: 53 cost time: 0.6092729568481445
Epoch: 53, Steps: 2 | Train Loss: 0.473 Vali Loss: 0.630 Vali Acc: 0.896 Test Loss: 0.630 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.623408317565918
Epoch: 54, Steps: 2 | Train Loss: 0.449 Vali Loss: 0.611 Vali Acc: 0.896 Test Loss: 0.611 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.747438907623291
Epoch: 55, Steps: 2 | Train Loss: 0.436 Vali Loss: 0.593 Vali Acc: 0.896 Test Loss: 0.593 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.5226263999938965
Epoch: 56, Steps: 2 | Train Loss: 0.410 Vali Loss: 0.576 Vali Acc: 0.896 Test Loss: 0.576 Test Acc: 0.896
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.7521770000457764
Epoch: 57, Steps: 2 | Train Loss: 0.397 Vali Loss: 0.560 Vali Acc: 0.896 Test Loss: 0.560 Test Acc: 0.896
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.7135238647460938
Epoch: 58, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.545 Vali Acc: 0.896 Test Loss: 0.545 Test Acc: 0.896
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.8105313777923584
Epoch: 59, Steps: 2 | Train Loss: 0.367 Vali Loss: 0.531 Vali Acc: 0.896 Test Loss: 0.531 Test Acc: 0.896
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.7155447006225586
Epoch: 60, Steps: 2 | Train Loss: 0.349 Vali Loss: 0.517 Vali Acc: 0.900 Test Loss: 0.517 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 61 cost time: 0.735140323638916
Epoch: 61, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.505 Vali Acc: 0.904 Test Loss: 0.505 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903699).  Saving model ...
Epoch: 62 cost time: 0.8543128967285156
Epoch: 62, Steps: 2 | Train Loss: 0.323 Vali Loss: 0.492 Vali Acc: 0.904 Test Loss: 0.492 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903699).  Saving model ...
Epoch: 63 cost time: 0.7350540161132812
Epoch: 63, Steps: 2 | Train Loss: 0.306 Vali Loss: 0.480 Vali Acc: 0.911 Test Loss: 0.480 Test Acc: 0.911
Validation loss decreased (-0.903699 --> -0.911106).  Saving model ...
Epoch: 64 cost time: 0.6190817356109619
Epoch: 64, Steps: 2 | Train Loss: 0.291 Vali Loss: 0.469 Vali Acc: 0.915 Test Loss: 0.469 Test Acc: 0.915
Validation loss decreased (-0.911106 --> -0.914810).  Saving model ...
Epoch: 65 cost time: 0.7389571666717529
Epoch: 65, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.459 Vali Acc: 0.919 Test Loss: 0.459 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 66 cost time: 0.6478796005249023
Epoch: 66, Steps: 2 | Train Loss: 0.274 Vali Loss: 0.449 Vali Acc: 0.919 Test Loss: 0.449 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 67 cost time: 0.61667799949646
Epoch: 67, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.440 Vali Acc: 0.919 Test Loss: 0.440 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 68 cost time: 0.8013842105865479
Epoch: 68, Steps: 2 | Train Loss: 0.251 Vali Loss: 0.430 Vali Acc: 0.919 Test Loss: 0.430 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 69 cost time: 0.7627904415130615
Epoch: 69, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.422 Vali Acc: 0.919 Test Loss: 0.422 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 70 cost time: 0.5245940685272217
Epoch: 70, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.414 Vali Acc: 0.919 Test Loss: 0.414 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 71 cost time: 0.8567385673522949
Epoch: 71, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.406 Vali Acc: 0.919 Test Loss: 0.406 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 72 cost time: 0.7552275657653809
Epoch: 72, Steps: 2 | Train Loss: 0.210 Vali Loss: 0.399 Vali Acc: 0.919 Test Loss: 0.399 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918515).  Saving model ...
Epoch: 73 cost time: 0.7435328960418701
Epoch: 73, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.392 Vali Acc: 0.919 Test Loss: 0.392 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 74 cost time: 0.7258265018463135
Epoch: 74, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.385 Vali Acc: 0.919 Test Loss: 0.385 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 75 cost time: 0.6853821277618408
Epoch: 75, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.379 Vali Acc: 0.919 Test Loss: 0.379 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 76 cost time: 0.8133115768432617
Epoch: 76, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.373 Vali Acc: 0.919 Test Loss: 0.373 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 77 cost time: 0.6286773681640625
Epoch: 77, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.367 Vali Acc: 0.919 Test Loss: 0.367 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 78 cost time: 0.7521524429321289
Epoch: 78, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.361 Vali Acc: 0.919 Test Loss: 0.361 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 79 cost time: 0.8344390392303467
Epoch: 79, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.356 Vali Acc: 0.919 Test Loss: 0.356 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 80 cost time: 0.6876187324523926
Epoch: 80, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.351 Vali Acc: 0.919 Test Loss: 0.351 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 81 cost time: 0.8828463554382324
Epoch: 81, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.346 Vali Acc: 0.919 Test Loss: 0.346 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 82 cost time: 0.6650147438049316
Epoch: 82, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.341 Vali Acc: 0.919 Test Loss: 0.341 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 83 cost time: 0.6439375877380371
Epoch: 83, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.337 Vali Acc: 0.919 Test Loss: 0.337 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 84 cost time: 0.7285027503967285
Epoch: 84, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.333 Vali Acc: 0.919 Test Loss: 0.333 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 85 cost time: 0.6695597171783447
Epoch: 85, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.328 Vali Acc: 0.919 Test Loss: 0.328 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 86 cost time: 0.5667102336883545
Epoch: 86, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.325 Vali Acc: 0.919 Test Loss: 0.325 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 87 cost time: 0.7326943874359131
Epoch: 87, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.321 Vali Acc: 0.919 Test Loss: 0.321 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 88 cost time: 0.8454985618591309
Epoch: 88, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.317 Vali Acc: 0.919 Test Loss: 0.317 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 89 cost time: 0.8204543590545654
Epoch: 89, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.314 Vali Acc: 0.919 Test Loss: 0.314 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 90 cost time: 0.8401172161102295
Epoch: 90, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.310 Vali Acc: 0.919 Test Loss: 0.310 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 91 cost time: 0.5954780578613281
Epoch: 91, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.307 Vali Acc: 0.919 Test Loss: 0.307 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 92 cost time: 0.7780671119689941
Epoch: 92, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.305 Vali Acc: 0.919 Test Loss: 0.305 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 93 cost time: 0.8523130416870117
Epoch: 93, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.302 Vali Acc: 0.919 Test Loss: 0.302 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918516).  Saving model ...
Epoch: 94 cost time: 0.7318747043609619
Epoch: 94, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.299 Vali Acc: 0.919 Test Loss: 0.299 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 95 cost time: 0.7050049304962158
Epoch: 95, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.296 Vali Acc: 0.919 Test Loss: 0.296 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 96 cost time: 0.7221026420593262
Epoch: 96, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.294 Vali Acc: 0.919 Test Loss: 0.294 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 97 cost time: 0.8277122974395752
Epoch: 97, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.291 Vali Acc: 0.919 Test Loss: 0.291 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 98 cost time: 1.1878941059112549
Epoch: 98, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.289 Vali Acc: 0.919 Test Loss: 0.289 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 99 cost time: 0.7760248184204102
Epoch: 99, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.286 Vali Acc: 0.919 Test Loss: 0.286 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 100 cost time: 0.8241164684295654
Epoch: 100, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.284 Vali Acc: 0.919 Test Loss: 0.284 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_DLinear_UEA_ftM_sl65_ll0_pl0_ma33_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9185185185185185
model parameter : 10146
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         30                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_DLinear_UEA_ftM_sl65_ll0_pl0_ma30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.260106325149536
Epoch: 1, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.790 Vali Acc: 0.167 Test Loss: 1.790 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 0.7241616249084473
Epoch: 2, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.787 Vali Acc: 0.167 Test Loss: 1.787 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 0.7398252487182617
Epoch: 3, Steps: 2 | Train Loss: 1.784 Vali Loss: 1.784 Vali Acc: 0.315 Test Loss: 1.784 Test Acc: 0.315
Validation loss decreased (-0.166649 --> -0.314797).  Saving model ...
Epoch: 4 cost time: 0.8203599452972412
Epoch: 4, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.779 Vali Acc: 0.333 Test Loss: 1.779 Test Acc: 0.333
Validation loss decreased (-0.314797 --> -0.333316).  Saving model ...
Epoch: 5 cost time: 0.8448963165283203
Epoch: 5, Steps: 2 | Train Loss: 1.773 Vali Loss: 1.772 Vali Acc: 0.333 Test Loss: 1.772 Test Acc: 0.333
Validation loss decreased (-0.333316 --> -0.333316).  Saving model ...
Epoch: 6 cost time: 0.6536877155303955
Epoch: 6, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.765 Vali Acc: 0.389 Test Loss: 1.765 Test Acc: 0.389
Validation loss decreased (-0.333316 --> -0.388871).  Saving model ...
Epoch: 7 cost time: 0.7097842693328857
Epoch: 7, Steps: 2 | Train Loss: 1.756 Vali Loss: 1.756 Vali Acc: 0.511 Test Loss: 1.756 Test Acc: 0.511
Validation loss decreased (-0.388871 --> -0.511094).  Saving model ...
Epoch: 8 cost time: 0.766491174697876
Epoch: 8, Steps: 2 | Train Loss: 1.745 Vali Loss: 1.746 Vali Acc: 0.604 Test Loss: 1.746 Test Acc: 0.604
Validation loss decreased (-0.511094 --> -0.603686).  Saving model ...
Epoch: 9 cost time: 0.7883110046386719
Epoch: 9, Steps: 2 | Train Loss: 1.732 Vali Loss: 1.735 Vali Acc: 0.652 Test Loss: 1.735 Test Acc: 0.652
Validation loss decreased (-0.603686 --> -0.651835).  Saving model ...
Epoch: 10 cost time: 0.7427752017974854
Epoch: 10, Steps: 2 | Train Loss: 1.720 Vali Loss: 1.723 Vali Acc: 0.707 Test Loss: 1.723 Test Acc: 0.707
Validation loss decreased (-0.651835 --> -0.707390).  Saving model ...
Epoch: 11 cost time: 0.8161365985870361
Epoch: 11, Steps: 2 | Train Loss: 1.704 Vali Loss: 1.711 Vali Acc: 0.722 Test Loss: 1.711 Test Acc: 0.722
Validation loss decreased (-0.707390 --> -0.722205).  Saving model ...
Epoch: 12 cost time: 1.106855869293213
Epoch: 12, Steps: 2 | Train Loss: 1.690 Vali Loss: 1.697 Vali Acc: 0.733 Test Loss: 1.697 Test Acc: 0.733
Validation loss decreased (-0.722205 --> -0.733316).  Saving model ...
Epoch: 13 cost time: 0.8106160163879395
Epoch: 13, Steps: 2 | Train Loss: 1.675 Vali Loss: 1.682 Vali Acc: 0.748 Test Loss: 1.682 Test Acc: 0.748
Validation loss decreased (-0.733316 --> -0.748131).  Saving model ...
Epoch: 14 cost time: 0.6241188049316406
Epoch: 14, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.666 Vali Acc: 0.759 Test Loss: 1.666 Test Acc: 0.759
Validation loss decreased (-0.748131 --> -0.759243).  Saving model ...
Epoch: 15 cost time: 0.7880067825317383
Epoch: 15, Steps: 2 | Train Loss: 1.639 Vali Loss: 1.650 Vali Acc: 0.759 Test Loss: 1.650 Test Acc: 0.759
Validation loss decreased (-0.759243 --> -0.759243).  Saving model ...
Epoch: 16 cost time: 0.669379472732544
Epoch: 16, Steps: 2 | Train Loss: 1.617 Vali Loss: 1.632 Vali Acc: 0.759 Test Loss: 1.632 Test Acc: 0.759
Validation loss decreased (-0.759243 --> -0.759243).  Saving model ...
Epoch: 17 cost time: 0.7140729427337646
Epoch: 17, Steps: 2 | Train Loss: 1.597 Vali Loss: 1.613 Vali Acc: 0.759 Test Loss: 1.613 Test Acc: 0.759
Validation loss decreased (-0.759243 --> -0.759243).  Saving model ...
Epoch: 18 cost time: 0.7382469177246094
Epoch: 18, Steps: 2 | Train Loss: 1.574 Vali Loss: 1.594 Vali Acc: 0.759 Test Loss: 1.594 Test Acc: 0.759
Validation loss decreased (-0.759243 --> -0.759243).  Saving model ...
Epoch: 19 cost time: 0.9107930660247803
Epoch: 19, Steps: 2 | Train Loss: 1.545 Vali Loss: 1.573 Vali Acc: 0.763 Test Loss: 1.573 Test Acc: 0.763
Validation loss decreased (-0.759243 --> -0.762947).  Saving model ...
Epoch: 20 cost time: 0.6371448040008545
Epoch: 20, Steps: 2 | Train Loss: 1.526 Vali Loss: 1.552 Vali Acc: 0.774 Test Loss: 1.552 Test Acc: 0.774
Validation loss decreased (-0.762947 --> -0.774059).  Saving model ...
Epoch: 21 cost time: 0.6359341144561768
Epoch: 21, Steps: 2 | Train Loss: 1.498 Vali Loss: 1.529 Vali Acc: 0.774 Test Loss: 1.529 Test Acc: 0.774
Validation loss decreased (-0.774059 --> -0.774059).  Saving model ...
Epoch: 22 cost time: 0.6883244514465332
Epoch: 22, Steps: 2 | Train Loss: 1.472 Vali Loss: 1.505 Vali Acc: 0.778 Test Loss: 1.505 Test Acc: 0.778
Validation loss decreased (-0.774059 --> -0.777763).  Saving model ...
Epoch: 23 cost time: 0.8165304660797119
Epoch: 23, Steps: 2 | Train Loss: 1.438 Vali Loss: 1.479 Vali Acc: 0.789 Test Loss: 1.479 Test Acc: 0.789
Validation loss decreased (-0.777763 --> -0.788874).  Saving model ...
Epoch: 24 cost time: 0.6399245262145996
Epoch: 24, Steps: 2 | Train Loss: 1.412 Vali Loss: 1.453 Vali Acc: 0.793 Test Loss: 1.453 Test Acc: 0.793
Validation loss decreased (-0.788874 --> -0.792578).  Saving model ...
Epoch: 25 cost time: 0.7102558612823486
Epoch: 25, Steps: 2 | Train Loss: 1.383 Vali Loss: 1.426 Vali Acc: 0.793 Test Loss: 1.426 Test Acc: 0.793
Validation loss decreased (-0.792578 --> -0.792578).  Saving model ...
Epoch: 26 cost time: 0.9252395629882812
Epoch: 26, Steps: 2 | Train Loss: 1.353 Vali Loss: 1.397 Vali Acc: 0.800 Test Loss: 1.397 Test Acc: 0.800
Validation loss decreased (-0.792578 --> -0.799986).  Saving model ...
Epoch: 27 cost time: 0.872246503829956
Epoch: 27, Steps: 2 | Train Loss: 1.317 Vali Loss: 1.368 Vali Acc: 0.804 Test Loss: 1.368 Test Acc: 0.804
Validation loss decreased (-0.799986 --> -0.803690).  Saving model ...
Epoch: 28 cost time: 0.7560172080993652
Epoch: 28, Steps: 2 | Train Loss: 1.289 Vali Loss: 1.337 Vali Acc: 0.804 Test Loss: 1.337 Test Acc: 0.804
Validation loss decreased (-0.803690 --> -0.803690).  Saving model ...
Epoch: 29 cost time: 0.6379389762878418
Epoch: 29, Steps: 2 | Train Loss: 1.257 Vali Loss: 1.307 Vali Acc: 0.811 Test Loss: 1.307 Test Acc: 0.811
Validation loss decreased (-0.803690 --> -0.811098).  Saving model ...
Epoch: 30 cost time: 0.6367895603179932
Epoch: 30, Steps: 2 | Train Loss: 1.217 Vali Loss: 1.275 Vali Acc: 0.807 Test Loss: 1.275 Test Acc: 0.807
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.930619478225708
Epoch: 31, Steps: 2 | Train Loss: 1.181 Vali Loss: 1.243 Vali Acc: 0.811 Test Loss: 1.243 Test Acc: 0.811
Validation loss decreased (-0.811098 --> -0.811099).  Saving model ...
Epoch: 32 cost time: 0.6121237277984619
Epoch: 32, Steps: 2 | Train Loss: 1.141 Vali Loss: 1.211 Vali Acc: 0.815 Test Loss: 1.211 Test Acc: 0.815
Validation loss decreased (-0.811099 --> -0.814803).  Saving model ...
Epoch: 33 cost time: 0.7578403949737549
Epoch: 33, Steps: 2 | Train Loss: 1.098 Vali Loss: 1.179 Vali Acc: 0.822 Test Loss: 1.179 Test Acc: 0.822
Validation loss decreased (-0.814803 --> -0.822210).  Saving model ...
Epoch: 34 cost time: 0.810868501663208
Epoch: 34, Steps: 2 | Train Loss: 1.061 Vali Loss: 1.146 Vali Acc: 0.826 Test Loss: 1.146 Test Acc: 0.826
Validation loss decreased (-0.822210 --> -0.825914).  Saving model ...
Epoch: 35 cost time: 0.8836090564727783
Epoch: 35, Steps: 2 | Train Loss: 1.029 Vali Loss: 1.114 Vali Acc: 0.826 Test Loss: 1.114 Test Acc: 0.826
Validation loss decreased (-0.825914 --> -0.825915).  Saving model ...
Epoch: 36 cost time: 0.829399585723877
Epoch: 36, Steps: 2 | Train Loss: 0.988 Vali Loss: 1.082 Vali Acc: 0.830 Test Loss: 1.082 Test Acc: 0.830
Validation loss decreased (-0.825915 --> -0.829619).  Saving model ...
Epoch: 37 cost time: 0.6352047920227051
Epoch: 37, Steps: 2 | Train Loss: 0.952 Vali Loss: 1.049 Vali Acc: 0.826 Test Loss: 1.049 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6891317367553711
Epoch: 38, Steps: 2 | Train Loss: 0.922 Vali Loss: 1.018 Vali Acc: 0.830 Test Loss: 1.018 Test Acc: 0.830
Validation loss decreased (-0.829619 --> -0.829619).  Saving model ...
Epoch: 39 cost time: 0.686495304107666
Epoch: 39, Steps: 2 | Train Loss: 0.884 Vali Loss: 0.987 Vali Acc: 0.833 Test Loss: 0.987 Test Acc: 0.833
Validation loss decreased (-0.829619 --> -0.833323).  Saving model ...
Epoch: 40 cost time: 0.8466536998748779
Epoch: 40, Steps: 2 | Train Loss: 0.851 Vali Loss: 0.956 Vali Acc: 0.844 Test Loss: 0.956 Test Acc: 0.844
Validation loss decreased (-0.833323 --> -0.844435).  Saving model ...
Epoch: 41 cost time: 0.7824571132659912
Epoch: 41, Steps: 2 | Train Loss: 0.812 Vali Loss: 0.926 Vali Acc: 0.844 Test Loss: 0.926 Test Acc: 0.844
Validation loss decreased (-0.844435 --> -0.844435).  Saving model ...
Epoch: 42 cost time: 1.0268206596374512
Epoch: 42, Steps: 2 | Train Loss: 0.774 Vali Loss: 0.897 Vali Acc: 0.852 Test Loss: 0.897 Test Acc: 0.852
Validation loss decreased (-0.844435 --> -0.851843).  Saving model ...
Epoch: 43 cost time: 0.881049394607544
Epoch: 43, Steps: 2 | Train Loss: 0.740 Vali Loss: 0.869 Vali Acc: 0.856 Test Loss: 0.869 Test Acc: 0.856
Validation loss decreased (-0.851843 --> -0.855547).  Saving model ...
Epoch: 44 cost time: 0.8441252708435059
Epoch: 44, Steps: 2 | Train Loss: 0.718 Vali Loss: 0.842 Vali Acc: 0.859 Test Loss: 0.842 Test Acc: 0.859
Validation loss decreased (-0.855547 --> -0.859251).  Saving model ...
Epoch: 45 cost time: 0.6554098129272461
Epoch: 45, Steps: 2 | Train Loss: 0.684 Vali Loss: 0.815 Vali Acc: 0.859 Test Loss: 0.815 Test Acc: 0.859
Validation loss decreased (-0.859251 --> -0.859251).  Saving model ...
Epoch: 46 cost time: 0.9294323921203613
Epoch: 46, Steps: 2 | Train Loss: 0.656 Vali Loss: 0.789 Vali Acc: 0.863 Test Loss: 0.789 Test Acc: 0.863
Validation loss decreased (-0.859251 --> -0.862955).  Saving model ...
Epoch: 47 cost time: 0.6896541118621826
Epoch: 47, Steps: 2 | Train Loss: 0.626 Vali Loss: 0.765 Vali Acc: 0.867 Test Loss: 0.765 Test Acc: 0.867
Validation loss decreased (-0.862955 --> -0.866659).  Saving model ...
Epoch: 48 cost time: 0.5780668258666992
Epoch: 48, Steps: 2 | Train Loss: 0.596 Vali Loss: 0.741 Vali Acc: 0.874 Test Loss: 0.741 Test Acc: 0.874
Validation loss decreased (-0.866659 --> -0.874067).  Saving model ...
Epoch: 49 cost time: 0.6639418601989746
Epoch: 49, Steps: 2 | Train Loss: 0.571 Vali Loss: 0.718 Vali Acc: 0.881 Test Loss: 0.718 Test Acc: 0.881
Validation loss decreased (-0.874067 --> -0.881474).  Saving model ...
Epoch: 50 cost time: 0.8910205364227295
Epoch: 50, Steps: 2 | Train Loss: 0.549 Vali Loss: 0.696 Vali Acc: 0.893 Test Loss: 0.696 Test Acc: 0.893
Validation loss decreased (-0.881474 --> -0.892586).  Saving model ...
Epoch: 51 cost time: 0.9337356090545654
Epoch: 51, Steps: 2 | Train Loss: 0.515 Vali Loss: 0.675 Vali Acc: 0.893 Test Loss: 0.675 Test Acc: 0.893
Validation loss decreased (-0.892586 --> -0.892586).  Saving model ...
Epoch: 52 cost time: 0.6700057983398438
Epoch: 52, Steps: 2 | Train Loss: 0.500 Vali Loss: 0.655 Vali Acc: 0.893 Test Loss: 0.655 Test Acc: 0.893
Validation loss decreased (-0.892586 --> -0.892586).  Saving model ...
Epoch: 53 cost time: 0.7184560298919678
Epoch: 53, Steps: 2 | Train Loss: 0.475 Vali Loss: 0.636 Vali Acc: 0.893 Test Loss: 0.636 Test Acc: 0.893
Validation loss decreased (-0.892586 --> -0.892586).  Saving model ...
Epoch: 54 cost time: 0.7081141471862793
Epoch: 54, Steps: 2 | Train Loss: 0.451 Vali Loss: 0.617 Vali Acc: 0.896 Test Loss: 0.617 Test Acc: 0.896
Validation loss decreased (-0.892586 --> -0.896290).  Saving model ...
Epoch: 55 cost time: 0.6268618106842041
Epoch: 55, Steps: 2 | Train Loss: 0.437 Vali Loss: 0.600 Vali Acc: 0.893 Test Loss: 0.600 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.7866320610046387
Epoch: 56, Steps: 2 | Train Loss: 0.411 Vali Loss: 0.583 Vali Acc: 0.893 Test Loss: 0.583 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.9502828121185303
Epoch: 57, Steps: 2 | Train Loss: 0.399 Vali Loss: 0.568 Vali Acc: 0.889 Test Loss: 0.568 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.1309168338775635
Epoch: 58, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.553 Vali Acc: 0.893 Test Loss: 0.553 Test Acc: 0.893
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.7180356979370117
Epoch: 59, Steps: 2 | Train Loss: 0.369 Vali Loss: 0.539 Vali Acc: 0.893 Test Loss: 0.539 Test Acc: 0.893
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.2599127292633057
Epoch: 60, Steps: 2 | Train Loss: 0.351 Vali Loss: 0.525 Vali Acc: 0.893 Test Loss: 0.525 Test Acc: 0.893
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.776979923248291
Epoch: 61, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.512 Vali Acc: 0.896 Test Loss: 0.512 Test Acc: 0.896
Validation loss decreased (-0.896290 --> -0.896291).  Saving model ...
Epoch: 62 cost time: 0.8800449371337891
Epoch: 62, Steps: 2 | Train Loss: 0.326 Vali Loss: 0.500 Vali Acc: 0.900 Test Loss: 0.500 Test Acc: 0.900
Validation loss decreased (-0.896291 --> -0.899995).  Saving model ...
Epoch: 63 cost time: 0.947542667388916
Epoch: 63, Steps: 2 | Train Loss: 0.308 Vali Loss: 0.489 Vali Acc: 0.904 Test Loss: 0.489 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903699).  Saving model ...
Epoch: 64 cost time: 0.8236041069030762
Epoch: 64, Steps: 2 | Train Loss: 0.294 Vali Loss: 0.478 Vali Acc: 0.907 Test Loss: 0.478 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 65 cost time: 0.9002068042755127
Epoch: 65, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.467 Vali Acc: 0.907 Test Loss: 0.467 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 66 cost time: 0.8368799686431885
Epoch: 66, Steps: 2 | Train Loss: 0.277 Vali Loss: 0.458 Vali Acc: 0.907 Test Loss: 0.458 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 67 cost time: 0.7820782661437988
Epoch: 67, Steps: 2 | Train Loss: 0.263 Vali Loss: 0.448 Vali Acc: 0.911 Test Loss: 0.448 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 68 cost time: 0.8027334213256836
Epoch: 68, Steps: 2 | Train Loss: 0.253 Vali Loss: 0.440 Vali Acc: 0.915 Test Loss: 0.440 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914810).  Saving model ...
Epoch: 69 cost time: 0.826707124710083
Epoch: 69, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.431 Vali Acc: 0.919 Test Loss: 0.431 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 70 cost time: 0.706063985824585
Epoch: 70, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.423 Vali Acc: 0.919 Test Loss: 0.423 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 71 cost time: 0.6301982402801514
Epoch: 71, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.416 Vali Acc: 0.911 Test Loss: 0.416 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.7290291786193848
Epoch: 72, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.408 Vali Acc: 0.915 Test Loss: 0.408 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.8325605392456055
Epoch: 73, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.402 Vali Acc: 0.911 Test Loss: 0.402 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 0.9683270454406738
Epoch: 74, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.395 Vali Acc: 0.911 Test Loss: 0.395 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 0.627737283706665
Epoch: 75, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.389 Vali Acc: 0.915 Test Loss: 0.389 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 0.7664647102355957
Epoch: 76, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.383 Vali Acc: 0.915 Test Loss: 0.383 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 0.8431432247161865
Epoch: 77, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.377 Vali Acc: 0.915 Test Loss: 0.377 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 0.8478765487670898
Epoch: 78, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.371 Vali Acc: 0.919 Test Loss: 0.371 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918515).  Saving model ...
Epoch: 79 cost time: 1.0982346534729004
Epoch: 79, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.366 Vali Acc: 0.919 Test Loss: 0.366 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 80 cost time: 0.8687779903411865
Epoch: 80, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.361 Vali Acc: 0.919 Test Loss: 0.361 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 81 cost time: 0.9085323810577393
Epoch: 81, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.356 Vali Acc: 0.919 Test Loss: 0.356 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 82 cost time: 0.8285579681396484
Epoch: 82, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.351 Vali Acc: 0.919 Test Loss: 0.351 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 83 cost time: 0.9134421348571777
Epoch: 83, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.347 Vali Acc: 0.919 Test Loss: 0.347 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 84 cost time: 0.8403327465057373
Epoch: 84, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.343 Vali Acc: 0.919 Test Loss: 0.343 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 85 cost time: 0.8728547096252441
Epoch: 85, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.339 Vali Acc: 0.919 Test Loss: 0.339 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 86 cost time: 1.0267913341522217
Epoch: 86, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.335 Vali Acc: 0.919 Test Loss: 0.335 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 87 cost time: 0.9107694625854492
Epoch: 87, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.331 Vali Acc: 0.915 Test Loss: 0.331 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 0.8520538806915283
Epoch: 88, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.327 Vali Acc: 0.915 Test Loss: 0.327 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 0.9241154193878174
Epoch: 89, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.324 Vali Acc: 0.915 Test Loss: 0.324 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 0.8772907257080078
Epoch: 90, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.320 Vali Acc: 0.915 Test Loss: 0.320 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 91 cost time: 0.7312395572662354
Epoch: 91, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.317 Vali Acc: 0.915 Test Loss: 0.317 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 92 cost time: 0.7798221111297607
Epoch: 92, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.315 Vali Acc: 0.915 Test Loss: 0.315 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 93 cost time: 0.7365231513977051
Epoch: 93, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.312 Vali Acc: 0.915 Test Loss: 0.312 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 94 cost time: 0.966494083404541
Epoch: 94, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.309 Vali Acc: 0.915 Test Loss: 0.309 Test Acc: 0.915
EarlyStopping counter: 8 out of 10
Epoch: 95 cost time: 0.8923132419586182
Epoch: 95, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.306 Vali Acc: 0.915 Test Loss: 0.306 Test Acc: 0.915
EarlyStopping counter: 9 out of 10
Epoch: 96 cost time: 0.82277512550354
Epoch: 96, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.304 Vali Acc: 0.915 Test Loss: 0.304 Test Acc: 0.915
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_DLinear_UEA_ftM_sl65_ll0_pl0_ma30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9185185185185185
model parameter : 10146
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         26                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_DLinear_UEA_ftM_sl65_ll0_pl0_ma26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.2574429512023926
Epoch: 1, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.790 Vali Acc: 0.167 Test Loss: 1.790 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 1.1514387130737305
Epoch: 2, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.787 Vali Acc: 0.167 Test Loss: 1.787 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 0.7732434272766113
Epoch: 3, Steps: 2 | Train Loss: 1.784 Vali Loss: 1.784 Vali Acc: 0.315 Test Loss: 1.784 Test Acc: 0.315
Validation loss decreased (-0.166649 --> -0.314797).  Saving model ...
Epoch: 4 cost time: 0.8514366149902344
Epoch: 4, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.779 Vali Acc: 0.333 Test Loss: 1.779 Test Acc: 0.333
Validation loss decreased (-0.314797 --> -0.333316).  Saving model ...
Epoch: 5 cost time: 1.5091896057128906
Epoch: 5, Steps: 2 | Train Loss: 1.773 Vali Loss: 1.772 Vali Acc: 0.333 Test Loss: 1.772 Test Acc: 0.333
Validation loss decreased (-0.333316 --> -0.333316).  Saving model ...
Epoch: 6 cost time: 0.8892617225646973
Epoch: 6, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.765 Vali Acc: 0.385 Test Loss: 1.765 Test Acc: 0.385
Validation loss decreased (-0.333316 --> -0.385168).  Saving model ...
Epoch: 7 cost time: 0.895916223526001
Epoch: 7, Steps: 2 | Train Loss: 1.756 Vali Loss: 1.756 Vali Acc: 0.507 Test Loss: 1.756 Test Acc: 0.507
Validation loss decreased (-0.385168 --> -0.507390).  Saving model ...
Epoch: 8 cost time: 0.8612635135650635
Epoch: 8, Steps: 2 | Train Loss: 1.745 Vali Loss: 1.746 Vali Acc: 0.596 Test Loss: 1.746 Test Acc: 0.596
Validation loss decreased (-0.507390 --> -0.596279).  Saving model ...
Epoch: 9 cost time: 1.1907298564910889
Epoch: 9, Steps: 2 | Train Loss: 1.733 Vali Loss: 1.736 Vali Acc: 0.644 Test Loss: 1.736 Test Acc: 0.644
Validation loss decreased (-0.596279 --> -0.644427).  Saving model ...
Epoch: 10 cost time: 0.8774785995483398
Epoch: 10, Steps: 2 | Train Loss: 1.721 Vali Loss: 1.724 Vali Acc: 0.700 Test Loss: 1.724 Test Acc: 0.700
Validation loss decreased (-0.644427 --> -0.699983).  Saving model ...
Epoch: 11 cost time: 1.0163497924804688
Epoch: 11, Steps: 2 | Train Loss: 1.704 Vali Loss: 1.712 Vali Acc: 0.719 Test Loss: 1.712 Test Acc: 0.719
Validation loss decreased (-0.699983 --> -0.718501).  Saving model ...
Epoch: 12 cost time: 1.0396926403045654
Epoch: 12, Steps: 2 | Train Loss: 1.690 Vali Loss: 1.698 Vali Acc: 0.726 Test Loss: 1.698 Test Acc: 0.726
Validation loss decreased (-0.718501 --> -0.725909).  Saving model ...
Epoch: 13 cost time: 0.8259775638580322
Epoch: 13, Steps: 2 | Train Loss: 1.676 Vali Loss: 1.684 Vali Acc: 0.756 Test Loss: 1.684 Test Acc: 0.756
Validation loss decreased (-0.725909 --> -0.755539).  Saving model ...
Epoch: 14 cost time: 0.8360979557037354
Epoch: 14, Steps: 2 | Train Loss: 1.658 Vali Loss: 1.668 Vali Acc: 0.759 Test Loss: 1.668 Test Acc: 0.759
Validation loss decreased (-0.755539 --> -0.759243).  Saving model ...
Epoch: 15 cost time: 0.997417688369751
Epoch: 15, Steps: 2 | Train Loss: 1.640 Vali Loss: 1.652 Vali Acc: 0.767 Test Loss: 1.652 Test Acc: 0.767
Validation loss decreased (-0.759243 --> -0.766650).  Saving model ...
Epoch: 16 cost time: 0.8540327548980713
Epoch: 16, Steps: 2 | Train Loss: 1.619 Vali Loss: 1.634 Vali Acc: 0.763 Test Loss: 1.634 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7460746765136719
Epoch: 17, Steps: 2 | Train Loss: 1.599 Vali Loss: 1.616 Vali Acc: 0.763 Test Loss: 1.616 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7346153259277344
Epoch: 18, Steps: 2 | Train Loss: 1.577 Vali Loss: 1.596 Vali Acc: 0.763 Test Loss: 1.596 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.78877854347229
Epoch: 19, Steps: 2 | Train Loss: 1.548 Vali Loss: 1.576 Vali Acc: 0.767 Test Loss: 1.576 Test Acc: 0.767
Validation loss decreased (-0.766650 --> -0.766651).  Saving model ...
Epoch: 20 cost time: 0.6402685642242432
Epoch: 20, Steps: 2 | Train Loss: 1.529 Vali Loss: 1.555 Vali Acc: 0.770 Test Loss: 1.555 Test Acc: 0.770
Validation loss decreased (-0.766651 --> -0.770355).  Saving model ...
Epoch: 21 cost time: 0.7391698360443115
Epoch: 21, Steps: 2 | Train Loss: 1.501 Vali Loss: 1.532 Vali Acc: 0.774 Test Loss: 1.532 Test Acc: 0.774
Validation loss decreased (-0.770355 --> -0.774059).  Saving model ...
Epoch: 22 cost time: 0.7542591094970703
Epoch: 22, Steps: 2 | Train Loss: 1.475 Vali Loss: 1.508 Vali Acc: 0.774 Test Loss: 1.508 Test Acc: 0.774
Validation loss decreased (-0.774059 --> -0.774059).  Saving model ...
Epoch: 23 cost time: 0.7218174934387207
Epoch: 23, Steps: 2 | Train Loss: 1.442 Vali Loss: 1.483 Vali Acc: 0.774 Test Loss: 1.483 Test Acc: 0.774
Validation loss decreased (-0.774059 --> -0.774059).  Saving model ...
Epoch: 24 cost time: 1.094651222229004
Epoch: 24, Steps: 2 | Train Loss: 1.416 Vali Loss: 1.457 Vali Acc: 0.785 Test Loss: 1.457 Test Acc: 0.785
Validation loss decreased (-0.774059 --> -0.785171).  Saving model ...
Epoch: 25 cost time: 0.9687705039978027
Epoch: 25, Steps: 2 | Train Loss: 1.387 Vali Loss: 1.430 Vali Acc: 0.789 Test Loss: 1.430 Test Acc: 0.789
Validation loss decreased (-0.785171 --> -0.788875).  Saving model ...
Epoch: 26 cost time: 0.8919529914855957
Epoch: 26, Steps: 2 | Train Loss: 1.357 Vali Loss: 1.402 Vali Acc: 0.793 Test Loss: 1.402 Test Acc: 0.793
Validation loss decreased (-0.788875 --> -0.792579).  Saving model ...
Epoch: 27 cost time: 0.8772101402282715
Epoch: 27, Steps: 2 | Train Loss: 1.321 Vali Loss: 1.373 Vali Acc: 0.796 Test Loss: 1.373 Test Acc: 0.796
Validation loss decreased (-0.792579 --> -0.796283).  Saving model ...
Epoch: 28 cost time: 0.8415539264678955
Epoch: 28, Steps: 2 | Train Loss: 1.293 Vali Loss: 1.343 Vali Acc: 0.800 Test Loss: 1.343 Test Acc: 0.800
Validation loss decreased (-0.796283 --> -0.799987).  Saving model ...
Epoch: 29 cost time: 0.8527462482452393
Epoch: 29, Steps: 2 | Train Loss: 1.261 Vali Loss: 1.312 Vali Acc: 0.800 Test Loss: 1.312 Test Acc: 0.800
Validation loss decreased (-0.799987 --> -0.799987).  Saving model ...
Epoch: 30 cost time: 0.9266235828399658
Epoch: 30, Steps: 2 | Train Loss: 1.222 Vali Loss: 1.281 Vali Acc: 0.800 Test Loss: 1.281 Test Acc: 0.800
Validation loss decreased (-0.799987 --> -0.799987).  Saving model ...
Epoch: 31 cost time: 0.7474379539489746
Epoch: 31, Steps: 2 | Train Loss: 1.186 Vali Loss: 1.249 Vali Acc: 0.804 Test Loss: 1.249 Test Acc: 0.804
Validation loss decreased (-0.799987 --> -0.803691).  Saving model ...
Epoch: 32 cost time: 0.83294677734375
Epoch: 32, Steps: 2 | Train Loss: 1.146 Vali Loss: 1.217 Vali Acc: 0.804 Test Loss: 1.217 Test Acc: 0.804
Validation loss decreased (-0.803691 --> -0.803692).  Saving model ...
Epoch: 33 cost time: 0.9247441291809082
Epoch: 33, Steps: 2 | Train Loss: 1.103 Vali Loss: 1.185 Vali Acc: 0.811 Test Loss: 1.185 Test Acc: 0.811
Validation loss decreased (-0.803692 --> -0.811099).  Saving model ...
Epoch: 34 cost time: 1.3234548568725586
Epoch: 34, Steps: 2 | Train Loss: 1.066 Vali Loss: 1.153 Vali Acc: 0.807 Test Loss: 1.153 Test Acc: 0.807
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.917123556137085
Epoch: 35, Steps: 2 | Train Loss: 1.034 Vali Loss: 1.120 Vali Acc: 0.811 Test Loss: 1.120 Test Acc: 0.811
Validation loss decreased (-0.811099 --> -0.811100).  Saving model ...
Epoch: 36 cost time: 0.8717477321624756
Epoch: 36, Steps: 2 | Train Loss: 0.993 Vali Loss: 1.088 Vali Acc: 0.815 Test Loss: 1.088 Test Acc: 0.815
Validation loss decreased (-0.811100 --> -0.814804).  Saving model ...
Epoch: 37 cost time: 0.7500655651092529
Epoch: 37, Steps: 2 | Train Loss: 0.958 Vali Loss: 1.056 Vali Acc: 0.819 Test Loss: 1.056 Test Acc: 0.819
Validation loss decreased (-0.814804 --> -0.818508).  Saving model ...
Epoch: 38 cost time: 1.1586534976959229
Epoch: 38, Steps: 2 | Train Loss: 0.927 Vali Loss: 1.025 Vali Acc: 0.819 Test Loss: 1.025 Test Acc: 0.819
Validation loss decreased (-0.818508 --> -0.818508).  Saving model ...
Epoch: 39 cost time: 0.905996561050415
Epoch: 39, Steps: 2 | Train Loss: 0.889 Vali Loss: 0.994 Vali Acc: 0.822 Test Loss: 0.994 Test Acc: 0.822
Validation loss decreased (-0.818508 --> -0.822212).  Saving model ...
Epoch: 40 cost time: 1.1204051971435547
Epoch: 40, Steps: 2 | Train Loss: 0.856 Vali Loss: 0.964 Vali Acc: 0.826 Test Loss: 0.964 Test Acc: 0.826
Validation loss decreased (-0.822212 --> -0.825916).  Saving model ...
Epoch: 41 cost time: 0.8934915065765381
Epoch: 41, Steps: 2 | Train Loss: 0.817 Vali Loss: 0.934 Vali Acc: 0.830 Test Loss: 0.934 Test Acc: 0.830
Validation loss decreased (-0.825916 --> -0.829620).  Saving model ...
Epoch: 42 cost time: 1.0741488933563232
Epoch: 42, Steps: 2 | Train Loss: 0.779 Vali Loss: 0.905 Vali Acc: 0.833 Test Loss: 0.905 Test Acc: 0.833
Validation loss decreased (-0.829620 --> -0.833324).  Saving model ...
Epoch: 43 cost time: 0.815706729888916
Epoch: 43, Steps: 2 | Train Loss: 0.745 Vali Loss: 0.877 Vali Acc: 0.837 Test Loss: 0.877 Test Acc: 0.837
Validation loss decreased (-0.833324 --> -0.837028).  Saving model ...
Epoch: 44 cost time: 1.144648551940918
Epoch: 44, Steps: 2 | Train Loss: 0.723 Vali Loss: 0.849 Vali Acc: 0.837 Test Loss: 0.849 Test Acc: 0.837
Validation loss decreased (-0.837028 --> -0.837029).  Saving model ...
Epoch: 45 cost time: 1.140700340270996
Epoch: 45, Steps: 2 | Train Loss: 0.690 Vali Loss: 0.823 Vali Acc: 0.841 Test Loss: 0.823 Test Acc: 0.841
Validation loss decreased (-0.837029 --> -0.840733).  Saving model ...
Epoch: 46 cost time: 0.8855931758880615
Epoch: 46, Steps: 2 | Train Loss: 0.661 Vali Loss: 0.798 Vali Acc: 0.852 Test Loss: 0.798 Test Acc: 0.852
Validation loss decreased (-0.840733 --> -0.851844).  Saving model ...
Epoch: 47 cost time: 0.8515965938568115
Epoch: 47, Steps: 2 | Train Loss: 0.631 Vali Loss: 0.773 Vali Acc: 0.852 Test Loss: 0.773 Test Acc: 0.852
Validation loss decreased (-0.851844 --> -0.851844).  Saving model ...
Epoch: 48 cost time: 0.7295999526977539
Epoch: 48, Steps: 2 | Train Loss: 0.602 Vali Loss: 0.749 Vali Acc: 0.859 Test Loss: 0.749 Test Acc: 0.859
Validation loss decreased (-0.851844 --> -0.859252).  Saving model ...
Epoch: 49 cost time: 1.1778857707977295
Epoch: 49, Steps: 2 | Train Loss: 0.577 Vali Loss: 0.727 Vali Acc: 0.863 Test Loss: 0.727 Test Acc: 0.863
Validation loss decreased (-0.859252 --> -0.862956).  Saving model ...
Epoch: 50 cost time: 0.8451263904571533
Epoch: 50, Steps: 2 | Train Loss: 0.555 Vali Loss: 0.705 Vali Acc: 0.870 Test Loss: 0.705 Test Acc: 0.870
Validation loss decreased (-0.862956 --> -0.870363).  Saving model ...
Epoch: 51 cost time: 0.9988617897033691
Epoch: 51, Steps: 2 | Train Loss: 0.521 Vali Loss: 0.684 Vali Acc: 0.881 Test Loss: 0.684 Test Acc: 0.881
Validation loss decreased (-0.870363 --> -0.881475).  Saving model ...
Epoch: 52 cost time: 1.078927993774414
Epoch: 52, Steps: 2 | Train Loss: 0.506 Vali Loss: 0.664 Vali Acc: 0.881 Test Loss: 0.664 Test Acc: 0.881
Validation loss decreased (-0.881475 --> -0.881475).  Saving model ...
Epoch: 53 cost time: 1.3944017887115479
Epoch: 53, Steps: 2 | Train Loss: 0.480 Vali Loss: 0.645 Vali Acc: 0.881 Test Loss: 0.645 Test Acc: 0.881
Validation loss decreased (-0.881475 --> -0.881475).  Saving model ...
Epoch: 54 cost time: 1.2502186298370361
Epoch: 54, Steps: 2 | Train Loss: 0.457 Vali Loss: 0.627 Vali Acc: 0.881 Test Loss: 0.627 Test Acc: 0.881
Validation loss decreased (-0.881475 --> -0.881475).  Saving model ...
Epoch: 55 cost time: 1.185880422592163
Epoch: 55, Steps: 2 | Train Loss: 0.443 Vali Loss: 0.610 Vali Acc: 0.885 Test Loss: 0.610 Test Acc: 0.885
Validation loss decreased (-0.881475 --> -0.885179).  Saving model ...
Epoch: 56 cost time: 0.9083876609802246
Epoch: 56, Steps: 2 | Train Loss: 0.417 Vali Loss: 0.593 Vali Acc: 0.885 Test Loss: 0.593 Test Acc: 0.885
Validation loss decreased (-0.885179 --> -0.885179).  Saving model ...
Epoch: 57 cost time: 1.020599126815796
Epoch: 57, Steps: 2 | Train Loss: 0.404 Vali Loss: 0.578 Vali Acc: 0.889 Test Loss: 0.578 Test Acc: 0.889
Validation loss decreased (-0.885179 --> -0.888883).  Saving model ...
Epoch: 58 cost time: 1.1095647811889648
Epoch: 58, Steps: 2 | Train Loss: 0.386 Vali Loss: 0.563 Vali Acc: 0.889 Test Loss: 0.563 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888883).  Saving model ...
Epoch: 59 cost time: 1.2237493991851807
Epoch: 59, Steps: 2 | Train Loss: 0.374 Vali Loss: 0.549 Vali Acc: 0.889 Test Loss: 0.549 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888883).  Saving model ...
Epoch: 60 cost time: 0.6995267868041992
Epoch: 60, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.536 Vali Acc: 0.889 Test Loss: 0.536 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888884).  Saving model ...
Epoch: 61 cost time: 1.0241615772247314
Epoch: 61, Steps: 2 | Train Loss: 0.339 Vali Loss: 0.523 Vali Acc: 0.893 Test Loss: 0.523 Test Acc: 0.893
Validation loss decreased (-0.888884 --> -0.892587).  Saving model ...
Epoch: 62 cost time: 0.9538424015045166
Epoch: 62, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.512 Vali Acc: 0.889 Test Loss: 0.512 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.966759204864502
Epoch: 63, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.500 Vali Acc: 0.889 Test Loss: 0.500 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.112062931060791
Epoch: 64, Steps: 2 | Train Loss: 0.299 Vali Loss: 0.489 Vali Acc: 0.893 Test Loss: 0.489 Test Acc: 0.893
Validation loss decreased (-0.892587 --> -0.892588).  Saving model ...
Epoch: 65 cost time: 0.7242162227630615
Epoch: 65, Steps: 2 | Train Loss: 0.291 Vali Loss: 0.479 Vali Acc: 0.896 Test Loss: 0.479 Test Acc: 0.896
Validation loss decreased (-0.892588 --> -0.896292).  Saving model ...
Epoch: 66 cost time: 1.0499389171600342
Epoch: 66, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.469 Vali Acc: 0.900 Test Loss: 0.469 Test Acc: 0.900
Validation loss decreased (-0.896292 --> -0.899995).  Saving model ...
Epoch: 67 cost time: 0.7869162559509277
Epoch: 67, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.460 Vali Acc: 0.900 Test Loss: 0.460 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 68 cost time: 0.9707579612731934
Epoch: 68, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.451 Vali Acc: 0.900 Test Loss: 0.451 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 69 cost time: 1.0833239555358887
Epoch: 69, Steps: 2 | Train Loss: 0.251 Vali Loss: 0.443 Vali Acc: 0.900 Test Loss: 0.443 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 70 cost time: 1.1021802425384521
Epoch: 70, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.435 Vali Acc: 0.904 Test Loss: 0.435 Test Acc: 0.904
Validation loss decreased (-0.899996 --> -0.903699).  Saving model ...
Epoch: 71 cost time: 0.7474403381347656
Epoch: 71, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.428 Vali Acc: 0.904 Test Loss: 0.428 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903699).  Saving model ...
Epoch: 72 cost time: 0.9994404315948486
Epoch: 72, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.421 Vali Acc: 0.904 Test Loss: 0.421 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903699).  Saving model ...
Epoch: 73 cost time: 0.9069843292236328
Epoch: 73, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.414 Vali Acc: 0.904 Test Loss: 0.414 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903700).  Saving model ...
Epoch: 74 cost time: 0.9648494720458984
Epoch: 74, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.407 Vali Acc: 0.904 Test Loss: 0.407 Test Acc: 0.904
Validation loss decreased (-0.903700 --> -0.903700).  Saving model ...
Epoch: 75 cost time: 0.9149456024169922
Epoch: 75, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.401 Vali Acc: 0.904 Test Loss: 0.401 Test Acc: 0.904
Validation loss decreased (-0.903700 --> -0.903700).  Saving model ...
Epoch: 76 cost time: 1.0546443462371826
Epoch: 76, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.395 Vali Acc: 0.904 Test Loss: 0.395 Test Acc: 0.904
Validation loss decreased (-0.903700 --> -0.903700).  Saving model ...
Epoch: 77 cost time: 0.9915571212768555
Epoch: 77, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.389 Vali Acc: 0.904 Test Loss: 0.389 Test Acc: 0.904
Validation loss decreased (-0.903700 --> -0.903700).  Saving model ...
Epoch: 78 cost time: 0.8968081474304199
Epoch: 78, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.383 Vali Acc: 0.904 Test Loss: 0.383 Test Acc: 0.904
Validation loss decreased (-0.903700 --> -0.903700).  Saving model ...
Epoch: 79 cost time: 1.150130033493042
Epoch: 79, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.378 Vali Acc: 0.904 Test Loss: 0.378 Test Acc: 0.904
Validation loss decreased (-0.903700 --> -0.903700).  Saving model ...
Epoch: 80 cost time: 1.0090394020080566
Epoch: 80, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.373 Vali Acc: 0.904 Test Loss: 0.373 Test Acc: 0.904
Validation loss decreased (-0.903700 --> -0.903700).  Saving model ...
Epoch: 81 cost time: 1.1666181087493896
Epoch: 81, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.368 Vali Acc: 0.904 Test Loss: 0.368 Test Acc: 0.904
Validation loss decreased (-0.903700 --> -0.903700).  Saving model ...
Epoch: 82 cost time: 1.0314993858337402
Epoch: 82, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.364 Vali Acc: 0.904 Test Loss: 0.364 Test Acc: 0.904
Validation loss decreased (-0.903700 --> -0.903700).  Saving model ...
Epoch: 83 cost time: 1.0515952110290527
Epoch: 83, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.359 Vali Acc: 0.904 Test Loss: 0.359 Test Acc: 0.904
Validation loss decreased (-0.903700 --> -0.903700).  Saving model ...
Epoch: 84 cost time: 0.9530510902404785
Epoch: 84, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.355 Vali Acc: 0.904 Test Loss: 0.355 Test Acc: 0.904
Validation loss decreased (-0.903700 --> -0.903700).  Saving model ...
Epoch: 85 cost time: 1.005066156387329
Epoch: 85, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.351 Vali Acc: 0.904 Test Loss: 0.351 Test Acc: 0.904
Validation loss decreased (-0.903700 --> -0.903700).  Saving model ...
Epoch: 86 cost time: 1.0034875869750977
Epoch: 86, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.347 Vali Acc: 0.904 Test Loss: 0.347 Test Acc: 0.904
Validation loss decreased (-0.903700 --> -0.903700).  Saving model ...
Epoch: 87 cost time: 0.9012467861175537
Epoch: 87, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.343 Vali Acc: 0.904 Test Loss: 0.343 Test Acc: 0.904
Validation loss decreased (-0.903700 --> -0.903700).  Saving model ...
Epoch: 88 cost time: 1.1725354194641113
Epoch: 88, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.340 Vali Acc: 0.904 Test Loss: 0.340 Test Acc: 0.904
Validation loss decreased (-0.903700 --> -0.903700).  Saving model ...
Epoch: 89 cost time: 1.1067304611206055
Epoch: 89, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.336 Vali Acc: 0.904 Test Loss: 0.336 Test Acc: 0.904
Validation loss decreased (-0.903700 --> -0.903700).  Saving model ...
Epoch: 90 cost time: 1.1000373363494873
Epoch: 90, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.333 Vali Acc: 0.907 Test Loss: 0.333 Test Acc: 0.907
Validation loss decreased (-0.903700 --> -0.907404).  Saving model ...
Epoch: 91 cost time: 1.0698325634002686
Epoch: 91, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.330 Vali Acc: 0.904 Test Loss: 0.330 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 1.560971736907959
Epoch: 92, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.327 Vali Acc: 0.904 Test Loss: 0.327 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 1.4638910293579102
Epoch: 93, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.324 Vali Acc: 0.904 Test Loss: 0.324 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 1.5227084159851074
Epoch: 94, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.321 Vali Acc: 0.900 Test Loss: 0.321 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 1.1311542987823486
Epoch: 95, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.319 Vali Acc: 0.900 Test Loss: 0.319 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 96 cost time: 0.9263803958892822
Epoch: 96, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.316 Vali Acc: 0.900 Test Loss: 0.316 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 97 cost time: 1.2243733406066895
Epoch: 97, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.314 Vali Acc: 0.900 Test Loss: 0.314 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 98 cost time: 0.9626202583312988
Epoch: 98, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.311 Vali Acc: 0.904 Test Loss: 0.311 Test Acc: 0.904
EarlyStopping counter: 8 out of 10
Epoch: 99 cost time: 1.3299329280853271
Epoch: 99, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.308 Vali Acc: 0.904 Test Loss: 0.308 Test Acc: 0.904
EarlyStopping counter: 9 out of 10
Epoch: 100 cost time: 1.2756474018096924
Epoch: 100, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.306 Vali Acc: 0.904 Test Loss: 0.306 Test Acc: 0.904
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_DLinear_UEA_ftM_sl65_ll0_pl0_ma26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9074074074074074
model parameter : 10146
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         23                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_DLinear_UEA_ftM_sl65_ll0_pl0_ma23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.9831478595733643
Epoch: 1, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.790 Vali Acc: 0.167 Test Loss: 1.790 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 0.9449326992034912
Epoch: 2, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.787 Vali Acc: 0.167 Test Loss: 1.787 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 0.745650053024292
Epoch: 3, Steps: 2 | Train Loss: 1.784 Vali Loss: 1.784 Vali Acc: 0.319 Test Loss: 1.784 Test Acc: 0.319
Validation loss decreased (-0.166649 --> -0.318501).  Saving model ...
Epoch: 4 cost time: 0.8178761005401611
Epoch: 4, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.779 Vali Acc: 0.333 Test Loss: 1.779 Test Acc: 0.333
Validation loss decreased (-0.318501 --> -0.333316).  Saving model ...
Epoch: 5 cost time: 0.7013852596282959
Epoch: 5, Steps: 2 | Train Loss: 1.773 Vali Loss: 1.772 Vali Acc: 0.333 Test Loss: 1.772 Test Acc: 0.333
Validation loss decreased (-0.333316 --> -0.333316).  Saving model ...
Epoch: 6 cost time: 0.7448348999023438
Epoch: 6, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.765 Vali Acc: 0.374 Test Loss: 1.765 Test Acc: 0.374
Validation loss decreased (-0.333316 --> -0.374056).  Saving model ...
Epoch: 7 cost time: 0.854017972946167
Epoch: 7, Steps: 2 | Train Loss: 1.756 Vali Loss: 1.756 Vali Acc: 0.511 Test Loss: 1.756 Test Acc: 0.511
Validation loss decreased (-0.374056 --> -0.511094).  Saving model ...
Epoch: 8 cost time: 1.0120675563812256
Epoch: 8, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.747 Vali Acc: 0.593 Test Loss: 1.747 Test Acc: 0.593
Validation loss decreased (-0.511094 --> -0.592575).  Saving model ...
Epoch: 9 cost time: 1.326833963394165
Epoch: 9, Steps: 2 | Train Loss: 1.733 Vali Loss: 1.736 Vali Acc: 0.644 Test Loss: 1.736 Test Acc: 0.644
Validation loss decreased (-0.592575 --> -0.644427).  Saving model ...
Epoch: 10 cost time: 0.8719649314880371
Epoch: 10, Steps: 2 | Train Loss: 1.722 Vali Loss: 1.725 Vali Acc: 0.693 Test Loss: 1.725 Test Acc: 0.693
Validation loss decreased (-0.644427 --> -0.692575).  Saving model ...
Epoch: 11 cost time: 1.1415362358093262
Epoch: 11, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.713 Vali Acc: 0.715 Test Loss: 1.713 Test Acc: 0.715
Validation loss decreased (-0.692575 --> -0.714798).  Saving model ...
Epoch: 12 cost time: 0.9292011260986328
Epoch: 12, Steps: 2 | Train Loss: 1.692 Vali Loss: 1.699 Vali Acc: 0.741 Test Loss: 1.699 Test Acc: 0.741
Validation loss decreased (-0.714798 --> -0.740724).  Saving model ...
Epoch: 13 cost time: 1.208939552307129
Epoch: 13, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.685 Vali Acc: 0.756 Test Loss: 1.685 Test Acc: 0.756
Validation loss decreased (-0.740724 --> -0.755539).  Saving model ...
Epoch: 14 cost time: 0.7173466682434082
Epoch: 14, Steps: 2 | Train Loss: 1.660 Vali Loss: 1.670 Vali Acc: 0.763 Test Loss: 1.670 Test Acc: 0.763
Validation loss decreased (-0.755539 --> -0.762946).  Saving model ...
Epoch: 15 cost time: 0.8494634628295898
Epoch: 15, Steps: 2 | Train Loss: 1.642 Vali Loss: 1.654 Vali Acc: 0.767 Test Loss: 1.654 Test Acc: 0.767
Validation loss decreased (-0.762946 --> -0.766650).  Saving model ...
Epoch: 16 cost time: 0.7071292400360107
Epoch: 16, Steps: 2 | Train Loss: 1.621 Vali Loss: 1.637 Vali Acc: 0.767 Test Loss: 1.637 Test Acc: 0.767
Validation loss decreased (-0.766650 --> -0.766650).  Saving model ...
Epoch: 17 cost time: 0.811650276184082
Epoch: 17, Steps: 2 | Train Loss: 1.601 Vali Loss: 1.618 Vali Acc: 0.763 Test Loss: 1.618 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9519619941711426
Epoch: 18, Steps: 2 | Train Loss: 1.579 Vali Loss: 1.599 Vali Acc: 0.767 Test Loss: 1.599 Test Acc: 0.767
Validation loss decreased (-0.766650 --> -0.766651).  Saving model ...
Epoch: 19 cost time: 0.8396883010864258
Epoch: 19, Steps: 2 | Train Loss: 1.551 Vali Loss: 1.579 Vali Acc: 0.770 Test Loss: 1.579 Test Acc: 0.770
Validation loss decreased (-0.766651 --> -0.770355).  Saving model ...
Epoch: 20 cost time: 0.8283517360687256
Epoch: 20, Steps: 2 | Train Loss: 1.532 Vali Loss: 1.558 Vali Acc: 0.774 Test Loss: 1.558 Test Acc: 0.774
Validation loss decreased (-0.770355 --> -0.774058).  Saving model ...
Epoch: 21 cost time: 0.920529842376709
Epoch: 21, Steps: 2 | Train Loss: 1.505 Vali Loss: 1.536 Vali Acc: 0.774 Test Loss: 1.536 Test Acc: 0.774
Validation loss decreased (-0.774058 --> -0.774059).  Saving model ...
Epoch: 22 cost time: 0.9070768356323242
Epoch: 22, Steps: 2 | Train Loss: 1.479 Vali Loss: 1.512 Vali Acc: 0.774 Test Loss: 1.512 Test Acc: 0.774
Validation loss decreased (-0.774059 --> -0.774059).  Saving model ...
Epoch: 23 cost time: 0.9141061305999756
Epoch: 23, Steps: 2 | Train Loss: 1.446 Vali Loss: 1.488 Vali Acc: 0.778 Test Loss: 1.488 Test Acc: 0.778
Validation loss decreased (-0.774059 --> -0.777763).  Saving model ...
Epoch: 24 cost time: 1.245244026184082
Epoch: 24, Steps: 2 | Train Loss: 1.421 Vali Loss: 1.462 Vali Acc: 0.778 Test Loss: 1.462 Test Acc: 0.778
Validation loss decreased (-0.777763 --> -0.777763).  Saving model ...
Epoch: 25 cost time: 1.1144564151763916
Epoch: 25, Steps: 2 | Train Loss: 1.392 Vali Loss: 1.435 Vali Acc: 0.778 Test Loss: 1.435 Test Acc: 0.778
Validation loss decreased (-0.777763 --> -0.777763).  Saving model ...
Epoch: 26 cost time: 1.2209022045135498
Epoch: 26, Steps: 2 | Train Loss: 1.362 Vali Loss: 1.407 Vali Acc: 0.789 Test Loss: 1.407 Test Acc: 0.789
Validation loss decreased (-0.777763 --> -0.788875).  Saving model ...
Epoch: 27 cost time: 0.7777853012084961
Epoch: 27, Steps: 2 | Train Loss: 1.327 Vali Loss: 1.379 Vali Acc: 0.796 Test Loss: 1.379 Test Acc: 0.796
Validation loss decreased (-0.788875 --> -0.796283).  Saving model ...
Epoch: 28 cost time: 0.7921810150146484
Epoch: 28, Steps: 2 | Train Loss: 1.299 Vali Loss: 1.349 Vali Acc: 0.796 Test Loss: 1.349 Test Acc: 0.796
Validation loss decreased (-0.796283 --> -0.796283).  Saving model ...
Epoch: 29 cost time: 1.0354244709014893
Epoch: 29, Steps: 2 | Train Loss: 1.267 Vali Loss: 1.318 Vali Acc: 0.796 Test Loss: 1.318 Test Acc: 0.796
Validation loss decreased (-0.796283 --> -0.796283).  Saving model ...
Epoch: 30 cost time: 0.7963840961456299
Epoch: 30, Steps: 2 | Train Loss: 1.228 Vali Loss: 1.288 Vali Acc: 0.796 Test Loss: 1.288 Test Acc: 0.796
Validation loss decreased (-0.796283 --> -0.796283).  Saving model ...
Epoch: 31 cost time: 0.8321540355682373
Epoch: 31, Steps: 2 | Train Loss: 1.193 Vali Loss: 1.256 Vali Acc: 0.800 Test Loss: 1.256 Test Acc: 0.800
Validation loss decreased (-0.796283 --> -0.799987).  Saving model ...
Epoch: 32 cost time: 0.7639093399047852
Epoch: 32, Steps: 2 | Train Loss: 1.153 Vali Loss: 1.225 Vali Acc: 0.804 Test Loss: 1.225 Test Acc: 0.804
Validation loss decreased (-0.799987 --> -0.803691).  Saving model ...
Epoch: 33 cost time: 0.8331441879272461
Epoch: 33, Steps: 2 | Train Loss: 1.111 Vali Loss: 1.193 Vali Acc: 0.800 Test Loss: 1.193 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8191709518432617
Epoch: 34, Steps: 2 | Train Loss: 1.074 Vali Loss: 1.160 Vali Acc: 0.800 Test Loss: 1.160 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8114089965820312
Epoch: 35, Steps: 2 | Train Loss: 1.042 Vali Loss: 1.128 Vali Acc: 0.804 Test Loss: 1.128 Test Acc: 0.804
Validation loss decreased (-0.803691 --> -0.803692).  Saving model ...
Epoch: 36 cost time: 1.000330924987793
Epoch: 36, Steps: 2 | Train Loss: 1.001 Vali Loss: 1.096 Vali Acc: 0.807 Test Loss: 1.096 Test Acc: 0.807
Validation loss decreased (-0.803692 --> -0.807396).  Saving model ...
Epoch: 37 cost time: 0.9646143913269043
Epoch: 37, Steps: 2 | Train Loss: 0.966 Vali Loss: 1.064 Vali Acc: 0.811 Test Loss: 1.064 Test Acc: 0.811
Validation loss decreased (-0.807396 --> -0.811100).  Saving model ...
Epoch: 38 cost time: 0.9098107814788818
Epoch: 38, Steps: 2 | Train Loss: 0.935 Vali Loss: 1.033 Vali Acc: 0.811 Test Loss: 1.033 Test Acc: 0.811
Validation loss decreased (-0.811100 --> -0.811101).  Saving model ...
Epoch: 39 cost time: 0.7023828029632568
Epoch: 39, Steps: 2 | Train Loss: 0.897 Vali Loss: 1.002 Vali Acc: 0.811 Test Loss: 1.002 Test Acc: 0.811
Validation loss decreased (-0.811101 --> -0.811101).  Saving model ...
Epoch: 40 cost time: 0.8393518924713135
Epoch: 40, Steps: 2 | Train Loss: 0.864 Vali Loss: 0.972 Vali Acc: 0.811 Test Loss: 0.972 Test Acc: 0.811
Validation loss decreased (-0.811101 --> -0.811101).  Saving model ...
Epoch: 41 cost time: 1.1138603687286377
Epoch: 41, Steps: 2 | Train Loss: 0.826 Vali Loss: 0.942 Vali Acc: 0.819 Test Loss: 0.942 Test Acc: 0.819
Validation loss decreased (-0.811101 --> -0.818509).  Saving model ...
Epoch: 42 cost time: 0.8686656951904297
Epoch: 42, Steps: 2 | Train Loss: 0.787 Vali Loss: 0.913 Vali Acc: 0.833 Test Loss: 0.913 Test Acc: 0.833
Validation loss decreased (-0.818509 --> -0.833324).  Saving model ...
Epoch: 43 cost time: 1.0616440773010254
Epoch: 43, Steps: 2 | Train Loss: 0.753 Vali Loss: 0.885 Vali Acc: 0.833 Test Loss: 0.885 Test Acc: 0.833
Validation loss decreased (-0.833324 --> -0.833324).  Saving model ...
Epoch: 44 cost time: 1.113877296447754
Epoch: 44, Steps: 2 | Train Loss: 0.731 Vali Loss: 0.858 Vali Acc: 0.833 Test Loss: 0.858 Test Acc: 0.833
Validation loss decreased (-0.833324 --> -0.833325).  Saving model ...
Epoch: 45 cost time: 0.9410901069641113
Epoch: 45, Steps: 2 | Train Loss: 0.697 Vali Loss: 0.831 Vali Acc: 0.837 Test Loss: 0.831 Test Acc: 0.837
Validation loss decreased (-0.833325 --> -0.837029).  Saving model ...
Epoch: 46 cost time: 0.820286750793457
Epoch: 46, Steps: 2 | Train Loss: 0.669 Vali Loss: 0.806 Vali Acc: 0.837 Test Loss: 0.806 Test Acc: 0.837
Validation loss decreased (-0.837029 --> -0.837029).  Saving model ...
Epoch: 47 cost time: 1.0605876445770264
Epoch: 47, Steps: 2 | Train Loss: 0.638 Vali Loss: 0.781 Vali Acc: 0.844 Test Loss: 0.781 Test Acc: 0.844
Validation loss decreased (-0.837029 --> -0.844437).  Saving model ...
Epoch: 48 cost time: 1.5199408531188965
Epoch: 48, Steps: 2 | Train Loss: 0.609 Vali Loss: 0.758 Vali Acc: 0.852 Test Loss: 0.758 Test Acc: 0.852
Validation loss decreased (-0.844437 --> -0.851844).  Saving model ...
Epoch: 49 cost time: 0.8180410861968994
Epoch: 49, Steps: 2 | Train Loss: 0.584 Vali Loss: 0.735 Vali Acc: 0.852 Test Loss: 0.735 Test Acc: 0.852
Validation loss decreased (-0.851844 --> -0.851844).  Saving model ...
Epoch: 50 cost time: 0.988532543182373
Epoch: 50, Steps: 2 | Train Loss: 0.562 Vali Loss: 0.714 Vali Acc: 0.856 Test Loss: 0.714 Test Acc: 0.856
Validation loss decreased (-0.851844 --> -0.855548).  Saving model ...
Epoch: 51 cost time: 1.089773178100586
Epoch: 51, Steps: 2 | Train Loss: 0.528 Vali Loss: 0.693 Vali Acc: 0.863 Test Loss: 0.693 Test Acc: 0.863
Validation loss decreased (-0.855548 --> -0.862956).  Saving model ...
Epoch: 52 cost time: 0.965712308883667
Epoch: 52, Steps: 2 | Train Loss: 0.513 Vali Loss: 0.673 Vali Acc: 0.878 Test Loss: 0.673 Test Acc: 0.878
Validation loss decreased (-0.862956 --> -0.877771).  Saving model ...
Epoch: 53 cost time: 0.8851277828216553
Epoch: 53, Steps: 2 | Train Loss: 0.487 Vali Loss: 0.654 Vali Acc: 0.878 Test Loss: 0.654 Test Acc: 0.878
Validation loss decreased (-0.877771 --> -0.877771).  Saving model ...
Epoch: 54 cost time: 0.8912143707275391
Epoch: 54, Steps: 2 | Train Loss: 0.463 Vali Loss: 0.636 Vali Acc: 0.881 Test Loss: 0.636 Test Acc: 0.881
Validation loss decreased (-0.877771 --> -0.881475).  Saving model ...
Epoch: 55 cost time: 0.7286643981933594
Epoch: 55, Steps: 2 | Train Loss: 0.449 Vali Loss: 0.618 Vali Acc: 0.881 Test Loss: 0.618 Test Acc: 0.881
Validation loss decreased (-0.881475 --> -0.881475).  Saving model ...
Epoch: 56 cost time: 0.9989612102508545
Epoch: 56, Steps: 2 | Train Loss: 0.423 Vali Loss: 0.602 Vali Acc: 0.881 Test Loss: 0.602 Test Acc: 0.881
Validation loss decreased (-0.881475 --> -0.881475).  Saving model ...
Epoch: 57 cost time: 0.8344643115997314
Epoch: 57, Steps: 2 | Train Loss: 0.411 Vali Loss: 0.586 Vali Acc: 0.885 Test Loss: 0.586 Test Acc: 0.885
Validation loss decreased (-0.881475 --> -0.885179).  Saving model ...
Epoch: 58 cost time: 0.884521484375
Epoch: 58, Steps: 2 | Train Loss: 0.393 Vali Loss: 0.572 Vali Acc: 0.889 Test Loss: 0.572 Test Acc: 0.889
Validation loss decreased (-0.885179 --> -0.888883).  Saving model ...
Epoch: 59 cost time: 0.8410196304321289
Epoch: 59, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.558 Vali Acc: 0.889 Test Loss: 0.558 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888883).  Saving model ...
Epoch: 60 cost time: 1.0974090099334717
Epoch: 60, Steps: 2 | Train Loss: 0.363 Vali Loss: 0.545 Vali Acc: 0.889 Test Loss: 0.545 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888883).  Saving model ...
Epoch: 61 cost time: 1.002978801727295
Epoch: 61, Steps: 2 | Train Loss: 0.345 Vali Loss: 0.532 Vali Acc: 0.893 Test Loss: 0.532 Test Acc: 0.893
Validation loss decreased (-0.888883 --> -0.892587).  Saving model ...
Epoch: 62 cost time: 0.9782500267028809
Epoch: 62, Steps: 2 | Train Loss: 0.337 Vali Loss: 0.520 Vali Acc: 0.893 Test Loss: 0.520 Test Acc: 0.893
Validation loss decreased (-0.892587 --> -0.892587).  Saving model ...
Epoch: 63 cost time: 0.9025788307189941
Epoch: 63, Steps: 2 | Train Loss: 0.319 Vali Loss: 0.509 Vali Acc: 0.893 Test Loss: 0.509 Test Acc: 0.893
Validation loss decreased (-0.892587 --> -0.892588).  Saving model ...
Epoch: 64 cost time: 1.2050132751464844
Epoch: 64, Steps: 2 | Train Loss: 0.305 Vali Loss: 0.498 Vali Acc: 0.896 Test Loss: 0.498 Test Acc: 0.896
Validation loss decreased (-0.892588 --> -0.896291).  Saving model ...
Epoch: 65 cost time: 1.1271615028381348
Epoch: 65, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.488 Vali Acc: 0.900 Test Loss: 0.488 Test Acc: 0.900
Validation loss decreased (-0.896291 --> -0.899995).  Saving model ...
Epoch: 66 cost time: 0.9141857624053955
Epoch: 66, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.478 Vali Acc: 0.900 Test Loss: 0.478 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 67 cost time: 0.7903850078582764
Epoch: 67, Steps: 2 | Train Loss: 0.274 Vali Loss: 0.469 Vali Acc: 0.900 Test Loss: 0.469 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 68 cost time: 0.9433701038360596
Epoch: 68, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.460 Vali Acc: 0.900 Test Loss: 0.460 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 69 cost time: 0.8265457153320312
Epoch: 69, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.452 Vali Acc: 0.900 Test Loss: 0.452 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 70 cost time: 0.6845152378082275
Epoch: 70, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.444 Vali Acc: 0.896 Test Loss: 0.444 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.7633483409881592
Epoch: 71, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.437 Vali Acc: 0.896 Test Loss: 0.437 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.8053665161132812
Epoch: 72, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.430 Vali Acc: 0.896 Test Loss: 0.430 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.7835078239440918
Epoch: 73, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.423 Vali Acc: 0.896 Test Loss: 0.423 Test Acc: 0.896
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 1.2989585399627686
Epoch: 74, Steps: 2 | Train Loss: 0.211 Vali Loss: 0.417 Vali Acc: 0.896 Test Loss: 0.417 Test Acc: 0.896
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 0.8350160121917725
Epoch: 75, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.410 Vali Acc: 0.896 Test Loss: 0.410 Test Acc: 0.896
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 0.9124925136566162
Epoch: 76, Steps: 2 | Train Loss: 0.194 Vali Loss: 0.404 Vali Acc: 0.896 Test Loss: 0.404 Test Acc: 0.896
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 0.9486815929412842
Epoch: 77, Steps: 2 | Train Loss: 0.194 Vali Loss: 0.398 Vali Acc: 0.896 Test Loss: 0.398 Test Acc: 0.896
EarlyStopping counter: 8 out of 10
Epoch: 78 cost time: 0.9987993240356445
Epoch: 78, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.393 Vali Acc: 0.896 Test Loss: 0.393 Test Acc: 0.896
EarlyStopping counter: 9 out of 10
Epoch: 79 cost time: 0.8888182640075684
Epoch: 79, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.387 Vali Acc: 0.896 Test Loss: 0.387 Test Acc: 0.896
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_DLinear_UEA_ftM_sl65_ll0_pl0_ma23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9
model parameter : 10146
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         20                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_DLinear_UEA_ftM_sl65_ll0_pl0_ma20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.975611448287964
Epoch: 1, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.790 Vali Acc: 0.167 Test Loss: 1.790 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 0.7944109439849854
Epoch: 2, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.787 Vali Acc: 0.167 Test Loss: 1.787 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 0.7600491046905518
Epoch: 3, Steps: 2 | Train Loss: 1.784 Vali Loss: 1.783 Vali Acc: 0.330 Test Loss: 1.783 Test Acc: 0.330
Validation loss decreased (-0.166649 --> -0.329612).  Saving model ...
Epoch: 4 cost time: 0.8494296073913574
Epoch: 4, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.778 Vali Acc: 0.333 Test Loss: 1.778 Test Acc: 0.333
Validation loss decreased (-0.329612 --> -0.333316).  Saving model ...
Epoch: 5 cost time: 0.8291850090026855
Epoch: 5, Steps: 2 | Train Loss: 1.773 Vali Loss: 1.772 Vali Acc: 0.333 Test Loss: 1.772 Test Acc: 0.333
Validation loss decreased (-0.333316 --> -0.333316).  Saving model ...
Epoch: 6 cost time: 0.6924703121185303
Epoch: 6, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.765 Vali Acc: 0.378 Test Loss: 1.765 Test Acc: 0.378
Validation loss decreased (-0.333316 --> -0.377760).  Saving model ...
Epoch: 7 cost time: 1.0048496723175049
Epoch: 7, Steps: 2 | Train Loss: 1.756 Vali Loss: 1.756 Vali Acc: 0.522 Test Loss: 1.756 Test Acc: 0.522
Validation loss decreased (-0.377760 --> -0.522205).  Saving model ...
Epoch: 8 cost time: 0.9354326725006104
Epoch: 8, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.747 Vali Acc: 0.585 Test Loss: 1.747 Test Acc: 0.585
Validation loss decreased (-0.522205 --> -0.585168).  Saving model ...
Epoch: 9 cost time: 0.9123806953430176
Epoch: 9, Steps: 2 | Train Loss: 1.733 Vali Loss: 1.736 Vali Acc: 0.656 Test Loss: 1.736 Test Acc: 0.656
Validation loss decreased (-0.585168 --> -0.655538).  Saving model ...
Epoch: 10 cost time: 1.1293039321899414
Epoch: 10, Steps: 2 | Train Loss: 1.722 Vali Loss: 1.725 Vali Acc: 0.685 Test Loss: 1.725 Test Acc: 0.685
Validation loss decreased (-0.655538 --> -0.685168).  Saving model ...
Epoch: 11 cost time: 0.8420941829681396
Epoch: 11, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.713 Vali Acc: 0.715 Test Loss: 1.713 Test Acc: 0.715
Validation loss decreased (-0.685168 --> -0.714798).  Saving model ...
Epoch: 12 cost time: 0.8225488662719727
Epoch: 12, Steps: 2 | Train Loss: 1.692 Vali Loss: 1.700 Vali Acc: 0.733 Test Loss: 1.700 Test Acc: 0.733
Validation loss decreased (-0.714798 --> -0.733316).  Saving model ...
Epoch: 13 cost time: 1.0363712310791016
Epoch: 13, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.685 Vali Acc: 0.759 Test Loss: 1.685 Test Acc: 0.759
Validation loss decreased (-0.733316 --> -0.759242).  Saving model ...
Epoch: 14 cost time: 0.8321895599365234
Epoch: 14, Steps: 2 | Train Loss: 1.660 Vali Loss: 1.670 Vali Acc: 0.763 Test Loss: 1.670 Test Acc: 0.763
Validation loss decreased (-0.759242 --> -0.762946).  Saving model ...
Epoch: 15 cost time: 0.7368745803833008
Epoch: 15, Steps: 2 | Train Loss: 1.642 Vali Loss: 1.654 Vali Acc: 0.763 Test Loss: 1.654 Test Acc: 0.763
Validation loss decreased (-0.762946 --> -0.762946).  Saving model ...
Epoch: 16 cost time: 1.0119318962097168
Epoch: 16, Steps: 2 | Train Loss: 1.621 Vali Loss: 1.637 Vali Acc: 0.759 Test Loss: 1.637 Test Acc: 0.759
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9998748302459717
Epoch: 17, Steps: 2 | Train Loss: 1.602 Vali Loss: 1.619 Vali Acc: 0.767 Test Loss: 1.619 Test Acc: 0.767
Validation loss decreased (-0.762946 --> -0.766650).  Saving model ...
Epoch: 18 cost time: 0.8155615329742432
Epoch: 18, Steps: 2 | Train Loss: 1.580 Vali Loss: 1.600 Vali Acc: 0.770 Test Loss: 1.600 Test Acc: 0.770
Validation loss decreased (-0.766650 --> -0.770354).  Saving model ...
Epoch: 19 cost time: 0.9540026187896729
Epoch: 19, Steps: 2 | Train Loss: 1.551 Vali Loss: 1.580 Vali Acc: 0.770 Test Loss: 1.580 Test Acc: 0.770
Validation loss decreased (-0.770354 --> -0.770355).  Saving model ...
Epoch: 20 cost time: 0.800295352935791
Epoch: 20, Steps: 2 | Train Loss: 1.532 Vali Loss: 1.559 Vali Acc: 0.770 Test Loss: 1.559 Test Acc: 0.770
Validation loss decreased (-0.770355 --> -0.770355).  Saving model ...
Epoch: 21 cost time: 0.8376579284667969
Epoch: 21, Steps: 2 | Train Loss: 1.505 Vali Loss: 1.537 Vali Acc: 0.774 Test Loss: 1.537 Test Acc: 0.774
Validation loss decreased (-0.770355 --> -0.774059).  Saving model ...
Epoch: 22 cost time: 0.6905410289764404
Epoch: 22, Steps: 2 | Train Loss: 1.479 Vali Loss: 1.513 Vali Acc: 0.774 Test Loss: 1.513 Test Acc: 0.774
Validation loss decreased (-0.774059 --> -0.774059).  Saving model ...
Epoch: 23 cost time: 0.8154623508453369
Epoch: 23, Steps: 2 | Train Loss: 1.446 Vali Loss: 1.489 Vali Acc: 0.774 Test Loss: 1.489 Test Acc: 0.774
Validation loss decreased (-0.774059 --> -0.774059).  Saving model ...
Epoch: 24 cost time: 0.8505418300628662
Epoch: 24, Steps: 2 | Train Loss: 1.421 Vali Loss: 1.463 Vali Acc: 0.770 Test Loss: 1.463 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7737467288970947
Epoch: 25, Steps: 2 | Train Loss: 1.393 Vali Loss: 1.437 Vali Acc: 0.774 Test Loss: 1.437 Test Acc: 0.774
Validation loss decreased (-0.774059 --> -0.774060).  Saving model ...
Epoch: 26 cost time: 0.7300200462341309
Epoch: 26, Steps: 2 | Train Loss: 1.363 Vali Loss: 1.409 Vali Acc: 0.770 Test Loss: 1.409 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9335496425628662
Epoch: 27, Steps: 2 | Train Loss: 1.327 Vali Loss: 1.380 Vali Acc: 0.778 Test Loss: 1.380 Test Acc: 0.778
Validation loss decreased (-0.774060 --> -0.777764).  Saving model ...
Epoch: 28 cost time: 0.7843141555786133
Epoch: 28, Steps: 2 | Train Loss: 1.299 Vali Loss: 1.350 Vali Acc: 0.774 Test Loss: 1.350 Test Acc: 0.774
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8341410160064697
Epoch: 29, Steps: 2 | Train Loss: 1.268 Vali Loss: 1.320 Vali Acc: 0.778 Test Loss: 1.320 Test Acc: 0.778
Validation loss decreased (-0.777764 --> -0.777765).  Saving model ...
Epoch: 30 cost time: 0.8454437255859375
Epoch: 30, Steps: 2 | Train Loss: 1.229 Vali Loss: 1.289 Vali Acc: 0.781 Test Loss: 1.289 Test Acc: 0.781
Validation loss decreased (-0.777765 --> -0.781469).  Saving model ...
Epoch: 31 cost time: 0.8677499294281006
Epoch: 31, Steps: 2 | Train Loss: 1.193 Vali Loss: 1.258 Vali Acc: 0.785 Test Loss: 1.258 Test Acc: 0.785
Validation loss decreased (-0.781469 --> -0.785173).  Saving model ...
Epoch: 32 cost time: 1.08677077293396
Epoch: 32, Steps: 2 | Train Loss: 1.153 Vali Loss: 1.226 Vali Acc: 0.781 Test Loss: 1.226 Test Acc: 0.781
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6933355331420898
Epoch: 33, Steps: 2 | Train Loss: 1.111 Vali Loss: 1.194 Vali Acc: 0.789 Test Loss: 1.194 Test Acc: 0.789
Validation loss decreased (-0.785173 --> -0.788877).  Saving model ...
Epoch: 34 cost time: 0.7832872867584229
Epoch: 34, Steps: 2 | Train Loss: 1.074 Vali Loss: 1.162 Vali Acc: 0.793 Test Loss: 1.162 Test Acc: 0.793
Validation loss decreased (-0.788877 --> -0.792581).  Saving model ...
Epoch: 35 cost time: 0.6662330627441406
Epoch: 35, Steps: 2 | Train Loss: 1.042 Vali Loss: 1.130 Vali Acc: 0.793 Test Loss: 1.130 Test Acc: 0.793
Validation loss decreased (-0.792581 --> -0.792581).  Saving model ...
Epoch: 36 cost time: 0.9640870094299316
Epoch: 36, Steps: 2 | Train Loss: 1.001 Vali Loss: 1.098 Vali Acc: 0.793 Test Loss: 1.098 Test Acc: 0.793
Validation loss decreased (-0.792581 --> -0.792582).  Saving model ...
Epoch: 37 cost time: 0.7962336540222168
Epoch: 37, Steps: 2 | Train Loss: 0.966 Vali Loss: 1.066 Vali Acc: 0.796 Test Loss: 1.066 Test Acc: 0.796
Validation loss decreased (-0.792582 --> -0.796286).  Saving model ...
Epoch: 38 cost time: 0.7401697635650635
Epoch: 38, Steps: 2 | Train Loss: 0.935 Vali Loss: 1.035 Vali Acc: 0.800 Test Loss: 1.035 Test Acc: 0.800
Validation loss decreased (-0.796286 --> -0.799990).  Saving model ...
Epoch: 39 cost time: 0.8289554119110107
Epoch: 39, Steps: 2 | Train Loss: 0.897 Vali Loss: 1.004 Vali Acc: 0.800 Test Loss: 1.004 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799990).  Saving model ...
Epoch: 40 cost time: 0.6901755332946777
Epoch: 40, Steps: 2 | Train Loss: 0.864 Vali Loss: 0.974 Vali Acc: 0.804 Test Loss: 0.974 Test Acc: 0.804
Validation loss decreased (-0.799990 --> -0.803694).  Saving model ...
Epoch: 41 cost time: 0.8546977043151855
Epoch: 41, Steps: 2 | Train Loss: 0.825 Vali Loss: 0.945 Vali Acc: 0.804 Test Loss: 0.945 Test Acc: 0.804
Validation loss decreased (-0.803694 --> -0.803694).  Saving model ...
Epoch: 42 cost time: 0.755467414855957
Epoch: 42, Steps: 2 | Train Loss: 0.787 Vali Loss: 0.916 Vali Acc: 0.811 Test Loss: 0.916 Test Acc: 0.811
Validation loss decreased (-0.803694 --> -0.811102).  Saving model ...
Epoch: 43 cost time: 0.9002909660339355
Epoch: 43, Steps: 2 | Train Loss: 0.753 Vali Loss: 0.888 Vali Acc: 0.822 Test Loss: 0.888 Test Acc: 0.822
Validation loss decreased (-0.811102 --> -0.822213).  Saving model ...
Epoch: 44 cost time: 0.6755595207214355
Epoch: 44, Steps: 2 | Train Loss: 0.731 Vali Loss: 0.861 Vali Acc: 0.826 Test Loss: 0.861 Test Acc: 0.826
Validation loss decreased (-0.822213 --> -0.825917).  Saving model ...
Epoch: 45 cost time: 0.8038623332977295
Epoch: 45, Steps: 2 | Train Loss: 0.697 Vali Loss: 0.835 Vali Acc: 0.826 Test Loss: 0.835 Test Acc: 0.826
Validation loss decreased (-0.825917 --> -0.825918).  Saving model ...
Epoch: 46 cost time: 0.8072898387908936
Epoch: 46, Steps: 2 | Train Loss: 0.668 Vali Loss: 0.809 Vali Acc: 0.830 Test Loss: 0.809 Test Acc: 0.830
Validation loss decreased (-0.825918 --> -0.829622).  Saving model ...
Epoch: 47 cost time: 0.8337068557739258
Epoch: 47, Steps: 2 | Train Loss: 0.638 Vali Loss: 0.785 Vali Acc: 0.826 Test Loss: 0.785 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.9093809127807617
Epoch: 48, Steps: 2 | Train Loss: 0.609 Vali Loss: 0.762 Vali Acc: 0.833 Test Loss: 0.762 Test Acc: 0.833
Validation loss decreased (-0.829622 --> -0.833326).  Saving model ...
Epoch: 49 cost time: 0.9630739688873291
Epoch: 49, Steps: 2 | Train Loss: 0.583 Vali Loss: 0.739 Vali Acc: 0.837 Test Loss: 0.739 Test Acc: 0.837
Validation loss decreased (-0.833326 --> -0.837030).  Saving model ...
Epoch: 50 cost time: 1.0062196254730225
Epoch: 50, Steps: 2 | Train Loss: 0.562 Vali Loss: 0.718 Vali Acc: 0.844 Test Loss: 0.718 Test Acc: 0.844
Validation loss decreased (-0.837030 --> -0.844437).  Saving model ...
Epoch: 51 cost time: 0.849886417388916
Epoch: 51, Steps: 2 | Train Loss: 0.527 Vali Loss: 0.697 Vali Acc: 0.852 Test Loss: 0.697 Test Acc: 0.852
Validation loss decreased (-0.844437 --> -0.851845).  Saving model ...
Epoch: 52 cost time: 0.8536016941070557
Epoch: 52, Steps: 2 | Train Loss: 0.513 Vali Loss: 0.678 Vali Acc: 0.859 Test Loss: 0.678 Test Acc: 0.859
Validation loss decreased (-0.851845 --> -0.859252).  Saving model ...
Epoch: 53 cost time: 0.6923022270202637
Epoch: 53, Steps: 2 | Train Loss: 0.487 Vali Loss: 0.659 Vali Acc: 0.867 Test Loss: 0.659 Test Acc: 0.867
Validation loss decreased (-0.859252 --> -0.866660).  Saving model ...
Epoch: 54 cost time: 0.6616718769073486
Epoch: 54, Steps: 2 | Train Loss: 0.464 Vali Loss: 0.641 Vali Acc: 0.878 Test Loss: 0.641 Test Acc: 0.878
Validation loss decreased (-0.866660 --> -0.877771).  Saving model ...
Epoch: 55 cost time: 0.7749464511871338
Epoch: 55, Steps: 2 | Train Loss: 0.449 Vali Loss: 0.624 Vali Acc: 0.878 Test Loss: 0.624 Test Acc: 0.878
Validation loss decreased (-0.877771 --> -0.877772).  Saving model ...
Epoch: 56 cost time: 0.752894401550293
Epoch: 56, Steps: 2 | Train Loss: 0.423 Vali Loss: 0.608 Vali Acc: 0.878 Test Loss: 0.608 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 57 cost time: 0.8129591941833496
Epoch: 57, Steps: 2 | Train Loss: 0.411 Vali Loss: 0.592 Vali Acc: 0.878 Test Loss: 0.592 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 58 cost time: 0.703575611114502
Epoch: 58, Steps: 2 | Train Loss: 0.393 Vali Loss: 0.578 Vali Acc: 0.878 Test Loss: 0.578 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 59 cost time: 0.9210519790649414
Epoch: 59, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.565 Vali Acc: 0.878 Test Loss: 0.565 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 60 cost time: 0.736807107925415
Epoch: 60, Steps: 2 | Train Loss: 0.363 Vali Loss: 0.551 Vali Acc: 0.881 Test Loss: 0.551 Test Acc: 0.881
Validation loss decreased (-0.877772 --> -0.881476).  Saving model ...
Epoch: 61 cost time: 1.0133776664733887
Epoch: 61, Steps: 2 | Train Loss: 0.345 Vali Loss: 0.539 Vali Acc: 0.885 Test Loss: 0.539 Test Acc: 0.885
Validation loss decreased (-0.881476 --> -0.885180).  Saving model ...
Epoch: 62 cost time: 0.8688316345214844
Epoch: 62, Steps: 2 | Train Loss: 0.338 Vali Loss: 0.528 Vali Acc: 0.889 Test Loss: 0.528 Test Acc: 0.889
Validation loss decreased (-0.885180 --> -0.888884).  Saving model ...
Epoch: 63 cost time: 0.9223711490631104
Epoch: 63, Steps: 2 | Train Loss: 0.319 Vali Loss: 0.516 Vali Acc: 0.889 Test Loss: 0.516 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 64 cost time: 0.7886989116668701
Epoch: 64, Steps: 2 | Train Loss: 0.305 Vali Loss: 0.506 Vali Acc: 0.893 Test Loss: 0.506 Test Acc: 0.893
Validation loss decreased (-0.888884 --> -0.892588).  Saving model ...
Epoch: 65 cost time: 0.7299134731292725
Epoch: 65, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.496 Vali Acc: 0.893 Test Loss: 0.496 Test Acc: 0.893
Validation loss decreased (-0.892588 --> -0.892588).  Saving model ...
Epoch: 66 cost time: 0.6781413555145264
Epoch: 66, Steps: 2 | Train Loss: 0.288 Vali Loss: 0.486 Vali Acc: 0.896 Test Loss: 0.486 Test Acc: 0.896
Validation loss decreased (-0.892588 --> -0.896291).  Saving model ...
Epoch: 67 cost time: 0.9386506080627441
Epoch: 67, Steps: 2 | Train Loss: 0.275 Vali Loss: 0.478 Vali Acc: 0.896 Test Loss: 0.478 Test Acc: 0.896
Validation loss decreased (-0.896291 --> -0.896292).  Saving model ...
Epoch: 68 cost time: 0.8002481460571289
Epoch: 68, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.469 Vali Acc: 0.896 Test Loss: 0.469 Test Acc: 0.896
Validation loss decreased (-0.896292 --> -0.896292).  Saving model ...
Epoch: 69 cost time: 0.9484732151031494
Epoch: 69, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.461 Vali Acc: 0.896 Test Loss: 0.461 Test Acc: 0.896
Validation loss decreased (-0.896292 --> -0.896292).  Saving model ...
Epoch: 70 cost time: 0.8820374011993408
Epoch: 70, Steps: 2 | Train Loss: 0.251 Vali Loss: 0.453 Vali Acc: 0.896 Test Loss: 0.453 Test Acc: 0.896
Validation loss decreased (-0.896292 --> -0.896292).  Saving model ...
Epoch: 71 cost time: 0.7872509956359863
Epoch: 71, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.446 Vali Acc: 0.896 Test Loss: 0.446 Test Acc: 0.896
Validation loss decreased (-0.896292 --> -0.896292).  Saving model ...
Epoch: 72 cost time: 0.9758577346801758
Epoch: 72, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.439 Vali Acc: 0.896 Test Loss: 0.439 Test Acc: 0.896
Validation loss decreased (-0.896292 --> -0.896292).  Saving model ...
Epoch: 73 cost time: 1.2621674537658691
Epoch: 73, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.432 Vali Acc: 0.896 Test Loss: 0.432 Test Acc: 0.896
Validation loss decreased (-0.896292 --> -0.896292).  Saving model ...
Epoch: 74 cost time: 0.6880185604095459
Epoch: 74, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.426 Vali Acc: 0.896 Test Loss: 0.426 Test Acc: 0.896
Validation loss decreased (-0.896292 --> -0.896292).  Saving model ...
Epoch: 75 cost time: 0.6449167728424072
Epoch: 75, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.420 Vali Acc: 0.896 Test Loss: 0.420 Test Acc: 0.896
Validation loss decreased (-0.896292 --> -0.896292).  Saving model ...
Epoch: 76 cost time: 0.6718263626098633
Epoch: 76, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.414 Vali Acc: 0.893 Test Loss: 0.414 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.8635189533233643
Epoch: 77, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.408 Vali Acc: 0.893 Test Loss: 0.408 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 1.1494801044464111
Epoch: 78, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.403 Vali Acc: 0.893 Test Loss: 0.403 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 0.85418701171875
Epoch: 79, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.397 Vali Acc: 0.893 Test Loss: 0.397 Test Acc: 0.893
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 0.8610048294067383
Epoch: 80, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.392 Vali Acc: 0.893 Test Loss: 0.392 Test Acc: 0.893
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 1.0168919563293457
Epoch: 81, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.388 Vali Acc: 0.889 Test Loss: 0.388 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 0.7431344985961914
Epoch: 82, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.383 Vali Acc: 0.889 Test Loss: 0.383 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 0.8662121295928955
Epoch: 83, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.379 Vali Acc: 0.889 Test Loss: 0.379 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 0.7401199340820312
Epoch: 84, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.375 Vali Acc: 0.889 Test Loss: 0.375 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 85 cost time: 0.8187627792358398
Epoch: 85, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.370 Vali Acc: 0.889 Test Loss: 0.370 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_DLinear_UEA_ftM_sl65_ll0_pl0_ma20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8962962962962963
model parameter : 10146
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         17                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_DLinear_UEA_ftM_sl65_ll0_pl0_ma17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2694766521453857
Epoch: 1, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.790 Vali Acc: 0.167 Test Loss: 1.790 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 0.709845781326294
Epoch: 2, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.786 Vali Acc: 0.167 Test Loss: 1.786 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 0.7147572040557861
Epoch: 3, Steps: 2 | Train Loss: 1.783 Vali Loss: 1.783 Vali Acc: 0.333 Test Loss: 1.783 Test Acc: 0.333
Validation loss decreased (-0.166649 --> -0.333316).  Saving model ...
Epoch: 4 cost time: 0.8086209297180176
Epoch: 4, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.778 Vali Acc: 0.333 Test Loss: 1.778 Test Acc: 0.333
Validation loss decreased (-0.333316 --> -0.333316).  Saving model ...
Epoch: 5 cost time: 0.8051178455352783
Epoch: 5, Steps: 2 | Train Loss: 1.773 Vali Loss: 1.772 Vali Acc: 0.333 Test Loss: 1.772 Test Acc: 0.333
Validation loss decreased (-0.333316 --> -0.333316).  Saving model ...
Epoch: 6 cost time: 0.8241016864776611
Epoch: 6, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.765 Vali Acc: 0.370 Test Loss: 1.765 Test Acc: 0.370
Validation loss decreased (-0.333316 --> -0.370353).  Saving model ...
Epoch: 7 cost time: 0.6292531490325928
Epoch: 7, Steps: 2 | Train Loss: 1.756 Vali Loss: 1.756 Vali Acc: 0.522 Test Loss: 1.756 Test Acc: 0.522
Validation loss decreased (-0.370353 --> -0.522205).  Saving model ...
Epoch: 8 cost time: 0.8678512573242188
Epoch: 8, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.747 Vali Acc: 0.589 Test Loss: 1.747 Test Acc: 0.589
Validation loss decreased (-0.522205 --> -0.588871).  Saving model ...
Epoch: 9 cost time: 1.3976049423217773
Epoch: 9, Steps: 2 | Train Loss: 1.733 Vali Loss: 1.737 Vali Acc: 0.652 Test Loss: 1.737 Test Acc: 0.652
Validation loss decreased (-0.588871 --> -0.651834).  Saving model ...
Epoch: 10 cost time: 0.8868467807769775
Epoch: 10, Steps: 2 | Train Loss: 1.722 Vali Loss: 1.726 Vali Acc: 0.681 Test Loss: 1.726 Test Acc: 0.681
Validation loss decreased (-0.651834 --> -0.681464).  Saving model ...
Epoch: 11 cost time: 0.8237528800964355
Epoch: 11, Steps: 2 | Train Loss: 1.706 Vali Loss: 1.714 Vali Acc: 0.711 Test Loss: 1.714 Test Acc: 0.711
Validation loss decreased (-0.681464 --> -0.711094).  Saving model ...
Epoch: 12 cost time: 0.789292573928833
Epoch: 12, Steps: 2 | Train Loss: 1.693 Vali Loss: 1.701 Vali Acc: 0.737 Test Loss: 1.701 Test Acc: 0.737
Validation loss decreased (-0.711094 --> -0.737020).  Saving model ...
Epoch: 13 cost time: 0.8076810836791992
Epoch: 13, Steps: 2 | Train Loss: 1.679 Vali Loss: 1.687 Vali Acc: 0.752 Test Loss: 1.687 Test Acc: 0.752
Validation loss decreased (-0.737020 --> -0.751835).  Saving model ...
Epoch: 14 cost time: 0.7696316242218018
Epoch: 14, Steps: 2 | Train Loss: 1.661 Vali Loss: 1.672 Vali Acc: 0.756 Test Loss: 1.672 Test Acc: 0.756
Validation loss decreased (-0.751835 --> -0.755539).  Saving model ...
Epoch: 15 cost time: 0.7750339508056641
Epoch: 15, Steps: 2 | Train Loss: 1.644 Vali Loss: 1.656 Vali Acc: 0.763 Test Loss: 1.656 Test Acc: 0.763
Validation loss decreased (-0.755539 --> -0.762946).  Saving model ...
Epoch: 16 cost time: 0.8105411529541016
Epoch: 16, Steps: 2 | Train Loss: 1.623 Vali Loss: 1.639 Vali Acc: 0.770 Test Loss: 1.639 Test Acc: 0.770
Validation loss decreased (-0.762946 --> -0.770354).  Saving model ...
Epoch: 17 cost time: 0.8966367244720459
Epoch: 17, Steps: 2 | Train Loss: 1.604 Vali Loss: 1.622 Vali Acc: 0.770 Test Loss: 1.622 Test Acc: 0.770
Validation loss decreased (-0.770354 --> -0.770354).  Saving model ...
Epoch: 18 cost time: 0.8859603404998779
Epoch: 18, Steps: 2 | Train Loss: 1.583 Vali Loss: 1.603 Vali Acc: 0.770 Test Loss: 1.603 Test Acc: 0.770
Validation loss decreased (-0.770354 --> -0.770354).  Saving model ...
Epoch: 19 cost time: 1.0175912380218506
Epoch: 19, Steps: 2 | Train Loss: 1.555 Vali Loss: 1.583 Vali Acc: 0.774 Test Loss: 1.583 Test Acc: 0.774
Validation loss decreased (-0.770354 --> -0.774058).  Saving model ...
Epoch: 20 cost time: 0.8622736930847168
Epoch: 20, Steps: 2 | Train Loss: 1.536 Vali Loss: 1.563 Vali Acc: 0.774 Test Loss: 1.563 Test Acc: 0.774
Validation loss decreased (-0.774058 --> -0.774058).  Saving model ...
Epoch: 21 cost time: 0.7503831386566162
Epoch: 21, Steps: 2 | Train Loss: 1.509 Vali Loss: 1.541 Vali Acc: 0.774 Test Loss: 1.541 Test Acc: 0.774
Validation loss decreased (-0.774058 --> -0.774059).  Saving model ...
Epoch: 22 cost time: 0.7493467330932617
Epoch: 22, Steps: 2 | Train Loss: 1.484 Vali Loss: 1.518 Vali Acc: 0.774 Test Loss: 1.518 Test Acc: 0.774
Validation loss decreased (-0.774059 --> -0.774059).  Saving model ...
Epoch: 23 cost time: 0.9546027183532715
Epoch: 23, Steps: 2 | Train Loss: 1.451 Vali Loss: 1.494 Vali Acc: 0.774 Test Loss: 1.494 Test Acc: 0.774
Validation loss decreased (-0.774059 --> -0.774059).  Saving model ...
Epoch: 24 cost time: 0.8925769329071045
Epoch: 24, Steps: 2 | Train Loss: 1.426 Vali Loss: 1.468 Vali Acc: 0.774 Test Loss: 1.468 Test Acc: 0.774
Validation loss decreased (-0.774059 --> -0.774059).  Saving model ...
Epoch: 25 cost time: 0.8895618915557861
Epoch: 25, Steps: 2 | Train Loss: 1.398 Vali Loss: 1.442 Vali Acc: 0.774 Test Loss: 1.442 Test Acc: 0.774
Validation loss decreased (-0.774059 --> -0.774060).  Saving model ...
Epoch: 26 cost time: 0.9428658485412598
Epoch: 26, Steps: 2 | Train Loss: 1.369 Vali Loss: 1.414 Vali Acc: 0.778 Test Loss: 1.414 Test Acc: 0.778
Validation loss decreased (-0.774060 --> -0.777764).  Saving model ...
Epoch: 27 cost time: 0.9440686702728271
Epoch: 27, Steps: 2 | Train Loss: 1.334 Vali Loss: 1.386 Vali Acc: 0.781 Test Loss: 1.386 Test Acc: 0.781
Validation loss decreased (-0.777764 --> -0.781468).  Saving model ...
Epoch: 28 cost time: 0.7448654174804688
Epoch: 28, Steps: 2 | Train Loss: 1.306 Vali Loss: 1.357 Vali Acc: 0.778 Test Loss: 1.357 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7069554328918457
Epoch: 29, Steps: 2 | Train Loss: 1.275 Vali Loss: 1.327 Vali Acc: 0.778 Test Loss: 1.327 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8817124366760254
Epoch: 30, Steps: 2 | Train Loss: 1.236 Vali Loss: 1.296 Vali Acc: 0.778 Test Loss: 1.296 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7505292892456055
Epoch: 31, Steps: 2 | Train Loss: 1.201 Vali Loss: 1.265 Vali Acc: 0.781 Test Loss: 1.265 Test Acc: 0.781
Validation loss decreased (-0.781468 --> -0.781469).  Saving model ...
Epoch: 32 cost time: 0.7659099102020264
Epoch: 32, Steps: 2 | Train Loss: 1.161 Vali Loss: 1.234 Vali Acc: 0.781 Test Loss: 1.234 Test Acc: 0.781
Validation loss decreased (-0.781469 --> -0.781469).  Saving model ...
Epoch: 33 cost time: 0.6963968276977539
Epoch: 33, Steps: 2 | Train Loss: 1.120 Vali Loss: 1.202 Vali Acc: 0.785 Test Loss: 1.202 Test Acc: 0.785
Validation loss decreased (-0.781469 --> -0.785173).  Saving model ...
Epoch: 34 cost time: 0.980147123336792
Epoch: 34, Steps: 2 | Train Loss: 1.083 Vali Loss: 1.170 Vali Acc: 0.789 Test Loss: 1.170 Test Acc: 0.789
Validation loss decreased (-0.785173 --> -0.788877).  Saving model ...
Epoch: 35 cost time: 1.0438828468322754
Epoch: 35, Steps: 2 | Train Loss: 1.051 Vali Loss: 1.138 Vali Acc: 0.793 Test Loss: 1.138 Test Acc: 0.793
Validation loss decreased (-0.788877 --> -0.792581).  Saving model ...
Epoch: 36 cost time: 0.7897953987121582
Epoch: 36, Steps: 2 | Train Loss: 1.010 Vali Loss: 1.107 Vali Acc: 0.800 Test Loss: 1.107 Test Acc: 0.800
Validation loss decreased (-0.792581 --> -0.799989).  Saving model ...
Epoch: 37 cost time: 1.2051467895507812
Epoch: 37, Steps: 2 | Train Loss: 0.975 Vali Loss: 1.075 Vali Acc: 0.800 Test Loss: 1.075 Test Acc: 0.800
Validation loss decreased (-0.799989 --> -0.799989).  Saving model ...
Epoch: 38 cost time: 0.8339614868164062
Epoch: 38, Steps: 2 | Train Loss: 0.944 Vali Loss: 1.044 Vali Acc: 0.800 Test Loss: 1.044 Test Acc: 0.800
Validation loss decreased (-0.799989 --> -0.799990).  Saving model ...
Epoch: 39 cost time: 0.7245588302612305
Epoch: 39, Steps: 2 | Train Loss: 0.906 Vali Loss: 1.013 Vali Acc: 0.804 Test Loss: 1.013 Test Acc: 0.804
Validation loss decreased (-0.799990 --> -0.803694).  Saving model ...
Epoch: 40 cost time: 1.0602169036865234
Epoch: 40, Steps: 2 | Train Loss: 0.874 Vali Loss: 0.983 Vali Acc: 0.804 Test Loss: 0.983 Test Acc: 0.804
Validation loss decreased (-0.803694 --> -0.803694).  Saving model ...
Epoch: 41 cost time: 0.9801681041717529
Epoch: 41, Steps: 2 | Train Loss: 0.834 Vali Loss: 0.954 Vali Acc: 0.804 Test Loss: 0.954 Test Acc: 0.804
Validation loss decreased (-0.803694 --> -0.803694).  Saving model ...
Epoch: 42 cost time: 0.7933931350708008
Epoch: 42, Steps: 2 | Train Loss: 0.796 Vali Loss: 0.925 Vali Acc: 0.804 Test Loss: 0.925 Test Acc: 0.804
Validation loss decreased (-0.803694 --> -0.803694).  Saving model ...
Epoch: 43 cost time: 1.0216493606567383
Epoch: 43, Steps: 2 | Train Loss: 0.762 Vali Loss: 0.897 Vali Acc: 0.807 Test Loss: 0.897 Test Acc: 0.807
Validation loss decreased (-0.803694 --> -0.807398).  Saving model ...
Epoch: 44 cost time: 0.9849185943603516
Epoch: 44, Steps: 2 | Train Loss: 0.740 Vali Loss: 0.870 Vali Acc: 0.804 Test Loss: 0.870 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8602128028869629
Epoch: 45, Steps: 2 | Train Loss: 0.706 Vali Loss: 0.844 Vali Acc: 0.811 Test Loss: 0.844 Test Acc: 0.811
Validation loss decreased (-0.807398 --> -0.811103).  Saving model ...
Epoch: 46 cost time: 0.9818246364593506
Epoch: 46, Steps: 2 | Train Loss: 0.677 Vali Loss: 0.818 Vali Acc: 0.815 Test Loss: 0.818 Test Acc: 0.815
Validation loss decreased (-0.811103 --> -0.814807).  Saving model ...
Epoch: 47 cost time: 1.0243170261383057
Epoch: 47, Steps: 2 | Train Loss: 0.646 Vali Loss: 0.794 Vali Acc: 0.822 Test Loss: 0.794 Test Acc: 0.822
Validation loss decreased (-0.814807 --> -0.822214).  Saving model ...
Epoch: 48 cost time: 1.1444687843322754
Epoch: 48, Steps: 2 | Train Loss: 0.617 Vali Loss: 0.771 Vali Acc: 0.826 Test Loss: 0.771 Test Acc: 0.826
Validation loss decreased (-0.822214 --> -0.825918).  Saving model ...
Epoch: 49 cost time: 1.2115118503570557
Epoch: 49, Steps: 2 | Train Loss: 0.592 Vali Loss: 0.748 Vali Acc: 0.826 Test Loss: 0.748 Test Acc: 0.826
Validation loss decreased (-0.825918 --> -0.825918).  Saving model ...
Epoch: 50 cost time: 0.9355807304382324
Epoch: 50, Steps: 2 | Train Loss: 0.570 Vali Loss: 0.727 Vali Acc: 0.830 Test Loss: 0.727 Test Acc: 0.830
Validation loss decreased (-0.825918 --> -0.829622).  Saving model ...
Epoch: 51 cost time: 1.0241751670837402
Epoch: 51, Steps: 2 | Train Loss: 0.535 Vali Loss: 0.706 Vali Acc: 0.841 Test Loss: 0.706 Test Acc: 0.841
Validation loss decreased (-0.829622 --> -0.840734).  Saving model ...
Epoch: 52 cost time: 1.0913231372833252
Epoch: 52, Steps: 2 | Train Loss: 0.521 Vali Loss: 0.686 Vali Acc: 0.844 Test Loss: 0.686 Test Acc: 0.844
Validation loss decreased (-0.840734 --> -0.844438).  Saving model ...
Epoch: 53 cost time: 1.5316417217254639
Epoch: 53, Steps: 2 | Train Loss: 0.495 Vali Loss: 0.668 Vali Acc: 0.852 Test Loss: 0.668 Test Acc: 0.852
Validation loss decreased (-0.844438 --> -0.851845).  Saving model ...
Epoch: 54 cost time: 0.9866695404052734
Epoch: 54, Steps: 2 | Train Loss: 0.471 Vali Loss: 0.650 Vali Acc: 0.863 Test Loss: 0.650 Test Acc: 0.863
Validation loss decreased (-0.851845 --> -0.862956).  Saving model ...
Epoch: 55 cost time: 0.8210725784301758
Epoch: 55, Steps: 2 | Train Loss: 0.456 Vali Loss: 0.633 Vali Acc: 0.867 Test Loss: 0.633 Test Acc: 0.867
Validation loss decreased (-0.862956 --> -0.866660).  Saving model ...
Epoch: 56 cost time: 1.143908977508545
Epoch: 56, Steps: 2 | Train Loss: 0.431 Vali Loss: 0.617 Vali Acc: 0.867 Test Loss: 0.617 Test Acc: 0.867
Validation loss decreased (-0.866660 --> -0.866661).  Saving model ...
Epoch: 57 cost time: 1.1136131286621094
Epoch: 57, Steps: 2 | Train Loss: 0.418 Vali Loss: 0.601 Vali Acc: 0.874 Test Loss: 0.601 Test Acc: 0.874
Validation loss decreased (-0.866661 --> -0.874068).  Saving model ...
Epoch: 58 cost time: 1.0445680618286133
Epoch: 58, Steps: 2 | Train Loss: 0.400 Vali Loss: 0.587 Vali Acc: 0.878 Test Loss: 0.587 Test Acc: 0.878
Validation loss decreased (-0.874068 --> -0.877772).  Saving model ...
Epoch: 59 cost time: 0.775794506072998
Epoch: 59, Steps: 2 | Train Loss: 0.388 Vali Loss: 0.573 Vali Acc: 0.878 Test Loss: 0.573 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 60 cost time: 0.880972146987915
Epoch: 60, Steps: 2 | Train Loss: 0.369 Vali Loss: 0.560 Vali Acc: 0.881 Test Loss: 0.560 Test Acc: 0.881
Validation loss decreased (-0.877772 --> -0.881476).  Saving model ...
Epoch: 61 cost time: 0.8585515022277832
Epoch: 61, Steps: 2 | Train Loss: 0.352 Vali Loss: 0.548 Vali Acc: 0.881 Test Loss: 0.548 Test Acc: 0.881
Validation loss decreased (-0.881476 --> -0.881476).  Saving model ...
Epoch: 62 cost time: 0.9563751220703125
Epoch: 62, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.536 Vali Acc: 0.881 Test Loss: 0.536 Test Acc: 0.881
Validation loss decreased (-0.881476 --> -0.881476).  Saving model ...
Epoch: 63 cost time: 1.2049987316131592
Epoch: 63, Steps: 2 | Train Loss: 0.325 Vali Loss: 0.525 Vali Acc: 0.881 Test Loss: 0.525 Test Acc: 0.881
Validation loss decreased (-0.881476 --> -0.881476).  Saving model ...
Epoch: 64 cost time: 0.9191317558288574
Epoch: 64, Steps: 2 | Train Loss: 0.312 Vali Loss: 0.515 Vali Acc: 0.889 Test Loss: 0.515 Test Acc: 0.889
Validation loss decreased (-0.881476 --> -0.888884).  Saving model ...
Epoch: 65 cost time: 1.0413799285888672
Epoch: 65, Steps: 2 | Train Loss: 0.303 Vali Loss: 0.505 Vali Acc: 0.893 Test Loss: 0.505 Test Acc: 0.893
Validation loss decreased (-0.888884 --> -0.892588).  Saving model ...
Epoch: 66 cost time: 0.8967056274414062
Epoch: 66, Steps: 2 | Train Loss: 0.294 Vali Loss: 0.495 Vali Acc: 0.893 Test Loss: 0.495 Test Acc: 0.893
Validation loss decreased (-0.892588 --> -0.892588).  Saving model ...
Epoch: 67 cost time: 1.3633556365966797
Epoch: 67, Steps: 2 | Train Loss: 0.281 Vali Loss: 0.486 Vali Acc: 0.893 Test Loss: 0.486 Test Acc: 0.893
Validation loss decreased (-0.892588 --> -0.892588).  Saving model ...
Epoch: 68 cost time: 1.0691227912902832
Epoch: 68, Steps: 2 | Train Loss: 0.270 Vali Loss: 0.478 Vali Acc: 0.893 Test Loss: 0.478 Test Acc: 0.893
Validation loss decreased (-0.892588 --> -0.892588).  Saving model ...
Epoch: 69 cost time: 0.9274482727050781
Epoch: 69, Steps: 2 | Train Loss: 0.263 Vali Loss: 0.470 Vali Acc: 0.893 Test Loss: 0.470 Test Acc: 0.893
Validation loss decreased (-0.892588 --> -0.892588).  Saving model ...
Epoch: 70 cost time: 0.6469056606292725
Epoch: 70, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.462 Vali Acc: 0.893 Test Loss: 0.462 Test Acc: 0.893
Validation loss decreased (-0.892588 --> -0.892588).  Saving model ...
Epoch: 71 cost time: 1.0866029262542725
Epoch: 71, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.455 Vali Acc: 0.893 Test Loss: 0.455 Test Acc: 0.893
Validation loss decreased (-0.892588 --> -0.892588).  Saving model ...
Epoch: 72 cost time: 0.7943863868713379
Epoch: 72, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.448 Vali Acc: 0.893 Test Loss: 0.448 Test Acc: 0.893
Validation loss decreased (-0.892588 --> -0.892588).  Saving model ...
Epoch: 73 cost time: 0.8597910404205322
Epoch: 73, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.441 Vali Acc: 0.893 Test Loss: 0.441 Test Acc: 0.893
Validation loss decreased (-0.892588 --> -0.892588).  Saving model ...
Epoch: 74 cost time: 0.7523472309112549
Epoch: 74, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.435 Vali Acc: 0.893 Test Loss: 0.435 Test Acc: 0.893
Validation loss decreased (-0.892588 --> -0.892588).  Saving model ...
Epoch: 75 cost time: 0.6571660041809082
Epoch: 75, Steps: 2 | Train Loss: 0.210 Vali Loss: 0.429 Vali Acc: 0.893 Test Loss: 0.429 Test Acc: 0.893
Validation loss decreased (-0.892588 --> -0.892588).  Saving model ...
Epoch: 76 cost time: 0.8139019012451172
Epoch: 76, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.423 Vali Acc: 0.893 Test Loss: 0.423 Test Acc: 0.893
Validation loss decreased (-0.892588 --> -0.892588).  Saving model ...
Epoch: 77 cost time: 0.8483593463897705
Epoch: 77, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.417 Vali Acc: 0.889 Test Loss: 0.417 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.8860311508178711
Epoch: 78, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.412 Vali Acc: 0.889 Test Loss: 0.412 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 0.8112540245056152
Epoch: 79, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.406 Vali Acc: 0.889 Test Loss: 0.406 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 1.1166329383850098
Epoch: 80, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.401 Vali Acc: 0.889 Test Loss: 0.401 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 1.0468521118164062
Epoch: 81, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.397 Vali Acc: 0.889 Test Loss: 0.397 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 0.7827596664428711
Epoch: 82, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.392 Vali Acc: 0.889 Test Loss: 0.392 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 83 cost time: 1.4243011474609375
Epoch: 83, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.388 Vali Acc: 0.889 Test Loss: 0.388 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 84 cost time: 1.1883440017700195
Epoch: 84, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.384 Vali Acc: 0.889 Test Loss: 0.384 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 85 cost time: 0.8108527660369873
Epoch: 85, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.379 Vali Acc: 0.889 Test Loss: 0.379 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 86 cost time: 0.8299028873443604
Epoch: 86, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.375 Vali Acc: 0.889 Test Loss: 0.375 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_DLinear_UEA_ftM_sl65_ll0_pl0_ma17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8925925925925926
model parameter : 10146
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         13                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_DLinear_UEA_ftM_sl65_ll0_pl0_ma13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.5026144981384277
Epoch: 1, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.790 Vali Acc: 0.167 Test Loss: 1.790 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 0.914578914642334
Epoch: 2, Steps: 2 | Train Loss: 1.787 Vali Loss: 1.786 Vali Acc: 0.167 Test Loss: 1.786 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 0.9494643211364746
Epoch: 3, Steps: 2 | Train Loss: 1.783 Vali Loss: 1.782 Vali Acc: 0.333 Test Loss: 1.782 Test Acc: 0.333
Validation loss decreased (-0.166649 --> -0.333316).  Saving model ...
Epoch: 4 cost time: 0.9867770671844482
Epoch: 4, Steps: 2 | Train Loss: 1.780 Vali Loss: 1.778 Vali Acc: 0.333 Test Loss: 1.778 Test Acc: 0.333
Validation loss decreased (-0.333316 --> -0.333316).  Saving model ...
Epoch: 5 cost time: 1.084317684173584
Epoch: 5, Steps: 2 | Train Loss: 1.772 Vali Loss: 1.772 Vali Acc: 0.333 Test Loss: 1.772 Test Acc: 0.333
Validation loss decreased (-0.333316 --> -0.333316).  Saving model ...
Epoch: 6 cost time: 0.9813997745513916
Epoch: 6, Steps: 2 | Train Loss: 1.765 Vali Loss: 1.765 Vali Acc: 0.381 Test Loss: 1.765 Test Acc: 0.381
Validation loss decreased (-0.333316 --> -0.381464).  Saving model ...
Epoch: 7 cost time: 0.9816079139709473
Epoch: 7, Steps: 2 | Train Loss: 1.756 Vali Loss: 1.756 Vali Acc: 0.530 Test Loss: 1.756 Test Acc: 0.530
Validation loss decreased (-0.381464 --> -0.529612).  Saving model ...
Epoch: 8 cost time: 1.026879072189331
Epoch: 8, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.747 Vali Acc: 0.593 Test Loss: 1.747 Test Acc: 0.593
Validation loss decreased (-0.529612 --> -0.592575).  Saving model ...
Epoch: 9 cost time: 1.0508546829223633
Epoch: 9, Steps: 2 | Train Loss: 1.734 Vali Loss: 1.737 Vali Acc: 0.652 Test Loss: 1.737 Test Acc: 0.652
Validation loss decreased (-0.592575 --> -0.651834).  Saving model ...
Epoch: 10 cost time: 0.9322900772094727
Epoch: 10, Steps: 2 | Train Loss: 1.723 Vali Loss: 1.726 Vali Acc: 0.674 Test Loss: 1.726 Test Acc: 0.674
Validation loss decreased (-0.651834 --> -0.674057).  Saving model ...
Epoch: 11 cost time: 0.855696439743042
Epoch: 11, Steps: 2 | Train Loss: 1.707 Vali Loss: 1.714 Vali Acc: 0.704 Test Loss: 1.714 Test Acc: 0.704
Validation loss decreased (-0.674057 --> -0.703687).  Saving model ...
Epoch: 12 cost time: 0.8545703887939453
Epoch: 12, Steps: 2 | Train Loss: 1.694 Vali Loss: 1.702 Vali Acc: 0.726 Test Loss: 1.702 Test Acc: 0.726
Validation loss decreased (-0.703687 --> -0.725909).  Saving model ...
Epoch: 13 cost time: 0.8222670555114746
Epoch: 13, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.688 Vali Acc: 0.744 Test Loss: 1.688 Test Acc: 0.744
Validation loss decreased (-0.725909 --> -0.744428).  Saving model ...
Epoch: 14 cost time: 0.9212391376495361
Epoch: 14, Steps: 2 | Train Loss: 1.663 Vali Loss: 1.673 Vali Acc: 0.752 Test Loss: 1.673 Test Acc: 0.752
Validation loss decreased (-0.744428 --> -0.751835).  Saving model ...
Epoch: 15 cost time: 0.9179315567016602
Epoch: 15, Steps: 2 | Train Loss: 1.646 Vali Loss: 1.658 Vali Acc: 0.759 Test Loss: 1.658 Test Acc: 0.759
Validation loss decreased (-0.751835 --> -0.759243).  Saving model ...
Epoch: 16 cost time: 1.4068231582641602
Epoch: 16, Steps: 2 | Train Loss: 1.625 Vali Loss: 1.641 Vali Acc: 0.759 Test Loss: 1.641 Test Acc: 0.759
Validation loss decreased (-0.759243 --> -0.759243).  Saving model ...
Epoch: 17 cost time: 1.2475476264953613
Epoch: 17, Steps: 2 | Train Loss: 1.606 Vali Loss: 1.623 Vali Acc: 0.759 Test Loss: 1.623 Test Acc: 0.759
Validation loss decreased (-0.759243 --> -0.759243).  Saving model ...
Epoch: 18 cost time: 0.8410604000091553
Epoch: 18, Steps: 2 | Train Loss: 1.585 Vali Loss: 1.605 Vali Acc: 0.763 Test Loss: 1.605 Test Acc: 0.763
Validation loss decreased (-0.759243 --> -0.762947).  Saving model ...
Epoch: 19 cost time: 1.1548199653625488
Epoch: 19, Steps: 2 | Train Loss: 1.557 Vali Loss: 1.586 Vali Acc: 0.770 Test Loss: 1.586 Test Acc: 0.770
Validation loss decreased (-0.762947 --> -0.770355).  Saving model ...
Epoch: 20 cost time: 1.0871188640594482
Epoch: 20, Steps: 2 | Train Loss: 1.539 Vali Loss: 1.565 Vali Acc: 0.770 Test Loss: 1.565 Test Acc: 0.770
Validation loss decreased (-0.770355 --> -0.770355).  Saving model ...
Epoch: 21 cost time: 0.8561489582061768
Epoch: 21, Steps: 2 | Train Loss: 1.512 Vali Loss: 1.543 Vali Acc: 0.770 Test Loss: 1.543 Test Acc: 0.770
Validation loss decreased (-0.770355 --> -0.770355).  Saving model ...
Epoch: 22 cost time: 0.7532639503479004
Epoch: 22, Steps: 2 | Train Loss: 1.487 Vali Loss: 1.521 Vali Acc: 0.774 Test Loss: 1.521 Test Acc: 0.774
Validation loss decreased (-0.770355 --> -0.774059).  Saving model ...
Epoch: 23 cost time: 0.7843174934387207
Epoch: 23, Steps: 2 | Train Loss: 1.455 Vali Loss: 1.497 Vali Acc: 0.774 Test Loss: 1.497 Test Acc: 0.774
Validation loss decreased (-0.774059 --> -0.774059).  Saving model ...
Epoch: 24 cost time: 0.7343704700469971
Epoch: 24, Steps: 2 | Train Loss: 1.430 Vali Loss: 1.472 Vali Acc: 0.774 Test Loss: 1.472 Test Acc: 0.774
Validation loss decreased (-0.774059 --> -0.774059).  Saving model ...
Epoch: 25 cost time: 0.770679235458374
Epoch: 25, Steps: 2 | Train Loss: 1.403 Vali Loss: 1.446 Vali Acc: 0.774 Test Loss: 1.446 Test Acc: 0.774
Validation loss decreased (-0.774059 --> -0.774060).  Saving model ...
Epoch: 26 cost time: 0.8398416042327881
Epoch: 26, Steps: 2 | Train Loss: 1.373 Vali Loss: 1.418 Vali Acc: 0.778 Test Loss: 1.418 Test Acc: 0.778
Validation loss decreased (-0.774060 --> -0.777764).  Saving model ...
Epoch: 27 cost time: 0.9010999202728271
Epoch: 27, Steps: 2 | Train Loss: 1.339 Vali Loss: 1.390 Vali Acc: 0.778 Test Loss: 1.390 Test Acc: 0.778
Validation loss decreased (-0.777764 --> -0.777764).  Saving model ...
Epoch: 28 cost time: 1.0329465866088867
Epoch: 28, Steps: 2 | Train Loss: 1.312 Vali Loss: 1.361 Vali Acc: 0.778 Test Loss: 1.361 Test Acc: 0.778
Validation loss decreased (-0.777764 --> -0.777764).  Saving model ...
Epoch: 29 cost time: 1.0085766315460205
Epoch: 29, Steps: 2 | Train Loss: 1.280 Vali Loss: 1.331 Vali Acc: 0.778 Test Loss: 1.331 Test Acc: 0.778
Validation loss decreased (-0.777764 --> -0.777764).  Saving model ...
Epoch: 30 cost time: 0.9991989135742188
Epoch: 30, Steps: 2 | Train Loss: 1.242 Vali Loss: 1.301 Vali Acc: 0.778 Test Loss: 1.301 Test Acc: 0.778
Validation loss decreased (-0.777764 --> -0.777765).  Saving model ...
Epoch: 31 cost time: 1.185204267501831
Epoch: 31, Steps: 2 | Train Loss: 1.207 Vali Loss: 1.270 Vali Acc: 0.774 Test Loss: 1.270 Test Acc: 0.774
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0867395401000977
Epoch: 32, Steps: 2 | Train Loss: 1.168 Vali Loss: 1.239 Vali Acc: 0.778 Test Loss: 1.239 Test Acc: 0.778
Validation loss decreased (-0.777765 --> -0.777765).  Saving model ...
Epoch: 33 cost time: 0.8583698272705078
Epoch: 33, Steps: 2 | Train Loss: 1.126 Vali Loss: 1.208 Vali Acc: 0.781 Test Loss: 1.208 Test Acc: 0.781
Validation loss decreased (-0.777765 --> -0.781469).  Saving model ...
Epoch: 34 cost time: 1.1496081352233887
Epoch: 34, Steps: 2 | Train Loss: 1.089 Vali Loss: 1.176 Vali Acc: 0.785 Test Loss: 1.176 Test Acc: 0.785
Validation loss decreased (-0.781469 --> -0.785173).  Saving model ...
Epoch: 35 cost time: 0.8204278945922852
Epoch: 35, Steps: 2 | Train Loss: 1.058 Vali Loss: 1.144 Vali Acc: 0.785 Test Loss: 1.144 Test Acc: 0.785
Validation loss decreased (-0.785173 --> -0.785174).  Saving model ...
Epoch: 36 cost time: 1.2702875137329102
Epoch: 36, Steps: 2 | Train Loss: 1.017 Vali Loss: 1.113 Vali Acc: 0.781 Test Loss: 1.113 Test Acc: 0.781
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.109847068786621
Epoch: 37, Steps: 2 | Train Loss: 0.982 Vali Loss: 1.081 Vali Acc: 0.789 Test Loss: 1.081 Test Acc: 0.789
Validation loss decreased (-0.785174 --> -0.788878).  Saving model ...
Epoch: 38 cost time: 0.7635080814361572
Epoch: 38, Steps: 2 | Train Loss: 0.951 Vali Loss: 1.050 Vali Acc: 0.793 Test Loss: 1.050 Test Acc: 0.793
Validation loss decreased (-0.788878 --> -0.792582).  Saving model ...
Epoch: 39 cost time: 1.1228604316711426
Epoch: 39, Steps: 2 | Train Loss: 0.913 Vali Loss: 1.020 Vali Acc: 0.800 Test Loss: 1.020 Test Acc: 0.800
Validation loss decreased (-0.792582 --> -0.799990).  Saving model ...
Epoch: 40 cost time: 1.0152266025543213
Epoch: 40, Steps: 2 | Train Loss: 0.881 Vali Loss: 0.990 Vali Acc: 0.804 Test Loss: 0.990 Test Acc: 0.804
Validation loss decreased (-0.799990 --> -0.803694).  Saving model ...
Epoch: 41 cost time: 0.7466335296630859
Epoch: 41, Steps: 2 | Train Loss: 0.842 Vali Loss: 0.960 Vali Acc: 0.800 Test Loss: 0.960 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0700476169586182
Epoch: 42, Steps: 2 | Train Loss: 0.803 Vali Loss: 0.932 Vali Acc: 0.804 Test Loss: 0.932 Test Acc: 0.804
Validation loss decreased (-0.803694 --> -0.803694).  Saving model ...
Epoch: 43 cost time: 1.1804513931274414
Epoch: 43, Steps: 2 | Train Loss: 0.769 Vali Loss: 0.904 Vali Acc: 0.804 Test Loss: 0.904 Test Acc: 0.804
Validation loss decreased (-0.803694 --> -0.803695).  Saving model ...
Epoch: 44 cost time: 0.9492847919464111
Epoch: 44, Steps: 2 | Train Loss: 0.747 Vali Loss: 0.877 Vali Acc: 0.800 Test Loss: 0.877 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8460006713867188
Epoch: 45, Steps: 2 | Train Loss: 0.713 Vali Loss: 0.851 Vali Acc: 0.796 Test Loss: 0.851 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.2230346202850342
Epoch: 46, Steps: 2 | Train Loss: 0.684 Vali Loss: 0.825 Vali Acc: 0.800 Test Loss: 0.825 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.079390525817871
Epoch: 47, Steps: 2 | Train Loss: 0.653 Vali Loss: 0.801 Vali Acc: 0.811 Test Loss: 0.801 Test Acc: 0.811
Validation loss decreased (-0.803695 --> -0.811103).  Saving model ...
Epoch: 48 cost time: 1.0261688232421875
Epoch: 48, Steps: 2 | Train Loss: 0.624 Vali Loss: 0.778 Vali Acc: 0.815 Test Loss: 0.778 Test Acc: 0.815
Validation loss decreased (-0.811103 --> -0.814807).  Saving model ...
Epoch: 49 cost time: 0.8952522277832031
Epoch: 49, Steps: 2 | Train Loss: 0.599 Vali Loss: 0.756 Vali Acc: 0.819 Test Loss: 0.756 Test Acc: 0.819
Validation loss decreased (-0.814807 --> -0.818511).  Saving model ...
Epoch: 50 cost time: 1.3376672267913818
Epoch: 50, Steps: 2 | Train Loss: 0.577 Vali Loss: 0.734 Vali Acc: 0.822 Test Loss: 0.734 Test Acc: 0.822
Validation loss decreased (-0.818511 --> -0.822215).  Saving model ...
Epoch: 51 cost time: 1.0676562786102295
Epoch: 51, Steps: 2 | Train Loss: 0.542 Vali Loss: 0.713 Vali Acc: 0.826 Test Loss: 0.713 Test Acc: 0.826
Validation loss decreased (-0.822215 --> -0.825919).  Saving model ...
Epoch: 52 cost time: 0.8779678344726562
Epoch: 52, Steps: 2 | Train Loss: 0.528 Vali Loss: 0.694 Vali Acc: 0.833 Test Loss: 0.694 Test Acc: 0.833
Validation loss decreased (-0.825919 --> -0.833326).  Saving model ...
Epoch: 53 cost time: 1.1027638912200928
Epoch: 53, Steps: 2 | Train Loss: 0.502 Vali Loss: 0.675 Vali Acc: 0.841 Test Loss: 0.675 Test Acc: 0.841
Validation loss decreased (-0.833326 --> -0.840734).  Saving model ...
Epoch: 54 cost time: 0.8881552219390869
Epoch: 54, Steps: 2 | Train Loss: 0.478 Vali Loss: 0.657 Vali Acc: 0.848 Test Loss: 0.657 Test Acc: 0.848
Validation loss decreased (-0.840734 --> -0.848142).  Saving model ...
Epoch: 55 cost time: 0.9095759391784668
Epoch: 55, Steps: 2 | Train Loss: 0.462 Vali Loss: 0.640 Vali Acc: 0.859 Test Loss: 0.640 Test Acc: 0.859
Validation loss decreased (-0.848142 --> -0.859253).  Saving model ...
Epoch: 56 cost time: 0.81831955909729
Epoch: 56, Steps: 2 | Train Loss: 0.438 Vali Loss: 0.624 Vali Acc: 0.863 Test Loss: 0.624 Test Acc: 0.863
Validation loss decreased (-0.859253 --> -0.862957).  Saving model ...
Epoch: 57 cost time: 0.7075512409210205
Epoch: 57, Steps: 2 | Train Loss: 0.424 Vali Loss: 0.609 Vali Acc: 0.859 Test Loss: 0.609 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.8102941513061523
Epoch: 58, Steps: 2 | Train Loss: 0.406 Vali Loss: 0.595 Vali Acc: 0.859 Test Loss: 0.595 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.6961681842803955
Epoch: 59, Steps: 2 | Train Loss: 0.395 Vali Loss: 0.581 Vali Acc: 0.863 Test Loss: 0.581 Test Acc: 0.863
Validation loss decreased (-0.862957 --> -0.862957).  Saving model ...
Epoch: 60 cost time: 0.6624546051025391
Epoch: 60, Steps: 2 | Train Loss: 0.376 Vali Loss: 0.568 Vali Acc: 0.870 Test Loss: 0.568 Test Acc: 0.870
Validation loss decreased (-0.862957 --> -0.870365).  Saving model ...
Epoch: 61 cost time: 0.9781744480133057
Epoch: 61, Steps: 2 | Train Loss: 0.359 Vali Loss: 0.556 Vali Acc: 0.874 Test Loss: 0.556 Test Acc: 0.874
Validation loss decreased (-0.870365 --> -0.874069).  Saving model ...
Epoch: 62 cost time: 0.9627771377563477
Epoch: 62, Steps: 2 | Train Loss: 0.351 Vali Loss: 0.545 Vali Acc: 0.881 Test Loss: 0.545 Test Acc: 0.881
Validation loss decreased (-0.874069 --> -0.881476).  Saving model ...
Epoch: 63 cost time: 0.9125120639801025
Epoch: 63, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.533 Vali Acc: 0.881 Test Loss: 0.533 Test Acc: 0.881
Validation loss decreased (-0.881476 --> -0.881476).  Saving model ...
Epoch: 64 cost time: 0.9063873291015625
Epoch: 64, Steps: 2 | Train Loss: 0.318 Vali Loss: 0.523 Vali Acc: 0.881 Test Loss: 0.523 Test Acc: 0.881
Validation loss decreased (-0.881476 --> -0.881476).  Saving model ...
Epoch: 65 cost time: 0.670832633972168
Epoch: 65, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.513 Vali Acc: 0.885 Test Loss: 0.513 Test Acc: 0.885
Validation loss decreased (-0.881476 --> -0.885180).  Saving model ...
Epoch: 66 cost time: 0.9172253608703613
Epoch: 66, Steps: 2 | Train Loss: 0.300 Vali Loss: 0.504 Vali Acc: 0.889 Test Loss: 0.504 Test Acc: 0.889
Validation loss decreased (-0.885180 --> -0.888884).  Saving model ...
Epoch: 67 cost time: 0.9089949131011963
Epoch: 67, Steps: 2 | Train Loss: 0.288 Vali Loss: 0.495 Vali Acc: 0.889 Test Loss: 0.495 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 68 cost time: 1.2200274467468262
Epoch: 68, Steps: 2 | Train Loss: 0.277 Vali Loss: 0.486 Vali Acc: 0.889 Test Loss: 0.486 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 69 cost time: 0.997495174407959
Epoch: 69, Steps: 2 | Train Loss: 0.270 Vali Loss: 0.478 Vali Acc: 0.889 Test Loss: 0.478 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 70 cost time: 1.1292762756347656
Epoch: 70, Steps: 2 | Train Loss: 0.263 Vali Loss: 0.471 Vali Acc: 0.889 Test Loss: 0.471 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 71 cost time: 1.0662121772766113
Epoch: 71, Steps: 2 | Train Loss: 0.248 Vali Loss: 0.463 Vali Acc: 0.885 Test Loss: 0.463 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.1595568656921387
Epoch: 72, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.456 Vali Acc: 0.885 Test Loss: 0.456 Test Acc: 0.885
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 1.0743272304534912
Epoch: 73, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.450 Vali Acc: 0.885 Test Loss: 0.450 Test Acc: 0.885
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 0.9601864814758301
Epoch: 74, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.444 Vali Acc: 0.885 Test Loss: 0.444 Test Acc: 0.885
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 1.097015142440796
Epoch: 75, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.437 Vali Acc: 0.885 Test Loss: 0.437 Test Acc: 0.885
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 0.833838939666748
Epoch: 76, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.431 Vali Acc: 0.885 Test Loss: 0.431 Test Acc: 0.885
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 0.8737313747406006
Epoch: 77, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.426 Vali Acc: 0.889 Test Loss: 0.426 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 78 cost time: 0.9792826175689697
Epoch: 78, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.420 Vali Acc: 0.885 Test Loss: 0.420 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 1.0138275623321533
Epoch: 79, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.415 Vali Acc: 0.885 Test Loss: 0.415 Test Acc: 0.885
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 1.2088184356689453
Epoch: 80, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.410 Vali Acc: 0.885 Test Loss: 0.410 Test Acc: 0.885
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 0.998807430267334
Epoch: 81, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.405 Vali Acc: 0.885 Test Loss: 0.405 Test Acc: 0.885
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 1.1521620750427246
Epoch: 82, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.400 Vali Acc: 0.889 Test Loss: 0.400 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 83 cost time: 0.8833110332489014
Epoch: 83, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.396 Vali Acc: 0.889 Test Loss: 0.396 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 84 cost time: 1.0138146877288818
Epoch: 84, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.392 Vali Acc: 0.889 Test Loss: 0.392 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 85 cost time: 1.026474952697754
Epoch: 85, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.387 Vali Acc: 0.889 Test Loss: 0.387 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 86 cost time: 1.0528388023376465
Epoch: 86, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.384 Vali Acc: 0.889 Test Loss: 0.384 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 87 cost time: 0.9120914936065674
Epoch: 87, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.380 Vali Acc: 0.889 Test Loss: 0.380 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 88 cost time: 1.4197795391082764
Epoch: 88, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.376 Vali Acc: 0.889 Test Loss: 0.376 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 89 cost time: 1.1229054927825928
Epoch: 89, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.372 Vali Acc: 0.889 Test Loss: 0.372 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 90 cost time: 1.1097755432128906
Epoch: 90, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.369 Vali Acc: 0.889 Test Loss: 0.369 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 91 cost time: 0.8694179058074951
Epoch: 91, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.366 Vali Acc: 0.889 Test Loss: 0.366 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 92 cost time: 1.0126547813415527
Epoch: 92, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.363 Vali Acc: 0.889 Test Loss: 0.363 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 93 cost time: 0.8555524349212646
Epoch: 93, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.360 Vali Acc: 0.889 Test Loss: 0.360 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 94 cost time: 1.1692547798156738
Epoch: 94, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.357 Vali Acc: 0.889 Test Loss: 0.357 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 95 cost time: 1.1377170085906982
Epoch: 95, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.354 Vali Acc: 0.889 Test Loss: 0.354 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 96 cost time: 0.9396815299987793
Epoch: 96, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.351 Vali Acc: 0.889 Test Loss: 0.351 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 97 cost time: 0.9965217113494873
Epoch: 97, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.349 Vali Acc: 0.889 Test Loss: 0.349 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 98 cost time: 0.8526628017425537
Epoch: 98, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.346 Vali Acc: 0.889 Test Loss: 0.346 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 99 cost time: 0.9372241497039795
Epoch: 99, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.343 Vali Acc: 0.889 Test Loss: 0.343 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 100 cost time: 1.2872745990753174
Epoch: 100, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.341 Vali Acc: 0.889 Test Loss: 0.341 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_DLinear_UEA_ftM_sl65_ll0_pl0_ma13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8888888888888888
model parameter : 10146
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_DLinear_UEA_ftM_sl65_ll0_pl0_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 4.02093505859375
Epoch: 1, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.789 Vali Acc: 0.167 Test Loss: 1.789 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 1.31693434715271
Epoch: 2, Steps: 2 | Train Loss: 1.787 Vali Loss: 1.785 Vali Acc: 0.167 Test Loss: 1.785 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 0.8800878524780273
Epoch: 3, Steps: 2 | Train Loss: 1.782 Vali Loss: 1.782 Vali Acc: 0.333 Test Loss: 1.782 Test Acc: 0.333
Validation loss decreased (-0.166649 --> -0.333316).  Saving model ...
Epoch: 4 cost time: 1.2112274169921875
Epoch: 4, Steps: 2 | Train Loss: 1.779 Vali Loss: 1.777 Vali Acc: 0.333 Test Loss: 1.777 Test Acc: 0.333
Validation loss decreased (-0.333316 --> -0.333316).  Saving model ...
Epoch: 5 cost time: 1.121248722076416
Epoch: 5, Steps: 2 | Train Loss: 1.772 Vali Loss: 1.771 Vali Acc: 0.333 Test Loss: 1.771 Test Acc: 0.333
Validation loss decreased (-0.333316 --> -0.333316).  Saving model ...
Epoch: 6 cost time: 1.3708961009979248
Epoch: 6, Steps: 2 | Train Loss: 1.765 Vali Loss: 1.764 Vali Acc: 0.396 Test Loss: 1.764 Test Acc: 0.396
Validation loss decreased (-0.333316 --> -0.396279).  Saving model ...
Epoch: 7 cost time: 1.3407719135284424
Epoch: 7, Steps: 2 | Train Loss: 1.755 Vali Loss: 1.756 Vali Acc: 0.537 Test Loss: 1.756 Test Acc: 0.537
Validation loss decreased (-0.396279 --> -0.537019).  Saving model ...
Epoch: 8 cost time: 0.9160339832305908
Epoch: 8, Steps: 2 | Train Loss: 1.745 Vali Loss: 1.746 Vali Acc: 0.600 Test Loss: 1.746 Test Acc: 0.600
Validation loss decreased (-0.537019 --> -0.599983).  Saving model ...
Epoch: 9 cost time: 1.2931292057037354
Epoch: 9, Steps: 2 | Train Loss: 1.733 Vali Loss: 1.736 Vali Acc: 0.648 Test Loss: 1.736 Test Acc: 0.648
Validation loss decreased (-0.599983 --> -0.648131).  Saving model ...
Epoch: 10 cost time: 1.0689549446105957
Epoch: 10, Steps: 2 | Train Loss: 1.722 Vali Loss: 1.725 Vali Acc: 0.681 Test Loss: 1.725 Test Acc: 0.681
Validation loss decreased (-0.648131 --> -0.681464).  Saving model ...
Epoch: 11 cost time: 1.229201078414917
Epoch: 11, Steps: 2 | Train Loss: 1.706 Vali Loss: 1.713 Vali Acc: 0.704 Test Loss: 1.713 Test Acc: 0.704
Validation loss decreased (-0.681464 --> -0.703687).  Saving model ...
Epoch: 12 cost time: 1.5988469123840332
Epoch: 12, Steps: 2 | Train Loss: 1.693 Vali Loss: 1.701 Vali Acc: 0.730 Test Loss: 1.701 Test Acc: 0.730
Validation loss decreased (-0.703687 --> -0.729613).  Saving model ...
Epoch: 13 cost time: 1.2403221130371094
Epoch: 13, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.687 Vali Acc: 0.748 Test Loss: 1.687 Test Acc: 0.748
Validation loss decreased (-0.729613 --> -0.748131).  Saving model ...
Epoch: 14 cost time: 1.1485064029693604
Epoch: 14, Steps: 2 | Train Loss: 1.662 Vali Loss: 1.672 Vali Acc: 0.748 Test Loss: 1.672 Test Acc: 0.748
Validation loss decreased (-0.748131 --> -0.748131).  Saving model ...
Epoch: 15 cost time: 1.3892078399658203
Epoch: 15, Steps: 2 | Train Loss: 1.645 Vali Loss: 1.656 Vali Acc: 0.752 Test Loss: 1.656 Test Acc: 0.752
Validation loss decreased (-0.748131 --> -0.751835).  Saving model ...
Epoch: 16 cost time: 1.249971628189087
Epoch: 16, Steps: 2 | Train Loss: 1.624 Vali Loss: 1.640 Vali Acc: 0.752 Test Loss: 1.640 Test Acc: 0.752
Validation loss decreased (-0.751835 --> -0.751835).  Saving model ...
Epoch: 17 cost time: 1.0925416946411133
Epoch: 17, Steps: 2 | Train Loss: 1.605 Vali Loss: 1.622 Vali Acc: 0.756 Test Loss: 1.622 Test Acc: 0.756
Validation loss decreased (-0.751835 --> -0.755539).  Saving model ...
Epoch: 18 cost time: 1.2703113555908203
Epoch: 18, Steps: 2 | Train Loss: 1.584 Vali Loss: 1.603 Vali Acc: 0.756 Test Loss: 1.603 Test Acc: 0.756
Validation loss decreased (-0.755539 --> -0.755540).  Saving model ...
Epoch: 19 cost time: 1.1597912311553955
Epoch: 19, Steps: 2 | Train Loss: 1.556 Vali Loss: 1.584 Vali Acc: 0.763 Test Loss: 1.584 Test Acc: 0.763
Validation loss decreased (-0.755540 --> -0.762947).  Saving model ...
Epoch: 20 cost time: 1.0147228240966797
Epoch: 20, Steps: 2 | Train Loss: 1.538 Vali Loss: 1.563 Vali Acc: 0.763 Test Loss: 1.563 Test Acc: 0.763
Validation loss decreased (-0.762947 --> -0.762947).  Saving model ...
Epoch: 21 cost time: 1.2867481708526611
Epoch: 21, Steps: 2 | Train Loss: 1.511 Vali Loss: 1.541 Vali Acc: 0.763 Test Loss: 1.541 Test Acc: 0.763
Validation loss decreased (-0.762947 --> -0.762948).  Saving model ...
Epoch: 22 cost time: 1.1571645736694336
Epoch: 22, Steps: 2 | Train Loss: 1.486 Vali Loss: 1.518 Vali Acc: 0.767 Test Loss: 1.518 Test Acc: 0.767
Validation loss decreased (-0.762948 --> -0.766651).  Saving model ...
Epoch: 23 cost time: 0.9620237350463867
Epoch: 23, Steps: 2 | Train Loss: 1.454 Vali Loss: 1.494 Vali Acc: 0.767 Test Loss: 1.494 Test Acc: 0.767
Validation loss decreased (-0.766651 --> -0.766652).  Saving model ...
Epoch: 24 cost time: 1.2616403102874756
Epoch: 24, Steps: 2 | Train Loss: 1.429 Vali Loss: 1.469 Vali Acc: 0.767 Test Loss: 1.469 Test Acc: 0.767
Validation loss decreased (-0.766652 --> -0.766652).  Saving model ...
Epoch: 25 cost time: 0.950568675994873
Epoch: 25, Steps: 2 | Train Loss: 1.401 Vali Loss: 1.443 Vali Acc: 0.767 Test Loss: 1.443 Test Acc: 0.767
Validation loss decreased (-0.766652 --> -0.766652).  Saving model ...
Epoch: 26 cost time: 1.075486660003662
Epoch: 26, Steps: 2 | Train Loss: 1.372 Vali Loss: 1.415 Vali Acc: 0.767 Test Loss: 1.415 Test Acc: 0.767
Validation loss decreased (-0.766652 --> -0.766653).  Saving model ...
Epoch: 27 cost time: 0.8487346172332764
Epoch: 27, Steps: 2 | Train Loss: 1.337 Vali Loss: 1.387 Vali Acc: 0.770 Test Loss: 1.387 Test Acc: 0.770
Validation loss decreased (-0.766653 --> -0.770357).  Saving model ...
Epoch: 28 cost time: 1.0377466678619385
Epoch: 28, Steps: 2 | Train Loss: 1.310 Vali Loss: 1.358 Vali Acc: 0.770 Test Loss: 1.358 Test Acc: 0.770
Validation loss decreased (-0.770357 --> -0.770357).  Saving model ...
Epoch: 29 cost time: 1.1966407299041748
Epoch: 29, Steps: 2 | Train Loss: 1.278 Vali Loss: 1.328 Vali Acc: 0.770 Test Loss: 1.328 Test Acc: 0.770
Validation loss decreased (-0.770357 --> -0.770357).  Saving model ...
Epoch: 30 cost time: 1.507004976272583
Epoch: 30, Steps: 2 | Train Loss: 1.240 Vali Loss: 1.297 Vali Acc: 0.770 Test Loss: 1.297 Test Acc: 0.770
Validation loss decreased (-0.770357 --> -0.770357).  Saving model ...
Epoch: 31 cost time: 1.178234577178955
Epoch: 31, Steps: 2 | Train Loss: 1.205 Vali Loss: 1.267 Vali Acc: 0.770 Test Loss: 1.267 Test Acc: 0.770
Validation loss decreased (-0.770357 --> -0.770358).  Saving model ...
Epoch: 32 cost time: 1.4522762298583984
Epoch: 32, Steps: 2 | Train Loss: 1.166 Vali Loss: 1.235 Vali Acc: 0.770 Test Loss: 1.235 Test Acc: 0.770
Validation loss decreased (-0.770358 --> -0.770358).  Saving model ...
Epoch: 33 cost time: 0.9904453754425049
Epoch: 33, Steps: 2 | Train Loss: 1.124 Vali Loss: 1.204 Vali Acc: 0.770 Test Loss: 1.204 Test Acc: 0.770
Validation loss decreased (-0.770358 --> -0.770358).  Saving model ...
Epoch: 34 cost time: 1.1179513931274414
Epoch: 34, Steps: 2 | Train Loss: 1.087 Vali Loss: 1.172 Vali Acc: 0.770 Test Loss: 1.172 Test Acc: 0.770
Validation loss decreased (-0.770358 --> -0.770359).  Saving model ...
Epoch: 35 cost time: 1.311190128326416
Epoch: 35, Steps: 2 | Train Loss: 1.056 Vali Loss: 1.140 Vali Acc: 0.770 Test Loss: 1.140 Test Acc: 0.770
Validation loss decreased (-0.770359 --> -0.770359).  Saving model ...
Epoch: 36 cost time: 0.9097745418548584
Epoch: 36, Steps: 2 | Train Loss: 1.014 Vali Loss: 1.108 Vali Acc: 0.774 Test Loss: 1.108 Test Acc: 0.774
Validation loss decreased (-0.770359 --> -0.774063).  Saving model ...
Epoch: 37 cost time: 1.128340721130371
Epoch: 37, Steps: 2 | Train Loss: 0.980 Vali Loss: 1.077 Vali Acc: 0.781 Test Loss: 1.077 Test Acc: 0.781
Validation loss decreased (-0.774063 --> -0.781471).  Saving model ...
Epoch: 38 cost time: 1.1827833652496338
Epoch: 38, Steps: 2 | Train Loss: 0.949 Vali Loss: 1.046 Vali Acc: 0.785 Test Loss: 1.046 Test Acc: 0.785
Validation loss decreased (-0.781471 --> -0.785175).  Saving model ...
Epoch: 39 cost time: 1.1570167541503906
Epoch: 39, Steps: 2 | Train Loss: 0.911 Vali Loss: 1.015 Vali Acc: 0.789 Test Loss: 1.015 Test Acc: 0.789
Validation loss decreased (-0.785175 --> -0.788879).  Saving model ...
Epoch: 40 cost time: 1.3990187644958496
Epoch: 40, Steps: 2 | Train Loss: 0.879 Vali Loss: 0.985 Vali Acc: 0.789 Test Loss: 0.985 Test Acc: 0.789
Validation loss decreased (-0.788879 --> -0.788879).  Saving model ...
Epoch: 41 cost time: 0.9900350570678711
Epoch: 41, Steps: 2 | Train Loss: 0.840 Vali Loss: 0.956 Vali Acc: 0.800 Test Loss: 0.956 Test Acc: 0.800
Validation loss decreased (-0.788879 --> -0.799990).  Saving model ...
Epoch: 42 cost time: 1.1545331478118896
Epoch: 42, Steps: 2 | Train Loss: 0.801 Vali Loss: 0.927 Vali Acc: 0.800 Test Loss: 0.927 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799991).  Saving model ...
Epoch: 43 cost time: 1.083768367767334
Epoch: 43, Steps: 2 | Train Loss: 0.767 Vali Loss: 0.900 Vali Acc: 0.800 Test Loss: 0.900 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 44 cost time: 1.444809913635254
Epoch: 44, Steps: 2 | Train Loss: 0.745 Vali Loss: 0.873 Vali Acc: 0.804 Test Loss: 0.873 Test Acc: 0.804
Validation loss decreased (-0.799991 --> -0.803695).  Saving model ...
Epoch: 45 cost time: 1.2201263904571533
Epoch: 45, Steps: 2 | Train Loss: 0.711 Vali Loss: 0.847 Vali Acc: 0.804 Test Loss: 0.847 Test Acc: 0.804
Validation loss decreased (-0.803695 --> -0.803695).  Saving model ...
Epoch: 46 cost time: 1.272338628768921
Epoch: 46, Steps: 2 | Train Loss: 0.683 Vali Loss: 0.822 Vali Acc: 0.804 Test Loss: 0.822 Test Acc: 0.804
Validation loss decreased (-0.803695 --> -0.803695).  Saving model ...
Epoch: 47 cost time: 1.0092525482177734
Epoch: 47, Steps: 2 | Train Loss: 0.652 Vali Loss: 0.797 Vali Acc: 0.811 Test Loss: 0.797 Test Acc: 0.811
Validation loss decreased (-0.803695 --> -0.811103).  Saving model ...
Epoch: 48 cost time: 1.3953030109405518
Epoch: 48, Steps: 2 | Train Loss: 0.623 Vali Loss: 0.774 Vali Acc: 0.815 Test Loss: 0.774 Test Acc: 0.815
Validation loss decreased (-0.811103 --> -0.814807).  Saving model ...
Epoch: 49 cost time: 1.5020167827606201
Epoch: 49, Steps: 2 | Train Loss: 0.598 Vali Loss: 0.752 Vali Acc: 0.826 Test Loss: 0.752 Test Acc: 0.826
Validation loss decreased (-0.814807 --> -0.825918).  Saving model ...
Epoch: 50 cost time: 1.0644268989562988
Epoch: 50, Steps: 2 | Train Loss: 0.576 Vali Loss: 0.731 Vali Acc: 0.826 Test Loss: 0.731 Test Acc: 0.826
Validation loss decreased (-0.825918 --> -0.825919).  Saving model ...
Epoch: 51 cost time: 1.5054407119750977
Epoch: 51, Steps: 2 | Train Loss: 0.542 Vali Loss: 0.710 Vali Acc: 0.826 Test Loss: 0.710 Test Acc: 0.826
Validation loss decreased (-0.825919 --> -0.825919).  Saving model ...
Epoch: 52 cost time: 1.5807764530181885
Epoch: 52, Steps: 2 | Train Loss: 0.528 Vali Loss: 0.691 Vali Acc: 0.826 Test Loss: 0.691 Test Acc: 0.826
Validation loss decreased (-0.825919 --> -0.825919).  Saving model ...
Epoch: 53 cost time: 1.108823299407959
Epoch: 53, Steps: 2 | Train Loss: 0.501 Vali Loss: 0.673 Vali Acc: 0.841 Test Loss: 0.673 Test Acc: 0.841
Validation loss decreased (-0.825919 --> -0.840734).  Saving model ...
Epoch: 54 cost time: 1.1924324035644531
Epoch: 54, Steps: 2 | Train Loss: 0.478 Vali Loss: 0.655 Vali Acc: 0.844 Test Loss: 0.655 Test Acc: 0.844
Validation loss decreased (-0.840734 --> -0.844438).  Saving model ...
Epoch: 55 cost time: 1.3270983695983887
Epoch: 55, Steps: 2 | Train Loss: 0.463 Vali Loss: 0.638 Vali Acc: 0.852 Test Loss: 0.638 Test Acc: 0.852
Validation loss decreased (-0.844438 --> -0.851845).  Saving model ...
Epoch: 56 cost time: 1.4314556121826172
Epoch: 56, Steps: 2 | Train Loss: 0.438 Vali Loss: 0.622 Vali Acc: 0.856 Test Loss: 0.622 Test Acc: 0.856
Validation loss decreased (-0.851845 --> -0.855549).  Saving model ...
Epoch: 57 cost time: 1.033323049545288
Epoch: 57, Steps: 2 | Train Loss: 0.425 Vali Loss: 0.607 Vali Acc: 0.863 Test Loss: 0.607 Test Acc: 0.863
Validation loss decreased (-0.855549 --> -0.862957).  Saving model ...
Epoch: 58 cost time: 1.1130189895629883
Epoch: 58, Steps: 2 | Train Loss: 0.407 Vali Loss: 0.593 Vali Acc: 0.867 Test Loss: 0.593 Test Acc: 0.867
Validation loss decreased (-0.862957 --> -0.866661).  Saving model ...
Epoch: 59 cost time: 0.9009847640991211
Epoch: 59, Steps: 2 | Train Loss: 0.396 Vali Loss: 0.579 Vali Acc: 0.867 Test Loss: 0.579 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 60 cost time: 1.1128792762756348
Epoch: 60, Steps: 2 | Train Loss: 0.377 Vali Loss: 0.567 Vali Acc: 0.874 Test Loss: 0.567 Test Acc: 0.874
Validation loss decreased (-0.866661 --> -0.874068).  Saving model ...
Epoch: 61 cost time: 1.0960931777954102
Epoch: 61, Steps: 2 | Train Loss: 0.359 Vali Loss: 0.555 Vali Acc: 0.874 Test Loss: 0.555 Test Acc: 0.874
Validation loss decreased (-0.874068 --> -0.874069).  Saving model ...
Epoch: 62 cost time: 0.9893100261688232
Epoch: 62, Steps: 2 | Train Loss: 0.352 Vali Loss: 0.543 Vali Acc: 0.874 Test Loss: 0.543 Test Acc: 0.874
Validation loss decreased (-0.874069 --> -0.874069).  Saving model ...
Epoch: 63 cost time: 1.20005464553833
Epoch: 63, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.532 Vali Acc: 0.878 Test Loss: 0.532 Test Acc: 0.878
Validation loss decreased (-0.874069 --> -0.877772).  Saving model ...
Epoch: 64 cost time: 0.9371399879455566
Epoch: 64, Steps: 2 | Train Loss: 0.319 Vali Loss: 0.522 Vali Acc: 0.878 Test Loss: 0.522 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877773).  Saving model ...
Epoch: 65 cost time: 0.8893780708312988
Epoch: 65, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.512 Vali Acc: 0.885 Test Loss: 0.512 Test Acc: 0.885
Validation loss decreased (-0.877773 --> -0.885180).  Saving model ...
Epoch: 66 cost time: 0.8227503299713135
Epoch: 66, Steps: 2 | Train Loss: 0.302 Vali Loss: 0.502 Vali Acc: 0.889 Test Loss: 0.502 Test Acc: 0.889
Validation loss decreased (-0.885180 --> -0.888884).  Saving model ...
Epoch: 67 cost time: 0.993966817855835
Epoch: 67, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.494 Vali Acc: 0.889 Test Loss: 0.494 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 68 cost time: 1.1281747817993164
Epoch: 68, Steps: 2 | Train Loss: 0.278 Vali Loss: 0.485 Vali Acc: 0.889 Test Loss: 0.485 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 69 cost time: 1.1566789150238037
Epoch: 69, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.477 Vali Acc: 0.889 Test Loss: 0.477 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 70 cost time: 1.1033351421356201
Epoch: 70, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.470 Vali Acc: 0.885 Test Loss: 0.470 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.330611228942871
Epoch: 71, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.462 Vali Acc: 0.889 Test Loss: 0.462 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 72 cost time: 1.099729061126709
Epoch: 72, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.455 Vali Acc: 0.889 Test Loss: 0.455 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 73 cost time: 0.7638781070709229
Epoch: 73, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.449 Vali Acc: 0.889 Test Loss: 0.449 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 74 cost time: 0.9098019599914551
Epoch: 74, Steps: 2 | Train Loss: 0.226 Vali Loss: 0.442 Vali Acc: 0.889 Test Loss: 0.442 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 75 cost time: 1.0144233703613281
Epoch: 75, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.436 Vali Acc: 0.889 Test Loss: 0.436 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 76 cost time: 1.0657551288604736
Epoch: 76, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.430 Vali Acc: 0.889 Test Loss: 0.430 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 77 cost time: 0.9100358486175537
Epoch: 77, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.424 Vali Acc: 0.889 Test Loss: 0.424 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 78 cost time: 0.8635821342468262
Epoch: 78, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.419 Vali Acc: 0.889 Test Loss: 0.419 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 79 cost time: 1.1846895217895508
Epoch: 79, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.414 Vali Acc: 0.889 Test Loss: 0.414 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 80 cost time: 0.9130468368530273
Epoch: 80, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.408 Vali Acc: 0.889 Test Loss: 0.408 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 81 cost time: 1.096527099609375
Epoch: 81, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.404 Vali Acc: 0.889 Test Loss: 0.404 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 82 cost time: 1.2420885562896729
Epoch: 82, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.399 Vali Acc: 0.889 Test Loss: 0.399 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 83 cost time: 0.9266583919525146
Epoch: 83, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.395 Vali Acc: 0.889 Test Loss: 0.395 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 84 cost time: 0.9852862358093262
Epoch: 84, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.390 Vali Acc: 0.889 Test Loss: 0.390 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 85 cost time: 1.5925424098968506
Epoch: 85, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.386 Vali Acc: 0.889 Test Loss: 0.386 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 86 cost time: 1.2056498527526855
Epoch: 86, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.382 Vali Acc: 0.885 Test Loss: 0.382 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 0.9643990993499756
Epoch: 87, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.378 Vali Acc: 0.885 Test Loss: 0.378 Test Acc: 0.885
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 1.2743604183197021
Epoch: 88, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.374 Vali Acc: 0.885 Test Loss: 0.374 Test Acc: 0.885
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 1.1663463115692139
Epoch: 89, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.371 Vali Acc: 0.885 Test Loss: 0.371 Test Acc: 0.885
EarlyStopping counter: 4 out of 10
Epoch: 90 cost time: 1.216599941253662
Epoch: 90, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.367 Vali Acc: 0.885 Test Loss: 0.367 Test Acc: 0.885
EarlyStopping counter: 5 out of 10
Epoch: 91 cost time: 1.118476390838623
Epoch: 91, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.364 Vali Acc: 0.885 Test Loss: 0.364 Test Acc: 0.885
EarlyStopping counter: 6 out of 10
Epoch: 92 cost time: 1.0521140098571777
Epoch: 92, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.361 Vali Acc: 0.885 Test Loss: 0.361 Test Acc: 0.885
EarlyStopping counter: 7 out of 10
Epoch: 93 cost time: 0.9809975624084473
Epoch: 93, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.358 Vali Acc: 0.885 Test Loss: 0.358 Test Acc: 0.885
EarlyStopping counter: 8 out of 10
Epoch: 94 cost time: 1.3607897758483887
Epoch: 94, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.355 Vali Acc: 0.885 Test Loss: 0.355 Test Acc: 0.885
EarlyStopping counter: 9 out of 10
Epoch: 95 cost time: 0.9454247951507568
Epoch: 95, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.352 Vali Acc: 0.885 Test Loss: 0.352 Test Acc: 0.885
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_DLinear_UEA_ftM_sl65_ll0_pl0_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8888888888888888
model parameter : 10146
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_DLinear_UEA_ftM_sl65_ll0_pl0_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 4.115920066833496
Epoch: 1, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.789 Vali Acc: 0.167 Test Loss: 1.789 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 0.8247547149658203
Epoch: 2, Steps: 2 | Train Loss: 1.787 Vali Loss: 1.785 Vali Acc: 0.167 Test Loss: 1.785 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 1.1966743469238281
Epoch: 3, Steps: 2 | Train Loss: 1.782 Vali Loss: 1.781 Vali Acc: 0.333 Test Loss: 1.781 Test Acc: 0.333
Validation loss decreased (-0.166649 --> -0.333316).  Saving model ...
Epoch: 4 cost time: 1.4564416408538818
Epoch: 4, Steps: 2 | Train Loss: 1.779 Vali Loss: 1.777 Vali Acc: 0.333 Test Loss: 1.777 Test Acc: 0.333
Validation loss decreased (-0.333316 --> -0.333316).  Saving model ...
Epoch: 5 cost time: 1.2612125873565674
Epoch: 5, Steps: 2 | Train Loss: 1.772 Vali Loss: 1.771 Vali Acc: 0.333 Test Loss: 1.771 Test Acc: 0.333
Validation loss decreased (-0.333316 --> -0.333316).  Saving model ...
Epoch: 6 cost time: 1.3384606838226318
Epoch: 6, Steps: 2 | Train Loss: 1.765 Vali Loss: 1.764 Vali Acc: 0.393 Test Loss: 1.764 Test Acc: 0.393
Validation loss decreased (-0.333316 --> -0.392575).  Saving model ...
Epoch: 7 cost time: 1.0642249584197998
Epoch: 7, Steps: 2 | Train Loss: 1.756 Vali Loss: 1.756 Vali Acc: 0.537 Test Loss: 1.756 Test Acc: 0.537
Validation loss decreased (-0.392575 --> -0.537019).  Saving model ...
Epoch: 8 cost time: 1.13899827003479
Epoch: 8, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.747 Vali Acc: 0.596 Test Loss: 1.747 Test Acc: 0.596
Validation loss decreased (-0.537019 --> -0.596279).  Saving model ...
Epoch: 9 cost time: 1.0701770782470703
Epoch: 9, Steps: 2 | Train Loss: 1.734 Vali Loss: 1.737 Vali Acc: 0.644 Test Loss: 1.737 Test Acc: 0.644
Validation loss decreased (-0.596279 --> -0.644427).  Saving model ...
Epoch: 10 cost time: 1.1882851123809814
Epoch: 10, Steps: 2 | Train Loss: 1.723 Vali Loss: 1.726 Vali Acc: 0.681 Test Loss: 1.726 Test Acc: 0.681
Validation loss decreased (-0.644427 --> -0.681464).  Saving model ...
Epoch: 11 cost time: 1.1757991313934326
Epoch: 11, Steps: 2 | Train Loss: 1.708 Vali Loss: 1.714 Vali Acc: 0.707 Test Loss: 1.714 Test Acc: 0.707
Validation loss decreased (-0.681464 --> -0.707390).  Saving model ...
Epoch: 12 cost time: 1.2570793628692627
Epoch: 12, Steps: 2 | Train Loss: 1.695 Vali Loss: 1.702 Vali Acc: 0.730 Test Loss: 1.702 Test Acc: 0.730
Validation loss decreased (-0.707390 --> -0.729613).  Saving model ...
Epoch: 13 cost time: 1.5423922538757324
Epoch: 13, Steps: 2 | Train Loss: 1.682 Vali Loss: 1.688 Vali Acc: 0.744 Test Loss: 1.688 Test Acc: 0.744
Validation loss decreased (-0.729613 --> -0.744428).  Saving model ...
Epoch: 14 cost time: 1.4557089805603027
Epoch: 14, Steps: 2 | Train Loss: 1.665 Vali Loss: 1.674 Vali Acc: 0.752 Test Loss: 1.674 Test Acc: 0.752
Validation loss decreased (-0.744428 --> -0.751835).  Saving model ...
Epoch: 15 cost time: 1.3445525169372559
Epoch: 15, Steps: 2 | Train Loss: 1.648 Vali Loss: 1.658 Vali Acc: 0.752 Test Loss: 1.658 Test Acc: 0.752
Validation loss decreased (-0.751835 --> -0.751835).  Saving model ...
Epoch: 16 cost time: 1.1853997707366943
Epoch: 16, Steps: 2 | Train Loss: 1.628 Vali Loss: 1.642 Vali Acc: 0.756 Test Loss: 1.642 Test Acc: 0.756
Validation loss decreased (-0.751835 --> -0.755539).  Saving model ...
Epoch: 17 cost time: 1.2076122760772705
Epoch: 17, Steps: 2 | Train Loss: 1.609 Vali Loss: 1.625 Vali Acc: 0.756 Test Loss: 1.625 Test Acc: 0.756
Validation loss decreased (-0.755539 --> -0.755539).  Saving model ...
Epoch: 18 cost time: 1.3177390098571777
Epoch: 18, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.606 Vali Acc: 0.759 Test Loss: 1.606 Test Acc: 0.759
Validation loss decreased (-0.755539 --> -0.759243).  Saving model ...
Epoch: 19 cost time: 0.7868540287017822
Epoch: 19, Steps: 2 | Train Loss: 1.561 Vali Loss: 1.587 Vali Acc: 0.763 Test Loss: 1.587 Test Acc: 0.763
Validation loss decreased (-0.759243 --> -0.762947).  Saving model ...
Epoch: 20 cost time: 0.8723030090332031
Epoch: 20, Steps: 2 | Train Loss: 1.544 Vali Loss: 1.567 Vali Acc: 0.763 Test Loss: 1.567 Test Acc: 0.763
Validation loss decreased (-0.762947 --> -0.762947).  Saving model ...
Epoch: 21 cost time: 0.7780420780181885
Epoch: 21, Steps: 2 | Train Loss: 1.517 Vali Loss: 1.545 Vali Acc: 0.774 Test Loss: 1.545 Test Acc: 0.774
Validation loss decreased (-0.762947 --> -0.774059).  Saving model ...
Epoch: 22 cost time: 1.1861770153045654
Epoch: 22, Steps: 2 | Train Loss: 1.493 Vali Loss: 1.523 Vali Acc: 0.770 Test Loss: 1.523 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3176021575927734
Epoch: 23, Steps: 2 | Train Loss: 1.461 Vali Loss: 1.499 Vali Acc: 0.774 Test Loss: 1.499 Test Acc: 0.774
Validation loss decreased (-0.774059 --> -0.774059).  Saving model ...
Epoch: 24 cost time: 1.4650733470916748
Epoch: 24, Steps: 2 | Train Loss: 1.437 Vali Loss: 1.475 Vali Acc: 0.774 Test Loss: 1.475 Test Acc: 0.774
Validation loss decreased (-0.774059 --> -0.774059).  Saving model ...
Epoch: 25 cost time: 1.7044789791107178
Epoch: 25, Steps: 2 | Train Loss: 1.410 Vali Loss: 1.449 Vali Acc: 0.770 Test Loss: 1.449 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4681084156036377
Epoch: 26, Steps: 2 | Train Loss: 1.381 Vali Loss: 1.421 Vali Acc: 0.774 Test Loss: 1.421 Test Acc: 0.774
Validation loss decreased (-0.774059 --> -0.774060).  Saving model ...
Epoch: 27 cost time: 0.9821321964263916
Epoch: 27, Steps: 2 | Train Loss: 1.347 Vali Loss: 1.394 Vali Acc: 0.774 Test Loss: 1.394 Test Acc: 0.774
Validation loss decreased (-0.774060 --> -0.774060).  Saving model ...
Epoch: 28 cost time: 1.12192702293396
Epoch: 28, Steps: 2 | Train Loss: 1.320 Vali Loss: 1.365 Vali Acc: 0.774 Test Loss: 1.365 Test Acc: 0.774
Validation loss decreased (-0.774060 --> -0.774060).  Saving model ...
Epoch: 29 cost time: 1.3797941207885742
Epoch: 29, Steps: 2 | Train Loss: 1.289 Vali Loss: 1.335 Vali Acc: 0.774 Test Loss: 1.335 Test Acc: 0.774
Validation loss decreased (-0.774060 --> -0.774061).  Saving model ...
Epoch: 30 cost time: 1.1192317008972168
Epoch: 30, Steps: 2 | Train Loss: 1.251 Vali Loss: 1.305 Vali Acc: 0.774 Test Loss: 1.305 Test Acc: 0.774
Validation loss decreased (-0.774061 --> -0.774061).  Saving model ...
Epoch: 31 cost time: 1.334155797958374
Epoch: 31, Steps: 2 | Train Loss: 1.217 Vali Loss: 1.274 Vali Acc: 0.774 Test Loss: 1.274 Test Acc: 0.774
Validation loss decreased (-0.774061 --> -0.774061).  Saving model ...
Epoch: 32 cost time: 1.1322908401489258
Epoch: 32, Steps: 2 | Train Loss: 1.179 Vali Loss: 1.243 Vali Acc: 0.774 Test Loss: 1.243 Test Acc: 0.774
Validation loss decreased (-0.774061 --> -0.774062).  Saving model ...
Epoch: 33 cost time: 1.4192719459533691
Epoch: 33, Steps: 2 | Train Loss: 1.137 Vali Loss: 1.212 Vali Acc: 0.774 Test Loss: 1.212 Test Acc: 0.774
Validation loss decreased (-0.774062 --> -0.774062).  Saving model ...
Epoch: 34 cost time: 1.387852430343628
Epoch: 34, Steps: 2 | Train Loss: 1.100 Vali Loss: 1.180 Vali Acc: 0.774 Test Loss: 1.180 Test Acc: 0.774
Validation loss decreased (-0.774062 --> -0.774062).  Saving model ...
Epoch: 35 cost time: 1.538548231124878
Epoch: 35, Steps: 2 | Train Loss: 1.069 Vali Loss: 1.149 Vali Acc: 0.774 Test Loss: 1.149 Test Acc: 0.774
Validation loss decreased (-0.774062 --> -0.774063).  Saving model ...
Epoch: 36 cost time: 1.0610337257385254
Epoch: 36, Steps: 2 | Train Loss: 1.028 Vali Loss: 1.117 Vali Acc: 0.774 Test Loss: 1.117 Test Acc: 0.774
Validation loss decreased (-0.774063 --> -0.774063).  Saving model ...
Epoch: 37 cost time: 1.0572004318237305
Epoch: 37, Steps: 2 | Train Loss: 0.994 Vali Loss: 1.086 Vali Acc: 0.778 Test Loss: 1.086 Test Acc: 0.778
Validation loss decreased (-0.774063 --> -0.777767).  Saving model ...
Epoch: 38 cost time: 1.1400508880615234
Epoch: 38, Steps: 2 | Train Loss: 0.963 Vali Loss: 1.054 Vali Acc: 0.778 Test Loss: 1.054 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 39 cost time: 1.3697829246520996
Epoch: 39, Steps: 2 | Train Loss: 0.925 Vali Loss: 1.024 Vali Acc: 0.778 Test Loss: 1.024 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777768).  Saving model ...
Epoch: 40 cost time: 1.3290293216705322
Epoch: 40, Steps: 2 | Train Loss: 0.893 Vali Loss: 0.994 Vali Acc: 0.785 Test Loss: 0.994 Test Acc: 0.785
Validation loss decreased (-0.777768 --> -0.785175).  Saving model ...
Epoch: 41 cost time: 1.4014642238616943
Epoch: 41, Steps: 2 | Train Loss: 0.854 Vali Loss: 0.965 Vali Acc: 0.785 Test Loss: 0.965 Test Acc: 0.785
Validation loss decreased (-0.785175 --> -0.785176).  Saving model ...
Epoch: 42 cost time: 1.2018210887908936
Epoch: 42, Steps: 2 | Train Loss: 0.816 Vali Loss: 0.936 Vali Acc: 0.785 Test Loss: 0.936 Test Acc: 0.785
Validation loss decreased (-0.785176 --> -0.785176).  Saving model ...
Epoch: 43 cost time: 1.257476806640625
Epoch: 43, Steps: 2 | Train Loss: 0.782 Vali Loss: 0.908 Vali Acc: 0.789 Test Loss: 0.908 Test Acc: 0.789
Validation loss decreased (-0.785176 --> -0.788880).  Saving model ...
Epoch: 44 cost time: 1.4243690967559814
Epoch: 44, Steps: 2 | Train Loss: 0.759 Vali Loss: 0.881 Vali Acc: 0.796 Test Loss: 0.881 Test Acc: 0.796
Validation loss decreased (-0.788880 --> -0.796287).  Saving model ...
Epoch: 45 cost time: 1.1983599662780762
Epoch: 45, Steps: 2 | Train Loss: 0.725 Vali Loss: 0.855 Vali Acc: 0.800 Test Loss: 0.855 Test Acc: 0.800
Validation loss decreased (-0.796287 --> -0.799991).  Saving model ...
Epoch: 46 cost time: 1.1872990131378174
Epoch: 46, Steps: 2 | Train Loss: 0.697 Vali Loss: 0.829 Vali Acc: 0.800 Test Loss: 0.829 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 47 cost time: 1.2365837097167969
Epoch: 47, Steps: 2 | Train Loss: 0.666 Vali Loss: 0.805 Vali Acc: 0.807 Test Loss: 0.805 Test Acc: 0.807
Validation loss decreased (-0.799992 --> -0.807399).  Saving model ...
Epoch: 48 cost time: 1.4264273643493652
Epoch: 48, Steps: 2 | Train Loss: 0.636 Vali Loss: 0.782 Vali Acc: 0.807 Test Loss: 0.782 Test Acc: 0.807
Validation loss decreased (-0.807399 --> -0.807400).  Saving model ...
Epoch: 49 cost time: 1.285247802734375
Epoch: 49, Steps: 2 | Train Loss: 0.611 Vali Loss: 0.759 Vali Acc: 0.807 Test Loss: 0.759 Test Acc: 0.807
Validation loss decreased (-0.807400 --> -0.807400).  Saving model ...
Epoch: 50 cost time: 0.9734852313995361
Epoch: 50, Steps: 2 | Train Loss: 0.589 Vali Loss: 0.738 Vali Acc: 0.822 Test Loss: 0.738 Test Acc: 0.822
Validation loss decreased (-0.807400 --> -0.822215).  Saving model ...
Epoch: 51 cost time: 1.2862300872802734
Epoch: 51, Steps: 2 | Train Loss: 0.554 Vali Loss: 0.717 Vali Acc: 0.826 Test Loss: 0.717 Test Acc: 0.826
Validation loss decreased (-0.822215 --> -0.825919).  Saving model ...
Epoch: 52 cost time: 1.204186201095581
Epoch: 52, Steps: 2 | Train Loss: 0.541 Vali Loss: 0.698 Vali Acc: 0.833 Test Loss: 0.698 Test Acc: 0.833
Validation loss decreased (-0.825919 --> -0.833326).  Saving model ...
Epoch: 53 cost time: 1.2376551628112793
Epoch: 53, Steps: 2 | Train Loss: 0.514 Vali Loss: 0.679 Vali Acc: 0.844 Test Loss: 0.679 Test Acc: 0.844
Validation loss decreased (-0.833326 --> -0.844438).  Saving model ...
Epoch: 54 cost time: 1.2621114253997803
Epoch: 54, Steps: 2 | Train Loss: 0.490 Vali Loss: 0.661 Vali Acc: 0.844 Test Loss: 0.661 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 55 cost time: 0.9957668781280518
Epoch: 55, Steps: 2 | Train Loss: 0.475 Vali Loss: 0.644 Vali Acc: 0.852 Test Loss: 0.644 Test Acc: 0.852
Validation loss decreased (-0.844438 --> -0.851845).  Saving model ...
Epoch: 56 cost time: 1.1346580982208252
Epoch: 56, Steps: 2 | Train Loss: 0.450 Vali Loss: 0.628 Vali Acc: 0.856 Test Loss: 0.628 Test Acc: 0.856
Validation loss decreased (-0.851845 --> -0.855549).  Saving model ...
Epoch: 57 cost time: 0.9684088230133057
Epoch: 57, Steps: 2 | Train Loss: 0.437 Vali Loss: 0.613 Vali Acc: 0.863 Test Loss: 0.613 Test Acc: 0.863
Validation loss decreased (-0.855549 --> -0.862957).  Saving model ...
Epoch: 58 cost time: 1.2642436027526855
Epoch: 58, Steps: 2 | Train Loss: 0.419 Vali Loss: 0.598 Vali Acc: 0.867 Test Loss: 0.598 Test Acc: 0.867
Validation loss decreased (-0.862957 --> -0.866661).  Saving model ...
Epoch: 59 cost time: 1.0539922714233398
Epoch: 59, Steps: 2 | Train Loss: 0.408 Vali Loss: 0.585 Vali Acc: 0.867 Test Loss: 0.585 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 60 cost time: 1.1724131107330322
Epoch: 60, Steps: 2 | Train Loss: 0.388 Vali Loss: 0.572 Vali Acc: 0.867 Test Loss: 0.572 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 61 cost time: 1.173501968383789
Epoch: 61, Steps: 2 | Train Loss: 0.371 Vali Loss: 0.559 Vali Acc: 0.878 Test Loss: 0.559 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877772).  Saving model ...
Epoch: 62 cost time: 1.0435738563537598
Epoch: 62, Steps: 2 | Train Loss: 0.363 Vali Loss: 0.548 Vali Acc: 0.881 Test Loss: 0.548 Test Acc: 0.881
Validation loss decreased (-0.877772 --> -0.881476).  Saving model ...
Epoch: 63 cost time: 1.1377205848693848
Epoch: 63, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.537 Vali Acc: 0.878 Test Loss: 0.537 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.103691816329956
Epoch: 64, Steps: 2 | Train Loss: 0.329 Vali Loss: 0.526 Vali Acc: 0.881 Test Loss: 0.526 Test Acc: 0.881
Validation loss decreased (-0.881476 --> -0.881476).  Saving model ...
Epoch: 65 cost time: 0.8202962875366211
Epoch: 65, Steps: 2 | Train Loss: 0.321 Vali Loss: 0.516 Vali Acc: 0.881 Test Loss: 0.516 Test Acc: 0.881
Validation loss decreased (-0.881476 --> -0.881476).  Saving model ...
Epoch: 66 cost time: 1.1561808586120605
Epoch: 66, Steps: 2 | Train Loss: 0.312 Vali Loss: 0.507 Vali Acc: 0.885 Test Loss: 0.507 Test Acc: 0.885
Validation loss decreased (-0.881476 --> -0.885180).  Saving model ...
Epoch: 67 cost time: 1.3539032936096191
Epoch: 67, Steps: 2 | Train Loss: 0.299 Vali Loss: 0.498 Vali Acc: 0.885 Test Loss: 0.498 Test Acc: 0.885
Validation loss decreased (-0.885180 --> -0.885180).  Saving model ...
Epoch: 68 cost time: 1.3603994846343994
Epoch: 68, Steps: 2 | Train Loss: 0.288 Vali Loss: 0.489 Vali Acc: 0.885 Test Loss: 0.489 Test Acc: 0.885
Validation loss decreased (-0.885180 --> -0.885180).  Saving model ...
Epoch: 69 cost time: 1.0297045707702637
Epoch: 69, Steps: 2 | Train Loss: 0.281 Vali Loss: 0.481 Vali Acc: 0.885 Test Loss: 0.481 Test Acc: 0.885
Validation loss decreased (-0.885180 --> -0.885180).  Saving model ...
Epoch: 70 cost time: 1.3619422912597656
Epoch: 70, Steps: 2 | Train Loss: 0.274 Vali Loss: 0.473 Vali Acc: 0.885 Test Loss: 0.473 Test Acc: 0.885
Validation loss decreased (-0.885180 --> -0.885180).  Saving model ...
Epoch: 71 cost time: 0.8356821537017822
Epoch: 71, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.466 Vali Acc: 0.885 Test Loss: 0.466 Test Acc: 0.885
Validation loss decreased (-0.885180 --> -0.885181).  Saving model ...
Epoch: 72 cost time: 1.1530601978302002
Epoch: 72, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.459 Vali Acc: 0.885 Test Loss: 0.459 Test Acc: 0.885
Validation loss decreased (-0.885181 --> -0.885181).  Saving model ...
Epoch: 73 cost time: 1.0232346057891846
Epoch: 73, Steps: 2 | Train Loss: 0.241 Vali Loss: 0.452 Vali Acc: 0.881 Test Loss: 0.452 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.5004498958587646
Epoch: 74, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.446 Vali Acc: 0.881 Test Loss: 0.446 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.7801637649536133
Epoch: 75, Steps: 2 | Train Loss: 0.226 Vali Loss: 0.439 Vali Acc: 0.885 Test Loss: 0.439 Test Acc: 0.885
Validation loss decreased (-0.885181 --> -0.885181).  Saving model ...
Epoch: 76 cost time: 0.980363130569458
Epoch: 76, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.433 Vali Acc: 0.885 Test Loss: 0.433 Test Acc: 0.885
Validation loss decreased (-0.885181 --> -0.885181).  Saving model ...
Epoch: 77 cost time: 1.117588758468628
Epoch: 77, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.427 Vali Acc: 0.885 Test Loss: 0.427 Test Acc: 0.885
Validation loss decreased (-0.885181 --> -0.885181).  Saving model ...
Epoch: 78 cost time: 1.1566407680511475
Epoch: 78, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.422 Vali Acc: 0.885 Test Loss: 0.422 Test Acc: 0.885
Validation loss decreased (-0.885181 --> -0.885181).  Saving model ...
Epoch: 79 cost time: 1.1240670680999756
Epoch: 79, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.416 Vali Acc: 0.885 Test Loss: 0.416 Test Acc: 0.885
Validation loss decreased (-0.885181 --> -0.885181).  Saving model ...
Epoch: 80 cost time: 1.0557286739349365
Epoch: 80, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.411 Vali Acc: 0.889 Test Loss: 0.411 Test Acc: 0.889
Validation loss decreased (-0.885181 --> -0.888885).  Saving model ...
Epoch: 81 cost time: 0.9919860363006592
Epoch: 81, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.406 Vali Acc: 0.885 Test Loss: 0.406 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 1.2463293075561523
Epoch: 82, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.402 Vali Acc: 0.885 Test Loss: 0.402 Test Acc: 0.885
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 1.0902817249298096
Epoch: 83, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.397 Vali Acc: 0.885 Test Loss: 0.397 Test Acc: 0.885
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 1.0175981521606445
Epoch: 84, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.393 Vali Acc: 0.885 Test Loss: 0.393 Test Acc: 0.885
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 0.9197065830230713
Epoch: 85, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.388 Vali Acc: 0.889 Test Loss: 0.388 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 86 cost time: 0.9836831092834473
Epoch: 86, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.384 Vali Acc: 0.885 Test Loss: 0.384 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 1.1650545597076416
Epoch: 87, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.380 Vali Acc: 0.885 Test Loss: 0.380 Test Acc: 0.885
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 1.041593074798584
Epoch: 88, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.376 Vali Acc: 0.885 Test Loss: 0.376 Test Acc: 0.885
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 0.9206998348236084
Epoch: 89, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.373 Vali Acc: 0.885 Test Loss: 0.373 Test Acc: 0.885
EarlyStopping counter: 4 out of 10
Epoch: 90 cost time: 1.030651330947876
Epoch: 90, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.369 Vali Acc: 0.885 Test Loss: 0.369 Test Acc: 0.885
EarlyStopping counter: 5 out of 10
Epoch: 91 cost time: 1.1180405616760254
Epoch: 91, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.366 Vali Acc: 0.881 Test Loss: 0.366 Test Acc: 0.881
EarlyStopping counter: 6 out of 10
Epoch: 92 cost time: 1.0458984375
Epoch: 92, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.363 Vali Acc: 0.881 Test Loss: 0.363 Test Acc: 0.881
EarlyStopping counter: 7 out of 10
Epoch: 93 cost time: 0.9815022945404053
Epoch: 93, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.359 Vali Acc: 0.881 Test Loss: 0.359 Test Acc: 0.881
EarlyStopping counter: 8 out of 10
Epoch: 94 cost time: 1.2251694202423096
Epoch: 94, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.356 Vali Acc: 0.881 Test Loss: 0.356 Test Acc: 0.881
EarlyStopping counter: 9 out of 10
Epoch: 95 cost time: 1.086857557296753
Epoch: 95, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.354 Vali Acc: 0.881 Test Loss: 0.354 Test Acc: 0.881
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_DLinear_UEA_ftM_sl65_ll0_pl0_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8888888888888888
model parameter : 10146
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         4                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_DLinear_UEA_ftM_sl65_ll0_pl0_ma4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.6014697551727295
Epoch: 1, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.789 Vali Acc: 0.167 Test Loss: 1.789 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 0.8527998924255371
Epoch: 2, Steps: 2 | Train Loss: 1.787 Vali Loss: 1.785 Vali Acc: 0.167 Test Loss: 1.785 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 1.141789197921753
Epoch: 3, Steps: 2 | Train Loss: 1.782 Vali Loss: 1.781 Vali Acc: 0.333 Test Loss: 1.781 Test Acc: 0.333
Validation loss decreased (-0.166649 --> -0.333316).  Saving model ...
Epoch: 4 cost time: 1.1272087097167969
Epoch: 4, Steps: 2 | Train Loss: 1.779 Vali Loss: 1.776 Vali Acc: 0.333 Test Loss: 1.776 Test Acc: 0.333
Validation loss decreased (-0.333316 --> -0.333316).  Saving model ...
Epoch: 5 cost time: 1.0475044250488281
Epoch: 5, Steps: 2 | Train Loss: 1.771 Vali Loss: 1.770 Vali Acc: 0.333 Test Loss: 1.770 Test Acc: 0.333
Validation loss decreased (-0.333316 --> -0.333316).  Saving model ...
Epoch: 6 cost time: 1.0350768566131592
Epoch: 6, Steps: 2 | Train Loss: 1.764 Vali Loss: 1.763 Vali Acc: 0.426 Test Loss: 1.763 Test Acc: 0.426
Validation loss decreased (-0.333316 --> -0.425908).  Saving model ...
Epoch: 7 cost time: 1.1069023609161377
Epoch: 7, Steps: 2 | Train Loss: 1.755 Vali Loss: 1.755 Vali Acc: 0.552 Test Loss: 1.755 Test Acc: 0.552
Validation loss decreased (-0.425908 --> -0.551834).  Saving model ...
Epoch: 8 cost time: 1.0803234577178955
Epoch: 8, Steps: 2 | Train Loss: 1.745 Vali Loss: 1.745 Vali Acc: 0.619 Test Loss: 1.745 Test Acc: 0.619
Validation loss decreased (-0.551834 --> -0.618501).  Saving model ...
Epoch: 9 cost time: 0.9185113906860352
Epoch: 9, Steps: 2 | Train Loss: 1.733 Vali Loss: 1.735 Vali Acc: 0.663 Test Loss: 1.735 Test Acc: 0.663
Validation loss decreased (-0.618501 --> -0.662946).  Saving model ...
Epoch: 10 cost time: 0.9904766082763672
Epoch: 10, Steps: 2 | Train Loss: 1.722 Vali Loss: 1.724 Vali Acc: 0.693 Test Loss: 1.724 Test Acc: 0.693
Validation loss decreased (-0.662946 --> -0.692575).  Saving model ...
Epoch: 11 cost time: 0.9927012920379639
Epoch: 11, Steps: 2 | Train Loss: 1.707 Vali Loss: 1.712 Vali Acc: 0.730 Test Loss: 1.712 Test Acc: 0.730
Validation loss decreased (-0.692575 --> -0.729613).  Saving model ...
Epoch: 12 cost time: 0.9843239784240723
Epoch: 12, Steps: 2 | Train Loss: 1.694 Vali Loss: 1.699 Vali Acc: 0.741 Test Loss: 1.699 Test Acc: 0.741
Validation loss decreased (-0.729613 --> -0.740724).  Saving model ...
Epoch: 13 cost time: 1.3184986114501953
Epoch: 13, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.685 Vali Acc: 0.756 Test Loss: 1.685 Test Acc: 0.756
Validation loss decreased (-0.740724 --> -0.755539).  Saving model ...
Epoch: 14 cost time: 1.3427395820617676
Epoch: 14, Steps: 2 | Train Loss: 1.663 Vali Loss: 1.670 Vali Acc: 0.756 Test Loss: 1.670 Test Acc: 0.756
Validation loss decreased (-0.755539 --> -0.755539).  Saving model ...
Epoch: 15 cost time: 0.9468584060668945
Epoch: 15, Steps: 2 | Train Loss: 1.647 Vali Loss: 1.654 Vali Acc: 0.763 Test Loss: 1.654 Test Acc: 0.763
Validation loss decreased (-0.755539 --> -0.762946).  Saving model ...
Epoch: 16 cost time: 0.9495394229888916
Epoch: 16, Steps: 2 | Train Loss: 1.626 Vali Loss: 1.638 Vali Acc: 0.763 Test Loss: 1.638 Test Acc: 0.763
Validation loss decreased (-0.762946 --> -0.762947).  Saving model ...
Epoch: 17 cost time: 0.8297181129455566
Epoch: 17, Steps: 2 | Train Loss: 1.607 Vali Loss: 1.620 Vali Acc: 0.767 Test Loss: 1.620 Test Acc: 0.767
Validation loss decreased (-0.762947 --> -0.766650).  Saving model ...
Epoch: 18 cost time: 1.4747238159179688
Epoch: 18, Steps: 2 | Train Loss: 1.586 Vali Loss: 1.601 Vali Acc: 0.767 Test Loss: 1.601 Test Acc: 0.767
Validation loss decreased (-0.766650 --> -0.766651).  Saving model ...
Epoch: 19 cost time: 0.8202717304229736
Epoch: 19, Steps: 2 | Train Loss: 1.559 Vali Loss: 1.581 Vali Acc: 0.767 Test Loss: 1.581 Test Acc: 0.767
Validation loss decreased (-0.766651 --> -0.766651).  Saving model ...
Epoch: 20 cost time: 1.027886152267456
Epoch: 20, Steps: 2 | Train Loss: 1.541 Vali Loss: 1.561 Vali Acc: 0.767 Test Loss: 1.561 Test Acc: 0.767
Validation loss decreased (-0.766651 --> -0.766651).  Saving model ...
Epoch: 21 cost time: 1.0902814865112305
Epoch: 21, Steps: 2 | Train Loss: 1.514 Vali Loss: 1.539 Vali Acc: 0.767 Test Loss: 1.539 Test Acc: 0.767
Validation loss decreased (-0.766651 --> -0.766651).  Saving model ...
Epoch: 22 cost time: 0.8812487125396729
Epoch: 22, Steps: 2 | Train Loss: 1.490 Vali Loss: 1.516 Vali Acc: 0.770 Test Loss: 1.516 Test Acc: 0.770
Validation loss decreased (-0.766651 --> -0.770355).  Saving model ...
Epoch: 23 cost time: 1.0220270156860352
Epoch: 23, Steps: 2 | Train Loss: 1.457 Vali Loss: 1.491 Vali Acc: 0.767 Test Loss: 1.491 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.373668909072876
Epoch: 24, Steps: 2 | Train Loss: 1.433 Vali Loss: 1.466 Vali Acc: 0.770 Test Loss: 1.466 Test Acc: 0.770
Validation loss decreased (-0.770355 --> -0.770356).  Saving model ...
Epoch: 25 cost time: 1.0708327293395996
Epoch: 25, Steps: 2 | Train Loss: 1.406 Vali Loss: 1.440 Vali Acc: 0.770 Test Loss: 1.440 Test Acc: 0.770
Validation loss decreased (-0.770356 --> -0.770356).  Saving model ...
Epoch: 26 cost time: 1.100294589996338
Epoch: 26, Steps: 2 | Train Loss: 1.377 Vali Loss: 1.412 Vali Acc: 0.770 Test Loss: 1.412 Test Acc: 0.770
Validation loss decreased (-0.770356 --> -0.770356).  Saving model ...
Epoch: 27 cost time: 1.069620132446289
Epoch: 27, Steps: 2 | Train Loss: 1.342 Vali Loss: 1.383 Vali Acc: 0.774 Test Loss: 1.383 Test Acc: 0.774
Validation loss decreased (-0.770356 --> -0.774060).  Saving model ...
Epoch: 28 cost time: 0.8957090377807617
Epoch: 28, Steps: 2 | Train Loss: 1.316 Vali Loss: 1.354 Vali Acc: 0.774 Test Loss: 1.354 Test Acc: 0.774
Validation loss decreased (-0.774060 --> -0.774061).  Saving model ...
Epoch: 29 cost time: 1.096923589706421
Epoch: 29, Steps: 2 | Train Loss: 1.284 Vali Loss: 1.324 Vali Acc: 0.774 Test Loss: 1.324 Test Acc: 0.774
Validation loss decreased (-0.774061 --> -0.774061).  Saving model ...
Epoch: 30 cost time: 1.0947535037994385
Epoch: 30, Steps: 2 | Train Loss: 1.246 Vali Loss: 1.293 Vali Acc: 0.770 Test Loss: 1.293 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9388952255249023
Epoch: 31, Steps: 2 | Train Loss: 1.211 Vali Loss: 1.262 Vali Acc: 0.774 Test Loss: 1.262 Test Acc: 0.774
Validation loss decreased (-0.774061 --> -0.774061).  Saving model ...
Epoch: 32 cost time: 0.9963552951812744
Epoch: 32, Steps: 2 | Train Loss: 1.173 Vali Loss: 1.230 Vali Acc: 0.774 Test Loss: 1.230 Test Acc: 0.774
Validation loss decreased (-0.774061 --> -0.774062).  Saving model ...
Epoch: 33 cost time: 0.898047924041748
Epoch: 33, Steps: 2 | Train Loss: 1.131 Vali Loss: 1.198 Vali Acc: 0.778 Test Loss: 1.198 Test Acc: 0.778
Validation loss decreased (-0.774062 --> -0.777766).  Saving model ...
Epoch: 34 cost time: 0.9396095275878906
Epoch: 34, Steps: 2 | Train Loss: 1.094 Vali Loss: 1.166 Vali Acc: 0.774 Test Loss: 1.166 Test Acc: 0.774
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.4839444160461426
Epoch: 35, Steps: 2 | Train Loss: 1.063 Vali Loss: 1.134 Vali Acc: 0.774 Test Loss: 1.134 Test Acc: 0.774
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.093027114868164
Epoch: 36, Steps: 2 | Train Loss: 1.022 Vali Loss: 1.102 Vali Acc: 0.778 Test Loss: 1.102 Test Acc: 0.778
Validation loss decreased (-0.777766 --> -0.777767).  Saving model ...
Epoch: 37 cost time: 0.94873046875
Epoch: 37, Steps: 2 | Train Loss: 0.988 Vali Loss: 1.071 Vali Acc: 0.781 Test Loss: 1.071 Test Acc: 0.781
Validation loss decreased (-0.777767 --> -0.781471).  Saving model ...
Epoch: 38 cost time: 1.0077953338623047
Epoch: 38, Steps: 2 | Train Loss: 0.957 Vali Loss: 1.039 Vali Acc: 0.781 Test Loss: 1.039 Test Acc: 0.781
Validation loss decreased (-0.781471 --> -0.781471).  Saving model ...
Epoch: 39 cost time: 1.1946072578430176
Epoch: 39, Steps: 2 | Train Loss: 0.919 Vali Loss: 1.008 Vali Acc: 0.789 Test Loss: 1.008 Test Acc: 0.789
Validation loss decreased (-0.781471 --> -0.788879).  Saving model ...
Epoch: 40 cost time: 1.2198593616485596
Epoch: 40, Steps: 2 | Train Loss: 0.887 Vali Loss: 0.978 Vali Acc: 0.785 Test Loss: 0.978 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.4518601894378662
Epoch: 41, Steps: 2 | Train Loss: 0.848 Vali Loss: 0.949 Vali Acc: 0.793 Test Loss: 0.949 Test Acc: 0.793
Validation loss decreased (-0.788879 --> -0.792583).  Saving model ...
Epoch: 42 cost time: 0.9391982555389404
Epoch: 42, Steps: 2 | Train Loss: 0.810 Vali Loss: 0.920 Vali Acc: 0.793 Test Loss: 0.920 Test Acc: 0.793
Validation loss decreased (-0.792583 --> -0.792583).  Saving model ...
Epoch: 43 cost time: 0.9578225612640381
Epoch: 43, Steps: 2 | Train Loss: 0.776 Vali Loss: 0.892 Vali Acc: 0.793 Test Loss: 0.892 Test Acc: 0.793
Validation loss decreased (-0.792583 --> -0.792584).  Saving model ...
Epoch: 44 cost time: 1.3357772827148438
Epoch: 44, Steps: 2 | Train Loss: 0.754 Vali Loss: 0.864 Vali Acc: 0.800 Test Loss: 0.864 Test Acc: 0.800
Validation loss decreased (-0.792584 --> -0.799991).  Saving model ...
Epoch: 45 cost time: 1.2098989486694336
Epoch: 45, Steps: 2 | Train Loss: 0.720 Vali Loss: 0.838 Vali Acc: 0.804 Test Loss: 0.838 Test Acc: 0.804
Validation loss decreased (-0.799991 --> -0.803695).  Saving model ...
Epoch: 46 cost time: 1.0741324424743652
Epoch: 46, Steps: 2 | Train Loss: 0.692 Vali Loss: 0.813 Vali Acc: 0.811 Test Loss: 0.813 Test Acc: 0.811
Validation loss decreased (-0.803695 --> -0.811103).  Saving model ...
Epoch: 47 cost time: 1.3539931774139404
Epoch: 47, Steps: 2 | Train Loss: 0.662 Vali Loss: 0.789 Vali Acc: 0.819 Test Loss: 0.789 Test Acc: 0.819
Validation loss decreased (-0.811103 --> -0.818511).  Saving model ...
Epoch: 48 cost time: 1.0351331233978271
Epoch: 48, Steps: 2 | Train Loss: 0.632 Vali Loss: 0.765 Vali Acc: 0.822 Test Loss: 0.765 Test Acc: 0.822
Validation loss decreased (-0.818511 --> -0.822215).  Saving model ...
Epoch: 49 cost time: 1.0776801109313965
Epoch: 49, Steps: 2 | Train Loss: 0.607 Vali Loss: 0.743 Vali Acc: 0.826 Test Loss: 0.743 Test Acc: 0.826
Validation loss decreased (-0.822215 --> -0.825918).  Saving model ...
Epoch: 50 cost time: 1.0473659038543701
Epoch: 50, Steps: 2 | Train Loss: 0.585 Vali Loss: 0.722 Vali Acc: 0.826 Test Loss: 0.722 Test Acc: 0.826
Validation loss decreased (-0.825918 --> -0.825919).  Saving model ...
Epoch: 51 cost time: 0.906848669052124
Epoch: 51, Steps: 2 | Train Loss: 0.551 Vali Loss: 0.701 Vali Acc: 0.837 Test Loss: 0.701 Test Acc: 0.837
Validation loss decreased (-0.825919 --> -0.837030).  Saving model ...
Epoch: 52 cost time: 0.8428101539611816
Epoch: 52, Steps: 2 | Train Loss: 0.537 Vali Loss: 0.681 Vali Acc: 0.848 Test Loss: 0.681 Test Acc: 0.848
Validation loss decreased (-0.837030 --> -0.848141).  Saving model ...
Epoch: 53 cost time: 1.050926685333252
Epoch: 53, Steps: 2 | Train Loss: 0.511 Vali Loss: 0.663 Vali Acc: 0.856 Test Loss: 0.663 Test Acc: 0.856
Validation loss decreased (-0.848141 --> -0.855549).  Saving model ...
Epoch: 54 cost time: 0.943350076675415
Epoch: 54, Steps: 2 | Train Loss: 0.487 Vali Loss: 0.645 Vali Acc: 0.863 Test Loss: 0.645 Test Acc: 0.863
Validation loss decreased (-0.855549 --> -0.862957).  Saving model ...
Epoch: 55 cost time: 1.00538969039917
Epoch: 55, Steps: 2 | Train Loss: 0.473 Vali Loss: 0.628 Vali Acc: 0.870 Test Loss: 0.628 Test Acc: 0.870
Validation loss decreased (-0.862957 --> -0.870364).  Saving model ...
Epoch: 56 cost time: 0.9509315490722656
Epoch: 56, Steps: 2 | Train Loss: 0.447 Vali Loss: 0.612 Vali Acc: 0.870 Test Loss: 0.612 Test Acc: 0.870
Validation loss decreased (-0.870364 --> -0.870364).  Saving model ...
Epoch: 57 cost time: 1.102482557296753
Epoch: 57, Steps: 2 | Train Loss: 0.434 Vali Loss: 0.597 Vali Acc: 0.878 Test Loss: 0.597 Test Acc: 0.878
Validation loss decreased (-0.870364 --> -0.877772).  Saving model ...
Epoch: 58 cost time: 0.9392116069793701
Epoch: 58, Steps: 2 | Train Loss: 0.416 Vali Loss: 0.582 Vali Acc: 0.878 Test Loss: 0.582 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 59 cost time: 1.0934934616088867
Epoch: 59, Steps: 2 | Train Loss: 0.406 Vali Loss: 0.569 Vali Acc: 0.881 Test Loss: 0.569 Test Acc: 0.881
Validation loss decreased (-0.877772 --> -0.881476).  Saving model ...
Epoch: 60 cost time: 1.177567720413208
Epoch: 60, Steps: 2 | Train Loss: 0.386 Vali Loss: 0.556 Vali Acc: 0.881 Test Loss: 0.556 Test Acc: 0.881
Validation loss decreased (-0.881476 --> -0.881476).  Saving model ...
Epoch: 61 cost time: 1.324716567993164
Epoch: 61, Steps: 2 | Train Loss: 0.368 Vali Loss: 0.544 Vali Acc: 0.881 Test Loss: 0.544 Test Acc: 0.881
Validation loss decreased (-0.881476 --> -0.881476).  Saving model ...
Epoch: 62 cost time: 0.8098323345184326
Epoch: 62, Steps: 2 | Train Loss: 0.361 Vali Loss: 0.532 Vali Acc: 0.885 Test Loss: 0.532 Test Acc: 0.885
Validation loss decreased (-0.881476 --> -0.885180).  Saving model ...
Epoch: 63 cost time: 0.9225852489471436
Epoch: 63, Steps: 2 | Train Loss: 0.342 Vali Loss: 0.521 Vali Acc: 0.885 Test Loss: 0.521 Test Acc: 0.885
Validation loss decreased (-0.885180 --> -0.885180).  Saving model ...
Epoch: 64 cost time: 0.8531877994537354
Epoch: 64, Steps: 2 | Train Loss: 0.328 Vali Loss: 0.510 Vali Acc: 0.885 Test Loss: 0.510 Test Acc: 0.885
Validation loss decreased (-0.885180 --> -0.885180).  Saving model ...
Epoch: 65 cost time: 0.9676852226257324
Epoch: 65, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.500 Vali Acc: 0.889 Test Loss: 0.500 Test Acc: 0.889
Validation loss decreased (-0.885180 --> -0.888884).  Saving model ...
Epoch: 66 cost time: 1.0025954246520996
Epoch: 66, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.490 Vali Acc: 0.889 Test Loss: 0.490 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 67 cost time: 1.0047125816345215
Epoch: 67, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.482 Vali Acc: 0.889 Test Loss: 0.482 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 68 cost time: 0.9310665130615234
Epoch: 68, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.473 Vali Acc: 0.889 Test Loss: 0.473 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 69 cost time: 0.8559901714324951
Epoch: 69, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.465 Vali Acc: 0.885 Test Loss: 0.465 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.0143561363220215
Epoch: 70, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.457 Vali Acc: 0.885 Test Loss: 0.457 Test Acc: 0.885
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 1.1004524230957031
Epoch: 71, Steps: 2 | Train Loss: 0.258 Vali Loss: 0.449 Vali Acc: 0.885 Test Loss: 0.449 Test Acc: 0.885
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 1.2576425075531006
Epoch: 72, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.442 Vali Acc: 0.885 Test Loss: 0.442 Test Acc: 0.885
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.8748805522918701
Epoch: 73, Steps: 2 | Train Loss: 0.240 Vali Loss: 0.435 Vali Acc: 0.881 Test Loss: 0.435 Test Acc: 0.881
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 0.9020950794219971
Epoch: 74, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.429 Vali Acc: 0.881 Test Loss: 0.429 Test Acc: 0.881
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 0.8688349723815918
Epoch: 75, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.423 Vali Acc: 0.885 Test Loss: 0.423 Test Acc: 0.885
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 0.760420560836792
Epoch: 76, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.416 Vali Acc: 0.885 Test Loss: 0.416 Test Acc: 0.885
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 0.9191069602966309
Epoch: 77, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.411 Vali Acc: 0.885 Test Loss: 0.411 Test Acc: 0.885
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 0.771831750869751
Epoch: 78, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.405 Vali Acc: 0.885 Test Loss: 0.405 Test Acc: 0.885
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_DLinear_UEA_ftM_sl65_ll0_pl0_ma4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8888888888888888
model parameter : 10146
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_DLinear_UEA_ftM_sl65_ll0_pl0_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.9809165000915527
Epoch: 1, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.789 Vali Acc: 0.167 Test Loss: 1.789 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 1.0831718444824219
Epoch: 2, Steps: 2 | Train Loss: 1.787 Vali Loss: 1.785 Vali Acc: 0.167 Test Loss: 1.785 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 1.0446503162384033
Epoch: 3, Steps: 2 | Train Loss: 1.782 Vali Loss: 1.781 Vali Acc: 0.333 Test Loss: 1.781 Test Acc: 0.333
Validation loss decreased (-0.166649 --> -0.333316).  Saving model ...
Epoch: 4 cost time: 1.245283842086792
Epoch: 4, Steps: 2 | Train Loss: 1.779 Vali Loss: 1.777 Vali Acc: 0.333 Test Loss: 1.777 Test Acc: 0.333
Validation loss decreased (-0.333316 --> -0.333316).  Saving model ...
Epoch: 5 cost time: 1.0569169521331787
Epoch: 5, Steps: 2 | Train Loss: 1.771 Vali Loss: 1.771 Vali Acc: 0.333 Test Loss: 1.771 Test Acc: 0.333
Validation loss decreased (-0.333316 --> -0.333316).  Saving model ...
Epoch: 6 cost time: 0.8042387962341309
Epoch: 6, Steps: 2 | Train Loss: 1.765 Vali Loss: 1.764 Vali Acc: 0.400 Test Loss: 1.764 Test Acc: 0.400
Validation loss decreased (-0.333316 --> -0.399982).  Saving model ...
Epoch: 7 cost time: 0.8145899772644043
Epoch: 7, Steps: 2 | Train Loss: 1.756 Vali Loss: 1.756 Vali Acc: 0.537 Test Loss: 1.756 Test Acc: 0.537
Validation loss decreased (-0.399982 --> -0.537019).  Saving model ...
Epoch: 8 cost time: 0.8727619647979736
Epoch: 8, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.747 Vali Acc: 0.607 Test Loss: 1.747 Test Acc: 0.607
Validation loss decreased (-0.537019 --> -0.607390).  Saving model ...
Epoch: 9 cost time: 0.7808454036712646
Epoch: 9, Steps: 2 | Train Loss: 1.735 Vali Loss: 1.737 Vali Acc: 0.656 Test Loss: 1.737 Test Acc: 0.656
Validation loss decreased (-0.607390 --> -0.655538).  Saving model ...
Epoch: 10 cost time: 0.7629940509796143
Epoch: 10, Steps: 2 | Train Loss: 1.725 Vali Loss: 1.726 Vali Acc: 0.685 Test Loss: 1.726 Test Acc: 0.685
Validation loss decreased (-0.655538 --> -0.685168).  Saving model ...
Epoch: 11 cost time: 0.7782206535339355
Epoch: 11, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.714 Vali Acc: 0.715 Test Loss: 1.714 Test Acc: 0.715
Validation loss decreased (-0.685168 --> -0.714798).  Saving model ...
Epoch: 12 cost time: 0.7810568809509277
Epoch: 12, Steps: 2 | Train Loss: 1.697 Vali Loss: 1.702 Vali Acc: 0.737 Test Loss: 1.702 Test Acc: 0.737
Validation loss decreased (-0.714798 --> -0.737020).  Saving model ...
Epoch: 13 cost time: 0.7806434631347656
Epoch: 13, Steps: 2 | Train Loss: 1.685 Vali Loss: 1.688 Vali Acc: 0.759 Test Loss: 1.688 Test Acc: 0.759
Validation loss decreased (-0.737020 --> -0.759242).  Saving model ...
Epoch: 14 cost time: 1.083740234375
Epoch: 14, Steps: 2 | Train Loss: 1.668 Vali Loss: 1.674 Vali Acc: 0.759 Test Loss: 1.674 Test Acc: 0.759
Validation loss decreased (-0.759242 --> -0.759243).  Saving model ...
Epoch: 15 cost time: 0.9083287715911865
Epoch: 15, Steps: 2 | Train Loss: 1.652 Vali Loss: 1.658 Vali Acc: 0.759 Test Loss: 1.658 Test Acc: 0.759
Validation loss decreased (-0.759243 --> -0.759243).  Saving model ...
Epoch: 16 cost time: 0.8749804496765137
Epoch: 16, Steps: 2 | Train Loss: 1.632 Vali Loss: 1.642 Vali Acc: 0.759 Test Loss: 1.642 Test Acc: 0.759
Validation loss decreased (-0.759243 --> -0.759243).  Saving model ...
Epoch: 17 cost time: 0.890955924987793
Epoch: 17, Steps: 2 | Train Loss: 1.614 Vali Loss: 1.625 Vali Acc: 0.759 Test Loss: 1.625 Test Acc: 0.759
Validation loss decreased (-0.759243 --> -0.759243).  Saving model ...
Epoch: 18 cost time: 0.6880247592926025
Epoch: 18, Steps: 2 | Train Loss: 1.594 Vali Loss: 1.607 Vali Acc: 0.759 Test Loss: 1.607 Test Acc: 0.759
Validation loss decreased (-0.759243 --> -0.759243).  Saving model ...
Epoch: 19 cost time: 0.7215981483459473
Epoch: 19, Steps: 2 | Train Loss: 1.568 Vali Loss: 1.587 Vali Acc: 0.767 Test Loss: 1.587 Test Acc: 0.767
Validation loss decreased (-0.759243 --> -0.766651).  Saving model ...
Epoch: 20 cost time: 0.8858151435852051
Epoch: 20, Steps: 2 | Train Loss: 1.550 Vali Loss: 1.567 Vali Acc: 0.770 Test Loss: 1.567 Test Acc: 0.770
Validation loss decreased (-0.766651 --> -0.770355).  Saving model ...
Epoch: 21 cost time: 0.9365711212158203
Epoch: 21, Steps: 2 | Train Loss: 1.525 Vali Loss: 1.546 Vali Acc: 0.778 Test Loss: 1.546 Test Acc: 0.778
Validation loss decreased (-0.770355 --> -0.777762).  Saving model ...
Epoch: 22 cost time: 1.1593658924102783
Epoch: 22, Steps: 2 | Train Loss: 1.501 Vali Loss: 1.523 Vali Acc: 0.774 Test Loss: 1.523 Test Acc: 0.774
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1566710472106934
Epoch: 23, Steps: 2 | Train Loss: 1.469 Vali Loss: 1.500 Vali Acc: 0.774 Test Loss: 1.500 Test Acc: 0.774
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8035459518432617
Epoch: 24, Steps: 2 | Train Loss: 1.446 Vali Loss: 1.475 Vali Acc: 0.774 Test Loss: 1.475 Test Acc: 0.774
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.728830099105835
Epoch: 25, Steps: 2 | Train Loss: 1.420 Vali Loss: 1.449 Vali Acc: 0.778 Test Loss: 1.449 Test Acc: 0.778
Validation loss decreased (-0.777762 --> -0.777763).  Saving model ...
Epoch: 26 cost time: 0.7423326969146729
Epoch: 26, Steps: 2 | Train Loss: 1.391 Vali Loss: 1.422 Vali Acc: 0.774 Test Loss: 1.422 Test Acc: 0.774
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8646655082702637
Epoch: 27, Steps: 2 | Train Loss: 1.358 Vali Loss: 1.394 Vali Acc: 0.774 Test Loss: 1.394 Test Acc: 0.774
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8451235294342041
Epoch: 28, Steps: 2 | Train Loss: 1.332 Vali Loss: 1.365 Vali Acc: 0.774 Test Loss: 1.365 Test Acc: 0.774
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7946531772613525
Epoch: 29, Steps: 2 | Train Loss: 1.302 Vali Loss: 1.336 Vali Acc: 0.774 Test Loss: 1.336 Test Acc: 0.774
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0444602966308594
Epoch: 30, Steps: 2 | Train Loss: 1.265 Vali Loss: 1.306 Vali Acc: 0.770 Test Loss: 1.306 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.7690925598144531
Epoch: 31, Steps: 2 | Train Loss: 1.230 Vali Loss: 1.275 Vali Acc: 0.774 Test Loss: 1.275 Test Acc: 0.774
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.8564274311065674
Epoch: 32, Steps: 2 | Train Loss: 1.193 Vali Loss: 1.244 Vali Acc: 0.774 Test Loss: 1.244 Test Acc: 0.774
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.7903962135314941
Epoch: 33, Steps: 2 | Train Loss: 1.151 Vali Loss: 1.213 Vali Acc: 0.774 Test Loss: 1.213 Test Acc: 0.774
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.9080300331115723
Epoch: 34, Steps: 2 | Train Loss: 1.115 Vali Loss: 1.181 Vali Acc: 0.774 Test Loss: 1.181 Test Acc: 0.774
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.903886079788208
Epoch: 35, Steps: 2 | Train Loss: 1.085 Vali Loss: 1.149 Vali Acc: 0.770 Test Loss: 1.149 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_DLinear_UEA_ftM_sl65_ll0_pl0_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7777777777777778
model parameter : 10146
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_DLinear_UEA_ftM_sl65_ll0_pl0_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.121485948562622
Epoch: 1, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.789 Vali Acc: 0.167 Test Loss: 1.789 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 0.8737478256225586
Epoch: 2, Steps: 2 | Train Loss: 1.787 Vali Loss: 1.785 Vali Acc: 0.167 Test Loss: 1.785 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 0.7180023193359375
Epoch: 3, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.781 Vali Acc: 0.333 Test Loss: 1.781 Test Acc: 0.333
Validation loss decreased (-0.166649 --> -0.333316).  Saving model ...
Epoch: 4 cost time: 0.7687699794769287
Epoch: 4, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.776 Vali Acc: 0.333 Test Loss: 1.776 Test Acc: 0.333
Validation loss decreased (-0.333316 --> -0.333316).  Saving model ...
Epoch: 5 cost time: 0.9316372871398926
Epoch: 5, Steps: 2 | Train Loss: 1.771 Vali Loss: 1.770 Vali Acc: 0.333 Test Loss: 1.770 Test Acc: 0.333
Validation loss decreased (-0.333316 --> -0.333316).  Saving model ...
Epoch: 6 cost time: 0.7074198722839355
Epoch: 6, Steps: 2 | Train Loss: 1.764 Vali Loss: 1.763 Vali Acc: 0.437 Test Loss: 1.763 Test Acc: 0.437
Validation loss decreased (-0.333316 --> -0.437019).  Saving model ...
Epoch: 7 cost time: 0.6181638240814209
Epoch: 7, Steps: 2 | Train Loss: 1.755 Vali Loss: 1.755 Vali Acc: 0.556 Test Loss: 1.755 Test Acc: 0.556
Validation loss decreased (-0.437019 --> -0.555538).  Saving model ...
Epoch: 8 cost time: 0.6127700805664062
Epoch: 8, Steps: 2 | Train Loss: 1.745 Vali Loss: 1.745 Vali Acc: 0.626 Test Loss: 1.745 Test Acc: 0.626
Validation loss decreased (-0.555538 --> -0.625908).  Saving model ...
Epoch: 9 cost time: 0.8283529281616211
Epoch: 9, Steps: 2 | Train Loss: 1.733 Vali Loss: 1.735 Vali Acc: 0.663 Test Loss: 1.735 Test Acc: 0.663
Validation loss decreased (-0.625908 --> -0.662946).  Saving model ...
Epoch: 10 cost time: 0.7635433673858643
Epoch: 10, Steps: 2 | Train Loss: 1.722 Vali Loss: 1.724 Vali Acc: 0.700 Test Loss: 1.724 Test Acc: 0.700
Validation loss decreased (-0.662946 --> -0.699983).  Saving model ...
Epoch: 11 cost time: 0.8376216888427734
Epoch: 11, Steps: 2 | Train Loss: 1.707 Vali Loss: 1.712 Vali Acc: 0.730 Test Loss: 1.712 Test Acc: 0.730
Validation loss decreased (-0.699983 --> -0.729613).  Saving model ...
Epoch: 12 cost time: 1.0238313674926758
Epoch: 12, Steps: 2 | Train Loss: 1.694 Vali Loss: 1.699 Vali Acc: 0.744 Test Loss: 1.699 Test Acc: 0.744
Validation loss decreased (-0.729613 --> -0.744427).  Saving model ...
Epoch: 13 cost time: 0.6049373149871826
Epoch: 13, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.685 Vali Acc: 0.763 Test Loss: 1.685 Test Acc: 0.763
Validation loss decreased (-0.744427 --> -0.762946).  Saving model ...
Epoch: 14 cost time: 1.026357889175415
Epoch: 14, Steps: 2 | Train Loss: 1.663 Vali Loss: 1.670 Vali Acc: 0.759 Test Loss: 1.670 Test Acc: 0.759
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0635154247283936
Epoch: 15, Steps: 2 | Train Loss: 1.647 Vali Loss: 1.654 Vali Acc: 0.763 Test Loss: 1.654 Test Acc: 0.763
Validation loss decreased (-0.762946 --> -0.762946).  Saving model ...
Epoch: 16 cost time: 0.8651745319366455
Epoch: 16, Steps: 2 | Train Loss: 1.626 Vali Loss: 1.637 Vali Acc: 0.763 Test Loss: 1.637 Test Acc: 0.763
Validation loss decreased (-0.762946 --> -0.762947).  Saving model ...
Epoch: 17 cost time: 0.9051682949066162
Epoch: 17, Steps: 2 | Train Loss: 1.607 Vali Loss: 1.619 Vali Acc: 0.767 Test Loss: 1.619 Test Acc: 0.767
Validation loss decreased (-0.762947 --> -0.766650).  Saving model ...
Epoch: 18 cost time: 0.7258996963500977
Epoch: 18, Steps: 2 | Train Loss: 1.586 Vali Loss: 1.601 Vali Acc: 0.767 Test Loss: 1.601 Test Acc: 0.767
Validation loss decreased (-0.766650 --> -0.766651).  Saving model ...
Epoch: 19 cost time: 0.9411280155181885
Epoch: 19, Steps: 2 | Train Loss: 1.559 Vali Loss: 1.581 Vali Acc: 0.770 Test Loss: 1.581 Test Acc: 0.770
Validation loss decreased (-0.766651 --> -0.770355).  Saving model ...
Epoch: 20 cost time: 0.922093391418457
Epoch: 20, Steps: 2 | Train Loss: 1.541 Vali Loss: 1.560 Vali Acc: 0.770 Test Loss: 1.560 Test Acc: 0.770
Validation loss decreased (-0.770355 --> -0.770355).  Saving model ...
Epoch: 21 cost time: 0.8598136901855469
Epoch: 21, Steps: 2 | Train Loss: 1.515 Vali Loss: 1.538 Vali Acc: 0.774 Test Loss: 1.538 Test Acc: 0.774
Validation loss decreased (-0.770355 --> -0.774059).  Saving model ...
Epoch: 22 cost time: 0.8765556812286377
Epoch: 22, Steps: 2 | Train Loss: 1.490 Vali Loss: 1.515 Vali Acc: 0.774 Test Loss: 1.515 Test Acc: 0.774
Validation loss decreased (-0.774059 --> -0.774059).  Saving model ...
Epoch: 23 cost time: 0.8081521987915039
Epoch: 23, Steps: 2 | Train Loss: 1.458 Vali Loss: 1.491 Vali Acc: 0.774 Test Loss: 1.491 Test Acc: 0.774
Validation loss decreased (-0.774059 --> -0.774059).  Saving model ...
Epoch: 24 cost time: 0.8028411865234375
Epoch: 24, Steps: 2 | Train Loss: 1.434 Vali Loss: 1.465 Vali Acc: 0.774 Test Loss: 1.465 Test Acc: 0.774
Validation loss decreased (-0.774059 --> -0.774059).  Saving model ...
Epoch: 25 cost time: 0.7304775714874268
Epoch: 25, Steps: 2 | Train Loss: 1.406 Vali Loss: 1.439 Vali Acc: 0.774 Test Loss: 1.439 Test Acc: 0.774
Validation loss decreased (-0.774059 --> -0.774060).  Saving model ...
Epoch: 26 cost time: 0.8166725635528564
Epoch: 26, Steps: 2 | Train Loss: 1.377 Vali Loss: 1.411 Vali Acc: 0.778 Test Loss: 1.411 Test Acc: 0.778
Validation loss decreased (-0.774060 --> -0.777764).  Saving model ...
Epoch: 27 cost time: 0.7130539417266846
Epoch: 27, Steps: 2 | Train Loss: 1.343 Vali Loss: 1.382 Vali Acc: 0.778 Test Loss: 1.382 Test Acc: 0.778
Validation loss decreased (-0.777764 --> -0.777764).  Saving model ...
Epoch: 28 cost time: 0.773883581161499
Epoch: 28, Steps: 2 | Train Loss: 1.316 Vali Loss: 1.353 Vali Acc: 0.778 Test Loss: 1.353 Test Acc: 0.778
Validation loss decreased (-0.777764 --> -0.777764).  Saving model ...
Epoch: 29 cost time: 1.0308351516723633
Epoch: 29, Steps: 2 | Train Loss: 1.285 Vali Loss: 1.323 Vali Acc: 0.778 Test Loss: 1.323 Test Acc: 0.778
Validation loss decreased (-0.777764 --> -0.777765).  Saving model ...
Epoch: 30 cost time: 0.8357439041137695
Epoch: 30, Steps: 2 | Train Loss: 1.247 Vali Loss: 1.292 Vali Acc: 0.781 Test Loss: 1.292 Test Acc: 0.781
Validation loss decreased (-0.777765 --> -0.781469).  Saving model ...
Epoch: 31 cost time: 0.8314535617828369
Epoch: 31, Steps: 2 | Train Loss: 1.212 Vali Loss: 1.261 Vali Acc: 0.781 Test Loss: 1.261 Test Acc: 0.781
Validation loss decreased (-0.781469 --> -0.781469).  Saving model ...
Epoch: 32 cost time: 0.6358935832977295
Epoch: 32, Steps: 2 | Train Loss: 1.174 Vali Loss: 1.229 Vali Acc: 0.778 Test Loss: 1.229 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.791048526763916
Epoch: 33, Steps: 2 | Train Loss: 1.132 Vali Loss: 1.197 Vali Acc: 0.778 Test Loss: 1.197 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.774120569229126
Epoch: 34, Steps: 2 | Train Loss: 1.095 Vali Loss: 1.165 Vali Acc: 0.778 Test Loss: 1.165 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8741168975830078
Epoch: 35, Steps: 2 | Train Loss: 1.064 Vali Loss: 1.133 Vali Acc: 0.778 Test Loss: 1.133 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.8409695625305176
Epoch: 36, Steps: 2 | Train Loss: 1.023 Vali Loss: 1.101 Vali Acc: 0.781 Test Loss: 1.101 Test Acc: 0.781
Validation loss decreased (-0.781469 --> -0.781470).  Saving model ...
Epoch: 37 cost time: 0.7446651458740234
Epoch: 37, Steps: 2 | Train Loss: 0.988 Vali Loss: 1.069 Vali Acc: 0.781 Test Loss: 1.069 Test Acc: 0.781
Validation loss decreased (-0.781470 --> -0.781471).  Saving model ...
Epoch: 38 cost time: 0.6792051792144775
Epoch: 38, Steps: 2 | Train Loss: 0.958 Vali Loss: 1.037 Vali Acc: 0.785 Test Loss: 1.037 Test Acc: 0.785
Validation loss decreased (-0.781471 --> -0.785175).  Saving model ...
Epoch: 39 cost time: 0.725895881652832
Epoch: 39, Steps: 2 | Train Loss: 0.919 Vali Loss: 1.007 Vali Acc: 0.789 Test Loss: 1.007 Test Acc: 0.789
Validation loss decreased (-0.785175 --> -0.788879).  Saving model ...
Epoch: 40 cost time: 0.5620553493499756
Epoch: 40, Steps: 2 | Train Loss: 0.888 Vali Loss: 0.976 Vali Acc: 0.793 Test Loss: 0.976 Test Acc: 0.793
Validation loss decreased (-0.788879 --> -0.792583).  Saving model ...
Epoch: 41 cost time: 0.7478840351104736
Epoch: 41, Steps: 2 | Train Loss: 0.849 Vali Loss: 0.947 Vali Acc: 0.793 Test Loss: 0.947 Test Acc: 0.793
Validation loss decreased (-0.792583 --> -0.792583).  Saving model ...
Epoch: 42 cost time: 0.618314266204834
Epoch: 42, Steps: 2 | Train Loss: 0.811 Vali Loss: 0.918 Vali Acc: 0.793 Test Loss: 0.918 Test Acc: 0.793
Validation loss decreased (-0.792583 --> -0.792583).  Saving model ...
Epoch: 43 cost time: 0.8259081840515137
Epoch: 43, Steps: 2 | Train Loss: 0.777 Vali Loss: 0.890 Vali Acc: 0.804 Test Loss: 0.890 Test Acc: 0.804
Validation loss decreased (-0.792583 --> -0.803695).  Saving model ...
Epoch: 44 cost time: 0.785085916519165
Epoch: 44, Steps: 2 | Train Loss: 0.755 Vali Loss: 0.862 Vali Acc: 0.807 Test Loss: 0.862 Test Acc: 0.807
Validation loss decreased (-0.803695 --> -0.807399).  Saving model ...
Epoch: 45 cost time: 0.7560093402862549
Epoch: 45, Steps: 2 | Train Loss: 0.721 Vali Loss: 0.836 Vali Acc: 0.811 Test Loss: 0.836 Test Acc: 0.811
Validation loss decreased (-0.807399 --> -0.811103).  Saving model ...
Epoch: 46 cost time: 0.7451756000518799
Epoch: 46, Steps: 2 | Train Loss: 0.693 Vali Loss: 0.811 Vali Acc: 0.819 Test Loss: 0.811 Test Acc: 0.819
Validation loss decreased (-0.811103 --> -0.818510).  Saving model ...
Epoch: 47 cost time: 0.6250603199005127
Epoch: 47, Steps: 2 | Train Loss: 0.662 Vali Loss: 0.786 Vali Acc: 0.822 Test Loss: 0.786 Test Acc: 0.822
Validation loss decreased (-0.818510 --> -0.822214).  Saving model ...
Epoch: 48 cost time: 0.7833137512207031
Epoch: 48, Steps: 2 | Train Loss: 0.633 Vali Loss: 0.763 Vali Acc: 0.830 Test Loss: 0.763 Test Acc: 0.830
Validation loss decreased (-0.822214 --> -0.829622).  Saving model ...
Epoch: 49 cost time: 0.8121745586395264
Epoch: 49, Steps: 2 | Train Loss: 0.608 Vali Loss: 0.740 Vali Acc: 0.833 Test Loss: 0.740 Test Acc: 0.833
Validation loss decreased (-0.829622 --> -0.833326).  Saving model ...
Epoch: 50 cost time: 0.6217429637908936
Epoch: 50, Steps: 2 | Train Loss: 0.586 Vali Loss: 0.719 Vali Acc: 0.830 Test Loss: 0.719 Test Acc: 0.830
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.6730971336364746
Epoch: 51, Steps: 2 | Train Loss: 0.551 Vali Loss: 0.698 Vali Acc: 0.844 Test Loss: 0.698 Test Acc: 0.844
Validation loss decreased (-0.833326 --> -0.844437).  Saving model ...
Epoch: 52 cost time: 0.6653053760528564
Epoch: 52, Steps: 2 | Train Loss: 0.538 Vali Loss: 0.679 Vali Acc: 0.852 Test Loss: 0.679 Test Acc: 0.852
Validation loss decreased (-0.844437 --> -0.851845).  Saving model ...
Epoch: 53 cost time: 0.6132035255432129
Epoch: 53, Steps: 2 | Train Loss: 0.511 Vali Loss: 0.660 Vali Acc: 0.859 Test Loss: 0.660 Test Acc: 0.859
Validation loss decreased (-0.851845 --> -0.859253).  Saving model ...
Epoch: 54 cost time: 0.6458067893981934
Epoch: 54, Steps: 2 | Train Loss: 0.487 Vali Loss: 0.642 Vali Acc: 0.867 Test Loss: 0.642 Test Acc: 0.867
Validation loss decreased (-0.859253 --> -0.866660).  Saving model ...
Epoch: 55 cost time: 0.7007710933685303
Epoch: 55, Steps: 2 | Train Loss: 0.473 Vali Loss: 0.625 Vali Acc: 0.870 Test Loss: 0.625 Test Acc: 0.870
Validation loss decreased (-0.866660 --> -0.870364).  Saving model ...
Epoch: 56 cost time: 0.5861313343048096
Epoch: 56, Steps: 2 | Train Loss: 0.447 Vali Loss: 0.609 Vali Acc: 0.874 Test Loss: 0.609 Test Acc: 0.874
Validation loss decreased (-0.870364 --> -0.874068).  Saving model ...
Epoch: 57 cost time: 0.6495280265808105
Epoch: 57, Steps: 2 | Train Loss: 0.435 Vali Loss: 0.594 Vali Acc: 0.878 Test Loss: 0.594 Test Acc: 0.878
Validation loss decreased (-0.874068 --> -0.877772).  Saving model ...
Epoch: 58 cost time: 0.6932694911956787
Epoch: 58, Steps: 2 | Train Loss: 0.416 Vali Loss: 0.579 Vali Acc: 0.881 Test Loss: 0.579 Test Acc: 0.881
Validation loss decreased (-0.877772 --> -0.881476).  Saving model ...
Epoch: 59 cost time: 0.7835044860839844
Epoch: 59, Steps: 2 | Train Loss: 0.406 Vali Loss: 0.566 Vali Acc: 0.885 Test Loss: 0.566 Test Acc: 0.885
Validation loss decreased (-0.881476 --> -0.885180).  Saving model ...
Epoch: 60 cost time: 0.8464062213897705
Epoch: 60, Steps: 2 | Train Loss: 0.386 Vali Loss: 0.553 Vali Acc: 0.881 Test Loss: 0.553 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.9072933197021484
Epoch: 61, Steps: 2 | Train Loss: 0.369 Vali Loss: 0.540 Vali Acc: 0.881 Test Loss: 0.540 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.025649070739746
Epoch: 62, Steps: 2 | Train Loss: 0.361 Vali Loss: 0.529 Vali Acc: 0.881 Test Loss: 0.529 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.7070138454437256
Epoch: 63, Steps: 2 | Train Loss: 0.342 Vali Loss: 0.517 Vali Acc: 0.885 Test Loss: 0.517 Test Acc: 0.885
Validation loss decreased (-0.885180 --> -0.885180).  Saving model ...
Epoch: 64 cost time: 0.6625621318817139
Epoch: 64, Steps: 2 | Train Loss: 0.328 Vali Loss: 0.507 Vali Acc: 0.881 Test Loss: 0.507 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.7411601543426514
Epoch: 65, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.497 Vali Acc: 0.881 Test Loss: 0.497 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.8457431793212891
Epoch: 66, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.487 Vali Acc: 0.889 Test Loss: 0.487 Test Acc: 0.889
Validation loss decreased (-0.885180 --> -0.888884).  Saving model ...
Epoch: 67 cost time: 0.7774136066436768
Epoch: 67, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.478 Vali Acc: 0.889 Test Loss: 0.478 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 68 cost time: 0.6419694423675537
Epoch: 68, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.469 Vali Acc: 0.889 Test Loss: 0.469 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 69 cost time: 0.8080883026123047
Epoch: 69, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.461 Vali Acc: 0.889 Test Loss: 0.461 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 70 cost time: 0.7713148593902588
Epoch: 70, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.453 Vali Acc: 0.889 Test Loss: 0.453 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 71 cost time: 0.7560243606567383
Epoch: 71, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.446 Vali Acc: 0.889 Test Loss: 0.446 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 72 cost time: 0.6725935935974121
Epoch: 72, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.439 Vali Acc: 0.889 Test Loss: 0.439 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 73 cost time: 0.7197377681732178
Epoch: 73, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.432 Vali Acc: 0.889 Test Loss: 0.432 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 74 cost time: 0.6637575626373291
Epoch: 74, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.425 Vali Acc: 0.889 Test Loss: 0.425 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 75 cost time: 0.6362988948822021
Epoch: 75, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.419 Vali Acc: 0.889 Test Loss: 0.419 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 76 cost time: 0.9740304946899414
Epoch: 76, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.413 Vali Acc: 0.889 Test Loss: 0.413 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 77 cost time: 0.9565713405609131
Epoch: 77, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.407 Vali Acc: 0.889 Test Loss: 0.407 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 78 cost time: 1.298231601715088
Epoch: 78, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.401 Vali Acc: 0.893 Test Loss: 0.401 Test Acc: 0.893
Validation loss decreased (-0.888885 --> -0.892589).  Saving model ...
Epoch: 79 cost time: 0.7084369659423828
Epoch: 79, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.395 Vali Acc: 0.893 Test Loss: 0.395 Test Acc: 0.893
Validation loss decreased (-0.892589 --> -0.892589).  Saving model ...
Epoch: 80 cost time: 0.8032748699188232
Epoch: 80, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.390 Vali Acc: 0.893 Test Loss: 0.390 Test Acc: 0.893
Validation loss decreased (-0.892589 --> -0.892589).  Saving model ...
Epoch: 81 cost time: 0.6573548316955566
Epoch: 81, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.385 Vali Acc: 0.893 Test Loss: 0.385 Test Acc: 0.893
Validation loss decreased (-0.892589 --> -0.892589).  Saving model ...
Epoch: 82 cost time: 0.726778507232666
Epoch: 82, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.380 Vali Acc: 0.893 Test Loss: 0.380 Test Acc: 0.893
Validation loss decreased (-0.892589 --> -0.892589).  Saving model ...
Epoch: 83 cost time: 0.704195499420166
Epoch: 83, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.376 Vali Acc: 0.893 Test Loss: 0.376 Test Acc: 0.893
Validation loss decreased (-0.892589 --> -0.892589).  Saving model ...
Epoch: 84 cost time: 0.5937981605529785
Epoch: 84, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.371 Vali Acc: 0.893 Test Loss: 0.371 Test Acc: 0.893
Validation loss decreased (-0.892589 --> -0.892589).  Saving model ...
Epoch: 85 cost time: 0.6181254386901855
Epoch: 85, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.367 Vali Acc: 0.893 Test Loss: 0.367 Test Acc: 0.893
Validation loss decreased (-0.892589 --> -0.892589).  Saving model ...
Epoch: 86 cost time: 0.7077090740203857
Epoch: 86, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.363 Vali Acc: 0.893 Test Loss: 0.363 Test Acc: 0.893
Validation loss decreased (-0.892589 --> -0.892589).  Saving model ...
Epoch: 87 cost time: 0.8412654399871826
Epoch: 87, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.359 Vali Acc: 0.893 Test Loss: 0.359 Test Acc: 0.893
Validation loss decreased (-0.892589 --> -0.892589).  Saving model ...
Epoch: 88 cost time: 0.809593677520752
Epoch: 88, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.355 Vali Acc: 0.893 Test Loss: 0.355 Test Acc: 0.893
Validation loss decreased (-0.892589 --> -0.892589).  Saving model ...
Epoch: 89 cost time: 0.7417809963226318
Epoch: 89, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.351 Vali Acc: 0.893 Test Loss: 0.351 Test Acc: 0.893
Validation loss decreased (-0.892589 --> -0.892589).  Saving model ...
Epoch: 90 cost time: 0.6922588348388672
Epoch: 90, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.347 Vali Acc: 0.893 Test Loss: 0.347 Test Acc: 0.893
Validation loss decreased (-0.892589 --> -0.892589).  Saving model ...
Epoch: 91 cost time: 0.721472978591919
Epoch: 91, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.344 Vali Acc: 0.893 Test Loss: 0.344 Test Acc: 0.893
Validation loss decreased (-0.892589 --> -0.892589).  Saving model ...
Epoch: 92 cost time: 0.8294072151184082
Epoch: 92, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.341 Vali Acc: 0.893 Test Loss: 0.341 Test Acc: 0.893
Validation loss decreased (-0.892589 --> -0.892589).  Saving model ...
Epoch: 93 cost time: 0.9479174613952637
Epoch: 93, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.338 Vali Acc: 0.889 Test Loss: 0.338 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 0.897136926651001
Epoch: 94, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.335 Vali Acc: 0.889 Test Loss: 0.335 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 0.809401273727417
Epoch: 95, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.332 Vali Acc: 0.889 Test Loss: 0.332 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 96 cost time: 0.8319010734558105
Epoch: 96, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.329 Vali Acc: 0.889 Test Loss: 0.329 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 97 cost time: 0.8634347915649414
Epoch: 97, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.326 Vali Acc: 0.889 Test Loss: 0.326 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 98 cost time: 0.833676815032959
Epoch: 98, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.323 Vali Acc: 0.889 Test Loss: 0.323 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 99 cost time: 0.7588188648223877
Epoch: 99, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.320 Vali Acc: 0.889 Test Loss: 0.320 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 100 cost time: 0.6988162994384766
Epoch: 100, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.318 Vali Acc: 0.889 Test Loss: 0.318 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_ERing_DLinear_UEA_ftM_sl65_ll0_pl0_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8925925925925926
model parameter : 10146
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              DLinear             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_DLinear_UEA_ftM_sl65_ll0_pl0_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5019686222076416
Epoch: 1, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.789 Vali Acc: 0.167 Test Loss: 1.789 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 0.7756025791168213
Epoch: 2, Steps: 2 | Train Loss: 1.787 Vali Loss: 1.785 Vali Acc: 0.167 Test Loss: 1.785 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 0.9464137554168701
Epoch: 3, Steps: 2 | Train Loss: 1.782 Vali Loss: 1.781 Vali Acc: 0.333 Test Loss: 1.781 Test Acc: 0.333
Validation loss decreased (-0.166649 --> -0.333316).  Saving model ...
Epoch: 4 cost time: 0.6623954772949219
Epoch: 4, Steps: 2 | Train Loss: 1.779 Vali Loss: 1.777 Vali Acc: 0.333 Test Loss: 1.777 Test Acc: 0.333
Validation loss decreased (-0.333316 --> -0.333316).  Saving model ...
Epoch: 5 cost time: 0.898984432220459
Epoch: 5, Steps: 2 | Train Loss: 1.771 Vali Loss: 1.771 Vali Acc: 0.333 Test Loss: 1.771 Test Acc: 0.333
Validation loss decreased (-0.333316 --> -0.333316).  Saving model ...
Epoch: 6 cost time: 0.6475863456726074
Epoch: 6, Steps: 2 | Train Loss: 1.765 Vali Loss: 1.764 Vali Acc: 0.404 Test Loss: 1.764 Test Acc: 0.404
Validation loss decreased (-0.333316 --> -0.403686).  Saving model ...
Epoch: 7 cost time: 0.7945148944854736
Epoch: 7, Steps: 2 | Train Loss: 1.756 Vali Loss: 1.756 Vali Acc: 0.537 Test Loss: 1.756 Test Acc: 0.537
Validation loss decreased (-0.403686 --> -0.537019).  Saving model ...
Epoch: 8 cost time: 0.8294146060943604
Epoch: 8, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.747 Vali Acc: 0.611 Test Loss: 1.747 Test Acc: 0.611
Validation loss decreased (-0.537019 --> -0.611094).  Saving model ...
Epoch: 9 cost time: 0.8920879364013672
Epoch: 9, Steps: 2 | Train Loss: 1.736 Vali Loss: 1.737 Vali Acc: 0.656 Test Loss: 1.737 Test Acc: 0.656
Validation loss decreased (-0.611094 --> -0.655538).  Saving model ...
Epoch: 10 cost time: 0.9251561164855957
Epoch: 10, Steps: 2 | Train Loss: 1.726 Vali Loss: 1.726 Vali Acc: 0.685 Test Loss: 1.726 Test Acc: 0.685
Validation loss decreased (-0.655538 --> -0.685168).  Saving model ...
Epoch: 11 cost time: 0.7053911685943604
Epoch: 11, Steps: 2 | Train Loss: 1.711 Vali Loss: 1.714 Vali Acc: 0.722 Test Loss: 1.714 Test Acc: 0.722
Validation loss decreased (-0.685168 --> -0.722205).  Saving model ...
Epoch: 12 cost time: 0.795628547668457
Epoch: 12, Steps: 2 | Train Loss: 1.699 Vali Loss: 1.702 Vali Acc: 0.741 Test Loss: 1.702 Test Acc: 0.741
Validation loss decreased (-0.722205 --> -0.740724).  Saving model ...
Epoch: 13 cost time: 0.8010118007659912
Epoch: 13, Steps: 2 | Train Loss: 1.686 Vali Loss: 1.688 Vali Acc: 0.763 Test Loss: 1.688 Test Acc: 0.763
Validation loss decreased (-0.740724 --> -0.762946).  Saving model ...
Epoch: 14 cost time: 0.8639886379241943
Epoch: 14, Steps: 2 | Train Loss: 1.670 Vali Loss: 1.674 Vali Acc: 0.759 Test Loss: 1.674 Test Acc: 0.759
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8500547409057617
Epoch: 15, Steps: 2 | Train Loss: 1.655 Vali Loss: 1.659 Vali Acc: 0.759 Test Loss: 1.659 Test Acc: 0.759
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7483975887298584
Epoch: 16, Steps: 2 | Train Loss: 1.635 Vali Loss: 1.642 Vali Acc: 0.759 Test Loss: 1.642 Test Acc: 0.759
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8118917942047119
Epoch: 17, Steps: 2 | Train Loss: 1.617 Vali Loss: 1.625 Vali Acc: 0.759 Test Loss: 1.625 Test Acc: 0.759
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.664724588394165
Epoch: 18, Steps: 2 | Train Loss: 1.598 Vali Loss: 1.607 Vali Acc: 0.759 Test Loss: 1.607 Test Acc: 0.759
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9671497344970703
Epoch: 19, Steps: 2 | Train Loss: 1.571 Vali Loss: 1.588 Vali Acc: 0.770 Test Loss: 1.588 Test Acc: 0.770
Validation loss decreased (-0.762946 --> -0.770354).  Saving model ...
Epoch: 20 cost time: 0.7281675338745117
Epoch: 20, Steps: 2 | Train Loss: 1.555 Vali Loss: 1.568 Vali Acc: 0.778 Test Loss: 1.568 Test Acc: 0.778
Validation loss decreased (-0.770354 --> -0.777762).  Saving model ...
Epoch: 21 cost time: 0.7897794246673584
Epoch: 21, Steps: 2 | Train Loss: 1.529 Vali Loss: 1.546 Vali Acc: 0.778 Test Loss: 1.546 Test Acc: 0.778
Validation loss decreased (-0.777762 --> -0.777762).  Saving model ...
Epoch: 22 cost time: 0.6786952018737793
Epoch: 22, Steps: 2 | Train Loss: 1.506 Vali Loss: 1.524 Vali Acc: 0.778 Test Loss: 1.524 Test Acc: 0.778
Validation loss decreased (-0.777762 --> -0.777763).  Saving model ...
Epoch: 23 cost time: 0.9201064109802246
Epoch: 23, Steps: 2 | Train Loss: 1.475 Vali Loss: 1.500 Vali Acc: 0.778 Test Loss: 1.500 Test Acc: 0.778
Validation loss decreased (-0.777763 --> -0.777763).  Saving model ...
Epoch: 24 cost time: 0.7054891586303711
Epoch: 24, Steps: 2 | Train Loss: 1.452 Vali Loss: 1.476 Vali Acc: 0.781 Test Loss: 1.476 Test Acc: 0.781
Validation loss decreased (-0.777763 --> -0.781467).  Saving model ...
Epoch: 25 cost time: 0.6346967220306396
Epoch: 25, Steps: 2 | Train Loss: 1.426 Vali Loss: 1.450 Vali Acc: 0.781 Test Loss: 1.450 Test Acc: 0.781
Validation loss decreased (-0.781467 --> -0.781467).  Saving model ...
Epoch: 26 cost time: 0.8261218070983887
Epoch: 26, Steps: 2 | Train Loss: 1.398 Vali Loss: 1.423 Vali Acc: 0.778 Test Loss: 1.423 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8497850894927979
Epoch: 27, Steps: 2 | Train Loss: 1.365 Vali Loss: 1.395 Vali Acc: 0.778 Test Loss: 1.395 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8990404605865479
Epoch: 28, Steps: 2 | Train Loss: 1.340 Vali Loss: 1.366 Vali Acc: 0.778 Test Loss: 1.366 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7704534530639648
Epoch: 29, Steps: 2 | Train Loss: 1.309 Vali Loss: 1.337 Vali Acc: 0.778 Test Loss: 1.337 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7063517570495605
Epoch: 30, Steps: 2 | Train Loss: 1.273 Vali Loss: 1.307 Vali Acc: 0.774 Test Loss: 1.307 Test Acc: 0.774
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.771826982498169
Epoch: 31, Steps: 2 | Train Loss: 1.239 Vali Loss: 1.276 Vali Acc: 0.778 Test Loss: 1.276 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.7455174922943115
Epoch: 32, Steps: 2 | Train Loss: 1.202 Vali Loss: 1.245 Vali Acc: 0.778 Test Loss: 1.245 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.7750856876373291
Epoch: 33, Steps: 2 | Train Loss: 1.161 Vali Loss: 1.214 Vali Acc: 0.778 Test Loss: 1.214 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.7987151145935059
Epoch: 34, Steps: 2 | Train Loss: 1.125 Vali Loss: 1.182 Vali Acc: 0.774 Test Loss: 1.182 Test Acc: 0.774
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.6645526885986328
Epoch: 35, Steps: 2 | Train Loss: 1.095 Vali Loss: 1.150 Vali Acc: 0.774 Test Loss: 1.150 Test Acc: 0.774
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_DLinear_UEA_ftM_sl65_ll0_pl0_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.7814814814814814
model parameter : 10146
model size : 0.04MB
