Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         103                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma103_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.394936800003052
Epoch: 1, Steps: 9 | Train Loss: 1.430 Vali Loss: 1.195 Vali Acc: 0.522 Test Loss: 1.195 Test Acc: 0.522
Validation loss decreased (inf --> -0.521727).  Saving model ...
Epoch: 2 cost time: 3.064950466156006
Epoch: 2, Steps: 9 | Train Loss: 0.735 Vali Loss: 0.818 Vali Acc: 0.688 Test Loss: 0.818 Test Acc: 0.688
Validation loss decreased (-0.521727 --> -0.688398).  Saving model ...
Epoch: 3 cost time: 3.0050196647644043
Epoch: 3, Steps: 9 | Train Loss: 0.211 Vali Loss: 0.639 Vali Acc: 0.754 Test Loss: 0.639 Test Acc: 0.754
Validation loss decreased (-0.688398 --> -0.753617).  Saving model ...
Epoch: 4 cost time: 2.8383865356445312
Epoch: 4, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.568 Vali Acc: 0.768 Test Loss: 0.568 Test Acc: 0.768
Validation loss decreased (-0.753617 --> -0.768110).  Saving model ...
Epoch: 5 cost time: 3.192044734954834
Epoch: 5, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.830 Vali Acc: 0.746 Test Loss: 0.830 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.818709135055542
Epoch: 6, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.780 Vali Acc: 0.790 Test Loss: 0.780 Test Acc: 0.790
Validation loss decreased (-0.768110 --> -0.789847).  Saving model ...
Epoch: 7 cost time: 3.11651873588562
Epoch: 7, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.665 Vali Acc: 0.804 Test Loss: 0.665 Test Acc: 0.804
Validation loss decreased (-0.789847 --> -0.804341).  Saving model ...
Epoch: 8 cost time: 3.2014806270599365
Epoch: 8, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.678 Vali Acc: 0.797 Test Loss: 0.678 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.1955742835998535
Epoch: 9, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.724 Vali Acc: 0.797 Test Loss: 0.724 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.9204440116882324
Epoch: 10, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.756 Vali Acc: 0.775 Test Loss: 0.756 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.053724765777588
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.760 Vali Acc: 0.768 Test Loss: 0.760 Test Acc: 0.768
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.299292802810669
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.752 Vali Acc: 0.783 Test Loss: 0.752 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.434746265411377
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.748 Vali Acc: 0.775 Test Loss: 0.748 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.122828006744385
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.741 Vali Acc: 0.768 Test Loss: 0.741 Test Acc: 0.768
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.604919910430908
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.748 Vali Acc: 0.768 Test Loss: 0.748 Test Acc: 0.768
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.8869237899780273
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.749 Vali Acc: 0.775 Test Loss: 0.749 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.2958555221557617
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.750 Vali Acc: 0.775 Test Loss: 0.750 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma103_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8043478260869565
model parameter : 17228804
model size : 85.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         83                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma83_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.641033172607422
Epoch: 1, Steps: 9 | Train Loss: 1.432 Vali Loss: 1.212 Vali Acc: 0.522 Test Loss: 1.212 Test Acc: 0.522
Validation loss decreased (inf --> -0.521727).  Saving model ...
Epoch: 2 cost time: 3.639812707901001
Epoch: 2, Steps: 9 | Train Loss: 0.747 Vali Loss: 0.830 Vali Acc: 0.696 Test Loss: 0.830 Test Acc: 0.696
Validation loss decreased (-0.521727 --> -0.695644).  Saving model ...
Epoch: 3 cost time: 3.725749969482422
Epoch: 3, Steps: 9 | Train Loss: 0.231 Vali Loss: 0.598 Vali Acc: 0.804 Test Loss: 0.598 Test Acc: 0.804
Validation loss decreased (-0.695644 --> -0.804342).  Saving model ...
Epoch: 4 cost time: 3.8951423168182373
Epoch: 4, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.553 Vali Acc: 0.841 Test Loss: 0.553 Test Acc: 0.841
Validation loss decreased (-0.804342 --> -0.840574).  Saving model ...
Epoch: 5 cost time: 3.891509771347046
Epoch: 5, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.775 Vali Acc: 0.775 Test Loss: 0.775 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.5040128231048584
Epoch: 6, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.609 Vali Acc: 0.848 Test Loss: 0.609 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847820).  Saving model ...
Epoch: 7 cost time: 3.646669864654541
Epoch: 7, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.582 Vali Acc: 0.841 Test Loss: 0.582 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.5966460704803467
Epoch: 8, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.645 Vali Acc: 0.841 Test Loss: 0.645 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.4673707485198975
Epoch: 9, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.690 Vali Acc: 0.833 Test Loss: 0.690 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.7605514526367188
Epoch: 10, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.693 Vali Acc: 0.833 Test Loss: 0.693 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.7663304805755615
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.676 Vali Acc: 0.841 Test Loss: 0.676 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.250657081604004
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.660 Vali Acc: 0.848 Test Loss: 0.660 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.89905858039856
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.661 Vali Acc: 0.848 Test Loss: 0.661 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.142391204833984
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.660 Vali Acc: 0.841 Test Loss: 0.660 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.351408958435059
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.671 Vali Acc: 0.841 Test Loss: 0.671 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.8957409858703613
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.667 Vali Acc: 0.841 Test Loss: 0.667 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma83_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 17228804
model size : 85.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         62                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma62_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.6464385986328125
Epoch: 1, Steps: 9 | Train Loss: 1.435 Vali Loss: 1.214 Vali Acc: 0.536 Test Loss: 1.214 Test Acc: 0.536
Validation loss decreased (inf --> -0.536220).  Saving model ...
Epoch: 2 cost time: 4.890076160430908
Epoch: 2, Steps: 9 | Train Loss: 0.746 Vali Loss: 0.851 Vali Acc: 0.688 Test Loss: 0.851 Test Acc: 0.688
Validation loss decreased (-0.536220 --> -0.688397).  Saving model ...
Epoch: 3 cost time: 4.054385423660278
Epoch: 3, Steps: 9 | Train Loss: 0.214 Vali Loss: 0.613 Vali Acc: 0.819 Test Loss: 0.613 Test Acc: 0.819
Validation loss decreased (-0.688397 --> -0.818834).  Saving model ...
Epoch: 4 cost time: 3.865757703781128
Epoch: 4, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.583 Vali Acc: 0.848 Test Loss: 0.583 Test Acc: 0.848
Validation loss decreased (-0.818834 --> -0.847820).  Saving model ...
Epoch: 5 cost time: 4.1902174949646
Epoch: 5, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.719 Vali Acc: 0.819 Test Loss: 0.719 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.001101732254028
Epoch: 6, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.678 Vali Acc: 0.841 Test Loss: 0.678 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.1670825481414795
Epoch: 7, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.597 Vali Acc: 0.891 Test Loss: 0.597 Test Acc: 0.891
Validation loss decreased (-0.847820 --> -0.891298).  Saving model ...
Epoch: 8 cost time: 4.555907487869263
Epoch: 8, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.620 Vali Acc: 0.891 Test Loss: 0.620 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.054473400115967
Epoch: 9, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.666 Vali Acc: 0.870 Test Loss: 0.666 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.3249101638793945
Epoch: 10, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.682 Vali Acc: 0.855 Test Loss: 0.682 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.325995206832886
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.673 Vali Acc: 0.855 Test Loss: 0.673 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.438835620880127
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.656 Vali Acc: 0.870 Test Loss: 0.656 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.2563724517822266
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.656 Vali Acc: 0.870 Test Loss: 0.656 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.184328317642212
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.659 Vali Acc: 0.862 Test Loss: 0.659 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.9498677253723145
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.668 Vali Acc: 0.862 Test Loss: 0.668 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.227301359176636
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.665 Vali Acc: 0.862 Test Loss: 0.665 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.5333685874938965
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.669 Vali Acc: 0.862 Test Loss: 0.669 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma62_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 17228804
model size : 85.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         42                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.18966817855835
Epoch: 1, Steps: 9 | Train Loss: 1.426 Vali Loss: 1.157 Vali Acc: 0.543 Test Loss: 1.157 Test Acc: 0.543
Validation loss decreased (inf --> -0.543467).  Saving model ...
Epoch: 2 cost time: 3.9420571327209473
Epoch: 2, Steps: 9 | Train Loss: 0.710 Vali Loss: 0.791 Vali Acc: 0.696 Test Loss: 0.791 Test Acc: 0.696
Validation loss decreased (-0.543467 --> -0.695644).  Saving model ...
Epoch: 3 cost time: 3.570018768310547
Epoch: 3, Steps: 9 | Train Loss: 0.199 Vali Loss: 0.606 Vali Acc: 0.804 Test Loss: 0.606 Test Acc: 0.804
Validation loss decreased (-0.695644 --> -0.804342).  Saving model ...
Epoch: 4 cost time: 4.5166075229644775
Epoch: 4, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.582 Vali Acc: 0.797 Test Loss: 0.582 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.723980903625488
Epoch: 5, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.543 Vali Acc: 0.812 Test Loss: 0.543 Test Acc: 0.812
Validation loss decreased (-0.804342 --> -0.811589).  Saving model ...
Epoch: 6 cost time: 5.778951406478882
Epoch: 6, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.589 Vali Acc: 0.804 Test Loss: 0.589 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.901020050048828
Epoch: 7, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.594 Vali Acc: 0.819 Test Loss: 0.594 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818835).  Saving model ...
Epoch: 8 cost time: 4.8320252895355225
Epoch: 8, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.578 Vali Acc: 0.819 Test Loss: 0.578 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818835).  Saving model ...
Epoch: 9 cost time: 5.224236249923706
Epoch: 9, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.572 Vali Acc: 0.833 Test Loss: 0.572 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833328).  Saving model ...
Epoch: 10 cost time: 5.230842351913452
Epoch: 10, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.581 Vali Acc: 0.833 Test Loss: 0.581 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.247380971908569
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.586 Vali Acc: 0.826 Test Loss: 0.586 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.11059308052063
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.590 Vali Acc: 0.826 Test Loss: 0.590 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.084608554840088
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.604 Vali Acc: 0.826 Test Loss: 0.604 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.2016894817352295
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.598 Vali Acc: 0.826 Test Loss: 0.598 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.350218772888184
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.602 Vali Acc: 0.826 Test Loss: 0.602 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.315107583999634
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.596 Vali Acc: 0.848 Test Loss: 0.596 Test Acc: 0.848
Validation loss decreased (-0.833328 --> -0.847820).  Saving model ...
Epoch: 17 cost time: 4.504330635070801
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.604 Vali Acc: 0.841 Test Loss: 0.604 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.224413633346558
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.603 Vali Acc: 0.848 Test Loss: 0.603 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.658070087432861
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.605 Vali Acc: 0.848 Test Loss: 0.605 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.203059434890747
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.606 Vali Acc: 0.848 Test Loss: 0.606 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.327120304107666
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.592 Vali Acc: 0.855 Test Loss: 0.592 Test Acc: 0.855
Validation loss decreased (-0.847820 --> -0.855067).  Saving model ...
Epoch: 22 cost time: 5.6326985359191895
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.599 Vali Acc: 0.855 Test Loss: 0.599 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.90411901473999
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.609 Vali Acc: 0.848 Test Loss: 0.609 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.818218946456909
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.626 Vali Acc: 0.841 Test Loss: 0.626 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.628417015075684
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.605 Vali Acc: 0.848 Test Loss: 0.605 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.846730709075928
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.597 Vali Acc: 0.855 Test Loss: 0.597 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.623758554458618
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.610 Vali Acc: 0.848 Test Loss: 0.610 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.560372591018677
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.609 Vali Acc: 0.848 Test Loss: 0.609 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 5.715433120727539
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.617 Vali Acc: 0.848 Test Loss: 0.617 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 5.143574237823486
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.612 Vali Acc: 0.848 Test Loss: 0.612 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 4.529783248901367
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.614 Vali Acc: 0.848 Test Loss: 0.614 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 17228804
model size : 85.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 7.616701126098633
Epoch: 1, Steps: 9 | Train Loss: 1.441 Vali Loss: 1.193 Vali Acc: 0.543 Test Loss: 1.193 Test Acc: 0.543
Validation loss decreased (inf --> -0.543466).  Saving model ...
Epoch: 2 cost time: 5.907411813735962
Epoch: 2, Steps: 9 | Train Loss: 0.721 Vali Loss: 0.780 Vali Acc: 0.739 Test Loss: 0.780 Test Acc: 0.739
Validation loss decreased (-0.543466 --> -0.739123).  Saving model ...
Epoch: 3 cost time: 5.8917763233184814
Epoch: 3, Steps: 9 | Train Loss: 0.219 Vali Loss: 0.545 Vali Acc: 0.797 Test Loss: 0.545 Test Acc: 0.797
Validation loss decreased (-0.739123 --> -0.797096).  Saving model ...
Epoch: 4 cost time: 5.340139150619507
Epoch: 4, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.551 Vali Acc: 0.826 Test Loss: 0.551 Test Acc: 0.826
Validation loss decreased (-0.797096 --> -0.826081).  Saving model ...
Epoch: 5 cost time: 5.118812322616577
Epoch: 5, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.461 Vali Acc: 0.841 Test Loss: 0.461 Test Acc: 0.841
Validation loss decreased (-0.826081 --> -0.840575).  Saving model ...
Epoch: 6 cost time: 5.140761375427246
Epoch: 6, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.513 Vali Acc: 0.841 Test Loss: 0.513 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.342759609222412
Epoch: 7, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.395 Vali Acc: 0.877 Test Loss: 0.395 Test Acc: 0.877
Validation loss decreased (-0.840575 --> -0.876808).  Saving model ...
Epoch: 8 cost time: 5.2114951610565186
Epoch: 8, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.435 Vali Acc: 0.855 Test Loss: 0.435 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.201734304428101
Epoch: 9, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.482 Vali Acc: 0.870 Test Loss: 0.482 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.813784837722778
Epoch: 10, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.449 Vali Acc: 0.884 Test Loss: 0.449 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884053).  Saving model ...
Epoch: 11 cost time: 5.787402629852295
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.440 Vali Acc: 0.884 Test Loss: 0.440 Test Acc: 0.884
Validation loss decreased (-0.884053 --> -0.884054).  Saving model ...
Epoch: 12 cost time: 5.235208034515381
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.436 Vali Acc: 0.891 Test Loss: 0.436 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891300).  Saving model ...
Epoch: 13 cost time: 4.794187307357788
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.446 Vali Acc: 0.877 Test Loss: 0.446 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.201998233795166
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.448 Vali Acc: 0.877 Test Loss: 0.448 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.514989614486694
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.452 Vali Acc: 0.877 Test Loss: 0.452 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.774817228317261
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.450 Vali Acc: 0.877 Test Loss: 0.450 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.943601131439209
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.453 Vali Acc: 0.862 Test Loss: 0.453 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.468922853469849
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.456 Vali Acc: 0.862 Test Loss: 0.456 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.757133960723877
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.463 Vali Acc: 0.862 Test Loss: 0.463 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.105380296707153
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.862 Test Loss: 0.467 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.664174556732178
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.452 Vali Acc: 0.870 Test Loss: 0.452 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.293835878372192
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.453 Vali Acc: 0.870 Test Loss: 0.453 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 17228804
model size : 85.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 7.8306732177734375
Epoch: 1, Steps: 9 | Train Loss: 1.437 Vali Loss: 1.151 Vali Acc: 0.514 Test Loss: 1.151 Test Acc: 0.514
Validation loss decreased (inf --> -0.514481).  Saving model ...
Epoch: 2 cost time: 5.379782676696777
Epoch: 2, Steps: 9 | Train Loss: 0.750 Vali Loss: 0.794 Vali Acc: 0.674 Test Loss: 0.794 Test Acc: 0.674
Validation loss decreased (-0.514481 --> -0.673905).  Saving model ...
Epoch: 3 cost time: 5.186691522598267
Epoch: 3, Steps: 9 | Train Loss: 0.221 Vali Loss: 0.714 Vali Acc: 0.725 Test Loss: 0.714 Test Acc: 0.725
Validation loss decreased (-0.673905 --> -0.724631).  Saving model ...
Epoch: 4 cost time: 4.409029483795166
Epoch: 4, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.615 Vali Acc: 0.768 Test Loss: 0.615 Test Acc: 0.768
Validation loss decreased (-0.724631 --> -0.768110).  Saving model ...
Epoch: 5 cost time: 4.733794927597046
Epoch: 5, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.619 Vali Acc: 0.790 Test Loss: 0.619 Test Acc: 0.790
Validation loss decreased (-0.768110 --> -0.789849).  Saving model ...
Epoch: 6 cost time: 5.035603761672974
Epoch: 6, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.660 Vali Acc: 0.790 Test Loss: 0.660 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.1457226276397705
Epoch: 7, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.679 Vali Acc: 0.761 Test Loss: 0.679 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.377827882766724
Epoch: 8, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.639 Vali Acc: 0.790 Test Loss: 0.639 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.700314283370972
Epoch: 9, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.638 Vali Acc: 0.790 Test Loss: 0.638 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.379930257797241
Epoch: 10, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.654 Vali Acc: 0.804 Test Loss: 0.654 Test Acc: 0.804
Validation loss decreased (-0.789849 --> -0.804341).  Saving model ...
Epoch: 11 cost time: 5.612797737121582
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.667 Vali Acc: 0.797 Test Loss: 0.667 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.122952938079834
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.660 Vali Acc: 0.797 Test Loss: 0.660 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.239789962768555
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.654 Vali Acc: 0.797 Test Loss: 0.654 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.11607551574707
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.639 Vali Acc: 0.790 Test Loss: 0.639 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.763097047805786
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.649 Vali Acc: 0.797 Test Loss: 0.649 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.495250940322876
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.652 Vali Acc: 0.804 Test Loss: 0.652 Test Acc: 0.804
Validation loss decreased (-0.804341 --> -0.804341).  Saving model ...
Epoch: 17 cost time: 5.0210349559783936
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.656 Vali Acc: 0.804 Test Loss: 0.656 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.662338495254517
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.652 Vali Acc: 0.804 Test Loss: 0.652 Test Acc: 0.804
Validation loss decreased (-0.804341 --> -0.804341).  Saving model ...
Epoch: 19 cost time: 5.632568836212158
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.653 Vali Acc: 0.804 Test Loss: 0.653 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.3893842697143555
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.658 Vali Acc: 0.804 Test Loss: 0.658 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.752850532531738
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.650 Vali Acc: 0.804 Test Loss: 0.650 Test Acc: 0.804
Validation loss decreased (-0.804341 --> -0.804341).  Saving model ...
Epoch: 22 cost time: 6.140176773071289
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.650 Vali Acc: 0.804 Test Loss: 0.650 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.654389381408691
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.655 Vali Acc: 0.804 Test Loss: 0.655 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.869357585906982
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.661 Vali Acc: 0.804 Test Loss: 0.661 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.633191347122192
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.652 Vali Acc: 0.804 Test Loss: 0.652 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.869752645492554
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.657 Vali Acc: 0.804 Test Loss: 0.657 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 4.487640142440796
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.662 Vali Acc: 0.804 Test Loss: 0.662 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.461318254470825
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.655 Vali Acc: 0.804 Test Loss: 0.655 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 5.260874509811401
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.651 Vali Acc: 0.804 Test Loss: 0.651 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 6.179283857345581
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.654 Vali Acc: 0.804 Test Loss: 0.654 Test Acc: 0.804
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 6.0043604373931885
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.659 Vali Acc: 0.804 Test Loss: 0.659 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8043478260869565
model parameter : 17228804
model size : 85.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.578856945037842
Epoch: 1, Steps: 9 | Train Loss: 1.453 Vali Loss: 1.207 Vali Acc: 0.493 Test Loss: 1.207 Test Acc: 0.493
Validation loss decreased (inf --> -0.492742).  Saving model ...
Epoch: 2 cost time: 5.505984306335449
Epoch: 2, Steps: 9 | Train Loss: 0.759 Vali Loss: 1.001 Vali Acc: 0.587 Test Loss: 1.001 Test Acc: 0.587
Validation loss decreased (-0.492742 --> -0.586947).  Saving model ...
Epoch: 3 cost time: 5.470437288284302
Epoch: 3, Steps: 9 | Train Loss: 0.264 Vali Loss: 0.879 Vali Acc: 0.659 Test Loss: 0.879 Test Acc: 0.659
Validation loss decreased (-0.586947 --> -0.659412).  Saving model ...
Epoch: 4 cost time: 5.661193609237671
Epoch: 4, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.960 Vali Acc: 0.667 Test Loss: 0.960 Test Acc: 0.667
Validation loss decreased (-0.659412 --> -0.666657).  Saving model ...
Epoch: 5 cost time: 5.771517753601074
Epoch: 5, Steps: 9 | Train Loss: 0.023 Vali Loss: 1.087 Vali Acc: 0.703 Test Loss: 1.087 Test Acc: 0.703
Validation loss decreased (-0.666657 --> -0.702888).  Saving model ...
Epoch: 6 cost time: 6.245886564254761
Epoch: 6, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.970 Vali Acc: 0.688 Test Loss: 0.970 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.042003631591797
Epoch: 7, Steps: 9 | Train Loss: 0.021 Vali Loss: 1.686 Vali Acc: 0.630 Test Loss: 1.686 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.794552326202393
Epoch: 8, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.215 Vali Acc: 0.717 Test Loss: 1.215 Test Acc: 0.717
Validation loss decreased (-0.702888 --> -0.717379).  Saving model ...
Epoch: 9 cost time: 5.725633859634399
Epoch: 9, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.215 Vali Acc: 0.688 Test Loss: 1.215 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.252498626708984
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.421 Vali Acc: 0.688 Test Loss: 1.421 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.436529159545898
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.338 Vali Acc: 0.696 Test Loss: 1.338 Test Acc: 0.696
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.636016368865967
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.280 Vali Acc: 0.739 Test Loss: 1.280 Test Acc: 0.739
Validation loss decreased (-0.717379 --> -0.739118).  Saving model ...
Epoch: 13 cost time: 5.79105544090271
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.281 Vali Acc: 0.710 Test Loss: 1.281 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.776382207870483
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.302 Vali Acc: 0.717 Test Loss: 1.302 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.298638582229614
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.302 Vali Acc: 0.717 Test Loss: 1.302 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.257498264312744
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.285 Vali Acc: 0.717 Test Loss: 1.285 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.5717785358428955
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.270 Vali Acc: 0.717 Test Loss: 1.270 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.342274904251099
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.267 Vali Acc: 0.717 Test Loss: 1.267 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.928937673568726
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.263 Vali Acc: 0.717 Test Loss: 1.263 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.912116527557373
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.266 Vali Acc: 0.717 Test Loss: 1.266 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.959647178649902
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.268 Vali Acc: 0.717 Test Loss: 1.268 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.244285821914673
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.271 Vali Acc: 0.717 Test Loss: 1.271 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7391304347826086
model parameter : 17228804
model size : 85.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 7.585721731185913
Epoch: 1, Steps: 9 | Train Loss: 1.465 Vali Loss: 1.448 Vali Acc: 0.246 Test Loss: 1.448 Test Acc: 0.246
Validation loss decreased (inf --> -0.246362).  Saving model ...
Epoch: 2 cost time: 5.174688816070557
Epoch: 2, Steps: 9 | Train Loss: 0.885 Vali Loss: 1.406 Vali Acc: 0.333 Test Loss: 1.406 Test Acc: 0.333
Validation loss decreased (-0.246362 --> -0.333319).  Saving model ...
Epoch: 3 cost time: 5.8810601234436035
Epoch: 3, Steps: 9 | Train Loss: 0.356 Vali Loss: 1.437 Vali Acc: 0.406 Test Loss: 1.437 Test Acc: 0.406
Validation loss decreased (-0.333319 --> -0.405783).  Saving model ...
Epoch: 4 cost time: 6.022590637207031
Epoch: 4, Steps: 9 | Train Loss: 0.109 Vali Loss: 1.762 Vali Acc: 0.428 Test Loss: 1.762 Test Acc: 0.428
Validation loss decreased (-0.405783 --> -0.427519).  Saving model ...
Epoch: 5 cost time: 6.174495220184326
Epoch: 5, Steps: 9 | Train Loss: 0.044 Vali Loss: 1.842 Vali Acc: 0.420 Test Loss: 1.842 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.85779070854187
Epoch: 6, Steps: 9 | Train Loss: 0.011 Vali Loss: 1.789 Vali Acc: 0.449 Test Loss: 1.789 Test Acc: 0.449
Validation loss decreased (-0.427519 --> -0.449257).  Saving model ...
Epoch: 7 cost time: 5.386340141296387
Epoch: 7, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.865 Vali Acc: 0.464 Test Loss: 1.865 Test Acc: 0.464
Validation loss decreased (-0.449257 --> -0.463749).  Saving model ...
Epoch: 8 cost time: 4.921546697616577
Epoch: 8, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.098 Vali Acc: 0.457 Test Loss: 2.098 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.99953293800354
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.004 Vali Acc: 0.464 Test Loss: 2.004 Test Acc: 0.464
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.964460849761963
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.917 Vali Acc: 0.464 Test Loss: 1.917 Test Acc: 0.464
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.057584047317505
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.894 Vali Acc: 0.471 Test Loss: 1.894 Test Acc: 0.471
Validation loss decreased (-0.463749 --> -0.470996).  Saving model ...
Epoch: 12 cost time: 5.7270402908325195
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.923 Vali Acc: 0.478 Test Loss: 1.923 Test Acc: 0.478
Validation loss decreased (-0.470996 --> -0.478242).  Saving model ...
Epoch: 13 cost time: 5.297683000564575
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.923 Vali Acc: 0.478 Test Loss: 1.923 Test Acc: 0.478
Validation loss decreased (-0.478242 --> -0.478242).  Saving model ...
Epoch: 14 cost time: 5.646154880523682
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.918 Vali Acc: 0.478 Test Loss: 1.918 Test Acc: 0.478
Validation loss decreased (-0.478242 --> -0.478242).  Saving model ...
Epoch: 15 cost time: 5.0593414306640625
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.909 Vali Acc: 0.478 Test Loss: 1.909 Test Acc: 0.478
Validation loss decreased (-0.478242 --> -0.478242).  Saving model ...
Epoch: 16 cost time: 4.879568338394165
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.909 Vali Acc: 0.478 Test Loss: 1.909 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.758079290390015
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.901 Vali Acc: 0.486 Test Loss: 1.901 Test Acc: 0.486
Validation loss decreased (-0.478242 --> -0.485488).  Saving model ...
Epoch: 18 cost time: 5.456720590591431
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.884 Vali Acc: 0.486 Test Loss: 1.884 Test Acc: 0.486
Validation loss decreased (-0.485488 --> -0.485488).  Saving model ...
Epoch: 19 cost time: 5.174467086791992
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.861 Vali Acc: 0.486 Test Loss: 1.861 Test Acc: 0.486
Validation loss decreased (-0.485488 --> -0.485489).  Saving model ...
Epoch: 20 cost time: 5.5606279373168945
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.858 Vali Acc: 0.486 Test Loss: 1.858 Test Acc: 0.486
Validation loss decreased (-0.485489 --> -0.485489).  Saving model ...
Epoch: 21 cost time: 5.086335182189941
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.874 Vali Acc: 0.486 Test Loss: 1.874 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.971496343612671
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.876 Vali Acc: 0.486 Test Loss: 1.876 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.32971453666687
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.868 Vali Acc: 0.500 Test Loss: 1.868 Test Acc: 0.500
Validation loss decreased (-0.485489 --> -0.499981).  Saving model ...
Epoch: 24 cost time: 5.138986825942993
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.855 Vali Acc: 0.493 Test Loss: 1.855 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.637073040008545
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.862 Vali Acc: 0.500 Test Loss: 1.862 Test Acc: 0.500
Validation loss decreased (-0.499981 --> -0.499981).  Saving model ...
Epoch: 26 cost time: 5.114651679992676
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.863 Vali Acc: 0.500 Test Loss: 1.863 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.104924201965332
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.847 Vali Acc: 0.514 Test Loss: 1.847 Test Acc: 0.514
Validation loss decreased (-0.499981 --> -0.514474).  Saving model ...
Epoch: 28 cost time: 5.732660293579102
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.838 Vali Acc: 0.514 Test Loss: 1.838 Test Acc: 0.514
Validation loss decreased (-0.514474 --> -0.514474).  Saving model ...
Epoch: 29 cost time: 5.608333349227905
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.825 Vali Acc: 0.529 Test Loss: 1.825 Test Acc: 0.529
Validation loss decreased (-0.514474 --> -0.528967).  Saving model ...
Epoch: 30 cost time: 5.400143146514893
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.829 Vali Acc: 0.529 Test Loss: 1.829 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.342044115066528
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.840 Vali Acc: 0.543 Test Loss: 1.840 Test Acc: 0.543
Validation loss decreased (-0.528967 --> -0.543460).  Saving model ...
Epoch: 32 cost time: 5.470356225967407
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.847 Vali Acc: 0.529 Test Loss: 1.847 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 5.378839731216431
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.847 Vali Acc: 0.536 Test Loss: 1.847 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 5.489927530288696
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.841 Vali Acc: 0.551 Test Loss: 1.841 Test Acc: 0.551
Validation loss decreased (-0.543460 --> -0.550706).  Saving model ...
Epoch: 35 cost time: 5.1114819049835205
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.845 Vali Acc: 0.551 Test Loss: 1.845 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 4.451114177703857
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.829 Vali Acc: 0.551 Test Loss: 1.829 Test Acc: 0.551
Validation loss decreased (-0.550706 --> -0.550706).  Saving model ...
Epoch: 37 cost time: 5.215820789337158
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.824 Vali Acc: 0.543 Test Loss: 1.824 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 4.890787601470947
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.819 Vali Acc: 0.551 Test Loss: 1.819 Test Acc: 0.551
Validation loss decreased (-0.550706 --> -0.550706).  Saving model ...
Epoch: 39 cost time: 5.847921848297119
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.834 Vali Acc: 0.551 Test Loss: 1.834 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 5.80677604675293
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.834 Vali Acc: 0.543 Test Loss: 1.834 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 5.721766710281372
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.823 Vali Acc: 0.543 Test Loss: 1.823 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 5.966605186462402
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.815 Vali Acc: 0.551 Test Loss: 1.815 Test Acc: 0.551
Validation loss decreased (-0.550706 --> -0.550706).  Saving model ...
Epoch: 43 cost time: 6.047517776489258
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.801 Vali Acc: 0.551 Test Loss: 1.801 Test Acc: 0.551
Validation loss decreased (-0.550706 --> -0.550707).  Saving model ...
Epoch: 44 cost time: 4.899799585342407
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.806 Vali Acc: 0.551 Test Loss: 1.806 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 5.1244401931762695
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.814 Vali Acc: 0.551 Test Loss: 1.814 Test Acc: 0.551
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 4.996041774749756
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.827 Vali Acc: 0.551 Test Loss: 1.827 Test Acc: 0.551
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 4.933806657791138
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.827 Vali Acc: 0.551 Test Loss: 1.827 Test Acc: 0.551
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 5.49019980430603
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.826 Vali Acc: 0.551 Test Loss: 1.826 Test Acc: 0.551
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 6.01015043258667
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.820 Vali Acc: 0.551 Test Loss: 1.820 Test Acc: 0.551
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 5.283714294433594
Epoch: 50, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.815 Vali Acc: 0.551 Test Loss: 1.815 Test Acc: 0.551
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 5.302799463272095
Epoch: 51, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.813 Vali Acc: 0.551 Test Loss: 1.813 Test Acc: 0.551
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 5.927514314651489
Epoch: 52, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.810 Vali Acc: 0.551 Test Loss: 1.810 Test Acc: 0.551
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 5.206387758255005
Epoch: 53, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.808 Vali Acc: 0.551 Test Loss: 1.808 Test Acc: 0.551
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5507246376811594
model parameter : 17228804
model size : 85.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.684973478317261
Epoch: 1, Steps: 9 | Train Loss: 1.471 Vali Loss: 1.450 Vali Acc: 0.312 Test Loss: 1.450 Test Acc: 0.312
Validation loss decreased (inf --> -0.311580).  Saving model ...
Epoch: 2 cost time: 4.928673028945923
Epoch: 2, Steps: 9 | Train Loss: 1.065 Vali Loss: 1.510 Vali Acc: 0.297 Test Loss: 1.510 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.8256113529205322
Epoch: 3, Steps: 9 | Train Loss: 0.551 Vali Loss: 1.943 Vali Acc: 0.290 Test Loss: 1.943 Test Acc: 0.290
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.619020938873291
Epoch: 4, Steps: 9 | Train Loss: 0.232 Vali Loss: 2.002 Vali Acc: 0.290 Test Loss: 2.002 Test Acc: 0.290
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.2554521560668945
Epoch: 5, Steps: 9 | Train Loss: 0.104 Vali Loss: 2.762 Vali Acc: 0.304 Test Loss: 2.762 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.9473090171813965
Epoch: 6, Steps: 9 | Train Loss: 0.033 Vali Loss: 3.334 Vali Acc: 0.341 Test Loss: 3.334 Test Acc: 0.341
Validation loss decreased (-0.311580 --> -0.340546).  Saving model ...
Epoch: 7 cost time: 5.499540567398071
Epoch: 7, Steps: 9 | Train Loss: 0.012 Vali Loss: 3.129 Vali Acc: 0.333 Test Loss: 3.129 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.382417440414429
Epoch: 8, Steps: 9 | Train Loss: 0.005 Vali Loss: 3.692 Vali Acc: 0.348 Test Loss: 3.692 Test Acc: 0.348
Validation loss decreased (-0.340546 --> -0.347789).  Saving model ...
Epoch: 9 cost time: 5.614496469497681
Epoch: 9, Steps: 9 | Train Loss: 0.002 Vali Loss: 3.558 Vali Acc: 0.377 Test Loss: 3.558 Test Acc: 0.377
Validation loss decreased (-0.347789 --> -0.376776).  Saving model ...
Epoch: 10 cost time: 4.733207941055298
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 3.380 Vali Acc: 0.391 Test Loss: 3.380 Test Acc: 0.391
Validation loss decreased (-0.376776 --> -0.391271).  Saving model ...
Epoch: 11 cost time: 4.632468223571777
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 3.381 Vali Acc: 0.384 Test Loss: 3.381 Test Acc: 0.384
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.588769197463989
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 3.372 Vali Acc: 0.377 Test Loss: 3.372 Test Acc: 0.377
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.931303262710571
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.282 Vali Acc: 0.406 Test Loss: 3.282 Test Acc: 0.406
Validation loss decreased (-0.391271 --> -0.405764).  Saving model ...
Epoch: 14 cost time: 5.062024354934692
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.250 Vali Acc: 0.406 Test Loss: 3.250 Test Acc: 0.406
Validation loss decreased (-0.405764 --> -0.405765).  Saving model ...
Epoch: 15 cost time: 5.441934823989868
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.216 Vali Acc: 0.406 Test Loss: 3.216 Test Acc: 0.406
Validation loss decreased (-0.405765 --> -0.405765).  Saving model ...
Epoch: 16 cost time: 5.594487905502319
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.213 Vali Acc: 0.406 Test Loss: 3.213 Test Acc: 0.406
Validation loss decreased (-0.405765 --> -0.405765).  Saving model ...
Epoch: 17 cost time: 5.86734414100647
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.193 Vali Acc: 0.406 Test Loss: 3.193 Test Acc: 0.406
Validation loss decreased (-0.405765 --> -0.405765).  Saving model ...
Epoch: 18 cost time: 5.71103572845459
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.188 Vali Acc: 0.399 Test Loss: 3.188 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.147855520248413
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.227 Vali Acc: 0.406 Test Loss: 3.227 Test Acc: 0.406
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.212623357772827
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.265 Vali Acc: 0.413 Test Loss: 3.265 Test Acc: 0.413
Validation loss decreased (-0.405765 --> -0.413011).  Saving model ...
Epoch: 21 cost time: 4.333213806152344
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.297 Vali Acc: 0.413 Test Loss: 3.297 Test Acc: 0.413
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.8997602462768555
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.215 Vali Acc: 0.406 Test Loss: 3.215 Test Acc: 0.406
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.144025802612305
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.151 Vali Acc: 0.413 Test Loss: 3.151 Test Acc: 0.413
Validation loss decreased (-0.413011 --> -0.413012).  Saving model ...
Epoch: 24 cost time: 5.668030738830566
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.083 Vali Acc: 0.435 Test Loss: 3.083 Test Acc: 0.435
Validation loss decreased (-0.413012 --> -0.434752).  Saving model ...
Epoch: 25 cost time: 5.2796103954315186
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.129 Vali Acc: 0.442 Test Loss: 3.129 Test Acc: 0.442
Validation loss decreased (-0.434752 --> -0.441998).  Saving model ...
Epoch: 26 cost time: 4.882529020309448
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.121 Vali Acc: 0.442 Test Loss: 3.121 Test Acc: 0.442
Validation loss decreased (-0.441998 --> -0.441998).  Saving model ...
Epoch: 27 cost time: 5.5309669971466064
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.111 Vali Acc: 0.442 Test Loss: 3.111 Test Acc: 0.442
Validation loss decreased (-0.441998 --> -0.441998).  Saving model ...
Epoch: 28 cost time: 5.094799995422363
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.143 Vali Acc: 0.449 Test Loss: 3.143 Test Acc: 0.449
Validation loss decreased (-0.441998 --> -0.449244).  Saving model ...
Epoch: 29 cost time: 4.582298517227173
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.158 Vali Acc: 0.457 Test Loss: 3.158 Test Acc: 0.457
Validation loss decreased (-0.449244 --> -0.456490).  Saving model ...
Epoch: 30 cost time: 4.655935287475586
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.168 Vali Acc: 0.457 Test Loss: 3.168 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 4.361005544662476
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.146 Vali Acc: 0.457 Test Loss: 3.146 Test Acc: 0.457
Validation loss decreased (-0.456490 --> -0.456490).  Saving model ...
Epoch: 32 cost time: 5.745497465133667
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.168 Vali Acc: 0.457 Test Loss: 3.168 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 5.376265287399292
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.184 Vali Acc: 0.457 Test Loss: 3.184 Test Acc: 0.457
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 5.411971807479858
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.186 Vali Acc: 0.457 Test Loss: 3.186 Test Acc: 0.457
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 5.910145998001099
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.185 Vali Acc: 0.457 Test Loss: 3.185 Test Acc: 0.457
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 5.592159986495972
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.168 Vali Acc: 0.457 Test Loss: 3.168 Test Acc: 0.457
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 5.399702787399292
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.145 Vali Acc: 0.464 Test Loss: 3.145 Test Acc: 0.464
Validation loss decreased (-0.456490 --> -0.463737).  Saving model ...
Epoch: 38 cost time: 5.302118301391602
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.146 Vali Acc: 0.464 Test Loss: 3.146 Test Acc: 0.464
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 5.888519525527954
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.166 Vali Acc: 0.464 Test Loss: 3.166 Test Acc: 0.464
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 5.060525417327881
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.159 Vali Acc: 0.478 Test Loss: 3.159 Test Acc: 0.478
Validation loss decreased (-0.463737 --> -0.478229).  Saving model ...
Epoch: 41 cost time: 5.090213060379028
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.141 Vali Acc: 0.478 Test Loss: 3.141 Test Acc: 0.478
Validation loss decreased (-0.478229 --> -0.478229).  Saving model ...
Epoch: 42 cost time: 5.512794494628906
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.136 Vali Acc: 0.471 Test Loss: 3.136 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 5.253203630447388
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.139 Vali Acc: 0.471 Test Loss: 3.139 Test Acc: 0.471
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 4.784969091415405
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.161 Vali Acc: 0.471 Test Loss: 3.161 Test Acc: 0.471
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 4.7643091678619385
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.184 Vali Acc: 0.478 Test Loss: 3.184 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 5.468383073806763
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.185 Vali Acc: 0.478 Test Loss: 3.185 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 4.739701986312866
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.166 Vali Acc: 0.478 Test Loss: 3.166 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 4.438498258590698
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.151 Vali Acc: 0.478 Test Loss: 3.151 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 5.0131471157073975
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.139 Vali Acc: 0.486 Test Loss: 3.139 Test Acc: 0.486
Validation loss decreased (-0.478229 --> -0.485476).  Saving model ...
Epoch: 50 cost time: 5.376542568206787
Epoch: 50, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.137 Vali Acc: 0.486 Test Loss: 3.137 Test Acc: 0.486
Validation loss decreased (-0.485476 --> -0.485476).  Saving model ...
Epoch: 51 cost time: 5.134895324707031
Epoch: 51, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.149 Vali Acc: 0.486 Test Loss: 3.149 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 5.391191244125366
Epoch: 52, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.162 Vali Acc: 0.478 Test Loss: 3.162 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 5.561880111694336
Epoch: 53, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.157 Vali Acc: 0.478 Test Loss: 3.157 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 6.0857555866241455
Epoch: 54, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.149 Vali Acc: 0.486 Test Loss: 3.149 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 5.756492614746094
Epoch: 55, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.143 Vali Acc: 0.493 Test Loss: 3.143 Test Acc: 0.493
Validation loss decreased (-0.485476 --> -0.492722).  Saving model ...
Epoch: 56 cost time: 5.664865493774414
Epoch: 56, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.147 Vali Acc: 0.493 Test Loss: 3.147 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 5.53470778465271
Epoch: 57, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.145 Vali Acc: 0.493 Test Loss: 3.145 Test Acc: 0.493
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 4.882887125015259
Epoch: 58, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.160 Vali Acc: 0.486 Test Loss: 3.160 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 5.269628286361694
Epoch: 59, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.162 Vali Acc: 0.478 Test Loss: 3.162 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 5.309272289276123
Epoch: 60, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.153 Vali Acc: 0.478 Test Loss: 3.153 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 5.458811283111572
Epoch: 61, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.158 Vali Acc: 0.478 Test Loss: 3.158 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 5.573837757110596
Epoch: 62, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.155 Vali Acc: 0.478 Test Loss: 3.155 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 5.550308704376221
Epoch: 63, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.154 Vali Acc: 0.478 Test Loss: 3.154 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 5.4091808795928955
Epoch: 64, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.164 Vali Acc: 0.478 Test Loss: 3.164 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 5.411659479141235
Epoch: 65, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.168 Vali Acc: 0.478 Test Loss: 3.168 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.4927536231884058
model parameter : 17228804
model size : 85.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.564517974853516
Epoch: 1, Steps: 9 | Train Loss: 1.435 Vali Loss: 1.454 Vali Acc: 0.246 Test Loss: 1.454 Test Acc: 0.246
Validation loss decreased (inf --> -0.246362).  Saving model ...
Epoch: 2 cost time: 5.269883871078491
Epoch: 2, Steps: 9 | Train Loss: 1.027 Vali Loss: 1.371 Vali Acc: 0.283 Test Loss: 1.371 Test Acc: 0.283
Validation loss decreased (-0.246362 --> -0.282595).  Saving model ...
Epoch: 3 cost time: 5.407952308654785
Epoch: 3, Steps: 9 | Train Loss: 0.483 Vali Loss: 1.579 Vali Acc: 0.319 Test Loss: 1.579 Test Acc: 0.319
Validation loss decreased (-0.282595 --> -0.318825).  Saving model ...
Epoch: 4 cost time: 5.002902269363403
Epoch: 4, Steps: 9 | Train Loss: 0.191 Vali Loss: 1.674 Vali Acc: 0.326 Test Loss: 1.674 Test Acc: 0.326
Validation loss decreased (-0.318825 --> -0.326070).  Saving model ...
Epoch: 5 cost time: 4.805602312088013
Epoch: 5, Steps: 9 | Train Loss: 0.077 Vali Loss: 2.207 Vali Acc: 0.341 Test Loss: 2.207 Test Acc: 0.341
Validation loss decreased (-0.326070 --> -0.340558).  Saving model ...
Epoch: 6 cost time: 5.061789035797119
Epoch: 6, Steps: 9 | Train Loss: 0.021 Vali Loss: 1.881 Vali Acc: 0.464 Test Loss: 1.881 Test Acc: 0.464
Validation loss decreased (-0.340558 --> -0.463749).  Saving model ...
Epoch: 7 cost time: 4.5117552280426025
Epoch: 7, Steps: 9 | Train Loss: 0.009 Vali Loss: 2.601 Vali Acc: 0.326 Test Loss: 2.601 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.552264451980591
Epoch: 8, Steps: 9 | Train Loss: 0.003 Vali Loss: 2.742 Vali Acc: 0.362 Test Loss: 2.742 Test Acc: 0.362
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.50441575050354
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.497 Vali Acc: 0.399 Test Loss: 2.497 Test Acc: 0.399
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.552392244338989
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.359 Vali Acc: 0.420 Test Loss: 2.359 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.134392738342285
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.363 Vali Acc: 0.413 Test Loss: 2.363 Test Acc: 0.413
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.988548994064331
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.476 Vali Acc: 0.399 Test Loss: 2.476 Test Acc: 0.399
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.911186456680298
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.466 Vali Acc: 0.413 Test Loss: 2.466 Test Acc: 0.413
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.657853364944458
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.405 Vali Acc: 0.428 Test Loss: 2.405 Test Acc: 0.428
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.803299188613892
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.330 Vali Acc: 0.442 Test Loss: 2.330 Test Acc: 0.442
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.002669811248779
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.274 Vali Acc: 0.442 Test Loss: 2.274 Test Acc: 0.442
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.463768115942029
model parameter : 17228804
model size : 85.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         103                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma103_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.842588901519775
Epoch: 1, Steps: 9 | Train Loss: 1.375 Vali Loss: 1.191 Vali Acc: 0.529 Test Loss: 1.191 Test Acc: 0.529
Validation loss decreased (inf --> -0.528974).  Saving model ...
Epoch: 2 cost time: 4.698425531387329
Epoch: 2, Steps: 9 | Train Loss: 0.715 Vali Loss: 0.817 Vali Acc: 0.688 Test Loss: 0.817 Test Acc: 0.688
Validation loss decreased (-0.528974 --> -0.688398).  Saving model ...
Epoch: 3 cost time: 4.945972681045532
Epoch: 3, Steps: 9 | Train Loss: 0.208 Vali Loss: 0.683 Vali Acc: 0.746 Test Loss: 0.683 Test Acc: 0.746
Validation loss decreased (-0.688398 --> -0.746370).  Saving model ...
Epoch: 4 cost time: 5.5077126026153564
Epoch: 4, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.772 Vali Acc: 0.746 Test Loss: 0.772 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.442712306976318
Epoch: 5, Steps: 9 | Train Loss: 0.020 Vali Loss: 1.133 Vali Acc: 0.696 Test Loss: 1.133 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.283389091491699
Epoch: 6, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.682 Vali Acc: 0.812 Test Loss: 0.682 Test Acc: 0.812
Validation loss decreased (-0.746370 --> -0.811587).  Saving model ...
Epoch: 7 cost time: 5.827627420425415
Epoch: 7, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.700 Vali Acc: 0.804 Test Loss: 0.700 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.525707244873047
Epoch: 8, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.768 Vali Acc: 0.783 Test Loss: 0.768 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.686136960983276
Epoch: 9, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.768 Vali Acc: 0.819 Test Loss: 0.768 Test Acc: 0.819
Validation loss decreased (-0.811587 --> -0.818833).  Saving model ...
Epoch: 10 cost time: 5.467749834060669
Epoch: 10, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.759 Vali Acc: 0.826 Test Loss: 0.759 Test Acc: 0.826
Validation loss decreased (-0.818833 --> -0.826079).  Saving model ...
Epoch: 11 cost time: 5.21912407875061
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.753 Vali Acc: 0.819 Test Loss: 0.753 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.681911468505859
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.755 Vali Acc: 0.819 Test Loss: 0.755 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.1287829875946045
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.753 Vali Acc: 0.819 Test Loss: 0.753 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.737256765365601
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.757 Vali Acc: 0.819 Test Loss: 0.757 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.248974800109863
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.763 Vali Acc: 0.826 Test Loss: 0.763 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.549593448638916
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.763 Vali Acc: 0.826 Test Loss: 0.763 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.7312304973602295
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.758 Vali Acc: 0.826 Test Loss: 0.758 Test Acc: 0.826
Validation loss decreased (-0.826079 --> -0.826079).  Saving model ...
Epoch: 18 cost time: 5.334806680679321
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.768 Vali Acc: 0.826 Test Loss: 0.768 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.413666486740112
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.771 Vali Acc: 0.826 Test Loss: 0.771 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.426596403121948
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.765 Vali Acc: 0.826 Test Loss: 0.765 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.162254571914673
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.765 Vali Acc: 0.826 Test Loss: 0.765 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.227235317230225
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.768 Vali Acc: 0.826 Test Loss: 0.768 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.512105703353882
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.770 Vali Acc: 0.826 Test Loss: 0.770 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.607830047607422
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.766 Vali Acc: 0.833 Test Loss: 0.766 Test Acc: 0.833
Validation loss decreased (-0.826079 --> -0.833326).  Saving model ...
Epoch: 25 cost time: 4.955521821975708
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.763 Vali Acc: 0.826 Test Loss: 0.763 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.147011756896973
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.761 Vali Acc: 0.826 Test Loss: 0.761 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.37628960609436
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.764 Vali Acc: 0.826 Test Loss: 0.764 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 5.94114089012146
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.772 Vali Acc: 0.826 Test Loss: 0.772 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 5.016448736190796
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.767 Vali Acc: 0.826 Test Loss: 0.767 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 5.031998157501221
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.765 Vali Acc: 0.833 Test Loss: 0.765 Test Acc: 0.833
Validation loss decreased (-0.833326 --> -0.833326).  Saving model ...
Epoch: 31 cost time: 5.411865949630737
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.767 Vali Acc: 0.833 Test Loss: 0.767 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 6.176924228668213
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.768 Vali Acc: 0.833 Test Loss: 0.768 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 5.058949947357178
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.770 Vali Acc: 0.833 Test Loss: 0.770 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 4.982785940170288
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.774 Vali Acc: 0.841 Test Loss: 0.774 Test Acc: 0.841
Validation loss decreased (-0.833326 --> -0.840572).  Saving model ...
Epoch: 35 cost time: 4.244499444961548
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.772 Vali Acc: 0.841 Test Loss: 0.772 Test Acc: 0.841
Validation loss decreased (-0.840572 --> -0.840572).  Saving model ...
Epoch: 36 cost time: 4.7157206535339355
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.774 Vali Acc: 0.841 Test Loss: 0.774 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 4.71736216545105
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.772 Vali Acc: 0.841 Test Loss: 0.772 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 5.2895026206970215
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.770 Vali Acc: 0.841 Test Loss: 0.770 Test Acc: 0.841
Validation loss decreased (-0.840572 --> -0.840572).  Saving model ...
Epoch: 39 cost time: 5.340683221817017
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.770 Vali Acc: 0.848 Test Loss: 0.770 Test Acc: 0.848
Validation loss decreased (-0.840572 --> -0.847818).  Saving model ...
Epoch: 40 cost time: 5.1035919189453125
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.771 Vali Acc: 0.848 Test Loss: 0.771 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 5.3999550342559814
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.774 Vali Acc: 0.841 Test Loss: 0.774 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 5.0203657150268555
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.775 Vali Acc: 0.841 Test Loss: 0.775 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 4.859390020370483
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.776 Vali Acc: 0.841 Test Loss: 0.776 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 4.956438064575195
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.776 Vali Acc: 0.841 Test Loss: 0.776 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 4.859352111816406
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.841 Test Loss: 0.777 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 5.660354137420654
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.776 Vali Acc: 0.841 Test Loss: 0.776 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 5.885040283203125
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.841 Test Loss: 0.777 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 5.721491098403931
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.776 Vali Acc: 0.841 Test Loss: 0.776 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 5.210096120834351
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.774 Vali Acc: 0.848 Test Loss: 0.774 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma103_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 14083076
model size : 73.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         83                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma83_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.384992837905884
Epoch: 1, Steps: 9 | Train Loss: 1.378 Vali Loss: 1.183 Vali Acc: 0.529 Test Loss: 1.183 Test Acc: 0.529
Validation loss decreased (inf --> -0.528974).  Saving model ...
Epoch: 2 cost time: 5.088428735733032
Epoch: 2, Steps: 9 | Train Loss: 0.736 Vali Loss: 0.801 Vali Acc: 0.717 Test Loss: 0.801 Test Acc: 0.717
Validation loss decreased (-0.528974 --> -0.717383).  Saving model ...
Epoch: 3 cost time: 4.956009387969971
Epoch: 3, Steps: 9 | Train Loss: 0.219 Vali Loss: 0.634 Vali Acc: 0.768 Test Loss: 0.634 Test Acc: 0.768
Validation loss decreased (-0.717383 --> -0.768110).  Saving model ...
Epoch: 4 cost time: 5.12128210067749
Epoch: 4, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.654 Vali Acc: 0.812 Test Loss: 0.654 Test Acc: 0.812
Validation loss decreased (-0.768110 --> -0.811588).  Saving model ...
Epoch: 5 cost time: 5.126440525054932
Epoch: 5, Steps: 9 | Train Loss: 0.022 Vali Loss: 1.130 Vali Acc: 0.710 Test Loss: 1.130 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.32763409614563
Epoch: 6, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.658 Vali Acc: 0.826 Test Loss: 0.658 Test Acc: 0.826
Validation loss decreased (-0.811588 --> -0.826080).  Saving model ...
Epoch: 7 cost time: 5.359899520874023
Epoch: 7, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.604 Vali Acc: 0.855 Test Loss: 0.604 Test Acc: 0.855
Validation loss decreased (-0.826080 --> -0.855066).  Saving model ...
Epoch: 8 cost time: 4.760882377624512
Epoch: 8, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.683 Vali Acc: 0.848 Test Loss: 0.683 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.859163999557495
Epoch: 9, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.768 Vali Acc: 0.819 Test Loss: 0.768 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.029141187667847
Epoch: 10, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.758 Vali Acc: 0.812 Test Loss: 0.758 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.684067726135254
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.730 Vali Acc: 0.819 Test Loss: 0.730 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.672277450561523
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.725 Vali Acc: 0.819 Test Loss: 0.725 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.49089503288269
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.720 Vali Acc: 0.819 Test Loss: 0.720 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.642223596572876
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.729 Vali Acc: 0.819 Test Loss: 0.729 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.300355434417725
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.741 Vali Acc: 0.819 Test Loss: 0.741 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.7032270431518555
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.740 Vali Acc: 0.826 Test Loss: 0.740 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.306575059890747
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.727 Vali Acc: 0.819 Test Loss: 0.727 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma83_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 14083076
model size : 73.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         62                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma62_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 7.446502447128296
Epoch: 1, Steps: 9 | Train Loss: 1.365 Vali Loss: 1.197 Vali Acc: 0.522 Test Loss: 1.197 Test Acc: 0.522
Validation loss decreased (inf --> -0.521727).  Saving model ...
Epoch: 2 cost time: 5.223917245864868
Epoch: 2, Steps: 9 | Train Loss: 0.726 Vali Loss: 0.823 Vali Acc: 0.717 Test Loss: 0.823 Test Acc: 0.717
Validation loss decreased (-0.521727 --> -0.717383).  Saving model ...
Epoch: 3 cost time: 5.029501438140869
Epoch: 3, Steps: 9 | Train Loss: 0.211 Vali Loss: 0.672 Vali Acc: 0.768 Test Loss: 0.672 Test Acc: 0.768
Validation loss decreased (-0.717383 --> -0.768109).  Saving model ...
Epoch: 4 cost time: 5.139096260070801
Epoch: 4, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.807 Vali Acc: 0.775 Test Loss: 0.807 Test Acc: 0.775
Validation loss decreased (-0.768109 --> -0.775354).  Saving model ...
Epoch: 5 cost time: 4.848587512969971
Epoch: 5, Steps: 9 | Train Loss: 0.025 Vali Loss: 1.120 Vali Acc: 0.717 Test Loss: 1.120 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.8145482540130615
Epoch: 6, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.655 Vali Acc: 0.841 Test Loss: 0.655 Test Acc: 0.841
Validation loss decreased (-0.775354 --> -0.840573).  Saving model ...
Epoch: 7 cost time: 4.88803243637085
Epoch: 7, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.663 Vali Acc: 0.848 Test Loss: 0.663 Test Acc: 0.848
Validation loss decreased (-0.840573 --> -0.847819).  Saving model ...
Epoch: 8 cost time: 5.305128335952759
Epoch: 8, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.718 Vali Acc: 0.862 Test Loss: 0.718 Test Acc: 0.862
Validation loss decreased (-0.847819 --> -0.862312).  Saving model ...
Epoch: 9 cost time: 5.603604793548584
Epoch: 9, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.753 Vali Acc: 0.848 Test Loss: 0.753 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.1877405643463135
Epoch: 10, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.695 Vali Acc: 0.877 Test Loss: 0.695 Test Acc: 0.877
Validation loss decreased (-0.862312 --> -0.876805).  Saving model ...
Epoch: 11 cost time: 5.1251380443573
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.674 Vali Acc: 0.884 Test Loss: 0.674 Test Acc: 0.884
Validation loss decreased (-0.876805 --> -0.884051).  Saving model ...
Epoch: 12 cost time: 5.125064134597778
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.682 Vali Acc: 0.877 Test Loss: 0.682 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.027878761291504
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.686 Vali Acc: 0.884 Test Loss: 0.686 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.077967166900635
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.699 Vali Acc: 0.877 Test Loss: 0.699 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.8952956199646
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.711 Vali Acc: 0.862 Test Loss: 0.711 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.717420816421509
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.708 Vali Acc: 0.862 Test Loss: 0.708 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.011375188827515
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.694 Vali Acc: 0.877 Test Loss: 0.694 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.211963891983032
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.705 Vali Acc: 0.877 Test Loss: 0.705 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.148287773132324
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.712 Vali Acc: 0.877 Test Loss: 0.712 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.452826738357544
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.710 Vali Acc: 0.891 Test Loss: 0.710 Test Acc: 0.891
Validation loss decreased (-0.884051 --> -0.891297).  Saving model ...
Epoch: 21 cost time: 5.335156679153442
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.714 Vali Acc: 0.891 Test Loss: 0.714 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.832360506057739
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.716 Vali Acc: 0.891 Test Loss: 0.716 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.514263391494751
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.715 Vali Acc: 0.891 Test Loss: 0.715 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.4677817821502686
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.710 Vali Acc: 0.891 Test Loss: 0.710 Test Acc: 0.891
Validation loss decreased (-0.891297 --> -0.891297).  Saving model ...
Epoch: 25 cost time: 4.8368542194366455
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.709 Vali Acc: 0.899 Test Loss: 0.709 Test Acc: 0.899
Validation loss decreased (-0.891297 --> -0.898544).  Saving model ...
Epoch: 26 cost time: 5.023478269577026
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.712 Vali Acc: 0.899 Test Loss: 0.712 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.065703392028809
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.716 Vali Acc: 0.899 Test Loss: 0.716 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 5.558107376098633
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.724 Vali Acc: 0.906 Test Loss: 0.724 Test Acc: 0.906
Validation loss decreased (-0.898544 --> -0.905790).  Saving model ...
Epoch: 29 cost time: 4.17687463760376
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.722 Vali Acc: 0.899 Test Loss: 0.722 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.844111204147339
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.720 Vali Acc: 0.899 Test Loss: 0.720 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 5.382782220840454
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.723 Vali Acc: 0.906 Test Loss: 0.723 Test Acc: 0.906
Validation loss decreased (-0.905790 --> -0.905790).  Saving model ...
Epoch: 32 cost time: 5.364360332489014
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.720 Vali Acc: 0.899 Test Loss: 0.720 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 5.180670976638794
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.720 Vali Acc: 0.891 Test Loss: 0.720 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 5.213256359100342
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.724 Vali Acc: 0.899 Test Loss: 0.724 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 5.226443290710449
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.724 Vali Acc: 0.899 Test Loss: 0.724 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 5.1744065284729
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.726 Vali Acc: 0.899 Test Loss: 0.726 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 4.89231276512146
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.725 Vali Acc: 0.899 Test Loss: 0.725 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 4.593115329742432
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.722 Vali Acc: 0.899 Test Loss: 0.722 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 4.315037727355957
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.723 Vali Acc: 0.906 Test Loss: 0.723 Test Acc: 0.906
Validation loss decreased (-0.905790 --> -0.905790).  Saving model ...
Epoch: 40 cost time: 5.017072439193726
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.725 Vali Acc: 0.906 Test Loss: 0.725 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 4.511303186416626
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.731 Vali Acc: 0.899 Test Loss: 0.731 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 5.131433963775635
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.732 Vali Acc: 0.899 Test Loss: 0.732 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 5.037785530090332
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.732 Vali Acc: 0.899 Test Loss: 0.732 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 5.5902440547943115
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.734 Vali Acc: 0.899 Test Loss: 0.734 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 5.702394247055054
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.735 Vali Acc: 0.899 Test Loss: 0.735 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 5.8051230907440186
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.734 Vali Acc: 0.899 Test Loss: 0.734 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 5.786648750305176
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.735 Vali Acc: 0.899 Test Loss: 0.735 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 5.386552095413208
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.734 Vali Acc: 0.899 Test Loss: 0.734 Test Acc: 0.899
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 5.09592866897583
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.730 Vali Acc: 0.906 Test Loss: 0.730 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma62_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 14083076
model size : 73.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         42                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.903696775436401
Epoch: 1, Steps: 9 | Train Loss: 1.344 Vali Loss: 1.152 Vali Acc: 0.529 Test Loss: 1.152 Test Acc: 0.529
Validation loss decreased (inf --> -0.528974).  Saving model ...
Epoch: 2 cost time: 5.432804584503174
Epoch: 2, Steps: 9 | Train Loss: 0.694 Vali Loss: 0.780 Vali Acc: 0.703 Test Loss: 0.780 Test Acc: 0.703
Validation loss decreased (-0.528974 --> -0.702891).  Saving model ...
Epoch: 3 cost time: 5.288184404373169
Epoch: 3, Steps: 9 | Train Loss: 0.216 Vali Loss: 0.574 Vali Acc: 0.804 Test Loss: 0.574 Test Acc: 0.804
Validation loss decreased (-0.702891 --> -0.804342).  Saving model ...
Epoch: 4 cost time: 5.715869903564453
Epoch: 4, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.900 Vali Acc: 0.761 Test Loss: 0.900 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.401943206787109
Epoch: 5, Steps: 9 | Train Loss: 0.050 Vali Loss: 1.114 Vali Acc: 0.696 Test Loss: 1.114 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.4244794845581055
Epoch: 6, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.595 Vali Acc: 0.819 Test Loss: 0.595 Test Acc: 0.819
Validation loss decreased (-0.804342 --> -0.818835).  Saving model ...
Epoch: 7 cost time: 4.418254375457764
Epoch: 7, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.603 Vali Acc: 0.826 Test Loss: 0.603 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826081).  Saving model ...
Epoch: 8 cost time: 4.392571926116943
Epoch: 8, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.736 Vali Acc: 0.833 Test Loss: 0.736 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833326).  Saving model ...
Epoch: 9 cost time: 4.720675945281982
Epoch: 9, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.727 Vali Acc: 0.826 Test Loss: 0.727 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.139420986175537
Epoch: 10, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.660 Vali Acc: 0.841 Test Loss: 0.660 Test Acc: 0.841
Validation loss decreased (-0.833326 --> -0.840573).  Saving model ...
Epoch: 11 cost time: 4.119115829467773
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.629 Vali Acc: 0.841 Test Loss: 0.629 Test Acc: 0.841
Validation loss decreased (-0.840573 --> -0.840573).  Saving model ...
Epoch: 12 cost time: 4.861366033554077
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.632 Vali Acc: 0.841 Test Loss: 0.632 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.244966506958008
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.631 Vali Acc: 0.841 Test Loss: 0.631 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.204515695571899
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.642 Vali Acc: 0.841 Test Loss: 0.642 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.873810291290283
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.656 Vali Acc: 0.841 Test Loss: 0.656 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.282869100570679
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.663 Vali Acc: 0.841 Test Loss: 0.663 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.106378078460693
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.660 Vali Acc: 0.841 Test Loss: 0.660 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.494367599487305
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.669 Vali Acc: 0.841 Test Loss: 0.669 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.064729690551758
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.672 Vali Acc: 0.841 Test Loss: 0.672 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.255550146102905
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.669 Vali Acc: 0.841 Test Loss: 0.669 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.122174263000488
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.669 Vali Acc: 0.841 Test Loss: 0.669 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 14083076
model size : 73.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.7425854206085205
Epoch: 1, Steps: 9 | Train Loss: 1.351 Vali Loss: 1.171 Vali Acc: 0.507 Test Loss: 1.171 Test Acc: 0.507
Validation loss decreased (inf --> -0.507235).  Saving model ...
Epoch: 2 cost time: 5.26819634437561
Epoch: 2, Steps: 9 | Train Loss: 0.710 Vali Loss: 0.779 Vali Acc: 0.703 Test Loss: 0.779 Test Acc: 0.703
Validation loss decreased (-0.507235 --> -0.702891).  Saving model ...
Epoch: 3 cost time: 5.202397584915161
Epoch: 3, Steps: 9 | Train Loss: 0.230 Vali Loss: 0.570 Vali Acc: 0.812 Test Loss: 0.570 Test Acc: 0.812
Validation loss decreased (-0.702891 --> -0.811589).  Saving model ...
Epoch: 4 cost time: 5.106642484664917
Epoch: 4, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.711 Vali Acc: 0.783 Test Loss: 0.711 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.8259570598602295
Epoch: 5, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.872 Vali Acc: 0.746 Test Loss: 0.872 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.164026737213135
Epoch: 6, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.459 Vali Acc: 0.833 Test Loss: 0.459 Test Acc: 0.833
Validation loss decreased (-0.811589 --> -0.833329).  Saving model ...
Epoch: 7 cost time: 4.565732717514038
Epoch: 7, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.557 Vali Acc: 0.826 Test Loss: 0.557 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.088350296020508
Epoch: 8, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.612 Vali Acc: 0.812 Test Loss: 0.612 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.083117246627808
Epoch: 9, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.518 Vali Acc: 0.848 Test Loss: 0.518 Test Acc: 0.848
Validation loss decreased (-0.833329 --> -0.847821).  Saving model ...
Epoch: 10 cost time: 4.672605037689209
Epoch: 10, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.455 Vali Acc: 0.848 Test Loss: 0.455 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847822).  Saving model ...
Epoch: 11 cost time: 4.737963676452637
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.438 Vali Acc: 0.855 Test Loss: 0.438 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 12 cost time: 4.0555291175842285
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.445 Vali Acc: 0.870 Test Loss: 0.445 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869561).  Saving model ...
Epoch: 13 cost time: 4.547207593917847
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.453 Vali Acc: 0.870 Test Loss: 0.453 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.777307987213135
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.463 Vali Acc: 0.870 Test Loss: 0.463 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.754698276519775
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.470 Vali Acc: 0.870 Test Loss: 0.470 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.391762971878052
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.471 Vali Acc: 0.870 Test Loss: 0.471 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.092743158340454
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.460 Vali Acc: 0.870 Test Loss: 0.460 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.5593297481536865
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.462 Vali Acc: 0.870 Test Loss: 0.462 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.703818321228027
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.468 Vali Acc: 0.870 Test Loss: 0.468 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.882831335067749
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.466 Vali Acc: 0.870 Test Loss: 0.466 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.088180065155029
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.870 Test Loss: 0.467 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.7080466747283936
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.870 Test Loss: 0.467 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 14083076
model size : 73.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 7.155317544937134
Epoch: 1, Steps: 9 | Train Loss: 1.391 Vali Loss: 1.190 Vali Acc: 0.500 Test Loss: 1.190 Test Acc: 0.500
Validation loss decreased (inf --> -0.499988).  Saving model ...
Epoch: 2 cost time: 5.0657806396484375
Epoch: 2, Steps: 9 | Train Loss: 0.773 Vali Loss: 0.789 Vali Acc: 0.696 Test Loss: 0.789 Test Acc: 0.696
Validation loss decreased (-0.499988 --> -0.695644).  Saving model ...
Epoch: 3 cost time: 5.104043960571289
Epoch: 3, Steps: 9 | Train Loss: 0.246 Vali Loss: 0.671 Vali Acc: 0.739 Test Loss: 0.671 Test Acc: 0.739
Validation loss decreased (-0.695644 --> -0.739124).  Saving model ...
Epoch: 4 cost time: 4.914020299911499
Epoch: 4, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.752 Vali Acc: 0.717 Test Loss: 0.752 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.785903215408325
Epoch: 5, Steps: 9 | Train Loss: 0.042 Vali Loss: 1.004 Vali Acc: 0.703 Test Loss: 1.004 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.265566825866699
Epoch: 6, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.546 Vali Acc: 0.797 Test Loss: 0.546 Test Acc: 0.797
Validation loss decreased (-0.739124 --> -0.797096).  Saving model ...
Epoch: 7 cost time: 4.549581289291382
Epoch: 7, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.623 Vali Acc: 0.797 Test Loss: 0.623 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.740314245223999
Epoch: 8, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.565 Vali Acc: 0.819 Test Loss: 0.565 Test Acc: 0.819
Validation loss decreased (-0.797096 --> -0.818835).  Saving model ...
Epoch: 9 cost time: 4.766603469848633
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.663 Vali Acc: 0.790 Test Loss: 0.663 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.077415943145752
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.789 Vali Acc: 0.768 Test Loss: 0.789 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.122417449951172
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.701 Vali Acc: 0.812 Test Loss: 0.701 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.124033689498901
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.647 Vali Acc: 0.804 Test Loss: 0.647 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.920690059661865
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.638 Vali Acc: 0.797 Test Loss: 0.638 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.086993217468262
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.643 Vali Acc: 0.797 Test Loss: 0.643 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.774263858795166
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.656 Vali Acc: 0.797 Test Loss: 0.656 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.0675928592681885
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.672 Vali Acc: 0.797 Test Loss: 0.672 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.304099082946777
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.663 Vali Acc: 0.797 Test Loss: 0.663 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.489069938659668
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.660 Vali Acc: 0.797 Test Loss: 0.660 Test Acc: 0.797
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8188405797101449
model parameter : 14083076
model size : 73.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 7.495100498199463
Epoch: 1, Steps: 9 | Train Loss: 1.437 Vali Loss: 1.225 Vali Acc: 0.500 Test Loss: 1.225 Test Acc: 0.500
Validation loss decreased (inf --> -0.499988).  Saving model ...
Epoch: 2 cost time: 5.099744081497192
Epoch: 2, Steps: 9 | Train Loss: 0.822 Vali Loss: 0.900 Vali Acc: 0.659 Test Loss: 0.900 Test Acc: 0.659
Validation loss decreased (-0.499988 --> -0.659411).  Saving model ...
Epoch: 3 cost time: 5.109835624694824
Epoch: 3, Steps: 9 | Train Loss: 0.285 Vali Loss: 0.861 Vali Acc: 0.674 Test Loss: 0.861 Test Acc: 0.674
Validation loss decreased (-0.659411 --> -0.673904).  Saving model ...
Epoch: 4 cost time: 5.077057361602783
Epoch: 4, Steps: 9 | Train Loss: 0.106 Vali Loss: 1.335 Vali Acc: 0.572 Test Loss: 1.335 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.878219366073608
Epoch: 5, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.943 Vali Acc: 0.703 Test Loss: 0.943 Test Acc: 0.703
Validation loss decreased (-0.673904 --> -0.702889).  Saving model ...
Epoch: 6 cost time: 4.547367572784424
Epoch: 6, Steps: 9 | Train Loss: 0.011 Vali Loss: 1.024 Vali Acc: 0.674 Test Loss: 1.024 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.575024366378784
Epoch: 7, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.997 Vali Acc: 0.688 Test Loss: 0.997 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.484627962112427
Epoch: 8, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.079 Vali Acc: 0.703 Test Loss: 1.079 Test Acc: 0.703
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.912411451339722
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.069 Vali Acc: 0.710 Test Loss: 1.069 Test Acc: 0.710
Validation loss decreased (-0.702889 --> -0.710134).  Saving model ...
Epoch: 10 cost time: 4.01692795753479
Epoch: 10, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.074 Vali Acc: 0.703 Test Loss: 1.074 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.1108222007751465
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.070 Vali Acc: 0.696 Test Loss: 1.070 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.9716691970825195
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.067 Vali Acc: 0.710 Test Loss: 1.067 Test Acc: 0.710
Validation loss decreased (-0.710134 --> -0.710134).  Saving model ...
Epoch: 13 cost time: 4.666763782501221
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.066 Vali Acc: 0.703 Test Loss: 1.066 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.9953038692474365
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.071 Vali Acc: 0.710 Test Loss: 1.071 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.1849822998046875
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.075 Vali Acc: 0.710 Test Loss: 1.075 Test Acc: 0.710
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.840949535369873
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.078 Vali Acc: 0.710 Test Loss: 1.078 Test Acc: 0.710
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.3258421421051025
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.079 Vali Acc: 0.710 Test Loss: 1.079 Test Acc: 0.710
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.1908791065216064
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.081 Vali Acc: 0.710 Test Loss: 1.081 Test Acc: 0.710
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.905667066574097
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.085 Vali Acc: 0.710 Test Loss: 1.085 Test Acc: 0.710
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.207592964172363
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.085 Vali Acc: 0.710 Test Loss: 1.085 Test Acc: 0.710
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.9407522678375244
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.083 Vali Acc: 0.710 Test Loss: 1.083 Test Acc: 0.710
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.397409915924072
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.084 Vali Acc: 0.710 Test Loss: 1.084 Test Acc: 0.710
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7101449275362319
model parameter : 14083076
model size : 73.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 7.170908689498901
Epoch: 1, Steps: 9 | Train Loss: 1.463 Vali Loss: 1.404 Vali Acc: 0.304 Test Loss: 1.404 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 5.011096715927124
Epoch: 2, Steps: 9 | Train Loss: 0.969 Vali Loss: 1.316 Vali Acc: 0.391 Test Loss: 1.316 Test Acc: 0.391
Validation loss decreased (-0.304334 --> -0.391291).  Saving model ...
Epoch: 3 cost time: 4.6709840297698975
Epoch: 3, Steps: 9 | Train Loss: 0.377 Vali Loss: 1.314 Vali Acc: 0.420 Test Loss: 1.314 Test Acc: 0.420
Validation loss decreased (-0.391291 --> -0.420277).  Saving model ...
Epoch: 4 cost time: 4.72324800491333
Epoch: 4, Steps: 9 | Train Loss: 0.130 Vali Loss: 1.870 Vali Acc: 0.341 Test Loss: 1.870 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.88845419883728
Epoch: 5, Steps: 9 | Train Loss: 0.045 Vali Loss: 1.631 Vali Acc: 0.442 Test Loss: 1.631 Test Acc: 0.442
Validation loss decreased (-0.420277 --> -0.442013).  Saving model ...
Epoch: 6 cost time: 5.071731328964233
Epoch: 6, Steps: 9 | Train Loss: 0.018 Vali Loss: 1.835 Vali Acc: 0.457 Test Loss: 1.835 Test Acc: 0.457
Validation loss decreased (-0.442013 --> -0.456503).  Saving model ...
Epoch: 7 cost time: 5.165686368942261
Epoch: 7, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.837 Vali Acc: 0.486 Test Loss: 1.837 Test Acc: 0.486
Validation loss decreased (-0.456503 --> -0.485489).  Saving model ...
Epoch: 8 cost time: 5.230710983276367
Epoch: 8, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.905 Vali Acc: 0.449 Test Loss: 1.905 Test Acc: 0.449
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.373668432235718
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.868 Vali Acc: 0.471 Test Loss: 1.868 Test Acc: 0.471
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.410350799560547
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.921 Vali Acc: 0.493 Test Loss: 1.921 Test Acc: 0.493
Validation loss decreased (-0.485489 --> -0.492734).  Saving model ...
Epoch: 11 cost time: 3.9204163551330566
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.882 Vali Acc: 0.522 Test Loss: 1.882 Test Acc: 0.522
Validation loss decreased (-0.492734 --> -0.521720).  Saving model ...
Epoch: 12 cost time: 4.501971483230591
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.781 Vali Acc: 0.514 Test Loss: 1.781 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.791252851486206
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.783 Vali Acc: 0.514 Test Loss: 1.783 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.070235013961792
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.815 Vali Acc: 0.514 Test Loss: 1.815 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.02734112739563
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.801 Vali Acc: 0.514 Test Loss: 1.801 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.002244472503662
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.779 Vali Acc: 0.522 Test Loss: 1.779 Test Acc: 0.522
Validation loss decreased (-0.521720 --> -0.521721).  Saving model ...
Epoch: 17 cost time: 4.3957953453063965
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.778 Vali Acc: 0.522 Test Loss: 1.778 Test Acc: 0.522
Validation loss decreased (-0.521721 --> -0.521721).  Saving model ...
Epoch: 18 cost time: 4.250925540924072
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.758 Vali Acc: 0.551 Test Loss: 1.758 Test Acc: 0.551
Validation loss decreased (-0.521721 --> -0.550707).  Saving model ...
Epoch: 19 cost time: 4.437899827957153
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.777 Vali Acc: 0.536 Test Loss: 1.777 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.691974401473999
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.799 Vali Acc: 0.536 Test Loss: 1.799 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.992868423461914
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.805 Vali Acc: 0.536 Test Loss: 1.805 Test Acc: 0.536
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.138578176498413
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.787 Vali Acc: 0.543 Test Loss: 1.787 Test Acc: 0.543
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.168113708496094
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.763 Vali Acc: 0.565 Test Loss: 1.763 Test Acc: 0.565
Validation loss decreased (-0.550707 --> -0.565200).  Saving model ...
Epoch: 24 cost time: 5.074273586273193
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.771 Vali Acc: 0.565 Test Loss: 1.771 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.938601732254028
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.780 Vali Acc: 0.565 Test Loss: 1.780 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.951213359832764
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.785 Vali Acc: 0.572 Test Loss: 1.785 Test Acc: 0.572
Validation loss decreased (-0.565200 --> -0.572446).  Saving model ...
Epoch: 27 cost time: 4.825233697891235
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.770 Vali Acc: 0.565 Test Loss: 1.770 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.598051071166992
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.742 Vali Acc: 0.572 Test Loss: 1.742 Test Acc: 0.572
Validation loss decreased (-0.572446 --> -0.572446).  Saving model ...
Epoch: 29 cost time: 4.75060248374939
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.740 Vali Acc: 0.580 Test Loss: 1.740 Test Acc: 0.580
Validation loss decreased (-0.572446 --> -0.579693).  Saving model ...
Epoch: 30 cost time: 4.651281833648682
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.746 Vali Acc: 0.580 Test Loss: 1.746 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 4.782264947891235
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.751 Vali Acc: 0.572 Test Loss: 1.751 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 5.157165050506592
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.745 Vali Acc: 0.580 Test Loss: 1.745 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 4.655691862106323
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.743 Vali Acc: 0.587 Test Loss: 1.743 Test Acc: 0.587
Validation loss decreased (-0.579693 --> -0.586939).  Saving model ...
Epoch: 34 cost time: 4.291520357131958
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.737 Vali Acc: 0.587 Test Loss: 1.737 Test Acc: 0.587
Validation loss decreased (-0.586939 --> -0.586939).  Saving model ...
Epoch: 35 cost time: 3.962038516998291
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.743 Vali Acc: 0.587 Test Loss: 1.743 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 4.184268474578857
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.748 Vali Acc: 0.587 Test Loss: 1.748 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 4.44441032409668
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.749 Vali Acc: 0.580 Test Loss: 1.749 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 4.682157039642334
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.751 Vali Acc: 0.587 Test Loss: 1.751 Test Acc: 0.587
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 5.14065146446228
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.751 Vali Acc: 0.580 Test Loss: 1.751 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 5.050510406494141
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.742 Vali Acc: 0.587 Test Loss: 1.742 Test Acc: 0.587
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 5.209470987319946
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.739 Vali Acc: 0.594 Test Loss: 1.739 Test Acc: 0.594
Validation loss decreased (-0.586939 --> -0.594186).  Saving model ...
Epoch: 42 cost time: 4.9706714153289795
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.747 Vali Acc: 0.580 Test Loss: 1.747 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 4.759498357772827
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.750 Vali Acc: 0.580 Test Loss: 1.750 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 5.120782136917114
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.753 Vali Acc: 0.580 Test Loss: 1.753 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 5.162099123001099
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.755 Vali Acc: 0.580 Test Loss: 1.755 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 5.118303537368774
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.758 Vali Acc: 0.580 Test Loss: 1.758 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 4.217787981033325
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.755 Vali Acc: 0.587 Test Loss: 1.755 Test Acc: 0.587
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 4.208510875701904
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.754 Vali Acc: 0.594 Test Loss: 1.754 Test Acc: 0.594
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 4.577064752578735
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.751 Vali Acc: 0.594 Test Loss: 1.751 Test Acc: 0.594
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 4.712090253829956
Epoch: 50, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.750 Vali Acc: 0.594 Test Loss: 1.750 Test Acc: 0.594
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 4.418024063110352
Epoch: 51, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.752 Vali Acc: 0.601 Test Loss: 1.752 Test Acc: 0.601
Validation loss decreased (-0.594186 --> -0.601432).  Saving model ...
Epoch: 52 cost time: 3.525949478149414
Epoch: 52, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.753 Vali Acc: 0.601 Test Loss: 1.753 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 4.5614333152771
Epoch: 53, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.754 Vali Acc: 0.601 Test Loss: 1.754 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 5.215268135070801
Epoch: 54, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.756 Vali Acc: 0.601 Test Loss: 1.756 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 5.289318323135376
Epoch: 55, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.758 Vali Acc: 0.601 Test Loss: 1.758 Test Acc: 0.601
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 5.164168357849121
Epoch: 56, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.756 Vali Acc: 0.601 Test Loss: 1.756 Test Acc: 0.601
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 4.953340768814087
Epoch: 57, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.766 Vali Acc: 0.601 Test Loss: 1.766 Test Acc: 0.601
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 4.760634660720825
Epoch: 58, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.768 Vali Acc: 0.609 Test Loss: 1.768 Test Acc: 0.609
Validation loss decreased (-0.601432 --> -0.608678).  Saving model ...
Epoch: 59 cost time: 4.565959930419922
Epoch: 59, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.772 Vali Acc: 0.601 Test Loss: 1.772 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 3.9538064002990723
Epoch: 60, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.776 Vali Acc: 0.609 Test Loss: 1.776 Test Acc: 0.609
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 4.250258445739746
Epoch: 61, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.771 Vali Acc: 0.609 Test Loss: 1.771 Test Acc: 0.609
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 4.850238561630249
Epoch: 62, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.768 Vali Acc: 0.609 Test Loss: 1.768 Test Acc: 0.609
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 4.801374673843384
Epoch: 63, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.767 Vali Acc: 0.601 Test Loss: 1.767 Test Acc: 0.601
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 5.641100883483887
Epoch: 64, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.761 Vali Acc: 0.609 Test Loss: 1.761 Test Acc: 0.609
Validation loss decreased (-0.608678 --> -0.608678).  Saving model ...
Epoch: 65 cost time: 5.034743309020996
Epoch: 65, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.761 Vali Acc: 0.616 Test Loss: 1.761 Test Acc: 0.616
Validation loss decreased (-0.608678 --> -0.615924).  Saving model ...
Epoch: 66 cost time: 4.569960594177246
Epoch: 66, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.763 Vali Acc: 0.623 Test Loss: 1.763 Test Acc: 0.623
Validation loss decreased (-0.615924 --> -0.623171).  Saving model ...
Epoch: 67 cost time: 4.2315545082092285
Epoch: 67, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.765 Vali Acc: 0.638 Test Loss: 1.765 Test Acc: 0.638
Validation loss decreased (-0.623171 --> -0.637664).  Saving model ...
Epoch: 68 cost time: 5.303762197494507
Epoch: 68, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.772 Vali Acc: 0.623 Test Loss: 1.772 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 5.055726051330566
Epoch: 69, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.775 Vali Acc: 0.630 Test Loss: 1.775 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 5.473286867141724
Epoch: 70, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.772 Vali Acc: 0.638 Test Loss: 1.772 Test Acc: 0.638
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 5.0610833168029785
Epoch: 71, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.774 Vali Acc: 0.645 Test Loss: 1.774 Test Acc: 0.645
Validation loss decreased (-0.637664 --> -0.644910).  Saving model ...
Epoch: 72 cost time: 5.357373952865601
Epoch: 72, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.775 Vali Acc: 0.645 Test Loss: 1.775 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 5.167557239532471
Epoch: 73, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.777 Vali Acc: 0.645 Test Loss: 1.777 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 5.11043643951416
Epoch: 74, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.784 Vali Acc: 0.659 Test Loss: 1.784 Test Acc: 0.659
Validation loss decreased (-0.644910 --> -0.659402).  Saving model ...
Epoch: 75 cost time: 4.988968849182129
Epoch: 75, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.786 Vali Acc: 0.652 Test Loss: 1.786 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 5.2337846755981445
Epoch: 76, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.787 Vali Acc: 0.652 Test Loss: 1.787 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 5.018283843994141
Epoch: 77, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.789 Vali Acc: 0.652 Test Loss: 1.789 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 4.777482986450195
Epoch: 78, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.790 Vali Acc: 0.652 Test Loss: 1.790 Test Acc: 0.652
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 5.163818597793579
Epoch: 79, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.793 Vali Acc: 0.652 Test Loss: 1.793 Test Acc: 0.652
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 4.77657413482666
Epoch: 80, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.798 Vali Acc: 0.652 Test Loss: 1.798 Test Acc: 0.652
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 4.959339380264282
Epoch: 81, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.803 Vali Acc: 0.659 Test Loss: 1.803 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 82 cost time: 4.6337103843688965
Epoch: 82, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.805 Vali Acc: 0.652 Test Loss: 1.805 Test Acc: 0.652
EarlyStopping counter: 8 out of 10
Epoch: 83 cost time: 4.060971260070801
Epoch: 83, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.806 Vali Acc: 0.645 Test Loss: 1.806 Test Acc: 0.645
EarlyStopping counter: 9 out of 10
Epoch: 84 cost time: 4.184518337249756
Epoch: 84, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.809 Vali Acc: 0.659 Test Loss: 1.809 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.6594202898550725
model parameter : 14083076
model size : 73.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.387034177780151
Epoch: 1, Steps: 9 | Train Loss: 1.443 Vali Loss: 1.472 Vali Acc: 0.261 Test Loss: 1.472 Test Acc: 0.261
Validation loss decreased (inf --> -0.260855).  Saving model ...
Epoch: 2 cost time: 5.2018890380859375
Epoch: 2, Steps: 9 | Train Loss: 1.045 Vali Loss: 1.510 Vali Acc: 0.297 Test Loss: 1.510 Test Acc: 0.297
Validation loss decreased (-0.260855 --> -0.297086).  Saving model ...
Epoch: 3 cost time: 4.754142761230469
Epoch: 3, Steps: 9 | Train Loss: 0.549 Vali Loss: 1.789 Vali Acc: 0.333 Test Loss: 1.789 Test Acc: 0.333
Validation loss decreased (-0.297086 --> -0.333315).  Saving model ...
Epoch: 4 cost time: 4.171668529510498
Epoch: 4, Steps: 9 | Train Loss: 0.261 Vali Loss: 2.111 Vali Acc: 0.326 Test Loss: 2.111 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.018603801727295
Epoch: 5, Steps: 9 | Train Loss: 0.140 Vali Loss: 2.721 Vali Acc: 0.326 Test Loss: 2.721 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.849628925323486
Epoch: 6, Steps: 9 | Train Loss: 0.060 Vali Loss: 3.422 Vali Acc: 0.333 Test Loss: 3.422 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.046519041061401
Epoch: 7, Steps: 9 | Train Loss: 0.023 Vali Loss: 3.223 Vali Acc: 0.326 Test Loss: 3.223 Test Acc: 0.326
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.056402206420898
Epoch: 8, Steps: 9 | Train Loss: 0.009 Vali Loss: 3.505 Vali Acc: 0.370 Test Loss: 3.505 Test Acc: 0.370
Validation loss decreased (-0.333315 --> -0.369530).  Saving model ...
Epoch: 9 cost time: 4.529386520385742
Epoch: 9, Steps: 9 | Train Loss: 0.007 Vali Loss: 2.951 Vali Acc: 0.370 Test Loss: 2.951 Test Acc: 0.370
Validation loss decreased (-0.369530 --> -0.369536).  Saving model ...
Epoch: 10 cost time: 4.987003803253174
Epoch: 10, Steps: 9 | Train Loss: 0.006 Vali Loss: 3.260 Vali Acc: 0.377 Test Loss: 3.260 Test Acc: 0.377
Validation loss decreased (-0.369536 --> -0.376779).  Saving model ...
Epoch: 11 cost time: 4.713913202285767
Epoch: 11, Steps: 9 | Train Loss: 0.002 Vali Loss: 4.079 Vali Acc: 0.341 Test Loss: 4.079 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.376907825469971
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 3.512 Vali Acc: 0.362 Test Loss: 3.512 Test Acc: 0.362
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.177552700042725
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 3.629 Vali Acc: 0.362 Test Loss: 3.629 Test Acc: 0.362
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.857560634613037
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 3.593 Vali Acc: 0.377 Test Loss: 3.593 Test Acc: 0.377
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.7494707107543945
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.481 Vali Acc: 0.391 Test Loss: 3.481 Test Acc: 0.391
Validation loss decreased (-0.376779 --> -0.391270).  Saving model ...
Epoch: 16 cost time: 4.52960467338562
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.517 Vali Acc: 0.391 Test Loss: 3.517 Test Acc: 0.391
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.96440577507019
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.526 Vali Acc: 0.377 Test Loss: 3.526 Test Acc: 0.377
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.0131402015686035
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.513 Vali Acc: 0.377 Test Loss: 3.513 Test Acc: 0.377
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.686737775802612
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.511 Vali Acc: 0.384 Test Loss: 3.511 Test Acc: 0.384
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.36609148979187
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.586 Vali Acc: 0.377 Test Loss: 3.586 Test Acc: 0.377
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.509688854217529
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.576 Vali Acc: 0.384 Test Loss: 3.576 Test Acc: 0.384
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.358292102813721
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.558 Vali Acc: 0.384 Test Loss: 3.558 Test Acc: 0.384
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.057854175567627
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.552 Vali Acc: 0.391 Test Loss: 3.552 Test Acc: 0.391
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.714782953262329
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.561 Vali Acc: 0.391 Test Loss: 3.561 Test Acc: 0.391
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.651521921157837
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 3.564 Vali Acc: 0.391 Test Loss: 3.564 Test Acc: 0.391
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.391304347826087
model parameter : 14083076
model size : 73.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.126960039138794
Epoch: 1, Steps: 9 | Train Loss: 1.443 Vali Loss: 1.428 Vali Acc: 0.297 Test Loss: 1.428 Test Acc: 0.297
Validation loss decreased (inf --> -0.297087).  Saving model ...
Epoch: 2 cost time: 4.621328115463257
Epoch: 2, Steps: 9 | Train Loss: 1.005 Vali Loss: 1.301 Vali Acc: 0.384 Test Loss: 1.301 Test Acc: 0.384
Validation loss decreased (-0.297087 --> -0.384045).  Saving model ...
Epoch: 3 cost time: 5.038485050201416
Epoch: 3, Steps: 9 | Train Loss: 0.467 Vali Loss: 1.352 Vali Acc: 0.370 Test Loss: 1.352 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.132255554199219
Epoch: 4, Steps: 9 | Train Loss: 0.205 Vali Loss: 1.673 Vali Acc: 0.333 Test Loss: 1.673 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.633695125579834
Epoch: 5, Steps: 9 | Train Loss: 0.075 Vali Loss: 1.926 Vali Acc: 0.341 Test Loss: 1.926 Test Acc: 0.341
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.385617971420288
Epoch: 6, Steps: 9 | Train Loss: 0.034 Vali Loss: 2.126 Vali Acc: 0.362 Test Loss: 2.126 Test Acc: 0.362
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.276386499404907
Epoch: 7, Steps: 9 | Train Loss: 0.012 Vali Loss: 2.255 Vali Acc: 0.348 Test Loss: 2.255 Test Acc: 0.348
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.000015497207642
Epoch: 8, Steps: 9 | Train Loss: 0.004 Vali Loss: 2.166 Vali Acc: 0.442 Test Loss: 2.166 Test Acc: 0.442
Validation loss decreased (-0.384045 --> -0.442007).  Saving model ...
Epoch: 9 cost time: 4.10175633430481
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.272 Vali Acc: 0.413 Test Loss: 2.272 Test Acc: 0.413
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.388527870178223
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.080 Vali Acc: 0.428 Test Loss: 2.080 Test Acc: 0.428
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.088320970535278
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.960 Vali Acc: 0.471 Test Loss: 1.960 Test Acc: 0.471
Validation loss decreased (-0.442007 --> -0.470995).  Saving model ...
Epoch: 12 cost time: 4.1592772006988525
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.887 Vali Acc: 0.471 Test Loss: 1.887 Test Acc: 0.471
Validation loss decreased (-0.470995 --> -0.470996).  Saving model ...
Epoch: 13 cost time: 4.1263182163238525
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.939 Vali Acc: 0.486 Test Loss: 1.939 Test Acc: 0.486
Validation loss decreased (-0.470996 --> -0.485488).  Saving model ...
Epoch: 14 cost time: 4.481855154037476
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.007 Vali Acc: 0.457 Test Loss: 2.007 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.783330917358398
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.972 Vali Acc: 0.486 Test Loss: 1.972 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.849924087524414
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.951 Vali Acc: 0.500 Test Loss: 1.951 Test Acc: 0.500
Validation loss decreased (-0.485488 --> -0.499980).  Saving model ...
Epoch: 17 cost time: 4.84709095954895
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.936 Vali Acc: 0.507 Test Loss: 1.936 Test Acc: 0.507
Validation loss decreased (-0.499980 --> -0.507227).  Saving model ...
Epoch: 18 cost time: 4.25695276260376
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.902 Vali Acc: 0.507 Test Loss: 1.902 Test Acc: 0.507
Validation loss decreased (-0.507227 --> -0.507227).  Saving model ...
Epoch: 19 cost time: 4.3439435958862305
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.918 Vali Acc: 0.507 Test Loss: 1.918 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.332741975784302
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.929 Vali Acc: 0.507 Test Loss: 1.929 Test Acc: 0.507
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.173199415206909
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.913 Vali Acc: 0.507 Test Loss: 1.913 Test Acc: 0.507
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.898038387298584
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.919 Vali Acc: 0.500 Test Loss: 1.919 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.866628170013428
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.932 Vali Acc: 0.500 Test Loss: 1.932 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.772157669067383
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.942 Vali Acc: 0.500 Test Loss: 1.942 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.319574594497681
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.942 Vali Acc: 0.507 Test Loss: 1.942 Test Acc: 0.507
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.194170713424683
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.929 Vali Acc: 0.514 Test Loss: 1.929 Test Acc: 0.514
Validation loss decreased (-0.507227 --> -0.514473).  Saving model ...
Epoch: 27 cost time: 4.976973295211792
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.911 Vali Acc: 0.514 Test Loss: 1.911 Test Acc: 0.514
Validation loss decreased (-0.514473 --> -0.514474).  Saving model ...
Epoch: 28 cost time: 4.696030855178833
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.880 Vali Acc: 0.543 Test Loss: 1.880 Test Acc: 0.543
Validation loss decreased (-0.514474 --> -0.543459).  Saving model ...
Epoch: 29 cost time: 4.869879484176636
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.874 Vali Acc: 0.551 Test Loss: 1.874 Test Acc: 0.551
Validation loss decreased (-0.543459 --> -0.550706).  Saving model ...
Epoch: 30 cost time: 4.631879806518555
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.897 Vali Acc: 0.536 Test Loss: 1.897 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.191006422042847
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.910 Vali Acc: 0.514 Test Loss: 1.910 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 4.8481245040893555
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.911 Vali Acc: 0.529 Test Loss: 1.911 Test Acc: 0.529
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 4.736798048019409
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.918 Vali Acc: 0.536 Test Loss: 1.918 Test Acc: 0.536
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 5.017387866973877
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.915 Vali Acc: 0.536 Test Loss: 1.915 Test Acc: 0.536
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 4.319687843322754
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.922 Vali Acc: 0.536 Test Loss: 1.922 Test Acc: 0.536
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 4.371036767959595
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.927 Vali Acc: 0.529 Test Loss: 1.927 Test Acc: 0.529
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 4.478454351425171
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.926 Vali Acc: 0.536 Test Loss: 1.926 Test Acc: 0.536
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 4.4942498207092285
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.914 Vali Acc: 0.551 Test Loss: 1.914 Test Acc: 0.551
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 4.18827486038208
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.902 Vali Acc: 0.558 Test Loss: 1.902 Test Acc: 0.558
Validation loss decreased (-0.550706 --> -0.557952).  Saving model ...
Epoch: 40 cost time: 4.412525177001953
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.892 Vali Acc: 0.558 Test Loss: 1.892 Test Acc: 0.558
Validation loss decreased (-0.557952 --> -0.557952).  Saving model ...
Epoch: 41 cost time: 4.406569719314575
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.888 Vali Acc: 0.565 Test Loss: 1.888 Test Acc: 0.565
Validation loss decreased (-0.557952 --> -0.565199).  Saving model ...
Epoch: 42 cost time: 4.8252646923065186
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.901 Vali Acc: 0.565 Test Loss: 1.901 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 4.762417793273926
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.911 Vali Acc: 0.558 Test Loss: 1.911 Test Acc: 0.558
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 4.211012601852417
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.917 Vali Acc: 0.558 Test Loss: 1.917 Test Acc: 0.558
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 4.470548629760742
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.919 Vali Acc: 0.558 Test Loss: 1.919 Test Acc: 0.558
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 4.669143915176392
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.913 Vali Acc: 0.558 Test Loss: 1.913 Test Acc: 0.558
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 3.8621466159820557
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.902 Vali Acc: 0.565 Test Loss: 1.902 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 4.642519235610962
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.904 Vali Acc: 0.565 Test Loss: 1.904 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 4.652902841567993
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.919 Vali Acc: 0.558 Test Loss: 1.919 Test Acc: 0.558
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 5.0664894580841064
Epoch: 50, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.938 Vali Acc: 0.543 Test Loss: 1.938 Test Acc: 0.543
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 5.326518535614014
Epoch: 51, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.948 Vali Acc: 0.543 Test Loss: 1.948 Test Acc: 0.543
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5652173913043478
model parameter : 14083076
model size : 73.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         103                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df512_ma103_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.200676441192627
Epoch: 1, Steps: 9 | Train Loss: 1.357 Vali Loss: 1.132 Vali Acc: 0.543 Test Loss: 1.132 Test Acc: 0.543
Validation loss decreased (inf --> -0.543467).  Saving model ...
Epoch: 2 cost time: 4.566619634628296
Epoch: 2, Steps: 9 | Train Loss: 0.679 Vali Loss: 0.873 Vali Acc: 0.645 Test Loss: 0.873 Test Acc: 0.645
Validation loss decreased (-0.543467 --> -0.644919).  Saving model ...
Epoch: 3 cost time: 5.038202285766602
Epoch: 3, Steps: 9 | Train Loss: 0.204 Vali Loss: 0.835 Vali Acc: 0.688 Test Loss: 0.835 Test Acc: 0.688
Validation loss decreased (-0.644919 --> -0.688397).  Saving model ...
Epoch: 4 cost time: 5.393864154815674
Epoch: 4, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.783 Vali Acc: 0.754 Test Loss: 0.783 Test Acc: 0.754
Validation loss decreased (-0.688397 --> -0.753615).  Saving model ...
Epoch: 5 cost time: 5.537278652191162
Epoch: 5, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.641 Vali Acc: 0.797 Test Loss: 0.641 Test Acc: 0.797
Validation loss decreased (-0.753615 --> -0.797095).  Saving model ...
Epoch: 6 cost time: 5.5436625480651855
Epoch: 6, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.743 Vali Acc: 0.812 Test Loss: 0.743 Test Acc: 0.812
Validation loss decreased (-0.797095 --> -0.811587).  Saving model ...
Epoch: 7 cost time: 5.583833932876587
Epoch: 7, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.813 Vali Acc: 0.797 Test Loss: 0.813 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.2117919921875
Epoch: 8, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.761 Vali Acc: 0.790 Test Loss: 0.761 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.890453577041626
Epoch: 9, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.739 Vali Acc: 0.783 Test Loss: 0.739 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.973609447479248
Epoch: 10, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.736 Vali Acc: 0.783 Test Loss: 0.736 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.012051820755005
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.760 Vali Acc: 0.797 Test Loss: 0.760 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.915448904037476
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.786 Vali Acc: 0.797 Test Loss: 0.786 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.099316596984863
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.778 Vali Acc: 0.797 Test Loss: 0.778 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.896664142608643
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.773 Vali Acc: 0.797 Test Loss: 0.773 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.23980450630188
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.773 Vali Acc: 0.797 Test Loss: 0.773 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.6714723110198975
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.783 Vali Acc: 0.797 Test Loss: 0.783 Test Acc: 0.797
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df512_ma103_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8115942028985508
model parameter : 12510212
model size : 67.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         83                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df512_ma83_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 7.310909986495972
Epoch: 1, Steps: 9 | Train Loss: 1.364 Vali Loss: 1.148 Vali Acc: 0.551 Test Loss: 1.148 Test Acc: 0.551
Validation loss decreased (inf --> -0.550713).  Saving model ...
Epoch: 2 cost time: 4.411686658859253
Epoch: 2, Steps: 9 | Train Loss: 0.687 Vali Loss: 0.881 Vali Acc: 0.638 Test Loss: 0.881 Test Acc: 0.638
Validation loss decreased (-0.550713 --> -0.637672).  Saving model ...
Epoch: 3 cost time: 4.718789577484131
Epoch: 3, Steps: 9 | Train Loss: 0.208 Vali Loss: 0.765 Vali Acc: 0.732 Test Loss: 0.765 Test Acc: 0.732
Validation loss decreased (-0.637672 --> -0.731876).  Saving model ...
Epoch: 4 cost time: 4.812392234802246
Epoch: 4, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.766 Vali Acc: 0.761 Test Loss: 0.766 Test Acc: 0.761
Validation loss decreased (-0.731876 --> -0.760862).  Saving model ...
Epoch: 5 cost time: 5.071153402328491
Epoch: 5, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.589 Vali Acc: 0.841 Test Loss: 0.589 Test Acc: 0.841
Validation loss decreased (-0.760862 --> -0.840574).  Saving model ...
Epoch: 6 cost time: 4.680471420288086
Epoch: 6, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.666 Vali Acc: 0.812 Test Loss: 0.666 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.51873517036438
Epoch: 7, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.849 Vali Acc: 0.812 Test Loss: 0.849 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.735071897506714
Epoch: 8, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.780 Vali Acc: 0.819 Test Loss: 0.780 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.047508716583252
Epoch: 9, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.710 Vali Acc: 0.804 Test Loss: 0.710 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.209678649902344
Epoch: 10, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.692 Vali Acc: 0.812 Test Loss: 0.692 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.073015213012695
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.724 Vali Acc: 0.841 Test Loss: 0.724 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.088980436325073
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.770 Vali Acc: 0.841 Test Loss: 0.770 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.330142974853516
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.770 Vali Acc: 0.833 Test Loss: 0.770 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.580365896224976
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.756 Vali Acc: 0.833 Test Loss: 0.756 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.4207541942596436
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.751 Vali Acc: 0.833 Test Loss: 0.751 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df512_ma83_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 12510212
model size : 67.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         62                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df512_ma62_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.0288474559783936
Epoch: 1, Steps: 9 | Train Loss: 1.356 Vali Loss: 1.124 Vali Acc: 0.580 Test Loss: 1.124 Test Acc: 0.580
Validation loss decreased (inf --> -0.579699).  Saving model ...
Epoch: 2 cost time: 4.063660621643066
Epoch: 2, Steps: 9 | Train Loss: 0.670 Vali Loss: 0.864 Vali Acc: 0.645 Test Loss: 0.864 Test Acc: 0.645
Validation loss decreased (-0.579699 --> -0.644919).  Saving model ...
Epoch: 3 cost time: 4.840004920959473
Epoch: 3, Steps: 9 | Train Loss: 0.183 Vali Loss: 0.778 Vali Acc: 0.739 Test Loss: 0.778 Test Acc: 0.739
Validation loss decreased (-0.644919 --> -0.739123).  Saving model ...
Epoch: 4 cost time: 5.036569595336914
Epoch: 4, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.828 Vali Acc: 0.754 Test Loss: 0.828 Test Acc: 0.754
Validation loss decreased (-0.739123 --> -0.753615).  Saving model ...
Epoch: 5 cost time: 4.715713977813721
Epoch: 5, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.629 Vali Acc: 0.826 Test Loss: 0.629 Test Acc: 0.826
Validation loss decreased (-0.753615 --> -0.826081).  Saving model ...
Epoch: 6 cost time: 5.172872304916382
Epoch: 6, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.780 Vali Acc: 0.804 Test Loss: 0.780 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.898106336593628
Epoch: 7, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.869 Vali Acc: 0.804 Test Loss: 0.869 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.035066366195679
Epoch: 8, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.741 Vali Acc: 0.855 Test Loss: 0.741 Test Acc: 0.855
Validation loss decreased (-0.826081 --> -0.855065).  Saving model ...
Epoch: 9 cost time: 5.185593843460083
Epoch: 9, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.870 Test Loss: 0.696 Test Acc: 0.870
Validation loss decreased (-0.855065 --> -0.869558).  Saving model ...
Epoch: 10 cost time: 5.277854919433594
Epoch: 10, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.870 Test Loss: 0.697 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.319199562072754
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.738 Vali Acc: 0.855 Test Loss: 0.738 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.134052515029907
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.774 Vali Acc: 0.833 Test Loss: 0.774 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.84225058555603
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.772 Vali Acc: 0.833 Test Loss: 0.772 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.047138452529907
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.765 Vali Acc: 0.833 Test Loss: 0.765 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.939841032028198
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.758 Vali Acc: 0.848 Test Loss: 0.758 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.038210868835449
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.761 Vali Acc: 0.841 Test Loss: 0.761 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.140401363372803
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.764 Vali Acc: 0.841 Test Loss: 0.764 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.190707206726074
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.764 Vali Acc: 0.848 Test Loss: 0.764 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.271645545959473
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.763 Vali Acc: 0.855 Test Loss: 0.763 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df512_ma62_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 12510212
model size : 67.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         42                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df512_ma42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.54794979095459
Epoch: 1, Steps: 9 | Train Loss: 1.336 Vali Loss: 1.079 Vali Acc: 0.616 Test Loss: 1.079 Test Acc: 0.616
Validation loss decreased (inf --> -0.615931).  Saving model ...
Epoch: 2 cost time: 4.168838262557983
Epoch: 2, Steps: 9 | Train Loss: 0.646 Vali Loss: 0.853 Vali Acc: 0.667 Test Loss: 0.853 Test Acc: 0.667
Validation loss decreased (-0.615931 --> -0.666658).  Saving model ...
Epoch: 3 cost time: 4.961615800857544
Epoch: 3, Steps: 9 | Train Loss: 0.185 Vali Loss: 0.792 Vali Acc: 0.725 Test Loss: 0.792 Test Acc: 0.725
Validation loss decreased (-0.666658 --> -0.724630).  Saving model ...
Epoch: 4 cost time: 4.684275388717651
Epoch: 4, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.666 Vali Acc: 0.783 Test Loss: 0.666 Test Acc: 0.783
Validation loss decreased (-0.724630 --> -0.782602).  Saving model ...
Epoch: 5 cost time: 4.296538829803467
Epoch: 5, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.534 Vali Acc: 0.819 Test Loss: 0.534 Test Acc: 0.819
Validation loss decreased (-0.782602 --> -0.818835).  Saving model ...
Epoch: 6 cost time: 4.771377325057983
Epoch: 6, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.606 Vali Acc: 0.812 Test Loss: 0.606 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.729967355728149
Epoch: 7, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.795 Vali Acc: 0.790 Test Loss: 0.795 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.249496698379517
Epoch: 8, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.611 Vali Acc: 0.826 Test Loss: 0.611 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826081).  Saving model ...
Epoch: 9 cost time: 4.82318377494812
Epoch: 9, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.558 Vali Acc: 0.841 Test Loss: 0.558 Test Acc: 0.841
Validation loss decreased (-0.826081 --> -0.840574).  Saving model ...
Epoch: 10 cost time: 4.44817852973938
Epoch: 10, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.573 Vali Acc: 0.826 Test Loss: 0.573 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.687603712081909
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.632 Vali Acc: 0.797 Test Loss: 0.632 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.644144296646118
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.677 Vali Acc: 0.797 Test Loss: 0.677 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.537769794464111
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.680 Vali Acc: 0.797 Test Loss: 0.680 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.115217208862305
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.672 Vali Acc: 0.797 Test Loss: 0.672 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.0939226150512695
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.666 Vali Acc: 0.804 Test Loss: 0.666 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.67466402053833
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.669 Vali Acc: 0.804 Test Loss: 0.669 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.819106578826904
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.676 Vali Acc: 0.797 Test Loss: 0.676 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.70054030418396
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.666 Vali Acc: 0.804 Test Loss: 0.666 Test Acc: 0.804
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.563856601715088
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.668 Vali Acc: 0.804 Test Loss: 0.668 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df512_ma42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 12510212
model size : 67.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df512_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 7.117877960205078
Epoch: 1, Steps: 9 | Train Loss: 1.389 Vali Loss: 1.141 Vali Acc: 0.543 Test Loss: 1.141 Test Acc: 0.543
Validation loss decreased (inf --> -0.543467).  Saving model ...
Epoch: 2 cost time: 5.044098138809204
Epoch: 2, Steps: 9 | Train Loss: 0.690 Vali Loss: 0.800 Vali Acc: 0.717 Test Loss: 0.800 Test Acc: 0.717
Validation loss decreased (-0.543467 --> -0.717383).  Saving model ...
Epoch: 3 cost time: 4.290815830230713
Epoch: 3, Steps: 9 | Train Loss: 0.203 Vali Loss: 0.679 Vali Acc: 0.761 Test Loss: 0.679 Test Acc: 0.761
Validation loss decreased (-0.717383 --> -0.760863).  Saving model ...
Epoch: 4 cost time: 4.022490978240967
Epoch: 4, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.598 Vali Acc: 0.804 Test Loss: 0.598 Test Acc: 0.804
Validation loss decreased (-0.760863 --> -0.804342).  Saving model ...
Epoch: 5 cost time: 4.2563793659210205
Epoch: 5, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.493 Vali Acc: 0.790 Test Loss: 0.493 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.588696241378784
Epoch: 6, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.542 Vali Acc: 0.812 Test Loss: 0.542 Test Acc: 0.812
Validation loss decreased (-0.804342 --> -0.811589).  Saving model ...
Epoch: 7 cost time: 3.5393083095550537
Epoch: 7, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.636 Vali Acc: 0.804 Test Loss: 0.636 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.360705614089966
Epoch: 8, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.560 Vali Acc: 0.826 Test Loss: 0.560 Test Acc: 0.826
Validation loss decreased (-0.811589 --> -0.826081).  Saving model ...
Epoch: 9 cost time: 4.334429502487183
Epoch: 9, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.504 Vali Acc: 0.826 Test Loss: 0.504 Test Acc: 0.826
Validation loss decreased (-0.826081 --> -0.826082).  Saving model ...
Epoch: 10 cost time: 4.770246505737305
Epoch: 10, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.481 Vali Acc: 0.848 Test Loss: 0.481 Test Acc: 0.848
Validation loss decreased (-0.826082 --> -0.847821).  Saving model ...
Epoch: 11 cost time: 4.5856287479400635
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.507 Vali Acc: 0.833 Test Loss: 0.507 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.827749252319336
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.534 Vali Acc: 0.833 Test Loss: 0.534 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.33851957321167
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.533 Vali Acc: 0.833 Test Loss: 0.533 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.890369176864624
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.527 Vali Acc: 0.833 Test Loss: 0.527 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.450159549713135
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.524 Vali Acc: 0.841 Test Loss: 0.524 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.061542749404907
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.537 Vali Acc: 0.833 Test Loss: 0.537 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.822463750839233
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.833 Test Loss: 0.542 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.491168737411499
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.529 Vali Acc: 0.841 Test Loss: 0.529 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.377753734588623
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.524 Vali Acc: 0.841 Test Loss: 0.524 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.1499950885772705
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.524 Vali Acc: 0.841 Test Loss: 0.524 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df512_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 12510212
model size : 67.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df512_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.388672828674316
Epoch: 1, Steps: 9 | Train Loss: 1.332 Vali Loss: 1.075 Vali Acc: 0.616 Test Loss: 1.075 Test Acc: 0.616
Validation loss decreased (inf --> -0.615931).  Saving model ...
Epoch: 2 cost time: 4.28214168548584
Epoch: 2, Steps: 9 | Train Loss: 0.708 Vali Loss: 0.938 Vali Acc: 0.623 Test Loss: 0.938 Test Acc: 0.623
Validation loss decreased (-0.615931 --> -0.623179).  Saving model ...
Epoch: 3 cost time: 4.758269548416138
Epoch: 3, Steps: 9 | Train Loss: 0.237 Vali Loss: 0.851 Vali Acc: 0.717 Test Loss: 0.851 Test Acc: 0.717
Validation loss decreased (-0.623179 --> -0.717383).  Saving model ...
Epoch: 4 cost time: 4.5209996700286865
Epoch: 4, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.795 Vali Acc: 0.703 Test Loss: 0.795 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.080193996429443
Epoch: 5, Steps: 9 | Train Loss: 0.052 Vali Loss: 1.018 Vali Acc: 0.717 Test Loss: 1.018 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.058260202407837
Epoch: 6, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.621 Vali Acc: 0.783 Test Loss: 0.621 Test Acc: 0.783
Validation loss decreased (-0.717383 --> -0.782602).  Saving model ...
Epoch: 7 cost time: 3.816450834274292
Epoch: 7, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.866 Vali Acc: 0.746 Test Loss: 0.866 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.0177226066589355
Epoch: 8, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.697 Vali Acc: 0.768 Test Loss: 0.697 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.347113609313965
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.705 Vali Acc: 0.775 Test Loss: 0.705 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.2729880809783936
Epoch: 10, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.725 Vali Acc: 0.790 Test Loss: 0.725 Test Acc: 0.790
Validation loss decreased (-0.782602 --> -0.789848).  Saving model ...
Epoch: 11 cost time: 4.215322732925415
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.738 Vali Acc: 0.783 Test Loss: 0.738 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.6894917488098145
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.733 Vali Acc: 0.783 Test Loss: 0.733 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.04641580581665
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.725 Vali Acc: 0.783 Test Loss: 0.725 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.273422002792358
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.715 Vali Acc: 0.783 Test Loss: 0.715 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.482735633850098
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.713 Vali Acc: 0.790 Test Loss: 0.713 Test Acc: 0.790
Validation loss decreased (-0.789848 --> -0.789848).  Saving model ...
Epoch: 16 cost time: 4.556839942932129
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.727 Vali Acc: 0.790 Test Loss: 0.727 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.274969577789307
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.738 Vali Acc: 0.783 Test Loss: 0.738 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.10054349899292
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.726 Vali Acc: 0.797 Test Loss: 0.726 Test Acc: 0.797
Validation loss decreased (-0.789848 --> -0.797094).  Saving model ...
Epoch: 19 cost time: 4.344714403152466
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.725 Vali Acc: 0.797 Test Loss: 0.725 Test Acc: 0.797
Validation loss decreased (-0.797094 --> -0.797094).  Saving model ...
Epoch: 20 cost time: 4.686651945114136
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.714 Vali Acc: 0.797 Test Loss: 0.714 Test Acc: 0.797
Validation loss decreased (-0.797094 --> -0.797094).  Saving model ...
Epoch: 21 cost time: 4.361934185028076
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.718 Vali Acc: 0.797 Test Loss: 0.718 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.038488388061523
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.732 Vali Acc: 0.797 Test Loss: 0.732 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.10378623008728
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.746 Vali Acc: 0.790 Test Loss: 0.746 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.523864030838013
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.732 Vali Acc: 0.797 Test Loss: 0.732 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.923080921173096
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.729 Vali Acc: 0.797 Test Loss: 0.729 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.570480108261108
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.737 Vali Acc: 0.797 Test Loss: 0.737 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.1302406787872314
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.743 Vali Acc: 0.797 Test Loss: 0.743 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.5716776847839355
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.737 Vali Acc: 0.797 Test Loss: 0.737 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.671367883682251
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.745 Vali Acc: 0.797 Test Loss: 0.745 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.7366251945495605
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.745 Vali Acc: 0.797 Test Loss: 0.745 Test Acc: 0.797
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df512_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7971014492753623
model parameter : 12510212
model size : 67.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df512_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.309207201004028
Epoch: 1, Steps: 9 | Train Loss: 1.385 Vali Loss: 1.154 Vali Acc: 0.500 Test Loss: 1.154 Test Acc: 0.500
Validation loss decreased (inf --> -0.499988).  Saving model ...
Epoch: 2 cost time: 4.636938095092773
Epoch: 2, Steps: 9 | Train Loss: 0.753 Vali Loss: 0.974 Vali Acc: 0.638 Test Loss: 0.974 Test Acc: 0.638
Validation loss decreased (-0.499988 --> -0.637671).  Saving model ...
Epoch: 3 cost time: 4.58807897567749
Epoch: 3, Steps: 9 | Train Loss: 0.263 Vali Loss: 1.125 Vali Acc: 0.587 Test Loss: 1.125 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.283495903015137
Epoch: 4, Steps: 9 | Train Loss: 0.100 Vali Loss: 1.100 Vali Acc: 0.645 Test Loss: 1.100 Test Acc: 0.645
Validation loss decreased (-0.637671 --> -0.644917).  Saving model ...
Epoch: 5 cost time: 4.533747673034668
Epoch: 5, Steps: 9 | Train Loss: 0.054 Vali Loss: 1.126 Vali Acc: 0.638 Test Loss: 1.126 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.9722962379455566
Epoch: 6, Steps: 9 | Train Loss: 0.012 Vali Loss: 1.187 Vali Acc: 0.710 Test Loss: 1.187 Test Acc: 0.710
Validation loss decreased (-0.644917 --> -0.710133).  Saving model ...
Epoch: 7 cost time: 4.450129508972168
Epoch: 7, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.118 Vali Acc: 0.674 Test Loss: 1.118 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.6787548065185547
Epoch: 8, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.089 Vali Acc: 0.710 Test Loss: 1.089 Test Acc: 0.710
Validation loss decreased (-0.710133 --> -0.710134).  Saving model ...
Epoch: 9 cost time: 4.176783323287964
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.218 Vali Acc: 0.696 Test Loss: 1.218 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.7128214836120605
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.222 Vali Acc: 0.696 Test Loss: 1.222 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.789047002792358
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.160 Vali Acc: 0.696 Test Loss: 1.160 Test Acc: 0.696
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.986258506774902
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.150 Vali Acc: 0.688 Test Loss: 1.150 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.431008338928223
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.153 Vali Acc: 0.688 Test Loss: 1.153 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.140703439712524
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.163 Vali Acc: 0.688 Test Loss: 1.163 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.4152960777282715
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.166 Vali Acc: 0.688 Test Loss: 1.166 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.492213010787964
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.165 Vali Acc: 0.688 Test Loss: 1.165 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.573505163192749
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.167 Vali Acc: 0.688 Test Loss: 1.167 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.830812931060791
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.170 Vali Acc: 0.681 Test Loss: 1.170 Test Acc: 0.681
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df512_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7101449275362319
model parameter : 12510212
model size : 67.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.362141132354736
Epoch: 1, Steps: 9 | Train Loss: 1.402 Vali Loss: 1.347 Vali Acc: 0.348 Test Loss: 1.347 Test Acc: 0.348
Validation loss decreased (inf --> -0.347813).  Saving model ...
Epoch: 2 cost time: 4.243281364440918
Epoch: 2, Steps: 9 | Train Loss: 0.880 Vali Loss: 1.200 Vali Acc: 0.478 Test Loss: 1.200 Test Acc: 0.478
Validation loss decreased (-0.347813 --> -0.478249).  Saving model ...
Epoch: 3 cost time: 4.170913934707642
Epoch: 3, Steps: 9 | Train Loss: 0.353 Vali Loss: 1.487 Vali Acc: 0.391 Test Loss: 1.487 Test Acc: 0.391
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.693027019500732
Epoch: 4, Steps: 9 | Train Loss: 0.149 Vali Loss: 1.727 Vali Acc: 0.413 Test Loss: 1.727 Test Acc: 0.413
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.638909816741943
Epoch: 5, Steps: 9 | Train Loss: 0.083 Vali Loss: 1.550 Vali Acc: 0.471 Test Loss: 1.550 Test Acc: 0.471
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.397323846817017
Epoch: 6, Steps: 9 | Train Loss: 0.021 Vali Loss: 1.977 Vali Acc: 0.384 Test Loss: 1.977 Test Acc: 0.384
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.312130451202393
Epoch: 7, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.859 Vali Acc: 0.464 Test Loss: 1.859 Test Acc: 0.464
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.465510129928589
Epoch: 8, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.964 Vali Acc: 0.442 Test Loss: 1.964 Test Acc: 0.442
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.312280654907227
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.802 Vali Acc: 0.442 Test Loss: 1.802 Test Acc: 0.442
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.089669704437256
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.729 Vali Acc: 0.471 Test Loss: 1.729 Test Acc: 0.471
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.0981831550598145
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.768 Vali Acc: 0.486 Test Loss: 1.768 Test Acc: 0.486
Validation loss decreased (-0.478249 --> -0.485490).  Saving model ...
Epoch: 12 cost time: 4.297254323959351
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.815 Vali Acc: 0.457 Test Loss: 1.815 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.598839044570923
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.824 Vali Acc: 0.464 Test Loss: 1.824 Test Acc: 0.464
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.020805597305298
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.823 Vali Acc: 0.464 Test Loss: 1.823 Test Acc: 0.464
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.976213455200195
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.819 Vali Acc: 0.471 Test Loss: 1.819 Test Acc: 0.471
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.689449071884155
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.801 Vali Acc: 0.471 Test Loss: 1.801 Test Acc: 0.471
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.926100730895996
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.800 Vali Acc: 0.471 Test Loss: 1.800 Test Acc: 0.471
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.781060457229614
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.818 Vali Acc: 0.471 Test Loss: 1.818 Test Acc: 0.471
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.000872611999512
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.805 Vali Acc: 0.478 Test Loss: 1.805 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.352394104003906
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.792 Vali Acc: 0.493 Test Loss: 1.792 Test Acc: 0.493
Validation loss decreased (-0.485490 --> -0.492736).  Saving model ...
Epoch: 21 cost time: 4.30433464050293
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.791 Vali Acc: 0.493 Test Loss: 1.791 Test Acc: 0.493
Validation loss decreased (-0.492736 --> -0.492736).  Saving model ...
Epoch: 22 cost time: 4.929392337799072
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.805 Vali Acc: 0.493 Test Loss: 1.805 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.408082962036133
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.795 Vali Acc: 0.522 Test Loss: 1.795 Test Acc: 0.522
Validation loss decreased (-0.492736 --> -0.521721).  Saving model ...
Epoch: 24 cost time: 4.279644727706909
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.797 Vali Acc: 0.536 Test Loss: 1.797 Test Acc: 0.536
Validation loss decreased (-0.521721 --> -0.536214).  Saving model ...
Epoch: 25 cost time: 4.960764408111572
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.809 Vali Acc: 0.529 Test Loss: 1.809 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.859070062637329
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.803 Vali Acc: 0.543 Test Loss: 1.803 Test Acc: 0.543
Validation loss decreased (-0.536214 --> -0.543460).  Saving model ...
Epoch: 27 cost time: 4.480510711669922
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.791 Vali Acc: 0.551 Test Loss: 1.791 Test Acc: 0.551
Validation loss decreased (-0.543460 --> -0.550707).  Saving model ...
Epoch: 28 cost time: 3.9039146900177
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.786 Vali Acc: 0.551 Test Loss: 1.786 Test Acc: 0.551
Validation loss decreased (-0.550707 --> -0.550707).  Saving model ...
Epoch: 29 cost time: 3.868208646774292
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.787 Vali Acc: 0.551 Test Loss: 1.787 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.197954177856445
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.793 Vali Acc: 0.551 Test Loss: 1.793 Test Acc: 0.551
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.8551180362701416
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.807 Vali Acc: 0.543 Test Loss: 1.807 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 4.388858079910278
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.811 Vali Acc: 0.543 Test Loss: 1.811 Test Acc: 0.543
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 4.729391813278198
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.811 Vali Acc: 0.551 Test Loss: 1.811 Test Acc: 0.551
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 4.610507488250732
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.800 Vali Acc: 0.565 Test Loss: 1.800 Test Acc: 0.565
Validation loss decreased (-0.550707 --> -0.565199).  Saving model ...
Epoch: 35 cost time: 4.516556978225708
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.786 Vali Acc: 0.572 Test Loss: 1.786 Test Acc: 0.572
Validation loss decreased (-0.565199 --> -0.572446).  Saving model ...
Epoch: 36 cost time: 4.507835865020752
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.791 Vali Acc: 0.572 Test Loss: 1.791 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 4.638817310333252
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.798 Vali Acc: 0.572 Test Loss: 1.798 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 4.7743821144104
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.812 Vali Acc: 0.565 Test Loss: 1.812 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 4.3560707569122314
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.811 Vali Acc: 0.565 Test Loss: 1.811 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 4.456958770751953
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.819 Vali Acc: 0.572 Test Loss: 1.819 Test Acc: 0.572
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 4.147860527038574
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.813 Vali Acc: 0.572 Test Loss: 1.813 Test Acc: 0.572
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 3.561861276626587
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.817 Vali Acc: 0.572 Test Loss: 1.817 Test Acc: 0.572
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 3.354764461517334
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.827 Vali Acc: 0.572 Test Loss: 1.827 Test Acc: 0.572
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 4.408643007278442
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.842 Vali Acc: 0.572 Test Loss: 1.842 Test Acc: 0.572
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 4.48587965965271
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.846 Vali Acc: 0.572 Test Loss: 1.846 Test Acc: 0.572
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.572463768115942
model parameter : 12510212
model size : 67.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.555434465408325
Epoch: 1, Steps: 9 | Train Loss: 1.422 Vali Loss: 1.483 Vali Acc: 0.232 Test Loss: 1.483 Test Acc: 0.232
Validation loss decreased (inf --> -0.231869).  Saving model ...
Epoch: 2 cost time: 4.684442043304443
Epoch: 2, Steps: 9 | Train Loss: 1.095 Vali Loss: 1.327 Vali Acc: 0.370 Test Loss: 1.327 Test Acc: 0.370
Validation loss decreased (-0.231869 --> -0.369552).  Saving model ...
Epoch: 3 cost time: 4.721081733703613
Epoch: 3, Steps: 9 | Train Loss: 0.570 Vali Loss: 1.976 Vali Acc: 0.297 Test Loss: 1.976 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.415393114089966
Epoch: 4, Steps: 9 | Train Loss: 0.256 Vali Loss: 1.793 Vali Acc: 0.355 Test Loss: 1.793 Test Acc: 0.355
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.671750545501709
Epoch: 5, Steps: 9 | Train Loss: 0.118 Vali Loss: 2.483 Vali Acc: 0.333 Test Loss: 2.483 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.7500689029693604
Epoch: 6, Steps: 9 | Train Loss: 0.045 Vali Loss: 3.503 Vali Acc: 0.319 Test Loss: 3.503 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.916916608810425
Epoch: 7, Steps: 9 | Train Loss: 0.015 Vali Loss: 2.135 Vali Acc: 0.449 Test Loss: 2.135 Test Acc: 0.449
Validation loss decreased (-0.369552 --> -0.449254).  Saving model ...
Epoch: 8 cost time: 3.7810399532318115
Epoch: 8, Steps: 9 | Train Loss: 0.006 Vali Loss: 2.662 Vali Acc: 0.413 Test Loss: 2.662 Test Acc: 0.413
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.18391227722168
Epoch: 9, Steps: 9 | Train Loss: 0.002 Vali Loss: 3.885 Vali Acc: 0.355 Test Loss: 3.885 Test Acc: 0.355
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.167062520980835
Epoch: 10, Steps: 9 | Train Loss: 0.002 Vali Loss: 3.477 Vali Acc: 0.377 Test Loss: 3.477 Test Acc: 0.377
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.33497166633606
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 3.000 Vali Acc: 0.435 Test Loss: 3.000 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.618562459945679
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.812 Vali Acc: 0.457 Test Loss: 2.812 Test Acc: 0.457
Validation loss decreased (-0.449254 --> -0.456494).  Saving model ...
Epoch: 13 cost time: 4.436366319656372
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.840 Vali Acc: 0.457 Test Loss: 2.840 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.230055570602417
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.961 Vali Acc: 0.442 Test Loss: 2.961 Test Acc: 0.442
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.154833555221558
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.998 Vali Acc: 0.428 Test Loss: 2.998 Test Acc: 0.428
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.458470582962036
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.951 Vali Acc: 0.449 Test Loss: 2.951 Test Acc: 0.449
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.407098054885864
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.946 Vali Acc: 0.464 Test Loss: 2.946 Test Acc: 0.464
Validation loss decreased (-0.456494 --> -0.463739).  Saving model ...
Epoch: 18 cost time: 4.670337677001953
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.925 Vali Acc: 0.464 Test Loss: 2.925 Test Acc: 0.464
Validation loss decreased (-0.463739 --> -0.463739).  Saving model ...
Epoch: 19 cost time: 4.28978705406189
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.894 Vali Acc: 0.457 Test Loss: 2.894 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.122281312942505
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.956 Vali Acc: 0.464 Test Loss: 2.956 Test Acc: 0.464
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.1934192180633545
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.968 Vali Acc: 0.464 Test Loss: 2.968 Test Acc: 0.464
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.1930670738220215
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.888 Vali Acc: 0.464 Test Loss: 2.888 Test Acc: 0.464
Validation loss decreased (-0.463739 --> -0.463739).  Saving model ...
Epoch: 23 cost time: 4.772888898849487
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.867 Vali Acc: 0.478 Test Loss: 2.867 Test Acc: 0.478
Validation loss decreased (-0.463739 --> -0.478232).  Saving model ...
Epoch: 24 cost time: 4.290201663970947
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.921 Vali Acc: 0.471 Test Loss: 2.921 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.6539225578308105
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.949 Vali Acc: 0.464 Test Loss: 2.949 Test Acc: 0.464
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.674057245254517
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.937 Vali Acc: 0.471 Test Loss: 2.937 Test Acc: 0.471
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.916690111160278
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.919 Vali Acc: 0.464 Test Loss: 2.919 Test Acc: 0.464
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 4.71814751625061
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.912 Vali Acc: 0.486 Test Loss: 2.912 Test Acc: 0.486
Validation loss decreased (-0.478232 --> -0.485478).  Saving model ...
Epoch: 29 cost time: 4.388808727264404
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.861 Vali Acc: 0.493 Test Loss: 2.861 Test Acc: 0.493
Validation loss decreased (-0.485478 --> -0.492725).  Saving model ...
Epoch: 30 cost time: 4.025245666503906
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.890 Vali Acc: 0.486 Test Loss: 2.890 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.607726812362671
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.904 Vali Acc: 0.486 Test Loss: 2.904 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.4445457458496094
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.907 Vali Acc: 0.493 Test Loss: 2.907 Test Acc: 0.493
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 4.131911754608154
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.924 Vali Acc: 0.486 Test Loss: 2.924 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 4.2153990268707275
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.923 Vali Acc: 0.486 Test Loss: 2.923 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 4.345170021057129
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.910 Vali Acc: 0.500 Test Loss: 2.910 Test Acc: 0.500
Validation loss decreased (-0.492725 --> -0.499971).  Saving model ...
Epoch: 36 cost time: 4.420557260513306
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.923 Vali Acc: 0.500 Test Loss: 2.923 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 4.845229148864746
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.952 Vali Acc: 0.493 Test Loss: 2.952 Test Acc: 0.493
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 4.645095348358154
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.967 Vali Acc: 0.493 Test Loss: 2.967 Test Acc: 0.493
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.898707628250122
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.968 Vali Acc: 0.493 Test Loss: 2.968 Test Acc: 0.493
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.7467002868652344
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.961 Vali Acc: 0.500 Test Loss: 2.961 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 3.891974687576294
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.963 Vali Acc: 0.507 Test Loss: 2.963 Test Acc: 0.507
Validation loss decreased (-0.499971 --> -0.507217).  Saving model ...
Epoch: 42 cost time: 4.32460618019104
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.960 Vali Acc: 0.507 Test Loss: 2.960 Test Acc: 0.507
Validation loss decreased (-0.507217 --> -0.507217).  Saving model ...
Epoch: 43 cost time: 4.566625118255615
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.953 Vali Acc: 0.522 Test Loss: 2.953 Test Acc: 0.522
Validation loss decreased (-0.507217 --> -0.521710).  Saving model ...
Epoch: 44 cost time: 4.92792534828186
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.959 Vali Acc: 0.522 Test Loss: 2.959 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 4.54155158996582
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.941 Vali Acc: 0.529 Test Loss: 2.941 Test Acc: 0.529
Validation loss decreased (-0.521710 --> -0.528956).  Saving model ...
Epoch: 46 cost time: 4.3254687786102295
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.931 Vali Acc: 0.529 Test Loss: 2.931 Test Acc: 0.529
Validation loss decreased (-0.528956 --> -0.528956).  Saving model ...
Epoch: 47 cost time: 4.4640421867370605
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.953 Vali Acc: 0.536 Test Loss: 2.953 Test Acc: 0.536
Validation loss decreased (-0.528956 --> -0.536202).  Saving model ...
Epoch: 48 cost time: 4.131963729858398
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.954 Vali Acc: 0.536 Test Loss: 2.954 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 4.188348054885864
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.923 Vali Acc: 0.536 Test Loss: 2.923 Test Acc: 0.536
Validation loss decreased (-0.536202 --> -0.536203).  Saving model ...
Epoch: 50 cost time: 4.346840858459473
Epoch: 50, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.915 Vali Acc: 0.536 Test Loss: 2.915 Test Acc: 0.536
Validation loss decreased (-0.536203 --> -0.536203).  Saving model ...
Epoch: 51 cost time: 4.240925073623657
Epoch: 51, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.917 Vali Acc: 0.536 Test Loss: 2.917 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 4.139498710632324
Epoch: 52, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.919 Vali Acc: 0.536 Test Loss: 2.919 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 4.539881944656372
Epoch: 53, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.925 Vali Acc: 0.536 Test Loss: 2.925 Test Acc: 0.536
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 4.282777309417725
Epoch: 54, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.915 Vali Acc: 0.536 Test Loss: 2.915 Test Acc: 0.536
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 3.6998770236968994
Epoch: 55, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.924 Vali Acc: 0.536 Test Loss: 2.924 Test Acc: 0.536
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 4.164535284042358
Epoch: 56, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.929 Vali Acc: 0.536 Test Loss: 2.929 Test Acc: 0.536
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 4.389878511428833
Epoch: 57, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.934 Vali Acc: 0.536 Test Loss: 2.934 Test Acc: 0.536
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 4.169987440109253
Epoch: 58, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.936 Vali Acc: 0.529 Test Loss: 2.936 Test Acc: 0.529
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 4.2352306842803955
Epoch: 59, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.951 Vali Acc: 0.529 Test Loss: 2.951 Test Acc: 0.529
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 4.263693809509277
Epoch: 60, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.970 Vali Acc: 0.536 Test Loss: 2.970 Test Acc: 0.536
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5362318840579711
model parameter : 12510212
model size : 67.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.893870830535889
Epoch: 1, Steps: 9 | Train Loss: 1.420 Vali Loss: 1.535 Vali Acc: 0.239 Test Loss: 1.535 Test Acc: 0.239
Validation loss decreased (inf --> -0.239115).  Saving model ...
Epoch: 2 cost time: 4.251100063323975
Epoch: 2, Steps: 9 | Train Loss: 1.074 Vali Loss: 1.299 Vali Acc: 0.406 Test Loss: 1.299 Test Acc: 0.406
Validation loss decreased (-0.239115 --> -0.405784).  Saving model ...
Epoch: 3 cost time: 4.301225900650024
Epoch: 3, Steps: 9 | Train Loss: 0.528 Vali Loss: 1.702 Vali Acc: 0.290 Test Loss: 1.702 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.605630159378052
Epoch: 4, Steps: 9 | Train Loss: 0.216 Vali Loss: 1.648 Vali Acc: 0.348 Test Loss: 1.648 Test Acc: 0.348
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.552111864089966
Epoch: 5, Steps: 9 | Train Loss: 0.093 Vali Loss: 1.583 Vali Acc: 0.399 Test Loss: 1.583 Test Acc: 0.399
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.745147228240967
Epoch: 6, Steps: 9 | Train Loss: 0.030 Vali Loss: 2.049 Vali Acc: 0.355 Test Loss: 2.049 Test Acc: 0.355
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.455562353134155
Epoch: 7, Steps: 9 | Train Loss: 0.012 Vali Loss: 2.022 Vali Acc: 0.377 Test Loss: 2.022 Test Acc: 0.377
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.467951536178589
Epoch: 8, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.679 Vali Acc: 0.486 Test Loss: 1.679 Test Acc: 0.486
Validation loss decreased (-0.405784 --> -0.485490).  Saving model ...
Epoch: 9 cost time: 4.6556737422943115
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.913 Vali Acc: 0.471 Test Loss: 1.913 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.651827573776245
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.179 Vali Acc: 0.391 Test Loss: 2.179 Test Acc: 0.391
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.59704065322876
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.168 Vali Acc: 0.413 Test Loss: 2.168 Test Acc: 0.413
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.508315563201904
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.009 Vali Acc: 0.449 Test Loss: 2.009 Test Acc: 0.449
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.8568549156188965
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.901 Vali Acc: 0.457 Test Loss: 1.901 Test Acc: 0.457
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.317740201950073
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.835 Vali Acc: 0.493 Test Loss: 1.835 Test Acc: 0.493
Validation loss decreased (-0.485490 --> -0.492735).  Saving model ...
Epoch: 15 cost time: 4.197979927062988
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.840 Vali Acc: 0.493 Test Loss: 1.840 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.948213338851929
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.873 Vali Acc: 0.493 Test Loss: 1.873 Test Acc: 0.493
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.2737135887146
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.913 Vali Acc: 0.486 Test Loss: 1.913 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.079418659210205
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.919 Vali Acc: 0.493 Test Loss: 1.919 Test Acc: 0.493
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.3981781005859375
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.922 Vali Acc: 0.514 Test Loss: 1.922 Test Acc: 0.514
Validation loss decreased (-0.492735 --> -0.514474).  Saving model ...
Epoch: 20 cost time: 3.981996536254883
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.931 Vali Acc: 0.500 Test Loss: 1.931 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.054413795471191
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.933 Vali Acc: 0.507 Test Loss: 1.933 Test Acc: 0.507
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.9244277477264404
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.903 Vali Acc: 0.507 Test Loss: 1.903 Test Acc: 0.507
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.3053364753723145
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.890 Vali Acc: 0.514 Test Loss: 1.890 Test Acc: 0.514
Validation loss decreased (-0.514474 --> -0.514474).  Saving model ...
Epoch: 24 cost time: 3.5660018920898438
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.881 Vali Acc: 0.536 Test Loss: 1.881 Test Acc: 0.536
Validation loss decreased (-0.514474 --> -0.536213).  Saving model ...
Epoch: 25 cost time: 4.54449987411499
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.886 Vali Acc: 0.529 Test Loss: 1.886 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.40697979927063
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.897 Vali Acc: 0.536 Test Loss: 1.897 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.038828134536743
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.920 Vali Acc: 0.529 Test Loss: 1.920 Test Acc: 0.529
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.053333282470703
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.922 Vali Acc: 0.529 Test Loss: 1.922 Test Acc: 0.529
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.946462869644165
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.878 Vali Acc: 0.536 Test Loss: 1.878 Test Acc: 0.536
Validation loss decreased (-0.536213 --> -0.536213).  Saving model ...
Epoch: 30 cost time: 4.644428014755249
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.886 Vali Acc: 0.536 Test Loss: 1.886 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 4.935096502304077
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.900 Vali Acc: 0.536 Test Loss: 1.900 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 5.0845794677734375
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.919 Vali Acc: 0.536 Test Loss: 1.919 Test Acc: 0.536
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 4.826690435409546
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.937 Vali Acc: 0.536 Test Loss: 1.937 Test Acc: 0.536
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.9643466472625732
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.946 Vali Acc: 0.536 Test Loss: 1.946 Test Acc: 0.536
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 4.311122179031372
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.929 Vali Acc: 0.536 Test Loss: 1.929 Test Acc: 0.536
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 4.209648370742798
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.924 Vali Acc: 0.536 Test Loss: 1.924 Test Acc: 0.536
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 4.3681395053863525
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.923 Vali Acc: 0.543 Test Loss: 1.923 Test Acc: 0.543
Validation loss decreased (-0.536213 --> -0.543459).  Saving model ...
Epoch: 38 cost time: 4.567833185195923
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.933 Vali Acc: 0.543 Test Loss: 1.933 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 4.410362243652344
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.940 Vali Acc: 0.536 Test Loss: 1.940 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 4.617670774459839
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.945 Vali Acc: 0.536 Test Loss: 1.945 Test Acc: 0.536
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 4.440612077713013
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.939 Vali Acc: 0.543 Test Loss: 1.939 Test Acc: 0.543
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 4.417119026184082
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.936 Vali Acc: 0.543 Test Loss: 1.936 Test Acc: 0.543
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 4.339441299438477
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.928 Vali Acc: 0.551 Test Loss: 1.928 Test Acc: 0.551
Validation loss decreased (-0.543459 --> -0.550705).  Saving model ...
Epoch: 44 cost time: 4.520350217819214
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.934 Vali Acc: 0.558 Test Loss: 1.934 Test Acc: 0.558
Validation loss decreased (-0.550705 --> -0.557952).  Saving model ...
Epoch: 45 cost time: 4.110268592834473
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.932 Vali Acc: 0.558 Test Loss: 1.932 Test Acc: 0.558
Validation loss decreased (-0.557952 --> -0.557952).  Saving model ...
Epoch: 46 cost time: 4.142276763916016
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.931 Vali Acc: 0.572 Test Loss: 1.931 Test Acc: 0.572
Validation loss decreased (-0.557952 --> -0.572444).  Saving model ...
Epoch: 47 cost time: 4.840734958648682
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.941 Vali Acc: 0.572 Test Loss: 1.941 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 4.3476879596710205
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.944 Vali Acc: 0.565 Test Loss: 1.944 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 4.451015472412109
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.938 Vali Acc: 0.565 Test Loss: 1.938 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 4.609733819961548
Epoch: 50, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.937 Vali Acc: 0.572 Test Loss: 1.937 Test Acc: 0.572
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 4.433026313781738
Epoch: 51, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.937 Vali Acc: 0.580 Test Loss: 1.937 Test Acc: 0.580
Validation loss decreased (-0.572444 --> -0.579691).  Saving model ...
Epoch: 52 cost time: 4.440922737121582
Epoch: 52, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.934 Vali Acc: 0.594 Test Loss: 1.934 Test Acc: 0.594
Validation loss decreased (-0.579691 --> -0.594184).  Saving model ...
Epoch: 53 cost time: 4.592394828796387
Epoch: 53, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.936 Vali Acc: 0.594 Test Loss: 1.936 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 5.133212566375732
Epoch: 54, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.939 Vali Acc: 0.594 Test Loss: 1.939 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 4.898995637893677
Epoch: 55, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.946 Vali Acc: 0.594 Test Loss: 1.946 Test Acc: 0.594
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 4.578611373901367
Epoch: 56, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.949 Vali Acc: 0.594 Test Loss: 1.949 Test Acc: 0.594
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 4.510337829589844
Epoch: 57, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.953 Vali Acc: 0.594 Test Loss: 1.953 Test Acc: 0.594
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 4.204865455627441
Epoch: 58, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.960 Vali Acc: 0.594 Test Loss: 1.960 Test Acc: 0.594
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 3.991912603378296
Epoch: 59, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.964 Vali Acc: 0.594 Test Loss: 1.964 Test Acc: 0.594
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 4.0122411251068115
Epoch: 60, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.966 Vali Acc: 0.594 Test Loss: 1.966 Test Acc: 0.594
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 4.196642160415649
Epoch: 61, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.968 Vali Acc: 0.594 Test Loss: 1.968 Test Acc: 0.594
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 4.101748943328857
Epoch: 62, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.969 Vali Acc: 0.594 Test Loss: 1.969 Test Acc: 0.594
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5942028985507246
model parameter : 12510212
model size : 67.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         103                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df256_ma103_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.638666391372681
Epoch: 1, Steps: 9 | Train Loss: 1.453 Vali Loss: 1.238 Vali Acc: 0.428 Test Loss: 1.238 Test Acc: 0.428
Validation loss decreased (inf --> -0.427524).  Saving model ...
Epoch: 2 cost time: 5.136490345001221
Epoch: 2, Steps: 9 | Train Loss: 0.796 Vali Loss: 1.068 Vali Acc: 0.601 Test Loss: 1.068 Test Acc: 0.601
Validation loss decreased (-0.427524 --> -0.601439).  Saving model ...
Epoch: 3 cost time: 4.182444095611572
Epoch: 3, Steps: 9 | Train Loss: 0.278 Vali Loss: 0.744 Vali Acc: 0.746 Test Loss: 0.744 Test Acc: 0.746
Validation loss decreased (-0.601439 --> -0.746369).  Saving model ...
Epoch: 4 cost time: 4.363335371017456
Epoch: 4, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.630 Vali Acc: 0.725 Test Loss: 0.630 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.4151599407196045
Epoch: 5, Steps: 9 | Train Loss: 0.048 Vali Loss: 1.020 Vali Acc: 0.710 Test Loss: 1.020 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.943474054336548
Epoch: 6, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.763 Vali Acc: 0.768 Test Loss: 0.763 Test Acc: 0.768
Validation loss decreased (-0.746369 --> -0.768108).  Saving model ...
Epoch: 7 cost time: 3.861783742904663
Epoch: 7, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.971 Vali Acc: 0.754 Test Loss: 0.971 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.927815198898315
Epoch: 8, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.916 Vali Acc: 0.746 Test Loss: 0.916 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.3012442588806152
Epoch: 9, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.859 Vali Acc: 0.761 Test Loss: 0.859 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.791557550430298
Epoch: 10, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.846 Vali Acc: 0.754 Test Loss: 0.846 Test Acc: 0.754
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.823330640792847
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.849 Vali Acc: 0.761 Test Loss: 0.849 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.9842138290405273
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.871 Vali Acc: 0.761 Test Loss: 0.871 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.3135666847229
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.863 Vali Acc: 0.768 Test Loss: 0.863 Test Acc: 0.768
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.836935043334961
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.868 Vali Acc: 0.768 Test Loss: 0.868 Test Acc: 0.768
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.960749626159668
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.868 Vali Acc: 0.768 Test Loss: 0.868 Test Acc: 0.768
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.760173320770264
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.867 Vali Acc: 0.768 Test Loss: 0.867 Test Acc: 0.768
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df256_ma103_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7681159420289855
model parameter : 11723780
model size : 64.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         83                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df256_ma83_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.033806800842285
Epoch: 1, Steps: 9 | Train Loss: 1.466 Vali Loss: 1.277 Vali Acc: 0.399 Test Loss: 1.277 Test Acc: 0.399
Validation loss decreased (inf --> -0.398538).  Saving model ...
Epoch: 2 cost time: 4.39835262298584
Epoch: 2, Steps: 9 | Train Loss: 0.826 Vali Loss: 1.108 Vali Acc: 0.580 Test Loss: 1.108 Test Acc: 0.580
Validation loss decreased (-0.398538 --> -0.579699).  Saving model ...
Epoch: 3 cost time: 4.712335824966431
Epoch: 3, Steps: 9 | Train Loss: 0.300 Vali Loss: 0.683 Vali Acc: 0.761 Test Loss: 0.683 Test Acc: 0.761
Validation loss decreased (-0.579699 --> -0.760863).  Saving model ...
Epoch: 4 cost time: 4.788545846939087
Epoch: 4, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.588 Vali Acc: 0.797 Test Loss: 0.588 Test Acc: 0.797
Validation loss decreased (-0.760863 --> -0.797096).  Saving model ...
Epoch: 5 cost time: 4.5717902183532715
Epoch: 5, Steps: 9 | Train Loss: 0.052 Vali Loss: 1.001 Vali Acc: 0.754 Test Loss: 1.001 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.409746170043945
Epoch: 6, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.668 Vali Acc: 0.783 Test Loss: 0.668 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.754555702209473
Epoch: 7, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.973 Vali Acc: 0.754 Test Loss: 0.973 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.48228907585144
Epoch: 8, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.797 Vali Acc: 0.790 Test Loss: 0.797 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.197035551071167
Epoch: 9, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.759 Vali Acc: 0.790 Test Loss: 0.759 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.080811977386475
Epoch: 10, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.778 Vali Acc: 0.797 Test Loss: 0.778 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.2144129276275635
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.803 Vali Acc: 0.783 Test Loss: 0.803 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.6361706256866455
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.823 Vali Acc: 0.790 Test Loss: 0.823 Test Acc: 0.790
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.244229555130005
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.811 Vali Acc: 0.797 Test Loss: 0.811 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.382401943206787
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.814 Vali Acc: 0.804 Test Loss: 0.814 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804340).  Saving model ...
Epoch: 15 cost time: 4.110535383224487
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.818 Vali Acc: 0.804 Test Loss: 0.818 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.953575372695923
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.822 Vali Acc: 0.804 Test Loss: 0.822 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.071922302246094
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.817 Vali Acc: 0.804 Test Loss: 0.817 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.050768136978149
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.808 Vali Acc: 0.797 Test Loss: 0.808 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.454216480255127
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.808 Vali Acc: 0.797 Test Loss: 0.808 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.7204203605651855
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.818 Vali Acc: 0.804 Test Loss: 0.818 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.564525842666626
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.828 Vali Acc: 0.804 Test Loss: 0.828 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.57080078125
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.831 Vali Acc: 0.804 Test Loss: 0.831 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.636400461196899
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.820 Vali Acc: 0.804 Test Loss: 0.820 Test Acc: 0.804
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.380036354064941
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.827 Vali Acc: 0.804 Test Loss: 0.827 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df256_ma83_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8043478260869565
model parameter : 11723780
model size : 64.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         62                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df256_ma62_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.038877248764038
Epoch: 1, Steps: 9 | Train Loss: 1.455 Vali Loss: 1.271 Vali Acc: 0.391 Test Loss: 1.271 Test Acc: 0.391
Validation loss decreased (inf --> -0.391292).  Saving model ...
Epoch: 2 cost time: 4.710150241851807
Epoch: 2, Steps: 9 | Train Loss: 0.811 Vali Loss: 1.119 Vali Acc: 0.551 Test Loss: 1.119 Test Acc: 0.551
Validation loss decreased (-0.391292 --> -0.550713).  Saving model ...
Epoch: 3 cost time: 4.853569507598877
Epoch: 3, Steps: 9 | Train Loss: 0.280 Vali Loss: 0.710 Vali Acc: 0.768 Test Loss: 0.710 Test Acc: 0.768
Validation loss decreased (-0.550713 --> -0.768109).  Saving model ...
Epoch: 4 cost time: 4.382188081741333
Epoch: 4, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.613 Vali Acc: 0.783 Test Loss: 0.613 Test Acc: 0.783
Validation loss decreased (-0.768109 --> -0.782603).  Saving model ...
Epoch: 5 cost time: 4.509239435195923
Epoch: 5, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.939 Vali Acc: 0.775 Test Loss: 0.939 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.754195928573608
Epoch: 6, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.714 Vali Acc: 0.790 Test Loss: 0.714 Test Acc: 0.790
Validation loss decreased (-0.782603 --> -0.789848).  Saving model ...
Epoch: 7 cost time: 4.295418977737427
Epoch: 7, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.027 Vali Acc: 0.761 Test Loss: 1.027 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.876950979232788
Epoch: 8, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.854 Vali Acc: 0.804 Test Loss: 0.854 Test Acc: 0.804
Validation loss decreased (-0.789848 --> -0.804339).  Saving model ...
Epoch: 9 cost time: 4.05778169631958
Epoch: 9, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.811 Vali Acc: 0.790 Test Loss: 0.811 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.2049219608306885
Epoch: 10, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.806 Vali Acc: 0.804 Test Loss: 0.806 Test Acc: 0.804
Validation loss decreased (-0.804339 --> -0.804340).  Saving model ...
Epoch: 11 cost time: 4.434803247451782
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.811 Vali Acc: 0.797 Test Loss: 0.811 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.179385185241699
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.826 Vali Acc: 0.804 Test Loss: 0.826 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.246248483657837
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.829 Vali Acc: 0.812 Test Loss: 0.829 Test Acc: 0.812
Validation loss decreased (-0.804340 --> -0.811586).  Saving model ...
Epoch: 14 cost time: 3.62130069732666
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.843 Vali Acc: 0.804 Test Loss: 0.843 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.8808627128601074
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.850 Vali Acc: 0.804 Test Loss: 0.850 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.429058074951172
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.849 Vali Acc: 0.804 Test Loss: 0.849 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.729194164276123
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.839 Vali Acc: 0.812 Test Loss: 0.839 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.123333692550659
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.830 Vali Acc: 0.804 Test Loss: 0.830 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.023539066314697
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.833 Vali Acc: 0.804 Test Loss: 0.833 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.757777214050293
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.843 Vali Acc: 0.804 Test Loss: 0.843 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.768930196762085
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.855 Vali Acc: 0.812 Test Loss: 0.855 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.8316590785980225
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.856 Vali Acc: 0.812 Test Loss: 0.856 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.2739338874816895
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.846 Vali Acc: 0.819 Test Loss: 0.846 Test Acc: 0.819
Validation loss decreased (-0.811586 --> -0.818832).  Saving model ...
Epoch: 24 cost time: 3.9675004482269287
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.848 Vali Acc: 0.826 Test Loss: 0.848 Test Acc: 0.826
Validation loss decreased (-0.818832 --> -0.826078).  Saving model ...
Epoch: 25 cost time: 4.258069753646851
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.844 Vali Acc: 0.826 Test Loss: 0.844 Test Acc: 0.826
Validation loss decreased (-0.826078 --> -0.826079).  Saving model ...
Epoch: 26 cost time: 4.598176956176758
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.849 Vali Acc: 0.826 Test Loss: 0.849 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.748120546340942
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.852 Vali Acc: 0.826 Test Loss: 0.852 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.84405255317688
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.856 Vali Acc: 0.826 Test Loss: 0.856 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 4.662808895111084
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.855 Vali Acc: 0.826 Test Loss: 0.855 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 4.488580942153931
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.858 Vali Acc: 0.819 Test Loss: 0.858 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 4.499652147293091
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.854 Vali Acc: 0.826 Test Loss: 0.854 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 4.421255350112915
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.862 Vali Acc: 0.826 Test Loss: 0.862 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 4.581856966018677
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.865 Vali Acc: 0.819 Test Loss: 0.865 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 4.634891748428345
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.864 Vali Acc: 0.819 Test Loss: 0.864 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 4.5523693561553955
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.857 Vali Acc: 0.826 Test Loss: 0.857 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df256_ma62_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8260869565217391
model parameter : 11723780
model size : 64.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         42                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df256_ma42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.168023347854614
Epoch: 1, Steps: 9 | Train Loss: 1.443 Vali Loss: 1.218 Vali Acc: 0.449 Test Loss: 1.218 Test Acc: 0.449
Validation loss decreased (inf --> -0.449263).  Saving model ...
Epoch: 2 cost time: 3.826240062713623
Epoch: 2, Steps: 9 | Train Loss: 0.763 Vali Loss: 1.006 Vali Acc: 0.645 Test Loss: 1.006 Test Acc: 0.645
Validation loss decreased (-0.449263 --> -0.644917).  Saving model ...
Epoch: 3 cost time: 3.637080192565918
Epoch: 3, Steps: 9 | Train Loss: 0.268 Vali Loss: 0.702 Vali Acc: 0.739 Test Loss: 0.702 Test Acc: 0.739
Validation loss decreased (-0.644917 --> -0.739123).  Saving model ...
Epoch: 4 cost time: 3.98221755027771
Epoch: 4, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.625 Vali Acc: 0.732 Test Loss: 0.625 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.713369131088257
Epoch: 5, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.911 Vali Acc: 0.775 Test Loss: 0.911 Test Acc: 0.775
Validation loss decreased (-0.739123 --> -0.775353).  Saving model ...
Epoch: 6 cost time: 4.298397779464722
Epoch: 6, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.714 Vali Acc: 0.775 Test Loss: 0.714 Test Acc: 0.775
Validation loss decreased (-0.775353 --> -0.775355).  Saving model ...
Epoch: 7 cost time: 4.249835729598999
Epoch: 7, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.905 Vali Acc: 0.732 Test Loss: 0.905 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.156210899353027
Epoch: 8, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.559 Vali Acc: 0.804 Test Loss: 0.559 Test Acc: 0.804
Validation loss decreased (-0.775355 --> -0.804342).  Saving model ...
Epoch: 9 cost time: 4.39129376411438
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.620 Vali Acc: 0.797 Test Loss: 0.620 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.062232494354248
Epoch: 10, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.723 Vali Acc: 0.783 Test Loss: 0.723 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.293721675872803
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.746 Vali Acc: 0.783 Test Loss: 0.746 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.452112197875977
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.717 Vali Acc: 0.775 Test Loss: 0.717 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.754719972610474
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.683 Vali Acc: 0.783 Test Loss: 0.683 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.703149318695068
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.687 Vali Acc: 0.775 Test Loss: 0.687 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.09084415435791
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.694 Vali Acc: 0.783 Test Loss: 0.694 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.961890459060669
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.783 Test Loss: 0.696 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.6748127937316895
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.783 Test Loss: 0.697 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.37000298500061
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.693 Vali Acc: 0.775 Test Loss: 0.693 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df256_ma42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8043478260869565
model parameter : 11723780
model size : 64.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df256_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.979102849960327
Epoch: 1, Steps: 9 | Train Loss: 1.455 Vali Loss: 1.284 Vali Acc: 0.326 Test Loss: 1.284 Test Acc: 0.326
Validation loss decreased (inf --> -0.326074).  Saving model ...
Epoch: 2 cost time: 4.514090299606323
Epoch: 2, Steps: 9 | Train Loss: 0.835 Vali Loss: 1.127 Vali Acc: 0.594 Test Loss: 1.127 Test Acc: 0.594
Validation loss decreased (-0.326074 --> -0.594192).  Saving model ...
Epoch: 3 cost time: 4.29688572883606
Epoch: 3, Steps: 9 | Train Loss: 0.320 Vali Loss: 0.634 Vali Acc: 0.739 Test Loss: 0.634 Test Acc: 0.739
Validation loss decreased (-0.594192 --> -0.739124).  Saving model ...
Epoch: 4 cost time: 4.183084011077881
Epoch: 4, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.582 Vali Acc: 0.790 Test Loss: 0.582 Test Acc: 0.790
Validation loss decreased (-0.739124 --> -0.789849).  Saving model ...
Epoch: 5 cost time: 3.4030537605285645
Epoch: 5, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.767 Vali Acc: 0.775 Test Loss: 0.767 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.422605037689209
Epoch: 6, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.552 Vali Acc: 0.797 Test Loss: 0.552 Test Acc: 0.797
Validation loss decreased (-0.789849 --> -0.797096).  Saving model ...
Epoch: 7 cost time: 3.7817671298980713
Epoch: 7, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.859 Vali Acc: 0.790 Test Loss: 0.859 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.1554858684539795
Epoch: 8, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.551 Vali Acc: 0.819 Test Loss: 0.551 Test Acc: 0.819
Validation loss decreased (-0.797096 --> -0.818835).  Saving model ...
Epoch: 9 cost time: 4.0011045932769775
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.509 Vali Acc: 0.833 Test Loss: 0.509 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833328).  Saving model ...
Epoch: 10 cost time: 4.373499155044556
Epoch: 10, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.543 Vali Acc: 0.826 Test Loss: 0.543 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.292471170425415
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.602 Vali Acc: 0.826 Test Loss: 0.602 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.496697187423706
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.611 Vali Acc: 0.826 Test Loss: 0.611 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.317491769790649
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.586 Vali Acc: 0.826 Test Loss: 0.586 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.371432304382324
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.581 Vali Acc: 0.833 Test Loss: 0.581 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.220290422439575
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.585 Vali Acc: 0.833 Test Loss: 0.585 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.298227548599243
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.591 Vali Acc: 0.833 Test Loss: 0.591 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.3834288120269775
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.587 Vali Acc: 0.833 Test Loss: 0.587 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.483270883560181
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.579 Vali Acc: 0.833 Test Loss: 0.579 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.584923505783081
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.578 Vali Acc: 0.833 Test Loss: 0.578 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df256_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 11723780
model size : 64.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df256_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.05480694770813
Epoch: 1, Steps: 9 | Train Loss: 1.472 Vali Loss: 1.286 Vali Acc: 0.406 Test Loss: 1.286 Test Acc: 0.406
Validation loss decreased (inf --> -0.405784).  Saving model ...
Epoch: 2 cost time: 4.192818641662598
Epoch: 2, Steps: 9 | Train Loss: 0.862 Vali Loss: 1.112 Vali Acc: 0.507 Test Loss: 1.112 Test Acc: 0.507
Validation loss decreased (-0.405784 --> -0.507235).  Saving model ...
Epoch: 3 cost time: 3.84425687789917
Epoch: 3, Steps: 9 | Train Loss: 0.342 Vali Loss: 0.690 Vali Acc: 0.725 Test Loss: 0.690 Test Acc: 0.725
Validation loss decreased (-0.507235 --> -0.724631).  Saving model ...
Epoch: 4 cost time: 4.428868532180786
Epoch: 4, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.686 Vali Acc: 0.732 Test Loss: 0.686 Test Acc: 0.732
Validation loss decreased (-0.724631 --> -0.731877).  Saving model ...
Epoch: 5 cost time: 3.7679741382598877
Epoch: 5, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.888 Vali Acc: 0.710 Test Loss: 0.888 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.423461675643921
Epoch: 6, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.696 Vali Acc: 0.754 Test Loss: 0.696 Test Acc: 0.754
Validation loss decreased (-0.731877 --> -0.753616).  Saving model ...
Epoch: 7 cost time: 4.219996452331543
Epoch: 7, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.719 Vali Acc: 0.754 Test Loss: 0.719 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.5147478580474854
Epoch: 8, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.816 Vali Acc: 0.732 Test Loss: 0.816 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.626718521118164
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.083 Vali Acc: 0.739 Test Loss: 1.083 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.620004415512085
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.796 Vali Acc: 0.768 Test Loss: 0.796 Test Acc: 0.768
Validation loss decreased (-0.753616 --> -0.768108).  Saving model ...
Epoch: 11 cost time: 4.091942310333252
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.681 Vali Acc: 0.768 Test Loss: 0.681 Test Acc: 0.768
Validation loss decreased (-0.768108 --> -0.768109).  Saving model ...
Epoch: 12 cost time: 4.263230800628662
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.694 Vali Acc: 0.783 Test Loss: 0.694 Test Acc: 0.783
Validation loss decreased (-0.768109 --> -0.782602).  Saving model ...
Epoch: 13 cost time: 4.315602779388428
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.723 Vali Acc: 0.775 Test Loss: 0.723 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.254492998123169
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.744 Vali Acc: 0.783 Test Loss: 0.744 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.219098329544067
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.743 Vali Acc: 0.775 Test Loss: 0.743 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.253045082092285
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.739 Vali Acc: 0.775 Test Loss: 0.739 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.6841416358947754
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.744 Vali Acc: 0.761 Test Loss: 0.744 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.224820852279663
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.745 Vali Acc: 0.768 Test Loss: 0.745 Test Acc: 0.768
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.559552192687988
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.747 Vali Acc: 0.768 Test Loss: 0.747 Test Acc: 0.768
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.346895456314087
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.751 Vali Acc: 0.775 Test Loss: 0.751 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.16088080406189
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.751 Vali Acc: 0.783 Test Loss: 0.751 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.951038122177124
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.751 Vali Acc: 0.783 Test Loss: 0.751 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df256_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.782608695652174
model parameter : 11723780
model size : 64.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df256_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.903880596160889
Epoch: 1, Steps: 9 | Train Loss: 1.493 Vali Loss: 1.245 Vali Acc: 0.457 Test Loss: 1.245 Test Acc: 0.457
Validation loss decreased (inf --> -0.456509).  Saving model ...
Epoch: 2 cost time: 4.221699953079224
Epoch: 2, Steps: 9 | Train Loss: 0.830 Vali Loss: 1.116 Vali Acc: 0.572 Test Loss: 1.116 Test Acc: 0.572
Validation loss decreased (-0.456509 --> -0.572453).  Saving model ...
Epoch: 3 cost time: 4.423094272613525
Epoch: 3, Steps: 9 | Train Loss: 0.329 Vali Loss: 0.913 Vali Acc: 0.652 Test Loss: 0.913 Test Acc: 0.652
Validation loss decreased (-0.572453 --> -0.652165).  Saving model ...
Epoch: 4 cost time: 4.3830015659332275
Epoch: 4, Steps: 9 | Train Loss: 0.139 Vali Loss: 1.023 Vali Acc: 0.659 Test Loss: 1.023 Test Acc: 0.659
Validation loss decreased (-0.652165 --> -0.659410).  Saving model ...
Epoch: 5 cost time: 4.828656435012817
Epoch: 5, Steps: 9 | Train Loss: 0.029 Vali Loss: 1.090 Vali Acc: 0.645 Test Loss: 1.090 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.478025436401367
Epoch: 6, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.259 Vali Acc: 0.623 Test Loss: 1.259 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.466751575469971
Epoch: 7, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.216 Vali Acc: 0.659 Test Loss: 1.216 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.738574504852295
Epoch: 8, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.192 Vali Acc: 0.659 Test Loss: 1.192 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.591454267501831
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.236 Vali Acc: 0.688 Test Loss: 1.236 Test Acc: 0.688
Validation loss decreased (-0.659410 --> -0.688393).  Saving model ...
Epoch: 10 cost time: 3.8535919189453125
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.196 Vali Acc: 0.696 Test Loss: 1.196 Test Acc: 0.696
Validation loss decreased (-0.688393 --> -0.695640).  Saving model ...
Epoch: 11 cost time: 4.296474456787109
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.186 Vali Acc: 0.674 Test Loss: 1.186 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.311971426010132
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.191 Vali Acc: 0.681 Test Loss: 1.191 Test Acc: 0.681
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.118227243423462
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.210 Vali Acc: 0.688 Test Loss: 1.210 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.187707424163818
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.212 Vali Acc: 0.688 Test Loss: 1.212 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.00954532623291
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.214 Vali Acc: 0.688 Test Loss: 1.214 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.360521078109741
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.213 Vali Acc: 0.696 Test Loss: 1.213 Test Acc: 0.696
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.265353202819824
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.217 Vali Acc: 0.688 Test Loss: 1.217 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.9671716690063477
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.207 Vali Acc: 0.696 Test Loss: 1.207 Test Acc: 0.696
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.341098785400391
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.212 Vali Acc: 0.696 Test Loss: 1.212 Test Acc: 0.696
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.22621488571167
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.227 Vali Acc: 0.703 Test Loss: 1.227 Test Acc: 0.703
Validation loss decreased (-0.695640 --> -0.702886).  Saving model ...
Epoch: 21 cost time: 4.2064127922058105
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.240 Vali Acc: 0.696 Test Loss: 1.240 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.425368547439575
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.243 Vali Acc: 0.696 Test Loss: 1.243 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.276862144470215
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.238 Vali Acc: 0.696 Test Loss: 1.238 Test Acc: 0.696
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.2053656578063965
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.245 Vali Acc: 0.696 Test Loss: 1.245 Test Acc: 0.696
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.251097679138184
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.248 Vali Acc: 0.696 Test Loss: 1.248 Test Acc: 0.696
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.387514352798462
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.257 Vali Acc: 0.696 Test Loss: 1.257 Test Acc: 0.696
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.4096009731292725
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.250 Vali Acc: 0.688 Test Loss: 1.250 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.613467216491699
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.255 Vali Acc: 0.688 Test Loss: 1.255 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.293186902999878
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.255 Vali Acc: 0.688 Test Loss: 1.255 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.128055810928345
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.263 Vali Acc: 0.688 Test Loss: 1.263 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df256_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7028985507246377
model parameter : 11723780
model size : 64.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.409740924835205
Epoch: 1, Steps: 9 | Train Loss: 1.483 Vali Loss: 1.394 Vali Acc: 0.304 Test Loss: 1.394 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 4.290544271469116
Epoch: 2, Steps: 9 | Train Loss: 0.949 Vali Loss: 1.271 Vali Acc: 0.420 Test Loss: 1.271 Test Acc: 0.420
Validation loss decreased (-0.304334 --> -0.420277).  Saving model ...
Epoch: 3 cost time: 4.13062047958374
Epoch: 3, Steps: 9 | Train Loss: 0.409 Vali Loss: 1.355 Vali Acc: 0.391 Test Loss: 1.355 Test Acc: 0.391
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.133462190628052
Epoch: 4, Steps: 9 | Train Loss: 0.160 Vali Loss: 1.575 Vali Acc: 0.406 Test Loss: 1.575 Test Acc: 0.406
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.082510709762573
Epoch: 5, Steps: 9 | Train Loss: 0.048 Vali Loss: 1.562 Vali Acc: 0.435 Test Loss: 1.562 Test Acc: 0.435
Validation loss decreased (-0.420277 --> -0.434767).  Saving model ...
Epoch: 6 cost time: 4.499487638473511
Epoch: 6, Steps: 9 | Train Loss: 0.015 Vali Loss: 1.771 Vali Acc: 0.413 Test Loss: 1.771 Test Acc: 0.413
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.196288585662842
Epoch: 7, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.666 Vali Acc: 0.507 Test Loss: 1.666 Test Acc: 0.507
Validation loss decreased (-0.434767 --> -0.507230).  Saving model ...
Epoch: 8 cost time: 3.8595824241638184
Epoch: 8, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.963 Vali Acc: 0.478 Test Loss: 1.963 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.16495943069458
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.105 Vali Acc: 0.428 Test Loss: 2.105 Test Acc: 0.428
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.150301456451416
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.936 Vali Acc: 0.486 Test Loss: 1.936 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.357367277145386
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.866 Vali Acc: 0.529 Test Loss: 1.866 Test Acc: 0.529
Validation loss decreased (-0.507230 --> -0.528967).  Saving model ...
Epoch: 12 cost time: 4.404947280883789
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.878 Vali Acc: 0.529 Test Loss: 1.878 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.380209684371948
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.901 Vali Acc: 0.529 Test Loss: 1.901 Test Acc: 0.529
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.381040334701538
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.873 Vali Acc: 0.522 Test Loss: 1.873 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.205071687698364
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.864 Vali Acc: 0.529 Test Loss: 1.864 Test Acc: 0.529
Validation loss decreased (-0.528967 --> -0.528967).  Saving model ...
Epoch: 16 cost time: 3.519742012023926
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.863 Vali Acc: 0.536 Test Loss: 1.863 Test Acc: 0.536
Validation loss decreased (-0.528967 --> -0.536213).  Saving model ...
Epoch: 17 cost time: 3.350689649581909
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.837 Vali Acc: 0.536 Test Loss: 1.837 Test Acc: 0.536
Validation loss decreased (-0.536213 --> -0.536214).  Saving model ...
Epoch: 18 cost time: 3.1562721729278564
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.837 Vali Acc: 0.543 Test Loss: 1.837 Test Acc: 0.543
Validation loss decreased (-0.536214 --> -0.543460).  Saving model ...
Epoch: 19 cost time: 4.272915840148926
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.841 Vali Acc: 0.551 Test Loss: 1.841 Test Acc: 0.551
Validation loss decreased (-0.543460 --> -0.550706).  Saving model ...
Epoch: 20 cost time: 4.136433362960815
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.839 Vali Acc: 0.558 Test Loss: 1.839 Test Acc: 0.558
Validation loss decreased (-0.550706 --> -0.557953).  Saving model ...
Epoch: 21 cost time: 4.380244731903076
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.834 Vali Acc: 0.551 Test Loss: 1.834 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.265066623687744
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.827 Vali Acc: 0.551 Test Loss: 1.827 Test Acc: 0.551
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.887394428253174
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.825 Vali Acc: 0.551 Test Loss: 1.825 Test Acc: 0.551
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.889033317565918
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.837 Vali Acc: 0.558 Test Loss: 1.837 Test Acc: 0.558
Validation loss decreased (-0.557953 --> -0.557953).  Saving model ...
Epoch: 25 cost time: 4.210443496704102
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.831 Vali Acc: 0.580 Test Loss: 1.831 Test Acc: 0.580
Validation loss decreased (-0.557953 --> -0.579692).  Saving model ...
Epoch: 26 cost time: 3.8590638637542725
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.825 Vali Acc: 0.565 Test Loss: 1.825 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.002512216567993
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.829 Vali Acc: 0.572 Test Loss: 1.829 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.787940740585327
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.827 Vali Acc: 0.572 Test Loss: 1.827 Test Acc: 0.572
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.694214105606079
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.820 Vali Acc: 0.580 Test Loss: 1.820 Test Acc: 0.580
Validation loss decreased (-0.579692 --> -0.579692).  Saving model ...
Epoch: 30 cost time: 4.232651472091675
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.808 Vali Acc: 0.580 Test Loss: 1.808 Test Acc: 0.580
Validation loss decreased (-0.579692 --> -0.579692).  Saving model ...
Epoch: 31 cost time: 4.426178216934204
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.820 Vali Acc: 0.580 Test Loss: 1.820 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.710116147994995
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.809 Vali Acc: 0.580 Test Loss: 1.809 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 4.028541088104248
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.803 Vali Acc: 0.580 Test Loss: 1.803 Test Acc: 0.580
Validation loss decreased (-0.579692 --> -0.579692).  Saving model ...
Epoch: 34 cost time: 4.025357961654663
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.803 Vali Acc: 0.587 Test Loss: 1.803 Test Acc: 0.587
Validation loss decreased (-0.579692 --> -0.586938).  Saving model ...
Epoch: 35 cost time: 4.3003013134002686
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.813 Vali Acc: 0.594 Test Loss: 1.813 Test Acc: 0.594
Validation loss decreased (-0.586938 --> -0.594185).  Saving model ...
Epoch: 36 cost time: 3.8833518028259277
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.818 Vali Acc: 0.587 Test Loss: 1.818 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 4.220650672912598
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.811 Vali Acc: 0.587 Test Loss: 1.811 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 4.235322952270508
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.810 Vali Acc: 0.587 Test Loss: 1.810 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 4.414866209030151
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.815 Vali Acc: 0.587 Test Loss: 1.815 Test Acc: 0.587
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 4.132322072982788
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.813 Vali Acc: 0.587 Test Loss: 1.813 Test Acc: 0.587
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 3.899073362350464
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.806 Vali Acc: 0.580 Test Loss: 1.806 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 4.11043381690979
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.803 Vali Acc: 0.594 Test Loss: 1.803 Test Acc: 0.594
Validation loss decreased (-0.594185 --> -0.594185).  Saving model ...
Epoch: 43 cost time: 4.197247505187988
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.805 Vali Acc: 0.594 Test Loss: 1.805 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 4.380344867706299
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.820 Vali Acc: 0.594 Test Loss: 1.820 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 4.515123605728149
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.829 Vali Acc: 0.587 Test Loss: 1.829 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 4.130212783813477
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.827 Vali Acc: 0.594 Test Loss: 1.827 Test Acc: 0.594
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 4.111740589141846
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.825 Vali Acc: 0.601 Test Loss: 1.825 Test Acc: 0.601
Validation loss decreased (-0.594185 --> -0.601431).  Saving model ...
Epoch: 48 cost time: 3.663708448410034
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.834 Vali Acc: 0.594 Test Loss: 1.834 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.8974173069000244
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.835 Vali Acc: 0.601 Test Loss: 1.835 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 3.658132314682007
Epoch: 50, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.829 Vali Acc: 0.594 Test Loss: 1.829 Test Acc: 0.594
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 3.7884469032287598
Epoch: 51, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.824 Vali Acc: 0.587 Test Loss: 1.824 Test Acc: 0.587
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 4.118620157241821
Epoch: 52, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.822 Vali Acc: 0.594 Test Loss: 1.822 Test Acc: 0.594
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 4.240659952163696
Epoch: 53, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.824 Vali Acc: 0.594 Test Loss: 1.824 Test Acc: 0.594
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 4.377672433853149
Epoch: 54, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.826 Vali Acc: 0.594 Test Loss: 1.826 Test Acc: 0.594
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 4.494580268859863
Epoch: 55, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.829 Vali Acc: 0.601 Test Loss: 1.829 Test Acc: 0.601
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 4.315778732299805
Epoch: 56, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.829 Vali Acc: 0.601 Test Loss: 1.829 Test Acc: 0.601
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 3.8968963623046875
Epoch: 57, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.830 Vali Acc: 0.594 Test Loss: 1.830 Test Acc: 0.594
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.6014492753623188
model parameter : 11723780
model size : 64.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.244061470031738
Epoch: 1, Steps: 9 | Train Loss: 1.442 Vali Loss: 1.544 Vali Acc: 0.275 Test Loss: 1.544 Test Acc: 0.275
Validation loss decreased (inf --> -0.275347).  Saving model ...
Epoch: 2 cost time: 4.473455905914307
Epoch: 2, Steps: 9 | Train Loss: 1.084 Vali Loss: 1.334 Vali Acc: 0.319 Test Loss: 1.334 Test Acc: 0.319
Validation loss decreased (-0.275347 --> -0.318827).  Saving model ...
Epoch: 3 cost time: 4.497255086898804
Epoch: 3, Steps: 9 | Train Loss: 0.647 Vali Loss: 2.043 Vali Acc: 0.283 Test Loss: 2.043 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.438295841217041
Epoch: 4, Steps: 9 | Train Loss: 0.295 Vali Loss: 2.218 Vali Acc: 0.312 Test Loss: 2.218 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.410255432128906
Epoch: 5, Steps: 9 | Train Loss: 0.105 Vali Loss: 2.678 Vali Acc: 0.326 Test Loss: 2.678 Test Acc: 0.326
Validation loss decreased (-0.318827 --> -0.326060).  Saving model ...
Epoch: 6 cost time: 3.85870361328125
Epoch: 6, Steps: 9 | Train Loss: 0.052 Vali Loss: 2.437 Vali Acc: 0.348 Test Loss: 2.437 Test Acc: 0.348
Validation loss decreased (-0.326060 --> -0.347802).  Saving model ...
Epoch: 7 cost time: 3.606055974960327
Epoch: 7, Steps: 9 | Train Loss: 0.015 Vali Loss: 2.774 Vali Acc: 0.355 Test Loss: 2.774 Test Acc: 0.355
Validation loss decreased (-0.347802 --> -0.355045).  Saving model ...
Epoch: 8 cost time: 4.175585985183716
Epoch: 8, Steps: 9 | Train Loss: 0.006 Vali Loss: 2.729 Vali Acc: 0.384 Test Loss: 2.729 Test Acc: 0.384
Validation loss decreased (-0.355045 --> -0.384031).  Saving model ...
Epoch: 9 cost time: 4.426916122436523
Epoch: 9, Steps: 9 | Train Loss: 0.003 Vali Loss: 2.406 Vali Acc: 0.428 Test Loss: 2.406 Test Acc: 0.428
Validation loss decreased (-0.384031 --> -0.427512).  Saving model ...
Epoch: 10 cost time: 4.333171129226685
Epoch: 10, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.924 Vali Acc: 0.362 Test Loss: 2.924 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.793088436126709
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 3.068 Vali Acc: 0.377 Test Loss: 3.068 Test Acc: 0.377
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.228423833847046
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.791 Vali Acc: 0.420 Test Loss: 2.791 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.359891891479492
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.647 Vali Acc: 0.428 Test Loss: 2.647 Test Acc: 0.428
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.8560123443603516
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.680 Vali Acc: 0.442 Test Loss: 2.680 Test Acc: 0.442
Validation loss decreased (-0.427512 --> -0.442002).  Saving model ...
Epoch: 15 cost time: 3.666503429412842
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.750 Vali Acc: 0.435 Test Loss: 2.750 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.028721809387207
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.732 Vali Acc: 0.442 Test Loss: 2.732 Test Acc: 0.442
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.394366979598999
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.718 Vali Acc: 0.449 Test Loss: 2.718 Test Acc: 0.449
Validation loss decreased (-0.442002 --> -0.449248).  Saving model ...
Epoch: 18 cost time: 4.480252504348755
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.733 Vali Acc: 0.449 Test Loss: 2.733 Test Acc: 0.449
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.529217004776001
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.751 Vali Acc: 0.449 Test Loss: 2.751 Test Acc: 0.449
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.329655647277832
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.787 Vali Acc: 0.449 Test Loss: 2.787 Test Acc: 0.449
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.221468687057495
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.781 Vali Acc: 0.449 Test Loss: 2.781 Test Acc: 0.449
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.65006422996521
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.802 Vali Acc: 0.449 Test Loss: 2.802 Test Acc: 0.449
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.3955585956573486
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.860 Vali Acc: 0.442 Test Loss: 2.860 Test Acc: 0.442
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.3099069595336914
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.805 Vali Acc: 0.457 Test Loss: 2.805 Test Acc: 0.457
Validation loss decreased (-0.449248 --> -0.456494).  Saving model ...
Epoch: 25 cost time: 4.25380277633667
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.810 Vali Acc: 0.464 Test Loss: 2.810 Test Acc: 0.464
Validation loss decreased (-0.456494 --> -0.463740).  Saving model ...
Epoch: 26 cost time: 4.213644027709961
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.807 Vali Acc: 0.471 Test Loss: 2.807 Test Acc: 0.471
Validation loss decreased (-0.463740 --> -0.470986).  Saving model ...
Epoch: 27 cost time: 4.4521801471710205
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.848 Vali Acc: 0.471 Test Loss: 2.848 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.229538202285767
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.866 Vali Acc: 0.478 Test Loss: 2.866 Test Acc: 0.478
Validation loss decreased (-0.470986 --> -0.478232).  Saving model ...
Epoch: 29 cost time: 4.121699810028076
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.851 Vali Acc: 0.478 Test Loss: 2.851 Test Acc: 0.478
Validation loss decreased (-0.478232 --> -0.478232).  Saving model ...
Epoch: 30 cost time: 4.286869764328003
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.806 Vali Acc: 0.493 Test Loss: 2.806 Test Acc: 0.493
Validation loss decreased (-0.478232 --> -0.492726).  Saving model ...
Epoch: 31 cost time: 4.127307891845703
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.803 Vali Acc: 0.486 Test Loss: 2.803 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.9211134910583496
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.788 Vali Acc: 0.500 Test Loss: 2.788 Test Acc: 0.500
Validation loss decreased (-0.492726 --> -0.499972).  Saving model ...
Epoch: 33 cost time: 3.8430919647216797
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.800 Vali Acc: 0.500 Test Loss: 2.800 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.9596731662750244
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.840 Vali Acc: 0.507 Test Loss: 2.840 Test Acc: 0.507
Validation loss decreased (-0.499972 --> -0.507218).  Saving model ...
Epoch: 35 cost time: 4.397459983825684
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.850 Vali Acc: 0.493 Test Loss: 2.850 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 4.329924583435059
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.841 Vali Acc: 0.493 Test Loss: 2.841 Test Acc: 0.493
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 4.276276350021362
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.818 Vali Acc: 0.500 Test Loss: 2.818 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.868425130844116
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.818 Vali Acc: 0.500 Test Loss: 2.818 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.6207847595214844
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.852 Vali Acc: 0.500 Test Loss: 2.852 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.858323812484741
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.889 Vali Acc: 0.507 Test Loss: 2.889 Test Acc: 0.507
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 4.380750417709351
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.861 Vali Acc: 0.529 Test Loss: 2.861 Test Acc: 0.529
Validation loss decreased (-0.507218 --> -0.528957).  Saving model ...
Epoch: 42 cost time: 4.360111951828003
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.837 Vali Acc: 0.522 Test Loss: 2.837 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.8072705268859863
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.831 Vali Acc: 0.514 Test Loss: 2.831 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.9889073371887207
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.846 Vali Acc: 0.514 Test Loss: 2.846 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.90460467338562
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.889 Vali Acc: 0.507 Test Loss: 2.889 Test Acc: 0.507
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 4.300165414810181
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.912 Vali Acc: 0.500 Test Loss: 2.912 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 4.2337470054626465
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.914 Vali Acc: 0.500 Test Loss: 2.914 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 4.216730356216431
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.932 Vali Acc: 0.507 Test Loss: 2.932 Test Acc: 0.507
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 4.361820459365845
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.936 Vali Acc: 0.507 Test Loss: 2.936 Test Acc: 0.507
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 4.600967645645142
Epoch: 50, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.927 Vali Acc: 0.507 Test Loss: 2.927 Test Acc: 0.507
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 4.183062553405762
Epoch: 51, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.918 Vali Acc: 0.514 Test Loss: 2.918 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5289855072463768
model parameter : 11723780
model size : 64.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.486248254776001
Epoch: 1, Steps: 9 | Train Loss: 1.437 Vali Loss: 1.515 Vali Acc: 0.210 Test Loss: 1.515 Test Acc: 0.210
Validation loss decreased (inf --> -0.210130).  Saving model ...
Epoch: 2 cost time: 3.84371018409729
Epoch: 2, Steps: 9 | Train Loss: 1.030 Vali Loss: 1.355 Vali Acc: 0.355 Test Loss: 1.355 Test Acc: 0.355
Validation loss decreased (-0.210130 --> -0.355059).  Saving model ...
Epoch: 3 cost time: 3.984934091567993
Epoch: 3, Steps: 9 | Train Loss: 0.585 Vali Loss: 1.612 Vali Acc: 0.304 Test Loss: 1.612 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.1041176319122314
Epoch: 4, Steps: 9 | Train Loss: 0.233 Vali Loss: 1.750 Vali Acc: 0.312 Test Loss: 1.750 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.207009553909302
Epoch: 5, Steps: 9 | Train Loss: 0.083 Vali Loss: 1.682 Vali Acc: 0.362 Test Loss: 1.682 Test Acc: 0.362
Validation loss decreased (-0.355059 --> -0.362302).  Saving model ...
Epoch: 6 cost time: 4.029108285903931
Epoch: 6, Steps: 9 | Train Loss: 0.025 Vali Loss: 1.610 Vali Acc: 0.471 Test Loss: 1.610 Test Acc: 0.471
Validation loss decreased (-0.362302 --> -0.470998).  Saving model ...
Epoch: 7 cost time: 3.904879093170166
Epoch: 7, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.880 Vali Acc: 0.413 Test Loss: 1.880 Test Acc: 0.413
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.231684684753418
Epoch: 8, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.892 Vali Acc: 0.449 Test Loss: 1.892 Test Acc: 0.449
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.820070266723633
Epoch: 9, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.654 Vali Acc: 0.522 Test Loss: 1.654 Test Acc: 0.522
Validation loss decreased (-0.470998 --> -0.521723).  Saving model ...
Epoch: 10 cost time: 3.8360047340393066
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.633 Vali Acc: 0.493 Test Loss: 1.633 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.8118526935577393
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.729 Vali Acc: 0.478 Test Loss: 1.729 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.751521110534668
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.771 Vali Acc: 0.493 Test Loss: 1.771 Test Acc: 0.493
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.226534605026245
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.769 Vali Acc: 0.486 Test Loss: 1.769 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.298545837402344
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.736 Vali Acc: 0.500 Test Loss: 1.736 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.628982305526733
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.720 Vali Acc: 0.507 Test Loss: 1.720 Test Acc: 0.507
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.5304131507873535
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.692 Vali Acc: 0.507 Test Loss: 1.692 Test Acc: 0.507
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.9203274250030518
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.697 Vali Acc: 0.551 Test Loss: 1.697 Test Acc: 0.551
Validation loss decreased (-0.521723 --> -0.550708).  Saving model ...
Epoch: 18 cost time: 3.47464656829834
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.711 Vali Acc: 0.551 Test Loss: 1.711 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.8392295837402344
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.746 Vali Acc: 0.551 Test Loss: 1.746 Test Acc: 0.551
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.8022706508636475
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.773 Vali Acc: 0.551 Test Loss: 1.773 Test Acc: 0.551
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.118077754974365
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.765 Vali Acc: 0.551 Test Loss: 1.765 Test Acc: 0.551
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.684948682785034
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.764 Vali Acc: 0.565 Test Loss: 1.764 Test Acc: 0.565
Validation loss decreased (-0.550708 --> -0.565200).  Saving model ...
Epoch: 23 cost time: 3.628270149230957
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.774 Vali Acc: 0.565 Test Loss: 1.774 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.344754457473755
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.773 Vali Acc: 0.558 Test Loss: 1.773 Test Acc: 0.558
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.509373188018799
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.788 Vali Acc: 0.558 Test Loss: 1.788 Test Acc: 0.558
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.334978103637695
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.796 Vali Acc: 0.558 Test Loss: 1.796 Test Acc: 0.558
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.398674964904785
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.802 Vali Acc: 0.558 Test Loss: 1.802 Test Acc: 0.558
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.394888401031494
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.804 Vali Acc: 0.558 Test Loss: 1.804 Test Acc: 0.558
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.934284210205078
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.805 Vali Acc: 0.565 Test Loss: 1.805 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.8608510494232178
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.791 Vali Acc: 0.565 Test Loss: 1.791 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.996731996536255
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.784 Vali Acc: 0.565 Test Loss: 1.784 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.605513095855713
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.782 Vali Acc: 0.572 Test Loss: 1.782 Test Acc: 0.572
Validation loss decreased (-0.565200 --> -0.572446).  Saving model ...
Epoch: 33 cost time: 4.224438428878784
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.788 Vali Acc: 0.565 Test Loss: 1.788 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 4.118004083633423
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.796 Vali Acc: 0.565 Test Loss: 1.796 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 4.3058764934539795
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.798 Vali Acc: 0.572 Test Loss: 1.798 Test Acc: 0.572
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 4.204615592956543
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.805 Vali Acc: 0.565 Test Loss: 1.805 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.610396385192871
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.816 Vali Acc: 0.580 Test Loss: 1.816 Test Acc: 0.580
Validation loss decreased (-0.572446 --> -0.579692).  Saving model ...
Epoch: 38 cost time: 3.8997373580932617
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.827 Vali Acc: 0.580 Test Loss: 1.827 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 4.309937953948975
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.845 Vali Acc: 0.572 Test Loss: 1.845 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.944901704788208
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.854 Vali Acc: 0.580 Test Loss: 1.854 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 4.561746597290039
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.843 Vali Acc: 0.587 Test Loss: 1.843 Test Acc: 0.587
Validation loss decreased (-0.579692 --> -0.586938).  Saving model ...
Epoch: 42 cost time: 4.0923542976379395
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.833 Vali Acc: 0.594 Test Loss: 1.833 Test Acc: 0.594
Validation loss decreased (-0.586938 --> -0.594185).  Saving model ...
Epoch: 43 cost time: 4.054908990859985
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.833 Vali Acc: 0.594 Test Loss: 1.833 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 4.03916072845459
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.843 Vali Acc: 0.587 Test Loss: 1.843 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 4.112603187561035
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.855 Vali Acc: 0.587 Test Loss: 1.855 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 4.478900671005249
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.859 Vali Acc: 0.587 Test Loss: 1.859 Test Acc: 0.587
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 4.179844379425049
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.860 Vali Acc: 0.587 Test Loss: 1.860 Test Acc: 0.587
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 3.745514154434204
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.866 Vali Acc: 0.587 Test Loss: 1.866 Test Acc: 0.587
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 4.160347938537598
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.870 Vali Acc: 0.587 Test Loss: 1.870 Test Acc: 0.587
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 4.48565936088562
Epoch: 50, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.874 Vali Acc: 0.594 Test Loss: 1.874 Test Acc: 0.594
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 4.528822422027588
Epoch: 51, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.877 Vali Acc: 0.594 Test Loss: 1.877 Test Acc: 0.594
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 4.547471761703491
Epoch: 52, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.883 Vali Acc: 0.594 Test Loss: 1.883 Test Acc: 0.594
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5942028985507246
model parameter : 11723780
model size : 64.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         103                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df128_ma103_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.785330295562744
Epoch: 1, Steps: 9 | Train Loss: 1.377 Vali Loss: 1.197 Vali Acc: 0.391 Test Loss: 1.197 Test Acc: 0.391
Validation loss decreased (inf --> -0.391292).  Saving model ...
Epoch: 2 cost time: 4.296738147735596
Epoch: 2, Steps: 9 | Train Loss: 0.732 Vali Loss: 0.831 Vali Acc: 0.645 Test Loss: 0.831 Test Acc: 0.645
Validation loss decreased (-0.391292 --> -0.644919).  Saving model ...
Epoch: 3 cost time: 4.3307085037231445
Epoch: 3, Steps: 9 | Train Loss: 0.241 Vali Loss: 0.968 Vali Acc: 0.696 Test Loss: 0.968 Test Acc: 0.696
Validation loss decreased (-0.644919 --> -0.695642).  Saving model ...
Epoch: 4 cost time: 3.8814923763275146
Epoch: 4, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.963 Vali Acc: 0.710 Test Loss: 0.963 Test Acc: 0.710
Validation loss decreased (-0.695642 --> -0.710135).  Saving model ...
Epoch: 5 cost time: 4.431731939315796
Epoch: 5, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.769 Vali Acc: 0.761 Test Loss: 0.769 Test Acc: 0.761
Validation loss decreased (-0.710135 --> -0.760862).  Saving model ...
Epoch: 6 cost time: 4.201413154602051
Epoch: 6, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.137 Vali Acc: 0.746 Test Loss: 1.137 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.152201414108276
Epoch: 7, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.844 Vali Acc: 0.761 Test Loss: 0.844 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.504074573516846
Epoch: 8, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.795 Vali Acc: 0.783 Test Loss: 0.795 Test Acc: 0.783
Validation loss decreased (-0.760862 --> -0.782601).  Saving model ...
Epoch: 9 cost time: 4.382841110229492
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.999 Vali Acc: 0.754 Test Loss: 0.999 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.532623529434204
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.118 Vali Acc: 0.739 Test Loss: 1.118 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.347641229629517
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.000 Vali Acc: 0.739 Test Loss: 1.000 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.72435736656189
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.953 Vali Acc: 0.754 Test Loss: 0.953 Test Acc: 0.754
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.564213275909424
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.942 Vali Acc: 0.739 Test Loss: 0.942 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.8435585498809814
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.946 Vali Acc: 0.739 Test Loss: 0.946 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.442734479904175
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.947 Vali Acc: 0.739 Test Loss: 0.947 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.35245418548584
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.955 Vali Acc: 0.739 Test Loss: 0.955 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.3972532749176025
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.957 Vali Acc: 0.739 Test Loss: 0.957 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.3238296508789062
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.960 Vali Acc: 0.739 Test Loss: 0.960 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df128_ma103_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.782608695652174
model parameter : 11330564
model size : 62.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         83                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df128_ma83_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.52799129486084
Epoch: 1, Steps: 9 | Train Loss: 1.385 Vali Loss: 1.197 Vali Acc: 0.435 Test Loss: 1.197 Test Acc: 0.435
Validation loss decreased (inf --> -0.434771).  Saving model ...
Epoch: 2 cost time: 4.376729249954224
Epoch: 2, Steps: 9 | Train Loss: 0.751 Vali Loss: 0.842 Vali Acc: 0.688 Test Loss: 0.842 Test Acc: 0.688
Validation loss decreased (-0.434771 --> -0.688397).  Saving model ...
Epoch: 3 cost time: 4.4748854637146
Epoch: 3, Steps: 9 | Train Loss: 0.260 Vali Loss: 0.925 Vali Acc: 0.688 Test Loss: 0.925 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.261615753173828
Epoch: 4, Steps: 9 | Train Loss: 0.065 Vali Loss: 1.059 Vali Acc: 0.688 Test Loss: 1.059 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.1879472732543945
Epoch: 5, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.681 Vali Acc: 0.761 Test Loss: 0.681 Test Acc: 0.761
Validation loss decreased (-0.688397 --> -0.760863).  Saving model ...
Epoch: 6 cost time: 4.299225330352783
Epoch: 6, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.165 Vali Acc: 0.761 Test Loss: 1.165 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.666411876678467
Epoch: 7, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.777 Vali Acc: 0.768 Test Loss: 0.777 Test Acc: 0.768
Validation loss decreased (-0.760863 --> -0.768108).  Saving model ...
Epoch: 8 cost time: 4.508174657821655
Epoch: 8, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.733 Vali Acc: 0.783 Test Loss: 0.733 Test Acc: 0.783
Validation loss decreased (-0.768108 --> -0.782601).  Saving model ...
Epoch: 9 cost time: 4.5359861850738525
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.859 Vali Acc: 0.790 Test Loss: 0.859 Test Acc: 0.790
Validation loss decreased (-0.782601 --> -0.789846).  Saving model ...
Epoch: 10 cost time: 5.046441078186035
Epoch: 10, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.936 Vali Acc: 0.775 Test Loss: 0.936 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.568878650665283
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.892 Vali Acc: 0.790 Test Loss: 0.892 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.4342076778411865
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.862 Vali Acc: 0.804 Test Loss: 0.862 Test Acc: 0.804
Validation loss decreased (-0.789846 --> -0.804339).  Saving model ...
Epoch: 13 cost time: 4.258226156234741
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.848 Vali Acc: 0.804 Test Loss: 0.848 Test Acc: 0.804
Validation loss decreased (-0.804339 --> -0.804339).  Saving model ...
Epoch: 14 cost time: 4.507856845855713
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.848 Vali Acc: 0.812 Test Loss: 0.848 Test Acc: 0.812
Validation loss decreased (-0.804339 --> -0.811586).  Saving model ...
Epoch: 15 cost time: 4.43151330947876
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.842 Vali Acc: 0.812 Test Loss: 0.842 Test Acc: 0.812
Validation loss decreased (-0.811586 --> -0.811586).  Saving model ...
Epoch: 16 cost time: 4.625378131866455
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.849 Vali Acc: 0.812 Test Loss: 0.849 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.656384229660034
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.854 Vali Acc: 0.812 Test Loss: 0.854 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.746142864227295
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.859 Vali Acc: 0.804 Test Loss: 0.859 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.486672401428223
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.854 Vali Acc: 0.804 Test Loss: 0.854 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.043867588043213
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.797 Test Loss: 0.845 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.660686016082764
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.855 Vali Acc: 0.797 Test Loss: 0.855 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.735037326812744
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.862 Vali Acc: 0.797 Test Loss: 0.862 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.5503129959106445
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.873 Vali Acc: 0.797 Test Loss: 0.873 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.19257116317749
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.871 Vali Acc: 0.797 Test Loss: 0.871 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.608342885971069
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.869 Vali Acc: 0.797 Test Loss: 0.869 Test Acc: 0.797
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df128_ma83_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8115942028985508
model parameter : 11330564
model size : 62.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         62                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df128_ma62_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.791261196136475
Epoch: 1, Steps: 9 | Train Loss: 1.401 Vali Loss: 1.206 Vali Acc: 0.435 Test Loss: 1.206 Test Acc: 0.435
Validation loss decreased (inf --> -0.434771).  Saving model ...
Epoch: 2 cost time: 4.016258239746094
Epoch: 2, Steps: 9 | Train Loss: 0.757 Vali Loss: 0.859 Vali Acc: 0.681 Test Loss: 0.859 Test Acc: 0.681
Validation loss decreased (-0.434771 --> -0.681151).  Saving model ...
Epoch: 3 cost time: 4.137740612030029
Epoch: 3, Steps: 9 | Train Loss: 0.241 Vali Loss: 0.934 Vali Acc: 0.688 Test Loss: 0.934 Test Acc: 0.688
Validation loss decreased (-0.681151 --> -0.688396).  Saving model ...
Epoch: 4 cost time: 4.165903568267822
Epoch: 4, Steps: 9 | Train Loss: 0.058 Vali Loss: 1.066 Vali Acc: 0.710 Test Loss: 1.066 Test Acc: 0.710
Validation loss decreased (-0.688396 --> -0.710134).  Saving model ...
Epoch: 5 cost time: 4.734235525131226
Epoch: 5, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.704 Vali Acc: 0.739 Test Loss: 0.704 Test Acc: 0.739
Validation loss decreased (-0.710134 --> -0.739123).  Saving model ...
Epoch: 6 cost time: 4.910437822341919
Epoch: 6, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.070 Vali Acc: 0.783 Test Loss: 1.070 Test Acc: 0.783
Validation loss decreased (-0.739123 --> -0.782598).  Saving model ...
Epoch: 7 cost time: 4.929495573043823
Epoch: 7, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.844 Vali Acc: 0.804 Test Loss: 0.844 Test Acc: 0.804
Validation loss decreased (-0.782598 --> -0.804339).  Saving model ...
Epoch: 8 cost time: 4.603099822998047
Epoch: 8, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.880 Vali Acc: 0.732 Test Loss: 0.880 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.52832293510437
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.029 Vali Acc: 0.804 Test Loss: 1.029 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.29382848739624
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.114 Vali Acc: 0.790 Test Loss: 1.114 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.381402969360352
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.945 Vali Acc: 0.819 Test Loss: 0.945 Test Acc: 0.819
Validation loss decreased (-0.804339 --> -0.818831).  Saving model ...
Epoch: 12 cost time: 4.840626001358032
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.895 Vali Acc: 0.833 Test Loss: 0.895 Test Acc: 0.833
Validation loss decreased (-0.818831 --> -0.833324).  Saving model ...
Epoch: 13 cost time: 4.99252462387085
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.895 Vali Acc: 0.819 Test Loss: 0.895 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.859315633773804
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.909 Vali Acc: 0.819 Test Loss: 0.909 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.675307273864746
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.915 Vali Acc: 0.819 Test Loss: 0.915 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.063252687454224
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.920 Vali Acc: 0.819 Test Loss: 0.920 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.167745113372803
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.927 Vali Acc: 0.826 Test Loss: 0.927 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.9813661575317383
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.928 Vali Acc: 0.826 Test Loss: 0.928 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.426060676574707
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.925 Vali Acc: 0.826 Test Loss: 0.925 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.865007162094116
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.917 Vali Acc: 0.826 Test Loss: 0.917 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.454387664794922
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.925 Vali Acc: 0.826 Test Loss: 0.925 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.377763986587524
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.926 Vali Acc: 0.826 Test Loss: 0.926 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df128_ma62_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 11330564
model size : 62.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         42                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df128_ma42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.931230783462524
Epoch: 1, Steps: 9 | Train Loss: 1.403 Vali Loss: 1.174 Vali Acc: 0.464 Test Loss: 1.174 Test Acc: 0.464
Validation loss decreased (inf --> -0.463756).  Saving model ...
Epoch: 2 cost time: 4.213074445724487
Epoch: 2, Steps: 9 | Train Loss: 0.715 Vali Loss: 0.806 Vali Acc: 0.659 Test Loss: 0.806 Test Acc: 0.659
Validation loss decreased (-0.463756 --> -0.659412).  Saving model ...
Epoch: 3 cost time: 4.3481292724609375
Epoch: 3, Steps: 9 | Train Loss: 0.216 Vali Loss: 0.855 Vali Acc: 0.725 Test Loss: 0.855 Test Acc: 0.725
Validation loss decreased (-0.659412 --> -0.724629).  Saving model ...
Epoch: 4 cost time: 4.5020692348480225
Epoch: 4, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.883 Vali Acc: 0.717 Test Loss: 0.883 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.387960910797119
Epoch: 5, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.589 Vali Acc: 0.768 Test Loss: 0.589 Test Acc: 0.768
Validation loss decreased (-0.724629 --> -0.768110).  Saving model ...
Epoch: 6 cost time: 4.387653112411499
Epoch: 6, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.120 Vali Acc: 0.739 Test Loss: 1.120 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.482988357543945
Epoch: 7, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.804 Vali Acc: 0.783 Test Loss: 0.804 Test Acc: 0.783
Validation loss decreased (-0.768110 --> -0.782601).  Saving model ...
Epoch: 8 cost time: 4.345757722854614
Epoch: 8, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.626 Vali Acc: 0.768 Test Loss: 0.626 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.364628553390503
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.687 Vali Acc: 0.696 Test Loss: 1.687 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.292456388473511
Epoch: 10, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.907 Vali Acc: 0.783 Test Loss: 0.907 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.653862237930298
Epoch: 11, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.853 Vali Acc: 0.768 Test Loss: 0.853 Test Acc: 0.768
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.708303213119507
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.857 Vali Acc: 0.790 Test Loss: 0.857 Test Acc: 0.790
Validation loss decreased (-0.782601 --> -0.789847).  Saving model ...
Epoch: 13 cost time: 4.791202783584595
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.933 Vali Acc: 0.790 Test Loss: 0.933 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.802798271179199
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.953 Vali Acc: 0.775 Test Loss: 0.953 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.7666990756988525
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.947 Vali Acc: 0.783 Test Loss: 0.947 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.553642511367798
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.943 Vali Acc: 0.797 Test Loss: 0.943 Test Acc: 0.797
Validation loss decreased (-0.789847 --> -0.797092).  Saving model ...
Epoch: 17 cost time: 4.442159175872803
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.941 Vali Acc: 0.797 Test Loss: 0.941 Test Acc: 0.797
Validation loss decreased (-0.797092 --> -0.797092).  Saving model ...
Epoch: 18 cost time: 4.042155504226685
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.929 Vali Acc: 0.797 Test Loss: 0.929 Test Acc: 0.797
Validation loss decreased (-0.797092 --> -0.797092).  Saving model ...
Epoch: 19 cost time: 3.686123847961426
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.919 Vali Acc: 0.797 Test Loss: 0.919 Test Acc: 0.797
Validation loss decreased (-0.797092 --> -0.797092).  Saving model ...
Epoch: 20 cost time: 4.409403324127197
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.907 Vali Acc: 0.797 Test Loss: 0.907 Test Acc: 0.797
Validation loss decreased (-0.797092 --> -0.797092).  Saving model ...
Epoch: 21 cost time: 4.412322044372559
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.903 Vali Acc: 0.797 Test Loss: 0.903 Test Acc: 0.797
Validation loss decreased (-0.797092 --> -0.797092).  Saving model ...
Epoch: 22 cost time: 4.298800945281982
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.900 Vali Acc: 0.797 Test Loss: 0.900 Test Acc: 0.797
Validation loss decreased (-0.797092 --> -0.797092).  Saving model ...
Epoch: 23 cost time: 4.481627941131592
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.898 Vali Acc: 0.797 Test Loss: 0.898 Test Acc: 0.797
Validation loss decreased (-0.797092 --> -0.797092).  Saving model ...
Epoch: 24 cost time: 3.8803536891937256
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.894 Vali Acc: 0.797 Test Loss: 0.894 Test Acc: 0.797
Validation loss decreased (-0.797092 --> -0.797093).  Saving model ...
Epoch: 25 cost time: 3.5620646476745605
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.893 Vali Acc: 0.797 Test Loss: 0.893 Test Acc: 0.797
Validation loss decreased (-0.797093 --> -0.797093).  Saving model ...
Epoch: 26 cost time: 4.158351898193359
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.886 Vali Acc: 0.797 Test Loss: 0.886 Test Acc: 0.797
Validation loss decreased (-0.797093 --> -0.797093).  Saving model ...
Epoch: 27 cost time: 4.287692308425903
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.886 Vali Acc: 0.797 Test Loss: 0.886 Test Acc: 0.797
Validation loss decreased (-0.797093 --> -0.797093).  Saving model ...
Epoch: 28 cost time: 4.759021759033203
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.889 Vali Acc: 0.797 Test Loss: 0.889 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.95423436164856
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.893 Vali Acc: 0.797 Test Loss: 0.893 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 4.871633768081665
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.896 Vali Acc: 0.797 Test Loss: 0.896 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 4.976897478103638
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.896 Vali Acc: 0.797 Test Loss: 0.896 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 4.238925457000732
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.899 Vali Acc: 0.790 Test Loss: 0.899 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 4.2029128074646
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.897 Vali Acc: 0.797 Test Loss: 0.897 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 4.612819671630859
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.896 Vali Acc: 0.797 Test Loss: 0.896 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 4.770849704742432
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.894 Vali Acc: 0.797 Test Loss: 0.894 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 4.6954123973846436
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.890 Vali Acc: 0.797 Test Loss: 0.890 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 4.35263991355896
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.893 Vali Acc: 0.797 Test Loss: 0.893 Test Acc: 0.797
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df128_ma42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7971014492753623
model parameter : 11330564
model size : 62.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df128_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.369455099105835
Epoch: 1, Steps: 9 | Train Loss: 1.433 Vali Loss: 1.212 Vali Acc: 0.471 Test Loss: 1.212 Test Acc: 0.471
Validation loss decreased (inf --> -0.471002).  Saving model ...
Epoch: 2 cost time: 4.234891891479492
Epoch: 2, Steps: 9 | Train Loss: 0.745 Vali Loss: 0.838 Vali Acc: 0.667 Test Loss: 0.838 Test Acc: 0.667
Validation loss decreased (-0.471002 --> -0.666658).  Saving model ...
Epoch: 3 cost time: 3.8812286853790283
Epoch: 3, Steps: 9 | Train Loss: 0.242 Vali Loss: 0.789 Vali Acc: 0.725 Test Loss: 0.789 Test Acc: 0.725
Validation loss decreased (-0.666658 --> -0.724630).  Saving model ...
Epoch: 4 cost time: 4.511976003646851
Epoch: 4, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.735 Vali Acc: 0.732 Test Loss: 0.735 Test Acc: 0.732
Validation loss decreased (-0.724630 --> -0.731877).  Saving model ...
Epoch: 5 cost time: 4.109757423400879
Epoch: 5, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.527 Vali Acc: 0.819 Test Loss: 0.527 Test Acc: 0.819
Validation loss decreased (-0.731877 --> -0.818835).  Saving model ...
Epoch: 6 cost time: 3.842536211013794
Epoch: 6, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.607 Vali Acc: 0.804 Test Loss: 0.607 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.363367080688477
Epoch: 7, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.571 Vali Acc: 0.819 Test Loss: 0.571 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.7069625854492188
Epoch: 8, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.461 Vali Acc: 0.819 Test Loss: 0.461 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818836).  Saving model ...
Epoch: 9 cost time: 3.8930728435516357
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.519 Vali Acc: 0.819 Test Loss: 0.519 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.236648797988892
Epoch: 10, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.591 Vali Acc: 0.812 Test Loss: 0.591 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.24090051651001
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.605 Vali Acc: 0.797 Test Loss: 0.605 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.127465486526489
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.587 Vali Acc: 0.812 Test Loss: 0.587 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.39699387550354
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.580 Vali Acc: 0.812 Test Loss: 0.580 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.554465293884277
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.579 Vali Acc: 0.812 Test Loss: 0.579 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.425950527191162
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.569 Vali Acc: 0.819 Test Loss: 0.569 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.455441236495972
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.572 Vali Acc: 0.812 Test Loss: 0.572 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.381001710891724
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.582 Vali Acc: 0.812 Test Loss: 0.582 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.729490041732788
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.586 Vali Acc: 0.812 Test Loss: 0.586 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df128_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8188405797101449
model parameter : 11330564
model size : 62.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df128_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.084075689315796
Epoch: 1, Steps: 9 | Train Loss: 1.453 Vali Loss: 1.215 Vali Acc: 0.428 Test Loss: 1.215 Test Acc: 0.428
Validation loss decreased (inf --> -0.427524).  Saving model ...
Epoch: 2 cost time: 4.285272836685181
Epoch: 2, Steps: 9 | Train Loss: 0.758 Vali Loss: 0.838 Vali Acc: 0.717 Test Loss: 0.838 Test Acc: 0.717
Validation loss decreased (-0.427524 --> -0.717383).  Saving model ...
Epoch: 3 cost time: 4.3670806884765625
Epoch: 3, Steps: 9 | Train Loss: 0.260 Vali Loss: 0.876 Vali Acc: 0.674 Test Loss: 0.876 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.396157741546631
Epoch: 4, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.839 Vali Acc: 0.717 Test Loss: 0.839 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.043031454086304
Epoch: 5, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.689 Vali Acc: 0.717 Test Loss: 0.689 Test Acc: 0.717
Validation loss decreased (-0.717383 --> -0.717384).  Saving model ...
Epoch: 6 cost time: 4.050230503082275
Epoch: 6, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.789 Vali Acc: 0.725 Test Loss: 0.789 Test Acc: 0.725
Validation loss decreased (-0.717384 --> -0.724630).  Saving model ...
Epoch: 7 cost time: 4.061061382293701
Epoch: 7, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.758 Vali Acc: 0.739 Test Loss: 0.758 Test Acc: 0.739
Validation loss decreased (-0.724630 --> -0.739123).  Saving model ...
Epoch: 8 cost time: 3.8122425079345703
Epoch: 8, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.738 Vali Acc: 0.739 Test Loss: 0.738 Test Acc: 0.739
Validation loss decreased (-0.739123 --> -0.739123).  Saving model ...
Epoch: 9 cost time: 3.782611846923828
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.807 Vali Acc: 0.746 Test Loss: 0.807 Test Acc: 0.746
Validation loss decreased (-0.739123 --> -0.746369).  Saving model ...
Epoch: 10 cost time: 4.327604532241821
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.806 Vali Acc: 0.761 Test Loss: 0.806 Test Acc: 0.761
Validation loss decreased (-0.746369 --> -0.760862).  Saving model ...
Epoch: 11 cost time: 3.9822845458984375
Epoch: 11, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.783 Vali Acc: 0.746 Test Loss: 0.783 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.6694698333740234
Epoch: 12, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.774 Vali Acc: 0.768 Test Loss: 0.774 Test Acc: 0.768
Validation loss decreased (-0.760862 --> -0.768108).  Saving model ...
Epoch: 13 cost time: 4.332859039306641
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.787 Vali Acc: 0.768 Test Loss: 0.787 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.561884880065918
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.790 Vali Acc: 0.761 Test Loss: 0.790 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.22856593132019
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.792 Vali Acc: 0.754 Test Loss: 0.792 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.344326972961426
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.799 Vali Acc: 0.746 Test Loss: 0.799 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.358343839645386
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.800 Vali Acc: 0.746 Test Loss: 0.800 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.13261342048645
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.801 Vali Acc: 0.746 Test Loss: 0.801 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.275960683822632
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.795 Vali Acc: 0.768 Test Loss: 0.795 Test Acc: 0.768
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.52149510383606
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.792 Vali Acc: 0.768 Test Loss: 0.792 Test Acc: 0.768
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.60647439956665
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.799 Vali Acc: 0.768 Test Loss: 0.799 Test Acc: 0.768
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.641924858093262
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.806 Vali Acc: 0.768 Test Loss: 0.806 Test Acc: 0.768
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df128_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7681159420289855
model parameter : 11330564
model size : 62.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df128_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.160198450088501
Epoch: 1, Steps: 9 | Train Loss: 1.463 Vali Loss: 1.192 Vali Acc: 0.522 Test Loss: 1.192 Test Acc: 0.522
Validation loss decreased (inf --> -0.521727).  Saving model ...
Epoch: 2 cost time: 4.185928106307983
Epoch: 2, Steps: 9 | Train Loss: 0.762 Vali Loss: 0.979 Vali Acc: 0.638 Test Loss: 0.979 Test Acc: 0.638
Validation loss decreased (-0.521727 --> -0.637671).  Saving model ...
Epoch: 3 cost time: 4.32985782623291
Epoch: 3, Steps: 9 | Train Loss: 0.311 Vali Loss: 1.454 Vali Acc: 0.514 Test Loss: 1.454 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.105729818344116
Epoch: 4, Steps: 9 | Train Loss: 0.189 Vali Loss: 1.148 Vali Acc: 0.638 Test Loss: 1.148 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.051250457763672
Epoch: 5, Steps: 9 | Train Loss: 0.100 Vali Loss: 1.239 Vali Acc: 0.616 Test Loss: 1.239 Test Acc: 0.616
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.418095827102661
Epoch: 6, Steps: 9 | Train Loss: 0.038 Vali Loss: 1.198 Vali Acc: 0.645 Test Loss: 1.198 Test Acc: 0.645
Validation loss decreased (-0.637671 --> -0.644916).  Saving model ...
Epoch: 7 cost time: 4.184778690338135
Epoch: 7, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.217 Vali Acc: 0.616 Test Loss: 1.217 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.8480939865112305
Epoch: 8, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.276 Vali Acc: 0.638 Test Loss: 1.276 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.8338711261749268
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.372 Vali Acc: 0.667 Test Loss: 1.372 Test Acc: 0.667
Validation loss decreased (-0.644916 --> -0.666653).  Saving model ...
Epoch: 10 cost time: 3.8183906078338623
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.325 Vali Acc: 0.638 Test Loss: 1.325 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.1467931270599365
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.322 Vali Acc: 0.630 Test Loss: 1.322 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.8917605876922607
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.357 Vali Acc: 0.645 Test Loss: 1.357 Test Acc: 0.645
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.8993635177612305
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.383 Vali Acc: 0.645 Test Loss: 1.383 Test Acc: 0.645
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.172373056411743
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.375 Vali Acc: 0.645 Test Loss: 1.375 Test Acc: 0.645
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.424548387527466
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.357 Vali Acc: 0.630 Test Loss: 1.357 Test Acc: 0.630
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.260969161987305
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.350 Vali Acc: 0.630 Test Loss: 1.350 Test Acc: 0.630
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.026698350906372
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.355 Vali Acc: 0.630 Test Loss: 1.355 Test Acc: 0.630
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.0716142654418945
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.352 Vali Acc: 0.638 Test Loss: 1.352 Test Acc: 0.638
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.9947397708892822
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.352 Vali Acc: 0.638 Test Loss: 1.352 Test Acc: 0.638
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df128_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.6666666666666666
model parameter : 11330564
model size : 62.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.052013874053955
Epoch: 1, Steps: 9 | Train Loss: 1.457 Vali Loss: 1.380 Vali Acc: 0.341 Test Loss: 1.380 Test Acc: 0.341
Validation loss decreased (inf --> -0.340566).  Saving model ...
Epoch: 2 cost time: 4.075328826904297
Epoch: 2, Steps: 9 | Train Loss: 0.913 Vali Loss: 1.269 Vali Acc: 0.457 Test Loss: 1.269 Test Acc: 0.457
Validation loss decreased (-0.340566 --> -0.456509).  Saving model ...
Epoch: 3 cost time: 4.410097122192383
Epoch: 3, Steps: 9 | Train Loss: 0.402 Vali Loss: 1.516 Vali Acc: 0.391 Test Loss: 1.516 Test Acc: 0.391
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.9630489349365234
Epoch: 4, Steps: 9 | Train Loss: 0.144 Vali Loss: 1.592 Vali Acc: 0.435 Test Loss: 1.592 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.081201076507568
Epoch: 5, Steps: 9 | Train Loss: 0.056 Vali Loss: 1.645 Vali Acc: 0.471 Test Loss: 1.645 Test Acc: 0.471
Validation loss decreased (-0.456509 --> -0.470998).  Saving model ...
Epoch: 6 cost time: 4.068710565567017
Epoch: 6, Steps: 9 | Train Loss: 0.020 Vali Loss: 2.168 Vali Acc: 0.399 Test Loss: 2.168 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.117194175720215
Epoch: 7, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.908 Vali Acc: 0.435 Test Loss: 1.908 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.212366819381714
Epoch: 8, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.761 Vali Acc: 0.493 Test Loss: 1.761 Test Acc: 0.493
Validation loss decreased (-0.470998 --> -0.492736).  Saving model ...
Epoch: 9 cost time: 4.086870908737183
Epoch: 9, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.849 Vali Acc: 0.478 Test Loss: 1.849 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.035299062728882
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.898 Vali Acc: 0.478 Test Loss: 1.898 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.95835542678833
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.853 Vali Acc: 0.493 Test Loss: 1.853 Test Acc: 0.493
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.330350637435913
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.855 Vali Acc: 0.529 Test Loss: 1.855 Test Acc: 0.529
Validation loss decreased (-0.492736 --> -0.528967).  Saving model ...
Epoch: 13 cost time: 3.5604801177978516
Epoch: 13, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.798 Vali Acc: 0.522 Test Loss: 1.798 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.6294031143188477
Epoch: 14, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.810 Vali Acc: 0.507 Test Loss: 1.810 Test Acc: 0.507
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.505110740661621
Epoch: 15, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.852 Vali Acc: 0.529 Test Loss: 1.852 Test Acc: 0.529
Validation loss decreased (-0.528967 --> -0.528967).  Saving model ...
Epoch: 16 cost time: 4.203735828399658
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.852 Vali Acc: 0.529 Test Loss: 1.852 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.6281936168670654
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.843 Vali Acc: 0.536 Test Loss: 1.843 Test Acc: 0.536
Validation loss decreased (-0.528967 --> -0.536213).  Saving model ...
Epoch: 18 cost time: 4.2356789112091064
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.840 Vali Acc: 0.507 Test Loss: 1.840 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.398426055908203
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.839 Vali Acc: 0.514 Test Loss: 1.839 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.197986125946045
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.850 Vali Acc: 0.522 Test Loss: 1.850 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.530017614364624
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.844 Vali Acc: 0.522 Test Loss: 1.844 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.348833084106445
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.837 Vali Acc: 0.522 Test Loss: 1.837 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.268826246261597
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.838 Vali Acc: 0.536 Test Loss: 1.838 Test Acc: 0.536
Validation loss decreased (-0.536213 --> -0.536214).  Saving model ...
Epoch: 24 cost time: 4.220052719116211
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.836 Vali Acc: 0.536 Test Loss: 1.836 Test Acc: 0.536
Validation loss decreased (-0.536214 --> -0.536214).  Saving model ...
Epoch: 25 cost time: 4.606332778930664
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.848 Vali Acc: 0.536 Test Loss: 1.848 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.14954400062561
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.852 Vali Acc: 0.551 Test Loss: 1.852 Test Acc: 0.551
Validation loss decreased (-0.536214 --> -0.550706).  Saving model ...
Epoch: 27 cost time: 4.170375823974609
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.839 Vali Acc: 0.558 Test Loss: 1.839 Test Acc: 0.558
Validation loss decreased (-0.550706 --> -0.557953).  Saving model ...
Epoch: 28 cost time: 4.32628321647644
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.831 Vali Acc: 0.551 Test Loss: 1.831 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.077328443527222
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.843 Vali Acc: 0.551 Test Loss: 1.843 Test Acc: 0.551
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.8144025802612305
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.854 Vali Acc: 0.551 Test Loss: 1.854 Test Acc: 0.551
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 4.173980951309204
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.858 Vali Acc: 0.551 Test Loss: 1.858 Test Acc: 0.551
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 4.311669588088989
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.865 Vali Acc: 0.551 Test Loss: 1.865 Test Acc: 0.551
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 4.410492897033691
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.868 Vali Acc: 0.551 Test Loss: 1.868 Test Acc: 0.551
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 4.4695470333099365
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.872 Vali Acc: 0.551 Test Loss: 1.872 Test Acc: 0.551
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 4.261845588684082
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.867 Vali Acc: 0.551 Test Loss: 1.867 Test Acc: 0.551
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 4.272419214248657
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.866 Vali Acc: 0.543 Test Loss: 1.866 Test Acc: 0.543
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 4.331704616546631
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.860 Vali Acc: 0.551 Test Loss: 1.860 Test Acc: 0.551
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5579710144927537
model parameter : 11330564
model size : 62.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.543765068054199
Epoch: 1, Steps: 9 | Train Loss: 1.427 Vali Loss: 1.448 Vali Acc: 0.261 Test Loss: 1.448 Test Acc: 0.261
Validation loss decreased (inf --> -0.260855).  Saving model ...
Epoch: 2 cost time: 3.9987733364105225
Epoch: 2, Steps: 9 | Train Loss: 1.035 Vali Loss: 1.346 Vali Acc: 0.333 Test Loss: 1.346 Test Acc: 0.333
Validation loss decreased (-0.260855 --> -0.333320).  Saving model ...
Epoch: 3 cost time: 4.347755193710327
Epoch: 3, Steps: 9 | Train Loss: 0.580 Vali Loss: 1.975 Vali Acc: 0.283 Test Loss: 1.975 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.0148584842681885
Epoch: 4, Steps: 9 | Train Loss: 0.316 Vali Loss: 2.233 Vali Acc: 0.312 Test Loss: 2.233 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.093233823776245
Epoch: 5, Steps: 9 | Train Loss: 0.137 Vali Loss: 2.595 Vali Acc: 0.319 Test Loss: 2.595 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.417149066925049
Epoch: 6, Steps: 9 | Train Loss: 0.071 Vali Loss: 2.834 Vali Acc: 0.384 Test Loss: 2.834 Test Acc: 0.384
Validation loss decreased (-0.333320 --> -0.384030).  Saving model ...
Epoch: 7 cost time: 4.173543453216553
Epoch: 7, Steps: 9 | Train Loss: 0.021 Vali Loss: 2.237 Vali Acc: 0.428 Test Loss: 2.237 Test Acc: 0.428
Validation loss decreased (-0.384030 --> -0.427514).  Saving model ...
Epoch: 8 cost time: 4.227587699890137
Epoch: 8, Steps: 9 | Train Loss: 0.007 Vali Loss: 2.683 Vali Acc: 0.384 Test Loss: 2.683 Test Acc: 0.384
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.141108989715576
Epoch: 9, Steps: 9 | Train Loss: 0.005 Vali Loss: 3.068 Vali Acc: 0.370 Test Loss: 3.068 Test Acc: 0.370
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.9777815341949463
Epoch: 10, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.791 Vali Acc: 0.399 Test Loss: 2.791 Test Acc: 0.399
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.399325132369995
Epoch: 11, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.564 Vali Acc: 0.442 Test Loss: 2.564 Test Acc: 0.442
Validation loss decreased (-0.427514 --> -0.442003).  Saving model ...
Epoch: 12 cost time: 4.546040058135986
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.663 Vali Acc: 0.435 Test Loss: 2.663 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.241978168487549
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.762 Vali Acc: 0.435 Test Loss: 2.762 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.6508684158325195
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.745 Vali Acc: 0.442 Test Loss: 2.745 Test Acc: 0.442
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.00246000289917
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.687 Vali Acc: 0.442 Test Loss: 2.687 Test Acc: 0.442
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.98533034324646
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.671 Vali Acc: 0.442 Test Loss: 2.671 Test Acc: 0.442
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.8866496086120605
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.651 Vali Acc: 0.435 Test Loss: 2.651 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.9994089603424072
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.663 Vali Acc: 0.449 Test Loss: 2.663 Test Acc: 0.449
Validation loss decreased (-0.442003 --> -0.449249).  Saving model ...
Epoch: 19 cost time: 4.188662528991699
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.716 Vali Acc: 0.449 Test Loss: 2.716 Test Acc: 0.449
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.3674867153167725
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.744 Vali Acc: 0.449 Test Loss: 2.744 Test Acc: 0.449
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.104996919631958
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.725 Vali Acc: 0.442 Test Loss: 2.725 Test Acc: 0.442
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.278128147125244
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.709 Vali Acc: 0.442 Test Loss: 2.709 Test Acc: 0.442
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.381831407546997
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.708 Vali Acc: 0.449 Test Loss: 2.708 Test Acc: 0.449
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.970261335372925
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.703 Vali Acc: 0.471 Test Loss: 2.703 Test Acc: 0.471
Validation loss decreased (-0.449249 --> -0.470987).  Saving model ...
Epoch: 25 cost time: 3.8241593837738037
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.709 Vali Acc: 0.478 Test Loss: 2.709 Test Acc: 0.478
Validation loss decreased (-0.470987 --> -0.478234).  Saving model ...
Epoch: 26 cost time: 4.06322455406189
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.721 Vali Acc: 0.478 Test Loss: 2.721 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.7217235565185547
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.706 Vali Acc: 0.471 Test Loss: 2.706 Test Acc: 0.471
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.303797721862793
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.658 Vali Acc: 0.493 Test Loss: 2.658 Test Acc: 0.493
Validation loss decreased (-0.478234 --> -0.492727).  Saving model ...
Epoch: 29 cost time: 4.444821357727051
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.670 Vali Acc: 0.493 Test Loss: 2.670 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.862271547317505
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.695 Vali Acc: 0.486 Test Loss: 2.695 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 4.384237051010132
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.711 Vali Acc: 0.486 Test Loss: 2.711 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 4.404886484146118
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.714 Vali Acc: 0.486 Test Loss: 2.714 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.9130859375
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.679 Vali Acc: 0.493 Test Loss: 2.679 Test Acc: 0.493
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 4.033088684082031
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.662 Vali Acc: 0.493 Test Loss: 2.662 Test Acc: 0.493
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 4.360878944396973
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.661 Vali Acc: 0.507 Test Loss: 2.661 Test Acc: 0.507
Validation loss decreased (-0.492727 --> -0.507220).  Saving model ...
Epoch: 36 cost time: 4.310576677322388
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.651 Vali Acc: 0.507 Test Loss: 2.651 Test Acc: 0.507
Validation loss decreased (-0.507220 --> -0.507220).  Saving model ...
Epoch: 37 cost time: 4.41473388671875
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.627 Vali Acc: 0.507 Test Loss: 2.627 Test Acc: 0.507
Validation loss decreased (-0.507220 --> -0.507220).  Saving model ...
Epoch: 38 cost time: 4.364328145980835
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.627 Vali Acc: 0.507 Test Loss: 2.627 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 4.296829700469971
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.658 Vali Acc: 0.507 Test Loss: 2.658 Test Acc: 0.507
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 4.5619964599609375
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.680 Vali Acc: 0.507 Test Loss: 2.680 Test Acc: 0.507
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 4.008969068527222
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.696 Vali Acc: 0.507 Test Loss: 2.696 Test Acc: 0.507
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 4.41133189201355
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.710 Vali Acc: 0.507 Test Loss: 2.710 Test Acc: 0.507
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 3.91168475151062
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.709 Vali Acc: 0.507 Test Loss: 2.709 Test Acc: 0.507
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 4.43816065788269
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.682 Vali Acc: 0.507 Test Loss: 2.682 Test Acc: 0.507
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 4.2112836837768555
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.668 Vali Acc: 0.507 Test Loss: 2.668 Test Acc: 0.507
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 4.23466682434082
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.687 Vali Acc: 0.500 Test Loss: 2.687 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 4.258920192718506
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.700 Vali Acc: 0.500 Test Loss: 2.700 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5072463768115942
model parameter : 11330564
model size : 62.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.599420070648193
Epoch: 1, Steps: 9 | Train Loss: 1.375 Vali Loss: 1.405 Vali Acc: 0.319 Test Loss: 1.405 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 3.8330259323120117
Epoch: 2, Steps: 9 | Train Loss: 0.993 Vali Loss: 1.255 Vali Acc: 0.355 Test Loss: 1.255 Test Acc: 0.355
Validation loss decreased (-0.318827 --> -0.355060).  Saving model ...
Epoch: 3 cost time: 3.4252848625183105
Epoch: 3, Steps: 9 | Train Loss: 0.528 Vali Loss: 1.596 Vali Acc: 0.319 Test Loss: 1.596 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.084727048873901
Epoch: 4, Steps: 9 | Train Loss: 0.231 Vali Loss: 1.399 Vali Acc: 0.413 Test Loss: 1.399 Test Acc: 0.413
Validation loss decreased (-0.355060 --> -0.413029).  Saving model ...
Epoch: 5 cost time: 3.98093318939209
Epoch: 5, Steps: 9 | Train Loss: 0.086 Vali Loss: 1.694 Vali Acc: 0.370 Test Loss: 1.694 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.25044059753418
Epoch: 6, Steps: 9 | Train Loss: 0.051 Vali Loss: 1.975 Vali Acc: 0.384 Test Loss: 1.975 Test Acc: 0.384
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.463292598724365
Epoch: 7, Steps: 9 | Train Loss: 0.012 Vali Loss: 1.785 Vali Acc: 0.449 Test Loss: 1.785 Test Acc: 0.449
Validation loss decreased (-0.413029 --> -0.449258).  Saving model ...
Epoch: 8 cost time: 4.28289270401001
Epoch: 8, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.448 Vali Acc: 0.536 Test Loss: 1.448 Test Acc: 0.536
Validation loss decreased (-0.449258 --> -0.536217).  Saving model ...
Epoch: 9 cost time: 3.1911752223968506
Epoch: 9, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.692 Vali Acc: 0.486 Test Loss: 1.692 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.2854888439178467
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.851 Vali Acc: 0.486 Test Loss: 1.851 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.896322727203369
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.693 Vali Acc: 0.529 Test Loss: 1.693 Test Acc: 0.529
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.400044202804565
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.601 Vali Acc: 0.558 Test Loss: 1.601 Test Acc: 0.558
Validation loss decreased (-0.536217 --> -0.557955).  Saving model ...
Epoch: 13 cost time: 4.402173757553101
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.606 Vali Acc: 0.551 Test Loss: 1.606 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.3648681640625
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.628 Vali Acc: 0.580 Test Loss: 1.628 Test Acc: 0.580
Validation loss decreased (-0.557955 --> -0.579694).  Saving model ...
Epoch: 15 cost time: 4.39734411239624
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.676 Vali Acc: 0.558 Test Loss: 1.676 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.295018672943115
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.700 Vali Acc: 0.565 Test Loss: 1.700 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.067331790924072
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.704 Vali Acc: 0.572 Test Loss: 1.704 Test Acc: 0.572
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.7064075469970703
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.697 Vali Acc: 0.572 Test Loss: 1.697 Test Acc: 0.572
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.755321979522705
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.683 Vali Acc: 0.580 Test Loss: 1.683 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.361515522003174
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.685 Vali Acc: 0.580 Test Loss: 1.685 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.2169129848480225
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.684 Vali Acc: 0.580 Test Loss: 1.684 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.202214002609253
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.694 Vali Acc: 0.580 Test Loss: 1.694 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.095856666564941
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.698 Vali Acc: 0.580 Test Loss: 1.698 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.047115087509155
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.706 Vali Acc: 0.572 Test Loss: 1.706 Test Acc: 0.572
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm512_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5797101449275363
model parameter : 11330564
model size : 62.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         103                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma103_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.737498760223389
Epoch: 1, Steps: 9 | Train Loss: 1.384 Vali Loss: 1.248 Vali Acc: 0.435 Test Loss: 1.248 Test Acc: 0.435
Validation loss decreased (inf --> -0.434770).  Saving model ...
Epoch: 2 cost time: 3.3851327896118164
Epoch: 2, Steps: 9 | Train Loss: 0.941 Vali Loss: 0.953 Vali Acc: 0.587 Test Loss: 0.953 Test Acc: 0.587
Validation loss decreased (-0.434770 --> -0.586947).  Saving model ...
Epoch: 3 cost time: 3.407257318496704
Epoch: 3, Steps: 9 | Train Loss: 0.456 Vali Loss: 0.836 Vali Acc: 0.732 Test Loss: 0.836 Test Acc: 0.732
Validation loss decreased (-0.586947 --> -0.731876).  Saving model ...
Epoch: 4 cost time: 3.147296667098999
Epoch: 4, Steps: 9 | Train Loss: 0.194 Vali Loss: 0.560 Vali Acc: 0.812 Test Loss: 0.560 Test Acc: 0.812
Validation loss decreased (-0.731876 --> -0.811589).  Saving model ...
Epoch: 5 cost time: 3.2228925228118896
Epoch: 5, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.615 Vali Acc: 0.775 Test Loss: 0.615 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.166149377822876
Epoch: 6, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.559 Vali Acc: 0.797 Test Loss: 0.559 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.228372097015381
Epoch: 7, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.623 Vali Acc: 0.826 Test Loss: 0.623 Test Acc: 0.826
Validation loss decreased (-0.811589 --> -0.826081).  Saving model ...
Epoch: 8 cost time: 3.1287965774536133
Epoch: 8, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.590 Vali Acc: 0.797 Test Loss: 0.590 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.2592391967773438
Epoch: 9, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.579 Vali Acc: 0.812 Test Loss: 0.579 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.1768622398376465
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.567 Vali Acc: 0.819 Test Loss: 0.567 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.60770320892334
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.571 Vali Acc: 0.855 Test Loss: 0.571 Test Acc: 0.855
Validation loss decreased (-0.826081 --> -0.855067).  Saving model ...
Epoch: 12 cost time: 3.43650484085083
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.567 Vali Acc: 0.848 Test Loss: 0.567 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.2847607135772705
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.561 Vali Acc: 0.848 Test Loss: 0.561 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.271873950958252
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.575 Vali Acc: 0.841 Test Loss: 0.575 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.04069447517395
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.572 Vali Acc: 0.855 Test Loss: 0.572 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.352543830871582
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.571 Vali Acc: 0.855 Test Loss: 0.571 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.040354013442993
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.573 Vali Acc: 0.855 Test Loss: 0.573 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.3179094791412354
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.575 Vali Acc: 0.862 Test Loss: 0.575 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862313).  Saving model ...
Epoch: 19 cost time: 3.2736802101135254
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.572 Vali Acc: 0.862 Test Loss: 0.572 Test Acc: 0.862
Validation loss decreased (-0.862313 --> -0.862313).  Saving model ...
Epoch: 20 cost time: 3.0380475521087646
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.565 Vali Acc: 0.870 Test Loss: 0.565 Test Acc: 0.870
Validation loss decreased (-0.862313 --> -0.869560).  Saving model ...
Epoch: 21 cost time: 3.2078239917755127
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.562 Vali Acc: 0.870 Test Loss: 0.562 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869560).  Saving model ...
Epoch: 22 cost time: 3.3613202571868896
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.562 Vali Acc: 0.870 Test Loss: 0.562 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.0878405570983887
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.577 Vali Acc: 0.862 Test Loss: 0.577 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.2812693119049072
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.575 Vali Acc: 0.870 Test Loss: 0.575 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.1448142528533936
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.576 Vali Acc: 0.862 Test Loss: 0.576 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.0941641330718994
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.576 Vali Acc: 0.870 Test Loss: 0.576 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.301433801651001
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.577 Vali Acc: 0.870 Test Loss: 0.577 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.137143850326538
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.579 Vali Acc: 0.870 Test Loss: 0.579 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.278931140899658
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.575 Vali Acc: 0.870 Test Loss: 0.575 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.205305337905884
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.576 Vali Acc: 0.870 Test Loss: 0.576 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.309307336807251
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.576 Vali Acc: 0.870 Test Loss: 0.576 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma103_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 5992964
model size : 32.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         83                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma83_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.847750186920166
Epoch: 1, Steps: 9 | Train Loss: 1.391 Vali Loss: 1.256 Vali Acc: 0.457 Test Loss: 1.256 Test Acc: 0.457
Validation loss decreased (inf --> -0.456509).  Saving model ...
Epoch: 2 cost time: 3.372544527053833
Epoch: 2, Steps: 9 | Train Loss: 0.958 Vali Loss: 0.953 Vali Acc: 0.594 Test Loss: 0.953 Test Acc: 0.594
Validation loss decreased (-0.456509 --> -0.594193).  Saving model ...
Epoch: 3 cost time: 3.3225529193878174
Epoch: 3, Steps: 9 | Train Loss: 0.470 Vali Loss: 0.841 Vali Acc: 0.717 Test Loss: 0.841 Test Acc: 0.717
Validation loss decreased (-0.594193 --> -0.717383).  Saving model ...
Epoch: 4 cost time: 3.6098663806915283
Epoch: 4, Steps: 9 | Train Loss: 0.204 Vali Loss: 0.531 Vali Acc: 0.826 Test Loss: 0.531 Test Acc: 0.826
Validation loss decreased (-0.717383 --> -0.826082).  Saving model ...
Epoch: 5 cost time: 3.3141021728515625
Epoch: 5, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.557 Vali Acc: 0.826 Test Loss: 0.557 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.3861849308013916
Epoch: 6, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.538 Vali Acc: 0.812 Test Loss: 0.538 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.449826955795288
Epoch: 7, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.567 Vali Acc: 0.826 Test Loss: 0.567 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.212247848510742
Epoch: 8, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.555 Vali Acc: 0.833 Test Loss: 0.555 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833328).  Saving model ...
Epoch: 9 cost time: 3.1125686168670654
Epoch: 9, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.525 Vali Acc: 0.848 Test Loss: 0.525 Test Acc: 0.848
Validation loss decreased (-0.833328 --> -0.847821).  Saving model ...
Epoch: 10 cost time: 3.186631679534912
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.516 Vali Acc: 0.848 Test Loss: 0.516 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 11 cost time: 3.1715497970581055
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.533 Vali Acc: 0.855 Test Loss: 0.533 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855067).  Saving model ...
Epoch: 12 cost time: 3.314685106277466
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.534 Vali Acc: 0.862 Test Loss: 0.534 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862314).  Saving model ...
Epoch: 13 cost time: 3.21667218208313
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.529 Vali Acc: 0.862 Test Loss: 0.529 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 14 cost time: 3.5715866088867188
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.544 Vali Acc: 0.862 Test Loss: 0.544 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.47092604637146
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.529 Vali Acc: 0.870 Test Loss: 0.529 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869560).  Saving model ...
Epoch: 16 cost time: 3.2731142044067383
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.520 Vali Acc: 0.877 Test Loss: 0.520 Test Acc: 0.877
Validation loss decreased (-0.869560 --> -0.876806).  Saving model ...
Epoch: 17 cost time: 3.1768932342529297
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.534 Vali Acc: 0.877 Test Loss: 0.534 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.3213820457458496
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.538 Vali Acc: 0.877 Test Loss: 0.538 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.051705837249756
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.526 Vali Acc: 0.877 Test Loss: 0.526 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.2730748653411865
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.517 Vali Acc: 0.877 Test Loss: 0.517 Test Acc: 0.877
Validation loss decreased (-0.876806 --> -0.876806).  Saving model ...
Epoch: 21 cost time: 3.426811695098877
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.517 Vali Acc: 0.884 Test Loss: 0.517 Test Acc: 0.884
Validation loss decreased (-0.876806 --> -0.884053).  Saving model ...
Epoch: 22 cost time: 3.4629440307617188
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.519 Vali Acc: 0.877 Test Loss: 0.519 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.4733340740203857
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.534 Vali Acc: 0.877 Test Loss: 0.534 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.4129364490509033
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.531 Vali Acc: 0.877 Test Loss: 0.531 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.391495704650879
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.527 Vali Acc: 0.877 Test Loss: 0.527 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.2095017433166504
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.525 Vali Acc: 0.884 Test Loss: 0.525 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.4373810291290283
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.524 Vali Acc: 0.884 Test Loss: 0.524 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.1756112575531006
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.529 Vali Acc: 0.877 Test Loss: 0.529 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.3788716793060303
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.526 Vali Acc: 0.884 Test Loss: 0.526 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.103297233581543
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.530 Vali Acc: 0.884 Test Loss: 0.530 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.6324801445007324
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.531 Vali Acc: 0.891 Test Loss: 0.531 Test Acc: 0.891
Validation loss decreased (-0.884053 --> -0.891299).  Saving model ...
Epoch: 32 cost time: 3.3173720836639404
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.530 Vali Acc: 0.891 Test Loss: 0.530 Test Acc: 0.891
Validation loss decreased (-0.891299 --> -0.891299).  Saving model ...
Epoch: 33 cost time: 3.5637505054473877
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.530 Vali Acc: 0.899 Test Loss: 0.530 Test Acc: 0.899
Validation loss decreased (-0.891299 --> -0.898545).  Saving model ...
Epoch: 34 cost time: 3.740169048309326
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.535 Vali Acc: 0.891 Test Loss: 0.535 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.394073724746704
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.536 Vali Acc: 0.891 Test Loss: 0.536 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.181818962097168
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.534 Vali Acc: 0.891 Test Loss: 0.534 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.252715826034546
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.532 Vali Acc: 0.899 Test Loss: 0.532 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.480360984802246
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.529 Vali Acc: 0.899 Test Loss: 0.529 Test Acc: 0.899
Validation loss decreased (-0.898545 --> -0.898545).  Saving model ...
Epoch: 39 cost time: 3.244056463241577
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.529 Vali Acc: 0.899 Test Loss: 0.529 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.581021785736084
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.533 Vali Acc: 0.899 Test Loss: 0.533 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.4876480102539062
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.529 Vali Acc: 0.899 Test Loss: 0.529 Test Acc: 0.899
Validation loss decreased (-0.898545 --> -0.898545).  Saving model ...
Epoch: 42 cost time: 3.9348533153533936
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.528 Vali Acc: 0.891 Test Loss: 0.528 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.50004243850708
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.528 Vali Acc: 0.899 Test Loss: 0.528 Test Acc: 0.899
Validation loss decreased (-0.898545 --> -0.898545).  Saving model ...
Epoch: 44 cost time: 3.3469955921173096
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.531 Vali Acc: 0.899 Test Loss: 0.531 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.2178688049316406
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.533 Vali Acc: 0.899 Test Loss: 0.533 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 3.236260414123535
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.899 Test Loss: 0.542 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 3.3907806873321533
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.548 Vali Acc: 0.899 Test Loss: 0.548 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 3.4867794513702393
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.549 Vali Acc: 0.899 Test Loss: 0.549 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 3.327554225921631
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.543 Vali Acc: 0.899 Test Loss: 0.543 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 3.260258913040161
Epoch: 50, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.536 Vali Acc: 0.899 Test Loss: 0.536 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 3.2682716846466064
Epoch: 51, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.536 Vali Acc: 0.899 Test Loss: 0.536 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 3.573103666305542
Epoch: 52, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.899 Test Loss: 0.542 Test Acc: 0.899
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 3.2624576091766357
Epoch: 53, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.547 Vali Acc: 0.899 Test Loss: 0.547 Test Acc: 0.899
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma83_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 5992964
model size : 32.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         62                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma62_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.760230541229248
Epoch: 1, Steps: 9 | Train Loss: 1.394 Vali Loss: 1.235 Vali Acc: 0.457 Test Loss: 1.235 Test Acc: 0.457
Validation loss decreased (inf --> -0.456509).  Saving model ...
Epoch: 2 cost time: 3.601120948791504
Epoch: 2, Steps: 9 | Train Loss: 0.952 Vali Loss: 0.959 Vali Acc: 0.609 Test Loss: 0.959 Test Acc: 0.609
Validation loss decreased (-0.456509 --> -0.608686).  Saving model ...
Epoch: 3 cost time: 3.298278331756592
Epoch: 3, Steps: 9 | Train Loss: 0.456 Vali Loss: 0.829 Vali Acc: 0.710 Test Loss: 0.829 Test Acc: 0.710
Validation loss decreased (-0.608686 --> -0.710137).  Saving model ...
Epoch: 4 cost time: 3.647080183029175
Epoch: 4, Steps: 9 | Train Loss: 0.181 Vali Loss: 0.547 Vali Acc: 0.833 Test Loss: 0.547 Test Acc: 0.833
Validation loss decreased (-0.710137 --> -0.833328).  Saving model ...
Epoch: 5 cost time: 3.3605310916900635
Epoch: 5, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.539 Vali Acc: 0.862 Test Loss: 0.539 Test Acc: 0.862
Validation loss decreased (-0.833328 --> -0.862313).  Saving model ...
Epoch: 6 cost time: 3.3726348876953125
Epoch: 6, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.500 Vali Acc: 0.899 Test Loss: 0.500 Test Acc: 0.899
Validation loss decreased (-0.862313 --> -0.898546).  Saving model ...
Epoch: 7 cost time: 3.0850136280059814
Epoch: 7, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.525 Vali Acc: 0.891 Test Loss: 0.525 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.4384799003601074
Epoch: 8, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.559 Vali Acc: 0.884 Test Loss: 0.559 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.1704862117767334
Epoch: 9, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.496 Vali Acc: 0.913 Test Loss: 0.496 Test Acc: 0.913
Validation loss decreased (-0.898546 --> -0.913039).  Saving model ...
Epoch: 10 cost time: 3.2681655883789062
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.483 Vali Acc: 0.913 Test Loss: 0.483 Test Acc: 0.913
Validation loss decreased (-0.913039 --> -0.913039).  Saving model ...
Epoch: 11 cost time: 3.2353434562683105
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.513 Vali Acc: 0.906 Test Loss: 0.513 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.45945405960083
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.525 Vali Acc: 0.906 Test Loss: 0.525 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.499804735183716
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.515 Vali Acc: 0.906 Test Loss: 0.515 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.573228120803833
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.526 Vali Acc: 0.906 Test Loss: 0.526 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.718418836593628
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.518 Vali Acc: 0.906 Test Loss: 0.518 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.778712034225464
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.511 Vali Acc: 0.913 Test Loss: 0.511 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.1373655796051025
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.527 Vali Acc: 0.906 Test Loss: 0.527 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.083136558532715
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.530 Vali Acc: 0.906 Test Loss: 0.530 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.24825382232666
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.522 Vali Acc: 0.906 Test Loss: 0.522 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.064152956008911
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.516 Vali Acc: 0.913 Test Loss: 0.516 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma62_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 5992964
model size : 32.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         42                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.184061288833618
Epoch: 1, Steps: 9 | Train Loss: 1.381 Vali Loss: 1.211 Vali Acc: 0.457 Test Loss: 1.211 Test Acc: 0.457
Validation loss decreased (inf --> -0.456510).  Saving model ...
Epoch: 2 cost time: 3.2238800525665283
Epoch: 2, Steps: 9 | Train Loss: 0.904 Vali Loss: 0.899 Vali Acc: 0.645 Test Loss: 0.899 Test Acc: 0.645
Validation loss decreased (-0.456510 --> -0.644919).  Saving model ...
Epoch: 3 cost time: 3.130690574645996
Epoch: 3, Steps: 9 | Train Loss: 0.426 Vali Loss: 0.791 Vali Acc: 0.754 Test Loss: 0.791 Test Acc: 0.754
Validation loss decreased (-0.644919 --> -0.753615).  Saving model ...
Epoch: 4 cost time: 3.1926493644714355
Epoch: 4, Steps: 9 | Train Loss: 0.170 Vali Loss: 0.526 Vali Acc: 0.826 Test Loss: 0.526 Test Acc: 0.826
Validation loss decreased (-0.753615 --> -0.826082).  Saving model ...
Epoch: 5 cost time: 3.040239095687866
Epoch: 5, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.526 Vali Acc: 0.812 Test Loss: 0.526 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.0550734996795654
Epoch: 6, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.442 Vali Acc: 0.841 Test Loss: 0.442 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840575).  Saving model ...
Epoch: 7 cost time: 3.44771409034729
Epoch: 7, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.492 Vali Acc: 0.833 Test Loss: 0.492 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.425701856613159
Epoch: 8, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.505 Vali Acc: 0.841 Test Loss: 0.505 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.202803134918213
Epoch: 9, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.450 Vali Acc: 0.855 Test Loss: 0.450 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855068).  Saving model ...
Epoch: 10 cost time: 3.3576254844665527
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.434 Vali Acc: 0.862 Test Loss: 0.434 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 11 cost time: 3.387458086013794
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.464 Vali Acc: 0.862 Test Loss: 0.464 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.3890044689178467
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.461 Vali Acc: 0.870 Test Loss: 0.461 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869561).  Saving model ...
Epoch: 13 cost time: 3.2816574573516846
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.446 Vali Acc: 0.877 Test Loss: 0.446 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 14 cost time: 3.3488566875457764
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.475 Vali Acc: 0.870 Test Loss: 0.475 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.1643552780151367
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.468 Vali Acc: 0.870 Test Loss: 0.468 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.4809930324554443
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.462 Vali Acc: 0.877 Test Loss: 0.462 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.2860045433044434
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.479 Vali Acc: 0.877 Test Loss: 0.479 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.2525384426116943
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.478 Vali Acc: 0.870 Test Loss: 0.478 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.2880029678344727
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.884 Test Loss: 0.472 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884053).  Saving model ...
Epoch: 20 cost time: 3.8011724948883057
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.468 Vali Acc: 0.891 Test Loss: 0.468 Test Acc: 0.891
Validation loss decreased (-0.884053 --> -0.891300).  Saving model ...
Epoch: 21 cost time: 3.159203052520752
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.891 Test Loss: 0.474 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.08030366897583
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.471 Vali Acc: 0.891 Test Loss: 0.471 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.8825645446777344
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.479 Vali Acc: 0.884 Test Loss: 0.479 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.918684959411621
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.470 Vali Acc: 0.891 Test Loss: 0.470 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.142057180404663
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.471 Vali Acc: 0.891 Test Loss: 0.471 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.632127046585083
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.891 Test Loss: 0.474 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.4525363445281982
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.891 Test Loss: 0.473 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.814737558364868
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.475 Vali Acc: 0.891 Test Loss: 0.475 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.77241849899292
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.470 Vali Acc: 0.891 Test Loss: 0.470 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.497593879699707
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.476 Vali Acc: 0.891 Test Loss: 0.476 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 5992964
model size : 32.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.543212890625
Epoch: 1, Steps: 9 | Train Loss: 1.401 Vali Loss: 1.273 Vali Acc: 0.457 Test Loss: 1.273 Test Acc: 0.457
Validation loss decreased (inf --> -0.456509).  Saving model ...
Epoch: 2 cost time: 3.5643179416656494
Epoch: 2, Steps: 9 | Train Loss: 0.948 Vali Loss: 0.939 Vali Acc: 0.674 Test Loss: 0.939 Test Acc: 0.674
Validation loss decreased (-0.456509 --> -0.673904).  Saving model ...
Epoch: 3 cost time: 3.6059141159057617
Epoch: 3, Steps: 9 | Train Loss: 0.462 Vali Loss: 0.780 Vali Acc: 0.746 Test Loss: 0.780 Test Acc: 0.746
Validation loss decreased (-0.673904 --> -0.746369).  Saving model ...
Epoch: 4 cost time: 3.420013904571533
Epoch: 4, Steps: 9 | Train Loss: 0.171 Vali Loss: 0.511 Vali Acc: 0.877 Test Loss: 0.511 Test Acc: 0.877
Validation loss decreased (-0.746369 --> -0.876806).  Saving model ...
Epoch: 5 cost time: 3.6373953819274902
Epoch: 5, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.429 Vali Acc: 0.884 Test Loss: 0.429 Test Acc: 0.884
Validation loss decreased (-0.876806 --> -0.884054).  Saving model ...
Epoch: 6 cost time: 3.32277512550354
Epoch: 6, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.371 Vali Acc: 0.884 Test Loss: 0.371 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 7 cost time: 3.0784873962402344
Epoch: 7, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.409 Vali Acc: 0.877 Test Loss: 0.409 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.313154935836792
Epoch: 8, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.418 Vali Acc: 0.877 Test Loss: 0.418 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.475947141647339
Epoch: 9, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.342 Vali Acc: 0.884 Test Loss: 0.342 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884055).  Saving model ...
Epoch: 10 cost time: 3.4505114555358887
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.339 Vali Acc: 0.899 Test Loss: 0.339 Test Acc: 0.899
Validation loss decreased (-0.884055 --> -0.898547).  Saving model ...
Epoch: 11 cost time: 3.484893321990967
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.374 Vali Acc: 0.891 Test Loss: 0.374 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.3503434658050537
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.382 Vali Acc: 0.891 Test Loss: 0.382 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.4087390899658203
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.368 Vali Acc: 0.891 Test Loss: 0.368 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.643399477005005
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.376 Vali Acc: 0.891 Test Loss: 0.376 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.4274556636810303
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.375 Vali Acc: 0.899 Test Loss: 0.375 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.3307223320007324
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.375 Vali Acc: 0.899 Test Loss: 0.375 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.290813684463501
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.382 Vali Acc: 0.906 Test Loss: 0.382 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905793).  Saving model ...
Epoch: 18 cost time: 3.290360927581787
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.376 Vali Acc: 0.906 Test Loss: 0.376 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905793).  Saving model ...
Epoch: 19 cost time: 3.3336081504821777
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.369 Vali Acc: 0.906 Test Loss: 0.369 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905793).  Saving model ...
Epoch: 20 cost time: 3.2363665103912354
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.364 Vali Acc: 0.906 Test Loss: 0.364 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905793).  Saving model ...
Epoch: 21 cost time: 3.30568528175354
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.369 Vali Acc: 0.906 Test Loss: 0.369 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.374063014984131
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.373 Vali Acc: 0.906 Test Loss: 0.373 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.3943872451782227
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.385 Vali Acc: 0.906 Test Loss: 0.385 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.4298958778381348
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.378 Vali Acc: 0.906 Test Loss: 0.378 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.146075487136841
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.373 Vali Acc: 0.906 Test Loss: 0.373 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.1915204524993896
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.370 Vali Acc: 0.906 Test Loss: 0.370 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.115903615951538
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.375 Vali Acc: 0.906 Test Loss: 0.375 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.9995338916778564
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.378 Vali Acc: 0.906 Test Loss: 0.378 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.1566455364227295
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.379 Vali Acc: 0.899 Test Loss: 0.379 Test Acc: 0.899
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.335221529006958
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.379 Vali Acc: 0.899 Test Loss: 0.379 Test Acc: 0.899
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 5992964
model size : 32.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.145801782608032
Epoch: 1, Steps: 9 | Train Loss: 1.389 Vali Loss: 1.248 Vali Acc: 0.420 Test Loss: 1.248 Test Acc: 0.420
Validation loss decreased (inf --> -0.420277).  Saving model ...
Epoch: 2 cost time: 3.0381147861480713
Epoch: 2, Steps: 9 | Train Loss: 0.961 Vali Loss: 0.942 Vali Acc: 0.609 Test Loss: 0.942 Test Acc: 0.609
Validation loss decreased (-0.420277 --> -0.608686).  Saving model ...
Epoch: 3 cost time: 3.3428666591644287
Epoch: 3, Steps: 9 | Train Loss: 0.489 Vali Loss: 0.789 Vali Acc: 0.674 Test Loss: 0.789 Test Acc: 0.674
Validation loss decreased (-0.608686 --> -0.673905).  Saving model ...
Epoch: 4 cost time: 2.9904205799102783
Epoch: 4, Steps: 9 | Train Loss: 0.210 Vali Loss: 0.558 Vali Acc: 0.775 Test Loss: 0.558 Test Acc: 0.775
Validation loss decreased (-0.673905 --> -0.775357).  Saving model ...
Epoch: 5 cost time: 3.2739133834838867
Epoch: 5, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.560 Vali Acc: 0.761 Test Loss: 0.560 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.0870156288146973
Epoch: 6, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.511 Vali Acc: 0.797 Test Loss: 0.511 Test Acc: 0.797
Validation loss decreased (-0.775357 --> -0.797096).  Saving model ...
Epoch: 7 cost time: 3.410783290863037
Epoch: 7, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.490 Vali Acc: 0.833 Test Loss: 0.490 Test Acc: 0.833
Validation loss decreased (-0.797096 --> -0.833328).  Saving model ...
Epoch: 8 cost time: 3.543506145477295
Epoch: 8, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.522 Vali Acc: 0.819 Test Loss: 0.522 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.645970344543457
Epoch: 9, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.477 Vali Acc: 0.833 Test Loss: 0.477 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833329).  Saving model ...
Epoch: 10 cost time: 3.551424026489258
Epoch: 10, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.497 Vali Acc: 0.841 Test Loss: 0.497 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 11 cost time: 3.3079025745391846
Epoch: 11, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.515 Vali Acc: 0.848 Test Loss: 0.515 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 12 cost time: 3.545097827911377
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.490 Vali Acc: 0.855 Test Loss: 0.490 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 13 cost time: 3.23879075050354
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.489 Vali Acc: 0.855 Test Loss: 0.489 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 14 cost time: 3.404505968093872
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.507 Vali Acc: 0.848 Test Loss: 0.507 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.762972116470337
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.503 Vali Acc: 0.848 Test Loss: 0.503 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.396817207336426
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.483 Vali Acc: 0.848 Test Loss: 0.483 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.360569477081299
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.499 Vali Acc: 0.855 Test Loss: 0.499 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.4512104988098145
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.502 Vali Acc: 0.855 Test Loss: 0.502 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.3938279151916504
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.487 Vali Acc: 0.848 Test Loss: 0.487 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.3923723697662354
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.481 Vali Acc: 0.848 Test Loss: 0.481 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.205864906311035
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.492 Vali Acc: 0.833 Test Loss: 0.492 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.258162021636963
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.503 Vali Acc: 0.841 Test Loss: 0.503 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.1202621459960938
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.504 Vali Acc: 0.841 Test Loss: 0.504 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 5992964
model size : 32.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.725762844085693
Epoch: 1, Steps: 9 | Train Loss: 1.401 Vali Loss: 1.219 Vali Acc: 0.493 Test Loss: 1.219 Test Acc: 0.493
Validation loss decreased (inf --> -0.492741).  Saving model ...
Epoch: 2 cost time: 3.408461332321167
Epoch: 2, Steps: 9 | Train Loss: 0.958 Vali Loss: 0.997 Vali Acc: 0.601 Test Loss: 0.997 Test Acc: 0.601
Validation loss decreased (-0.492741 --> -0.601439).  Saving model ...
Epoch: 3 cost time: 3.6651620864868164
Epoch: 3, Steps: 9 | Train Loss: 0.492 Vali Loss: 0.925 Vali Acc: 0.652 Test Loss: 0.925 Test Acc: 0.652
Validation loss decreased (-0.601439 --> -0.652165).  Saving model ...
Epoch: 4 cost time: 3.54040789604187
Epoch: 4, Steps: 9 | Train Loss: 0.238 Vali Loss: 0.783 Vali Acc: 0.710 Test Loss: 0.783 Test Acc: 0.710
Validation loss decreased (-0.652165 --> -0.710137).  Saving model ...
Epoch: 5 cost time: 3.8872106075286865
Epoch: 5, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.852 Vali Acc: 0.703 Test Loss: 0.852 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.751981735229492
Epoch: 6, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.848 Vali Acc: 0.710 Test Loss: 0.848 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.514667510986328
Epoch: 7, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.790 Vali Acc: 0.754 Test Loss: 0.790 Test Acc: 0.754
Validation loss decreased (-0.710137 --> -0.753615).  Saving model ...
Epoch: 8 cost time: 3.3304085731506348
Epoch: 8, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.787 Vali Acc: 0.754 Test Loss: 0.787 Test Acc: 0.754
Validation loss decreased (-0.753615 --> -0.753615).  Saving model ...
Epoch: 9 cost time: 3.300093412399292
Epoch: 9, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.851 Vali Acc: 0.739 Test Loss: 0.851 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.3111379146575928
Epoch: 10, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.816 Vali Acc: 0.754 Test Loss: 0.816 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.3033804893493652
Epoch: 11, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.821 Vali Acc: 0.768 Test Loss: 0.821 Test Acc: 0.768
Validation loss decreased (-0.753615 --> -0.768108).  Saving model ...
Epoch: 12 cost time: 3.3825361728668213
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.819 Vali Acc: 0.754 Test Loss: 0.819 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.5381836891174316
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.833 Vali Acc: 0.754 Test Loss: 0.833 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.8000383377075195
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.840 Vali Acc: 0.739 Test Loss: 0.840 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.590385675430298
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.842 Vali Acc: 0.746 Test Loss: 0.842 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.2153308391571045
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.844 Vali Acc: 0.746 Test Loss: 0.844 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.251842498779297
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.834 Vali Acc: 0.754 Test Loss: 0.834 Test Acc: 0.754
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.6744213104248047
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.840 Vali Acc: 0.746 Test Loss: 0.840 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.189260959625244
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.853 Vali Acc: 0.746 Test Loss: 0.853 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.234807014465332
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.853 Vali Acc: 0.746 Test Loss: 0.853 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.1443397998809814
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.853 Vali Acc: 0.746 Test Loss: 0.853 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7681159420289855
model parameter : 5992964
model size : 32.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.988267421722412
Epoch: 1, Steps: 9 | Train Loss: 1.420 Vali Loss: 1.404 Vali Acc: 0.312 Test Loss: 1.404 Test Acc: 0.312
Validation loss decreased (inf --> -0.311580).  Saving model ...
Epoch: 2 cost time: 3.311886787414551
Epoch: 2, Steps: 9 | Train Loss: 1.121 Vali Loss: 1.283 Vali Acc: 0.413 Test Loss: 1.283 Test Acc: 0.413
Validation loss decreased (-0.311580 --> -0.413031).  Saving model ...
Epoch: 3 cost time: 3.2576076984405518
Epoch: 3, Steps: 9 | Train Loss: 0.683 Vali Loss: 1.217 Vali Acc: 0.435 Test Loss: 1.217 Test Acc: 0.435
Validation loss decreased (-0.413031 --> -0.434770).  Saving model ...
Epoch: 4 cost time: 3.322971820831299
Epoch: 4, Steps: 9 | Train Loss: 0.365 Vali Loss: 1.309 Vali Acc: 0.442 Test Loss: 1.309 Test Acc: 0.442
Validation loss decreased (-0.434770 --> -0.442016).  Saving model ...
Epoch: 5 cost time: 3.1959328651428223
Epoch: 5, Steps: 9 | Train Loss: 0.165 Vali Loss: 1.286 Vali Acc: 0.500 Test Loss: 1.286 Test Acc: 0.500
Validation loss decreased (-0.442016 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 3.281710386276245
Epoch: 6, Steps: 9 | Train Loss: 0.073 Vali Loss: 1.466 Vali Acc: 0.486 Test Loss: 1.466 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.106001615524292
Epoch: 7, Steps: 9 | Train Loss: 0.030 Vali Loss: 1.472 Vali Acc: 0.493 Test Loss: 1.472 Test Acc: 0.493
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.9201292991638184
Epoch: 8, Steps: 9 | Train Loss: 0.011 Vali Loss: 1.536 Vali Acc: 0.486 Test Loss: 1.536 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.514138698577881
Epoch: 9, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.601 Vali Acc: 0.486 Test Loss: 1.601 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.3551933765411377
Epoch: 10, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.573 Vali Acc: 0.514 Test Loss: 1.573 Test Acc: 0.514
Validation loss decreased (-0.499987 --> -0.514477).  Saving model ...
Epoch: 11 cost time: 3.213805675506592
Epoch: 11, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.485 Vali Acc: 0.507 Test Loss: 1.485 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.178323984146118
Epoch: 12, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.535 Vali Acc: 0.529 Test Loss: 1.535 Test Acc: 0.529
Validation loss decreased (-0.514477 --> -0.528970).  Saving model ...
Epoch: 13 cost time: 3.361342191696167
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.583 Vali Acc: 0.543 Test Loss: 1.583 Test Acc: 0.543
Validation loss decreased (-0.528970 --> -0.543462).  Saving model ...
Epoch: 14 cost time: 3.278931140899658
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.511 Vali Acc: 0.536 Test Loss: 1.511 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.27437686920166
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.532 Vali Acc: 0.551 Test Loss: 1.532 Test Acc: 0.551
Validation loss decreased (-0.543462 --> -0.550709).  Saving model ...
Epoch: 16 cost time: 3.2174458503723145
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.567 Vali Acc: 0.536 Test Loss: 1.567 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.222601890563965
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.541 Vali Acc: 0.551 Test Loss: 1.541 Test Acc: 0.551
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.5682551860809326
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.526 Vali Acc: 0.551 Test Loss: 1.526 Test Acc: 0.551
Validation loss decreased (-0.550709 --> -0.550709).  Saving model ...
Epoch: 19 cost time: 3.247189521789551
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.529 Vali Acc: 0.551 Test Loss: 1.529 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.295724630355835
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.501 Vali Acc: 0.565 Test Loss: 1.501 Test Acc: 0.565
Validation loss decreased (-0.550709 --> -0.565202).  Saving model ...
Epoch: 21 cost time: 3.446413278579712
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.484 Vali Acc: 0.572 Test Loss: 1.484 Test Acc: 0.572
Validation loss decreased (-0.565202 --> -0.572449).  Saving model ...
Epoch: 22 cost time: 3.1961121559143066
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.504 Vali Acc: 0.580 Test Loss: 1.504 Test Acc: 0.580
Validation loss decreased (-0.572449 --> -0.579695).  Saving model ...
Epoch: 23 cost time: 3.0394840240478516
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.490 Vali Acc: 0.587 Test Loss: 1.490 Test Acc: 0.587
Validation loss decreased (-0.579695 --> -0.586942).  Saving model ...
Epoch: 24 cost time: 3.068579912185669
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.506 Vali Acc: 0.580 Test Loss: 1.506 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.1738860607147217
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.521 Vali Acc: 0.587 Test Loss: 1.521 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.1740286350250244
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.530 Vali Acc: 0.587 Test Loss: 1.530 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.4761762619018555
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.472 Vali Acc: 0.616 Test Loss: 1.472 Test Acc: 0.616
Validation loss decreased (-0.586942 --> -0.615927).  Saving model ...
Epoch: 28 cost time: 3.2162578105926514
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.438 Vali Acc: 0.630 Test Loss: 1.438 Test Acc: 0.630
Validation loss decreased (-0.615927 --> -0.630420).  Saving model ...
Epoch: 29 cost time: 3.273899793624878
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.463 Vali Acc: 0.623 Test Loss: 1.463 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.5686919689178467
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.472 Vali Acc: 0.630 Test Loss: 1.472 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.2337565422058105
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.490 Vali Acc: 0.623 Test Loss: 1.490 Test Acc: 0.623
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.217923402786255
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.481 Vali Acc: 0.623 Test Loss: 1.481 Test Acc: 0.623
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.244040012359619
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.492 Vali Acc: 0.623 Test Loss: 1.492 Test Acc: 0.623
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.221829652786255
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.485 Vali Acc: 0.638 Test Loss: 1.485 Test Acc: 0.638
Validation loss decreased (-0.630420 --> -0.637666).  Saving model ...
Epoch: 35 cost time: 3.0542685985565186
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.478 Vali Acc: 0.638 Test Loss: 1.478 Test Acc: 0.638
Validation loss decreased (-0.637666 --> -0.637666).  Saving model ...
Epoch: 36 cost time: 3.4146342277526855
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.487 Vali Acc: 0.638 Test Loss: 1.487 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.3086025714874268
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.483 Vali Acc: 0.645 Test Loss: 1.483 Test Acc: 0.645
Validation loss decreased (-0.637666 --> -0.644913).  Saving model ...
Epoch: 38 cost time: 3.325029134750366
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.488 Vali Acc: 0.645 Test Loss: 1.488 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.3231360912323
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.478 Vali Acc: 0.652 Test Loss: 1.478 Test Acc: 0.652
Validation loss decreased (-0.644913 --> -0.652159).  Saving model ...
Epoch: 40 cost time: 3.3227031230926514
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.474 Vali Acc: 0.652 Test Loss: 1.474 Test Acc: 0.652
Validation loss decreased (-0.652159 --> -0.652159).  Saving model ...
Epoch: 41 cost time: 3.0837833881378174
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.481 Vali Acc: 0.652 Test Loss: 1.481 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.190737724304199
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.495 Vali Acc: 0.652 Test Loss: 1.495 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.189185619354248
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.497 Vali Acc: 0.652 Test Loss: 1.497 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.2011964321136475
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.489 Vali Acc: 0.645 Test Loss: 1.489 Test Acc: 0.645
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 3.1908364295959473
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.484 Vali Acc: 0.645 Test Loss: 1.484 Test Acc: 0.645
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 3.225627899169922
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.465 Vali Acc: 0.645 Test Loss: 1.465 Test Acc: 0.645
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 3.1783225536346436
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.458 Vali Acc: 0.652 Test Loss: 1.458 Test Acc: 0.652
Validation loss decreased (-0.652159 --> -0.652159).  Saving model ...
Epoch: 48 cost time: 3.3084161281585693
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.465 Vali Acc: 0.645 Test Loss: 1.465 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.2043936252593994
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.469 Vali Acc: 0.645 Test Loss: 1.469 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 3.2890625
Epoch: 50, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.477 Vali Acc: 0.645 Test Loss: 1.477 Test Acc: 0.645
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 3.3599672317504883
Epoch: 51, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.484 Vali Acc: 0.645 Test Loss: 1.484 Test Acc: 0.645
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 3.452272653579712
Epoch: 52, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.477 Vali Acc: 0.645 Test Loss: 1.477 Test Acc: 0.645
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 3.2578835487365723
Epoch: 53, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.467 Vali Acc: 0.645 Test Loss: 1.467 Test Acc: 0.645
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 3.358696460723877
Epoch: 54, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.466 Vali Acc: 0.645 Test Loss: 1.466 Test Acc: 0.645
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 3.7688539028167725
Epoch: 55, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.470 Vali Acc: 0.645 Test Loss: 1.470 Test Acc: 0.645
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 3.869192361831665
Epoch: 56, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.482 Vali Acc: 0.645 Test Loss: 1.482 Test Acc: 0.645
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 3.3507235050201416
Epoch: 57, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.492 Vali Acc: 0.659 Test Loss: 1.492 Test Acc: 0.659
Validation loss decreased (-0.652159 --> -0.659405).  Saving model ...
Epoch: 58 cost time: 3.4148941040039062
Epoch: 58, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.489 Vali Acc: 0.659 Test Loss: 1.489 Test Acc: 0.659
Validation loss decreased (-0.659405 --> -0.659405).  Saving model ...
Epoch: 59 cost time: 3.1918890476226807
Epoch: 59, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.484 Vali Acc: 0.659 Test Loss: 1.484 Test Acc: 0.659
Validation loss decreased (-0.659405 --> -0.659405).  Saving model ...
Epoch: 60 cost time: 3.2645456790924072
Epoch: 60, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.481 Vali Acc: 0.659 Test Loss: 1.481 Test Acc: 0.659
Validation loss decreased (-0.659405 --> -0.659405).  Saving model ...
Epoch: 61 cost time: 2.9368457794189453
Epoch: 61, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.471 Vali Acc: 0.659 Test Loss: 1.471 Test Acc: 0.659
Validation loss decreased (-0.659405 --> -0.659406).  Saving model ...
Epoch: 62 cost time: 3.2329788208007812
Epoch: 62, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.466 Vali Acc: 0.659 Test Loss: 1.466 Test Acc: 0.659
Validation loss decreased (-0.659406 --> -0.659406).  Saving model ...
Epoch: 63 cost time: 3.056945562362671
Epoch: 63, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.470 Vali Acc: 0.659 Test Loss: 1.470 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 3.3123111724853516
Epoch: 64, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.478 Vali Acc: 0.659 Test Loss: 1.478 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 3.1326608657836914
Epoch: 65, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.471 Vali Acc: 0.659 Test Loss: 1.471 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 3.253319501876831
Epoch: 66, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.467 Vali Acc: 0.659 Test Loss: 1.467 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 3.7177562713623047
Epoch: 67, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.468 Vali Acc: 0.667 Test Loss: 1.468 Test Acc: 0.667
Validation loss decreased (-0.659406 --> -0.666652).  Saving model ...
Epoch: 68 cost time: 3.1846659183502197
Epoch: 68, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.470 Vali Acc: 0.667 Test Loss: 1.470 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 3.2235095500946045
Epoch: 69, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.469 Vali Acc: 0.667 Test Loss: 1.469 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 3.2055351734161377
Epoch: 70, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.469 Vali Acc: 0.674 Test Loss: 1.469 Test Acc: 0.674
Validation loss decreased (-0.666652 --> -0.673898).  Saving model ...
Epoch: 71 cost time: 3.1908059120178223
Epoch: 71, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.477 Vali Acc: 0.667 Test Loss: 1.477 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 3.158571720123291
Epoch: 72, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.479 Vali Acc: 0.667 Test Loss: 1.479 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 3.3068995475769043
Epoch: 73, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.480 Vali Acc: 0.667 Test Loss: 1.480 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 3.2792954444885254
Epoch: 74, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.476 Vali Acc: 0.674 Test Loss: 1.476 Test Acc: 0.674
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 3.3172051906585693
Epoch: 75, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.473 Vali Acc: 0.674 Test Loss: 1.473 Test Acc: 0.674
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 3.348027467727661
Epoch: 76, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.470 Vali Acc: 0.681 Test Loss: 1.470 Test Acc: 0.681
Validation loss decreased (-0.673898 --> -0.681145).  Saving model ...
Epoch: 77 cost time: 3.0403618812561035
Epoch: 77, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.469 Vali Acc: 0.681 Test Loss: 1.469 Test Acc: 0.681
Validation loss decreased (-0.681145 --> -0.681145).  Saving model ...
Epoch: 78 cost time: 3.1623575687408447
Epoch: 78, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.476 Vali Acc: 0.681 Test Loss: 1.476 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 3.170430898666382
Epoch: 79, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.479 Vali Acc: 0.681 Test Loss: 1.479 Test Acc: 0.681
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 3.1327593326568604
Epoch: 80, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.479 Vali Acc: 0.681 Test Loss: 1.479 Test Acc: 0.681
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 3.1051225662231445
Epoch: 81, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.479 Vali Acc: 0.688 Test Loss: 1.479 Test Acc: 0.688
Validation loss decreased (-0.681145 --> -0.688391).  Saving model ...
Epoch: 82 cost time: 3.320266008377075
Epoch: 82, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.484 Vali Acc: 0.688 Test Loss: 1.484 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 3.402719020843506
Epoch: 83, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.486 Vali Acc: 0.688 Test Loss: 1.486 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 3.3168702125549316
Epoch: 84, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.489 Vali Acc: 0.688 Test Loss: 1.489 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 3.6474220752716064
Epoch: 85, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.488 Vali Acc: 0.688 Test Loss: 1.488 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 3.1912670135498047
Epoch: 86, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.489 Vali Acc: 0.696 Test Loss: 1.489 Test Acc: 0.696
Validation loss decreased (-0.688391 --> -0.695637).  Saving model ...
Epoch: 87 cost time: 3.1177637577056885
Epoch: 87, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.488 Vali Acc: 0.696 Test Loss: 1.488 Test Acc: 0.696
Validation loss decreased (-0.695637 --> -0.695637).  Saving model ...
Epoch: 88 cost time: 3.0541810989379883
Epoch: 88, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.491 Vali Acc: 0.696 Test Loss: 1.491 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 3.114445686340332
Epoch: 89, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.493 Vali Acc: 0.696 Test Loss: 1.493 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 3.138401746749878
Epoch: 90, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.492 Vali Acc: 0.696 Test Loss: 1.492 Test Acc: 0.696
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 3.3973679542541504
Epoch: 91, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.494 Vali Acc: 0.696 Test Loss: 1.494 Test Acc: 0.696
EarlyStopping counter: 4 out of 10
Epoch: 92 cost time: 3.2122726440429688
Epoch: 92, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.493 Vali Acc: 0.696 Test Loss: 1.493 Test Acc: 0.696
EarlyStopping counter: 5 out of 10
Epoch: 93 cost time: 3.4542012214660645
Epoch: 93, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.493 Vali Acc: 0.696 Test Loss: 1.493 Test Acc: 0.696
EarlyStopping counter: 6 out of 10
Epoch: 94 cost time: 3.5773890018463135
Epoch: 94, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.490 Vali Acc: 0.696 Test Loss: 1.490 Test Acc: 0.696
EarlyStopping counter: 7 out of 10
Epoch: 95 cost time: 3.294218063354492
Epoch: 95, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.490 Vali Acc: 0.696 Test Loss: 1.490 Test Acc: 0.696
EarlyStopping counter: 8 out of 10
Epoch: 96 cost time: 3.1289567947387695
Epoch: 96, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.494 Vali Acc: 0.696 Test Loss: 1.494 Test Acc: 0.696
EarlyStopping counter: 9 out of 10
Epoch: 97 cost time: 3.0688087940216064
Epoch: 97, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.496 Vali Acc: 0.696 Test Loss: 1.496 Test Acc: 0.696
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.6956521739130435
model parameter : 5992964
model size : 32.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.016647815704346
Epoch: 1, Steps: 9 | Train Loss: 1.437 Vali Loss: 1.463 Vali Acc: 0.239 Test Loss: 1.463 Test Acc: 0.239
Validation loss decreased (inf --> -0.239116).  Saving model ...
Epoch: 2 cost time: 3.15972900390625
Epoch: 2, Steps: 9 | Train Loss: 1.251 Vali Loss: 1.429 Vali Acc: 0.246 Test Loss: 1.429 Test Acc: 0.246
Validation loss decreased (-0.239116 --> -0.246363).  Saving model ...
Epoch: 3 cost time: 3.1504242420196533
Epoch: 3, Steps: 9 | Train Loss: 0.890 Vali Loss: 1.529 Vali Acc: 0.297 Test Loss: 1.529 Test Acc: 0.297
Validation loss decreased (-0.246363 --> -0.297086).  Saving model ...
Epoch: 4 cost time: 3.1075539588928223
Epoch: 4, Steps: 9 | Train Loss: 0.562 Vali Loss: 1.721 Vali Acc: 0.319 Test Loss: 1.721 Test Acc: 0.319
Validation loss decreased (-0.297086 --> -0.318823).  Saving model ...
Epoch: 5 cost time: 3.3221678733825684
Epoch: 5, Steps: 9 | Train Loss: 0.329 Vali Loss: 2.235 Vali Acc: 0.312 Test Loss: 2.235 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9787189960479736
Epoch: 6, Steps: 9 | Train Loss: 0.171 Vali Loss: 2.478 Vali Acc: 0.290 Test Loss: 2.478 Test Acc: 0.290
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.014225959777832
Epoch: 7, Steps: 9 | Train Loss: 0.077 Vali Loss: 3.103 Vali Acc: 0.312 Test Loss: 3.103 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.199206590652466
Epoch: 8, Steps: 9 | Train Loss: 0.038 Vali Loss: 2.705 Vali Acc: 0.312 Test Loss: 2.705 Test Acc: 0.312
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.0790557861328125
Epoch: 9, Steps: 9 | Train Loss: 0.015 Vali Loss: 3.333 Vali Acc: 0.326 Test Loss: 3.333 Test Acc: 0.326
Validation loss decreased (-0.318823 --> -0.326054).  Saving model ...
Epoch: 10 cost time: 3.483884811401367
Epoch: 10, Steps: 9 | Train Loss: 0.008 Vali Loss: 2.863 Vali Acc: 0.362 Test Loss: 2.863 Test Acc: 0.362
Validation loss decreased (-0.326054 --> -0.362290).  Saving model ...
Epoch: 11 cost time: 3.458678722381592
Epoch: 11, Steps: 9 | Train Loss: 0.005 Vali Loss: 2.492 Vali Acc: 0.370 Test Loss: 2.492 Test Acc: 0.370
Validation loss decreased (-0.362290 --> -0.369540).  Saving model ...
Epoch: 12 cost time: 3.246131181716919
Epoch: 12, Steps: 9 | Train Loss: 0.004 Vali Loss: 2.796 Vali Acc: 0.355 Test Loss: 2.796 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.2376134395599365
Epoch: 13, Steps: 9 | Train Loss: 0.003 Vali Loss: 3.069 Vali Acc: 0.355 Test Loss: 3.069 Test Acc: 0.355
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.04402232170105
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.829 Vali Acc: 0.377 Test Loss: 2.829 Test Acc: 0.377
Validation loss decreased (-0.369540 --> -0.376783).  Saving model ...
Epoch: 15 cost time: 3.078566551208496
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.832 Vali Acc: 0.362 Test Loss: 2.832 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.887763261795044
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.816 Vali Acc: 0.362 Test Loss: 2.816 Test Acc: 0.362
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.1431570053100586
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.816 Vali Acc: 0.391 Test Loss: 2.816 Test Acc: 0.391
Validation loss decreased (-0.376783 --> -0.391276).  Saving model ...
Epoch: 18 cost time: 3.359909772872925
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.858 Vali Acc: 0.391 Test Loss: 2.858 Test Acc: 0.391
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.3673348426818848
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.839 Vali Acc: 0.391 Test Loss: 2.839 Test Acc: 0.391
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.2014617919921875
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.840 Vali Acc: 0.391 Test Loss: 2.840 Test Acc: 0.391
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.2244133949279785
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.804 Vali Acc: 0.406 Test Loss: 2.804 Test Acc: 0.406
Validation loss decreased (-0.391276 --> -0.405769).  Saving model ...
Epoch: 22 cost time: 3.133434772491455
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.875 Vali Acc: 0.399 Test Loss: 2.875 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.1761972904205322
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.866 Vali Acc: 0.406 Test Loss: 2.866 Test Acc: 0.406
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.1291050910949707
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.850 Vali Acc: 0.406 Test Loss: 2.850 Test Acc: 0.406
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.2084381580352783
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.889 Vali Acc: 0.406 Test Loss: 2.889 Test Acc: 0.406
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.080246925354004
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.877 Vali Acc: 0.391 Test Loss: 2.877 Test Acc: 0.391
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.4942634105682373
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.869 Vali Acc: 0.399 Test Loss: 2.869 Test Acc: 0.399
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.395050287246704
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.847 Vali Acc: 0.406 Test Loss: 2.847 Test Acc: 0.406
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.4433860778808594
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.857 Vali Acc: 0.420 Test Loss: 2.857 Test Acc: 0.420
Validation loss decreased (-0.405769 --> -0.420261).  Saving model ...
Epoch: 30 cost time: 3.466522693634033
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.889 Vali Acc: 0.413 Test Loss: 2.889 Test Acc: 0.413
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.4432883262634277
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.937 Vali Acc: 0.413 Test Loss: 2.937 Test Acc: 0.413
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.3651859760284424
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.947 Vali Acc: 0.406 Test Loss: 2.947 Test Acc: 0.406
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.188826084136963
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.932 Vali Acc: 0.391 Test Loss: 2.932 Test Acc: 0.391
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.34364914894104
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.867 Vali Acc: 0.399 Test Loss: 2.867 Test Acc: 0.399
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.2463228702545166
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.809 Vali Acc: 0.399 Test Loss: 2.809 Test Acc: 0.399
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.490363121032715
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.791 Vali Acc: 0.420 Test Loss: 2.791 Test Acc: 0.420
Validation loss decreased (-0.420261 --> -0.420262).  Saving model ...
Epoch: 37 cost time: 3.5613038539886475
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.818 Vali Acc: 0.413 Test Loss: 2.818 Test Acc: 0.413
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.561091423034668
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.859 Vali Acc: 0.413 Test Loss: 2.859 Test Acc: 0.413
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.667985677719116
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.874 Vali Acc: 0.406 Test Loss: 2.874 Test Acc: 0.406
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.5417728424072266
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.854 Vali Acc: 0.413 Test Loss: 2.854 Test Acc: 0.413
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 3.500066041946411
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.880 Vali Acc: 0.413 Test Loss: 2.880 Test Acc: 0.413
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 3.2497692108154297
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.883 Vali Acc: 0.406 Test Loss: 2.883 Test Acc: 0.406
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 3.2574262619018555
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.895 Vali Acc: 0.413 Test Loss: 2.895 Test Acc: 0.413
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 3.517615795135498
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.905 Vali Acc: 0.420 Test Loss: 2.905 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 3.624217987060547
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.901 Vali Acc: 0.435 Test Loss: 2.901 Test Acc: 0.435
Validation loss decreased (-0.420262 --> -0.434754).  Saving model ...
Epoch: 46 cost time: 3.6284494400024414
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.877 Vali Acc: 0.449 Test Loss: 2.877 Test Acc: 0.449
Validation loss decreased (-0.434754 --> -0.449247).  Saving model ...
Epoch: 47 cost time: 3.244884967803955
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.873 Vali Acc: 0.449 Test Loss: 2.873 Test Acc: 0.449
Validation loss decreased (-0.449247 --> -0.449247).  Saving model ...
Epoch: 48 cost time: 3.08432674407959
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.889 Vali Acc: 0.449 Test Loss: 2.889 Test Acc: 0.449
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.363722085952759
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.922 Vali Acc: 0.457 Test Loss: 2.922 Test Acc: 0.457
Validation loss decreased (-0.449247 --> -0.456493).  Saving model ...
Epoch: 50 cost time: 3.5535354614257812
Epoch: 50, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.947 Vali Acc: 0.457 Test Loss: 2.947 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 2.973262310028076
Epoch: 51, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.957 Vali Acc: 0.457 Test Loss: 2.957 Test Acc: 0.457
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 3.6969802379608154
Epoch: 52, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.957 Vali Acc: 0.449 Test Loss: 2.957 Test Acc: 0.449
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 3.5354268550872803
Epoch: 53, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.966 Vali Acc: 0.449 Test Loss: 2.966 Test Acc: 0.449
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 3.677053928375244
Epoch: 54, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.979 Vali Acc: 0.457 Test Loss: 2.979 Test Acc: 0.457
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 3.5965399742126465
Epoch: 55, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.979 Vali Acc: 0.449 Test Loss: 2.979 Test Acc: 0.449
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 3.3782260417938232
Epoch: 56, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.984 Vali Acc: 0.457 Test Loss: 2.984 Test Acc: 0.457
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 3.4632296562194824
Epoch: 57, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.995 Vali Acc: 0.449 Test Loss: 2.995 Test Acc: 0.449
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 3.340765953063965
Epoch: 58, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.998 Vali Acc: 0.449 Test Loss: 2.998 Test Acc: 0.449
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 3.2789735794067383
Epoch: 59, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.993 Vali Acc: 0.449 Test Loss: 2.993 Test Acc: 0.449
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.45652173913043476
model parameter : 5992964
model size : 32.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.791458606719971
Epoch: 1, Steps: 9 | Train Loss: 1.425 Vali Loss: 1.425 Vali Acc: 0.261 Test Loss: 1.425 Test Acc: 0.261
Validation loss decreased (inf --> -0.260855).  Saving model ...
Epoch: 2 cost time: 3.2376768589019775
Epoch: 2, Steps: 9 | Train Loss: 1.168 Vali Loss: 1.344 Vali Acc: 0.370 Test Loss: 1.344 Test Acc: 0.370
Validation loss decreased (-0.260855 --> -0.369552).  Saving model ...
Epoch: 3 cost time: 3.100430488586426
Epoch: 3, Steps: 9 | Train Loss: 0.850 Vali Loss: 1.321 Vali Acc: 0.348 Test Loss: 1.321 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.033273458480835
Epoch: 4, Steps: 9 | Train Loss: 0.511 Vali Loss: 1.337 Vali Acc: 0.341 Test Loss: 1.337 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.0352895259857178
Epoch: 5, Steps: 9 | Train Loss: 0.256 Vali Loss: 1.559 Vali Acc: 0.304 Test Loss: 1.559 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.917480230331421
Epoch: 6, Steps: 9 | Train Loss: 0.122 Vali Loss: 1.594 Vali Acc: 0.355 Test Loss: 1.594 Test Acc: 0.355
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.3734254837036133
Epoch: 7, Steps: 9 | Train Loss: 0.049 Vali Loss: 1.929 Vali Acc: 0.341 Test Loss: 1.929 Test Acc: 0.341
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.0508077144622803
Epoch: 8, Steps: 9 | Train Loss: 0.023 Vali Loss: 1.670 Vali Acc: 0.384 Test Loss: 1.670 Test Acc: 0.384
Validation loss decreased (-0.369552 --> -0.384041).  Saving model ...
Epoch: 9 cost time: 3.065943956375122
Epoch: 9, Steps: 9 | Train Loss: 0.011 Vali Loss: 1.948 Vali Acc: 0.355 Test Loss: 1.948 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.4195029735565186
Epoch: 10, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.897 Vali Acc: 0.384 Test Loss: 1.897 Test Acc: 0.384
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.238790988922119
Epoch: 11, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.599 Vali Acc: 0.435 Test Loss: 1.599 Test Acc: 0.435
Validation loss decreased (-0.384041 --> -0.434767).  Saving model ...
Epoch: 12 cost time: 3.346101760864258
Epoch: 12, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.551 Vali Acc: 0.442 Test Loss: 1.551 Test Acc: 0.442
Validation loss decreased (-0.434767 --> -0.442013).  Saving model ...
Epoch: 13 cost time: 3.411005973815918
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.652 Vali Acc: 0.413 Test Loss: 1.652 Test Acc: 0.413
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.987900495529175
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.651 Vali Acc: 0.442 Test Loss: 1.651 Test Acc: 0.442
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.3345186710357666
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.727 Vali Acc: 0.428 Test Loss: 1.727 Test Acc: 0.428
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.402557611465454
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.701 Vali Acc: 0.449 Test Loss: 1.701 Test Acc: 0.449
Validation loss decreased (-0.442013 --> -0.449258).  Saving model ...
Epoch: 17 cost time: 3.372502565383911
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.541 Vali Acc: 0.478 Test Loss: 1.541 Test Acc: 0.478
Validation loss decreased (-0.449258 --> -0.478245).  Saving model ...
Epoch: 18 cost time: 3.3205339908599854
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.566 Vali Acc: 0.471 Test Loss: 1.566 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.320002317428589
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.634 Vali Acc: 0.464 Test Loss: 1.634 Test Acc: 0.464
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.575366735458374
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.642 Vali Acc: 0.464 Test Loss: 1.642 Test Acc: 0.464
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.3974530696868896
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.563 Vali Acc: 0.478 Test Loss: 1.563 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.7066550254821777
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.573 Vali Acc: 0.493 Test Loss: 1.573 Test Acc: 0.493
Validation loss decreased (-0.478245 --> -0.492738).  Saving model ...
Epoch: 23 cost time: 3.0553979873657227
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.558 Vali Acc: 0.493 Test Loss: 1.558 Test Acc: 0.493
Validation loss decreased (-0.492738 --> -0.492738).  Saving model ...
Epoch: 24 cost time: 3.207937002182007
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.600 Vali Acc: 0.478 Test Loss: 1.600 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.9993200302124023
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.626 Vali Acc: 0.493 Test Loss: 1.626 Test Acc: 0.493
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.0940873622894287
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.597 Vali Acc: 0.493 Test Loss: 1.597 Test Acc: 0.493
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.510952949523926
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.551 Vali Acc: 0.507 Test Loss: 1.551 Test Acc: 0.507
Validation loss decreased (-0.492738 --> -0.507231).  Saving model ...
Epoch: 28 cost time: 3.524878978729248
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.534 Vali Acc: 0.514 Test Loss: 1.534 Test Acc: 0.514
Validation loss decreased (-0.507231 --> -0.514477).  Saving model ...
Epoch: 29 cost time: 3.2268552780151367
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.565 Vali Acc: 0.500 Test Loss: 1.565 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.4147939682006836
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.585 Vali Acc: 0.507 Test Loss: 1.585 Test Acc: 0.507
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.2650222778320312
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.598 Vali Acc: 0.500 Test Loss: 1.598 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.0237882137298584
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.600 Vali Acc: 0.507 Test Loss: 1.600 Test Acc: 0.507
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.0068130493164062
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.604 Vali Acc: 0.514 Test Loss: 1.604 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.057973623275757
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.567 Vali Acc: 0.529 Test Loss: 1.567 Test Acc: 0.529
Validation loss decreased (-0.514477 --> -0.528970).  Saving model ...
Epoch: 35 cost time: 2.9477481842041016
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.528 Vali Acc: 0.551 Test Loss: 1.528 Test Acc: 0.551
Validation loss decreased (-0.528970 --> -0.550709).  Saving model ...
Epoch: 36 cost time: 2.824528455734253
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.516 Vali Acc: 0.551 Test Loss: 1.516 Test Acc: 0.551
Validation loss decreased (-0.550709 --> -0.550709).  Saving model ...
Epoch: 37 cost time: 3.1989424228668213
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.514 Vali Acc: 0.543 Test Loss: 1.514 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.279160499572754
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.534 Vali Acc: 0.543 Test Loss: 1.534 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.3989102840423584
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.539 Vali Acc: 0.543 Test Loss: 1.539 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.3382625579833984
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.519 Vali Acc: 0.572 Test Loss: 1.519 Test Acc: 0.572
Validation loss decreased (-0.550709 --> -0.572449).  Saving model ...
Epoch: 41 cost time: 3.13217830657959
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.527 Vali Acc: 0.565 Test Loss: 1.527 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.1192569732666016
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.549 Vali Acc: 0.572 Test Loss: 1.549 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.140519857406616
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.550 Vali Acc: 0.565 Test Loss: 1.550 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.155390977859497
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.541 Vali Acc: 0.572 Test Loss: 1.541 Test Acc: 0.572
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 3.2081363201141357
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.541 Vali Acc: 0.565 Test Loss: 1.541 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 3.5612523555755615
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.532 Vali Acc: 0.565 Test Loss: 1.532 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 3.8867666721343994
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.534 Vali Acc: 0.565 Test Loss: 1.534 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 3.434509515762329
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.536 Vali Acc: 0.565 Test Loss: 1.536 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 3.4334874153137207
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.540 Vali Acc: 0.565 Test Loss: 1.540 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 3.4818034172058105
Epoch: 50, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.553 Vali Acc: 0.572 Test Loss: 1.553 Test Acc: 0.572
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.572463768115942
model parameter : 5992964
model size : 32.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         103                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma103_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.726918458938599
Epoch: 1, Steps: 9 | Train Loss: 1.446 Vali Loss: 1.244 Vali Acc: 0.500 Test Loss: 1.244 Test Acc: 0.500
Validation loss decreased (inf --> -0.499988).  Saving model ...
Epoch: 2 cost time: 2.891119956970215
Epoch: 2, Steps: 9 | Train Loss: 0.968 Vali Loss: 0.924 Vali Acc: 0.681 Test Loss: 0.924 Test Acc: 0.681
Validation loss decreased (-0.499988 --> -0.681150).  Saving model ...
Epoch: 3 cost time: 3.0357327461242676
Epoch: 3, Steps: 9 | Train Loss: 0.498 Vali Loss: 0.728 Vali Acc: 0.732 Test Loss: 0.728 Test Acc: 0.732
Validation loss decreased (-0.681150 --> -0.731877).  Saving model ...
Epoch: 4 cost time: 3.2002923488616943
Epoch: 4, Steps: 9 | Train Loss: 0.203 Vali Loss: 0.652 Vali Acc: 0.761 Test Loss: 0.652 Test Acc: 0.761
Validation loss decreased (-0.731877 --> -0.760863).  Saving model ...
Epoch: 5 cost time: 3.1204559803009033
Epoch: 5, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.948 Vali Acc: 0.710 Test Loss: 0.948 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.080559253692627
Epoch: 6, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.589 Vali Acc: 0.804 Test Loss: 0.589 Test Acc: 0.804
Validation loss decreased (-0.760863 --> -0.804342).  Saving model ...
Epoch: 7 cost time: 3.04490327835083
Epoch: 7, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.779 Vali Acc: 0.790 Test Loss: 0.779 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.3991799354553223
Epoch: 8, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.634 Vali Acc: 0.797 Test Loss: 0.634 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.9607253074645996
Epoch: 9, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.574 Vali Acc: 0.819 Test Loss: 0.574 Test Acc: 0.819
Validation loss decreased (-0.804342 --> -0.818835).  Saving model ...
Epoch: 10 cost time: 3.1356611251831055
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.621 Vali Acc: 0.804 Test Loss: 0.621 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.0300817489624023
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.662 Vali Acc: 0.812 Test Loss: 0.662 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.121978759765625
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.642 Vali Acc: 0.804 Test Loss: 0.642 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.1533071994781494
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.616 Vali Acc: 0.826 Test Loss: 0.616 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826081).  Saving model ...
Epoch: 14 cost time: 3.48862886428833
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.619 Vali Acc: 0.833 Test Loss: 0.619 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833327).  Saving model ...
Epoch: 15 cost time: 3.7124876976013184
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.628 Vali Acc: 0.833 Test Loss: 0.628 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.301795244216919
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.621 Vali Acc: 0.833 Test Loss: 0.621 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.5058677196502686
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.620 Vali Acc: 0.841 Test Loss: 0.620 Test Acc: 0.841
Validation loss decreased (-0.833327 --> -0.840574).  Saving model ...
Epoch: 18 cost time: 3.61600399017334
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.617 Vali Acc: 0.848 Test Loss: 0.617 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847820).  Saving model ...
Epoch: 19 cost time: 3.1327288150787354
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.612 Vali Acc: 0.841 Test Loss: 0.612 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.451687812805176
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.621 Vali Acc: 0.841 Test Loss: 0.621 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.0383763313293457
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.626 Vali Acc: 0.833 Test Loss: 0.626 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.9080989360809326
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.624 Vali Acc: 0.833 Test Loss: 0.624 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.9830973148345947
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.618 Vali Acc: 0.841 Test Loss: 0.618 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.096693754196167
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.621 Vali Acc: 0.841 Test Loss: 0.621 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.1917765140533447
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.626 Vali Acc: 0.841 Test Loss: 0.626 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.043729782104492
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.621 Vali Acc: 0.848 Test Loss: 0.621 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.3890743255615234
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.622 Vali Acc: 0.841 Test Loss: 0.622 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.1381077766418457
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.620 Vali Acc: 0.841 Test Loss: 0.620 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma103_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 4420100
model size : 26.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         83                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma83_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.737013101577759
Epoch: 1, Steps: 9 | Train Loss: 1.456 Vali Loss: 1.249 Vali Acc: 0.486 Test Loss: 1.249 Test Acc: 0.486
Validation loss decreased (inf --> -0.485495).  Saving model ...
Epoch: 2 cost time: 3.292137384414673
Epoch: 2, Steps: 9 | Train Loss: 0.977 Vali Loss: 0.921 Vali Acc: 0.681 Test Loss: 0.921 Test Acc: 0.681
Validation loss decreased (-0.485495 --> -0.681150).  Saving model ...
Epoch: 3 cost time: 3.7292213439941406
Epoch: 3, Steps: 9 | Train Loss: 0.506 Vali Loss: 0.707 Vali Acc: 0.746 Test Loss: 0.707 Test Acc: 0.746
Validation loss decreased (-0.681150 --> -0.746370).  Saving model ...
Epoch: 4 cost time: 3.4550416469573975
Epoch: 4, Steps: 9 | Train Loss: 0.213 Vali Loss: 0.633 Vali Acc: 0.768 Test Loss: 0.633 Test Acc: 0.768
Validation loss decreased (-0.746370 --> -0.768110).  Saving model ...
Epoch: 5 cost time: 3.4575111865997314
Epoch: 5, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.928 Vali Acc: 0.732 Test Loss: 0.928 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.5512454509735107
Epoch: 6, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.522 Vali Acc: 0.783 Test Loss: 0.522 Test Acc: 0.783
Validation loss decreased (-0.768110 --> -0.782603).  Saving model ...
Epoch: 7 cost time: 3.4986836910247803
Epoch: 7, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.713 Vali Acc: 0.783 Test Loss: 0.713 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.2627975940704346
Epoch: 8, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.547 Vali Acc: 0.848 Test Loss: 0.547 Test Acc: 0.848
Validation loss decreased (-0.782603 --> -0.847821).  Saving model ...
Epoch: 9 cost time: 3.342226982116699
Epoch: 9, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.507 Vali Acc: 0.841 Test Loss: 0.507 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.401348829269409
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.561 Vali Acc: 0.841 Test Loss: 0.561 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.408123016357422
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.605 Vali Acc: 0.848 Test Loss: 0.605 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.3982505798339844
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.585 Vali Acc: 0.848 Test Loss: 0.585 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.6207008361816406
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.563 Vali Acc: 0.848 Test Loss: 0.563 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.2877814769744873
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.564 Vali Acc: 0.833 Test Loss: 0.564 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.7287967205047607
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.571 Vali Acc: 0.833 Test Loss: 0.571 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.2529654502868652
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.558 Vali Acc: 0.848 Test Loss: 0.558 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.1494486331939697
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.564 Vali Acc: 0.848 Test Loss: 0.564 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.61688232421875
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.565 Vali Acc: 0.862 Test Loss: 0.565 Test Acc: 0.862
Validation loss decreased (-0.847821 --> -0.862313).  Saving model ...
Epoch: 19 cost time: 3.274637222290039
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.560 Vali Acc: 0.855 Test Loss: 0.560 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.2280397415161133
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.566 Vali Acc: 0.848 Test Loss: 0.566 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.1422786712646484
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.571 Vali Acc: 0.848 Test Loss: 0.571 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.3193247318267822
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.571 Vali Acc: 0.848 Test Loss: 0.571 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.3146491050720215
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.566 Vali Acc: 0.848 Test Loss: 0.566 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.48276948928833
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.569 Vali Acc: 0.855 Test Loss: 0.569 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.4151194095611572
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.571 Vali Acc: 0.855 Test Loss: 0.571 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.300351858139038
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.565 Vali Acc: 0.862 Test Loss: 0.565 Test Acc: 0.862
Validation loss decreased (-0.862313 --> -0.862313).  Saving model ...
Epoch: 27 cost time: 3.661595582962036
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.567 Vali Acc: 0.848 Test Loss: 0.567 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.555971622467041
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.567 Vali Acc: 0.848 Test Loss: 0.567 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.4486162662506104
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.569 Vali Acc: 0.855 Test Loss: 0.569 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.645796537399292
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.579 Vali Acc: 0.862 Test Loss: 0.579 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.547670364379883
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.576 Vali Acc: 0.870 Test Loss: 0.576 Test Acc: 0.870
Validation loss decreased (-0.862313 --> -0.869559).  Saving model ...
Epoch: 32 cost time: 3.330963611602783
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.574 Vali Acc: 0.855 Test Loss: 0.574 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.5362589359283447
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.579 Vali Acc: 0.862 Test Loss: 0.579 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.2879791259765625
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.573 Vali Acc: 0.862 Test Loss: 0.573 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.442221164703369
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.570 Vali Acc: 0.870 Test Loss: 0.570 Test Acc: 0.870
Validation loss decreased (-0.869559 --> -0.869560).  Saving model ...
Epoch: 36 cost time: 3.461024522781372
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.569 Vali Acc: 0.877 Test Loss: 0.569 Test Acc: 0.877
Validation loss decreased (-0.869560 --> -0.876806).  Saving model ...
Epoch: 37 cost time: 3.555979013442993
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.579 Vali Acc: 0.870 Test Loss: 0.579 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.5700912475585938
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.585 Vali Acc: 0.862 Test Loss: 0.585 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.4044535160064697
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.577 Vali Acc: 0.862 Test Loss: 0.577 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.215505599975586
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.577 Vali Acc: 0.870 Test Loss: 0.577 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 3.4129703044891357
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.574 Vali Acc: 0.877 Test Loss: 0.574 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 3.4041121006011963
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.578 Vali Acc: 0.870 Test Loss: 0.578 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 3.0860726833343506
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.579 Vali Acc: 0.862 Test Loss: 0.579 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 3.3643453121185303
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.577 Vali Acc: 0.877 Test Loss: 0.577 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 3.304564952850342
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.578 Vali Acc: 0.884 Test Loss: 0.578 Test Acc: 0.884
Validation loss decreased (-0.876806 --> -0.884052).  Saving model ...
Epoch: 46 cost time: 3.524857997894287
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.586 Vali Acc: 0.870 Test Loss: 0.586 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.4466185569763184
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.584 Vali Acc: 0.877 Test Loss: 0.584 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 3.489104986190796
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.582 Vali Acc: 0.884 Test Loss: 0.582 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 3.6227357387542725
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.580 Vali Acc: 0.884 Test Loss: 0.580 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 3.4750280380249023
Epoch: 50, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.581 Vali Acc: 0.884 Test Loss: 0.581 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 3.269559860229492
Epoch: 51, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.586 Vali Acc: 0.891 Test Loss: 0.586 Test Acc: 0.891
Validation loss decreased (-0.884052 --> -0.891298).  Saving model ...
Epoch: 52 cost time: 3.1808292865753174
Epoch: 52, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.587 Vali Acc: 0.891 Test Loss: 0.587 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 3.2410390377044678
Epoch: 53, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.588 Vali Acc: 0.891 Test Loss: 0.588 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 3.3820865154266357
Epoch: 54, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.593 Vali Acc: 0.891 Test Loss: 0.593 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 3.660741090774536
Epoch: 55, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.594 Vali Acc: 0.884 Test Loss: 0.594 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 3.47697377204895
Epoch: 56, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.593 Vali Acc: 0.884 Test Loss: 0.593 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 3.6685924530029297
Epoch: 57, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.592 Vali Acc: 0.884 Test Loss: 0.592 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 3.296982526779175
Epoch: 58, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.593 Vali Acc: 0.884 Test Loss: 0.593 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 3.339688301086426
Epoch: 59, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.594 Vali Acc: 0.884 Test Loss: 0.594 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 3.379286527633667
Epoch: 60, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.593 Vali Acc: 0.884 Test Loss: 0.593 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 3.0358664989471436
Epoch: 61, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.590 Vali Acc: 0.884 Test Loss: 0.590 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma83_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 4420100
model size : 26.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         62                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma62_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.820511817932129
Epoch: 1, Steps: 9 | Train Loss: 1.452 Vali Loss: 1.259 Vali Acc: 0.500 Test Loss: 1.259 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 3.2977423667907715
Epoch: 2, Steps: 9 | Train Loss: 0.977 Vali Loss: 0.933 Vali Acc: 0.674 Test Loss: 0.933 Test Acc: 0.674
Validation loss decreased (-0.499987 --> -0.673904).  Saving model ...
Epoch: 3 cost time: 3.0800609588623047
Epoch: 3, Steps: 9 | Train Loss: 0.495 Vali Loss: 0.713 Vali Acc: 0.768 Test Loss: 0.713 Test Acc: 0.768
Validation loss decreased (-0.673904 --> -0.768109).  Saving model ...
Epoch: 4 cost time: 3.0369720458984375
Epoch: 4, Steps: 9 | Train Loss: 0.203 Vali Loss: 0.653 Vali Acc: 0.783 Test Loss: 0.653 Test Acc: 0.783
Validation loss decreased (-0.768109 --> -0.782602).  Saving model ...
Epoch: 5 cost time: 2.8474082946777344
Epoch: 5, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.859 Vali Acc: 0.725 Test Loss: 0.859 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.8672404289245605
Epoch: 6, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.522 Vali Acc: 0.819 Test Loss: 0.522 Test Acc: 0.819
Validation loss decreased (-0.782602 --> -0.818835).  Saving model ...
Epoch: 7 cost time: 2.8988285064697266
Epoch: 7, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.749 Vali Acc: 0.819 Test Loss: 0.749 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.936321496963501
Epoch: 8, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.582 Vali Acc: 0.841 Test Loss: 0.582 Test Acc: 0.841
Validation loss decreased (-0.818835 --> -0.840574).  Saving model ...
Epoch: 9 cost time: 3.006544828414917
Epoch: 9, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.533 Vali Acc: 0.870 Test Loss: 0.533 Test Acc: 0.870
Validation loss decreased (-0.840574 --> -0.869560).  Saving model ...
Epoch: 10 cost time: 3.124105215072632
Epoch: 10, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.583 Vali Acc: 0.848 Test Loss: 0.583 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.359060049057007
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.603 Vali Acc: 0.870 Test Loss: 0.603 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.364483118057251
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.572 Vali Acc: 0.870 Test Loss: 0.572 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.3202154636383057
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.549 Vali Acc: 0.870 Test Loss: 0.549 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.3135108947753906
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.551 Vali Acc: 0.884 Test Loss: 0.551 Test Acc: 0.884
Validation loss decreased (-0.869560 --> -0.884052).  Saving model ...
Epoch: 15 cost time: 3.224717855453491
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.561 Vali Acc: 0.884 Test Loss: 0.561 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.1072041988372803
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.554 Vali Acc: 0.884 Test Loss: 0.554 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.938878059387207
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.556 Vali Acc: 0.884 Test Loss: 0.556 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.029231071472168
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.553 Vali Acc: 0.884 Test Loss: 0.553 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.036184787750244
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.551 Vali Acc: 0.884 Test Loss: 0.551 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.188934803009033
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.557 Vali Acc: 0.891 Test Loss: 0.557 Test Acc: 0.891
Validation loss decreased (-0.884052 --> -0.891299).  Saving model ...
Epoch: 21 cost time: 3.40748929977417
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.561 Vali Acc: 0.891 Test Loss: 0.561 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.3868041038513184
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.559 Vali Acc: 0.899 Test Loss: 0.559 Test Acc: 0.899
Validation loss decreased (-0.891299 --> -0.898545).  Saving model ...
Epoch: 23 cost time: 3.2269656658172607
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.554 Vali Acc: 0.891 Test Loss: 0.554 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.2632932662963867
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.553 Vali Acc: 0.891 Test Loss: 0.553 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.874084234237671
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.553 Vali Acc: 0.899 Test Loss: 0.553 Test Acc: 0.899
Validation loss decreased (-0.898545 --> -0.898545).  Saving model ...
Epoch: 26 cost time: 3.1919643878936768
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.551 Vali Acc: 0.899 Test Loss: 0.551 Test Acc: 0.899
Validation loss decreased (-0.898545 --> -0.898545).  Saving model ...
Epoch: 27 cost time: 2.9036734104156494
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.554 Vali Acc: 0.899 Test Loss: 0.554 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.857938289642334
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.552 Vali Acc: 0.906 Test Loss: 0.552 Test Acc: 0.906
Validation loss decreased (-0.898545 --> -0.905792).  Saving model ...
Epoch: 29 cost time: 2.920733690261841
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.553 Vali Acc: 0.906 Test Loss: 0.553 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.91589093208313
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.564 Vali Acc: 0.899 Test Loss: 0.564 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.2437777519226074
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.562 Vali Acc: 0.899 Test Loss: 0.562 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.2972774505615234
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.560 Vali Acc: 0.906 Test Loss: 0.560 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.199122190475464
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.562 Vali Acc: 0.913 Test Loss: 0.562 Test Acc: 0.913
Validation loss decreased (-0.905792 --> -0.913038).  Saving model ...
Epoch: 34 cost time: 3.5091371536254883
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.556 Vali Acc: 0.913 Test Loss: 0.556 Test Acc: 0.913
Validation loss decreased (-0.913038 --> -0.913038).  Saving model ...
Epoch: 35 cost time: 3.396787643432617
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.552 Vali Acc: 0.913 Test Loss: 0.552 Test Acc: 0.913
Validation loss decreased (-0.913038 --> -0.913038).  Saving model ...
Epoch: 36 cost time: 3.382166862487793
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.552 Vali Acc: 0.913 Test Loss: 0.552 Test Acc: 0.913
Validation loss decreased (-0.913038 --> -0.913038).  Saving model ...
Epoch: 37 cost time: 3.1405029296875
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.561 Vali Acc: 0.913 Test Loss: 0.561 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.2251384258270264
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.568 Vali Acc: 0.913 Test Loss: 0.568 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.240821123123169
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.561 Vali Acc: 0.913 Test Loss: 0.561 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.509850263595581
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.560 Vali Acc: 0.913 Test Loss: 0.560 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 3.6646363735198975
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.558 Vali Acc: 0.913 Test Loss: 0.558 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 3.666780710220337
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.562 Vali Acc: 0.913 Test Loss: 0.562 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 3.53752064704895
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.565 Vali Acc: 0.913 Test Loss: 0.565 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 3.538684844970703
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.563 Vali Acc: 0.913 Test Loss: 0.563 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 3.3801310062408447
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.563 Vali Acc: 0.913 Test Loss: 0.563 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 3.3156731128692627
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.570 Vali Acc: 0.913 Test Loss: 0.570 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma62_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 4420100
model size : 26.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         42                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.6090922355651855
Epoch: 1, Steps: 9 | Train Loss: 1.439 Vali Loss: 1.231 Vali Acc: 0.486 Test Loss: 1.231 Test Acc: 0.486
Validation loss decreased (inf --> -0.485495).  Saving model ...
Epoch: 2 cost time: 3.187669038772583
Epoch: 2, Steps: 9 | Train Loss: 0.950 Vali Loss: 0.882 Vali Acc: 0.696 Test Loss: 0.882 Test Acc: 0.696
Validation loss decreased (-0.485495 --> -0.695643).  Saving model ...
Epoch: 3 cost time: 3.465548515319824
Epoch: 3, Steps: 9 | Train Loss: 0.481 Vali Loss: 0.672 Vali Acc: 0.761 Test Loss: 0.672 Test Acc: 0.761
Validation loss decreased (-0.695643 --> -0.760863).  Saving model ...
Epoch: 4 cost time: 3.430880308151245
Epoch: 4, Steps: 9 | Train Loss: 0.204 Vali Loss: 0.610 Vali Acc: 0.775 Test Loss: 0.610 Test Acc: 0.775
Validation loss decreased (-0.760863 --> -0.775356).  Saving model ...
Epoch: 5 cost time: 3.3315200805664062
Epoch: 5, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.809 Vali Acc: 0.725 Test Loss: 0.809 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.3641560077667236
Epoch: 6, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.432 Vali Acc: 0.841 Test Loss: 0.432 Test Acc: 0.841
Validation loss decreased (-0.775356 --> -0.840575).  Saving model ...
Epoch: 7 cost time: 3.1205732822418213
Epoch: 7, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.655 Vali Acc: 0.775 Test Loss: 0.655 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.1407887935638428
Epoch: 8, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.552 Vali Acc: 0.819 Test Loss: 0.552 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.9386954307556152
Epoch: 9, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.511 Vali Acc: 0.848 Test Loss: 0.511 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 10 cost time: 3.079129934310913
Epoch: 10, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.592 Vali Acc: 0.833 Test Loss: 0.592 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.6314284801483154
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.498 Vali Acc: 0.833 Test Loss: 0.498 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.2881648540496826
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.472 Vali Acc: 0.855 Test Loss: 0.472 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 13 cost time: 3.4563724994659424
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.475 Vali Acc: 0.870 Test Loss: 0.475 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869560).  Saving model ...
Epoch: 14 cost time: 3.2210092544555664
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.501 Vali Acc: 0.855 Test Loss: 0.501 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.413604736328125
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.521 Vali Acc: 0.855 Test Loss: 0.521 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.3248708248138428
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.496 Vali Acc: 0.855 Test Loss: 0.496 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.0744481086730957
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.494 Vali Acc: 0.862 Test Loss: 0.494 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.148111343383789
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.494 Vali Acc: 0.862 Test Loss: 0.494 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.0847878456115723
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.496 Vali Acc: 0.862 Test Loss: 0.496 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.1893224716186523
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.505 Vali Acc: 0.862 Test Loss: 0.505 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.1227355003356934
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.510 Vali Acc: 0.862 Test Loss: 0.510 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.380117177963257
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.502 Vali Acc: 0.862 Test Loss: 0.502 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.3793301582336426
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.496 Vali Acc: 0.862 Test Loss: 0.496 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 4420100
model size : 26.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.583178997039795
Epoch: 1, Steps: 9 | Train Loss: 1.449 Vali Loss: 1.232 Vali Acc: 0.507 Test Loss: 1.232 Test Acc: 0.507
Validation loss decreased (inf --> -0.507234).  Saving model ...
Epoch: 2 cost time: 3.158945322036743
Epoch: 2, Steps: 9 | Train Loss: 0.989 Vali Loss: 0.924 Vali Acc: 0.674 Test Loss: 0.924 Test Acc: 0.674
Validation loss decreased (-0.507234 --> -0.673904).  Saving model ...
Epoch: 3 cost time: 2.8864901065826416
Epoch: 3, Steps: 9 | Train Loss: 0.534 Vali Loss: 0.684 Vali Acc: 0.804 Test Loss: 0.684 Test Acc: 0.804
Validation loss decreased (-0.673904 --> -0.804341).  Saving model ...
Epoch: 4 cost time: 2.927821636199951
Epoch: 4, Steps: 9 | Train Loss: 0.224 Vali Loss: 0.557 Vali Acc: 0.804 Test Loss: 0.557 Test Acc: 0.804
Validation loss decreased (-0.804341 --> -0.804342).  Saving model ...
Epoch: 5 cost time: 3.036442756652832
Epoch: 5, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.723 Vali Acc: 0.746 Test Loss: 0.723 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.196326971054077
Epoch: 6, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.377 Vali Acc: 0.884 Test Loss: 0.377 Test Acc: 0.884
Validation loss decreased (-0.804342 --> -0.884054).  Saving model ...
Epoch: 7 cost time: 3.3500540256500244
Epoch: 7, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.503 Vali Acc: 0.833 Test Loss: 0.503 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.311892509460449
Epoch: 8, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.422 Vali Acc: 0.862 Test Loss: 0.422 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.1084611415863037
Epoch: 9, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.352 Vali Acc: 0.891 Test Loss: 0.352 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 10 cost time: 3.032512664794922
Epoch: 10, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.394 Vali Acc: 0.884 Test Loss: 0.394 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.968545436859131
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.406 Vali Acc: 0.884 Test Loss: 0.406 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.004631757736206
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.380 Vali Acc: 0.891 Test Loss: 0.380 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.123290777206421
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.360 Vali Acc: 0.899 Test Loss: 0.360 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 14 cost time: 3.0655064582824707
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.362 Vali Acc: 0.899 Test Loss: 0.362 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.0707688331604004
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.369 Vali Acc: 0.891 Test Loss: 0.369 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.1481516361236572
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.362 Vali Acc: 0.899 Test Loss: 0.362 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.2099785804748535
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.366 Vali Acc: 0.891 Test Loss: 0.366 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.352010488510132
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.366 Vali Acc: 0.899 Test Loss: 0.366 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.339648485183716
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.359 Vali Acc: 0.899 Test Loss: 0.359 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 20 cost time: 3.016453981399536
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.358 Vali Acc: 0.899 Test Loss: 0.358 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 21 cost time: 3.2415788173675537
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.368 Vali Acc: 0.891 Test Loss: 0.368 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.061838150024414
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.365 Vali Acc: 0.891 Test Loss: 0.365 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.06433367729187
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.359 Vali Acc: 0.899 Test Loss: 0.359 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.015536069869995
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.355 Vali Acc: 0.899 Test Loss: 0.355 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 25 cost time: 3.1089134216308594
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.358 Vali Acc: 0.899 Test Loss: 0.358 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.3241002559661865
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.356 Vali Acc: 0.899 Test Loss: 0.356 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.190406084060669
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.359 Vali Acc: 0.899 Test Loss: 0.359 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.337286949157715
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.359 Vali Acc: 0.906 Test Loss: 0.359 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 29 cost time: 3.0179543495178223
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.358 Vali Acc: 0.906 Test Loss: 0.358 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 30 cost time: 3.035048723220825
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.363 Vali Acc: 0.906 Test Loss: 0.363 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.0262954235076904
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.357 Vali Acc: 0.906 Test Loss: 0.357 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 32 cost time: 2.991891860961914
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.356 Vali Acc: 0.906 Test Loss: 0.356 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 33 cost time: 3.068105697631836
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.363 Vali Acc: 0.906 Test Loss: 0.363 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.156489372253418
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.359 Vali Acc: 0.906 Test Loss: 0.359 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.2650883197784424
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.358 Vali Acc: 0.906 Test Loss: 0.358 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.3791258335113525
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.355 Vali Acc: 0.906 Test Loss: 0.355 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 37 cost time: 3.5421700477600098
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.361 Vali Acc: 0.906 Test Loss: 0.361 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.478381633758545
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.368 Vali Acc: 0.906 Test Loss: 0.368 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.126356840133667
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.365 Vali Acc: 0.906 Test Loss: 0.365 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.1358842849731445
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.365 Vali Acc: 0.906 Test Loss: 0.365 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.962952136993408
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.363 Vali Acc: 0.906 Test Loss: 0.363 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 2.9476473331451416
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.362 Vali Acc: 0.906 Test Loss: 0.362 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 3.144279718399048
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.358 Vali Acc: 0.906 Test Loss: 0.358 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 3.4000768661499023
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.358 Vali Acc: 0.906 Test Loss: 0.358 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 3.190434217453003
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.359 Vali Acc: 0.906 Test Loss: 0.359 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 3.119429349899292
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.365 Vali Acc: 0.906 Test Loss: 0.365 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 4420100
model size : 26.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.613360643386841
Epoch: 1, Steps: 9 | Train Loss: 1.467 Vali Loss: 1.240 Vali Acc: 0.457 Test Loss: 1.240 Test Acc: 0.457
Validation loss decreased (inf --> -0.456509).  Saving model ...
Epoch: 2 cost time: 3.1163249015808105
Epoch: 2, Steps: 9 | Train Loss: 0.991 Vali Loss: 0.923 Vali Acc: 0.674 Test Loss: 0.923 Test Acc: 0.674
Validation loss decreased (-0.456509 --> -0.673904).  Saving model ...
Epoch: 3 cost time: 3.0788023471832275
Epoch: 3, Steps: 9 | Train Loss: 0.552 Vali Loss: 0.700 Vali Acc: 0.732 Test Loss: 0.700 Test Acc: 0.732
Validation loss decreased (-0.673904 --> -0.731877).  Saving model ...
Epoch: 4 cost time: 3.133714199066162
Epoch: 4, Steps: 9 | Train Loss: 0.235 Vali Loss: 0.607 Vali Acc: 0.783 Test Loss: 0.607 Test Acc: 0.783
Validation loss decreased (-0.731877 --> -0.782603).  Saving model ...
Epoch: 5 cost time: 3.336277723312378
Epoch: 5, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.738 Vali Acc: 0.739 Test Loss: 0.738 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.020853281021118
Epoch: 6, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.534 Vali Acc: 0.775 Test Loss: 0.534 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.954193353652954
Epoch: 7, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.591 Vali Acc: 0.739 Test Loss: 0.591 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.878638982772827
Epoch: 8, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.502 Vali Acc: 0.826 Test Loss: 0.502 Test Acc: 0.826
Validation loss decreased (-0.782603 --> -0.826082).  Saving model ...
Epoch: 9 cost time: 2.7797000408172607
Epoch: 9, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.534 Vali Acc: 0.804 Test Loss: 0.534 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8179993629455566
Epoch: 10, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.558 Vali Acc: 0.812 Test Loss: 0.558 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.1784873008728027
Epoch: 11, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.490 Vali Acc: 0.819 Test Loss: 0.490 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.281503438949585
Epoch: 12, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.488 Vali Acc: 0.819 Test Loss: 0.488 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.181216239929199
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.510 Vali Acc: 0.826 Test Loss: 0.510 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.324582576751709
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.506 Vali Acc: 0.819 Test Loss: 0.506 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.2573118209838867
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.493 Vali Acc: 0.819 Test Loss: 0.493 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.9764721393585205
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.487 Vali Acc: 0.819 Test Loss: 0.487 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.932436943054199
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.503 Vali Acc: 0.819 Test Loss: 0.503 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.8926444053649902
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.512 Vali Acc: 0.833 Test Loss: 0.512 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833328).  Saving model ...
Epoch: 19 cost time: 2.8326754570007324
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.500 Vali Acc: 0.819 Test Loss: 0.500 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.8873860836029053
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.497 Vali Acc: 0.819 Test Loss: 0.497 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.276064395904541
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.502 Vali Acc: 0.819 Test Loss: 0.502 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.2494354248046875
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.501 Vali Acc: 0.826 Test Loss: 0.501 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.1623287200927734
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.504 Vali Acc: 0.819 Test Loss: 0.504 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.2401697635650635
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.507 Vali Acc: 0.819 Test Loss: 0.507 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.1235175132751465
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.511 Vali Acc: 0.826 Test Loss: 0.511 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.8075568675994873
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.499 Vali Acc: 0.826 Test Loss: 0.499 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.024649143218994
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.503 Vali Acc: 0.826 Test Loss: 0.503 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.931025505065918
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.507 Vali Acc: 0.826 Test Loss: 0.507 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 4420100
model size : 26.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.843995571136475
Epoch: 1, Steps: 9 | Train Loss: 1.463 Vali Loss: 1.244 Vali Acc: 0.464 Test Loss: 1.244 Test Acc: 0.464
Validation loss decreased (inf --> -0.463756).  Saving model ...
Epoch: 2 cost time: 3.2647604942321777
Epoch: 2, Steps: 9 | Train Loss: 0.967 Vali Loss: 0.972 Vali Acc: 0.630 Test Loss: 0.972 Test Acc: 0.630
Validation loss decreased (-0.463756 --> -0.630425).  Saving model ...
Epoch: 3 cost time: 3.451906204223633
Epoch: 3, Steps: 9 | Train Loss: 0.548 Vali Loss: 0.859 Vali Acc: 0.659 Test Loss: 0.859 Test Acc: 0.659
Validation loss decreased (-0.630425 --> -0.659412).  Saving model ...
Epoch: 4 cost time: 3.276359796524048
Epoch: 4, Steps: 9 | Train Loss: 0.262 Vali Loss: 0.788 Vali Acc: 0.732 Test Loss: 0.788 Test Acc: 0.732
Validation loss decreased (-0.659412 --> -0.731876).  Saving model ...
Epoch: 5 cost time: 3.0731935501098633
Epoch: 5, Steps: 9 | Train Loss: 0.147 Vali Loss: 0.912 Vali Acc: 0.659 Test Loss: 0.912 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.044518232345581
Epoch: 6, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.779 Vali Acc: 0.725 Test Loss: 0.779 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.4235405921936035
Epoch: 7, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.905 Vali Acc: 0.739 Test Loss: 0.905 Test Acc: 0.739
Validation loss decreased (-0.731876 --> -0.739121).  Saving model ...
Epoch: 8 cost time: 3.4294652938842773
Epoch: 8, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.753 Vali Acc: 0.768 Test Loss: 0.753 Test Acc: 0.768
Validation loss decreased (-0.739121 --> -0.768108).  Saving model ...
Epoch: 9 cost time: 3.2092185020446777
Epoch: 9, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.744 Vali Acc: 0.768 Test Loss: 0.744 Test Acc: 0.768
Validation loss decreased (-0.768108 --> -0.768109).  Saving model ...
Epoch: 10 cost time: 3.7661499977111816
Epoch: 10, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.804 Vali Acc: 0.746 Test Loss: 0.804 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.3791627883911133
Epoch: 11, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.800 Vali Acc: 0.768 Test Loss: 0.800 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.384317636489868
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.789 Vali Acc: 0.768 Test Loss: 0.789 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.2862026691436768
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.780 Vali Acc: 0.761 Test Loss: 0.780 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.194453716278076
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.784 Vali Acc: 0.768 Test Loss: 0.784 Test Acc: 0.768
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.04032826423645
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.793 Vali Acc: 0.775 Test Loss: 0.793 Test Acc: 0.775
Validation loss decreased (-0.768109 --> -0.775354).  Saving model ...
Epoch: 16 cost time: 3.4231276512145996
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.795 Vali Acc: 0.775 Test Loss: 0.795 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.050945281982422
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.799 Vali Acc: 0.775 Test Loss: 0.799 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.4130685329437256
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.800 Vali Acc: 0.775 Test Loss: 0.800 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.31058406829834
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.802 Vali Acc: 0.768 Test Loss: 0.802 Test Acc: 0.768
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.311751365661621
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.807 Vali Acc: 0.768 Test Loss: 0.807 Test Acc: 0.768
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.4614760875701904
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.809 Vali Acc: 0.775 Test Loss: 0.809 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.226339340209961
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.817 Vali Acc: 0.768 Test Loss: 0.817 Test Acc: 0.768
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.013221502304077
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.812 Vali Acc: 0.768 Test Loss: 0.812 Test Acc: 0.768
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.9117891788482666
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.811 Vali Acc: 0.768 Test Loss: 0.811 Test Acc: 0.768
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.970276117324829
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.811 Vali Acc: 0.761 Test Loss: 0.811 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7753623188405797
model parameter : 4420100
model size : 26.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.690274953842163
Epoch: 1, Steps: 9 | Train Loss: 1.438 Vali Loss: 1.398 Vali Acc: 0.297 Test Loss: 1.398 Test Acc: 0.297
Validation loss decreased (inf --> -0.297087).  Saving model ...
Epoch: 2 cost time: 3.299713611602783
Epoch: 2, Steps: 9 | Train Loss: 1.091 Vali Loss: 1.258 Vali Acc: 0.428 Test Loss: 1.258 Test Acc: 0.428
Validation loss decreased (-0.297087 --> -0.427524).  Saving model ...
Epoch: 3 cost time: 3.212270736694336
Epoch: 3, Steps: 9 | Train Loss: 0.714 Vali Loss: 1.225 Vali Acc: 0.420 Test Loss: 1.225 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.53950572013855
Epoch: 4, Steps: 9 | Train Loss: 0.413 Vali Loss: 1.178 Vali Acc: 0.514 Test Loss: 1.178 Test Acc: 0.514
Validation loss decreased (-0.427524 --> -0.514481).  Saving model ...
Epoch: 5 cost time: 3.1413681507110596
Epoch: 5, Steps: 9 | Train Loss: 0.241 Vali Loss: 1.404 Vali Acc: 0.406 Test Loss: 1.404 Test Acc: 0.406
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.069133758544922
Epoch: 6, Steps: 9 | Train Loss: 0.111 Vali Loss: 1.431 Vali Acc: 0.493 Test Loss: 1.431 Test Acc: 0.493
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.0680015087127686
Epoch: 7, Steps: 9 | Train Loss: 0.055 Vali Loss: 1.566 Vali Acc: 0.464 Test Loss: 1.566 Test Acc: 0.464
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.0895040035247803
Epoch: 8, Steps: 9 | Train Loss: 0.023 Vali Loss: 1.514 Vali Acc: 0.486 Test Loss: 1.514 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.109313726425171
Epoch: 9, Steps: 9 | Train Loss: 0.010 Vali Loss: 1.627 Vali Acc: 0.522 Test Loss: 1.627 Test Acc: 0.522
Validation loss decreased (-0.514481 --> -0.521723).  Saving model ...
Epoch: 10 cost time: 3.2646493911743164
Epoch: 10, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.732 Vali Acc: 0.493 Test Loss: 1.732 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.4205965995788574
Epoch: 11, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.645 Vali Acc: 0.507 Test Loss: 1.645 Test Acc: 0.507
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.5922210216522217
Epoch: 12, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.468 Vali Acc: 0.529 Test Loss: 1.468 Test Acc: 0.529
Validation loss decreased (-0.521723 --> -0.528971).  Saving model ...
Epoch: 13 cost time: 3.7203378677368164
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.492 Vali Acc: 0.536 Test Loss: 1.492 Test Acc: 0.536
Validation loss decreased (-0.528971 --> -0.536217).  Saving model ...
Epoch: 14 cost time: 3.6603424549102783
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.561 Vali Acc: 0.514 Test Loss: 1.561 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.246656656265259
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.528 Vali Acc: 0.536 Test Loss: 1.528 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.159435510635376
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.528 Vali Acc: 0.522 Test Loss: 1.528 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.883370876312256
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.533 Vali Acc: 0.536 Test Loss: 1.533 Test Acc: 0.536
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.036285161972046
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.509 Vali Acc: 0.543 Test Loss: 1.509 Test Acc: 0.543
Validation loss decreased (-0.536217 --> -0.543463).  Saving model ...
Epoch: 19 cost time: 3.3636579513549805
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.539 Vali Acc: 0.543 Test Loss: 1.539 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.443570852279663
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.532 Vali Acc: 0.543 Test Loss: 1.532 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.4828498363494873
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.493 Vali Acc: 0.565 Test Loss: 1.493 Test Acc: 0.565
Validation loss decreased (-0.543463 --> -0.565202).  Saving model ...
Epoch: 22 cost time: 3.260348081588745
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.518 Vali Acc: 0.551 Test Loss: 1.518 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.166084051132202
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.500 Vali Acc: 0.565 Test Loss: 1.500 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.0307061672210693
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.481 Vali Acc: 0.594 Test Loss: 1.481 Test Acc: 0.594
Validation loss decreased (-0.565202 --> -0.594188).  Saving model ...
Epoch: 25 cost time: 2.9747836589813232
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.480 Vali Acc: 0.587 Test Loss: 1.480 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.129038095474243
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.493 Vali Acc: 0.580 Test Loss: 1.493 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.3701064586639404
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.459 Vali Acc: 0.601 Test Loss: 1.459 Test Acc: 0.601
Validation loss decreased (-0.594188 --> -0.601435).  Saving model ...
Epoch: 28 cost time: 3.480922222137451
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.446 Vali Acc: 0.601 Test Loss: 1.446 Test Acc: 0.601
Validation loss decreased (-0.601435 --> -0.601435).  Saving model ...
Epoch: 29 cost time: 3.4851367473602295
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.440 Vali Acc: 0.601 Test Loss: 1.440 Test Acc: 0.601
Validation loss decreased (-0.601435 --> -0.601435).  Saving model ...
Epoch: 30 cost time: 3.557878255844116
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.424 Vali Acc: 0.601 Test Loss: 1.424 Test Acc: 0.601
Validation loss decreased (-0.601435 --> -0.601435).  Saving model ...
Epoch: 31 cost time: 3.483321189880371
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.448 Vali Acc: 0.601 Test Loss: 1.448 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.5728249549865723
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.477 Vali Acc: 0.594 Test Loss: 1.477 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.223329544067383
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.454 Vali Acc: 0.601 Test Loss: 1.454 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.2194302082061768
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.426 Vali Acc: 0.601 Test Loss: 1.426 Test Acc: 0.601
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.355015754699707
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.425 Vali Acc: 0.601 Test Loss: 1.425 Test Acc: 0.601
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.182981014251709
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.445 Vali Acc: 0.594 Test Loss: 1.445 Test Acc: 0.594
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.5003647804260254
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.443 Vali Acc: 0.594 Test Loss: 1.443 Test Acc: 0.594
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.353771686553955
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.428 Vali Acc: 0.609 Test Loss: 1.428 Test Acc: 0.609
Validation loss decreased (-0.601435 --> -0.608681).  Saving model ...
Epoch: 39 cost time: 3.276724100112915
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.428 Vali Acc: 0.616 Test Loss: 1.428 Test Acc: 0.616
Validation loss decreased (-0.608681 --> -0.615928).  Saving model ...
Epoch: 40 cost time: 3.329455614089966
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.439 Vali Acc: 0.616 Test Loss: 1.439 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.5590100288391113
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.446 Vali Acc: 0.609 Test Loss: 1.446 Test Acc: 0.609
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.4739291667938232
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.413 Vali Acc: 0.623 Test Loss: 1.413 Test Acc: 0.623
Validation loss decreased (-0.615928 --> -0.623174).  Saving model ...
Epoch: 43 cost time: 3.190781831741333
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.401 Vali Acc: 0.616 Test Loss: 1.401 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.9898407459259033
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.404 Vali Acc: 0.616 Test Loss: 1.404 Test Acc: 0.616
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.990727663040161
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.413 Vali Acc: 0.623 Test Loss: 1.413 Test Acc: 0.623
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 2.980945110321045
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.423 Vali Acc: 0.623 Test Loss: 1.423 Test Acc: 0.623
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 3.1789839267730713
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.431 Vali Acc: 0.623 Test Loss: 1.431 Test Acc: 0.623
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 3.3515987396240234
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.418 Vali Acc: 0.623 Test Loss: 1.418 Test Acc: 0.623
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 3.5846142768859863
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.405 Vali Acc: 0.623 Test Loss: 1.405 Test Acc: 0.623
Validation loss decreased (-0.623174 --> -0.623174).  Saving model ...
Epoch: 50 cost time: 3.288301467895508
Epoch: 50, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.407 Vali Acc: 0.623 Test Loss: 1.407 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 3.5872626304626465
Epoch: 51, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.402 Vali Acc: 0.623 Test Loss: 1.402 Test Acc: 0.623
Validation loss decreased (-0.623174 --> -0.623174).  Saving model ...
Epoch: 52 cost time: 3.1492631435394287
Epoch: 52, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.407 Vali Acc: 0.623 Test Loss: 1.407 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 3.3083372116088867
Epoch: 53, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.413 Vali Acc: 0.623 Test Loss: 1.413 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 3.131207227706909
Epoch: 54, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.421 Vali Acc: 0.623 Test Loss: 1.421 Test Acc: 0.623
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 3.1651480197906494
Epoch: 55, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.431 Vali Acc: 0.623 Test Loss: 1.431 Test Acc: 0.623
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 3.4121203422546387
Epoch: 56, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.433 Vali Acc: 0.623 Test Loss: 1.433 Test Acc: 0.623
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 3.41412091255188
Epoch: 57, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.428 Vali Acc: 0.630 Test Loss: 1.428 Test Acc: 0.630
Validation loss decreased (-0.623174 --> -0.630421).  Saving model ...
Epoch: 58 cost time: 3.5816867351531982
Epoch: 58, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.416 Vali Acc: 0.630 Test Loss: 1.416 Test Acc: 0.630
Validation loss decreased (-0.630421 --> -0.630421).  Saving model ...
Epoch: 59 cost time: 3.4210591316223145
Epoch: 59, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.412 Vali Acc: 0.630 Test Loss: 1.412 Test Acc: 0.630
Validation loss decreased (-0.630421 --> -0.630421).  Saving model ...
Epoch: 60 cost time: 3.462307929992676
Epoch: 60, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.420 Vali Acc: 0.630 Test Loss: 1.420 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 3.4100582599639893
Epoch: 61, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.432 Vali Acc: 0.630 Test Loss: 1.432 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 3.2671680450439453
Epoch: 62, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.445 Vali Acc: 0.630 Test Loss: 1.445 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 3.231295108795166
Epoch: 63, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.444 Vali Acc: 0.630 Test Loss: 1.444 Test Acc: 0.630
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 3.242523431777954
Epoch: 64, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.439 Vali Acc: 0.630 Test Loss: 1.439 Test Acc: 0.630
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 3.2960288524627686
Epoch: 65, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.436 Vali Acc: 0.630 Test Loss: 1.436 Test Acc: 0.630
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 3.291701316833496
Epoch: 66, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.433 Vali Acc: 0.630 Test Loss: 1.433 Test Acc: 0.630
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 3.542477607727051
Epoch: 67, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.426 Vali Acc: 0.638 Test Loss: 1.426 Test Acc: 0.638
Validation loss decreased (-0.630421 --> -0.637667).  Saving model ...
Epoch: 68 cost time: 3.511073350906372
Epoch: 68, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.425 Vali Acc: 0.638 Test Loss: 1.425 Test Acc: 0.638
Validation loss decreased (-0.637667 --> -0.637667).  Saving model ...
Epoch: 69 cost time: 3.1827878952026367
Epoch: 69, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.418 Vali Acc: 0.638 Test Loss: 1.418 Test Acc: 0.638
Validation loss decreased (-0.637667 --> -0.637667).  Saving model ...
Epoch: 70 cost time: 3.286285400390625
Epoch: 70, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.414 Vali Acc: 0.638 Test Loss: 1.414 Test Acc: 0.638
Validation loss decreased (-0.637667 --> -0.637667).  Saving model ...
Epoch: 71 cost time: 2.9771456718444824
Epoch: 71, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.416 Vali Acc: 0.638 Test Loss: 1.416 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 2.8832404613494873
Epoch: 72, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.420 Vali Acc: 0.638 Test Loss: 1.420 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 2.8893580436706543
Epoch: 73, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.423 Vali Acc: 0.638 Test Loss: 1.423 Test Acc: 0.638
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 2.9910008907318115
Epoch: 74, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.425 Vali Acc: 0.638 Test Loss: 1.425 Test Acc: 0.638
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 3.019855260848999
Epoch: 75, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.422 Vali Acc: 0.638 Test Loss: 1.422 Test Acc: 0.638
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 2.9579296112060547
Epoch: 76, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.422 Vali Acc: 0.645 Test Loss: 1.422 Test Acc: 0.645
Validation loss decreased (-0.637667 --> -0.644913).  Saving model ...
Epoch: 77 cost time: 3.3854594230651855
Epoch: 77, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.425 Vali Acc: 0.638 Test Loss: 1.425 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 3.268872022628784
Epoch: 78, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.425 Vali Acc: 0.638 Test Loss: 1.425 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 3.463442325592041
Epoch: 79, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.426 Vali Acc: 0.645 Test Loss: 1.426 Test Acc: 0.645
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 3.4064748287200928
Epoch: 80, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.429 Vali Acc: 0.645 Test Loss: 1.429 Test Acc: 0.645
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 2.991811752319336
Epoch: 81, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.436 Vali Acc: 0.638 Test Loss: 1.436 Test Acc: 0.638
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 3.0129854679107666
Epoch: 82, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.437 Vali Acc: 0.645 Test Loss: 1.437 Test Acc: 0.645
EarlyStopping counter: 6 out of 10
Epoch: 83 cost time: 3.277841567993164
Epoch: 83, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.436 Vali Acc: 0.659 Test Loss: 1.436 Test Acc: 0.659
Validation loss decreased (-0.644913 --> -0.659406).  Saving model ...
Epoch: 84 cost time: 3.096301555633545
Epoch: 84, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.433 Vali Acc: 0.659 Test Loss: 1.433 Test Acc: 0.659
Validation loss decreased (-0.659406 --> -0.659406).  Saving model ...
Epoch: 85 cost time: 3.1489930152893066
Epoch: 85, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.430 Vali Acc: 0.659 Test Loss: 1.430 Test Acc: 0.659
Validation loss decreased (-0.659406 --> -0.659406).  Saving model ...
Epoch: 86 cost time: 3.546135187149048
Epoch: 86, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.431 Vali Acc: 0.659 Test Loss: 1.431 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 3.336642026901245
Epoch: 87, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.436 Vali Acc: 0.659 Test Loss: 1.436 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 3.410902261734009
Epoch: 88, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.442 Vali Acc: 0.659 Test Loss: 1.442 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 3.4230785369873047
Epoch: 89, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.448 Vali Acc: 0.652 Test Loss: 1.448 Test Acc: 0.652
EarlyStopping counter: 4 out of 10
Epoch: 90 cost time: 3.2523889541625977
Epoch: 90, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.450 Vali Acc: 0.652 Test Loss: 1.450 Test Acc: 0.652
EarlyStopping counter: 5 out of 10
Epoch: 91 cost time: 3.1807031631469727
Epoch: 91, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.451 Vali Acc: 0.652 Test Loss: 1.451 Test Acc: 0.652
EarlyStopping counter: 6 out of 10
Epoch: 92 cost time: 3.156921148300171
Epoch: 92, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.452 Vali Acc: 0.659 Test Loss: 1.452 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 93 cost time: 2.974175453186035
Epoch: 93, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.451 Vali Acc: 0.667 Test Loss: 1.451 Test Acc: 0.667
Validation loss decreased (-0.659406 --> -0.666652).  Saving model ...
Epoch: 94 cost time: 3.1744790077209473
Epoch: 94, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.453 Vali Acc: 0.667 Test Loss: 1.453 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 3.3003134727478027
Epoch: 95, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.458 Vali Acc: 0.667 Test Loss: 1.458 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 3.295891523361206
Epoch: 96, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.462 Vali Acc: 0.667 Test Loss: 1.462 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 97 cost time: 3.4158987998962402
Epoch: 97, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.459 Vali Acc: 0.667 Test Loss: 1.459 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 98 cost time: 3.379974365234375
Epoch: 98, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.457 Vali Acc: 0.667 Test Loss: 1.457 Test Acc: 0.667
EarlyStopping counter: 5 out of 10
Epoch: 99 cost time: 3.322575807571411
Epoch: 99, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.456 Vali Acc: 0.674 Test Loss: 1.456 Test Acc: 0.674
Validation loss decreased (-0.666652 --> -0.673898).  Saving model ...
Epoch: 100 cost time: 2.997007369995117
Epoch: 100, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.456 Vali Acc: 0.681 Test Loss: 1.456 Test Acc: 0.681
Validation loss decreased (-0.673898 --> -0.681145).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.6811594202898551
model parameter : 4420100
model size : 26.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.697345733642578
Epoch: 1, Steps: 9 | Train Loss: 1.459 Vali Loss: 1.444 Vali Acc: 0.254 Test Loss: 1.444 Test Acc: 0.254
Validation loss decreased (inf --> -0.253609).  Saving model ...
Epoch: 2 cost time: 3.4634077548980713
Epoch: 2, Steps: 9 | Train Loss: 1.194 Vali Loss: 1.512 Vali Acc: 0.283 Test Loss: 1.512 Test Acc: 0.283
Validation loss decreased (-0.253609 --> -0.282594).  Saving model ...
Epoch: 3 cost time: 3.1469614505767822
Epoch: 3, Steps: 9 | Train Loss: 0.979 Vali Loss: 1.541 Vali Acc: 0.312 Test Loss: 1.541 Test Acc: 0.312
Validation loss decreased (-0.282594 --> -0.311579).  Saving model ...
Epoch: 4 cost time: 3.256220817565918
Epoch: 4, Steps: 9 | Train Loss: 0.652 Vali Loss: 1.683 Vali Acc: 0.304 Test Loss: 1.683 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.1651060581207275
Epoch: 5, Steps: 9 | Train Loss: 0.387 Vali Loss: 2.082 Vali Acc: 0.312 Test Loss: 2.082 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.0156733989715576
Epoch: 6, Steps: 9 | Train Loss: 0.218 Vali Loss: 2.690 Vali Acc: 0.304 Test Loss: 2.690 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.2860114574432373
Epoch: 7, Steps: 9 | Train Loss: 0.125 Vali Loss: 2.682 Vali Acc: 0.304 Test Loss: 2.682 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.2676644325256348
Epoch: 8, Steps: 9 | Train Loss: 0.061 Vali Loss: 2.927 Vali Acc: 0.312 Test Loss: 2.927 Test Acc: 0.312
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.3924474716186523
Epoch: 9, Steps: 9 | Train Loss: 0.029 Vali Loss: 2.864 Vali Acc: 0.341 Test Loss: 2.864 Test Acc: 0.341
Validation loss decreased (-0.311579 --> -0.340551).  Saving model ...
Epoch: 10 cost time: 3.5466067790985107
Epoch: 10, Steps: 9 | Train Loss: 0.013 Vali Loss: 2.946 Vali Acc: 0.333 Test Loss: 2.946 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.4003922939300537
Epoch: 11, Steps: 9 | Train Loss: 0.008 Vali Loss: 2.630 Vali Acc: 0.341 Test Loss: 2.630 Test Acc: 0.341
Validation loss decreased (-0.340551 --> -0.340553).  Saving model ...
Epoch: 12 cost time: 3.418086051940918
Epoch: 12, Steps: 9 | Train Loss: 0.004 Vali Loss: 2.832 Vali Acc: 0.362 Test Loss: 2.832 Test Acc: 0.362
Validation loss decreased (-0.340553 --> -0.362291).  Saving model ...
Epoch: 13 cost time: 3.3973817825317383
Epoch: 13, Steps: 9 | Train Loss: 0.003 Vali Loss: 2.991 Vali Acc: 0.370 Test Loss: 2.991 Test Acc: 0.370
Validation loss decreased (-0.362291 --> -0.369535).  Saving model ...
Epoch: 14 cost time: 2.893404960632324
Epoch: 14, Steps: 9 | Train Loss: 0.003 Vali Loss: 2.874 Vali Acc: 0.377 Test Loss: 2.874 Test Acc: 0.377
Validation loss decreased (-0.369535 --> -0.376783).  Saving model ...
Epoch: 15 cost time: 2.955533504486084
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.667 Vali Acc: 0.391 Test Loss: 2.667 Test Acc: 0.391
Validation loss decreased (-0.376783 --> -0.391278).  Saving model ...
Epoch: 16 cost time: 2.9674177169799805
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.698 Vali Acc: 0.370 Test Loss: 2.698 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.885446071624756
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.763 Vali Acc: 0.391 Test Loss: 2.763 Test Acc: 0.391
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.2510335445404053
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.848 Vali Acc: 0.391 Test Loss: 2.848 Test Acc: 0.391
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.2181477546691895
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.727 Vali Acc: 0.399 Test Loss: 2.727 Test Acc: 0.399
Validation loss decreased (-0.391278 --> -0.398523).  Saving model ...
Epoch: 20 cost time: 3.276646852493286
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.734 Vali Acc: 0.399 Test Loss: 2.734 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.1889255046844482
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.761 Vali Acc: 0.413 Test Loss: 2.761 Test Acc: 0.413
Validation loss decreased (-0.398523 --> -0.413016).  Saving model ...
Epoch: 22 cost time: 2.9785194396972656
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.798 Vali Acc: 0.420 Test Loss: 2.798 Test Acc: 0.420
Validation loss decreased (-0.413016 --> -0.420262).  Saving model ...
Epoch: 23 cost time: 3.0905842781066895
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.864 Vali Acc: 0.413 Test Loss: 2.864 Test Acc: 0.413
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.06760573387146
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.833 Vali Acc: 0.428 Test Loss: 2.833 Test Acc: 0.428
Validation loss decreased (-0.420262 --> -0.427508).  Saving model ...
Epoch: 25 cost time: 3.5087461471557617
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.836 Vali Acc: 0.428 Test Loss: 2.836 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.214026689529419
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.868 Vali Acc: 0.406 Test Loss: 2.868 Test Acc: 0.406
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.1160271167755127
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.806 Vali Acc: 0.413 Test Loss: 2.806 Test Acc: 0.413
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.5331783294677734
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.750 Vali Acc: 0.406 Test Loss: 2.750 Test Acc: 0.406
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.4322617053985596
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.744 Vali Acc: 0.420 Test Loss: 2.744 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.40268874168396
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.729 Vali Acc: 0.420 Test Loss: 2.729 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.338685989379883
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.759 Vali Acc: 0.406 Test Loss: 2.759 Test Acc: 0.406
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.461277961730957
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.787 Vali Acc: 0.406 Test Loss: 2.787 Test Acc: 0.406
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.9761555194854736
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.775 Vali Acc: 0.413 Test Loss: 2.775 Test Acc: 0.413
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.1328792572021484
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.800 Vali Acc: 0.406 Test Loss: 2.800 Test Acc: 0.406
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.427536231884058
model parameter : 4420100
model size : 26.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.000332593917847
Epoch: 1, Steps: 9 | Train Loss: 1.438 Vali Loss: 1.408 Vali Acc: 0.268 Test Loss: 1.408 Test Acc: 0.268
Validation loss decreased (inf --> -0.268102).  Saving model ...
Epoch: 2 cost time: 3.4408700466156006
Epoch: 2, Steps: 9 | Train Loss: 1.214 Vali Loss: 1.368 Vali Acc: 0.290 Test Loss: 1.368 Test Acc: 0.290
Validation loss decreased (-0.268102 --> -0.289841).  Saving model ...
Epoch: 3 cost time: 3.2608211040496826
Epoch: 3, Steps: 9 | Train Loss: 0.897 Vali Loss: 1.321 Vali Acc: 0.290 Test Loss: 1.321 Test Acc: 0.290
Validation loss decreased (-0.289841 --> -0.289842).  Saving model ...
Epoch: 4 cost time: 3.3674583435058594
Epoch: 4, Steps: 9 | Train Loss: 0.571 Vali Loss: 1.249 Vali Acc: 0.391 Test Loss: 1.249 Test Acc: 0.391
Validation loss decreased (-0.289842 --> -0.391292).  Saving model ...
Epoch: 5 cost time: 3.571910858154297
Epoch: 5, Steps: 9 | Train Loss: 0.333 Vali Loss: 1.557 Vali Acc: 0.297 Test Loss: 1.557 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.50626540184021
Epoch: 6, Steps: 9 | Train Loss: 0.159 Vali Loss: 1.568 Vali Acc: 0.362 Test Loss: 1.568 Test Acc: 0.362
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.1233856678009033
Epoch: 7, Steps: 9 | Train Loss: 0.083 Vali Loss: 1.585 Vali Acc: 0.370 Test Loss: 1.585 Test Acc: 0.370
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.291095018386841
Epoch: 8, Steps: 9 | Train Loss: 0.037 Vali Loss: 1.966 Vali Acc: 0.391 Test Loss: 1.966 Test Acc: 0.391
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.0985310077667236
Epoch: 9, Steps: 9 | Train Loss: 0.019 Vali Loss: 1.770 Vali Acc: 0.362 Test Loss: 1.770 Test Acc: 0.362
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.937288284301758
Epoch: 10, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.784 Vali Acc: 0.370 Test Loss: 1.784 Test Acc: 0.370
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.302480697631836
Epoch: 11, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.839 Vali Acc: 0.406 Test Loss: 1.839 Test Acc: 0.406
Validation loss decreased (-0.391292 --> -0.405779).  Saving model ...
Epoch: 12 cost time: 3.3398349285125732
Epoch: 12, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.805 Vali Acc: 0.391 Test Loss: 1.805 Test Acc: 0.391
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.377023696899414
Epoch: 13, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.793 Vali Acc: 0.428 Test Loss: 1.793 Test Acc: 0.428
Validation loss decreased (-0.405779 --> -0.427518).  Saving model ...
Epoch: 14 cost time: 3.4184584617614746
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.754 Vali Acc: 0.428 Test Loss: 1.754 Test Acc: 0.428
Validation loss decreased (-0.427518 --> -0.427519).  Saving model ...
Epoch: 15 cost time: 3.404996871948242
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.721 Vali Acc: 0.449 Test Loss: 1.721 Test Acc: 0.449
Validation loss decreased (-0.427519 --> -0.449258).  Saving model ...
Epoch: 16 cost time: 3.559086322784424
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.734 Vali Acc: 0.457 Test Loss: 1.734 Test Acc: 0.457
Validation loss decreased (-0.449258 --> -0.456504).  Saving model ...
Epoch: 17 cost time: 3.1789181232452393
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.714 Vali Acc: 0.457 Test Loss: 1.714 Test Acc: 0.457
Validation loss decreased (-0.456504 --> -0.456505).  Saving model ...
Epoch: 18 cost time: 3.0850939750671387
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.706 Vali Acc: 0.457 Test Loss: 1.706 Test Acc: 0.457
Validation loss decreased (-0.456505 --> -0.456505).  Saving model ...
Epoch: 19 cost time: 3.133087396621704
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.679 Vali Acc: 0.457 Test Loss: 1.679 Test Acc: 0.457
Validation loss decreased (-0.456505 --> -0.456505).  Saving model ...
Epoch: 20 cost time: 3.4611616134643555
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.683 Vali Acc: 0.464 Test Loss: 1.683 Test Acc: 0.464
Validation loss decreased (-0.456505 --> -0.463751).  Saving model ...
Epoch: 21 cost time: 3.203035831451416
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.674 Vali Acc: 0.464 Test Loss: 1.674 Test Acc: 0.464
Validation loss decreased (-0.463751 --> -0.463751).  Saving model ...
Epoch: 22 cost time: 3.197230100631714
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.698 Vali Acc: 0.457 Test Loss: 1.698 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.248349666595459
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.727 Vali Acc: 0.471 Test Loss: 1.727 Test Acc: 0.471
Validation loss decreased (-0.463751 --> -0.470997).  Saving model ...
Epoch: 24 cost time: 3.1567161083221436
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.692 Vali Acc: 0.486 Test Loss: 1.692 Test Acc: 0.486
Validation loss decreased (-0.470997 --> -0.485490).  Saving model ...
Epoch: 25 cost time: 3.1700148582458496
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.668 Vali Acc: 0.478 Test Loss: 1.668 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.9634745121002197
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.671 Vali Acc: 0.478 Test Loss: 1.671 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.9556081295013428
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.654 Vali Acc: 0.486 Test Loss: 1.654 Test Acc: 0.486
Validation loss decreased (-0.485490 --> -0.485491).  Saving model ...
Epoch: 28 cost time: 3.0455331802368164
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.630 Vali Acc: 0.500 Test Loss: 1.630 Test Acc: 0.500
Validation loss decreased (-0.485491 --> -0.499984).  Saving model ...
Epoch: 29 cost time: 3.3970792293548584
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.645 Vali Acc: 0.507 Test Loss: 1.645 Test Acc: 0.507
Validation loss decreased (-0.499984 --> -0.507230).  Saving model ...
Epoch: 30 cost time: 3.1304101943969727
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.655 Vali Acc: 0.507 Test Loss: 1.655 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.2387356758117676
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.686 Vali Acc: 0.500 Test Loss: 1.686 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.219114065170288
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.700 Vali Acc: 0.500 Test Loss: 1.700 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.212210178375244
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.661 Vali Acc: 0.507 Test Loss: 1.661 Test Acc: 0.507
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.942115068435669
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.633 Vali Acc: 0.536 Test Loss: 1.633 Test Acc: 0.536
Validation loss decreased (-0.507230 --> -0.536216).  Saving model ...
Epoch: 35 cost time: 2.957608938217163
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.644 Vali Acc: 0.536 Test Loss: 1.644 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.7389585971832275
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.672 Vali Acc: 0.522 Test Loss: 1.672 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.1562774181365967
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.683 Vali Acc: 0.522 Test Loss: 1.683 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.899989366531372
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.676 Vali Acc: 0.536 Test Loss: 1.676 Test Acc: 0.536
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.3578989505767822
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.682 Vali Acc: 0.536 Test Loss: 1.682 Test Acc: 0.536
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.29876971244812
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.681 Vali Acc: 0.551 Test Loss: 1.681 Test Acc: 0.551
Validation loss decreased (-0.536216 --> -0.550708).  Saving model ...
Epoch: 41 cost time: 3.815391778945923
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.687 Vali Acc: 0.551 Test Loss: 1.687 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.542478561401367
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.683 Vali Acc: 0.551 Test Loss: 1.683 Test Acc: 0.551
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.776855945587158
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.680 Vali Acc: 0.551 Test Loss: 1.680 Test Acc: 0.551
Validation loss decreased (-0.550708 --> -0.550708).  Saving model ...
Epoch: 44 cost time: 3.589921474456787
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.683 Vali Acc: 0.543 Test Loss: 1.683 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.464550018310547
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.684 Vali Acc: 0.543 Test Loss: 1.684 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 3.347994565963745
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.688 Vali Acc: 0.551 Test Loss: 1.688 Test Acc: 0.551
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 3.520268201828003
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.692 Vali Acc: 0.558 Test Loss: 1.692 Test Acc: 0.558
Validation loss decreased (-0.550708 --> -0.557954).  Saving model ...
Epoch: 48 cost time: 3.1524507999420166
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.695 Vali Acc: 0.543 Test Loss: 1.695 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.496432065963745
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.702 Vali Acc: 0.536 Test Loss: 1.702 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 3.245548725128174
Epoch: 50, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.710 Vali Acc: 0.536 Test Loss: 1.710 Test Acc: 0.536
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 3.242842197418213
Epoch: 51, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.716 Vali Acc: 0.536 Test Loss: 1.716 Test Acc: 0.536
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 3.228686809539795
Epoch: 52, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.725 Vali Acc: 0.551 Test Loss: 1.725 Test Acc: 0.551
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 3.176527261734009
Epoch: 53, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.741 Vali Acc: 0.536 Test Loss: 1.741 Test Acc: 0.536
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 3.117995262145996
Epoch: 54, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.747 Vali Acc: 0.536 Test Loss: 1.747 Test Acc: 0.536
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 3.489149332046509
Epoch: 55, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.762 Vali Acc: 0.543 Test Loss: 1.762 Test Acc: 0.543
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 3.1331100463867188
Epoch: 56, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.773 Vali Acc: 0.551 Test Loss: 1.773 Test Acc: 0.551
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 3.351485013961792
Epoch: 57, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.774 Vali Acc: 0.551 Test Loss: 1.774 Test Acc: 0.551
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5579710144927537
model parameter : 4420100
model size : 26.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         103                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df512_ma103_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.2913854122161865
Epoch: 1, Steps: 9 | Train Loss: 1.361 Vali Loss: 1.224 Vali Acc: 0.435 Test Loss: 1.224 Test Acc: 0.435
Validation loss decreased (inf --> -0.434770).  Saving model ...
Epoch: 2 cost time: 3.279973030090332
Epoch: 2, Steps: 9 | Train Loss: 0.992 Vali Loss: 0.975 Vali Acc: 0.616 Test Loss: 0.975 Test Acc: 0.616
Validation loss decreased (-0.434770 --> -0.615932).  Saving model ...
Epoch: 3 cost time: 3.1846396923065186
Epoch: 3, Steps: 9 | Train Loss: 0.478 Vali Loss: 0.753 Vali Acc: 0.739 Test Loss: 0.753 Test Acc: 0.739
Validation loss decreased (-0.615932 --> -0.739123).  Saving model ...
Epoch: 4 cost time: 3.2998218536376953
Epoch: 4, Steps: 9 | Train Loss: 0.211 Vali Loss: 0.718 Vali Acc: 0.739 Test Loss: 0.718 Test Acc: 0.739
Validation loss decreased (-0.739123 --> -0.739123).  Saving model ...
Epoch: 5 cost time: 3.398742914199829
Epoch: 5, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.775 Vali Acc: 0.739 Test Loss: 0.775 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.484663724899292
Epoch: 6, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.607 Vali Acc: 0.775 Test Loss: 0.607 Test Acc: 0.775
Validation loss decreased (-0.739123 --> -0.775356).  Saving model ...
Epoch: 7 cost time: 3.510100841522217
Epoch: 7, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.878 Vali Acc: 0.761 Test Loss: 0.878 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.3284218311309814
Epoch: 8, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.653 Vali Acc: 0.783 Test Loss: 0.653 Test Acc: 0.783
Validation loss decreased (-0.775356 --> -0.782602).  Saving model ...
Epoch: 9 cost time: 3.3343539237976074
Epoch: 9, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.624 Vali Acc: 0.797 Test Loss: 0.624 Test Acc: 0.797
Validation loss decreased (-0.782602 --> -0.797095).  Saving model ...
Epoch: 10 cost time: 3.6605026721954346
Epoch: 10, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.713 Vali Acc: 0.797 Test Loss: 0.713 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.543774127960205
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.730 Vali Acc: 0.768 Test Loss: 0.730 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.7708685398101807
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.715 Vali Acc: 0.775 Test Loss: 0.715 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.7587647438049316
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.703 Vali Acc: 0.775 Test Loss: 0.703 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.6736297607421875
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.696 Vali Acc: 0.790 Test Loss: 0.696 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.5608267784118652
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.693 Vali Acc: 0.790 Test Loss: 0.693 Test Acc: 0.790
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.4367029666900635
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.699 Vali Acc: 0.790 Test Loss: 0.699 Test Acc: 0.790
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.692640781402588
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.701 Vali Acc: 0.783 Test Loss: 0.701 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.4620285034179688
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.701 Vali Acc: 0.783 Test Loss: 0.701 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.3859729766845703
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.700 Vali Acc: 0.790 Test Loss: 0.700 Test Acc: 0.790
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df512_ma103_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7971014492753623
model parameter : 3633668
model size : 23.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         83                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df512_ma83_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.996883153915405
Epoch: 1, Steps: 9 | Train Loss: 1.335 Vali Loss: 1.210 Vali Acc: 0.486 Test Loss: 1.210 Test Acc: 0.486
Validation loss decreased (inf --> -0.485495).  Saving model ...
Epoch: 2 cost time: 3.1840007305145264
Epoch: 2, Steps: 9 | Train Loss: 0.977 Vali Loss: 0.949 Vali Acc: 0.630 Test Loss: 0.949 Test Acc: 0.630
Validation loss decreased (-0.485495 --> -0.630425).  Saving model ...
Epoch: 3 cost time: 3.2332375049591064
Epoch: 3, Steps: 9 | Train Loss: 0.486 Vali Loss: 0.744 Vali Acc: 0.717 Test Loss: 0.744 Test Acc: 0.717
Validation loss decreased (-0.630425 --> -0.717384).  Saving model ...
Epoch: 4 cost time: 3.41060209274292
Epoch: 4, Steps: 9 | Train Loss: 0.212 Vali Loss: 0.714 Vali Acc: 0.746 Test Loss: 0.714 Test Acc: 0.746
Validation loss decreased (-0.717384 --> -0.746370).  Saving model ...
Epoch: 5 cost time: 3.424753189086914
Epoch: 5, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.717 Vali Acc: 0.717 Test Loss: 0.717 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.315195322036743
Epoch: 6, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.561 Vali Acc: 0.797 Test Loss: 0.561 Test Acc: 0.797
Validation loss decreased (-0.746370 --> -0.797096).  Saving model ...
Epoch: 7 cost time: 3.159208059310913
Epoch: 7, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.840 Vali Acc: 0.775 Test Loss: 0.840 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.3684334754943848
Epoch: 8, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.610 Vali Acc: 0.775 Test Loss: 0.610 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.223863124847412
Epoch: 9, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.588 Vali Acc: 0.812 Test Loss: 0.588 Test Acc: 0.812
Validation loss decreased (-0.797096 --> -0.811588).  Saving model ...
Epoch: 10 cost time: 3.229530096054077
Epoch: 10, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.689 Vali Acc: 0.797 Test Loss: 0.689 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.387301206588745
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.651 Vali Acc: 0.812 Test Loss: 0.651 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.3319671154022217
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.646 Vali Acc: 0.812 Test Loss: 0.646 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.167496681213379
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.655 Vali Acc: 0.812 Test Loss: 0.655 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.6579205989837646
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.659 Vali Acc: 0.812 Test Loss: 0.659 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.446272611618042
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.655 Vali Acc: 0.812 Test Loss: 0.655 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.1564347743988037
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.658 Vali Acc: 0.804 Test Loss: 0.658 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.5113463401794434
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.654 Vali Acc: 0.804 Test Loss: 0.654 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.326295852661133
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.655 Vali Acc: 0.804 Test Loss: 0.655 Test Acc: 0.804
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.420196533203125
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.662 Vali Acc: 0.826 Test Loss: 0.662 Test Acc: 0.826
Validation loss decreased (-0.811588 --> -0.826080).  Saving model ...
Epoch: 20 cost time: 3.5764403343200684
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.666 Vali Acc: 0.826 Test Loss: 0.666 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.4169254302978516
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.662 Vali Acc: 0.826 Test Loss: 0.662 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.302980661392212
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.663 Vali Acc: 0.826 Test Loss: 0.663 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.3221447467803955
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.658 Vali Acc: 0.826 Test Loss: 0.658 Test Acc: 0.826
Validation loss decreased (-0.826080 --> -0.826080).  Saving model ...
Epoch: 24 cost time: 3.2908148765563965
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.650 Vali Acc: 0.833 Test Loss: 0.650 Test Acc: 0.833
Validation loss decreased (-0.826080 --> -0.833327).  Saving model ...
Epoch: 25 cost time: 3.520625114440918
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.646 Vali Acc: 0.833 Test Loss: 0.646 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 26 cost time: 4.106621980667114
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.642 Vali Acc: 0.841 Test Loss: 0.642 Test Acc: 0.841
Validation loss decreased (-0.833327 --> -0.840573).  Saving model ...
Epoch: 27 cost time: 3.312337636947632
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.651 Vali Acc: 0.833 Test Loss: 0.651 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.578566789627075
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.657 Vali Acc: 0.848 Test Loss: 0.657 Test Acc: 0.848
Validation loss decreased (-0.840573 --> -0.847820).  Saving model ...
Epoch: 29 cost time: 3.5214715003967285
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.657 Vali Acc: 0.848 Test Loss: 0.657 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.5121004581451416
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.652 Vali Acc: 0.841 Test Loss: 0.652 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.671570301055908
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.652 Vali Acc: 0.833 Test Loss: 0.652 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.357029676437378
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.655 Vali Acc: 0.841 Test Loss: 0.655 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.559922695159912
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.658 Vali Acc: 0.848 Test Loss: 0.658 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.343076705932617
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.649 Vali Acc: 0.833 Test Loss: 0.649 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.301262855529785
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.657 Vali Acc: 0.841 Test Loss: 0.657 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 3.141775608062744
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.658 Vali Acc: 0.841 Test Loss: 0.658 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.3835535049438477
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.666 Vali Acc: 0.848 Test Loss: 0.666 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.7040786743164062
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.661 Vali Acc: 0.848 Test Loss: 0.661 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df512_ma83_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 3633668
model size : 23.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         62                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df512_ma62_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.288162708282471
Epoch: 1, Steps: 9 | Train Loss: 1.333 Vali Loss: 1.208 Vali Acc: 0.464 Test Loss: 1.208 Test Acc: 0.464
Validation loss decreased (inf --> -0.463756).  Saving model ...
Epoch: 2 cost time: 3.2944509983062744
Epoch: 2, Steps: 9 | Train Loss: 0.966 Vali Loss: 0.946 Vali Acc: 0.645 Test Loss: 0.946 Test Acc: 0.645
Validation loss decreased (-0.463756 --> -0.644918).  Saving model ...
Epoch: 3 cost time: 3.2727787494659424
Epoch: 3, Steps: 9 | Train Loss: 0.475 Vali Loss: 0.762 Vali Acc: 0.739 Test Loss: 0.762 Test Acc: 0.739
Validation loss decreased (-0.644918 --> -0.739123).  Saving model ...
Epoch: 4 cost time: 3.2543931007385254
Epoch: 4, Steps: 9 | Train Loss: 0.203 Vali Loss: 0.705 Vali Acc: 0.761 Test Loss: 0.705 Test Acc: 0.761
Validation loss decreased (-0.739123 --> -0.760863).  Saving model ...
Epoch: 5 cost time: 3.2345526218414307
Epoch: 5, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.745 Vali Acc: 0.761 Test Loss: 0.745 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.324903964996338
Epoch: 6, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.583 Vali Acc: 0.797 Test Loss: 0.583 Test Acc: 0.797
Validation loss decreased (-0.760863 --> -0.797096).  Saving model ...
Epoch: 7 cost time: 3.3935225009918213
Epoch: 7, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.748 Vali Acc: 0.790 Test Loss: 0.748 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.3489341735839844
Epoch: 8, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.668 Vali Acc: 0.812 Test Loss: 0.668 Test Acc: 0.812
Validation loss decreased (-0.797096 --> -0.811588).  Saving model ...
Epoch: 9 cost time: 3.438075065612793
Epoch: 9, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.580 Vali Acc: 0.877 Test Loss: 0.580 Test Acc: 0.877
Validation loss decreased (-0.811588 --> -0.876806).  Saving model ...
Epoch: 10 cost time: 3.392896890640259
Epoch: 10, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.612 Vali Acc: 0.855 Test Loss: 0.612 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.351550817489624
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.632 Vali Acc: 0.848 Test Loss: 0.632 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.3517208099365234
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.644 Vali Acc: 0.855 Test Loss: 0.644 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.2688305377960205
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.639 Vali Acc: 0.848 Test Loss: 0.639 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.4132080078125
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.634 Vali Acc: 0.848 Test Loss: 0.634 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.349757432937622
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.632 Vali Acc: 0.848 Test Loss: 0.632 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.210338830947876
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.636 Vali Acc: 0.855 Test Loss: 0.636 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.4743142127990723
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.628 Vali Acc: 0.855 Test Loss: 0.628 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.559809923171997
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.633 Vali Acc: 0.855 Test Loss: 0.633 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.3149449825286865
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.638 Vali Acc: 0.862 Test Loss: 0.638 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df512_ma62_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 3633668
model size : 23.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         42                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df512_ma42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.905908107757568
Epoch: 1, Steps: 9 | Train Loss: 1.324 Vali Loss: 1.164 Vali Acc: 0.507 Test Loss: 1.164 Test Acc: 0.507
Validation loss decreased (inf --> -0.507235).  Saving model ...
Epoch: 2 cost time: 3.253032684326172
Epoch: 2, Steps: 9 | Train Loss: 0.950 Vali Loss: 0.896 Vali Acc: 0.688 Test Loss: 0.896 Test Acc: 0.688
Validation loss decreased (-0.507235 --> -0.688397).  Saving model ...
Epoch: 3 cost time: 3.1277103424072266
Epoch: 3, Steps: 9 | Train Loss: 0.454 Vali Loss: 0.693 Vali Acc: 0.739 Test Loss: 0.693 Test Acc: 0.739
Validation loss decreased (-0.688397 --> -0.739124).  Saving model ...
Epoch: 4 cost time: 3.4295291900634766
Epoch: 4, Steps: 9 | Train Loss: 0.201 Vali Loss: 0.662 Vali Acc: 0.768 Test Loss: 0.662 Test Acc: 0.768
Validation loss decreased (-0.739124 --> -0.768109).  Saving model ...
Epoch: 5 cost time: 3.6236679553985596
Epoch: 5, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.625 Vali Acc: 0.790 Test Loss: 0.625 Test Acc: 0.790
Validation loss decreased (-0.768109 --> -0.789849).  Saving model ...
Epoch: 6 cost time: 3.3534295558929443
Epoch: 6, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.501 Vali Acc: 0.804 Test Loss: 0.501 Test Acc: 0.804
Validation loss decreased (-0.789849 --> -0.804343).  Saving model ...
Epoch: 7 cost time: 3.3947126865386963
Epoch: 7, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.661 Vali Acc: 0.797 Test Loss: 0.661 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.3154258728027344
Epoch: 8, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.629 Vali Acc: 0.797 Test Loss: 0.629 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.7016441822052
Epoch: 9, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.539 Vali Acc: 0.812 Test Loss: 0.539 Test Acc: 0.812
Validation loss decreased (-0.804343 --> -0.811589).  Saving model ...
Epoch: 10 cost time: 3.3269236087799072
Epoch: 10, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.554 Vali Acc: 0.804 Test Loss: 0.554 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.637925624847412
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.558 Vali Acc: 0.804 Test Loss: 0.558 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.2635364532470703
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.591 Vali Acc: 0.790 Test Loss: 0.591 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.6867640018463135
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.599 Vali Acc: 0.797 Test Loss: 0.599 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.5308480262756348
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.592 Vali Acc: 0.804 Test Loss: 0.592 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.3533544540405273
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.578 Vali Acc: 0.819 Test Loss: 0.578 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818835).  Saving model ...
Epoch: 16 cost time: 3.4753925800323486
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.580 Vali Acc: 0.804 Test Loss: 0.580 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.1815245151519775
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.571 Vali Acc: 0.819 Test Loss: 0.571 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818835).  Saving model ...
Epoch: 18 cost time: 3.832188844680786
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.579 Vali Acc: 0.819 Test Loss: 0.579 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.4632623195648193
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.586 Vali Acc: 0.812 Test Loss: 0.586 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.614886999130249
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.585 Vali Acc: 0.812 Test Loss: 0.585 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.382662773132324
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.589 Vali Acc: 0.812 Test Loss: 0.589 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.24514102935791
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.591 Vali Acc: 0.819 Test Loss: 0.591 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.5233986377716064
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.583 Vali Acc: 0.819 Test Loss: 0.583 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.4275705814361572
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.577 Vali Acc: 0.833 Test Loss: 0.577 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833328).  Saving model ...
Epoch: 25 cost time: 3.3691205978393555
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.576 Vali Acc: 0.833 Test Loss: 0.576 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 26 cost time: 3.3317811489105225
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.573 Vali Acc: 0.833 Test Loss: 0.573 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 27 cost time: 3.3545944690704346
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.584 Vali Acc: 0.841 Test Loss: 0.584 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840574).  Saving model ...
Epoch: 28 cost time: 3.2705609798431396
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.588 Vali Acc: 0.833 Test Loss: 0.588 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.3388428688049316
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.583 Vali Acc: 0.833 Test Loss: 0.583 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.162783145904541
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.579 Vali Acc: 0.833 Test Loss: 0.579 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.5632753372192383
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.581 Vali Acc: 0.833 Test Loss: 0.581 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.431171178817749
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.587 Vali Acc: 0.833 Test Loss: 0.587 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.1641428470611572
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.596 Vali Acc: 0.833 Test Loss: 0.596 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.471153497695923
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.584 Vali Acc: 0.833 Test Loss: 0.584 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.251389980316162
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.588 Vali Acc: 0.833 Test Loss: 0.588 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 3.396649122238159
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.584 Vali Acc: 0.833 Test Loss: 0.584 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 3.314551830291748
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.585 Vali Acc: 0.833 Test Loss: 0.585 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df512_ma42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 3633668
model size : 23.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df512_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.790811061859131
Epoch: 1, Steps: 9 | Train Loss: 1.325 Vali Loss: 1.211 Vali Acc: 0.478 Test Loss: 1.211 Test Acc: 0.478
Validation loss decreased (inf --> -0.478249).  Saving model ...
Epoch: 2 cost time: 3.2535338401794434
Epoch: 2, Steps: 9 | Train Loss: 0.971 Vali Loss: 0.934 Vali Acc: 0.674 Test Loss: 0.934 Test Acc: 0.674
Validation loss decreased (-0.478249 --> -0.673904).  Saving model ...
Epoch: 3 cost time: 3.063419818878174
Epoch: 3, Steps: 9 | Train Loss: 0.482 Vali Loss: 0.739 Vali Acc: 0.717 Test Loss: 0.739 Test Acc: 0.717
Validation loss decreased (-0.673904 --> -0.717384).  Saving model ...
Epoch: 4 cost time: 3.2799439430236816
Epoch: 4, Steps: 9 | Train Loss: 0.226 Vali Loss: 0.646 Vali Acc: 0.775 Test Loss: 0.646 Test Acc: 0.775
Validation loss decreased (-0.717384 --> -0.775356).  Saving model ...
Epoch: 5 cost time: 3.127047300338745
Epoch: 5, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.559 Vali Acc: 0.819 Test Loss: 0.559 Test Acc: 0.819
Validation loss decreased (-0.775356 --> -0.818835).  Saving model ...
Epoch: 6 cost time: 3.1409943103790283
Epoch: 6, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.439 Vali Acc: 0.826 Test Loss: 0.439 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826083).  Saving model ...
Epoch: 7 cost time: 3.285135507583618
Epoch: 7, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.545 Vali Acc: 0.812 Test Loss: 0.545 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9822537899017334
Epoch: 8, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.474 Vali Acc: 0.848 Test Loss: 0.474 Test Acc: 0.848
Validation loss decreased (-0.826083 --> -0.847821).  Saving model ...
Epoch: 9 cost time: 3.3522369861602783
Epoch: 9, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.417 Vali Acc: 0.848 Test Loss: 0.417 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847822).  Saving model ...
Epoch: 10 cost time: 3.2826030254364014
Epoch: 10, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.452 Vali Acc: 0.862 Test Loss: 0.452 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862314).  Saving model ...
Epoch: 11 cost time: 3.394380807876587
Epoch: 11, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.434 Vali Acc: 0.855 Test Loss: 0.434 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.1721131801605225
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.439 Vali Acc: 0.855 Test Loss: 0.439 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.318779945373535
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.446 Vali Acc: 0.855 Test Loss: 0.446 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.285356283187866
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.447 Vali Acc: 0.855 Test Loss: 0.447 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.200626850128174
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.432 Vali Acc: 0.855 Test Loss: 0.432 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.269777536392212
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.434 Vali Acc: 0.877 Test Loss: 0.434 Test Acc: 0.877
Validation loss decreased (-0.862314 --> -0.876807).  Saving model ...
Epoch: 17 cost time: 3.234520435333252
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.434 Vali Acc: 0.877 Test Loss: 0.434 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 18 cost time: 3.058648109436035
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.435 Vali Acc: 0.877 Test Loss: 0.435 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.0294182300567627
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.434 Vali Acc: 0.862 Test Loss: 0.434 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.0722882747650146
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.428 Vali Acc: 0.862 Test Loss: 0.428 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.2779359817504883
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.434 Vali Acc: 0.877 Test Loss: 0.434 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 22 cost time: 3.1578176021575928
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.443 Vali Acc: 0.877 Test Loss: 0.443 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.228902578353882
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.433 Vali Acc: 0.884 Test Loss: 0.433 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884054).  Saving model ...
Epoch: 24 cost time: 3.2676210403442383
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.422 Vali Acc: 0.891 Test Loss: 0.422 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891300).  Saving model ...
Epoch: 25 cost time: 3.1651148796081543
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.420 Vali Acc: 0.884 Test Loss: 0.420 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.252964496612549
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.419 Vali Acc: 0.891 Test Loss: 0.419 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 27 cost time: 3.11372709274292
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.422 Vali Acc: 0.891 Test Loss: 0.422 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.091754198074341
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.425 Vali Acc: 0.884 Test Loss: 0.425 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.2852444648742676
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.424 Vali Acc: 0.884 Test Loss: 0.424 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.2523887157440186
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.421 Vali Acc: 0.884 Test Loss: 0.421 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.1656858921051025
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.425 Vali Acc: 0.884 Test Loss: 0.425 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.1248676776885986
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.428 Vali Acc: 0.884 Test Loss: 0.428 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.2401061058044434
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.429 Vali Acc: 0.884 Test Loss: 0.429 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.4832022190093994
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.419 Vali Acc: 0.891 Test Loss: 0.419 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 35 cost time: 3.3662326335906982
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.424 Vali Acc: 0.884 Test Loss: 0.424 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.629584312438965
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.426 Vali Acc: 0.891 Test Loss: 0.426 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.497244358062744
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.429 Vali Acc: 0.891 Test Loss: 0.429 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.136594772338867
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.431 Vali Acc: 0.891 Test Loss: 0.431 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.227971315383911
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.433 Vali Acc: 0.891 Test Loss: 0.433 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.1531453132629395
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.432 Vali Acc: 0.891 Test Loss: 0.432 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 3.405587911605835
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.431 Vali Acc: 0.891 Test Loss: 0.431 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 3.3342039585113525
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.429 Vali Acc: 0.891 Test Loss: 0.429 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.353865623474121
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.424 Vali Acc: 0.891 Test Loss: 0.424 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 3.1883018016815186
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.426 Vali Acc: 0.891 Test Loss: 0.426 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df512_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 3633668
model size : 23.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df512_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.225172758102417
Epoch: 1, Steps: 9 | Train Loss: 1.321 Vali Loss: 1.185 Vali Acc: 0.486 Test Loss: 1.185 Test Acc: 0.486
Validation loss decreased (inf --> -0.485495).  Saving model ...
Epoch: 2 cost time: 4.00489616394043
Epoch: 2, Steps: 9 | Train Loss: 0.973 Vali Loss: 0.956 Vali Acc: 0.674 Test Loss: 0.956 Test Acc: 0.674
Validation loss decreased (-0.485495 --> -0.673903).  Saving model ...
Epoch: 3 cost time: 3.7321197986602783
Epoch: 3, Steps: 9 | Train Loss: 0.518 Vali Loss: 0.741 Vali Acc: 0.703 Test Loss: 0.741 Test Acc: 0.703
Validation loss decreased (-0.673903 --> -0.702891).  Saving model ...
Epoch: 4 cost time: 3.7783679962158203
Epoch: 4, Steps: 9 | Train Loss: 0.240 Vali Loss: 0.759 Vali Acc: 0.703 Test Loss: 0.759 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.317965269088745
Epoch: 5, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.647 Vali Acc: 0.754 Test Loss: 0.647 Test Acc: 0.754
Validation loss decreased (-0.702891 --> -0.753617).  Saving model ...
Epoch: 6 cost time: 3.7931933403015137
Epoch: 6, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.572 Vali Acc: 0.768 Test Loss: 0.572 Test Acc: 0.768
Validation loss decreased (-0.753617 --> -0.768110).  Saving model ...
Epoch: 7 cost time: 3.25724720954895
Epoch: 7, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.717 Vali Acc: 0.768 Test Loss: 0.717 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.6375887393951416
Epoch: 8, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.556 Vali Acc: 0.804 Test Loss: 0.556 Test Acc: 0.804
Validation loss decreased (-0.768110 --> -0.804342).  Saving model ...
Epoch: 9 cost time: 3.6333396434783936
Epoch: 9, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.608 Vali Acc: 0.783 Test Loss: 0.608 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.7097694873809814
Epoch: 10, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.668 Vali Acc: 0.768 Test Loss: 0.668 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.5681564807891846
Epoch: 11, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.567 Vali Acc: 0.790 Test Loss: 0.567 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.2011868953704834
Epoch: 12, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.589 Vali Acc: 0.804 Test Loss: 0.589 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.6480631828308105
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.628 Vali Acc: 0.790 Test Loss: 0.628 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.4222559928894043
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.621 Vali Acc: 0.790 Test Loss: 0.621 Test Acc: 0.790
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.268749237060547
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.603 Vali Acc: 0.783 Test Loss: 0.603 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.3675625324249268
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.605 Vali Acc: 0.783 Test Loss: 0.605 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.539768695831299
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.608 Vali Acc: 0.783 Test Loss: 0.608 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.417710304260254
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.611 Vali Acc: 0.790 Test Loss: 0.611 Test Acc: 0.790
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df512_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8043478260869565
model parameter : 3633668
model size : 23.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df512_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.128536701202393
Epoch: 1, Steps: 9 | Train Loss: 1.344 Vali Loss: 1.193 Vali Acc: 0.486 Test Loss: 1.193 Test Acc: 0.486
Validation loss decreased (inf --> -0.485495).  Saving model ...
Epoch: 2 cost time: 3.4704830646514893
Epoch: 2, Steps: 9 | Train Loss: 0.983 Vali Loss: 0.984 Vali Acc: 0.594 Test Loss: 0.984 Test Acc: 0.594
Validation loss decreased (-0.485495 --> -0.594193).  Saving model ...
Epoch: 3 cost time: 3.2459065914154053
Epoch: 3, Steps: 9 | Train Loss: 0.563 Vali Loss: 0.885 Vali Acc: 0.674 Test Loss: 0.885 Test Acc: 0.674
Validation loss decreased (-0.594193 --> -0.673904).  Saving model ...
Epoch: 4 cost time: 3.0882022380828857
Epoch: 4, Steps: 9 | Train Loss: 0.273 Vali Loss: 0.824 Vali Acc: 0.674 Test Loss: 0.824 Test Acc: 0.674
Validation loss decreased (-0.673904 --> -0.673905).  Saving model ...
Epoch: 5 cost time: 3.2998900413513184
Epoch: 5, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.948 Vali Acc: 0.659 Test Loss: 0.948 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1277718544006348
Epoch: 6, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.838 Vali Acc: 0.696 Test Loss: 0.838 Test Acc: 0.696
Validation loss decreased (-0.673905 --> -0.695644).  Saving model ...
Epoch: 7 cost time: 3.0758965015411377
Epoch: 7, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.887 Vali Acc: 0.667 Test Loss: 0.887 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.169389009475708
Epoch: 8, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.886 Vali Acc: 0.688 Test Loss: 0.886 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.3645002841949463
Epoch: 9, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.900 Vali Acc: 0.688 Test Loss: 0.900 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.3768911361694336
Epoch: 10, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.872 Vali Acc: 0.725 Test Loss: 0.872 Test Acc: 0.725
Validation loss decreased (-0.695644 --> -0.724629).  Saving model ...
Epoch: 11 cost time: 3.4032418727874756
Epoch: 11, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.860 Vali Acc: 0.725 Test Loss: 0.860 Test Acc: 0.725
Validation loss decreased (-0.724629 --> -0.724629).  Saving model ...
Epoch: 12 cost time: 3.366511344909668
Epoch: 12, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.889 Vali Acc: 0.717 Test Loss: 0.889 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.205627918243408
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.910 Vali Acc: 0.717 Test Loss: 0.910 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.343505620956421
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.904 Vali Acc: 0.717 Test Loss: 0.904 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.514564275741577
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.896 Vali Acc: 0.725 Test Loss: 0.896 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.490145683288574
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.905 Vali Acc: 0.717 Test Loss: 0.905 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.215142011642456
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.913 Vali Acc: 0.717 Test Loss: 0.913 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.758594512939453
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.917 Vali Acc: 0.717 Test Loss: 0.917 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.3251044750213623
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.908 Vali Acc: 0.725 Test Loss: 0.908 Test Acc: 0.725
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.4771053791046143
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.914 Vali Acc: 0.717 Test Loss: 0.914 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.288733720779419
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.921 Vali Acc: 0.717 Test Loss: 0.921 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df512_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7246376811594203
model parameter : 3633668
model size : 23.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.313640117645264
Epoch: 1, Steps: 9 | Train Loss: 1.405 Vali Loss: 1.400 Vali Acc: 0.304 Test Loss: 1.400 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 3.471052885055542
Epoch: 2, Steps: 9 | Train Loss: 1.105 Vali Loss: 1.320 Vali Acc: 0.384 Test Loss: 1.320 Test Acc: 0.384
Validation loss decreased (-0.304334 --> -0.384045).  Saving model ...
Epoch: 3 cost time: 3.24135684967041
Epoch: 3, Steps: 9 | Train Loss: 0.701 Vali Loss: 1.256 Vali Acc: 0.464 Test Loss: 1.256 Test Acc: 0.464
Validation loss decreased (-0.384045 --> -0.463756).  Saving model ...
Epoch: 4 cost time: 3.4136836528778076
Epoch: 4, Steps: 9 | Train Loss: 0.393 Vali Loss: 1.240 Vali Acc: 0.464 Test Loss: 1.240 Test Acc: 0.464
Validation loss decreased (-0.463756 --> -0.463756).  Saving model ...
Epoch: 5 cost time: 3.427729368209839
Epoch: 5, Steps: 9 | Train Loss: 0.201 Vali Loss: 1.329 Vali Acc: 0.442 Test Loss: 1.329 Test Acc: 0.442
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.5775949954986572
Epoch: 6, Steps: 9 | Train Loss: 0.086 Vali Loss: 1.488 Vali Acc: 0.442 Test Loss: 1.488 Test Acc: 0.442
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.5025150775909424
Epoch: 7, Steps: 9 | Train Loss: 0.046 Vali Loss: 1.443 Vali Acc: 0.493 Test Loss: 1.443 Test Acc: 0.493
Validation loss decreased (-0.463756 --> -0.492739).  Saving model ...
Epoch: 8 cost time: 3.708892583847046
Epoch: 8, Steps: 9 | Train Loss: 0.021 Vali Loss: 1.571 Vali Acc: 0.507 Test Loss: 1.571 Test Acc: 0.507
Validation loss decreased (-0.492739 --> -0.507231).  Saving model ...
Epoch: 9 cost time: 3.3788442611694336
Epoch: 9, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.475 Vali Acc: 0.478 Test Loss: 1.475 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.356726884841919
Epoch: 10, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.538 Vali Acc: 0.486 Test Loss: 1.538 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.4021413326263428
Epoch: 11, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.590 Vali Acc: 0.500 Test Loss: 1.590 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.468122720718384
Epoch: 12, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.542 Vali Acc: 0.493 Test Loss: 1.542 Test Acc: 0.493
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.2893965244293213
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.553 Vali Acc: 0.500 Test Loss: 1.553 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.469320058822632
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.552 Vali Acc: 0.507 Test Loss: 1.552 Test Acc: 0.507
Validation loss decreased (-0.507231 --> -0.507231).  Saving model ...
Epoch: 15 cost time: 3.5899925231933594
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.563 Vali Acc: 0.507 Test Loss: 1.563 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.566650152206421
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.558 Vali Acc: 0.522 Test Loss: 1.558 Test Acc: 0.522
Validation loss decreased (-0.507231 --> -0.521724).  Saving model ...
Epoch: 17 cost time: 3.5377187728881836
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.594 Vali Acc: 0.514 Test Loss: 1.594 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.473766326904297
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.548 Vali Acc: 0.522 Test Loss: 1.548 Test Acc: 0.522
Validation loss decreased (-0.521724 --> -0.521724).  Saving model ...
Epoch: 19 cost time: 3.6089234352111816
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.532 Vali Acc: 0.529 Test Loss: 1.532 Test Acc: 0.529
Validation loss decreased (-0.521724 --> -0.528970).  Saving model ...
Epoch: 20 cost time: 3.823745012283325
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.579 Vali Acc: 0.529 Test Loss: 1.579 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.73140811920166
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.584 Vali Acc: 0.514 Test Loss: 1.584 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.4160070419311523
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.559 Vali Acc: 0.522 Test Loss: 1.559 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.5540006160736084
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.535 Vali Acc: 0.551 Test Loss: 1.535 Test Acc: 0.551
Validation loss decreased (-0.528970 --> -0.550709).  Saving model ...
Epoch: 24 cost time: 3.330082416534424
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.542 Vali Acc: 0.551 Test Loss: 1.542 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.537562131881714
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.581 Vali Acc: 0.536 Test Loss: 1.581 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.8341281414031982
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.579 Vali Acc: 0.536 Test Loss: 1.579 Test Acc: 0.536
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.542142391204834
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.537 Vali Acc: 0.565 Test Loss: 1.537 Test Acc: 0.565
Validation loss decreased (-0.550709 --> -0.565202).  Saving model ...
Epoch: 28 cost time: 3.6375584602355957
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.540 Vali Acc: 0.565 Test Loss: 1.540 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.690023422241211
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.543 Vali Acc: 0.565 Test Loss: 1.543 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.5804145336151123
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.548 Vali Acc: 0.565 Test Loss: 1.548 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.5526952743530273
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.557 Vali Acc: 0.558 Test Loss: 1.557 Test Acc: 0.558
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.601757764816284
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.552 Vali Acc: 0.565 Test Loss: 1.552 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.606914520263672
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.554 Vali Acc: 0.580 Test Loss: 1.554 Test Acc: 0.580
Validation loss decreased (-0.565202 --> -0.579695).  Saving model ...
Epoch: 34 cost time: 3.7375967502593994
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.559 Vali Acc: 0.580 Test Loss: 1.559 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 4.022592306137085
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.554 Vali Acc: 0.580 Test Loss: 1.554 Test Acc: 0.580
Validation loss decreased (-0.579695 --> -0.579695).  Saving model ...
Epoch: 36 cost time: 3.388678789138794
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.544 Vali Acc: 0.580 Test Loss: 1.544 Test Acc: 0.580
Validation loss decreased (-0.579695 --> -0.579695).  Saving model ...
Epoch: 37 cost time: 3.293811559677124
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.537 Vali Acc: 0.580 Test Loss: 1.537 Test Acc: 0.580
Validation loss decreased (-0.579695 --> -0.579695).  Saving model ...
Epoch: 38 cost time: 3.2228050231933594
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.541 Vali Acc: 0.587 Test Loss: 1.541 Test Acc: 0.587
Validation loss decreased (-0.579695 --> -0.586941).  Saving model ...
Epoch: 39 cost time: 3.2207937240600586
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.545 Vali Acc: 0.587 Test Loss: 1.545 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.412236213684082
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.553 Vali Acc: 0.587 Test Loss: 1.553 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.50551176071167
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.558 Vali Acc: 0.587 Test Loss: 1.558 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.665191888809204
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.562 Vali Acc: 0.594 Test Loss: 1.562 Test Acc: 0.594
Validation loss decreased (-0.586941 --> -0.594187).  Saving model ...
Epoch: 43 cost time: 3.3244800567626953
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.567 Vali Acc: 0.594 Test Loss: 1.567 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.4785587787628174
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.565 Vali Acc: 0.594 Test Loss: 1.565 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.5305967330932617
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.561 Vali Acc: 0.601 Test Loss: 1.561 Test Acc: 0.601
Validation loss decreased (-0.594187 --> -0.601434).  Saving model ...
Epoch: 46 cost time: 3.631908655166626
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.563 Vali Acc: 0.601 Test Loss: 1.563 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.5082576274871826
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.561 Vali Acc: 0.594 Test Loss: 1.561 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 3.3991858959198
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.559 Vali Acc: 0.601 Test Loss: 1.559 Test Acc: 0.601
Validation loss decreased (-0.601434 --> -0.601434).  Saving model ...
Epoch: 49 cost time: 3.207920789718628
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.560 Vali Acc: 0.601 Test Loss: 1.560 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.6623101234436035
Epoch: 50, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.563 Vali Acc: 0.609 Test Loss: 1.563 Test Acc: 0.609
Validation loss decreased (-0.601434 --> -0.608680).  Saving model ...
Epoch: 51 cost time: 3.458094596862793
Epoch: 51, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.560 Vali Acc: 0.616 Test Loss: 1.560 Test Acc: 0.616
Validation loss decreased (-0.608680 --> -0.615926).  Saving model ...
Epoch: 52 cost time: 3.4567131996154785
Epoch: 52, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.564 Vali Acc: 0.616 Test Loss: 1.564 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 3.365520715713501
Epoch: 53, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.575 Vali Acc: 0.609 Test Loss: 1.575 Test Acc: 0.609
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 3.337527275085449
Epoch: 54, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.578 Vali Acc: 0.609 Test Loss: 1.578 Test Acc: 0.609
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 3.5497562885284424
Epoch: 55, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.583 Vali Acc: 0.609 Test Loss: 1.583 Test Acc: 0.609
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 3.7887160778045654
Epoch: 56, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.592 Vali Acc: 0.609 Test Loss: 1.592 Test Acc: 0.609
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 3.6473281383514404
Epoch: 57, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.591 Vali Acc: 0.609 Test Loss: 1.591 Test Acc: 0.609
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 3.75896954536438
Epoch: 58, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.591 Vali Acc: 0.623 Test Loss: 1.591 Test Acc: 0.623
Validation loss decreased (-0.615926 --> -0.623172).  Saving model ...
Epoch: 59 cost time: 3.6675076484680176
Epoch: 59, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.596 Vali Acc: 0.623 Test Loss: 1.596 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 3.5069468021392822
Epoch: 60, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.601 Vali Acc: 0.630 Test Loss: 1.601 Test Acc: 0.630
Validation loss decreased (-0.623172 --> -0.630419).  Saving model ...
Epoch: 61 cost time: 3.6837260723114014
Epoch: 61, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.603 Vali Acc: 0.623 Test Loss: 1.603 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 3.4023685455322266
Epoch: 62, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.609 Vali Acc: 0.623 Test Loss: 1.609 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 3.7422451972961426
Epoch: 63, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.611 Vali Acc: 0.630 Test Loss: 1.611 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 3.486269474029541
Epoch: 64, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.609 Vali Acc: 0.630 Test Loss: 1.609 Test Acc: 0.630
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 3.8854305744171143
Epoch: 65, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.610 Vali Acc: 0.630 Test Loss: 1.610 Test Acc: 0.630
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 3.887157678604126
Epoch: 66, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.614 Vali Acc: 0.638 Test Loss: 1.614 Test Acc: 0.638
Validation loss decreased (-0.630419 --> -0.637665).  Saving model ...
Epoch: 67 cost time: 3.5684192180633545
Epoch: 67, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.613 Vali Acc: 0.638 Test Loss: 1.613 Test Acc: 0.638
Validation loss decreased (-0.637665 --> -0.637665).  Saving model ...
Epoch: 68 cost time: 3.860802412033081
Epoch: 68, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.617 Vali Acc: 0.638 Test Loss: 1.617 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 3.4950873851776123
Epoch: 69, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.617 Vali Acc: 0.638 Test Loss: 1.617 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 3.4209537506103516
Epoch: 70, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.618 Vali Acc: 0.638 Test Loss: 1.618 Test Acc: 0.638
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 3.3454952239990234
Epoch: 71, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.618 Vali Acc: 0.638 Test Loss: 1.618 Test Acc: 0.638
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 3.5120761394500732
Epoch: 72, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.619 Vali Acc: 0.638 Test Loss: 1.619 Test Acc: 0.638
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 3.3648242950439453
Epoch: 73, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.624 Vali Acc: 0.638 Test Loss: 1.624 Test Acc: 0.638
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 3.4478111267089844
Epoch: 74, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.625 Vali Acc: 0.638 Test Loss: 1.625 Test Acc: 0.638
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 3.4426791667938232
Epoch: 75, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.627 Vali Acc: 0.638 Test Loss: 1.627 Test Acc: 0.638
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 3.395554780960083
Epoch: 76, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.633 Vali Acc: 0.638 Test Loss: 1.633 Test Acc: 0.638
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 3.4099223613739014
Epoch: 77, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.637 Vali Acc: 0.638 Test Loss: 1.637 Test Acc: 0.638
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.6376811594202898
model parameter : 3633668
model size : 23.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.093905448913574
Epoch: 1, Steps: 9 | Train Loss: 1.415 Vali Loss: 1.429 Vali Acc: 0.283 Test Loss: 1.429 Test Acc: 0.283
Validation loss decreased (inf --> -0.282594).  Saving model ...
Epoch: 2 cost time: 3.205897569656372
Epoch: 2, Steps: 9 | Train Loss: 1.252 Vali Loss: 1.457 Vali Acc: 0.304 Test Loss: 1.457 Test Acc: 0.304
Validation loss decreased (-0.282594 --> -0.304333).  Saving model ...
Epoch: 3 cost time: 3.153993844985962
Epoch: 3, Steps: 9 | Train Loss: 0.954 Vali Loss: 1.550 Vali Acc: 0.312 Test Loss: 1.550 Test Acc: 0.312
Validation loss decreased (-0.304333 --> -0.311579).  Saving model ...
Epoch: 4 cost time: 3.3537137508392334
Epoch: 4, Steps: 9 | Train Loss: 0.641 Vali Loss: 1.692 Vali Acc: 0.333 Test Loss: 1.692 Test Acc: 0.333
Validation loss decreased (-0.311579 --> -0.333316).  Saving model ...
Epoch: 5 cost time: 3.047290802001953
Epoch: 5, Steps: 9 | Train Loss: 0.374 Vali Loss: 2.149 Vali Acc: 0.297 Test Loss: 2.149 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.20205020904541
Epoch: 6, Steps: 9 | Train Loss: 0.222 Vali Loss: 2.169 Vali Acc: 0.333 Test Loss: 2.169 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.1286098957061768
Epoch: 7, Steps: 9 | Train Loss: 0.120 Vali Loss: 2.912 Vali Acc: 0.297 Test Loss: 2.912 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.179781913757324
Epoch: 8, Steps: 9 | Train Loss: 0.066 Vali Loss: 2.858 Vali Acc: 0.319 Test Loss: 2.858 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.9649345874786377
Epoch: 9, Steps: 9 | Train Loss: 0.033 Vali Loss: 2.795 Vali Acc: 0.370 Test Loss: 2.795 Test Acc: 0.370
Validation loss decreased (-0.333316 --> -0.369537).  Saving model ...
Epoch: 10 cost time: 3.2988364696502686
Epoch: 10, Steps: 9 | Train Loss: 0.014 Vali Loss: 2.956 Vali Acc: 0.348 Test Loss: 2.956 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.083339214324951
Epoch: 11, Steps: 9 | Train Loss: 0.009 Vali Loss: 2.912 Vali Acc: 0.362 Test Loss: 2.912 Test Acc: 0.362
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.1756601333618164
Epoch: 12, Steps: 9 | Train Loss: 0.006 Vali Loss: 2.733 Vali Acc: 0.391 Test Loss: 2.733 Test Acc: 0.391
Validation loss decreased (-0.369537 --> -0.391277).  Saving model ...
Epoch: 13 cost time: 3.4995880126953125
Epoch: 13, Steps: 9 | Train Loss: 0.004 Vali Loss: 2.752 Vali Acc: 0.391 Test Loss: 2.752 Test Acc: 0.391
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.355816602706909
Epoch: 14, Steps: 9 | Train Loss: 0.003 Vali Loss: 2.867 Vali Acc: 0.370 Test Loss: 2.867 Test Acc: 0.370
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.29040789604187
Epoch: 15, Steps: 9 | Train Loss: 0.003 Vali Loss: 2.860 Vali Acc: 0.377 Test Loss: 2.860 Test Acc: 0.377
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.2774014472961426
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.778 Vali Acc: 0.399 Test Loss: 2.778 Test Acc: 0.399
Validation loss decreased (-0.391277 --> -0.398523).  Saving model ...
Epoch: 17 cost time: 3.2697460651397705
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.847 Vali Acc: 0.399 Test Loss: 2.847 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.43422794342041
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.876 Vali Acc: 0.391 Test Loss: 2.876 Test Acc: 0.391
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.433988332748413
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.828 Vali Acc: 0.406 Test Loss: 2.828 Test Acc: 0.406
Validation loss decreased (-0.398523 --> -0.405769).  Saving model ...
Epoch: 20 cost time: 3.3727896213531494
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.771 Vali Acc: 0.413 Test Loss: 2.771 Test Acc: 0.413
Validation loss decreased (-0.405769 --> -0.413016).  Saving model ...
Epoch: 21 cost time: 3.52864670753479
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.715 Vali Acc: 0.420 Test Loss: 2.715 Test Acc: 0.420
Validation loss decreased (-0.413016 --> -0.420263).  Saving model ...
Epoch: 22 cost time: 3.5225212574005127
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.705 Vali Acc: 0.428 Test Loss: 2.705 Test Acc: 0.428
Validation loss decreased (-0.420263 --> -0.427509).  Saving model ...
Epoch: 23 cost time: 3.034881591796875
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.766 Vali Acc: 0.420 Test Loss: 2.766 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.4196786880493164
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.783 Vali Acc: 0.413 Test Loss: 2.783 Test Acc: 0.413
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.138375997543335
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.822 Vali Acc: 0.399 Test Loss: 2.822 Test Acc: 0.399
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.2113211154937744
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.812 Vali Acc: 0.406 Test Loss: 2.812 Test Acc: 0.406
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.9344098567962646
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.834 Vali Acc: 0.420 Test Loss: 2.834 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.1258509159088135
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.818 Vali Acc: 0.420 Test Loss: 2.818 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.9867639541625977
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.806 Vali Acc: 0.435 Test Loss: 2.806 Test Acc: 0.435
Validation loss decreased (-0.427509 --> -0.434755).  Saving model ...
Epoch: 30 cost time: 3.1929526329040527
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.754 Vali Acc: 0.435 Test Loss: 2.754 Test Acc: 0.435
Validation loss decreased (-0.434755 --> -0.434755).  Saving model ...
Epoch: 31 cost time: 3.128446340560913
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.764 Vali Acc: 0.435 Test Loss: 2.764 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.877974271774292
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.743 Vali Acc: 0.435 Test Loss: 2.743 Test Acc: 0.435
Validation loss decreased (-0.434755 --> -0.434755).  Saving model ...
Epoch: 33 cost time: 2.883681535720825
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.724 Vali Acc: 0.442 Test Loss: 2.724 Test Acc: 0.442
Validation loss decreased (-0.434755 --> -0.442002).  Saving model ...
Epoch: 34 cost time: 3.1360390186309814
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.757 Vali Acc: 0.442 Test Loss: 2.757 Test Acc: 0.442
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.0329694747924805
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.741 Vali Acc: 0.442 Test Loss: 2.741 Test Acc: 0.442
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.0881662368774414
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.759 Vali Acc: 0.442 Test Loss: 2.759 Test Acc: 0.442
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.0417404174804688
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.805 Vali Acc: 0.428 Test Loss: 2.805 Test Acc: 0.428
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.922201633453369
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.842 Vali Acc: 0.428 Test Loss: 2.842 Test Acc: 0.428
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.1988673210144043
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.814 Vali Acc: 0.442 Test Loss: 2.814 Test Acc: 0.442
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.2299623489379883
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.779 Vali Acc: 0.457 Test Loss: 2.779 Test Acc: 0.457
Validation loss decreased (-0.442002 --> -0.456494).  Saving model ...
Epoch: 41 cost time: 2.982621192932129
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.769 Vali Acc: 0.457 Test Loss: 2.769 Test Acc: 0.457
Validation loss decreased (-0.456494 --> -0.456494).  Saving model ...
Epoch: 42 cost time: 3.550570011138916
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.746 Vali Acc: 0.457 Test Loss: 2.746 Test Acc: 0.457
Validation loss decreased (-0.456494 --> -0.456494).  Saving model ...
Epoch: 43 cost time: 3.306047201156616
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.760 Vali Acc: 0.457 Test Loss: 2.760 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.151189088821411
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.776 Vali Acc: 0.449 Test Loss: 2.776 Test Acc: 0.449
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.1330161094665527
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.787 Vali Acc: 0.457 Test Loss: 2.787 Test Acc: 0.457
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.125812530517578
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.753 Vali Acc: 0.457 Test Loss: 2.753 Test Acc: 0.457
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 3.399958848953247
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.749 Vali Acc: 0.457 Test Loss: 2.749 Test Acc: 0.457
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 3.0518686771392822
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.774 Vali Acc: 0.457 Test Loss: 2.774 Test Acc: 0.457
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 3.176931619644165
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.789 Vali Acc: 0.457 Test Loss: 2.789 Test Acc: 0.457
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 3.3963842391967773
Epoch: 50, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.792 Vali Acc: 0.457 Test Loss: 2.792 Test Acc: 0.457
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 3.4391536712646484
Epoch: 51, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.795 Vali Acc: 0.457 Test Loss: 2.795 Test Acc: 0.457
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 3.531371831893921
Epoch: 52, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.818 Vali Acc: 0.471 Test Loss: 2.818 Test Acc: 0.471
Validation loss decreased (-0.456494 --> -0.470986).  Saving model ...
Epoch: 53 cost time: 3.338594675064087
Epoch: 53, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.835 Vali Acc: 0.457 Test Loss: 2.835 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 3.046813488006592
Epoch: 54, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.829 Vali Acc: 0.457 Test Loss: 2.829 Test Acc: 0.457
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 3.0875864028930664
Epoch: 55, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.820 Vali Acc: 0.457 Test Loss: 2.820 Test Acc: 0.457
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 3.298853635787964
Epoch: 56, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.812 Vali Acc: 0.486 Test Loss: 2.812 Test Acc: 0.486
Validation loss decreased (-0.470986 --> -0.485479).  Saving model ...
Epoch: 57 cost time: 3.4672720432281494
Epoch: 57, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.822 Vali Acc: 0.478 Test Loss: 2.822 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 3.5918424129486084
Epoch: 58, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.833 Vali Acc: 0.471 Test Loss: 2.833 Test Acc: 0.471
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 3.2608706951141357
Epoch: 59, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.854 Vali Acc: 0.471 Test Loss: 2.854 Test Acc: 0.471
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 3.4089620113372803
Epoch: 60, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.862 Vali Acc: 0.478 Test Loss: 2.862 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 3.3662331104278564
Epoch: 61, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.858 Vali Acc: 0.486 Test Loss: 2.858 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 3.43487811088562
Epoch: 62, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.844 Vali Acc: 0.486 Test Loss: 2.844 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 3.554685592651367
Epoch: 63, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.826 Vali Acc: 0.486 Test Loss: 2.826 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 3.4344327449798584
Epoch: 64, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.824 Vali Acc: 0.486 Test Loss: 2.824 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 3.3595900535583496
Epoch: 65, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.824 Vali Acc: 0.486 Test Loss: 2.824 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 3.268695592880249
Epoch: 66, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.827 Vali Acc: 0.493 Test Loss: 2.827 Test Acc: 0.493
Validation loss decreased (-0.485479 --> -0.492725).  Saving model ...
Epoch: 67 cost time: 3.2983052730560303
Epoch: 67, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.820 Vali Acc: 0.493 Test Loss: 2.820 Test Acc: 0.493
Validation loss decreased (-0.492725 --> -0.492725).  Saving model ...
Epoch: 68 cost time: 3.175222873687744
Epoch: 68, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.828 Vali Acc: 0.493 Test Loss: 2.828 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 3.283177375793457
Epoch: 69, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.847 Vali Acc: 0.486 Test Loss: 2.847 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 3.5068821907043457
Epoch: 70, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.839 Vali Acc: 0.486 Test Loss: 2.839 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 3.3819875717163086
Epoch: 71, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.838 Vali Acc: 0.478 Test Loss: 2.838 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 3.40354585647583
Epoch: 72, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.841 Vali Acc: 0.486 Test Loss: 2.841 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 3.523898124694824
Epoch: 73, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.845 Vali Acc: 0.486 Test Loss: 2.845 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 3.1660678386688232
Epoch: 74, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.856 Vali Acc: 0.486 Test Loss: 2.856 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 2.998751163482666
Epoch: 75, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.863 Vali Acc: 0.486 Test Loss: 2.863 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 3.223149538040161
Epoch: 76, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.872 Vali Acc: 0.486 Test Loss: 2.872 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 3.0600719451904297
Epoch: 77, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.887 Vali Acc: 0.478 Test Loss: 2.887 Test Acc: 0.478
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.4927536231884058
model parameter : 3633668
model size : 23.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.004846572875977
Epoch: 1, Steps: 9 | Train Loss: 1.440 Vali Loss: 1.377 Vali Acc: 0.326 Test Loss: 1.377 Test Acc: 0.326
Validation loss decreased (inf --> -0.326073).  Saving model ...
Epoch: 2 cost time: 3.255284070968628
Epoch: 2, Steps: 9 | Train Loss: 1.274 Vali Loss: 1.339 Vali Acc: 0.348 Test Loss: 1.339 Test Acc: 0.348
Validation loss decreased (-0.326073 --> -0.347813).  Saving model ...
Epoch: 3 cost time: 3.0852766036987305
Epoch: 3, Steps: 9 | Train Loss: 0.928 Vali Loss: 1.288 Vali Acc: 0.384 Test Loss: 1.288 Test Acc: 0.384
Validation loss decreased (-0.347813 --> -0.384045).  Saving model ...
Epoch: 4 cost time: 2.9824211597442627
Epoch: 4, Steps: 9 | Train Loss: 0.560 Vali Loss: 1.293 Vali Acc: 0.341 Test Loss: 1.293 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.110187530517578
Epoch: 5, Steps: 9 | Train Loss: 0.310 Vali Loss: 1.344 Vali Acc: 0.391 Test Loss: 1.344 Test Acc: 0.391
Validation loss decreased (-0.384045 --> -0.391291).  Saving model ...
Epoch: 6 cost time: 3.496445655822754
Epoch: 6, Steps: 9 | Train Loss: 0.173 Vali Loss: 1.554 Vali Acc: 0.348 Test Loss: 1.554 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.4163453578948975
Epoch: 7, Steps: 9 | Train Loss: 0.079 Vali Loss: 1.666 Vali Acc: 0.362 Test Loss: 1.666 Test Acc: 0.362
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.9253957271575928
Epoch: 8, Steps: 9 | Train Loss: 0.037 Vali Loss: 1.793 Vali Acc: 0.377 Test Loss: 1.793 Test Acc: 0.377
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.942190170288086
Epoch: 9, Steps: 9 | Train Loss: 0.018 Vali Loss: 1.608 Vali Acc: 0.406 Test Loss: 1.608 Test Acc: 0.406
Validation loss decreased (-0.391291 --> -0.405781).  Saving model ...
Epoch: 10 cost time: 3.0317742824554443
Epoch: 10, Steps: 9 | Train Loss: 0.010 Vali Loss: 1.586 Vali Acc: 0.406 Test Loss: 1.586 Test Acc: 0.406
Validation loss decreased (-0.405781 --> -0.405781).  Saving model ...
Epoch: 11 cost time: 3.3207437992095947
Epoch: 11, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.757 Vali Acc: 0.413 Test Loss: 1.757 Test Acc: 0.413
Validation loss decreased (-0.405781 --> -0.413026).  Saving model ...
Epoch: 12 cost time: 3.121983766555786
Epoch: 12, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.690 Vali Acc: 0.435 Test Loss: 1.690 Test Acc: 0.435
Validation loss decreased (-0.413026 --> -0.434766).  Saving model ...
Epoch: 13 cost time: 3.2671597003936768
Epoch: 13, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.673 Vali Acc: 0.420 Test Loss: 1.673 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.9790432453155518
Epoch: 14, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.654 Vali Acc: 0.464 Test Loss: 1.654 Test Acc: 0.464
Validation loss decreased (-0.434766 --> -0.463752).  Saving model ...
Epoch: 15 cost time: 3.1602141857147217
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.631 Vali Acc: 0.478 Test Loss: 1.631 Test Acc: 0.478
Validation loss decreased (-0.463752 --> -0.478245).  Saving model ...
Epoch: 16 cost time: 2.912005662918091
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.617 Vali Acc: 0.464 Test Loss: 1.617 Test Acc: 0.464
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.027754306793213
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.636 Vali Acc: 0.478 Test Loss: 1.636 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.1174349784851074
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.610 Vali Acc: 0.493 Test Loss: 1.610 Test Acc: 0.493
Validation loss decreased (-0.478245 --> -0.492738).  Saving model ...
Epoch: 19 cost time: 3.338618278503418
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.624 Vali Acc: 0.493 Test Loss: 1.624 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.3574533462524414
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.620 Vali Acc: 0.507 Test Loss: 1.620 Test Acc: 0.507
Validation loss decreased (-0.492738 --> -0.507230).  Saving model ...
Epoch: 21 cost time: 3.4543685913085938
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.610 Vali Acc: 0.507 Test Loss: 1.610 Test Acc: 0.507
Validation loss decreased (-0.507230 --> -0.507230).  Saving model ...
Epoch: 22 cost time: 3.5878944396972656
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.591 Vali Acc: 0.500 Test Loss: 1.591 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.572617292404175
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.597 Vali Acc: 0.500 Test Loss: 1.597 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.255521059036255
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.590 Vali Acc: 0.514 Test Loss: 1.590 Test Acc: 0.514
Validation loss decreased (-0.507230 --> -0.514477).  Saving model ...
Epoch: 25 cost time: 3.47251558303833
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.612 Vali Acc: 0.529 Test Loss: 1.612 Test Acc: 0.529
Validation loss decreased (-0.514477 --> -0.528969).  Saving model ...
Epoch: 26 cost time: 3.4177427291870117
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.613 Vali Acc: 0.543 Test Loss: 1.613 Test Acc: 0.543
Validation loss decreased (-0.528969 --> -0.543462).  Saving model ...
Epoch: 27 cost time: 3.4731147289276123
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.607 Vali Acc: 0.529 Test Loss: 1.607 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.062425374984741
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.616 Vali Acc: 0.529 Test Loss: 1.616 Test Acc: 0.529
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.044283151626587
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.626 Vali Acc: 0.543 Test Loss: 1.626 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.1075456142425537
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.628 Vali Acc: 0.543 Test Loss: 1.628 Test Acc: 0.543
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.173307418823242
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.626 Vali Acc: 0.551 Test Loss: 1.626 Test Acc: 0.551
Validation loss decreased (-0.543462 --> -0.550708).  Saving model ...
Epoch: 32 cost time: 3.2379255294799805
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.616 Vali Acc: 0.551 Test Loss: 1.616 Test Acc: 0.551
Validation loss decreased (-0.550708 --> -0.550708).  Saving model ...
Epoch: 33 cost time: 3.2440483570098877
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.633 Vali Acc: 0.536 Test Loss: 1.633 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.2196216583251953
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.665 Vali Acc: 0.543 Test Loss: 1.665 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.152343511581421
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.658 Vali Acc: 0.558 Test Loss: 1.658 Test Acc: 0.558
Validation loss decreased (-0.550708 --> -0.557954).  Saving model ...
Epoch: 36 cost time: 3.035917282104492
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.647 Vali Acc: 0.565 Test Loss: 1.647 Test Acc: 0.565
Validation loss decreased (-0.557954 --> -0.565201).  Saving model ...
Epoch: 37 cost time: 3.435678482055664
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.638 Vali Acc: 0.572 Test Loss: 1.638 Test Acc: 0.572
Validation loss decreased (-0.565201 --> -0.572447).  Saving model ...
Epoch: 38 cost time: 3.1671481132507324
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.642 Vali Acc: 0.572 Test Loss: 1.642 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.126077890396118
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.645 Vali Acc: 0.565 Test Loss: 1.645 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.150570869445801
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.640 Vali Acc: 0.572 Test Loss: 1.640 Test Acc: 0.572
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 3.1370832920074463
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.636 Vali Acc: 0.572 Test Loss: 1.636 Test Acc: 0.572
Validation loss decreased (-0.572447 --> -0.572447).  Saving model ...
Epoch: 42 cost time: 3.342560291290283
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.631 Vali Acc: 0.572 Test Loss: 1.631 Test Acc: 0.572
Validation loss decreased (-0.572447 --> -0.572447).  Saving model ...
Epoch: 43 cost time: 3.2050719261169434
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.636 Vali Acc: 0.565 Test Loss: 1.636 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.376525402069092
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.639 Vali Acc: 0.565 Test Loss: 1.639 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.2223355770111084
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.649 Vali Acc: 0.565 Test Loss: 1.649 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.1369011402130127
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.662 Vali Acc: 0.572 Test Loss: 1.662 Test Acc: 0.572
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 3.1581315994262695
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.668 Vali Acc: 0.572 Test Loss: 1.668 Test Acc: 0.572
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 3.2359509468078613
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.676 Vali Acc: 0.572 Test Loss: 1.676 Test Acc: 0.572
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 3.398172616958618
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.685 Vali Acc: 0.572 Test Loss: 1.685 Test Acc: 0.572
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 3.532054901123047
Epoch: 50, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.684 Vali Acc: 0.572 Test Loss: 1.684 Test Acc: 0.572
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 3.438918352127075
Epoch: 51, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.677 Vali Acc: 0.572 Test Loss: 1.677 Test Acc: 0.572
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 3.574019432067871
Epoch: 52, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.679 Vali Acc: 0.580 Test Loss: 1.679 Test Acc: 0.580
Validation loss decreased (-0.572447 --> -0.579693).  Saving model ...
Epoch: 53 cost time: 3.336308240890503
Epoch: 53, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.687 Vali Acc: 0.572 Test Loss: 1.687 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 3.516258716583252
Epoch: 54, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.689 Vali Acc: 0.565 Test Loss: 1.689 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 3.1261961460113525
Epoch: 55, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.688 Vali Acc: 0.565 Test Loss: 1.688 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 3.403266429901123
Epoch: 56, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.685 Vali Acc: 0.565 Test Loss: 1.685 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 3.463822364807129
Epoch: 57, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.679 Vali Acc: 0.572 Test Loss: 1.679 Test Acc: 0.572
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 3.492342233657837
Epoch: 58, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.680 Vali Acc: 0.572 Test Loss: 1.680 Test Acc: 0.572
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 3.5950255393981934
Epoch: 59, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.688 Vali Acc: 0.565 Test Loss: 1.688 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 3.4758212566375732
Epoch: 60, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.699 Vali Acc: 0.565 Test Loss: 1.699 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 3.5206568241119385
Epoch: 61, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.705 Vali Acc: 0.565 Test Loss: 1.705 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 3.472543716430664
Epoch: 62, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.712 Vali Acc: 0.565 Test Loss: 1.712 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5797101449275363
model parameter : 3633668
model size : 23.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         103                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df256_ma103_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.075417995452881
Epoch: 1, Steps: 9 | Train Loss: 1.378 Vali Loss: 1.303 Vali Acc: 0.413 Test Loss: 1.303 Test Acc: 0.413
Validation loss decreased (inf --> -0.413030).  Saving model ...
Epoch: 2 cost time: 3.0262365341186523
Epoch: 2, Steps: 9 | Train Loss: 0.973 Vali Loss: 0.957 Vali Acc: 0.616 Test Loss: 0.957 Test Acc: 0.616
Validation loss decreased (-0.413030 --> -0.615932).  Saving model ...
Epoch: 3 cost time: 3.136274576187134
Epoch: 3, Steps: 9 | Train Loss: 0.474 Vali Loss: 0.866 Vali Acc: 0.710 Test Loss: 0.866 Test Acc: 0.710
Validation loss decreased (-0.615932 --> -0.710136).  Saving model ...
Epoch: 4 cost time: 3.2038655281066895
Epoch: 4, Steps: 9 | Train Loss: 0.229 Vali Loss: 0.651 Vali Acc: 0.754 Test Loss: 0.651 Test Acc: 0.754
Validation loss decreased (-0.710136 --> -0.753617).  Saving model ...
Epoch: 5 cost time: 3.340973377227783
Epoch: 5, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.698 Vali Acc: 0.761 Test Loss: 0.698 Test Acc: 0.761
Validation loss decreased (-0.753617 --> -0.760863).  Saving model ...
Epoch: 6 cost time: 3.1913185119628906
Epoch: 6, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.789 Vali Acc: 0.746 Test Loss: 0.789 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0108580589294434
Epoch: 7, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.593 Vali Acc: 0.819 Test Loss: 0.593 Test Acc: 0.819
Validation loss decreased (-0.760863 --> -0.818835).  Saving model ...
Epoch: 8 cost time: 3.1286535263061523
Epoch: 8, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.753 Vali Acc: 0.746 Test Loss: 0.753 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.1310086250305176
Epoch: 9, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.747 Vali Acc: 0.754 Test Loss: 0.747 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.0743143558502197
Epoch: 10, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.683 Vali Acc: 0.775 Test Loss: 0.683 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.2843682765960693
Epoch: 11, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.707 Vali Acc: 0.797 Test Loss: 0.707 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.221560001373291
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.751 Vali Acc: 0.768 Test Loss: 0.751 Test Acc: 0.768
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.190822124481201
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.735 Vali Acc: 0.775 Test Loss: 0.735 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.1072325706481934
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.708 Vali Acc: 0.783 Test Loss: 0.708 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.2703518867492676
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.738 Vali Acc: 0.775 Test Loss: 0.738 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.1175553798675537
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.755 Vali Acc: 0.768 Test Loss: 0.755 Test Acc: 0.768
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.011524200439453
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.741 Vali Acc: 0.775 Test Loss: 0.741 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df256_ma103_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8188405797101449
model parameter : 3240452
model size : 22.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         83                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df256_ma83_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.706902503967285
Epoch: 1, Steps: 9 | Train Loss: 1.390 Vali Loss: 1.319 Vali Acc: 0.391 Test Loss: 1.319 Test Acc: 0.391
Validation loss decreased (inf --> -0.391291).  Saving model ...
Epoch: 2 cost time: 2.9914305210113525
Epoch: 2, Steps: 9 | Train Loss: 0.988 Vali Loss: 0.959 Vali Acc: 0.652 Test Loss: 0.959 Test Acc: 0.652
Validation loss decreased (-0.391291 --> -0.652164).  Saving model ...
Epoch: 3 cost time: 3.057025671005249
Epoch: 3, Steps: 9 | Train Loss: 0.486 Vali Loss: 0.886 Vali Acc: 0.688 Test Loss: 0.886 Test Acc: 0.688
Validation loss decreased (-0.652164 --> -0.688397).  Saving model ...
Epoch: 4 cost time: 3.153818130493164
Epoch: 4, Steps: 9 | Train Loss: 0.230 Vali Loss: 0.635 Vali Acc: 0.761 Test Loss: 0.635 Test Acc: 0.761
Validation loss decreased (-0.688397 --> -0.760863).  Saving model ...
Epoch: 5 cost time: 3.1750051975250244
Epoch: 5, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.661 Vali Acc: 0.746 Test Loss: 0.661 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1935837268829346
Epoch: 6, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.780 Vali Acc: 0.732 Test Loss: 0.780 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.226663589477539
Epoch: 7, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.546 Vali Acc: 0.826 Test Loss: 0.546 Test Acc: 0.826
Validation loss decreased (-0.760863 --> -0.826082).  Saving model ...
Epoch: 8 cost time: 3.2416839599609375
Epoch: 8, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.813 Vali Acc: 0.768 Test Loss: 0.813 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.2599048614501953
Epoch: 9, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.672 Vali Acc: 0.783 Test Loss: 0.672 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.091750144958496
Epoch: 10, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.669 Vali Acc: 0.804 Test Loss: 0.669 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.38162899017334
Epoch: 11, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.735 Vali Acc: 0.804 Test Loss: 0.735 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.2750117778778076
Epoch: 12, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.740 Vali Acc: 0.804 Test Loss: 0.740 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.2649331092834473
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.704 Vali Acc: 0.797 Test Loss: 0.704 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.454402208328247
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.676 Vali Acc: 0.804 Test Loss: 0.676 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.3013601303100586
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.721 Vali Acc: 0.797 Test Loss: 0.721 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.1533989906311035
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.740 Vali Acc: 0.797 Test Loss: 0.740 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.0663726329803467
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.713 Vali Acc: 0.797 Test Loss: 0.713 Test Acc: 0.797
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df256_ma83_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8260869565217391
model parameter : 3240452
model size : 22.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         62                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df256_ma62_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.918329477310181
Epoch: 1, Steps: 9 | Train Loss: 1.402 Vali Loss: 1.319 Vali Acc: 0.413 Test Loss: 1.319 Test Acc: 0.413
Validation loss decreased (inf --> -0.413030).  Saving model ...
Epoch: 2 cost time: 3.4024927616119385
Epoch: 2, Steps: 9 | Train Loss: 0.989 Vali Loss: 0.954 Vali Acc: 0.645 Test Loss: 0.954 Test Acc: 0.645
Validation loss decreased (-0.413030 --> -0.644918).  Saving model ...
Epoch: 3 cost time: 3.633500814437866
Epoch: 3, Steps: 9 | Train Loss: 0.475 Vali Loss: 0.893 Vali Acc: 0.652 Test Loss: 0.893 Test Acc: 0.652
Validation loss decreased (-0.644918 --> -0.652165).  Saving model ...
Epoch: 4 cost time: 3.352802038192749
Epoch: 4, Steps: 9 | Train Loss: 0.214 Vali Loss: 0.651 Vali Acc: 0.783 Test Loss: 0.651 Test Acc: 0.783
Validation loss decreased (-0.652165 --> -0.782602).  Saving model ...
Epoch: 5 cost time: 3.360400915145874
Epoch: 5, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.665 Vali Acc: 0.783 Test Loss: 0.665 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.169062852859497
Epoch: 6, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.757 Vali Acc: 0.783 Test Loss: 0.757 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.231093645095825
Epoch: 7, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.571 Vali Acc: 0.862 Test Loss: 0.571 Test Acc: 0.862
Validation loss decreased (-0.782602 --> -0.862313).  Saving model ...
Epoch: 8 cost time: 3.534125328063965
Epoch: 8, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.679 Vali Acc: 0.797 Test Loss: 0.679 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.359628200531006
Epoch: 9, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.743 Vali Acc: 0.775 Test Loss: 0.743 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.181901454925537
Epoch: 10, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.638 Vali Acc: 0.841 Test Loss: 0.638 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.2934391498565674
Epoch: 11, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.619 Vali Acc: 0.848 Test Loss: 0.619 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.276902914047241
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.664 Vali Acc: 0.848 Test Loss: 0.664 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.3107001781463623
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.684 Vali Acc: 0.841 Test Loss: 0.684 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.1313514709472656
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.650 Vali Acc: 0.848 Test Loss: 0.650 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.2100648880004883
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.655 Vali Acc: 0.841 Test Loss: 0.655 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.5396692752838135
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.681 Vali Acc: 0.826 Test Loss: 0.681 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.5540666580200195
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.682 Vali Acc: 0.826 Test Loss: 0.682 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df256_ma62_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 3240452
model size : 22.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         42                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df256_ma42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.930308818817139
Epoch: 1, Steps: 9 | Train Loss: 1.399 Vali Loss: 1.288 Vali Acc: 0.420 Test Loss: 1.288 Test Acc: 0.420
Validation loss decreased (inf --> -0.420277).  Saving model ...
Epoch: 2 cost time: 3.1581621170043945
Epoch: 2, Steps: 9 | Train Loss: 0.956 Vali Loss: 0.894 Vali Acc: 0.667 Test Loss: 0.894 Test Acc: 0.667
Validation loss decreased (-0.420277 --> -0.666658).  Saving model ...
Epoch: 3 cost time: 3.343160629272461
Epoch: 3, Steps: 9 | Train Loss: 0.448 Vali Loss: 0.851 Vali Acc: 0.674 Test Loss: 0.851 Test Acc: 0.674
Validation loss decreased (-0.666658 --> -0.673905).  Saving model ...
Epoch: 4 cost time: 3.1662845611572266
Epoch: 4, Steps: 9 | Train Loss: 0.209 Vali Loss: 0.594 Vali Acc: 0.797 Test Loss: 0.594 Test Acc: 0.797
Validation loss decreased (-0.673905 --> -0.797096).  Saving model ...
Epoch: 5 cost time: 3.2984681129455566
Epoch: 5, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.618 Vali Acc: 0.783 Test Loss: 0.618 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.2896180152893066
Epoch: 6, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.747 Vali Acc: 0.761 Test Loss: 0.747 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.1528260707855225
Epoch: 7, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.478 Vali Acc: 0.833 Test Loss: 0.478 Test Acc: 0.833
Validation loss decreased (-0.797096 --> -0.833329).  Saving model ...
Epoch: 8 cost time: 3.323502540588379
Epoch: 8, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.650 Vali Acc: 0.783 Test Loss: 0.650 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.4174060821533203
Epoch: 9, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.596 Vali Acc: 0.797 Test Loss: 0.596 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.4401471614837646
Epoch: 10, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.544 Vali Acc: 0.812 Test Loss: 0.544 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.3585569858551025
Epoch: 11, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.576 Vali Acc: 0.812 Test Loss: 0.576 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.1350090503692627
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.620 Vali Acc: 0.804 Test Loss: 0.620 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.209209442138672
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.621 Vali Acc: 0.790 Test Loss: 0.621 Test Acc: 0.790
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.302940607070923
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.591 Vali Acc: 0.797 Test Loss: 0.591 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.364531993865967
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.604 Vali Acc: 0.797 Test Loss: 0.604 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.9947047233581543
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.624 Vali Acc: 0.804 Test Loss: 0.624 Test Acc: 0.804
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.095034599304199
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.628 Vali Acc: 0.790 Test Loss: 0.628 Test Acc: 0.790
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df256_ma42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 3240452
model size : 22.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df256_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.3009257316589355
Epoch: 1, Steps: 9 | Train Loss: 1.366 Vali Loss: 1.274 Vali Acc: 0.406 Test Loss: 1.274 Test Acc: 0.406
Validation loss decreased (inf --> -0.405784).  Saving model ...
Epoch: 2 cost time: 3.53897762298584
Epoch: 2, Steps: 9 | Train Loss: 0.970 Vali Loss: 0.944 Vali Acc: 0.645 Test Loss: 0.944 Test Acc: 0.645
Validation loss decreased (-0.405784 --> -0.644918).  Saving model ...
Epoch: 3 cost time: 3.3178982734680176
Epoch: 3, Steps: 9 | Train Loss: 0.476 Vali Loss: 0.840 Vali Acc: 0.674 Test Loss: 0.840 Test Acc: 0.674
Validation loss decreased (-0.644918 --> -0.673905).  Saving model ...
Epoch: 4 cost time: 3.4147133827209473
Epoch: 4, Steps: 9 | Train Loss: 0.231 Vali Loss: 0.616 Vali Acc: 0.797 Test Loss: 0.616 Test Acc: 0.797
Validation loss decreased (-0.673905 --> -0.797095).  Saving model ...
Epoch: 5 cost time: 3.7189271450042725
Epoch: 5, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.555 Vali Acc: 0.804 Test Loss: 0.555 Test Acc: 0.804
Validation loss decreased (-0.797095 --> -0.804342).  Saving model ...
Epoch: 6 cost time: 3.342254161834717
Epoch: 6, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.708 Vali Acc: 0.739 Test Loss: 0.708 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0759568214416504
Epoch: 7, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.425 Vali Acc: 0.848 Test Loss: 0.425 Test Acc: 0.848
Validation loss decreased (-0.804342 --> -0.847822).  Saving model ...
Epoch: 8 cost time: 3.1693830490112305
Epoch: 8, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.475 Vali Acc: 0.833 Test Loss: 0.475 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.2434558868408203
Epoch: 9, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.508 Vali Acc: 0.819 Test Loss: 0.508 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.4791853427886963
Epoch: 10, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.411 Vali Acc: 0.855 Test Loss: 0.411 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 11 cost time: 3.3851847648620605
Epoch: 11, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.392 Vali Acc: 0.862 Test Loss: 0.392 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 12 cost time: 3.2123007774353027
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.435 Vali Acc: 0.855 Test Loss: 0.435 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.345311164855957
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.463 Vali Acc: 0.877 Test Loss: 0.463 Test Acc: 0.877
Validation loss decreased (-0.862315 --> -0.876807).  Saving model ...
Epoch: 14 cost time: 3.5250682830810547
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.433 Vali Acc: 0.862 Test Loss: 0.433 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.6954586505889893
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.431 Vali Acc: 0.855 Test Loss: 0.431 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.50827693939209
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.447 Vali Acc: 0.870 Test Loss: 0.447 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.4699878692626953
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.451 Vali Acc: 0.870 Test Loss: 0.451 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.796865224838257
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.444 Vali Acc: 0.862 Test Loss: 0.444 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.453641176223755
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.444 Vali Acc: 0.855 Test Loss: 0.444 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.5262911319732666
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.450 Vali Acc: 0.862 Test Loss: 0.450 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.839958429336548
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.470 Vali Acc: 0.870 Test Loss: 0.470 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.404214859008789
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.466 Vali Acc: 0.870 Test Loss: 0.466 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.4486756324768066
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.461 Vali Acc: 0.870 Test Loss: 0.461 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df256_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 3240452
model size : 22.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df256_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.339781284332275
Epoch: 1, Steps: 9 | Train Loss: 1.335 Vali Loss: 1.251 Vali Acc: 0.435 Test Loss: 1.251 Test Acc: 0.435
Validation loss decreased (inf --> -0.434770).  Saving model ...
Epoch: 2 cost time: 3.4692327976226807
Epoch: 2, Steps: 9 | Train Loss: 0.968 Vali Loss: 0.962 Vali Acc: 0.638 Test Loss: 0.962 Test Acc: 0.638
Validation loss decreased (-0.434770 --> -0.637672).  Saving model ...
Epoch: 3 cost time: 3.286062002182007
Epoch: 3, Steps: 9 | Train Loss: 0.505 Vali Loss: 0.871 Vali Acc: 0.659 Test Loss: 0.871 Test Acc: 0.659
Validation loss decreased (-0.637672 --> -0.659412).  Saving model ...
Epoch: 4 cost time: 3.4030933380126953
Epoch: 4, Steps: 9 | Train Loss: 0.264 Vali Loss: 0.689 Vali Acc: 0.725 Test Loss: 0.689 Test Acc: 0.725
Validation loss decreased (-0.659412 --> -0.724631).  Saving model ...
Epoch: 5 cost time: 3.4597814083099365
Epoch: 5, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.673 Vali Acc: 0.754 Test Loss: 0.673 Test Acc: 0.754
Validation loss decreased (-0.724631 --> -0.753616).  Saving model ...
Epoch: 6 cost time: 3.283798933029175
Epoch: 6, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.746 Vali Acc: 0.739 Test Loss: 0.746 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.1338658332824707
Epoch: 7, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.576 Vali Acc: 0.768 Test Loss: 0.576 Test Acc: 0.768
Validation loss decreased (-0.753616 --> -0.768110).  Saving model ...
Epoch: 8 cost time: 3.265868663787842
Epoch: 8, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.628 Vali Acc: 0.775 Test Loss: 0.628 Test Acc: 0.775
Validation loss decreased (-0.768110 --> -0.775356).  Saving model ...
Epoch: 9 cost time: 3.2166895866394043
Epoch: 9, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.622 Vali Acc: 0.775 Test Loss: 0.622 Test Acc: 0.775
Validation loss decreased (-0.775356 --> -0.775356).  Saving model ...
Epoch: 10 cost time: 3.1972737312316895
Epoch: 10, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.621 Vali Acc: 0.768 Test Loss: 0.621 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.5559914112091064
Epoch: 11, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.625 Vali Acc: 0.768 Test Loss: 0.625 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.328126907348633
Epoch: 12, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.653 Vali Acc: 0.783 Test Loss: 0.653 Test Acc: 0.783
Validation loss decreased (-0.775356 --> -0.782602).  Saving model ...
Epoch: 13 cost time: 3.278717279434204
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.655 Vali Acc: 0.783 Test Loss: 0.655 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.431674003601074
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.643 Vali Acc: 0.775 Test Loss: 0.643 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.37479829788208
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.647 Vali Acc: 0.775 Test Loss: 0.647 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.5750861167907715
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.655 Vali Acc: 0.783 Test Loss: 0.655 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.5546233654022217
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.653 Vali Acc: 0.783 Test Loss: 0.653 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.7215089797973633
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.662 Vali Acc: 0.775 Test Loss: 0.662 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.3441975116729736
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.666 Vali Acc: 0.783 Test Loss: 0.666 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.547483205795288
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.666 Vali Acc: 0.775 Test Loss: 0.666 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.6199748516082764
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.665 Vali Acc: 0.783 Test Loss: 0.665 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.535304069519043
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.660 Vali Acc: 0.783 Test Loss: 0.660 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df256_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.782608695652174
model parameter : 3240452
model size : 22.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df256_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.321880102157593
Epoch: 1, Steps: 9 | Train Loss: 1.380 Vali Loss: 1.245 Vali Acc: 0.449 Test Loss: 1.245 Test Acc: 0.449
Validation loss decreased (inf --> -0.449263).  Saving model ...
Epoch: 2 cost time: 3.7232160568237305
Epoch: 2, Steps: 9 | Train Loss: 0.990 Vali Loss: 1.003 Vali Acc: 0.623 Test Loss: 1.003 Test Acc: 0.623
Validation loss decreased (-0.449263 --> -0.623178).  Saving model ...
Epoch: 3 cost time: 3.4009671211242676
Epoch: 3, Steps: 9 | Train Loss: 0.510 Vali Loss: 0.925 Vali Acc: 0.630 Test Loss: 0.925 Test Acc: 0.630
Validation loss decreased (-0.623178 --> -0.630426).  Saving model ...
Epoch: 4 cost time: 3.1800527572631836
Epoch: 4, Steps: 9 | Train Loss: 0.283 Vali Loss: 0.835 Vali Acc: 0.674 Test Loss: 0.835 Test Acc: 0.674
Validation loss decreased (-0.630426 --> -0.673905).  Saving model ...
Epoch: 5 cost time: 3.406801700592041
Epoch: 5, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.904 Vali Acc: 0.667 Test Loss: 0.904 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.595487594604492
Epoch: 6, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.923 Vali Acc: 0.674 Test Loss: 0.923 Test Acc: 0.674
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.346102237701416
Epoch: 7, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.841 Vali Acc: 0.710 Test Loss: 0.841 Test Acc: 0.710
Validation loss decreased (-0.673905 --> -0.710137).  Saving model ...
Epoch: 8 cost time: 3.3169498443603516
Epoch: 8, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.936 Vali Acc: 0.710 Test Loss: 0.936 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.418315887451172
Epoch: 9, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.994 Vali Acc: 0.710 Test Loss: 0.994 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.3096892833709717
Epoch: 10, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.924 Vali Acc: 0.703 Test Loss: 0.924 Test Acc: 0.703
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.266780138015747
Epoch: 11, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.940 Vali Acc: 0.725 Test Loss: 0.940 Test Acc: 0.725
Validation loss decreased (-0.710137 --> -0.724628).  Saving model ...
Epoch: 12 cost time: 3.2643520832061768
Epoch: 12, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.988 Vali Acc: 0.725 Test Loss: 0.988 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.2654263973236084
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.003 Vali Acc: 0.710 Test Loss: 1.003 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.42315411567688
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.974 Vali Acc: 0.725 Test Loss: 0.974 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.5632004737854004
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.974 Vali Acc: 0.725 Test Loss: 0.974 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.3513550758361816
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.983 Vali Acc: 0.717 Test Loss: 0.983 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.2169485092163086
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.001 Vali Acc: 0.696 Test Loss: 1.001 Test Acc: 0.696
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.2743051052093506
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.988 Vali Acc: 0.710 Test Loss: 0.988 Test Acc: 0.710
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.635484457015991
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.983 Vali Acc: 0.717 Test Loss: 0.983 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.244386672973633
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.991 Vali Acc: 0.717 Test Loss: 0.991 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.3879382610321045
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.005 Vali Acc: 0.710 Test Loss: 1.005 Test Acc: 0.710
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df256_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7246376811594203
model parameter : 3240452
model size : 22.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.909230709075928
Epoch: 1, Steps: 9 | Train Loss: 1.424 Vali Loss: 1.412 Vali Acc: 0.326 Test Loss: 1.412 Test Acc: 0.326
Validation loss decreased (inf --> -0.326073).  Saving model ...
Epoch: 2 cost time: 3.2852671146392822
Epoch: 2, Steps: 9 | Train Loss: 1.132 Vali Loss: 1.292 Vali Acc: 0.435 Test Loss: 1.292 Test Acc: 0.435
Validation loss decreased (-0.326073 --> -0.434770).  Saving model ...
Epoch: 3 cost time: 3.1297614574432373
Epoch: 3, Steps: 9 | Train Loss: 0.685 Vali Loss: 1.236 Vali Acc: 0.464 Test Loss: 1.236 Test Acc: 0.464
Validation loss decreased (-0.434770 --> -0.463756).  Saving model ...
Epoch: 4 cost time: 3.289975643157959
Epoch: 4, Steps: 9 | Train Loss: 0.389 Vali Loss: 1.265 Vali Acc: 0.442 Test Loss: 1.265 Test Acc: 0.442
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.055104970932007
Epoch: 5, Steps: 9 | Train Loss: 0.209 Vali Loss: 1.243 Vali Acc: 0.543 Test Loss: 1.243 Test Acc: 0.543
Validation loss decreased (-0.463756 --> -0.543466).  Saving model ...
Epoch: 6 cost time: 3.1561505794525146
Epoch: 6, Steps: 9 | Train Loss: 0.109 Vali Loss: 1.522 Vali Acc: 0.435 Test Loss: 1.522 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.7044179439544678
Epoch: 7, Steps: 9 | Train Loss: 0.054 Vali Loss: 1.348 Vali Acc: 0.522 Test Loss: 1.348 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.342130661010742
Epoch: 8, Steps: 9 | Train Loss: 0.026 Vali Loss: 1.509 Vali Acc: 0.486 Test Loss: 1.509 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.418205738067627
Epoch: 9, Steps: 9 | Train Loss: 0.011 Vali Loss: 1.474 Vali Acc: 0.514 Test Loss: 1.474 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.35071063041687
Epoch: 10, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.491 Vali Acc: 0.522 Test Loss: 1.491 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.3270442485809326
Epoch: 11, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.451 Vali Acc: 0.514 Test Loss: 1.451 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.3329966068267822
Epoch: 12, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.420 Vali Acc: 0.565 Test Loss: 1.420 Test Acc: 0.565
Validation loss decreased (-0.543466 --> -0.565203).  Saving model ...
Epoch: 13 cost time: 3.578387975692749
Epoch: 13, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.441 Vali Acc: 0.565 Test Loss: 1.441 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.245777130126953
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.469 Vali Acc: 0.558 Test Loss: 1.469 Test Acc: 0.558
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.5773754119873047
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.480 Vali Acc: 0.565 Test Loss: 1.480 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.782315254211426
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.451 Vali Acc: 0.580 Test Loss: 1.451 Test Acc: 0.580
Validation loss decreased (-0.565203 --> -0.579696).  Saving model ...
Epoch: 17 cost time: 3.4455132484436035
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.439 Vali Acc: 0.572 Test Loss: 1.439 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.88130521774292
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.419 Vali Acc: 0.594 Test Loss: 1.419 Test Acc: 0.594
Validation loss decreased (-0.579696 --> -0.594189).  Saving model ...
Epoch: 19 cost time: 3.4410288333892822
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.430 Vali Acc: 0.594 Test Loss: 1.430 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.23873233795166
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.435 Vali Acc: 0.594 Test Loss: 1.435 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.4161391258239746
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.434 Vali Acc: 0.587 Test Loss: 1.434 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.2224745750427246
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.443 Vali Acc: 0.580 Test Loss: 1.443 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.345456600189209
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.435 Vali Acc: 0.594 Test Loss: 1.435 Test Acc: 0.594
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.4774069786071777
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.441 Vali Acc: 0.601 Test Loss: 1.441 Test Acc: 0.601
Validation loss decreased (-0.594189 --> -0.601435).  Saving model ...
Epoch: 25 cost time: 3.4442636966705322
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.444 Vali Acc: 0.601 Test Loss: 1.444 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.640178680419922
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.444 Vali Acc: 0.609 Test Loss: 1.444 Test Acc: 0.609
Validation loss decreased (-0.601435 --> -0.608681).  Saving model ...
Epoch: 27 cost time: 3.481839895248413
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.439 Vali Acc: 0.616 Test Loss: 1.439 Test Acc: 0.616
Validation loss decreased (-0.608681 --> -0.615928).  Saving model ...
Epoch: 28 cost time: 3.511425018310547
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.444 Vali Acc: 0.616 Test Loss: 1.444 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.265535593032837
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.445 Vali Acc: 0.609 Test Loss: 1.445 Test Acc: 0.609
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.2450644969940186
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.435 Vali Acc: 0.616 Test Loss: 1.435 Test Acc: 0.616
Validation loss decreased (-0.615928 --> -0.615928).  Saving model ...
Epoch: 31 cost time: 3.3775999546051025
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.436 Vali Acc: 0.616 Test Loss: 1.436 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.3351964950561523
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.437 Vali Acc: 0.609 Test Loss: 1.437 Test Acc: 0.609
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.527193546295166
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.439 Vali Acc: 0.609 Test Loss: 1.439 Test Acc: 0.609
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.387303352355957
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.454 Vali Acc: 0.601 Test Loss: 1.454 Test Acc: 0.601
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.598869800567627
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.449 Vali Acc: 0.616 Test Loss: 1.449 Test Acc: 0.616
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.351958990097046
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.452 Vali Acc: 0.616 Test Loss: 1.452 Test Acc: 0.616
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.7727136611938477
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.450 Vali Acc: 0.630 Test Loss: 1.450 Test Acc: 0.630
Validation loss decreased (-0.615928 --> -0.630420).  Saving model ...
Epoch: 38 cost time: 3.6670401096343994
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.454 Vali Acc: 0.630 Test Loss: 1.454 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.7066776752471924
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.463 Vali Acc: 0.623 Test Loss: 1.463 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.5876314640045166
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.470 Vali Acc: 0.630 Test Loss: 1.470 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 3.5076935291290283
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.479 Vali Acc: 0.630 Test Loss: 1.479 Test Acc: 0.630
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 3.419583797454834
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.485 Vali Acc: 0.630 Test Loss: 1.485 Test Acc: 0.630
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 3.2856802940368652
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.490 Vali Acc: 0.630 Test Loss: 1.490 Test Acc: 0.630
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 3.186572313308716
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.492 Vali Acc: 0.630 Test Loss: 1.492 Test Acc: 0.630
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 3.602285385131836
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.493 Vali Acc: 0.638 Test Loss: 1.493 Test Acc: 0.638
Validation loss decreased (-0.630420 --> -0.637666).  Saving model ...
Epoch: 46 cost time: 3.569492816925049
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.497 Vali Acc: 0.645 Test Loss: 1.497 Test Acc: 0.645
Validation loss decreased (-0.637666 --> -0.644913).  Saving model ...
Epoch: 47 cost time: 3.2647581100463867
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.504 Vali Acc: 0.645 Test Loss: 1.504 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.475057601928711
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.508 Vali Acc: 0.645 Test Loss: 1.508 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 3.315061569213867
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.505 Vali Acc: 0.652 Test Loss: 1.505 Test Acc: 0.652
Validation loss decreased (-0.644913 --> -0.652159).  Saving model ...
Epoch: 50 cost time: 3.439458131790161
Epoch: 50, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.507 Vali Acc: 0.659 Test Loss: 1.507 Test Acc: 0.659
Validation loss decreased (-0.652159 --> -0.659405).  Saving model ...
Epoch: 51 cost time: 3.281559467315674
Epoch: 51, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.506 Vali Acc: 0.659 Test Loss: 1.506 Test Acc: 0.659
Validation loss decreased (-0.659405 --> -0.659405).  Saving model ...
Epoch: 52 cost time: 3.390589952468872
Epoch: 52, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.509 Vali Acc: 0.659 Test Loss: 1.509 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 3.4970128536224365
Epoch: 53, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.512 Vali Acc: 0.667 Test Loss: 1.512 Test Acc: 0.667
Validation loss decreased (-0.659405 --> -0.666652).  Saving model ...
Epoch: 54 cost time: 3.258821725845337
Epoch: 54, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.515 Vali Acc: 0.667 Test Loss: 1.515 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 3.4382567405700684
Epoch: 55, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.518 Vali Acc: 0.667 Test Loss: 1.518 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 3.3116846084594727
Epoch: 56, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.519 Vali Acc: 0.667 Test Loss: 1.519 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 3.2686266899108887
Epoch: 57, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.522 Vali Acc: 0.667 Test Loss: 1.522 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 3.1667988300323486
Epoch: 58, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.523 Vali Acc: 0.667 Test Loss: 1.523 Test Acc: 0.667
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 2.9807302951812744
Epoch: 59, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.526 Vali Acc: 0.667 Test Loss: 1.526 Test Acc: 0.667
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 3.2653939723968506
Epoch: 60, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.530 Vali Acc: 0.667 Test Loss: 1.530 Test Acc: 0.667
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 3.1717209815979004
Epoch: 61, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.534 Vali Acc: 0.667 Test Loss: 1.534 Test Acc: 0.667
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 3.283360719680786
Epoch: 62, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.534 Vali Acc: 0.667 Test Loss: 1.534 Test Acc: 0.667
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 3.3943657875061035
Epoch: 63, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.535 Vali Acc: 0.667 Test Loss: 1.535 Test Acc: 0.667
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.6666666666666666
model parameter : 3240452
model size : 22.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.751123666763306
Epoch: 1, Steps: 9 | Train Loss: 1.448 Vali Loss: 1.479 Vali Acc: 0.217 Test Loss: 1.479 Test Acc: 0.217
Validation loss decreased (inf --> -0.217377).  Saving model ...
Epoch: 2 cost time: 3.5699596405029297
Epoch: 2, Steps: 9 | Train Loss: 1.280 Vali Loss: 1.443 Vali Acc: 0.254 Test Loss: 1.443 Test Acc: 0.254
Validation loss decreased (-0.217377 --> -0.253609).  Saving model ...
Epoch: 3 cost time: 3.3742048740386963
Epoch: 3, Steps: 9 | Train Loss: 0.932 Vali Loss: 1.514 Vali Acc: 0.312 Test Loss: 1.514 Test Acc: 0.312
Validation loss decreased (-0.253609 --> -0.311579).  Saving model ...
Epoch: 4 cost time: 3.474684953689575
Epoch: 4, Steps: 9 | Train Loss: 0.619 Vali Loss: 1.671 Vali Acc: 0.312 Test Loss: 1.671 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.5853679180145264
Epoch: 5, Steps: 9 | Train Loss: 0.417 Vali Loss: 1.854 Vali Acc: 0.312 Test Loss: 1.854 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.778639554977417
Epoch: 6, Steps: 9 | Train Loss: 0.241 Vali Loss: 2.176 Vali Acc: 0.312 Test Loss: 2.176 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.661005973815918
Epoch: 7, Steps: 9 | Train Loss: 0.139 Vali Loss: 1.978 Vali Acc: 0.326 Test Loss: 1.978 Test Acc: 0.326
Validation loss decreased (-0.311579 --> -0.326067).  Saving model ...
Epoch: 8 cost time: 3.51828670501709
Epoch: 8, Steps: 9 | Train Loss: 0.067 Vali Loss: 2.267 Vali Acc: 0.341 Test Loss: 2.267 Test Acc: 0.341
Validation loss decreased (-0.326067 --> -0.340557).  Saving model ...
Epoch: 9 cost time: 3.6239726543426514
Epoch: 9, Steps: 9 | Train Loss: 0.034 Vali Loss: 2.062 Vali Acc: 0.355 Test Loss: 2.062 Test Acc: 0.355
Validation loss decreased (-0.340557 --> -0.355052).  Saving model ...
Epoch: 10 cost time: 3.475998640060425
Epoch: 10, Steps: 9 | Train Loss: 0.013 Vali Loss: 2.191 Vali Acc: 0.377 Test Loss: 2.191 Test Acc: 0.377
Validation loss decreased (-0.355052 --> -0.376790).  Saving model ...
Epoch: 11 cost time: 3.73500657081604
Epoch: 11, Steps: 9 | Train Loss: 0.009 Vali Loss: 2.215 Vali Acc: 0.399 Test Loss: 2.215 Test Acc: 0.399
Validation loss decreased (-0.376790 --> -0.398529).  Saving model ...
Epoch: 12 cost time: 3.4057347774505615
Epoch: 12, Steps: 9 | Train Loss: 0.006 Vali Loss: 2.169 Vali Acc: 0.428 Test Loss: 2.169 Test Acc: 0.428
Validation loss decreased (-0.398529 --> -0.427515).  Saving model ...
Epoch: 13 cost time: 3.855480432510376
Epoch: 13, Steps: 9 | Train Loss: 0.004 Vali Loss: 2.167 Vali Acc: 0.449 Test Loss: 2.167 Test Acc: 0.449
Validation loss decreased (-0.427515 --> -0.449254).  Saving model ...
Epoch: 14 cost time: 3.723675489425659
Epoch: 14, Steps: 9 | Train Loss: 0.003 Vali Loss: 2.258 Vali Acc: 0.449 Test Loss: 2.258 Test Acc: 0.449
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.2522711753845215
Epoch: 15, Steps: 9 | Train Loss: 0.003 Vali Loss: 2.224 Vali Acc: 0.471 Test Loss: 2.224 Test Acc: 0.471
Validation loss decreased (-0.449254 --> -0.470992).  Saving model ...
Epoch: 16 cost time: 3.481238842010498
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.180 Vali Acc: 0.478 Test Loss: 2.180 Test Acc: 0.478
Validation loss decreased (-0.470992 --> -0.478239).  Saving model ...
Epoch: 17 cost time: 3.6736886501312256
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.182 Vali Acc: 0.471 Test Loss: 2.182 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.5080924034118652
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.282 Vali Acc: 0.464 Test Loss: 2.282 Test Acc: 0.464
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.543766736984253
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.229 Vali Acc: 0.471 Test Loss: 2.229 Test Acc: 0.471
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.7357919216156006
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.191 Vali Acc: 0.500 Test Loss: 2.191 Test Acc: 0.500
Validation loss decreased (-0.478239 --> -0.499978).  Saving model ...
Epoch: 21 cost time: 3.233135223388672
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.161 Vali Acc: 0.522 Test Loss: 2.161 Test Acc: 0.522
Validation loss decreased (-0.499978 --> -0.521718).  Saving model ...
Epoch: 22 cost time: 3.606692314147949
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.131 Vali Acc: 0.500 Test Loss: 2.131 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.534665584564209
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.206 Vali Acc: 0.500 Test Loss: 2.206 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.2752387523651123
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.283 Vali Acc: 0.486 Test Loss: 2.283 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.6532115936279297
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.254 Vali Acc: 0.493 Test Loss: 2.254 Test Acc: 0.493
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.36460280418396
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.215 Vali Acc: 0.500 Test Loss: 2.215 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.1788859367370605
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.230 Vali Acc: 0.507 Test Loss: 2.230 Test Acc: 0.507
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.434732437133789
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.236 Vali Acc: 0.493 Test Loss: 2.236 Test Acc: 0.493
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.499864101409912
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.218 Vali Acc: 0.493 Test Loss: 2.218 Test Acc: 0.493
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.421421766281128
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.200 Vali Acc: 0.507 Test Loss: 2.200 Test Acc: 0.507
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.686884641647339
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.218 Vali Acc: 0.514 Test Loss: 2.218 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5217391304347826
model parameter : 3240452
model size : 22.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.44283390045166
Epoch: 1, Steps: 9 | Train Loss: 1.430 Vali Loss: 1.407 Vali Acc: 0.275 Test Loss: 1.407 Test Acc: 0.275
Validation loss decreased (inf --> -0.275348).  Saving model ...
Epoch: 2 cost time: 3.238548755645752
Epoch: 2, Steps: 9 | Train Loss: 1.233 Vali Loss: 1.349 Vali Acc: 0.355 Test Loss: 1.349 Test Acc: 0.355
Validation loss decreased (-0.275348 --> -0.355059).  Saving model ...
Epoch: 3 cost time: 3.5002665519714355
Epoch: 3, Steps: 9 | Train Loss: 0.899 Vali Loss: 1.322 Vali Acc: 0.333 Test Loss: 1.322 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.3409008979797363
Epoch: 4, Steps: 9 | Train Loss: 0.582 Vali Loss: 1.296 Vali Acc: 0.362 Test Loss: 1.296 Test Acc: 0.362
Validation loss decreased (-0.355059 --> -0.362306).  Saving model ...
Epoch: 5 cost time: 3.4334421157836914
Epoch: 5, Steps: 9 | Train Loss: 0.334 Vali Loss: 1.286 Vali Acc: 0.413 Test Loss: 1.286 Test Acc: 0.413
Validation loss decreased (-0.362306 --> -0.413031).  Saving model ...
Epoch: 6 cost time: 3.489434242248535
Epoch: 6, Steps: 9 | Train Loss: 0.197 Vali Loss: 1.693 Vali Acc: 0.297 Test Loss: 1.693 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.4540467262268066
Epoch: 7, Steps: 9 | Train Loss: 0.100 Vali Loss: 1.390 Vali Acc: 0.420 Test Loss: 1.390 Test Acc: 0.420
Validation loss decreased (-0.413031 --> -0.420276).  Saving model ...
Epoch: 8 cost time: 3.4289357662200928
Epoch: 8, Steps: 9 | Train Loss: 0.049 Vali Loss: 1.558 Vali Acc: 0.377 Test Loss: 1.558 Test Acc: 0.377
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.1936001777648926
Epoch: 9, Steps: 9 | Train Loss: 0.022 Vali Loss: 1.490 Vali Acc: 0.442 Test Loss: 1.490 Test Acc: 0.442
Validation loss decreased (-0.420276 --> -0.442014).  Saving model ...
Epoch: 10 cost time: 3.2445218563079834
Epoch: 10, Steps: 9 | Train Loss: 0.011 Vali Loss: 1.488 Vali Acc: 0.413 Test Loss: 1.488 Test Acc: 0.413
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.564500570297241
Epoch: 11, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.406 Vali Acc: 0.478 Test Loss: 1.406 Test Acc: 0.478
Validation loss decreased (-0.442014 --> -0.478247).  Saving model ...
Epoch: 12 cost time: 3.2452197074890137
Epoch: 12, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.383 Vali Acc: 0.500 Test Loss: 1.383 Test Acc: 0.500
Validation loss decreased (-0.478247 --> -0.499986).  Saving model ...
Epoch: 13 cost time: 3.4205551147460938
Epoch: 13, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.491 Vali Acc: 0.486 Test Loss: 1.491 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.321632146835327
Epoch: 14, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.468 Vali Acc: 0.486 Test Loss: 1.468 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.253634214401245
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.425 Vali Acc: 0.522 Test Loss: 1.425 Test Acc: 0.522
Validation loss decreased (-0.499986 --> -0.521725).  Saving model ...
Epoch: 16 cost time: 3.353692054748535
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.397 Vali Acc: 0.529 Test Loss: 1.397 Test Acc: 0.529
Validation loss decreased (-0.521725 --> -0.528972).  Saving model ...
Epoch: 17 cost time: 3.2972140312194824
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.412 Vali Acc: 0.522 Test Loss: 1.412 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.0405917167663574
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.432 Vali Acc: 0.536 Test Loss: 1.432 Test Acc: 0.536
Validation loss decreased (-0.528972 --> -0.536218).  Saving model ...
Epoch: 19 cost time: 3.3600504398345947
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.420 Vali Acc: 0.565 Test Loss: 1.420 Test Acc: 0.565
Validation loss decreased (-0.536218 --> -0.565203).  Saving model ...
Epoch: 20 cost time: 3.0771584510803223
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.406 Vali Acc: 0.580 Test Loss: 1.406 Test Acc: 0.580
Validation loss decreased (-0.565203 --> -0.579696).  Saving model ...
Epoch: 21 cost time: 3.516707420349121
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.398 Vali Acc: 0.594 Test Loss: 1.398 Test Acc: 0.594
Validation loss decreased (-0.579696 --> -0.594189).  Saving model ...
Epoch: 22 cost time: 3.392475128173828
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.410 Vali Acc: 0.565 Test Loss: 1.410 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.208953857421875
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.425 Vali Acc: 0.558 Test Loss: 1.425 Test Acc: 0.558
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.343003511428833
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.443 Vali Acc: 0.551 Test Loss: 1.443 Test Acc: 0.551
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.526808738708496
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.433 Vali Acc: 0.551 Test Loss: 1.433 Test Acc: 0.551
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.0620129108428955
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.423 Vali Acc: 0.580 Test Loss: 1.423 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.1693594455718994
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.433 Vali Acc: 0.580 Test Loss: 1.433 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.330754280090332
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.443 Vali Acc: 0.587 Test Loss: 1.443 Test Acc: 0.587
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.1477088928222656
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.446 Vali Acc: 0.587 Test Loss: 1.446 Test Acc: 0.587
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.2476978302001953
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.444 Vali Acc: 0.587 Test Loss: 1.444 Test Acc: 0.587
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.718109607696533
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.453 Vali Acc: 0.587 Test Loss: 1.453 Test Acc: 0.587
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5942028985507246
model parameter : 3240452
model size : 22.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         103                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df128_ma103_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.088080167770386
Epoch: 1, Steps: 9 | Train Loss: 1.420 Vali Loss: 1.267 Vali Acc: 0.435 Test Loss: 1.267 Test Acc: 0.435
Validation loss decreased (inf --> -0.434770).  Saving model ...
Epoch: 2 cost time: 3.61629319190979
Epoch: 2, Steps: 9 | Train Loss: 0.969 Vali Loss: 1.003 Vali Acc: 0.594 Test Loss: 1.003 Test Acc: 0.594
Validation loss decreased (-0.434770 --> -0.594193).  Saving model ...
Epoch: 3 cost time: 3.606529712677002
Epoch: 3, Steps: 9 | Train Loss: 0.472 Vali Loss: 0.742 Vali Acc: 0.710 Test Loss: 0.742 Test Acc: 0.710
Validation loss decreased (-0.594193 --> -0.710138).  Saving model ...
Epoch: 4 cost time: 3.698580503463745
Epoch: 4, Steps: 9 | Train Loss: 0.209 Vali Loss: 0.752 Vali Acc: 0.717 Test Loss: 0.752 Test Acc: 0.717
Validation loss decreased (-0.710138 --> -0.717384).  Saving model ...
Epoch: 5 cost time: 3.684110164642334
Epoch: 5, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.676 Vali Acc: 0.739 Test Loss: 0.676 Test Acc: 0.739
Validation loss decreased (-0.717384 --> -0.739124).  Saving model ...
Epoch: 6 cost time: 3.6241981983184814
Epoch: 6, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.665 Vali Acc: 0.783 Test Loss: 0.665 Test Acc: 0.783
Validation loss decreased (-0.739124 --> -0.782602).  Saving model ...
Epoch: 7 cost time: 3.8105478286743164
Epoch: 7, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.781 Vali Acc: 0.732 Test Loss: 0.781 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.654876708984375
Epoch: 8, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.711 Vali Acc: 0.768 Test Loss: 0.711 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.7212252616882324
Epoch: 9, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.704 Vali Acc: 0.790 Test Loss: 0.704 Test Acc: 0.790
Validation loss decreased (-0.782602 --> -0.789848).  Saving model ...
Epoch: 10 cost time: 4.037522554397583
Epoch: 10, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.756 Vali Acc: 0.746 Test Loss: 0.756 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.503643035888672
Epoch: 11, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.762 Vali Acc: 0.754 Test Loss: 0.762 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.702218532562256
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.749 Vali Acc: 0.754 Test Loss: 0.749 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.6171517372131348
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.736 Vali Acc: 0.768 Test Loss: 0.736 Test Acc: 0.768
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.009755849838257
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.728 Vali Acc: 0.754 Test Loss: 0.728 Test Acc: 0.754
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.903129816055298
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.736 Vali Acc: 0.746 Test Loss: 0.736 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.507892370223999
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.742 Vali Acc: 0.761 Test Loss: 0.742 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.6956446170806885
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.748 Vali Acc: 0.746 Test Loss: 0.748 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.473010301589966
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.747 Vali Acc: 0.739 Test Loss: 0.747 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.665724515914917
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.749 Vali Acc: 0.768 Test Loss: 0.749 Test Acc: 0.768
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df128_ma103_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7898550724637681
model parameter : 3043844
model size : 21.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         83                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df128_ma83_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.209227085113525
Epoch: 1, Steps: 9 | Train Loss: 1.416 Vali Loss: 1.260 Vali Acc: 0.442 Test Loss: 1.260 Test Acc: 0.442
Validation loss decreased (inf --> -0.442016).  Saving model ...
Epoch: 2 cost time: 3.5053865909576416
Epoch: 2, Steps: 9 | Train Loss: 0.966 Vali Loss: 0.993 Vali Acc: 0.601 Test Loss: 0.993 Test Acc: 0.601
Validation loss decreased (-0.442016 --> -0.601439).  Saving model ...
Epoch: 3 cost time: 3.5916285514831543
Epoch: 3, Steps: 9 | Train Loss: 0.477 Vali Loss: 0.728 Vali Acc: 0.717 Test Loss: 0.728 Test Acc: 0.717
Validation loss decreased (-0.601439 --> -0.717384).  Saving model ...
Epoch: 4 cost time: 3.468705654144287
Epoch: 4, Steps: 9 | Train Loss: 0.210 Vali Loss: 0.747 Vali Acc: 0.725 Test Loss: 0.747 Test Acc: 0.725
Validation loss decreased (-0.717384 --> -0.724630).  Saving model ...
Epoch: 5 cost time: 3.565964937210083
Epoch: 5, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.669 Vali Acc: 0.739 Test Loss: 0.669 Test Acc: 0.739
Validation loss decreased (-0.724630 --> -0.739124).  Saving model ...
Epoch: 6 cost time: 3.4724507331848145
Epoch: 6, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.629 Vali Acc: 0.790 Test Loss: 0.629 Test Acc: 0.790
Validation loss decreased (-0.739124 --> -0.789849).  Saving model ...
Epoch: 7 cost time: 3.092694044113159
Epoch: 7, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.732 Vali Acc: 0.754 Test Loss: 0.732 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.260565996170044
Epoch: 8, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.705 Vali Acc: 0.768 Test Loss: 0.705 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.3852288722991943
Epoch: 9, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.650 Vali Acc: 0.797 Test Loss: 0.650 Test Acc: 0.797
Validation loss decreased (-0.789849 --> -0.797095).  Saving model ...
Epoch: 10 cost time: 3.0450758934020996
Epoch: 10, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.715 Vali Acc: 0.775 Test Loss: 0.715 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.352172613143921
Epoch: 11, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.719 Vali Acc: 0.775 Test Loss: 0.719 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.5331242084503174
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.707 Vali Acc: 0.775 Test Loss: 0.707 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.592048168182373
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.693 Vali Acc: 0.790 Test Loss: 0.693 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.378598213195801
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.698 Vali Acc: 0.790 Test Loss: 0.698 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.594928741455078
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.708 Vali Acc: 0.790 Test Loss: 0.708 Test Acc: 0.790
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.44370698928833
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.712 Vali Acc: 0.790 Test Loss: 0.712 Test Acc: 0.790
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.6004438400268555
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.711 Vali Acc: 0.783 Test Loss: 0.711 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.332125663757324
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.708 Vali Acc: 0.797 Test Loss: 0.708 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.6315369606018066
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.708 Vali Acc: 0.797 Test Loss: 0.708 Test Acc: 0.797
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df128_ma83_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7971014492753623
model parameter : 3043844
model size : 21.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         62                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df128_ma62_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.65829062461853
Epoch: 1, Steps: 9 | Train Loss: 1.415 Vali Loss: 1.265 Vali Acc: 0.457 Test Loss: 1.265 Test Acc: 0.457
Validation loss decreased (inf --> -0.456509).  Saving model ...
Epoch: 2 cost time: 3.0154590606689453
Epoch: 2, Steps: 9 | Train Loss: 0.961 Vali Loss: 0.997 Vali Acc: 0.609 Test Loss: 0.997 Test Acc: 0.609
Validation loss decreased (-0.456509 --> -0.608686).  Saving model ...
Epoch: 3 cost time: 3.1526572704315186
Epoch: 3, Steps: 9 | Train Loss: 0.466 Vali Loss: 0.745 Vali Acc: 0.710 Test Loss: 0.745 Test Acc: 0.710
Validation loss decreased (-0.608686 --> -0.710137).  Saving model ...
Epoch: 4 cost time: 3.256594657897949
Epoch: 4, Steps: 9 | Train Loss: 0.199 Vali Loss: 0.781 Vali Acc: 0.717 Test Loss: 0.781 Test Acc: 0.717
Validation loss decreased (-0.710137 --> -0.717383).  Saving model ...
Epoch: 5 cost time: 3.3043806552886963
Epoch: 5, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.687 Vali Acc: 0.739 Test Loss: 0.687 Test Acc: 0.739
Validation loss decreased (-0.717383 --> -0.739124).  Saving model ...
Epoch: 6 cost time: 3.4839580059051514
Epoch: 6, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.635 Vali Acc: 0.819 Test Loss: 0.635 Test Acc: 0.819
Validation loss decreased (-0.739124 --> -0.818834).  Saving model ...
Epoch: 7 cost time: 3.478620767593384
Epoch: 7, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.755 Vali Acc: 0.783 Test Loss: 0.755 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.4351096153259277
Epoch: 8, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.710 Vali Acc: 0.775 Test Loss: 0.710 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.642439603805542
Epoch: 9, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.644 Vali Acc: 0.812 Test Loss: 0.644 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.1528890132904053
Epoch: 10, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.724 Vali Acc: 0.797 Test Loss: 0.724 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.423898696899414
Epoch: 11, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.733 Vali Acc: 0.797 Test Loss: 0.733 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.2966225147247314
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.697 Vali Acc: 0.783 Test Loss: 0.697 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.3051493167877197
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.679 Vali Acc: 0.804 Test Loss: 0.679 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.4599955081939697
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.684 Vali Acc: 0.819 Test Loss: 0.684 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.1376073360443115
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.701 Vali Acc: 0.812 Test Loss: 0.701 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.2402894496917725
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.698 Vali Acc: 0.812 Test Loss: 0.698 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df128_ma62_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8188405797101449
model parameter : 3043844
model size : 21.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         42                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df128_ma42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.8955771923065186
Epoch: 1, Steps: 9 | Train Loss: 1.398 Vali Loss: 1.209 Vali Acc: 0.507 Test Loss: 1.209 Test Acc: 0.507
Validation loss decreased (inf --> -0.507234).  Saving model ...
Epoch: 2 cost time: 3.2977709770202637
Epoch: 2, Steps: 9 | Train Loss: 0.934 Vali Loss: 0.940 Vali Acc: 0.659 Test Loss: 0.940 Test Acc: 0.659
Validation loss decreased (-0.507234 --> -0.659411).  Saving model ...
Epoch: 3 cost time: 3.4499335289001465
Epoch: 3, Steps: 9 | Train Loss: 0.450 Vali Loss: 0.698 Vali Acc: 0.717 Test Loss: 0.698 Test Acc: 0.717
Validation loss decreased (-0.659411 --> -0.717384).  Saving model ...
Epoch: 4 cost time: 3.2882866859436035
Epoch: 4, Steps: 9 | Train Loss: 0.195 Vali Loss: 0.739 Vali Acc: 0.732 Test Loss: 0.739 Test Acc: 0.732
Validation loss decreased (-0.717384 --> -0.731877).  Saving model ...
Epoch: 5 cost time: 3.3096985816955566
Epoch: 5, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.608 Vali Acc: 0.761 Test Loss: 0.608 Test Acc: 0.761
Validation loss decreased (-0.731877 --> -0.760863).  Saving model ...
Epoch: 6 cost time: 3.2786645889282227
Epoch: 6, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.598 Vali Acc: 0.775 Test Loss: 0.598 Test Acc: 0.775
Validation loss decreased (-0.760863 --> -0.775356).  Saving model ...
Epoch: 7 cost time: 3.198850154876709
Epoch: 7, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.681 Vali Acc: 0.775 Test Loss: 0.681 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.2409701347351074
Epoch: 8, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.627 Vali Acc: 0.783 Test Loss: 0.627 Test Acc: 0.783
Validation loss decreased (-0.775356 --> -0.782602).  Saving model ...
Epoch: 9 cost time: 3.1107683181762695
Epoch: 9, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.607 Vali Acc: 0.775 Test Loss: 0.607 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.6924986839294434
Epoch: 10, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.660 Vali Acc: 0.783 Test Loss: 0.660 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.455618143081665
Epoch: 11, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.665 Vali Acc: 0.797 Test Loss: 0.665 Test Acc: 0.797
Validation loss decreased (-0.782602 --> -0.797095).  Saving model ...
Epoch: 12 cost time: 3.511870861053467
Epoch: 12, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.646 Vali Acc: 0.790 Test Loss: 0.646 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.65555739402771
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.635 Vali Acc: 0.804 Test Loss: 0.635 Test Acc: 0.804
Validation loss decreased (-0.797095 --> -0.804341).  Saving model ...
Epoch: 14 cost time: 3.449556589126587
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.640 Vali Acc: 0.804 Test Loss: 0.640 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.4168524742126465
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.657 Vali Acc: 0.804 Test Loss: 0.657 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.4115874767303467
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.651 Vali Acc: 0.804 Test Loss: 0.651 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.4028544425964355
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.646 Vali Acc: 0.797 Test Loss: 0.646 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.5504038333892822
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.646 Vali Acc: 0.797 Test Loss: 0.646 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.631319999694824
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.652 Vali Acc: 0.812 Test Loss: 0.652 Test Acc: 0.812
Validation loss decreased (-0.804341 --> -0.811588).  Saving model ...
Epoch: 20 cost time: 3.6248865127563477
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.648 Vali Acc: 0.812 Test Loss: 0.648 Test Acc: 0.812
Validation loss decreased (-0.811588 --> -0.811588).  Saving model ...
Epoch: 21 cost time: 3.2356441020965576
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.644 Vali Acc: 0.812 Test Loss: 0.644 Test Acc: 0.812
Validation loss decreased (-0.811588 --> -0.811588).  Saving model ...
Epoch: 22 cost time: 3.3237838745117188
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.647 Vali Acc: 0.797 Test Loss: 0.647 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.262678623199463
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.655 Vali Acc: 0.797 Test Loss: 0.655 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.2938976287841797
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.660 Vali Acc: 0.790 Test Loss: 0.660 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.460222005844116
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.668 Vali Acc: 0.797 Test Loss: 0.668 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.2856876850128174
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.656 Vali Acc: 0.797 Test Loss: 0.656 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.3107311725616455
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.657 Vali Acc: 0.790 Test Loss: 0.657 Test Acc: 0.790
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.0734498500823975
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.678 Vali Acc: 0.790 Test Loss: 0.678 Test Acc: 0.790
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.999023675918579
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.670 Vali Acc: 0.790 Test Loss: 0.670 Test Acc: 0.790
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.1024041175842285
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.662 Vali Acc: 0.797 Test Loss: 0.662 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.460570812225342
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.663 Vali Acc: 0.804 Test Loss: 0.663 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df128_ma42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8115942028985508
model parameter : 3043844
model size : 21.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df128_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.070847511291504
Epoch: 1, Steps: 9 | Train Loss: 1.428 Vali Loss: 1.254 Vali Acc: 0.493 Test Loss: 1.254 Test Acc: 0.493
Validation loss decreased (inf --> -0.492741).  Saving model ...
Epoch: 2 cost time: 3.4540679454803467
Epoch: 2, Steps: 9 | Train Loss: 0.971 Vali Loss: 0.971 Vali Acc: 0.623 Test Loss: 0.971 Test Acc: 0.623
Validation loss decreased (-0.492741 --> -0.623179).  Saving model ...
Epoch: 3 cost time: 3.297029733657837
Epoch: 3, Steps: 9 | Train Loss: 0.471 Vali Loss: 0.741 Vali Acc: 0.725 Test Loss: 0.741 Test Acc: 0.725
Validation loss decreased (-0.623179 --> -0.724630).  Saving model ...
Epoch: 4 cost time: 3.210613250732422
Epoch: 4, Steps: 9 | Train Loss: 0.219 Vali Loss: 0.700 Vali Acc: 0.739 Test Loss: 0.700 Test Acc: 0.739
Validation loss decreased (-0.724630 --> -0.739123).  Saving model ...
Epoch: 5 cost time: 3.4487218856811523
Epoch: 5, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.579 Vali Acc: 0.761 Test Loss: 0.579 Test Acc: 0.761
Validation loss decreased (-0.739123 --> -0.760864).  Saving model ...
Epoch: 6 cost time: 3.597947359085083
Epoch: 6, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.575 Vali Acc: 0.812 Test Loss: 0.575 Test Acc: 0.812
Validation loss decreased (-0.760864 --> -0.811588).  Saving model ...
Epoch: 7 cost time: 3.1834816932678223
Epoch: 7, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.586 Vali Acc: 0.797 Test Loss: 0.586 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.32651424407959
Epoch: 8, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.532 Vali Acc: 0.804 Test Loss: 0.532 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.450159788131714
Epoch: 9, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.513 Vali Acc: 0.790 Test Loss: 0.513 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.983757495880127
Epoch: 10, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.518 Vali Acc: 0.797 Test Loss: 0.518 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.4390697479248047
Epoch: 11, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.540 Vali Acc: 0.812 Test Loss: 0.540 Test Acc: 0.812
Validation loss decreased (-0.811588 --> -0.811589).  Saving model ...
Epoch: 12 cost time: 3.457245111465454
Epoch: 12, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.525 Vali Acc: 0.812 Test Loss: 0.525 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811589).  Saving model ...
Epoch: 13 cost time: 3.209221363067627
Epoch: 13, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.505 Vali Acc: 0.819 Test Loss: 0.505 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818836).  Saving model ...
Epoch: 14 cost time: 3.6132395267486572
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.496 Vali Acc: 0.826 Test Loss: 0.496 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826082).  Saving model ...
Epoch: 15 cost time: 3.779527187347412
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.501 Vali Acc: 0.819 Test Loss: 0.501 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.083866834640503
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.507 Vali Acc: 0.826 Test Loss: 0.507 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.3898229598999023
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.506 Vali Acc: 0.833 Test Loss: 0.506 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833328).  Saving model ...
Epoch: 18 cost time: 3.337327003479004
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.501 Vali Acc: 0.833 Test Loss: 0.501 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 19 cost time: 3.309211015701294
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.493 Vali Acc: 0.833 Test Loss: 0.493 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 20 cost time: 3.455026626586914
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.490 Vali Acc: 0.833 Test Loss: 0.490 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 21 cost time: 3.553471803665161
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.497 Vali Acc: 0.833 Test Loss: 0.497 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.5571999549865723
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.491 Vali Acc: 0.833 Test Loss: 0.491 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.376678466796875
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.501 Vali Acc: 0.841 Test Loss: 0.501 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840575).  Saving model ...
Epoch: 24 cost time: 3.53772234916687
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.502 Vali Acc: 0.841 Test Loss: 0.502 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.4214959144592285
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.505 Vali Acc: 0.841 Test Loss: 0.505 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.2929797172546387
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.494 Vali Acc: 0.841 Test Loss: 0.494 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 27 cost time: 3.6028342247009277
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.496 Vali Acc: 0.848 Test Loss: 0.496 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 28 cost time: 3.2986226081848145
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.517 Vali Acc: 0.841 Test Loss: 0.517 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.399461269378662
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.508 Vali Acc: 0.841 Test Loss: 0.508 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.665342092514038
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.497 Vali Acc: 0.841 Test Loss: 0.497 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.326150894165039
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.499 Vali Acc: 0.848 Test Loss: 0.499 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.6149559020996094
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.502 Vali Acc: 0.848 Test Loss: 0.502 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.2123053073883057
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.510 Vali Acc: 0.848 Test Loss: 0.510 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.5886058807373047
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.509 Vali Acc: 0.855 Test Loss: 0.509 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855067).  Saving model ...
Epoch: 35 cost time: 3.431619167327881
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.498 Vali Acc: 0.848 Test Loss: 0.498 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.4504141807556152
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.506 Vali Acc: 0.848 Test Loss: 0.506 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.621445655822754
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.509 Vali Acc: 0.848 Test Loss: 0.509 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.7242038249969482
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.510 Vali Acc: 0.848 Test Loss: 0.510 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.5265233516693115
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.506 Vali Acc: 0.848 Test Loss: 0.506 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.43843674659729
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.506 Vali Acc: 0.848 Test Loss: 0.506 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 3.53507924079895
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.511 Vali Acc: 0.841 Test Loss: 0.511 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 3.741389036178589
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.515 Vali Acc: 0.841 Test Loss: 0.515 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.783827066421509
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.525 Vali Acc: 0.841 Test Loss: 0.525 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 3.363823175430298
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.522 Vali Acc: 0.841 Test Loss: 0.522 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df128_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 3043844
model size : 21.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df128_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.02507758140564
Epoch: 1, Steps: 9 | Train Loss: 1.382 Vali Loss: 1.192 Vali Acc: 0.471 Test Loss: 1.192 Test Acc: 0.471
Validation loss decreased (inf --> -0.471003).  Saving model ...
Epoch: 2 cost time: 3.1112706661224365
Epoch: 2, Steps: 9 | Train Loss: 0.958 Vali Loss: 0.962 Vali Acc: 0.638 Test Loss: 0.962 Test Acc: 0.638
Validation loss decreased (-0.471003 --> -0.637672).  Saving model ...
Epoch: 3 cost time: 3.2368860244750977
Epoch: 3, Steps: 9 | Train Loss: 0.513 Vali Loss: 0.746 Vali Acc: 0.717 Test Loss: 0.746 Test Acc: 0.717
Validation loss decreased (-0.637672 --> -0.717384).  Saving model ...
Epoch: 4 cost time: 3.1831276416778564
Epoch: 4, Steps: 9 | Train Loss: 0.243 Vali Loss: 0.804 Vali Acc: 0.703 Test Loss: 0.804 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.062277317047119
Epoch: 5, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.657 Vali Acc: 0.754 Test Loss: 0.657 Test Acc: 0.754
Validation loss decreased (-0.717384 --> -0.753617).  Saving model ...
Epoch: 6 cost time: 3.2784829139709473
Epoch: 6, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.681 Vali Acc: 0.732 Test Loss: 0.681 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.123854875564575
Epoch: 7, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.695 Vali Acc: 0.754 Test Loss: 0.695 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.3426060676574707
Epoch: 8, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.676 Vali Acc: 0.761 Test Loss: 0.676 Test Acc: 0.761
Validation loss decreased (-0.753617 --> -0.760863).  Saving model ...
Epoch: 9 cost time: 3.0899243354797363
Epoch: 9, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.657 Vali Acc: 0.739 Test Loss: 0.657 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.2652320861816406
Epoch: 10, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.729 Vali Acc: 0.754 Test Loss: 0.729 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.394448757171631
Epoch: 11, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.709 Vali Acc: 0.761 Test Loss: 0.709 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.2909340858459473
Epoch: 12, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.688 Vali Acc: 0.746 Test Loss: 0.688 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.245335578918457
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.700 Vali Acc: 0.754 Test Loss: 0.700 Test Acc: 0.754
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.185183525085449
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.701 Vali Acc: 0.754 Test Loss: 0.701 Test Acc: 0.754
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.965379476547241
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.704 Vali Acc: 0.761 Test Loss: 0.704 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.0335779190063477
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.693 Vali Acc: 0.754 Test Loss: 0.693 Test Acc: 0.754
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.048130512237549
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.704 Vali Acc: 0.754 Test Loss: 0.704 Test Acc: 0.754
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.261718273162842
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.711 Vali Acc: 0.754 Test Loss: 0.711 Test Acc: 0.754
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df128_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7608695652173914
model parameter : 3043844
model size : 21.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df128_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.863295078277588
Epoch: 1, Steps: 9 | Train Loss: 1.388 Vali Loss: 1.205 Vali Acc: 0.493 Test Loss: 1.205 Test Acc: 0.493
Validation loss decreased (inf --> -0.492742).  Saving model ...
Epoch: 2 cost time: 3.393463611602783
Epoch: 2, Steps: 9 | Train Loss: 0.960 Vali Loss: 1.013 Vali Acc: 0.594 Test Loss: 1.013 Test Acc: 0.594
Validation loss decreased (-0.492742 --> -0.594193).  Saving model ...
Epoch: 3 cost time: 3.5517995357513428
Epoch: 3, Steps: 9 | Train Loss: 0.534 Vali Loss: 0.878 Vali Acc: 0.667 Test Loss: 0.878 Test Acc: 0.667
Validation loss decreased (-0.594193 --> -0.666658).  Saving model ...
Epoch: 4 cost time: 3.34232759475708
Epoch: 4, Steps: 9 | Train Loss: 0.259 Vali Loss: 0.915 Vali Acc: 0.638 Test Loss: 0.915 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.511848211288452
Epoch: 5, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.857 Vali Acc: 0.681 Test Loss: 0.857 Test Acc: 0.681
Validation loss decreased (-0.666658 --> -0.681151).  Saving model ...
Epoch: 6 cost time: 3.0367867946624756
Epoch: 6, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.864 Vali Acc: 0.667 Test Loss: 0.864 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.2516496181488037
Epoch: 7, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.913 Vali Acc: 0.696 Test Loss: 0.913 Test Acc: 0.696
Validation loss decreased (-0.681151 --> -0.695643).  Saving model ...
Epoch: 8 cost time: 3.122263193130493
Epoch: 8, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.945 Vali Acc: 0.674 Test Loss: 0.945 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.399864435195923
Epoch: 9, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.969 Vali Acc: 0.674 Test Loss: 0.969 Test Acc: 0.674
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.272740125656128
Epoch: 10, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.978 Vali Acc: 0.674 Test Loss: 0.978 Test Acc: 0.674
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.3773763179779053
Epoch: 11, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.019 Vali Acc: 0.681 Test Loss: 1.019 Test Acc: 0.681
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.1824209690093994
Epoch: 12, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.010 Vali Acc: 0.688 Test Loss: 1.010 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.3462071418762207
Epoch: 13, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.999 Vali Acc: 0.688 Test Loss: 0.999 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.2843668460845947
Epoch: 14, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.003 Vali Acc: 0.688 Test Loss: 1.003 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.3047468662261963
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.005 Vali Acc: 0.688 Test Loss: 1.005 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.957336902618408
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.009 Vali Acc: 0.681 Test Loss: 1.009 Test Acc: 0.681
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.2001965045928955
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.015 Vali Acc: 0.681 Test Loss: 1.015 Test Acc: 0.681
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df128_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.6956521739130435
model parameter : 3043844
model size : 21.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.816391706466675
Epoch: 1, Steps: 9 | Train Loss: 1.436 Vali Loss: 1.369 Vali Acc: 0.326 Test Loss: 1.369 Test Acc: 0.326
Validation loss decreased (inf --> -0.326073).  Saving model ...
Epoch: 2 cost time: 3.3628547191619873
Epoch: 2, Steps: 9 | Train Loss: 1.138 Vali Loss: 1.272 Vali Acc: 0.406 Test Loss: 1.272 Test Acc: 0.406
Validation loss decreased (-0.326073 --> -0.405784).  Saving model ...
Epoch: 3 cost time: 3.5033340454101562
Epoch: 3, Steps: 9 | Train Loss: 0.699 Vali Loss: 1.221 Vali Acc: 0.457 Test Loss: 1.221 Test Acc: 0.457
Validation loss decreased (-0.405784 --> -0.456510).  Saving model ...
Epoch: 4 cost time: 3.2198095321655273
Epoch: 4, Steps: 9 | Train Loss: 0.398 Vali Loss: 1.305 Vali Acc: 0.384 Test Loss: 1.305 Test Acc: 0.384
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.202409029006958
Epoch: 5, Steps: 9 | Train Loss: 0.213 Vali Loss: 1.292 Vali Acc: 0.507 Test Loss: 1.292 Test Acc: 0.507
Validation loss decreased (-0.456510 --> -0.507233).  Saving model ...
Epoch: 6 cost time: 3.49403977394104
Epoch: 6, Steps: 9 | Train Loss: 0.107 Vali Loss: 1.357 Vali Acc: 0.471 Test Loss: 1.357 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.3698313236236572
Epoch: 7, Steps: 9 | Train Loss: 0.044 Vali Loss: 1.343 Vali Acc: 0.486 Test Loss: 1.343 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.433608055114746
Epoch: 8, Steps: 9 | Train Loss: 0.023 Vali Loss: 1.546 Vali Acc: 0.457 Test Loss: 1.546 Test Acc: 0.457
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.2030606269836426
Epoch: 9, Steps: 9 | Train Loss: 0.013 Vali Loss: 1.406 Vali Acc: 0.514 Test Loss: 1.406 Test Acc: 0.514
Validation loss decreased (-0.507233 --> -0.514479).  Saving model ...
Epoch: 10 cost time: 3.2290964126586914
Epoch: 10, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.600 Vali Acc: 0.493 Test Loss: 1.600 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.2816805839538574
Epoch: 11, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.620 Vali Acc: 0.493 Test Loss: 1.620 Test Acc: 0.493
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.306626319885254
Epoch: 12, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.490 Vali Acc: 0.522 Test Loss: 1.490 Test Acc: 0.522
Validation loss decreased (-0.514479 --> -0.521724).  Saving model ...
Epoch: 13 cost time: 3.2866361141204834
Epoch: 13, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.515 Vali Acc: 0.522 Test Loss: 1.515 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.5888240337371826
Epoch: 14, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.538 Vali Acc: 0.522 Test Loss: 1.538 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.301985025405884
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.495 Vali Acc: 0.536 Test Loss: 1.495 Test Acc: 0.536
Validation loss decreased (-0.521724 --> -0.536217).  Saving model ...
Epoch: 16 cost time: 3.4393720626831055
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.508 Vali Acc: 0.529 Test Loss: 1.508 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.2020742893218994
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.523 Vali Acc: 0.522 Test Loss: 1.523 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.3145904541015625
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.524 Vali Acc: 0.536 Test Loss: 1.524 Test Acc: 0.536
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.5156257152557373
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.507 Vali Acc: 0.536 Test Loss: 1.507 Test Acc: 0.536
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.3080532550811768
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.491 Vali Acc: 0.543 Test Loss: 1.491 Test Acc: 0.543
Validation loss decreased (-0.536217 --> -0.543463).  Saving model ...
Epoch: 21 cost time: 3.3412697315216064
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.488 Vali Acc: 0.551 Test Loss: 1.488 Test Acc: 0.551
Validation loss decreased (-0.543463 --> -0.550710).  Saving model ...
Epoch: 22 cost time: 3.331284284591675
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.495 Vali Acc: 0.551 Test Loss: 1.495 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.4114177227020264
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.497 Vali Acc: 0.551 Test Loss: 1.497 Test Acc: 0.551
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.659092664718628
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.494 Vali Acc: 0.558 Test Loss: 1.494 Test Acc: 0.558
Validation loss decreased (-0.550710 --> -0.557956).  Saving model ...
Epoch: 25 cost time: 3.467437744140625
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.491 Vali Acc: 0.558 Test Loss: 1.491 Test Acc: 0.558
Validation loss decreased (-0.557956 --> -0.557956).  Saving model ...
Epoch: 26 cost time: 3.636301279067993
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.508 Vali Acc: 0.558 Test Loss: 1.508 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.69952654838562
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.516 Vali Acc: 0.565 Test Loss: 1.516 Test Acc: 0.565
Validation loss decreased (-0.557956 --> -0.565202).  Saving model ...
Epoch: 28 cost time: 3.3514554500579834
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.509 Vali Acc: 0.565 Test Loss: 1.509 Test Acc: 0.565
Validation loss decreased (-0.565202 --> -0.565202).  Saving model ...
Epoch: 29 cost time: 3.3425419330596924
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.508 Vali Acc: 0.572 Test Loss: 1.508 Test Acc: 0.572
Validation loss decreased (-0.565202 --> -0.572449).  Saving model ...
Epoch: 30 cost time: 3.2545957565307617
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.517 Vali Acc: 0.580 Test Loss: 1.517 Test Acc: 0.580
Validation loss decreased (-0.572449 --> -0.579695).  Saving model ...
Epoch: 31 cost time: 3.2425718307495117
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.518 Vali Acc: 0.580 Test Loss: 1.518 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.254122734069824
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.513 Vali Acc: 0.580 Test Loss: 1.513 Test Acc: 0.580
Validation loss decreased (-0.579695 --> -0.579695).  Saving model ...
Epoch: 33 cost time: 3.445280075073242
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.516 Vali Acc: 0.580 Test Loss: 1.516 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.3398330211639404
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.524 Vali Acc: 0.580 Test Loss: 1.524 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.633972644805908
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.524 Vali Acc: 0.580 Test Loss: 1.524 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.0853466987609863
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.521 Vali Acc: 0.580 Test Loss: 1.521 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.1002278327941895
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.520 Vali Acc: 0.587 Test Loss: 1.520 Test Acc: 0.587
Validation loss decreased (-0.579695 --> -0.586941).  Saving model ...
Epoch: 38 cost time: 3.189434051513672
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.526 Vali Acc: 0.587 Test Loss: 1.526 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.0374703407287598
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.539 Vali Acc: 0.594 Test Loss: 1.539 Test Acc: 0.594
Validation loss decreased (-0.586941 --> -0.594188).  Saving model ...
Epoch: 40 cost time: 3.472210168838501
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.548 Vali Acc: 0.594 Test Loss: 1.548 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.9987900257110596
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.549 Vali Acc: 0.587 Test Loss: 1.549 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.465008020401001
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.547 Vali Acc: 0.587 Test Loss: 1.547 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.0949196815490723
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.540 Vali Acc: 0.580 Test Loss: 1.540 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.596712589263916
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.539 Vali Acc: 0.580 Test Loss: 1.539 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 3.230182647705078
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.546 Vali Acc: 0.587 Test Loss: 1.546 Test Acc: 0.587
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 3.1984992027282715
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.555 Vali Acc: 0.594 Test Loss: 1.555 Test Acc: 0.594
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 3.1710257530212402
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.567 Vali Acc: 0.587 Test Loss: 1.567 Test Acc: 0.587
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 3.2939820289611816
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.563 Vali Acc: 0.587 Test Loss: 1.563 Test Acc: 0.587
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 3.1157848834991455
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.561 Vali Acc: 0.587 Test Loss: 1.561 Test Acc: 0.587
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5942028985507246
model parameter : 3043844
model size : 21.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.56931471824646
Epoch: 1, Steps: 9 | Train Loss: 1.435 Vali Loss: 1.425 Vali Acc: 0.239 Test Loss: 1.425 Test Acc: 0.239
Validation loss decreased (inf --> -0.239116).  Saving model ...
Epoch: 2 cost time: 3.3917784690856934
Epoch: 2, Steps: 9 | Train Loss: 1.229 Vali Loss: 1.432 Vali Acc: 0.246 Test Loss: 1.432 Test Acc: 0.246
Validation loss decreased (-0.239116 --> -0.246362).  Saving model ...
Epoch: 3 cost time: 3.4202756881713867
Epoch: 3, Steps: 9 | Train Loss: 0.945 Vali Loss: 1.498 Vali Acc: 0.283 Test Loss: 1.498 Test Acc: 0.283
Validation loss decreased (-0.246362 --> -0.282594).  Saving model ...
Epoch: 4 cost time: 3.1915624141693115
Epoch: 4, Steps: 9 | Train Loss: 0.610 Vali Loss: 1.741 Vali Acc: 0.312 Test Loss: 1.741 Test Acc: 0.312
Validation loss decreased (-0.282594 --> -0.311577).  Saving model ...
Epoch: 5 cost time: 3.551088809967041
Epoch: 5, Steps: 9 | Train Loss: 0.397 Vali Loss: 1.862 Vali Acc: 0.275 Test Loss: 1.862 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.3013579845428467
Epoch: 6, Steps: 9 | Train Loss: 0.227 Vali Loss: 1.866 Vali Acc: 0.268 Test Loss: 1.866 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.533726453781128
Epoch: 7, Steps: 9 | Train Loss: 0.128 Vali Loss: 2.163 Vali Acc: 0.297 Test Loss: 2.163 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.2623167037963867
Epoch: 8, Steps: 9 | Train Loss: 0.062 Vali Loss: 2.354 Vali Acc: 0.341 Test Loss: 2.354 Test Acc: 0.341
Validation loss decreased (-0.311577 --> -0.340556).  Saving model ...
Epoch: 9 cost time: 3.5962181091308594
Epoch: 9, Steps: 9 | Train Loss: 0.037 Vali Loss: 2.298 Vali Acc: 0.362 Test Loss: 2.298 Test Acc: 0.362
Validation loss decreased (-0.340556 --> -0.362296).  Saving model ...
Epoch: 10 cost time: 3.564666748046875
Epoch: 10, Steps: 9 | Train Loss: 0.016 Vali Loss: 2.440 Vali Acc: 0.370 Test Loss: 2.440 Test Acc: 0.370
Validation loss decreased (-0.362296 --> -0.369541).  Saving model ...
Epoch: 11 cost time: 3.7246973514556885
Epoch: 11, Steps: 9 | Train Loss: 0.009 Vali Loss: 2.438 Vali Acc: 0.362 Test Loss: 2.438 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.635378837585449
Epoch: 12, Steps: 9 | Train Loss: 0.007 Vali Loss: 2.452 Vali Acc: 0.355 Test Loss: 2.452 Test Acc: 0.355
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.510672092437744
Epoch: 13, Steps: 9 | Train Loss: 0.004 Vali Loss: 2.462 Vali Acc: 0.377 Test Loss: 2.462 Test Acc: 0.377
Validation loss decreased (-0.369541 --> -0.376787).  Saving model ...
Epoch: 14 cost time: 3.324967861175537
Epoch: 14, Steps: 9 | Train Loss: 0.003 Vali Loss: 2.419 Vali Acc: 0.406 Test Loss: 2.419 Test Acc: 0.406
Validation loss decreased (-0.376787 --> -0.405773).  Saving model ...
Epoch: 15 cost time: 3.170912742614746
Epoch: 15, Steps: 9 | Train Loss: 0.003 Vali Loss: 2.349 Vali Acc: 0.435 Test Loss: 2.349 Test Acc: 0.435
Validation loss decreased (-0.405773 --> -0.434759).  Saving model ...
Epoch: 16 cost time: 3.238161087036133
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.371 Vali Acc: 0.442 Test Loss: 2.371 Test Acc: 0.442
Validation loss decreased (-0.434759 --> -0.442005).  Saving model ...
Epoch: 17 cost time: 3.2259199619293213
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.436 Vali Acc: 0.435 Test Loss: 2.436 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.3447306156158447
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.426 Vali Acc: 0.428 Test Loss: 2.426 Test Acc: 0.428
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.4094762802124023
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.375 Vali Acc: 0.442 Test Loss: 2.375 Test Acc: 0.442
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.6031627655029297
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.322 Vali Acc: 0.478 Test Loss: 2.322 Test Acc: 0.478
Validation loss decreased (-0.442005 --> -0.478238).  Saving model ...
Epoch: 21 cost time: 3.606076955795288
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.293 Vali Acc: 0.486 Test Loss: 2.293 Test Acc: 0.486
Validation loss decreased (-0.478238 --> -0.485484).  Saving model ...
Epoch: 22 cost time: 3.4280338287353516
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.321 Vali Acc: 0.486 Test Loss: 2.321 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.272132635116577
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.331 Vali Acc: 0.486 Test Loss: 2.331 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.438786506652832
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.303 Vali Acc: 0.493 Test Loss: 2.303 Test Acc: 0.493
Validation loss decreased (-0.485484 --> -0.492731).  Saving model ...
Epoch: 25 cost time: 3.5932395458221436
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.276 Vali Acc: 0.500 Test Loss: 2.276 Test Acc: 0.500
Validation loss decreased (-0.492731 --> -0.499977).  Saving model ...
Epoch: 26 cost time: 3.3296475410461426
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.328 Vali Acc: 0.500 Test Loss: 2.328 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.5689427852630615
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.345 Vali Acc: 0.486 Test Loss: 2.345 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.3636326789855957
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.308 Vali Acc: 0.500 Test Loss: 2.308 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.4116122722625732
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.332 Vali Acc: 0.500 Test Loss: 2.332 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.633833408355713
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.369 Vali Acc: 0.500 Test Loss: 2.369 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.3442044258117676
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.350 Vali Acc: 0.500 Test Loss: 2.350 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.7339775562286377
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.319 Vali Acc: 0.500 Test Loss: 2.319 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.5807485580444336
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.289 Vali Acc: 0.493 Test Loss: 2.289 Test Acc: 0.493
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.173443555831909
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.280 Vali Acc: 0.500 Test Loss: 2.280 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.352161169052124
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.331 Vali Acc: 0.500 Test Loss: 2.331 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5
model parameter : 3043844
model size : 21.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.8934853076934814
Epoch: 1, Steps: 9 | Train Loss: 1.419 Vali Loss: 1.395 Vali Acc: 0.246 Test Loss: 1.395 Test Acc: 0.246
Validation loss decreased (inf --> -0.246363).  Saving model ...
Epoch: 2 cost time: 3.657748222351074
Epoch: 2, Steps: 9 | Train Loss: 1.228 Vali Loss: 1.339 Vali Acc: 0.326 Test Loss: 1.339 Test Acc: 0.326
Validation loss decreased (-0.246363 --> -0.326074).  Saving model ...
Epoch: 3 cost time: 3.881986141204834
Epoch: 3, Steps: 9 | Train Loss: 0.920 Vali Loss: 1.319 Vali Acc: 0.348 Test Loss: 1.319 Test Acc: 0.348
Validation loss decreased (-0.326074 --> -0.347813).  Saving model ...
Epoch: 4 cost time: 3.598625659942627
Epoch: 4, Steps: 9 | Train Loss: 0.565 Vali Loss: 1.417 Vali Acc: 0.326 Test Loss: 1.417 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.459350109100342
Epoch: 5, Steps: 9 | Train Loss: 0.347 Vali Loss: 1.369 Vali Acc: 0.384 Test Loss: 1.369 Test Acc: 0.384
Validation loss decreased (-0.347813 --> -0.384044).  Saving model ...
Epoch: 6 cost time: 3.493213653564453
Epoch: 6, Steps: 9 | Train Loss: 0.200 Vali Loss: 1.320 Vali Acc: 0.377 Test Loss: 1.320 Test Acc: 0.377
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.5160460472106934
Epoch: 7, Steps: 9 | Train Loss: 0.094 Vali Loss: 1.442 Vali Acc: 0.399 Test Loss: 1.442 Test Acc: 0.399
Validation loss decreased (-0.384044 --> -0.398536).  Saving model ...
Epoch: 8 cost time: 4.003434896469116
Epoch: 8, Steps: 9 | Train Loss: 0.047 Vali Loss: 1.505 Vali Acc: 0.399 Test Loss: 1.505 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.5218589305877686
Epoch: 9, Steps: 9 | Train Loss: 0.024 Vali Loss: 1.522 Vali Acc: 0.435 Test Loss: 1.522 Test Acc: 0.435
Validation loss decreased (-0.398536 --> -0.434767).  Saving model ...
Epoch: 10 cost time: 3.478017807006836
Epoch: 10, Steps: 9 | Train Loss: 0.012 Vali Loss: 1.540 Vali Acc: 0.435 Test Loss: 1.540 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.291098117828369
Epoch: 11, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.434 Vali Acc: 0.500 Test Loss: 1.434 Test Acc: 0.500
Validation loss decreased (-0.434767 --> -0.499986).  Saving model ...
Epoch: 12 cost time: 3.523203134536743
Epoch: 12, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.388 Vali Acc: 0.522 Test Loss: 1.388 Test Acc: 0.522
Validation loss decreased (-0.499986 --> -0.521725).  Saving model ...
Epoch: 13 cost time: 3.3713812828063965
Epoch: 13, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.494 Vali Acc: 0.500 Test Loss: 1.494 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.2090675830841064
Epoch: 14, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.535 Vali Acc: 0.500 Test Loss: 1.535 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.5412185192108154
Epoch: 15, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.439 Vali Acc: 0.514 Test Loss: 1.439 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.3726389408111572
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.413 Vali Acc: 0.522 Test Loss: 1.413 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.4922780990600586
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.442 Vali Acc: 0.514 Test Loss: 1.442 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.2851755619049072
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.446 Vali Acc: 0.536 Test Loss: 1.446 Test Acc: 0.536
Validation loss decreased (-0.521725 --> -0.536217).  Saving model ...
Epoch: 19 cost time: 3.4544641971588135
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.454 Vali Acc: 0.522 Test Loss: 1.454 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.404895544052124
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.427 Vali Acc: 0.551 Test Loss: 1.427 Test Acc: 0.551
Validation loss decreased (-0.536217 --> -0.550710).  Saving model ...
Epoch: 21 cost time: 3.2426300048828125
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.402 Vali Acc: 0.551 Test Loss: 1.402 Test Acc: 0.551
Validation loss decreased (-0.550710 --> -0.550711).  Saving model ...
Epoch: 22 cost time: 3.3294246196746826
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.411 Vali Acc: 0.565 Test Loss: 1.411 Test Acc: 0.565
Validation loss decreased (-0.550711 --> -0.565203).  Saving model ...
Epoch: 23 cost time: 3.263394355773926
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.419 Vali Acc: 0.558 Test Loss: 1.419 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.585761070251465
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.428 Vali Acc: 0.565 Test Loss: 1.428 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.330390453338623
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.400 Vali Acc: 0.572 Test Loss: 1.400 Test Acc: 0.572
Validation loss decreased (-0.565203 --> -0.572450).  Saving model ...
Epoch: 26 cost time: 3.816762685775757
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.416 Vali Acc: 0.580 Test Loss: 1.416 Test Acc: 0.580
Validation loss decreased (-0.572450 --> -0.579696).  Saving model ...
Epoch: 27 cost time: 3.3792531490325928
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.424 Vali Acc: 0.580 Test Loss: 1.424 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.557323455810547
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.425 Vali Acc: 0.587 Test Loss: 1.425 Test Acc: 0.587
Validation loss decreased (-0.579696 --> -0.586942).  Saving model ...
Epoch: 29 cost time: 3.362757682800293
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.429 Vali Acc: 0.587 Test Loss: 1.429 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.205244779586792
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.434 Vali Acc: 0.601 Test Loss: 1.434 Test Acc: 0.601
Validation loss decreased (-0.586942 --> -0.601435).  Saving model ...
Epoch: 31 cost time: 3.3595638275146484
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.426 Vali Acc: 0.601 Test Loss: 1.426 Test Acc: 0.601
Validation loss decreased (-0.601435 --> -0.601435).  Saving model ...
Epoch: 32 cost time: 3.4554638862609863
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.431 Vali Acc: 0.609 Test Loss: 1.431 Test Acc: 0.609
Validation loss decreased (-0.601435 --> -0.608681).  Saving model ...
Epoch: 33 cost time: 3.323035478591919
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.430 Vali Acc: 0.609 Test Loss: 1.430 Test Acc: 0.609
Validation loss decreased (-0.608681 --> -0.608681).  Saving model ...
Epoch: 34 cost time: 3.4197943210601807
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.431 Vali Acc: 0.601 Test Loss: 1.431 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.3600940704345703
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.432 Vali Acc: 0.609 Test Loss: 1.432 Test Acc: 0.609
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.233487129211426
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.439 Vali Acc: 0.609 Test Loss: 1.439 Test Acc: 0.609
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 4.079144477844238
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.447 Vali Acc: 0.609 Test Loss: 1.447 Test Acc: 0.609
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.4824650287628174
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.452 Vali Acc: 0.609 Test Loss: 1.452 Test Acc: 0.609
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.6930384635925293
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.455 Vali Acc: 0.616 Test Loss: 1.455 Test Acc: 0.616
Validation loss decreased (-0.608681 --> -0.615927).  Saving model ...
Epoch: 40 cost time: 3.5125601291656494
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.457 Vali Acc: 0.616 Test Loss: 1.457 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.6600475311279297
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.462 Vali Acc: 0.616 Test Loss: 1.462 Test Acc: 0.616
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.6928505897521973
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.467 Vali Acc: 0.616 Test Loss: 1.467 Test Acc: 0.616
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.600154161453247
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.472 Vali Acc: 0.609 Test Loss: 1.472 Test Acc: 0.609
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 4.004454135894775
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.478 Vali Acc: 0.609 Test Loss: 1.478 Test Acc: 0.609
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 3.794771909713745
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.473 Vali Acc: 0.609 Test Loss: 1.473 Test Acc: 0.609
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 3.5336732864379883
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.472 Vali Acc: 0.623 Test Loss: 1.472 Test Acc: 0.623
Validation loss decreased (-0.615927 --> -0.623174).  Saving model ...
Epoch: 47 cost time: 3.494783639907837
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.484 Vali Acc: 0.616 Test Loss: 1.484 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.677452564239502
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.494 Vali Acc: 0.609 Test Loss: 1.494 Test Acc: 0.609
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 3.8104090690612793
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.500 Vali Acc: 0.609 Test Loss: 1.500 Test Acc: 0.609
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 3.4953958988189697
Epoch: 50, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.497 Vali Acc: 0.616 Test Loss: 1.497 Test Acc: 0.616
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 3.259247303009033
Epoch: 51, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.495 Vali Acc: 0.630 Test Loss: 1.495 Test Acc: 0.630
Validation loss decreased (-0.623174 --> -0.630420).  Saving model ...
Epoch: 52 cost time: 3.478745698928833
Epoch: 52, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.496 Vali Acc: 0.630 Test Loss: 1.496 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 3.6723873615264893
Epoch: 53, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.505 Vali Acc: 0.630 Test Loss: 1.505 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 3.5934064388275146
Epoch: 54, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.517 Vali Acc: 0.638 Test Loss: 1.517 Test Acc: 0.638
Validation loss decreased (-0.630420 --> -0.637666).  Saving model ...
Epoch: 55 cost time: 3.3668177127838135
Epoch: 55, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.525 Vali Acc: 0.638 Test Loss: 1.525 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 3.4277193546295166
Epoch: 56, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.524 Vali Acc: 0.623 Test Loss: 1.524 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 3.420449733734131
Epoch: 57, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.524 Vali Acc: 0.630 Test Loss: 1.524 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 3.258455753326416
Epoch: 58, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.524 Vali Acc: 0.630 Test Loss: 1.524 Test Acc: 0.630
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 3.26357102394104
Epoch: 59, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.526 Vali Acc: 0.638 Test Loss: 1.526 Test Acc: 0.638
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 3.4057435989379883
Epoch: 60, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.528 Vali Acc: 0.638 Test Loss: 1.528 Test Acc: 0.638
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 3.3591055870056152
Epoch: 61, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.526 Vali Acc: 0.638 Test Loss: 1.526 Test Acc: 0.638
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 3.845123052597046
Epoch: 62, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.528 Vali Acc: 0.638 Test Loss: 1.528 Test Acc: 0.638
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 3.522980213165283
Epoch: 63, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.532 Vali Acc: 0.638 Test Loss: 1.532 Test Acc: 0.638
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 3.8332858085632324
Epoch: 64, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.535 Vali Acc: 0.630 Test Loss: 1.535 Test Acc: 0.630
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm256_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.6376811594202898
model parameter : 3043844
model size : 21.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         103                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma103_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.101267576217651
Epoch: 1, Steps: 9 | Train Loss: 1.419 Vali Loss: 1.350 Vali Acc: 0.377 Test Loss: 1.350 Test Acc: 0.377
Validation loss decreased (inf --> -0.376798).  Saving model ...
Epoch: 2 cost time: 3.15800142288208
Epoch: 2, Steps: 9 | Train Loss: 1.166 Vali Loss: 1.139 Vali Acc: 0.543 Test Loss: 1.139 Test Acc: 0.543
Validation loss decreased (-0.376798 --> -0.543467).  Saving model ...
Epoch: 3 cost time: 3.3935165405273438
Epoch: 3, Steps: 9 | Train Loss: 0.785 Vali Loss: 0.918 Vali Acc: 0.659 Test Loss: 0.918 Test Acc: 0.659
Validation loss decreased (-0.543467 --> -0.659411).  Saving model ...
Epoch: 4 cost time: 3.312793016433716
Epoch: 4, Steps: 9 | Train Loss: 0.446 Vali Loss: 0.801 Vali Acc: 0.688 Test Loss: 0.801 Test Acc: 0.688
Validation loss decreased (-0.659411 --> -0.688398).  Saving model ...
Epoch: 5 cost time: 3.3300299644470215
Epoch: 5, Steps: 9 | Train Loss: 0.221 Vali Loss: 0.633 Vali Acc: 0.775 Test Loss: 0.633 Test Acc: 0.775
Validation loss decreased (-0.688398 --> -0.775356).  Saving model ...
Epoch: 6 cost time: 3.0795109272003174
Epoch: 6, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.543 Vali Acc: 0.812 Test Loss: 0.543 Test Acc: 0.812
Validation loss decreased (-0.775356 --> -0.811589).  Saving model ...
Epoch: 7 cost time: 3.3239803314208984
Epoch: 7, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.544 Vali Acc: 0.812 Test Loss: 0.544 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.4021480083465576
Epoch: 8, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.479 Vali Acc: 0.855 Test Loss: 0.479 Test Acc: 0.855
Validation loss decreased (-0.811589 --> -0.855068).  Saving model ...
Epoch: 9 cost time: 3.441328287124634
Epoch: 9, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.483 Vali Acc: 0.848 Test Loss: 0.483 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.515280246734619
Epoch: 10, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.520 Vali Acc: 0.848 Test Loss: 0.520 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.251589059829712
Epoch: 11, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.466 Vali Acc: 0.841 Test Loss: 0.466 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.428847312927246
Epoch: 12, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.476 Vali Acc: 0.848 Test Loss: 0.476 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.222062349319458
Epoch: 13, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.483 Vali Acc: 0.848 Test Loss: 0.483 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.1154959201812744
Epoch: 14, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.487 Vali Acc: 0.848 Test Loss: 0.487 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.1773765087127686
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.480 Vali Acc: 0.848 Test Loss: 0.480 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.2865753173828125
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.486 Vali Acc: 0.862 Test Loss: 0.486 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 17 cost time: 3.5099921226501465
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.487 Vali Acc: 0.855 Test Loss: 0.487 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.443713903427124
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.496 Vali Acc: 0.862 Test Loss: 0.496 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.147792100906372
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.493 Vali Acc: 0.862 Test Loss: 0.493 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.290695905685425
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.491 Vali Acc: 0.862 Test Loss: 0.491 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.1725058555603027
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.489 Vali Acc: 0.862 Test Loss: 0.489 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.196208953857422
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.488 Vali Acc: 0.870 Test Loss: 0.488 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869560).  Saving model ...
Epoch: 23 cost time: 3.3255555629730225
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.500 Vali Acc: 0.862 Test Loss: 0.500 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.1569528579711914
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.498 Vali Acc: 0.855 Test Loss: 0.498 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.0961809158325195
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.501 Vali Acc: 0.862 Test Loss: 0.501 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.1030797958374023
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.504 Vali Acc: 0.862 Test Loss: 0.504 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.3266327381134033
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.502 Vali Acc: 0.870 Test Loss: 0.502 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.2533600330352783
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.500 Vali Acc: 0.877 Test Loss: 0.500 Test Acc: 0.877
Validation loss decreased (-0.869560 --> -0.876807).  Saving model ...
Epoch: 29 cost time: 3.4169349670410156
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.501 Vali Acc: 0.870 Test Loss: 0.501 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.406317710876465
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.507 Vali Acc: 0.870 Test Loss: 0.507 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.442579746246338
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.511 Vali Acc: 0.862 Test Loss: 0.511 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.3405818939208984
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.511 Vali Acc: 0.870 Test Loss: 0.511 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.219381093978882
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.517 Vali Acc: 0.862 Test Loss: 0.517 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.314803123474121
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.514 Vali Acc: 0.877 Test Loss: 0.514 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.402833938598633
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.509 Vali Acc: 0.884 Test Loss: 0.509 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884053).  Saving model ...
Epoch: 36 cost time: 3.357970714569092
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.507 Vali Acc: 0.884 Test Loss: 0.507 Test Acc: 0.884
Validation loss decreased (-0.884053 --> -0.884053).  Saving model ...
Epoch: 37 cost time: 3.280984401702881
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.512 Vali Acc: 0.884 Test Loss: 0.512 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.3821897506713867
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.512 Vali Acc: 0.884 Test Loss: 0.512 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.377525806427002
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.514 Vali Acc: 0.877 Test Loss: 0.514 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.298544406890869
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.517 Vali Acc: 0.884 Test Loss: 0.517 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 3.443758010864258
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.518 Vali Acc: 0.877 Test Loss: 0.518 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 3.061490297317505
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.520 Vali Acc: 0.877 Test Loss: 0.520 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 3.357119560241699
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.519 Vali Acc: 0.877 Test Loss: 0.519 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 3.3455400466918945
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.527 Vali Acc: 0.884 Test Loss: 0.527 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 3.2137625217437744
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.531 Vali Acc: 0.884 Test Loss: 0.531 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 3.243107318878174
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.530 Vali Acc: 0.884 Test Loss: 0.530 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma103_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 2341124
model size : 13.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         83                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma83_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.079953908920288
Epoch: 1, Steps: 9 | Train Loss: 1.426 Vali Loss: 1.361 Vali Acc: 0.399 Test Loss: 1.361 Test Acc: 0.399
Validation loss decreased (inf --> -0.398537).  Saving model ...
Epoch: 2 cost time: 3.3351943492889404
Epoch: 2, Steps: 9 | Train Loss: 1.176 Vali Loss: 1.154 Vali Acc: 0.529 Test Loss: 1.154 Test Acc: 0.529
Validation loss decreased (-0.398537 --> -0.528974).  Saving model ...
Epoch: 3 cost time: 3.006953001022339
Epoch: 3, Steps: 9 | Train Loss: 0.792 Vali Loss: 0.926 Vali Acc: 0.659 Test Loss: 0.926 Test Acc: 0.659
Validation loss decreased (-0.528974 --> -0.659411).  Saving model ...
Epoch: 4 cost time: 3.210853338241577
Epoch: 4, Steps: 9 | Train Loss: 0.449 Vali Loss: 0.819 Vali Acc: 0.681 Test Loss: 0.819 Test Acc: 0.681
Validation loss decreased (-0.659411 --> -0.681151).  Saving model ...
Epoch: 5 cost time: 3.336796998977661
Epoch: 5, Steps: 9 | Train Loss: 0.229 Vali Loss: 0.620 Vali Acc: 0.768 Test Loss: 0.620 Test Acc: 0.768
Validation loss decreased (-0.681151 --> -0.768110).  Saving model ...
Epoch: 6 cost time: 3.5270283222198486
Epoch: 6, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.559 Vali Acc: 0.754 Test Loss: 0.559 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.3015542030334473
Epoch: 7, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.514 Vali Acc: 0.833 Test Loss: 0.514 Test Acc: 0.833
Validation loss decreased (-0.768110 --> -0.833328).  Saving model ...
Epoch: 8 cost time: 3.2222635746002197
Epoch: 8, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.446 Vali Acc: 0.862 Test Loss: 0.446 Test Acc: 0.862
Validation loss decreased (-0.833328 --> -0.862314).  Saving model ...
Epoch: 9 cost time: 3.192751169204712
Epoch: 9, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.466 Vali Acc: 0.862 Test Loss: 0.466 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.279395341873169
Epoch: 10, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.522 Vali Acc: 0.855 Test Loss: 0.522 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.196389675140381
Epoch: 11, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.442 Vali Acc: 0.855 Test Loss: 0.442 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.206996202468872
Epoch: 12, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.455 Vali Acc: 0.891 Test Loss: 0.455 Test Acc: 0.891
Validation loss decreased (-0.862314 --> -0.891300).  Saving model ...
Epoch: 13 cost time: 3.340583086013794
Epoch: 13, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.465 Vali Acc: 0.884 Test Loss: 0.465 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.682504415512085
Epoch: 14, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.464 Vali Acc: 0.884 Test Loss: 0.464 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.5188090801239014
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.456 Vali Acc: 0.884 Test Loss: 0.456 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.340860366821289
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.465 Vali Acc: 0.884 Test Loss: 0.465 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.196617364883423
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.464 Vali Acc: 0.884 Test Loss: 0.464 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.351909875869751
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.469 Vali Acc: 0.877 Test Loss: 0.469 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.4105396270751953
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.460 Vali Acc: 0.877 Test Loss: 0.460 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.327545642852783
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.461 Vali Acc: 0.884 Test Loss: 0.461 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.145223617553711
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.464 Vali Acc: 0.884 Test Loss: 0.464 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.0761258602142334
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.455 Vali Acc: 0.891 Test Loss: 0.455 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma83_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 2341124
model size : 13.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         62                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma62_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.273622751235962
Epoch: 1, Steps: 9 | Train Loss: 1.422 Vali Loss: 1.370 Vali Acc: 0.377 Test Loss: 1.370 Test Acc: 0.377
Validation loss decreased (inf --> -0.376798).  Saving model ...
Epoch: 2 cost time: 3.534316301345825
Epoch: 2, Steps: 9 | Train Loss: 1.182 Vali Loss: 1.165 Vali Acc: 0.507 Test Loss: 1.165 Test Acc: 0.507
Validation loss decreased (-0.376798 --> -0.507235).  Saving model ...
Epoch: 3 cost time: 3.2787954807281494
Epoch: 3, Steps: 9 | Train Loss: 0.792 Vali Loss: 0.942 Vali Acc: 0.652 Test Loss: 0.942 Test Acc: 0.652
Validation loss decreased (-0.507235 --> -0.652164).  Saving model ...
Epoch: 4 cost time: 3.5463736057281494
Epoch: 4, Steps: 9 | Train Loss: 0.450 Vali Loss: 0.834 Vali Acc: 0.652 Test Loss: 0.834 Test Acc: 0.652
Validation loss decreased (-0.652164 --> -0.652166).  Saving model ...
Epoch: 5 cost time: 3.272858142852783
Epoch: 5, Steps: 9 | Train Loss: 0.222 Vali Loss: 0.642 Vali Acc: 0.819 Test Loss: 0.642 Test Acc: 0.819
Validation loss decreased (-0.652166 --> -0.818834).  Saving model ...
Epoch: 6 cost time: 3.424468517303467
Epoch: 6, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.575 Vali Acc: 0.819 Test Loss: 0.575 Test Acc: 0.819
Validation loss decreased (-0.818834 --> -0.818835).  Saving model ...
Epoch: 7 cost time: 3.5739686489105225
Epoch: 7, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.534 Vali Acc: 0.862 Test Loss: 0.534 Test Acc: 0.862
Validation loss decreased (-0.818835 --> -0.862314).  Saving model ...
Epoch: 8 cost time: 3.856599807739258
Epoch: 8, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.474 Vali Acc: 0.884 Test Loss: 0.474 Test Acc: 0.884
Validation loss decreased (-0.862314 --> -0.884053).  Saving model ...
Epoch: 9 cost time: 3.4523375034332275
Epoch: 9, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.456 Vali Acc: 0.906 Test Loss: 0.456 Test Acc: 0.906
Validation loss decreased (-0.884053 --> -0.905793).  Saving model ...
Epoch: 10 cost time: 3.4995808601379395
Epoch: 10, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.505 Vali Acc: 0.906 Test Loss: 0.505 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.72920298576355
Epoch: 11, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.466 Vali Acc: 0.891 Test Loss: 0.466 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.1844842433929443
Epoch: 12, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.475 Vali Acc: 0.906 Test Loss: 0.475 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.2536444664001465
Epoch: 13, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.478 Vali Acc: 0.906 Test Loss: 0.478 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.509225606918335
Epoch: 14, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.471 Vali Acc: 0.920 Test Loss: 0.471 Test Acc: 0.920
Validation loss decreased (-0.905793 --> -0.920285).  Saving model ...
Epoch: 15 cost time: 3.6618454456329346
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.467 Vali Acc: 0.913 Test Loss: 0.467 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.5701606273651123
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.480 Vali Acc: 0.920 Test Loss: 0.480 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.4119837284088135
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.478 Vali Acc: 0.920 Test Loss: 0.478 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.4743664264678955
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.479 Vali Acc: 0.920 Test Loss: 0.479 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.4733028411865234
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.475 Vali Acc: 0.913 Test Loss: 0.475 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.2615814208984375
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.475 Vali Acc: 0.913 Test Loss: 0.475 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.3664536476135254
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.476 Vali Acc: 0.913 Test Loss: 0.476 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.406942844390869
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.471 Vali Acc: 0.906 Test Loss: 0.471 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.6535298824310303
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.484 Vali Acc: 0.913 Test Loss: 0.484 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.609833002090454
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.483 Vali Acc: 0.913 Test Loss: 0.483 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma62_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 2341124
model size : 13.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         42                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.159913778305054
Epoch: 1, Steps: 9 | Train Loss: 1.417 Vali Loss: 1.346 Vali Acc: 0.413 Test Loss: 1.346 Test Acc: 0.413
Validation loss decreased (inf --> -0.413030).  Saving model ...
Epoch: 2 cost time: 3.404217004776001
Epoch: 2, Steps: 9 | Train Loss: 1.137 Vali Loss: 1.114 Vali Acc: 0.572 Test Loss: 1.114 Test Acc: 0.572
Validation loss decreased (-0.413030 --> -0.572453).  Saving model ...
Epoch: 3 cost time: 3.335333824157715
Epoch: 3, Steps: 9 | Train Loss: 0.760 Vali Loss: 0.879 Vali Acc: 0.659 Test Loss: 0.879 Test Acc: 0.659
Validation loss decreased (-0.572453 --> -0.659411).  Saving model ...
Epoch: 4 cost time: 3.4659342765808105
Epoch: 4, Steps: 9 | Train Loss: 0.434 Vali Loss: 0.785 Vali Acc: 0.703 Test Loss: 0.785 Test Acc: 0.703
Validation loss decreased (-0.659411 --> -0.702891).  Saving model ...
Epoch: 5 cost time: 3.556486129760742
Epoch: 5, Steps: 9 | Train Loss: 0.208 Vali Loss: 0.593 Vali Acc: 0.775 Test Loss: 0.593 Test Acc: 0.775
Validation loss decreased (-0.702891 --> -0.775356).  Saving model ...
Epoch: 6 cost time: 3.3819684982299805
Epoch: 6, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.482 Vali Acc: 0.826 Test Loss: 0.482 Test Acc: 0.826
Validation loss decreased (-0.775356 --> -0.826082).  Saving model ...
Epoch: 7 cost time: 3.519270658493042
Epoch: 7, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.564 Vali Acc: 0.826 Test Loss: 0.564 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.4535791873931885
Epoch: 8, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.404 Vali Acc: 0.877 Test Loss: 0.404 Test Acc: 0.877
Validation loss decreased (-0.826082 --> -0.876808).  Saving model ...
Epoch: 9 cost time: 3.202331066131592
Epoch: 9, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.406 Vali Acc: 0.877 Test Loss: 0.406 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.334676742553711
Epoch: 10, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.554 Vali Acc: 0.848 Test Loss: 0.554 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.329188108444214
Epoch: 11, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.405 Vali Acc: 0.877 Test Loss: 0.405 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.301417827606201
Epoch: 12, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.426 Vali Acc: 0.877 Test Loss: 0.426 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.3834750652313232
Epoch: 13, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.469 Vali Acc: 0.855 Test Loss: 0.469 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.571726083755493
Epoch: 14, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.437 Vali Acc: 0.870 Test Loss: 0.437 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.705876588821411
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.411 Vali Acc: 0.877 Test Loss: 0.411 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.6664068698883057
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.425 Vali Acc: 0.884 Test Loss: 0.425 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 17 cost time: 3.822699785232544
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.432 Vali Acc: 0.884 Test Loss: 0.432 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.7868356704711914
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.436 Vali Acc: 0.884 Test Loss: 0.436 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.608574151992798
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.429 Vali Acc: 0.884 Test Loss: 0.429 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.855417251586914
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.429 Vali Acc: 0.899 Test Loss: 0.429 Test Acc: 0.899
Validation loss decreased (-0.884054 --> -0.898546).  Saving model ...
Epoch: 21 cost time: 3.844024419784546
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.430 Vali Acc: 0.899 Test Loss: 0.430 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.281696319580078
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.424 Vali Acc: 0.891 Test Loss: 0.424 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.130430459976196
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.433 Vali Acc: 0.884 Test Loss: 0.433 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.843389272689819
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.433 Vali Acc: 0.891 Test Loss: 0.433 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.556118726730347
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.433 Vali Acc: 0.899 Test Loss: 0.433 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.867093086242676
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.436 Vali Acc: 0.899 Test Loss: 0.436 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.376537084579468
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.437 Vali Acc: 0.899 Test Loss: 0.437 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.084012508392334
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.431 Vali Acc: 0.906 Test Loss: 0.431 Test Acc: 0.906
Validation loss decreased (-0.898546 --> -0.905793).  Saving model ...
Epoch: 29 cost time: 3.823619842529297
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.430 Vali Acc: 0.906 Test Loss: 0.430 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905793).  Saving model ...
Epoch: 30 cost time: 4.277841329574585
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.434 Vali Acc: 0.906 Test Loss: 0.434 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 4.11525297164917
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.440 Vali Acc: 0.906 Test Loss: 0.440 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.236621379852295
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.441 Vali Acc: 0.906 Test Loss: 0.441 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.181952953338623
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.444 Vali Acc: 0.906 Test Loss: 0.444 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.072725534439087
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.441 Vali Acc: 0.906 Test Loss: 0.441 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.2072176933288574
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.437 Vali Acc: 0.906 Test Loss: 0.437 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.246399164199829
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.440 Vali Acc: 0.906 Test Loss: 0.440 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.328012466430664
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.448 Vali Acc: 0.906 Test Loss: 0.448 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 3.3276755809783936
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.441 Vali Acc: 0.906 Test Loss: 0.441 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 3.4035608768463135
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.443 Vali Acc: 0.906 Test Loss: 0.443 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 2341124
model size : 13.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.718396425247192
Epoch: 1, Steps: 9 | Train Loss: 1.442 Vali Loss: 1.386 Vali Acc: 0.355 Test Loss: 1.386 Test Acc: 0.355
Validation loss decreased (inf --> -0.355059).  Saving model ...
Epoch: 2 cost time: 3.8470211029052734
Epoch: 2, Steps: 9 | Train Loss: 1.182 Vali Loss: 1.163 Vali Acc: 0.572 Test Loss: 1.163 Test Acc: 0.572
Validation loss decreased (-0.355059 --> -0.572452).  Saving model ...
Epoch: 3 cost time: 3.656308174133301
Epoch: 3, Steps: 9 | Train Loss: 0.796 Vali Loss: 0.921 Vali Acc: 0.652 Test Loss: 0.921 Test Acc: 0.652
Validation loss decreased (-0.572452 --> -0.652165).  Saving model ...
Epoch: 4 cost time: 3.624478340148926
Epoch: 4, Steps: 9 | Train Loss: 0.461 Vali Loss: 0.790 Vali Acc: 0.681 Test Loss: 0.790 Test Acc: 0.681
Validation loss decreased (-0.652165 --> -0.681152).  Saving model ...
Epoch: 5 cost time: 3.2667040824890137
Epoch: 5, Steps: 9 | Train Loss: 0.225 Vali Loss: 0.556 Vali Acc: 0.826 Test Loss: 0.556 Test Acc: 0.826
Validation loss decreased (-0.681152 --> -0.826081).  Saving model ...
Epoch: 6 cost time: 3.34096622467041
Epoch: 6, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.450 Vali Acc: 0.855 Test Loss: 0.450 Test Acc: 0.855
Validation loss decreased (-0.826081 --> -0.855068).  Saving model ...
Epoch: 7 cost time: 3.6502366065979004
Epoch: 7, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.390 Vali Acc: 0.877 Test Loss: 0.390 Test Acc: 0.877
Validation loss decreased (-0.855068 --> -0.876808).  Saving model ...
Epoch: 8 cost time: 3.599865198135376
Epoch: 8, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.371 Vali Acc: 0.877 Test Loss: 0.371 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 9 cost time: 3.3125035762786865
Epoch: 9, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.320 Vali Acc: 0.884 Test Loss: 0.320 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884055).  Saving model ...
Epoch: 10 cost time: 3.732567071914673
Epoch: 10, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.346 Vali Acc: 0.891 Test Loss: 0.346 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
Epoch: 11 cost time: 3.1329808235168457
Epoch: 11, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.342 Vali Acc: 0.884 Test Loss: 0.342 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.1966378688812256
Epoch: 12, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.340 Vali Acc: 0.899 Test Loss: 0.340 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 13 cost time: 3.3800220489501953
Epoch: 13, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.324 Vali Acc: 0.899 Test Loss: 0.324 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 14 cost time: 3.2695326805114746
Epoch: 14, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.323 Vali Acc: 0.899 Test Loss: 0.323 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 15 cost time: 3.243553400039673
Epoch: 15, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.326 Vali Acc: 0.906 Test Loss: 0.326 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 16 cost time: 3.05363130569458
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.342 Vali Acc: 0.899 Test Loss: 0.342 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.1705851554870605
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.330 Vali Acc: 0.899 Test Loss: 0.330 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.079559803009033
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.324 Vali Acc: 0.899 Test Loss: 0.324 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.301276445388794
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.325 Vali Acc: 0.899 Test Loss: 0.325 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.2993357181549072
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.330 Vali Acc: 0.906 Test Loss: 0.330 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.470801591873169
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.318 Vali Acc: 0.899 Test Loss: 0.318 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.2445783615112305
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.313 Vali Acc: 0.899 Test Loss: 0.313 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.1381475925445557
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.333 Vali Acc: 0.891 Test Loss: 0.333 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.2396178245544434
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.335 Vali Acc: 0.899 Test Loss: 0.335 Test Acc: 0.899
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.4517247676849365
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.334 Vali Acc: 0.906 Test Loss: 0.334 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 2341124
model size : 13.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.398968458175659
Epoch: 1, Steps: 9 | Train Loss: 1.480 Vali Loss: 1.381 Vali Acc: 0.362 Test Loss: 1.381 Test Acc: 0.362
Validation loss decreased (inf --> -0.362305).  Saving model ...
Epoch: 2 cost time: 3.2713265419006348
Epoch: 2, Steps: 9 | Train Loss: 1.215 Vali Loss: 1.156 Vali Acc: 0.572 Test Loss: 1.156 Test Acc: 0.572
Validation loss decreased (-0.362305 --> -0.572452).  Saving model ...
Epoch: 3 cost time: 3.4474141597747803
Epoch: 3, Steps: 9 | Train Loss: 0.823 Vali Loss: 0.907 Vali Acc: 0.674 Test Loss: 0.907 Test Acc: 0.674
Validation loss decreased (-0.572452 --> -0.673904).  Saving model ...
Epoch: 4 cost time: 3.360241651535034
Epoch: 4, Steps: 9 | Train Loss: 0.491 Vali Loss: 0.835 Vali Acc: 0.688 Test Loss: 0.835 Test Acc: 0.688
Validation loss decreased (-0.673904 --> -0.688397).  Saving model ...
Epoch: 5 cost time: 3.4974100589752197
Epoch: 5, Steps: 9 | Train Loss: 0.265 Vali Loss: 0.585 Vali Acc: 0.754 Test Loss: 0.585 Test Acc: 0.754
Validation loss decreased (-0.688397 --> -0.753617).  Saving model ...
Epoch: 6 cost time: 3.3285751342773438
Epoch: 6, Steps: 9 | Train Loss: 0.158 Vali Loss: 0.577 Vali Acc: 0.768 Test Loss: 0.577 Test Acc: 0.768
Validation loss decreased (-0.753617 --> -0.768110).  Saving model ...
Epoch: 7 cost time: 3.5294642448425293
Epoch: 7, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.492 Vali Acc: 0.790 Test Loss: 0.492 Test Acc: 0.790
Validation loss decreased (-0.768110 --> -0.789850).  Saving model ...
Epoch: 8 cost time: 3.629643678665161
Epoch: 8, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.408 Vali Acc: 0.826 Test Loss: 0.408 Test Acc: 0.826
Validation loss decreased (-0.789850 --> -0.826083).  Saving model ...
Epoch: 9 cost time: 3.2264864444732666
Epoch: 9, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.455 Vali Acc: 0.804 Test Loss: 0.455 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.6048691272735596
Epoch: 10, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.417 Vali Acc: 0.826 Test Loss: 0.417 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.6093122959136963
Epoch: 11, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.388 Vali Acc: 0.833 Test Loss: 0.388 Test Acc: 0.833
Validation loss decreased (-0.826083 --> -0.833329).  Saving model ...
Epoch: 12 cost time: 3.8739707469940186
Epoch: 12, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.514 Vali Acc: 0.790 Test Loss: 0.514 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.031192302703857
Epoch: 13, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.402 Vali Acc: 0.826 Test Loss: 0.402 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.9922616481781006
Epoch: 14, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.394 Vali Acc: 0.862 Test Loss: 0.394 Test Acc: 0.862
Validation loss decreased (-0.833329 --> -0.862315).  Saving model ...
Epoch: 15 cost time: 3.9417643547058105
Epoch: 15, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.418 Vali Acc: 0.826 Test Loss: 0.418 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.9672799110412598
Epoch: 16, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.419 Vali Acc: 0.826 Test Loss: 0.419 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.7839434146881104
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.407 Vali Acc: 0.841 Test Loss: 0.407 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.7876031398773193
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.401 Vali Acc: 0.848 Test Loss: 0.401 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.9826436042785645
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.398 Vali Acc: 0.848 Test Loss: 0.398 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.860651731491089
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.397 Vali Acc: 0.848 Test Loss: 0.397 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.76521372795105
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.394 Vali Acc: 0.855 Test Loss: 0.394 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.901779890060425
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.399 Vali Acc: 0.862 Test Loss: 0.399 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.780557632446289
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.407 Vali Acc: 0.848 Test Loss: 0.407 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.7601804733276367
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.396 Vali Acc: 0.855 Test Loss: 0.396 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 2341124
model size : 13.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.182347297668457
Epoch: 1, Steps: 9 | Train Loss: 1.474 Vali Loss: 1.402 Vali Acc: 0.319 Test Loss: 1.402 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 4.247286081314087
Epoch: 2, Steps: 9 | Train Loss: 1.191 Vali Loss: 1.194 Vali Acc: 0.514 Test Loss: 1.194 Test Acc: 0.514
Validation loss decreased (-0.318827 --> -0.514481).  Saving model ...
Epoch: 3 cost time: 4.244928359985352
Epoch: 3, Steps: 9 | Train Loss: 0.818 Vali Loss: 0.966 Vali Acc: 0.667 Test Loss: 0.966 Test Acc: 0.667
Validation loss decreased (-0.514481 --> -0.666657).  Saving model ...
Epoch: 4 cost time: 4.1097571849823
Epoch: 4, Steps: 9 | Train Loss: 0.509 Vali Loss: 0.892 Vali Acc: 0.645 Test Loss: 0.892 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.243013381958008
Epoch: 5, Steps: 9 | Train Loss: 0.285 Vali Loss: 0.769 Vali Acc: 0.717 Test Loss: 0.769 Test Acc: 0.717
Validation loss decreased (-0.666657 --> -0.717384).  Saving model ...
Epoch: 6 cost time: 4.096322774887085
Epoch: 6, Steps: 9 | Train Loss: 0.186 Vali Loss: 0.694 Vali Acc: 0.761 Test Loss: 0.694 Test Acc: 0.761
Validation loss decreased (-0.717384 --> -0.760863).  Saving model ...
Epoch: 7 cost time: 4.3867902755737305
Epoch: 7, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.731 Vali Acc: 0.703 Test Loss: 0.731 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.947582244873047
Epoch: 8, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.648 Vali Acc: 0.804 Test Loss: 0.648 Test Acc: 0.804
Validation loss decreased (-0.760863 --> -0.804341).  Saving model ...
Epoch: 9 cost time: 4.211192607879639
Epoch: 9, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.690 Vali Acc: 0.739 Test Loss: 0.690 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.8879759311676025
Epoch: 10, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.694 Vali Acc: 0.768 Test Loss: 0.694 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.048949718475342
Epoch: 11, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.727 Vali Acc: 0.768 Test Loss: 0.727 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.8333890438079834
Epoch: 12, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.699 Vali Acc: 0.768 Test Loss: 0.699 Test Acc: 0.768
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.127045154571533
Epoch: 13, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.688 Vali Acc: 0.761 Test Loss: 0.688 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.139794826507568
Epoch: 14, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.719 Vali Acc: 0.768 Test Loss: 0.719 Test Acc: 0.768
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.5829548835754395
Epoch: 15, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.710 Vali Acc: 0.775 Test Loss: 0.710 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.462790012359619
Epoch: 16, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.703 Vali Acc: 0.775 Test Loss: 0.703 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.261073589324951
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.695 Vali Acc: 0.783 Test Loss: 0.695 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.166970729827881
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.718 Vali Acc: 0.783 Test Loss: 0.718 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8043478260869565
model parameter : 2341124
model size : 13.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.710245370864868
Epoch: 1, Steps: 9 | Train Loss: 1.466 Vali Loss: 1.411 Vali Acc: 0.239 Test Loss: 1.411 Test Acc: 0.239
Validation loss decreased (inf --> -0.239116).  Saving model ...
Epoch: 2 cost time: 4.2960145473480225
Epoch: 2, Steps: 9 | Train Loss: 1.247 Vali Loss: 1.350 Vali Acc: 0.297 Test Loss: 1.350 Test Acc: 0.297
Validation loss decreased (-0.239116 --> -0.297088).  Saving model ...
Epoch: 3 cost time: 3.903653621673584
Epoch: 3, Steps: 9 | Train Loss: 0.974 Vali Loss: 1.302 Vali Acc: 0.384 Test Loss: 1.302 Test Acc: 0.384
Validation loss decreased (-0.297088 --> -0.384045).  Saving model ...
Epoch: 4 cost time: 4.6259167194366455
Epoch: 4, Steps: 9 | Train Loss: 0.715 Vali Loss: 1.221 Vali Acc: 0.449 Test Loss: 1.221 Test Acc: 0.449
Validation loss decreased (-0.384045 --> -0.449263).  Saving model ...
Epoch: 5 cost time: 3.6964528560638428
Epoch: 5, Steps: 9 | Train Loss: 0.461 Vali Loss: 1.237 Vali Acc: 0.449 Test Loss: 1.237 Test Acc: 0.449
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.130094051361084
Epoch: 6, Steps: 9 | Train Loss: 0.325 Vali Loss: 1.190 Vali Acc: 0.486 Test Loss: 1.190 Test Acc: 0.486
Validation loss decreased (-0.449263 --> -0.485495).  Saving model ...
Epoch: 7 cost time: 4.007562637329102
Epoch: 7, Steps: 9 | Train Loss: 0.182 Vali Loss: 1.356 Vali Acc: 0.428 Test Loss: 1.356 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.112757921218872
Epoch: 8, Steps: 9 | Train Loss: 0.096 Vali Loss: 1.308 Vali Acc: 0.493 Test Loss: 1.308 Test Acc: 0.493
Validation loss decreased (-0.485495 --> -0.492741).  Saving model ...
Epoch: 9 cost time: 3.9833574295043945
Epoch: 9, Steps: 9 | Train Loss: 0.060 Vali Loss: 1.375 Vali Acc: 0.486 Test Loss: 1.375 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.288721799850464
Epoch: 10, Steps: 9 | Train Loss: 0.033 Vali Loss: 1.355 Vali Acc: 0.507 Test Loss: 1.355 Test Acc: 0.507
Validation loss decreased (-0.492741 --> -0.507233).  Saving model ...
Epoch: 11 cost time: 3.9851841926574707
Epoch: 11, Steps: 9 | Train Loss: 0.018 Vali Loss: 1.607 Vali Acc: 0.514 Test Loss: 1.607 Test Acc: 0.514
Validation loss decreased (-0.507233 --> -0.514477).  Saving model ...
Epoch: 12 cost time: 3.7148938179016113
Epoch: 12, Steps: 9 | Train Loss: 0.014 Vali Loss: 1.355 Vali Acc: 0.507 Test Loss: 1.355 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.916142225265503
Epoch: 13, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.413 Vali Acc: 0.522 Test Loss: 1.413 Test Acc: 0.522
Validation loss decreased (-0.514477 --> -0.521725).  Saving model ...
Epoch: 14 cost time: 4.3711302280426025
Epoch: 14, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.555 Vali Acc: 0.536 Test Loss: 1.555 Test Acc: 0.536
Validation loss decreased (-0.521725 --> -0.536216).  Saving model ...
Epoch: 15 cost time: 4.1922266483306885
Epoch: 15, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.460 Vali Acc: 0.543 Test Loss: 1.460 Test Acc: 0.543
Validation loss decreased (-0.536216 --> -0.543464).  Saving model ...
Epoch: 16 cost time: 3.6753547191619873
Epoch: 16, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.363 Vali Acc: 0.536 Test Loss: 1.363 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.09276270866394
Epoch: 17, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.395 Vali Acc: 0.558 Test Loss: 1.395 Test Acc: 0.558
Validation loss decreased (-0.543464 --> -0.557957).  Saving model ...
Epoch: 18 cost time: 3.9265294075012207
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.466 Vali Acc: 0.551 Test Loss: 1.466 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.359264850616455
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.446 Vali Acc: 0.558 Test Loss: 1.446 Test Acc: 0.558
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.371960401535034
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.415 Vali Acc: 0.565 Test Loss: 1.415 Test Acc: 0.565
Validation loss decreased (-0.557957 --> -0.565203).  Saving model ...
Epoch: 21 cost time: 4.4118123054504395
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.417 Vali Acc: 0.565 Test Loss: 1.417 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.376107454299927
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.380 Vali Acc: 0.551 Test Loss: 1.380 Test Acc: 0.551
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.7992711067199707
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.317 Vali Acc: 0.572 Test Loss: 1.317 Test Acc: 0.572
Validation loss decreased (-0.565203 --> -0.572451).  Saving model ...
Epoch: 24 cost time: 4.186231374740601
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.340 Vali Acc: 0.580 Test Loss: 1.340 Test Acc: 0.580
Validation loss decreased (-0.572451 --> -0.579697).  Saving model ...
Epoch: 25 cost time: 3.954636573791504
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.326 Vali Acc: 0.587 Test Loss: 1.326 Test Acc: 0.587
Validation loss decreased (-0.579697 --> -0.586943).  Saving model ...
Epoch: 26 cost time: 4.362504720687866
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.308 Vali Acc: 0.601 Test Loss: 1.308 Test Acc: 0.601
Validation loss decreased (-0.586943 --> -0.601436).  Saving model ...
Epoch: 27 cost time: 3.877108573913574
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.281 Vali Acc: 0.609 Test Loss: 1.281 Test Acc: 0.609
Validation loss decreased (-0.601436 --> -0.608683).  Saving model ...
Epoch: 28 cost time: 3.9953157901763916
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.282 Vali Acc: 0.601 Test Loss: 1.282 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.9469525814056396
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.293 Vali Acc: 0.616 Test Loss: 1.293 Test Acc: 0.616
Validation loss decreased (-0.608683 --> -0.615929).  Saving model ...
Epoch: 30 cost time: 3.933438777923584
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.327 Vali Acc: 0.616 Test Loss: 1.327 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.954493284225464
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.308 Vali Acc: 0.623 Test Loss: 1.308 Test Acc: 0.623
Validation loss decreased (-0.615929 --> -0.623175).  Saving model ...
Epoch: 32 cost time: 3.879011631011963
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.289 Vali Acc: 0.623 Test Loss: 1.289 Test Acc: 0.623
Validation loss decreased (-0.623175 --> -0.623176).  Saving model ...
Epoch: 33 cost time: 3.892761707305908
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.253 Vali Acc: 0.616 Test Loss: 1.253 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 4.093995094299316
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.224 Vali Acc: 0.623 Test Loss: 1.224 Test Acc: 0.623
Validation loss decreased (-0.623176 --> -0.623176).  Saving model ...
Epoch: 35 cost time: 4.726049184799194
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.241 Vali Acc: 0.630 Test Loss: 1.241 Test Acc: 0.630
Validation loss decreased (-0.623176 --> -0.630422).  Saving model ...
Epoch: 36 cost time: 4.2475903034210205
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.250 Vali Acc: 0.630 Test Loss: 1.250 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 4.16383171081543
Epoch: 37, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.251 Vali Acc: 0.630 Test Loss: 1.251 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 4.311976194381714
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.248 Vali Acc: 0.630 Test Loss: 1.248 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 4.0464088916778564
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.216 Vali Acc: 0.638 Test Loss: 1.216 Test Acc: 0.638
Validation loss decreased (-0.630422 --> -0.637669).  Saving model ...
Epoch: 40 cost time: 4.213934898376465
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.207 Vali Acc: 0.630 Test Loss: 1.207 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 4.093883752822876
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.221 Vali Acc: 0.638 Test Loss: 1.221 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 4.035582542419434
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.215 Vali Acc: 0.638 Test Loss: 1.215 Test Acc: 0.638
Validation loss decreased (-0.637669 --> -0.637669).  Saving model ...
Epoch: 43 cost time: 3.9463918209075928
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.210 Vali Acc: 0.638 Test Loss: 1.210 Test Acc: 0.638
Validation loss decreased (-0.637669 --> -0.637669).  Saving model ...
Epoch: 44 cost time: 4.121982574462891
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.175 Vali Acc: 0.659 Test Loss: 1.175 Test Acc: 0.659
Validation loss decreased (-0.637669 --> -0.659409).  Saving model ...
Epoch: 45 cost time: 4.0387256145477295
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.178 Vali Acc: 0.652 Test Loss: 1.178 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.8744451999664307
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.177 Vali Acc: 0.652 Test Loss: 1.177 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.8070220947265625
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.181 Vali Acc: 0.659 Test Loss: 1.181 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.815337657928467
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.198 Vali Acc: 0.659 Test Loss: 1.198 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 3.986057758331299
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.197 Vali Acc: 0.652 Test Loss: 1.197 Test Acc: 0.652
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 4.022822141647339
Epoch: 50, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.183 Vali Acc: 0.659 Test Loss: 1.183 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 3.938776731491089
Epoch: 51, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.171 Vali Acc: 0.667 Test Loss: 1.171 Test Acc: 0.667
Validation loss decreased (-0.659409 --> -0.666655).  Saving model ...
Epoch: 52 cost time: 3.9149162769317627
Epoch: 52, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.176 Vali Acc: 0.667 Test Loss: 1.176 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 3.8420064449310303
Epoch: 53, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.185 Vali Acc: 0.674 Test Loss: 1.185 Test Acc: 0.674
Validation loss decreased (-0.666655 --> -0.673901).  Saving model ...
Epoch: 54 cost time: 4.058521032333374
Epoch: 54, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.176 Vali Acc: 0.667 Test Loss: 1.176 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 3.833860158920288
Epoch: 55, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.173 Vali Acc: 0.674 Test Loss: 1.173 Test Acc: 0.674
Validation loss decreased (-0.673901 --> -0.673901).  Saving model ...
Epoch: 56 cost time: 3.6403658390045166
Epoch: 56, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.176 Vali Acc: 0.681 Test Loss: 1.176 Test Acc: 0.681
Validation loss decreased (-0.673901 --> -0.681148).  Saving model ...
Epoch: 57 cost time: 3.600867509841919
Epoch: 57, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.179 Vali Acc: 0.688 Test Loss: 1.179 Test Acc: 0.688
Validation loss decreased (-0.681148 --> -0.688394).  Saving model ...
Epoch: 58 cost time: 3.794832706451416
Epoch: 58, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.169 Vali Acc: 0.688 Test Loss: 1.169 Test Acc: 0.688
Validation loss decreased (-0.688394 --> -0.688394).  Saving model ...
Epoch: 59 cost time: 3.9304330348968506
Epoch: 59, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.162 Vali Acc: 0.696 Test Loss: 1.162 Test Acc: 0.696
Validation loss decreased (-0.688394 --> -0.695641).  Saving model ...
Epoch: 60 cost time: 3.9056894779205322
Epoch: 60, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.160 Vali Acc: 0.710 Test Loss: 1.160 Test Acc: 0.710
Validation loss decreased (-0.695641 --> -0.710133).  Saving model ...
Epoch: 61 cost time: 3.6955020427703857
Epoch: 61, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.145 Vali Acc: 0.710 Test Loss: 1.145 Test Acc: 0.710
Validation loss decreased (-0.710133 --> -0.710133).  Saving model ...
Epoch: 62 cost time: 3.614295482635498
Epoch: 62, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.142 Vali Acc: 0.703 Test Loss: 1.142 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 3.854186773300171
Epoch: 63, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.138 Vali Acc: 0.703 Test Loss: 1.138 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 3.577930212020874
Epoch: 64, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.137 Vali Acc: 0.703 Test Loss: 1.137 Test Acc: 0.703
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 3.888233184814453
Epoch: 65, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.162 Vali Acc: 0.703 Test Loss: 1.162 Test Acc: 0.703
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 3.911266565322876
Epoch: 66, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.172 Vali Acc: 0.696 Test Loss: 1.172 Test Acc: 0.696
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 3.785607099533081
Epoch: 67, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.158 Vali Acc: 0.696 Test Loss: 1.158 Test Acc: 0.696
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 4.046406269073486
Epoch: 68, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.151 Vali Acc: 0.696 Test Loss: 1.151 Test Acc: 0.696
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 4.144614934921265
Epoch: 69, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.151 Vali Acc: 0.696 Test Loss: 1.151 Test Acc: 0.696
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 3.933234214782715
Epoch: 70, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.155 Vali Acc: 0.696 Test Loss: 1.155 Test Acc: 0.696
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 3.981701374053955
Epoch: 71, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.144 Vali Acc: 0.696 Test Loss: 1.144 Test Acc: 0.696
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7101449275362319
model parameter : 2341124
model size : 13.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.388298511505127
Epoch: 1, Steps: 9 | Train Loss: 1.450 Vali Loss: 1.406 Vali Acc: 0.217 Test Loss: 1.406 Test Acc: 0.217
Validation loss decreased (inf --> -0.217377).  Saving model ...
Epoch: 2 cost time: 4.123978137969971
Epoch: 2, Steps: 9 | Train Loss: 1.361 Vali Loss: 1.416 Vali Acc: 0.297 Test Loss: 1.416 Test Acc: 0.297
Validation loss decreased (-0.217377 --> -0.297087).  Saving model ...
Epoch: 3 cost time: 4.332157611846924
Epoch: 3, Steps: 9 | Train Loss: 1.133 Vali Loss: 1.406 Vali Acc: 0.254 Test Loss: 1.406 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.887605905532837
Epoch: 4, Steps: 9 | Train Loss: 0.946 Vali Loss: 1.560 Vali Acc: 0.261 Test Loss: 1.560 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.374443531036377
Epoch: 5, Steps: 9 | Train Loss: 0.704 Vali Loss: 1.653 Vali Acc: 0.290 Test Loss: 1.653 Test Acc: 0.290
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.990903615951538
Epoch: 6, Steps: 9 | Train Loss: 0.524 Vali Loss: 1.952 Vali Acc: 0.275 Test Loss: 1.952 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.731968402862549
Epoch: 7, Steps: 9 | Train Loss: 0.354 Vali Loss: 2.111 Vali Acc: 0.297 Test Loss: 2.111 Test Acc: 0.297
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.6254377365112305
Epoch: 8, Steps: 9 | Train Loss: 0.239 Vali Loss: 2.552 Vali Acc: 0.297 Test Loss: 2.552 Test Acc: 0.297
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.246565103530884
Epoch: 9, Steps: 9 | Train Loss: 0.168 Vali Loss: 2.298 Vali Acc: 0.319 Test Loss: 2.298 Test Acc: 0.319
Validation loss decreased (-0.297087 --> -0.318818).  Saving model ...
Epoch: 10 cost time: 3.934546709060669
Epoch: 10, Steps: 9 | Train Loss: 0.104 Vali Loss: 2.670 Vali Acc: 0.326 Test Loss: 2.670 Test Acc: 0.326
Validation loss decreased (-0.318818 --> -0.326060).  Saving model ...
Epoch: 11 cost time: 3.782932758331299
Epoch: 11, Steps: 9 | Train Loss: 0.055 Vali Loss: 2.749 Vali Acc: 0.326 Test Loss: 2.749 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.176239728927612
Epoch: 12, Steps: 9 | Train Loss: 0.037 Vali Loss: 2.545 Vali Acc: 0.326 Test Loss: 2.545 Test Acc: 0.326
Validation loss decreased (-0.326060 --> -0.326062).  Saving model ...
Epoch: 13 cost time: 3.9600391387939453
Epoch: 13, Steps: 9 | Train Loss: 0.026 Vali Loss: 2.782 Vali Acc: 0.319 Test Loss: 2.782 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.023380517959595
Epoch: 14, Steps: 9 | Train Loss: 0.019 Vali Loss: 2.556 Vali Acc: 0.333 Test Loss: 2.556 Test Acc: 0.333
Validation loss decreased (-0.326062 --> -0.333308).  Saving model ...
Epoch: 15 cost time: 3.778942346572876
Epoch: 15, Steps: 9 | Train Loss: 0.010 Vali Loss: 2.363 Vali Acc: 0.341 Test Loss: 2.363 Test Acc: 0.341
Validation loss decreased (-0.333308 --> -0.340556).  Saving model ...
Epoch: 16 cost time: 4.181852102279663
Epoch: 16, Steps: 9 | Train Loss: 0.010 Vali Loss: 2.666 Vali Acc: 0.326 Test Loss: 2.666 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.9009673595428467
Epoch: 17, Steps: 9 | Train Loss: 0.008 Vali Loss: 2.681 Vali Acc: 0.341 Test Loss: 2.681 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.733930826187134
Epoch: 18, Steps: 9 | Train Loss: 0.006 Vali Loss: 2.181 Vali Acc: 0.362 Test Loss: 2.181 Test Acc: 0.362
Validation loss decreased (-0.340556 --> -0.362297).  Saving model ...
Epoch: 19 cost time: 4.255054950714111
Epoch: 19, Steps: 9 | Train Loss: 0.005 Vali Loss: 2.375 Vali Acc: 0.348 Test Loss: 2.375 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.061732292175293
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 2.481 Vali Acc: 0.341 Test Loss: 2.481 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.043097734451294
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 2.498 Vali Acc: 0.355 Test Loss: 2.498 Test Acc: 0.355
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.176593542098999
Epoch: 22, Steps: 9 | Train Loss: 0.003 Vali Loss: 2.428 Vali Acc: 0.362 Test Loss: 2.428 Test Acc: 0.362
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.739251136779785
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 2.353 Vali Acc: 0.377 Test Loss: 2.353 Test Acc: 0.377
Validation loss decreased (-0.362297 --> -0.376788).  Saving model ...
Epoch: 24 cost time: 3.924914598464966
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.339 Vali Acc: 0.391 Test Loss: 2.339 Test Acc: 0.391
Validation loss decreased (-0.376788 --> -0.391281).  Saving model ...
Epoch: 25 cost time: 4.4658894538879395
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.364 Vali Acc: 0.377 Test Loss: 2.364 Test Acc: 0.377
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.231797218322754
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.366 Vali Acc: 0.391 Test Loss: 2.366 Test Acc: 0.391
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.8997411727905273
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.416 Vali Acc: 0.399 Test Loss: 2.416 Test Acc: 0.399
Validation loss decreased (-0.391281 --> -0.398527).  Saving model ...
Epoch: 28 cost time: 3.8713154792785645
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.460 Vali Acc: 0.377 Test Loss: 2.460 Test Acc: 0.377
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.944244861602783
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.453 Vali Acc: 0.406 Test Loss: 2.453 Test Acc: 0.406
Validation loss decreased (-0.398527 --> -0.405773).  Saving model ...
Epoch: 30 cost time: 3.904068946838379
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.446 Vali Acc: 0.399 Test Loss: 2.446 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.674360513687134
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.457 Vali Acc: 0.406 Test Loss: 2.457 Test Acc: 0.406
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 4.386956214904785
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.519 Vali Acc: 0.391 Test Loss: 2.519 Test Acc: 0.391
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 4.41384220123291
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.337 Vali Acc: 0.435 Test Loss: 2.337 Test Acc: 0.435
Validation loss decreased (-0.405773 --> -0.434759).  Saving model ...
Epoch: 34 cost time: 4.008135080337524
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.304 Vali Acc: 0.435 Test Loss: 2.304 Test Acc: 0.435
Validation loss decreased (-0.434759 --> -0.434760).  Saving model ...
Epoch: 35 cost time: 4.02681827545166
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.324 Vali Acc: 0.442 Test Loss: 2.324 Test Acc: 0.442
Validation loss decreased (-0.434760 --> -0.442006).  Saving model ...
Epoch: 36 cost time: 3.9354794025421143
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.405 Vali Acc: 0.435 Test Loss: 2.405 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.795259475708008
Epoch: 37, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.438 Vali Acc: 0.428 Test Loss: 2.438 Test Acc: 0.428
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 4.118792772293091
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.447 Vali Acc: 0.428 Test Loss: 2.447 Test Acc: 0.428
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 4.324235200881958
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.381 Vali Acc: 0.442 Test Loss: 2.381 Test Acc: 0.442
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.9202260971069336
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.369 Vali Acc: 0.457 Test Loss: 2.369 Test Acc: 0.457
Validation loss decreased (-0.442006 --> -0.456498).  Saving model ...
Epoch: 41 cost time: 4.2328855991363525
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.436 Vali Acc: 0.428 Test Loss: 2.436 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 4.38526177406311
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.467 Vali Acc: 0.435 Test Loss: 2.467 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 4.615118741989136
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.435 Vali Acc: 0.420 Test Loss: 2.435 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 4.177608013153076
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.340 Vali Acc: 0.449 Test Loss: 2.340 Test Acc: 0.449
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 4.261659383773804
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.409 Vali Acc: 0.449 Test Loss: 2.409 Test Acc: 0.449
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 4.437264442443848
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.461 Vali Acc: 0.442 Test Loss: 2.461 Test Acc: 0.442
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 4.0562193393707275
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.536 Vali Acc: 0.413 Test Loss: 2.536 Test Acc: 0.413
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 4.035030364990234
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.513 Vali Acc: 0.420 Test Loss: 2.513 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 3.909291982650757
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.441 Vali Acc: 0.442 Test Loss: 2.441 Test Acc: 0.442
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 4.030421018600464
Epoch: 50, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.391 Vali Acc: 0.457 Test Loss: 2.391 Test Acc: 0.457
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.45652173913043476
model parameter : 2341124
model size : 13.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.94715142250061
Epoch: 1, Steps: 9 | Train Loss: 1.428 Vali Loss: 1.408 Vali Acc: 0.326 Test Loss: 1.408 Test Acc: 0.326
Validation loss decreased (inf --> -0.326073).  Saving model ...
Epoch: 2 cost time: 4.38641619682312
Epoch: 2, Steps: 9 | Train Loss: 1.321 Vali Loss: 1.419 Vali Acc: 0.283 Test Loss: 1.419 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.161865711212158
Epoch: 3, Steps: 9 | Train Loss: 1.117 Vali Loss: 1.360 Vali Acc: 0.312 Test Loss: 1.360 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.025115489959717
Epoch: 4, Steps: 9 | Train Loss: 0.864 Vali Loss: 1.404 Vali Acc: 0.290 Test Loss: 1.404 Test Acc: 0.290
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.021701812744141
Epoch: 5, Steps: 9 | Train Loss: 0.627 Vali Loss: 1.385 Vali Acc: 0.304 Test Loss: 1.385 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.020807981491089
Epoch: 6, Steps: 9 | Train Loss: 0.446 Vali Loss: 1.555 Vali Acc: 0.283 Test Loss: 1.555 Test Acc: 0.283
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.458651304244995
Epoch: 7, Steps: 9 | Train Loss: 0.281 Vali Loss: 1.681 Vali Acc: 0.297 Test Loss: 1.681 Test Acc: 0.297
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.6882054805755615
Epoch: 8, Steps: 9 | Train Loss: 0.167 Vali Loss: 1.942 Vali Acc: 0.304 Test Loss: 1.942 Test Acc: 0.304
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.6087095737457275
Epoch: 9, Steps: 9 | Train Loss: 0.114 Vali Loss: 1.702 Vali Acc: 0.355 Test Loss: 1.702 Test Acc: 0.355
Validation loss decreased (-0.326073 --> -0.355055).  Saving model ...
Epoch: 10 cost time: 4.540313005447388
Epoch: 10, Steps: 9 | Train Loss: 0.064 Vali Loss: 2.020 Vali Acc: 0.333 Test Loss: 2.020 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.390054702758789
Epoch: 11, Steps: 9 | Train Loss: 0.034 Vali Loss: 2.001 Vali Acc: 0.333 Test Loss: 2.001 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.236724138259888
Epoch: 12, Steps: 9 | Train Loss: 0.021 Vali Loss: 1.796 Vali Acc: 0.370 Test Loss: 1.796 Test Acc: 0.370
Validation loss decreased (-0.355055 --> -0.369547).  Saving model ...
Epoch: 13 cost time: 4.419596195220947
Epoch: 13, Steps: 9 | Train Loss: 0.015 Vali Loss: 2.033 Vali Acc: 0.341 Test Loss: 2.033 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.410998106002808
Epoch: 14, Steps: 9 | Train Loss: 0.011 Vali Loss: 1.891 Vali Acc: 0.377 Test Loss: 1.891 Test Acc: 0.377
Validation loss decreased (-0.369547 --> -0.376793).  Saving model ...
Epoch: 15 cost time: 4.573118209838867
Epoch: 15, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.733 Vali Acc: 0.362 Test Loss: 1.733 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.357136487960815
Epoch: 16, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.733 Vali Acc: 0.384 Test Loss: 1.733 Test Acc: 0.384
Validation loss decreased (-0.376793 --> -0.384041).  Saving model ...
Epoch: 17 cost time: 4.20864725112915
Epoch: 17, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.854 Vali Acc: 0.391 Test Loss: 1.854 Test Acc: 0.391
Validation loss decreased (-0.384041 --> -0.391286).  Saving model ...
Epoch: 18 cost time: 4.200434684753418
Epoch: 18, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.636 Vali Acc: 0.406 Test Loss: 1.636 Test Acc: 0.406
Validation loss decreased (-0.391286 --> -0.405781).  Saving model ...
Epoch: 19 cost time: 4.361236810684204
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.640 Vali Acc: 0.413 Test Loss: 1.640 Test Acc: 0.413
Validation loss decreased (-0.405781 --> -0.413027).  Saving model ...
Epoch: 20 cost time: 4.028364896774292
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.611 Vali Acc: 0.435 Test Loss: 1.611 Test Acc: 0.435
Validation loss decreased (-0.413027 --> -0.434767).  Saving model ...
Epoch: 21 cost time: 3.9528632164001465
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.618 Vali Acc: 0.420 Test Loss: 1.618 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.042377710342407
Epoch: 22, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.638 Vali Acc: 0.428 Test Loss: 1.638 Test Acc: 0.428
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.160664796829224
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.593 Vali Acc: 0.457 Test Loss: 1.593 Test Acc: 0.457
Validation loss decreased (-0.434767 --> -0.456506).  Saving model ...
Epoch: 24 cost time: 4.240477800369263
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.574 Vali Acc: 0.442 Test Loss: 1.574 Test Acc: 0.442
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.028928518295288
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.592 Vali Acc: 0.420 Test Loss: 1.592 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.865772008895874
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.593 Vali Acc: 0.457 Test Loss: 1.593 Test Acc: 0.457
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.032270669937134
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.552 Vali Acc: 0.457 Test Loss: 1.552 Test Acc: 0.457
Validation loss decreased (-0.456506 --> -0.456506).  Saving model ...
Epoch: 28 cost time: 4.082513809204102
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.535 Vali Acc: 0.478 Test Loss: 1.535 Test Acc: 0.478
Validation loss decreased (-0.456506 --> -0.478246).  Saving model ...
Epoch: 29 cost time: 4.396556854248047
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.551 Vali Acc: 0.471 Test Loss: 1.551 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.771722316741943
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.561 Vali Acc: 0.478 Test Loss: 1.561 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 4.503786325454712
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.529 Vali Acc: 0.500 Test Loss: 1.529 Test Acc: 0.500
Validation loss decreased (-0.478246 --> -0.499985).  Saving model ...
Epoch: 32 cost time: 4.4794762134552
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.525 Vali Acc: 0.500 Test Loss: 1.525 Test Acc: 0.500
Validation loss decreased (-0.499985 --> -0.499985).  Saving model ...
Epoch: 33 cost time: 4.31624698638916
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.485 Vali Acc: 0.500 Test Loss: 1.485 Test Acc: 0.500
Validation loss decreased (-0.499985 --> -0.499985).  Saving model ...
Epoch: 34 cost time: 4.6146581172943115
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.457 Vali Acc: 0.507 Test Loss: 1.457 Test Acc: 0.507
Validation loss decreased (-0.499985 --> -0.507232).  Saving model ...
Epoch: 35 cost time: 4.08306622505188
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.469 Vali Acc: 0.522 Test Loss: 1.469 Test Acc: 0.522
Validation loss decreased (-0.507232 --> -0.521724).  Saving model ...
Epoch: 36 cost time: 4.5602381229400635
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.501 Vali Acc: 0.522 Test Loss: 1.501 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 4.2455363273620605
Epoch: 37, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.515 Vali Acc: 0.507 Test Loss: 1.515 Test Acc: 0.507
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 4.073850154876709
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.497 Vali Acc: 0.507 Test Loss: 1.497 Test Acc: 0.507
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.995553970336914
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.430 Vali Acc: 0.536 Test Loss: 1.430 Test Acc: 0.536
Validation loss decreased (-0.521724 --> -0.536218).  Saving model ...
Epoch: 40 cost time: 4.157942295074463
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.408 Vali Acc: 0.536 Test Loss: 1.408 Test Acc: 0.536
Validation loss decreased (-0.536218 --> -0.536218).  Saving model ...
Epoch: 41 cost time: 3.725459337234497
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.436 Vali Acc: 0.536 Test Loss: 1.436 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.9454641342163086
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.463 Vali Acc: 0.529 Test Loss: 1.463 Test Acc: 0.529
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 4.207943439483643
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.475 Vali Acc: 0.543 Test Loss: 1.475 Test Acc: 0.543
Validation loss decreased (-0.536218 --> -0.543464).  Saving model ...
Epoch: 44 cost time: 4.032862663269043
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.408 Vali Acc: 0.558 Test Loss: 1.408 Test Acc: 0.558
Validation loss decreased (-0.543464 --> -0.557957).  Saving model ...
Epoch: 45 cost time: 3.854597330093384
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.420 Vali Acc: 0.543 Test Loss: 1.420 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 4.073800086975098
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.436 Vali Acc: 0.543 Test Loss: 1.436 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 4.3964080810546875
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.455 Vali Acc: 0.543 Test Loss: 1.455 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 4.071169137954712
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.446 Vali Acc: 0.558 Test Loss: 1.446 Test Acc: 0.558
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 3.8210065364837646
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.424 Vali Acc: 0.572 Test Loss: 1.424 Test Acc: 0.572
Validation loss decreased (-0.557957 --> -0.572450).  Saving model ...
Epoch: 50 cost time: 3.971251964569092
Epoch: 50, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.403 Vali Acc: 0.587 Test Loss: 1.403 Test Acc: 0.587
Validation loss decreased (-0.572450 --> -0.586942).  Saving model ...
Epoch: 51 cost time: 4.015316963195801
Epoch: 51, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.403 Vali Acc: 0.594 Test Loss: 1.403 Test Acc: 0.594
Validation loss decreased (-0.586942 --> -0.594189).  Saving model ...
Epoch: 52 cost time: 4.222718954086304
Epoch: 52, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.412 Vali Acc: 0.580 Test Loss: 1.412 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 4.327545881271362
Epoch: 53, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.429 Vali Acc: 0.587 Test Loss: 1.429 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 4.310067653656006
Epoch: 54, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.449 Vali Acc: 0.572 Test Loss: 1.449 Test Acc: 0.572
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 4.477023601531982
Epoch: 55, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.454 Vali Acc: 0.565 Test Loss: 1.454 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 4.521311283111572
Epoch: 56, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.449 Vali Acc: 0.572 Test Loss: 1.449 Test Acc: 0.572
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 3.8876709938049316
Epoch: 57, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.439 Vali Acc: 0.565 Test Loss: 1.439 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 4.118579864501953
Epoch: 58, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.412 Vali Acc: 0.594 Test Loss: 1.412 Test Acc: 0.594
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 3.9859540462493896
Epoch: 59, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.400 Vali Acc: 0.609 Test Loss: 1.400 Test Acc: 0.609
Validation loss decreased (-0.594189 --> -0.608682).  Saving model ...
Epoch: 60 cost time: 3.956981658935547
Epoch: 60, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.388 Vali Acc: 0.623 Test Loss: 1.388 Test Acc: 0.623
Validation loss decreased (-0.608682 --> -0.623175).  Saving model ...
Epoch: 61 cost time: 3.7312989234924316
Epoch: 61, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.375 Vali Acc: 0.623 Test Loss: 1.375 Test Acc: 0.623
Validation loss decreased (-0.623175 --> -0.623175).  Saving model ...
Epoch: 62 cost time: 4.551664590835571
Epoch: 62, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.382 Vali Acc: 0.630 Test Loss: 1.382 Test Acc: 0.630
Validation loss decreased (-0.623175 --> -0.630421).  Saving model ...
Epoch: 63 cost time: 4.061821222305298
Epoch: 63, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.391 Vali Acc: 0.623 Test Loss: 1.391 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 3.7607781887054443
Epoch: 64, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.404 Vali Acc: 0.623 Test Loss: 1.404 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 3.908705711364746
Epoch: 65, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.403 Vali Acc: 0.623 Test Loss: 1.403 Test Acc: 0.623
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 4.195070505142212
Epoch: 66, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.408 Vali Acc: 0.616 Test Loss: 1.408 Test Acc: 0.616
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 4.161618232727051
Epoch: 67, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.411 Vali Acc: 0.616 Test Loss: 1.411 Test Acc: 0.616
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 3.972843885421753
Epoch: 68, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.412 Vali Acc: 0.616 Test Loss: 1.412 Test Acc: 0.616
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 4.26798415184021
Epoch: 69, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.414 Vali Acc: 0.616 Test Loss: 1.414 Test Acc: 0.616
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 4.109379053115845
Epoch: 70, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.428 Vali Acc: 0.623 Test Loss: 1.428 Test Acc: 0.623
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 4.530689716339111
Epoch: 71, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.424 Vali Acc: 0.623 Test Loss: 1.424 Test Acc: 0.623
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 4.202828645706177
Epoch: 72, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.436 Vali Acc: 0.623 Test Loss: 1.436 Test Acc: 0.623
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.6304347826086957
model parameter : 2341124
model size : 13.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         103                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma103_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.128969192504883
Epoch: 1, Steps: 9 | Train Loss: 1.416 Vali Loss: 1.342 Vali Acc: 0.384 Test Loss: 1.342 Test Acc: 0.384
Validation loss decreased (inf --> -0.384045).  Saving model ...
Epoch: 2 cost time: 4.026585340499878
Epoch: 2, Steps: 9 | Train Loss: 1.188 Vali Loss: 1.125 Vali Acc: 0.565 Test Loss: 1.125 Test Acc: 0.565
Validation loss decreased (-0.384045 --> -0.565206).  Saving model ...
Epoch: 3 cost time: 3.683164596557617
Epoch: 3, Steps: 9 | Train Loss: 0.790 Vali Loss: 0.971 Vali Acc: 0.623 Test Loss: 0.971 Test Acc: 0.623
Validation loss decreased (-0.565206 --> -0.623179).  Saving model ...
Epoch: 4 cost time: 4.171698093414307
Epoch: 4, Steps: 9 | Train Loss: 0.480 Vali Loss: 0.800 Vali Acc: 0.739 Test Loss: 0.800 Test Acc: 0.739
Validation loss decreased (-0.623179 --> -0.739122).  Saving model ...
Epoch: 5 cost time: 4.284625768661499
Epoch: 5, Steps: 9 | Train Loss: 0.281 Vali Loss: 0.802 Vali Acc: 0.725 Test Loss: 0.802 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.9345171451568604
Epoch: 6, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.606 Vali Acc: 0.768 Test Loss: 0.606 Test Acc: 0.768
Validation loss decreased (-0.739122 --> -0.768110).  Saving model ...
Epoch: 7 cost time: 4.112250566482544
Epoch: 7, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.662 Vali Acc: 0.783 Test Loss: 0.662 Test Acc: 0.783
Validation loss decreased (-0.768110 --> -0.782602).  Saving model ...
Epoch: 8 cost time: 3.88270902633667
Epoch: 8, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.550 Vali Acc: 0.797 Test Loss: 0.550 Test Acc: 0.797
Validation loss decreased (-0.782602 --> -0.797096).  Saving model ...
Epoch: 9 cost time: 3.754671096801758
Epoch: 9, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.536 Vali Acc: 0.819 Test Loss: 0.536 Test Acc: 0.819
Validation loss decreased (-0.797096 --> -0.818835).  Saving model ...
Epoch: 10 cost time: 4.115788221359253
Epoch: 10, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.624 Vali Acc: 0.804 Test Loss: 0.624 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.415983200073242
Epoch: 11, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.541 Vali Acc: 0.797 Test Loss: 0.541 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.2989583015441895
Epoch: 12, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.528 Vali Acc: 0.826 Test Loss: 0.528 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826082).  Saving model ...
Epoch: 13 cost time: 4.26731014251709
Epoch: 13, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.550 Vali Acc: 0.819 Test Loss: 0.550 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.037170886993408
Epoch: 14, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.566 Vali Acc: 0.819 Test Loss: 0.566 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.0972678661346436
Epoch: 15, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.547 Vali Acc: 0.819 Test Loss: 0.547 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.7325479984283447
Epoch: 16, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.543 Vali Acc: 0.833 Test Loss: 0.543 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833328).  Saving model ...
Epoch: 17 cost time: 4.0712502002716064
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.565 Vali Acc: 0.826 Test Loss: 0.565 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.064842462539673
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.570 Vali Acc: 0.833 Test Loss: 0.570 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.278806209564209
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.559 Vali Acc: 0.826 Test Loss: 0.559 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.123725891113281
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.549 Vali Acc: 0.841 Test Loss: 0.549 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840574).  Saving model ...
Epoch: 21 cost time: 4.19106650352478
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.554 Vali Acc: 0.833 Test Loss: 0.554 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.130746364593506
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.560 Vali Acc: 0.841 Test Loss: 0.560 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.800520896911621
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.556 Vali Acc: 0.841 Test Loss: 0.556 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.614147901535034
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.555 Vali Acc: 0.848 Test Loss: 0.555 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847821).  Saving model ...
Epoch: 25 cost time: 3.753023862838745
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.560 Vali Acc: 0.848 Test Loss: 0.560 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.4509222507476807
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.560 Vali Acc: 0.855 Test Loss: 0.560 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855067).  Saving model ...
Epoch: 27 cost time: 3.9292869567871094
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.559 Vali Acc: 0.855 Test Loss: 0.559 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 28 cost time: 3.944037437438965
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.563 Vali Acc: 0.862 Test Loss: 0.563 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862313).  Saving model ...
Epoch: 29 cost time: 3.9569461345672607
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.566 Vali Acc: 0.862 Test Loss: 0.566 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.013856887817383
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.560 Vali Acc: 0.862 Test Loss: 0.560 Test Acc: 0.862
Validation loss decreased (-0.862313 --> -0.862313).  Saving model ...
Epoch: 31 cost time: 3.996155023574829
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.566 Vali Acc: 0.855 Test Loss: 0.566 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.8914151191711426
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.571 Vali Acc: 0.870 Test Loss: 0.571 Test Acc: 0.870
Validation loss decreased (-0.862313 --> -0.869560).  Saving model ...
Epoch: 33 cost time: 4.064007043838501
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.568 Vali Acc: 0.870 Test Loss: 0.568 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869560).  Saving model ...
Epoch: 34 cost time: 4.17109227180481
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.569 Vali Acc: 0.870 Test Loss: 0.569 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.8754358291625977
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.562 Vali Acc: 0.877 Test Loss: 0.562 Test Acc: 0.877
Validation loss decreased (-0.869560 --> -0.876806).  Saving model ...
Epoch: 36 cost time: 4.210522174835205
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.568 Vali Acc: 0.877 Test Loss: 0.568 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.914041042327881
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.576 Vali Acc: 0.870 Test Loss: 0.576 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 4.486981630325317
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.583 Vali Acc: 0.870 Test Loss: 0.583 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.9142873287200928
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.582 Vali Acc: 0.870 Test Loss: 0.582 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 4.054828882217407
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.572 Vali Acc: 0.877 Test Loss: 0.572 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 4.095669984817505
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.571 Vali Acc: 0.877 Test Loss: 0.571 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 4.0768773555755615
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.574 Vali Acc: 0.870 Test Loss: 0.574 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 3.8725831508636475
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.577 Vali Acc: 0.870 Test Loss: 0.577 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 3.8899343013763428
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.585 Vali Acc: 0.870 Test Loss: 0.585 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 3.908123016357422
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.589 Vali Acc: 0.870 Test Loss: 0.589 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma103_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 1554692
model size : 10.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         83                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma83_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.850975751876831
Epoch: 1, Steps: 9 | Train Loss: 1.414 Vali Loss: 1.339 Vali Acc: 0.406 Test Loss: 1.339 Test Acc: 0.406
Validation loss decreased (inf --> -0.405784).  Saving model ...
Epoch: 2 cost time: 4.376396179199219
Epoch: 2, Steps: 9 | Train Loss: 1.186 Vali Loss: 1.123 Vali Acc: 0.594 Test Loss: 1.123 Test Acc: 0.594
Validation loss decreased (-0.405784 --> -0.594192).  Saving model ...
Epoch: 3 cost time: 4.136160850524902
Epoch: 3, Steps: 9 | Train Loss: 0.801 Vali Loss: 0.971 Vali Acc: 0.630 Test Loss: 0.971 Test Acc: 0.630
Validation loss decreased (-0.594192 --> -0.630425).  Saving model ...
Epoch: 4 cost time: 4.239831209182739
Epoch: 4, Steps: 9 | Train Loss: 0.489 Vali Loss: 0.789 Vali Acc: 0.746 Test Loss: 0.789 Test Acc: 0.746
Validation loss decreased (-0.630425 --> -0.746369).  Saving model ...
Epoch: 5 cost time: 3.960588216781616
Epoch: 5, Steps: 9 | Train Loss: 0.286 Vali Loss: 0.785 Vali Acc: 0.732 Test Loss: 0.785 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.256853818893433
Epoch: 6, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.578 Vali Acc: 0.790 Test Loss: 0.578 Test Acc: 0.790
Validation loss decreased (-0.746369 --> -0.789849).  Saving model ...
Epoch: 7 cost time: 3.8806676864624023
Epoch: 7, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.632 Vali Acc: 0.783 Test Loss: 0.632 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.96417236328125
Epoch: 8, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.495 Vali Acc: 0.812 Test Loss: 0.495 Test Acc: 0.812
Validation loss decreased (-0.789849 --> -0.811589).  Saving model ...
Epoch: 9 cost time: 4.040356397628784
Epoch: 9, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.510 Vali Acc: 0.833 Test Loss: 0.510 Test Acc: 0.833
Validation loss decreased (-0.811589 --> -0.833328).  Saving model ...
Epoch: 10 cost time: 4.201205015182495
Epoch: 10, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.572 Vali Acc: 0.833 Test Loss: 0.572 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.740760326385498
Epoch: 11, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.476 Vali Acc: 0.855 Test Loss: 0.476 Test Acc: 0.855
Validation loss decreased (-0.833328 --> -0.855068).  Saving model ...
Epoch: 12 cost time: 3.7708561420440674
Epoch: 12, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.469 Vali Acc: 0.855 Test Loss: 0.469 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 13 cost time: 3.7649950981140137
Epoch: 13, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.505 Vali Acc: 0.855 Test Loss: 0.505 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.85384202003479
Epoch: 14, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.514 Vali Acc: 0.862 Test Loss: 0.514 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 15 cost time: 3.759687900543213
Epoch: 15, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.479 Vali Acc: 0.870 Test Loss: 0.479 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869560).  Saving model ...
Epoch: 16 cost time: 3.8279213905334473
Epoch: 16, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.483 Vali Acc: 0.870 Test Loss: 0.483 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.001801490783691
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.510 Vali Acc: 0.870 Test Loss: 0.510 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.699944257736206
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.513 Vali Acc: 0.870 Test Loss: 0.513 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.003889322280884
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.499 Vali Acc: 0.877 Test Loss: 0.499 Test Acc: 0.877
Validation loss decreased (-0.869560 --> -0.876807).  Saving model ...
Epoch: 20 cost time: 4.060084819793701
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.492 Vali Acc: 0.884 Test Loss: 0.492 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884053).  Saving model ...
Epoch: 21 cost time: 3.840350866317749
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.494 Vali Acc: 0.884 Test Loss: 0.494 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.048821449279785
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.495 Vali Acc: 0.884 Test Loss: 0.495 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.059126138687134
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.498 Vali Acc: 0.884 Test Loss: 0.498 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.4392759799957275
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.493 Vali Acc: 0.891 Test Loss: 0.493 Test Acc: 0.891
Validation loss decreased (-0.884053 --> -0.891299).  Saving model ...
Epoch: 25 cost time: 4.201141119003296
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.497 Vali Acc: 0.891 Test Loss: 0.497 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.314948797225952
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.495 Vali Acc: 0.891 Test Loss: 0.495 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.86200213432312
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.499 Vali Acc: 0.891 Test Loss: 0.499 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.266513347625732
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.504 Vali Acc: 0.891 Test Loss: 0.504 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.5715394020080566
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.507 Vali Acc: 0.891 Test Loss: 0.507 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.7439305782318115
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.500 Vali Acc: 0.891 Test Loss: 0.500 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.85149884223938
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.503 Vali Acc: 0.899 Test Loss: 0.503 Test Acc: 0.899
Validation loss decreased (-0.891299 --> -0.898546).  Saving model ...
Epoch: 32 cost time: 3.6021041870117188
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.503 Vali Acc: 0.891 Test Loss: 0.503 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.8936233520507812
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.501 Vali Acc: 0.891 Test Loss: 0.501 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.715623140335083
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.504 Vali Acc: 0.891 Test Loss: 0.504 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.996013879776001
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.497 Vali Acc: 0.891 Test Loss: 0.497 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.9773340225219727
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.502 Vali Acc: 0.891 Test Loss: 0.502 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.7145755290985107
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.510 Vali Acc: 0.899 Test Loss: 0.510 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.5354700088500977
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.518 Vali Acc: 0.899 Test Loss: 0.518 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 4.0485687255859375
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.516 Vali Acc: 0.899 Test Loss: 0.516 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.9612770080566406
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.506 Vali Acc: 0.891 Test Loss: 0.506 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 4.007588624954224
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.507 Vali Acc: 0.899 Test Loss: 0.507 Test Acc: 0.899
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma83_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 1554692
model size : 10.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         62                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma62_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.936387300491333
Epoch: 1, Steps: 9 | Train Loss: 1.413 Vali Loss: 1.336 Vali Acc: 0.399 Test Loss: 1.336 Test Acc: 0.399
Validation loss decreased (inf --> -0.398537).  Saving model ...
Epoch: 2 cost time: 3.4753239154815674
Epoch: 2, Steps: 9 | Train Loss: 1.183 Vali Loss: 1.129 Vali Acc: 0.587 Test Loss: 1.129 Test Acc: 0.587
Validation loss decreased (-0.398537 --> -0.586945).  Saving model ...
Epoch: 3 cost time: 3.923781633377075
Epoch: 3, Steps: 9 | Train Loss: 0.794 Vali Loss: 0.980 Vali Acc: 0.638 Test Loss: 0.980 Test Acc: 0.638
Validation loss decreased (-0.586945 --> -0.637671).  Saving model ...
Epoch: 4 cost time: 3.6378750801086426
Epoch: 4, Steps: 9 | Train Loss: 0.479 Vali Loss: 0.802 Vali Acc: 0.754 Test Loss: 0.802 Test Acc: 0.754
Validation loss decreased (-0.637671 --> -0.753615).  Saving model ...
Epoch: 5 cost time: 3.638401508331299
Epoch: 5, Steps: 9 | Train Loss: 0.270 Vali Loss: 0.784 Vali Acc: 0.739 Test Loss: 0.784 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.4318761825561523
Epoch: 6, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.593 Vali Acc: 0.819 Test Loss: 0.593 Test Acc: 0.819
Validation loss decreased (-0.753615 --> -0.818835).  Saving model ...
Epoch: 7 cost time: 3.4383914470672607
Epoch: 7, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.609 Vali Acc: 0.833 Test Loss: 0.609 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833327).  Saving model ...
Epoch: 8 cost time: 3.698300838470459
Epoch: 8, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.524 Vali Acc: 0.855 Test Loss: 0.524 Test Acc: 0.855
Validation loss decreased (-0.833327 --> -0.855067).  Saving model ...
Epoch: 9 cost time: 3.631344795227051
Epoch: 9, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.504 Vali Acc: 0.877 Test Loss: 0.504 Test Acc: 0.877
Validation loss decreased (-0.855067 --> -0.876807).  Saving model ...
Epoch: 10 cost time: 3.5948941707611084
Epoch: 10, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.580 Vali Acc: 0.848 Test Loss: 0.580 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.6100122928619385
Epoch: 11, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.508 Vali Acc: 0.891 Test Loss: 0.508 Test Acc: 0.891
Validation loss decreased (-0.876807 --> -0.891299).  Saving model ...
Epoch: 12 cost time: 3.6565845012664795
Epoch: 12, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.487 Vali Acc: 0.906 Test Loss: 0.487 Test Acc: 0.906
Validation loss decreased (-0.891299 --> -0.905792).  Saving model ...
Epoch: 13 cost time: 3.5554261207580566
Epoch: 13, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.512 Vali Acc: 0.913 Test Loss: 0.512 Test Acc: 0.913
Validation loss decreased (-0.905792 --> -0.913038).  Saving model ...
Epoch: 14 cost time: 3.6195645332336426
Epoch: 14, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.525 Vali Acc: 0.906 Test Loss: 0.525 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.6723945140838623
Epoch: 15, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.496 Vali Acc: 0.906 Test Loss: 0.496 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.9098331928253174
Epoch: 16, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.492 Vali Acc: 0.906 Test Loss: 0.492 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.550118923187256
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.515 Vali Acc: 0.913 Test Loss: 0.515 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.7391347885131836
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.524 Vali Acc: 0.906 Test Loss: 0.524 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.8040542602539062
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.511 Vali Acc: 0.920 Test Loss: 0.511 Test Acc: 0.920
Validation loss decreased (-0.913038 --> -0.920285).  Saving model ...
Epoch: 20 cost time: 3.9930660724639893
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.504 Vali Acc: 0.920 Test Loss: 0.504 Test Acc: 0.920
Validation loss decreased (-0.920285 --> -0.920285).  Saving model ...
Epoch: 21 cost time: 3.9049975872039795
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.506 Vali Acc: 0.928 Test Loss: 0.506 Test Acc: 0.928
Validation loss decreased (-0.920285 --> -0.927531).  Saving model ...
Epoch: 22 cost time: 3.833814859390259
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.506 Vali Acc: 0.928 Test Loss: 0.506 Test Acc: 0.928
Validation loss decreased (-0.927531 --> -0.927531).  Saving model ...
Epoch: 23 cost time: 3.864670991897583
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.508 Vali Acc: 0.928 Test Loss: 0.508 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.6333842277526855
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.507 Vali Acc: 0.920 Test Loss: 0.507 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.6248042583465576
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.512 Vali Acc: 0.928 Test Loss: 0.512 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.6765732765197754
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.511 Vali Acc: 0.928 Test Loss: 0.511 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.605391025543213
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.512 Vali Acc: 0.928 Test Loss: 0.512 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.576641082763672
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.515 Vali Acc: 0.920 Test Loss: 0.515 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.6692001819610596
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.519 Vali Acc: 0.928 Test Loss: 0.519 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.71012020111084
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.515 Vali Acc: 0.928 Test Loss: 0.515 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.7861268520355225
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.520 Vali Acc: 0.920 Test Loss: 0.520 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.7007088661193848
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.516 Vali Acc: 0.920 Test Loss: 0.516 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma62_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 1554692
model size : 10.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         42                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.633411884307861
Epoch: 1, Steps: 9 | Train Loss: 1.404 Vali Loss: 1.315 Vali Acc: 0.391 Test Loss: 1.315 Test Acc: 0.391
Validation loss decreased (inf --> -0.391291).  Saving model ...
Epoch: 2 cost time: 3.8125925064086914
Epoch: 2, Steps: 9 | Train Loss: 1.155 Vali Loss: 1.084 Vali Acc: 0.616 Test Loss: 1.084 Test Acc: 0.616
Validation loss decreased (-0.391291 --> -0.615931).  Saving model ...
Epoch: 3 cost time: 3.9226648807525635
Epoch: 3, Steps: 9 | Train Loss: 0.762 Vali Loss: 0.942 Vali Acc: 0.667 Test Loss: 0.942 Test Acc: 0.667
Validation loss decreased (-0.615931 --> -0.666657).  Saving model ...
Epoch: 4 cost time: 3.5777981281280518
Epoch: 4, Steps: 9 | Train Loss: 0.443 Vali Loss: 0.752 Vali Acc: 0.754 Test Loss: 0.752 Test Acc: 0.754
Validation loss decreased (-0.666657 --> -0.753616).  Saving model ...
Epoch: 5 cost time: 3.820215940475464
Epoch: 5, Steps: 9 | Train Loss: 0.246 Vali Loss: 0.758 Vali Acc: 0.746 Test Loss: 0.758 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.7181692123413086
Epoch: 6, Steps: 9 | Train Loss: 0.126 Vali Loss: 0.566 Vali Acc: 0.797 Test Loss: 0.566 Test Acc: 0.797
Validation loss decreased (-0.753616 --> -0.797096).  Saving model ...
Epoch: 7 cost time: 3.9980883598327637
Epoch: 7, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.565 Vali Acc: 0.797 Test Loss: 0.565 Test Acc: 0.797
Validation loss decreased (-0.797096 --> -0.797096).  Saving model ...
Epoch: 8 cost time: 3.580533504486084
Epoch: 8, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.511 Vali Acc: 0.826 Test Loss: 0.511 Test Acc: 0.826
Validation loss decreased (-0.797096 --> -0.826082).  Saving model ...
Epoch: 9 cost time: 3.7824056148529053
Epoch: 9, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.487 Vali Acc: 0.826 Test Loss: 0.487 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 10 cost time: 3.5897059440612793
Epoch: 10, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.551 Vali Acc: 0.819 Test Loss: 0.551 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.650156021118164
Epoch: 11, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.472 Vali Acc: 0.848 Test Loss: 0.472 Test Acc: 0.848
Validation loss decreased (-0.826082 --> -0.847821).  Saving model ...
Epoch: 12 cost time: 4.067711114883423
Epoch: 12, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.461 Vali Acc: 0.848 Test Loss: 0.461 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 13 cost time: 3.6688485145568848
Epoch: 13, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.500 Vali Acc: 0.826 Test Loss: 0.500 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.6132755279541016
Epoch: 14, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.503 Vali Acc: 0.826 Test Loss: 0.503 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.4296987056732178
Epoch: 15, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.452 Vali Acc: 0.862 Test Loss: 0.452 Test Acc: 0.862
Validation loss decreased (-0.847821 --> -0.862314).  Saving model ...
Epoch: 16 cost time: 3.721865177154541
Epoch: 16, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.460 Vali Acc: 0.862 Test Loss: 0.460 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.5029547214508057
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.499 Vali Acc: 0.855 Test Loss: 0.499 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.3563995361328125
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.500 Vali Acc: 0.848 Test Loss: 0.500 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.906289577484131
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.482 Vali Acc: 0.848 Test Loss: 0.482 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.979260206222534
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.476 Vali Acc: 0.877 Test Loss: 0.476 Test Acc: 0.877
Validation loss decreased (-0.862314 --> -0.876807).  Saving model ...
Epoch: 21 cost time: 3.9474427700042725
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.483 Vali Acc: 0.870 Test Loss: 0.483 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.7529101371765137
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.480 Vali Acc: 0.862 Test Loss: 0.480 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.242841720581055
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.481 Vali Acc: 0.877 Test Loss: 0.481 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.7179036140441895
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.484 Vali Acc: 0.862 Test Loss: 0.484 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.026603698730469
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.494 Vali Acc: 0.877 Test Loss: 0.494 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.187270879745483
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.486 Vali Acc: 0.877 Test Loss: 0.486 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.3109824657440186
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.477 Vali Acc: 0.877 Test Loss: 0.477 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.008861064910889
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.481 Vali Acc: 0.877 Test Loss: 0.481 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.036576747894287
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.488 Vali Acc: 0.877 Test Loss: 0.488 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.9876949787139893
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.487 Vali Acc: 0.877 Test Loss: 0.487 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 1554692
model size : 10.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.746200084686279
Epoch: 1, Steps: 9 | Train Loss: 1.406 Vali Loss: 1.325 Vali Acc: 0.399 Test Loss: 1.325 Test Acc: 0.399
Validation loss decreased (inf --> -0.398537).  Saving model ...
Epoch: 2 cost time: 3.7829809188842773
Epoch: 2, Steps: 9 | Train Loss: 1.174 Vali Loss: 1.123 Vali Acc: 0.609 Test Loss: 1.123 Test Acc: 0.609
Validation loss decreased (-0.398537 --> -0.608684).  Saving model ...
Epoch: 3 cost time: 3.610187530517578
Epoch: 3, Steps: 9 | Train Loss: 0.788 Vali Loss: 0.970 Vali Acc: 0.638 Test Loss: 0.970 Test Acc: 0.638
Validation loss decreased (-0.608684 --> -0.637671).  Saving model ...
Epoch: 4 cost time: 4.176855087280273
Epoch: 4, Steps: 9 | Train Loss: 0.478 Vali Loss: 0.775 Vali Acc: 0.754 Test Loss: 0.775 Test Acc: 0.754
Validation loss decreased (-0.637671 --> -0.753615).  Saving model ...
Epoch: 5 cost time: 4.074198961257935
Epoch: 5, Steps: 9 | Train Loss: 0.276 Vali Loss: 0.696 Vali Acc: 0.768 Test Loss: 0.696 Test Acc: 0.768
Validation loss decreased (-0.753615 --> -0.768109).  Saving model ...
Epoch: 6 cost time: 4.113283634185791
Epoch: 6, Steps: 9 | Train Loss: 0.138 Vali Loss: 0.521 Vali Acc: 0.841 Test Loss: 0.521 Test Acc: 0.841
Validation loss decreased (-0.768109 --> -0.840575).  Saving model ...
Epoch: 7 cost time: 4.65179443359375
Epoch: 7, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.468 Vali Acc: 0.826 Test Loss: 0.468 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.183373689651489
Epoch: 8, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.412 Vali Acc: 0.833 Test Loss: 0.412 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.120118141174316
Epoch: 9, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.384 Vali Acc: 0.855 Test Loss: 0.384 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855069).  Saving model ...
Epoch: 10 cost time: 3.9164788722991943
Epoch: 10, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.432 Vali Acc: 0.841 Test Loss: 0.432 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.353992223739624
Epoch: 11, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.348 Vali Acc: 0.870 Test Loss: 0.348 Test Acc: 0.870
Validation loss decreased (-0.855069 --> -0.869562).  Saving model ...
Epoch: 12 cost time: 4.253355264663696
Epoch: 12, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.344 Vali Acc: 0.877 Test Loss: 0.344 Test Acc: 0.877
Validation loss decreased (-0.869562 --> -0.876808).  Saving model ...
Epoch: 13 cost time: 4.0083091259002686
Epoch: 13, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.358 Vali Acc: 0.877 Test Loss: 0.358 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.19282341003418
Epoch: 14, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.367 Vali Acc: 0.884 Test Loss: 0.367 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 15 cost time: 4.096941947937012
Epoch: 15, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.341 Vali Acc: 0.877 Test Loss: 0.341 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.8707377910614014
Epoch: 16, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.333 Vali Acc: 0.884 Test Loss: 0.333 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884055).  Saving model ...
Epoch: 17 cost time: 3.927802801132202
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.352 Vali Acc: 0.891 Test Loss: 0.352 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
Epoch: 18 cost time: 3.814983367919922
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.357 Vali Acc: 0.884 Test Loss: 0.357 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.9998619556427
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.350 Vali Acc: 0.884 Test Loss: 0.350 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.9548025131225586
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.346 Vali Acc: 0.891 Test Loss: 0.346 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 21 cost time: 3.7498257160186768
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.348 Vali Acc: 0.899 Test Loss: 0.348 Test Acc: 0.899
Validation loss decreased (-0.891301 --> -0.898547).  Saving model ...
Epoch: 22 cost time: 3.6721158027648926
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.346 Vali Acc: 0.899 Test Loss: 0.346 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 23 cost time: 3.9276933670043945
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.341 Vali Acc: 0.891 Test Loss: 0.341 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.082530975341797
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.343 Vali Acc: 0.891 Test Loss: 0.343 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.932105779647827
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.345 Vali Acc: 0.891 Test Loss: 0.345 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.250073432922363
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.339 Vali Acc: 0.891 Test Loss: 0.339 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.7776243686676025
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.339 Vali Acc: 0.891 Test Loss: 0.339 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.8651680946350098
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.349 Vali Acc: 0.891 Test Loss: 0.349 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.5660240650177
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.349 Vali Acc: 0.891 Test Loss: 0.349 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 4.418473243713379
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.342 Vali Acc: 0.891 Test Loss: 0.342 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.733886480331421
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.345 Vali Acc: 0.891 Test Loss: 0.345 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.5742568969726562
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.345 Vali Acc: 0.891 Test Loss: 0.345 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 1554692
model size : 10.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.519845962524414
Epoch: 1, Steps: 9 | Train Loss: 1.370 Vali Loss: 1.312 Vali Acc: 0.406 Test Loss: 1.312 Test Acc: 0.406
Validation loss decreased (inf --> -0.405784).  Saving model ...
Epoch: 2 cost time: 3.981020450592041
Epoch: 2, Steps: 9 | Train Loss: 1.165 Vali Loss: 1.108 Vali Acc: 0.594 Test Loss: 1.108 Test Acc: 0.594
Validation loss decreased (-0.405784 --> -0.594192).  Saving model ...
Epoch: 3 cost time: 3.551257610321045
Epoch: 3, Steps: 9 | Train Loss: 0.801 Vali Loss: 0.976 Vali Acc: 0.645 Test Loss: 0.976 Test Acc: 0.645
Validation loss decreased (-0.594192 --> -0.644918).  Saving model ...
Epoch: 4 cost time: 3.7607388496398926
Epoch: 4, Steps: 9 | Train Loss: 0.503 Vali Loss: 0.794 Vali Acc: 0.725 Test Loss: 0.794 Test Acc: 0.725
Validation loss decreased (-0.644918 --> -0.724630).  Saving model ...
Epoch: 5 cost time: 3.6451008319854736
Epoch: 5, Steps: 9 | Train Loss: 0.295 Vali Loss: 0.755 Vali Acc: 0.717 Test Loss: 0.755 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.742093086242676
Epoch: 6, Steps: 9 | Train Loss: 0.172 Vali Loss: 0.571 Vali Acc: 0.790 Test Loss: 0.571 Test Acc: 0.790
Validation loss decreased (-0.724630 --> -0.789849).  Saving model ...
Epoch: 7 cost time: 3.881600856781006
Epoch: 7, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.568 Vali Acc: 0.775 Test Loss: 0.568 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.681579351425171
Epoch: 8, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.478 Vali Acc: 0.812 Test Loss: 0.478 Test Acc: 0.812
Validation loss decreased (-0.789849 --> -0.811589).  Saving model ...
Epoch: 9 cost time: 3.6403708457946777
Epoch: 9, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.487 Vali Acc: 0.797 Test Loss: 0.487 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.7015786170959473
Epoch: 10, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.506 Vali Acc: 0.804 Test Loss: 0.506 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.214011192321777
Epoch: 11, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.426 Vali Acc: 0.848 Test Loss: 0.426 Test Acc: 0.848
Validation loss decreased (-0.811589 --> -0.847822).  Saving model ...
Epoch: 12 cost time: 4.463489294052124
Epoch: 12, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.479 Vali Acc: 0.812 Test Loss: 0.479 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.283893823623657
Epoch: 13, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.463 Vali Acc: 0.826 Test Loss: 0.463 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.298761367797852
Epoch: 14, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.434 Vali Acc: 0.819 Test Loss: 0.434 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.4245781898498535
Epoch: 15, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.425 Vali Acc: 0.819 Test Loss: 0.425 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.451171875
Epoch: 16, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.441 Vali Acc: 0.826 Test Loss: 0.441 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.1074137687683105
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.438 Vali Acc: 0.826 Test Loss: 0.438 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.435227394104004
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.435 Vali Acc: 0.826 Test Loss: 0.435 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.328402280807495
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.440 Vali Acc: 0.826 Test Loss: 0.440 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.091531753540039
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.418 Vali Acc: 0.833 Test Loss: 0.418 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.7393970489501953
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.429 Vali Acc: 0.826 Test Loss: 0.429 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 1554692
model size : 10.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.802924633026123
Epoch: 1, Steps: 9 | Train Loss: 1.436 Vali Loss: 1.355 Vali Acc: 0.297 Test Loss: 1.355 Test Acc: 0.297
Validation loss decreased (inf --> -0.297088).  Saving model ...
Epoch: 2 cost time: 3.622054100036621
Epoch: 2, Steps: 9 | Train Loss: 1.192 Vali Loss: 1.159 Vali Acc: 0.471 Test Loss: 1.159 Test Acc: 0.471
Validation loss decreased (-0.297088 --> -0.471003).  Saving model ...
Epoch: 3 cost time: 4.1562628746032715
Epoch: 3, Steps: 9 | Train Loss: 0.833 Vali Loss: 1.020 Vali Acc: 0.594 Test Loss: 1.020 Test Acc: 0.594
Validation loss decreased (-0.471003 --> -0.594193).  Saving model ...
Epoch: 4 cost time: 3.8228535652160645
Epoch: 4, Steps: 9 | Train Loss: 0.515 Vali Loss: 0.868 Vali Acc: 0.638 Test Loss: 0.868 Test Acc: 0.638
Validation loss decreased (-0.594193 --> -0.637672).  Saving model ...
Epoch: 5 cost time: 4.162539720535278
Epoch: 5, Steps: 9 | Train Loss: 0.312 Vali Loss: 0.851 Vali Acc: 0.667 Test Loss: 0.851 Test Acc: 0.667
Validation loss decreased (-0.637672 --> -0.666658).  Saving model ...
Epoch: 6 cost time: 3.8797965049743652
Epoch: 6, Steps: 9 | Train Loss: 0.207 Vali Loss: 0.772 Vali Acc: 0.681 Test Loss: 0.772 Test Acc: 0.681
Validation loss decreased (-0.666658 --> -0.681152).  Saving model ...
Epoch: 7 cost time: 3.8020577430725098
Epoch: 7, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.714 Vali Acc: 0.703 Test Loss: 0.714 Test Acc: 0.703
Validation loss decreased (-0.681152 --> -0.702891).  Saving model ...
Epoch: 8 cost time: 4.059400796890259
Epoch: 8, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.687 Vali Acc: 0.739 Test Loss: 0.687 Test Acc: 0.739
Validation loss decreased (-0.702891 --> -0.739124).  Saving model ...
Epoch: 9 cost time: 3.8729469776153564
Epoch: 9, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.670 Vali Acc: 0.732 Test Loss: 0.670 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.720585346221924
Epoch: 10, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.685 Vali Acc: 0.732 Test Loss: 0.685 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.987948417663574
Epoch: 11, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.664 Vali Acc: 0.754 Test Loss: 0.664 Test Acc: 0.754
Validation loss decreased (-0.739124 --> -0.753617).  Saving model ...
Epoch: 12 cost time: 4.1573896408081055
Epoch: 12, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.689 Vali Acc: 0.746 Test Loss: 0.689 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.775071144104004
Epoch: 13, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.695 Vali Acc: 0.761 Test Loss: 0.695 Test Acc: 0.761
Validation loss decreased (-0.753617 --> -0.760863).  Saving model ...
Epoch: 14 cost time: 3.6510744094848633
Epoch: 14, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.684 Vali Acc: 0.761 Test Loss: 0.684 Test Acc: 0.761
Validation loss decreased (-0.760863 --> -0.760863).  Saving model ...
Epoch: 15 cost time: 3.7625138759613037
Epoch: 15, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.682 Vali Acc: 0.754 Test Loss: 0.682 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.096867561340332
Epoch: 16, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.692 Vali Acc: 0.754 Test Loss: 0.692 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.7241828441619873
Epoch: 17, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.712 Vali Acc: 0.761 Test Loss: 0.712 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.6403310298919678
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.713 Vali Acc: 0.761 Test Loss: 0.713 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.628880262374878
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.708 Vali Acc: 0.761 Test Loss: 0.708 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.783226251602173
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.711 Vali Acc: 0.761 Test Loss: 0.711 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.8074469566345215
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.715 Vali Acc: 0.761 Test Loss: 0.715 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.212194204330444
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.718 Vali Acc: 0.761 Test Loss: 0.718 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.3830649852752686
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.717 Vali Acc: 0.761 Test Loss: 0.717 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.208531618118286
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.719 Vali Acc: 0.761 Test Loss: 0.719 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7608695652173914
model parameter : 1554692
model size : 10.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.2322399616241455
Epoch: 1, Steps: 9 | Train Loss: 1.439 Vali Loss: 1.427 Vali Acc: 0.268 Test Loss: 1.427 Test Acc: 0.268
Validation loss decreased (inf --> -0.268102).  Saving model ...
Epoch: 2 cost time: 4.095425367355347
Epoch: 2, Steps: 9 | Train Loss: 1.293 Vali Loss: 1.390 Vali Acc: 0.304 Test Loss: 1.390 Test Acc: 0.304
Validation loss decreased (-0.268102 --> -0.304334).  Saving model ...
Epoch: 3 cost time: 4.541530609130859
Epoch: 3, Steps: 9 | Train Loss: 0.981 Vali Loss: 1.299 Vali Acc: 0.384 Test Loss: 1.299 Test Acc: 0.384
Validation loss decreased (-0.304334 --> -0.384045).  Saving model ...
Epoch: 4 cost time: 4.218522787094116
Epoch: 4, Steps: 9 | Train Loss: 0.710 Vali Loss: 1.289 Vali Acc: 0.420 Test Loss: 1.289 Test Acc: 0.420
Validation loss decreased (-0.384045 --> -0.420277).  Saving model ...
Epoch: 5 cost time: 4.187959909439087
Epoch: 5, Steps: 9 | Train Loss: 0.497 Vali Loss: 1.222 Vali Acc: 0.435 Test Loss: 1.222 Test Acc: 0.435
Validation loss decreased (-0.420277 --> -0.434770).  Saving model ...
Epoch: 6 cost time: 3.8967630863189697
Epoch: 6, Steps: 9 | Train Loss: 0.326 Vali Loss: 1.272 Vali Acc: 0.457 Test Loss: 1.272 Test Acc: 0.457
Validation loss decreased (-0.434770 --> -0.456509).  Saving model ...
Epoch: 7 cost time: 3.651879072189331
Epoch: 7, Steps: 9 | Train Loss: 0.215 Vali Loss: 1.266 Vali Acc: 0.464 Test Loss: 1.266 Test Acc: 0.464
Validation loss decreased (-0.456509 --> -0.463755).  Saving model ...
Epoch: 8 cost time: 3.820962905883789
Epoch: 8, Steps: 9 | Train Loss: 0.123 Vali Loss: 1.277 Vali Acc: 0.500 Test Loss: 1.277 Test Acc: 0.500
Validation loss decreased (-0.463755 --> -0.499987).  Saving model ...
Epoch: 9 cost time: 4.214576244354248
Epoch: 9, Steps: 9 | Train Loss: 0.077 Vali Loss: 1.487 Vali Acc: 0.435 Test Loss: 1.487 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.985454797744751
Epoch: 10, Steps: 9 | Train Loss: 0.056 Vali Loss: 1.297 Vali Acc: 0.529 Test Loss: 1.297 Test Acc: 0.529
Validation loss decreased (-0.499987 --> -0.528973).  Saving model ...
Epoch: 11 cost time: 3.7675399780273438
Epoch: 11, Steps: 9 | Train Loss: 0.025 Vali Loss: 1.500 Vali Acc: 0.514 Test Loss: 1.500 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.271328687667847
Epoch: 12, Steps: 9 | Train Loss: 0.015 Vali Loss: 1.577 Vali Acc: 0.486 Test Loss: 1.577 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.300459384918213
Epoch: 13, Steps: 9 | Train Loss: 0.012 Vali Loss: 1.388 Vali Acc: 0.536 Test Loss: 1.388 Test Acc: 0.536
Validation loss decreased (-0.528973 --> -0.536218).  Saving model ...
Epoch: 14 cost time: 4.363278150558472
Epoch: 14, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.461 Vali Acc: 0.522 Test Loss: 1.461 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.114941120147705
Epoch: 15, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.459 Vali Acc: 0.529 Test Loss: 1.459 Test Acc: 0.529
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.113577842712402
Epoch: 16, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.367 Vali Acc: 0.580 Test Loss: 1.367 Test Acc: 0.580
Validation loss decreased (-0.536218 --> -0.579696).  Saving model ...
Epoch: 17 cost time: 4.05615496635437
Epoch: 17, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.411 Vali Acc: 0.543 Test Loss: 1.411 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.180819034576416
Epoch: 18, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.472 Vali Acc: 0.529 Test Loss: 1.472 Test Acc: 0.529
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.0947370529174805
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.374 Vali Acc: 0.565 Test Loss: 1.374 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.439558267593384
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.421 Vali Acc: 0.565 Test Loss: 1.421 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.9009735584259033
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.442 Vali Acc: 0.543 Test Loss: 1.442 Test Acc: 0.543
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.8670101165771484
Epoch: 22, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.394 Vali Acc: 0.558 Test Loss: 1.394 Test Acc: 0.558
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.648040771484375
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.358 Vali Acc: 0.565 Test Loss: 1.358 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.8739678859710693
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.358 Vali Acc: 0.558 Test Loss: 1.358 Test Acc: 0.558
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.9053475856781006
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.378 Vali Acc: 0.572 Test Loss: 1.378 Test Acc: 0.572
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.936349868774414
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.382 Vali Acc: 0.565 Test Loss: 1.382 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5797101449275363
model parameter : 1554692
model size : 10.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.932691335678101
Epoch: 1, Steps: 9 | Train Loss: 1.496 Vali Loss: 1.382 Vali Acc: 0.348 Test Loss: 1.382 Test Acc: 0.348
Validation loss decreased (inf --> -0.347812).  Saving model ...
Epoch: 2 cost time: 3.9820101261138916
Epoch: 2, Steps: 9 | Train Loss: 1.371 Vali Loss: 1.450 Vali Acc: 0.290 Test Loss: 1.450 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.6899921894073486
Epoch: 3, Steps: 9 | Train Loss: 1.158 Vali Loss: 1.414 Vali Acc: 0.297 Test Loss: 1.414 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.056035041809082
Epoch: 4, Steps: 9 | Train Loss: 0.935 Vali Loss: 1.512 Vali Acc: 0.319 Test Loss: 1.512 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.9508919715881348
Epoch: 5, Steps: 9 | Train Loss: 0.744 Vali Loss: 1.571 Vali Acc: 0.304 Test Loss: 1.571 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.980562686920166
Epoch: 6, Steps: 9 | Train Loss: 0.560 Vali Loss: 1.892 Vali Acc: 0.326 Test Loss: 1.892 Test Acc: 0.326
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.6898837089538574
Epoch: 7, Steps: 9 | Train Loss: 0.413 Vali Loss: 2.089 Vali Acc: 0.326 Test Loss: 2.089 Test Acc: 0.326
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.6992440223693848
Epoch: 8, Steps: 9 | Train Loss: 0.270 Vali Loss: 2.313 Vali Acc: 0.319 Test Loss: 2.313 Test Acc: 0.319
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.840219259262085
Epoch: 9, Steps: 9 | Train Loss: 0.182 Vali Loss: 2.685 Vali Acc: 0.312 Test Loss: 2.685 Test Acc: 0.312
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.7778327465057373
Epoch: 10, Steps: 9 | Train Loss: 0.123 Vali Loss: 2.709 Vali Acc: 0.312 Test Loss: 2.709 Test Acc: 0.312
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.557713508605957
Epoch: 11, Steps: 9 | Train Loss: 0.075 Vali Loss: 2.876 Vali Acc: 0.319 Test Loss: 2.876 Test Acc: 0.319
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.34782608695652173
model parameter : 1554692
model size : 10.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.563579082489014
Epoch: 1, Steps: 9 | Train Loss: 1.430 Vali Loss: 1.417 Vali Acc: 0.254 Test Loss: 1.417 Test Acc: 0.254
Validation loss decreased (inf --> -0.253609).  Saving model ...
Epoch: 2 cost time: 3.482025623321533
Epoch: 2, Steps: 9 | Train Loss: 1.339 Vali Loss: 1.447 Vali Acc: 0.261 Test Loss: 1.447 Test Acc: 0.261
Validation loss decreased (-0.253609 --> -0.260855).  Saving model ...
Epoch: 3 cost time: 3.8429934978485107
Epoch: 3, Steps: 9 | Train Loss: 1.119 Vali Loss: 1.376 Vali Acc: 0.333 Test Loss: 1.376 Test Acc: 0.333
Validation loss decreased (-0.260855 --> -0.333320).  Saving model ...
Epoch: 4 cost time: 3.6000282764434814
Epoch: 4, Steps: 9 | Train Loss: 0.935 Vali Loss: 1.375 Vali Acc: 0.362 Test Loss: 1.375 Test Acc: 0.362
Validation loss decreased (-0.333320 --> -0.362305).  Saving model ...
Epoch: 5 cost time: 3.7552177906036377
Epoch: 5, Steps: 9 | Train Loss: 0.690 Vali Loss: 1.370 Vali Acc: 0.326 Test Loss: 1.370 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.672375440597534
Epoch: 6, Steps: 9 | Train Loss: 0.513 Vali Loss: 1.483 Vali Acc: 0.348 Test Loss: 1.483 Test Acc: 0.348
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.8739206790924072
Epoch: 7, Steps: 9 | Train Loss: 0.344 Vali Loss: 1.567 Vali Acc: 0.341 Test Loss: 1.567 Test Acc: 0.341
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.9314231872558594
Epoch: 8, Steps: 9 | Train Loss: 0.227 Vali Loss: 1.582 Vali Acc: 0.348 Test Loss: 1.582 Test Acc: 0.348
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.797469139099121
Epoch: 9, Steps: 9 | Train Loss: 0.139 Vali Loss: 1.876 Vali Acc: 0.348 Test Loss: 1.876 Test Acc: 0.348
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.2225916385650635
Epoch: 10, Steps: 9 | Train Loss: 0.092 Vali Loss: 1.692 Vali Acc: 0.362 Test Loss: 1.692 Test Acc: 0.362
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.301194667816162
Epoch: 11, Steps: 9 | Train Loss: 0.050 Vali Loss: 2.058 Vali Acc: 0.348 Test Loss: 2.058 Test Acc: 0.348
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.013254642486572
Epoch: 12, Steps: 9 | Train Loss: 0.031 Vali Loss: 1.934 Vali Acc: 0.355 Test Loss: 1.934 Test Acc: 0.355
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.1245951652526855
Epoch: 13, Steps: 9 | Train Loss: 0.020 Vali Loss: 1.716 Vali Acc: 0.362 Test Loss: 1.716 Test Acc: 0.362
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.972693681716919
Epoch: 14, Steps: 9 | Train Loss: 0.014 Vali Loss: 1.745 Vali Acc: 0.370 Test Loss: 1.745 Test Acc: 0.370
Validation loss decreased (-0.362305 --> -0.369548).  Saving model ...
Epoch: 15 cost time: 3.9595587253570557
Epoch: 15, Steps: 9 | Train Loss: 0.010 Vali Loss: 1.798 Vali Acc: 0.384 Test Loss: 1.798 Test Acc: 0.384
Validation loss decreased (-0.369548 --> -0.384040).  Saving model ...
Epoch: 16 cost time: 3.8048644065856934
Epoch: 16, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.742 Vali Acc: 0.384 Test Loss: 1.742 Test Acc: 0.384
Validation loss decreased (-0.384040 --> -0.384041).  Saving model ...
Epoch: 17 cost time: 3.963766574859619
Epoch: 17, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.720 Vali Acc: 0.399 Test Loss: 1.720 Test Acc: 0.399
Validation loss decreased (-0.384041 --> -0.398534).  Saving model ...
Epoch: 18 cost time: 4.155100107192993
Epoch: 18, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.778 Vali Acc: 0.399 Test Loss: 1.778 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.015744209289551
Epoch: 19, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.739 Vali Acc: 0.399 Test Loss: 1.739 Test Acc: 0.399
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.9450035095214844
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.678 Vali Acc: 0.399 Test Loss: 1.678 Test Acc: 0.399
Validation loss decreased (-0.398534 --> -0.398534).  Saving model ...
Epoch: 21 cost time: 3.7718288898468018
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.660 Vali Acc: 0.428 Test Loss: 1.660 Test Acc: 0.428
Validation loss decreased (-0.398534 --> -0.427520).  Saving model ...
Epoch: 22 cost time: 3.6553683280944824
Epoch: 22, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.623 Vali Acc: 0.435 Test Loss: 1.623 Test Acc: 0.435
Validation loss decreased (-0.427520 --> -0.434766).  Saving model ...
Epoch: 23 cost time: 3.7247626781463623
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.614 Vali Acc: 0.420 Test Loss: 1.614 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.262169361114502
Epoch: 24, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.646 Vali Acc: 0.442 Test Loss: 1.646 Test Acc: 0.442
Validation loss decreased (-0.434766 --> -0.442013).  Saving model ...
Epoch: 25 cost time: 4.2734291553497314
Epoch: 25, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.689 Vali Acc: 0.442 Test Loss: 1.689 Test Acc: 0.442
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.8310911655426025
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.705 Vali Acc: 0.420 Test Loss: 1.705 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.193490505218506
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.612 Vali Acc: 0.442 Test Loss: 1.612 Test Acc: 0.442
Validation loss decreased (-0.442013 --> -0.442013).  Saving model ...
Epoch: 28 cost time: 4.224096775054932
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.589 Vali Acc: 0.449 Test Loss: 1.589 Test Acc: 0.449
Validation loss decreased (-0.442013 --> -0.449259).  Saving model ...
Epoch: 29 cost time: 4.1782896518707275
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.563 Vali Acc: 0.464 Test Loss: 1.563 Test Acc: 0.464
Validation loss decreased (-0.449259 --> -0.463752).  Saving model ...
Epoch: 30 cost time: 3.8445425033569336
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.592 Vali Acc: 0.464 Test Loss: 1.592 Test Acc: 0.464
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 4.142352819442749
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.557 Vali Acc: 0.471 Test Loss: 1.557 Test Acc: 0.471
Validation loss decreased (-0.463752 --> -0.470999).  Saving model ...
Epoch: 32 cost time: 3.808185577392578
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.567 Vali Acc: 0.478 Test Loss: 1.567 Test Acc: 0.478
Validation loss decreased (-0.470999 --> -0.478245).  Saving model ...
Epoch: 33 cost time: 4.1704840660095215
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.561 Vali Acc: 0.471 Test Loss: 1.561 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.8788068294525146
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.530 Vali Acc: 0.478 Test Loss: 1.530 Test Acc: 0.478
Validation loss decreased (-0.478245 --> -0.478246).  Saving model ...
Epoch: 35 cost time: 3.6293184757232666
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.501 Vali Acc: 0.536 Test Loss: 1.501 Test Acc: 0.536
Validation loss decreased (-0.478246 --> -0.536217).  Saving model ...
Epoch: 36 cost time: 3.9400787353515625
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.539 Vali Acc: 0.514 Test Loss: 1.539 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.9086079597473145
Epoch: 37, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.544 Vali Acc: 0.514 Test Loss: 1.544 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.429274082183838
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.529 Vali Acc: 0.514 Test Loss: 1.529 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.5582828521728516
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.520 Vali Acc: 0.514 Test Loss: 1.520 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.7594056129455566
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.526 Vali Acc: 0.529 Test Loss: 1.526 Test Acc: 0.529
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 4.457779884338379
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.526 Vali Acc: 0.522 Test Loss: 1.526 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 4.280295133590698
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.523 Vali Acc: 0.522 Test Loss: 1.523 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 4.303350448608398
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.507 Vali Acc: 0.543 Test Loss: 1.507 Test Acc: 0.543
Validation loss decreased (-0.536217 --> -0.543463).  Saving model ...
Epoch: 44 cost time: 4.6817731857299805
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.483 Vali Acc: 0.558 Test Loss: 1.483 Test Acc: 0.558
Validation loss decreased (-0.543463 --> -0.557956).  Saving model ...
Epoch: 45 cost time: 4.284289598464966
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.472 Vali Acc: 0.565 Test Loss: 1.472 Test Acc: 0.565
Validation loss decreased (-0.557956 --> -0.565203).  Saving model ...
Epoch: 46 cost time: 4.834622144699097
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.477 Vali Acc: 0.551 Test Loss: 1.477 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 4.132915258407593
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.487 Vali Acc: 0.536 Test Loss: 1.487 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 4.235712289810181
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.502 Vali Acc: 0.529 Test Loss: 1.502 Test Acc: 0.529
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 4.476659297943115
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.511 Vali Acc: 0.529 Test Loss: 1.511 Test Acc: 0.529
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 4.257956266403198
Epoch: 50, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.500 Vali Acc: 0.543 Test Loss: 1.500 Test Acc: 0.543
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 3.9046082496643066
Epoch: 51, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.507 Vali Acc: 0.551 Test Loss: 1.507 Test Acc: 0.551
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 4.30942964553833
Epoch: 52, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.523 Vali Acc: 0.543 Test Loss: 1.523 Test Acc: 0.543
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 4.010365009307861
Epoch: 53, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.528 Vali Acc: 0.543 Test Loss: 1.528 Test Acc: 0.543
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 3.8952035903930664
Epoch: 54, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.516 Vali Acc: 0.551 Test Loss: 1.516 Test Acc: 0.551
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 4.0911054611206055
Epoch: 55, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.507 Vali Acc: 0.543 Test Loss: 1.507 Test Acc: 0.543
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5652173913043478
model parameter : 1554692
model size : 10.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         103                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df512_ma103_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.969158411026001
Epoch: 1, Steps: 9 | Train Loss: 1.446 Vali Loss: 1.335 Vali Acc: 0.428 Test Loss: 1.335 Test Acc: 0.428
Validation loss decreased (inf --> -0.427523).  Saving model ...
Epoch: 2 cost time: 4.31242823600769
Epoch: 2, Steps: 9 | Train Loss: 1.183 Vali Loss: 1.131 Vali Acc: 0.616 Test Loss: 1.131 Test Acc: 0.616
Validation loss decreased (-0.427523 --> -0.615931).  Saving model ...
Epoch: 3 cost time: 4.3389787673950195
Epoch: 3, Steps: 9 | Train Loss: 0.822 Vali Loss: 0.978 Vali Acc: 0.667 Test Loss: 0.978 Test Acc: 0.667
Validation loss decreased (-0.615931 --> -0.666657).  Saving model ...
Epoch: 4 cost time: 4.398465633392334
Epoch: 4, Steps: 9 | Train Loss: 0.534 Vali Loss: 0.848 Vali Acc: 0.710 Test Loss: 0.848 Test Acc: 0.710
Validation loss decreased (-0.666657 --> -0.710136).  Saving model ...
Epoch: 5 cost time: 4.228146314620972
Epoch: 5, Steps: 9 | Train Loss: 0.302 Vali Loss: 0.784 Vali Acc: 0.725 Test Loss: 0.784 Test Acc: 0.725
Validation loss decreased (-0.710136 --> -0.724630).  Saving model ...
Epoch: 6 cost time: 4.501765251159668
Epoch: 6, Steps: 9 | Train Loss: 0.164 Vali Loss: 0.706 Vali Acc: 0.732 Test Loss: 0.706 Test Acc: 0.732
Validation loss decreased (-0.724630 --> -0.731877).  Saving model ...
Epoch: 7 cost time: 4.125383138656616
Epoch: 7, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.799 Vali Acc: 0.746 Test Loss: 0.799 Test Acc: 0.746
Validation loss decreased (-0.731877 --> -0.746369).  Saving model ...
Epoch: 8 cost time: 4.04972243309021
Epoch: 8, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.606 Vali Acc: 0.768 Test Loss: 0.606 Test Acc: 0.768
Validation loss decreased (-0.746369 --> -0.768110).  Saving model ...
Epoch: 9 cost time: 3.916987895965576
Epoch: 9, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.721 Vali Acc: 0.746 Test Loss: 0.721 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.2102930545806885
Epoch: 10, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.689 Vali Acc: 0.790 Test Loss: 0.689 Test Acc: 0.790
Validation loss decreased (-0.768110 --> -0.789848).  Saving model ...
Epoch: 11 cost time: 4.276092767715454
Epoch: 11, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.631 Vali Acc: 0.754 Test Loss: 0.631 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.223131418228149
Epoch: 12, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.654 Vali Acc: 0.746 Test Loss: 0.654 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.213830471038818
Epoch: 13, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.680 Vali Acc: 0.775 Test Loss: 0.680 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.310961484909058
Epoch: 14, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.679 Vali Acc: 0.790 Test Loss: 0.679 Test Acc: 0.790
Validation loss decreased (-0.789848 --> -0.789848).  Saving model ...
Epoch: 15 cost time: 4.247542858123779
Epoch: 15, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.651 Vali Acc: 0.761 Test Loss: 0.651 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.264124870300293
Epoch: 16, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.651 Vali Acc: 0.775 Test Loss: 0.651 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.279746770858765
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.647 Vali Acc: 0.768 Test Loss: 0.647 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.130133628845215
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.651 Vali Acc: 0.761 Test Loss: 0.651 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.193491458892822
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.658 Vali Acc: 0.804 Test Loss: 0.658 Test Acc: 0.804
Validation loss decreased (-0.789848 --> -0.804341).  Saving model ...
Epoch: 20 cost time: 4.461077451705933
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.670 Vali Acc: 0.804 Test Loss: 0.670 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.693104982376099
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.660 Vali Acc: 0.783 Test Loss: 0.660 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.471441984176636
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.651 Vali Acc: 0.775 Test Loss: 0.651 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.322107791900635
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.658 Vali Acc: 0.804 Test Loss: 0.658 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.17340612411499
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.671 Vali Acc: 0.804 Test Loss: 0.671 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.438959121704102
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.675 Vali Acc: 0.804 Test Loss: 0.675 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.149191856384277
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.656 Vali Acc: 0.812 Test Loss: 0.656 Test Acc: 0.812
Validation loss decreased (-0.804341 --> -0.811588).  Saving model ...
Epoch: 27 cost time: 3.798729181289673
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.657 Vali Acc: 0.812 Test Loss: 0.657 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.244241952896118
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.652 Vali Acc: 0.812 Test Loss: 0.652 Test Acc: 0.812
Validation loss decreased (-0.811588 --> -0.811588).  Saving model ...
Epoch: 29 cost time: 3.7463157176971436
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.654 Vali Acc: 0.812 Test Loss: 0.654 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.77996563911438
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.661 Vali Acc: 0.812 Test Loss: 0.661 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.8542075157165527
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.658 Vali Acc: 0.812 Test Loss: 0.658 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 4.027122259140015
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.652 Vali Acc: 0.812 Test Loss: 0.652 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 4.447365045547485
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.661 Vali Acc: 0.812 Test Loss: 0.661 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 4.160055875778198
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.669 Vali Acc: 0.812 Test Loss: 0.669 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 4.293946981430054
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.665 Vali Acc: 0.812 Test Loss: 0.665 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 4.239829063415527
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.652 Vali Acc: 0.819 Test Loss: 0.652 Test Acc: 0.819
Validation loss decreased (-0.811588 --> -0.818834).  Saving model ...
Epoch: 37 cost time: 4.2322678565979
Epoch: 37, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.650 Vali Acc: 0.819 Test Loss: 0.650 Test Acc: 0.819
Validation loss decreased (-0.818834 --> -0.818834).  Saving model ...
Epoch: 38 cost time: 4.274301052093506
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.654 Vali Acc: 0.812 Test Loss: 0.654 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.8867106437683105
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.661 Vali Acc: 0.812 Test Loss: 0.661 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.983355760574341
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.674 Vali Acc: 0.812 Test Loss: 0.674 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 4.136371612548828
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.677 Vali Acc: 0.812 Test Loss: 0.677 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 3.9557442665100098
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.670 Vali Acc: 0.812 Test Loss: 0.670 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 3.728119134902954
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.668 Vali Acc: 0.819 Test Loss: 0.668 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 4.057497501373291
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.669 Vali Acc: 0.819 Test Loss: 0.669 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 3.7742717266082764
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.671 Vali Acc: 0.819 Test Loss: 0.671 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 3.7991912364959717
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.671 Vali Acc: 0.819 Test Loss: 0.671 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 3.5447890758514404
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.674 Vali Acc: 0.819 Test Loss: 0.674 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df512_ma103_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8188405797101449
model parameter : 1161476
model size : 9.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         83                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df512_ma83_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.963313579559326
Epoch: 1, Steps: 9 | Train Loss: 1.452 Vali Loss: 1.338 Vali Acc: 0.399 Test Loss: 1.338 Test Acc: 0.399
Validation loss decreased (inf --> -0.398537).  Saving model ...
Epoch: 2 cost time: 3.7485456466674805
Epoch: 2, Steps: 9 | Train Loss: 1.193 Vali Loss: 1.134 Vali Acc: 0.623 Test Loss: 1.134 Test Acc: 0.623
Validation loss decreased (-0.398537 --> -0.623177).  Saving model ...
Epoch: 3 cost time: 3.9483799934387207
Epoch: 3, Steps: 9 | Train Loss: 0.838 Vali Loss: 0.979 Vali Acc: 0.681 Test Loss: 0.979 Test Acc: 0.681
Validation loss decreased (-0.623177 --> -0.681150).  Saving model ...
Epoch: 4 cost time: 3.8033604621887207
Epoch: 4, Steps: 9 | Train Loss: 0.545 Vali Loss: 0.839 Vali Acc: 0.725 Test Loss: 0.839 Test Acc: 0.725
Validation loss decreased (-0.681150 --> -0.724629).  Saving model ...
Epoch: 5 cost time: 4.036881685256958
Epoch: 5, Steps: 9 | Train Loss: 0.309 Vali Loss: 0.767 Vali Acc: 0.754 Test Loss: 0.767 Test Acc: 0.754
Validation loss decreased (-0.724629 --> -0.753616).  Saving model ...
Epoch: 6 cost time: 3.9772017002105713
Epoch: 6, Steps: 9 | Train Loss: 0.167 Vali Loss: 0.677 Vali Acc: 0.775 Test Loss: 0.677 Test Acc: 0.775
Validation loss decreased (-0.753616 --> -0.775356).  Saving model ...
Epoch: 7 cost time: 4.05456280708313
Epoch: 7, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.796 Vali Acc: 0.739 Test Loss: 0.796 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.919433355331421
Epoch: 8, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.562 Vali Acc: 0.783 Test Loss: 0.562 Test Acc: 0.783
Validation loss decreased (-0.775356 --> -0.782603).  Saving model ...
Epoch: 9 cost time: 3.597226858139038
Epoch: 9, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.698 Vali Acc: 0.754 Test Loss: 0.698 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.4822189807891846
Epoch: 10, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.645 Vali Acc: 0.797 Test Loss: 0.645 Test Acc: 0.797
Validation loss decreased (-0.782603 --> -0.797095).  Saving model ...
Epoch: 11 cost time: 3.8776659965515137
Epoch: 11, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.599 Vali Acc: 0.804 Test Loss: 0.599 Test Acc: 0.804
Validation loss decreased (-0.797095 --> -0.804342).  Saving model ...
Epoch: 12 cost time: 3.6981422901153564
Epoch: 12, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.610 Vali Acc: 0.804 Test Loss: 0.610 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.588883876800537
Epoch: 13, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.627 Vali Acc: 0.804 Test Loss: 0.627 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.628344774246216
Epoch: 14, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.638 Vali Acc: 0.797 Test Loss: 0.638 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.839993476867676
Epoch: 15, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.613 Vali Acc: 0.804 Test Loss: 0.613 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.74714732170105
Epoch: 16, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.611 Vali Acc: 0.804 Test Loss: 0.611 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.7992801666259766
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.598 Vali Acc: 0.812 Test Loss: 0.598 Test Acc: 0.812
Validation loss decreased (-0.804342 --> -0.811588).  Saving model ...
Epoch: 18 cost time: 3.7654006481170654
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.601 Vali Acc: 0.819 Test Loss: 0.601 Test Acc: 0.819
Validation loss decreased (-0.811588 --> -0.818835).  Saving model ...
Epoch: 19 cost time: 4.029498100280762
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.612 Vali Acc: 0.804 Test Loss: 0.612 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.8766820430755615
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.623 Vali Acc: 0.812 Test Loss: 0.623 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.305486679077148
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.612 Vali Acc: 0.812 Test Loss: 0.612 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.8277878761291504
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.600 Vali Acc: 0.819 Test Loss: 0.600 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818835).  Saving model ...
Epoch: 23 cost time: 4.120995998382568
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.610 Vali Acc: 0.812 Test Loss: 0.610 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.051180124282837
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.625 Vali Acc: 0.812 Test Loss: 0.625 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.404153347015381
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.625 Vali Acc: 0.812 Test Loss: 0.625 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.9053955078125
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.598 Vali Acc: 0.819 Test Loss: 0.598 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818835).  Saving model ...
Epoch: 27 cost time: 3.826369524002075
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.597 Vali Acc: 0.819 Test Loss: 0.597 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818835).  Saving model ...
Epoch: 28 cost time: 3.591752767562866
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.595 Vali Acc: 0.819 Test Loss: 0.595 Test Acc: 0.819
Validation loss decreased (-0.818835 --> -0.818835).  Saving model ...
Epoch: 29 cost time: 3.6260976791381836
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.602 Vali Acc: 0.819 Test Loss: 0.602 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.7901721000671387
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.612 Vali Acc: 0.819 Test Loss: 0.612 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.649470567703247
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.607 Vali Acc: 0.826 Test Loss: 0.607 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826081).  Saving model ...
Epoch: 32 cost time: 3.6336874961853027
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.599 Vali Acc: 0.819 Test Loss: 0.599 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.7951977252960205
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.604 Vali Acc: 0.826 Test Loss: 0.604 Test Acc: 0.826
Validation loss decreased (-0.826081 --> -0.826081).  Saving model ...
Epoch: 34 cost time: 3.851100206375122
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.611 Vali Acc: 0.826 Test Loss: 0.611 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 4.023419618606567
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.609 Vali Acc: 0.826 Test Loss: 0.609 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 4.172129154205322
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.596 Vali Acc: 0.819 Test Loss: 0.596 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 4.167097568511963
Epoch: 37, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.593 Vali Acc: 0.819 Test Loss: 0.593 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.7728521823883057
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.597 Vali Acc: 0.819 Test Loss: 0.597 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.8209736347198486
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.603 Vali Acc: 0.826 Test Loss: 0.603 Test Acc: 0.826
Validation loss decreased (-0.826081 --> -0.826081).  Saving model ...
Epoch: 40 cost time: 3.7754528522491455
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.616 Vali Acc: 0.826 Test Loss: 0.616 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.762772560119629
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.618 Vali Acc: 0.826 Test Loss: 0.618 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.9575650691986084
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.614 Vali Acc: 0.826 Test Loss: 0.614 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.5636558532714844
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.614 Vali Acc: 0.833 Test Loss: 0.614 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833327).  Saving model ...
Epoch: 44 cost time: 3.695780038833618
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.613 Vali Acc: 0.833 Test Loss: 0.613 Test Acc: 0.833
Validation loss decreased (-0.833327 --> -0.833327).  Saving model ...
Epoch: 45 cost time: 3.6031556129455566
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.614 Vali Acc: 0.833 Test Loss: 0.614 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.6321089267730713
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.613 Vali Acc: 0.833 Test Loss: 0.613 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.611478567123413
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.615 Vali Acc: 0.833 Test Loss: 0.615 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.826467514038086
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.620 Vali Acc: 0.833 Test Loss: 0.620 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 3.616713523864746
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.621 Vali Acc: 0.833 Test Loss: 0.621 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 3.8412160873413086
Epoch: 50, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.616 Vali Acc: 0.833 Test Loss: 0.616 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 4.4000842571258545
Epoch: 51, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.619 Vali Acc: 0.841 Test Loss: 0.619 Test Acc: 0.841
Validation loss decreased (-0.833327 --> -0.840574).  Saving model ...
Epoch: 52 cost time: 4.034116744995117
Epoch: 52, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.616 Vali Acc: 0.841 Test Loss: 0.616 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840574).  Saving model ...
Epoch: 53 cost time: 4.317116975784302
Epoch: 53, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.618 Vali Acc: 0.841 Test Loss: 0.618 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 3.981740951538086
Epoch: 54, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.617 Vali Acc: 0.841 Test Loss: 0.617 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 3.8081722259521484
Epoch: 55, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.623 Vali Acc: 0.841 Test Loss: 0.623 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 4.147956848144531
Epoch: 56, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.630 Vali Acc: 0.841 Test Loss: 0.630 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 3.782670736312866
Epoch: 57, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.634 Vali Acc: 0.841 Test Loss: 0.634 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 3.70959734916687
Epoch: 58, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.629 Vali Acc: 0.841 Test Loss: 0.629 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 3.6731324195861816
Epoch: 59, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.629 Vali Acc: 0.841 Test Loss: 0.629 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 3.8712377548217773
Epoch: 60, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.625 Vali Acc: 0.841 Test Loss: 0.625 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 3.919912815093994
Epoch: 61, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.625 Vali Acc: 0.841 Test Loss: 0.625 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 3.858980894088745
Epoch: 62, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.627 Vali Acc: 0.848 Test Loss: 0.627 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847820).  Saving model ...
Epoch: 63 cost time: 3.822106122970581
Epoch: 63, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.630 Vali Acc: 0.841 Test Loss: 0.630 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 4.003608703613281
Epoch: 64, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.634 Vali Acc: 0.841 Test Loss: 0.634 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 3.8071038722991943
Epoch: 65, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.638 Vali Acc: 0.841 Test Loss: 0.638 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 3.5913069248199463
Epoch: 66, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.639 Vali Acc: 0.841 Test Loss: 0.639 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 3.738640785217285
Epoch: 67, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.640 Vali Acc: 0.841 Test Loss: 0.640 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 3.7282066345214844
Epoch: 68, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.848 Test Loss: 0.637 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 3.6506340503692627
Epoch: 69, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.635 Vali Acc: 0.848 Test Loss: 0.635 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 3.9423351287841797
Epoch: 70, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.636 Vali Acc: 0.848 Test Loss: 0.636 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 3.813213586807251
Epoch: 71, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.848 Test Loss: 0.637 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 4.046843767166138
Epoch: 72, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.848 Test Loss: 0.637 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df512_ma83_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 1161476
model size : 9.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         62                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df512_ma62_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.934205532073975
Epoch: 1, Steps: 9 | Train Loss: 1.444 Vali Loss: 1.311 Vali Acc: 0.435 Test Loss: 1.311 Test Acc: 0.435
Validation loss decreased (inf --> -0.434770).  Saving model ...
Epoch: 2 cost time: 3.7959141731262207
Epoch: 2, Steps: 9 | Train Loss: 1.190 Vali Loss: 1.121 Vali Acc: 0.609 Test Loss: 1.121 Test Acc: 0.609
Validation loss decreased (-0.434770 --> -0.608684).  Saving model ...
Epoch: 3 cost time: 3.962045669555664
Epoch: 3, Steps: 9 | Train Loss: 0.831 Vali Loss: 0.978 Vali Acc: 0.659 Test Loss: 0.978 Test Acc: 0.659
Validation loss decreased (-0.608684 --> -0.659411).  Saving model ...
Epoch: 4 cost time: 3.9122941493988037
Epoch: 4, Steps: 9 | Train Loss: 0.532 Vali Loss: 0.841 Vali Acc: 0.732 Test Loss: 0.841 Test Acc: 0.732
Validation loss decreased (-0.659411 --> -0.731876).  Saving model ...
Epoch: 5 cost time: 4.07233738899231
Epoch: 5, Steps: 9 | Train Loss: 0.301 Vali Loss: 0.772 Vali Acc: 0.754 Test Loss: 0.772 Test Acc: 0.754
Validation loss decreased (-0.731876 --> -0.753615).  Saving model ...
Epoch: 6 cost time: 4.099113941192627
Epoch: 6, Steps: 9 | Train Loss: 0.155 Vali Loss: 0.687 Vali Acc: 0.768 Test Loss: 0.687 Test Acc: 0.768
Validation loss decreased (-0.753615 --> -0.768109).  Saving model ...
Epoch: 7 cost time: 3.900108575820923
Epoch: 7, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.734 Vali Acc: 0.768 Test Loss: 0.734 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.882402181625366
Epoch: 8, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.584 Vali Acc: 0.812 Test Loss: 0.584 Test Acc: 0.812
Validation loss decreased (-0.768109 --> -0.811588).  Saving model ...
Epoch: 9 cost time: 4.2391228675842285
Epoch: 9, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.659 Vali Acc: 0.790 Test Loss: 0.659 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.040353775024414
Epoch: 10, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.643 Vali Acc: 0.812 Test Loss: 0.643 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.962859869003296
Epoch: 11, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.609 Vali Acc: 0.819 Test Loss: 0.609 Test Acc: 0.819
Validation loss decreased (-0.811588 --> -0.818834).  Saving model ...
Epoch: 12 cost time: 4.132320880889893
Epoch: 12, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.610 Vali Acc: 0.819 Test Loss: 0.610 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.06641960144043
Epoch: 13, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.607 Vali Acc: 0.819 Test Loss: 0.607 Test Acc: 0.819
Validation loss decreased (-0.818834 --> -0.818835).  Saving model ...
Epoch: 14 cost time: 4.309376955032349
Epoch: 14, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.620 Vali Acc: 0.848 Test Loss: 0.620 Test Acc: 0.848
Validation loss decreased (-0.818835 --> -0.847820).  Saving model ...
Epoch: 15 cost time: 4.0116496086120605
Epoch: 15, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.609 Vali Acc: 0.841 Test Loss: 0.609 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.1311986446380615
Epoch: 16, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.613 Vali Acc: 0.855 Test Loss: 0.613 Test Acc: 0.855
Validation loss decreased (-0.847820 --> -0.855066).  Saving model ...
Epoch: 17 cost time: 4.375528573989868
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.601 Vali Acc: 0.833 Test Loss: 0.601 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.190800428390503
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.601 Vali Acc: 0.833 Test Loss: 0.601 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.9389350414276123
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.605 Vali Acc: 0.855 Test Loss: 0.605 Test Acc: 0.855
Validation loss decreased (-0.855066 --> -0.855066).  Saving model ...
Epoch: 20 cost time: 3.877385139465332
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.607 Vali Acc: 0.855 Test Loss: 0.607 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.030932903289795
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.600 Vali Acc: 0.841 Test Loss: 0.600 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.842979669570923
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.597 Vali Acc: 0.841 Test Loss: 0.597 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.088583707809448
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.606 Vali Acc: 0.870 Test Loss: 0.606 Test Acc: 0.870
Validation loss decreased (-0.855066 --> -0.869559).  Saving model ...
Epoch: 24 cost time: 4.0415260791778564
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.613 Vali Acc: 0.862 Test Loss: 0.613 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.813009738922119
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.618 Vali Acc: 0.848 Test Loss: 0.618 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.8831534385681152
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.600 Vali Acc: 0.855 Test Loss: 0.600 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.8835015296936035
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.598 Vali Acc: 0.862 Test Loss: 0.598 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 4.386592149734497
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.597 Vali Acc: 0.862 Test Loss: 0.597 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 4.240139484405518
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.605 Vali Acc: 0.870 Test Loss: 0.605 Test Acc: 0.870
Validation loss decreased (-0.869559 --> -0.869559).  Saving model ...
Epoch: 30 cost time: 4.052660942077637
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.608 Vali Acc: 0.862 Test Loss: 0.608 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 4.167034149169922
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.605 Vali Acc: 0.870 Test Loss: 0.605 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 4.123832702636719
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.600 Vali Acc: 0.870 Test Loss: 0.600 Test Acc: 0.870
Validation loss decreased (-0.869559 --> -0.869559).  Saving model ...
Epoch: 33 cost time: 3.8683106899261475
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.603 Vali Acc: 0.870 Test Loss: 0.603 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 4.291851043701172
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.609 Vali Acc: 0.862 Test Loss: 0.609 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 4.007839202880859
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.607 Vali Acc: 0.862 Test Loss: 0.607 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 4.088228225708008
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.601 Vali Acc: 0.862 Test Loss: 0.601 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 4.052814722061157
Epoch: 37, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.597 Vali Acc: 0.870 Test Loss: 0.597 Test Acc: 0.870
Validation loss decreased (-0.869559 --> -0.869559).  Saving model ...
Epoch: 38 cost time: 3.7702865600585938
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.598 Vali Acc: 0.870 Test Loss: 0.598 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.919687271118164
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.862 Test Loss: 0.601 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 4.126187801361084
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.611 Vali Acc: 0.855 Test Loss: 0.611 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 3.767033576965332
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.615 Vali Acc: 0.870 Test Loss: 0.615 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 3.7073113918304443
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.614 Vali Acc: 0.862 Test Loss: 0.614 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 3.9245243072509766
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.613 Vali Acc: 0.877 Test Loss: 0.613 Test Acc: 0.877
Validation loss decreased (-0.869559 --> -0.876805).  Saving model ...
Epoch: 44 cost time: 3.748157262802124
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.611 Vali Acc: 0.870 Test Loss: 0.611 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.768749237060547
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.612 Vali Acc: 0.877 Test Loss: 0.612 Test Acc: 0.877
Validation loss decreased (-0.876805 --> -0.876805).  Saving model ...
Epoch: 46 cost time: 4.102493762969971
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.612 Vali Acc: 0.870 Test Loss: 0.612 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 4.140932321548462
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.613 Vali Acc: 0.862 Test Loss: 0.613 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 4.180632829666138
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.619 Vali Acc: 0.870 Test Loss: 0.619 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 3.951082706451416
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.618 Vali Acc: 0.870 Test Loss: 0.618 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 4.238799571990967
Epoch: 50, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.612 Vali Acc: 0.870 Test Loss: 0.612 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 3.7020208835601807
Epoch: 51, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.615 Vali Acc: 0.870 Test Loss: 0.615 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 4.083246946334839
Epoch: 52, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.614 Vali Acc: 0.877 Test Loss: 0.614 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 4.501425504684448
Epoch: 53, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.616 Vali Acc: 0.877 Test Loss: 0.616 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 3.879406452178955
Epoch: 54, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.616 Vali Acc: 0.877 Test Loss: 0.616 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 3.780820369720459
Epoch: 55, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.619 Vali Acc: 0.884 Test Loss: 0.619 Test Acc: 0.884
Validation loss decreased (-0.876805 --> -0.884052).  Saving model ...
Epoch: 56 cost time: 3.8323636054992676
Epoch: 56, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.623 Vali Acc: 0.884 Test Loss: 0.623 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 3.6098086833953857
Epoch: 57, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.626 Vali Acc: 0.884 Test Loss: 0.626 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 3.5579404830932617
Epoch: 58, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.622 Vali Acc: 0.884 Test Loss: 0.622 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 3.5322935581207275
Epoch: 59, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.621 Vali Acc: 0.884 Test Loss: 0.621 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 3.7975707054138184
Epoch: 60, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.619 Vali Acc: 0.884 Test Loss: 0.619 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 3.9503095149993896
Epoch: 61, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.622 Vali Acc: 0.884 Test Loss: 0.622 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 4.122833967208862
Epoch: 62, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.625 Vali Acc: 0.884 Test Loss: 0.625 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 3.846447229385376
Epoch: 63, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.626 Vali Acc: 0.884 Test Loss: 0.626 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 3.8953380584716797
Epoch: 64, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.628 Vali Acc: 0.884 Test Loss: 0.628 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 3.8447654247283936
Epoch: 65, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.630 Vali Acc: 0.884 Test Loss: 0.630 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df512_ma62_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 1161476
model size : 9.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         42                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df512_ma42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.778026342391968
Epoch: 1, Steps: 9 | Train Loss: 1.425 Vali Loss: 1.283 Vali Acc: 0.464 Test Loss: 1.283 Test Acc: 0.464
Validation loss decreased (inf --> -0.463755).  Saving model ...
Epoch: 2 cost time: 3.975414991378784
Epoch: 2, Steps: 9 | Train Loss: 1.166 Vali Loss: 1.065 Vali Acc: 0.652 Test Loss: 1.065 Test Acc: 0.652
Validation loss decreased (-0.463755 --> -0.652163).  Saving model ...
Epoch: 3 cost time: 4.037678480148315
Epoch: 3, Steps: 9 | Train Loss: 0.790 Vali Loss: 0.933 Vali Acc: 0.674 Test Loss: 0.933 Test Acc: 0.674
Validation loss decreased (-0.652163 --> -0.673904).  Saving model ...
Epoch: 4 cost time: 3.9192111492156982
Epoch: 4, Steps: 9 | Train Loss: 0.500 Vali Loss: 0.795 Vali Acc: 0.739 Test Loss: 0.795 Test Acc: 0.739
Validation loss decreased (-0.673904 --> -0.739122).  Saving model ...
Epoch: 5 cost time: 3.659940481185913
Epoch: 5, Steps: 9 | Train Loss: 0.281 Vali Loss: 0.713 Vali Acc: 0.739 Test Loss: 0.713 Test Acc: 0.739
Validation loss decreased (-0.739122 --> -0.739123).  Saving model ...
Epoch: 6 cost time: 4.204086065292358
Epoch: 6, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.635 Vali Acc: 0.768 Test Loss: 0.635 Test Acc: 0.768
Validation loss decreased (-0.739123 --> -0.768110).  Saving model ...
Epoch: 7 cost time: 3.8245084285736084
Epoch: 7, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.670 Vali Acc: 0.732 Test Loss: 0.670 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.010598659515381
Epoch: 8, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.539 Vali Acc: 0.768 Test Loss: 0.539 Test Acc: 0.768
Validation loss decreased (-0.768110 --> -0.768111).  Saving model ...
Epoch: 9 cost time: 4.16653847694397
Epoch: 9, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.599 Vali Acc: 0.775 Test Loss: 0.599 Test Acc: 0.775
Validation loss decreased (-0.768111 --> -0.775356).  Saving model ...
Epoch: 10 cost time: 4.0203986167907715
Epoch: 10, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.604 Vali Acc: 0.783 Test Loss: 0.604 Test Acc: 0.783
Validation loss decreased (-0.775356 --> -0.782603).  Saving model ...
Epoch: 11 cost time: 4.199045181274414
Epoch: 11, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.562 Vali Acc: 0.797 Test Loss: 0.562 Test Acc: 0.797
Validation loss decreased (-0.782603 --> -0.797096).  Saving model ...
Epoch: 12 cost time: 4.464444875717163
Epoch: 12, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.566 Vali Acc: 0.783 Test Loss: 0.566 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.074996709823608
Epoch: 13, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.577 Vali Acc: 0.790 Test Loss: 0.577 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.085996866226196
Epoch: 14, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.584 Vali Acc: 0.790 Test Loss: 0.584 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.089195489883423
Epoch: 15, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.564 Vali Acc: 0.790 Test Loss: 0.564 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.9675374031066895
Epoch: 16, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.567 Vali Acc: 0.790 Test Loss: 0.567 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.7205471992492676
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.559 Vali Acc: 0.790 Test Loss: 0.559 Test Acc: 0.790
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.6713685989379883
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.557 Vali Acc: 0.790 Test Loss: 0.557 Test Acc: 0.790
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.7524211406707764
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.562 Vali Acc: 0.790 Test Loss: 0.562 Test Acc: 0.790
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.0765392780303955
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.575 Vali Acc: 0.790 Test Loss: 0.575 Test Acc: 0.790
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.018619060516357
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.561 Vali Acc: 0.790 Test Loss: 0.561 Test Acc: 0.790
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df512_ma42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7971014492753623
model parameter : 1161476
model size : 9.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df512_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.784332513809204
Epoch: 1, Steps: 9 | Train Loss: 1.432 Vali Loss: 1.322 Vali Acc: 0.391 Test Loss: 1.322 Test Acc: 0.391
Validation loss decreased (inf --> -0.391291).  Saving model ...
Epoch: 2 cost time: 3.610905170440674
Epoch: 2, Steps: 9 | Train Loss: 1.204 Vali Loss: 1.133 Vali Acc: 0.572 Test Loss: 1.133 Test Acc: 0.572
Validation loss decreased (-0.391291 --> -0.572452).  Saving model ...
Epoch: 3 cost time: 3.9844095706939697
Epoch: 3, Steps: 9 | Train Loss: 0.838 Vali Loss: 0.976 Vali Acc: 0.659 Test Loss: 0.976 Test Acc: 0.659
Validation loss decreased (-0.572452 --> -0.659411).  Saving model ...
Epoch: 4 cost time: 3.964313268661499
Epoch: 4, Steps: 9 | Train Loss: 0.528 Vali Loss: 0.827 Vali Acc: 0.710 Test Loss: 0.827 Test Acc: 0.710
Validation loss decreased (-0.659411 --> -0.710137).  Saving model ...
Epoch: 5 cost time: 3.6187849044799805
Epoch: 5, Steps: 9 | Train Loss: 0.300 Vali Loss: 0.729 Vali Acc: 0.746 Test Loss: 0.729 Test Acc: 0.746
Validation loss decreased (-0.710137 --> -0.746370).  Saving model ...
Epoch: 6 cost time: 3.77323317527771
Epoch: 6, Steps: 9 | Train Loss: 0.160 Vali Loss: 0.621 Vali Acc: 0.783 Test Loss: 0.621 Test Acc: 0.783
Validation loss decreased (-0.746370 --> -0.782602).  Saving model ...
Epoch: 7 cost time: 4.104327201843262
Epoch: 7, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.648 Vali Acc: 0.761 Test Loss: 0.648 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.8380072116851807
Epoch: 8, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.488 Vali Acc: 0.826 Test Loss: 0.488 Test Acc: 0.826
Validation loss decreased (-0.782602 --> -0.826082).  Saving model ...
Epoch: 9 cost time: 3.9787604808807373
Epoch: 9, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.516 Vali Acc: 0.826 Test Loss: 0.516 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.7140777111053467
Epoch: 10, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.516 Vali Acc: 0.819 Test Loss: 0.516 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.7517356872558594
Epoch: 11, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.449 Vali Acc: 0.841 Test Loss: 0.449 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840575).  Saving model ...
Epoch: 12 cost time: 3.8773953914642334
Epoch: 12, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.449 Vali Acc: 0.848 Test Loss: 0.449 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 13 cost time: 3.8558950424194336
Epoch: 13, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.466 Vali Acc: 0.833 Test Loss: 0.466 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.5860140323638916
Epoch: 14, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.456 Vali Acc: 0.848 Test Loss: 0.456 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.640622138977051
Epoch: 15, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.447 Vali Acc: 0.848 Test Loss: 0.447 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 16 cost time: 3.799923896789551
Epoch: 16, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.451 Vali Acc: 0.855 Test Loss: 0.451 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 17 cost time: 3.874512195587158
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.428 Vali Acc: 0.848 Test Loss: 0.428 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.6471071243286133
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.434 Vali Acc: 0.848 Test Loss: 0.434 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.061496734619141
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.434 Vali Acc: 0.848 Test Loss: 0.434 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.8947179317474365
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.436 Vali Acc: 0.848 Test Loss: 0.436 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.011846542358398
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.426 Vali Acc: 0.848 Test Loss: 0.426 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.183623313903809
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.420 Vali Acc: 0.848 Test Loss: 0.420 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.7538254261016846
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.430 Vali Acc: 0.855 Test Loss: 0.430 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 24 cost time: 3.8559463024139404
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.435 Vali Acc: 0.848 Test Loss: 0.435 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.944045305252075
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.443 Vali Acc: 0.848 Test Loss: 0.443 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.354486465454102
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.425 Vali Acc: 0.855 Test Loss: 0.425 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 27 cost time: 4.103917360305786
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.420 Vali Acc: 0.855 Test Loss: 0.420 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 28 cost time: 3.8966081142425537
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.416 Vali Acc: 0.862 Test Loss: 0.416 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 29 cost time: 3.9625110626220703
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.418 Vali Acc: 0.855 Test Loss: 0.418 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.768064498901367
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.425 Vali Acc: 0.855 Test Loss: 0.425 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.6349165439605713
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.428 Vali Acc: 0.855 Test Loss: 0.428 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.9118258953094482
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.422 Vali Acc: 0.855 Test Loss: 0.422 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.824997901916504
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.416 Vali Acc: 0.855 Test Loss: 0.416 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.641570568084717
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.422 Vali Acc: 0.855 Test Loss: 0.422 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.778069257736206
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.421 Vali Acc: 0.855 Test Loss: 0.421 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 4.1720006465911865
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.416 Vali Acc: 0.855 Test Loss: 0.416 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 4.0408384799957275
Epoch: 37, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.415 Vali Acc: 0.855 Test Loss: 0.415 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.7587730884552
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.418 Vali Acc: 0.855 Test Loss: 0.418 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df512_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 1161476
model size : 9.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df512_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.456982374191284
Epoch: 1, Steps: 9 | Train Loss: 1.455 Vali Loss: 1.327 Vali Acc: 0.399 Test Loss: 1.327 Test Acc: 0.399
Validation loss decreased (inf --> -0.398537).  Saving model ...
Epoch: 2 cost time: 4.407508611679077
Epoch: 2, Steps: 9 | Train Loss: 1.207 Vali Loss: 1.130 Vali Acc: 0.594 Test Loss: 1.130 Test Acc: 0.594
Validation loss decreased (-0.398537 --> -0.594192).  Saving model ...
Epoch: 3 cost time: 4.453375816345215
Epoch: 3, Steps: 9 | Train Loss: 0.854 Vali Loss: 0.965 Vali Acc: 0.652 Test Loss: 0.965 Test Acc: 0.652
Validation loss decreased (-0.594192 --> -0.652164).  Saving model ...
Epoch: 4 cost time: 4.359587669372559
Epoch: 4, Steps: 9 | Train Loss: 0.555 Vali Loss: 0.841 Vali Acc: 0.710 Test Loss: 0.841 Test Acc: 0.710
Validation loss decreased (-0.652164 --> -0.710137).  Saving model ...
Epoch: 5 cost time: 3.907339096069336
Epoch: 5, Steps: 9 | Train Loss: 0.351 Vali Loss: 0.734 Vali Acc: 0.717 Test Loss: 0.734 Test Acc: 0.717
Validation loss decreased (-0.710137 --> -0.717384).  Saving model ...
Epoch: 6 cost time: 3.927835464477539
Epoch: 6, Steps: 9 | Train Loss: 0.206 Vali Loss: 0.681 Vali Acc: 0.732 Test Loss: 0.681 Test Acc: 0.732
Validation loss decreased (-0.717384 --> -0.731877).  Saving model ...
Epoch: 7 cost time: 4.165709495544434
Epoch: 7, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.648 Vali Acc: 0.732 Test Loss: 0.648 Test Acc: 0.732
Validation loss decreased (-0.731877 --> -0.731878).  Saving model ...
Epoch: 8 cost time: 3.923694610595703
Epoch: 8, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.546 Vali Acc: 0.783 Test Loss: 0.546 Test Acc: 0.783
Validation loss decreased (-0.731878 --> -0.782603).  Saving model ...
Epoch: 9 cost time: 3.9333415031433105
Epoch: 9, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.584 Vali Acc: 0.754 Test Loss: 0.584 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.428766250610352
Epoch: 10, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.511 Vali Acc: 0.804 Test Loss: 0.511 Test Acc: 0.804
Validation loss decreased (-0.782603 --> -0.804343).  Saving model ...
Epoch: 11 cost time: 4.12026309967041
Epoch: 11, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.555 Vali Acc: 0.768 Test Loss: 0.555 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.211938142776489
Epoch: 12, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.533 Vali Acc: 0.804 Test Loss: 0.533 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.4384543895721436
Epoch: 13, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.525 Vali Acc: 0.804 Test Loss: 0.525 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.237185478210449
Epoch: 14, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.540 Vali Acc: 0.783 Test Loss: 0.540 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.337045431137085
Epoch: 15, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.525 Vali Acc: 0.804 Test Loss: 0.525 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.029684782028198
Epoch: 16, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.523 Vali Acc: 0.804 Test Loss: 0.523 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.430865526199341
Epoch: 17, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.523 Vali Acc: 0.812 Test Loss: 0.523 Test Acc: 0.812
Validation loss decreased (-0.804343 --> -0.811589).  Saving model ...
Epoch: 18 cost time: 4.326160669326782
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.527 Vali Acc: 0.812 Test Loss: 0.527 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.054033041000366
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.516 Vali Acc: 0.804 Test Loss: 0.516 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.084015846252441
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.530 Vali Acc: 0.797 Test Loss: 0.530 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.887402057647705
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.539 Vali Acc: 0.790 Test Loss: 0.539 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.8925046920776367
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.535 Vali Acc: 0.797 Test Loss: 0.535 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.7533016204833984
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.513 Vali Acc: 0.804 Test Loss: 0.513 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.173609495162964
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.522 Vali Acc: 0.797 Test Loss: 0.522 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.968424081802368
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.533 Vali Acc: 0.797 Test Loss: 0.533 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.043930530548096
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.526 Vali Acc: 0.797 Test Loss: 0.526 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.190722227096558
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.517 Vali Acc: 0.804 Test Loss: 0.517 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df512_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8115942028985508
model parameter : 1161476
model size : 9.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df512_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.035075902938843
Epoch: 1, Steps: 9 | Train Loss: 1.459 Vali Loss: 1.366 Vali Acc: 0.312 Test Loss: 1.366 Test Acc: 0.312
Validation loss decreased (inf --> -0.311581).  Saving model ...
Epoch: 2 cost time: 4.086079835891724
Epoch: 2, Steps: 9 | Train Loss: 1.227 Vali Loss: 1.195 Vali Acc: 0.442 Test Loss: 1.195 Test Acc: 0.442
Validation loss decreased (-0.311581 --> -0.442017).  Saving model ...
Epoch: 3 cost time: 4.274561643600464
Epoch: 3, Steps: 9 | Train Loss: 0.887 Vali Loss: 1.034 Vali Acc: 0.616 Test Loss: 1.034 Test Acc: 0.616
Validation loss decreased (-0.442017 --> -0.615932).  Saving model ...
Epoch: 4 cost time: 4.199572801589966
Epoch: 4, Steps: 9 | Train Loss: 0.580 Vali Loss: 0.917 Vali Acc: 0.630 Test Loss: 0.917 Test Acc: 0.630
Validation loss decreased (-0.615932 --> -0.630426).  Saving model ...
Epoch: 5 cost time: 4.020526885986328
Epoch: 5, Steps: 9 | Train Loss: 0.366 Vali Loss: 0.869 Vali Acc: 0.659 Test Loss: 0.869 Test Acc: 0.659
Validation loss decreased (-0.630426 --> -0.659412).  Saving model ...
Epoch: 6 cost time: 3.902109384536743
Epoch: 6, Steps: 9 | Train Loss: 0.227 Vali Loss: 0.839 Vali Acc: 0.667 Test Loss: 0.839 Test Acc: 0.667
Validation loss decreased (-0.659412 --> -0.666658).  Saving model ...
Epoch: 7 cost time: 3.6418356895446777
Epoch: 7, Steps: 9 | Train Loss: 0.143 Vali Loss: 0.886 Vali Acc: 0.667 Test Loss: 0.886 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.901256799697876
Epoch: 8, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.821 Vali Acc: 0.688 Test Loss: 0.821 Test Acc: 0.688
Validation loss decreased (-0.666658 --> -0.688398).  Saving model ...
Epoch: 9 cost time: 3.874526023864746
Epoch: 9, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.837 Vali Acc: 0.681 Test Loss: 0.837 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.7574679851531982
Epoch: 10, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.842 Vali Acc: 0.681 Test Loss: 0.842 Test Acc: 0.681
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.687788724899292
Epoch: 11, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.816 Vali Acc: 0.725 Test Loss: 0.816 Test Acc: 0.725
Validation loss decreased (-0.688398 --> -0.724630).  Saving model ...
Epoch: 12 cost time: 3.8039140701293945
Epoch: 12, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.835 Vali Acc: 0.725 Test Loss: 0.835 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.0309553146362305
Epoch: 13, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.837 Vali Acc: 0.725 Test Loss: 0.837 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.7372939586639404
Epoch: 14, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.839 Vali Acc: 0.739 Test Loss: 0.839 Test Acc: 0.739
Validation loss decreased (-0.724630 --> -0.739122).  Saving model ...
Epoch: 15 cost time: 4.072025775909424
Epoch: 15, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.846 Vali Acc: 0.739 Test Loss: 0.846 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.059085369110107
Epoch: 16, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.854 Vali Acc: 0.739 Test Loss: 0.854 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.074987173080444
Epoch: 17, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.848 Vali Acc: 0.739 Test Loss: 0.848 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.8332431316375732
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.842 Vali Acc: 0.732 Test Loss: 0.842 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.27125358581543
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.857 Vali Acc: 0.739 Test Loss: 0.857 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.371033668518066
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.858 Vali Acc: 0.746 Test Loss: 0.858 Test Acc: 0.746
Validation loss decreased (-0.739122 --> -0.746368).  Saving model ...
Epoch: 21 cost time: 3.8987278938293457
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.852 Vali Acc: 0.746 Test Loss: 0.852 Test Acc: 0.746
Validation loss decreased (-0.746368 --> -0.746368).  Saving model ...
Epoch: 22 cost time: 3.791923761367798
Epoch: 22, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.853 Vali Acc: 0.739 Test Loss: 0.853 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.062713623046875
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.867 Vali Acc: 0.739 Test Loss: 0.867 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.346287965774536
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.877 Vali Acc: 0.746 Test Loss: 0.877 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.9708635807037354
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.890 Vali Acc: 0.746 Test Loss: 0.890 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.0237603187561035
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.872 Vali Acc: 0.746 Test Loss: 0.872 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.873746156692505
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.870 Vali Acc: 0.746 Test Loss: 0.870 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.930274486541748
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.869 Vali Acc: 0.746 Test Loss: 0.869 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.819401979446411
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.878 Vali Acc: 0.746 Test Loss: 0.878 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.793292999267578
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.884 Vali Acc: 0.746 Test Loss: 0.884 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.6774275302886963
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.889 Vali Acc: 0.746 Test Loss: 0.889 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df512_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7463768115942029
model parameter : 1161476
model size : 9.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.162407636642456
Epoch: 1, Steps: 9 | Train Loss: 1.436 Vali Loss: 1.410 Vali Acc: 0.261 Test Loss: 1.410 Test Acc: 0.261
Validation loss decreased (inf --> -0.260855).  Saving model ...
Epoch: 2 cost time: 4.2033467292785645
Epoch: 2, Steps: 9 | Train Loss: 1.315 Vali Loss: 1.401 Vali Acc: 0.319 Test Loss: 1.401 Test Acc: 0.319
Validation loss decreased (-0.260855 --> -0.318827).  Saving model ...
Epoch: 3 cost time: 4.035586833953857
Epoch: 3, Steps: 9 | Train Loss: 1.037 Vali Loss: 1.320 Vali Acc: 0.377 Test Loss: 1.320 Test Acc: 0.377
Validation loss decreased (-0.318827 --> -0.376798).  Saving model ...
Epoch: 4 cost time: 3.9167189598083496
Epoch: 4, Steps: 9 | Train Loss: 0.770 Vali Loss: 1.314 Vali Acc: 0.377 Test Loss: 1.314 Test Acc: 0.377
Validation loss decreased (-0.376798 --> -0.376798).  Saving model ...
Epoch: 5 cost time: 4.323019981384277
Epoch: 5, Steps: 9 | Train Loss: 0.537 Vali Loss: 1.281 Vali Acc: 0.435 Test Loss: 1.281 Test Acc: 0.435
Validation loss decreased (-0.376798 --> -0.434770).  Saving model ...
Epoch: 6 cost time: 4.24362325668335
Epoch: 6, Steps: 9 | Train Loss: 0.360 Vali Loss: 1.308 Vali Acc: 0.420 Test Loss: 1.308 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.316876173019409
Epoch: 7, Steps: 9 | Train Loss: 0.230 Vali Loss: 1.406 Vali Acc: 0.428 Test Loss: 1.406 Test Acc: 0.428
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.210586309432983
Epoch: 8, Steps: 9 | Train Loss: 0.161 Vali Loss: 1.390 Vali Acc: 0.464 Test Loss: 1.390 Test Acc: 0.464
Validation loss decreased (-0.434770 --> -0.463754).  Saving model ...
Epoch: 9 cost time: 4.252169609069824
Epoch: 9, Steps: 9 | Train Loss: 0.093 Vali Loss: 1.545 Vali Acc: 0.442 Test Loss: 1.545 Test Acc: 0.442
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.556747674942017
Epoch: 10, Steps: 9 | Train Loss: 0.056 Vali Loss: 1.523 Vali Acc: 0.449 Test Loss: 1.523 Test Acc: 0.449
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.308480262756348
Epoch: 11, Steps: 9 | Train Loss: 0.032 Vali Loss: 1.513 Vali Acc: 0.493 Test Loss: 1.513 Test Acc: 0.493
Validation loss decreased (-0.463754 --> -0.492738).  Saving model ...
Epoch: 12 cost time: 4.028413534164429
Epoch: 12, Steps: 9 | Train Loss: 0.020 Vali Loss: 1.587 Vali Acc: 0.486 Test Loss: 1.587 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.871056318283081
Epoch: 13, Steps: 9 | Train Loss: 0.014 Vali Loss: 1.586 Vali Acc: 0.478 Test Loss: 1.586 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.8862202167510986
Epoch: 14, Steps: 9 | Train Loss: 0.011 Vali Loss: 1.472 Vali Acc: 0.522 Test Loss: 1.472 Test Acc: 0.522
Validation loss decreased (-0.492738 --> -0.521724).  Saving model ...
Epoch: 15 cost time: 3.684676170349121
Epoch: 15, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.475 Vali Acc: 0.536 Test Loss: 1.475 Test Acc: 0.536
Validation loss decreased (-0.521724 --> -0.536217).  Saving model ...
Epoch: 16 cost time: 4.015434503555298
Epoch: 16, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.564 Vali Acc: 0.507 Test Loss: 1.564 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.0187764167785645
Epoch: 17, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.533 Vali Acc: 0.536 Test Loss: 1.533 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.026757717132568
Epoch: 18, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.489 Vali Acc: 0.536 Test Loss: 1.489 Test Acc: 0.536
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.52478814125061
Epoch: 19, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.465 Vali Acc: 0.543 Test Loss: 1.465 Test Acc: 0.543
Validation loss decreased (-0.536217 --> -0.543464).  Saving model ...
Epoch: 20 cost time: 4.43398118019104
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.434 Vali Acc: 0.558 Test Loss: 1.434 Test Acc: 0.558
Validation loss decreased (-0.543464 --> -0.557957).  Saving model ...
Epoch: 21 cost time: 4.200118780136108
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.467 Vali Acc: 0.558 Test Loss: 1.467 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.355921268463135
Epoch: 22, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.454 Vali Acc: 0.558 Test Loss: 1.454 Test Acc: 0.558
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.322272300720215
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.421 Vali Acc: 0.580 Test Loss: 1.421 Test Acc: 0.580
Validation loss decreased (-0.557957 --> -0.579696).  Saving model ...
Epoch: 24 cost time: 4.654524087905884
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.413 Vali Acc: 0.580 Test Loss: 1.413 Test Acc: 0.580
Validation loss decreased (-0.579696 --> -0.579696).  Saving model ...
Epoch: 25 cost time: 4.637601375579834
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.419 Vali Acc: 0.587 Test Loss: 1.419 Test Acc: 0.587
Validation loss decreased (-0.579696 --> -0.586942).  Saving model ...
Epoch: 26 cost time: 4.517059087753296
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.445 Vali Acc: 0.580 Test Loss: 1.445 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.586971282958984
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.438 Vali Acc: 0.587 Test Loss: 1.438 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.070289850234985
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.421 Vali Acc: 0.587 Test Loss: 1.421 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 4.2344136238098145
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.381 Vali Acc: 0.594 Test Loss: 1.381 Test Acc: 0.594
Validation loss decreased (-0.586942 --> -0.594189).  Saving model ...
Epoch: 30 cost time: 4.048054218292236
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.380 Vali Acc: 0.594 Test Loss: 1.380 Test Acc: 0.594
Validation loss decreased (-0.594189 --> -0.594189).  Saving model ...
Epoch: 31 cost time: 4.067464828491211
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.391 Vali Acc: 0.594 Test Loss: 1.391 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.9738452434539795
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.406 Vali Acc: 0.587 Test Loss: 1.406 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 4.1463234424591064
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.417 Vali Acc: 0.587 Test Loss: 1.417 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 4.101475715637207
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.403 Vali Acc: 0.594 Test Loss: 1.403 Test Acc: 0.594
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 4.423391580581665
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.394 Vali Acc: 0.594 Test Loss: 1.394 Test Acc: 0.594
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 4.096665859222412
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.404 Vali Acc: 0.609 Test Loss: 1.404 Test Acc: 0.609
Validation loss decreased (-0.594189 --> -0.608682).  Saving model ...
Epoch: 37 cost time: 4.404523611068726
Epoch: 37, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.383 Vali Acc: 0.601 Test Loss: 1.383 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 4.127147197723389
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.375 Vali Acc: 0.616 Test Loss: 1.375 Test Acc: 0.616
Validation loss decreased (-0.608682 --> -0.615928).  Saving model ...
Epoch: 39 cost time: 4.170131206512451
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.386 Vali Acc: 0.616 Test Loss: 1.386 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 4.305116653442383
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.375 Vali Acc: 0.616 Test Loss: 1.375 Test Acc: 0.616
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 4.295870780944824
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.361 Vali Acc: 0.616 Test Loss: 1.361 Test Acc: 0.616
Validation loss decreased (-0.615928 --> -0.615928).  Saving model ...
Epoch: 42 cost time: 4.180088758468628
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.368 Vali Acc: 0.616 Test Loss: 1.368 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 4.269057512283325
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.358 Vali Acc: 0.623 Test Loss: 1.358 Test Acc: 0.623
Validation loss decreased (-0.615928 --> -0.623175).  Saving model ...
Epoch: 44 cost time: 4.154863357543945
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.351 Vali Acc: 0.623 Test Loss: 1.351 Test Acc: 0.623
Validation loss decreased (-0.623175 --> -0.623175).  Saving model ...
Epoch: 45 cost time: 4.286810398101807
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.357 Vali Acc: 0.623 Test Loss: 1.357 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 4.014085292816162
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.370 Vali Acc: 0.630 Test Loss: 1.370 Test Acc: 0.630
Validation loss decreased (-0.623175 --> -0.630421).  Saving model ...
Epoch: 47 cost time: 3.7665982246398926
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.373 Vali Acc: 0.630 Test Loss: 1.373 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.9100444316864014
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.360 Vali Acc: 0.630 Test Loss: 1.360 Test Acc: 0.630
Validation loss decreased (-0.630421 --> -0.630421).  Saving model ...
Epoch: 49 cost time: 3.6552982330322266
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.355 Vali Acc: 0.630 Test Loss: 1.355 Test Acc: 0.630
Validation loss decreased (-0.630421 --> -0.630421).  Saving model ...
Epoch: 50 cost time: 4.000607013702393
Epoch: 50, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.343 Vali Acc: 0.645 Test Loss: 1.343 Test Acc: 0.645
Validation loss decreased (-0.630421 --> -0.644914).  Saving model ...
Epoch: 51 cost time: 4.030510187149048
Epoch: 51, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.329 Vali Acc: 0.645 Test Loss: 1.329 Test Acc: 0.645
Validation loss decreased (-0.644914 --> -0.644914).  Saving model ...
Epoch: 52 cost time: 4.553464412689209
Epoch: 52, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.335 Vali Acc: 0.645 Test Loss: 1.335 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 4.08285117149353
Epoch: 53, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.341 Vali Acc: 0.645 Test Loss: 1.341 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 4.470969200134277
Epoch: 54, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.344 Vali Acc: 0.652 Test Loss: 1.344 Test Acc: 0.652
Validation loss decreased (-0.644914 --> -0.652160).  Saving model ...
Epoch: 55 cost time: 4.569367170333862
Epoch: 55, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.329 Vali Acc: 0.652 Test Loss: 1.329 Test Acc: 0.652
Validation loss decreased (-0.652160 --> -0.652161).  Saving model ...
Epoch: 56 cost time: 4.3196704387664795
Epoch: 56, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.325 Vali Acc: 0.652 Test Loss: 1.325 Test Acc: 0.652
Validation loss decreased (-0.652161 --> -0.652161).  Saving model ...
Epoch: 57 cost time: 4.429667711257935
Epoch: 57, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.337 Vali Acc: 0.652 Test Loss: 1.337 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 4.234664440155029
Epoch: 58, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.351 Vali Acc: 0.652 Test Loss: 1.351 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 3.880211114883423
Epoch: 59, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.350 Vali Acc: 0.652 Test Loss: 1.350 Test Acc: 0.652
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 3.8494279384613037
Epoch: 60, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.345 Vali Acc: 0.652 Test Loss: 1.345 Test Acc: 0.652
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 4.381274223327637
Epoch: 61, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.344 Vali Acc: 0.659 Test Loss: 1.344 Test Acc: 0.659
Validation loss decreased (-0.652161 --> -0.659407).  Saving model ...
Epoch: 62 cost time: 3.882521867752075
Epoch: 62, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.349 Vali Acc: 0.652 Test Loss: 1.349 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 4.233095645904541
Epoch: 63, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.355 Vali Acc: 0.652 Test Loss: 1.355 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 3.6872007846832275
Epoch: 64, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.352 Vali Acc: 0.659 Test Loss: 1.352 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 3.927725315093994
Epoch: 65, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.354 Vali Acc: 0.652 Test Loss: 1.354 Test Acc: 0.652
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 4.191240549087524
Epoch: 66, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.359 Vali Acc: 0.652 Test Loss: 1.359 Test Acc: 0.652
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 4.52044939994812
Epoch: 67, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.353 Vali Acc: 0.659 Test Loss: 1.353 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 4.31059718132019
Epoch: 68, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.347 Vali Acc: 0.659 Test Loss: 1.347 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 3.8776562213897705
Epoch: 69, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.343 Vali Acc: 0.659 Test Loss: 1.343 Test Acc: 0.659
Validation loss decreased (-0.659407 --> -0.659407).  Saving model ...
Epoch: 70 cost time: 4.043888330459595
Epoch: 70, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.343 Vali Acc: 0.659 Test Loss: 1.343 Test Acc: 0.659
Validation loss decreased (-0.659407 --> -0.659407).  Saving model ...
Epoch: 71 cost time: 4.162062168121338
Epoch: 71, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.343 Vali Acc: 0.667 Test Loss: 1.343 Test Acc: 0.667
Validation loss decreased (-0.659407 --> -0.666653).  Saving model ...
Epoch: 72 cost time: 4.275084733963013
Epoch: 72, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.340 Vali Acc: 0.667 Test Loss: 1.340 Test Acc: 0.667
Validation loss decreased (-0.666653 --> -0.666653).  Saving model ...
Epoch: 73 cost time: 4.610874176025391
Epoch: 73, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.338 Vali Acc: 0.667 Test Loss: 1.338 Test Acc: 0.667
Validation loss decreased (-0.666653 --> -0.666653).  Saving model ...
Epoch: 74 cost time: 4.575693607330322
Epoch: 74, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.335 Vali Acc: 0.667 Test Loss: 1.335 Test Acc: 0.667
Validation loss decreased (-0.666653 --> -0.666653).  Saving model ...
Epoch: 75 cost time: 3.7064332962036133
Epoch: 75, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.340 Vali Acc: 0.667 Test Loss: 1.340 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 4.365968227386475
Epoch: 76, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.346 Vali Acc: 0.667 Test Loss: 1.346 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 4.04979395866394
Epoch: 77, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.349 Vali Acc: 0.667 Test Loss: 1.349 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 3.7256765365600586
Epoch: 78, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.346 Vali Acc: 0.667 Test Loss: 1.346 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 3.8811330795288086
Epoch: 79, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.340 Vali Acc: 0.667 Test Loss: 1.340 Test Acc: 0.667
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 3.80576229095459
Epoch: 80, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.336 Vali Acc: 0.667 Test Loss: 1.336 Test Acc: 0.667
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 3.7887275218963623
Epoch: 81, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.337 Vali Acc: 0.667 Test Loss: 1.337 Test Acc: 0.667
EarlyStopping counter: 7 out of 10
Epoch: 82 cost time: 4.099444389343262
Epoch: 82, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.340 Vali Acc: 0.667 Test Loss: 1.340 Test Acc: 0.667
EarlyStopping counter: 8 out of 10
Epoch: 83 cost time: 4.3694984912872314
Epoch: 83, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.340 Vali Acc: 0.667 Test Loss: 1.340 Test Acc: 0.667
EarlyStopping counter: 9 out of 10
Epoch: 84 cost time: 4.296788454055786
Epoch: 84, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.342 Vali Acc: 0.674 Test Loss: 1.342 Test Acc: 0.674
Validation loss decreased (-0.666653 --> -0.673900).  Saving model ...
Epoch: 85 cost time: 4.323619842529297
Epoch: 85, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.345 Vali Acc: 0.674 Test Loss: 1.345 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 4.158949851989746
Epoch: 86, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.345 Vali Acc: 0.674 Test Loss: 1.345 Test Acc: 0.674
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 4.171064376831055
Epoch: 87, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.344 Vali Acc: 0.674 Test Loss: 1.344 Test Acc: 0.674
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 4.012976408004761
Epoch: 88, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.346 Vali Acc: 0.674 Test Loss: 1.346 Test Acc: 0.674
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 4.058865547180176
Epoch: 89, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.347 Vali Acc: 0.681 Test Loss: 1.347 Test Acc: 0.681
Validation loss decreased (-0.673900 --> -0.681146).  Saving model ...
Epoch: 90 cost time: 4.123515605926514
Epoch: 90, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.348 Vali Acc: 0.681 Test Loss: 1.348 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 3.7715373039245605
Epoch: 91, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.349 Vali Acc: 0.688 Test Loss: 1.349 Test Acc: 0.688
Validation loss decreased (-0.681146 --> -0.688392).  Saving model ...
Epoch: 92 cost time: 3.6066179275512695
Epoch: 92, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.349 Vali Acc: 0.688 Test Loss: 1.349 Test Acc: 0.688
Validation loss decreased (-0.688392 --> -0.688392).  Saving model ...
Epoch: 93 cost time: 4.209787845611572
Epoch: 93, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.349 Vali Acc: 0.688 Test Loss: 1.349 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 3.6253747940063477
Epoch: 94, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.347 Vali Acc: 0.688 Test Loss: 1.347 Test Acc: 0.688
Validation loss decreased (-0.688392 --> -0.688392).  Saving model ...
Epoch: 95 cost time: 3.989048957824707
Epoch: 95, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.349 Vali Acc: 0.688 Test Loss: 1.349 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 3.980374813079834
Epoch: 96, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.350 Vali Acc: 0.681 Test Loss: 1.350 Test Acc: 0.681
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 4.02293848991394
Epoch: 97, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.350 Vali Acc: 0.681 Test Loss: 1.350 Test Acc: 0.681
EarlyStopping counter: 3 out of 10
Epoch: 98 cost time: 4.57207179069519
Epoch: 98, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.349 Vali Acc: 0.681 Test Loss: 1.349 Test Acc: 0.681
EarlyStopping counter: 4 out of 10
Epoch: 99 cost time: 4.721022129058838
Epoch: 99, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.349 Vali Acc: 0.688 Test Loss: 1.349 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 100 cost time: 4.76422381401062
Epoch: 100, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.348 Vali Acc: 0.681 Test Loss: 1.348 Test Acc: 0.681
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.6884057971014492
model parameter : 1161476
model size : 9.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.277517557144165
Epoch: 1, Steps: 9 | Train Loss: 1.421 Vali Loss: 1.379 Vali Acc: 0.283 Test Loss: 1.379 Test Acc: 0.283
Validation loss decreased (inf --> -0.282595).  Saving model ...
Epoch: 2 cost time: 4.7171852588653564
Epoch: 2, Steps: 9 | Train Loss: 1.362 Vali Loss: 1.464 Vali Acc: 0.232 Test Loss: 1.464 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.103348016738892
Epoch: 3, Steps: 9 | Train Loss: 1.128 Vali Loss: 1.396 Vali Acc: 0.290 Test Loss: 1.396 Test Acc: 0.290
Validation loss decreased (-0.282595 --> -0.289841).  Saving model ...
Epoch: 4 cost time: 4.137298107147217
Epoch: 4, Steps: 9 | Train Loss: 0.962 Vali Loss: 1.518 Vali Acc: 0.290 Test Loss: 1.518 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.992201328277588
Epoch: 5, Steps: 9 | Train Loss: 0.770 Vali Loss: 1.673 Vali Acc: 0.283 Test Loss: 1.673 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.906463623046875
Epoch: 6, Steps: 9 | Train Loss: 0.598 Vali Loss: 1.734 Vali Acc: 0.304 Test Loss: 1.734 Test Acc: 0.304
Validation loss decreased (-0.289841 --> -0.304330).  Saving model ...
Epoch: 7 cost time: 4.126636981964111
Epoch: 7, Steps: 9 | Train Loss: 0.413 Vali Loss: 2.113 Vali Acc: 0.283 Test Loss: 2.113 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.8541336059570312
Epoch: 8, Steps: 9 | Train Loss: 0.278 Vali Loss: 2.235 Vali Acc: 0.304 Test Loss: 2.235 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.432215690612793
Epoch: 9, Steps: 9 | Train Loss: 0.203 Vali Loss: 2.590 Vali Acc: 0.312 Test Loss: 2.590 Test Acc: 0.312
Validation loss decreased (-0.304330 --> -0.311568).  Saving model ...
Epoch: 10 cost time: 4.06580924987793
Epoch: 10, Steps: 9 | Train Loss: 0.139 Vali Loss: 2.583 Vali Acc: 0.283 Test Loss: 2.583 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.2526609897613525
Epoch: 11, Steps: 9 | Train Loss: 0.081 Vali Loss: 2.820 Vali Acc: 0.283 Test Loss: 2.820 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.115386724472046
Epoch: 12, Steps: 9 | Train Loss: 0.054 Vali Loss: 3.153 Vali Acc: 0.290 Test Loss: 3.153 Test Acc: 0.290
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.597069978713989
Epoch: 13, Steps: 9 | Train Loss: 0.033 Vali Loss: 2.580 Vali Acc: 0.319 Test Loss: 2.580 Test Acc: 0.319
Validation loss decreased (-0.311568 --> -0.318815).  Saving model ...
Epoch: 14 cost time: 4.7369256019592285
Epoch: 14, Steps: 9 | Train Loss: 0.023 Vali Loss: 2.743 Vali Acc: 0.326 Test Loss: 2.743 Test Acc: 0.326
Validation loss decreased (-0.318815 --> -0.326060).  Saving model ...
Epoch: 15 cost time: 4.567845106124878
Epoch: 15, Steps: 9 | Train Loss: 0.017 Vali Loss: 3.183 Vali Acc: 0.333 Test Loss: 3.183 Test Acc: 0.333
Validation loss decreased (-0.326060 --> -0.333302).  Saving model ...
Epoch: 16 cost time: 4.1539037227630615
Epoch: 16, Steps: 9 | Train Loss: 0.011 Vali Loss: 2.786 Vali Acc: 0.341 Test Loss: 2.786 Test Acc: 0.341
Validation loss decreased (-0.333302 --> -0.340552).  Saving model ...
Epoch: 17 cost time: 4.066072463989258
Epoch: 17, Steps: 9 | Train Loss: 0.010 Vali Loss: 2.532 Vali Acc: 0.341 Test Loss: 2.532 Test Acc: 0.341
Validation loss decreased (-0.340552 --> -0.340554).  Saving model ...
Epoch: 18 cost time: 4.499453544616699
Epoch: 18, Steps: 9 | Train Loss: 0.008 Vali Loss: 2.685 Vali Acc: 0.341 Test Loss: 2.685 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.675103664398193
Epoch: 19, Steps: 9 | Train Loss: 0.008 Vali Loss: 2.729 Vali Acc: 0.355 Test Loss: 2.729 Test Acc: 0.355
Validation loss decreased (-0.340554 --> -0.355045).  Saving model ...
Epoch: 20 cost time: 4.112628698348999
Epoch: 20, Steps: 9 | Train Loss: 0.005 Vali Loss: 2.881 Vali Acc: 0.355 Test Loss: 2.881 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.122101306915283
Epoch: 21, Steps: 9 | Train Loss: 0.006 Vali Loss: 2.850 Vali Acc: 0.362 Test Loss: 2.850 Test Acc: 0.362
Validation loss decreased (-0.355045 --> -0.362290).  Saving model ...
Epoch: 22 cost time: 4.180872678756714
Epoch: 22, Steps: 9 | Train Loss: 0.004 Vali Loss: 2.761 Vali Acc: 0.377 Test Loss: 2.761 Test Acc: 0.377
Validation loss decreased (-0.362290 --> -0.376784).  Saving model ...
Epoch: 23 cost time: 3.8472836017608643
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 2.645 Vali Acc: 0.377 Test Loss: 2.645 Test Acc: 0.377
Validation loss decreased (-0.376784 --> -0.376785).  Saving model ...
Epoch: 24 cost time: 3.711784601211548
Epoch: 24, Steps: 9 | Train Loss: 0.003 Vali Loss: 2.714 Vali Acc: 0.370 Test Loss: 2.714 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.7759852409362793
Epoch: 25, Steps: 9 | Train Loss: 0.003 Vali Loss: 2.784 Vali Acc: 0.377 Test Loss: 2.784 Test Acc: 0.377
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.8949718475341797
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.842 Vali Acc: 0.384 Test Loss: 2.842 Test Acc: 0.384
Validation loss decreased (-0.376785 --> -0.384030).  Saving model ...
Epoch: 27 cost time: 4.210479736328125
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.826 Vali Acc: 0.391 Test Loss: 2.826 Test Acc: 0.391
Validation loss decreased (-0.384030 --> -0.391276).  Saving model ...
Epoch: 28 cost time: 4.066849946975708
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.809 Vali Acc: 0.399 Test Loss: 2.809 Test Acc: 0.399
Validation loss decreased (-0.391276 --> -0.398523).  Saving model ...
Epoch: 29 cost time: 3.857774496078491
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.702 Vali Acc: 0.406 Test Loss: 2.702 Test Acc: 0.406
Validation loss decreased (-0.398523 --> -0.405770).  Saving model ...
Epoch: 30 cost time: 3.9424490928649902
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.695 Vali Acc: 0.406 Test Loss: 2.695 Test Acc: 0.406
Validation loss decreased (-0.405770 --> -0.405770).  Saving model ...
Epoch: 31 cost time: 4.096322298049927
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.706 Vali Acc: 0.406 Test Loss: 2.706 Test Acc: 0.406
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.7475361824035645
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.730 Vali Acc: 0.406 Test Loss: 2.730 Test Acc: 0.406
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 4.327456712722778
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.685 Vali Acc: 0.413 Test Loss: 2.685 Test Acc: 0.413
Validation loss decreased (-0.405770 --> -0.413017).  Saving model ...
Epoch: 34 cost time: 4.405723333358765
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.669 Vali Acc: 0.413 Test Loss: 2.669 Test Acc: 0.413
Validation loss decreased (-0.413017 --> -0.413017).  Saving model ...
Epoch: 35 cost time: 4.080537557601929
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.712 Vali Acc: 0.413 Test Loss: 2.712 Test Acc: 0.413
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 4.4381492137908936
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.752 Vali Acc: 0.406 Test Loss: 2.752 Test Acc: 0.406
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.9655606746673584
Epoch: 37, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.803 Vali Acc: 0.406 Test Loss: 2.803 Test Acc: 0.406
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.747467517852783
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.760 Vali Acc: 0.406 Test Loss: 2.760 Test Acc: 0.406
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.997715950012207
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.756 Vali Acc: 0.413 Test Loss: 2.756 Test Acc: 0.413
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.731722354888916
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.770 Vali Acc: 0.413 Test Loss: 2.770 Test Acc: 0.413
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 3.832482099533081
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.786 Vali Acc: 0.413 Test Loss: 2.786 Test Acc: 0.413
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 3.9157474040985107
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.768 Vali Acc: 0.420 Test Loss: 2.768 Test Acc: 0.420
Validation loss decreased (-0.413017 --> -0.420262).  Saving model ...
Epoch: 43 cost time: 4.2139892578125
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.737 Vali Acc: 0.420 Test Loss: 2.737 Test Acc: 0.420
Validation loss decreased (-0.420262 --> -0.420262).  Saving model ...
Epoch: 44 cost time: 4.044049978256226
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.725 Vali Acc: 0.413 Test Loss: 2.725 Test Acc: 0.413
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.8505301475524902
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.750 Vali Acc: 0.420 Test Loss: 2.750 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 4.378816366195679
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.791 Vali Acc: 0.428 Test Loss: 2.791 Test Acc: 0.428
Validation loss decreased (-0.420262 --> -0.427508).  Saving model ...
Epoch: 47 cost time: 3.8852040767669678
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.830 Vali Acc: 0.428 Test Loss: 2.830 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 4.462973117828369
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.802 Vali Acc: 0.413 Test Loss: 2.802 Test Acc: 0.413
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 4.167826414108276
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.730 Vali Acc: 0.420 Test Loss: 2.730 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 3.926403760910034
Epoch: 50, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.731 Vali Acc: 0.435 Test Loss: 2.731 Test Acc: 0.435
Validation loss decreased (-0.427508 --> -0.434755).  Saving model ...
Epoch: 51 cost time: 4.652070045471191
Epoch: 51, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.734 Vali Acc: 0.413 Test Loss: 2.734 Test Acc: 0.413
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 4.329740762710571
Epoch: 52, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.762 Vali Acc: 0.413 Test Loss: 2.762 Test Acc: 0.413
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 4.2620909214019775
Epoch: 53, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.774 Vali Acc: 0.413 Test Loss: 2.774 Test Acc: 0.413
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 4.0246546268463135
Epoch: 54, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.783 Vali Acc: 0.413 Test Loss: 2.783 Test Acc: 0.413
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 4.057396411895752
Epoch: 55, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.756 Vali Acc: 0.420 Test Loss: 2.756 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 4.288271188735962
Epoch: 56, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.714 Vali Acc: 0.420 Test Loss: 2.714 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 3.946016788482666
Epoch: 57, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.696 Vali Acc: 0.435 Test Loss: 2.696 Test Acc: 0.435
Validation loss decreased (-0.434755 --> -0.434756).  Saving model ...
Epoch: 58 cost time: 4.348785638809204
Epoch: 58, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.734 Vali Acc: 0.435 Test Loss: 2.734 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 3.658552885055542
Epoch: 59, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.770 Vali Acc: 0.435 Test Loss: 2.770 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 4.7709150314331055
Epoch: 60, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.805 Vali Acc: 0.428 Test Loss: 2.805 Test Acc: 0.428
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 4.056555986404419
Epoch: 61, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.799 Vali Acc: 0.428 Test Loss: 2.799 Test Acc: 0.428
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 3.996899127960205
Epoch: 62, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.816 Vali Acc: 0.435 Test Loss: 2.816 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 4.6237146854400635
Epoch: 63, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.828 Vali Acc: 0.435 Test Loss: 2.828 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 4.505019903182983
Epoch: 64, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.834 Vali Acc: 0.435 Test Loss: 2.834 Test Acc: 0.435
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 4.612478494644165
Epoch: 65, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.839 Vali Acc: 0.435 Test Loss: 2.839 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 4.211641311645508
Epoch: 66, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.851 Vali Acc: 0.428 Test Loss: 2.851 Test Acc: 0.428
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 4.4950807094573975
Epoch: 67, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.804 Vali Acc: 0.428 Test Loss: 2.804 Test Acc: 0.428
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.43478260869565216
model parameter : 1161476
model size : 9.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.686948776245117
Epoch: 1, Steps: 9 | Train Loss: 1.463 Vali Loss: 1.409 Vali Acc: 0.290 Test Loss: 1.409 Test Acc: 0.290
Validation loss decreased (inf --> -0.289841).  Saving model ...
Epoch: 2 cost time: 3.8999533653259277
Epoch: 2, Steps: 9 | Train Loss: 1.352 Vali Loss: 1.458 Vali Acc: 0.239 Test Loss: 1.458 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.629676580429077
Epoch: 3, Steps: 9 | Train Loss: 1.102 Vali Loss: 1.357 Vali Acc: 0.312 Test Loss: 1.357 Test Acc: 0.312
Validation loss decreased (-0.289841 --> -0.311581).  Saving model ...
Epoch: 4 cost time: 4.170630693435669
Epoch: 4, Steps: 9 | Train Loss: 0.933 Vali Loss: 1.369 Vali Acc: 0.297 Test Loss: 1.369 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.721803903579712
Epoch: 5, Steps: 9 | Train Loss: 0.738 Vali Loss: 1.419 Vali Acc: 0.304 Test Loss: 1.419 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.821631669998169
Epoch: 6, Steps: 9 | Train Loss: 0.534 Vali Loss: 1.385 Vali Acc: 0.312 Test Loss: 1.385 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.027659893035889
Epoch: 7, Steps: 9 | Train Loss: 0.359 Vali Loss: 1.545 Vali Acc: 0.312 Test Loss: 1.545 Test Acc: 0.312
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.7953195571899414
Epoch: 8, Steps: 9 | Train Loss: 0.220 Vali Loss: 1.562 Vali Acc: 0.304 Test Loss: 1.562 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.7723257541656494
Epoch: 9, Steps: 9 | Train Loss: 0.168 Vali Loss: 1.701 Vali Acc: 0.297 Test Loss: 1.701 Test Acc: 0.297
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.836331605911255
Epoch: 10, Steps: 9 | Train Loss: 0.093 Vali Loss: 1.744 Vali Acc: 0.297 Test Loss: 1.744 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.855632781982422
Epoch: 11, Steps: 9 | Train Loss: 0.055 Vali Loss: 1.726 Vali Acc: 0.319 Test Loss: 1.726 Test Acc: 0.319
Validation loss decreased (-0.311581 --> -0.318823).  Saving model ...
Epoch: 12 cost time: 3.6419544219970703
Epoch: 12, Steps: 9 | Train Loss: 0.037 Vali Loss: 2.024 Vali Acc: 0.312 Test Loss: 2.024 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.858330249786377
Epoch: 13, Steps: 9 | Train Loss: 0.027 Vali Loss: 1.730 Vali Acc: 0.341 Test Loss: 1.730 Test Acc: 0.341
Validation loss decreased (-0.318823 --> -0.340562).  Saving model ...
Epoch: 14 cost time: 3.559309720993042
Epoch: 14, Steps: 9 | Train Loss: 0.017 Vali Loss: 1.673 Vali Acc: 0.384 Test Loss: 1.673 Test Acc: 0.384
Validation loss decreased (-0.340562 --> -0.384041).  Saving model ...
Epoch: 15 cost time: 3.676032543182373
Epoch: 15, Steps: 9 | Train Loss: 0.012 Vali Loss: 1.797 Vali Acc: 0.355 Test Loss: 1.797 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.6827173233032227
Epoch: 16, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.799 Vali Acc: 0.370 Test Loss: 1.799 Test Acc: 0.370
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.020344495773315
Epoch: 17, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.689 Vali Acc: 0.391 Test Loss: 1.689 Test Acc: 0.391
Validation loss decreased (-0.384041 --> -0.391287).  Saving model ...
Epoch: 18 cost time: 3.70592999458313
Epoch: 18, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.596 Vali Acc: 0.413 Test Loss: 1.596 Test Acc: 0.413
Validation loss decreased (-0.391287 --> -0.413028).  Saving model ...
Epoch: 19 cost time: 3.77775502204895
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.648 Vali Acc: 0.391 Test Loss: 1.648 Test Acc: 0.391
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.3653905391693115
Epoch: 20, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.699 Vali Acc: 0.406 Test Loss: 1.699 Test Acc: 0.406
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.461481094360352
Epoch: 21, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.686 Vali Acc: 0.413 Test Loss: 1.686 Test Acc: 0.413
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.8895039558410645
Epoch: 22, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.637 Vali Acc: 0.413 Test Loss: 1.637 Test Acc: 0.413
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.982192039489746
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.609 Vali Acc: 0.428 Test Loss: 1.609 Test Acc: 0.428
Validation loss decreased (-0.413028 --> -0.427520).  Saving model ...
Epoch: 24 cost time: 3.9221160411834717
Epoch: 24, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.646 Vali Acc: 0.428 Test Loss: 1.646 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.799272298812866
Epoch: 25, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.646 Vali Acc: 0.435 Test Loss: 1.646 Test Acc: 0.435
Validation loss decreased (-0.427520 --> -0.434766).  Saving model ...
Epoch: 26 cost time: 4.232547760009766
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.651 Vali Acc: 0.435 Test Loss: 1.651 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.206265211105347
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.623 Vali Acc: 0.442 Test Loss: 1.623 Test Acc: 0.442
Validation loss decreased (-0.434766 --> -0.442013).  Saving model ...
Epoch: 28 cost time: 4.2769246101379395
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.594 Vali Acc: 0.435 Test Loss: 1.594 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.7864606380462646
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.550 Vali Acc: 0.478 Test Loss: 1.550 Test Acc: 0.478
Validation loss decreased (-0.442013 --> -0.478245).  Saving model ...
Epoch: 30 cost time: 3.828868865966797
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.559 Vali Acc: 0.486 Test Loss: 1.559 Test Acc: 0.486
Validation loss decreased (-0.478245 --> -0.485492).  Saving model ...
Epoch: 31 cost time: 3.735051155090332
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.589 Vali Acc: 0.478 Test Loss: 1.589 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.7278153896331787
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.588 Vali Acc: 0.486 Test Loss: 1.588 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.5096333026885986
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.591 Vali Acc: 0.486 Test Loss: 1.591 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 4.034514427185059
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.593 Vali Acc: 0.500 Test Loss: 1.593 Test Acc: 0.500
Validation loss decreased (-0.485492 --> -0.499984).  Saving model ...
Epoch: 35 cost time: 4.226253986358643
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.566 Vali Acc: 0.500 Test Loss: 1.566 Test Acc: 0.500
Validation loss decreased (-0.499984 --> -0.499984).  Saving model ...
Epoch: 36 cost time: 4.111001968383789
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.569 Vali Acc: 0.493 Test Loss: 1.569 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.9609122276306152
Epoch: 37, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.581 Vali Acc: 0.500 Test Loss: 1.581 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.7163805961608887
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.577 Vali Acc: 0.514 Test Loss: 1.577 Test Acc: 0.514
Validation loss decreased (-0.499984 --> -0.514477).  Saving model ...
Epoch: 39 cost time: 3.9935457706451416
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.573 Vali Acc: 0.522 Test Loss: 1.573 Test Acc: 0.522
Validation loss decreased (-0.514477 --> -0.521723).  Saving model ...
Epoch: 40 cost time: 4.342216730117798
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.576 Vali Acc: 0.522 Test Loss: 1.576 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 4.505255699157715
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.584 Vali Acc: 0.514 Test Loss: 1.584 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 4.22162652015686
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.579 Vali Acc: 0.522 Test Loss: 1.579 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 4.190850019454956
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.552 Vali Acc: 0.522 Test Loss: 1.552 Test Acc: 0.522
Validation loss decreased (-0.521723 --> -0.521724).  Saving model ...
Epoch: 44 cost time: 4.267295598983765
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.545 Vali Acc: 0.543 Test Loss: 1.545 Test Acc: 0.543
Validation loss decreased (-0.521724 --> -0.543463).  Saving model ...
Epoch: 45 cost time: 3.918328046798706
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.563 Vali Acc: 0.536 Test Loss: 1.563 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.95251727104187
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.591 Vali Acc: 0.522 Test Loss: 1.591 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.994074821472168
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.608 Vali Acc: 0.529 Test Loss: 1.608 Test Acc: 0.529
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.8494601249694824
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.601 Vali Acc: 0.536 Test Loss: 1.601 Test Acc: 0.536
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 4.119192838668823
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.591 Vali Acc: 0.536 Test Loss: 1.591 Test Acc: 0.536
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 3.848198890686035
Epoch: 50, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.581 Vali Acc: 0.543 Test Loss: 1.581 Test Acc: 0.543
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 3.752561330795288
Epoch: 51, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.579 Vali Acc: 0.565 Test Loss: 1.579 Test Acc: 0.565
Validation loss decreased (-0.543463 --> -0.565202).  Saving model ...
Epoch: 52 cost time: 4.540238857269287
Epoch: 52, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.588 Vali Acc: 0.565 Test Loss: 1.588 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 4.264093637466431
Epoch: 53, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.598 Vali Acc: 0.558 Test Loss: 1.598 Test Acc: 0.558
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 4.161545515060425
Epoch: 54, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.613 Vali Acc: 0.543 Test Loss: 1.613 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 3.9363553524017334
Epoch: 55, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.609 Vali Acc: 0.543 Test Loss: 1.609 Test Acc: 0.543
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 4.171426057815552
Epoch: 56, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.603 Vali Acc: 0.558 Test Loss: 1.603 Test Acc: 0.558
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 3.9165942668914795
Epoch: 57, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.585 Vali Acc: 0.572 Test Loss: 1.585 Test Acc: 0.572
Validation loss decreased (-0.565202 --> -0.572448).  Saving model ...
Epoch: 58 cost time: 4.2264723777771
Epoch: 58, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.582 Vali Acc: 0.572 Test Loss: 1.582 Test Acc: 0.572
Validation loss decreased (-0.572448 --> -0.572448).  Saving model ...
Epoch: 59 cost time: 3.8867146968841553
Epoch: 59, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.584 Vali Acc: 0.572 Test Loss: 1.584 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 3.9877779483795166
Epoch: 60, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.592 Vali Acc: 0.572 Test Loss: 1.592 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 4.141937971115112
Epoch: 61, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.604 Vali Acc: 0.565 Test Loss: 1.604 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 3.996166229248047
Epoch: 62, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.614 Vali Acc: 0.565 Test Loss: 1.614 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 3.9340174198150635
Epoch: 63, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.624 Vali Acc: 0.580 Test Loss: 1.624 Test Acc: 0.580
Validation loss decreased (-0.572448 --> -0.579694).  Saving model ...
Epoch: 64 cost time: 3.823044776916504
Epoch: 64, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.628 Vali Acc: 0.580 Test Loss: 1.628 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 3.8540005683898926
Epoch: 65, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.633 Vali Acc: 0.565 Test Loss: 1.633 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 4.026084899902344
Epoch: 66, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.644 Vali Acc: 0.558 Test Loss: 1.644 Test Acc: 0.558
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 4.000036716461182
Epoch: 67, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.632 Vali Acc: 0.572 Test Loss: 1.632 Test Acc: 0.572
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 4.563920259475708
Epoch: 68, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.624 Vali Acc: 0.565 Test Loss: 1.624 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 4.41538405418396
Epoch: 69, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.623 Vali Acc: 0.565 Test Loss: 1.623 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 4.291832447052002
Epoch: 70, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.627 Vali Acc: 0.565 Test Loss: 1.627 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 4.0665271282196045
Epoch: 71, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.637 Vali Acc: 0.565 Test Loss: 1.637 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 4.322840929031372
Epoch: 72, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.643 Vali Acc: 0.572 Test Loss: 1.643 Test Acc: 0.572
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 4.300858974456787
Epoch: 73, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.651 Vali Acc: 0.572 Test Loss: 1.651 Test Acc: 0.572
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5797101449275363
model parameter : 1161476
model size : 9.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         103                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df256_ma103_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.696581125259399
Epoch: 1, Steps: 9 | Train Loss: 1.403 Vali Loss: 1.323 Vali Acc: 0.399 Test Loss: 1.323 Test Acc: 0.399
Validation loss decreased (inf --> -0.398537).  Saving model ...
Epoch: 2 cost time: 3.580911159515381
Epoch: 2, Steps: 9 | Train Loss: 1.168 Vali Loss: 1.143 Vali Acc: 0.536 Test Loss: 1.143 Test Acc: 0.536
Validation loss decreased (-0.398537 --> -0.536220).  Saving model ...
Epoch: 3 cost time: 3.8440239429473877
Epoch: 3, Steps: 9 | Train Loss: 0.839 Vali Loss: 0.975 Vali Acc: 0.630 Test Loss: 0.975 Test Acc: 0.630
Validation loss decreased (-0.536220 --> -0.630425).  Saving model ...
Epoch: 4 cost time: 3.730417013168335
Epoch: 4, Steps: 9 | Train Loss: 0.514 Vali Loss: 0.855 Vali Acc: 0.667 Test Loss: 0.855 Test Acc: 0.667
Validation loss decreased (-0.630425 --> -0.666658).  Saving model ...
Epoch: 5 cost time: 3.703064441680908
Epoch: 5, Steps: 9 | Train Loss: 0.297 Vali Loss: 0.825 Vali Acc: 0.710 Test Loss: 0.825 Test Acc: 0.710
Validation loss decreased (-0.666658 --> -0.710137).  Saving model ...
Epoch: 6 cost time: 3.8185434341430664
Epoch: 6, Steps: 9 | Train Loss: 0.173 Vali Loss: 0.726 Vali Acc: 0.710 Test Loss: 0.726 Test Acc: 0.710
Validation loss decreased (-0.710137 --> -0.710138).  Saving model ...
Epoch: 7 cost time: 3.734119415283203
Epoch: 7, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.696 Vali Acc: 0.790 Test Loss: 0.696 Test Acc: 0.790
Validation loss decreased (-0.710138 --> -0.789848).  Saving model ...
Epoch: 8 cost time: 3.658172845840454
Epoch: 8, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.646 Vali Acc: 0.768 Test Loss: 0.646 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.045126676559448
Epoch: 9, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.682 Vali Acc: 0.783 Test Loss: 0.682 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.187937021255493
Epoch: 10, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.657 Vali Acc: 0.783 Test Loss: 0.657 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.045820951461792
Epoch: 11, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.655 Vali Acc: 0.790 Test Loss: 0.655 Test Acc: 0.790
Validation loss decreased (-0.789848 --> -0.789849).  Saving model ...
Epoch: 12 cost time: 4.03240180015564
Epoch: 12, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.679 Vali Acc: 0.790 Test Loss: 0.679 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.8891029357910156
Epoch: 13, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.688 Vali Acc: 0.797 Test Loss: 0.688 Test Acc: 0.797
Validation loss decreased (-0.789849 --> -0.797095).  Saving model ...
Epoch: 14 cost time: 4.236821174621582
Epoch: 14, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.659 Vali Acc: 0.783 Test Loss: 0.659 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.08785343170166
Epoch: 15, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.653 Vali Acc: 0.783 Test Loss: 0.653 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.239426612854004
Epoch: 16, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.666 Vali Acc: 0.797 Test Loss: 0.666 Test Acc: 0.797
Validation loss decreased (-0.797095 --> -0.797095).  Saving model ...
Epoch: 17 cost time: 4.323431968688965
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.676 Vali Acc: 0.797 Test Loss: 0.676 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.767789363861084
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.652 Vali Acc: 0.783 Test Loss: 0.652 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.82731032371521
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.664 Vali Acc: 0.790 Test Loss: 0.664 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.033681869506836
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.690 Vali Acc: 0.797 Test Loss: 0.690 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.034468650817871
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.683 Vali Acc: 0.797 Test Loss: 0.683 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.8064229488372803
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.664 Vali Acc: 0.797 Test Loss: 0.664 Test Acc: 0.797
Validation loss decreased (-0.797095 --> -0.797095).  Saving model ...
Epoch: 23 cost time: 4.167927503585815
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.682 Vali Acc: 0.797 Test Loss: 0.682 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.6335866451263428
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.689 Vali Acc: 0.797 Test Loss: 0.689 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.2322351932525635
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.674 Vali Acc: 0.797 Test Loss: 0.674 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.513361930847168
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.665 Vali Acc: 0.812 Test Loss: 0.665 Test Acc: 0.812
Validation loss decreased (-0.797095 --> -0.811588).  Saving model ...
Epoch: 27 cost time: 4.682011127471924
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.679 Vali Acc: 0.804 Test Loss: 0.679 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.764853000640869
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.681 Vali Acc: 0.804 Test Loss: 0.681 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.607679128646851
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.679 Vali Acc: 0.804 Test Loss: 0.679 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.313700199127197
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.682 Vali Acc: 0.812 Test Loss: 0.682 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 4.194328546524048
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.686 Vali Acc: 0.804 Test Loss: 0.686 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 4.070135116577148
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.681 Vali Acc: 0.804 Test Loss: 0.681 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 4.105328321456909
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.684 Vali Acc: 0.804 Test Loss: 0.684 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 4.057259559631348
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.685 Vali Acc: 0.812 Test Loss: 0.685 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 4.057788372039795
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.692 Vali Acc: 0.804 Test Loss: 0.692 Test Acc: 0.804
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.6961793899536133
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.693 Vali Acc: 0.804 Test Loss: 0.693 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df256_ma103_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8115942028985508
model parameter : 964868
model size : 8.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         83                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df256_ma83_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.055096864700317
Epoch: 1, Steps: 9 | Train Loss: 1.403 Vali Loss: 1.321 Vali Acc: 0.413 Test Loss: 1.321 Test Acc: 0.413
Validation loss decreased (inf --> -0.413030).  Saving model ...
Epoch: 2 cost time: 4.0369157791137695
Epoch: 2, Steps: 9 | Train Loss: 1.177 Vali Loss: 1.144 Vali Acc: 0.551 Test Loss: 1.144 Test Acc: 0.551
Validation loss decreased (-0.413030 --> -0.550713).  Saving model ...
Epoch: 3 cost time: 4.379589796066284
Epoch: 3, Steps: 9 | Train Loss: 0.853 Vali Loss: 0.975 Vali Acc: 0.623 Test Loss: 0.975 Test Acc: 0.623
Validation loss decreased (-0.550713 --> -0.623179).  Saving model ...
Epoch: 4 cost time: 4.6504809856414795
Epoch: 4, Steps: 9 | Train Loss: 0.525 Vali Loss: 0.853 Vali Acc: 0.688 Test Loss: 0.853 Test Acc: 0.688
Validation loss decreased (-0.623179 --> -0.688397).  Saving model ...
Epoch: 5 cost time: 4.413480997085571
Epoch: 5, Steps: 9 | Train Loss: 0.306 Vali Loss: 0.828 Vali Acc: 0.710 Test Loss: 0.828 Test Acc: 0.710
Validation loss decreased (-0.688397 --> -0.710137).  Saving model ...
Epoch: 6 cost time: 4.311499118804932
Epoch: 6, Steps: 9 | Train Loss: 0.184 Vali Loss: 0.695 Vali Acc: 0.783 Test Loss: 0.695 Test Acc: 0.783
Validation loss decreased (-0.710137 --> -0.782602).  Saving model ...
Epoch: 7 cost time: 4.596180200576782
Epoch: 7, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.671 Vali Acc: 0.768 Test Loss: 0.671 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.513720512390137
Epoch: 8, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.625 Vali Acc: 0.790 Test Loss: 0.625 Test Acc: 0.790
Validation loss decreased (-0.782602 --> -0.789849).  Saving model ...
Epoch: 9 cost time: 4.057818174362183
Epoch: 9, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.665 Vali Acc: 0.783 Test Loss: 0.665 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.133622169494629
Epoch: 10, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.629 Vali Acc: 0.790 Test Loss: 0.629 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.016794919967651
Epoch: 11, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.625 Vali Acc: 0.783 Test Loss: 0.625 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.2871809005737305
Epoch: 12, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.643 Vali Acc: 0.783 Test Loss: 0.643 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.9006452560424805
Epoch: 13, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.655 Vali Acc: 0.790 Test Loss: 0.655 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.17053747177124
Epoch: 14, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.624 Vali Acc: 0.790 Test Loss: 0.624 Test Acc: 0.790
Validation loss decreased (-0.789849 --> -0.789849).  Saving model ...
Epoch: 15 cost time: 4.152987957000732
Epoch: 15, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.620 Vali Acc: 0.783 Test Loss: 0.620 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.9852163791656494
Epoch: 16, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.630 Vali Acc: 0.797 Test Loss: 0.630 Test Acc: 0.797
Validation loss decreased (-0.789849 --> -0.797095).  Saving model ...
Epoch: 17 cost time: 4.051908493041992
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.645 Vali Acc: 0.790 Test Loss: 0.645 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.467320680618286
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.613 Vali Acc: 0.804 Test Loss: 0.613 Test Acc: 0.804
Validation loss decreased (-0.797095 --> -0.804342).  Saving model ...
Epoch: 19 cost time: 4.187966823577881
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.624 Vali Acc: 0.804 Test Loss: 0.624 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.223558664321899
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.657 Vali Acc: 0.790 Test Loss: 0.657 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.3268513679504395
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.651 Vali Acc: 0.797 Test Loss: 0.651 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.030999183654785
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.621 Vali Acc: 0.804 Test Loss: 0.621 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.193652153015137
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.643 Vali Acc: 0.804 Test Loss: 0.643 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.185048341751099
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.653 Vali Acc: 0.797 Test Loss: 0.653 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.235117435455322
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.635 Vali Acc: 0.804 Test Loss: 0.635 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.12418794631958
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.621 Vali Acc: 0.819 Test Loss: 0.621 Test Acc: 0.819
Validation loss decreased (-0.804342 --> -0.818834).  Saving model ...
Epoch: 27 cost time: 3.8549792766571045
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.639 Vali Acc: 0.819 Test Loss: 0.639 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.7464489936828613
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.641 Vali Acc: 0.812 Test Loss: 0.641 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.082322359085083
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.642 Vali Acc: 0.812 Test Loss: 0.642 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.9740710258483887
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.648 Vali Acc: 0.812 Test Loss: 0.648 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.6933200359344482
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.651 Vali Acc: 0.812 Test Loss: 0.651 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.5888760089874268
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.641 Vali Acc: 0.819 Test Loss: 0.641 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 4.242502927780151
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.643 Vali Acc: 0.819 Test Loss: 0.643 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 4.119403123855591
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.644 Vali Acc: 0.826 Test Loss: 0.644 Test Acc: 0.826
Validation loss decreased (-0.818834 --> -0.826081).  Saving model ...
Epoch: 35 cost time: 4.259061098098755
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.652 Vali Acc: 0.826 Test Loss: 0.652 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 4.163542747497559
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.654 Vali Acc: 0.826 Test Loss: 0.654 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 4.110630035400391
Epoch: 37, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.658 Vali Acc: 0.826 Test Loss: 0.658 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.899261474609375
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.652 Vali Acc: 0.826 Test Loss: 0.652 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 4.230451822280884
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.642 Vali Acc: 0.833 Test Loss: 0.642 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833327).  Saving model ...
Epoch: 40 cost time: 4.2530999183654785
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.645 Vali Acc: 0.833 Test Loss: 0.645 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 4.439035892486572
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.655 Vali Acc: 0.826 Test Loss: 0.655 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.8862221240997314
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.667 Vali Acc: 0.826 Test Loss: 0.667 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 4.103705167770386
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.663 Vali Acc: 0.826 Test Loss: 0.663 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.9974164962768555
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.662 Vali Acc: 0.826 Test Loss: 0.662 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 4.047138929367065
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.660 Vali Acc: 0.833 Test Loss: 0.660 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 4.323043346405029
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.662 Vali Acc: 0.833 Test Loss: 0.662 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 4.309814214706421
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.664 Vali Acc: 0.833 Test Loss: 0.664 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 4.63558554649353
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.672 Vali Acc: 0.826 Test Loss: 0.672 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 5.00959324836731
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.672 Vali Acc: 0.833 Test Loss: 0.672 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df256_ma83_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 964868
model size : 8.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         62                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df256_ma62_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.4633708000183105
Epoch: 1, Steps: 9 | Train Loss: 1.435 Vali Loss: 1.347 Vali Acc: 0.413 Test Loss: 1.347 Test Acc: 0.413
Validation loss decreased (inf --> -0.413030).  Saving model ...
Epoch: 2 cost time: 4.557828903198242
Epoch: 2, Steps: 9 | Train Loss: 1.205 Vali Loss: 1.174 Vali Acc: 0.536 Test Loss: 1.174 Test Acc: 0.536
Validation loss decreased (-0.413030 --> -0.536220).  Saving model ...
Epoch: 3 cost time: 4.06139874458313
Epoch: 3, Steps: 9 | Train Loss: 0.868 Vali Loss: 0.999 Vali Acc: 0.609 Test Loss: 0.999 Test Acc: 0.609
Validation loss decreased (-0.536220 --> -0.608686).  Saving model ...
Epoch: 4 cost time: 4.5495758056640625
Epoch: 4, Steps: 9 | Train Loss: 0.535 Vali Loss: 0.889 Vali Acc: 0.638 Test Loss: 0.889 Test Acc: 0.638
Validation loss decreased (-0.608686 --> -0.637672).  Saving model ...
Epoch: 5 cost time: 3.721276044845581
Epoch: 5, Steps: 9 | Train Loss: 0.304 Vali Loss: 0.838 Vali Acc: 0.674 Test Loss: 0.838 Test Acc: 0.674
Validation loss decreased (-0.637672 --> -0.673905).  Saving model ...
Epoch: 6 cost time: 3.856327772140503
Epoch: 6, Steps: 9 | Train Loss: 0.177 Vali Loss: 0.731 Vali Acc: 0.732 Test Loss: 0.731 Test Acc: 0.732
Validation loss decreased (-0.673905 --> -0.731877).  Saving model ...
Epoch: 7 cost time: 4.193827390670776
Epoch: 7, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.693 Vali Acc: 0.783 Test Loss: 0.693 Test Acc: 0.783
Validation loss decreased (-0.731877 --> -0.782602).  Saving model ...
Epoch: 8 cost time: 4.350855588912964
Epoch: 8, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.645 Vali Acc: 0.812 Test Loss: 0.645 Test Acc: 0.812
Validation loss decreased (-0.782602 --> -0.811588).  Saving model ...
Epoch: 9 cost time: 3.835994005203247
Epoch: 9, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.668 Vali Acc: 0.783 Test Loss: 0.668 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.126253843307495
Epoch: 10, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.669 Vali Acc: 0.797 Test Loss: 0.669 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.0294880867004395
Epoch: 11, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.625 Vali Acc: 0.841 Test Loss: 0.625 Test Acc: 0.841
Validation loss decreased (-0.811588 --> -0.840573).  Saving model ...
Epoch: 12 cost time: 4.046693563461304
Epoch: 12, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.642 Vali Acc: 0.819 Test Loss: 0.642 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.831238269805908
Epoch: 13, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.666 Vali Acc: 0.826 Test Loss: 0.666 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.940340757369995
Epoch: 14, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.643 Vali Acc: 0.826 Test Loss: 0.643 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.103521823883057
Epoch: 15, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.639 Vali Acc: 0.833 Test Loss: 0.639 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.502575874328613
Epoch: 16, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.639 Vali Acc: 0.826 Test Loss: 0.639 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.109581470489502
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.648 Vali Acc: 0.819 Test Loss: 0.648 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.281971454620361
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.633 Vali Acc: 0.848 Test Loss: 0.633 Test Acc: 0.848
Validation loss decreased (-0.840573 --> -0.847820).  Saving model ...
Epoch: 19 cost time: 4.41742205619812
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.639 Vali Acc: 0.826 Test Loss: 0.639 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.7523484230041504
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.656 Vali Acc: 0.833 Test Loss: 0.656 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.6870861053466797
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.658 Vali Acc: 0.841 Test Loss: 0.658 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.830678939819336
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.637 Vali Acc: 0.841 Test Loss: 0.637 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.9423623085021973
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.646 Vali Acc: 0.848 Test Loss: 0.646 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.8950889110565186
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.657 Vali Acc: 0.841 Test Loss: 0.657 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.015387296676636
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.650 Vali Acc: 0.841 Test Loss: 0.650 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.114031076431274
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.638 Vali Acc: 0.841 Test Loss: 0.638 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.880004644393921
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.649 Vali Acc: 0.841 Test Loss: 0.649 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.282748222351074
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.647 Vali Acc: 0.841 Test Loss: 0.647 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df256_ma62_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 964868
model size : 8.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         42                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df256_ma42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.6203203201293945
Epoch: 1, Steps: 9 | Train Loss: 1.400 Vali Loss: 1.309 Vali Acc: 0.420 Test Loss: 1.309 Test Acc: 0.420
Validation loss decreased (inf --> -0.420277).  Saving model ...
Epoch: 2 cost time: 3.6885406970977783
Epoch: 2, Steps: 9 | Train Loss: 1.162 Vali Loss: 1.116 Vali Acc: 0.558 Test Loss: 1.116 Test Acc: 0.558
Validation loss decreased (-0.420277 --> -0.557960).  Saving model ...
Epoch: 3 cost time: 4.002451181411743
Epoch: 3, Steps: 9 | Train Loss: 0.822 Vali Loss: 0.945 Vali Acc: 0.630 Test Loss: 0.945 Test Acc: 0.630
Validation loss decreased (-0.557960 --> -0.630425).  Saving model ...
Epoch: 4 cost time: 3.841362714767456
Epoch: 4, Steps: 9 | Train Loss: 0.493 Vali Loss: 0.827 Vali Acc: 0.674 Test Loss: 0.827 Test Acc: 0.674
Validation loss decreased (-0.630425 --> -0.673905).  Saving model ...
Epoch: 5 cost time: 3.8962795734405518
Epoch: 5, Steps: 9 | Train Loss: 0.277 Vali Loss: 0.806 Vali Acc: 0.659 Test Loss: 0.806 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.713780164718628
Epoch: 6, Steps: 9 | Train Loss: 0.170 Vali Loss: 0.668 Vali Acc: 0.746 Test Loss: 0.668 Test Acc: 0.746
Validation loss decreased (-0.673905 --> -0.746370).  Saving model ...
Epoch: 7 cost time: 3.715118408203125
Epoch: 7, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.665 Vali Acc: 0.732 Test Loss: 0.665 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.584826946258545
Epoch: 8, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.605 Vali Acc: 0.768 Test Loss: 0.605 Test Acc: 0.768
Validation loss decreased (-0.746370 --> -0.768110).  Saving model ...
Epoch: 9 cost time: 3.7883877754211426
Epoch: 9, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.632 Vali Acc: 0.768 Test Loss: 0.632 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.8700215816497803
Epoch: 10, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.620 Vali Acc: 0.790 Test Loss: 0.620 Test Acc: 0.790
Validation loss decreased (-0.768110 --> -0.789849).  Saving model ...
Epoch: 11 cost time: 3.3544692993164062
Epoch: 11, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.580 Vali Acc: 0.804 Test Loss: 0.580 Test Acc: 0.804
Validation loss decreased (-0.789849 --> -0.804342).  Saving model ...
Epoch: 12 cost time: 3.658653974533081
Epoch: 12, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.618 Vali Acc: 0.790 Test Loss: 0.618 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.627814769744873
Epoch: 13, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.630 Vali Acc: 0.797 Test Loss: 0.630 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.6954526901245117
Epoch: 14, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.591 Vali Acc: 0.790 Test Loss: 0.591 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.083200693130493
Epoch: 15, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.600 Vali Acc: 0.804 Test Loss: 0.600 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.950961112976074
Epoch: 16, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.592 Vali Acc: 0.804 Test Loss: 0.592 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.181484222412109
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.610 Vali Acc: 0.804 Test Loss: 0.610 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.5430681705474854
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.591 Vali Acc: 0.797 Test Loss: 0.591 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.1063292026519775
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.598 Vali Acc: 0.804 Test Loss: 0.598 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.935424327850342
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.622 Vali Acc: 0.797 Test Loss: 0.622 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.9793004989624023
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.613 Vali Acc: 0.797 Test Loss: 0.613 Test Acc: 0.797
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df256_ma42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8043478260869565
model parameter : 964868
model size : 8.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df256_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.198046684265137
Epoch: 1, Steps: 9 | Train Loss: 1.422 Vali Loss: 1.339 Vali Acc: 0.341 Test Loss: 1.339 Test Acc: 0.341
Validation loss decreased (inf --> -0.340566).  Saving model ...
Epoch: 2 cost time: 3.548614740371704
Epoch: 2, Steps: 9 | Train Loss: 1.213 Vali Loss: 1.171 Vali Acc: 0.587 Test Loss: 1.171 Test Acc: 0.587
Validation loss decreased (-0.340566 --> -0.586945).  Saving model ...
Epoch: 3 cost time: 4.0640223026275635
Epoch: 3, Steps: 9 | Train Loss: 0.873 Vali Loss: 0.990 Vali Acc: 0.623 Test Loss: 0.990 Test Acc: 0.623
Validation loss decreased (-0.586945 --> -0.623179).  Saving model ...
Epoch: 4 cost time: 3.8978755474090576
Epoch: 4, Steps: 9 | Train Loss: 0.523 Vali Loss: 0.851 Vali Acc: 0.681 Test Loss: 0.851 Test Acc: 0.681
Validation loss decreased (-0.623179 --> -0.681151).  Saving model ...
Epoch: 5 cost time: 3.829824686050415
Epoch: 5, Steps: 9 | Train Loss: 0.312 Vali Loss: 0.760 Vali Acc: 0.725 Test Loss: 0.760 Test Acc: 0.725
Validation loss decreased (-0.681151 --> -0.724630).  Saving model ...
Epoch: 6 cost time: 4.582533836364746
Epoch: 6, Steps: 9 | Train Loss: 0.200 Vali Loss: 0.639 Vali Acc: 0.797 Test Loss: 0.639 Test Acc: 0.797
Validation loss decreased (-0.724630 --> -0.797095).  Saving model ...
Epoch: 7 cost time: 4.002055406570435
Epoch: 7, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.593 Vali Acc: 0.768 Test Loss: 0.593 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.30873703956604
Epoch: 8, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.507 Vali Acc: 0.783 Test Loss: 0.507 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.9596543312072754
Epoch: 9, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.534 Vali Acc: 0.804 Test Loss: 0.534 Test Acc: 0.804
Validation loss decreased (-0.797095 --> -0.804342).  Saving model ...
Epoch: 10 cost time: 4.386112451553345
Epoch: 10, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.531 Vali Acc: 0.812 Test Loss: 0.531 Test Acc: 0.812
Validation loss decreased (-0.804342 --> -0.811589).  Saving model ...
Epoch: 11 cost time: 4.2769365310668945
Epoch: 11, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.469 Vali Acc: 0.804 Test Loss: 0.469 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.925020217895508
Epoch: 12, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.483 Vali Acc: 0.819 Test Loss: 0.483 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818836).  Saving model ...
Epoch: 13 cost time: 4.286943435668945
Epoch: 13, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.515 Vali Acc: 0.812 Test Loss: 0.515 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.156757354736328
Epoch: 14, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.469 Vali Acc: 0.812 Test Loss: 0.469 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.1020660400390625
Epoch: 15, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.456 Vali Acc: 0.812 Test Loss: 0.456 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.709897041320801
Epoch: 16, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.462 Vali Acc: 0.812 Test Loss: 0.462 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.87670636177063
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.473 Vali Acc: 0.819 Test Loss: 0.473 Test Acc: 0.819
Validation loss decreased (-0.818836 --> -0.818836).  Saving model ...
Epoch: 18 cost time: 3.6916468143463135
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.456 Vali Acc: 0.826 Test Loss: 0.456 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826082).  Saving model ...
Epoch: 19 cost time: 3.802640914916992
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.450 Vali Acc: 0.819 Test Loss: 0.450 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.043081998825073
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.457 Vali Acc: 0.833 Test Loss: 0.457 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833329).  Saving model ...
Epoch: 21 cost time: 3.756638288497925
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.456 Vali Acc: 0.833 Test Loss: 0.456 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 22 cost time: 3.753911256790161
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.442 Vali Acc: 0.833 Test Loss: 0.442 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 23 cost time: 4.387681007385254
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.450 Vali Acc: 0.841 Test Loss: 0.450 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 24 cost time: 4.157544851303101
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.464 Vali Acc: 0.841 Test Loss: 0.464 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.9962472915649414
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.453 Vali Acc: 0.841 Test Loss: 0.453 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.111027717590332
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.434 Vali Acc: 0.841 Test Loss: 0.434 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 27 cost time: 3.8653581142425537
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.442 Vali Acc: 0.841 Test Loss: 0.442 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.453745365142822
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.440 Vali Acc: 0.841 Test Loss: 0.440 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.845379590988159
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.442 Vali Acc: 0.848 Test Loss: 0.442 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 30 cost time: 4.213346004486084
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.449 Vali Acc: 0.848 Test Loss: 0.449 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 4.0440685749053955
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.455 Vali Acc: 0.848 Test Loss: 0.455 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.9477615356445312
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.448 Vali Acc: 0.848 Test Loss: 0.448 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.5538089275360107
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.447 Vali Acc: 0.855 Test Loss: 0.447 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 34 cost time: 3.7108092308044434
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.444 Vali Acc: 0.855 Test Loss: 0.444 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 35 cost time: 3.7059667110443115
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.450 Vali Acc: 0.848 Test Loss: 0.450 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.7769014835357666
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.447 Vali Acc: 0.848 Test Loss: 0.447 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.882849931716919
Epoch: 37, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.447 Vali Acc: 0.848 Test Loss: 0.447 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 4.176788568496704
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.437 Vali Acc: 0.855 Test Loss: 0.437 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 39 cost time: 4.012189865112305
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.430 Vali Acc: 0.848 Test Loss: 0.430 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 4.324101209640503
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.431 Vali Acc: 0.841 Test Loss: 0.431 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 4.248761415481567
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.439 Vali Acc: 0.848 Test Loss: 0.439 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.9553496837615967
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.450 Vali Acc: 0.848 Test Loss: 0.450 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 4.075723171234131
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.445 Vali Acc: 0.848 Test Loss: 0.445 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 3.994485378265381
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.443 Vali Acc: 0.848 Test Loss: 0.443 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 4.1011903285980225
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.438 Vali Acc: 0.848 Test Loss: 0.438 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 3.7835488319396973
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.441 Vali Acc: 0.848 Test Loss: 0.441 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 4.078778982162476
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.443 Vali Acc: 0.848 Test Loss: 0.443 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 3.8324978351593018
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.451 Vali Acc: 0.841 Test Loss: 0.451 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df256_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 964868
model size : 8.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df256_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.522075414657593
Epoch: 1, Steps: 9 | Train Loss: 1.442 Vali Loss: 1.340 Vali Acc: 0.355 Test Loss: 1.340 Test Acc: 0.355
Validation loss decreased (inf --> -0.355059).  Saving model ...
Epoch: 2 cost time: 3.5979292392730713
Epoch: 2, Steps: 9 | Train Loss: 1.227 Vali Loss: 1.171 Vali Acc: 0.514 Test Loss: 1.171 Test Acc: 0.514
Validation loss decreased (-0.355059 --> -0.514481).  Saving model ...
Epoch: 3 cost time: 3.7503225803375244
Epoch: 3, Steps: 9 | Train Loss: 0.881 Vali Loss: 0.974 Vali Acc: 0.609 Test Loss: 0.974 Test Acc: 0.609
Validation loss decreased (-0.514481 --> -0.608686).  Saving model ...
Epoch: 4 cost time: 3.807851552963257
Epoch: 4, Steps: 9 | Train Loss: 0.571 Vali Loss: 0.870 Vali Acc: 0.681 Test Loss: 0.870 Test Acc: 0.681
Validation loss decreased (-0.608686 --> -0.681151).  Saving model ...
Epoch: 5 cost time: 3.9189443588256836
Epoch: 5, Steps: 9 | Train Loss: 0.341 Vali Loss: 0.790 Vali Acc: 0.652 Test Loss: 0.790 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.140156984329224
Epoch: 6, Steps: 9 | Train Loss: 0.236 Vali Loss: 0.719 Vali Acc: 0.696 Test Loss: 0.719 Test Acc: 0.696
Validation loss decreased (-0.681151 --> -0.695645).  Saving model ...
Epoch: 7 cost time: 4.354531526565552
Epoch: 7, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.698 Vali Acc: 0.703 Test Loss: 0.698 Test Acc: 0.703
Validation loss decreased (-0.695645 --> -0.702892).  Saving model ...
Epoch: 8 cost time: 4.427843809127808
Epoch: 8, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.582 Vali Acc: 0.739 Test Loss: 0.582 Test Acc: 0.739
Validation loss decreased (-0.702892 --> -0.739125).  Saving model ...
Epoch: 9 cost time: 4.129614353179932
Epoch: 9, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.649 Vali Acc: 0.739 Test Loss: 0.649 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.57342267036438
Epoch: 10, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.558 Vali Acc: 0.746 Test Loss: 0.558 Test Acc: 0.746
Validation loss decreased (-0.739125 --> -0.746371).  Saving model ...
Epoch: 11 cost time: 4.174713850021362
Epoch: 11, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.532 Vali Acc: 0.775 Test Loss: 0.532 Test Acc: 0.775
Validation loss decreased (-0.746371 --> -0.775357).  Saving model ...
Epoch: 12 cost time: 4.164587736129761
Epoch: 12, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.641 Vali Acc: 0.746 Test Loss: 0.641 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.265497922897339
Epoch: 13, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.554 Vali Acc: 0.768 Test Loss: 0.554 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.259461164474487
Epoch: 14, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.519 Vali Acc: 0.797 Test Loss: 0.519 Test Acc: 0.797
Validation loss decreased (-0.775357 --> -0.797096).  Saving model ...
Epoch: 15 cost time: 4.104540586471558
Epoch: 15, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.559 Vali Acc: 0.790 Test Loss: 0.559 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.093474388122559
Epoch: 16, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.568 Vali Acc: 0.775 Test Loss: 0.568 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.8640823364257812
Epoch: 17, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.542 Vali Acc: 0.790 Test Loss: 0.542 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.3944196701049805
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.533 Vali Acc: 0.790 Test Loss: 0.533 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.117124557495117
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.534 Vali Acc: 0.790 Test Loss: 0.534 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.09520149230957
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.550 Vali Acc: 0.783 Test Loss: 0.550 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.351088285446167
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.541 Vali Acc: 0.790 Test Loss: 0.541 Test Acc: 0.790
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.154800176620483
Epoch: 22, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.528 Vali Acc: 0.797 Test Loss: 0.528 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.8255417346954346
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.545 Vali Acc: 0.797 Test Loss: 0.545 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.414262771606445
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.555 Vali Acc: 0.783 Test Loss: 0.555 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df256_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7971014492753623
model parameter : 964868
model size : 8.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df256_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.264125108718872
Epoch: 1, Steps: 9 | Train Loss: 1.453 Vali Loss: 1.388 Vali Acc: 0.304 Test Loss: 1.388 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 3.966634750366211
Epoch: 2, Steps: 9 | Train Loss: 1.237 Vali Loss: 1.215 Vali Acc: 0.486 Test Loss: 1.215 Test Acc: 0.486
Validation loss decreased (-0.304334 --> -0.485495).  Saving model ...
Epoch: 3 cost time: 3.463982105255127
Epoch: 3, Steps: 9 | Train Loss: 0.908 Vali Loss: 1.034 Vali Acc: 0.580 Test Loss: 1.034 Test Acc: 0.580
Validation loss decreased (-0.485495 --> -0.579700).  Saving model ...
Epoch: 4 cost time: 3.5780386924743652
Epoch: 4, Steps: 9 | Train Loss: 0.578 Vali Loss: 0.930 Vali Acc: 0.623 Test Loss: 0.930 Test Acc: 0.623
Validation loss decreased (-0.579700 --> -0.623179).  Saving model ...
Epoch: 5 cost time: 4.265669822692871
Epoch: 5, Steps: 9 | Train Loss: 0.355 Vali Loss: 0.896 Vali Acc: 0.667 Test Loss: 0.896 Test Acc: 0.667
Validation loss decreased (-0.623179 --> -0.666658).  Saving model ...
Epoch: 6 cost time: 3.536853075027466
Epoch: 6, Steps: 9 | Train Loss: 0.231 Vali Loss: 0.808 Vali Acc: 0.688 Test Loss: 0.808 Test Acc: 0.688
Validation loss decreased (-0.666658 --> -0.688398).  Saving model ...
Epoch: 7 cost time: 3.7221498489379883
Epoch: 7, Steps: 9 | Train Loss: 0.146 Vali Loss: 0.839 Vali Acc: 0.717 Test Loss: 0.839 Test Acc: 0.717
Validation loss decreased (-0.688398 --> -0.717383).  Saving model ...
Epoch: 8 cost time: 3.869882345199585
Epoch: 8, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.800 Vali Acc: 0.710 Test Loss: 0.800 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.732168674468994
Epoch: 9, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.858 Vali Acc: 0.681 Test Loss: 0.858 Test Acc: 0.681
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.041162729263306
Epoch: 10, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.848 Vali Acc: 0.696 Test Loss: 0.848 Test Acc: 0.696
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.033403635025024
Epoch: 11, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.820 Vali Acc: 0.725 Test Loss: 0.820 Test Acc: 0.725
Validation loss decreased (-0.717383 --> -0.724629).  Saving model ...
Epoch: 12 cost time: 4.059316158294678
Epoch: 12, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.847 Vali Acc: 0.717 Test Loss: 0.847 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.1356518268585205
Epoch: 13, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.840 Vali Acc: 0.732 Test Loss: 0.840 Test Acc: 0.732
Validation loss decreased (-0.724629 --> -0.731876).  Saving model ...
Epoch: 14 cost time: 3.747685194015503
Epoch: 14, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.833 Vali Acc: 0.739 Test Loss: 0.833 Test Acc: 0.739
Validation loss decreased (-0.731876 --> -0.739122).  Saving model ...
Epoch: 15 cost time: 3.6287283897399902
Epoch: 15, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.823 Vali Acc: 0.739 Test Loss: 0.823 Test Acc: 0.739
Validation loss decreased (-0.739122 --> -0.739122).  Saving model ...
Epoch: 16 cost time: 4.103772878646851
Epoch: 16, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.843 Vali Acc: 0.739 Test Loss: 0.843 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.154134511947632
Epoch: 17, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.855 Vali Acc: 0.739 Test Loss: 0.855 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.844419002532959
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.833 Vali Acc: 0.739 Test Loss: 0.833 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.4911980628967285
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.844 Vali Acc: 0.732 Test Loss: 0.844 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.7887468338012695
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.858 Vali Acc: 0.739 Test Loss: 0.858 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.880082130432129
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.855 Vali Acc: 0.732 Test Loss: 0.855 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.6596436500549316
Epoch: 22, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.850 Vali Acc: 0.739 Test Loss: 0.850 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.095812559127808
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.853 Vali Acc: 0.732 Test Loss: 0.853 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.277891159057617
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.853 Vali Acc: 0.739 Test Loss: 0.853 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.9466207027435303
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.858 Vali Acc: 0.746 Test Loss: 0.858 Test Acc: 0.746
Validation loss decreased (-0.739122 --> -0.746368).  Saving model ...
Epoch: 26 cost time: 3.90386700630188
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.863 Vali Acc: 0.746 Test Loss: 0.863 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.014422416687012
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.864 Vali Acc: 0.739 Test Loss: 0.864 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.9553310871124268
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.856 Vali Acc: 0.746 Test Loss: 0.856 Test Acc: 0.746
Validation loss decreased (-0.746368 --> -0.746368).  Saving model ...
Epoch: 29 cost time: 3.8188328742980957
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.853 Vali Acc: 0.746 Test Loss: 0.853 Test Acc: 0.746
Validation loss decreased (-0.746368 --> -0.746368).  Saving model ...
Epoch: 30 cost time: 3.314127206802368
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.867 Vali Acc: 0.746 Test Loss: 0.867 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.7719886302948
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.870 Vali Acc: 0.746 Test Loss: 0.870 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.7067601680755615
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.864 Vali Acc: 0.746 Test Loss: 0.864 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.5592219829559326
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.864 Vali Acc: 0.746 Test Loss: 0.864 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.8147401809692383
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.867 Vali Acc: 0.739 Test Loss: 0.867 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.8968396186828613
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.874 Vali Acc: 0.739 Test Loss: 0.874 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.9159884452819824
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.874 Vali Acc: 0.739 Test Loss: 0.874 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.923556089401245
Epoch: 37, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.876 Vali Acc: 0.739 Test Loss: 0.876 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 4.238646030426025
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.871 Vali Acc: 0.754 Test Loss: 0.871 Test Acc: 0.754
Validation loss decreased (-0.746368 --> -0.753614).  Saving model ...
Epoch: 39 cost time: 4.177537441253662
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.865 Vali Acc: 0.739 Test Loss: 0.865 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 4.223018646240234
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.864 Vali Acc: 0.739 Test Loss: 0.864 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 4.2275917530059814
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.868 Vali Acc: 0.746 Test Loss: 0.868 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 4.035167217254639
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.874 Vali Acc: 0.746 Test Loss: 0.874 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 4.35779595375061
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.871 Vali Acc: 0.746 Test Loss: 0.871 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 4.164422035217285
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.875 Vali Acc: 0.746 Test Loss: 0.875 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 4.333764553070068
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.872 Vali Acc: 0.746 Test Loss: 0.872 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 3.7943286895751953
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.876 Vali Acc: 0.746 Test Loss: 0.876 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 3.8468923568725586
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.875 Vali Acc: 0.746 Test Loss: 0.875 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 3.9409828186035156
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.881 Vali Acc: 0.746 Test Loss: 0.881 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df256_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7536231884057971
model parameter : 964868
model size : 8.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.598800182342529
Epoch: 1, Steps: 9 | Train Loss: 1.443 Vali Loss: 1.455 Vali Acc: 0.217 Test Loss: 1.455 Test Acc: 0.217
Validation loss decreased (inf --> -0.217377).  Saving model ...
Epoch: 2 cost time: 3.692957639694214
Epoch: 2, Steps: 9 | Train Loss: 1.336 Vali Loss: 1.434 Vali Acc: 0.275 Test Loss: 1.434 Test Acc: 0.275
Validation loss decreased (-0.217377 --> -0.275348).  Saving model ...
Epoch: 3 cost time: 3.9581139087677
Epoch: 3, Steps: 9 | Train Loss: 1.044 Vali Loss: 1.369 Vali Acc: 0.355 Test Loss: 1.369 Test Acc: 0.355
Validation loss decreased (-0.275348 --> -0.355059).  Saving model ...
Epoch: 4 cost time: 4.033587694168091
Epoch: 4, Steps: 9 | Train Loss: 0.776 Vali Loss: 1.321 Vali Acc: 0.355 Test Loss: 1.321 Test Acc: 0.355
Validation loss decreased (-0.355059 --> -0.355059).  Saving model ...
Epoch: 5 cost time: 4.502022981643677
Epoch: 5, Steps: 9 | Train Loss: 0.537 Vali Loss: 1.330 Vali Acc: 0.370 Test Loss: 1.330 Test Acc: 0.370
Validation loss decreased (-0.355059 --> -0.369552).  Saving model ...
Epoch: 6 cost time: 4.176541805267334
Epoch: 6, Steps: 9 | Train Loss: 0.369 Vali Loss: 1.322 Vali Acc: 0.406 Test Loss: 1.322 Test Acc: 0.406
Validation loss decreased (-0.369552 --> -0.405784).  Saving model ...
Epoch: 7 cost time: 3.9118754863739014
Epoch: 7, Steps: 9 | Train Loss: 0.241 Vali Loss: 1.370 Vali Acc: 0.370 Test Loss: 1.370 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.948159694671631
Epoch: 8, Steps: 9 | Train Loss: 0.169 Vali Loss: 1.409 Vali Acc: 0.406 Test Loss: 1.409 Test Acc: 0.406
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.237625360488892
Epoch: 9, Steps: 9 | Train Loss: 0.096 Vali Loss: 1.449 Vali Acc: 0.413 Test Loss: 1.449 Test Acc: 0.413
Validation loss decreased (-0.405784 --> -0.413029).  Saving model ...
Epoch: 10 cost time: 3.880633592605591
Epoch: 10, Steps: 9 | Train Loss: 0.057 Vali Loss: 1.565 Vali Acc: 0.406 Test Loss: 1.565 Test Acc: 0.406
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.8222665786743164
Epoch: 11, Steps: 9 | Train Loss: 0.037 Vali Loss: 1.503 Vali Acc: 0.457 Test Loss: 1.503 Test Acc: 0.457
Validation loss decreased (-0.413029 --> -0.456507).  Saving model ...
Epoch: 12 cost time: 3.7522482872009277
Epoch: 12, Steps: 9 | Train Loss: 0.024 Vali Loss: 1.488 Vali Acc: 0.493 Test Loss: 1.488 Test Acc: 0.493
Validation loss decreased (-0.456507 --> -0.492739).  Saving model ...
Epoch: 13 cost time: 3.7237555980682373
Epoch: 13, Steps: 9 | Train Loss: 0.016 Vali Loss: 1.508 Vali Acc: 0.493 Test Loss: 1.508 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.80450177192688
Epoch: 14, Steps: 9 | Train Loss: 0.011 Vali Loss: 1.524 Vali Acc: 0.522 Test Loss: 1.524 Test Acc: 0.522
Validation loss decreased (-0.492739 --> -0.521724).  Saving model ...
Epoch: 15 cost time: 3.787655830383301
Epoch: 15, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.481 Vali Acc: 0.514 Test Loss: 1.481 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.590458631515503
Epoch: 16, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.503 Vali Acc: 0.529 Test Loss: 1.503 Test Acc: 0.529
Validation loss decreased (-0.521724 --> -0.528970).  Saving model ...
Epoch: 17 cost time: 3.816204071044922
Epoch: 17, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.594 Vali Acc: 0.493 Test Loss: 1.594 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.7115378379821777
Epoch: 18, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.530 Vali Acc: 0.536 Test Loss: 1.530 Test Acc: 0.536
Validation loss decreased (-0.528970 --> -0.536217).  Saving model ...
Epoch: 19 cost time: 3.8442177772521973
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.463 Vali Acc: 0.551 Test Loss: 1.463 Test Acc: 0.551
Validation loss decreased (-0.536217 --> -0.550710).  Saving model ...
Epoch: 20 cost time: 3.9834558963775635
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.446 Vali Acc: 0.543 Test Loss: 1.446 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.8350677490234375
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.482 Vali Acc: 0.536 Test Loss: 1.482 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.9302804470062256
Epoch: 22, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.495 Vali Acc: 0.543 Test Loss: 1.495 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.759448289871216
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.445 Vali Acc: 0.558 Test Loss: 1.445 Test Acc: 0.558
Validation loss decreased (-0.550710 --> -0.557957).  Saving model ...
Epoch: 24 cost time: 3.8600809574127197
Epoch: 24, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.442 Vali Acc: 0.572 Test Loss: 1.442 Test Acc: 0.572
Validation loss decreased (-0.557957 --> -0.572449).  Saving model ...
Epoch: 25 cost time: 3.8294637203216553
Epoch: 25, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.453 Vali Acc: 0.572 Test Loss: 1.453 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.792499303817749
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.449 Vali Acc: 0.572 Test Loss: 1.449 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.7067458629608154
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.443 Vali Acc: 0.572 Test Loss: 1.443 Test Acc: 0.572
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.002072334289551
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.461 Vali Acc: 0.565 Test Loss: 1.461 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.8295531272888184
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.455 Vali Acc: 0.572 Test Loss: 1.455 Test Acc: 0.572
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.756300926208496
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.433 Vali Acc: 0.572 Test Loss: 1.433 Test Acc: 0.572
Validation loss decreased (-0.572449 --> -0.572449).  Saving model ...
Epoch: 31 cost time: 3.677565813064575
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.427 Vali Acc: 0.572 Test Loss: 1.427 Test Acc: 0.572
Validation loss decreased (-0.572449 --> -0.572449).  Saving model ...
Epoch: 32 cost time: 3.778360605239868
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.459 Vali Acc: 0.572 Test Loss: 1.459 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.4642553329467773
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.474 Vali Acc: 0.572 Test Loss: 1.474 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.907505750656128
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.478 Vali Acc: 0.572 Test Loss: 1.478 Test Acc: 0.572
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.7318060398101807
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.468 Vali Acc: 0.572 Test Loss: 1.468 Test Acc: 0.572
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.988527297973633
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.477 Vali Acc: 0.580 Test Loss: 1.477 Test Acc: 0.580
Validation loss decreased (-0.572449 --> -0.579695).  Saving model ...
Epoch: 37 cost time: 3.9304065704345703
Epoch: 37, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.462 Vali Acc: 0.580 Test Loss: 1.462 Test Acc: 0.580
Validation loss decreased (-0.579695 --> -0.579696).  Saving model ...
Epoch: 38 cost time: 4.142825126647949
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.455 Vali Acc: 0.587 Test Loss: 1.455 Test Acc: 0.587
Validation loss decreased (-0.579696 --> -0.586942).  Saving model ...
Epoch: 39 cost time: 4.0227367877960205
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.462 Vali Acc: 0.594 Test Loss: 1.462 Test Acc: 0.594
Validation loss decreased (-0.586942 --> -0.594188).  Saving model ...
Epoch: 40 cost time: 3.9395172595977783
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.447 Vali Acc: 0.601 Test Loss: 1.447 Test Acc: 0.601
Validation loss decreased (-0.594188 --> -0.601435).  Saving model ...
Epoch: 41 cost time: 4.007242441177368
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.445 Vali Acc: 0.609 Test Loss: 1.445 Test Acc: 0.609
Validation loss decreased (-0.601435 --> -0.608681).  Saving model ...
Epoch: 42 cost time: 4.073716402053833
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.449 Vali Acc: 0.601 Test Loss: 1.449 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 4.257928848266602
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.460 Vali Acc: 0.609 Test Loss: 1.460 Test Acc: 0.609
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 4.168316841125488
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.469 Vali Acc: 0.609 Test Loss: 1.469 Test Acc: 0.609
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.7932748794555664
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.467 Vali Acc: 0.609 Test Loss: 1.467 Test Acc: 0.609
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 4.224138021469116
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.466 Vali Acc: 0.609 Test Loss: 1.466 Test Acc: 0.609
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 3.7531204223632812
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.468 Vali Acc: 0.616 Test Loss: 1.468 Test Acc: 0.616
Validation loss decreased (-0.608681 --> -0.615927).  Saving model ...
Epoch: 48 cost time: 4.1030988693237305
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.466 Vali Acc: 0.616 Test Loss: 1.466 Test Acc: 0.616
Validation loss decreased (-0.615927 --> -0.615927).  Saving model ...
Epoch: 49 cost time: 4.2139458656311035
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.474 Vali Acc: 0.616 Test Loss: 1.474 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.8396944999694824
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.476 Vali Acc: 0.616 Test Loss: 1.476 Test Acc: 0.616
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 4.473681449890137
Epoch: 51, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.458 Vali Acc: 0.623 Test Loss: 1.458 Test Acc: 0.623
Validation loss decreased (-0.615927 --> -0.623174).  Saving model ...
Epoch: 52 cost time: 5.036187648773193
Epoch: 52, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.462 Vali Acc: 0.630 Test Loss: 1.462 Test Acc: 0.630
Validation loss decreased (-0.623174 --> -0.630420).  Saving model ...
Epoch: 53 cost time: 4.631599426269531
Epoch: 53, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.469 Vali Acc: 0.630 Test Loss: 1.469 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 4.314608812332153
Epoch: 54, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.477 Vali Acc: 0.630 Test Loss: 1.477 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 4.327589750289917
Epoch: 55, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.486 Vali Acc: 0.623 Test Loss: 1.486 Test Acc: 0.623
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 4.7598936557769775
Epoch: 56, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.480 Vali Acc: 0.630 Test Loss: 1.480 Test Acc: 0.630
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 4.478238821029663
Epoch: 57, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.476 Vali Acc: 0.638 Test Loss: 1.476 Test Acc: 0.638
Validation loss decreased (-0.630420 --> -0.637666).  Saving model ...
Epoch: 58 cost time: 4.6464807987213135
Epoch: 58, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.472 Vali Acc: 0.638 Test Loss: 1.472 Test Acc: 0.638
Validation loss decreased (-0.637666 --> -0.637666).  Saving model ...
Epoch: 59 cost time: 4.774581670761108
Epoch: 59, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.469 Vali Acc: 0.638 Test Loss: 1.469 Test Acc: 0.638
Validation loss decreased (-0.637666 --> -0.637666).  Saving model ...
Epoch: 60 cost time: 4.451628923416138
Epoch: 60, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.473 Vali Acc: 0.638 Test Loss: 1.473 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 4.387321710586548
Epoch: 61, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.474 Vali Acc: 0.638 Test Loss: 1.474 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 4.105349779129028
Epoch: 62, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.477 Vali Acc: 0.638 Test Loss: 1.477 Test Acc: 0.638
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 4.102354288101196
Epoch: 63, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.477 Vali Acc: 0.638 Test Loss: 1.477 Test Acc: 0.638
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 4.062398433685303
Epoch: 64, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.480 Vali Acc: 0.638 Test Loss: 1.480 Test Acc: 0.638
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 4.082505941390991
Epoch: 65, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.481 Vali Acc: 0.638 Test Loss: 1.481 Test Acc: 0.638
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 4.328263282775879
Epoch: 66, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.482 Vali Acc: 0.638 Test Loss: 1.482 Test Acc: 0.638
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 4.061729669570923
Epoch: 67, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.478 Vali Acc: 0.638 Test Loss: 1.478 Test Acc: 0.638
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 4.322251081466675
Epoch: 68, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.483 Vali Acc: 0.638 Test Loss: 1.483 Test Acc: 0.638
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 4.323235750198364
Epoch: 69, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.497 Vali Acc: 0.630 Test Loss: 1.497 Test Acc: 0.630
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.6376811594202898
model parameter : 964868
model size : 8.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.67883825302124
Epoch: 1, Steps: 9 | Train Loss: 1.470 Vali Loss: 1.396 Vali Acc: 0.326 Test Loss: 1.396 Test Acc: 0.326
Validation loss decreased (inf --> -0.326073).  Saving model ...
Epoch: 2 cost time: 3.5811667442321777
Epoch: 2, Steps: 9 | Train Loss: 1.365 Vali Loss: 1.467 Vali Acc: 0.304 Test Loss: 1.467 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.5183093547821045
Epoch: 3, Steps: 9 | Train Loss: 1.206 Vali Loss: 1.420 Vali Acc: 0.304 Test Loss: 1.420 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.5829830169677734
Epoch: 4, Steps: 9 | Train Loss: 0.994 Vali Loss: 1.511 Vali Acc: 0.304 Test Loss: 1.511 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.9123611450195312
Epoch: 5, Steps: 9 | Train Loss: 0.789 Vali Loss: 1.587 Vali Acc: 0.290 Test Loss: 1.587 Test Acc: 0.290
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.4744322299957275
Epoch: 6, Steps: 9 | Train Loss: 0.641 Vali Loss: 1.780 Vali Acc: 0.304 Test Loss: 1.780 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.598465919494629
Epoch: 7, Steps: 9 | Train Loss: 0.449 Vali Loss: 1.991 Vali Acc: 0.297 Test Loss: 1.991 Test Acc: 0.297
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.8925490379333496
Epoch: 8, Steps: 9 | Train Loss: 0.349 Vali Loss: 2.171 Vali Acc: 0.326 Test Loss: 2.171 Test Acc: 0.326
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.5101773738861084
Epoch: 9, Steps: 9 | Train Loss: 0.220 Vali Loss: 2.476 Vali Acc: 0.312 Test Loss: 2.476 Test Acc: 0.312
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.6057980060577393
Epoch: 10, Steps: 9 | Train Loss: 0.146 Vali Loss: 2.516 Vali Acc: 0.326 Test Loss: 2.516 Test Acc: 0.326
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.5398380756378174
Epoch: 11, Steps: 9 | Train Loss: 0.110 Vali Loss: 2.744 Vali Acc: 0.297 Test Loss: 2.744 Test Acc: 0.297
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.32608695652173914
model parameter : 964868
model size : 8.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.653932809829712
Epoch: 1, Steps: 9 | Train Loss: 1.459 Vali Loss: 1.420 Vali Acc: 0.297 Test Loss: 1.420 Test Acc: 0.297
Validation loss decreased (inf --> -0.297087).  Saving model ...
Epoch: 2 cost time: 3.953329086303711
Epoch: 2, Steps: 9 | Train Loss: 1.343 Vali Loss: 1.455 Vali Acc: 0.275 Test Loss: 1.455 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.8821516036987305
Epoch: 3, Steps: 9 | Train Loss: 1.145 Vali Loss: 1.366 Vali Acc: 0.297 Test Loss: 1.366 Test Acc: 0.297
Validation loss decreased (-0.297087 --> -0.297088).  Saving model ...
Epoch: 4 cost time: 3.9010469913482666
Epoch: 4, Steps: 9 | Train Loss: 0.927 Vali Loss: 1.363 Vali Acc: 0.312 Test Loss: 1.363 Test Acc: 0.312
Validation loss decreased (-0.297088 --> -0.311581).  Saving model ...
Epoch: 5 cost time: 3.8502421379089355
Epoch: 5, Steps: 9 | Train Loss: 0.721 Vali Loss: 1.380 Vali Acc: 0.333 Test Loss: 1.380 Test Acc: 0.333
Validation loss decreased (-0.311581 --> -0.333320).  Saving model ...
Epoch: 6 cost time: 4.040661811828613
Epoch: 6, Steps: 9 | Train Loss: 0.570 Vali Loss: 1.444 Vali Acc: 0.341 Test Loss: 1.444 Test Acc: 0.341
Validation loss decreased (-0.333320 --> -0.340565).  Saving model ...
Epoch: 7 cost time: 3.8381757736206055
Epoch: 7, Steps: 9 | Train Loss: 0.380 Vali Loss: 1.473 Vali Acc: 0.355 Test Loss: 1.473 Test Acc: 0.355
Validation loss decreased (-0.340565 --> -0.355058).  Saving model ...
Epoch: 8 cost time: 3.893293619155884
Epoch: 8, Steps: 9 | Train Loss: 0.268 Vali Loss: 1.531 Vali Acc: 0.312 Test Loss: 1.531 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.6533398628234863
Epoch: 9, Steps: 9 | Train Loss: 0.165 Vali Loss: 1.713 Vali Acc: 0.341 Test Loss: 1.713 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.8538882732391357
Epoch: 10, Steps: 9 | Train Loss: 0.110 Vali Loss: 1.748 Vali Acc: 0.341 Test Loss: 1.748 Test Acc: 0.341
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.7491941452026367
Epoch: 11, Steps: 9 | Train Loss: 0.063 Vali Loss: 1.696 Vali Acc: 0.341 Test Loss: 1.696 Test Acc: 0.341
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.787588357925415
Epoch: 12, Steps: 9 | Train Loss: 0.048 Vali Loss: 1.613 Vali Acc: 0.355 Test Loss: 1.613 Test Acc: 0.355
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.899219274520874
Epoch: 13, Steps: 9 | Train Loss: 0.032 Vali Loss: 1.685 Vali Acc: 0.362 Test Loss: 1.685 Test Acc: 0.362
Validation loss decreased (-0.355058 --> -0.362302).  Saving model ...
Epoch: 14 cost time: 4.21374773979187
Epoch: 14, Steps: 9 | Train Loss: 0.019 Vali Loss: 1.581 Vali Acc: 0.384 Test Loss: 1.581 Test Acc: 0.384
Validation loss decreased (-0.362302 --> -0.384042).  Saving model ...
Epoch: 15 cost time: 4.395193815231323
Epoch: 15, Steps: 9 | Train Loss: 0.014 Vali Loss: 1.671 Vali Acc: 0.384 Test Loss: 1.671 Test Acc: 0.384
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.233449697494507
Epoch: 16, Steps: 9 | Train Loss: 0.013 Vali Loss: 1.691 Vali Acc: 0.406 Test Loss: 1.691 Test Acc: 0.406
Validation loss decreased (-0.384042 --> -0.405780).  Saving model ...
Epoch: 17 cost time: 4.266880750656128
Epoch: 17, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.598 Vali Acc: 0.413 Test Loss: 1.598 Test Acc: 0.413
Validation loss decreased (-0.405780 --> -0.413028).  Saving model ...
Epoch: 18 cost time: 4.068126440048218
Epoch: 18, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.581 Vali Acc: 0.428 Test Loss: 1.581 Test Acc: 0.428
Validation loss decreased (-0.413028 --> -0.427520).  Saving model ...
Epoch: 19 cost time: 4.053481340408325
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.593 Vali Acc: 0.435 Test Loss: 1.593 Test Acc: 0.435
Validation loss decreased (-0.427520 --> -0.434767).  Saving model ...
Epoch: 20 cost time: 4.450757741928101
Epoch: 20, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.612 Vali Acc: 0.435 Test Loss: 1.612 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.15026330947876
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.606 Vali Acc: 0.428 Test Loss: 1.606 Test Acc: 0.428
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.0021326541900635
Epoch: 22, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.599 Vali Acc: 0.464 Test Loss: 1.599 Test Acc: 0.464
Validation loss decreased (-0.434767 --> -0.463752).  Saving model ...
Epoch: 23 cost time: 3.814542055130005
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.569 Vali Acc: 0.471 Test Loss: 1.569 Test Acc: 0.471
Validation loss decreased (-0.463752 --> -0.470999).  Saving model ...
Epoch: 24 cost time: 3.9916765689849854
Epoch: 24, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.544 Vali Acc: 0.493 Test Loss: 1.544 Test Acc: 0.493
Validation loss decreased (-0.470999 --> -0.492738).  Saving model ...
Epoch: 25 cost time: 3.9072697162628174
Epoch: 25, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.532 Vali Acc: 0.486 Test Loss: 1.532 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.025467395782471
Epoch: 26, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.581 Vali Acc: 0.486 Test Loss: 1.581 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.9858100414276123
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.598 Vali Acc: 0.486 Test Loss: 1.598 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.8360729217529297
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.595 Vali Acc: 0.486 Test Loss: 1.595 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.085293769836426
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.554 Vali Acc: 0.493 Test Loss: 1.554 Test Acc: 0.493
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.5551230907440186
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.520 Vali Acc: 0.514 Test Loss: 1.520 Test Acc: 0.514
Validation loss decreased (-0.492738 --> -0.514478).  Saving model ...
Epoch: 31 cost time: 4.041838884353638
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.514 Vali Acc: 0.536 Test Loss: 1.514 Test Acc: 0.536
Validation loss decreased (-0.514478 --> -0.536217).  Saving model ...
Epoch: 32 cost time: 4.380475044250488
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.547 Vali Acc: 0.536 Test Loss: 1.547 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 4.236302375793457
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.541 Vali Acc: 0.536 Test Loss: 1.541 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 4.111150741577148
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.536 Vali Acc: 0.558 Test Loss: 1.536 Test Acc: 0.558
Validation loss decreased (-0.536217 --> -0.557956).  Saving model ...
Epoch: 35 cost time: 4.1300318241119385
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.520 Vali Acc: 0.551 Test Loss: 1.520 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 4.221676826477051
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.542 Vali Acc: 0.529 Test Loss: 1.542 Test Acc: 0.529
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 4.338480710983276
Epoch: 37, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.552 Vali Acc: 0.529 Test Loss: 1.552 Test Acc: 0.529
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 4.342479467391968
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.576 Vali Acc: 0.543 Test Loss: 1.576 Test Acc: 0.543
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.9861316680908203
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.571 Vali Acc: 0.551 Test Loss: 1.571 Test Acc: 0.551
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.7743515968322754
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.559 Vali Acc: 0.565 Test Loss: 1.559 Test Acc: 0.565
Validation loss decreased (-0.557956 --> -0.565202).  Saving model ...
Epoch: 41 cost time: 4.254775047302246
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.564 Vali Acc: 0.558 Test Loss: 1.564 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 4.143901348114014
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.545 Vali Acc: 0.558 Test Loss: 1.545 Test Acc: 0.558
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.714453935623169
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.543 Vali Acc: 0.551 Test Loss: 1.543 Test Acc: 0.551
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 4.067261457443237
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.541 Vali Acc: 0.551 Test Loss: 1.541 Test Acc: 0.551
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 4.012950897216797
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.566 Vali Acc: 0.543 Test Loss: 1.566 Test Acc: 0.543
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 4.136625051498413
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.588 Vali Acc: 0.543 Test Loss: 1.588 Test Acc: 0.543
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 4.21557092666626
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.601 Vali Acc: 0.551 Test Loss: 1.601 Test Acc: 0.551
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 4.196951866149902
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.605 Vali Acc: 0.558 Test Loss: 1.605 Test Acc: 0.558
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 4.087467908859253
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.604 Vali Acc: 0.558 Test Loss: 1.604 Test Acc: 0.558
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 4.37498664855957
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.601 Vali Acc: 0.565 Test Loss: 1.601 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5652173913043478
model parameter : 964868
model size : 8.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         103                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df128_ma103_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.831040382385254
Epoch: 1, Steps: 9 | Train Loss: 1.366 Vali Loss: 1.283 Vali Acc: 0.464 Test Loss: 1.283 Test Acc: 0.464
Validation loss decreased (inf --> -0.463755).  Saving model ...
Epoch: 2 cost time: 3.711960792541504
Epoch: 2, Steps: 9 | Train Loss: 1.155 Vali Loss: 1.113 Vali Acc: 0.536 Test Loss: 1.113 Test Acc: 0.536
Validation loss decreased (-0.463755 --> -0.536221).  Saving model ...
Epoch: 3 cost time: 3.82236385345459
Epoch: 3, Steps: 9 | Train Loss: 0.801 Vali Loss: 0.912 Vali Acc: 0.688 Test Loss: 0.912 Test Acc: 0.688
Validation loss decreased (-0.536221 --> -0.688397).  Saving model ...
Epoch: 4 cost time: 3.7690460681915283
Epoch: 4, Steps: 9 | Train Loss: 0.516 Vali Loss: 0.829 Vali Acc: 0.681 Test Loss: 0.829 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.9968421459198
Epoch: 5, Steps: 9 | Train Loss: 0.294 Vali Loss: 0.826 Vali Acc: 0.674 Test Loss: 0.826 Test Acc: 0.674
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.7835190296173096
Epoch: 6, Steps: 9 | Train Loss: 0.172 Vali Loss: 0.705 Vali Acc: 0.746 Test Loss: 0.705 Test Acc: 0.746
Validation loss decreased (-0.688397 --> -0.746370).  Saving model ...
Epoch: 7 cost time: 3.8569698333740234
Epoch: 7, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.708 Vali Acc: 0.754 Test Loss: 0.708 Test Acc: 0.754
Validation loss decreased (-0.746370 --> -0.753616).  Saving model ...
Epoch: 8 cost time: 4.022953987121582
Epoch: 8, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.676 Vali Acc: 0.775 Test Loss: 0.676 Test Acc: 0.775
Validation loss decreased (-0.753616 --> -0.775356).  Saving model ...
Epoch: 9 cost time: 4.098603248596191
Epoch: 9, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.720 Vali Acc: 0.768 Test Loss: 0.720 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.0574095249176025
Epoch: 10, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.722 Vali Acc: 0.775 Test Loss: 0.722 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.88854718208313
Epoch: 11, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.656 Vali Acc: 0.775 Test Loss: 0.656 Test Acc: 0.775
Validation loss decreased (-0.775356 --> -0.775356).  Saving model ...
Epoch: 12 cost time: 4.126044273376465
Epoch: 12, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.742 Vali Acc: 0.783 Test Loss: 0.742 Test Acc: 0.783
Validation loss decreased (-0.775356 --> -0.782601).  Saving model ...
Epoch: 13 cost time: 3.9602742195129395
Epoch: 13, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.741 Vali Acc: 0.768 Test Loss: 0.741 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.07276177406311
Epoch: 14, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.697 Vali Acc: 0.761 Test Loss: 0.697 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.143543720245361
Epoch: 15, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.685 Vali Acc: 0.775 Test Loss: 0.685 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.127179145812988
Epoch: 16, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.742 Vali Acc: 0.775 Test Loss: 0.742 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.1497275829315186
Epoch: 17, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.746 Vali Acc: 0.775 Test Loss: 0.746 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.8645401000976562
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.720 Vali Acc: 0.768 Test Loss: 0.720 Test Acc: 0.768
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.963564395904541
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.723 Vali Acc: 0.768 Test Loss: 0.723 Test Acc: 0.768
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.22800874710083
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.741 Vali Acc: 0.775 Test Loss: 0.741 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.757371187210083
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.734 Vali Acc: 0.768 Test Loss: 0.734 Test Acc: 0.768
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.469186782836914
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.730 Vali Acc: 0.775 Test Loss: 0.730 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df128_ma103_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.782608695652174
model parameter : 866564
model size : 8.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         83                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df128_ma83_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.073421239852905
Epoch: 1, Steps: 9 | Train Loss: 1.374 Vali Loss: 1.287 Vali Acc: 0.471 Test Loss: 1.287 Test Acc: 0.471
Validation loss decreased (inf --> -0.471002).  Saving model ...
Epoch: 2 cost time: 4.184079170227051
Epoch: 2, Steps: 9 | Train Loss: 1.156 Vali Loss: 1.117 Vali Acc: 0.551 Test Loss: 1.117 Test Acc: 0.551
Validation loss decreased (-0.471002 --> -0.550713).  Saving model ...
Epoch: 3 cost time: 4.2644312381744385
Epoch: 3, Steps: 9 | Train Loss: 0.813 Vali Loss: 0.918 Vali Acc: 0.703 Test Loss: 0.918 Test Acc: 0.703
Validation loss decreased (-0.550713 --> -0.702889).  Saving model ...
Epoch: 4 cost time: 4.428913831710815
Epoch: 4, Steps: 9 | Train Loss: 0.529 Vali Loss: 0.834 Vali Acc: 0.688 Test Loss: 0.834 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.425144910812378
Epoch: 5, Steps: 9 | Train Loss: 0.304 Vali Loss: 0.834 Vali Acc: 0.674 Test Loss: 0.834 Test Acc: 0.674
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.184572696685791
Epoch: 6, Steps: 9 | Train Loss: 0.177 Vali Loss: 0.706 Vali Acc: 0.761 Test Loss: 0.706 Test Acc: 0.761
Validation loss decreased (-0.702889 --> -0.760863).  Saving model ...
Epoch: 7 cost time: 4.14590048789978
Epoch: 7, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.678 Vali Acc: 0.768 Test Loss: 0.678 Test Acc: 0.768
Validation loss decreased (-0.760863 --> -0.768109).  Saving model ...
Epoch: 8 cost time: 3.80916166305542
Epoch: 8, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.665 Vali Acc: 0.768 Test Loss: 0.665 Test Acc: 0.768
Validation loss decreased (-0.768109 --> -0.768109).  Saving model ...
Epoch: 9 cost time: 4.140639066696167
Epoch: 9, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.705 Vali Acc: 0.775 Test Loss: 0.705 Test Acc: 0.775
Validation loss decreased (-0.768109 --> -0.775355).  Saving model ...
Epoch: 10 cost time: 3.6788556575775146
Epoch: 10, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.694 Vali Acc: 0.783 Test Loss: 0.694 Test Acc: 0.783
Validation loss decreased (-0.775355 --> -0.782602).  Saving model ...
Epoch: 11 cost time: 4.04389762878418
Epoch: 11, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.614 Vali Acc: 0.775 Test Loss: 0.614 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.7812447547912598
Epoch: 12, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.737 Vali Acc: 0.768 Test Loss: 0.737 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.9803531169891357
Epoch: 13, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.714 Vali Acc: 0.761 Test Loss: 0.714 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.9714672565460205
Epoch: 14, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.646 Vali Acc: 0.797 Test Loss: 0.646 Test Acc: 0.797
Validation loss decreased (-0.782602 --> -0.797095).  Saving model ...
Epoch: 15 cost time: 4.28394627571106
Epoch: 15, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.646 Vali Acc: 0.790 Test Loss: 0.646 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.145993709564209
Epoch: 16, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.718 Vali Acc: 0.761 Test Loss: 0.718 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.108551025390625
Epoch: 17, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.722 Vali Acc: 0.768 Test Loss: 0.722 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.397365093231201
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.683 Vali Acc: 0.790 Test Loss: 0.683 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.241690158843994
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.690 Vali Acc: 0.783 Test Loss: 0.690 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.296545505523682
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.707 Vali Acc: 0.775 Test Loss: 0.707 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.476587772369385
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.697 Vali Acc: 0.783 Test Loss: 0.697 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.671220541000366
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.686 Vali Acc: 0.797 Test Loss: 0.686 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.1636412143707275
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.688 Vali Acc: 0.797 Test Loss: 0.688 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.745131015777588
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.680 Vali Acc: 0.804 Test Loss: 0.680 Test Acc: 0.804
Validation loss decreased (-0.797095 --> -0.804341).  Saving model ...
Epoch: 25 cost time: 3.957141637802124
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.708 Vali Acc: 0.790 Test Loss: 0.708 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.810145854949951
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.687 Vali Acc: 0.804 Test Loss: 0.687 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.9638915061950684
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.688 Vali Acc: 0.804 Test Loss: 0.688 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.051681995391846
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.690 Vali Acc: 0.804 Test Loss: 0.690 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.152153730392456
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.706 Vali Acc: 0.804 Test Loss: 0.706 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.545441627502441
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.710 Vali Acc: 0.804 Test Loss: 0.710 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 4.113726377487183
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.696 Vali Acc: 0.804 Test Loss: 0.696 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 4.775116920471191
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.702 Vali Acc: 0.804 Test Loss: 0.702 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.9582858085632324
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.701 Vali Acc: 0.804 Test Loss: 0.701 Test Acc: 0.804
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 4.22249436378479
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.704 Vali Acc: 0.804 Test Loss: 0.704 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df128_ma83_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8043478260869565
model parameter : 866564
model size : 8.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         62                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df128_ma62_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.022316217422485
Epoch: 1, Steps: 9 | Train Loss: 1.377 Vali Loss: 1.298 Vali Acc: 0.435 Test Loss: 1.298 Test Acc: 0.435
Validation loss decreased (inf --> -0.434770).  Saving model ...
Epoch: 2 cost time: 4.16198468208313
Epoch: 2, Steps: 9 | Train Loss: 1.153 Vali Loss: 1.134 Vali Acc: 0.543 Test Loss: 1.134 Test Acc: 0.543
Validation loss decreased (-0.434770 --> -0.543467).  Saving model ...
Epoch: 3 cost time: 4.240851402282715
Epoch: 3, Steps: 9 | Train Loss: 0.809 Vali Loss: 0.937 Vali Acc: 0.681 Test Loss: 0.937 Test Acc: 0.681
Validation loss decreased (-0.543467 --> -0.681150).  Saving model ...
Epoch: 4 cost time: 3.6718928813934326
Epoch: 4, Steps: 9 | Train Loss: 0.517 Vali Loss: 0.861 Vali Acc: 0.681 Test Loss: 0.861 Test Acc: 0.681
Validation loss decreased (-0.681150 --> -0.681151).  Saving model ...
Epoch: 5 cost time: 4.180974006652832
Epoch: 5, Steps: 9 | Train Loss: 0.293 Vali Loss: 0.832 Vali Acc: 0.696 Test Loss: 0.832 Test Acc: 0.696
Validation loss decreased (-0.681151 --> -0.695644).  Saving model ...
Epoch: 6 cost time: 3.8760390281677246
Epoch: 6, Steps: 9 | Train Loss: 0.165 Vali Loss: 0.751 Vali Acc: 0.761 Test Loss: 0.751 Test Acc: 0.761
Validation loss decreased (-0.695644 --> -0.760862).  Saving model ...
Epoch: 7 cost time: 4.002323389053345
Epoch: 7, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.690 Vali Acc: 0.775 Test Loss: 0.690 Test Acc: 0.775
Validation loss decreased (-0.760862 --> -0.775355).  Saving model ...
Epoch: 8 cost time: 3.9968254566192627
Epoch: 8, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.702 Vali Acc: 0.783 Test Loss: 0.702 Test Acc: 0.783
Validation loss decreased (-0.775355 --> -0.782602).  Saving model ...
Epoch: 9 cost time: 4.203206300735474
Epoch: 9, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.703 Vali Acc: 0.783 Test Loss: 0.703 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.453803539276123
Epoch: 10, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.727 Vali Acc: 0.783 Test Loss: 0.727 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.719421625137329
Epoch: 11, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.646 Vali Acc: 0.797 Test Loss: 0.646 Test Acc: 0.797
Validation loss decreased (-0.782602 --> -0.797095).  Saving model ...
Epoch: 12 cost time: 4.0369086265563965
Epoch: 12, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.737 Vali Acc: 0.804 Test Loss: 0.737 Test Acc: 0.804
Validation loss decreased (-0.797095 --> -0.804340).  Saving model ...
Epoch: 13 cost time: 3.8997411727905273
Epoch: 13, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.729 Vali Acc: 0.790 Test Loss: 0.729 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.138790845870972
Epoch: 14, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.664 Vali Acc: 0.790 Test Loss: 0.664 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.988866090774536
Epoch: 15, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.662 Vali Acc: 0.790 Test Loss: 0.662 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.355148553848267
Epoch: 16, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.738 Vali Acc: 0.804 Test Loss: 0.738 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.104878187179565
Epoch: 17, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.736 Vali Acc: 0.804 Test Loss: 0.736 Test Acc: 0.804
Validation loss decreased (-0.804340 --> -0.804340).  Saving model ...
Epoch: 18 cost time: 4.192984104156494
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.696 Vali Acc: 0.790 Test Loss: 0.696 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.250096082687378
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.700 Vali Acc: 0.790 Test Loss: 0.700 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.440746307373047
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.708 Vali Acc: 0.790 Test Loss: 0.708 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.331889629364014
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.710 Vali Acc: 0.790 Test Loss: 0.710 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.05065655708313
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.708 Vali Acc: 0.797 Test Loss: 0.708 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.37198281288147
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.700 Vali Acc: 0.797 Test Loss: 0.700 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.320110321044922
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.689 Vali Acc: 0.812 Test Loss: 0.689 Test Acc: 0.812
Validation loss decreased (-0.804340 --> -0.811587).  Saving model ...
Epoch: 25 cost time: 4.21453070640564
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.708 Vali Acc: 0.790 Test Loss: 0.708 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.098944187164307
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.697 Vali Acc: 0.819 Test Loss: 0.697 Test Acc: 0.819
Validation loss decreased (-0.811587 --> -0.818834).  Saving model ...
Epoch: 27 cost time: 4.176814794540405
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.701 Vali Acc: 0.819 Test Loss: 0.701 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.275181293487549
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.698 Vali Acc: 0.804 Test Loss: 0.698 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.195148706436157
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.714 Vali Acc: 0.804 Test Loss: 0.714 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.3630475997924805
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.719 Vali Acc: 0.812 Test Loss: 0.719 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 4.517839193344116
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.704 Vali Acc: 0.819 Test Loss: 0.704 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 4.19045877456665
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.707 Vali Acc: 0.819 Test Loss: 0.707 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 4.3922858238220215
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.703 Vali Acc: 0.812 Test Loss: 0.703 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 4.587398529052734
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.705 Vali Acc: 0.826 Test Loss: 0.705 Test Acc: 0.826
Validation loss decreased (-0.818834 --> -0.826080).  Saving model ...
Epoch: 35 cost time: 4.135747194290161
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.711 Vali Acc: 0.826 Test Loss: 0.711 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 4.273088455200195
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.717 Vali Acc: 0.826 Test Loss: 0.717 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 4.181841850280762
Epoch: 37, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.725 Vali Acc: 0.819 Test Loss: 0.725 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 4.233678102493286
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.724 Vali Acc: 0.826 Test Loss: 0.724 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 4.247670888900757
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.725 Vali Acc: 0.826 Test Loss: 0.725 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 4.064856290817261
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.725 Vali Acc: 0.826 Test Loss: 0.725 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 4.292663812637329
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.730 Vali Acc: 0.826 Test Loss: 0.730 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 4.412588119506836
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.737 Vali Acc: 0.826 Test Loss: 0.737 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 4.102829456329346
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.730 Vali Acc: 0.819 Test Loss: 0.730 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 4.25942850112915
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.725 Vali Acc: 0.826 Test Loss: 0.725 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df128_ma62_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8260869565217391
model parameter : 866564
model size : 8.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         42                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df128_ma42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.887997388839722
Epoch: 1, Steps: 9 | Train Loss: 1.395 Vali Loss: 1.321 Vali Acc: 0.377 Test Loss: 1.321 Test Acc: 0.377
Validation loss decreased (inf --> -0.376798).  Saving model ...
Epoch: 2 cost time: 3.9819672107696533
Epoch: 2, Steps: 9 | Train Loss: 1.166 Vali Loss: 1.115 Vali Acc: 0.514 Test Loss: 1.115 Test Acc: 0.514
Validation loss decreased (-0.376798 --> -0.514482).  Saving model ...
Epoch: 3 cost time: 4.275120258331299
Epoch: 3, Steps: 9 | Train Loss: 0.785 Vali Loss: 0.894 Vali Acc: 0.681 Test Loss: 0.894 Test Acc: 0.681
Validation loss decreased (-0.514482 --> -0.681150).  Saving model ...
Epoch: 4 cost time: 4.23711085319519
Epoch: 4, Steps: 9 | Train Loss: 0.496 Vali Loss: 0.821 Vali Acc: 0.681 Test Loss: 0.821 Test Acc: 0.681
Validation loss decreased (-0.681150 --> -0.681151).  Saving model ...
Epoch: 5 cost time: 3.7193942070007324
Epoch: 5, Steps: 9 | Train Loss: 0.282 Vali Loss: 0.786 Vali Acc: 0.725 Test Loss: 0.786 Test Acc: 0.725
Validation loss decreased (-0.681151 --> -0.724630).  Saving model ...
Epoch: 6 cost time: 3.6684858798980713
Epoch: 6, Steps: 9 | Train Loss: 0.165 Vali Loss: 0.684 Vali Acc: 0.739 Test Loss: 0.684 Test Acc: 0.739
Validation loss decreased (-0.724630 --> -0.739124).  Saving model ...
Epoch: 7 cost time: 3.637275457382202
Epoch: 7, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.676 Vali Acc: 0.768 Test Loss: 0.676 Test Acc: 0.768
Validation loss decreased (-0.739124 --> -0.768109).  Saving model ...
Epoch: 8 cost time: 3.761442184448242
Epoch: 8, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.635 Vali Acc: 0.761 Test Loss: 0.635 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.15458345413208
Epoch: 9, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.650 Vali Acc: 0.775 Test Loss: 0.650 Test Acc: 0.775
Validation loss decreased (-0.768109 --> -0.775356).  Saving model ...
Epoch: 10 cost time: 3.6552107334136963
Epoch: 10, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.666 Vali Acc: 0.790 Test Loss: 0.666 Test Acc: 0.790
Validation loss decreased (-0.775356 --> -0.789848).  Saving model ...
Epoch: 11 cost time: 3.9585773944854736
Epoch: 11, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.572 Vali Acc: 0.812 Test Loss: 0.572 Test Acc: 0.812
Validation loss decreased (-0.789848 --> -0.811588).  Saving model ...
Epoch: 12 cost time: 4.098313331604004
Epoch: 12, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.743 Vali Acc: 0.739 Test Loss: 0.743 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.139858722686768
Epoch: 13, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.669 Vali Acc: 0.797 Test Loss: 0.669 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.9666502475738525
Epoch: 14, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.588 Vali Acc: 0.804 Test Loss: 0.588 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.207411527633667
Epoch: 15, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.613 Vali Acc: 0.797 Test Loss: 0.613 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.042026996612549
Epoch: 16, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.705 Vali Acc: 0.783 Test Loss: 0.705 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.125859022140503
Epoch: 17, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.687 Vali Acc: 0.790 Test Loss: 0.687 Test Acc: 0.790
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.8168907165527344
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.644 Vali Acc: 0.790 Test Loss: 0.644 Test Acc: 0.790
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.008208513259888
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.651 Vali Acc: 0.790 Test Loss: 0.651 Test Acc: 0.790
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.830509901046753
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.661 Vali Acc: 0.797 Test Loss: 0.661 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.5597219467163086
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.662 Vali Acc: 0.797 Test Loss: 0.662 Test Acc: 0.797
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df128_ma42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8115942028985508
model parameter : 866564
model size : 8.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df128_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.683833122253418
Epoch: 1, Steps: 9 | Train Loss: 1.413 Vali Loss: 1.316 Vali Acc: 0.399 Test Loss: 1.316 Test Acc: 0.399
Validation loss decreased (inf --> -0.398538).  Saving model ...
Epoch: 2 cost time: 4.014009475708008
Epoch: 2, Steps: 9 | Train Loss: 1.179 Vali Loss: 1.147 Vali Acc: 0.507 Test Loss: 1.147 Test Acc: 0.507
Validation loss decreased (-0.398538 --> -0.507235).  Saving model ...
Epoch: 3 cost time: 4.564896583557129
Epoch: 3, Steps: 9 | Train Loss: 0.824 Vali Loss: 0.951 Vali Acc: 0.696 Test Loss: 0.951 Test Acc: 0.696
Validation loss decreased (-0.507235 --> -0.695643).  Saving model ...
Epoch: 4 cost time: 4.791379690170288
Epoch: 4, Steps: 9 | Train Loss: 0.549 Vali Loss: 0.848 Vali Acc: 0.696 Test Loss: 0.848 Test Acc: 0.696
Validation loss decreased (-0.695643 --> -0.695644).  Saving model ...
Epoch: 5 cost time: 5.1478657722473145
Epoch: 5, Steps: 9 | Train Loss: 0.313 Vali Loss: 0.757 Vali Acc: 0.732 Test Loss: 0.757 Test Acc: 0.732
Validation loss decreased (-0.695644 --> -0.731876).  Saving model ...
Epoch: 6 cost time: 4.713266849517822
Epoch: 6, Steps: 9 | Train Loss: 0.176 Vali Loss: 0.679 Vali Acc: 0.768 Test Loss: 0.679 Test Acc: 0.768
Validation loss decreased (-0.731876 --> -0.768109).  Saving model ...
Epoch: 7 cost time: 4.421442985534668
Epoch: 7, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.596 Vali Acc: 0.804 Test Loss: 0.596 Test Acc: 0.804
Validation loss decreased (-0.768109 --> -0.804342).  Saving model ...
Epoch: 8 cost time: 4.700407028198242
Epoch: 8, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.590 Vali Acc: 0.783 Test Loss: 0.590 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.302793979644775
Epoch: 9, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.543 Vali Acc: 0.783 Test Loss: 0.543 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.477524042129517
Epoch: 10, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.567 Vali Acc: 0.790 Test Loss: 0.567 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.570399522781372
Epoch: 11, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.460 Vali Acc: 0.841 Test Loss: 0.460 Test Acc: 0.841
Validation loss decreased (-0.804342 --> -0.840575).  Saving model ...
Epoch: 12 cost time: 3.9531843662261963
Epoch: 12, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.557 Vali Acc: 0.797 Test Loss: 0.557 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.8881266117095947
Epoch: 13, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.557 Vali Acc: 0.812 Test Loss: 0.557 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.7361466884613037
Epoch: 14, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.472 Vali Acc: 0.855 Test Loss: 0.472 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855068).  Saving model ...
Epoch: 15 cost time: 4.047499895095825
Epoch: 15, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.469 Vali Acc: 0.819 Test Loss: 0.469 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.87457275390625
Epoch: 16, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.517 Vali Acc: 0.812 Test Loss: 0.517 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.314029216766357
Epoch: 17, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.522 Vali Acc: 0.826 Test Loss: 0.522 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.325170993804932
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.505 Vali Acc: 0.826 Test Loss: 0.505 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.247659683227539
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.502 Vali Acc: 0.826 Test Loss: 0.502 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.169239282608032
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.496 Vali Acc: 0.826 Test Loss: 0.496 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.2603600025177
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.494 Vali Acc: 0.826 Test Loss: 0.494 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.287146806716919
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.500 Vali Acc: 0.826 Test Loss: 0.500 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.179260492324829
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.506 Vali Acc: 0.826 Test Loss: 0.506 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.961932897567749
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.494 Vali Acc: 0.841 Test Loss: 0.494 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df128_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 866564
model size : 8.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df128_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.339109659194946
Epoch: 1, Steps: 9 | Train Loss: 1.433 Vali Loss: 1.341 Vali Acc: 0.377 Test Loss: 1.341 Test Acc: 0.377
Validation loss decreased (inf --> -0.376798).  Saving model ...
Epoch: 2 cost time: 4.0034284591674805
Epoch: 2, Steps: 9 | Train Loss: 1.191 Vali Loss: 1.160 Vali Acc: 0.486 Test Loss: 1.160 Test Acc: 0.486
Validation loss decreased (-0.376798 --> -0.485496).  Saving model ...
Epoch: 3 cost time: 3.937985420227051
Epoch: 3, Steps: 9 | Train Loss: 0.842 Vali Loss: 0.954 Vali Acc: 0.681 Test Loss: 0.954 Test Acc: 0.681
Validation loss decreased (-0.485496 --> -0.681150).  Saving model ...
Epoch: 4 cost time: 4.209747552871704
Epoch: 4, Steps: 9 | Train Loss: 0.573 Vali Loss: 0.847 Vali Acc: 0.652 Test Loss: 0.847 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.005467891693115
Epoch: 5, Steps: 9 | Train Loss: 0.344 Vali Loss: 0.787 Vali Acc: 0.674 Test Loss: 0.787 Test Acc: 0.674
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.4002439975738525
Epoch: 6, Steps: 9 | Train Loss: 0.208 Vali Loss: 0.706 Vali Acc: 0.725 Test Loss: 0.706 Test Acc: 0.725
Validation loss decreased (-0.681150 --> -0.724631).  Saving model ...
Epoch: 7 cost time: 4.039595127105713
Epoch: 7, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.644 Vali Acc: 0.754 Test Loss: 0.644 Test Acc: 0.754
Validation loss decreased (-0.724631 --> -0.753617).  Saving model ...
Epoch: 8 cost time: 4.555214166641235
Epoch: 8, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.623 Vali Acc: 0.746 Test Loss: 0.623 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.201881647109985
Epoch: 9, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.602 Vali Acc: 0.754 Test Loss: 0.602 Test Acc: 0.754
Validation loss decreased (-0.753617 --> -0.753617).  Saving model ...
Epoch: 10 cost time: 4.258318185806274
Epoch: 10, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.610 Vali Acc: 0.768 Test Loss: 0.610 Test Acc: 0.768
Validation loss decreased (-0.753617 --> -0.768110).  Saving model ...
Epoch: 11 cost time: 4.539050340652466
Epoch: 11, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.549 Vali Acc: 0.783 Test Loss: 0.549 Test Acc: 0.783
Validation loss decreased (-0.768110 --> -0.782603).  Saving model ...
Epoch: 12 cost time: 4.3131115436553955
Epoch: 12, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.632 Vali Acc: 0.754 Test Loss: 0.632 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.106830596923828
Epoch: 13, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.584 Vali Acc: 0.768 Test Loss: 0.584 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.09160041809082
Epoch: 14, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.569 Vali Acc: 0.768 Test Loss: 0.569 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.7897915840148926
Epoch: 15, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.565 Vali Acc: 0.775 Test Loss: 0.565 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.2312726974487305
Epoch: 16, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.599 Vali Acc: 0.768 Test Loss: 0.599 Test Acc: 0.768
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.318486213684082
Epoch: 17, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.589 Vali Acc: 0.783 Test Loss: 0.589 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.1271812915802
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.581 Vali Acc: 0.783 Test Loss: 0.581 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.950368642807007
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.588 Vali Acc: 0.775 Test Loss: 0.588 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.24708890914917
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.589 Vali Acc: 0.775 Test Loss: 0.589 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.253536224365234
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.577 Vali Acc: 0.783 Test Loss: 0.577 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df128_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.782608695652174
model parameter : 866564
model size : 8.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df128_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 6.1197896003723145
Epoch: 1, Steps: 9 | Train Loss: 1.403 Vali Loss: 1.415 Vali Acc: 0.304 Test Loss: 1.415 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 3.8769121170043945
Epoch: 2, Steps: 9 | Train Loss: 1.191 Vali Loss: 1.231 Vali Acc: 0.471 Test Loss: 1.231 Test Acc: 0.471
Validation loss decreased (-0.304334 --> -0.471002).  Saving model ...
Epoch: 3 cost time: 4.122934579849243
Epoch: 3, Steps: 9 | Train Loss: 0.882 Vali Loss: 1.053 Vali Acc: 0.543 Test Loss: 1.053 Test Acc: 0.543
Validation loss decreased (-0.471002 --> -0.543468).  Saving model ...
Epoch: 4 cost time: 3.8640055656433105
Epoch: 4, Steps: 9 | Train Loss: 0.588 Vali Loss: 0.949 Vali Acc: 0.616 Test Loss: 0.949 Test Acc: 0.616
Validation loss decreased (-0.543468 --> -0.615933).  Saving model ...
Epoch: 5 cost time: 3.87801456451416
Epoch: 5, Steps: 9 | Train Loss: 0.355 Vali Loss: 0.959 Vali Acc: 0.630 Test Loss: 0.959 Test Acc: 0.630
Validation loss decreased (-0.615933 --> -0.630425).  Saving model ...
Epoch: 6 cost time: 3.746032238006592
Epoch: 6, Steps: 9 | Train Loss: 0.233 Vali Loss: 0.864 Vali Acc: 0.688 Test Loss: 0.864 Test Acc: 0.688
Validation loss decreased (-0.630425 --> -0.688397).  Saving model ...
Epoch: 7 cost time: 3.7214925289154053
Epoch: 7, Steps: 9 | Train Loss: 0.152 Vali Loss: 0.861 Vali Acc: 0.674 Test Loss: 0.861 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.8718605041503906
Epoch: 8, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.914 Vali Acc: 0.681 Test Loss: 0.914 Test Acc: 0.681
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.7605366706848145
Epoch: 9, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.867 Vali Acc: 0.681 Test Loss: 0.867 Test Acc: 0.681
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.8719046115875244
Epoch: 10, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.924 Vali Acc: 0.674 Test Loss: 0.924 Test Acc: 0.674
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.745885133743286
Epoch: 11, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.862 Vali Acc: 0.674 Test Loss: 0.862 Test Acc: 0.674
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.662654161453247
Epoch: 12, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.930 Vali Acc: 0.710 Test Loss: 0.930 Test Acc: 0.710
Validation loss decreased (-0.688397 --> -0.710136).  Saving model ...
Epoch: 13 cost time: 4.046900987625122
Epoch: 13, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.913 Vali Acc: 0.703 Test Loss: 0.913 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.1644556522369385
Epoch: 14, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.902 Vali Acc: 0.688 Test Loss: 0.902 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.098517179489136
Epoch: 15, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.920 Vali Acc: 0.681 Test Loss: 0.920 Test Acc: 0.681
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.016180753707886
Epoch: 16, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.924 Vali Acc: 0.696 Test Loss: 0.924 Test Acc: 0.696
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.037967920303345
Epoch: 17, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.934 Vali Acc: 0.696 Test Loss: 0.934 Test Acc: 0.696
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.375932455062866
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.937 Vali Acc: 0.696 Test Loss: 0.937 Test Acc: 0.696
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.865380048751831
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.935 Vali Acc: 0.696 Test Loss: 0.935 Test Acc: 0.696
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.093433141708374
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.939 Vali Acc: 0.696 Test Loss: 0.939 Test Acc: 0.696
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.9358134269714355
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.933 Vali Acc: 0.696 Test Loss: 0.933 Test Acc: 0.696
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.779489040374756
Epoch: 22, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.950 Vali Acc: 0.688 Test Loss: 0.950 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df128_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7101449275362319
model parameter : 866564
model size : 8.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.730799198150635
Epoch: 1, Steps: 9 | Train Loss: 1.437 Vali Loss: 1.479 Vali Acc: 0.232 Test Loss: 1.479 Test Acc: 0.232
Validation loss decreased (inf --> -0.231869).  Saving model ...
Epoch: 2 cost time: 3.8046891689300537
Epoch: 2, Steps: 9 | Train Loss: 1.295 Vali Loss: 1.427 Vali Acc: 0.312 Test Loss: 1.427 Test Acc: 0.312
Validation loss decreased (-0.231869 --> -0.311580).  Saving model ...
Epoch: 3 cost time: 3.779168128967285
Epoch: 3, Steps: 9 | Train Loss: 1.029 Vali Loss: 1.387 Vali Acc: 0.268 Test Loss: 1.387 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.173126220703125
Epoch: 4, Steps: 9 | Train Loss: 0.790 Vali Loss: 1.344 Vali Acc: 0.355 Test Loss: 1.344 Test Acc: 0.355
Validation loss decreased (-0.311580 --> -0.355059).  Saving model ...
Epoch: 5 cost time: 4.403158903121948
Epoch: 5, Steps: 9 | Train Loss: 0.537 Vali Loss: 1.317 Vali Acc: 0.384 Test Loss: 1.317 Test Acc: 0.384
Validation loss decreased (-0.355059 --> -0.384045).  Saving model ...
Epoch: 6 cost time: 4.393474817276001
Epoch: 6, Steps: 9 | Train Loss: 0.373 Vali Loss: 1.342 Vali Acc: 0.391 Test Loss: 1.342 Test Acc: 0.391
Validation loss decreased (-0.384045 --> -0.391291).  Saving model ...
Epoch: 7 cost time: 4.498253107070923
Epoch: 7, Steps: 9 | Train Loss: 0.269 Vali Loss: 1.302 Vali Acc: 0.442 Test Loss: 1.302 Test Acc: 0.442
Validation loss decreased (-0.391291 --> -0.442016).  Saving model ...
Epoch: 8 cost time: 4.472130537033081
Epoch: 8, Steps: 9 | Train Loss: 0.155 Vali Loss: 1.451 Vali Acc: 0.413 Test Loss: 1.451 Test Acc: 0.413
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.949938058853149
Epoch: 9, Steps: 9 | Train Loss: 0.095 Vali Loss: 1.403 Vali Acc: 0.464 Test Loss: 1.403 Test Acc: 0.464
Validation loss decreased (-0.442016 --> -0.463754).  Saving model ...
Epoch: 10 cost time: 4.27941107749939
Epoch: 10, Steps: 9 | Train Loss: 0.062 Vali Loss: 1.408 Vali Acc: 0.442 Test Loss: 1.408 Test Acc: 0.442
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.387811660766602
Epoch: 11, Steps: 9 | Train Loss: 0.034 Vali Loss: 1.509 Vali Acc: 0.457 Test Loss: 1.509 Test Acc: 0.457
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.101505756378174
Epoch: 12, Steps: 9 | Train Loss: 0.030 Vali Loss: 1.437 Vali Acc: 0.464 Test Loss: 1.437 Test Acc: 0.464
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.289517402648926
Epoch: 13, Steps: 9 | Train Loss: 0.018 Vali Loss: 1.442 Vali Acc: 0.442 Test Loss: 1.442 Test Acc: 0.442
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.052469491958618
Epoch: 14, Steps: 9 | Train Loss: 0.013 Vali Loss: 1.469 Vali Acc: 0.464 Test Loss: 1.469 Test Acc: 0.464
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.87748122215271
Epoch: 15, Steps: 9 | Train Loss: 0.013 Vali Loss: 1.502 Vali Acc: 0.457 Test Loss: 1.502 Test Acc: 0.457
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.95202898979187
Epoch: 16, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.403 Vali Acc: 0.493 Test Loss: 1.403 Test Acc: 0.493
Validation loss decreased (-0.463754 --> -0.492740).  Saving model ...
Epoch: 17 cost time: 4.494650363922119
Epoch: 17, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.407 Vali Acc: 0.486 Test Loss: 1.407 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.0932533740997314
Epoch: 18, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.407 Vali Acc: 0.529 Test Loss: 1.407 Test Acc: 0.529
Validation loss decreased (-0.492740 --> -0.528971).  Saving model ...
Epoch: 19 cost time: 3.98441481590271
Epoch: 19, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.417 Vali Acc: 0.543 Test Loss: 1.417 Test Acc: 0.543
Validation loss decreased (-0.528971 --> -0.543464).  Saving model ...
Epoch: 20 cost time: 4.2380125522613525
Epoch: 20, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.411 Vali Acc: 0.536 Test Loss: 1.411 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.948251247406006
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.398 Vali Acc: 0.543 Test Loss: 1.398 Test Acc: 0.543
Validation loss decreased (-0.543464 --> -0.543464).  Saving model ...
Epoch: 22 cost time: 4.405872106552124
Epoch: 22, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.399 Vali Acc: 0.522 Test Loss: 1.399 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.9703245162963867
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.408 Vali Acc: 0.543 Test Loss: 1.408 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.312221050262451
Epoch: 24, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.400 Vali Acc: 0.551 Test Loss: 1.400 Test Acc: 0.551
Validation loss decreased (-0.543464 --> -0.550711).  Saving model ...
Epoch: 25 cost time: 4.265869617462158
Epoch: 25, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.388 Vali Acc: 0.558 Test Loss: 1.388 Test Acc: 0.558
Validation loss decreased (-0.550711 --> -0.557957).  Saving model ...
Epoch: 26 cost time: 4.206573009490967
Epoch: 26, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.384 Vali Acc: 0.572 Test Loss: 1.384 Test Acc: 0.572
Validation loss decreased (-0.557957 --> -0.572450).  Saving model ...
Epoch: 27 cost time: 3.945979595184326
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.387 Vali Acc: 0.580 Test Loss: 1.387 Test Acc: 0.580
Validation loss decreased (-0.572450 --> -0.579696).  Saving model ...
Epoch: 28 cost time: 3.995938777923584
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.387 Vali Acc: 0.587 Test Loss: 1.387 Test Acc: 0.587
Validation loss decreased (-0.579696 --> -0.586943).  Saving model ...
Epoch: 29 cost time: 4.601357460021973
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.381 Vali Acc: 0.572 Test Loss: 1.381 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.038808822631836
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.383 Vali Acc: 0.572 Test Loss: 1.383 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 4.086308717727661
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.383 Vali Acc: 0.587 Test Loss: 1.383 Test Acc: 0.587
Validation loss decreased (-0.586943 --> -0.586943).  Saving model ...
Epoch: 32 cost time: 4.000141382217407
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.391 Vali Acc: 0.587 Test Loss: 1.391 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 4.058415412902832
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.392 Vali Acc: 0.609 Test Loss: 1.392 Test Acc: 0.609
Validation loss decreased (-0.586943 --> -0.608682).  Saving model ...
Epoch: 34 cost time: 4.167420148849487
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.386 Vali Acc: 0.609 Test Loss: 1.386 Test Acc: 0.609
Validation loss decreased (-0.608682 --> -0.608682).  Saving model ...
Epoch: 35 cost time: 4.46487021446228
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.381 Vali Acc: 0.601 Test Loss: 1.381 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.9922454357147217
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.382 Vali Acc: 0.609 Test Loss: 1.382 Test Acc: 0.609
Validation loss decreased (-0.608682 --> -0.608682).  Saving model ...
Epoch: 37 cost time: 4.543785333633423
Epoch: 37, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.387 Vali Acc: 0.601 Test Loss: 1.387 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 4.140293121337891
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.390 Vali Acc: 0.601 Test Loss: 1.390 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 4.598829984664917
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.390 Vali Acc: 0.609 Test Loss: 1.390 Test Acc: 0.609
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 4.1888580322265625
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.397 Vali Acc: 0.594 Test Loss: 1.397 Test Acc: 0.594
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 3.8133738040924072
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.401 Vali Acc: 0.594 Test Loss: 1.401 Test Acc: 0.594
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 5.039933681488037
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.399 Vali Acc: 0.609 Test Loss: 1.399 Test Acc: 0.609
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 4.408666133880615
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.402 Vali Acc: 0.609 Test Loss: 1.402 Test Acc: 0.609
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 4.380678176879883
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.409 Vali Acc: 0.609 Test Loss: 1.409 Test Acc: 0.609
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 4.398747444152832
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.410 Vali Acc: 0.601 Test Loss: 1.410 Test Acc: 0.601
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 3.8756909370422363
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.408 Vali Acc: 0.609 Test Loss: 1.408 Test Acc: 0.609
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.6086956521739131
model parameter : 866564
model size : 8.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.73488974571228
Epoch: 1, Steps: 9 | Train Loss: 1.436 Vali Loss: 1.475 Vali Acc: 0.225 Test Loss: 1.475 Test Acc: 0.225
Validation loss decreased (inf --> -0.224623).  Saving model ...
Epoch: 2 cost time: 3.8303728103637695
Epoch: 2, Steps: 9 | Train Loss: 1.366 Vali Loss: 1.478 Vali Acc: 0.304 Test Loss: 1.478 Test Acc: 0.304
Validation loss decreased (-0.224623 --> -0.304333).  Saving model ...
Epoch: 3 cost time: 4.25847601890564
Epoch: 3, Steps: 9 | Train Loss: 1.174 Vali Loss: 1.490 Vali Acc: 0.283 Test Loss: 1.490 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.9740240573883057
Epoch: 4, Steps: 9 | Train Loss: 0.985 Vali Loss: 1.590 Vali Acc: 0.268 Test Loss: 1.590 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.305774688720703
Epoch: 5, Steps: 9 | Train Loss: 0.777 Vali Loss: 1.535 Vali Acc: 0.290 Test Loss: 1.535 Test Acc: 0.290
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.422627925872803
Epoch: 6, Steps: 9 | Train Loss: 0.607 Vali Loss: 1.850 Vali Acc: 0.283 Test Loss: 1.850 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.905256986618042
Epoch: 7, Steps: 9 | Train Loss: 0.458 Vali Loss: 1.855 Vali Acc: 0.290 Test Loss: 1.855 Test Acc: 0.290
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.4426658153533936
Epoch: 8, Steps: 9 | Train Loss: 0.316 Vali Loss: 2.071 Vali Acc: 0.290 Test Loss: 2.071 Test Acc: 0.290
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.340157985687256
Epoch: 9, Steps: 9 | Train Loss: 0.232 Vali Loss: 2.299 Vali Acc: 0.304 Test Loss: 2.299 Test Acc: 0.304
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.142041444778442
Epoch: 10, Steps: 9 | Train Loss: 0.174 Vali Loss: 2.276 Vali Acc: 0.319 Test Loss: 2.276 Test Acc: 0.319
Validation loss decreased (-0.304333 --> -0.318818).  Saving model ...
Epoch: 11 cost time: 4.205014944076538
Epoch: 11, Steps: 9 | Train Loss: 0.116 Vali Loss: 2.541 Vali Acc: 0.304 Test Loss: 2.541 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.381498336791992
Epoch: 12, Steps: 9 | Train Loss: 0.079 Vali Loss: 2.546 Vali Acc: 0.348 Test Loss: 2.546 Test Acc: 0.348
Validation loss decreased (-0.318818 --> -0.347801).  Saving model ...
Epoch: 13 cost time: 4.146563291549683
Epoch: 13, Steps: 9 | Train Loss: 0.049 Vali Loss: 2.426 Vali Acc: 0.362 Test Loss: 2.426 Test Acc: 0.362
Validation loss decreased (-0.347801 --> -0.362295).  Saving model ...
Epoch: 14 cost time: 4.036488056182861
Epoch: 14, Steps: 9 | Train Loss: 0.029 Vali Loss: 2.619 Vali Acc: 0.348 Test Loss: 2.619 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.9425394535064697
Epoch: 15, Steps: 9 | Train Loss: 0.028 Vali Loss: 2.607 Vali Acc: 0.355 Test Loss: 2.607 Test Acc: 0.355
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.893707036972046
Epoch: 16, Steps: 9 | Train Loss: 0.017 Vali Loss: 2.485 Vali Acc: 0.370 Test Loss: 2.485 Test Acc: 0.370
Validation loss decreased (-0.362295 --> -0.369540).  Saving model ...
Epoch: 17 cost time: 3.916074752807617
Epoch: 17, Steps: 9 | Train Loss: 0.012 Vali Loss: 2.291 Vali Acc: 0.384 Test Loss: 2.291 Test Acc: 0.384
Validation loss decreased (-0.369540 --> -0.384035).  Saving model ...
Epoch: 18 cost time: 3.9410598278045654
Epoch: 18, Steps: 9 | Train Loss: 0.010 Vali Loss: 2.345 Vali Acc: 0.391 Test Loss: 2.345 Test Acc: 0.391
Validation loss decreased (-0.384035 --> -0.391281).  Saving model ...
Epoch: 19 cost time: 3.770780563354492
Epoch: 19, Steps: 9 | Train Loss: 0.009 Vali Loss: 2.407 Vali Acc: 0.391 Test Loss: 2.407 Test Acc: 0.391
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.858800172805786
Epoch: 20, Steps: 9 | Train Loss: 0.007 Vali Loss: 2.527 Vali Acc: 0.384 Test Loss: 2.527 Test Acc: 0.384
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.181457042694092
Epoch: 21, Steps: 9 | Train Loss: 0.006 Vali Loss: 2.459 Vali Acc: 0.377 Test Loss: 2.459 Test Acc: 0.377
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.9252498149871826
Epoch: 22, Steps: 9 | Train Loss: 0.006 Vali Loss: 2.424 Vali Acc: 0.399 Test Loss: 2.424 Test Acc: 0.399
Validation loss decreased (-0.391281 --> -0.398526).  Saving model ...
Epoch: 23 cost time: 4.0532965660095215
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 2.418 Vali Acc: 0.391 Test Loss: 2.418 Test Acc: 0.391
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.400999546051025
Epoch: 24, Steps: 9 | Train Loss: 0.004 Vali Loss: 2.372 Vali Acc: 0.384 Test Loss: 2.372 Test Acc: 0.384
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.022843360900879
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 2.311 Vali Acc: 0.399 Test Loss: 2.311 Test Acc: 0.399
Validation loss decreased (-0.398526 --> -0.398528).  Saving model ...
Epoch: 26 cost time: 3.9225590229034424
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 2.357 Vali Acc: 0.406 Test Loss: 2.357 Test Acc: 0.406
Validation loss decreased (-0.398528 --> -0.405774).  Saving model ...
Epoch: 27 cost time: 3.9935829639434814
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 2.382 Vali Acc: 0.399 Test Loss: 2.382 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.7719385623931885
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 2.386 Vali Acc: 0.413 Test Loss: 2.386 Test Acc: 0.413
Validation loss decreased (-0.405774 --> -0.413020).  Saving model ...
Epoch: 29 cost time: 3.779697895050049
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 2.370 Vali Acc: 0.420 Test Loss: 2.370 Test Acc: 0.420
Validation loss decreased (-0.413020 --> -0.420266).  Saving model ...
Epoch: 30 cost time: 4.057578086853027
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 2.367 Vali Acc: 0.413 Test Loss: 2.367 Test Acc: 0.413
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.962894916534424
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.390 Vali Acc: 0.420 Test Loss: 2.390 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.8059613704681396
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.426 Vali Acc: 0.413 Test Loss: 2.426 Test Acc: 0.413
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.611581325531006
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.398 Vali Acc: 0.406 Test Loss: 2.398 Test Acc: 0.406
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.8764607906341553
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.263 Vali Acc: 0.457 Test Loss: 2.263 Test Acc: 0.457
Validation loss decreased (-0.420266 --> -0.456499).  Saving model ...
Epoch: 35 cost time: 3.9958980083465576
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.337 Vali Acc: 0.457 Test Loss: 2.337 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.7496719360351562
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.338 Vali Acc: 0.457 Test Loss: 2.338 Test Acc: 0.457
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.9350552558898926
Epoch: 37, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.342 Vali Acc: 0.457 Test Loss: 2.342 Test Acc: 0.457
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 4.166985511779785
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.360 Vali Acc: 0.442 Test Loss: 2.360 Test Acc: 0.442
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 4.7204201221466064
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.348 Vali Acc: 0.471 Test Loss: 2.348 Test Acc: 0.471
Validation loss decreased (-0.456499 --> -0.470991).  Saving model ...
Epoch: 40 cost time: 4.163658142089844
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.368 Vali Acc: 0.464 Test Loss: 2.368 Test Acc: 0.464
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 4.304614067077637
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.406 Vali Acc: 0.449 Test Loss: 2.406 Test Acc: 0.449
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.8688628673553467
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.425 Vali Acc: 0.442 Test Loss: 2.425 Test Acc: 0.442
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 4.350255489349365
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.470 Vali Acc: 0.449 Test Loss: 2.470 Test Acc: 0.449
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.8908941745758057
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.444 Vali Acc: 0.442 Test Loss: 2.444 Test Acc: 0.442
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 4.207769870758057
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.386 Vali Acc: 0.442 Test Loss: 2.386 Test Acc: 0.442
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 3.811040163040161
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.309 Vali Acc: 0.457 Test Loss: 2.309 Test Acc: 0.457
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 3.9919400215148926
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.301 Vali Acc: 0.449 Test Loss: 2.301 Test Acc: 0.449
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 3.963090181350708
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 2.343 Vali Acc: 0.457 Test Loss: 2.343 Test Acc: 0.457
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 3.737612247467041
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.377 Vali Acc: 0.457 Test Loss: 2.377 Test Acc: 0.457
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.47101449275362317
model parameter : 866564
model size : 8.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.734635829925537
Epoch: 1, Steps: 9 | Train Loss: 1.429 Vali Loss: 1.391 Vali Acc: 0.341 Test Loss: 1.391 Test Acc: 0.341
Validation loss decreased (inf --> -0.340566).  Saving model ...
Epoch: 2 cost time: 3.927175998687744
Epoch: 2, Steps: 9 | Train Loss: 1.301 Vali Loss: 1.378 Vali Acc: 0.341 Test Loss: 1.378 Test Acc: 0.341
Validation loss decreased (-0.340566 --> -0.340566).  Saving model ...
Epoch: 3 cost time: 4.243821382522583
Epoch: 3, Steps: 9 | Train Loss: 1.140 Vali Loss: 1.362 Vali Acc: 0.304 Test Loss: 1.362 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.0217204093933105
Epoch: 4, Steps: 9 | Train Loss: 0.957 Vali Loss: 1.371 Vali Acc: 0.341 Test Loss: 1.371 Test Acc: 0.341
Validation loss decreased (-0.340566 --> -0.340566).  Saving model ...
Epoch: 5 cost time: 3.8665032386779785
Epoch: 5, Steps: 9 | Train Loss: 0.739 Vali Loss: 1.305 Vali Acc: 0.384 Test Loss: 1.305 Test Acc: 0.384
Validation loss decreased (-0.340566 --> -0.384045).  Saving model ...
Epoch: 6 cost time: 4.0321595668792725
Epoch: 6, Steps: 9 | Train Loss: 0.573 Vali Loss: 1.426 Vali Acc: 0.319 Test Loss: 1.426 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.395579099655151
Epoch: 7, Steps: 9 | Train Loss: 0.388 Vali Loss: 1.390 Vali Acc: 0.362 Test Loss: 1.390 Test Acc: 0.362
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.314222097396851
Epoch: 8, Steps: 9 | Train Loss: 0.266 Vali Loss: 1.494 Vali Acc: 0.341 Test Loss: 1.494 Test Acc: 0.341
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.385471343994141
Epoch: 9, Steps: 9 | Train Loss: 0.191 Vali Loss: 1.622 Vali Acc: 0.333 Test Loss: 1.622 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.030539035797119
Epoch: 10, Steps: 9 | Train Loss: 0.139 Vali Loss: 1.440 Vali Acc: 0.362 Test Loss: 1.440 Test Acc: 0.362
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.9769296646118164
Epoch: 11, Steps: 9 | Train Loss: 0.081 Vali Loss: 1.790 Vali Acc: 0.348 Test Loss: 1.790 Test Acc: 0.348
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.8134453296661377
Epoch: 12, Steps: 9 | Train Loss: 0.049 Vali Loss: 1.511 Vali Acc: 0.391 Test Loss: 1.511 Test Acc: 0.391
Validation loss decreased (-0.384045 --> -0.391289).  Saving model ...
Epoch: 13 cost time: 3.803960084915161
Epoch: 13, Steps: 9 | Train Loss: 0.027 Vali Loss: 1.564 Vali Acc: 0.377 Test Loss: 1.564 Test Acc: 0.377
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.7019548416137695
Epoch: 14, Steps: 9 | Train Loss: 0.025 Vali Loss: 1.684 Vali Acc: 0.384 Test Loss: 1.684 Test Acc: 0.384
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.8531675338745117
Epoch: 15, Steps: 9 | Train Loss: 0.019 Vali Loss: 1.573 Vali Acc: 0.399 Test Loss: 1.573 Test Acc: 0.399
Validation loss decreased (-0.391289 --> -0.398535).  Saving model ...
Epoch: 16 cost time: 3.9357385635375977
Epoch: 16, Steps: 9 | Train Loss: 0.014 Vali Loss: 1.450 Vali Acc: 0.442 Test Loss: 1.450 Test Acc: 0.442
Validation loss decreased (-0.398535 --> -0.442014).  Saving model ...
Epoch: 17 cost time: 3.9521055221557617
Epoch: 17, Steps: 9 | Train Loss: 0.010 Vali Loss: 1.450 Vali Acc: 0.442 Test Loss: 1.450 Test Acc: 0.442
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.882319211959839
Epoch: 18, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.521 Vali Acc: 0.449 Test Loss: 1.521 Test Acc: 0.449
Validation loss decreased (-0.442014 --> -0.449260).  Saving model ...
Epoch: 19 cost time: 4.214249134063721
Epoch: 19, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.519 Vali Acc: 0.464 Test Loss: 1.519 Test Acc: 0.464
Validation loss decreased (-0.449260 --> -0.463753).  Saving model ...
Epoch: 20 cost time: 4.337774991989136
Epoch: 20, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.463 Vali Acc: 0.471 Test Loss: 1.463 Test Acc: 0.471
Validation loss decreased (-0.463753 --> -0.471000).  Saving model ...
Epoch: 21 cost time: 4.197418928146362
Epoch: 21, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.417 Vali Acc: 0.478 Test Loss: 1.417 Test Acc: 0.478
Validation loss decreased (-0.471000 --> -0.478247).  Saving model ...
Epoch: 22 cost time: 3.958329200744629
Epoch: 22, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.459 Vali Acc: 0.478 Test Loss: 1.459 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.347339153289795
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.445 Vali Acc: 0.486 Test Loss: 1.445 Test Acc: 0.486
Validation loss decreased (-0.478247 --> -0.485493).  Saving model ...
Epoch: 24 cost time: 3.9860031604766846
Epoch: 24, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.454 Vali Acc: 0.486 Test Loss: 1.454 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.915724039077759
Epoch: 25, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.445 Vali Acc: 0.507 Test Loss: 1.445 Test Acc: 0.507
Validation loss decreased (-0.485493 --> -0.507232).  Saving model ...
Epoch: 26 cost time: 3.712308883666992
Epoch: 26, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.440 Vali Acc: 0.514 Test Loss: 1.440 Test Acc: 0.514
Validation loss decreased (-0.507232 --> -0.514478).  Saving model ...
Epoch: 27 cost time: 3.633556842803955
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.436 Vali Acc: 0.507 Test Loss: 1.436 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.8031039237976074
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.423 Vali Acc: 0.536 Test Loss: 1.423 Test Acc: 0.536
Validation loss decreased (-0.514478 --> -0.536218).  Saving model ...
Epoch: 29 cost time: 3.786951780319214
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.406 Vali Acc: 0.558 Test Loss: 1.406 Test Acc: 0.558
Validation loss decreased (-0.536218 --> -0.557957).  Saving model ...
Epoch: 30 cost time: 3.9603452682495117
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.398 Vali Acc: 0.529 Test Loss: 1.398 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 4.022860288619995
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.420 Vali Acc: 0.551 Test Loss: 1.420 Test Acc: 0.551
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.9320950508117676
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.424 Vali Acc: 0.558 Test Loss: 1.424 Test Acc: 0.558
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.814582586288452
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.426 Vali Acc: 0.558 Test Loss: 1.426 Test Acc: 0.558
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.8850648403167725
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.409 Vali Acc: 0.565 Test Loss: 1.409 Test Acc: 0.565
Validation loss decreased (-0.557957 --> -0.565203).  Saving model ...
Epoch: 35 cost time: 4.063050270080566
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.400 Vali Acc: 0.565 Test Loss: 1.400 Test Acc: 0.565
Validation loss decreased (-0.565203 --> -0.565203).  Saving model ...
Epoch: 36 cost time: 3.9946558475494385
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.400 Vali Acc: 0.565 Test Loss: 1.400 Test Acc: 0.565
Validation loss decreased (-0.565203 --> -0.565203).  Saving model ...
Epoch: 37 cost time: 4.150700569152832
Epoch: 37, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.418 Vali Acc: 0.572 Test Loss: 1.418 Test Acc: 0.572
Validation loss decreased (-0.565203 --> -0.572450).  Saving model ...
Epoch: 38 cost time: 3.9632906913757324
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.432 Vali Acc: 0.558 Test Loss: 1.432 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 4.2201807498931885
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.436 Vali Acc: 0.580 Test Loss: 1.436 Test Acc: 0.580
Validation loss decreased (-0.572450 --> -0.579696).  Saving model ...
Epoch: 40 cost time: 4.2649030685424805
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.440 Vali Acc: 0.572 Test Loss: 1.440 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 4.186563491821289
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.440 Vali Acc: 0.572 Test Loss: 1.440 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 4.107995510101318
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.440 Vali Acc: 0.565 Test Loss: 1.440 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.7505266666412354
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.442 Vali Acc: 0.572 Test Loss: 1.442 Test Acc: 0.572
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.9739654064178467
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.438 Vali Acc: 0.587 Test Loss: 1.438 Test Acc: 0.587
Validation loss decreased (-0.579696 --> -0.586942).  Saving model ...
Epoch: 45 cost time: 3.6409032344818115
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.434 Vali Acc: 0.587 Test Loss: 1.434 Test Acc: 0.587
Validation loss decreased (-0.586942 --> -0.586942).  Saving model ...
Epoch: 46 cost time: 3.8690006732940674
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.434 Vali Acc: 0.594 Test Loss: 1.434 Test Acc: 0.594
Validation loss decreased (-0.586942 --> -0.594189).  Saving model ...
Epoch: 47 cost time: 3.7526304721832275
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.451 Vali Acc: 0.594 Test Loss: 1.451 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.705782413482666
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.465 Vali Acc: 0.587 Test Loss: 1.465 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 3.830406665802002
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.474 Vali Acc: 0.594 Test Loss: 1.474 Test Acc: 0.594
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 3.826904773712158
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.476 Vali Acc: 0.601 Test Loss: 1.476 Test Acc: 0.601
Validation loss decreased (-0.594189 --> -0.601435).  Saving model ...
Epoch: 51 cost time: 3.9951741695404053
Epoch: 51, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.467 Vali Acc: 0.601 Test Loss: 1.467 Test Acc: 0.601
Validation loss decreased (-0.601435 --> -0.601435).  Saving model ...
Epoch: 52 cost time: 3.780742645263672
Epoch: 52, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.474 Vali Acc: 0.609 Test Loss: 1.474 Test Acc: 0.609
Validation loss decreased (-0.601435 --> -0.608681).  Saving model ...
Epoch: 53 cost time: 3.9221229553222656
Epoch: 53, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.472 Vali Acc: 0.601 Test Loss: 1.472 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 3.9023821353912354
Epoch: 54, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.469 Vali Acc: 0.609 Test Loss: 1.469 Test Acc: 0.609
Validation loss decreased (-0.608681 --> -0.608681).  Saving model ...
Epoch: 55 cost time: 3.7015798091888428
Epoch: 55, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.482 Vali Acc: 0.601 Test Loss: 1.482 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 3.4158623218536377
Epoch: 56, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.488 Vali Acc: 0.609 Test Loss: 1.488 Test Acc: 0.609
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 3.720353603363037
Epoch: 57, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.492 Vali Acc: 0.609 Test Loss: 1.492 Test Acc: 0.609
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 3.774012327194214
Epoch: 58, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.494 Vali Acc: 0.601 Test Loss: 1.494 Test Acc: 0.601
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 3.6487128734588623
Epoch: 59, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.500 Vali Acc: 0.601 Test Loss: 1.500 Test Acc: 0.601
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 3.622523069381714
Epoch: 60, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.509 Vali Acc: 0.601 Test Loss: 1.509 Test Acc: 0.601
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 3.7793731689453125
Epoch: 61, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.516 Vali Acc: 0.601 Test Loss: 1.516 Test Acc: 0.601
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 3.926476001739502
Epoch: 62, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.522 Vali Acc: 0.601 Test Loss: 1.522 Test Acc: 0.601
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 4.124011754989624
Epoch: 63, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.523 Vali Acc: 0.601 Test Loss: 1.523 Test Acc: 0.601
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 4.36458158493042
Epoch: 64, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.519 Vali Acc: 0.601 Test Loss: 1.519 Test Acc: 0.601
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm128_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.6086956521739131
model parameter : 866564
model size : 8.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         103                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma103_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.522882461547852
Epoch: 1, Steps: 9 | Train Loss: 1.409 Vali Loss: 1.354 Vali Acc: 0.391 Test Loss: 1.354 Test Acc: 0.391
Validation loss decreased (inf --> -0.391291).  Saving model ...
Epoch: 2 cost time: 4.1633381843566895
Epoch: 2, Steps: 9 | Train Loss: 1.279 Vali Loss: 1.242 Vali Acc: 0.384 Test Loss: 1.242 Test Acc: 0.384
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.9794063568115234
Epoch: 3, Steps: 9 | Train Loss: 1.006 Vali Loss: 1.062 Vali Acc: 0.659 Test Loss: 1.062 Test Acc: 0.659
Validation loss decreased (-0.391291 --> -0.659410).  Saving model ...
Epoch: 4 cost time: 4.073939800262451
Epoch: 4, Steps: 9 | Train Loss: 0.740 Vali Loss: 0.924 Vali Acc: 0.681 Test Loss: 0.924 Test Acc: 0.681
Validation loss decreased (-0.659410 --> -0.681150).  Saving model ...
Epoch: 5 cost time: 4.101862192153931
Epoch: 5, Steps: 9 | Train Loss: 0.539 Vali Loss: 0.819 Vali Acc: 0.696 Test Loss: 0.819 Test Acc: 0.696
Validation loss decreased (-0.681150 --> -0.695644).  Saving model ...
Epoch: 6 cost time: 3.8724594116210938
Epoch: 6, Steps: 9 | Train Loss: 0.362 Vali Loss: 0.706 Vali Acc: 0.768 Test Loss: 0.706 Test Acc: 0.768
Validation loss decreased (-0.695644 --> -0.768109).  Saving model ...
Epoch: 7 cost time: 3.9529001712799072
Epoch: 7, Steps: 9 | Train Loss: 0.221 Vali Loss: 0.602 Vali Acc: 0.768 Test Loss: 0.602 Test Acc: 0.768
Validation loss decreased (-0.768109 --> -0.768110).  Saving model ...
Epoch: 8 cost time: 3.71197247505188
Epoch: 8, Steps: 9 | Train Loss: 0.143 Vali Loss: 0.510 Vali Acc: 0.841 Test Loss: 0.510 Test Acc: 0.841
Validation loss decreased (-0.768110 --> -0.840575).  Saving model ...
Epoch: 9 cost time: 3.8446083068847656
Epoch: 9, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.505 Vali Acc: 0.833 Test Loss: 0.505 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.9086074829101562
Epoch: 10, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.459 Vali Acc: 0.855 Test Loss: 0.459 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855068).  Saving model ...
Epoch: 11 cost time: 3.752000570297241
Epoch: 11, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.446 Vali Acc: 0.870 Test Loss: 0.446 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869561).  Saving model ...
Epoch: 12 cost time: 3.9377572536468506
Epoch: 12, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.457 Vali Acc: 0.848 Test Loss: 0.457 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.129276514053345
Epoch: 13, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.433 Vali Acc: 0.848 Test Loss: 0.433 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.3312602043151855
Epoch: 14, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.441 Vali Acc: 0.862 Test Loss: 0.441 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.1788859367370605
Epoch: 15, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.427 Vali Acc: 0.870 Test Loss: 0.427 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 16 cost time: 4.652392148971558
Epoch: 16, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.417 Vali Acc: 0.877 Test Loss: 0.417 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 17 cost time: 3.7835795879364014
Epoch: 17, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.423 Vali Acc: 0.877 Test Loss: 0.423 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.328117609024048
Epoch: 18, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.410 Vali Acc: 0.870 Test Loss: 0.410 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.8143391609191895
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.422 Vali Acc: 0.870 Test Loss: 0.422 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.9962477684020996
Epoch: 20, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.429 Vali Acc: 0.877 Test Loss: 0.429 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.8090317249298096
Epoch: 21, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.425 Vali Acc: 0.877 Test Loss: 0.425 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.7203948497772217
Epoch: 22, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.425 Vali Acc: 0.870 Test Loss: 0.425 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.702019453048706
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.419 Vali Acc: 0.870 Test Loss: 0.419 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.6643364429473877
Epoch: 24, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.433 Vali Acc: 0.877 Test Loss: 0.433 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.87672758102417
Epoch: 25, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.423 Vali Acc: 0.877 Test Loss: 0.423 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.780646800994873
Epoch: 26, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.417 Vali Acc: 0.870 Test Loss: 0.417 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma103_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 1006724
model size : 6.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         83                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma83_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.810482501983643
Epoch: 1, Steps: 9 | Train Loss: 1.434 Vali Loss: 1.376 Vali Acc: 0.304 Test Loss: 1.376 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 3.8679211139678955
Epoch: 2, Steps: 9 | Train Loss: 1.291 Vali Loss: 1.262 Vali Acc: 0.377 Test Loss: 1.262 Test Acc: 0.377
Validation loss decreased (-0.304334 --> -0.376799).  Saving model ...
Epoch: 3 cost time: 3.9762885570526123
Epoch: 3, Steps: 9 | Train Loss: 1.018 Vali Loss: 1.079 Vali Acc: 0.623 Test Loss: 1.079 Test Acc: 0.623
Validation loss decreased (-0.376799 --> -0.623178).  Saving model ...
Epoch: 4 cost time: 4.189452886581421
Epoch: 4, Steps: 9 | Train Loss: 0.754 Vali Loss: 0.937 Vali Acc: 0.667 Test Loss: 0.937 Test Acc: 0.667
Validation loss decreased (-0.623178 --> -0.666657).  Saving model ...
Epoch: 5 cost time: 3.968430757522583
Epoch: 5, Steps: 9 | Train Loss: 0.546 Vali Loss: 0.834 Vali Acc: 0.710 Test Loss: 0.834 Test Acc: 0.710
Validation loss decreased (-0.666657 --> -0.710137).  Saving model ...
Epoch: 6 cost time: 3.9303841590881348
Epoch: 6, Steps: 9 | Train Loss: 0.367 Vali Loss: 0.721 Vali Acc: 0.761 Test Loss: 0.721 Test Acc: 0.761
Validation loss decreased (-0.710137 --> -0.760862).  Saving model ...
Epoch: 7 cost time: 3.4733991622924805
Epoch: 7, Steps: 9 | Train Loss: 0.226 Vali Loss: 0.606 Vali Acc: 0.783 Test Loss: 0.606 Test Acc: 0.783
Validation loss decreased (-0.760862 --> -0.782603).  Saving model ...
Epoch: 8 cost time: 3.748502016067505
Epoch: 8, Steps: 9 | Train Loss: 0.150 Vali Loss: 0.515 Vali Acc: 0.855 Test Loss: 0.515 Test Acc: 0.855
Validation loss decreased (-0.782603 --> -0.855067).  Saving model ...
Epoch: 9 cost time: 3.6831064224243164
Epoch: 9, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.500 Vali Acc: 0.833 Test Loss: 0.500 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.566749334335327
Epoch: 10, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.455 Vali Acc: 0.855 Test Loss: 0.455 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855068).  Saving model ...
Epoch: 11 cost time: 3.7482616901397705
Epoch: 11, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.444 Vali Acc: 0.848 Test Loss: 0.444 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.7156412601470947
Epoch: 12, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.454 Vali Acc: 0.877 Test Loss: 0.454 Test Acc: 0.877
Validation loss decreased (-0.855068 --> -0.876807).  Saving model ...
Epoch: 13 cost time: 3.7991459369659424
Epoch: 13, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.432 Vali Acc: 0.870 Test Loss: 0.432 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.002690315246582
Epoch: 14, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.445 Vali Acc: 0.877 Test Loss: 0.445 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 15 cost time: 3.916494131088257
Epoch: 15, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.429 Vali Acc: 0.877 Test Loss: 0.429 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 16 cost time: 3.710108518600464
Epoch: 16, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.409 Vali Acc: 0.877 Test Loss: 0.409 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 17 cost time: 3.8485755920410156
Epoch: 17, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.421 Vali Acc: 0.877 Test Loss: 0.421 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.2522547245025635
Epoch: 18, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.404 Vali Acc: 0.884 Test Loss: 0.404 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884054).  Saving model ...
Epoch: 19 cost time: 3.6749861240386963
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.422 Vali Acc: 0.877 Test Loss: 0.422 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.849013090133667
Epoch: 20, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.426 Vali Acc: 0.884 Test Loss: 0.426 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.8911170959472656
Epoch: 21, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.415 Vali Acc: 0.884 Test Loss: 0.415 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.990027904510498
Epoch: 22, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.417 Vali Acc: 0.884 Test Loss: 0.417 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.9531736373901367
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.409 Vali Acc: 0.891 Test Loss: 0.409 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891300).  Saving model ...
Epoch: 24 cost time: 3.812209129333496
Epoch: 24, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.424 Vali Acc: 0.884 Test Loss: 0.424 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.8300201892852783
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.416 Vali Acc: 0.884 Test Loss: 0.416 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.281148910522461
Epoch: 26, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.407 Vali Acc: 0.877 Test Loss: 0.407 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.7022855281829834
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.416 Vali Acc: 0.877 Test Loss: 0.416 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.959851026535034
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.416 Vali Acc: 0.884 Test Loss: 0.416 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 4.2615745067596436
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.418 Vali Acc: 0.884 Test Loss: 0.418 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.8895015716552734
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.414 Vali Acc: 0.891 Test Loss: 0.414 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 4.097289800643921
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.413 Vali Acc: 0.891 Test Loss: 0.413 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.8908541202545166
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.418 Vali Acc: 0.891 Test Loss: 0.418 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.9058918952941895
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.428 Vali Acc: 0.891 Test Loss: 0.428 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma83_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 1006724
model size : 6.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         62                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma62_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.9221510887146
Epoch: 1, Steps: 9 | Train Loss: 1.451 Vali Loss: 1.393 Vali Acc: 0.268 Test Loss: 1.393 Test Acc: 0.268
Validation loss decreased (inf --> -0.268102).  Saving model ...
Epoch: 2 cost time: 4.544038772583008
Epoch: 2, Steps: 9 | Train Loss: 1.305 Vali Loss: 1.281 Vali Acc: 0.384 Test Loss: 1.281 Test Acc: 0.384
Validation loss decreased (-0.268102 --> -0.384045).  Saving model ...
Epoch: 3 cost time: 4.107649326324463
Epoch: 3, Steps: 9 | Train Loss: 1.034 Vali Loss: 1.101 Vali Acc: 0.601 Test Loss: 1.101 Test Acc: 0.601
Validation loss decreased (-0.384045 --> -0.601438).  Saving model ...
Epoch: 4 cost time: 4.148488521575928
Epoch: 4, Steps: 9 | Train Loss: 0.768 Vali Loss: 0.952 Vali Acc: 0.703 Test Loss: 0.952 Test Acc: 0.703
Validation loss decreased (-0.601438 --> -0.702889).  Saving model ...
Epoch: 5 cost time: 4.3329102993011475
Epoch: 5, Steps: 9 | Train Loss: 0.549 Vali Loss: 0.847 Vali Acc: 0.739 Test Loss: 0.847 Test Acc: 0.739
Validation loss decreased (-0.702889 --> -0.739122).  Saving model ...
Epoch: 6 cost time: 4.331390142440796
Epoch: 6, Steps: 9 | Train Loss: 0.366 Vali Loss: 0.728 Vali Acc: 0.790 Test Loss: 0.728 Test Acc: 0.790
Validation loss decreased (-0.739122 --> -0.789848).  Saving model ...
Epoch: 7 cost time: 3.9806690216064453
Epoch: 7, Steps: 9 | Train Loss: 0.223 Vali Loss: 0.614 Vali Acc: 0.826 Test Loss: 0.614 Test Acc: 0.826
Validation loss decreased (-0.789848 --> -0.826081).  Saving model ...
Epoch: 8 cost time: 4.22219181060791
Epoch: 8, Steps: 9 | Train Loss: 0.149 Vali Loss: 0.512 Vali Acc: 0.870 Test Loss: 0.512 Test Acc: 0.870
Validation loss decreased (-0.826081 --> -0.869560).  Saving model ...
Epoch: 9 cost time: 4.7004852294921875
Epoch: 9, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.508 Vali Acc: 0.899 Test Loss: 0.508 Test Acc: 0.899
Validation loss decreased (-0.869560 --> -0.898546).  Saving model ...
Epoch: 10 cost time: 4.251214265823364
Epoch: 10, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.456 Vali Acc: 0.899 Test Loss: 0.456 Test Acc: 0.899
Validation loss decreased (-0.898546 --> -0.898546).  Saving model ...
Epoch: 11 cost time: 4.237026929855347
Epoch: 11, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.436 Vali Acc: 0.877 Test Loss: 0.436 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.463222980499268
Epoch: 12, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.472 Vali Acc: 0.906 Test Loss: 0.472 Test Acc: 0.906
Validation loss decreased (-0.898546 --> -0.905792).  Saving model ...
Epoch: 13 cost time: 4.3865580558776855
Epoch: 13, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.435 Vali Acc: 0.913 Test Loss: 0.435 Test Acc: 0.913
Validation loss decreased (-0.905792 --> -0.913039).  Saving model ...
Epoch: 14 cost time: 4.429956674575806
Epoch: 14, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.438 Vali Acc: 0.906 Test Loss: 0.438 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.206737279891968
Epoch: 15, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.438 Vali Acc: 0.906 Test Loss: 0.438 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.553941011428833
Epoch: 16, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.420 Vali Acc: 0.906 Test Loss: 0.420 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.6287131309509277
Epoch: 17, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.424 Vali Acc: 0.913 Test Loss: 0.424 Test Acc: 0.913
Validation loss decreased (-0.913039 --> -0.913039).  Saving model ...
Epoch: 18 cost time: 3.9119062423706055
Epoch: 18, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.407 Vali Acc: 0.906 Test Loss: 0.407 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.514536619186401
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.423 Vali Acc: 0.913 Test Loss: 0.423 Test Acc: 0.913
Validation loss decreased (-0.913039 --> -0.913039).  Saving model ...
Epoch: 20 cost time: 3.9152448177337646
Epoch: 20, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.423 Vali Acc: 0.913 Test Loss: 0.423 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.9428577423095703
Epoch: 21, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.416 Vali Acc: 0.913 Test Loss: 0.416 Test Acc: 0.913
Validation loss decreased (-0.913039 --> -0.913039).  Saving model ...
Epoch: 22 cost time: 4.35387110710144
Epoch: 22, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.424 Vali Acc: 0.913 Test Loss: 0.424 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.414989471435547
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.417 Vali Acc: 0.913 Test Loss: 0.417 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.143030166625977
Epoch: 24, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.425 Vali Acc: 0.913 Test Loss: 0.425 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.158268690109253
Epoch: 25, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.420 Vali Acc: 0.913 Test Loss: 0.420 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.468833923339844
Epoch: 26, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.411 Vali Acc: 0.906 Test Loss: 0.411 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 4.315739870071411
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.421 Vali Acc: 0.913 Test Loss: 0.421 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 4.348181962966919
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.422 Vali Acc: 0.913 Test Loss: 0.422 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 4.14734959602356
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.427 Vali Acc: 0.913 Test Loss: 0.427 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 4.6372668743133545
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.423 Vali Acc: 0.913 Test Loss: 0.423 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 4.2364771366119385
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.418 Vali Acc: 0.913 Test Loss: 0.418 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma62_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 1006724
model size : 6.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         42                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.7044358253479
Epoch: 1, Steps: 9 | Train Loss: 1.433 Vali Loss: 1.367 Vali Acc: 0.326 Test Loss: 1.367 Test Acc: 0.326
Validation loss decreased (inf --> -0.326073).  Saving model ...
Epoch: 2 cost time: 3.6638715267181396
Epoch: 2, Steps: 9 | Train Loss: 1.294 Vali Loss: 1.237 Vali Acc: 0.399 Test Loss: 1.237 Test Acc: 0.399
Validation loss decreased (-0.326073 --> -0.398538).  Saving model ...
Epoch: 3 cost time: 4.237311840057373
Epoch: 3, Steps: 9 | Train Loss: 1.005 Vali Loss: 1.047 Vali Acc: 0.645 Test Loss: 1.047 Test Acc: 0.645
Validation loss decreased (-0.398538 --> -0.644917).  Saving model ...
Epoch: 4 cost time: 3.9121758937835693
Epoch: 4, Steps: 9 | Train Loss: 0.732 Vali Loss: 0.888 Vali Acc: 0.703 Test Loss: 0.888 Test Acc: 0.703
Validation loss decreased (-0.644917 --> -0.702890).  Saving model ...
Epoch: 5 cost time: 4.602441310882568
Epoch: 5, Steps: 9 | Train Loss: 0.514 Vali Loss: 0.779 Vali Acc: 0.761 Test Loss: 0.779 Test Acc: 0.761
Validation loss decreased (-0.702890 --> -0.760862).  Saving model ...
Epoch: 6 cost time: 4.508794784545898
Epoch: 6, Steps: 9 | Train Loss: 0.344 Vali Loss: 0.665 Vali Acc: 0.790 Test Loss: 0.665 Test Acc: 0.790
Validation loss decreased (-0.760862 --> -0.789848).  Saving model ...
Epoch: 7 cost time: 4.23661994934082
Epoch: 7, Steps: 9 | Train Loss: 0.208 Vali Loss: 0.554 Vali Acc: 0.826 Test Loss: 0.554 Test Acc: 0.826
Validation loss decreased (-0.789848 --> -0.826081).  Saving model ...
Epoch: 8 cost time: 3.761845827102661
Epoch: 8, Steps: 9 | Train Loss: 0.140 Vali Loss: 0.471 Vali Acc: 0.870 Test Loss: 0.471 Test Acc: 0.870
Validation loss decreased (-0.826081 --> -0.869561).  Saving model ...
Epoch: 9 cost time: 4.080395221710205
Epoch: 9, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.473 Vali Acc: 0.855 Test Loss: 0.473 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.634490489959717
Epoch: 10, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.405 Vali Acc: 0.891 Test Loss: 0.405 Test Acc: 0.891
Validation loss decreased (-0.869561 --> -0.891300).  Saving model ...
Epoch: 11 cost time: 4.049760580062866
Epoch: 11, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.382 Vali Acc: 0.899 Test Loss: 0.382 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898547).  Saving model ...
Epoch: 12 cost time: 3.773869276046753
Epoch: 12, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.427 Vali Acc: 0.891 Test Loss: 0.427 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.9485421180725098
Epoch: 13, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.383 Vali Acc: 0.899 Test Loss: 0.383 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.7618181705474854
Epoch: 14, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.391 Vali Acc: 0.906 Test Loss: 0.391 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905793).  Saving model ...
Epoch: 15 cost time: 4.044963598251343
Epoch: 15, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.379 Vali Acc: 0.906 Test Loss: 0.379 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905793).  Saving model ...
Epoch: 16 cost time: 3.5960161685943604
Epoch: 16, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.355 Vali Acc: 0.913 Test Loss: 0.355 Test Acc: 0.913
Validation loss decreased (-0.905793 --> -0.913040).  Saving model ...
Epoch: 17 cost time: 3.9111454486846924
Epoch: 17, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.368 Vali Acc: 0.906 Test Loss: 0.368 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.113245248794556
Epoch: 18, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.356 Vali Acc: 0.913 Test Loss: 0.356 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.3046183586120605
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.374 Vali Acc: 0.906 Test Loss: 0.374 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.052232265472412
Epoch: 20, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.367 Vali Acc: 0.906 Test Loss: 0.367 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.301713705062866
Epoch: 21, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.356 Vali Acc: 0.920 Test Loss: 0.356 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920286).  Saving model ...
Epoch: 22 cost time: 4.161429166793823
Epoch: 22, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.368 Vali Acc: 0.913 Test Loss: 0.368 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.034533500671387
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.367 Vali Acc: 0.906 Test Loss: 0.367 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.183070421218872
Epoch: 24, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.378 Vali Acc: 0.906 Test Loss: 0.378 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.995730400085449
Epoch: 25, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.360 Vali Acc: 0.920 Test Loss: 0.360 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.05844521522522
Epoch: 26, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.350 Vali Acc: 0.920 Test Loss: 0.350 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920286).  Saving model ...
Epoch: 27 cost time: 3.6628456115722656
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.363 Vali Acc: 0.913 Test Loss: 0.363 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.7427620887756348
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.370 Vali Acc: 0.913 Test Loss: 0.370 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.9709537029266357
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.372 Vali Acc: 0.913 Test Loss: 0.372 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.006030082702637
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.359 Vali Acc: 0.913 Test Loss: 0.359 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 4.120426654815674
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.354 Vali Acc: 0.920 Test Loss: 0.354 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.958576202392578
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.368 Vali Acc: 0.920 Test Loss: 0.368 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.8443498611450195
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.383 Vali Acc: 0.913 Test Loss: 0.383 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 4.426982641220093
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.370 Vali Acc: 0.913 Test Loss: 0.370 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 4.136118173599243
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.359 Vali Acc: 0.920 Test Loss: 0.359 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 4.435344934463501
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.360 Vali Acc: 0.920 Test Loss: 0.360 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 1006724
model size : 6.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.732071161270142
Epoch: 1, Steps: 9 | Train Loss: 1.430 Vali Loss: 1.363 Vali Acc: 0.254 Test Loss: 1.363 Test Acc: 0.254
Validation loss decreased (inf --> -0.253610).  Saving model ...
Epoch: 2 cost time: 3.7659506797790527
Epoch: 2, Steps: 9 | Train Loss: 1.268 Vali Loss: 1.234 Vali Acc: 0.428 Test Loss: 1.234 Test Acc: 0.428
Validation loss decreased (-0.253610 --> -0.427524).  Saving model ...
Epoch: 3 cost time: 3.4860458374023438
Epoch: 3, Steps: 9 | Train Loss: 0.996 Vali Loss: 1.054 Vali Acc: 0.652 Test Loss: 1.054 Test Acc: 0.652
Validation loss decreased (-0.427524 --> -0.652163).  Saving model ...
Epoch: 4 cost time: 3.5072848796844482
Epoch: 4, Steps: 9 | Train Loss: 0.736 Vali Loss: 0.892 Vali Acc: 0.732 Test Loss: 0.892 Test Acc: 0.732
Validation loss decreased (-0.652163 --> -0.731875).  Saving model ...
Epoch: 5 cost time: 3.4317069053649902
Epoch: 5, Steps: 9 | Train Loss: 0.510 Vali Loss: 0.757 Vali Acc: 0.812 Test Loss: 0.757 Test Acc: 0.812
Validation loss decreased (-0.731875 --> -0.811587).  Saving model ...
Epoch: 6 cost time: 3.6921401023864746
Epoch: 6, Steps: 9 | Train Loss: 0.347 Vali Loss: 0.623 Vali Acc: 0.826 Test Loss: 0.623 Test Acc: 0.826
Validation loss decreased (-0.811587 --> -0.826081).  Saving model ...
Epoch: 7 cost time: 3.753711223602295
Epoch: 7, Steps: 9 | Train Loss: 0.212 Vali Loss: 0.504 Vali Acc: 0.877 Test Loss: 0.504 Test Acc: 0.877
Validation loss decreased (-0.826081 --> -0.876807).  Saving model ...
Epoch: 8 cost time: 3.7027909755706787
Epoch: 8, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.406 Vali Acc: 0.906 Test Loss: 0.406 Test Acc: 0.906
Validation loss decreased (-0.876807 --> -0.905793).  Saving model ...
Epoch: 9 cost time: 3.87431001663208
Epoch: 9, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.374 Vali Acc: 0.913 Test Loss: 0.374 Test Acc: 0.913
Validation loss decreased (-0.905793 --> -0.913040).  Saving model ...
Epoch: 10 cost time: 3.698622465133667
Epoch: 10, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.340 Vali Acc: 0.906 Test Loss: 0.340 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.930736541748047
Epoch: 11, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.302 Vali Acc: 0.920 Test Loss: 0.302 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920287).  Saving model ...
Epoch: 12 cost time: 3.984001398086548
Epoch: 12, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.343 Vali Acc: 0.913 Test Loss: 0.343 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.64467716217041
Epoch: 13, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.296 Vali Acc: 0.913 Test Loss: 0.296 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.8162341117858887
Epoch: 14, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.312 Vali Acc: 0.920 Test Loss: 0.312 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.971872329711914
Epoch: 15, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.286 Vali Acc: 0.920 Test Loss: 0.286 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 16 cost time: 3.85977840423584
Epoch: 16, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.267 Vali Acc: 0.920 Test Loss: 0.267 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 17 cost time: 3.55430006980896
Epoch: 17, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.296 Vali Acc: 0.920 Test Loss: 0.296 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.6342248916625977
Epoch: 18, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.271 Vali Acc: 0.920 Test Loss: 0.271 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.607553720474243
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.265 Vali Acc: 0.920 Test Loss: 0.265 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 20 cost time: 3.419041395187378
Epoch: 20, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.280 Vali Acc: 0.920 Test Loss: 0.280 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.257373571395874
Epoch: 21, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.275 Vali Acc: 0.920 Test Loss: 0.275 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.6299960613250732
Epoch: 22, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.273 Vali Acc: 0.920 Test Loss: 0.273 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.5276801586151123
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.270 Vali Acc: 0.920 Test Loss: 0.270 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.8195745944976807
Epoch: 24, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.279 Vali Acc: 0.920 Test Loss: 0.279 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.630150556564331
Epoch: 25, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.269 Vali Acc: 0.920 Test Loss: 0.269 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.5971148014068604
Epoch: 26, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.256 Vali Acc: 0.920 Test Loss: 0.256 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 27 cost time: 3.646336078643799
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.266 Vali Acc: 0.920 Test Loss: 0.266 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.8092284202575684
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.267 Vali Acc: 0.920 Test Loss: 0.267 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.7122671604156494
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.275 Vali Acc: 0.920 Test Loss: 0.275 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.587564468383789
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.274 Vali Acc: 0.920 Test Loss: 0.274 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.634667158126831
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.272 Vali Acc: 0.920 Test Loss: 0.272 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.804697036743164
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.270 Vali Acc: 0.920 Test Loss: 0.270 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.661015272140503
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.276 Vali Acc: 0.920 Test Loss: 0.276 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.7295525074005127
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.264 Vali Acc: 0.920 Test Loss: 0.264 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.81022047996521
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.268 Vali Acc: 0.920 Test Loss: 0.268 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.574493169784546
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.273 Vali Acc: 0.920 Test Loss: 0.273 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 1006724
model size : 6.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.531950235366821
Epoch: 1, Steps: 9 | Train Loss: 1.402 Vali Loss: 1.369 Vali Acc: 0.333 Test Loss: 1.369 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 3.944190740585327
Epoch: 2, Steps: 9 | Train Loss: 1.284 Vali Loss: 1.251 Vali Acc: 0.435 Test Loss: 1.251 Test Acc: 0.435
Validation loss decreased (-0.333320 --> -0.434770).  Saving model ...
Epoch: 3 cost time: 3.7062318325042725
Epoch: 3, Steps: 9 | Train Loss: 1.021 Vali Loss: 1.078 Vali Acc: 0.609 Test Loss: 1.078 Test Acc: 0.609
Validation loss decreased (-0.434770 --> -0.608685).  Saving model ...
Epoch: 4 cost time: 3.697340726852417
Epoch: 4, Steps: 9 | Train Loss: 0.737 Vali Loss: 0.915 Vali Acc: 0.696 Test Loss: 0.915 Test Acc: 0.696
Validation loss decreased (-0.608685 --> -0.695643).  Saving model ...
Epoch: 5 cost time: 3.8917109966278076
Epoch: 5, Steps: 9 | Train Loss: 0.556 Vali Loss: 0.799 Vali Acc: 0.754 Test Loss: 0.799 Test Acc: 0.754
Validation loss decreased (-0.695643 --> -0.753615).  Saving model ...
Epoch: 6 cost time: 4.096707820892334
Epoch: 6, Steps: 9 | Train Loss: 0.388 Vali Loss: 0.693 Vali Acc: 0.761 Test Loss: 0.693 Test Acc: 0.761
Validation loss decreased (-0.753615 --> -0.760863).  Saving model ...
Epoch: 7 cost time: 3.8652498722076416
Epoch: 7, Steps: 9 | Train Loss: 0.274 Vali Loss: 0.600 Vali Acc: 0.797 Test Loss: 0.600 Test Acc: 0.797
Validation loss decreased (-0.760863 --> -0.797095).  Saving model ...
Epoch: 8 cost time: 3.779487133026123
Epoch: 8, Steps: 9 | Train Loss: 0.193 Vali Loss: 0.498 Vali Acc: 0.797 Test Loss: 0.498 Test Acc: 0.797
Validation loss decreased (-0.797095 --> -0.797096).  Saving model ...
Epoch: 9 cost time: 3.7350356578826904
Epoch: 9, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.507 Vali Acc: 0.804 Test Loss: 0.507 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804343).  Saving model ...
Epoch: 10 cost time: 3.8564822673797607
Epoch: 10, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.445 Vali Acc: 0.819 Test Loss: 0.445 Test Acc: 0.819
Validation loss decreased (-0.804343 --> -0.818836).  Saving model ...
Epoch: 11 cost time: 3.741762161254883
Epoch: 11, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.440 Vali Acc: 0.826 Test Loss: 0.440 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826083).  Saving model ...
Epoch: 12 cost time: 3.6913928985595703
Epoch: 12, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.436 Vali Acc: 0.833 Test Loss: 0.436 Test Acc: 0.833
Validation loss decreased (-0.826083 --> -0.833329).  Saving model ...
Epoch: 13 cost time: 3.96376895904541
Epoch: 13, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.420 Vali Acc: 0.841 Test Loss: 0.420 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840576).  Saving model ...
Epoch: 14 cost time: 3.8707969188690186
Epoch: 14, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.414 Vali Acc: 0.826 Test Loss: 0.414 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.778832197189331
Epoch: 15, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.400 Vali Acc: 0.841 Test Loss: 0.400 Test Acc: 0.841
Validation loss decreased (-0.840576 --> -0.840576).  Saving model ...
Epoch: 16 cost time: 4.208209037780762
Epoch: 16, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.397 Vali Acc: 0.833 Test Loss: 0.397 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.9276845455169678
Epoch: 17, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.398 Vali Acc: 0.841 Test Loss: 0.398 Test Acc: 0.841
Validation loss decreased (-0.840576 --> -0.840576).  Saving model ...
Epoch: 18 cost time: 4.073425769805908
Epoch: 18, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.381 Vali Acc: 0.841 Test Loss: 0.381 Test Acc: 0.841
Validation loss decreased (-0.840576 --> -0.840576).  Saving model ...
Epoch: 19 cost time: 3.9279844760894775
Epoch: 19, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.396 Vali Acc: 0.833 Test Loss: 0.396 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.874765634536743
Epoch: 20, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.385 Vali Acc: 0.833 Test Loss: 0.385 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.0103700160980225
Epoch: 21, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.390 Vali Acc: 0.848 Test Loss: 0.390 Test Acc: 0.848
Validation loss decreased (-0.840576 --> -0.847822).  Saving model ...
Epoch: 22 cost time: 3.980475664138794
Epoch: 22, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.392 Vali Acc: 0.841 Test Loss: 0.392 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.747208833694458
Epoch: 23, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.383 Vali Acc: 0.848 Test Loss: 0.383 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 24 cost time: 3.5103068351745605
Epoch: 24, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.398 Vali Acc: 0.848 Test Loss: 0.398 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.5160651206970215
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.391 Vali Acc: 0.848 Test Loss: 0.391 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.8175745010375977
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.388 Vali Acc: 0.848 Test Loss: 0.388 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.7273454666137695
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.384 Vali Acc: 0.848 Test Loss: 0.384 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.762397050857544
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.391 Vali Acc: 0.848 Test Loss: 0.391 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.7580082416534424
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.386 Vali Acc: 0.848 Test Loss: 0.386 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.5615875720977783
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.378 Vali Acc: 0.848 Test Loss: 0.378 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 31 cost time: 3.878925085067749
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.380 Vali Acc: 0.841 Test Loss: 0.380 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.911050319671631
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.394 Vali Acc: 0.848 Test Loss: 0.394 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 4.172898054122925
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.388 Vali Acc: 0.848 Test Loss: 0.388 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 4.044265270233154
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.369 Vali Acc: 0.862 Test Loss: 0.369 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862315).  Saving model ...
Epoch: 35 cost time: 4.200060844421387
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.372 Vali Acc: 0.862 Test Loss: 0.372 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 4.27520489692688
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.377 Vali Acc: 0.870 Test Loss: 0.377 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 37 cost time: 3.9683518409729004
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.377 Vali Acc: 0.870 Test Loss: 0.377 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 38 cost time: 3.953019618988037
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.377 Vali Acc: 0.855 Test Loss: 0.377 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.796761989593506
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.380 Vali Acc: 0.855 Test Loss: 0.380 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.6914923191070557
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.386 Vali Acc: 0.862 Test Loss: 0.386 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 3.6503548622131348
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.378 Vali Acc: 0.855 Test Loss: 0.378 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 3.639864444732666
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.377 Vali Acc: 0.855 Test Loss: 0.377 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 3.9556806087493896
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.386 Vali Acc: 0.862 Test Loss: 0.386 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 3.673243522644043
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.392 Vali Acc: 0.862 Test Loss: 0.392 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 4.2311882972717285
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.380 Vali Acc: 0.855 Test Loss: 0.380 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 4.563401699066162
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.378 Vali Acc: 0.855 Test Loss: 0.378 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 4.195234775543213
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.384 Vali Acc: 0.855 Test Loss: 0.384 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 1006724
model size : 6.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.175746202468872
Epoch: 1, Steps: 9 | Train Loss: 1.419 Vali Loss: 1.344 Vali Acc: 0.312 Test Loss: 1.344 Test Acc: 0.312
Validation loss decreased (inf --> -0.311581).  Saving model ...
Epoch: 2 cost time: 4.300137281417847
Epoch: 2, Steps: 9 | Train Loss: 1.292 Vali Loss: 1.202 Vali Acc: 0.500 Test Loss: 1.202 Test Acc: 0.500
Validation loss decreased (-0.311581 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 3.787425994873047
Epoch: 3, Steps: 9 | Train Loss: 0.972 Vali Loss: 1.054 Vali Acc: 0.609 Test Loss: 1.054 Test Acc: 0.609
Validation loss decreased (-0.499988 --> -0.608685).  Saving model ...
Epoch: 4 cost time: 4.0508739948272705
Epoch: 4, Steps: 9 | Train Loss: 0.727 Vali Loss: 0.909 Vali Acc: 0.667 Test Loss: 0.909 Test Acc: 0.667
Validation loss decreased (-0.608685 --> -0.666658).  Saving model ...
Epoch: 5 cost time: 3.6976349353790283
Epoch: 5, Steps: 9 | Train Loss: 0.550 Vali Loss: 0.823 Vali Acc: 0.710 Test Loss: 0.823 Test Acc: 0.710
Validation loss decreased (-0.666658 --> -0.710137).  Saving model ...
Epoch: 6 cost time: 3.611511468887329
Epoch: 6, Steps: 9 | Train Loss: 0.378 Vali Loss: 0.754 Vali Acc: 0.703 Test Loss: 0.754 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.943357467651367
Epoch: 7, Steps: 9 | Train Loss: 0.249 Vali Loss: 0.670 Vali Acc: 0.754 Test Loss: 0.670 Test Acc: 0.754
Validation loss decreased (-0.710137 --> -0.753616).  Saving model ...
Epoch: 8 cost time: 3.699537992477417
Epoch: 8, Steps: 9 | Train Loss: 0.176 Vali Loss: 0.617 Vali Acc: 0.768 Test Loss: 0.617 Test Acc: 0.768
Validation loss decreased (-0.753616 --> -0.768110).  Saving model ...
Epoch: 9 cost time: 3.7734804153442383
Epoch: 9, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.612 Vali Acc: 0.797 Test Loss: 0.612 Test Acc: 0.797
Validation loss decreased (-0.768110 --> -0.797095).  Saving model ...
Epoch: 10 cost time: 3.9925808906555176
Epoch: 10, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.581 Vali Acc: 0.775 Test Loss: 0.581 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.1758952140808105
Epoch: 11, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.563 Vali Acc: 0.790 Test Loss: 0.563 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.421043157577515
Epoch: 12, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.588 Vali Acc: 0.768 Test Loss: 0.588 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.294994115829468
Epoch: 13, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.601 Vali Acc: 0.804 Test Loss: 0.601 Test Acc: 0.804
Validation loss decreased (-0.797095 --> -0.804342).  Saving model ...
Epoch: 14 cost time: 4.148590803146362
Epoch: 14, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.599 Vali Acc: 0.768 Test Loss: 0.599 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.132159948348999
Epoch: 15, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.587 Vali Acc: 0.812 Test Loss: 0.587 Test Acc: 0.812
Validation loss decreased (-0.804342 --> -0.811588).  Saving model ...
Epoch: 16 cost time: 3.705458879470825
Epoch: 16, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.575 Vali Acc: 0.797 Test Loss: 0.575 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.8984928131103516
Epoch: 17, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.602 Vali Acc: 0.783 Test Loss: 0.602 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.8594751358032227
Epoch: 18, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.589 Vali Acc: 0.826 Test Loss: 0.589 Test Acc: 0.826
Validation loss decreased (-0.811588 --> -0.826081).  Saving model ...
Epoch: 19 cost time: 3.7736692428588867
Epoch: 19, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.589 Vali Acc: 0.812 Test Loss: 0.589 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.691786050796509
Epoch: 20, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.603 Vali Acc: 0.804 Test Loss: 0.603 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.7738256454467773
Epoch: 21, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.621 Vali Acc: 0.812 Test Loss: 0.621 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.8848156929016113
Epoch: 22, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.622 Vali Acc: 0.826 Test Loss: 0.622 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.857120990753174
Epoch: 23, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.612 Vali Acc: 0.819 Test Loss: 0.612 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.980863094329834
Epoch: 24, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.617 Vali Acc: 0.819 Test Loss: 0.617 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.639691114425659
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.627 Vali Acc: 0.804 Test Loss: 0.627 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.3260486125946045
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.616 Vali Acc: 0.833 Test Loss: 0.616 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833327).  Saving model ...
Epoch: 27 cost time: 4.043133735656738
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.623 Vali Acc: 0.797 Test Loss: 0.623 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.08387565612793
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.628 Vali Acc: 0.812 Test Loss: 0.628 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.204493761062622
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.634 Vali Acc: 0.812 Test Loss: 0.634 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.29550838470459
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.628 Vali Acc: 0.819 Test Loss: 0.628 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 4.026792287826538
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.627 Vali Acc: 0.819 Test Loss: 0.627 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 4.07280421257019
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.637 Vali Acc: 0.812 Test Loss: 0.637 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 4.181225061416626
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.642 Vali Acc: 0.812 Test Loss: 0.642 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 4.138502836227417
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.632 Vali Acc: 0.833 Test Loss: 0.632 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 4.00077223777771
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.633 Vali Acc: 0.826 Test Loss: 0.633 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.9564883708953857
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.630 Vali Acc: 0.833 Test Loss: 0.630 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 1006724
model size : 6.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.163219928741455
Epoch: 1, Steps: 9 | Train Loss: 1.401 Vali Loss: 1.438 Vali Acc: 0.225 Test Loss: 1.438 Test Acc: 0.225
Validation loss decreased (inf --> -0.224623).  Saving model ...
Epoch: 2 cost time: 3.898904800415039
Epoch: 2, Steps: 9 | Train Loss: 1.402 Vali Loss: 1.372 Vali Acc: 0.370 Test Loss: 1.372 Test Acc: 0.370
Validation loss decreased (-0.224623 --> -0.369551).  Saving model ...
Epoch: 3 cost time: 3.800267457962036
Epoch: 3, Steps: 9 | Train Loss: 1.119 Vali Loss: 1.322 Vali Acc: 0.370 Test Loss: 1.322 Test Acc: 0.370
Validation loss decreased (-0.369551 --> -0.369552).  Saving model ...
Epoch: 4 cost time: 3.779689311981201
Epoch: 4, Steps: 9 | Train Loss: 0.961 Vali Loss: 1.264 Vali Acc: 0.413 Test Loss: 1.264 Test Acc: 0.413
Validation loss decreased (-0.369552 --> -0.413031).  Saving model ...
Epoch: 5 cost time: 3.634127140045166
Epoch: 5, Steps: 9 | Train Loss: 0.809 Vali Loss: 1.192 Vali Acc: 0.457 Test Loss: 1.192 Test Acc: 0.457
Validation loss decreased (-0.413031 --> -0.456510).  Saving model ...
Epoch: 6 cost time: 3.9180591106414795
Epoch: 6, Steps: 9 | Train Loss: 0.658 Vali Loss: 1.128 Vali Acc: 0.507 Test Loss: 1.128 Test Acc: 0.507
Validation loss decreased (-0.456510 --> -0.507235).  Saving model ...
Epoch: 7 cost time: 3.698442220687866
Epoch: 7, Steps: 9 | Train Loss: 0.455 Vali Loss: 1.117 Vali Acc: 0.507 Test Loss: 1.117 Test Acc: 0.507
Validation loss decreased (-0.507235 --> -0.507235).  Saving model ...
Epoch: 8 cost time: 3.887453079223633
Epoch: 8, Steps: 9 | Train Loss: 0.320 Vali Loss: 1.145 Vali Acc: 0.493 Test Loss: 1.145 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.756925344467163
Epoch: 9, Steps: 9 | Train Loss: 0.227 Vali Loss: 1.126 Vali Acc: 0.514 Test Loss: 1.126 Test Acc: 0.514
Validation loss decreased (-0.507235 --> -0.514481).  Saving model ...
Epoch: 10 cost time: 3.844632863998413
Epoch: 10, Steps: 9 | Train Loss: 0.163 Vali Loss: 1.224 Vali Acc: 0.493 Test Loss: 1.224 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.538421630859375
Epoch: 11, Steps: 9 | Train Loss: 0.131 Vali Loss: 1.251 Vali Acc: 0.529 Test Loss: 1.251 Test Acc: 0.529
Validation loss decreased (-0.514481 --> -0.528973).  Saving model ...
Epoch: 12 cost time: 3.469780206680298
Epoch: 12, Steps: 9 | Train Loss: 0.084 Vali Loss: 1.323 Vali Acc: 0.529 Test Loss: 1.323 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.3036346435546875
Epoch: 13, Steps: 9 | Train Loss: 0.060 Vali Loss: 1.251 Vali Acc: 0.536 Test Loss: 1.251 Test Acc: 0.536
Validation loss decreased (-0.528973 --> -0.536219).  Saving model ...
Epoch: 14 cost time: 3.5977609157562256
Epoch: 14, Steps: 9 | Train Loss: 0.040 Vali Loss: 1.195 Vali Acc: 0.543 Test Loss: 1.195 Test Acc: 0.543
Validation loss decreased (-0.536219 --> -0.543466).  Saving model ...
Epoch: 15 cost time: 3.864025354385376
Epoch: 15, Steps: 9 | Train Loss: 0.031 Vali Loss: 1.524 Vali Acc: 0.514 Test Loss: 1.524 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.9943196773529053
Epoch: 16, Steps: 9 | Train Loss: 0.031 Vali Loss: 1.282 Vali Acc: 0.536 Test Loss: 1.282 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.9943490028381348
Epoch: 17, Steps: 9 | Train Loss: 0.020 Vali Loss: 1.350 Vali Acc: 0.558 Test Loss: 1.350 Test Acc: 0.558
Validation loss decreased (-0.543466 --> -0.557958).  Saving model ...
Epoch: 18 cost time: 3.74792742729187
Epoch: 18, Steps: 9 | Train Loss: 0.015 Vali Loss: 1.460 Vali Acc: 0.536 Test Loss: 1.460 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.087778091430664
Epoch: 19, Steps: 9 | Train Loss: 0.013 Vali Loss: 1.425 Vali Acc: 0.551 Test Loss: 1.425 Test Acc: 0.551
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.8796167373657227
Epoch: 20, Steps: 9 | Train Loss: 0.013 Vali Loss: 1.370 Vali Acc: 0.558 Test Loss: 1.370 Test Acc: 0.558
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.106013298034668
Epoch: 21, Steps: 9 | Train Loss: 0.010 Vali Loss: 1.392 Vali Acc: 0.551 Test Loss: 1.392 Test Acc: 0.551
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.9708216190338135
Epoch: 22, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.414 Vali Acc: 0.572 Test Loss: 1.414 Test Acc: 0.572
Validation loss decreased (-0.557958 --> -0.572450).  Saving model ...
Epoch: 23 cost time: 3.942150354385376
Epoch: 23, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.421 Vali Acc: 0.565 Test Loss: 1.421 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.0914552211761475
Epoch: 24, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.373 Vali Acc: 0.572 Test Loss: 1.373 Test Acc: 0.572
Validation loss decreased (-0.572450 --> -0.572450).  Saving model ...
Epoch: 25 cost time: 3.844956159591675
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.361 Vali Acc: 0.572 Test Loss: 1.361 Test Acc: 0.572
Validation loss decreased (-0.572450 --> -0.572450).  Saving model ...
Epoch: 26 cost time: 3.7907421588897705
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.405 Vali Acc: 0.587 Test Loss: 1.405 Test Acc: 0.587
Validation loss decreased (-0.572450 --> -0.586942).  Saving model ...
Epoch: 27 cost time: 3.726106643676758
Epoch: 27, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.474 Vali Acc: 0.580 Test Loss: 1.474 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.8581976890563965
Epoch: 28, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.421 Vali Acc: 0.601 Test Loss: 1.421 Test Acc: 0.601
Validation loss decreased (-0.586942 --> -0.601435).  Saving model ...
Epoch: 29 cost time: 3.5727837085723877
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.383 Vali Acc: 0.609 Test Loss: 1.383 Test Acc: 0.609
Validation loss decreased (-0.601435 --> -0.608682).  Saving model ...
Epoch: 30 cost time: 3.476996898651123
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.415 Vali Acc: 0.594 Test Loss: 1.415 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 4.123958349227905
Epoch: 31, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.426 Vali Acc: 0.594 Test Loss: 1.426 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.875605583190918
Epoch: 32, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.437 Vali Acc: 0.594 Test Loss: 1.437 Test Acc: 0.594
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 4.225663661956787
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.458 Vali Acc: 0.609 Test Loss: 1.458 Test Acc: 0.609
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 4.049622058868408
Epoch: 34, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.371 Vali Acc: 0.609 Test Loss: 1.371 Test Acc: 0.609
Validation loss decreased (-0.608682 --> -0.608682).  Saving model ...
Epoch: 35 cost time: 4.2542455196380615
Epoch: 35, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.354 Vali Acc: 0.601 Test Loss: 1.354 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 4.29721212387085
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.400 Vali Acc: 0.587 Test Loss: 1.400 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 4.248514175415039
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.390 Vali Acc: 0.601 Test Loss: 1.390 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 4.1839354038238525
Epoch: 38, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.398 Vali Acc: 0.594 Test Loss: 1.398 Test Acc: 0.594
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.7989394664764404
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.427 Vali Acc: 0.601 Test Loss: 1.427 Test Acc: 0.601
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 4.039227724075317
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.480 Vali Acc: 0.616 Test Loss: 1.480 Test Acc: 0.616
Validation loss decreased (-0.608682 --> -0.615927).  Saving model ...
Epoch: 41 cost time: 3.7954275608062744
Epoch: 41, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.425 Vali Acc: 0.609 Test Loss: 1.425 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 4.294415712356567
Epoch: 42, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.397 Vali Acc: 0.623 Test Loss: 1.397 Test Acc: 0.623
Validation loss decreased (-0.615927 --> -0.623174).  Saving model ...
Epoch: 43 cost time: 4.131710052490234
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.422 Vali Acc: 0.601 Test Loss: 1.422 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 4.01558518409729
Epoch: 44, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.451 Vali Acc: 0.594 Test Loss: 1.451 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 4.636899948120117
Epoch: 45, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.439 Vali Acc: 0.616 Test Loss: 1.439 Test Acc: 0.616
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 4.496160507202148
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.426 Vali Acc: 0.630 Test Loss: 1.426 Test Acc: 0.630
Validation loss decreased (-0.623174 --> -0.630421).  Saving model ...
Epoch: 47 cost time: 4.012103796005249
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.392 Vali Acc: 0.630 Test Loss: 1.392 Test Acc: 0.630
Validation loss decreased (-0.630421 --> -0.630421).  Saving model ...
Epoch: 48 cost time: 4.3090221881866455
Epoch: 48, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.407 Vali Acc: 0.623 Test Loss: 1.407 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 4.459510803222656
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.400 Vali Acc: 0.623 Test Loss: 1.400 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 4.759626150131226
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.457 Vali Acc: 0.616 Test Loss: 1.457 Test Acc: 0.616
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 4.476356744766235
Epoch: 51, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.427 Vali Acc: 0.623 Test Loss: 1.427 Test Acc: 0.623
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 3.922640800476074
Epoch: 52, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.345 Vali Acc: 0.638 Test Loss: 1.345 Test Acc: 0.638
Validation loss decreased (-0.630421 --> -0.637668).  Saving model ...
Epoch: 53 cost time: 4.03937554359436
Epoch: 53, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.344 Vali Acc: 0.638 Test Loss: 1.344 Test Acc: 0.638
Validation loss decreased (-0.637668 --> -0.637668).  Saving model ...
Epoch: 54 cost time: 4.145935297012329
Epoch: 54, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.391 Vali Acc: 0.645 Test Loss: 1.391 Test Acc: 0.645
Validation loss decreased (-0.637668 --> -0.644914).  Saving model ...
Epoch: 55 cost time: 3.982771158218384
Epoch: 55, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.407 Vali Acc: 0.638 Test Loss: 1.407 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 3.679482936859131
Epoch: 56, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.343 Vali Acc: 0.638 Test Loss: 1.343 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 3.7274186611175537
Epoch: 57, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.339 Vali Acc: 0.638 Test Loss: 1.339 Test Acc: 0.638
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 3.49336576461792
Epoch: 58, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.371 Vali Acc: 0.623 Test Loss: 1.371 Test Acc: 0.623
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 4.231159210205078
Epoch: 59, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.397 Vali Acc: 0.638 Test Loss: 1.397 Test Acc: 0.638
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 4.041199445724487
Epoch: 60, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.404 Vali Acc: 0.638 Test Loss: 1.404 Test Acc: 0.638
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 4.2844250202178955
Epoch: 61, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.391 Vali Acc: 0.630 Test Loss: 1.391 Test Acc: 0.630
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 3.9543535709381104
Epoch: 62, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.392 Vali Acc: 0.616 Test Loss: 1.392 Test Acc: 0.616
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 3.817553758621216
Epoch: 63, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.412 Vali Acc: 0.623 Test Loss: 1.412 Test Acc: 0.623
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 3.972477436065674
Epoch: 64, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.412 Vali Acc: 0.623 Test Loss: 1.412 Test Acc: 0.623
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.644927536231884
model parameter : 1006724
model size : 6.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.774152994155884
Epoch: 1, Steps: 9 | Train Loss: 1.458 Vali Loss: 1.466 Vali Acc: 0.254 Test Loss: 1.466 Test Acc: 0.254
Validation loss decreased (inf --> -0.253609).  Saving model ...
Epoch: 2 cost time: 3.317354202270508
Epoch: 2, Steps: 9 | Train Loss: 1.402 Vali Loss: 1.439 Vali Acc: 0.290 Test Loss: 1.439 Test Acc: 0.290
Validation loss decreased (-0.253609 --> -0.289841).  Saving model ...
Epoch: 3 cost time: 3.6274728775024414
Epoch: 3, Steps: 9 | Train Loss: 1.264 Vali Loss: 1.432 Vali Acc: 0.290 Test Loss: 1.432 Test Acc: 0.290
Validation loss decreased (-0.289841 --> -0.289841).  Saving model ...
Epoch: 4 cost time: 3.3974759578704834
Epoch: 4, Steps: 9 | Train Loss: 1.102 Vali Loss: 1.476 Vali Acc: 0.283 Test Loss: 1.476 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.6357803344726562
Epoch: 5, Steps: 9 | Train Loss: 1.060 Vali Loss: 1.505 Vali Acc: 0.304 Test Loss: 1.505 Test Acc: 0.304
Validation loss decreased (-0.289841 --> -0.304333).  Saving model ...
Epoch: 6 cost time: 3.3591597080230713
Epoch: 6, Steps: 9 | Train Loss: 0.930 Vali Loss: 1.499 Vali Acc: 0.304 Test Loss: 1.499 Test Acc: 0.304
Validation loss decreased (-0.304333 --> -0.304333).  Saving model ...
Epoch: 7 cost time: 3.5042922496795654
Epoch: 7, Steps: 9 | Train Loss: 0.732 Vali Loss: 1.644 Vali Acc: 0.333 Test Loss: 1.644 Test Acc: 0.333
Validation loss decreased (-0.304333 --> -0.333317).  Saving model ...
Epoch: 8 cost time: 3.6279945373535156
Epoch: 8, Steps: 9 | Train Loss: 0.591 Vali Loss: 1.978 Vali Acc: 0.312 Test Loss: 1.978 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.9423465728759766
Epoch: 9, Steps: 9 | Train Loss: 0.442 Vali Loss: 2.000 Vali Acc: 0.312 Test Loss: 2.000 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.699784755706787
Epoch: 10, Steps: 9 | Train Loss: 0.336 Vali Loss: 2.306 Vali Acc: 0.312 Test Loss: 2.306 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.5498547554016113
Epoch: 11, Steps: 9 | Train Loss: 0.292 Vali Loss: 2.504 Vali Acc: 0.319 Test Loss: 2.504 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.9166150093078613
Epoch: 12, Steps: 9 | Train Loss: 0.213 Vali Loss: 2.545 Vali Acc: 0.333 Test Loss: 2.545 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.418231725692749
Epoch: 13, Steps: 9 | Train Loss: 0.165 Vali Loss: 2.736 Vali Acc: 0.326 Test Loss: 2.736 Test Acc: 0.326
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.6660337448120117
Epoch: 14, Steps: 9 | Train Loss: 0.116 Vali Loss: 2.768 Vali Acc: 0.348 Test Loss: 2.768 Test Acc: 0.348
Validation loss decreased (-0.333317 --> -0.347798).  Saving model ...
Epoch: 15 cost time: 3.5701019763946533
Epoch: 15, Steps: 9 | Train Loss: 0.079 Vali Loss: 3.093 Vali Acc: 0.333 Test Loss: 3.093 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.3265509605407715
Epoch: 16, Steps: 9 | Train Loss: 0.077 Vali Loss: 2.917 Vali Acc: 0.355 Test Loss: 2.917 Test Acc: 0.355
Validation loss decreased (-0.347798 --> -0.355043).  Saving model ...
Epoch: 17 cost time: 3.9417035579681396
Epoch: 17, Steps: 9 | Train Loss: 0.044 Vali Loss: 2.810 Vali Acc: 0.333 Test Loss: 2.810 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.557596206665039
Epoch: 18, Steps: 9 | Train Loss: 0.040 Vali Loss: 3.017 Vali Acc: 0.348 Test Loss: 3.017 Test Acc: 0.348
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.7124247550964355
Epoch: 19, Steps: 9 | Train Loss: 0.031 Vali Loss: 3.140 Vali Acc: 0.341 Test Loss: 3.140 Test Acc: 0.341
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.8843650817871094
Epoch: 20, Steps: 9 | Train Loss: 0.025 Vali Loss: 2.883 Vali Acc: 0.348 Test Loss: 2.883 Test Acc: 0.348
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.6616055965423584
Epoch: 21, Steps: 9 | Train Loss: 0.022 Vali Loss: 3.064 Vali Acc: 0.341 Test Loss: 3.064 Test Acc: 0.341
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.091663122177124
Epoch: 22, Steps: 9 | Train Loss: 0.022 Vali Loss: 3.072 Vali Acc: 0.362 Test Loss: 3.072 Test Acc: 0.362
Validation loss decreased (-0.355043 --> -0.362288).  Saving model ...
Epoch: 23 cost time: 4.078389883041382
Epoch: 23, Steps: 9 | Train Loss: 0.015 Vali Loss: 2.907 Vali Acc: 0.362 Test Loss: 2.907 Test Acc: 0.362
Validation loss decreased (-0.362288 --> -0.362290).  Saving model ...
Epoch: 24 cost time: 3.7963945865631104
Epoch: 24, Steps: 9 | Train Loss: 0.015 Vali Loss: 2.798 Vali Acc: 0.370 Test Loss: 2.798 Test Acc: 0.370
Validation loss decreased (-0.362290 --> -0.369537).  Saving model ...
Epoch: 25 cost time: 3.633770704269409
Epoch: 25, Steps: 9 | Train Loss: 0.011 Vali Loss: 3.106 Vali Acc: 0.362 Test Loss: 3.106 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.5136189460754395
Epoch: 26, Steps: 9 | Train Loss: 0.013 Vali Loss: 3.111 Vali Acc: 0.348 Test Loss: 3.111 Test Acc: 0.348
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.5960309505462646
Epoch: 27, Steps: 9 | Train Loss: 0.011 Vali Loss: 2.788 Vali Acc: 0.377 Test Loss: 2.788 Test Acc: 0.377
Validation loss decreased (-0.369537 --> -0.376784).  Saving model ...
Epoch: 28 cost time: 3.7481164932250977
Epoch: 28, Steps: 9 | Train Loss: 0.009 Vali Loss: 2.922 Vali Acc: 0.377 Test Loss: 2.922 Test Acc: 0.377
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.614332437515259
Epoch: 29, Steps: 9 | Train Loss: 0.008 Vali Loss: 3.111 Vali Acc: 0.377 Test Loss: 3.111 Test Acc: 0.377
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.69697642326355
Epoch: 30, Steps: 9 | Train Loss: 0.009 Vali Loss: 3.189 Vali Acc: 0.377 Test Loss: 3.189 Test Acc: 0.377
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.959836721420288
Epoch: 31, Steps: 9 | Train Loss: 0.006 Vali Loss: 2.979 Vali Acc: 0.391 Test Loss: 2.979 Test Acc: 0.391
Validation loss decreased (-0.376784 --> -0.391275).  Saving model ...
Epoch: 32 cost time: 3.773883104324341
Epoch: 32, Steps: 9 | Train Loss: 0.007 Vali Loss: 3.054 Vali Acc: 0.391 Test Loss: 3.054 Test Acc: 0.391
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.754666328430176
Epoch: 33, Steps: 9 | Train Loss: 0.007 Vali Loss: 3.014 Vali Acc: 0.399 Test Loss: 3.014 Test Acc: 0.399
Validation loss decreased (-0.391275 --> -0.398521).  Saving model ...
Epoch: 34 cost time: 4.292724132537842
Epoch: 34, Steps: 9 | Train Loss: 0.005 Vali Loss: 3.080 Vali Acc: 0.377 Test Loss: 3.080 Test Acc: 0.377
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.9577996730804443
Epoch: 35, Steps: 9 | Train Loss: 0.005 Vali Loss: 3.074 Vali Acc: 0.377 Test Loss: 3.074 Test Acc: 0.377
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.7009623050689697
Epoch: 36, Steps: 9 | Train Loss: 0.005 Vali Loss: 3.220 Vali Acc: 0.377 Test Loss: 3.220 Test Acc: 0.377
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.991610527038574
Epoch: 37, Steps: 9 | Train Loss: 0.004 Vali Loss: 3.130 Vali Acc: 0.391 Test Loss: 3.130 Test Acc: 0.391
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.939688205718994
Epoch: 38, Steps: 9 | Train Loss: 0.004 Vali Loss: 2.965 Vali Acc: 0.406 Test Loss: 2.965 Test Acc: 0.406
Validation loss decreased (-0.398521 --> -0.405767).  Saving model ...
Epoch: 39 cost time: 3.6770219802856445
Epoch: 39, Steps: 9 | Train Loss: 0.003 Vali Loss: 2.904 Vali Acc: 0.399 Test Loss: 2.904 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.6541237831115723
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.979 Vali Acc: 0.399 Test Loss: 2.979 Test Acc: 0.399
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.94036865234375
Epoch: 41, Steps: 9 | Train Loss: 0.003 Vali Loss: 3.053 Vali Acc: 0.399 Test Loss: 3.053 Test Acc: 0.399
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.7492387294769287
Epoch: 42, Steps: 9 | Train Loss: 0.003 Vali Loss: 3.027 Vali Acc: 0.399 Test Loss: 3.027 Test Acc: 0.399
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 3.6379165649414062
Epoch: 43, Steps: 9 | Train Loss: 0.003 Vali Loss: 3.078 Vali Acc: 0.399 Test Loss: 3.078 Test Acc: 0.399
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 3.8135740756988525
Epoch: 44, Steps: 9 | Train Loss: 0.003 Vali Loss: 3.119 Vali Acc: 0.399 Test Loss: 3.119 Test Acc: 0.399
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 3.588712453842163
Epoch: 45, Steps: 9 | Train Loss: 0.003 Vali Loss: 3.107 Vali Acc: 0.399 Test Loss: 3.107 Test Acc: 0.399
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 3.843294620513916
Epoch: 46, Steps: 9 | Train Loss: 0.002 Vali Loss: 3.008 Vali Acc: 0.399 Test Loss: 3.008 Test Acc: 0.399
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 3.8382134437561035
Epoch: 47, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.891 Vali Acc: 0.399 Test Loss: 2.891 Test Acc: 0.399
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 3.913886308670044
Epoch: 48, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.888 Vali Acc: 0.406 Test Loss: 2.888 Test Acc: 0.406
Validation loss decreased (-0.405767 --> -0.405768).  Saving model ...
Epoch: 49 cost time: 3.8653953075408936
Epoch: 49, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.873 Vali Acc: 0.413 Test Loss: 2.873 Test Acc: 0.413
Validation loss decreased (-0.405768 --> -0.413015).  Saving model ...
Epoch: 50 cost time: 3.8178019523620605
Epoch: 50, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.967 Vali Acc: 0.413 Test Loss: 2.967 Test Acc: 0.413
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 4.459653854370117
Epoch: 51, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.980 Vali Acc: 0.413 Test Loss: 2.980 Test Acc: 0.413
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 3.9211018085479736
Epoch: 52, Steps: 9 | Train Loss: 0.002 Vali Loss: 2.946 Vali Acc: 0.420 Test Loss: 2.946 Test Acc: 0.420
Validation loss decreased (-0.413015 --> -0.420260).  Saving model ...
Epoch: 53 cost time: 3.8399369716644287
Epoch: 53, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.971 Vali Acc: 0.420 Test Loss: 2.971 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 3.9082462787628174
Epoch: 54, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.994 Vali Acc: 0.413 Test Loss: 2.994 Test Acc: 0.413
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 3.531693696975708
Epoch: 55, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.963 Vali Acc: 0.420 Test Loss: 2.963 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 3.6808080673217773
Epoch: 56, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.928 Vali Acc: 0.420 Test Loss: 2.928 Test Acc: 0.420
Validation loss decreased (-0.420260 --> -0.420261).  Saving model ...
Epoch: 57 cost time: 3.514024257659912
Epoch: 57, Steps: 9 | Train Loss: 0.001 Vali Loss: 3.043 Vali Acc: 0.413 Test Loss: 3.043 Test Acc: 0.413
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 3.717085361480713
Epoch: 58, Steps: 9 | Train Loss: 0.001 Vali Loss: 3.045 Vali Acc: 0.413 Test Loss: 3.045 Test Acc: 0.413
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 3.765881061553955
Epoch: 59, Steps: 9 | Train Loss: 0.001 Vali Loss: 3.090 Vali Acc: 0.420 Test Loss: 3.090 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 3.3592443466186523
Epoch: 60, Steps: 9 | Train Loss: 0.001 Vali Loss: 3.044 Vali Acc: 0.420 Test Loss: 3.044 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 3.7490005493164062
Epoch: 61, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.932 Vali Acc: 0.420 Test Loss: 2.932 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 4.395035028457642
Epoch: 62, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.947 Vali Acc: 0.420 Test Loss: 2.947 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 3.8698151111602783
Epoch: 63, Steps: 9 | Train Loss: 0.001 Vali Loss: 3.010 Vali Acc: 0.420 Test Loss: 3.010 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 3.8744099140167236
Epoch: 64, Steps: 9 | Train Loss: 0.001 Vali Loss: 3.046 Vali Acc: 0.406 Test Loss: 3.046 Test Acc: 0.406
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 3.8497679233551025
Epoch: 65, Steps: 9 | Train Loss: 0.001 Vali Loss: 3.019 Vali Acc: 0.413 Test Loss: 3.019 Test Acc: 0.413
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 3.842966318130493
Epoch: 66, Steps: 9 | Train Loss: 0.001 Vali Loss: 2.983 Vali Acc: 0.413 Test Loss: 2.983 Test Acc: 0.413
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.42028985507246375
model parameter : 1006724
model size : 6.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.674910068511963
Epoch: 1, Steps: 9 | Train Loss: 1.498 Vali Loss: 1.414 Vali Acc: 0.261 Test Loss: 1.414 Test Acc: 0.261
Validation loss decreased (inf --> -0.260855).  Saving model ...
Epoch: 2 cost time: 3.9219160079956055
Epoch: 2, Steps: 9 | Train Loss: 1.393 Vali Loss: 1.373 Vali Acc: 0.341 Test Loss: 1.373 Test Acc: 0.341
Validation loss decreased (-0.260855 --> -0.340566).  Saving model ...
Epoch: 3 cost time: 3.762983560562134
Epoch: 3, Steps: 9 | Train Loss: 1.221 Vali Loss: 1.346 Vali Acc: 0.326 Test Loss: 1.346 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.000736951828003
Epoch: 4, Steps: 9 | Train Loss: 1.122 Vali Loss: 1.333 Vali Acc: 0.297 Test Loss: 1.333 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.9646365642547607
Epoch: 5, Steps: 9 | Train Loss: 0.967 Vali Loss: 1.303 Vali Acc: 0.312 Test Loss: 1.303 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.5252089500427246
Epoch: 6, Steps: 9 | Train Loss: 0.856 Vali Loss: 1.272 Vali Acc: 0.326 Test Loss: 1.272 Test Acc: 0.326
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.6060633659362793
Epoch: 7, Steps: 9 | Train Loss: 0.657 Vali Loss: 1.301 Vali Acc: 0.319 Test Loss: 1.301 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.9772284030914307
Epoch: 8, Steps: 9 | Train Loss: 0.537 Vali Loss: 1.494 Vali Acc: 0.275 Test Loss: 1.494 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.967352867126465
Epoch: 9, Steps: 9 | Train Loss: 0.398 Vali Loss: 1.434 Vali Acc: 0.348 Test Loss: 1.434 Test Acc: 0.348
Validation loss decreased (-0.340566 --> -0.347812).  Saving model ...
Epoch: 10 cost time: 3.9030978679656982
Epoch: 10, Steps: 9 | Train Loss: 0.301 Vali Loss: 1.524 Vali Acc: 0.348 Test Loss: 1.524 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.265887260437012
Epoch: 11, Steps: 9 | Train Loss: 0.221 Vali Loss: 1.693 Vali Acc: 0.341 Test Loss: 1.693 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.8113439083099365
Epoch: 12, Steps: 9 | Train Loss: 0.163 Vali Loss: 1.631 Vali Acc: 0.348 Test Loss: 1.631 Test Acc: 0.348
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.607290267944336
Epoch: 13, Steps: 9 | Train Loss: 0.114 Vali Loss: 1.819 Vali Acc: 0.377 Test Loss: 1.819 Test Acc: 0.377
Validation loss decreased (-0.347812 --> -0.376793).  Saving model ...
Epoch: 14 cost time: 4.081406354904175
Epoch: 14, Steps: 9 | Train Loss: 0.079 Vali Loss: 1.786 Vali Acc: 0.370 Test Loss: 1.786 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.026938199996948
Epoch: 15, Steps: 9 | Train Loss: 0.061 Vali Loss: 1.971 Vali Acc: 0.399 Test Loss: 1.971 Test Acc: 0.399
Validation loss decreased (-0.376793 --> -0.398531).  Saving model ...
Epoch: 16 cost time: 3.864375114440918
Epoch: 16, Steps: 9 | Train Loss: 0.053 Vali Loss: 2.039 Vali Acc: 0.355 Test Loss: 2.039 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.9784867763519287
Epoch: 17, Steps: 9 | Train Loss: 0.033 Vali Loss: 1.651 Vali Acc: 0.413 Test Loss: 1.651 Test Acc: 0.413
Validation loss decreased (-0.398531 --> -0.413027).  Saving model ...
Epoch: 18 cost time: 3.7891974449157715
Epoch: 18, Steps: 9 | Train Loss: 0.030 Vali Loss: 1.981 Vali Acc: 0.399 Test Loss: 1.981 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.930718183517456
Epoch: 19, Steps: 9 | Train Loss: 0.023 Vali Loss: 2.016 Vali Acc: 0.384 Test Loss: 2.016 Test Acc: 0.384
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.7968366146087646
Epoch: 20, Steps: 9 | Train Loss: 0.021 Vali Loss: 1.684 Vali Acc: 0.428 Test Loss: 1.684 Test Acc: 0.428
Validation loss decreased (-0.413027 --> -0.427519).  Saving model ...
Epoch: 21 cost time: 4.092350244522095
Epoch: 21, Steps: 9 | Train Loss: 0.017 Vali Loss: 1.844 Vali Acc: 0.428 Test Loss: 1.844 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.145543336868286
Epoch: 22, Steps: 9 | Train Loss: 0.015 Vali Loss: 2.035 Vali Acc: 0.413 Test Loss: 2.035 Test Acc: 0.413
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.892292022705078
Epoch: 23, Steps: 9 | Train Loss: 0.011 Vali Loss: 1.877 Vali Acc: 0.391 Test Loss: 1.877 Test Acc: 0.391
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.35774302482605
Epoch: 24, Steps: 9 | Train Loss: 0.013 Vali Loss: 1.765 Vali Acc: 0.413 Test Loss: 1.765 Test Acc: 0.413
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.290698051452637
Epoch: 25, Steps: 9 | Train Loss: 0.009 Vali Loss: 2.022 Vali Acc: 0.428 Test Loss: 2.022 Test Acc: 0.428
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.229472398757935
Epoch: 26, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.901 Vali Acc: 0.406 Test Loss: 1.901 Test Acc: 0.406
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.8323042392730713
Epoch: 27, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.735 Vali Acc: 0.428 Test Loss: 1.735 Test Acc: 0.428
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.876107692718506
Epoch: 28, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.769 Vali Acc: 0.428 Test Loss: 1.769 Test Acc: 0.428
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.030258655548096
Epoch: 29, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.893 Vali Acc: 0.435 Test Loss: 1.893 Test Acc: 0.435
Validation loss decreased (-0.427519 --> -0.434764).  Saving model ...
Epoch: 30 cost time: 3.698270320892334
Epoch: 30, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.937 Vali Acc: 0.435 Test Loss: 1.937 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.8666763305664062
Epoch: 31, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.860 Vali Acc: 0.428 Test Loss: 1.860 Test Acc: 0.428
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 4.032750368118286
Epoch: 32, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.863 Vali Acc: 0.449 Test Loss: 1.863 Test Acc: 0.449
Validation loss decreased (-0.434764 --> -0.449257).  Saving model ...
Epoch: 33 cost time: 3.599116563796997
Epoch: 33, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.813 Vali Acc: 0.457 Test Loss: 1.813 Test Acc: 0.457
Validation loss decreased (-0.449257 --> -0.456504).  Saving model ...
Epoch: 34 cost time: 3.581723928451538
Epoch: 34, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.799 Vali Acc: 0.457 Test Loss: 1.799 Test Acc: 0.457
Validation loss decreased (-0.456504 --> -0.456504).  Saving model ...
Epoch: 35 cost time: 3.692567825317383
Epoch: 35, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.856 Vali Acc: 0.464 Test Loss: 1.856 Test Acc: 0.464
Validation loss decreased (-0.456504 --> -0.463750).  Saving model ...
Epoch: 36 cost time: 3.813837766647339
Epoch: 36, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.837 Vali Acc: 0.471 Test Loss: 1.837 Test Acc: 0.471
Validation loss decreased (-0.463750 --> -0.470996).  Saving model ...
Epoch: 37 cost time: 3.742173194885254
Epoch: 37, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.790 Vali Acc: 0.464 Test Loss: 1.790 Test Acc: 0.464
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 4.014755725860596
Epoch: 38, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.779 Vali Acc: 0.464 Test Loss: 1.779 Test Acc: 0.464
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 4.00626802444458
Epoch: 39, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.715 Vali Acc: 0.464 Test Loss: 1.715 Test Acc: 0.464
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 4.193785905838013
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.756 Vali Acc: 0.464 Test Loss: 1.756 Test Acc: 0.464
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 3.9437055587768555
Epoch: 41, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.804 Vali Acc: 0.464 Test Loss: 1.804 Test Acc: 0.464
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 4.042148590087891
Epoch: 42, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.843 Vali Acc: 0.471 Test Loss: 1.843 Test Acc: 0.471
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 3.8635289669036865
Epoch: 43, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.880 Vali Acc: 0.471 Test Loss: 1.880 Test Acc: 0.471
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 3.826619863510132
Epoch: 44, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.858 Vali Acc: 0.478 Test Loss: 1.858 Test Acc: 0.478
Validation loss decreased (-0.470996 --> -0.478242).  Saving model ...
Epoch: 45 cost time: 3.8929786682128906
Epoch: 45, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.773 Vali Acc: 0.486 Test Loss: 1.773 Test Acc: 0.486
Validation loss decreased (-0.478242 --> -0.485490).  Saving model ...
Epoch: 46 cost time: 3.8507466316223145
Epoch: 46, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.710 Vali Acc: 0.471 Test Loss: 1.710 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.63069748878479
Epoch: 47, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.698 Vali Acc: 0.478 Test Loss: 1.698 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 3.6854610443115234
Epoch: 48, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.768 Vali Acc: 0.493 Test Loss: 1.768 Test Acc: 0.493
Validation loss decreased (-0.485490 --> -0.492736).  Saving model ...
Epoch: 49 cost time: 4.102912902832031
Epoch: 49, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.797 Vali Acc: 0.493 Test Loss: 1.797 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 4.437196731567383
Epoch: 50, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.819 Vali Acc: 0.486 Test Loss: 1.819 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 4.269020080566406
Epoch: 51, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.744 Vali Acc: 0.493 Test Loss: 1.744 Test Acc: 0.493
Validation loss decreased (-0.492736 --> -0.492736).  Saving model ...
Epoch: 52 cost time: 4.211172103881836
Epoch: 52, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.695 Vali Acc: 0.500 Test Loss: 1.695 Test Acc: 0.500
Validation loss decreased (-0.492736 --> -0.499983).  Saving model ...
Epoch: 53 cost time: 4.09174108505249
Epoch: 53, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.746 Vali Acc: 0.493 Test Loss: 1.746 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 4.3761255741119385
Epoch: 54, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.795 Vali Acc: 0.486 Test Loss: 1.795 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 4.0909600257873535
Epoch: 55, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.803 Vali Acc: 0.471 Test Loss: 1.803 Test Acc: 0.471
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 4.242730617523193
Epoch: 56, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.739 Vali Acc: 0.471 Test Loss: 1.739 Test Acc: 0.471
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 4.100274324417114
Epoch: 57, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.773 Vali Acc: 0.493 Test Loss: 1.773 Test Acc: 0.493
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 3.8268401622772217
Epoch: 58, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.778 Vali Acc: 0.522 Test Loss: 1.778 Test Acc: 0.522
Validation loss decreased (-0.499983 --> -0.521721).  Saving model ...
Epoch: 59 cost time: 4.267515182495117
Epoch: 59, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.779 Vali Acc: 0.500 Test Loss: 1.779 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 3.5895557403564453
Epoch: 60, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.785 Vali Acc: 0.500 Test Loss: 1.785 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 3.593648910522461
Epoch: 61, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.745 Vali Acc: 0.500 Test Loss: 1.745 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 3.700906276702881
Epoch: 62, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.780 Vali Acc: 0.500 Test Loss: 1.780 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 3.673902750015259
Epoch: 63, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.935 Vali Acc: 0.500 Test Loss: 1.935 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 3.9221482276916504
Epoch: 64, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.976 Vali Acc: 0.507 Test Loss: 1.976 Test Acc: 0.507
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 3.918283700942993
Epoch: 65, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.882 Vali Acc: 0.507 Test Loss: 1.882 Test Acc: 0.507
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 4.018773794174194
Epoch: 66, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.796 Vali Acc: 0.500 Test Loss: 1.796 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 3.977234363555908
Epoch: 67, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.773 Vali Acc: 0.507 Test Loss: 1.773 Test Acc: 0.507
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 4.004172086715698
Epoch: 68, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.818 Vali Acc: 0.500 Test Loss: 1.818 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5217391304347826
model parameter : 1006724
model size : 6.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         103                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma103_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.370940685272217
Epoch: 1, Steps: 9 | Train Loss: 1.373 Vali Loss: 1.336 Vali Acc: 0.391 Test Loss: 1.336 Test Acc: 0.391
Validation loss decreased (inf --> -0.391291).  Saving model ...
Epoch: 2 cost time: 3.6969330310821533
Epoch: 2, Steps: 9 | Train Loss: 1.237 Vali Loss: 1.217 Vali Acc: 0.486 Test Loss: 1.217 Test Acc: 0.486
Validation loss decreased (-0.391291 --> -0.485495).  Saving model ...
Epoch: 3 cost time: 3.7218618392944336
Epoch: 3, Steps: 9 | Train Loss: 1.028 Vali Loss: 1.067 Vali Acc: 0.630 Test Loss: 1.067 Test Acc: 0.630
Validation loss decreased (-0.485495 --> -0.630424).  Saving model ...
Epoch: 4 cost time: 3.661071538925171
Epoch: 4, Steps: 9 | Train Loss: 0.754 Vali Loss: 0.949 Vali Acc: 0.688 Test Loss: 0.949 Test Acc: 0.688
Validation loss decreased (-0.630424 --> -0.688396).  Saving model ...
Epoch: 5 cost time: 3.978756904602051
Epoch: 5, Steps: 9 | Train Loss: 0.543 Vali Loss: 0.823 Vali Acc: 0.717 Test Loss: 0.823 Test Acc: 0.717
Validation loss decreased (-0.688396 --> -0.717383).  Saving model ...
Epoch: 6 cost time: 3.845867872238159
Epoch: 6, Steps: 9 | Train Loss: 0.378 Vali Loss: 0.718 Vali Acc: 0.754 Test Loss: 0.718 Test Acc: 0.754
Validation loss decreased (-0.717383 --> -0.753616).  Saving model ...
Epoch: 7 cost time: 3.9999659061431885
Epoch: 7, Steps: 9 | Train Loss: 0.257 Vali Loss: 0.628 Vali Acc: 0.804 Test Loss: 0.628 Test Acc: 0.804
Validation loss decreased (-0.753616 --> -0.804342).  Saving model ...
Epoch: 8 cost time: 4.022604942321777
Epoch: 8, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.536 Vali Acc: 0.833 Test Loss: 0.536 Test Acc: 0.833
Validation loss decreased (-0.804342 --> -0.833328).  Saving model ...
Epoch: 9 cost time: 4.083418130874634
Epoch: 9, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.528 Vali Acc: 0.841 Test Loss: 0.528 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840574).  Saving model ...
Epoch: 10 cost time: 3.977264642715454
Epoch: 10, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.483 Vali Acc: 0.848 Test Loss: 0.483 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847821).  Saving model ...
Epoch: 11 cost time: 3.8127851486206055
Epoch: 11, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.463 Vali Acc: 0.841 Test Loss: 0.463 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.75173020362854
Epoch: 12, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.475 Vali Acc: 0.848 Test Loss: 0.475 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 13 cost time: 3.640552043914795
Epoch: 13, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.462 Vali Acc: 0.855 Test Loss: 0.462 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 14 cost time: 3.820282220840454
Epoch: 14, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.452 Vali Acc: 0.841 Test Loss: 0.452 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.8509910106658936
Epoch: 15, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.454 Vali Acc: 0.833 Test Loss: 0.454 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.532395839691162
Epoch: 16, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.460 Vali Acc: 0.848 Test Loss: 0.460 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.5517449378967285
Epoch: 17, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.451 Vali Acc: 0.848 Test Loss: 0.451 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.552095413208008
Epoch: 18, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.441 Vali Acc: 0.848 Test Loss: 0.441 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.6787450313568115
Epoch: 19, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.450 Vali Acc: 0.841 Test Loss: 0.450 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.5442545413970947
Epoch: 20, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.454 Vali Acc: 0.855 Test Loss: 0.454 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 21 cost time: 3.718269109725952
Epoch: 21, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.443 Vali Acc: 0.848 Test Loss: 0.443 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.6549155712127686
Epoch: 22, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.449 Vali Acc: 0.848 Test Loss: 0.449 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.949483871459961
Epoch: 23, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.452 Vali Acc: 0.855 Test Loss: 0.452 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 24 cost time: 4.21928334236145
Epoch: 24, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.447 Vali Acc: 0.862 Test Loss: 0.447 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 25 cost time: 4.0619215965271
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.451 Vali Acc: 0.855 Test Loss: 0.451 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.323072195053101
Epoch: 26, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.454 Vali Acc: 0.855 Test Loss: 0.454 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.211876630783081
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.460 Vali Acc: 0.877 Test Loss: 0.460 Test Acc: 0.877
Validation loss decreased (-0.862314 --> -0.876807).  Saving model ...
Epoch: 28 cost time: 4.290542364120483
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.455 Vali Acc: 0.862 Test Loss: 0.455 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.02510929107666
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.455 Vali Acc: 0.870 Test Loss: 0.455 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 4.033646821975708
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.454 Vali Acc: 0.870 Test Loss: 0.454 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.9751741886138916
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.450 Vali Acc: 0.870 Test Loss: 0.450 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 4.174719333648682
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.449 Vali Acc: 0.870 Test Loss: 0.449 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 4.185138463973999
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.459 Vali Acc: 0.870 Test Loss: 0.459 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 4.252120494842529
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.456 Vali Acc: 0.870 Test Loss: 0.456 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 4.232689619064331
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.447 Vali Acc: 0.870 Test Loss: 0.447 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 4.159406423568726
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.452 Vali Acc: 0.870 Test Loss: 0.452 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 4.020912170410156
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.458 Vali Acc: 0.870 Test Loss: 0.458 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma103_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 613508
model size : 4.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         83                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma83_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.730159759521484
Epoch: 1, Steps: 9 | Train Loss: 1.379 Vali Loss: 1.335 Vali Acc: 0.362 Test Loss: 1.335 Test Acc: 0.362
Validation loss decreased (inf --> -0.362305).  Saving model ...
Epoch: 2 cost time: 4.096753358840942
Epoch: 2, Steps: 9 | Train Loss: 1.246 Vali Loss: 1.218 Vali Acc: 0.500 Test Loss: 1.218 Test Acc: 0.500
Validation loss decreased (-0.362305 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 3.6324594020843506
Epoch: 3, Steps: 9 | Train Loss: 1.025 Vali Loss: 1.062 Vali Acc: 0.688 Test Loss: 1.062 Test Acc: 0.688
Validation loss decreased (-0.499988 --> -0.688395).  Saving model ...
Epoch: 4 cost time: 3.852663993835449
Epoch: 4, Steps: 9 | Train Loss: 0.763 Vali Loss: 0.943 Vali Acc: 0.674 Test Loss: 0.943 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.5912861824035645
Epoch: 5, Steps: 9 | Train Loss: 0.550 Vali Loss: 0.815 Vali Acc: 0.732 Test Loss: 0.815 Test Acc: 0.732
Validation loss decreased (-0.688395 --> -0.731876).  Saving model ...
Epoch: 6 cost time: 3.509274482727051
Epoch: 6, Steps: 9 | Train Loss: 0.381 Vali Loss: 0.697 Vali Acc: 0.797 Test Loss: 0.697 Test Acc: 0.797
Validation loss decreased (-0.731876 --> -0.797094).  Saving model ...
Epoch: 7 cost time: 3.3174326419830322
Epoch: 7, Steps: 9 | Train Loss: 0.257 Vali Loss: 0.611 Vali Acc: 0.804 Test Loss: 0.611 Test Acc: 0.804
Validation loss decreased (-0.797094 --> -0.804342).  Saving model ...
Epoch: 8 cost time: 3.4642038345336914
Epoch: 8, Steps: 9 | Train Loss: 0.143 Vali Loss: 0.504 Vali Acc: 0.862 Test Loss: 0.504 Test Acc: 0.862
Validation loss decreased (-0.804342 --> -0.862314).  Saving model ...
Epoch: 9 cost time: 3.6520166397094727
Epoch: 9, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.518 Vali Acc: 0.826 Test Loss: 0.518 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.0953285694122314
Epoch: 10, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.448 Vali Acc: 0.862 Test Loss: 0.448 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 11 cost time: 3.9665937423706055
Epoch: 11, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.419 Vali Acc: 0.870 Test Loss: 0.419 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869561).  Saving model ...
Epoch: 12 cost time: 3.879828691482544
Epoch: 12, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.470 Vali Acc: 0.862 Test Loss: 0.470 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.0715553760528564
Epoch: 13, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.420 Vali Acc: 0.870 Test Loss: 0.420 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.454727411270142
Epoch: 14, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.414 Vali Acc: 0.862 Test Loss: 0.414 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.9188969135284424
Epoch: 15, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.420 Vali Acc: 0.870 Test Loss: 0.420 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.846994638442993
Epoch: 16, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.424 Vali Acc: 0.877 Test Loss: 0.424 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 17 cost time: 3.8772964477539062
Epoch: 17, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.421 Vali Acc: 0.884 Test Loss: 0.421 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884054).  Saving model ...
Epoch: 18 cost time: 3.7677254676818848
Epoch: 18, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.403 Vali Acc: 0.884 Test Loss: 0.403 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 19 cost time: 3.4941070079803467
Epoch: 19, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.412 Vali Acc: 0.877 Test Loss: 0.412 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.879171848297119
Epoch: 20, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.419 Vali Acc: 0.884 Test Loss: 0.419 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.400785207748413
Epoch: 21, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.408 Vali Acc: 0.899 Test Loss: 0.408 Test Acc: 0.899
Validation loss decreased (-0.884054 --> -0.898547).  Saving model ...
Epoch: 22 cost time: 3.50957989692688
Epoch: 22, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.416 Vali Acc: 0.884 Test Loss: 0.416 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.727283477783203
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.419 Vali Acc: 0.884 Test Loss: 0.419 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.6989376544952393
Epoch: 24, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.410 Vali Acc: 0.884 Test Loss: 0.410 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.408062219619751
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.412 Vali Acc: 0.891 Test Loss: 0.412 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.0921711921691895
Epoch: 26, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.416 Vali Acc: 0.891 Test Loss: 0.416 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 4.088306188583374
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.424 Vali Acc: 0.884 Test Loss: 0.424 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.9320735931396484
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.416 Vali Acc: 0.899 Test Loss: 0.416 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.6965768337249756
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.416 Vali Acc: 0.899 Test Loss: 0.416 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.6339054107666016
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.416 Vali Acc: 0.899 Test Loss: 0.416 Test Acc: 0.899
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 4.538159370422363
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.415 Vali Acc: 0.906 Test Loss: 0.415 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905793).  Saving model ...
Epoch: 32 cost time: 4.0816895961761475
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.411 Vali Acc: 0.913 Test Loss: 0.411 Test Acc: 0.913
Validation loss decreased (-0.905793 --> -0.913039).  Saving model ...
Epoch: 33 cost time: 3.7595343589782715
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.418 Vali Acc: 0.906 Test Loss: 0.418 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 4.033365249633789
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.418 Vali Acc: 0.899 Test Loss: 0.418 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.7061827182769775
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.407 Vali Acc: 0.913 Test Loss: 0.407 Test Acc: 0.913
Validation loss decreased (-0.913039 --> -0.913039).  Saving model ...
Epoch: 36 cost time: 3.9619452953338623
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.411 Vali Acc: 0.906 Test Loss: 0.411 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 4.041578769683838
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.417 Vali Acc: 0.906 Test Loss: 0.417 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.7250847816467285
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.423 Vali Acc: 0.913 Test Loss: 0.423 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 4.210886716842651
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.424 Vali Acc: 0.913 Test Loss: 0.424 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 4.137741327285767
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.422 Vali Acc: 0.906 Test Loss: 0.422 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 4.264027833938599
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.418 Vali Acc: 0.906 Test Loss: 0.418 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 4.369693279266357
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.417 Vali Acc: 0.913 Test Loss: 0.417 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 3.9234910011291504
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.422 Vali Acc: 0.906 Test Loss: 0.422 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 3.9922502040863037
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.432 Vali Acc: 0.906 Test Loss: 0.432 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 3.7094459533691406
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.423 Vali Acc: 0.913 Test Loss: 0.423 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma83_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 613508
model size : 4.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         62                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma62_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.954272270202637
Epoch: 1, Steps: 9 | Train Loss: 1.382 Vali Loss: 1.343 Vali Acc: 0.362 Test Loss: 1.343 Test Acc: 0.362
Validation loss decreased (inf --> -0.362305).  Saving model ...
Epoch: 2 cost time: 3.4816761016845703
Epoch: 2, Steps: 9 | Train Loss: 1.255 Vali Loss: 1.228 Vali Acc: 0.507 Test Loss: 1.228 Test Acc: 0.507
Validation loss decreased (-0.362305 --> -0.507234).  Saving model ...
Epoch: 3 cost time: 3.207954168319702
Epoch: 3, Steps: 9 | Train Loss: 1.033 Vali Loss: 1.080 Vali Acc: 0.638 Test Loss: 1.080 Test Acc: 0.638
Validation loss decreased (-0.507234 --> -0.637670).  Saving model ...
Epoch: 4 cost time: 3.3556487560272217
Epoch: 4, Steps: 9 | Train Loss: 0.770 Vali Loss: 0.963 Vali Acc: 0.681 Test Loss: 0.963 Test Acc: 0.681
Validation loss decreased (-0.637670 --> -0.681150).  Saving model ...
Epoch: 5 cost time: 3.4500575065612793
Epoch: 5, Steps: 9 | Train Loss: 0.555 Vali Loss: 0.833 Vali Acc: 0.725 Test Loss: 0.833 Test Acc: 0.725
Validation loss decreased (-0.681150 --> -0.724629).  Saving model ...
Epoch: 6 cost time: 3.5362277030944824
Epoch: 6, Steps: 9 | Train Loss: 0.380 Vali Loss: 0.724 Vali Acc: 0.790 Test Loss: 0.724 Test Acc: 0.790
Validation loss decreased (-0.724629 --> -0.789848).  Saving model ...
Epoch: 7 cost time: 3.703505516052246
Epoch: 7, Steps: 9 | Train Loss: 0.249 Vali Loss: 0.619 Vali Acc: 0.841 Test Loss: 0.619 Test Acc: 0.841
Validation loss decreased (-0.789848 --> -0.840574).  Saving model ...
Epoch: 8 cost time: 3.937790870666504
Epoch: 8, Steps: 9 | Train Loss: 0.140 Vali Loss: 0.517 Vali Acc: 0.862 Test Loss: 0.517 Test Acc: 0.862
Validation loss decreased (-0.840574 --> -0.862314).  Saving model ...
Epoch: 9 cost time: 3.8878414630889893
Epoch: 9, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.523 Vali Acc: 0.891 Test Loss: 0.523 Test Acc: 0.891
Validation loss decreased (-0.862314 --> -0.891299).  Saving model ...
Epoch: 10 cost time: 3.9699649810791016
Epoch: 10, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.462 Vali Acc: 0.870 Test Loss: 0.462 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.549166440963745
Epoch: 11, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.422 Vali Acc: 0.877 Test Loss: 0.422 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.5035436153411865
Epoch: 12, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.473 Vali Acc: 0.906 Test Loss: 0.473 Test Acc: 0.906
Validation loss decreased (-0.891299 --> -0.905792).  Saving model ...
Epoch: 13 cost time: 3.5691487789154053
Epoch: 13, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.435 Vali Acc: 0.891 Test Loss: 0.435 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.649381637573242
Epoch: 14, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.415 Vali Acc: 0.891 Test Loss: 0.415 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.208247661590576
Epoch: 15, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.424 Vali Acc: 0.906 Test Loss: 0.424 Test Acc: 0.906
Validation loss decreased (-0.905792 --> -0.905793).  Saving model ...
Epoch: 16 cost time: 3.460235834121704
Epoch: 16, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.433 Vali Acc: 0.913 Test Loss: 0.433 Test Acc: 0.913
Validation loss decreased (-0.905793 --> -0.913039).  Saving model ...
Epoch: 17 cost time: 3.5326642990112305
Epoch: 17, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.424 Vali Acc: 0.891 Test Loss: 0.424 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.2580513954162598
Epoch: 18, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.408 Vali Acc: 0.899 Test Loss: 0.408 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.4855902194976807
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.415 Vali Acc: 0.913 Test Loss: 0.415 Test Acc: 0.913
Validation loss decreased (-0.913039 --> -0.913039).  Saving model ...
Epoch: 20 cost time: 3.3554670810699463
Epoch: 20, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.423 Vali Acc: 0.920 Test Loss: 0.423 Test Acc: 0.920
Validation loss decreased (-0.913039 --> -0.920286).  Saving model ...
Epoch: 21 cost time: 3.409698247909546
Epoch: 21, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.413 Vali Acc: 0.913 Test Loss: 0.413 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.431976795196533
Epoch: 22, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.420 Vali Acc: 0.906 Test Loss: 0.420 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.610799789428711
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.425 Vali Acc: 0.913 Test Loss: 0.425 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.473799705505371
Epoch: 24, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.416 Vali Acc: 0.920 Test Loss: 0.416 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920286).  Saving model ...
Epoch: 25 cost time: 3.69826340675354
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.417 Vali Acc: 0.913 Test Loss: 0.417 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.604074239730835
Epoch: 26, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.417 Vali Acc: 0.913 Test Loss: 0.417 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.637176513671875
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.423 Vali Acc: 0.920 Test Loss: 0.423 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.859358549118042
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.418 Vali Acc: 0.920 Test Loss: 0.418 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.54897403717041
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.418 Vali Acc: 0.920 Test Loss: 0.418 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.4530229568481445
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.418 Vali Acc: 0.920 Test Loss: 0.418 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.339892625808716
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.420 Vali Acc: 0.920 Test Loss: 0.420 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.6629998683929443
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.418 Vali Acc: 0.920 Test Loss: 0.418 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.39711856842041
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.417 Vali Acc: 0.920 Test Loss: 0.417 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.389009714126587
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.417 Vali Acc: 0.920 Test Loss: 0.417 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma62_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 613508
model size : 4.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         42                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.282274484634399
Epoch: 1, Steps: 9 | Train Loss: 1.373 Vali Loss: 1.317 Vali Acc: 0.413 Test Loss: 1.317 Test Acc: 0.413
Validation loss decreased (inf --> -0.413030).  Saving model ...
Epoch: 2 cost time: 3.6467723846435547
Epoch: 2, Steps: 9 | Train Loss: 1.238 Vali Loss: 1.189 Vali Acc: 0.507 Test Loss: 1.189 Test Acc: 0.507
Validation loss decreased (-0.413030 --> -0.507234).  Saving model ...
Epoch: 3 cost time: 3.853212833404541
Epoch: 3, Steps: 9 | Train Loss: 1.016 Vali Loss: 1.033 Vali Acc: 0.667 Test Loss: 1.033 Test Acc: 0.667
Validation loss decreased (-0.507234 --> -0.666656).  Saving model ...
Epoch: 4 cost time: 3.6134867668151855
Epoch: 4, Steps: 9 | Train Loss: 0.738 Vali Loss: 0.913 Vali Acc: 0.703 Test Loss: 0.913 Test Acc: 0.703
Validation loss decreased (-0.666656 --> -0.702889).  Saving model ...
Epoch: 5 cost time: 3.756573438644409
Epoch: 5, Steps: 9 | Train Loss: 0.525 Vali Loss: 0.781 Vali Acc: 0.761 Test Loss: 0.781 Test Acc: 0.761
Validation loss decreased (-0.702889 --> -0.760862).  Saving model ...
Epoch: 6 cost time: 3.6319284439086914
Epoch: 6, Steps: 9 | Train Loss: 0.354 Vali Loss: 0.682 Vali Acc: 0.797 Test Loss: 0.682 Test Acc: 0.797
Validation loss decreased (-0.760862 --> -0.797095).  Saving model ...
Epoch: 7 cost time: 3.7444844245910645
Epoch: 7, Steps: 9 | Train Loss: 0.240 Vali Loss: 0.583 Vali Acc: 0.826 Test Loss: 0.583 Test Acc: 0.826
Validation loss decreased (-0.797095 --> -0.826081).  Saving model ...
Epoch: 8 cost time: 3.738569974899292
Epoch: 8, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.483 Vali Acc: 0.877 Test Loss: 0.483 Test Acc: 0.877
Validation loss decreased (-0.826081 --> -0.876807).  Saving model ...
Epoch: 9 cost time: 3.592273473739624
Epoch: 9, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.488 Vali Acc: 0.826 Test Loss: 0.488 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.475555181503296
Epoch: 10, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.421 Vali Acc: 0.877 Test Loss: 0.421 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 11 cost time: 3.6859121322631836
Epoch: 11, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.390 Vali Acc: 0.891 Test Loss: 0.390 Test Acc: 0.891
Validation loss decreased (-0.876807 --> -0.891300).  Saving model ...
Epoch: 12 cost time: 3.403947353363037
Epoch: 12, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.424 Vali Acc: 0.870 Test Loss: 0.424 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.5687203407287598
Epoch: 13, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.391 Vali Acc: 0.891 Test Loss: 0.391 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.420485734939575
Epoch: 14, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.370 Vali Acc: 0.906 Test Loss: 0.370 Test Acc: 0.906
Validation loss decreased (-0.891300 --> -0.905793).  Saving model ...
Epoch: 15 cost time: 3.4669137001037598
Epoch: 15, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.378 Vali Acc: 0.870 Test Loss: 0.378 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.736966371536255
Epoch: 16, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.385 Vali Acc: 0.870 Test Loss: 0.385 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.837991237640381
Epoch: 17, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.380 Vali Acc: 0.899 Test Loss: 0.380 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.844263792037964
Epoch: 18, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.359 Vali Acc: 0.899 Test Loss: 0.359 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.7082884311676025
Epoch: 19, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.369 Vali Acc: 0.884 Test Loss: 0.369 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.4935758113861084
Epoch: 20, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.382 Vali Acc: 0.877 Test Loss: 0.382 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.713953971862793
Epoch: 21, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.365 Vali Acc: 0.891 Test Loss: 0.365 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.8080973625183105
Epoch: 22, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.376 Vali Acc: 0.891 Test Loss: 0.376 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.72982120513916
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.375 Vali Acc: 0.891 Test Loss: 0.375 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.246736764907837
Epoch: 24, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.366 Vali Acc: 0.899 Test Loss: 0.366 Test Acc: 0.899
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 613508
model size : 4.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.710580110549927
Epoch: 1, Steps: 9 | Train Loss: 1.378 Vali Loss: 1.328 Vali Acc: 0.370 Test Loss: 1.328 Test Acc: 0.370
Validation loss decreased (inf --> -0.369552).  Saving model ...
Epoch: 2 cost time: 3.3745510578155518
Epoch: 2, Steps: 9 | Train Loss: 1.247 Vali Loss: 1.208 Vali Acc: 0.500 Test Loss: 1.208 Test Acc: 0.500
Validation loss decreased (-0.369552 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 3.558907985687256
Epoch: 3, Steps: 9 | Train Loss: 1.035 Vali Loss: 1.057 Vali Acc: 0.652 Test Loss: 1.057 Test Acc: 0.652
Validation loss decreased (-0.499988 --> -0.652163).  Saving model ...
Epoch: 4 cost time: 3.5299365520477295
Epoch: 4, Steps: 9 | Train Loss: 0.762 Vali Loss: 0.926 Vali Acc: 0.739 Test Loss: 0.926 Test Acc: 0.739
Validation loss decreased (-0.652163 --> -0.739121).  Saving model ...
Epoch: 5 cost time: 3.45763897895813
Epoch: 5, Steps: 9 | Train Loss: 0.539 Vali Loss: 0.783 Vali Acc: 0.804 Test Loss: 0.783 Test Acc: 0.804
Validation loss decreased (-0.739121 --> -0.804340).  Saving model ...
Epoch: 6 cost time: 3.725041627883911
Epoch: 6, Steps: 9 | Train Loss: 0.367 Vali Loss: 0.653 Vali Acc: 0.819 Test Loss: 0.653 Test Acc: 0.819
Validation loss decreased (-0.804340 --> -0.818834).  Saving model ...
Epoch: 7 cost time: 3.2916014194488525
Epoch: 7, Steps: 9 | Train Loss: 0.245 Vali Loss: 0.534 Vali Acc: 0.891 Test Loss: 0.534 Test Acc: 0.891
Validation loss decreased (-0.818834 --> -0.891299).  Saving model ...
Epoch: 8 cost time: 3.398592233657837
Epoch: 8, Steps: 9 | Train Loss: 0.143 Vali Loss: 0.438 Vali Acc: 0.891 Test Loss: 0.438 Test Acc: 0.891
Validation loss decreased (-0.891299 --> -0.891300).  Saving model ...
Epoch: 9 cost time: 3.255694627761841
Epoch: 9, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.425 Vali Acc: 0.877 Test Loss: 0.425 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.456000328063965
Epoch: 10, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.347 Vali Acc: 0.920 Test Loss: 0.347 Test Acc: 0.920
Validation loss decreased (-0.891300 --> -0.920286).  Saving model ...
Epoch: 11 cost time: 3.5757384300231934
Epoch: 11, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.316 Vali Acc: 0.920 Test Loss: 0.316 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920287).  Saving model ...
Epoch: 12 cost time: 3.7071855068206787
Epoch: 12, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.348 Vali Acc: 0.906 Test Loss: 0.348 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.7276203632354736
Epoch: 13, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.293 Vali Acc: 0.913 Test Loss: 0.293 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.683870553970337
Epoch: 14, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.294 Vali Acc: 0.920 Test Loss: 0.294 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 15 cost time: 3.7012832164764404
Epoch: 15, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.296 Vali Acc: 0.899 Test Loss: 0.296 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.9505231380462646
Epoch: 16, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.284 Vali Acc: 0.899 Test Loss: 0.284 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.8653342723846436
Epoch: 17, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.282 Vali Acc: 0.920 Test Loss: 0.282 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 18 cost time: 3.850515604019165
Epoch: 18, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.274 Vali Acc: 0.913 Test Loss: 0.274 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.6258926391601562
Epoch: 19, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.277 Vali Acc: 0.906 Test Loss: 0.277 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.280381441116333
Epoch: 20, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.278 Vali Acc: 0.913 Test Loss: 0.278 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.6257002353668213
Epoch: 21, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.270 Vali Acc: 0.920 Test Loss: 0.270 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 22 cost time: 3.538421154022217
Epoch: 22, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.271 Vali Acc: 0.920 Test Loss: 0.271 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.378976345062256
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.275 Vali Acc: 0.913 Test Loss: 0.275 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.6079607009887695
Epoch: 24, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.268 Vali Acc: 0.913 Test Loss: 0.268 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.559506416320801
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.270 Vali Acc: 0.913 Test Loss: 0.270 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.8325419425964355
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.268 Vali Acc: 0.913 Test Loss: 0.268 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.8494176864624023
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.275 Vali Acc: 0.913 Test Loss: 0.275 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.966928482055664
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.274 Vali Acc: 0.913 Test Loss: 0.274 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.8854176998138428
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.270 Vali Acc: 0.913 Test Loss: 0.270 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 4.041112422943115
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.270 Vali Acc: 0.913 Test Loss: 0.270 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.997706890106201
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.913 Test Loss: 0.271 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 613508
model size : 4.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.9195733070373535
Epoch: 1, Steps: 9 | Train Loss: 1.395 Vali Loss: 1.373 Vali Acc: 0.275 Test Loss: 1.373 Test Acc: 0.275
Validation loss decreased (inf --> -0.275349).  Saving model ...
Epoch: 2 cost time: 3.592803955078125
Epoch: 2, Steps: 9 | Train Loss: 1.281 Vali Loss: 1.244 Vali Acc: 0.457 Test Loss: 1.244 Test Acc: 0.457
Validation loss decreased (-0.275349 --> -0.456509).  Saving model ...
Epoch: 3 cost time: 3.5932211875915527
Epoch: 3, Steps: 9 | Train Loss: 1.069 Vali Loss: 1.084 Vali Acc: 0.601 Test Loss: 1.084 Test Acc: 0.601
Validation loss decreased (-0.456509 --> -0.601438).  Saving model ...
Epoch: 4 cost time: 3.5829625129699707
Epoch: 4, Steps: 9 | Train Loss: 0.817 Vali Loss: 0.957 Vali Acc: 0.667 Test Loss: 0.957 Test Acc: 0.667
Validation loss decreased (-0.601438 --> -0.666657).  Saving model ...
Epoch: 5 cost time: 3.6321446895599365
Epoch: 5, Steps: 9 | Train Loss: 0.593 Vali Loss: 0.808 Vali Acc: 0.717 Test Loss: 0.808 Test Acc: 0.717
Validation loss decreased (-0.666657 --> -0.717383).  Saving model ...
Epoch: 6 cost time: 3.542020559310913
Epoch: 6, Steps: 9 | Train Loss: 0.422 Vali Loss: 0.712 Vali Acc: 0.732 Test Loss: 0.712 Test Acc: 0.732
Validation loss decreased (-0.717383 --> -0.731877).  Saving model ...
Epoch: 7 cost time: 3.6318857669830322
Epoch: 7, Steps: 9 | Train Loss: 0.304 Vali Loss: 0.604 Vali Acc: 0.775 Test Loss: 0.604 Test Acc: 0.775
Validation loss decreased (-0.731877 --> -0.775356).  Saving model ...
Epoch: 8 cost time: 3.603023052215576
Epoch: 8, Steps: 9 | Train Loss: 0.182 Vali Loss: 0.524 Vali Acc: 0.783 Test Loss: 0.524 Test Acc: 0.783
Validation loss decreased (-0.775356 --> -0.782603).  Saving model ...
Epoch: 9 cost time: 3.784183979034424
Epoch: 9, Steps: 9 | Train Loss: 0.125 Vali Loss: 0.533 Vali Acc: 0.775 Test Loss: 0.533 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.482424259185791
Epoch: 10, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.444 Vali Acc: 0.819 Test Loss: 0.444 Test Acc: 0.819
Validation loss decreased (-0.782603 --> -0.818836).  Saving model ...
Epoch: 11 cost time: 3.5653750896453857
Epoch: 11, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.433 Vali Acc: 0.841 Test Loss: 0.433 Test Acc: 0.841
Validation loss decreased (-0.818836 --> -0.840575).  Saving model ...
Epoch: 12 cost time: 3.705634593963623
Epoch: 12, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.424 Vali Acc: 0.833 Test Loss: 0.424 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.5895307064056396
Epoch: 13, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.408 Vali Acc: 0.826 Test Loss: 0.408 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.560521364212036
Epoch: 14, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.405 Vali Acc: 0.841 Test Loss: 0.405 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840576).  Saving model ...
Epoch: 15 cost time: 3.6710093021392822
Epoch: 15, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.402 Vali Acc: 0.841 Test Loss: 0.402 Test Acc: 0.841
Validation loss decreased (-0.840576 --> -0.840576).  Saving model ...
Epoch: 16 cost time: 3.5527844429016113
Epoch: 16, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.393 Vali Acc: 0.855 Test Loss: 0.393 Test Acc: 0.855
Validation loss decreased (-0.840576 --> -0.855069).  Saving model ...
Epoch: 17 cost time: 3.4281578063964844
Epoch: 17, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.389 Vali Acc: 0.848 Test Loss: 0.389 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.5246422290802
Epoch: 18, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.401 Vali Acc: 0.877 Test Loss: 0.401 Test Acc: 0.877
Validation loss decreased (-0.855069 --> -0.876808).  Saving model ...
Epoch: 19 cost time: 3.5011861324310303
Epoch: 19, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.399 Vali Acc: 0.870 Test Loss: 0.399 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.4030117988586426
Epoch: 20, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.388 Vali Acc: 0.862 Test Loss: 0.388 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.502901077270508
Epoch: 21, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.379 Vali Acc: 0.848 Test Loss: 0.379 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.6944127082824707
Epoch: 22, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.399 Vali Acc: 0.855 Test Loss: 0.399 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.6212565898895264
Epoch: 23, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.393 Vali Acc: 0.862 Test Loss: 0.393 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.923004150390625
Epoch: 24, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.388 Vali Acc: 0.862 Test Loss: 0.388 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.6404225826263428
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.392 Vali Acc: 0.877 Test Loss: 0.392 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 26 cost time: 3.748878002166748
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.393 Vali Acc: 0.877 Test Loss: 0.393 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.517111301422119
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.385 Vali Acc: 0.862 Test Loss: 0.385 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.8764402866363525
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.381 Vali Acc: 0.862 Test Loss: 0.381 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.6178689002990723
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.390 Vali Acc: 0.884 Test Loss: 0.390 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 30 cost time: 3.195662260055542
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.384 Vali Acc: 0.870 Test Loss: 0.384 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.2405543327331543
Epoch: 31, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.382 Vali Acc: 0.877 Test Loss: 0.382 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.5104007720947266
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.388 Vali Acc: 0.891 Test Loss: 0.388 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891300).  Saving model ...
Epoch: 33 cost time: 3.3733267784118652
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.392 Vali Acc: 0.891 Test Loss: 0.392 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.543818473815918
Epoch: 34, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.380 Vali Acc: 0.870 Test Loss: 0.380 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.602215051651001
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.376 Vali Acc: 0.870 Test Loss: 0.376 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.6806914806365967
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.375 Vali Acc: 0.870 Test Loss: 0.375 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.594900369644165
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.380 Vali Acc: 0.884 Test Loss: 0.380 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.7491347789764404
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.384 Vali Acc: 0.884 Test Loss: 0.384 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.862868070602417
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.384 Vali Acc: 0.884 Test Loss: 0.384 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 3.530616283416748
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.379 Vali Acc: 0.877 Test Loss: 0.379 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 3.6373977661132812
Epoch: 41, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.379 Vali Acc: 0.877 Test Loss: 0.379 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 3.6132733821868896
Epoch: 42, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.377 Vali Acc: 0.877 Test Loss: 0.377 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 613508
model size : 4.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.884258508682251
Epoch: 1, Steps: 9 | Train Loss: 1.398 Vali Loss: 1.317 Vali Acc: 0.399 Test Loss: 1.317 Test Acc: 0.399
Validation loss decreased (inf --> -0.398538).  Saving model ...
Epoch: 2 cost time: 3.4393255710601807
Epoch: 2, Steps: 9 | Train Loss: 1.283 Vali Loss: 1.198 Vali Acc: 0.514 Test Loss: 1.198 Test Acc: 0.514
Validation loss decreased (-0.398538 --> -0.514481).  Saving model ...
Epoch: 3 cost time: 3.3954763412475586
Epoch: 3, Steps: 9 | Train Loss: 1.030 Vali Loss: 1.061 Vali Acc: 0.630 Test Loss: 1.061 Test Acc: 0.630
Validation loss decreased (-0.514481 --> -0.630424).  Saving model ...
Epoch: 4 cost time: 3.5533151626586914
Epoch: 4, Steps: 9 | Train Loss: 0.790 Vali Loss: 0.958 Vali Acc: 0.623 Test Loss: 0.958 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.3109755516052246
Epoch: 5, Steps: 9 | Train Loss: 0.571 Vali Loss: 0.862 Vali Acc: 0.681 Test Loss: 0.862 Test Acc: 0.681
Validation loss decreased (-0.630424 --> -0.681151).  Saving model ...
Epoch: 6 cost time: 3.175934076309204
Epoch: 6, Steps: 9 | Train Loss: 0.405 Vali Loss: 0.790 Vali Acc: 0.681 Test Loss: 0.790 Test Acc: 0.681
Validation loss decreased (-0.681151 --> -0.681152).  Saving model ...
Epoch: 7 cost time: 3.286236524581909
Epoch: 7, Steps: 9 | Train Loss: 0.303 Vali Loss: 0.733 Vali Acc: 0.732 Test Loss: 0.733 Test Acc: 0.732
Validation loss decreased (-0.681152 --> -0.731877).  Saving model ...
Epoch: 8 cost time: 3.329174757003784
Epoch: 8, Steps: 9 | Train Loss: 0.204 Vali Loss: 0.663 Vali Acc: 0.761 Test Loss: 0.663 Test Acc: 0.761
Validation loss decreased (-0.731877 --> -0.760863).  Saving model ...
Epoch: 9 cost time: 3.406784772872925
Epoch: 9, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.645 Vali Acc: 0.768 Test Loss: 0.645 Test Acc: 0.768
Validation loss decreased (-0.760863 --> -0.768109).  Saving model ...
Epoch: 10 cost time: 3.6520886421203613
Epoch: 10, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.601 Vali Acc: 0.797 Test Loss: 0.601 Test Acc: 0.797
Validation loss decreased (-0.768109 --> -0.797095).  Saving model ...
Epoch: 11 cost time: 3.7015650272369385
Epoch: 11, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.620 Vali Acc: 0.790 Test Loss: 0.620 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.617649555206299
Epoch: 12, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.618 Vali Acc: 0.783 Test Loss: 0.618 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.525529146194458
Epoch: 13, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.578 Vali Acc: 0.797 Test Loss: 0.578 Test Acc: 0.797
Validation loss decreased (-0.797095 --> -0.797096).  Saving model ...
Epoch: 14 cost time: 3.697474718093872
Epoch: 14, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.621 Vali Acc: 0.812 Test Loss: 0.621 Test Acc: 0.812
Validation loss decreased (-0.797096 --> -0.811588).  Saving model ...
Epoch: 15 cost time: 3.5790507793426514
Epoch: 15, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.608 Vali Acc: 0.790 Test Loss: 0.608 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.494798421859741
Epoch: 16, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.594 Vali Acc: 0.790 Test Loss: 0.594 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.476217746734619
Epoch: 17, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.611 Vali Acc: 0.790 Test Loss: 0.611 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.5824716091156006
Epoch: 18, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.625 Vali Acc: 0.812 Test Loss: 0.625 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.2164714336395264
Epoch: 19, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.607 Vali Acc: 0.783 Test Loss: 0.607 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.554023027420044
Epoch: 20, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.621 Vali Acc: 0.790 Test Loss: 0.621 Test Acc: 0.790
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.696991205215454
Epoch: 21, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.639 Vali Acc: 0.797 Test Loss: 0.639 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.7232823371887207
Epoch: 22, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.636 Vali Acc: 0.804 Test Loss: 0.636 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.711897850036621
Epoch: 23, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.632 Vali Acc: 0.812 Test Loss: 0.632 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.7658190727233887
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.624 Vali Acc: 0.790 Test Loss: 0.624 Test Acc: 0.790
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8115942028985508
model parameter : 613508
model size : 4.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.450281381607056
Epoch: 1, Steps: 9 | Train Loss: 1.418 Vali Loss: 1.393 Vali Acc: 0.319 Test Loss: 1.393 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 3.7311220169067383
Epoch: 2, Steps: 9 | Train Loss: 1.357 Vali Loss: 1.352 Vali Acc: 0.362 Test Loss: 1.352 Test Acc: 0.362
Validation loss decreased (-0.318827 --> -0.362305).  Saving model ...
Epoch: 3 cost time: 3.407467842102051
Epoch: 3, Steps: 9 | Train Loss: 1.189 Vali Loss: 1.297 Vali Acc: 0.435 Test Loss: 1.297 Test Acc: 0.435
Validation loss decreased (-0.362305 --> -0.434770).  Saving model ...
Epoch: 4 cost time: 3.5396387577056885
Epoch: 4, Steps: 9 | Train Loss: 1.003 Vali Loss: 1.241 Vali Acc: 0.464 Test Loss: 1.241 Test Acc: 0.464
Validation loss decreased (-0.434770 --> -0.463756).  Saving model ...
Epoch: 5 cost time: 3.4408011436462402
Epoch: 5, Steps: 9 | Train Loss: 0.823 Vali Loss: 1.189 Vali Acc: 0.500 Test Loss: 1.189 Test Acc: 0.500
Validation loss decreased (-0.463756 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 3.377526044845581
Epoch: 6, Steps: 9 | Train Loss: 0.660 Vali Loss: 1.143 Vali Acc: 0.514 Test Loss: 1.143 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.514481).  Saving model ...
Epoch: 7 cost time: 3.3730504512786865
Epoch: 7, Steps: 9 | Train Loss: 0.492 Vali Loss: 1.131 Vali Acc: 0.514 Test Loss: 1.131 Test Acc: 0.514
Validation loss decreased (-0.514481 --> -0.514481).  Saving model ...
Epoch: 8 cost time: 3.4196388721466064
Epoch: 8, Steps: 9 | Train Loss: 0.353 Vali Loss: 1.169 Vali Acc: 0.493 Test Loss: 1.169 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.3650496006011963
Epoch: 9, Steps: 9 | Train Loss: 0.250 Vali Loss: 1.115 Vali Acc: 0.529 Test Loss: 1.115 Test Acc: 0.529
Validation loss decreased (-0.514481 --> -0.528974).  Saving model ...
Epoch: 10 cost time: 3.6465671062469482
Epoch: 10, Steps: 9 | Train Loss: 0.203 Vali Loss: 1.271 Vali Acc: 0.478 Test Loss: 1.271 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.710192918777466
Epoch: 11, Steps: 9 | Train Loss: 0.151 Vali Loss: 1.233 Vali Acc: 0.486 Test Loss: 1.233 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.7941195964813232
Epoch: 12, Steps: 9 | Train Loss: 0.083 Vali Loss: 1.263 Vali Acc: 0.471 Test Loss: 1.263 Test Acc: 0.471
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.769874095916748
Epoch: 13, Steps: 9 | Train Loss: 0.075 Vali Loss: 1.358 Vali Acc: 0.486 Test Loss: 1.358 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.544269323348999
Epoch: 14, Steps: 9 | Train Loss: 0.056 Vali Loss: 1.400 Vali Acc: 0.500 Test Loss: 1.400 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.7068636417388916
Epoch: 15, Steps: 9 | Train Loss: 0.040 Vali Loss: 1.386 Vali Acc: 0.514 Test Loss: 1.386 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.6314244270324707
Epoch: 16, Steps: 9 | Train Loss: 0.033 Vali Loss: 1.366 Vali Acc: 0.493 Test Loss: 1.366 Test Acc: 0.493
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.9379189014434814
Epoch: 17, Steps: 9 | Train Loss: 0.027 Vali Loss: 1.421 Vali Acc: 0.507 Test Loss: 1.421 Test Acc: 0.507
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.788367509841919
Epoch: 18, Steps: 9 | Train Loss: 0.023 Vali Loss: 1.379 Vali Acc: 0.514 Test Loss: 1.379 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.4158711433410645
Epoch: 19, Steps: 9 | Train Loss: 0.016 Vali Loss: 1.331 Vali Acc: 0.522 Test Loss: 1.331 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5289855072463768
model parameter : 613508
model size : 4.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.827215671539307
Epoch: 1, Steps: 9 | Train Loss: 1.436 Vali Loss: 1.442 Vali Acc: 0.203 Test Loss: 1.442 Test Acc: 0.203
Validation loss decreased (inf --> -0.202884).  Saving model ...
Epoch: 2 cost time: 3.3842222690582275
Epoch: 2, Steps: 9 | Train Loss: 1.416 Vali Loss: 1.430 Vali Acc: 0.254 Test Loss: 1.430 Test Acc: 0.254
Validation loss decreased (-0.202884 --> -0.253609).  Saving model ...
Epoch: 3 cost time: 3.426926612854004
Epoch: 3, Steps: 9 | Train Loss: 1.315 Vali Loss: 1.427 Vali Acc: 0.254 Test Loss: 1.427 Test Acc: 0.254
Validation loss decreased (-0.253609 --> -0.253609).  Saving model ...
Epoch: 4 cost time: 3.462980270385742
Epoch: 4, Steps: 9 | Train Loss: 1.197 Vali Loss: 1.430 Vali Acc: 0.246 Test Loss: 1.430 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.74750018119812
Epoch: 5, Steps: 9 | Train Loss: 1.048 Vali Loss: 1.456 Vali Acc: 0.268 Test Loss: 1.456 Test Acc: 0.268
Validation loss decreased (-0.253609 --> -0.268101).  Saving model ...
Epoch: 6 cost time: 3.3531908988952637
Epoch: 6, Steps: 9 | Train Loss: 0.944 Vali Loss: 1.495 Vali Acc: 0.290 Test Loss: 1.495 Test Acc: 0.290
Validation loss decreased (-0.268101 --> -0.289840).  Saving model ...
Epoch: 7 cost time: 3.5480175018310547
Epoch: 7, Steps: 9 | Train Loss: 0.768 Vali Loss: 1.577 Vali Acc: 0.304 Test Loss: 1.577 Test Acc: 0.304
Validation loss decreased (-0.289840 --> -0.304332).  Saving model ...
Epoch: 8 cost time: 3.8379464149475098
Epoch: 8, Steps: 9 | Train Loss: 0.665 Vali Loss: 1.805 Vali Acc: 0.304 Test Loss: 1.805 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.4133658409118652
Epoch: 9, Steps: 9 | Train Loss: 0.506 Vali Loss: 2.011 Vali Acc: 0.297 Test Loss: 2.011 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.516494035720825
Epoch: 10, Steps: 9 | Train Loss: 0.429 Vali Loss: 2.228 Vali Acc: 0.319 Test Loss: 2.228 Test Acc: 0.319
Validation loss decreased (-0.304332 --> -0.318818).  Saving model ...
Epoch: 11 cost time: 3.723966598510742
Epoch: 11, Steps: 9 | Train Loss: 0.305 Vali Loss: 2.412 Vali Acc: 0.283 Test Loss: 2.412 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.5330653190612793
Epoch: 12, Steps: 9 | Train Loss: 0.232 Vali Loss: 2.526 Vali Acc: 0.312 Test Loss: 2.526 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.2526051998138428
Epoch: 13, Steps: 9 | Train Loss: 0.189 Vali Loss: 2.896 Vali Acc: 0.304 Test Loss: 2.896 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.8741414546966553
Epoch: 14, Steps: 9 | Train Loss: 0.135 Vali Loss: 2.798 Vali Acc: 0.304 Test Loss: 2.798 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.638903856277466
Epoch: 15, Steps: 9 | Train Loss: 0.100 Vali Loss: 2.974 Vali Acc: 0.304 Test Loss: 2.974 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.6614396572113037
Epoch: 16, Steps: 9 | Train Loss: 0.079 Vali Loss: 2.851 Vali Acc: 0.333 Test Loss: 2.851 Test Acc: 0.333
Validation loss decreased (-0.318818 --> -0.333305).  Saving model ...
Epoch: 17 cost time: 3.6492364406585693
Epoch: 17, Steps: 9 | Train Loss: 0.055 Vali Loss: 2.931 Vali Acc: 0.341 Test Loss: 2.931 Test Acc: 0.341
Validation loss decreased (-0.333305 --> -0.340550).  Saving model ...
Epoch: 18 cost time: 3.4880239963531494
Epoch: 18, Steps: 9 | Train Loss: 0.056 Vali Loss: 3.069 Vali Acc: 0.333 Test Loss: 3.069 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.717621088027954
Epoch: 19, Steps: 9 | Train Loss: 0.034 Vali Loss: 2.930 Vali Acc: 0.326 Test Loss: 2.930 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.774935722351074
Epoch: 20, Steps: 9 | Train Loss: 0.033 Vali Loss: 2.873 Vali Acc: 0.326 Test Loss: 2.873 Test Acc: 0.326
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.9523093700408936
Epoch: 21, Steps: 9 | Train Loss: 0.023 Vali Loss: 3.053 Vali Acc: 0.326 Test Loss: 3.053 Test Acc: 0.326
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.610443592071533
Epoch: 22, Steps: 9 | Train Loss: 0.024 Vali Loss: 2.919 Vali Acc: 0.319 Test Loss: 2.919 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.4706900119781494
Epoch: 23, Steps: 9 | Train Loss: 0.017 Vali Loss: 2.931 Vali Acc: 0.312 Test Loss: 2.931 Test Acc: 0.312
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.5972487926483154
Epoch: 24, Steps: 9 | Train Loss: 0.015 Vali Loss: 3.054 Vali Acc: 0.326 Test Loss: 3.054 Test Acc: 0.326
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.834080457687378
Epoch: 25, Steps: 9 | Train Loss: 0.012 Vali Loss: 2.892 Vali Acc: 0.341 Test Loss: 2.892 Test Acc: 0.341
Validation loss decreased (-0.340550 --> -0.340551).  Saving model ...
Epoch: 26 cost time: 4.125012636184692
Epoch: 26, Steps: 9 | Train Loss: 0.011 Vali Loss: 2.980 Vali Acc: 0.341 Test Loss: 2.980 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.558781385421753
Epoch: 27, Steps: 9 | Train Loss: 0.014 Vali Loss: 2.893 Vali Acc: 0.348 Test Loss: 2.893 Test Acc: 0.348
Validation loss decreased (-0.340551 --> -0.347797).  Saving model ...
Epoch: 28 cost time: 3.4697277545928955
Epoch: 28, Steps: 9 | Train Loss: 0.009 Vali Loss: 2.961 Vali Acc: 0.341 Test Loss: 2.961 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.5981764793395996
Epoch: 29, Steps: 9 | Train Loss: 0.010 Vali Loss: 2.930 Vali Acc: 0.355 Test Loss: 2.930 Test Acc: 0.355
Validation loss decreased (-0.347797 --> -0.355043).  Saving model ...
Epoch: 30 cost time: 3.396439552307129
Epoch: 30, Steps: 9 | Train Loss: 0.008 Vali Loss: 2.874 Vali Acc: 0.355 Test Loss: 2.874 Test Acc: 0.355
Validation loss decreased (-0.355043 --> -0.355044).  Saving model ...
Epoch: 31 cost time: 3.5964138507843018
Epoch: 31, Steps: 9 | Train Loss: 0.006 Vali Loss: 2.889 Vali Acc: 0.341 Test Loss: 2.889 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.8117616176605225
Epoch: 32, Steps: 9 | Train Loss: 0.007 Vali Loss: 3.010 Vali Acc: 0.319 Test Loss: 3.010 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.6378653049468994
Epoch: 33, Steps: 9 | Train Loss: 0.006 Vali Loss: 3.086 Vali Acc: 0.333 Test Loss: 3.086 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.780747413635254
Epoch: 34, Steps: 9 | Train Loss: 0.005 Vali Loss: 3.063 Vali Acc: 0.326 Test Loss: 3.063 Test Acc: 0.326
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.9635396003723145
Epoch: 35, Steps: 9 | Train Loss: 0.004 Vali Loss: 3.004 Vali Acc: 0.348 Test Loss: 3.004 Test Acc: 0.348
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.6463990211486816
Epoch: 36, Steps: 9 | Train Loss: 0.004 Vali Loss: 2.955 Vali Acc: 0.348 Test Loss: 2.955 Test Acc: 0.348
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.6912591457366943
Epoch: 37, Steps: 9 | Train Loss: 0.004 Vali Loss: 3.044 Vali Acc: 0.341 Test Loss: 3.044 Test Acc: 0.341
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.6397855281829834
Epoch: 38, Steps: 9 | Train Loss: 0.003 Vali Loss: 3.065 Vali Acc: 0.348 Test Loss: 3.065 Test Acc: 0.348
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 4.085204362869263
Epoch: 39, Steps: 9 | Train Loss: 0.003 Vali Loss: 2.974 Vali Acc: 0.348 Test Loss: 2.974 Test Acc: 0.348
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 3.8514904975891113
Epoch: 40, Steps: 9 | Train Loss: 0.003 Vali Loss: 2.923 Vali Acc: 0.348 Test Loss: 2.923 Test Acc: 0.348
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.35507246376811596
model parameter : 613508
model size : 4.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.036214113235474
Epoch: 1, Steps: 9 | Train Loss: 1.435 Vali Loss: 1.447 Vali Acc: 0.275 Test Loss: 1.447 Test Acc: 0.275
Validation loss decreased (inf --> -0.275348).  Saving model ...
Epoch: 2 cost time: 3.304863214492798
Epoch: 2, Steps: 9 | Train Loss: 1.392 Vali Loss: 1.432 Vali Acc: 0.290 Test Loss: 1.432 Test Acc: 0.290
Validation loss decreased (-0.275348 --> -0.289841).  Saving model ...
Epoch: 3 cost time: 3.5558648109436035
Epoch: 3, Steps: 9 | Train Loss: 1.282 Vali Loss: 1.412 Vali Acc: 0.319 Test Loss: 1.412 Test Acc: 0.319
Validation loss decreased (-0.289841 --> -0.318826).  Saving model ...
Epoch: 4 cost time: 3.6593892574310303
Epoch: 4, Steps: 9 | Train Loss: 1.119 Vali Loss: 1.385 Vali Acc: 0.362 Test Loss: 1.385 Test Acc: 0.362
Validation loss decreased (-0.318826 --> -0.362305).  Saving model ...
Epoch: 5 cost time: 3.693922281265259
Epoch: 5, Steps: 9 | Train Loss: 0.963 Vali Loss: 1.346 Vali Acc: 0.312 Test Loss: 1.346 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.723437547683716
Epoch: 6, Steps: 9 | Train Loss: 0.870 Vali Loss: 1.336 Vali Acc: 0.297 Test Loss: 1.336 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.646320104598999
Epoch: 7, Steps: 9 | Train Loss: 0.703 Vali Loss: 1.331 Vali Acc: 0.341 Test Loss: 1.331 Test Acc: 0.341
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.5228796005249023
Epoch: 8, Steps: 9 | Train Loss: 0.550 Vali Loss: 1.386 Vali Acc: 0.341 Test Loss: 1.386 Test Acc: 0.341
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.6322617530822754
Epoch: 9, Steps: 9 | Train Loss: 0.424 Vali Loss: 1.445 Vali Acc: 0.326 Test Loss: 1.445 Test Acc: 0.326
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.658111095428467
Epoch: 10, Steps: 9 | Train Loss: 0.345 Vali Loss: 1.536 Vali Acc: 0.348 Test Loss: 1.536 Test Acc: 0.348
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.109292984008789
Epoch: 11, Steps: 9 | Train Loss: 0.235 Vali Loss: 1.653 Vali Acc: 0.348 Test Loss: 1.653 Test Acc: 0.348
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.8103814125061035
Epoch: 12, Steps: 9 | Train Loss: 0.173 Vali Loss: 1.661 Vali Acc: 0.355 Test Loss: 1.661 Test Acc: 0.355
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.146955728530884
Epoch: 13, Steps: 9 | Train Loss: 0.139 Vali Loss: 1.840 Vali Acc: 0.370 Test Loss: 1.840 Test Acc: 0.370
Validation loss decreased (-0.362305 --> -0.369547).  Saving model ...
Epoch: 14 cost time: 3.7226815223693848
Epoch: 14, Steps: 9 | Train Loss: 0.083 Vali Loss: 1.967 Vali Acc: 0.384 Test Loss: 1.967 Test Acc: 0.384
Validation loss decreased (-0.369547 --> -0.384038).  Saving model ...
Epoch: 15 cost time: 3.641263961791992
Epoch: 15, Steps: 9 | Train Loss: 0.061 Vali Loss: 1.829 Vali Acc: 0.348 Test Loss: 1.829 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.7276320457458496
Epoch: 16, Steps: 9 | Train Loss: 0.053 Vali Loss: 1.922 Vali Acc: 0.391 Test Loss: 1.922 Test Acc: 0.391
Validation loss decreased (-0.384038 --> -0.391285).  Saving model ...
Epoch: 17 cost time: 3.617493152618408
Epoch: 17, Steps: 9 | Train Loss: 0.038 Vali Loss: 1.950 Vali Acc: 0.377 Test Loss: 1.950 Test Acc: 0.377
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.791415214538574
Epoch: 18, Steps: 9 | Train Loss: 0.033 Vali Loss: 1.902 Vali Acc: 0.384 Test Loss: 1.902 Test Acc: 0.384
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.028210639953613
Epoch: 19, Steps: 9 | Train Loss: 0.022 Vali Loss: 1.810 Vali Acc: 0.399 Test Loss: 1.810 Test Acc: 0.399
Validation loss decreased (-0.391285 --> -0.398533).  Saving model ...
Epoch: 20 cost time: 4.440232276916504
Epoch: 20, Steps: 9 | Train Loss: 0.022 Vali Loss: 1.803 Vali Acc: 0.413 Test Loss: 1.803 Test Acc: 0.413
Validation loss decreased (-0.398533 --> -0.413025).  Saving model ...
Epoch: 21 cost time: 3.8151745796203613
Epoch: 21, Steps: 9 | Train Loss: 0.018 Vali Loss: 1.897 Vali Acc: 0.399 Test Loss: 1.897 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.169420480728149
Epoch: 22, Steps: 9 | Train Loss: 0.016 Vali Loss: 1.937 Vali Acc: 0.399 Test Loss: 1.937 Test Acc: 0.399
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.9908993244171143
Epoch: 23, Steps: 9 | Train Loss: 0.013 Vali Loss: 1.895 Vali Acc: 0.391 Test Loss: 1.895 Test Acc: 0.391
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.099971055984497
Epoch: 24, Steps: 9 | Train Loss: 0.012 Vali Loss: 1.919 Vali Acc: 0.384 Test Loss: 1.919 Test Acc: 0.384
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.968031644821167
Epoch: 25, Steps: 9 | Train Loss: 0.010 Vali Loss: 1.876 Vali Acc: 0.399 Test Loss: 1.876 Test Acc: 0.399
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.0440146923065186
Epoch: 26, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.959 Vali Acc: 0.428 Test Loss: 1.959 Test Acc: 0.428
Validation loss decreased (-0.413025 --> -0.427517).  Saving model ...
Epoch: 27 cost time: 3.7623329162597656
Epoch: 27, Steps: 9 | Train Loss: 0.010 Vali Loss: 1.905 Vali Acc: 0.420 Test Loss: 1.905 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.8495688438415527
Epoch: 28, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.865 Vali Acc: 0.406 Test Loss: 1.865 Test Acc: 0.406
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.637655258178711
Epoch: 29, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.859 Vali Acc: 0.420 Test Loss: 1.859 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.7451984882354736
Epoch: 30, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.872 Vali Acc: 0.420 Test Loss: 1.872 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.7633581161499023
Epoch: 31, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.801 Vali Acc: 0.406 Test Loss: 1.801 Test Acc: 0.406
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 4.108546257019043
Epoch: 32, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.857 Vali Acc: 0.413 Test Loss: 1.857 Test Acc: 0.413
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.9313056468963623
Epoch: 33, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.786 Vali Acc: 0.435 Test Loss: 1.786 Test Acc: 0.435
Validation loss decreased (-0.427517 --> -0.434765).  Saving model ...
Epoch: 34 cost time: 4.167978286743164
Epoch: 34, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.814 Vali Acc: 0.428 Test Loss: 1.814 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 4.012462615966797
Epoch: 35, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.844 Vali Acc: 0.420 Test Loss: 1.844 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 4.034870147705078
Epoch: 36, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.838 Vali Acc: 0.420 Test Loss: 1.838 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.980010747909546
Epoch: 37, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.864 Vali Acc: 0.413 Test Loss: 1.864 Test Acc: 0.413
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 4.125548601150513
Epoch: 38, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.849 Vali Acc: 0.428 Test Loss: 1.849 Test Acc: 0.428
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 4.067057132720947
Epoch: 39, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.831 Vali Acc: 0.435 Test Loss: 1.831 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.7742691040039062
Epoch: 40, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.814 Vali Acc: 0.428 Test Loss: 1.814 Test Acc: 0.428
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.972609043121338
Epoch: 41, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.805 Vali Acc: 0.428 Test Loss: 1.805 Test Acc: 0.428
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 3.7958662509918213
Epoch: 42, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.863 Vali Acc: 0.428 Test Loss: 1.863 Test Acc: 0.428
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 3.9561362266540527
Epoch: 43, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.846 Vali Acc: 0.420 Test Loss: 1.846 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.43478260869565216
model parameter : 613508
model size : 4.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         103                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df512_ma103_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.254363059997559
Epoch: 1, Steps: 9 | Train Loss: 1.445 Vali Loss: 1.336 Vali Acc: 0.420 Test Loss: 1.336 Test Acc: 0.420
Validation loss decreased (inf --> -0.420276).  Saving model ...
Epoch: 2 cost time: 3.843761444091797
Epoch: 2, Steps: 9 | Train Loss: 1.278 Vali Loss: 1.199 Vali Acc: 0.529 Test Loss: 1.199 Test Acc: 0.529
Validation loss decreased (-0.420276 --> -0.528974).  Saving model ...
Epoch: 3 cost time: 3.7635693550109863
Epoch: 3, Steps: 9 | Train Loss: 1.050 Vali Loss: 1.062 Vali Acc: 0.609 Test Loss: 1.062 Test Acc: 0.609
Validation loss decreased (-0.528974 --> -0.608685).  Saving model ...
Epoch: 4 cost time: 3.7175817489624023
Epoch: 4, Steps: 9 | Train Loss: 0.825 Vali Loss: 0.936 Vali Acc: 0.652 Test Loss: 0.936 Test Acc: 0.652
Validation loss decreased (-0.608685 --> -0.652165).  Saving model ...
Epoch: 5 cost time: 3.7949771881103516
Epoch: 5, Steps: 9 | Train Loss: 0.598 Vali Loss: 0.849 Vali Acc: 0.667 Test Loss: 0.849 Test Acc: 0.667
Validation loss decreased (-0.652165 --> -0.666658).  Saving model ...
Epoch: 6 cost time: 3.8479115962982178
Epoch: 6, Steps: 9 | Train Loss: 0.423 Vali Loss: 0.739 Vali Acc: 0.725 Test Loss: 0.739 Test Acc: 0.725
Validation loss decreased (-0.666658 --> -0.724630).  Saving model ...
Epoch: 7 cost time: 3.662825107574463
Epoch: 7, Steps: 9 | Train Loss: 0.271 Vali Loss: 0.652 Vali Acc: 0.768 Test Loss: 0.652 Test Acc: 0.768
Validation loss decreased (-0.724630 --> -0.768109).  Saving model ...
Epoch: 8 cost time: 3.7927660942077637
Epoch: 8, Steps: 9 | Train Loss: 0.183 Vali Loss: 0.574 Vali Acc: 0.804 Test Loss: 0.574 Test Acc: 0.804
Validation loss decreased (-0.768109 --> -0.804342).  Saving model ...
Epoch: 9 cost time: 3.743410587310791
Epoch: 9, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.533 Vali Acc: 0.841 Test Loss: 0.533 Test Acc: 0.841
Validation loss decreased (-0.804342 --> -0.840574).  Saving model ...
Epoch: 10 cost time: 4.0353710651397705
Epoch: 10, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.497 Vali Acc: 0.833 Test Loss: 0.497 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.556889295578003
Epoch: 11, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.493 Vali Acc: 0.833 Test Loss: 0.493 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.5503368377685547
Epoch: 12, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.472 Vali Acc: 0.833 Test Loss: 0.472 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.070509672164917
Epoch: 13, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.482 Vali Acc: 0.833 Test Loss: 0.482 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.583036422729492
Epoch: 14, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.466 Vali Acc: 0.841 Test Loss: 0.466 Test Acc: 0.841
Validation loss decreased (-0.840574 --> -0.840575).  Saving model ...
Epoch: 15 cost time: 3.812697172164917
Epoch: 15, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.471 Vali Acc: 0.841 Test Loss: 0.471 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.1547935009002686
Epoch: 16, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.453 Vali Acc: 0.841 Test Loss: 0.453 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 17 cost time: 3.9766461849212646
Epoch: 17, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.458 Vali Acc: 0.841 Test Loss: 0.458 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.0210206508636475
Epoch: 18, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.471 Vali Acc: 0.855 Test Loss: 0.471 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855068).  Saving model ...
Epoch: 19 cost time: 3.847114086151123
Epoch: 19, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.457 Vali Acc: 0.841 Test Loss: 0.457 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.9221882820129395
Epoch: 20, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.460 Vali Acc: 0.841 Test Loss: 0.460 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.002669334411621
Epoch: 21, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.457 Vali Acc: 0.841 Test Loss: 0.457 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.8692095279693604
Epoch: 22, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.453 Vali Acc: 0.848 Test Loss: 0.453 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.879340648651123
Epoch: 23, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.462 Vali Acc: 0.848 Test Loss: 0.462 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.5731935501098633
Epoch: 24, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.461 Vali Acc: 0.841 Test Loss: 0.461 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.674619197845459
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.456 Vali Acc: 0.855 Test Loss: 0.456 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 26 cost time: 3.7327206134796143
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.465 Vali Acc: 0.848 Test Loss: 0.465 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.3793704509735107
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.472 Vali Acc: 0.855 Test Loss: 0.472 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.7290215492248535
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.461 Vali Acc: 0.870 Test Loss: 0.461 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869561).  Saving model ...
Epoch: 29 cost time: 3.7248036861419678
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.458 Vali Acc: 0.862 Test Loss: 0.458 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.765143394470215
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.465 Vali Acc: 0.855 Test Loss: 0.465 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.8293259143829346
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.452 Vali Acc: 0.862 Test Loss: 0.452 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.727764129638672
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.452 Vali Acc: 0.870 Test Loss: 0.452 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 33 cost time: 3.672926902770996
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.459 Vali Acc: 0.862 Test Loss: 0.459 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 4.070871829986572
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.467 Vali Acc: 0.862 Test Loss: 0.467 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.7668256759643555
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.473 Vali Acc: 0.862 Test Loss: 0.473 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.6438374519348145
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.472 Vali Acc: 0.862 Test Loss: 0.472 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.873502254486084
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.471 Vali Acc: 0.862 Test Loss: 0.471 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.6142451763153076
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.465 Vali Acc: 0.862 Test Loss: 0.465 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.366630792617798
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.462 Vali Acc: 0.870 Test Loss: 0.462 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 3.462674617767334
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.473 Vali Acc: 0.870 Test Loss: 0.473 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 4.044538974761963
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.481 Vali Acc: 0.870 Test Loss: 0.481 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 3.725050210952759
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.479 Vali Acc: 0.870 Test Loss: 0.479 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df512_ma103_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 416900
model size : 4.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         83                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df512_ma83_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.381397724151611
Epoch: 1, Steps: 9 | Train Loss: 1.445 Vali Loss: 1.332 Vali Acc: 0.420 Test Loss: 1.332 Test Acc: 0.420
Validation loss decreased (inf --> -0.420277).  Saving model ...
Epoch: 2 cost time: 3.972287893295288
Epoch: 2, Steps: 9 | Train Loss: 1.270 Vali Loss: 1.199 Vali Acc: 0.543 Test Loss: 1.199 Test Acc: 0.543
Validation loss decreased (-0.420277 --> -0.543466).  Saving model ...
Epoch: 3 cost time: 4.065753698348999
Epoch: 3, Steps: 9 | Train Loss: 1.049 Vali Loss: 1.064 Vali Acc: 0.594 Test Loss: 1.064 Test Acc: 0.594
Validation loss decreased (-0.543466 --> -0.594192).  Saving model ...
Epoch: 4 cost time: 4.30150580406189
Epoch: 4, Steps: 9 | Train Loss: 0.823 Vali Loss: 0.939 Vali Acc: 0.681 Test Loss: 0.939 Test Acc: 0.681
Validation loss decreased (-0.594192 --> -0.681150).  Saving model ...
Epoch: 5 cost time: 3.8381547927856445
Epoch: 5, Steps: 9 | Train Loss: 0.604 Vali Loss: 0.851 Vali Acc: 0.696 Test Loss: 0.851 Test Acc: 0.696
Validation loss decreased (-0.681150 --> -0.695644).  Saving model ...
Epoch: 6 cost time: 3.8217108249664307
Epoch: 6, Steps: 9 | Train Loss: 0.426 Vali Loss: 0.738 Vali Acc: 0.754 Test Loss: 0.738 Test Acc: 0.754
Validation loss decreased (-0.695644 --> -0.753616).  Saving model ...
Epoch: 7 cost time: 3.7243123054504395
Epoch: 7, Steps: 9 | Train Loss: 0.277 Vali Loss: 0.656 Vali Acc: 0.790 Test Loss: 0.656 Test Acc: 0.790
Validation loss decreased (-0.753616 --> -0.789849).  Saving model ...
Epoch: 8 cost time: 4.170217752456665
Epoch: 8, Steps: 9 | Train Loss: 0.187 Vali Loss: 0.564 Vali Acc: 0.819 Test Loss: 0.564 Test Acc: 0.819
Validation loss decreased (-0.789849 --> -0.818835).  Saving model ...
Epoch: 9 cost time: 4.05248236656189
Epoch: 9, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.539 Vali Acc: 0.841 Test Loss: 0.539 Test Acc: 0.841
Validation loss decreased (-0.818835 --> -0.840574).  Saving model ...
Epoch: 10 cost time: 3.719334602355957
Epoch: 10, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.483 Vali Acc: 0.826 Test Loss: 0.483 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.365692138671875
Epoch: 11, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.477 Vali Acc: 0.884 Test Loss: 0.477 Test Acc: 0.884
Validation loss decreased (-0.840574 --> -0.884053).  Saving model ...
Epoch: 12 cost time: 4.2343103885650635
Epoch: 12, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.463 Vali Acc: 0.862 Test Loss: 0.463 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.158701181411743
Epoch: 13, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.459 Vali Acc: 0.855 Test Loss: 0.459 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.8895342350006104
Epoch: 14, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.438 Vali Acc: 0.862 Test Loss: 0.438 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.9876177310943604
Epoch: 15, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.454 Vali Acc: 0.877 Test Loss: 0.454 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.9286904335021973
Epoch: 16, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.431 Vali Acc: 0.862 Test Loss: 0.431 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.116854906082153
Epoch: 17, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.436 Vali Acc: 0.870 Test Loss: 0.436 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.7582602500915527
Epoch: 18, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.451 Vali Acc: 0.891 Test Loss: 0.451 Test Acc: 0.891
Validation loss decreased (-0.884053 --> -0.891300).  Saving model ...
Epoch: 19 cost time: 3.7213337421417236
Epoch: 19, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.429 Vali Acc: 0.877 Test Loss: 0.429 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.560199737548828
Epoch: 20, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.438 Vali Acc: 0.884 Test Loss: 0.438 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.909860372543335
Epoch: 21, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.437 Vali Acc: 0.877 Test Loss: 0.437 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.7175722122192383
Epoch: 22, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.428 Vali Acc: 0.870 Test Loss: 0.428 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.5296332836151123
Epoch: 23, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.441 Vali Acc: 0.891 Test Loss: 0.441 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 24 cost time: 3.76274037361145
Epoch: 24, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.437 Vali Acc: 0.877 Test Loss: 0.437 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.960664987564087
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.433 Vali Acc: 0.884 Test Loss: 0.433 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.7013702392578125
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.439 Vali Acc: 0.899 Test Loss: 0.439 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898546).  Saving model ...
Epoch: 27 cost time: 3.6928865909576416
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.447 Vali Acc: 0.891 Test Loss: 0.447 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.5878000259399414
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.433 Vali Acc: 0.899 Test Loss: 0.433 Test Acc: 0.899
Validation loss decreased (-0.898546 --> -0.898546).  Saving model ...
Epoch: 29 cost time: 3.544523239135742
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.427 Vali Acc: 0.884 Test Loss: 0.427 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.089853286743164
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.436 Vali Acc: 0.884 Test Loss: 0.436 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.7920081615448
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.421 Vali Acc: 0.891 Test Loss: 0.421 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.7695651054382324
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.421 Vali Acc: 0.891 Test Loss: 0.421 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.6407673358917236
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.425 Vali Acc: 0.891 Test Loss: 0.425 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.5479915142059326
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.435 Vali Acc: 0.891 Test Loss: 0.435 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.816857099533081
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.445 Vali Acc: 0.891 Test Loss: 0.445 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 3.624650239944458
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.448 Vali Acc: 0.891 Test Loss: 0.448 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.8811051845550537
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.445 Vali Acc: 0.891 Test Loss: 0.445 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.5154452323913574
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.435 Vali Acc: 0.884 Test Loss: 0.435 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df512_ma83_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 416900
model size : 4.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         62                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df512_ma62_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.487915515899658
Epoch: 1, Steps: 9 | Train Loss: 1.455 Vali Loss: 1.343 Vali Acc: 0.348 Test Loss: 1.343 Test Acc: 0.348
Validation loss decreased (inf --> -0.347813).  Saving model ...
Epoch: 2 cost time: 3.7596328258514404
Epoch: 2, Steps: 9 | Train Loss: 1.289 Vali Loss: 1.214 Vali Acc: 0.558 Test Loss: 1.214 Test Acc: 0.558
Validation loss decreased (-0.347813 --> -0.557959).  Saving model ...
Epoch: 3 cost time: 3.999513864517212
Epoch: 3, Steps: 9 | Train Loss: 1.072 Vali Loss: 1.075 Vali Acc: 0.609 Test Loss: 1.075 Test Acc: 0.609
Validation loss decreased (-0.557959 --> -0.608685).  Saving model ...
Epoch: 4 cost time: 3.8695337772369385
Epoch: 4, Steps: 9 | Train Loss: 0.829 Vali Loss: 0.950 Vali Acc: 0.667 Test Loss: 0.950 Test Acc: 0.667
Validation loss decreased (-0.608685 --> -0.666657).  Saving model ...
Epoch: 5 cost time: 3.9913783073425293
Epoch: 5, Steps: 9 | Train Loss: 0.608 Vali Loss: 0.862 Vali Acc: 0.703 Test Loss: 0.862 Test Acc: 0.703
Validation loss decreased (-0.666657 --> -0.702890).  Saving model ...
Epoch: 6 cost time: 3.5988352298736572
Epoch: 6, Steps: 9 | Train Loss: 0.419 Vali Loss: 0.739 Vali Acc: 0.775 Test Loss: 0.739 Test Acc: 0.775
Validation loss decreased (-0.702890 --> -0.775355).  Saving model ...
Epoch: 7 cost time: 3.6729838848114014
Epoch: 7, Steps: 9 | Train Loss: 0.266 Vali Loss: 0.659 Vali Acc: 0.775 Test Loss: 0.659 Test Acc: 0.775
Validation loss decreased (-0.775355 --> -0.775356).  Saving model ...
Epoch: 8 cost time: 3.832176923751831
Epoch: 8, Steps: 9 | Train Loss: 0.172 Vali Loss: 0.572 Vali Acc: 0.826 Test Loss: 0.572 Test Acc: 0.826
Validation loss decreased (-0.775356 --> -0.826081).  Saving model ...
Epoch: 9 cost time: 3.739515542984009
Epoch: 9, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.535 Vali Acc: 0.906 Test Loss: 0.535 Test Acc: 0.906
Validation loss decreased (-0.826081 --> -0.905792).  Saving model ...
Epoch: 10 cost time: 3.5528595447540283
Epoch: 10, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.480 Vali Acc: 0.884 Test Loss: 0.480 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.8363914489746094
Epoch: 11, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.481 Vali Acc: 0.877 Test Loss: 0.481 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.152399778366089
Epoch: 12, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.462 Vali Acc: 0.913 Test Loss: 0.462 Test Acc: 0.913
Validation loss decreased (-0.905792 --> -0.913039).  Saving model ...
Epoch: 13 cost time: 3.8488714694976807
Epoch: 13, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.460 Vali Acc: 0.906 Test Loss: 0.460 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.8369855880737305
Epoch: 14, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.440 Vali Acc: 0.920 Test Loss: 0.440 Test Acc: 0.920
Validation loss decreased (-0.913039 --> -0.920285).  Saving model ...
Epoch: 15 cost time: 4.006834506988525
Epoch: 15, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.460 Vali Acc: 0.913 Test Loss: 0.460 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.8747682571411133
Epoch: 16, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.441 Vali Acc: 0.906 Test Loss: 0.441 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.8935883045196533
Epoch: 17, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.436 Vali Acc: 0.913 Test Loss: 0.436 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.8224549293518066
Epoch: 18, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.451 Vali Acc: 0.920 Test Loss: 0.451 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.575291395187378
Epoch: 19, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.432 Vali Acc: 0.920 Test Loss: 0.432 Test Acc: 0.920
Validation loss decreased (-0.920285 --> -0.920286).  Saving model ...
Epoch: 20 cost time: 3.6290299892425537
Epoch: 20, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.440 Vali Acc: 0.920 Test Loss: 0.440 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.44248366355896
Epoch: 21, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.443 Vali Acc: 0.920 Test Loss: 0.443 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.4001550674438477
Epoch: 22, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.436 Vali Acc: 0.920 Test Loss: 0.436 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.4930927753448486
Epoch: 23, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.444 Vali Acc: 0.920 Test Loss: 0.444 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.319192886352539
Epoch: 24, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.438 Vali Acc: 0.920 Test Loss: 0.438 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.5165226459503174
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.439 Vali Acc: 0.920 Test Loss: 0.439 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.708405017852783
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.443 Vali Acc: 0.920 Test Loss: 0.443 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.769857168197632
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.448 Vali Acc: 0.920 Test Loss: 0.448 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.7864444255828857
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.442 Vali Acc: 0.920 Test Loss: 0.442 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.5986216068267822
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.437 Vali Acc: 0.928 Test Loss: 0.437 Test Acc: 0.928
Validation loss decreased (-0.920286 --> -0.927532).  Saving model ...
Epoch: 30 cost time: 3.83034610748291
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.440 Vali Acc: 0.928 Test Loss: 0.440 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.966918706893921
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.432 Vali Acc: 0.928 Test Loss: 0.432 Test Acc: 0.928
Validation loss decreased (-0.927532 --> -0.927532).  Saving model ...
Epoch: 32 cost time: 4.145759344100952
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.434 Vali Acc: 0.928 Test Loss: 0.434 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.6010162830352783
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.435 Vali Acc: 0.928 Test Loss: 0.435 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.7232532501220703
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.442 Vali Acc: 0.928 Test Loss: 0.442 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.623067617416382
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.450 Vali Acc: 0.920 Test Loss: 0.450 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.6812734603881836
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.452 Vali Acc: 0.920 Test Loss: 0.452 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.5741047859191895
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.450 Vali Acc: 0.920 Test Loss: 0.450 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.494547128677368
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.441 Vali Acc: 0.928 Test Loss: 0.441 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.480084180831909
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.440 Vali Acc: 0.928 Test Loss: 0.440 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.747838020324707
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.447 Vali Acc: 0.928 Test Loss: 0.447 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 3.643551826477051
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.454 Vali Acc: 0.928 Test Loss: 0.454 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df512_ma62_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 416900
model size : 4.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         42                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df512_ma42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.518185377120972
Epoch: 1, Steps: 9 | Train Loss: 1.464 Vali Loss: 1.344 Vali Acc: 0.333 Test Loss: 1.344 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 3.7342913150787354
Epoch: 2, Steps: 9 | Train Loss: 1.288 Vali Loss: 1.186 Vali Acc: 0.558 Test Loss: 1.186 Test Acc: 0.558
Validation loss decreased (-0.333320 --> -0.557959).  Saving model ...
Epoch: 3 cost time: 3.8648030757904053
Epoch: 3, Steps: 9 | Train Loss: 1.054 Vali Loss: 1.036 Vali Acc: 0.638 Test Loss: 1.036 Test Acc: 0.638
Validation loss decreased (-0.557959 --> -0.637671).  Saving model ...
Epoch: 4 cost time: 3.7888994216918945
Epoch: 4, Steps: 9 | Train Loss: 0.806 Vali Loss: 0.908 Vali Acc: 0.681 Test Loss: 0.908 Test Acc: 0.681
Validation loss decreased (-0.637671 --> -0.681150).  Saving model ...
Epoch: 5 cost time: 3.742072105407715
Epoch: 5, Steps: 9 | Train Loss: 0.575 Vali Loss: 0.814 Vali Acc: 0.696 Test Loss: 0.814 Test Acc: 0.696
Validation loss decreased (-0.681150 --> -0.695644).  Saving model ...
Epoch: 6 cost time: 3.465465784072876
Epoch: 6, Steps: 9 | Train Loss: 0.395 Vali Loss: 0.700 Vali Acc: 0.746 Test Loss: 0.700 Test Acc: 0.746
Validation loss decreased (-0.695644 --> -0.746370).  Saving model ...
Epoch: 7 cost time: 3.6553566455841064
Epoch: 7, Steps: 9 | Train Loss: 0.248 Vali Loss: 0.617 Vali Acc: 0.775 Test Loss: 0.617 Test Acc: 0.775
Validation loss decreased (-0.746370 --> -0.775356).  Saving model ...
Epoch: 8 cost time: 3.550297737121582
Epoch: 8, Steps: 9 | Train Loss: 0.167 Vali Loss: 0.550 Vali Acc: 0.797 Test Loss: 0.550 Test Acc: 0.797
Validation loss decreased (-0.775356 --> -0.797096).  Saving model ...
Epoch: 9 cost time: 3.549152374267578
Epoch: 9, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.503 Vali Acc: 0.819 Test Loss: 0.503 Test Acc: 0.819
Validation loss decreased (-0.797096 --> -0.818836).  Saving model ...
Epoch: 10 cost time: 3.3908684253692627
Epoch: 10, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.451 Vali Acc: 0.848 Test Loss: 0.451 Test Acc: 0.848
Validation loss decreased (-0.818836 --> -0.847822).  Saving model ...
Epoch: 11 cost time: 3.586247444152832
Epoch: 11, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.458 Vali Acc: 0.833 Test Loss: 0.458 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.4862723350524902
Epoch: 12, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.434 Vali Acc: 0.862 Test Loss: 0.434 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862314).  Saving model ...
Epoch: 13 cost time: 3.71700119972229
Epoch: 13, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.431 Vali Acc: 0.855 Test Loss: 0.431 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.77873158454895
Epoch: 14, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.413 Vali Acc: 0.862 Test Loss: 0.413 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862315).  Saving model ...
Epoch: 15 cost time: 3.5681536197662354
Epoch: 15, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.440 Vali Acc: 0.848 Test Loss: 0.440 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.593552589416504
Epoch: 16, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.408 Vali Acc: 0.884 Test Loss: 0.408 Test Acc: 0.884
Validation loss decreased (-0.862315 --> -0.884054).  Saving model ...
Epoch: 17 cost time: 3.5819551944732666
Epoch: 17, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.409 Vali Acc: 0.870 Test Loss: 0.409 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.517148017883301
Epoch: 18, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.409 Vali Acc: 0.870 Test Loss: 0.409 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.4106509685516357
Epoch: 19, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.403 Vali Acc: 0.877 Test Loss: 0.403 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.7639927864074707
Epoch: 20, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.406 Vali Acc: 0.862 Test Loss: 0.406 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.3232810497283936
Epoch: 21, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.412 Vali Acc: 0.870 Test Loss: 0.412 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.4023325443267822
Epoch: 22, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.404 Vali Acc: 0.870 Test Loss: 0.404 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.3233468532562256
Epoch: 23, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.412 Vali Acc: 0.870 Test Loss: 0.412 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.499828577041626
Epoch: 24, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.399 Vali Acc: 0.884 Test Loss: 0.399 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 25 cost time: 3.6015992164611816
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.400 Vali Acc: 0.884 Test Loss: 0.400 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.7987618446350098
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.411 Vali Acc: 0.870 Test Loss: 0.411 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.4849300384521484
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.415 Vali Acc: 0.877 Test Loss: 0.415 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.698660135269165
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.401 Vali Acc: 0.884 Test Loss: 0.401 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.780043840408325
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.392 Vali Acc: 0.884 Test Loss: 0.392 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 30 cost time: 4.090563774108887
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.396 Vali Acc: 0.884 Test Loss: 0.396 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.8192038536071777
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.389 Vali Acc: 0.884 Test Loss: 0.389 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 32 cost time: 3.5836572647094727
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.392 Vali Acc: 0.884 Test Loss: 0.392 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.7681679725646973
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.395 Vali Acc: 0.884 Test Loss: 0.395 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.4757397174835205
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.405 Vali Acc: 0.877 Test Loss: 0.405 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.725590705871582
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.413 Vali Acc: 0.870 Test Loss: 0.413 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.4639577865600586
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.411 Vali Acc: 0.877 Test Loss: 0.411 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.499098300933838
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.408 Vali Acc: 0.877 Test Loss: 0.408 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.6568222045898438
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.400 Vali Acc: 0.884 Test Loss: 0.400 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.5067737102508545
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.394 Vali Acc: 0.884 Test Loss: 0.394 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.696134328842163
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.410 Vali Acc: 0.891 Test Loss: 0.410 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891300).  Saving model ...
Epoch: 41 cost time: 3.835157871246338
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.424 Vali Acc: 0.884 Test Loss: 0.424 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.7471325397491455
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.427 Vali Acc: 0.891 Test Loss: 0.427 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.714211940765381
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.414 Vali Acc: 0.877 Test Loss: 0.414 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.739415407180786
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.408 Vali Acc: 0.884 Test Loss: 0.408 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 3.5879056453704834
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.408 Vali Acc: 0.899 Test Loss: 0.408 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898547).  Saving model ...
Epoch: 46 cost time: 4.07466197013855
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.405 Vali Acc: 0.899 Test Loss: 0.405 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 47 cost time: 3.6235079765319824
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.405 Vali Acc: 0.899 Test Loss: 0.405 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 48 cost time: 3.490518808364868
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.404 Vali Acc: 0.899 Test Loss: 0.404 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 49 cost time: 3.334416389465332
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.409 Vali Acc: 0.899 Test Loss: 0.409 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.3513848781585693
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.412 Vali Acc: 0.899 Test Loss: 0.412 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 3.21962308883667
Epoch: 51, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.420 Vali Acc: 0.891 Test Loss: 0.420 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 3.423457384109497
Epoch: 52, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.423 Vali Acc: 0.891 Test Loss: 0.423 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 3.4534919261932373
Epoch: 53, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.416 Vali Acc: 0.891 Test Loss: 0.416 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 3.5936148166656494
Epoch: 54, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.418 Vali Acc: 0.891 Test Loss: 0.418 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 3.6545064449310303
Epoch: 55, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.417 Vali Acc: 0.891 Test Loss: 0.417 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 3.7113418579101562
Epoch: 56, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.419 Vali Acc: 0.891 Test Loss: 0.419 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 3.5531246662139893
Epoch: 57, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.422 Vali Acc: 0.891 Test Loss: 0.422 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 3.513188123703003
Epoch: 58, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.424 Vali Acc: 0.891 Test Loss: 0.424 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df512_ma42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 416900
model size : 4.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df512_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.224880695343018
Epoch: 1, Steps: 9 | Train Loss: 1.451 Vali Loss: 1.342 Vali Acc: 0.370 Test Loss: 1.342 Test Acc: 0.370
Validation loss decreased (inf --> -0.369552).  Saving model ...
Epoch: 2 cost time: 3.3378336429595947
Epoch: 2, Steps: 9 | Train Loss: 1.294 Vali Loss: 1.202 Vali Acc: 0.536 Test Loss: 1.202 Test Acc: 0.536
Validation loss decreased (-0.369552 --> -0.536220).  Saving model ...
Epoch: 3 cost time: 3.660172462463379
Epoch: 3, Steps: 9 | Train Loss: 1.054 Vali Loss: 1.058 Vali Acc: 0.659 Test Loss: 1.058 Test Acc: 0.659
Validation loss decreased (-0.536220 --> -0.659410).  Saving model ...
Epoch: 4 cost time: 3.617361068725586
Epoch: 4, Steps: 9 | Train Loss: 0.810 Vali Loss: 0.933 Vali Acc: 0.696 Test Loss: 0.933 Test Acc: 0.696
Validation loss decreased (-0.659410 --> -0.695643).  Saving model ...
Epoch: 5 cost time: 3.3759963512420654
Epoch: 5, Steps: 9 | Train Loss: 0.580 Vali Loss: 0.819 Vali Acc: 0.746 Test Loss: 0.819 Test Acc: 0.746
Validation loss decreased (-0.695643 --> -0.746369).  Saving model ...
Epoch: 6 cost time: 3.5242295265197754
Epoch: 6, Steps: 9 | Train Loss: 0.418 Vali Loss: 0.700 Vali Acc: 0.768 Test Loss: 0.700 Test Acc: 0.768
Validation loss decreased (-0.746369 --> -0.768109).  Saving model ...
Epoch: 7 cost time: 3.5241012573242188
Epoch: 7, Steps: 9 | Train Loss: 0.266 Vali Loss: 0.595 Vali Acc: 0.819 Test Loss: 0.595 Test Acc: 0.819
Validation loss decreased (-0.768109 --> -0.818835).  Saving model ...
Epoch: 8 cost time: 3.464536666870117
Epoch: 8, Steps: 9 | Train Loss: 0.168 Vali Loss: 0.508 Vali Acc: 0.848 Test Loss: 0.508 Test Acc: 0.848
Validation loss decreased (-0.818835 --> -0.847821).  Saving model ...
Epoch: 9 cost time: 3.988093376159668
Epoch: 9, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.450 Vali Acc: 0.862 Test Loss: 0.450 Test Acc: 0.862
Validation loss decreased (-0.847821 --> -0.862314).  Saving model ...
Epoch: 10 cost time: 3.876538038253784
Epoch: 10, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.401 Vali Acc: 0.877 Test Loss: 0.401 Test Acc: 0.877
Validation loss decreased (-0.862314 --> -0.876808).  Saving model ...
Epoch: 11 cost time: 4.054033994674683
Epoch: 11, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.365 Vali Acc: 0.884 Test Loss: 0.365 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 12 cost time: 4.218292951583862
Epoch: 12, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.349 Vali Acc: 0.906 Test Loss: 0.349 Test Acc: 0.906
Validation loss decreased (-0.884054 --> -0.905794).  Saving model ...
Epoch: 13 cost time: 3.7787866592407227
Epoch: 13, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.360 Vali Acc: 0.891 Test Loss: 0.360 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.839421272277832
Epoch: 14, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.319 Vali Acc: 0.899 Test Loss: 0.319 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.714460611343384
Epoch: 15, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.331 Vali Acc: 0.913 Test Loss: 0.331 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913040).  Saving model ...
Epoch: 16 cost time: 3.8513569831848145
Epoch: 16, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.331 Vali Acc: 0.913 Test Loss: 0.331 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 17 cost time: 3.7622768878936768
Epoch: 17, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.313 Vali Acc: 0.913 Test Loss: 0.313 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 18 cost time: 3.5239226818084717
Epoch: 18, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.311 Vali Acc: 0.913 Test Loss: 0.311 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 19 cost time: 3.539027690887451
Epoch: 19, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.314 Vali Acc: 0.913 Test Loss: 0.314 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.5976836681365967
Epoch: 20, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.327 Vali Acc: 0.913 Test Loss: 0.327 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.5342772006988525
Epoch: 21, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.315 Vali Acc: 0.913 Test Loss: 0.315 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.7758371829986572
Epoch: 22, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.301 Vali Acc: 0.913 Test Loss: 0.301 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 23 cost time: 3.883728265762329
Epoch: 23, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.307 Vali Acc: 0.913 Test Loss: 0.307 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.647041082382202
Epoch: 24, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.303 Vali Acc: 0.913 Test Loss: 0.303 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.797346353530884
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.304 Vali Acc: 0.906 Test Loss: 0.304 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.990290641784668
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.312 Vali Acc: 0.913 Test Loss: 0.312 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.905172824859619
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.320 Vali Acc: 0.913 Test Loss: 0.320 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.1691577434539795
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.306 Vali Acc: 0.913 Test Loss: 0.306 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.762538433074951
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.294 Vali Acc: 0.913 Test Loss: 0.294 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913041).  Saving model ...
Epoch: 30 cost time: 3.7684061527252197
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.293 Vali Acc: 0.913 Test Loss: 0.293 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 31 cost time: 3.7112553119659424
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.290 Vali Acc: 0.913 Test Loss: 0.290 Test Acc: 0.913
Validation loss decreased (-0.913041 --> -0.913041).  Saving model ...
Epoch: 32 cost time: 3.807400941848755
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.296 Vali Acc: 0.913 Test Loss: 0.296 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.582536220550537
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.298 Vali Acc: 0.913 Test Loss: 0.298 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.555001974105835
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.297 Vali Acc: 0.913 Test Loss: 0.297 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.5193710327148438
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.296 Vali Acc: 0.913 Test Loss: 0.296 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.443937301635742
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.296 Vali Acc: 0.913 Test Loss: 0.296 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.5822503566741943
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.298 Vali Acc: 0.913 Test Loss: 0.298 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.6288864612579346
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.293 Vali Acc: 0.913 Test Loss: 0.293 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.8557162284851074
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.294 Vali Acc: 0.913 Test Loss: 0.294 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.620856761932373
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.303 Vali Acc: 0.913 Test Loss: 0.303 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 3.726107120513916
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.308 Vali Acc: 0.906 Test Loss: 0.308 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df512_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 416900
model size : 4.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df512_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.8429765701293945
Epoch: 1, Steps: 9 | Train Loss: 1.445 Vali Loss: 1.365 Vali Acc: 0.384 Test Loss: 1.365 Test Acc: 0.384
Validation loss decreased (inf --> -0.384044).  Saving model ...
Epoch: 2 cost time: 3.4787533283233643
Epoch: 2, Steps: 9 | Train Loss: 1.311 Vali Loss: 1.222 Vali Acc: 0.514 Test Loss: 1.222 Test Acc: 0.514
Validation loss decreased (-0.384044 --> -0.514481).  Saving model ...
Epoch: 3 cost time: 3.6940054893493652
Epoch: 3, Steps: 9 | Train Loss: 1.092 Vali Loss: 1.073 Vali Acc: 0.616 Test Loss: 1.073 Test Acc: 0.616
Validation loss decreased (-0.514481 --> -0.615931).  Saving model ...
Epoch: 4 cost time: 3.437401294708252
Epoch: 4, Steps: 9 | Train Loss: 0.851 Vali Loss: 0.939 Vali Acc: 0.681 Test Loss: 0.939 Test Acc: 0.681
Validation loss decreased (-0.615931 --> -0.681150).  Saving model ...
Epoch: 5 cost time: 3.3340604305267334
Epoch: 5, Steps: 9 | Train Loss: 0.613 Vali Loss: 0.842 Vali Acc: 0.696 Test Loss: 0.842 Test Acc: 0.696
Validation loss decreased (-0.681150 --> -0.695644).  Saving model ...
Epoch: 6 cost time: 3.5206408500671387
Epoch: 6, Steps: 9 | Train Loss: 0.456 Vali Loss: 0.719 Vali Acc: 0.725 Test Loss: 0.719 Test Acc: 0.725
Validation loss decreased (-0.695644 --> -0.724630).  Saving model ...
Epoch: 7 cost time: 3.4662575721740723
Epoch: 7, Steps: 9 | Train Loss: 0.299 Vali Loss: 0.647 Vali Acc: 0.761 Test Loss: 0.647 Test Acc: 0.761
Validation loss decreased (-0.724630 --> -0.760863).  Saving model ...
Epoch: 8 cost time: 3.5021653175354004
Epoch: 8, Steps: 9 | Train Loss: 0.217 Vali Loss: 0.573 Vali Acc: 0.761 Test Loss: 0.573 Test Acc: 0.761
Validation loss decreased (-0.760863 --> -0.760864).  Saving model ...
Epoch: 9 cost time: 3.846200942993164
Epoch: 9, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.535 Vali Acc: 0.768 Test Loss: 0.535 Test Acc: 0.768
Validation loss decreased (-0.760864 --> -0.768111).  Saving model ...
Epoch: 10 cost time: 3.4754295349121094
Epoch: 10, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.495 Vali Acc: 0.804 Test Loss: 0.495 Test Acc: 0.804
Validation loss decreased (-0.768111 --> -0.804343).  Saving model ...
Epoch: 11 cost time: 3.488370418548584
Epoch: 11, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.475 Vali Acc: 0.812 Test Loss: 0.475 Test Acc: 0.812
Validation loss decreased (-0.804343 --> -0.811589).  Saving model ...
Epoch: 12 cost time: 3.818225860595703
Epoch: 12, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.461 Vali Acc: 0.819 Test Loss: 0.461 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818836).  Saving model ...
Epoch: 13 cost time: 3.8410282135009766
Epoch: 13, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.452 Vali Acc: 0.826 Test Loss: 0.452 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826082).  Saving model ...
Epoch: 14 cost time: 4.0036537647247314
Epoch: 14, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.421 Vali Acc: 0.841 Test Loss: 0.421 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840576).  Saving model ...
Epoch: 15 cost time: 4.11639404296875
Epoch: 15, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.439 Vali Acc: 0.833 Test Loss: 0.439 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.9168612957000732
Epoch: 16, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.416 Vali Acc: 0.848 Test Loss: 0.416 Test Acc: 0.848
Validation loss decreased (-0.840576 --> -0.847822).  Saving model ...
Epoch: 17 cost time: 3.764587879180908
Epoch: 17, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.418 Vali Acc: 0.841 Test Loss: 0.418 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.7306525707244873
Epoch: 18, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.426 Vali Acc: 0.819 Test Loss: 0.426 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.792445659637451
Epoch: 19, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.409 Vali Acc: 0.841 Test Loss: 0.409 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.868723154067993
Epoch: 20, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.411 Vali Acc: 0.848 Test Loss: 0.411 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 21 cost time: 3.705040454864502
Epoch: 21, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.424 Vali Acc: 0.826 Test Loss: 0.424 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.9078898429870605
Epoch: 22, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.402 Vali Acc: 0.855 Test Loss: 0.402 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 23 cost time: 3.713003635406494
Epoch: 23, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.409 Vali Acc: 0.841 Test Loss: 0.409 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.9591305255889893
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.402 Vali Acc: 0.848 Test Loss: 0.402 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.972853183746338
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.395 Vali Acc: 0.848 Test Loss: 0.395 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.817131996154785
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.411 Vali Acc: 0.833 Test Loss: 0.411 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.4597840309143066
Epoch: 27, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.407 Vali Acc: 0.841 Test Loss: 0.407 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.506466865539551
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.386 Vali Acc: 0.855 Test Loss: 0.386 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855069).  Saving model ...
Epoch: 29 cost time: 3.521735429763794
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.381 Vali Acc: 0.855 Test Loss: 0.381 Test Acc: 0.855
Validation loss decreased (-0.855069 --> -0.855069).  Saving model ...
Epoch: 30 cost time: 3.371957778930664
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.394 Vali Acc: 0.855 Test Loss: 0.394 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.6893985271453857
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.398 Vali Acc: 0.862 Test Loss: 0.398 Test Acc: 0.862
Validation loss decreased (-0.855069 --> -0.862315).  Saving model ...
Epoch: 32 cost time: 3.541823387145996
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.388 Vali Acc: 0.870 Test Loss: 0.388 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 33 cost time: 3.3055641651153564
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.386 Vali Acc: 0.870 Test Loss: 0.386 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 34 cost time: 3.4609832763671875
Epoch: 34, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.393 Vali Acc: 0.870 Test Loss: 0.393 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.353680372238159
Epoch: 35, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.404 Vali Acc: 0.862 Test Loss: 0.404 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.7212390899658203
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.392 Vali Acc: 0.870 Test Loss: 0.392 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.6130499839782715
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.383 Vali Acc: 0.870 Test Loss: 0.383 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 38 cost time: 3.9100255966186523
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.380 Vali Acc: 0.870 Test Loss: 0.380 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 39 cost time: 4.071908712387085
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.382 Vali Acc: 0.870 Test Loss: 0.382 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 4.200342893600464
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.391 Vali Acc: 0.870 Test Loss: 0.391 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.917985677719116
Epoch: 41, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.400 Vali Acc: 0.870 Test Loss: 0.400 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.999882936477661
Epoch: 42, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.394 Vali Acc: 0.870 Test Loss: 0.394 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 4.166840553283691
Epoch: 43, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.381 Vali Acc: 0.870 Test Loss: 0.381 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 4.1853766441345215
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.383 Vali Acc: 0.870 Test Loss: 0.383 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 3.887470245361328
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.389 Vali Acc: 0.870 Test Loss: 0.389 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 3.7203245162963867
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.388 Vali Acc: 0.870 Test Loss: 0.388 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 4.124458312988281
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.389 Vali Acc: 0.870 Test Loss: 0.389 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 3.7639472484588623
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.387 Vali Acc: 0.870 Test Loss: 0.387 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df512_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 416900
model size : 4.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df512_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.633325815200806
Epoch: 1, Steps: 9 | Train Loss: 1.457 Vali Loss: 1.319 Vali Acc: 0.413 Test Loss: 1.319 Test Acc: 0.413
Validation loss decreased (inf --> -0.413030).  Saving model ...
Epoch: 2 cost time: 4.272324323654175
Epoch: 2, Steps: 9 | Train Loss: 1.290 Vali Loss: 1.178 Vali Acc: 0.493 Test Loss: 1.178 Test Acc: 0.493
Validation loss decreased (-0.413030 --> -0.492742).  Saving model ...
Epoch: 3 cost time: 4.366431951522827
Epoch: 3, Steps: 9 | Train Loss: 1.071 Vali Loss: 1.039 Vali Acc: 0.565 Test Loss: 1.039 Test Acc: 0.565
Validation loss decreased (-0.492742 --> -0.565207).  Saving model ...
Epoch: 4 cost time: 4.198505163192749
Epoch: 4, Steps: 9 | Train Loss: 0.818 Vali Loss: 0.939 Vali Acc: 0.623 Test Loss: 0.939 Test Acc: 0.623
Validation loss decreased (-0.565207 --> -0.623179).  Saving model ...
Epoch: 5 cost time: 4.122832298278809
Epoch: 5, Steps: 9 | Train Loss: 0.609 Vali Loss: 0.869 Vali Acc: 0.638 Test Loss: 0.869 Test Acc: 0.638
Validation loss decreased (-0.623179 --> -0.637672).  Saving model ...
Epoch: 6 cost time: 4.129906177520752
Epoch: 6, Steps: 9 | Train Loss: 0.443 Vali Loss: 0.789 Vali Acc: 0.703 Test Loss: 0.789 Test Acc: 0.703
Validation loss decreased (-0.637672 --> -0.702891).  Saving model ...
Epoch: 7 cost time: 4.29253888130188
Epoch: 7, Steps: 9 | Train Loss: 0.303 Vali Loss: 0.751 Vali Acc: 0.703 Test Loss: 0.751 Test Acc: 0.703
Validation loss decreased (-0.702891 --> -0.702891).  Saving model ...
Epoch: 8 cost time: 3.8396480083465576
Epoch: 8, Steps: 9 | Train Loss: 0.229 Vali Loss: 0.702 Vali Acc: 0.725 Test Loss: 0.702 Test Acc: 0.725
Validation loss decreased (-0.702891 --> -0.724631).  Saving model ...
Epoch: 9 cost time: 3.7099335193634033
Epoch: 9, Steps: 9 | Train Loss: 0.156 Vali Loss: 0.695 Vali Acc: 0.710 Test Loss: 0.695 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.005892753601074
Epoch: 10, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.646 Vali Acc: 0.761 Test Loss: 0.646 Test Acc: 0.761
Validation loss decreased (-0.724631 --> -0.760863).  Saving model ...
Epoch: 11 cost time: 3.825735330581665
Epoch: 11, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.651 Vali Acc: 0.746 Test Loss: 0.651 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.713240146636963
Epoch: 12, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.629 Vali Acc: 0.775 Test Loss: 0.629 Test Acc: 0.775
Validation loss decreased (-0.760863 --> -0.775356).  Saving model ...
Epoch: 13 cost time: 3.5475287437438965
Epoch: 13, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.626 Vali Acc: 0.754 Test Loss: 0.626 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.8729536533355713
Epoch: 14, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.620 Vali Acc: 0.775 Test Loss: 0.620 Test Acc: 0.775
Validation loss decreased (-0.775356 --> -0.775356).  Saving model ...
Epoch: 15 cost time: 3.8422069549560547
Epoch: 15, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.630 Vali Acc: 0.768 Test Loss: 0.630 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.9825053215026855
Epoch: 16, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.626 Vali Acc: 0.783 Test Loss: 0.626 Test Acc: 0.783
Validation loss decreased (-0.775356 --> -0.782602).  Saving model ...
Epoch: 17 cost time: 4.027326822280884
Epoch: 17, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.637 Vali Acc: 0.775 Test Loss: 0.637 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.160358190536499
Epoch: 18, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.631 Vali Acc: 0.783 Test Loss: 0.631 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.236716985702515
Epoch: 19, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.631 Vali Acc: 0.775 Test Loss: 0.631 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.9012491703033447
Epoch: 20, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.648 Vali Acc: 0.783 Test Loss: 0.648 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.6570916175842285
Epoch: 21, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.642 Vali Acc: 0.790 Test Loss: 0.642 Test Acc: 0.790
Validation loss decreased (-0.782602 --> -0.789849).  Saving model ...
Epoch: 22 cost time: 3.603834867477417
Epoch: 22, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.641 Vali Acc: 0.790 Test Loss: 0.641 Test Acc: 0.790
Validation loss decreased (-0.789849 --> -0.789849).  Saving model ...
Epoch: 23 cost time: 3.808961868286133
Epoch: 23, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.648 Vali Acc: 0.783 Test Loss: 0.648 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.637925624847412
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.649 Vali Acc: 0.783 Test Loss: 0.649 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.577911376953125
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.653 Vali Acc: 0.783 Test Loss: 0.653 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.9120161533355713
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.643 Vali Acc: 0.783 Test Loss: 0.643 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.802368402481079
Epoch: 27, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.645 Vali Acc: 0.783 Test Loss: 0.645 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.565986633300781
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.649 Vali Acc: 0.783 Test Loss: 0.649 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.738588809967041
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.654 Vali Acc: 0.783 Test Loss: 0.654 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.6910481452941895
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.656 Vali Acc: 0.783 Test Loss: 0.656 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.6937942504882812
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.650 Vali Acc: 0.783 Test Loss: 0.650 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.583806037902832
Epoch: 32, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.655 Vali Acc: 0.783 Test Loss: 0.655 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df512_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7898550724637681
model parameter : 416900
model size : 4.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.35023307800293
Epoch: 1, Steps: 9 | Train Loss: 1.450 Vali Loss: 1.372 Vali Acc: 0.377 Test Loss: 1.372 Test Acc: 0.377
Validation loss decreased (inf --> -0.376798).  Saving model ...
Epoch: 2 cost time: 3.6303043365478516
Epoch: 2, Steps: 9 | Train Loss: 1.360 Vali Loss: 1.339 Vali Acc: 0.348 Test Loss: 1.339 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.7897634506225586
Epoch: 3, Steps: 9 | Train Loss: 1.205 Vali Loss: 1.287 Vali Acc: 0.413 Test Loss: 1.287 Test Acc: 0.413
Validation loss decreased (-0.376798 --> -0.413031).  Saving model ...
Epoch: 4 cost time: 3.6941888332366943
Epoch: 4, Steps: 9 | Train Loss: 1.036 Vali Loss: 1.237 Vali Acc: 0.457 Test Loss: 1.237 Test Acc: 0.457
Validation loss decreased (-0.413031 --> -0.456509).  Saving model ...
Epoch: 5 cost time: 3.7424910068511963
Epoch: 5, Steps: 9 | Train Loss: 0.846 Vali Loss: 1.204 Vali Acc: 0.457 Test Loss: 1.204 Test Acc: 0.457
Validation loss decreased (-0.456509 --> -0.456510).  Saving model ...
Epoch: 6 cost time: 3.584444046020508
Epoch: 6, Steps: 9 | Train Loss: 0.681 Vali Loss: 1.184 Vali Acc: 0.493 Test Loss: 1.184 Test Acc: 0.493
Validation loss decreased (-0.456510 --> -0.492742).  Saving model ...
Epoch: 7 cost time: 3.604740858078003
Epoch: 7, Steps: 9 | Train Loss: 0.507 Vali Loss: 1.152 Vali Acc: 0.493 Test Loss: 1.152 Test Acc: 0.493
Validation loss decreased (-0.492742 --> -0.492742).  Saving model ...
Epoch: 8 cost time: 4.006689786911011
Epoch: 8, Steps: 9 | Train Loss: 0.404 Vali Loss: 1.185 Vali Acc: 0.493 Test Loss: 1.185 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.7818098068237305
Epoch: 9, Steps: 9 | Train Loss: 0.302 Vali Loss: 1.204 Vali Acc: 0.486 Test Loss: 1.204 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.720674991607666
Epoch: 10, Steps: 9 | Train Loss: 0.247 Vali Loss: 1.188 Vali Acc: 0.514 Test Loss: 1.188 Test Acc: 0.514
Validation loss decreased (-0.492742 --> -0.514481).  Saving model ...
Epoch: 11 cost time: 3.762885093688965
Epoch: 11, Steps: 9 | Train Loss: 0.148 Vali Loss: 1.331 Vali Acc: 0.449 Test Loss: 1.331 Test Acc: 0.449
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.806413173675537
Epoch: 12, Steps: 9 | Train Loss: 0.103 Vali Loss: 1.258 Vali Acc: 0.478 Test Loss: 1.258 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.6803812980651855
Epoch: 13, Steps: 9 | Train Loss: 0.081 Vali Loss: 1.320 Vali Acc: 0.478 Test Loss: 1.320 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.70890474319458
Epoch: 14, Steps: 9 | Train Loss: 0.073 Vali Loss: 1.442 Vali Acc: 0.464 Test Loss: 1.442 Test Acc: 0.464
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.4748764038085938
Epoch: 15, Steps: 9 | Train Loss: 0.049 Vali Loss: 1.276 Vali Acc: 0.514 Test Loss: 1.276 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.3413000106811523
Epoch: 16, Steps: 9 | Train Loss: 0.038 Vali Loss: 1.531 Vali Acc: 0.464 Test Loss: 1.531 Test Acc: 0.464
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.5086236000061035
Epoch: 17, Steps: 9 | Train Loss: 0.032 Vali Loss: 1.480 Vali Acc: 0.507 Test Loss: 1.480 Test Acc: 0.507
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.2076117992401123
Epoch: 18, Steps: 9 | Train Loss: 0.023 Vali Loss: 1.354 Vali Acc: 0.522 Test Loss: 1.354 Test Acc: 0.522
Validation loss decreased (-0.514481 --> -0.521726).  Saving model ...
Epoch: 19 cost time: 3.370105266571045
Epoch: 19, Steps: 9 | Train Loss: 0.021 Vali Loss: 1.383 Vali Acc: 0.500 Test Loss: 1.383 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.3737642765045166
Epoch: 20, Steps: 9 | Train Loss: 0.018 Vali Loss: 1.448 Vali Acc: 0.522 Test Loss: 1.448 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.6176352500915527
Epoch: 21, Steps: 9 | Train Loss: 0.014 Vali Loss: 1.451 Vali Acc: 0.514 Test Loss: 1.451 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.61326003074646
Epoch: 22, Steps: 9 | Train Loss: 0.012 Vali Loss: 1.456 Vali Acc: 0.536 Test Loss: 1.456 Test Acc: 0.536
Validation loss decreased (-0.521726 --> -0.536217).  Saving model ...
Epoch: 23 cost time: 3.7494890689849854
Epoch: 23, Steps: 9 | Train Loss: 0.011 Vali Loss: 1.434 Vali Acc: 0.536 Test Loss: 1.434 Test Acc: 0.536
Validation loss decreased (-0.536217 --> -0.536218).  Saving model ...
Epoch: 24 cost time: 3.8796024322509766
Epoch: 24, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.453 Vali Acc: 0.543 Test Loss: 1.453 Test Acc: 0.543
Validation loss decreased (-0.536218 --> -0.543464).  Saving model ...
Epoch: 25 cost time: 3.595155954360962
Epoch: 25, Steps: 9 | Train Loss: 0.010 Vali Loss: 1.419 Vali Acc: 0.536 Test Loss: 1.419 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.470512866973877
Epoch: 26, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.376 Vali Acc: 0.558 Test Loss: 1.376 Test Acc: 0.558
Validation loss decreased (-0.543464 --> -0.557957).  Saving model ...
Epoch: 27 cost time: 3.4757440090179443
Epoch: 27, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.352 Vali Acc: 0.580 Test Loss: 1.352 Test Acc: 0.580
Validation loss decreased (-0.557957 --> -0.579697).  Saving model ...
Epoch: 28 cost time: 3.6051156520843506
Epoch: 28, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.424 Vali Acc: 0.543 Test Loss: 1.424 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.528998851776123
Epoch: 29, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.470 Vali Acc: 0.551 Test Loss: 1.470 Test Acc: 0.551
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.488119125366211
Epoch: 30, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.362 Vali Acc: 0.580 Test Loss: 1.362 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.2869391441345215
Epoch: 31, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.390 Vali Acc: 0.543 Test Loss: 1.390 Test Acc: 0.543
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.487313985824585
Epoch: 32, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.434 Vali Acc: 0.551 Test Loss: 1.434 Test Acc: 0.551
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.3207969665527344
Epoch: 33, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.441 Vali Acc: 0.536 Test Loss: 1.441 Test Acc: 0.536
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.566291570663452
Epoch: 34, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.428 Vali Acc: 0.572 Test Loss: 1.428 Test Acc: 0.572
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.316342353820801
Epoch: 35, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.398 Vali Acc: 0.572 Test Loss: 1.398 Test Acc: 0.572
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 3.4827322959899902
Epoch: 36, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.392 Vali Acc: 0.572 Test Loss: 1.392 Test Acc: 0.572
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 3.25519061088562
Epoch: 37, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.368 Vali Acc: 0.580 Test Loss: 1.368 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5797101449275363
model parameter : 416900
model size : 4.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.8176398277282715
Epoch: 1, Steps: 9 | Train Loss: 1.457 Vali Loss: 1.419 Vali Acc: 0.232 Test Loss: 1.419 Test Acc: 0.232
Validation loss decreased (inf --> -0.231870).  Saving model ...
Epoch: 2 cost time: 3.1118967533111572
Epoch: 2, Steps: 9 | Train Loss: 1.390 Vali Loss: 1.419 Vali Acc: 0.312 Test Loss: 1.419 Test Acc: 0.312
Validation loss decreased (-0.231870 --> -0.311580).  Saving model ...
Epoch: 3 cost time: 3.4627163410186768
Epoch: 3, Steps: 9 | Train Loss: 1.281 Vali Loss: 1.430 Vali Acc: 0.319 Test Loss: 1.430 Test Acc: 0.319
Validation loss decreased (-0.311580 --> -0.318826).  Saving model ...
Epoch: 4 cost time: 3.4418017864227295
Epoch: 4, Steps: 9 | Train Loss: 1.169 Vali Loss: 1.401 Vali Acc: 0.333 Test Loss: 1.401 Test Acc: 0.333
Validation loss decreased (-0.318826 --> -0.333319).  Saving model ...
Epoch: 5 cost time: 3.643141269683838
Epoch: 5, Steps: 9 | Train Loss: 1.042 Vali Loss: 1.432 Vali Acc: 0.319 Test Loss: 1.432 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.859929084777832
Epoch: 6, Steps: 9 | Train Loss: 0.925 Vali Loss: 1.511 Vali Acc: 0.304 Test Loss: 1.511 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.8458316326141357
Epoch: 7, Steps: 9 | Train Loss: 0.770 Vali Loss: 1.550 Vali Acc: 0.304 Test Loss: 1.550 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.595238208770752
Epoch: 8, Steps: 9 | Train Loss: 0.679 Vali Loss: 1.815 Vali Acc: 0.297 Test Loss: 1.815 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.159655570983887
Epoch: 9, Steps: 9 | Train Loss: 0.523 Vali Loss: 1.831 Vali Acc: 0.290 Test Loss: 1.831 Test Acc: 0.290
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.385460138320923
Epoch: 10, Steps: 9 | Train Loss: 0.446 Vali Loss: 1.944 Vali Acc: 0.304 Test Loss: 1.944 Test Acc: 0.304
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.607609510421753
Epoch: 11, Steps: 9 | Train Loss: 0.352 Vali Loss: 2.433 Vali Acc: 0.304 Test Loss: 2.433 Test Acc: 0.304
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.4715771675109863
Epoch: 12, Steps: 9 | Train Loss: 0.259 Vali Loss: 2.358 Vali Acc: 0.297 Test Loss: 2.358 Test Acc: 0.297
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.3445112705230713
Epoch: 13, Steps: 9 | Train Loss: 0.214 Vali Loss: 2.508 Vali Acc: 0.290 Test Loss: 2.508 Test Acc: 0.290
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.3564493656158447
Epoch: 14, Steps: 9 | Train Loss: 0.180 Vali Loss: 2.804 Vali Acc: 0.326 Test Loss: 2.804 Test Acc: 0.326
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.3333333333333333
model parameter : 416900
model size : 4.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.209421634674072
Epoch: 1, Steps: 9 | Train Loss: 1.486 Vali Loss: 1.397 Vali Acc: 0.297 Test Loss: 1.397 Test Acc: 0.297
Validation loss decreased (inf --> -0.297087).  Saving model ...
Epoch: 2 cost time: 3.302494525909424
Epoch: 2, Steps: 9 | Train Loss: 1.359 Vali Loss: 1.383 Vali Acc: 0.312 Test Loss: 1.383 Test Acc: 0.312
Validation loss decreased (-0.297087 --> -0.311580).  Saving model ...
Epoch: 3 cost time: 3.326986789703369
Epoch: 3, Steps: 9 | Train Loss: 1.295 Vali Loss: 1.367 Vali Acc: 0.297 Test Loss: 1.367 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.594822406768799
Epoch: 4, Steps: 9 | Train Loss: 1.153 Vali Loss: 1.324 Vali Acc: 0.312 Test Loss: 1.324 Test Acc: 0.312
Validation loss decreased (-0.311580 --> -0.311581).  Saving model ...
Epoch: 5 cost time: 3.5133140087127686
Epoch: 5, Steps: 9 | Train Loss: 1.040 Vali Loss: 1.315 Vali Acc: 0.304 Test Loss: 1.315 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.3345227241516113
Epoch: 6, Steps: 9 | Train Loss: 0.859 Vali Loss: 1.303 Vali Acc: 0.341 Test Loss: 1.303 Test Acc: 0.341
Validation loss decreased (-0.311581 --> -0.340567).  Saving model ...
Epoch: 7 cost time: 3.3680081367492676
Epoch: 7, Steps: 9 | Train Loss: 0.688 Vali Loss: 1.290 Vali Acc: 0.348 Test Loss: 1.290 Test Acc: 0.348
Validation loss decreased (-0.340567 --> -0.347813).  Saving model ...
Epoch: 8 cost time: 3.516554355621338
Epoch: 8, Steps: 9 | Train Loss: 0.593 Vali Loss: 1.366 Vali Acc: 0.333 Test Loss: 1.366 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.3723063468933105
Epoch: 9, Steps: 9 | Train Loss: 0.468 Vali Loss: 1.386 Vali Acc: 0.304 Test Loss: 1.386 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.60532283782959
Epoch: 10, Steps: 9 | Train Loss: 0.358 Vali Loss: 1.403 Vali Acc: 0.326 Test Loss: 1.403 Test Acc: 0.326
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.6527693271636963
Epoch: 11, Steps: 9 | Train Loss: 0.276 Vali Loss: 1.553 Vali Acc: 0.312 Test Loss: 1.553 Test Acc: 0.312
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.5379669666290283
Epoch: 12, Steps: 9 | Train Loss: 0.207 Vali Loss: 1.657 Vali Acc: 0.312 Test Loss: 1.657 Test Acc: 0.312
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.534666061401367
Epoch: 13, Steps: 9 | Train Loss: 0.148 Vali Loss: 1.670 Vali Acc: 0.333 Test Loss: 1.670 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.371886968612671
Epoch: 14, Steps: 9 | Train Loss: 0.117 Vali Loss: 1.742 Vali Acc: 0.362 Test Loss: 1.742 Test Acc: 0.362
Validation loss decreased (-0.347813 --> -0.362301).  Saving model ...
Epoch: 15 cost time: 3.7429230213165283
Epoch: 15, Steps: 9 | Train Loss: 0.089 Vali Loss: 1.698 Vali Acc: 0.362 Test Loss: 1.698 Test Acc: 0.362
Validation loss decreased (-0.362301 --> -0.362302).  Saving model ...
Epoch: 16 cost time: 3.34517765045166
Epoch: 16, Steps: 9 | Train Loss: 0.058 Vali Loss: 1.867 Vali Acc: 0.384 Test Loss: 1.867 Test Acc: 0.384
Validation loss decreased (-0.362302 --> -0.384039).  Saving model ...
Epoch: 17 cost time: 3.5114097595214844
Epoch: 17, Steps: 9 | Train Loss: 0.044 Vali Loss: 1.837 Vali Acc: 0.355 Test Loss: 1.837 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.8292970657348633
Epoch: 18, Steps: 9 | Train Loss: 0.035 Vali Loss: 1.742 Vali Acc: 0.377 Test Loss: 1.742 Test Acc: 0.377
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.433530807495117
Epoch: 19, Steps: 9 | Train Loss: 0.029 Vali Loss: 1.855 Vali Acc: 0.391 Test Loss: 1.855 Test Acc: 0.391
Validation loss decreased (-0.384039 --> -0.391286).  Saving model ...
Epoch: 20 cost time: 3.7014451026916504
Epoch: 20, Steps: 9 | Train Loss: 0.026 Vali Loss: 1.821 Vali Acc: 0.384 Test Loss: 1.821 Test Acc: 0.384
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.705730438232422
Epoch: 21, Steps: 9 | Train Loss: 0.019 Vali Loss: 1.760 Vali Acc: 0.406 Test Loss: 1.760 Test Acc: 0.406
Validation loss decreased (-0.391286 --> -0.405779).  Saving model ...
Epoch: 22 cost time: 3.4154787063598633
Epoch: 22, Steps: 9 | Train Loss: 0.017 Vali Loss: 1.846 Vali Acc: 0.399 Test Loss: 1.846 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.8557417392730713
Epoch: 23, Steps: 9 | Train Loss: 0.015 Vali Loss: 1.874 Vali Acc: 0.406 Test Loss: 1.874 Test Acc: 0.406
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.688812255859375
Epoch: 24, Steps: 9 | Train Loss: 0.013 Vali Loss: 1.952 Vali Acc: 0.384 Test Loss: 1.952 Test Acc: 0.384
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.4764292240142822
Epoch: 25, Steps: 9 | Train Loss: 0.013 Vali Loss: 1.787 Vali Acc: 0.413 Test Loss: 1.787 Test Acc: 0.413
Validation loss decreased (-0.405779 --> -0.413026).  Saving model ...
Epoch: 26 cost time: 3.0580058097839355
Epoch: 26, Steps: 9 | Train Loss: 0.010 Vali Loss: 1.779 Vali Acc: 0.391 Test Loss: 1.779 Test Acc: 0.391
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.247823715209961
Epoch: 27, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.788 Vali Acc: 0.406 Test Loss: 1.788 Test Acc: 0.406
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.822493314743042
Epoch: 28, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.781 Vali Acc: 0.399 Test Loss: 1.781 Test Acc: 0.399
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.7164700031280518
Epoch: 29, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.727 Vali Acc: 0.399 Test Loss: 1.727 Test Acc: 0.399
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.728599786758423
Epoch: 30, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.877 Vali Acc: 0.399 Test Loss: 1.877 Test Acc: 0.399
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.4387896060943604
Epoch: 31, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.854 Vali Acc: 0.406 Test Loss: 1.854 Test Acc: 0.406
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.4179623126983643
Epoch: 32, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.792 Vali Acc: 0.406 Test Loss: 1.792 Test Acc: 0.406
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.7060017585754395
Epoch: 33, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.761 Vali Acc: 0.406 Test Loss: 1.761 Test Acc: 0.406
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.848057985305786
Epoch: 34, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.730 Vali Acc: 0.399 Test Loss: 1.730 Test Acc: 0.399
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.633434772491455
Epoch: 35, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.776 Vali Acc: 0.406 Test Loss: 1.776 Test Acc: 0.406
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.41304347826086957
model parameter : 416900
model size : 4.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         103                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df256_ma103_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.880074501037598
Epoch: 1, Steps: 9 | Train Loss: 1.433 Vali Loss: 1.324 Vali Acc: 0.362 Test Loss: 1.324 Test Acc: 0.362
Validation loss decreased (inf --> -0.362306).  Saving model ...
Epoch: 2 cost time: 3.6188626289367676
Epoch: 2, Steps: 9 | Train Loss: 1.286 Vali Loss: 1.218 Vali Acc: 0.457 Test Loss: 1.218 Test Acc: 0.457
Validation loss decreased (-0.362306 --> -0.456510).  Saving model ...
Epoch: 3 cost time: 3.2876713275909424
Epoch: 3, Steps: 9 | Train Loss: 1.084 Vali Loss: 1.080 Vali Acc: 0.572 Test Loss: 1.080 Test Acc: 0.572
Validation loss decreased (-0.456510 --> -0.572453).  Saving model ...
Epoch: 4 cost time: 3.5436203479766846
Epoch: 4, Steps: 9 | Train Loss: 0.854 Vali Loss: 0.962 Vali Acc: 0.681 Test Loss: 0.962 Test Acc: 0.681
Validation loss decreased (-0.572453 --> -0.681150).  Saving model ...
Epoch: 5 cost time: 3.5844764709472656
Epoch: 5, Steps: 9 | Train Loss: 0.664 Vali Loss: 0.866 Vali Acc: 0.732 Test Loss: 0.866 Test Acc: 0.732
Validation loss decreased (-0.681150 --> -0.731875).  Saving model ...
Epoch: 6 cost time: 3.191739320755005
Epoch: 6, Steps: 9 | Train Loss: 0.465 Vali Loss: 0.775 Vali Acc: 0.754 Test Loss: 0.775 Test Acc: 0.754
Validation loss decreased (-0.731875 --> -0.753615).  Saving model ...
Epoch: 7 cost time: 3.484062671661377
Epoch: 7, Steps: 9 | Train Loss: 0.327 Vali Loss: 0.756 Vali Acc: 0.717 Test Loss: 0.756 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.307204484939575
Epoch: 8, Steps: 9 | Train Loss: 0.240 Vali Loss: 0.665 Vali Acc: 0.768 Test Loss: 0.665 Test Acc: 0.768
Validation loss decreased (-0.753615 --> -0.768109).  Saving model ...
Epoch: 9 cost time: 3.276458978652954
Epoch: 9, Steps: 9 | Train Loss: 0.147 Vali Loss: 0.627 Vali Acc: 0.761 Test Loss: 0.627 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.872838020324707
Epoch: 10, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.626 Vali Acc: 0.804 Test Loss: 0.626 Test Acc: 0.804
Validation loss decreased (-0.768109 --> -0.804342).  Saving model ...
Epoch: 11 cost time: 3.609389543533325
Epoch: 11, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.548 Vali Acc: 0.797 Test Loss: 0.548 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.592041015625
Epoch: 12, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.612 Vali Acc: 0.826 Test Loss: 0.612 Test Acc: 0.826
Validation loss decreased (-0.804342 --> -0.826081).  Saving model ...
Epoch: 13 cost time: 3.3781533241271973
Epoch: 13, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.518 Vali Acc: 0.790 Test Loss: 0.518 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.5804359912872314
Epoch: 14, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.523 Vali Acc: 0.812 Test Loss: 0.523 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.1312096118927
Epoch: 15, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.582 Vali Acc: 0.797 Test Loss: 0.582 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.5226335525512695
Epoch: 16, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.521 Vali Acc: 0.804 Test Loss: 0.521 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.393108367919922
Epoch: 17, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.528 Vali Acc: 0.797 Test Loss: 0.528 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.1785390377044678
Epoch: 18, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.547 Vali Acc: 0.812 Test Loss: 0.547 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.520564079284668
Epoch: 19, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.536 Vali Acc: 0.797 Test Loss: 0.536 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.1961357593536377
Epoch: 20, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.547 Vali Acc: 0.819 Test Loss: 0.547 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.652514696121216
Epoch: 21, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.547 Vali Acc: 0.826 Test Loss: 0.547 Test Acc: 0.826
Validation loss decreased (-0.826081 --> -0.826081).  Saving model ...
Epoch: 22 cost time: 3.571674108505249
Epoch: 22, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.546 Vali Acc: 0.812 Test Loss: 0.546 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.6615514755249023
Epoch: 23, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.534 Vali Acc: 0.812 Test Loss: 0.534 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.619765043258667
Epoch: 24, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.536 Vali Acc: 0.812 Test Loss: 0.536 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.4567172527313232
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.539 Vali Acc: 0.819 Test Loss: 0.539 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.6069443225860596
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.540 Vali Acc: 0.819 Test Loss: 0.540 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.4914140701293945
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.536 Vali Acc: 0.804 Test Loss: 0.536 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.923082113265991
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.544 Vali Acc: 0.819 Test Loss: 0.544 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.981492519378662
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.547 Vali Acc: 0.819 Test Loss: 0.547 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.9802918434143066
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.545 Vali Acc: 0.819 Test Loss: 0.545 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.7842178344726562
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.548 Vali Acc: 0.826 Test Loss: 0.548 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df256_ma103_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8260869565217391
model parameter : 318596
model size : 3.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         83                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df256_ma83_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.090717077255249
Epoch: 1, Steps: 9 | Train Loss: 1.442 Vali Loss: 1.314 Vali Acc: 0.370 Test Loss: 1.314 Test Acc: 0.370
Validation loss decreased (inf --> -0.369552).  Saving model ...
Epoch: 2 cost time: 3.061129331588745
Epoch: 2, Steps: 9 | Train Loss: 1.280 Vali Loss: 1.210 Vali Acc: 0.486 Test Loss: 1.210 Test Acc: 0.486
Validation loss decreased (-0.369552 --> -0.485495).  Saving model ...
Epoch: 3 cost time: 3.477513313293457
Epoch: 3, Steps: 9 | Train Loss: 1.082 Vali Loss: 1.072 Vali Acc: 0.587 Test Loss: 1.072 Test Acc: 0.587
Validation loss decreased (-0.485495 --> -0.586946).  Saving model ...
Epoch: 4 cost time: 3.7637791633605957
Epoch: 4, Steps: 9 | Train Loss: 0.857 Vali Loss: 0.956 Vali Acc: 0.696 Test Loss: 0.956 Test Acc: 0.696
Validation loss decreased (-0.586946 --> -0.695643).  Saving model ...
Epoch: 5 cost time: 3.5665669441223145
Epoch: 5, Steps: 9 | Train Loss: 0.666 Vali Loss: 0.859 Vali Acc: 0.732 Test Loss: 0.859 Test Acc: 0.732
Validation loss decreased (-0.695643 --> -0.731875).  Saving model ...
Epoch: 6 cost time: 3.8117318153381348
Epoch: 6, Steps: 9 | Train Loss: 0.475 Vali Loss: 0.763 Vali Acc: 0.746 Test Loss: 0.763 Test Acc: 0.746
Validation loss decreased (-0.731875 --> -0.746369).  Saving model ...
Epoch: 7 cost time: 3.4035918712615967
Epoch: 7, Steps: 9 | Train Loss: 0.325 Vali Loss: 0.742 Vali Acc: 0.746 Test Loss: 0.742 Test Acc: 0.746
Validation loss decreased (-0.746369 --> -0.746369).  Saving model ...
Epoch: 8 cost time: 3.511270046234131
Epoch: 8, Steps: 9 | Train Loss: 0.245 Vali Loss: 0.660 Vali Acc: 0.790 Test Loss: 0.660 Test Acc: 0.790
Validation loss decreased (-0.746369 --> -0.789848).  Saving model ...
Epoch: 9 cost time: 3.706205368041992
Epoch: 9, Steps: 9 | Train Loss: 0.152 Vali Loss: 0.611 Vali Acc: 0.797 Test Loss: 0.611 Test Acc: 0.797
Validation loss decreased (-0.789848 --> -0.797095).  Saving model ...
Epoch: 10 cost time: 3.462904930114746
Epoch: 10, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.597 Vali Acc: 0.797 Test Loss: 0.597 Test Acc: 0.797
Validation loss decreased (-0.797095 --> -0.797095).  Saving model ...
Epoch: 11 cost time: 3.409269332885742
Epoch: 11, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.526 Vali Acc: 0.790 Test Loss: 0.526 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.224860429763794
Epoch: 12, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.601 Vali Acc: 0.812 Test Loss: 0.601 Test Acc: 0.812
Validation loss decreased (-0.797095 --> -0.811588).  Saving model ...
Epoch: 13 cost time: 3.360231637954712
Epoch: 13, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.490 Vali Acc: 0.841 Test Loss: 0.490 Test Acc: 0.841
Validation loss decreased (-0.811588 --> -0.840575).  Saving model ...
Epoch: 14 cost time: 3.1837515830993652
Epoch: 14, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.494 Vali Acc: 0.833 Test Loss: 0.494 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.373110771179199
Epoch: 15, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.559 Vali Acc: 0.812 Test Loss: 0.559 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.2740299701690674
Epoch: 16, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.494 Vali Acc: 0.833 Test Loss: 0.494 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.2597506046295166
Epoch: 17, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.500 Vali Acc: 0.841 Test Loss: 0.500 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.588225841522217
Epoch: 18, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.522 Vali Acc: 0.841 Test Loss: 0.522 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.6252403259277344
Epoch: 19, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.509 Vali Acc: 0.826 Test Loss: 0.509 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.633805990219116
Epoch: 20, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.518 Vali Acc: 0.848 Test Loss: 0.518 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 21 cost time: 3.629807233810425
Epoch: 21, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.522 Vali Acc: 0.848 Test Loss: 0.522 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.841688394546509
Epoch: 22, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.525 Vali Acc: 0.848 Test Loss: 0.525 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.7164995670318604
Epoch: 23, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.504 Vali Acc: 0.841 Test Loss: 0.504 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.859624147415161
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.503 Vali Acc: 0.841 Test Loss: 0.503 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.2809512615203857
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.498 Vali Acc: 0.841 Test Loss: 0.498 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.488490581512451
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.506 Vali Acc: 0.841 Test Loss: 0.506 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.444129467010498
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.501 Vali Acc: 0.848 Test Loss: 0.501 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 28 cost time: 3.3446526527404785
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.511 Vali Acc: 0.841 Test Loss: 0.511 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.4902141094207764
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.516 Vali Acc: 0.855 Test Loss: 0.516 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855067).  Saving model ...
Epoch: 30 cost time: 3.517904043197632
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.511 Vali Acc: 0.841 Test Loss: 0.511 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.6438326835632324
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.513 Vali Acc: 0.841 Test Loss: 0.513 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.566446542739868
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.516 Vali Acc: 0.855 Test Loss: 0.516 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 33 cost time: 3.554994583129883
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.519 Vali Acc: 0.848 Test Loss: 0.519 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.621968984603882
Epoch: 34, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.516 Vali Acc: 0.855 Test Loss: 0.516 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.748126268386841
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.496 Vali Acc: 0.848 Test Loss: 0.496 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.4372260570526123
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.502 Vali Acc: 0.841 Test Loss: 0.502 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.5480010509490967
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.504 Vali Acc: 0.848 Test Loss: 0.504 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.799142360687256
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.525 Vali Acc: 0.855 Test Loss: 0.525 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.65281081199646
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.526 Vali Acc: 0.862 Test Loss: 0.526 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862314).  Saving model ...
Epoch: 40 cost time: 3.4388351440429688
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.518 Vali Acc: 0.855 Test Loss: 0.518 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.411198854446411
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.519 Vali Acc: 0.855 Test Loss: 0.519 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.3104257583618164
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.515 Vali Acc: 0.848 Test Loss: 0.515 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.616262435913086
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.512 Vali Acc: 0.848 Test Loss: 0.512 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.8615047931671143
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.511 Vali Acc: 0.848 Test Loss: 0.511 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 3.7790873050689697
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.512 Vali Acc: 0.848 Test Loss: 0.512 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 3.401482343673706
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.519 Vali Acc: 0.855 Test Loss: 0.519 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 3.482584238052368
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.525 Vali Acc: 0.862 Test Loss: 0.525 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 48 cost time: 3.7471585273742676
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.524 Vali Acc: 0.855 Test Loss: 0.524 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.6693050861358643
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.525 Vali Acc: 0.862 Test Loss: 0.525 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 50 cost time: 3.67329740524292
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.525 Vali Acc: 0.862 Test Loss: 0.525 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 3.597252130508423
Epoch: 51, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.528 Vali Acc: 0.862 Test Loss: 0.528 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 3.9056615829467773
Epoch: 52, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.528 Vali Acc: 0.855 Test Loss: 0.528 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 3.7156050205230713
Epoch: 53, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.521 Vali Acc: 0.855 Test Loss: 0.521 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 3.5531508922576904
Epoch: 54, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.522 Vali Acc: 0.855 Test Loss: 0.522 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 3.5933666229248047
Epoch: 55, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.519 Vali Acc: 0.855 Test Loss: 0.519 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 3.6766357421875
Epoch: 56, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.516 Vali Acc: 0.855 Test Loss: 0.516 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 3.7308809757232666
Epoch: 57, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.515 Vali Acc: 0.855 Test Loss: 0.515 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 3.548051357269287
Epoch: 58, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.517 Vali Acc: 0.855 Test Loss: 0.517 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 3.560756206512451
Epoch: 59, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.528 Vali Acc: 0.855 Test Loss: 0.528 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df256_ma83_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 318596
model size : 3.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         62                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df256_ma62_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.5664122104644775
Epoch: 1, Steps: 9 | Train Loss: 1.443 Vali Loss: 1.320 Vali Acc: 0.355 Test Loss: 1.320 Test Acc: 0.355
Validation loss decreased (inf --> -0.355059).  Saving model ...
Epoch: 2 cost time: 3.960632562637329
Epoch: 2, Steps: 9 | Train Loss: 1.283 Vali Loss: 1.218 Vali Acc: 0.464 Test Loss: 1.218 Test Acc: 0.464
Validation loss decreased (-0.355059 --> -0.463756).  Saving model ...
Epoch: 3 cost time: 4.130872488021851
Epoch: 3, Steps: 9 | Train Loss: 1.089 Vali Loss: 1.080 Vali Acc: 0.580 Test Loss: 1.080 Test Acc: 0.580
Validation loss decreased (-0.463756 --> -0.579699).  Saving model ...
Epoch: 4 cost time: 3.844489097595215
Epoch: 4, Steps: 9 | Train Loss: 0.856 Vali Loss: 0.961 Vali Acc: 0.674 Test Loss: 0.961 Test Acc: 0.674
Validation loss decreased (-0.579699 --> -0.673903).  Saving model ...
Epoch: 5 cost time: 3.7530517578125
Epoch: 5, Steps: 9 | Train Loss: 0.666 Vali Loss: 0.868 Vali Acc: 0.739 Test Loss: 0.868 Test Acc: 0.739
Validation loss decreased (-0.673903 --> -0.739122).  Saving model ...
Epoch: 6 cost time: 3.514233112335205
Epoch: 6, Steps: 9 | Train Loss: 0.470 Vali Loss: 0.768 Vali Acc: 0.768 Test Loss: 0.768 Test Acc: 0.768
Validation loss decreased (-0.739122 --> -0.768108).  Saving model ...
Epoch: 7 cost time: 3.4793145656585693
Epoch: 7, Steps: 9 | Train Loss: 0.311 Vali Loss: 0.740 Vali Acc: 0.754 Test Loss: 0.740 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.893202781677246
Epoch: 8, Steps: 9 | Train Loss: 0.234 Vali Loss: 0.652 Vali Acc: 0.812 Test Loss: 0.652 Test Acc: 0.812
Validation loss decreased (-0.768108 --> -0.811588).  Saving model ...
Epoch: 9 cost time: 3.396636962890625
Epoch: 9, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.596 Vali Acc: 0.826 Test Loss: 0.596 Test Acc: 0.826
Validation loss decreased (-0.811588 --> -0.826081).  Saving model ...
Epoch: 10 cost time: 3.5198121070861816
Epoch: 10, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.586 Vali Acc: 0.833 Test Loss: 0.586 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833327).  Saving model ...
Epoch: 11 cost time: 3.5286271572113037
Epoch: 11, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.512 Vali Acc: 0.848 Test Loss: 0.512 Test Acc: 0.848
Validation loss decreased (-0.833327 --> -0.847821).  Saving model ...
Epoch: 12 cost time: 3.9088022708892822
Epoch: 12, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.570 Vali Acc: 0.862 Test Loss: 0.570 Test Acc: 0.862
Validation loss decreased (-0.847821 --> -0.862313).  Saving model ...
Epoch: 13 cost time: 3.7303526401519775
Epoch: 13, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.478 Vali Acc: 0.877 Test Loss: 0.478 Test Acc: 0.877
Validation loss decreased (-0.862313 --> -0.876807).  Saving model ...
Epoch: 14 cost time: 4.022429704666138
Epoch: 14, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.465 Vali Acc: 0.855 Test Loss: 0.465 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.810866594314575
Epoch: 15, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.524 Vali Acc: 0.870 Test Loss: 0.524 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.802119016647339
Epoch: 16, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.471 Vali Acc: 0.870 Test Loss: 0.471 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.2658278942108154
Epoch: 17, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.473 Vali Acc: 0.891 Test Loss: 0.473 Test Acc: 0.891
Validation loss decreased (-0.876807 --> -0.891300).  Saving model ...
Epoch: 18 cost time: 3.657447338104248
Epoch: 18, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.488 Vali Acc: 0.891 Test Loss: 0.488 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.2560319900512695
Epoch: 19, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.476 Vali Acc: 0.884 Test Loss: 0.476 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.5071592330932617
Epoch: 20, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.478 Vali Acc: 0.877 Test Loss: 0.478 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.462031364440918
Epoch: 21, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.481 Vali Acc: 0.891 Test Loss: 0.481 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.295138359069824
Epoch: 22, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.482 Vali Acc: 0.884 Test Loss: 0.482 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.294752359390259
Epoch: 23, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.469 Vali Acc: 0.891 Test Loss: 0.469 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 24 cost time: 3.201555013656616
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.467 Vali Acc: 0.899 Test Loss: 0.467 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898546).  Saving model ...
Epoch: 25 cost time: 3.392895221710205
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.466 Vali Acc: 0.899 Test Loss: 0.466 Test Acc: 0.899
Validation loss decreased (-0.898546 --> -0.898546).  Saving model ...
Epoch: 26 cost time: 3.231241226196289
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.471 Vali Acc: 0.891 Test Loss: 0.471 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.432377338409424
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.464 Vali Acc: 0.891 Test Loss: 0.464 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.5065014362335205
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.470 Vali Acc: 0.899 Test Loss: 0.470 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.3306005001068115
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.474 Vali Acc: 0.891 Test Loss: 0.474 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.475487232208252
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.473 Vali Acc: 0.891 Test Loss: 0.473 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.41056752204895
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.473 Vali Acc: 0.891 Test Loss: 0.473 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.1142561435699463
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.473 Vali Acc: 0.891 Test Loss: 0.473 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.1732609272003174
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.472 Vali Acc: 0.891 Test Loss: 0.472 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.166161298751831
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.472 Vali Acc: 0.891 Test Loss: 0.472 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.258730173110962
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.462 Vali Acc: 0.891 Test Loss: 0.462 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df256_ma62_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 318596
model size : 3.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         42                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df256_ma42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.766567707061768
Epoch: 1, Steps: 9 | Train Loss: 1.408 Vali Loss: 1.305 Vali Acc: 0.362 Test Loss: 1.305 Test Acc: 0.362
Validation loss decreased (inf --> -0.362306).  Saving model ...
Epoch: 2 cost time: 3.403735876083374
Epoch: 2, Steps: 9 | Train Loss: 1.262 Vali Loss: 1.186 Vali Acc: 0.486 Test Loss: 1.186 Test Acc: 0.486
Validation loss decreased (-0.362306 --> -0.485495).  Saving model ...
Epoch: 3 cost time: 3.272024393081665
Epoch: 3, Steps: 9 | Train Loss: 1.057 Vali Loss: 1.039 Vali Acc: 0.623 Test Loss: 1.039 Test Acc: 0.623
Validation loss decreased (-0.485495 --> -0.623178).  Saving model ...
Epoch: 4 cost time: 3.15413498878479
Epoch: 4, Steps: 9 | Train Loss: 0.826 Vali Loss: 0.916 Vali Acc: 0.688 Test Loss: 0.916 Test Acc: 0.688
Validation loss decreased (-0.623178 --> -0.688397).  Saving model ...
Epoch: 5 cost time: 3.462719202041626
Epoch: 5, Steps: 9 | Train Loss: 0.635 Vali Loss: 0.823 Vali Acc: 0.739 Test Loss: 0.823 Test Acc: 0.739
Validation loss decreased (-0.688397 --> -0.739122).  Saving model ...
Epoch: 6 cost time: 3.3929548263549805
Epoch: 6, Steps: 9 | Train Loss: 0.445 Vali Loss: 0.729 Vali Acc: 0.768 Test Loss: 0.729 Test Acc: 0.768
Validation loss decreased (-0.739122 --> -0.768109).  Saving model ...
Epoch: 7 cost time: 3.373163938522339
Epoch: 7, Steps: 9 | Train Loss: 0.298 Vali Loss: 0.711 Vali Acc: 0.790 Test Loss: 0.711 Test Acc: 0.790
Validation loss decreased (-0.768109 --> -0.789848).  Saving model ...
Epoch: 8 cost time: 3.4096107482910156
Epoch: 8, Steps: 9 | Train Loss: 0.227 Vali Loss: 0.628 Vali Acc: 0.790 Test Loss: 0.628 Test Acc: 0.790
Validation loss decreased (-0.789848 --> -0.789849).  Saving model ...
Epoch: 9 cost time: 3.386842727661133
Epoch: 9, Steps: 9 | Train Loss: 0.137 Vali Loss: 0.550 Vali Acc: 0.812 Test Loss: 0.550 Test Acc: 0.812
Validation loss decreased (-0.789849 --> -0.811589).  Saving model ...
Epoch: 10 cost time: 3.207516670227051
Epoch: 10, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.591 Vali Acc: 0.812 Test Loss: 0.591 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.138303279876709
Epoch: 11, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.476 Vali Acc: 0.841 Test Loss: 0.476 Test Acc: 0.841
Validation loss decreased (-0.811589 --> -0.840575).  Saving model ...
Epoch: 12 cost time: 3.1237001419067383
Epoch: 12, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.533 Vali Acc: 0.819 Test Loss: 0.533 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.1062443256378174
Epoch: 13, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.451 Vali Acc: 0.870 Test Loss: 0.451 Test Acc: 0.870
Validation loss decreased (-0.840575 --> -0.869561).  Saving model ...
Epoch: 14 cost time: 3.0543642044067383
Epoch: 14, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.434 Vali Acc: 0.848 Test Loss: 0.434 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.221060276031494
Epoch: 15, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.495 Vali Acc: 0.833 Test Loss: 0.495 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.4949963092803955
Epoch: 16, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.435 Vali Acc: 0.870 Test Loss: 0.435 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 17 cost time: 3.6549501419067383
Epoch: 17, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.435 Vali Acc: 0.862 Test Loss: 0.435 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.632392168045044
Epoch: 18, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.457 Vali Acc: 0.870 Test Loss: 0.457 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.736896514892578
Epoch: 19, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.424 Vali Acc: 0.870 Test Loss: 0.424 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 20 cost time: 3.516120672225952
Epoch: 20, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.423 Vali Acc: 0.862 Test Loss: 0.423 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.6245553493499756
Epoch: 21, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.439 Vali Acc: 0.862 Test Loss: 0.439 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.3394992351531982
Epoch: 22, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.448 Vali Acc: 0.862 Test Loss: 0.448 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.1291563510894775
Epoch: 23, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.430 Vali Acc: 0.877 Test Loss: 0.430 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 24 cost time: 3.1141510009765625
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.423 Vali Acc: 0.862 Test Loss: 0.423 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.172677516937256
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.427 Vali Acc: 0.870 Test Loss: 0.427 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.217538833618164
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.422 Vali Acc: 0.862 Test Loss: 0.422 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.2105348110198975
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.417 Vali Acc: 0.862 Test Loss: 0.417 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.2414894104003906
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.434 Vali Acc: 0.877 Test Loss: 0.434 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.2518973350524902
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.432 Vali Acc: 0.870 Test Loss: 0.432 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.2504312992095947
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.430 Vali Acc: 0.870 Test Loss: 0.430 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 3.419628381729126
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.436 Vali Acc: 0.877 Test Loss: 0.436 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.394191026687622
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.427 Vali Acc: 0.862 Test Loss: 0.427 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.2808375358581543
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.421 Vali Acc: 0.862 Test Loss: 0.421 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df256_ma42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 318596
model size : 3.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df256_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.066957235336304
Epoch: 1, Steps: 9 | Train Loss: 1.446 Vali Loss: 1.308 Vali Acc: 0.384 Test Loss: 1.308 Test Acc: 0.384
Validation loss decreased (inf --> -0.384045).  Saving model ...
Epoch: 2 cost time: 3.260101795196533
Epoch: 2, Steps: 9 | Train Loss: 1.273 Vali Loss: 1.198 Vali Acc: 0.478 Test Loss: 1.198 Test Acc: 0.478
Validation loss decreased (-0.384045 --> -0.478249).  Saving model ...
Epoch: 3 cost time: 3.242084503173828
Epoch: 3, Steps: 9 | Train Loss: 1.084 Vali Loss: 1.054 Vali Acc: 0.623 Test Loss: 1.054 Test Acc: 0.623
Validation loss decreased (-0.478249 --> -0.623178).  Saving model ...
Epoch: 4 cost time: 3.077389717102051
Epoch: 4, Steps: 9 | Train Loss: 0.843 Vali Loss: 0.933 Vali Acc: 0.717 Test Loss: 0.933 Test Acc: 0.717
Validation loss decreased (-0.623178 --> -0.717382).  Saving model ...
Epoch: 5 cost time: 3.0602385997772217
Epoch: 5, Steps: 9 | Train Loss: 0.656 Vali Loss: 0.823 Vali Acc: 0.732 Test Loss: 0.823 Test Acc: 0.732
Validation loss decreased (-0.717382 --> -0.731876).  Saving model ...
Epoch: 6 cost time: 2.9692399501800537
Epoch: 6, Steps: 9 | Train Loss: 0.469 Vali Loss: 0.719 Vali Acc: 0.790 Test Loss: 0.719 Test Acc: 0.790
Validation loss decreased (-0.731876 --> -0.789848).  Saving model ...
Epoch: 7 cost time: 3.171480417251587
Epoch: 7, Steps: 9 | Train Loss: 0.327 Vali Loss: 0.662 Vali Acc: 0.797 Test Loss: 0.662 Test Acc: 0.797
Validation loss decreased (-0.789848 --> -0.797095).  Saving model ...
Epoch: 8 cost time: 3.315548896789551
Epoch: 8, Steps: 9 | Train Loss: 0.236 Vali Loss: 0.585 Vali Acc: 0.841 Test Loss: 0.585 Test Acc: 0.841
Validation loss decreased (-0.797095 --> -0.840574).  Saving model ...
Epoch: 9 cost time: 3.1921474933624268
Epoch: 9, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.513 Vali Acc: 0.848 Test Loss: 0.513 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847821).  Saving model ...
Epoch: 10 cost time: 3.270174264907837
Epoch: 10, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.476 Vali Acc: 0.870 Test Loss: 0.476 Test Acc: 0.870
Validation loss decreased (-0.847821 --> -0.869560).  Saving model ...
Epoch: 11 cost time: 3.267850399017334
Epoch: 11, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.417 Vali Acc: 0.877 Test Loss: 0.417 Test Acc: 0.877
Validation loss decreased (-0.869560 --> -0.876807).  Saving model ...
Epoch: 12 cost time: 3.246995687484741
Epoch: 12, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.415 Vali Acc: 0.877 Test Loss: 0.415 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 13 cost time: 3.3905489444732666
Epoch: 13, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.377 Vali Acc: 0.899 Test Loss: 0.377 Test Acc: 0.899
Validation loss decreased (-0.876807 --> -0.898547).  Saving model ...
Epoch: 14 cost time: 3.358531951904297
Epoch: 14, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.349 Vali Acc: 0.906 Test Loss: 0.349 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 15 cost time: 3.1353585720062256
Epoch: 15, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.366 Vali Acc: 0.891 Test Loss: 0.366 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.1654233932495117
Epoch: 16, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.349 Vali Acc: 0.906 Test Loss: 0.349 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 17 cost time: 3.4231491088867188
Epoch: 17, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.343 Vali Acc: 0.906 Test Loss: 0.343 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 18 cost time: 3.2319276332855225
Epoch: 18, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.337 Vali Acc: 0.906 Test Loss: 0.337 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 19 cost time: 2.94820499420166
Epoch: 19, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.324 Vali Acc: 0.899 Test Loss: 0.324 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.093231439590454
Epoch: 20, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.331 Vali Acc: 0.906 Test Loss: 0.331 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 21 cost time: 3.060868978500366
Epoch: 21, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.334 Vali Acc: 0.906 Test Loss: 0.334 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.137498140335083
Epoch: 22, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.333 Vali Acc: 0.906 Test Loss: 0.333 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.264601707458496
Epoch: 23, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.326 Vali Acc: 0.906 Test Loss: 0.326 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 24 cost time: 3.2671239376068115
Epoch: 24, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.322 Vali Acc: 0.906 Test Loss: 0.322 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 25 cost time: 3.1473584175109863
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.319 Vali Acc: 0.906 Test Loss: 0.319 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 26 cost time: 3.287266731262207
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.321 Vali Acc: 0.906 Test Loss: 0.321 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.2567927837371826
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.321 Vali Acc: 0.906 Test Loss: 0.321 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.1482045650482178
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.320 Vali Acc: 0.906 Test Loss: 0.320 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.1658525466918945
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.315 Vali Acc: 0.906 Test Loss: 0.315 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 30 cost time: 3.2086024284362793
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.311 Vali Acc: 0.906 Test Loss: 0.311 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 31 cost time: 3.1205224990844727
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.312 Vali Acc: 0.906 Test Loss: 0.312 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.3723435401916504
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.308 Vali Acc: 0.906 Test Loss: 0.308 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 33 cost time: 3.9859211444854736
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.314 Vali Acc: 0.906 Test Loss: 0.314 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.612891912460327
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.313 Vali Acc: 0.906 Test Loss: 0.313 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.8940839767456055
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.299 Vali Acc: 0.906 Test Loss: 0.299 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 36 cost time: 3.700547456741333
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.301 Vali Acc: 0.906 Test Loss: 0.301 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.706380844116211
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.300 Vali Acc: 0.906 Test Loss: 0.300 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.604612350463867
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.308 Vali Acc: 0.906 Test Loss: 0.308 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.410419225692749
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.312 Vali Acc: 0.906 Test Loss: 0.312 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.6057071685791016
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.306 Vali Acc: 0.906 Test Loss: 0.306 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 3.506270170211792
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.304 Vali Acc: 0.906 Test Loss: 0.304 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 3.5344080924987793
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.303 Vali Acc: 0.906 Test Loss: 0.303 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 3.421383857727051
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.299 Vali Acc: 0.906 Test Loss: 0.299 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 44 cost time: 3.6349449157714844
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.298 Vali Acc: 0.906 Test Loss: 0.298 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 45 cost time: 3.5861170291900635
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.301 Vali Acc: 0.906 Test Loss: 0.301 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.960050582885742
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.305 Vali Acc: 0.906 Test Loss: 0.305 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.6909286975860596
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.307 Vali Acc: 0.906 Test Loss: 0.307 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.8728349208831787
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.303 Vali Acc: 0.906 Test Loss: 0.303 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 3.51985502243042
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.304 Vali Acc: 0.906 Test Loss: 0.304 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 3.486156463623047
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.305 Vali Acc: 0.906 Test Loss: 0.305 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 3.5778887271881104
Epoch: 51, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.309 Vali Acc: 0.906 Test Loss: 0.309 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 3.344229221343994
Epoch: 52, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.308 Vali Acc: 0.906 Test Loss: 0.308 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 3.3933894634246826
Epoch: 53, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.301 Vali Acc: 0.906 Test Loss: 0.301 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 3.4378011226654053
Epoch: 54, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.301 Vali Acc: 0.906 Test Loss: 0.301 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df256_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 318596
model size : 3.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df256_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.776876449584961
Epoch: 1, Steps: 9 | Train Loss: 1.435 Vali Loss: 1.332 Vali Acc: 0.341 Test Loss: 1.332 Test Acc: 0.341
Validation loss decreased (inf --> -0.340566).  Saving model ...
Epoch: 2 cost time: 3.6431028842926025
Epoch: 2, Steps: 9 | Train Loss: 1.307 Vali Loss: 1.220 Vali Acc: 0.486 Test Loss: 1.220 Test Acc: 0.486
Validation loss decreased (-0.340566 --> -0.485495).  Saving model ...
Epoch: 3 cost time: 3.5109708309173584
Epoch: 3, Steps: 9 | Train Loss: 1.117 Vali Loss: 1.078 Vali Acc: 0.616 Test Loss: 1.078 Test Acc: 0.616
Validation loss decreased (-0.485495 --> -0.615931).  Saving model ...
Epoch: 4 cost time: 3.485605001449585
Epoch: 4, Steps: 9 | Train Loss: 0.894 Vali Loss: 0.954 Vali Acc: 0.703 Test Loss: 0.954 Test Acc: 0.703
Validation loss decreased (-0.615931 --> -0.702889).  Saving model ...
Epoch: 5 cost time: 3.6611671447753906
Epoch: 5, Steps: 9 | Train Loss: 0.700 Vali Loss: 0.831 Vali Acc: 0.739 Test Loss: 0.831 Test Acc: 0.739
Validation loss decreased (-0.702889 --> -0.739122).  Saving model ...
Epoch: 6 cost time: 3.850412607192993
Epoch: 6, Steps: 9 | Train Loss: 0.511 Vali Loss: 0.750 Vali Acc: 0.732 Test Loss: 0.750 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.67600679397583
Epoch: 7, Steps: 9 | Train Loss: 0.374 Vali Loss: 0.721 Vali Acc: 0.725 Test Loss: 0.721 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.687331199645996
Epoch: 8, Steps: 9 | Train Loss: 0.283 Vali Loss: 0.618 Vali Acc: 0.761 Test Loss: 0.618 Test Acc: 0.761
Validation loss decreased (-0.739122 --> -0.760863).  Saving model ...
Epoch: 9 cost time: 3.5374481678009033
Epoch: 9, Steps: 9 | Train Loss: 0.180 Vali Loss: 0.587 Vali Acc: 0.739 Test Loss: 0.587 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.50484299659729
Epoch: 10, Steps: 9 | Train Loss: 0.125 Vali Loss: 0.556 Vali Acc: 0.783 Test Loss: 0.556 Test Acc: 0.783
Validation loss decreased (-0.760863 --> -0.782603).  Saving model ...
Epoch: 11 cost time: 3.585610866546631
Epoch: 11, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.534 Vali Acc: 0.775 Test Loss: 0.534 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.885179281234741
Epoch: 12, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.521 Vali Acc: 0.783 Test Loss: 0.521 Test Acc: 0.783
Validation loss decreased (-0.782603 --> -0.782603).  Saving model ...
Epoch: 13 cost time: 3.5020031929016113
Epoch: 13, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.458 Vali Acc: 0.804 Test Loss: 0.458 Test Acc: 0.804
Validation loss decreased (-0.782603 --> -0.804343).  Saving model ...
Epoch: 14 cost time: 3.3685190677642822
Epoch: 14, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.474 Vali Acc: 0.804 Test Loss: 0.474 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.871831178665161
Epoch: 15, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.480 Vali Acc: 0.804 Test Loss: 0.480 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.485874652862549
Epoch: 16, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.449 Vali Acc: 0.826 Test Loss: 0.449 Test Acc: 0.826
Validation loss decreased (-0.804343 --> -0.826082).  Saving model ...
Epoch: 17 cost time: 3.7032344341278076
Epoch: 17, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.454 Vali Acc: 0.819 Test Loss: 0.454 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.8889708518981934
Epoch: 18, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.462 Vali Acc: 0.819 Test Loss: 0.462 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.8302950859069824
Epoch: 19, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.465 Vali Acc: 0.819 Test Loss: 0.465 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.091782808303833
Epoch: 20, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.449 Vali Acc: 0.819 Test Loss: 0.449 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.6487128734588623
Epoch: 21, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.446 Vali Acc: 0.804 Test Loss: 0.446 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.6587400436401367
Epoch: 22, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.457 Vali Acc: 0.819 Test Loss: 0.457 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.7141919136047363
Epoch: 23, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.451 Vali Acc: 0.833 Test Loss: 0.451 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833329).  Saving model ...
Epoch: 24 cost time: 3.7512240409851074
Epoch: 24, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.435 Vali Acc: 0.826 Test Loss: 0.435 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.890768051147461
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.436 Vali Acc: 0.826 Test Loss: 0.436 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.725883960723877
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.446 Vali Acc: 0.841 Test Loss: 0.446 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 27 cost time: 3.615283966064453
Epoch: 27, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.437 Vali Acc: 0.833 Test Loss: 0.437 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.7938120365142822
Epoch: 28, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.431 Vali Acc: 0.848 Test Loss: 0.431 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 29 cost time: 3.813917398452759
Epoch: 29, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.433 Vali Acc: 0.848 Test Loss: 0.433 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.7133538722991943
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.443 Vali Acc: 0.848 Test Loss: 0.443 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.7081379890441895
Epoch: 31, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.447 Vali Acc: 0.848 Test Loss: 0.447 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.7532856464385986
Epoch: 32, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.439 Vali Acc: 0.855 Test Loss: 0.439 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 33 cost time: 3.9853289127349854
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.431 Vali Acc: 0.855 Test Loss: 0.431 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 34 cost time: 3.3633995056152344
Epoch: 34, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.427 Vali Acc: 0.848 Test Loss: 0.427 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.6405417919158936
Epoch: 35, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.424 Vali Acc: 0.855 Test Loss: 0.424 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 36 cost time: 3.714252471923828
Epoch: 36, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.434 Vali Acc: 0.848 Test Loss: 0.434 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.7077245712280273
Epoch: 37, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.432 Vali Acc: 0.855 Test Loss: 0.432 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.483261823654175
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.436 Vali Acc: 0.848 Test Loss: 0.436 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.3639512062072754
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.429 Vali Acc: 0.855 Test Loss: 0.429 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.442639112472534
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.426 Vali Acc: 0.855 Test Loss: 0.426 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 3.9126968383789062
Epoch: 41, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.432 Vali Acc: 0.848 Test Loss: 0.432 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 3.9074249267578125
Epoch: 42, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.440 Vali Acc: 0.841 Test Loss: 0.440 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 3.8454339504241943
Epoch: 43, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.435 Vali Acc: 0.855 Test Loss: 0.435 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 4.079695701599121
Epoch: 44, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.430 Vali Acc: 0.862 Test Loss: 0.430 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 45 cost time: 3.6892218589782715
Epoch: 45, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.433 Vali Acc: 0.855 Test Loss: 0.433 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.816645622253418
Epoch: 46, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.435 Vali Acc: 0.855 Test Loss: 0.435 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 4.008269786834717
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.426 Vali Acc: 0.855 Test Loss: 0.426 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.495105028152466
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.429 Vali Acc: 0.862 Test Loss: 0.429 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 49 cost time: 3.310919761657715
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.430 Vali Acc: 0.862 Test Loss: 0.430 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.8270373344421387
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.436 Vali Acc: 0.855 Test Loss: 0.436 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 3.8329951763153076
Epoch: 51, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.441 Vali Acc: 0.855 Test Loss: 0.441 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 3.4117817878723145
Epoch: 52, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.437 Vali Acc: 0.855 Test Loss: 0.437 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 3.811394453048706
Epoch: 53, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.436 Vali Acc: 0.862 Test Loss: 0.436 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 3.987679958343506
Epoch: 54, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.441 Vali Acc: 0.855 Test Loss: 0.441 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 3.8429858684539795
Epoch: 55, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.440 Vali Acc: 0.862 Test Loss: 0.440 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 3.842597723007202
Epoch: 56, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.434 Vali Acc: 0.870 Test Loss: 0.434 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 57 cost time: 3.896638870239258
Epoch: 57, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.433 Vali Acc: 0.870 Test Loss: 0.433 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 58 cost time: 3.77706241607666
Epoch: 58, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.433 Vali Acc: 0.870 Test Loss: 0.433 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 59 cost time: 3.4994680881500244
Epoch: 59, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.440 Vali Acc: 0.870 Test Loss: 0.440 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 3.983510971069336
Epoch: 60, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.440 Vali Acc: 0.870 Test Loss: 0.440 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 3.5895416736602783
Epoch: 61, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.441 Vali Acc: 0.870 Test Loss: 0.441 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 3.5729992389678955
Epoch: 62, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.436 Vali Acc: 0.870 Test Loss: 0.436 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 3.5702905654907227
Epoch: 63, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.433 Vali Acc: 0.870 Test Loss: 0.433 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 3.12819766998291
Epoch: 64, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.436 Vali Acc: 0.870 Test Loss: 0.436 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 3.6889312267303467
Epoch: 65, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.440 Vali Acc: 0.870 Test Loss: 0.440 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 3.361957311630249
Epoch: 66, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.442 Vali Acc: 0.870 Test Loss: 0.442 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 3.6499524116516113
Epoch: 67, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.441 Vali Acc: 0.870 Test Loss: 0.441 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 3.5536537170410156
Epoch: 68, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.445 Vali Acc: 0.870 Test Loss: 0.445 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df256_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 318596
model size : 3.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df256_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.848060369491577
Epoch: 1, Steps: 9 | Train Loss: 1.453 Vali Loss: 1.335 Vali Acc: 0.384 Test Loss: 1.335 Test Acc: 0.384
Validation loss decreased (inf --> -0.384045).  Saving model ...
Epoch: 2 cost time: 3.474979877471924
Epoch: 2, Steps: 9 | Train Loss: 1.311 Vali Loss: 1.225 Vali Acc: 0.507 Test Loss: 1.225 Test Acc: 0.507
Validation loss decreased (-0.384045 --> -0.507234).  Saving model ...
Epoch: 3 cost time: 3.466663360595703
Epoch: 3, Steps: 9 | Train Loss: 1.128 Vali Loss: 1.090 Vali Acc: 0.565 Test Loss: 1.090 Test Acc: 0.565
Validation loss decreased (-0.507234 --> -0.565206).  Saving model ...
Epoch: 4 cost time: 3.248403787612915
Epoch: 4, Steps: 9 | Train Loss: 0.856 Vali Loss: 0.985 Vali Acc: 0.652 Test Loss: 0.985 Test Acc: 0.652
Validation loss decreased (-0.565206 --> -0.652164).  Saving model ...
Epoch: 5 cost time: 3.236773729324341
Epoch: 5, Steps: 9 | Train Loss: 0.686 Vali Loss: 0.920 Vali Acc: 0.623 Test Loss: 0.920 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.290869951248169
Epoch: 6, Steps: 9 | Train Loss: 0.496 Vali Loss: 0.847 Vali Acc: 0.645 Test Loss: 0.847 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.231534004211426
Epoch: 7, Steps: 9 | Train Loss: 0.369 Vali Loss: 0.815 Vali Acc: 0.667 Test Loss: 0.815 Test Acc: 0.667
Validation loss decreased (-0.652164 --> -0.666659).  Saving model ...
Epoch: 8 cost time: 3.1976006031036377
Epoch: 8, Steps: 9 | Train Loss: 0.279 Vali Loss: 0.843 Vali Acc: 0.659 Test Loss: 0.843 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.302722930908203
Epoch: 9, Steps: 9 | Train Loss: 0.184 Vali Loss: 0.754 Vali Acc: 0.703 Test Loss: 0.754 Test Acc: 0.703
Validation loss decreased (-0.666659 --> -0.702891).  Saving model ...
Epoch: 10 cost time: 3.3405039310455322
Epoch: 10, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.767 Vali Acc: 0.703 Test Loss: 0.767 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.246487855911255
Epoch: 11, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.718 Vali Acc: 0.732 Test Loss: 0.718 Test Acc: 0.732
Validation loss decreased (-0.702891 --> -0.731877).  Saving model ...
Epoch: 12 cost time: 3.321385622024536
Epoch: 12, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.717 Vali Acc: 0.710 Test Loss: 0.717 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.469897747039795
Epoch: 13, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.719 Vali Acc: 0.725 Test Loss: 0.719 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.4751815795898438
Epoch: 14, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.681 Vali Acc: 0.732 Test Loss: 0.681 Test Acc: 0.732
Validation loss decreased (-0.731877 --> -0.731877).  Saving model ...
Epoch: 15 cost time: 3.527111291885376
Epoch: 15, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.690 Vali Acc: 0.754 Test Loss: 0.690 Test Acc: 0.754
Validation loss decreased (-0.731877 --> -0.753616).  Saving model ...
Epoch: 16 cost time: 3.3512136936187744
Epoch: 16, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.715 Vali Acc: 0.739 Test Loss: 0.715 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.5844225883483887
Epoch: 17, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.713 Vali Acc: 0.739 Test Loss: 0.713 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.347616195678711
Epoch: 18, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.698 Vali Acc: 0.746 Test Loss: 0.698 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.385721445083618
Epoch: 19, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.687 Vali Acc: 0.739 Test Loss: 0.687 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.235891819000244
Epoch: 20, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.723 Vali Acc: 0.739 Test Loss: 0.723 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.1332082748413086
Epoch: 21, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.722 Vali Acc: 0.754 Test Loss: 0.722 Test Acc: 0.754
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.4113688468933105
Epoch: 22, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.718 Vali Acc: 0.761 Test Loss: 0.718 Test Acc: 0.761
Validation loss decreased (-0.753616 --> -0.760862).  Saving model ...
Epoch: 23 cost time: 3.6019296646118164
Epoch: 23, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.725 Vali Acc: 0.761 Test Loss: 0.725 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.2564101219177246
Epoch: 24, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.724 Vali Acc: 0.768 Test Loss: 0.724 Test Acc: 0.768
Validation loss decreased (-0.760862 --> -0.768109).  Saving model ...
Epoch: 25 cost time: 3.3314552307128906
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.708 Vali Acc: 0.754 Test Loss: 0.708 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.4803407192230225
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.703 Vali Acc: 0.746 Test Loss: 0.703 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.757242441177368
Epoch: 27, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.704 Vali Acc: 0.768 Test Loss: 0.704 Test Acc: 0.768
Validation loss decreased (-0.768109 --> -0.768109).  Saving model ...
Epoch: 28 cost time: 3.571082592010498
Epoch: 28, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.714 Vali Acc: 0.761 Test Loss: 0.714 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.3826494216918945
Epoch: 29, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.714 Vali Acc: 0.761 Test Loss: 0.714 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.6647534370422363
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.716 Vali Acc: 0.768 Test Loss: 0.716 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.4196455478668213
Epoch: 31, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.720 Vali Acc: 0.768 Test Loss: 0.720 Test Acc: 0.768
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.509249687194824
Epoch: 32, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.717 Vali Acc: 0.768 Test Loss: 0.717 Test Acc: 0.768
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.383702278137207
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.720 Vali Acc: 0.768 Test Loss: 0.720 Test Acc: 0.768
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.300255537033081
Epoch: 34, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.724 Vali Acc: 0.768 Test Loss: 0.724 Test Acc: 0.768
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.51414155960083
Epoch: 35, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.713 Vali Acc: 0.775 Test Loss: 0.713 Test Acc: 0.775
Validation loss decreased (-0.768109 --> -0.775355).  Saving model ...
Epoch: 36 cost time: 3.5363597869873047
Epoch: 36, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.714 Vali Acc: 0.775 Test Loss: 0.714 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.041456699371338
Epoch: 37, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.714 Vali Acc: 0.775 Test Loss: 0.714 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.2875638008117676
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.716 Vali Acc: 0.761 Test Loss: 0.716 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.3184432983398438
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.719 Vali Acc: 0.768 Test Loss: 0.719 Test Acc: 0.768
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.433455228805542
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.717 Vali Acc: 0.768 Test Loss: 0.717 Test Acc: 0.768
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 3.307121515274048
Epoch: 41, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.716 Vali Acc: 0.775 Test Loss: 0.716 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 3.503824472427368
Epoch: 42, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.714 Vali Acc: 0.783 Test Loss: 0.714 Test Acc: 0.783
Validation loss decreased (-0.775355 --> -0.782602).  Saving model ...
Epoch: 43 cost time: 3.393649101257324
Epoch: 43, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.711 Vali Acc: 0.783 Test Loss: 0.711 Test Acc: 0.783
Validation loss decreased (-0.782602 --> -0.782602).  Saving model ...
Epoch: 44 cost time: 3.407656669616699
Epoch: 44, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.712 Vali Acc: 0.783 Test Loss: 0.712 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.5383591651916504
Epoch: 45, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.715 Vali Acc: 0.768 Test Loss: 0.715 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 3.371392250061035
Epoch: 46, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.724 Vali Acc: 0.768 Test Loss: 0.724 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 3.205345630645752
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.731 Vali Acc: 0.775 Test Loss: 0.731 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 3.1362314224243164
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.727 Vali Acc: 0.775 Test Loss: 0.727 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 3.1127405166625977
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.723 Vali Acc: 0.775 Test Loss: 0.723 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 3.241513729095459
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.719 Vali Acc: 0.775 Test Loss: 0.719 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 3.263018846511841
Epoch: 51, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.718 Vali Acc: 0.768 Test Loss: 0.718 Test Acc: 0.768
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 3.658554792404175
Epoch: 52, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.719 Vali Acc: 0.768 Test Loss: 0.719 Test Acc: 0.768
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 3.2179152965545654
Epoch: 53, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.712 Vali Acc: 0.775 Test Loss: 0.712 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df256_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.782608695652174
model parameter : 318596
model size : 3.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.120966911315918
Epoch: 1, Steps: 9 | Train Loss: 1.418 Vali Loss: 1.394 Vali Acc: 0.261 Test Loss: 1.394 Test Acc: 0.261
Validation loss decreased (inf --> -0.260856).  Saving model ...
Epoch: 2 cost time: 3.5304768085479736
Epoch: 2, Steps: 9 | Train Loss: 1.330 Vali Loss: 1.355 Vali Acc: 0.355 Test Loss: 1.355 Test Acc: 0.355
Validation loss decreased (-0.260856 --> -0.355059).  Saving model ...
Epoch: 3 cost time: 3.724393606185913
Epoch: 3, Steps: 9 | Train Loss: 1.215 Vali Loss: 1.321 Vali Acc: 0.406 Test Loss: 1.321 Test Acc: 0.406
Validation loss decreased (-0.355059 --> -0.405784).  Saving model ...
Epoch: 4 cost time: 3.981957197189331
Epoch: 4, Steps: 9 | Train Loss: 1.027 Vali Loss: 1.262 Vali Acc: 0.435 Test Loss: 1.262 Test Acc: 0.435
Validation loss decreased (-0.405784 --> -0.434770).  Saving model ...
Epoch: 5 cost time: 3.548551321029663
Epoch: 5, Steps: 9 | Train Loss: 0.901 Vali Loss: 1.235 Vali Acc: 0.370 Test Loss: 1.235 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.258601188659668
Epoch: 6, Steps: 9 | Train Loss: 0.697 Vali Loss: 1.216 Vali Acc: 0.435 Test Loss: 1.216 Test Acc: 0.435
Validation loss decreased (-0.434770 --> -0.434770).  Saving model ...
Epoch: 7 cost time: 3.2976887226104736
Epoch: 7, Steps: 9 | Train Loss: 0.530 Vali Loss: 1.191 Vali Acc: 0.478 Test Loss: 1.191 Test Acc: 0.478
Validation loss decreased (-0.434770 --> -0.478249).  Saving model ...
Epoch: 8 cost time: 3.545963764190674
Epoch: 8, Steps: 9 | Train Loss: 0.428 Vali Loss: 1.214 Vali Acc: 0.420 Test Loss: 1.214 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.575155258178711
Epoch: 9, Steps: 9 | Train Loss: 0.294 Vali Loss: 1.270 Vali Acc: 0.449 Test Loss: 1.270 Test Acc: 0.449
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.1982595920562744
Epoch: 10, Steps: 9 | Train Loss: 0.228 Vali Loss: 1.228 Vali Acc: 0.464 Test Loss: 1.228 Test Acc: 0.464
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.330481767654419
Epoch: 11, Steps: 9 | Train Loss: 0.162 Vali Loss: 1.325 Vali Acc: 0.478 Test Loss: 1.325 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.5778677463531494
Epoch: 12, Steps: 9 | Train Loss: 0.127 Vali Loss: 1.330 Vali Acc: 0.478 Test Loss: 1.330 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.6834065914154053
Epoch: 13, Steps: 9 | Train Loss: 0.085 Vali Loss: 1.370 Vali Acc: 0.493 Test Loss: 1.370 Test Acc: 0.493
Validation loss decreased (-0.478249 --> -0.492740).  Saving model ...
Epoch: 14 cost time: 3.5006043910980225
Epoch: 14, Steps: 9 | Train Loss: 0.063 Vali Loss: 1.400 Vali Acc: 0.507 Test Loss: 1.400 Test Acc: 0.507
Validation loss decreased (-0.492740 --> -0.507232).  Saving model ...
Epoch: 15 cost time: 3.318796396255493
Epoch: 15, Steps: 9 | Train Loss: 0.048 Vali Loss: 1.411 Vali Acc: 0.500 Test Loss: 1.411 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.5985288619995117
Epoch: 16, Steps: 9 | Train Loss: 0.037 Vali Loss: 1.428 Vali Acc: 0.493 Test Loss: 1.428 Test Acc: 0.493
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.4818217754364014
Epoch: 17, Steps: 9 | Train Loss: 0.033 Vali Loss: 1.369 Vali Acc: 0.522 Test Loss: 1.369 Test Acc: 0.522
Validation loss decreased (-0.507232 --> -0.521725).  Saving model ...
Epoch: 18 cost time: 3.4610531330108643
Epoch: 18, Steps: 9 | Train Loss: 0.025 Vali Loss: 1.371 Vali Acc: 0.529 Test Loss: 1.371 Test Acc: 0.529
Validation loss decreased (-0.521725 --> -0.528972).  Saving model ...
Epoch: 19 cost time: 3.6608519554138184
Epoch: 19, Steps: 9 | Train Loss: 0.025 Vali Loss: 1.478 Vali Acc: 0.507 Test Loss: 1.478 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.4491782188415527
Epoch: 20, Steps: 9 | Train Loss: 0.016 Vali Loss: 1.465 Vali Acc: 0.500 Test Loss: 1.465 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.936011791229248
Epoch: 21, Steps: 9 | Train Loss: 0.016 Vali Loss: 1.380 Vali Acc: 0.529 Test Loss: 1.380 Test Acc: 0.529
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.1507740020751953
Epoch: 22, Steps: 9 | Train Loss: 0.013 Vali Loss: 1.356 Vali Acc: 0.551 Test Loss: 1.356 Test Acc: 0.551
Validation loss decreased (-0.528972 --> -0.550711).  Saving model ...
Epoch: 23 cost time: 3.2942819595336914
Epoch: 23, Steps: 9 | Train Loss: 0.012 Vali Loss: 1.457 Vali Acc: 0.529 Test Loss: 1.457 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.625664472579956
Epoch: 24, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.480 Vali Acc: 0.514 Test Loss: 1.480 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.2903692722320557
Epoch: 25, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.448 Vali Acc: 0.536 Test Loss: 1.448 Test Acc: 0.536
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.340230941772461
Epoch: 26, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.446 Vali Acc: 0.551 Test Loss: 1.446 Test Acc: 0.551
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.510014533996582
Epoch: 27, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.476 Vali Acc: 0.543 Test Loss: 1.476 Test Acc: 0.543
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.4756505489349365
Epoch: 28, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.398 Vali Acc: 0.514 Test Loss: 1.398 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.553779363632202
Epoch: 29, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.360 Vali Acc: 0.551 Test Loss: 1.360 Test Acc: 0.551
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.4876632690429688
Epoch: 30, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.364 Vali Acc: 0.558 Test Loss: 1.364 Test Acc: 0.558
Validation loss decreased (-0.550711 --> -0.557957).  Saving model ...
Epoch: 31 cost time: 3.4503252506256104
Epoch: 31, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.398 Vali Acc: 0.565 Test Loss: 1.398 Test Acc: 0.565
Validation loss decreased (-0.557957 --> -0.565203).  Saving model ...
Epoch: 32 cost time: 3.6569595336914062
Epoch: 32, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.488 Vali Acc: 0.558 Test Loss: 1.488 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.424293279647827
Epoch: 33, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.426 Vali Acc: 0.543 Test Loss: 1.426 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.5666439533233643
Epoch: 34, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.387 Vali Acc: 0.565 Test Loss: 1.387 Test Acc: 0.565
Validation loss decreased (-0.565203 --> -0.565204).  Saving model ...
Epoch: 35 cost time: 3.6392107009887695
Epoch: 35, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.499 Vali Acc: 0.551 Test Loss: 1.499 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.3271360397338867
Epoch: 36, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.441 Vali Acc: 0.565 Test Loss: 1.441 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.886045217514038
Epoch: 37, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.401 Vali Acc: 0.572 Test Loss: 1.401 Test Acc: 0.572
Validation loss decreased (-0.565204 --> -0.572450).  Saving model ...
Epoch: 38 cost time: 3.874302864074707
Epoch: 38, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.339 Vali Acc: 0.572 Test Loss: 1.339 Test Acc: 0.572
Validation loss decreased (-0.572450 --> -0.572450).  Saving model ...
Epoch: 39 cost time: 3.5627949237823486
Epoch: 39, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.357 Vali Acc: 0.572 Test Loss: 1.357 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.8069005012512207
Epoch: 40, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.380 Vali Acc: 0.572 Test Loss: 1.380 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.9023842811584473
Epoch: 41, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.382 Vali Acc: 0.580 Test Loss: 1.382 Test Acc: 0.580
Validation loss decreased (-0.572450 --> -0.579696).  Saving model ...
Epoch: 42 cost time: 3.670095920562744
Epoch: 42, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.384 Vali Acc: 0.580 Test Loss: 1.384 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.426330327987671
Epoch: 43, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.354 Vali Acc: 0.580 Test Loss: 1.354 Test Acc: 0.580
Validation loss decreased (-0.579696 --> -0.579697).  Saving model ...
Epoch: 44 cost time: 3.4596898555755615
Epoch: 44, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.373 Vali Acc: 0.572 Test Loss: 1.373 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.5593581199645996
Epoch: 45, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.365 Vali Acc: 0.580 Test Loss: 1.365 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 3.3471481800079346
Epoch: 46, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.385 Vali Acc: 0.580 Test Loss: 1.385 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 3.644792079925537
Epoch: 47, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.401 Vali Acc: 0.580 Test Loss: 1.401 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 3.4651565551757812
Epoch: 48, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.398 Vali Acc: 0.572 Test Loss: 1.398 Test Acc: 0.572
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 3.774968385696411
Epoch: 49, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.413 Vali Acc: 0.580 Test Loss: 1.413 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 3.8001976013183594
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.408 Vali Acc: 0.580 Test Loss: 1.408 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 3.9102296829223633
Epoch: 51, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.390 Vali Acc: 0.594 Test Loss: 1.390 Test Acc: 0.594
Validation loss decreased (-0.579697 --> -0.594189).  Saving model ...
Epoch: 52 cost time: 4.14903998374939
Epoch: 52, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.387 Vali Acc: 0.587 Test Loss: 1.387 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 4.013461112976074
Epoch: 53, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.384 Vali Acc: 0.594 Test Loss: 1.384 Test Acc: 0.594
Validation loss decreased (-0.594189 --> -0.594189).  Saving model ...
Epoch: 54 cost time: 3.1513450145721436
Epoch: 54, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.368 Vali Acc: 0.609 Test Loss: 1.368 Test Acc: 0.609
Validation loss decreased (-0.594189 --> -0.608682).  Saving model ...
Epoch: 55 cost time: 3.4963302612304688
Epoch: 55, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.360 Vali Acc: 0.609 Test Loss: 1.360 Test Acc: 0.609
Validation loss decreased (-0.608682 --> -0.608682).  Saving model ...
Epoch: 56 cost time: 3.3703384399414062
Epoch: 56, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.368 Vali Acc: 0.609 Test Loss: 1.368 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 3.2451157569885254
Epoch: 57, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.371 Vali Acc: 0.609 Test Loss: 1.371 Test Acc: 0.609
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 3.5817196369171143
Epoch: 58, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.381 Vali Acc: 0.594 Test Loss: 1.381 Test Acc: 0.594
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 3.5209262371063232
Epoch: 59, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.367 Vali Acc: 0.601 Test Loss: 1.367 Test Acc: 0.601
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 3.2369415760040283
Epoch: 60, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.348 Vali Acc: 0.601 Test Loss: 1.348 Test Acc: 0.601
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 3.217207908630371
Epoch: 61, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.330 Vali Acc: 0.616 Test Loss: 1.330 Test Acc: 0.616
Validation loss decreased (-0.608682 --> -0.615929).  Saving model ...
Epoch: 62 cost time: 3.292965888977051
Epoch: 62, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.330 Vali Acc: 0.616 Test Loss: 1.330 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 3.536144495010376
Epoch: 63, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.338 Vali Acc: 0.616 Test Loss: 1.338 Test Acc: 0.616
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 3.4601829051971436
Epoch: 64, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.351 Vali Acc: 0.601 Test Loss: 1.351 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 3.491957902908325
Epoch: 65, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.367 Vali Acc: 0.601 Test Loss: 1.367 Test Acc: 0.601
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 3.736924648284912
Epoch: 66, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.382 Vali Acc: 0.601 Test Loss: 1.382 Test Acc: 0.601
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 3.532386541366577
Epoch: 67, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.373 Vali Acc: 0.601 Test Loss: 1.373 Test Acc: 0.601
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 3.560852527618408
Epoch: 68, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.368 Vali Acc: 0.609 Test Loss: 1.368 Test Acc: 0.609
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 3.6942012310028076
Epoch: 69, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.379 Vali Acc: 0.601 Test Loss: 1.379 Test Acc: 0.601
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 3.427802324295044
Epoch: 70, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.367 Vali Acc: 0.616 Test Loss: 1.367 Test Acc: 0.616
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 3.371851682662964
Epoch: 71, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.350 Vali Acc: 0.623 Test Loss: 1.350 Test Acc: 0.623
Validation loss decreased (-0.615929 --> -0.623175).  Saving model ...
Epoch: 72 cost time: 3.609715223312378
Epoch: 72, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.333 Vali Acc: 0.630 Test Loss: 1.333 Test Acc: 0.630
Validation loss decreased (-0.623175 --> -0.630421).  Saving model ...
Epoch: 73 cost time: 3.33850359916687
Epoch: 73, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.323 Vali Acc: 0.623 Test Loss: 1.323 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 3.1989500522613525
Epoch: 74, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.329 Vali Acc: 0.630 Test Loss: 1.329 Test Acc: 0.630
Validation loss decreased (-0.630421 --> -0.630421).  Saving model ...
Epoch: 75 cost time: 3.2548584938049316
Epoch: 75, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.365 Vali Acc: 0.623 Test Loss: 1.365 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 3.4964511394500732
Epoch: 76, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.365 Vali Acc: 0.623 Test Loss: 1.365 Test Acc: 0.623
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 3.57262921333313
Epoch: 77, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.366 Vali Acc: 0.623 Test Loss: 1.366 Test Acc: 0.623
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 3.2156476974487305
Epoch: 78, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.361 Vali Acc: 0.623 Test Loss: 1.361 Test Acc: 0.623
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 3.513150215148926
Epoch: 79, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.355 Vali Acc: 0.623 Test Loss: 1.355 Test Acc: 0.623
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 3.2375922203063965
Epoch: 80, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.337 Vali Acc: 0.630 Test Loss: 1.337 Test Acc: 0.630
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 3.5310218334198
Epoch: 81, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.324 Vali Acc: 0.645 Test Loss: 1.324 Test Acc: 0.645
Validation loss decreased (-0.630421 --> -0.644914).  Saving model ...
Epoch: 82 cost time: 3.4346938133239746
Epoch: 82, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.321 Vali Acc: 0.645 Test Loss: 1.321 Test Acc: 0.645
Validation loss decreased (-0.644914 --> -0.644914).  Saving model ...
Epoch: 83 cost time: 3.436527967453003
Epoch: 83, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.319 Vali Acc: 0.645 Test Loss: 1.319 Test Acc: 0.645
Validation loss decreased (-0.644914 --> -0.644914).  Saving model ...
Epoch: 84 cost time: 3.0497887134552
Epoch: 84, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.328 Vali Acc: 0.645 Test Loss: 1.328 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 3.5945637226104736
Epoch: 85, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.331 Vali Acc: 0.645 Test Loss: 1.331 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 3.5799825191497803
Epoch: 86, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.338 Vali Acc: 0.645 Test Loss: 1.338 Test Acc: 0.645
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 3.6637797355651855
Epoch: 87, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.334 Vali Acc: 0.645 Test Loss: 1.334 Test Acc: 0.645
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 3.5641138553619385
Epoch: 88, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.336 Vali Acc: 0.645 Test Loss: 1.336 Test Acc: 0.645
EarlyStopping counter: 5 out of 10
Epoch: 89 cost time: 3.556507110595703
Epoch: 89, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.338 Vali Acc: 0.645 Test Loss: 1.338 Test Acc: 0.645
EarlyStopping counter: 6 out of 10
Epoch: 90 cost time: 3.623654365539551
Epoch: 90, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.328 Vali Acc: 0.645 Test Loss: 1.328 Test Acc: 0.645
EarlyStopping counter: 7 out of 10
Epoch: 91 cost time: 3.3136210441589355
Epoch: 91, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.330 Vali Acc: 0.645 Test Loss: 1.330 Test Acc: 0.645
EarlyStopping counter: 8 out of 10
Epoch: 92 cost time: 3.4975011348724365
Epoch: 92, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.329 Vali Acc: 0.645 Test Loss: 1.329 Test Acc: 0.645
EarlyStopping counter: 9 out of 10
Epoch: 93 cost time: 3.3165080547332764
Epoch: 93, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.329 Vali Acc: 0.645 Test Loss: 1.329 Test Acc: 0.645
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.644927536231884
model parameter : 318596
model size : 3.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.527318000793457
Epoch: 1, Steps: 9 | Train Loss: 1.395 Vali Loss: 1.393 Vali Acc: 0.261 Test Loss: 1.393 Test Acc: 0.261
Validation loss decreased (inf --> -0.260856).  Saving model ...
Epoch: 2 cost time: 3.318800926208496
Epoch: 2, Steps: 9 | Train Loss: 1.372 Vali Loss: 1.381 Vali Acc: 0.297 Test Loss: 1.381 Test Acc: 0.297
Validation loss decreased (-0.260856 --> -0.297088).  Saving model ...
Epoch: 3 cost time: 3.1941428184509277
Epoch: 3, Steps: 9 | Train Loss: 1.273 Vali Loss: 1.398 Vali Acc: 0.275 Test Loss: 1.398 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.3796284198760986
Epoch: 4, Steps: 9 | Train Loss: 1.157 Vali Loss: 1.381 Vali Acc: 0.304 Test Loss: 1.381 Test Acc: 0.304
Validation loss decreased (-0.297088 --> -0.304334).  Saving model ...
Epoch: 5 cost time: 3.5316057205200195
Epoch: 5, Steps: 9 | Train Loss: 1.077 Vali Loss: 1.395 Vali Acc: 0.268 Test Loss: 1.395 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.377152442932129
Epoch: 6, Steps: 9 | Train Loss: 0.931 Vali Loss: 1.506 Vali Acc: 0.297 Test Loss: 1.506 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.001969575881958
Epoch: 7, Steps: 9 | Train Loss: 0.782 Vali Loss: 1.574 Vali Acc: 0.275 Test Loss: 1.574 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.268033742904663
Epoch: 8, Steps: 9 | Train Loss: 0.719 Vali Loss: 1.581 Vali Acc: 0.304 Test Loss: 1.581 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.3637187480926514
Epoch: 9, Steps: 9 | Train Loss: 0.550 Vali Loss: 1.895 Vali Acc: 0.268 Test Loss: 1.895 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.3017048835754395
Epoch: 10, Steps: 9 | Train Loss: 0.451 Vali Loss: 1.968 Vali Acc: 0.304 Test Loss: 1.968 Test Acc: 0.304
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.7851884365081787
Epoch: 11, Steps: 9 | Train Loss: 0.361 Vali Loss: 2.234 Vali Acc: 0.275 Test Loss: 2.234 Test Acc: 0.275
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.353452682495117
Epoch: 12, Steps: 9 | Train Loss: 0.300 Vali Loss: 2.555 Vali Acc: 0.283 Test Loss: 2.555 Test Acc: 0.283
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.284966468811035
Epoch: 13, Steps: 9 | Train Loss: 0.228 Vali Loss: 2.576 Vali Acc: 0.283 Test Loss: 2.576 Test Acc: 0.283
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.2007200717926025
Epoch: 14, Steps: 9 | Train Loss: 0.163 Vali Loss: 2.758 Vali Acc: 0.283 Test Loss: 2.758 Test Acc: 0.283
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.30434782608695654
model parameter : 318596
model size : 3.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.156331777572632
Epoch: 1, Steps: 9 | Train Loss: 1.397 Vali Loss: 1.430 Vali Acc: 0.246 Test Loss: 1.430 Test Acc: 0.246
Validation loss decreased (inf --> -0.246363).  Saving model ...
Epoch: 2 cost time: 3.2243783473968506
Epoch: 2, Steps: 9 | Train Loss: 1.367 Vali Loss: 1.404 Vali Acc: 0.275 Test Loss: 1.404 Test Acc: 0.275
Validation loss decreased (-0.246363 --> -0.275348).  Saving model ...
Epoch: 3 cost time: 3.679419755935669
Epoch: 3, Steps: 9 | Train Loss: 1.226 Vali Loss: 1.393 Vali Acc: 0.319 Test Loss: 1.393 Test Acc: 0.319
Validation loss decreased (-0.275348 --> -0.318827).  Saving model ...
Epoch: 4 cost time: 3.3362209796905518
Epoch: 4, Steps: 9 | Train Loss: 1.117 Vali Loss: 1.357 Vali Acc: 0.290 Test Loss: 1.357 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.637810230255127
Epoch: 5, Steps: 9 | Train Loss: 0.997 Vali Loss: 1.337 Vali Acc: 0.319 Test Loss: 1.337 Test Acc: 0.319
Validation loss decreased (-0.318827 --> -0.318827).  Saving model ...
Epoch: 6 cost time: 3.311924457550049
Epoch: 6, Steps: 9 | Train Loss: 0.837 Vali Loss: 1.374 Vali Acc: 0.297 Test Loss: 1.374 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.2552995681762695
Epoch: 7, Steps: 9 | Train Loss: 0.722 Vali Loss: 1.366 Vali Acc: 0.312 Test Loss: 1.366 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.309133768081665
Epoch: 8, Steps: 9 | Train Loss: 0.598 Vali Loss: 1.341 Vali Acc: 0.326 Test Loss: 1.341 Test Acc: 0.326
Validation loss decreased (-0.318827 --> -0.326074).  Saving model ...
Epoch: 9 cost time: 3.350417137145996
Epoch: 9, Steps: 9 | Train Loss: 0.495 Vali Loss: 1.453 Vali Acc: 0.290 Test Loss: 1.453 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.369666814804077
Epoch: 10, Steps: 9 | Train Loss: 0.373 Vali Loss: 1.459 Vali Acc: 0.304 Test Loss: 1.459 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.1690235137939453
Epoch: 11, Steps: 9 | Train Loss: 0.291 Vali Loss: 1.622 Vali Acc: 0.304 Test Loss: 1.622 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.369548797607422
Epoch: 12, Steps: 9 | Train Loss: 0.215 Vali Loss: 1.641 Vali Acc: 0.275 Test Loss: 1.641 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.4183902740478516
Epoch: 13, Steps: 9 | Train Loss: 0.166 Vali Loss: 1.803 Vali Acc: 0.341 Test Loss: 1.803 Test Acc: 0.341
Validation loss decreased (-0.326074 --> -0.340562).  Saving model ...
Epoch: 14 cost time: 3.2291040420532227
Epoch: 14, Steps: 9 | Train Loss: 0.117 Vali Loss: 1.875 Vali Acc: 0.290 Test Loss: 1.875 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.3724353313446045
Epoch: 15, Steps: 9 | Train Loss: 0.080 Vali Loss: 1.856 Vali Acc: 0.319 Test Loss: 1.856 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.468949794769287
Epoch: 16, Steps: 9 | Train Loss: 0.067 Vali Loss: 2.042 Vali Acc: 0.312 Test Loss: 2.042 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.803860664367676
Epoch: 17, Steps: 9 | Train Loss: 0.050 Vali Loss: 1.999 Vali Acc: 0.297 Test Loss: 1.999 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.336531162261963
Epoch: 18, Steps: 9 | Train Loss: 0.041 Vali Loss: 1.978 Vali Acc: 0.348 Test Loss: 1.978 Test Acc: 0.348
Validation loss decreased (-0.340562 --> -0.347806).  Saving model ...
Epoch: 19 cost time: 3.141444683074951
Epoch: 19, Steps: 9 | Train Loss: 0.038 Vali Loss: 2.054 Vali Acc: 0.348 Test Loss: 2.054 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.5317766666412354
Epoch: 20, Steps: 9 | Train Loss: 0.027 Vali Loss: 1.982 Vali Acc: 0.319 Test Loss: 1.982 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.3979034423828125
Epoch: 21, Steps: 9 | Train Loss: 0.021 Vali Loss: 1.949 Vali Acc: 0.341 Test Loss: 1.949 Test Acc: 0.341
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.4660935401916504
Epoch: 22, Steps: 9 | Train Loss: 0.021 Vali Loss: 1.974 Vali Acc: 0.355 Test Loss: 1.974 Test Acc: 0.355
Validation loss decreased (-0.347806 --> -0.355053).  Saving model ...
Epoch: 23 cost time: 3.19311785697937
Epoch: 23, Steps: 9 | Train Loss: 0.016 Vali Loss: 2.099 Vali Acc: 0.312 Test Loss: 2.099 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.3195297718048096
Epoch: 24, Steps: 9 | Train Loss: 0.015 Vali Loss: 2.052 Vali Acc: 0.326 Test Loss: 2.052 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.586043357849121
Epoch: 25, Steps: 9 | Train Loss: 0.015 Vali Loss: 1.977 Vali Acc: 0.355 Test Loss: 1.977 Test Acc: 0.355
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.5823404788970947
Epoch: 26, Steps: 9 | Train Loss: 0.010 Vali Loss: 1.967 Vali Acc: 0.362 Test Loss: 1.967 Test Acc: 0.362
Validation loss decreased (-0.355053 --> -0.362299).  Saving model ...
Epoch: 27 cost time: 3.3345041275024414
Epoch: 27, Steps: 9 | Train Loss: 0.010 Vali Loss: 1.956 Vali Acc: 0.362 Test Loss: 1.956 Test Acc: 0.362
Validation loss decreased (-0.362299 --> -0.362299).  Saving model ...
Epoch: 28 cost time: 3.599120855331421
Epoch: 28, Steps: 9 | Train Loss: 0.010 Vali Loss: 1.918 Vali Acc: 0.341 Test Loss: 1.918 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.6186106204986572
Epoch: 29, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.951 Vali Acc: 0.355 Test Loss: 1.951 Test Acc: 0.355
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.5979931354522705
Epoch: 30, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.994 Vali Acc: 0.362 Test Loss: 1.994 Test Acc: 0.362
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.9732561111450195
Epoch: 31, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.947 Vali Acc: 0.355 Test Loss: 1.947 Test Acc: 0.355
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.513152599334717
Epoch: 32, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.933 Vali Acc: 0.370 Test Loss: 1.933 Test Acc: 0.370
Validation loss decreased (-0.362299 --> -0.369546).  Saving model ...
Epoch: 33 cost time: 3.5903260707855225
Epoch: 33, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.908 Vali Acc: 0.377 Test Loss: 1.908 Test Acc: 0.377
Validation loss decreased (-0.369546 --> -0.376793).  Saving model ...
Epoch: 34 cost time: 3.697946310043335
Epoch: 34, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.898 Vali Acc: 0.384 Test Loss: 1.898 Test Acc: 0.384
Validation loss decreased (-0.376793 --> -0.384039).  Saving model ...
Epoch: 35 cost time: 3.3246071338653564
Epoch: 35, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.952 Vali Acc: 0.399 Test Loss: 1.952 Test Acc: 0.399
Validation loss decreased (-0.384039 --> -0.398531).  Saving model ...
Epoch: 36 cost time: 3.536442995071411
Epoch: 36, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.915 Vali Acc: 0.377 Test Loss: 1.915 Test Acc: 0.377
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.7196669578552246
Epoch: 37, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.903 Vali Acc: 0.384 Test Loss: 1.903 Test Acc: 0.384
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.514962911605835
Epoch: 38, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.892 Vali Acc: 0.384 Test Loss: 1.892 Test Acc: 0.384
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.4339325428009033
Epoch: 39, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.911 Vali Acc: 0.384 Test Loss: 1.911 Test Acc: 0.384
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.8823657035827637
Epoch: 40, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.918 Vali Acc: 0.384 Test Loss: 1.918 Test Acc: 0.384
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 3.44901442527771
Epoch: 41, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.900 Vali Acc: 0.377 Test Loss: 1.900 Test Acc: 0.377
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 3.764561414718628
Epoch: 42, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.885 Vali Acc: 0.384 Test Loss: 1.885 Test Acc: 0.384
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 3.420154571533203
Epoch: 43, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.827 Vali Acc: 0.406 Test Loss: 1.827 Test Acc: 0.406
Validation loss decreased (-0.398531 --> -0.405779).  Saving model ...
Epoch: 44 cost time: 3.54909348487854
Epoch: 44, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.821 Vali Acc: 0.377 Test Loss: 1.821 Test Acc: 0.377
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.4855992794036865
Epoch: 45, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.819 Vali Acc: 0.377 Test Loss: 1.819 Test Acc: 0.377
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 3.0709805488586426
Epoch: 46, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.895 Vali Acc: 0.384 Test Loss: 1.895 Test Acc: 0.384
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 3.380513906478882
Epoch: 47, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.925 Vali Acc: 0.399 Test Loss: 1.925 Test Acc: 0.399
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 3.1128835678100586
Epoch: 48, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.897 Vali Acc: 0.391 Test Loss: 1.897 Test Acc: 0.391
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 3.2324540615081787
Epoch: 49, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.835 Vali Acc: 0.391 Test Loss: 1.835 Test Acc: 0.391
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 3.471189260482788
Epoch: 50, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.787 Vali Acc: 0.420 Test Loss: 1.787 Test Acc: 0.420
Validation loss decreased (-0.405779 --> -0.420272).  Saving model ...
Epoch: 51 cost time: 3.3595292568206787
Epoch: 51, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.774 Vali Acc: 0.406 Test Loss: 1.774 Test Acc: 0.406
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 3.394557237625122
Epoch: 52, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.768 Vali Acc: 0.428 Test Loss: 1.768 Test Acc: 0.428
Validation loss decreased (-0.420272 --> -0.427519).  Saving model ...
Epoch: 53 cost time: 3.5540542602539062
Epoch: 53, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.822 Vali Acc: 0.420 Test Loss: 1.822 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 3.9454307556152344
Epoch: 54, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.844 Vali Acc: 0.428 Test Loss: 1.844 Test Acc: 0.428
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 3.9057834148406982
Epoch: 55, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.841 Vali Acc: 0.428 Test Loss: 1.841 Test Acc: 0.428
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 3.832977533340454
Epoch: 56, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.840 Vali Acc: 0.435 Test Loss: 1.840 Test Acc: 0.435
Validation loss decreased (-0.427519 --> -0.434764).  Saving model ...
Epoch: 57 cost time: 3.609107732772827
Epoch: 57, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.824 Vali Acc: 0.435 Test Loss: 1.824 Test Acc: 0.435
Validation loss decreased (-0.434764 --> -0.434764).  Saving model ...
Epoch: 58 cost time: 3.6618893146514893
Epoch: 58, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.808 Vali Acc: 0.435 Test Loss: 1.808 Test Acc: 0.435
Validation loss decreased (-0.434764 --> -0.434765).  Saving model ...
Epoch: 59 cost time: 3.434807777404785
Epoch: 59, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.820 Vali Acc: 0.435 Test Loss: 1.820 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 3.5572547912597656
Epoch: 60, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.789 Vali Acc: 0.435 Test Loss: 1.789 Test Acc: 0.435
Validation loss decreased (-0.434765 --> -0.434765).  Saving model ...
Epoch: 61 cost time: 3.465614080429077
Epoch: 61, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.792 Vali Acc: 0.435 Test Loss: 1.792 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 3.470604658126831
Epoch: 62, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.822 Vali Acc: 0.435 Test Loss: 1.822 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 3.376267910003662
Epoch: 63, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.824 Vali Acc: 0.435 Test Loss: 1.824 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 3.6663572788238525
Epoch: 64, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.808 Vali Acc: 0.435 Test Loss: 1.808 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 3.370126962661743
Epoch: 65, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.797 Vali Acc: 0.435 Test Loss: 1.797 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 3.3210222721099854
Epoch: 66, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.763 Vali Acc: 0.449 Test Loss: 1.763 Test Acc: 0.449
Validation loss decreased (-0.434765 --> -0.449258).  Saving model ...
Epoch: 67 cost time: 3.458772897720337
Epoch: 67, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.734 Vali Acc: 0.464 Test Loss: 1.734 Test Acc: 0.464
Validation loss decreased (-0.449258 --> -0.463751).  Saving model ...
Epoch: 68 cost time: 3.43318247795105
Epoch: 68, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.706 Vali Acc: 0.471 Test Loss: 1.706 Test Acc: 0.471
Validation loss decreased (-0.463751 --> -0.470997).  Saving model ...
Epoch: 69 cost time: 3.667240619659424
Epoch: 69, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.709 Vali Acc: 0.471 Test Loss: 1.709 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 3.4926323890686035
Epoch: 70, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.719 Vali Acc: 0.471 Test Loss: 1.719 Test Acc: 0.471
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 3.3324129581451416
Epoch: 71, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.734 Vali Acc: 0.464 Test Loss: 1.734 Test Acc: 0.464
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 3.3757972717285156
Epoch: 72, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.743 Vali Acc: 0.464 Test Loss: 1.743 Test Acc: 0.464
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 3.2395806312561035
Epoch: 73, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.732 Vali Acc: 0.471 Test Loss: 1.732 Test Acc: 0.471
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 3.2378759384155273
Epoch: 74, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.728 Vali Acc: 0.478 Test Loss: 1.728 Test Acc: 0.478
Validation loss decreased (-0.470997 --> -0.478244).  Saving model ...
Epoch: 75 cost time: 3.1643121242523193
Epoch: 75, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.720 Vali Acc: 0.486 Test Loss: 1.720 Test Acc: 0.486
Validation loss decreased (-0.478244 --> -0.485490).  Saving model ...
Epoch: 76 cost time: 3.4273810386657715
Epoch: 76, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.692 Vali Acc: 0.478 Test Loss: 1.692 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 3.4970178604125977
Epoch: 77, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.671 Vali Acc: 0.486 Test Loss: 1.671 Test Acc: 0.486
Validation loss decreased (-0.485490 --> -0.485491).  Saving model ...
Epoch: 78 cost time: 3.2365355491638184
Epoch: 78, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.673 Vali Acc: 0.486 Test Loss: 1.673 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 3.5751030445098877
Epoch: 79, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.680 Vali Acc: 0.486 Test Loss: 1.680 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 3.6188766956329346
Epoch: 80, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.690 Vali Acc: 0.493 Test Loss: 1.690 Test Acc: 0.493
Validation loss decreased (-0.485491 --> -0.492737).  Saving model ...
Epoch: 81 cost time: 3.614358901977539
Epoch: 81, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.689 Vali Acc: 0.500 Test Loss: 1.689 Test Acc: 0.500
Validation loss decreased (-0.492737 --> -0.499983).  Saving model ...
Epoch: 82 cost time: 3.5607826709747314
Epoch: 82, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.661 Vali Acc: 0.500 Test Loss: 1.661 Test Acc: 0.500
Validation loss decreased (-0.499983 --> -0.499983).  Saving model ...
Epoch: 83 cost time: 3.625372886657715
Epoch: 83, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.642 Vali Acc: 0.500 Test Loss: 1.642 Test Acc: 0.500
Validation loss decreased (-0.499983 --> -0.499984).  Saving model ...
Epoch: 84 cost time: 3.3795313835144043
Epoch: 84, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.645 Vali Acc: 0.500 Test Loss: 1.645 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 3.508702039718628
Epoch: 85, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.649 Vali Acc: 0.500 Test Loss: 1.649 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 3.532881021499634
Epoch: 86, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.668 Vali Acc: 0.500 Test Loss: 1.668 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 3.3276960849761963
Epoch: 87, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.662 Vali Acc: 0.514 Test Loss: 1.662 Test Acc: 0.514
Validation loss decreased (-0.499984 --> -0.514476).  Saving model ...
Epoch: 88 cost time: 3.3305928707122803
Epoch: 88, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.663 Vali Acc: 0.514 Test Loss: 1.663 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 3.415947914123535
Epoch: 89, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.653 Vali Acc: 0.507 Test Loss: 1.653 Test Acc: 0.507
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 3.725154161453247
Epoch: 90, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.647 Vali Acc: 0.507 Test Loss: 1.647 Test Acc: 0.507
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 3.798039197921753
Epoch: 91, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.631 Vali Acc: 0.507 Test Loss: 1.631 Test Acc: 0.507
EarlyStopping counter: 4 out of 10
Epoch: 92 cost time: 3.5592756271362305
Epoch: 92, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.629 Vali Acc: 0.507 Test Loss: 1.629 Test Acc: 0.507
EarlyStopping counter: 5 out of 10
Epoch: 93 cost time: 3.6382694244384766
Epoch: 93, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.641 Vali Acc: 0.493 Test Loss: 1.641 Test Acc: 0.493
EarlyStopping counter: 6 out of 10
Epoch: 94 cost time: 3.2864136695861816
Epoch: 94, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.658 Vali Acc: 0.500 Test Loss: 1.658 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 95 cost time: 3.3168983459472656
Epoch: 95, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.673 Vali Acc: 0.500 Test Loss: 1.673 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 96 cost time: 3.5024309158325195
Epoch: 96, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.677 Vali Acc: 0.500 Test Loss: 1.677 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 97 cost time: 3.67854380607605
Epoch: 97, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.667 Vali Acc: 0.500 Test Loss: 1.667 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5144927536231884
model parameter : 318596
model size : 3.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         103                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df128_ma103_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.718030214309692
Epoch: 1, Steps: 9 | Train Loss: 1.449 Vali Loss: 1.348 Vali Acc: 0.355 Test Loss: 1.348 Test Acc: 0.355
Validation loss decreased (inf --> -0.355059).  Saving model ...
Epoch: 2 cost time: 3.383556365966797
Epoch: 2, Steps: 9 | Train Loss: 1.325 Vali Loss: 1.241 Vali Acc: 0.435 Test Loss: 1.241 Test Acc: 0.435
Validation loss decreased (-0.355059 --> -0.434770).  Saving model ...
Epoch: 3 cost time: 3.391702890396118
Epoch: 3, Steps: 9 | Train Loss: 1.075 Vali Loss: 1.091 Vali Acc: 0.609 Test Loss: 1.091 Test Acc: 0.609
Validation loss decreased (-0.434770 --> -0.608685).  Saving model ...
Epoch: 4 cost time: 3.504889726638794
Epoch: 4, Steps: 9 | Train Loss: 0.824 Vali Loss: 0.963 Vali Acc: 0.710 Test Loss: 0.963 Test Acc: 0.710
Validation loss decreased (-0.608685 --> -0.710135).  Saving model ...
Epoch: 5 cost time: 3.4040944576263428
Epoch: 5, Steps: 9 | Train Loss: 0.639 Vali Loss: 0.912 Vali Acc: 0.652 Test Loss: 0.912 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.755383253097534
Epoch: 6, Steps: 9 | Train Loss: 0.469 Vali Loss: 0.811 Vali Acc: 0.739 Test Loss: 0.811 Test Acc: 0.739
Validation loss decreased (-0.710135 --> -0.739122).  Saving model ...
Epoch: 7 cost time: 3.943608045578003
Epoch: 7, Steps: 9 | Train Loss: 0.324 Vali Loss: 0.719 Vali Acc: 0.754 Test Loss: 0.719 Test Acc: 0.754
Validation loss decreased (-0.739122 --> -0.753616).  Saving model ...
Epoch: 8 cost time: 3.6408536434173584
Epoch: 8, Steps: 9 | Train Loss: 0.219 Vali Loss: 0.686 Vali Acc: 0.754 Test Loss: 0.686 Test Acc: 0.754
Validation loss decreased (-0.753616 --> -0.753616).  Saving model ...
Epoch: 9 cost time: 3.630192756652832
Epoch: 9, Steps: 9 | Train Loss: 0.150 Vali Loss: 0.628 Vali Acc: 0.768 Test Loss: 0.628 Test Acc: 0.768
Validation loss decreased (-0.753616 --> -0.768110).  Saving model ...
Epoch: 10 cost time: 3.6540331840515137
Epoch: 10, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.628 Vali Acc: 0.754 Test Loss: 0.628 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.6470046043395996
Epoch: 11, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.630 Vali Acc: 0.754 Test Loss: 0.630 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.470435857772827
Epoch: 12, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.552 Vali Acc: 0.797 Test Loss: 0.552 Test Acc: 0.797
Validation loss decreased (-0.768110 --> -0.797096).  Saving model ...
Epoch: 13 cost time: 3.304919719696045
Epoch: 13, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.605 Vali Acc: 0.790 Test Loss: 0.605 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.412811279296875
Epoch: 14, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.603 Vali Acc: 0.775 Test Loss: 0.603 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.294976234436035
Epoch: 15, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.568 Vali Acc: 0.775 Test Loss: 0.568 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.489030122756958
Epoch: 16, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.574 Vali Acc: 0.775 Test Loss: 0.574 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.0917632579803467
Epoch: 17, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.553 Vali Acc: 0.790 Test Loss: 0.553 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.2370364665985107
Epoch: 18, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.565 Vali Acc: 0.783 Test Loss: 0.565 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.0526552200317383
Epoch: 19, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.580 Vali Acc: 0.783 Test Loss: 0.580 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.646932601928711
Epoch: 20, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.576 Vali Acc: 0.790 Test Loss: 0.576 Test Acc: 0.790
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.7712838649749756
Epoch: 21, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.572 Vali Acc: 0.783 Test Loss: 0.572 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.5744104385375977
Epoch: 22, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.572 Vali Acc: 0.783 Test Loss: 0.572 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df128_ma103_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7971014492753623
model parameter : 269444
model size : 3.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         83                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df128_ma83_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.084770917892456
Epoch: 1, Steps: 9 | Train Loss: 1.435 Vali Loss: 1.344 Vali Acc: 0.384 Test Loss: 1.344 Test Acc: 0.384
Validation loss decreased (inf --> -0.384045).  Saving model ...
Epoch: 2 cost time: 3.367185354232788
Epoch: 2, Steps: 9 | Train Loss: 1.312 Vali Loss: 1.238 Vali Acc: 0.428 Test Loss: 1.238 Test Acc: 0.428
Validation loss decreased (-0.384045 --> -0.427524).  Saving model ...
Epoch: 3 cost time: 3.433387517929077
Epoch: 3, Steps: 9 | Train Loss: 1.059 Vali Loss: 1.087 Vali Acc: 0.630 Test Loss: 1.087 Test Acc: 0.630
Validation loss decreased (-0.427524 --> -0.630424).  Saving model ...
Epoch: 4 cost time: 3.0878725051879883
Epoch: 4, Steps: 9 | Train Loss: 0.814 Vali Loss: 0.959 Vali Acc: 0.703 Test Loss: 0.959 Test Acc: 0.703
Validation loss decreased (-0.630424 --> -0.702889).  Saving model ...
Epoch: 5 cost time: 3.1284735202789307
Epoch: 5, Steps: 9 | Train Loss: 0.628 Vali Loss: 0.906 Vali Acc: 0.659 Test Loss: 0.906 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.2286622524261475
Epoch: 6, Steps: 9 | Train Loss: 0.466 Vali Loss: 0.804 Vali Acc: 0.739 Test Loss: 0.804 Test Acc: 0.739
Validation loss decreased (-0.702889 --> -0.739122).  Saving model ...
Epoch: 7 cost time: 3.1876277923583984
Epoch: 7, Steps: 9 | Train Loss: 0.324 Vali Loss: 0.707 Vali Acc: 0.783 Test Loss: 0.707 Test Acc: 0.783
Validation loss decreased (-0.739122 --> -0.782602).  Saving model ...
Epoch: 8 cost time: 3.1489028930664062
Epoch: 8, Steps: 9 | Train Loss: 0.224 Vali Loss: 0.670 Vali Acc: 0.768 Test Loss: 0.670 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.3913044929504395
Epoch: 9, Steps: 9 | Train Loss: 0.153 Vali Loss: 0.613 Vali Acc: 0.783 Test Loss: 0.613 Test Acc: 0.783
Validation loss decreased (-0.782602 --> -0.782603).  Saving model ...
Epoch: 10 cost time: 3.409287214279175
Epoch: 10, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.594 Vali Acc: 0.797 Test Loss: 0.594 Test Acc: 0.797
Validation loss decreased (-0.782603 --> -0.797096).  Saving model ...
Epoch: 11 cost time: 3.4447031021118164
Epoch: 11, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.601 Vali Acc: 0.768 Test Loss: 0.601 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.3787643909454346
Epoch: 12, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.521 Vali Acc: 0.826 Test Loss: 0.521 Test Acc: 0.826
Validation loss decreased (-0.797096 --> -0.826082).  Saving model ...
Epoch: 13 cost time: 3.6289868354797363
Epoch: 13, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.578 Vali Acc: 0.797 Test Loss: 0.578 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.318958282470703
Epoch: 14, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.565 Vali Acc: 0.812 Test Loss: 0.565 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.4431114196777344
Epoch: 15, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.535 Vali Acc: 0.812 Test Loss: 0.535 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.2991323471069336
Epoch: 16, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.547 Vali Acc: 0.819 Test Loss: 0.547 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.4654219150543213
Epoch: 17, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.525 Vali Acc: 0.833 Test Loss: 0.525 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833328).  Saving model ...
Epoch: 18 cost time: 3.3738489151000977
Epoch: 18, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.526 Vali Acc: 0.826 Test Loss: 0.526 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.2827727794647217
Epoch: 19, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.541 Vali Acc: 0.819 Test Loss: 0.541 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.4268603324890137
Epoch: 20, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.541 Vali Acc: 0.833 Test Loss: 0.541 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.40205454826355
Epoch: 21, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.532 Vali Acc: 0.819 Test Loss: 0.532 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.3265345096588135
Epoch: 22, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.525 Vali Acc: 0.826 Test Loss: 0.525 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.4505019187927246
Epoch: 23, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.528 Vali Acc: 0.848 Test Loss: 0.528 Test Acc: 0.848
Validation loss decreased (-0.833328 --> -0.847821).  Saving model ...
Epoch: 24 cost time: 3.3787758350372314
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.531 Vali Acc: 0.841 Test Loss: 0.531 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.4089698791503906
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.548 Vali Acc: 0.841 Test Loss: 0.548 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.5758931636810303
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.540 Vali Acc: 0.841 Test Loss: 0.540 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.582414388656616
Epoch: 27, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.532 Vali Acc: 0.833 Test Loss: 0.532 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.4627912044525146
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.531 Vali Acc: 0.841 Test Loss: 0.531 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.324704647064209
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.539 Vali Acc: 0.841 Test Loss: 0.539 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.235271692276001
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.549 Vali Acc: 0.841 Test Loss: 0.549 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 3.2118351459503174
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.539 Vali Acc: 0.833 Test Loss: 0.539 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.3618240356445312
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.532 Vali Acc: 0.833 Test Loss: 0.532 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.266801595687866
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.531 Vali Acc: 0.841 Test Loss: 0.531 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df128_ma83_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 269444
model size : 3.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         62                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df128_ma62_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.0085554122924805
Epoch: 1, Steps: 9 | Train Loss: 1.442 Vali Loss: 1.361 Vali Acc: 0.326 Test Loss: 1.361 Test Acc: 0.326
Validation loss decreased (inf --> -0.326073).  Saving model ...
Epoch: 2 cost time: 3.4482598304748535
Epoch: 2, Steps: 9 | Train Loss: 1.303 Vali Loss: 1.253 Vali Acc: 0.428 Test Loss: 1.253 Test Acc: 0.428
Validation loss decreased (-0.326073 --> -0.427524).  Saving model ...
Epoch: 3 cost time: 3.341177463531494
Epoch: 3, Steps: 9 | Train Loss: 1.066 Vali Loss: 1.103 Vali Acc: 0.587 Test Loss: 1.103 Test Acc: 0.587
Validation loss decreased (-0.427524 --> -0.586945).  Saving model ...
Epoch: 4 cost time: 3.30667781829834
Epoch: 4, Steps: 9 | Train Loss: 0.810 Vali Loss: 0.976 Vali Acc: 0.681 Test Loss: 0.976 Test Acc: 0.681
Validation loss decreased (-0.586945 --> -0.681150).  Saving model ...
Epoch: 5 cost time: 3.298527240753174
Epoch: 5, Steps: 9 | Train Loss: 0.621 Vali Loss: 0.913 Vali Acc: 0.652 Test Loss: 0.913 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.296259880065918
Epoch: 6, Steps: 9 | Train Loss: 0.454 Vali Loss: 0.807 Vali Acc: 0.768 Test Loss: 0.807 Test Acc: 0.768
Validation loss decreased (-0.681150 --> -0.768108).  Saving model ...
Epoch: 7 cost time: 3.3254127502441406
Epoch: 7, Steps: 9 | Train Loss: 0.319 Vali Loss: 0.716 Vali Acc: 0.790 Test Loss: 0.716 Test Acc: 0.790
Validation loss decreased (-0.768108 --> -0.789848).  Saving model ...
Epoch: 8 cost time: 2.967317819595337
Epoch: 8, Steps: 9 | Train Loss: 0.213 Vali Loss: 0.666 Vali Acc: 0.790 Test Loss: 0.666 Test Acc: 0.790
Validation loss decreased (-0.789848 --> -0.789848).  Saving model ...
Epoch: 9 cost time: 3.089285373687744
Epoch: 9, Steps: 9 | Train Loss: 0.144 Vali Loss: 0.607 Vali Acc: 0.833 Test Loss: 0.607 Test Acc: 0.833
Validation loss decreased (-0.789848 --> -0.833327).  Saving model ...
Epoch: 10 cost time: 3.3892617225646973
Epoch: 10, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.579 Vali Acc: 0.848 Test Loss: 0.579 Test Acc: 0.848
Validation loss decreased (-0.833327 --> -0.847820).  Saving model ...
Epoch: 11 cost time: 3.1378209590911865
Epoch: 11, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.586 Vali Acc: 0.826 Test Loss: 0.586 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.0855870246887207
Epoch: 12, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.513 Vali Acc: 0.855 Test Loss: 0.513 Test Acc: 0.855
Validation loss decreased (-0.847820 --> -0.855067).  Saving model ...
Epoch: 13 cost time: 3.1102452278137207
Epoch: 13, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.533 Vali Acc: 0.870 Test Loss: 0.533 Test Acc: 0.870
Validation loss decreased (-0.855067 --> -0.869560).  Saving model ...
Epoch: 14 cost time: 3.4971935749053955
Epoch: 14, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.540 Vali Acc: 0.855 Test Loss: 0.540 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.2269070148468018
Epoch: 15, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.506 Vali Acc: 0.870 Test Loss: 0.506 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869560).  Saving model ...
Epoch: 16 cost time: 3.4158549308776855
Epoch: 16, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.510 Vali Acc: 0.884 Test Loss: 0.510 Test Acc: 0.884
Validation loss decreased (-0.869560 --> -0.884053).  Saving model ...
Epoch: 17 cost time: 3.331376552581787
Epoch: 17, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.508 Vali Acc: 0.884 Test Loss: 0.508 Test Acc: 0.884
Validation loss decreased (-0.884053 --> -0.884053).  Saving model ...
Epoch: 18 cost time: 3.36645245552063
Epoch: 18, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.494 Vali Acc: 0.891 Test Loss: 0.494 Test Acc: 0.891
Validation loss decreased (-0.884053 --> -0.891299).  Saving model ...
Epoch: 19 cost time: 3.236867904663086
Epoch: 19, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.501 Vali Acc: 0.884 Test Loss: 0.501 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.254739284515381
Epoch: 20, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.503 Vali Acc: 0.891 Test Loss: 0.503 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.092639684677124
Epoch: 21, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.503 Vali Acc: 0.884 Test Loss: 0.503 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.099921941757202
Epoch: 22, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.492 Vali Acc: 0.899 Test Loss: 0.492 Test Acc: 0.899
Validation loss decreased (-0.891299 --> -0.898546).  Saving model ...
Epoch: 23 cost time: 3.0108115673065186
Epoch: 23, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.495 Vali Acc: 0.899 Test Loss: 0.495 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.018400192260742
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.493 Vali Acc: 0.906 Test Loss: 0.493 Test Acc: 0.906
Validation loss decreased (-0.898546 --> -0.905792).  Saving model ...
Epoch: 25 cost time: 3.074638605117798
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.506 Vali Acc: 0.906 Test Loss: 0.506 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.9119882583618164
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.501 Vali Acc: 0.906 Test Loss: 0.501 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.244525671005249
Epoch: 27, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.488 Vali Acc: 0.899 Test Loss: 0.488 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.5860767364501953
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.488 Vali Acc: 0.899 Test Loss: 0.488 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.2437386512756348
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.495 Vali Acc: 0.899 Test Loss: 0.495 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.346057176589966
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.507 Vali Acc: 0.899 Test Loss: 0.507 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.240424394607544
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.498 Vali Acc: 0.899 Test Loss: 0.498 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.372924327850342
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.491 Vali Acc: 0.899 Test Loss: 0.491 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.4803597927093506
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.491 Vali Acc: 0.906 Test Loss: 0.491 Test Acc: 0.906
Validation loss decreased (-0.905792 --> -0.905792).  Saving model ...
Epoch: 34 cost time: 3.0922889709472656
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.493 Vali Acc: 0.906 Test Loss: 0.493 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.1411287784576416
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.495 Vali Acc: 0.906 Test Loss: 0.495 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.2281644344329834
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.500 Vali Acc: 0.906 Test Loss: 0.500 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.2493135929107666
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.494 Vali Acc: 0.913 Test Loss: 0.494 Test Acc: 0.913
Validation loss decreased (-0.905792 --> -0.913039).  Saving model ...
Epoch: 38 cost time: 3.154844284057617
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.493 Vali Acc: 0.913 Test Loss: 0.493 Test Acc: 0.913
Validation loss decreased (-0.913039 --> -0.913039).  Saving model ...
Epoch: 39 cost time: 3.223144769668579
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.495 Vali Acc: 0.913 Test Loss: 0.495 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.2667899131774902
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.493 Vali Acc: 0.913 Test Loss: 0.493 Test Acc: 0.913
Validation loss decreased (-0.913039 --> -0.913039).  Saving model ...
Epoch: 41 cost time: 3.3978264331817627
Epoch: 41, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.492 Vali Acc: 0.913 Test Loss: 0.492 Test Acc: 0.913
Validation loss decreased (-0.913039 --> -0.913039).  Saving model ...
Epoch: 42 cost time: 3.57413387298584
Epoch: 42, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.487 Vali Acc: 0.913 Test Loss: 0.487 Test Acc: 0.913
Validation loss decreased (-0.913039 --> -0.913039).  Saving model ...
Epoch: 43 cost time: 3.4709954261779785
Epoch: 43, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.483 Vali Acc: 0.920 Test Loss: 0.483 Test Acc: 0.920
Validation loss decreased (-0.913039 --> -0.920285).  Saving model ...
Epoch: 44 cost time: 3.2392578125
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.483 Vali Acc: 0.920 Test Loss: 0.483 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.3369646072387695
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.493 Vali Acc: 0.920 Test Loss: 0.493 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 3.333322763442993
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.499 Vali Acc: 0.913 Test Loss: 0.499 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 3.175405979156494
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.500 Vali Acc: 0.913 Test Loss: 0.500 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 3.2595839500427246
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.498 Vali Acc: 0.920 Test Loss: 0.498 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 3.1291377544403076
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.490 Vali Acc: 0.920 Test Loss: 0.490 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 3.1801393032073975
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.494 Vali Acc: 0.920 Test Loss: 0.494 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 3.072770357131958
Epoch: 51, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.495 Vali Acc: 0.913 Test Loss: 0.495 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 3.1135339736938477
Epoch: 52, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.495 Vali Acc: 0.913 Test Loss: 0.495 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 3.0493996143341064
Epoch: 53, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.485 Vali Acc: 0.920 Test Loss: 0.485 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df128_ma62_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 269444
model size : 3.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         42                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df128_ma42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.560227394104004
Epoch: 1, Steps: 9 | Train Loss: 1.464 Vali Loss: 1.368 Vali Acc: 0.326 Test Loss: 1.368 Test Acc: 0.326
Validation loss decreased (inf --> -0.326073).  Saving model ...
Epoch: 2 cost time: 3.0539069175720215
Epoch: 2, Steps: 9 | Train Loss: 1.304 Vali Loss: 1.236 Vali Acc: 0.420 Test Loss: 1.236 Test Acc: 0.420
Validation loss decreased (-0.326073 --> -0.420277).  Saving model ...
Epoch: 3 cost time: 2.956986904144287
Epoch: 3, Steps: 9 | Train Loss: 1.058 Vali Loss: 1.071 Vali Acc: 0.609 Test Loss: 1.071 Test Acc: 0.609
Validation loss decreased (-0.420277 --> -0.608685).  Saving model ...
Epoch: 4 cost time: 3.0095181465148926
Epoch: 4, Steps: 9 | Train Loss: 0.786 Vali Loss: 0.936 Vali Acc: 0.717 Test Loss: 0.936 Test Acc: 0.717
Validation loss decreased (-0.608685 --> -0.717382).  Saving model ...
Epoch: 5 cost time: 3.0686275959014893
Epoch: 5, Steps: 9 | Train Loss: 0.608 Vali Loss: 0.874 Vali Acc: 0.681 Test Loss: 0.874 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.4855003356933594
Epoch: 6, Steps: 9 | Train Loss: 0.440 Vali Loss: 0.778 Vali Acc: 0.761 Test Loss: 0.778 Test Acc: 0.761
Validation loss decreased (-0.717382 --> -0.760862).  Saving model ...
Epoch: 7 cost time: 3.215930938720703
Epoch: 7, Steps: 9 | Train Loss: 0.310 Vali Loss: 0.685 Vali Acc: 0.790 Test Loss: 0.685 Test Acc: 0.790
Validation loss decreased (-0.760862 --> -0.789848).  Saving model ...
Epoch: 8 cost time: 3.285738468170166
Epoch: 8, Steps: 9 | Train Loss: 0.209 Vali Loss: 0.641 Vali Acc: 0.783 Test Loss: 0.641 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.3099584579467773
Epoch: 9, Steps: 9 | Train Loss: 0.143 Vali Loss: 0.584 Vali Acc: 0.797 Test Loss: 0.584 Test Acc: 0.797
Validation loss decreased (-0.789848 --> -0.797096).  Saving model ...
Epoch: 10 cost time: 3.319302558898926
Epoch: 10, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.562 Vali Acc: 0.804 Test Loss: 0.562 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804342).  Saving model ...
Epoch: 11 cost time: 3.4127378463745117
Epoch: 11, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.568 Vali Acc: 0.804 Test Loss: 0.568 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.1989853382110596
Epoch: 12, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.488 Vali Acc: 0.804 Test Loss: 0.488 Test Acc: 0.804
Validation loss decreased (-0.804342 --> -0.804343).  Saving model ...
Epoch: 13 cost time: 3.1498725414276123
Epoch: 13, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.520 Vali Acc: 0.833 Test Loss: 0.520 Test Acc: 0.833
Validation loss decreased (-0.804343 --> -0.833328).  Saving model ...
Epoch: 14 cost time: 3.3124239444732666
Epoch: 14, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.521 Vali Acc: 0.826 Test Loss: 0.521 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.9506759643554688
Epoch: 15, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.478 Vali Acc: 0.841 Test Loss: 0.478 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840575).  Saving model ...
Epoch: 16 cost time: 3.0959420204162598
Epoch: 16, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.493 Vali Acc: 0.833 Test Loss: 0.493 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.1622047424316406
Epoch: 17, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.480 Vali Acc: 0.841 Test Loss: 0.480 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.2181789875030518
Epoch: 18, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.464 Vali Acc: 0.848 Test Loss: 0.464 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 19 cost time: 3.4684436321258545
Epoch: 19, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.481 Vali Acc: 0.848 Test Loss: 0.481 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.129148006439209
Epoch: 20, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.479 Vali Acc: 0.848 Test Loss: 0.479 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.2238755226135254
Epoch: 21, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.472 Vali Acc: 0.855 Test Loss: 0.472 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855068).  Saving model ...
Epoch: 22 cost time: 3.4126994609832764
Epoch: 22, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.460 Vali Acc: 0.855 Test Loss: 0.460 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 23 cost time: 3.2590737342834473
Epoch: 23, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.468 Vali Acc: 0.855 Test Loss: 0.468 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.4297776222229004
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.468 Vali Acc: 0.862 Test Loss: 0.468 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 25 cost time: 3.2367868423461914
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.489 Vali Acc: 0.862 Test Loss: 0.489 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.415306806564331
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.479 Vali Acc: 0.848 Test Loss: 0.479 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.0997226238250732
Epoch: 27, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.467 Vali Acc: 0.848 Test Loss: 0.467 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.3292202949523926
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.459 Vali Acc: 0.862 Test Loss: 0.459 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 29 cost time: 3.0670783519744873
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.466 Vali Acc: 0.862 Test Loss: 0.466 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.198005199432373
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.482 Vali Acc: 0.862 Test Loss: 0.482 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.0566859245300293
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.474 Vali Acc: 0.855 Test Loss: 0.474 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.4806387424468994
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.468 Vali Acc: 0.855 Test Loss: 0.468 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 4.061076402664185
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.464 Vali Acc: 0.862 Test Loss: 0.464 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.230437994003296
Epoch: 34, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.468 Vali Acc: 0.862 Test Loss: 0.468 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.1848502159118652
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.470 Vali Acc: 0.862 Test Loss: 0.470 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 3.2455737590789795
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.477 Vali Acc: 0.862 Test Loss: 0.477 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.3750667572021484
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.475 Vali Acc: 0.862 Test Loss: 0.475 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.640561103820801
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.472 Vali Acc: 0.855 Test Loss: 0.472 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df128_ma42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 269444
model size : 3.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df128_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.5101213455200195
Epoch: 1, Steps: 9 | Train Loss: 1.417 Vali Loss: 1.352 Vali Acc: 0.355 Test Loss: 1.352 Test Acc: 0.355
Validation loss decreased (inf --> -0.355059).  Saving model ...
Epoch: 2 cost time: 3.2526166439056396
Epoch: 2, Steps: 9 | Train Loss: 1.280 Vali Loss: 1.239 Vali Acc: 0.471 Test Loss: 1.239 Test Acc: 0.471
Validation loss decreased (-0.355059 --> -0.471002).  Saving model ...
Epoch: 3 cost time: 3.242800712585449
Epoch: 3, Steps: 9 | Train Loss: 1.039 Vali Loss: 1.095 Vali Acc: 0.630 Test Loss: 1.095 Test Acc: 0.630
Validation loss decreased (-0.471002 --> -0.630424).  Saving model ...
Epoch: 4 cost time: 3.428330421447754
Epoch: 4, Steps: 9 | Train Loss: 0.805 Vali Loss: 0.965 Vali Acc: 0.717 Test Loss: 0.965 Test Acc: 0.717
Validation loss decreased (-0.630424 --> -0.717382).  Saving model ...
Epoch: 5 cost time: 3.1970620155334473
Epoch: 5, Steps: 9 | Train Loss: 0.613 Vali Loss: 0.885 Vali Acc: 0.746 Test Loss: 0.885 Test Acc: 0.746
Validation loss decreased (-0.717382 --> -0.746368).  Saving model ...
Epoch: 6 cost time: 3.2667489051818848
Epoch: 6, Steps: 9 | Train Loss: 0.458 Vali Loss: 0.779 Vali Acc: 0.775 Test Loss: 0.779 Test Acc: 0.775
Validation loss decreased (-0.746368 --> -0.775355).  Saving model ...
Epoch: 7 cost time: 3.30269455909729
Epoch: 7, Steps: 9 | Train Loss: 0.319 Vali Loss: 0.670 Vali Acc: 0.797 Test Loss: 0.670 Test Acc: 0.797
Validation loss decreased (-0.775355 --> -0.797095).  Saving model ...
Epoch: 8 cost time: 3.438474178314209
Epoch: 8, Steps: 9 | Train Loss: 0.219 Vali Loss: 0.615 Vali Acc: 0.812 Test Loss: 0.615 Test Acc: 0.812
Validation loss decreased (-0.797095 --> -0.811588).  Saving model ...
Epoch: 9 cost time: 3.3584234714508057
Epoch: 9, Steps: 9 | Train Loss: 0.157 Vali Loss: 0.536 Vali Acc: 0.862 Test Loss: 0.536 Test Acc: 0.862
Validation loss decreased (-0.811588 --> -0.862313).  Saving model ...
Epoch: 10 cost time: 3.4682791233062744
Epoch: 10, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.514 Vali Acc: 0.870 Test Loss: 0.514 Test Acc: 0.870
Validation loss decreased (-0.862313 --> -0.869560).  Saving model ...
Epoch: 11 cost time: 3.466768503189087
Epoch: 11, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.481 Vali Acc: 0.855 Test Loss: 0.481 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.0934784412384033
Epoch: 12, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.413 Vali Acc: 0.891 Test Loss: 0.413 Test Acc: 0.891
Validation loss decreased (-0.869560 --> -0.891300).  Saving model ...
Epoch: 13 cost time: 3.5456249713897705
Epoch: 13, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.432 Vali Acc: 0.884 Test Loss: 0.432 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.6279306411743164
Epoch: 14, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.429 Vali Acc: 0.884 Test Loss: 0.429 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.3573379516601562
Epoch: 15, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.392 Vali Acc: 0.899 Test Loss: 0.392 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898547).  Saving model ...
Epoch: 16 cost time: 3.431295156478882
Epoch: 16, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.395 Vali Acc: 0.891 Test Loss: 0.395 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.5239109992980957
Epoch: 17, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.392 Vali Acc: 0.884 Test Loss: 0.392 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.3920981884002686
Epoch: 18, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.375 Vali Acc: 0.899 Test Loss: 0.375 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 19 cost time: 3.455976963043213
Epoch: 19, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.370 Vali Acc: 0.899 Test Loss: 0.370 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 20 cost time: 3.374828577041626
Epoch: 20, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.372 Vali Acc: 0.906 Test Loss: 0.372 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905793).  Saving model ...
Epoch: 21 cost time: 3.4850962162017822
Epoch: 21, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.377 Vali Acc: 0.906 Test Loss: 0.377 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.2365217208862305
Epoch: 22, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.365 Vali Acc: 0.913 Test Loss: 0.365 Test Acc: 0.913
Validation loss decreased (-0.905793 --> -0.913040).  Saving model ...
Epoch: 23 cost time: 3.570343494415283
Epoch: 23, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.363 Vali Acc: 0.920 Test Loss: 0.363 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920286).  Saving model ...
Epoch: 24 cost time: 3.2165369987487793
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.360 Vali Acc: 0.913 Test Loss: 0.360 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.169997453689575
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.373 Vali Acc: 0.913 Test Loss: 0.373 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.304684638977051
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.369 Vali Acc: 0.913 Test Loss: 0.369 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.992309331893921
Epoch: 27, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.360 Vali Acc: 0.920 Test Loss: 0.360 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920286).  Saving model ...
Epoch: 28 cost time: 3.176297664642334
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.361 Vali Acc: 0.920 Test Loss: 0.361 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.969809055328369
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.367 Vali Acc: 0.913 Test Loss: 0.367 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.962801933288574
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.370 Vali Acc: 0.913 Test Loss: 0.370 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.2506721019744873
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.350 Vali Acc: 0.920 Test Loss: 0.350 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920286).  Saving model ...
Epoch: 32 cost time: 3.3015244007110596
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.342 Vali Acc: 0.920 Test Loss: 0.342 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920286).  Saving model ...
Epoch: 33 cost time: 3.2571020126342773
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.344 Vali Acc: 0.920 Test Loss: 0.344 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.3081905841827393
Epoch: 34, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.350 Vali Acc: 0.920 Test Loss: 0.350 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.198038339614868
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.351 Vali Acc: 0.920 Test Loss: 0.351 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.2943782806396484
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.351 Vali Acc: 0.920 Test Loss: 0.351 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.156954765319824
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.347 Vali Acc: 0.920 Test Loss: 0.347 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.096989154815674
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.351 Vali Acc: 0.920 Test Loss: 0.351 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.2860348224639893
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.355 Vali Acc: 0.913 Test Loss: 0.355 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 2.92718505859375
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.348 Vali Acc: 0.920 Test Loss: 0.348 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 3.1066904067993164
Epoch: 41, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.344 Vali Acc: 0.920 Test Loss: 0.344 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 3.3661890029907227
Epoch: 42, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.342 Vali Acc: 0.920 Test Loss: 0.342 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920286).  Saving model ...
Epoch: 43 cost time: 3.5370569229125977
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.337 Vali Acc: 0.920 Test Loss: 0.337 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920286).  Saving model ...
Epoch: 44 cost time: 3.610241413116455
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.337 Vali Acc: 0.920 Test Loss: 0.337 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920286).  Saving model ...
Epoch: 45 cost time: 3.367999315261841
Epoch: 45, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.344 Vali Acc: 0.920 Test Loss: 0.344 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.55051326751709
Epoch: 46, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.345 Vali Acc: 0.920 Test Loss: 0.345 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.272164821624756
Epoch: 47, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.346 Vali Acc: 0.920 Test Loss: 0.346 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.37076735496521
Epoch: 48, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.351 Vali Acc: 0.920 Test Loss: 0.351 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 3.1833691596984863
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.342 Vali Acc: 0.920 Test Loss: 0.342 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 2.991481304168701
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.349 Vali Acc: 0.920 Test Loss: 0.349 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 3.155247211456299
Epoch: 51, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.346 Vali Acc: 0.920 Test Loss: 0.346 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 3.2241060733795166
Epoch: 52, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.341 Vali Acc: 0.920 Test Loss: 0.341 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 3.1757233142852783
Epoch: 53, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.333 Vali Acc: 0.920 Test Loss: 0.333 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920287).  Saving model ...
Epoch: 54 cost time: 3.0994575023651123
Epoch: 54, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.330 Vali Acc: 0.920 Test Loss: 0.330 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 55 cost time: 3.2183871269226074
Epoch: 55, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.332 Vali Acc: 0.920 Test Loss: 0.332 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 3.349048614501953
Epoch: 56, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.332 Vali Acc: 0.920 Test Loss: 0.332 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 3.6087098121643066
Epoch: 57, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.332 Vali Acc: 0.920 Test Loss: 0.332 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 3.384793996810913
Epoch: 58, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.332 Vali Acc: 0.920 Test Loss: 0.332 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 3.376946449279785
Epoch: 59, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.335 Vali Acc: 0.920 Test Loss: 0.335 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 3.2237517833709717
Epoch: 60, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.333 Vali Acc: 0.920 Test Loss: 0.333 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 3.4566969871520996
Epoch: 61, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.335 Vali Acc: 0.920 Test Loss: 0.335 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 2.913139820098877
Epoch: 62, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.333 Vali Acc: 0.920 Test Loss: 0.333 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 3.047942638397217
Epoch: 63, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.333 Vali Acc: 0.920 Test Loss: 0.333 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 3.5024449825286865
Epoch: 64, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.334 Vali Acc: 0.920 Test Loss: 0.334 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df128_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 269444
model size : 3.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df128_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.453855037689209
Epoch: 1, Steps: 9 | Train Loss: 1.411 Vali Loss: 1.373 Vali Acc: 0.312 Test Loss: 1.373 Test Acc: 0.312
Validation loss decreased (inf --> -0.311580).  Saving model ...
Epoch: 2 cost time: 3.056283712387085
Epoch: 2, Steps: 9 | Train Loss: 1.283 Vali Loss: 1.261 Vali Acc: 0.449 Test Loss: 1.261 Test Acc: 0.449
Validation loss decreased (-0.311580 --> -0.449263).  Saving model ...
Epoch: 3 cost time: 3.522979736328125
Epoch: 3, Steps: 9 | Train Loss: 1.051 Vali Loss: 1.124 Vali Acc: 0.551 Test Loss: 1.124 Test Acc: 0.551
Validation loss decreased (-0.449263 --> -0.550713).  Saving model ...
Epoch: 4 cost time: 3.4347004890441895
Epoch: 4, Steps: 9 | Train Loss: 0.842 Vali Loss: 0.993 Vali Acc: 0.623 Test Loss: 0.993 Test Acc: 0.623
Validation loss decreased (-0.550713 --> -0.623178).  Saving model ...
Epoch: 5 cost time: 3.638300895690918
Epoch: 5, Steps: 9 | Train Loss: 0.652 Vali Loss: 0.928 Vali Acc: 0.645 Test Loss: 0.928 Test Acc: 0.645
Validation loss decreased (-0.623178 --> -0.644918).  Saving model ...
Epoch: 6 cost time: 3.4489376544952393
Epoch: 6, Steps: 9 | Train Loss: 0.498 Vali Loss: 0.837 Vali Acc: 0.688 Test Loss: 0.837 Test Acc: 0.688
Validation loss decreased (-0.644918 --> -0.688397).  Saving model ...
Epoch: 7 cost time: 3.4581422805786133
Epoch: 7, Steps: 9 | Train Loss: 0.342 Vali Loss: 0.719 Vali Acc: 0.754 Test Loss: 0.719 Test Acc: 0.754
Validation loss decreased (-0.688397 --> -0.753616).  Saving model ...
Epoch: 8 cost time: 3.476499557495117
Epoch: 8, Steps: 9 | Train Loss: 0.251 Vali Loss: 0.706 Vali Acc: 0.717 Test Loss: 0.706 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.170154333114624
Epoch: 9, Steps: 9 | Train Loss: 0.195 Vali Loss: 0.639 Vali Acc: 0.732 Test Loss: 0.639 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.6436760425567627
Epoch: 10, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.609 Vali Acc: 0.732 Test Loss: 0.609 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.2908384799957275
Epoch: 11, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.598 Vali Acc: 0.732 Test Loss: 0.598 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.238948345184326
Epoch: 12, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.533 Vali Acc: 0.761 Test Loss: 0.533 Test Acc: 0.761
Validation loss decreased (-0.753616 --> -0.760864).  Saving model ...
Epoch: 13 cost time: 3.3524997234344482
Epoch: 13, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.527 Vali Acc: 0.746 Test Loss: 0.527 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.4251554012298584
Epoch: 14, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.546 Vali Acc: 0.746 Test Loss: 0.546 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.4841363430023193
Epoch: 15, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.534 Vali Acc: 0.761 Test Loss: 0.534 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.5080957412719727
Epoch: 16, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.522 Vali Acc: 0.754 Test Loss: 0.522 Test Acc: 0.754
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.538994789123535
Epoch: 17, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.494 Vali Acc: 0.783 Test Loss: 0.494 Test Acc: 0.783
Validation loss decreased (-0.760864 --> -0.782604).  Saving model ...
Epoch: 18 cost time: 3.408707618713379
Epoch: 18, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.492 Vali Acc: 0.783 Test Loss: 0.492 Test Acc: 0.783
Validation loss decreased (-0.782604 --> -0.782604).  Saving model ...
Epoch: 19 cost time: 3.6201813220977783
Epoch: 19, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.519 Vali Acc: 0.754 Test Loss: 0.519 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.87178635597229
Epoch: 20, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.497 Vali Acc: 0.783 Test Loss: 0.497 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.466378688812256
Epoch: 21, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.484 Vali Acc: 0.797 Test Loss: 0.484 Test Acc: 0.797
Validation loss decreased (-0.782604 --> -0.797097).  Saving model ...
Epoch: 22 cost time: 3.683943033218384
Epoch: 22, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.498 Vali Acc: 0.790 Test Loss: 0.498 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.4417314529418945
Epoch: 23, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.497 Vali Acc: 0.768 Test Loss: 0.497 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.6519598960876465
Epoch: 24, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.483 Vali Acc: 0.790 Test Loss: 0.483 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.8126139640808105
Epoch: 25, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.504 Vali Acc: 0.783 Test Loss: 0.504 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.5349373817443848
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.492 Vali Acc: 0.812 Test Loss: 0.492 Test Acc: 0.812
Validation loss decreased (-0.797097 --> -0.811589).  Saving model ...
Epoch: 27 cost time: 3.509237289428711
Epoch: 27, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.495 Vali Acc: 0.804 Test Loss: 0.495 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.7521941661834717
Epoch: 28, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.499 Vali Acc: 0.797 Test Loss: 0.499 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.879293203353882
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.492 Vali Acc: 0.804 Test Loss: 0.492 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.8559365272521973
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.502 Vali Acc: 0.790 Test Loss: 0.502 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.4128522872924805
Epoch: 31, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.497 Vali Acc: 0.797 Test Loss: 0.497 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.4415791034698486
Epoch: 32, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.482 Vali Acc: 0.826 Test Loss: 0.482 Test Acc: 0.826
Validation loss decreased (-0.811589 --> -0.826082).  Saving model ...
Epoch: 33 cost time: 3.3700146675109863
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.477 Vali Acc: 0.826 Test Loss: 0.477 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 34 cost time: 3.1061325073242188
Epoch: 34, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.473 Vali Acc: 0.819 Test Loss: 0.473 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.586930990219116
Epoch: 35, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.473 Vali Acc: 0.819 Test Loss: 0.473 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.3789525032043457
Epoch: 36, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.488 Vali Acc: 0.797 Test Loss: 0.488 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.1553702354431152
Epoch: 37, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.491 Vali Acc: 0.812 Test Loss: 0.491 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.046830415725708
Epoch: 38, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.472 Vali Acc: 0.826 Test Loss: 0.472 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 39 cost time: 3.7286412715911865
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.469 Vali Acc: 0.826 Test Loss: 0.469 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 40 cost time: 3.566511631011963
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.475 Vali Acc: 0.819 Test Loss: 0.475 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.4980039596557617
Epoch: 41, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.484 Vali Acc: 0.819 Test Loss: 0.484 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.5215678215026855
Epoch: 42, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.481 Vali Acc: 0.819 Test Loss: 0.481 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.551835060119629
Epoch: 43, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.473 Vali Acc: 0.833 Test Loss: 0.473 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833329).  Saving model ...
Epoch: 44 cost time: 3.6820719242095947
Epoch: 44, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.469 Vali Acc: 0.833 Test Loss: 0.469 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 45 cost time: 3.4599597454071045
Epoch: 45, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.469 Vali Acc: 0.833 Test Loss: 0.469 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 46 cost time: 3.5474891662597656
Epoch: 46, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.471 Vali Acc: 0.833 Test Loss: 0.471 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.3276844024658203
Epoch: 47, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.485 Vali Acc: 0.819 Test Loss: 0.485 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 3.4753851890563965
Epoch: 48, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.481 Vali Acc: 0.826 Test Loss: 0.481 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 3.1947574615478516
Epoch: 49, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.464 Vali Acc: 0.833 Test Loss: 0.464 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 50 cost time: 3.4121952056884766
Epoch: 50, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.465 Vali Acc: 0.826 Test Loss: 0.465 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 3.5908279418945312
Epoch: 51, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.465 Vali Acc: 0.826 Test Loss: 0.465 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 3.798086404800415
Epoch: 52, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.474 Vali Acc: 0.819 Test Loss: 0.474 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 3.775207281112671
Epoch: 53, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.474 Vali Acc: 0.826 Test Loss: 0.474 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 3.843419313430786
Epoch: 54, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.469 Vali Acc: 0.826 Test Loss: 0.469 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 3.613399028778076
Epoch: 55, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.468 Vali Acc: 0.826 Test Loss: 0.468 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 3.558004379272461
Epoch: 56, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.469 Vali Acc: 0.819 Test Loss: 0.469 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 3.7423791885375977
Epoch: 57, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.467 Vali Acc: 0.819 Test Loss: 0.467 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 3.427603006362915
Epoch: 58, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.466 Vali Acc: 0.819 Test Loss: 0.466 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 3.6321327686309814
Epoch: 59, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.471 Vali Acc: 0.826 Test Loss: 0.471 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df128_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 269444
model size : 3.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df128_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.571300506591797
Epoch: 1, Steps: 9 | Train Loss: 1.399 Vali Loss: 1.329 Vali Acc: 0.384 Test Loss: 1.329 Test Acc: 0.384
Validation loss decreased (inf --> -0.384045).  Saving model ...
Epoch: 2 cost time: 3.0354340076446533
Epoch: 2, Steps: 9 | Train Loss: 1.281 Vali Loss: 1.216 Vali Acc: 0.493 Test Loss: 1.216 Test Acc: 0.493
Validation loss decreased (-0.384045 --> -0.492741).  Saving model ...
Epoch: 3 cost time: 3.211395502090454
Epoch: 3, Steps: 9 | Train Loss: 1.051 Vali Loss: 1.095 Vali Acc: 0.565 Test Loss: 1.095 Test Acc: 0.565
Validation loss decreased (-0.492741 --> -0.565206).  Saving model ...
Epoch: 4 cost time: 3.1530120372772217
Epoch: 4, Steps: 9 | Train Loss: 0.825 Vali Loss: 0.990 Vali Acc: 0.609 Test Loss: 0.990 Test Acc: 0.609
Validation loss decreased (-0.565206 --> -0.608686).  Saving model ...
Epoch: 5 cost time: 3.0991249084472656
Epoch: 5, Steps: 9 | Train Loss: 0.654 Vali Loss: 0.930 Vali Acc: 0.638 Test Loss: 0.930 Test Acc: 0.638
Validation loss decreased (-0.608686 --> -0.637672).  Saving model ...
Epoch: 6 cost time: 3.4328060150146484
Epoch: 6, Steps: 9 | Train Loss: 0.503 Vali Loss: 0.889 Vali Acc: 0.667 Test Loss: 0.889 Test Acc: 0.667
Validation loss decreased (-0.637672 --> -0.666658).  Saving model ...
Epoch: 7 cost time: 3.4170963764190674
Epoch: 7, Steps: 9 | Train Loss: 0.361 Vali Loss: 0.836 Vali Acc: 0.667 Test Loss: 0.836 Test Acc: 0.667
Validation loss decreased (-0.666658 --> -0.666658).  Saving model ...
Epoch: 8 cost time: 3.2461440563201904
Epoch: 8, Steps: 9 | Train Loss: 0.261 Vali Loss: 0.805 Vali Acc: 0.681 Test Loss: 0.805 Test Acc: 0.681
Validation loss decreased (-0.666658 --> -0.681151).  Saving model ...
Epoch: 9 cost time: 3.1306750774383545
Epoch: 9, Steps: 9 | Train Loss: 0.217 Vali Loss: 0.795 Vali Acc: 0.703 Test Loss: 0.795 Test Acc: 0.703
Validation loss decreased (-0.681151 --> -0.702891).  Saving model ...
Epoch: 10 cost time: 2.913084030151367
Epoch: 10, Steps: 9 | Train Loss: 0.148 Vali Loss: 0.764 Vali Acc: 0.725 Test Loss: 0.764 Test Acc: 0.725
Validation loss decreased (-0.702891 --> -0.724630).  Saving model ...
Epoch: 11 cost time: 2.9987246990203857
Epoch: 11, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.759 Vali Acc: 0.732 Test Loss: 0.759 Test Acc: 0.732
Validation loss decreased (-0.724630 --> -0.731876).  Saving model ...
Epoch: 12 cost time: 3.1391148567199707
Epoch: 12, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.731 Vali Acc: 0.754 Test Loss: 0.731 Test Acc: 0.754
Validation loss decreased (-0.731876 --> -0.753616).  Saving model ...
Epoch: 13 cost time: 3.0965113639831543
Epoch: 13, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.740 Vali Acc: 0.754 Test Loss: 0.740 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.221001625061035
Epoch: 14, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.753 Vali Acc: 0.725 Test Loss: 0.753 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.2991111278533936
Epoch: 15, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.749 Vali Acc: 0.746 Test Loss: 0.749 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.3320491313934326
Epoch: 16, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.740 Vali Acc: 0.754 Test Loss: 0.740 Test Acc: 0.754
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.2428085803985596
Epoch: 17, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.764 Vali Acc: 0.746 Test Loss: 0.764 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.2693886756896973
Epoch: 18, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.761 Vali Acc: 0.761 Test Loss: 0.761 Test Acc: 0.761
Validation loss decreased (-0.753616 --> -0.760862).  Saving model ...
Epoch: 19 cost time: 3.5467097759246826
Epoch: 19, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.760 Vali Acc: 0.754 Test Loss: 0.760 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.436264991760254
Epoch: 20, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.770 Vali Acc: 0.754 Test Loss: 0.770 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.471884250640869
Epoch: 21, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.753 Vali Acc: 0.754 Test Loss: 0.753 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.3766024112701416
Epoch: 22, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.738 Vali Acc: 0.754 Test Loss: 0.738 Test Acc: 0.754
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.2849233150482178
Epoch: 23, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.759 Vali Acc: 0.754 Test Loss: 0.759 Test Acc: 0.754
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.1148431301116943
Epoch: 24, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.767 Vali Acc: 0.754 Test Loss: 0.767 Test Acc: 0.754
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.157175302505493
Epoch: 25, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.762 Vali Acc: 0.761 Test Loss: 0.762 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.0557966232299805
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.758 Vali Acc: 0.754 Test Loss: 0.758 Test Acc: 0.754
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.3450045585632324
Epoch: 27, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.766 Vali Acc: 0.754 Test Loss: 0.766 Test Acc: 0.754
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.9985179901123047
Epoch: 28, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.770 Vali Acc: 0.754 Test Loss: 0.770 Test Acc: 0.754
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df128_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7608695652173914
model parameter : 269444
model size : 3.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.741259336471558
Epoch: 1, Steps: 9 | Train Loss: 1.396 Vali Loss: 1.399 Vali Acc: 0.261 Test Loss: 1.399 Test Acc: 0.261
Validation loss decreased (inf --> -0.260856).  Saving model ...
Epoch: 2 cost time: 3.474914312362671
Epoch: 2, Steps: 9 | Train Loss: 1.340 Vali Loss: 1.376 Vali Acc: 0.246 Test Loss: 1.376 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.3223814964294434
Epoch: 3, Steps: 9 | Train Loss: 1.173 Vali Loss: 1.332 Vali Acc: 0.319 Test Loss: 1.332 Test Acc: 0.319
Validation loss decreased (-0.260856 --> -0.318827).  Saving model ...
Epoch: 4 cost time: 3.48895001411438
Epoch: 4, Steps: 9 | Train Loss: 0.997 Vali Loss: 1.295 Vali Acc: 0.348 Test Loss: 1.295 Test Acc: 0.348
Validation loss decreased (-0.318827 --> -0.347813).  Saving model ...
Epoch: 5 cost time: 3.333073616027832
Epoch: 5, Steps: 9 | Train Loss: 0.833 Vali Loss: 1.271 Vali Acc: 0.413 Test Loss: 1.271 Test Acc: 0.413
Validation loss decreased (-0.347813 --> -0.413031).  Saving model ...
Epoch: 6 cost time: 3.14861798286438
Epoch: 6, Steps: 9 | Train Loss: 0.697 Vali Loss: 1.236 Vali Acc: 0.486 Test Loss: 1.236 Test Acc: 0.486
Validation loss decreased (-0.413031 --> -0.485495).  Saving model ...
Epoch: 7 cost time: 3.2016453742980957
Epoch: 7, Steps: 9 | Train Loss: 0.528 Vali Loss: 1.230 Vali Acc: 0.464 Test Loss: 1.230 Test Acc: 0.464
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.0623538494110107
Epoch: 8, Steps: 9 | Train Loss: 0.453 Vali Loss: 1.225 Vali Acc: 0.457 Test Loss: 1.225 Test Acc: 0.457
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.0373117923736572
Epoch: 9, Steps: 9 | Train Loss: 0.348 Vali Loss: 1.217 Vali Acc: 0.464 Test Loss: 1.217 Test Acc: 0.464
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.2164900302886963
Epoch: 10, Steps: 9 | Train Loss: 0.254 Vali Loss: 1.275 Vali Acc: 0.471 Test Loss: 1.275 Test Acc: 0.471
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.0995864868164062
Epoch: 11, Steps: 9 | Train Loss: 0.194 Vali Loss: 1.219 Vali Acc: 0.486 Test Loss: 1.219 Test Acc: 0.486
Validation loss decreased (-0.485495 --> -0.485495).  Saving model ...
Epoch: 12 cost time: 3.5965325832366943
Epoch: 12, Steps: 9 | Train Loss: 0.131 Vali Loss: 1.347 Vali Acc: 0.457 Test Loss: 1.347 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.359870672225952
Epoch: 13, Steps: 9 | Train Loss: 0.107 Vali Loss: 1.258 Vali Acc: 0.478 Test Loss: 1.258 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.524918794631958
Epoch: 14, Steps: 9 | Train Loss: 0.073 Vali Loss: 1.290 Vali Acc: 0.478 Test Loss: 1.290 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.83663010597229
Epoch: 15, Steps: 9 | Train Loss: 0.056 Vali Loss: 1.322 Vali Acc: 0.478 Test Loss: 1.322 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.399127721786499
Epoch: 16, Steps: 9 | Train Loss: 0.041 Vali Loss: 1.333 Vali Acc: 0.486 Test Loss: 1.333 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.7881417274475098
Epoch: 17, Steps: 9 | Train Loss: 0.035 Vali Loss: 1.349 Vali Acc: 0.493 Test Loss: 1.349 Test Acc: 0.493
Validation loss decreased (-0.485495 --> -0.492740).  Saving model ...
Epoch: 18 cost time: 3.3595354557037354
Epoch: 18, Steps: 9 | Train Loss: 0.034 Vali Loss: 1.369 Vali Acc: 0.500 Test Loss: 1.369 Test Acc: 0.500
Validation loss decreased (-0.492740 --> -0.499986).  Saving model ...
Epoch: 19 cost time: 3.3626015186309814
Epoch: 19, Steps: 9 | Train Loss: 0.024 Vali Loss: 1.336 Vali Acc: 0.500 Test Loss: 1.336 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499987).  Saving model ...
Epoch: 20 cost time: 3.11031436920166
Epoch: 20, Steps: 9 | Train Loss: 0.021 Vali Loss: 1.350 Vali Acc: 0.507 Test Loss: 1.350 Test Acc: 0.507
Validation loss decreased (-0.499987 --> -0.507233).  Saving model ...
Epoch: 21 cost time: 3.355325222015381
Epoch: 21, Steps: 9 | Train Loss: 0.017 Vali Loss: 1.315 Vali Acc: 0.514 Test Loss: 1.315 Test Acc: 0.514
Validation loss decreased (-0.507233 --> -0.514480).  Saving model ...
Epoch: 22 cost time: 3.381417751312256
Epoch: 22, Steps: 9 | Train Loss: 0.014 Vali Loss: 1.323 Vali Acc: 0.522 Test Loss: 1.323 Test Acc: 0.522
Validation loss decreased (-0.514480 --> -0.521726).  Saving model ...
Epoch: 23 cost time: 3.340266227722168
Epoch: 23, Steps: 9 | Train Loss: 0.013 Vali Loss: 1.332 Vali Acc: 0.514 Test Loss: 1.332 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.4369778633117676
Epoch: 24, Steps: 9 | Train Loss: 0.013 Vali Loss: 1.323 Vali Acc: 0.522 Test Loss: 1.323 Test Acc: 0.522
Validation loss decreased (-0.521726 --> -0.521726).  Saving model ...
Epoch: 25 cost time: 3.6050662994384766
Epoch: 25, Steps: 9 | Train Loss: 0.012 Vali Loss: 1.384 Vali Acc: 0.522 Test Loss: 1.384 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.665848970413208
Epoch: 26, Steps: 9 | Train Loss: 0.010 Vali Loss: 1.348 Vali Acc: 0.536 Test Loss: 1.348 Test Acc: 0.536
Validation loss decreased (-0.521726 --> -0.536218).  Saving model ...
Epoch: 27 cost time: 3.515211343765259
Epoch: 27, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.304 Vali Acc: 0.543 Test Loss: 1.304 Test Acc: 0.543
Validation loss decreased (-0.536218 --> -0.543465).  Saving model ...
Epoch: 28 cost time: 3.3722288608551025
Epoch: 28, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.328 Vali Acc: 0.565 Test Loss: 1.328 Test Acc: 0.565
Validation loss decreased (-0.543465 --> -0.565204).  Saving model ...
Epoch: 29 cost time: 3.420440196990967
Epoch: 29, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.382 Vali Acc: 0.536 Test Loss: 1.382 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.187753200531006
Epoch: 30, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.324 Vali Acc: 0.558 Test Loss: 1.324 Test Acc: 0.558
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.519801378250122
Epoch: 31, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.339 Vali Acc: 0.565 Test Loss: 1.339 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.4329733848571777
Epoch: 32, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.331 Vali Acc: 0.565 Test Loss: 1.331 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.2977285385131836
Epoch: 33, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.352 Vali Acc: 0.558 Test Loss: 1.352 Test Acc: 0.558
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.6536495685577393
Epoch: 34, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.366 Vali Acc: 0.558 Test Loss: 1.366 Test Acc: 0.558
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.4182779788970947
Epoch: 35, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.355 Vali Acc: 0.565 Test Loss: 1.355 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 3.418316602706909
Epoch: 36, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.344 Vali Acc: 0.565 Test Loss: 1.344 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.5319669246673584
Epoch: 37, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.348 Vali Acc: 0.565 Test Loss: 1.348 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.493265151977539
Epoch: 38, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.333 Vali Acc: 0.580 Test Loss: 1.333 Test Acc: 0.580
Validation loss decreased (-0.565204 --> -0.579697).  Saving model ...
Epoch: 39 cost time: 3.376652240753174
Epoch: 39, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.334 Vali Acc: 0.587 Test Loss: 1.334 Test Acc: 0.587
Validation loss decreased (-0.579697 --> -0.586943).  Saving model ...
Epoch: 40 cost time: 3.277649402618408
Epoch: 40, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.330 Vali Acc: 0.587 Test Loss: 1.330 Test Acc: 0.587
Validation loss decreased (-0.586943 --> -0.586943).  Saving model ...
Epoch: 41 cost time: 3.5060479640960693
Epoch: 41, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.302 Vali Acc: 0.587 Test Loss: 1.302 Test Acc: 0.587
Validation loss decreased (-0.586943 --> -0.586943).  Saving model ...
Epoch: 42 cost time: 3.482865333557129
Epoch: 42, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.309 Vali Acc: 0.580 Test Loss: 1.309 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.4206295013427734
Epoch: 43, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.333 Vali Acc: 0.580 Test Loss: 1.333 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.1958494186401367
Epoch: 44, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.349 Vali Acc: 0.580 Test Loss: 1.349 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.0435259342193604
Epoch: 45, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.347 Vali Acc: 0.580 Test Loss: 1.347 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 3.0657570362091064
Epoch: 46, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.344 Vali Acc: 0.580 Test Loss: 1.344 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 3.2137839794158936
Epoch: 47, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.312 Vali Acc: 0.594 Test Loss: 1.312 Test Acc: 0.594
Validation loss decreased (-0.586943 --> -0.594190).  Saving model ...
Epoch: 48 cost time: 3.055616617202759
Epoch: 48, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.309 Vali Acc: 0.594 Test Loss: 1.309 Test Acc: 0.594
Validation loss decreased (-0.594190 --> -0.594190).  Saving model ...
Epoch: 49 cost time: 3.217122793197632
Epoch: 49, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.328 Vali Acc: 0.594 Test Loss: 1.328 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.327446937561035
Epoch: 50, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.327 Vali Acc: 0.587 Test Loss: 1.327 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 3.466384172439575
Epoch: 51, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.334 Vali Acc: 0.587 Test Loss: 1.334 Test Acc: 0.587
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 3.2971105575561523
Epoch: 52, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.338 Vali Acc: 0.587 Test Loss: 1.338 Test Acc: 0.587
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 3.6279618740081787
Epoch: 53, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.343 Vali Acc: 0.580 Test Loss: 1.343 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 3.340376138687134
Epoch: 54, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.350 Vali Acc: 0.580 Test Loss: 1.350 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 3.424037456512451
Epoch: 55, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.365 Vali Acc: 0.594 Test Loss: 1.365 Test Acc: 0.594
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 3.4368538856506348
Epoch: 56, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.361 Vali Acc: 0.594 Test Loss: 1.361 Test Acc: 0.594
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 3.3497707843780518
Epoch: 57, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.355 Vali Acc: 0.594 Test Loss: 1.355 Test Acc: 0.594
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 2.9368317127227783
Epoch: 58, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.354 Vali Acc: 0.594 Test Loss: 1.354 Test Acc: 0.594
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5942028985507246
model parameter : 269444
model size : 3.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.517786502838135
Epoch: 1, Steps: 9 | Train Loss: 1.397 Vali Loss: 1.445 Vali Acc: 0.268 Test Loss: 1.445 Test Acc: 0.268
Validation loss decreased (inf --> -0.268101).  Saving model ...
Epoch: 2 cost time: 3.488752603530884
Epoch: 2, Steps: 9 | Train Loss: 1.358 Vali Loss: 1.447 Vali Acc: 0.254 Test Loss: 1.447 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.4920144081115723
Epoch: 3, Steps: 9 | Train Loss: 1.232 Vali Loss: 1.443 Vali Acc: 0.283 Test Loss: 1.443 Test Acc: 0.283
Validation loss decreased (-0.268101 --> -0.282594).  Saving model ...
Epoch: 4 cost time: 3.9229421615600586
Epoch: 4, Steps: 9 | Train Loss: 1.135 Vali Loss: 1.451 Vali Acc: 0.275 Test Loss: 1.451 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.4259121417999268
Epoch: 5, Steps: 9 | Train Loss: 1.058 Vali Loss: 1.474 Vali Acc: 0.275 Test Loss: 1.474 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.886871099472046
Epoch: 6, Steps: 9 | Train Loss: 0.970 Vali Loss: 1.452 Vali Acc: 0.326 Test Loss: 1.452 Test Acc: 0.326
Validation loss decreased (-0.282594 --> -0.326072).  Saving model ...
Epoch: 7 cost time: 3.4827558994293213
Epoch: 7, Steps: 9 | Train Loss: 0.798 Vali Loss: 1.489 Vali Acc: 0.297 Test Loss: 1.489 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.7397589683532715
Epoch: 8, Steps: 9 | Train Loss: 0.689 Vali Loss: 1.596 Vali Acc: 0.312 Test Loss: 1.596 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.535942792892456
Epoch: 9, Steps: 9 | Train Loss: 0.602 Vali Loss: 1.632 Vali Acc: 0.312 Test Loss: 1.632 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.5313751697540283
Epoch: 10, Steps: 9 | Train Loss: 0.470 Vali Loss: 1.766 Vali Acc: 0.326 Test Loss: 1.766 Test Acc: 0.326
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.2172324657440186
Epoch: 11, Steps: 9 | Train Loss: 0.384 Vali Loss: 1.876 Vali Acc: 0.304 Test Loss: 1.876 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.933938980102539
Epoch: 12, Steps: 9 | Train Loss: 0.294 Vali Loss: 1.984 Vali Acc: 0.304 Test Loss: 1.984 Test Acc: 0.304
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.501030921936035
Epoch: 13, Steps: 9 | Train Loss: 0.240 Vali Loss: 2.074 Vali Acc: 0.304 Test Loss: 2.074 Test Acc: 0.304
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.4927399158477783
Epoch: 14, Steps: 9 | Train Loss: 0.184 Vali Loss: 2.189 Vali Acc: 0.312 Test Loss: 2.189 Test Acc: 0.312
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.720839500427246
Epoch: 15, Steps: 9 | Train Loss: 0.151 Vali Loss: 2.291 Vali Acc: 0.319 Test Loss: 2.291 Test Acc: 0.319
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.397090435028076
Epoch: 16, Steps: 9 | Train Loss: 0.109 Vali Loss: 2.371 Vali Acc: 0.319 Test Loss: 2.371 Test Acc: 0.319
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.32608695652173914
model parameter : 269444
model size : 3.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.805386781692505
Epoch: 1, Steps: 9 | Train Loss: 1.400 Vali Loss: 1.434 Vali Acc: 0.254 Test Loss: 1.434 Test Acc: 0.254
Validation loss decreased (inf --> -0.253609).  Saving model ...
Epoch: 2 cost time: 3.452863931655884
Epoch: 2, Steps: 9 | Train Loss: 1.366 Vali Loss: 1.432 Vali Acc: 0.304 Test Loss: 1.432 Test Acc: 0.304
Validation loss decreased (-0.253609 --> -0.304334).  Saving model ...
Epoch: 3 cost time: 3.2697665691375732
Epoch: 3, Steps: 9 | Train Loss: 1.253 Vali Loss: 1.412 Vali Acc: 0.283 Test Loss: 1.412 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.1013057231903076
Epoch: 4, Steps: 9 | Train Loss: 1.137 Vali Loss: 1.378 Vali Acc: 0.304 Test Loss: 1.378 Test Acc: 0.304
Validation loss decreased (-0.304334 --> -0.304334).  Saving model ...
Epoch: 5 cost time: 2.9225354194641113
Epoch: 5, Steps: 9 | Train Loss: 1.012 Vali Loss: 1.365 Vali Acc: 0.341 Test Loss: 1.365 Test Acc: 0.341
Validation loss decreased (-0.304334 --> -0.340566).  Saving model ...
Epoch: 6 cost time: 3.178528308868408
Epoch: 6, Steps: 9 | Train Loss: 0.897 Vali Loss: 1.323 Vali Acc: 0.319 Test Loss: 1.323 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.3807854652404785
Epoch: 7, Steps: 9 | Train Loss: 0.765 Vali Loss: 1.318 Vali Acc: 0.304 Test Loss: 1.318 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.0506067276000977
Epoch: 8, Steps: 9 | Train Loss: 0.634 Vali Loss: 1.309 Vali Acc: 0.341 Test Loss: 1.309 Test Acc: 0.341
Validation loss decreased (-0.340566 --> -0.340567).  Saving model ...
Epoch: 9 cost time: 3.6657941341400146
Epoch: 9, Steps: 9 | Train Loss: 0.539 Vali Loss: 1.291 Vali Acc: 0.362 Test Loss: 1.291 Test Acc: 0.362
Validation loss decreased (-0.340567 --> -0.362306).  Saving model ...
Epoch: 10 cost time: 3.540379047393799
Epoch: 10, Steps: 9 | Train Loss: 0.413 Vali Loss: 1.365 Vali Acc: 0.312 Test Loss: 1.365 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.3776488304138184
Epoch: 11, Steps: 9 | Train Loss: 0.331 Vali Loss: 1.344 Vali Acc: 0.341 Test Loss: 1.344 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.765882730484009
Epoch: 12, Steps: 9 | Train Loss: 0.242 Vali Loss: 1.402 Vali Acc: 0.341 Test Loss: 1.402 Test Acc: 0.341
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.801940679550171
Epoch: 13, Steps: 9 | Train Loss: 0.185 Vali Loss: 1.420 Vali Acc: 0.370 Test Loss: 1.420 Test Acc: 0.370
Validation loss decreased (-0.362306 --> -0.369551).  Saving model ...
Epoch: 14 cost time: 3.4978270530700684
Epoch: 14, Steps: 9 | Train Loss: 0.144 Vali Loss: 1.406 Vali Acc: 0.355 Test Loss: 1.406 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.393754005432129
Epoch: 15, Steps: 9 | Train Loss: 0.110 Vali Loss: 1.517 Vali Acc: 0.348 Test Loss: 1.517 Test Acc: 0.348
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.283097505569458
Epoch: 16, Steps: 9 | Train Loss: 0.081 Vali Loss: 1.544 Vali Acc: 0.355 Test Loss: 1.544 Test Acc: 0.355
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.3682398796081543
Epoch: 17, Steps: 9 | Train Loss: 0.063 Vali Loss: 1.474 Vali Acc: 0.391 Test Loss: 1.474 Test Acc: 0.391
Validation loss decreased (-0.369551 --> -0.391290).  Saving model ...
Epoch: 18 cost time: 3.522810697555542
Epoch: 18, Steps: 9 | Train Loss: 0.060 Vali Loss: 1.624 Vali Acc: 0.377 Test Loss: 1.624 Test Acc: 0.377
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.2957921028137207
Epoch: 19, Steps: 9 | Train Loss: 0.035 Vali Loss: 1.477 Vali Acc: 0.399 Test Loss: 1.477 Test Acc: 0.399
Validation loss decreased (-0.391290 --> -0.398536).  Saving model ...
Epoch: 20 cost time: 3.2916765213012695
Epoch: 20, Steps: 9 | Train Loss: 0.033 Vali Loss: 1.480 Vali Acc: 0.399 Test Loss: 1.480 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.2677903175354004
Epoch: 21, Steps: 9 | Train Loss: 0.030 Vali Loss: 1.486 Vali Acc: 0.428 Test Loss: 1.486 Test Acc: 0.428
Validation loss decreased (-0.398536 --> -0.427521).  Saving model ...
Epoch: 22 cost time: 3.494537353515625
Epoch: 22, Steps: 9 | Train Loss: 0.025 Vali Loss: 1.529 Vali Acc: 0.406 Test Loss: 1.529 Test Acc: 0.406
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.4185447692871094
Epoch: 23, Steps: 9 | Train Loss: 0.021 Vali Loss: 1.531 Vali Acc: 0.413 Test Loss: 1.531 Test Acc: 0.413
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.4332690238952637
Epoch: 24, Steps: 9 | Train Loss: 0.017 Vali Loss: 1.496 Vali Acc: 0.420 Test Loss: 1.496 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.4987735748291016
Epoch: 25, Steps: 9 | Train Loss: 0.014 Vali Loss: 1.420 Vali Acc: 0.442 Test Loss: 1.420 Test Acc: 0.442
Validation loss decreased (-0.427521 --> -0.442015).  Saving model ...
Epoch: 26 cost time: 3.5609922409057617
Epoch: 26, Steps: 9 | Train Loss: 0.012 Vali Loss: 1.490 Vali Acc: 0.442 Test Loss: 1.490 Test Acc: 0.442
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.647446632385254
Epoch: 27, Steps: 9 | Train Loss: 0.011 Vali Loss: 1.581 Vali Acc: 0.435 Test Loss: 1.581 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.4587202072143555
Epoch: 28, Steps: 9 | Train Loss: 0.010 Vali Loss: 1.543 Vali Acc: 0.435 Test Loss: 1.543 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.2103493213653564
Epoch: 29, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.478 Vali Acc: 0.442 Test Loss: 1.478 Test Acc: 0.442
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.058633804321289
Epoch: 30, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.460 Vali Acc: 0.442 Test Loss: 1.460 Test Acc: 0.442
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.1398117542266846
Epoch: 31, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.585 Vali Acc: 0.428 Test Loss: 1.585 Test Acc: 0.428
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.075032949447632
Epoch: 32, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.523 Vali Acc: 0.435 Test Loss: 1.523 Test Acc: 0.435
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.9169602394104004
Epoch: 33, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.466 Vali Acc: 0.478 Test Loss: 1.466 Test Acc: 0.478
Validation loss decreased (-0.442015 --> -0.478246).  Saving model ...
Epoch: 34 cost time: 3.0967977046966553
Epoch: 34, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.460 Vali Acc: 0.478 Test Loss: 1.460 Test Acc: 0.478
Validation loss decreased (-0.478246 --> -0.478246).  Saving model ...
Epoch: 35 cost time: 3.2676429748535156
Epoch: 35, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.460 Vali Acc: 0.478 Test Loss: 1.460 Test Acc: 0.478
Validation loss decreased (-0.478246 --> -0.478246).  Saving model ...
Epoch: 36 cost time: 3.0676302909851074
Epoch: 36, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.489 Vali Acc: 0.471 Test Loss: 1.489 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.220799207687378
Epoch: 37, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.528 Vali Acc: 0.464 Test Loss: 1.528 Test Acc: 0.464
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.204375743865967
Epoch: 38, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.466 Vali Acc: 0.493 Test Loss: 1.466 Test Acc: 0.493
Validation loss decreased (-0.478246 --> -0.492739).  Saving model ...
Epoch: 39 cost time: 3.445169448852539
Epoch: 39, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.462 Vali Acc: 0.500 Test Loss: 1.462 Test Acc: 0.500
Validation loss decreased (-0.492739 --> -0.499985).  Saving model ...
Epoch: 40 cost time: 3.642127275466919
Epoch: 40, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.491 Vali Acc: 0.493 Test Loss: 1.491 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.593087911605835
Epoch: 41, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.448 Vali Acc: 0.500 Test Loss: 1.448 Test Acc: 0.500
Validation loss decreased (-0.499985 --> -0.499986).  Saving model ...
Epoch: 42 cost time: 3.672528028488159
Epoch: 42, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.456 Vali Acc: 0.514 Test Loss: 1.456 Test Acc: 0.514
Validation loss decreased (-0.499986 --> -0.514478).  Saving model ...
Epoch: 43 cost time: 3.457711696624756
Epoch: 43, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.516 Vali Acc: 0.478 Test Loss: 1.516 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.6537489891052246
Epoch: 44, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.511 Vali Acc: 0.493 Test Loss: 1.511 Test Acc: 0.493
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.637915849685669
Epoch: 45, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.490 Vali Acc: 0.500 Test Loss: 1.490 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.6222774982452393
Epoch: 46, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.461 Vali Acc: 0.514 Test Loss: 1.461 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 3.5705416202545166
Epoch: 47, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.438 Vali Acc: 0.529 Test Loss: 1.438 Test Acc: 0.529
Validation loss decreased (-0.514478 --> -0.528971).  Saving model ...
Epoch: 48 cost time: 3.226224660873413
Epoch: 48, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.442 Vali Acc: 0.529 Test Loss: 1.442 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.3582818508148193
Epoch: 49, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.490 Vali Acc: 0.529 Test Loss: 1.490 Test Acc: 0.529
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 3.2696361541748047
Epoch: 50, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.515 Vali Acc: 0.514 Test Loss: 1.515 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 3.3436222076416016
Epoch: 51, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.521 Vali Acc: 0.507 Test Loss: 1.521 Test Acc: 0.507
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 3.5869157314300537
Epoch: 52, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.513 Vali Acc: 0.514 Test Loss: 1.513 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 3.319608688354492
Epoch: 53, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.505 Vali Acc: 0.522 Test Loss: 1.505 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 3.588719129562378
Epoch: 54, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.497 Vali Acc: 0.522 Test Loss: 1.497 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 3.766482353210449
Epoch: 55, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.518 Vali Acc: 0.507 Test Loss: 1.518 Test Acc: 0.507
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 3.670747756958008
Epoch: 56, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.530 Vali Acc: 0.514 Test Loss: 1.530 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 3.6207733154296875
Epoch: 57, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.535 Vali Acc: 0.522 Test Loss: 1.535 Test Acc: 0.522
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm64_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5289855072463768
model parameter : 269444
model size : 3.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         103                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma103_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.240336894989014
Epoch: 1, Steps: 9 | Train Loss: 1.454 Vali Loss: 1.401 Vali Acc: 0.312 Test Loss: 1.401 Test Acc: 0.312
Validation loss decreased (inf --> -0.311580).  Saving model ...
Epoch: 2 cost time: 3.1177942752838135
Epoch: 2, Steps: 9 | Train Loss: 1.321 Vali Loss: 1.313 Vali Acc: 0.428 Test Loss: 1.313 Test Acc: 0.428
Validation loss decreased (-0.311580 --> -0.427523).  Saving model ...
Epoch: 3 cost time: 3.041630268096924
Epoch: 3, Steps: 9 | Train Loss: 1.188 Vali Loss: 1.213 Vali Acc: 0.500 Test Loss: 1.213 Test Acc: 0.500
Validation loss decreased (-0.427523 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 3.3722269535064697
Epoch: 4, Steps: 9 | Train Loss: 0.994 Vali Loss: 1.092 Vali Acc: 0.587 Test Loss: 1.092 Test Acc: 0.587
Validation loss decreased (-0.499988 --> -0.586946).  Saving model ...
Epoch: 5 cost time: 3.092076301574707
Epoch: 5, Steps: 9 | Train Loss: 0.810 Vali Loss: 0.984 Vali Acc: 0.688 Test Loss: 0.984 Test Acc: 0.688
Validation loss decreased (-0.586946 --> -0.688396).  Saving model ...
Epoch: 6 cost time: 3.1085314750671387
Epoch: 6, Steps: 9 | Train Loss: 0.690 Vali Loss: 0.883 Vali Acc: 0.710 Test Loss: 0.883 Test Acc: 0.710
Validation loss decreased (-0.688396 --> -0.710136).  Saving model ...
Epoch: 7 cost time: 3.367995500564575
Epoch: 7, Steps: 9 | Train Loss: 0.539 Vali Loss: 0.809 Vali Acc: 0.732 Test Loss: 0.809 Test Acc: 0.732
Validation loss decreased (-0.710136 --> -0.731876).  Saving model ...
Epoch: 8 cost time: 3.6557505130767822
Epoch: 8, Steps: 9 | Train Loss: 0.409 Vali Loss: 0.698 Vali Acc: 0.790 Test Loss: 0.698 Test Acc: 0.790
Validation loss decreased (-0.731876 --> -0.789848).  Saving model ...
Epoch: 9 cost time: 3.4880471229553223
Epoch: 9, Steps: 9 | Train Loss: 0.308 Vali Loss: 0.624 Vali Acc: 0.819 Test Loss: 0.624 Test Acc: 0.819
Validation loss decreased (-0.789848 --> -0.818834).  Saving model ...
Epoch: 10 cost time: 3.6129798889160156
Epoch: 10, Steps: 9 | Train Loss: 0.229 Vali Loss: 0.597 Vali Acc: 0.819 Test Loss: 0.597 Test Acc: 0.819
Validation loss decreased (-0.818834 --> -0.818835).  Saving model ...
Epoch: 11 cost time: 3.6731977462768555
Epoch: 11, Steps: 9 | Train Loss: 0.173 Vali Loss: 0.511 Vali Acc: 0.833 Test Loss: 0.511 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833328).  Saving model ...
Epoch: 12 cost time: 3.3859329223632812
Epoch: 12, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.528 Vali Acc: 0.833 Test Loss: 0.528 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.3106489181518555
Epoch: 13, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.460 Vali Acc: 0.841 Test Loss: 0.460 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840575).  Saving model ...
Epoch: 14 cost time: 3.4111311435699463
Epoch: 14, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.465 Vali Acc: 0.841 Test Loss: 0.465 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.713271379470825
Epoch: 15, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.452 Vali Acc: 0.855 Test Loss: 0.452 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855068).  Saving model ...
Epoch: 16 cost time: 3.2641067504882812
Epoch: 16, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.447 Vali Acc: 0.848 Test Loss: 0.447 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.446812391281128
Epoch: 17, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.457 Vali Acc: 0.841 Test Loss: 0.457 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.3154332637786865
Epoch: 18, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.436 Vali Acc: 0.855 Test Loss: 0.436 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 19 cost time: 3.5737836360931396
Epoch: 19, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.442 Vali Acc: 0.848 Test Loss: 0.442 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.2432141304016113
Epoch: 20, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.431 Vali Acc: 0.848 Test Loss: 0.431 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.788198709487915
Epoch: 21, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.425 Vali Acc: 0.848 Test Loss: 0.425 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.6545417308807373
Epoch: 22, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.429 Vali Acc: 0.855 Test Loss: 0.429 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 23 cost time: 3.4306726455688477
Epoch: 23, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.434 Vali Acc: 0.855 Test Loss: 0.434 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.4725148677825928
Epoch: 24, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.422 Vali Acc: 0.855 Test Loss: 0.422 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 25 cost time: 3.599717378616333
Epoch: 25, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.424 Vali Acc: 0.855 Test Loss: 0.424 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.809201240539551
Epoch: 26, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.434 Vali Acc: 0.855 Test Loss: 0.434 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.486032247543335
Epoch: 27, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.443 Vali Acc: 0.855 Test Loss: 0.443 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.3095319271087646
Epoch: 28, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.433 Vali Acc: 0.855 Test Loss: 0.433 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.1767289638519287
Epoch: 29, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.420 Vali Acc: 0.855 Test Loss: 0.420 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 30 cost time: 3.09455943107605
Epoch: 30, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.423 Vali Acc: 0.870 Test Loss: 0.423 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869561).  Saving model ...
Epoch: 31 cost time: 3.00516676902771
Epoch: 31, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.432 Vali Acc: 0.870 Test Loss: 0.432 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.331327438354492
Epoch: 32, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.434 Vali Acc: 0.862 Test Loss: 0.434 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.3580539226531982
Epoch: 33, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.430 Vali Acc: 0.862 Test Loss: 0.430 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.3333194255828857
Epoch: 34, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.429 Vali Acc: 0.862 Test Loss: 0.429 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.515125036239624
Epoch: 35, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.438 Vali Acc: 0.862 Test Loss: 0.438 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.4407451152801514
Epoch: 36, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.448 Vali Acc: 0.862 Test Loss: 0.448 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.7478325366973877
Epoch: 37, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.445 Vali Acc: 0.862 Test Loss: 0.445 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.35862135887146
Epoch: 38, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.438 Vali Acc: 0.862 Test Loss: 0.438 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 3.1935348510742188
Epoch: 39, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.432 Vali Acc: 0.848 Test Loss: 0.432 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 3.0935561656951904
Epoch: 40, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.442 Vali Acc: 0.848 Test Loss: 0.442 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma103_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 462404
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         83                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma83_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.572446823120117
Epoch: 1, Steps: 9 | Train Loss: 1.457 Vali Loss: 1.405 Vali Acc: 0.290 Test Loss: 1.405 Test Acc: 0.290
Validation loss decreased (inf --> -0.289841).  Saving model ...
Epoch: 2 cost time: 3.1244633197784424
Epoch: 2, Steps: 9 | Train Loss: 1.332 Vali Loss: 1.315 Vali Acc: 0.413 Test Loss: 1.315 Test Acc: 0.413
Validation loss decreased (-0.289841 --> -0.413030).  Saving model ...
Epoch: 3 cost time: 2.888842821121216
Epoch: 3, Steps: 9 | Train Loss: 1.190 Vali Loss: 1.210 Vali Acc: 0.500 Test Loss: 1.210 Test Acc: 0.500
Validation loss decreased (-0.413030 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 3.325056552886963
Epoch: 4, Steps: 9 | Train Loss: 1.008 Vali Loss: 1.089 Vali Acc: 0.652 Test Loss: 1.089 Test Acc: 0.652
Validation loss decreased (-0.499988 --> -0.652163).  Saving model ...
Epoch: 5 cost time: 3.1373326778411865
Epoch: 5, Steps: 9 | Train Loss: 0.820 Vali Loss: 0.978 Vali Acc: 0.739 Test Loss: 0.978 Test Acc: 0.739
Validation loss decreased (-0.652163 --> -0.739121).  Saving model ...
Epoch: 6 cost time: 3.2243289947509766
Epoch: 6, Steps: 9 | Train Loss: 0.700 Vali Loss: 0.870 Vali Acc: 0.761 Test Loss: 0.870 Test Acc: 0.761
Validation loss decreased (-0.739121 --> -0.760861).  Saving model ...
Epoch: 7 cost time: 3.3603708744049072
Epoch: 7, Steps: 9 | Train Loss: 0.555 Vali Loss: 0.798 Vali Acc: 0.739 Test Loss: 0.798 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.3362302780151367
Epoch: 8, Steps: 9 | Train Loss: 0.418 Vali Loss: 0.679 Vali Acc: 0.819 Test Loss: 0.679 Test Acc: 0.819
Validation loss decreased (-0.760861 --> -0.818834).  Saving model ...
Epoch: 9 cost time: 3.3722004890441895
Epoch: 9, Steps: 9 | Train Loss: 0.318 Vali Loss: 0.610 Vali Acc: 0.812 Test Loss: 0.610 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.4298839569091797
Epoch: 10, Steps: 9 | Train Loss: 0.242 Vali Loss: 0.590 Vali Acc: 0.833 Test Loss: 0.590 Test Acc: 0.833
Validation loss decreased (-0.818834 --> -0.833327).  Saving model ...
Epoch: 11 cost time: 3.0167980194091797
Epoch: 11, Steps: 9 | Train Loss: 0.184 Vali Loss: 0.489 Vali Acc: 0.870 Test Loss: 0.489 Test Acc: 0.870
Validation loss decreased (-0.833327 --> -0.869560).  Saving model ...
Epoch: 12 cost time: 3.1473567485809326
Epoch: 12, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.523 Vali Acc: 0.848 Test Loss: 0.523 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.0332348346710205
Epoch: 13, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.441 Vali Acc: 0.855 Test Loss: 0.441 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.8797240257263184
Epoch: 14, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.461 Vali Acc: 0.841 Test Loss: 0.461 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.07828688621521
Epoch: 15, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.423 Vali Acc: 0.884 Test Loss: 0.423 Test Acc: 0.884
Validation loss decreased (-0.869560 --> -0.884054).  Saving model ...
Epoch: 16 cost time: 3.161628484725952
Epoch: 16, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.426 Vali Acc: 0.877 Test Loss: 0.426 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.15080189704895
Epoch: 17, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.438 Vali Acc: 0.848 Test Loss: 0.438 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.4735589027404785
Epoch: 18, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.407 Vali Acc: 0.877 Test Loss: 0.407 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.3949389457702637
Epoch: 19, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.425 Vali Acc: 0.870 Test Loss: 0.425 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.309739828109741
Epoch: 20, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.418 Vali Acc: 0.862 Test Loss: 0.418 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.3463101387023926
Epoch: 21, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.417 Vali Acc: 0.862 Test Loss: 0.417 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.29514741897583
Epoch: 22, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.408 Vali Acc: 0.891 Test Loss: 0.408 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891300).  Saving model ...
Epoch: 23 cost time: 3.4783267974853516
Epoch: 23, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.420 Vali Acc: 0.891 Test Loss: 0.420 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.3335888385772705
Epoch: 24, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.399 Vali Acc: 0.906 Test Loss: 0.399 Test Acc: 0.906
Validation loss decreased (-0.891300 --> -0.905793).  Saving model ...
Epoch: 25 cost time: 3.0379679203033447
Epoch: 25, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.405 Vali Acc: 0.884 Test Loss: 0.405 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.1791563034057617
Epoch: 26, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.422 Vali Acc: 0.877 Test Loss: 0.422 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.1320571899414062
Epoch: 27, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.435 Vali Acc: 0.877 Test Loss: 0.435 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.939056873321533
Epoch: 28, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.420 Vali Acc: 0.870 Test Loss: 0.420 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.9947454929351807
Epoch: 29, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.402 Vali Acc: 0.899 Test Loss: 0.402 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.954800844192505
Epoch: 30, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.408 Vali Acc: 0.906 Test Loss: 0.408 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.968870162963867
Epoch: 31, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.418 Vali Acc: 0.899 Test Loss: 0.418 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.1802971363067627
Epoch: 32, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.421 Vali Acc: 0.884 Test Loss: 0.421 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.522465944290161
Epoch: 33, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.411 Vali Acc: 0.891 Test Loss: 0.411 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.4248898029327393
Epoch: 34, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.413 Vali Acc: 0.884 Test Loss: 0.413 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma83_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 462404
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         62                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma62_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.6855645179748535
Epoch: 1, Steps: 9 | Train Loss: 1.523 Vali Loss: 1.458 Vali Acc: 0.181 Test Loss: 1.458 Test Acc: 0.181
Validation loss decreased (inf --> -0.181145).  Saving model ...
Epoch: 2 cost time: 3.261866569519043
Epoch: 2, Steps: 9 | Train Loss: 1.363 Vali Loss: 1.359 Vali Acc: 0.370 Test Loss: 1.359 Test Acc: 0.370
Validation loss decreased (-0.181145 --> -0.369552).  Saving model ...
Epoch: 3 cost time: 2.8951659202575684
Epoch: 3, Steps: 9 | Train Loss: 1.215 Vali Loss: 1.255 Vali Acc: 0.428 Test Loss: 1.255 Test Acc: 0.428
Validation loss decreased (-0.369552 --> -0.427524).  Saving model ...
Epoch: 4 cost time: 3.2950284481048584
Epoch: 4, Steps: 9 | Train Loss: 1.031 Vali Loss: 1.124 Vali Acc: 0.594 Test Loss: 1.124 Test Acc: 0.594
Validation loss decreased (-0.427524 --> -0.594192).  Saving model ...
Epoch: 5 cost time: 2.8827078342437744
Epoch: 5, Steps: 9 | Train Loss: 0.842 Vali Loss: 1.004 Vali Acc: 0.703 Test Loss: 1.004 Test Acc: 0.703
Validation loss decreased (-0.594192 --> -0.702889).  Saving model ...
Epoch: 6 cost time: 3.06880259513855
Epoch: 6, Steps: 9 | Train Loss: 0.701 Vali Loss: 0.891 Vali Acc: 0.768 Test Loss: 0.891 Test Acc: 0.768
Validation loss decreased (-0.702889 --> -0.768107).  Saving model ...
Epoch: 7 cost time: 3.120675563812256
Epoch: 7, Steps: 9 | Train Loss: 0.552 Vali Loss: 0.806 Vali Acc: 0.754 Test Loss: 0.806 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.1908481121063232
Epoch: 8, Steps: 9 | Train Loss: 0.408 Vali Loss: 0.676 Vali Acc: 0.833 Test Loss: 0.676 Test Acc: 0.833
Validation loss decreased (-0.768107 --> -0.833327).  Saving model ...
Epoch: 9 cost time: 3.315739631652832
Epoch: 9, Steps: 9 | Train Loss: 0.308 Vali Loss: 0.605 Vali Acc: 0.841 Test Loss: 0.605 Test Acc: 0.841
Validation loss decreased (-0.833327 --> -0.840574).  Saving model ...
Epoch: 10 cost time: 3.3720333576202393
Epoch: 10, Steps: 9 | Train Loss: 0.227 Vali Loss: 0.567 Vali Acc: 0.855 Test Loss: 0.567 Test Acc: 0.855
Validation loss decreased (-0.840574 --> -0.855067).  Saving model ...
Epoch: 11 cost time: 3.5249996185302734
Epoch: 11, Steps: 9 | Train Loss: 0.173 Vali Loss: 0.476 Vali Acc: 0.899 Test Loss: 0.476 Test Acc: 0.899
Validation loss decreased (-0.855067 --> -0.898546).  Saving model ...
Epoch: 12 cost time: 3.2867472171783447
Epoch: 12, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.501 Vali Acc: 0.884 Test Loss: 0.501 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.303396701812744
Epoch: 13, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.433 Vali Acc: 0.913 Test Loss: 0.433 Test Acc: 0.913
Validation loss decreased (-0.898546 --> -0.913039).  Saving model ...
Epoch: 14 cost time: 3.3838860988616943
Epoch: 14, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.456 Vali Acc: 0.884 Test Loss: 0.456 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.4397387504577637
Epoch: 15, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.418 Vali Acc: 0.913 Test Loss: 0.418 Test Acc: 0.913
Validation loss decreased (-0.913039 --> -0.913039).  Saving model ...
Epoch: 16 cost time: 3.3809754848480225
Epoch: 16, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.415 Vali Acc: 0.899 Test Loss: 0.415 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.177926540374756
Epoch: 17, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.436 Vali Acc: 0.920 Test Loss: 0.436 Test Acc: 0.920
Validation loss decreased (-0.913039 --> -0.920285).  Saving model ...
Epoch: 18 cost time: 3.41228985786438
Epoch: 18, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.405 Vali Acc: 0.899 Test Loss: 0.405 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.3676676750183105
Epoch: 19, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.406 Vali Acc: 0.906 Test Loss: 0.406 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.336416006088257
Epoch: 20, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.418 Vali Acc: 0.891 Test Loss: 0.418 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.5804603099823
Epoch: 21, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.417 Vali Acc: 0.899 Test Loss: 0.417 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.4407498836517334
Epoch: 22, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.399 Vali Acc: 0.913 Test Loss: 0.399 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.5345304012298584
Epoch: 23, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.416 Vali Acc: 0.906 Test Loss: 0.416 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.2475311756134033
Epoch: 24, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.395 Vali Acc: 0.906 Test Loss: 0.395 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.3974475860595703
Epoch: 25, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.397 Vali Acc: 0.899 Test Loss: 0.397 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.3767268657684326
Epoch: 26, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.407 Vali Acc: 0.899 Test Loss: 0.407 Test Acc: 0.899
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.342402696609497
Epoch: 27, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.416 Vali Acc: 0.899 Test Loss: 0.416 Test Acc: 0.899
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma62_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 462404
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         42                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.74399733543396
Epoch: 1, Steps: 9 | Train Loss: 1.543 Vali Loss: 1.493 Vali Acc: 0.196 Test Loss: 1.493 Test Acc: 0.196
Validation loss decreased (inf --> -0.195637).  Saving model ...
Epoch: 2 cost time: 3.3643693923950195
Epoch: 2, Steps: 9 | Train Loss: 1.362 Vali Loss: 1.375 Vali Acc: 0.377 Test Loss: 1.375 Test Acc: 0.377
Validation loss decreased (-0.195637 --> -0.376798).  Saving model ...
Epoch: 3 cost time: 3.301753520965576
Epoch: 3, Steps: 9 | Train Loss: 1.202 Vali Loss: 1.253 Vali Acc: 0.442 Test Loss: 1.253 Test Acc: 0.442
Validation loss decreased (-0.376798 --> -0.442016).  Saving model ...
Epoch: 4 cost time: 3.2416272163391113
Epoch: 4, Steps: 9 | Train Loss: 1.005 Vali Loss: 1.109 Vali Acc: 0.594 Test Loss: 1.109 Test Acc: 0.594
Validation loss decreased (-0.442016 --> -0.594192).  Saving model ...
Epoch: 5 cost time: 3.1824538707733154
Epoch: 5, Steps: 9 | Train Loss: 0.808 Vali Loss: 0.977 Vali Acc: 0.703 Test Loss: 0.977 Test Acc: 0.703
Validation loss decreased (-0.594192 --> -0.702889).  Saving model ...
Epoch: 6 cost time: 3.4194650650024414
Epoch: 6, Steps: 9 | Train Loss: 0.670 Vali Loss: 0.853 Vali Acc: 0.754 Test Loss: 0.853 Test Acc: 0.754
Validation loss decreased (-0.702889 --> -0.753615).  Saving model ...
Epoch: 7 cost time: 3.340939998626709
Epoch: 7, Steps: 9 | Train Loss: 0.521 Vali Loss: 0.765 Vali Acc: 0.768 Test Loss: 0.765 Test Acc: 0.768
Validation loss decreased (-0.753615 --> -0.768108).  Saving model ...
Epoch: 8 cost time: 3.6365392208099365
Epoch: 8, Steps: 9 | Train Loss: 0.381 Vali Loss: 0.634 Vali Acc: 0.855 Test Loss: 0.634 Test Acc: 0.855
Validation loss decreased (-0.768108 --> -0.855066).  Saving model ...
Epoch: 9 cost time: 3.5549123287200928
Epoch: 9, Steps: 9 | Train Loss: 0.292 Vali Loss: 0.555 Vali Acc: 0.862 Test Loss: 0.555 Test Acc: 0.862
Validation loss decreased (-0.855066 --> -0.862313).  Saving model ...
Epoch: 10 cost time: 3.184903621673584
Epoch: 10, Steps: 9 | Train Loss: 0.208 Vali Loss: 0.528 Vali Acc: 0.848 Test Loss: 0.528 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.500880479812622
Epoch: 11, Steps: 9 | Train Loss: 0.168 Vali Loss: 0.429 Vali Acc: 0.884 Test Loss: 0.429 Test Acc: 0.884
Validation loss decreased (-0.862313 --> -0.884054).  Saving model ...
Epoch: 12 cost time: 3.2552924156188965
Epoch: 12, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.468 Vali Acc: 0.877 Test Loss: 0.468 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.2953648567199707
Epoch: 13, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.380 Vali Acc: 0.891 Test Loss: 0.380 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891301).  Saving model ...
Epoch: 14 cost time: 3.2836837768554688
Epoch: 14, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.410 Vali Acc: 0.891 Test Loss: 0.410 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.432554006576538
Epoch: 15, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.367 Vali Acc: 0.906 Test Loss: 0.367 Test Acc: 0.906
Validation loss decreased (-0.891301 --> -0.905793).  Saving model ...
Epoch: 16 cost time: 3.5596792697906494
Epoch: 16, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.373 Vali Acc: 0.906 Test Loss: 0.373 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.4796576499938965
Epoch: 17, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.388 Vali Acc: 0.899 Test Loss: 0.388 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.3135225772857666
Epoch: 18, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.350 Vali Acc: 0.906 Test Loss: 0.350 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905794).  Saving model ...
Epoch: 19 cost time: 3.3620593547821045
Epoch: 19, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.357 Vali Acc: 0.906 Test Loss: 0.357 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.3365213871002197
Epoch: 20, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.361 Vali Acc: 0.906 Test Loss: 0.361 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.4291348457336426
Epoch: 21, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.367 Vali Acc: 0.891 Test Loss: 0.367 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.4174394607543945
Epoch: 22, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.346 Vali Acc: 0.891 Test Loss: 0.346 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.5540931224823
Epoch: 23, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.361 Vali Acc: 0.906 Test Loss: 0.361 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.3836848735809326
Epoch: 24, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.349 Vali Acc: 0.906 Test Loss: 0.349 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 25 cost time: 3.624351739883423
Epoch: 25, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.342 Vali Acc: 0.899 Test Loss: 0.342 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.363635540008545
Epoch: 26, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.355 Vali Acc: 0.899 Test Loss: 0.355 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.439622163772583
Epoch: 27, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.357 Vali Acc: 0.899 Test Loss: 0.357 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.310262441635132
Epoch: 28, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.344 Vali Acc: 0.891 Test Loss: 0.344 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.4404802322387695
Epoch: 29, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.340 Vali Acc: 0.899 Test Loss: 0.340 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.382037878036499
Epoch: 30, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.341 Vali Acc: 0.899 Test Loss: 0.341 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.711484909057617
Epoch: 31, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.345 Vali Acc: 0.913 Test Loss: 0.345 Test Acc: 0.913
Validation loss decreased (-0.905794 --> -0.913040).  Saving model ...
Epoch: 32 cost time: 3.4169399738311768
Epoch: 32, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.348 Vali Acc: 0.906 Test Loss: 0.348 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.5310277938842773
Epoch: 33, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.340 Vali Acc: 0.899 Test Loss: 0.340 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.617074966430664
Epoch: 34, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.337 Vali Acc: 0.899 Test Loss: 0.337 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.4335100650787354
Epoch: 35, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.348 Vali Acc: 0.906 Test Loss: 0.348 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.3744781017303467
Epoch: 36, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.360 Vali Acc: 0.906 Test Loss: 0.360 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.495713949203491
Epoch: 37, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.362 Vali Acc: 0.906 Test Loss: 0.362 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.2457568645477295
Epoch: 38, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.344 Vali Acc: 0.906 Test Loss: 0.344 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.445678949356079
Epoch: 39, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.330 Vali Acc: 0.891 Test Loss: 0.330 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.612758159637451
Epoch: 40, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.340 Vali Acc: 0.899 Test Loss: 0.340 Test Acc: 0.899
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 3.312331199645996
Epoch: 41, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.358 Vali Acc: 0.906 Test Loss: 0.358 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9130434782608695
model parameter : 462404
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.196556091308594
Epoch: 1, Steps: 9 | Train Loss: 1.504 Vali Loss: 1.464 Vali Acc: 0.225 Test Loss: 1.464 Test Acc: 0.225
Validation loss decreased (inf --> -0.224623).  Saving model ...
Epoch: 2 cost time: 3.426198720932007
Epoch: 2, Steps: 9 | Train Loss: 1.360 Vali Loss: 1.356 Vali Acc: 0.377 Test Loss: 1.356 Test Acc: 0.377
Validation loss decreased (-0.224623 --> -0.376798).  Saving model ...
Epoch: 3 cost time: 3.595113754272461
Epoch: 3, Steps: 9 | Train Loss: 1.204 Vali Loss: 1.240 Vali Acc: 0.522 Test Loss: 1.240 Test Acc: 0.522
Validation loss decreased (-0.376798 --> -0.521727).  Saving model ...
Epoch: 4 cost time: 3.5170319080352783
Epoch: 4, Steps: 9 | Train Loss: 1.020 Vali Loss: 1.109 Vali Acc: 0.609 Test Loss: 1.109 Test Acc: 0.609
Validation loss decreased (-0.521727 --> -0.608685).  Saving model ...
Epoch: 5 cost time: 3.7791833877563477
Epoch: 5, Steps: 9 | Train Loss: 0.811 Vali Loss: 0.981 Vali Acc: 0.688 Test Loss: 0.981 Test Acc: 0.688
Validation loss decreased (-0.608685 --> -0.688396).  Saving model ...
Epoch: 6 cost time: 3.6371192932128906
Epoch: 6, Steps: 9 | Train Loss: 0.673 Vali Loss: 0.852 Vali Acc: 0.775 Test Loss: 0.852 Test Acc: 0.775
Validation loss decreased (-0.688396 --> -0.775354).  Saving model ...
Epoch: 7 cost time: 3.3482439517974854
Epoch: 7, Steps: 9 | Train Loss: 0.518 Vali Loss: 0.741 Vali Acc: 0.783 Test Loss: 0.741 Test Acc: 0.783
Validation loss decreased (-0.775354 --> -0.782601).  Saving model ...
Epoch: 8 cost time: 3.4025039672851562
Epoch: 8, Steps: 9 | Train Loss: 0.388 Vali Loss: 0.612 Vali Acc: 0.870 Test Loss: 0.612 Test Acc: 0.870
Validation loss decreased (-0.782601 --> -0.869559).  Saving model ...
Epoch: 9 cost time: 3.11318302154541
Epoch: 9, Steps: 9 | Train Loss: 0.284 Vali Loss: 0.532 Vali Acc: 0.891 Test Loss: 0.532 Test Acc: 0.891
Validation loss decreased (-0.869559 --> -0.891299).  Saving model ...
Epoch: 10 cost time: 3.5505285263061523
Epoch: 10, Steps: 9 | Train Loss: 0.207 Vali Loss: 0.477 Vali Acc: 0.891 Test Loss: 0.477 Test Acc: 0.891
Validation loss decreased (-0.891299 --> -0.891300).  Saving model ...
Epoch: 11 cost time: 3.418060302734375
Epoch: 11, Steps: 9 | Train Loss: 0.157 Vali Loss: 0.401 Vali Acc: 0.899 Test Loss: 0.401 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898547).  Saving model ...
Epoch: 12 cost time: 3.496635675430298
Epoch: 12, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.410 Vali Acc: 0.899 Test Loss: 0.410 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.6116695404052734
Epoch: 13, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.350 Vali Acc: 0.906 Test Loss: 0.350 Test Acc: 0.906
Validation loss decreased (-0.898547 --> -0.905794).  Saving model ...
Epoch: 14 cost time: 3.6009793281555176
Epoch: 14, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.348 Vali Acc: 0.906 Test Loss: 0.348 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 15 cost time: 3.5099740028381348
Epoch: 15, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.314 Vali Acc: 0.906 Test Loss: 0.314 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 16 cost time: 3.445840358734131
Epoch: 16, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.306 Vali Acc: 0.906 Test Loss: 0.306 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 17 cost time: 3.5351691246032715
Epoch: 17, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.313 Vali Acc: 0.906 Test Loss: 0.313 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.6604082584381104
Epoch: 18, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.289 Vali Acc: 0.899 Test Loss: 0.289 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.492807626724243
Epoch: 19, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.299 Vali Acc: 0.906 Test Loss: 0.299 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 20 cost time: 3.485429286956787
Epoch: 20, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.297 Vali Acc: 0.891 Test Loss: 0.297 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.2061307430267334
Epoch: 21, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.295 Vali Acc: 0.891 Test Loss: 0.295 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.639875888824463
Epoch: 22, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.281 Vali Acc: 0.891 Test Loss: 0.281 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.89463472366333
Epoch: 23, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.285 Vali Acc: 0.906 Test Loss: 0.285 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 24 cost time: 3.045239210128784
Epoch: 24, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.274 Vali Acc: 0.899 Test Loss: 0.274 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.3181262016296387
Epoch: 25, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.269 Vali Acc: 0.906 Test Loss: 0.269 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 26 cost time: 3.4071426391601562
Epoch: 26, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.269 Vali Acc: 0.906 Test Loss: 0.269 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.4198594093322754
Epoch: 27, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.268 Vali Acc: 0.906 Test Loss: 0.268 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 28 cost time: 3.2783453464508057
Epoch: 28, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.266 Vali Acc: 0.906 Test Loss: 0.266 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905794).  Saving model ...
Epoch: 29 cost time: 3.405637502670288
Epoch: 29, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.255 Vali Acc: 0.899 Test Loss: 0.255 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.5282230377197266
Epoch: 30, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.257 Vali Acc: 0.906 Test Loss: 0.257 Test Acc: 0.906
Validation loss decreased (-0.905794 --> -0.905795).  Saving model ...
Epoch: 31 cost time: 3.1850452423095703
Epoch: 31, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.262 Vali Acc: 0.906 Test Loss: 0.262 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.2288920879364014
Epoch: 32, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.261 Vali Acc: 0.906 Test Loss: 0.261 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.957577705383301
Epoch: 33, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.260 Vali Acc: 0.906 Test Loss: 0.260 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.2260360717773438
Epoch: 34, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.260 Vali Acc: 0.906 Test Loss: 0.260 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.3013830184936523
Epoch: 35, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.265 Vali Acc: 0.920 Test Loss: 0.265 Test Acc: 0.920
Validation loss decreased (-0.905795 --> -0.920287).  Saving model ...
Epoch: 36 cost time: 3.0967772006988525
Epoch: 36, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.274 Vali Acc: 0.906 Test Loss: 0.274 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.986168622970581
Epoch: 37, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.269 Vali Acc: 0.899 Test Loss: 0.269 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.1269848346710205
Epoch: 38, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.260 Vali Acc: 0.906 Test Loss: 0.260 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.6675570011138916
Epoch: 39, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.249 Vali Acc: 0.899 Test Loss: 0.249 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.432297706604004
Epoch: 40, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.256 Vali Acc: 0.906 Test Loss: 0.256 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 3.4256558418273926
Epoch: 41, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.268 Vali Acc: 0.899 Test Loss: 0.268 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 3.3089606761932373
Epoch: 42, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.267 Vali Acc: 0.906 Test Loss: 0.267 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 3.519341468811035
Epoch: 43, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.247 Vali Acc: 0.899 Test Loss: 0.247 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 3.6053576469421387
Epoch: 44, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.248 Vali Acc: 0.906 Test Loss: 0.248 Test Acc: 0.906
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 3.43928599357605
Epoch: 45, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.265 Vali Acc: 0.913 Test Loss: 0.265 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 462404
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.675828695297241
Epoch: 1, Steps: 9 | Train Loss: 1.481 Vali Loss: 1.396 Vali Acc: 0.290 Test Loss: 1.396 Test Acc: 0.290
Validation loss decreased (inf --> -0.289841).  Saving model ...
Epoch: 2 cost time: 3.2199783325195312
Epoch: 2, Steps: 9 | Train Loss: 1.360 Vali Loss: 1.306 Vali Acc: 0.449 Test Loss: 1.306 Test Acc: 0.449
Validation loss decreased (-0.289841 --> -0.449262).  Saving model ...
Epoch: 3 cost time: 3.139659881591797
Epoch: 3, Steps: 9 | Train Loss: 1.202 Vali Loss: 1.206 Vali Acc: 0.551 Test Loss: 1.206 Test Acc: 0.551
Validation loss decreased (-0.449262 --> -0.550713).  Saving model ...
Epoch: 4 cost time: 3.2507505416870117
Epoch: 4, Steps: 9 | Train Loss: 1.029 Vali Loss: 1.088 Vali Acc: 0.638 Test Loss: 1.088 Test Acc: 0.638
Validation loss decreased (-0.550713 --> -0.637670).  Saving model ...
Epoch: 5 cost time: 3.3187968730926514
Epoch: 5, Steps: 9 | Train Loss: 0.845 Vali Loss: 0.972 Vali Acc: 0.681 Test Loss: 0.972 Test Acc: 0.681
Validation loss decreased (-0.637670 --> -0.681150).  Saving model ...
Epoch: 6 cost time: 3.632328987121582
Epoch: 6, Steps: 9 | Train Loss: 0.714 Vali Loss: 0.856 Vali Acc: 0.732 Test Loss: 0.856 Test Acc: 0.732
Validation loss decreased (-0.681150 --> -0.731876).  Saving model ...
Epoch: 7 cost time: 3.1143221855163574
Epoch: 7, Steps: 9 | Train Loss: 0.586 Vali Loss: 0.769 Vali Acc: 0.739 Test Loss: 0.769 Test Acc: 0.739
Validation loss decreased (-0.731876 --> -0.739123).  Saving model ...
Epoch: 8 cost time: 3.219273567199707
Epoch: 8, Steps: 9 | Train Loss: 0.447 Vali Loss: 0.652 Vali Acc: 0.783 Test Loss: 0.652 Test Acc: 0.783
Validation loss decreased (-0.739123 --> -0.782602).  Saving model ...
Epoch: 9 cost time: 3.1871109008789062
Epoch: 9, Steps: 9 | Train Loss: 0.349 Vali Loss: 0.582 Vali Acc: 0.804 Test Loss: 0.582 Test Acc: 0.804
Validation loss decreased (-0.782602 --> -0.804342).  Saving model ...
Epoch: 10 cost time: 3.3563232421875
Epoch: 10, Steps: 9 | Train Loss: 0.276 Vali Loss: 0.550 Vali Acc: 0.797 Test Loss: 0.550 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.3079636096954346
Epoch: 11, Steps: 9 | Train Loss: 0.213 Vali Loss: 0.495 Vali Acc: 0.841 Test Loss: 0.495 Test Acc: 0.841
Validation loss decreased (-0.804342 --> -0.840575).  Saving model ...
Epoch: 12 cost time: 3.383495807647705
Epoch: 12, Steps: 9 | Train Loss: 0.180 Vali Loss: 0.469 Vali Acc: 0.841 Test Loss: 0.469 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 13 cost time: 3.370553493499756
Epoch: 13, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.466 Vali Acc: 0.833 Test Loss: 0.466 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.1084389686584473
Epoch: 14, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.447 Vali Acc: 0.855 Test Loss: 0.447 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855068).  Saving model ...
Epoch: 15 cost time: 3.3114919662475586
Epoch: 15, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.442 Vali Acc: 0.833 Test Loss: 0.442 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.3064961433410645
Epoch: 16, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.433 Vali Acc: 0.870 Test Loss: 0.433 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869561).  Saving model ...
Epoch: 17 cost time: 3.3831088542938232
Epoch: 17, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.409 Vali Acc: 0.862 Test Loss: 0.409 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.14426326751709
Epoch: 18, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.416 Vali Acc: 0.855 Test Loss: 0.416 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.0206735134124756
Epoch: 19, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.407 Vali Acc: 0.862 Test Loss: 0.407 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.0569281578063965
Epoch: 20, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.410 Vali Acc: 0.870 Test Loss: 0.410 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 21 cost time: 3.210482120513916
Epoch: 21, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.418 Vali Acc: 0.848 Test Loss: 0.418 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.185213565826416
Epoch: 22, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.404 Vali Acc: 0.855 Test Loss: 0.404 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.1524579524993896
Epoch: 23, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.403 Vali Acc: 0.877 Test Loss: 0.403 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 24 cost time: 3.0856754779815674
Epoch: 24, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.386 Vali Acc: 0.848 Test Loss: 0.386 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.985506296157837
Epoch: 25, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.403 Vali Acc: 0.877 Test Loss: 0.403 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 26 cost time: 3.1525027751922607
Epoch: 26, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.393 Vali Acc: 0.870 Test Loss: 0.393 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.2951271533966064
Epoch: 27, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.403 Vali Acc: 0.870 Test Loss: 0.403 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.518399238586426
Epoch: 28, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.414 Vali Acc: 0.870 Test Loss: 0.414 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.4806008338928223
Epoch: 29, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.387 Vali Acc: 0.848 Test Loss: 0.387 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.4242494106292725
Epoch: 30, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.399 Vali Acc: 0.877 Test Loss: 0.399 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 31 cost time: 3.354490280151367
Epoch: 31, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.404 Vali Acc: 0.877 Test Loss: 0.404 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.5744783878326416
Epoch: 32, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.384 Vali Acc: 0.870 Test Loss: 0.384 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.134321689605713
Epoch: 33, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.395 Vali Acc: 0.855 Test Loss: 0.395 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.099078893661499
Epoch: 34, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.397 Vali Acc: 0.862 Test Loss: 0.397 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.13804030418396
Epoch: 35, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.399 Vali Acc: 0.884 Test Loss: 0.399 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 36 cost time: 2.953803539276123
Epoch: 36, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.389 Vali Acc: 0.877 Test Loss: 0.389 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.2504074573516846
Epoch: 37, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.401 Vali Acc: 0.884 Test Loss: 0.401 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.099015712738037
Epoch: 38, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.397 Vali Acc: 0.884 Test Loss: 0.397 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 39 cost time: 3.2786827087402344
Epoch: 39, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.379 Vali Acc: 0.848 Test Loss: 0.379 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.368852138519287
Epoch: 40, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.401 Vali Acc: 0.870 Test Loss: 0.401 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.203397750854492
Epoch: 41, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.392 Vali Acc: 0.884 Test Loss: 0.392 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 42 cost time: 3.1364364624023438
Epoch: 42, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.382 Vali Acc: 0.884 Test Loss: 0.382 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 43 cost time: 3.3605899810791016
Epoch: 43, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.390 Vali Acc: 0.884 Test Loss: 0.390 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.417572259902954
Epoch: 44, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.382 Vali Acc: 0.877 Test Loss: 0.382 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.2383229732513428
Epoch: 45, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.393 Vali Acc: 0.877 Test Loss: 0.393 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.1542837619781494
Epoch: 46, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.392 Vali Acc: 0.884 Test Loss: 0.392 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 3.1052956581115723
Epoch: 47, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.388 Vali Acc: 0.884 Test Loss: 0.388 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 2.9472529888153076
Epoch: 48, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.392 Vali Acc: 0.884 Test Loss: 0.392 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 3.096611499786377
Epoch: 49, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.398 Vali Acc: 0.877 Test Loss: 0.398 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 3.0437278747558594
Epoch: 50, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.391 Vali Acc: 0.877 Test Loss: 0.391 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 3.1118087768554688
Epoch: 51, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.391 Vali Acc: 0.841 Test Loss: 0.391 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 3.2578210830688477
Epoch: 52, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.388 Vali Acc: 0.862 Test Loss: 0.388 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 462404
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.759295225143433
Epoch: 1, Steps: 9 | Train Loss: 1.447 Vali Loss: 1.358 Vali Acc: 0.312 Test Loss: 1.358 Test Acc: 0.312
Validation loss decreased (inf --> -0.311581).  Saving model ...
Epoch: 2 cost time: 3.2522571086883545
Epoch: 2, Steps: 9 | Train Loss: 1.317 Vali Loss: 1.247 Vali Acc: 0.500 Test Loss: 1.247 Test Acc: 0.500
Validation loss decreased (-0.311581 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 3.3282313346862793
Epoch: 3, Steps: 9 | Train Loss: 1.145 Vali Loss: 1.119 Vali Acc: 0.572 Test Loss: 1.119 Test Acc: 0.572
Validation loss decreased (-0.499988 --> -0.572453).  Saving model ...
Epoch: 4 cost time: 3.280939817428589
Epoch: 4, Steps: 9 | Train Loss: 0.974 Vali Loss: 0.997 Vali Acc: 0.667 Test Loss: 0.997 Test Acc: 0.667
Validation loss decreased (-0.572453 --> -0.666657).  Saving model ...
Epoch: 5 cost time: 3.0838983058929443
Epoch: 5, Steps: 9 | Train Loss: 0.780 Vali Loss: 0.884 Vali Acc: 0.688 Test Loss: 0.884 Test Acc: 0.688
Validation loss decreased (-0.666657 --> -0.688397).  Saving model ...
Epoch: 6 cost time: 3.080050230026245
Epoch: 6, Steps: 9 | Train Loss: 0.659 Vali Loss: 0.770 Vali Acc: 0.761 Test Loss: 0.770 Test Acc: 0.761
Validation loss decreased (-0.688397 --> -0.760862).  Saving model ...
Epoch: 7 cost time: 3.292424201965332
Epoch: 7, Steps: 9 | Train Loss: 0.512 Vali Loss: 0.707 Vali Acc: 0.746 Test Loss: 0.707 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.35542368888855
Epoch: 8, Steps: 9 | Train Loss: 0.397 Vali Loss: 0.640 Vali Acc: 0.783 Test Loss: 0.640 Test Acc: 0.783
Validation loss decreased (-0.760862 --> -0.782602).  Saving model ...
Epoch: 9 cost time: 3.294813871383667
Epoch: 9, Steps: 9 | Train Loss: 0.329 Vali Loss: 0.585 Vali Acc: 0.826 Test Loss: 0.585 Test Acc: 0.826
Validation loss decreased (-0.782602 --> -0.826081).  Saving model ...
Epoch: 10 cost time: 3.2486026287078857
Epoch: 10, Steps: 9 | Train Loss: 0.260 Vali Loss: 0.572 Vali Acc: 0.804 Test Loss: 0.572 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.4967968463897705
Epoch: 11, Steps: 9 | Train Loss: 0.217 Vali Loss: 0.521 Vali Acc: 0.804 Test Loss: 0.521 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.3264386653900146
Epoch: 12, Steps: 9 | Train Loss: 0.182 Vali Loss: 0.555 Vali Acc: 0.783 Test Loss: 0.555 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.4764363765716553
Epoch: 13, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.501 Vali Acc: 0.819 Test Loss: 0.501 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.3859801292419434
Epoch: 14, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.494 Vali Acc: 0.833 Test Loss: 0.494 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833328).  Saving model ...
Epoch: 15 cost time: 3.582624912261963
Epoch: 15, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.490 Vali Acc: 0.797 Test Loss: 0.490 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.525338888168335
Epoch: 16, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.492 Vali Acc: 0.841 Test Loss: 0.492 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840575).  Saving model ...
Epoch: 17 cost time: 3.2705111503601074
Epoch: 17, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.500 Vali Acc: 0.833 Test Loss: 0.500 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.992070436477661
Epoch: 18, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.498 Vali Acc: 0.812 Test Loss: 0.498 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.159046173095703
Epoch: 19, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.497 Vali Acc: 0.833 Test Loss: 0.497 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.044321298599243
Epoch: 20, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.509 Vali Acc: 0.848 Test Loss: 0.509 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 21 cost time: 3.384467363357544
Epoch: 21, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.500 Vali Acc: 0.833 Test Loss: 0.500 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.022892951965332
Epoch: 22, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.493 Vali Acc: 0.819 Test Loss: 0.493 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.223416328430176
Epoch: 23, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.523 Vali Acc: 0.826 Test Loss: 0.523 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.374267101287842
Epoch: 24, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.514 Vali Acc: 0.833 Test Loss: 0.514 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.3290538787841797
Epoch: 25, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.503 Vali Acc: 0.833 Test Loss: 0.503 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.322089672088623
Epoch: 26, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.513 Vali Acc: 0.833 Test Loss: 0.513 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.2061619758605957
Epoch: 27, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.525 Vali Acc: 0.819 Test Loss: 0.525 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.3755550384521484
Epoch: 28, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.515 Vali Acc: 0.833 Test Loss: 0.515 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.210474967956543
Epoch: 29, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.517 Vali Acc: 0.833 Test Loss: 0.517 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.0879619121551514
Epoch: 30, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.526 Vali Acc: 0.819 Test Loss: 0.526 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 462404
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.510568857192993
Epoch: 1, Steps: 9 | Train Loss: 1.422 Vali Loss: 1.400 Vali Acc: 0.283 Test Loss: 1.400 Test Acc: 0.283
Validation loss decreased (inf --> -0.282595).  Saving model ...
Epoch: 2 cost time: 3.066232442855835
Epoch: 2, Steps: 9 | Train Loss: 1.350 Vali Loss: 1.378 Vali Acc: 0.290 Test Loss: 1.378 Test Acc: 0.290
Validation loss decreased (-0.282595 --> -0.289841).  Saving model ...
Epoch: 3 cost time: 2.9337167739868164
Epoch: 3, Steps: 9 | Train Loss: 1.234 Vali Loss: 1.341 Vali Acc: 0.348 Test Loss: 1.341 Test Acc: 0.348
Validation loss decreased (-0.289841 --> -0.347813).  Saving model ...
Epoch: 4 cost time: 3.0258703231811523
Epoch: 4, Steps: 9 | Train Loss: 1.159 Vali Loss: 1.300 Vali Acc: 0.420 Test Loss: 1.300 Test Acc: 0.420
Validation loss decreased (-0.347813 --> -0.420277).  Saving model ...
Epoch: 5 cost time: 3.1305627822875977
Epoch: 5, Steps: 9 | Train Loss: 1.009 Vali Loss: 1.248 Vali Acc: 0.406 Test Loss: 1.248 Test Acc: 0.406
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.328702449798584
Epoch: 6, Steps: 9 | Train Loss: 0.904 Vali Loss: 1.196 Vali Acc: 0.457 Test Loss: 1.196 Test Acc: 0.457
Validation loss decreased (-0.420277 --> -0.456510).  Saving model ...
Epoch: 7 cost time: 3.06095552444458
Epoch: 7, Steps: 9 | Train Loss: 0.807 Vali Loss: 1.159 Vali Acc: 0.457 Test Loss: 1.159 Test Acc: 0.457
Validation loss decreased (-0.456510 --> -0.456510).  Saving model ...
Epoch: 8 cost time: 3.228769540786743
Epoch: 8, Steps: 9 | Train Loss: 0.683 Vali Loss: 1.111 Vali Acc: 0.500 Test Loss: 1.111 Test Acc: 0.500
Validation loss decreased (-0.456510 --> -0.499989).  Saving model ...
Epoch: 9 cost time: 3.2472782135009766
Epoch: 9, Steps: 9 | Train Loss: 0.587 Vali Loss: 1.122 Vali Acc: 0.464 Test Loss: 1.122 Test Acc: 0.464
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.304964065551758
Epoch: 10, Steps: 9 | Train Loss: 0.463 Vali Loss: 1.101 Vali Acc: 0.471 Test Loss: 1.101 Test Acc: 0.471
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.0251357555389404
Epoch: 11, Steps: 9 | Train Loss: 0.407 Vali Loss: 1.169 Vali Acc: 0.457 Test Loss: 1.169 Test Acc: 0.457
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.3421084880828857
Epoch: 12, Steps: 9 | Train Loss: 0.354 Vali Loss: 1.130 Vali Acc: 0.478 Test Loss: 1.130 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.250549554824829
Epoch: 13, Steps: 9 | Train Loss: 0.277 Vali Loss: 1.266 Vali Acc: 0.449 Test Loss: 1.266 Test Acc: 0.449
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.3017022609710693
Epoch: 14, Steps: 9 | Train Loss: 0.238 Vali Loss: 1.197 Vali Acc: 0.457 Test Loss: 1.197 Test Acc: 0.457
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.3426475524902344
Epoch: 15, Steps: 9 | Train Loss: 0.171 Vali Loss: 1.315 Vali Acc: 0.449 Test Loss: 1.315 Test Acc: 0.449
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.374638319015503
Epoch: 16, Steps: 9 | Train Loss: 0.141 Vali Loss: 1.229 Vali Acc: 0.478 Test Loss: 1.229 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.5881669521331787
Epoch: 17, Steps: 9 | Train Loss: 0.125 Vali Loss: 1.364 Vali Acc: 0.478 Test Loss: 1.364 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.522819757461548
Epoch: 18, Steps: 9 | Train Loss: 0.096 Vali Loss: 1.455 Vali Acc: 0.464 Test Loss: 1.455 Test Acc: 0.464
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5
model parameter : 462404
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.443634033203125
Epoch: 1, Steps: 9 | Train Loss: 1.438 Vali Loss: 1.419 Vali Acc: 0.283 Test Loss: 1.419 Test Acc: 0.283
Validation loss decreased (inf --> -0.282595).  Saving model ...
Epoch: 2 cost time: 3.6982421875
Epoch: 2, Steps: 9 | Train Loss: 1.389 Vali Loss: 1.421 Vali Acc: 0.283 Test Loss: 1.421 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.551841974258423
Epoch: 3, Steps: 9 | Train Loss: 1.339 Vali Loss: 1.428 Vali Acc: 0.312 Test Loss: 1.428 Test Acc: 0.312
Validation loss decreased (-0.282595 --> -0.311580).  Saving model ...
Epoch: 4 cost time: 3.4642486572265625
Epoch: 4, Steps: 9 | Train Loss: 1.278 Vali Loss: 1.438 Vali Acc: 0.304 Test Loss: 1.438 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.3593039512634277
Epoch: 5, Steps: 9 | Train Loss: 1.204 Vali Loss: 1.431 Vali Acc: 0.297 Test Loss: 1.431 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.365337371826172
Epoch: 6, Steps: 9 | Train Loss: 1.118 Vali Loss: 1.439 Vali Acc: 0.326 Test Loss: 1.439 Test Acc: 0.326
Validation loss decreased (-0.311580 --> -0.326073).  Saving model ...
Epoch: 7 cost time: 3.223430633544922
Epoch: 7, Steps: 9 | Train Loss: 1.034 Vali Loss: 1.503 Vali Acc: 0.319 Test Loss: 1.503 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.6080572605133057
Epoch: 8, Steps: 9 | Train Loss: 0.933 Vali Loss: 1.533 Vali Acc: 0.297 Test Loss: 1.533 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.5456364154815674
Epoch: 9, Steps: 9 | Train Loss: 0.823 Vali Loss: 1.695 Vali Acc: 0.304 Test Loss: 1.695 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.314467668533325
Epoch: 10, Steps: 9 | Train Loss: 0.733 Vali Loss: 1.796 Vali Acc: 0.297 Test Loss: 1.796 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.462254524230957
Epoch: 11, Steps: 9 | Train Loss: 0.668 Vali Loss: 1.933 Vali Acc: 0.304 Test Loss: 1.933 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.481980800628662
Epoch: 12, Steps: 9 | Train Loss: 0.560 Vali Loss: 2.024 Vali Acc: 0.312 Test Loss: 2.024 Test Acc: 0.312
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.2025818824768066
Epoch: 13, Steps: 9 | Train Loss: 0.493 Vali Loss: 2.235 Vali Acc: 0.304 Test Loss: 2.235 Test Acc: 0.304
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.402066707611084
Epoch: 14, Steps: 9 | Train Loss: 0.394 Vali Loss: 2.247 Vali Acc: 0.304 Test Loss: 2.247 Test Acc: 0.304
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.1764004230499268
Epoch: 15, Steps: 9 | Train Loss: 0.332 Vali Loss: 2.506 Vali Acc: 0.290 Test Loss: 2.506 Test Acc: 0.290
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.373751163482666
Epoch: 16, Steps: 9 | Train Loss: 0.296 Vali Loss: 2.382 Vali Acc: 0.304 Test Loss: 2.382 Test Acc: 0.304
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.32608695652173914
model parameter : 462404
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.363475561141968
Epoch: 1, Steps: 9 | Train Loss: 1.420 Vali Loss: 1.347 Vali Acc: 0.370 Test Loss: 1.347 Test Acc: 0.370
Validation loss decreased (inf --> -0.369552).  Saving model ...
Epoch: 2 cost time: 2.8337786197662354
Epoch: 2, Steps: 9 | Train Loss: 1.354 Vali Loss: 1.346 Vali Acc: 0.341 Test Loss: 1.346 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.90928316116333
Epoch: 3, Steps: 9 | Train Loss: 1.308 Vali Loss: 1.341 Vali Acc: 0.348 Test Loss: 1.341 Test Acc: 0.348
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.3156020641326904
Epoch: 4, Steps: 9 | Train Loss: 1.233 Vali Loss: 1.331 Vali Acc: 0.348 Test Loss: 1.331 Test Acc: 0.348
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.519252061843872
Epoch: 5, Steps: 9 | Train Loss: 1.152 Vali Loss: 1.308 Vali Acc: 0.377 Test Loss: 1.308 Test Acc: 0.377
Validation loss decreased (-0.369552 --> -0.376799).  Saving model ...
Epoch: 6 cost time: 3.4163520336151123
Epoch: 6, Steps: 9 | Train Loss: 1.035 Vali Loss: 1.288 Vali Acc: 0.370 Test Loss: 1.288 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.481590270996094
Epoch: 7, Steps: 9 | Train Loss: 0.954 Vali Loss: 1.293 Vali Acc: 0.384 Test Loss: 1.293 Test Acc: 0.384
Validation loss decreased (-0.376799 --> -0.384045).  Saving model ...
Epoch: 8 cost time: 3.595191717147827
Epoch: 8, Steps: 9 | Train Loss: 0.851 Vali Loss: 1.265 Vali Acc: 0.370 Test Loss: 1.265 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.7102766036987305
Epoch: 9, Steps: 9 | Train Loss: 0.744 Vali Loss: 1.317 Vali Acc: 0.362 Test Loss: 1.317 Test Acc: 0.362
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.1314456462860107
Epoch: 10, Steps: 9 | Train Loss: 0.638 Vali Loss: 1.364 Vali Acc: 0.355 Test Loss: 1.364 Test Acc: 0.355
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.523822546005249
Epoch: 11, Steps: 9 | Train Loss: 0.548 Vali Loss: 1.382 Vali Acc: 0.362 Test Loss: 1.382 Test Acc: 0.362
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.235473394393921
Epoch: 12, Steps: 9 | Train Loss: 0.457 Vali Loss: 1.441 Vali Acc: 0.341 Test Loss: 1.441 Test Acc: 0.341
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.086063861846924
Epoch: 13, Steps: 9 | Train Loss: 0.392 Vali Loss: 1.545 Vali Acc: 0.341 Test Loss: 1.545 Test Acc: 0.341
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.7043070793151855
Epoch: 14, Steps: 9 | Train Loss: 0.321 Vali Loss: 1.519 Vali Acc: 0.348 Test Loss: 1.519 Test Acc: 0.348
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.780550718307495
Epoch: 15, Steps: 9 | Train Loss: 0.257 Vali Loss: 1.675 Vali Acc: 0.370 Test Loss: 1.675 Test Acc: 0.370
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.8366589546203613
Epoch: 16, Steps: 9 | Train Loss: 0.211 Vali Loss: 1.474 Vali Acc: 0.333 Test Loss: 1.474 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.581996202468872
Epoch: 17, Steps: 9 | Train Loss: 0.182 Vali Loss: 1.851 Vali Acc: 0.319 Test Loss: 1.851 Test Acc: 0.319
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.38405797101449274
model parameter : 462404
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         103                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma103_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.728306293487549
Epoch: 1, Steps: 9 | Train Loss: 1.402 Vali Loss: 1.365 Vali Acc: 0.333 Test Loss: 1.365 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 3.1608810424804688
Epoch: 2, Steps: 9 | Train Loss: 1.334 Vali Loss: 1.295 Vali Acc: 0.420 Test Loss: 1.295 Test Acc: 0.420
Validation loss decreased (-0.333320 --> -0.420277).  Saving model ...
Epoch: 3 cost time: 2.89322829246521
Epoch: 3, Steps: 9 | Train Loss: 1.216 Vali Loss: 1.215 Vali Acc: 0.464 Test Loss: 1.215 Test Acc: 0.464
Validation loss decreased (-0.420277 --> -0.463756).  Saving model ...
Epoch: 4 cost time: 3.2023611068725586
Epoch: 4, Steps: 9 | Train Loss: 1.052 Vali Loss: 1.115 Vali Acc: 0.572 Test Loss: 1.115 Test Acc: 0.572
Validation loss decreased (-0.463756 --> -0.572453).  Saving model ...
Epoch: 5 cost time: 3.107103109359741
Epoch: 5, Steps: 9 | Train Loss: 0.902 Vali Loss: 1.024 Vali Acc: 0.616 Test Loss: 1.024 Test Acc: 0.616
Validation loss decreased (-0.572453 --> -0.615932).  Saving model ...
Epoch: 6 cost time: 3.110581874847412
Epoch: 6, Steps: 9 | Train Loss: 0.728 Vali Loss: 0.919 Vali Acc: 0.681 Test Loss: 0.919 Test Acc: 0.681
Validation loss decreased (-0.615932 --> -0.681150).  Saving model ...
Epoch: 7 cost time: 3.1326589584350586
Epoch: 7, Steps: 9 | Train Loss: 0.587 Vali Loss: 0.822 Vali Acc: 0.710 Test Loss: 0.822 Test Acc: 0.710
Validation loss decreased (-0.681150 --> -0.710137).  Saving model ...
Epoch: 8 cost time: 3.138704299926758
Epoch: 8, Steps: 9 | Train Loss: 0.438 Vali Loss: 0.726 Vali Acc: 0.761 Test Loss: 0.726 Test Acc: 0.761
Validation loss decreased (-0.710137 --> -0.760862).  Saving model ...
Epoch: 9 cost time: 3.0428712368011475
Epoch: 9, Steps: 9 | Train Loss: 0.311 Vali Loss: 0.640 Vali Acc: 0.797 Test Loss: 0.640 Test Acc: 0.797
Validation loss decreased (-0.760862 --> -0.797095).  Saving model ...
Epoch: 10 cost time: 3.3086440563201904
Epoch: 10, Steps: 9 | Train Loss: 0.245 Vali Loss: 0.560 Vali Acc: 0.826 Test Loss: 0.560 Test Acc: 0.826
Validation loss decreased (-0.797095 --> -0.826081).  Saving model ...
Epoch: 11 cost time: 3.114246368408203
Epoch: 11, Steps: 9 | Train Loss: 0.158 Vali Loss: 0.518 Vali Acc: 0.826 Test Loss: 0.518 Test Acc: 0.826
Validation loss decreased (-0.826081 --> -0.826082).  Saving model ...
Epoch: 12 cost time: 3.238140106201172
Epoch: 12, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.483 Vali Acc: 0.833 Test Loss: 0.483 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833329).  Saving model ...
Epoch: 13 cost time: 3.3695218563079834
Epoch: 13, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.449 Vali Acc: 0.833 Test Loss: 0.449 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 14 cost time: 3.396596908569336
Epoch: 14, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.464 Vali Acc: 0.862 Test Loss: 0.464 Test Acc: 0.862
Validation loss decreased (-0.833329 --> -0.862314).  Saving model ...
Epoch: 15 cost time: 3.2826249599456787
Epoch: 15, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.412 Vali Acc: 0.841 Test Loss: 0.412 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.2744898796081543
Epoch: 16, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.421 Vali Acc: 0.862 Test Loss: 0.421 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862315).  Saving model ...
Epoch: 17 cost time: 3.0949010848999023
Epoch: 17, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.433 Vali Acc: 0.862 Test Loss: 0.433 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.2272753715515137
Epoch: 18, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.412 Vali Acc: 0.855 Test Loss: 0.412 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.1333038806915283
Epoch: 19, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.426 Vali Acc: 0.841 Test Loss: 0.426 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.2829792499542236
Epoch: 20, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.417 Vali Acc: 0.855 Test Loss: 0.417 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.2412607669830322
Epoch: 21, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.413 Vali Acc: 0.862 Test Loss: 0.413 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 22 cost time: 3.2652127742767334
Epoch: 22, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.405 Vali Acc: 0.855 Test Loss: 0.405 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.3639864921569824
Epoch: 23, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.416 Vali Acc: 0.862 Test Loss: 0.416 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.3547544479370117
Epoch: 24, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.426 Vali Acc: 0.870 Test Loss: 0.426 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 25 cost time: 3.5497868061065674
Epoch: 25, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.418 Vali Acc: 0.877 Test Loss: 0.418 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 26 cost time: 3.5385959148406982
Epoch: 26, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.406 Vali Acc: 0.870 Test Loss: 0.406 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.358025550842285
Epoch: 27, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.409 Vali Acc: 0.862 Test Loss: 0.409 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.392861843109131
Epoch: 28, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.411 Vali Acc: 0.870 Test Loss: 0.411 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.4742677211761475
Epoch: 29, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.405 Vali Acc: 0.877 Test Loss: 0.405 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876808).  Saving model ...
Epoch: 30 cost time: 3.16310977935791
Epoch: 30, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.401 Vali Acc: 0.884 Test Loss: 0.401 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 31 cost time: 3.2479069232940674
Epoch: 31, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.398 Vali Acc: 0.884 Test Loss: 0.398 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 32 cost time: 3.1260321140289307
Epoch: 32, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.420 Vali Acc: 0.870 Test Loss: 0.420 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.239675521850586
Epoch: 33, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.414 Vali Acc: 0.870 Test Loss: 0.414 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.058364152908325
Epoch: 34, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.403 Vali Acc: 0.884 Test Loss: 0.403 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.1545794010162354
Epoch: 35, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.404 Vali Acc: 0.862 Test Loss: 0.404 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.086397647857666
Epoch: 36, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.412 Vali Acc: 0.870 Test Loss: 0.412 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.328348398208618
Epoch: 37, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.420 Vali Acc: 0.870 Test Loss: 0.420 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.2288522720336914
Epoch: 38, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.420 Vali Acc: 0.862 Test Loss: 0.420 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.0599417686462402
Epoch: 39, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.414 Vali Acc: 0.862 Test Loss: 0.414 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.2237329483032227
Epoch: 40, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.411 Vali Acc: 0.870 Test Loss: 0.411 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 3.1148526668548584
Epoch: 41, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.412 Vali Acc: 0.884 Test Loss: 0.412 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma103_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 265796
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         83                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma83_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.495912790298462
Epoch: 1, Steps: 9 | Train Loss: 1.411 Vali Loss: 1.376 Vali Acc: 0.333 Test Loss: 1.376 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 2.925045967102051
Epoch: 2, Steps: 9 | Train Loss: 1.335 Vali Loss: 1.307 Vali Acc: 0.391 Test Loss: 1.307 Test Acc: 0.391
Validation loss decreased (-0.333320 --> -0.391291).  Saving model ...
Epoch: 3 cost time: 3.0338165760040283
Epoch: 3, Steps: 9 | Train Loss: 1.222 Vali Loss: 1.230 Vali Acc: 0.442 Test Loss: 1.230 Test Acc: 0.442
Validation loss decreased (-0.391291 --> -0.442017).  Saving model ...
Epoch: 4 cost time: 2.9849376678466797
Epoch: 4, Steps: 9 | Train Loss: 1.063 Vali Loss: 1.130 Vali Acc: 0.551 Test Loss: 1.130 Test Acc: 0.551
Validation loss decreased (-0.442017 --> -0.550713).  Saving model ...
Epoch: 5 cost time: 3.017991304397583
Epoch: 5, Steps: 9 | Train Loss: 0.917 Vali Loss: 1.038 Vali Acc: 0.594 Test Loss: 1.038 Test Acc: 0.594
Validation loss decreased (-0.550713 --> -0.594193).  Saving model ...
Epoch: 6 cost time: 3.0969226360321045
Epoch: 6, Steps: 9 | Train Loss: 0.743 Vali Loss: 0.934 Vali Acc: 0.674 Test Loss: 0.934 Test Acc: 0.674
Validation loss decreased (-0.594193 --> -0.673904).  Saving model ...
Epoch: 7 cost time: 3.3564248085021973
Epoch: 7, Steps: 9 | Train Loss: 0.600 Vali Loss: 0.831 Vali Acc: 0.732 Test Loss: 0.831 Test Acc: 0.732
Validation loss decreased (-0.673904 --> -0.731876).  Saving model ...
Epoch: 8 cost time: 3.157045364379883
Epoch: 8, Steps: 9 | Train Loss: 0.449 Vali Loss: 0.736 Vali Acc: 0.761 Test Loss: 0.736 Test Acc: 0.761
Validation loss decreased (-0.731876 --> -0.760862).  Saving model ...
Epoch: 9 cost time: 3.1106948852539062
Epoch: 9, Steps: 9 | Train Loss: 0.322 Vali Loss: 0.646 Vali Acc: 0.804 Test Loss: 0.646 Test Acc: 0.804
Validation loss decreased (-0.760862 --> -0.804341).  Saving model ...
Epoch: 10 cost time: 3.1531856060028076
Epoch: 10, Steps: 9 | Train Loss: 0.254 Vali Loss: 0.571 Vali Acc: 0.812 Test Loss: 0.571 Test Acc: 0.812
Validation loss decreased (-0.804341 --> -0.811588).  Saving model ...
Epoch: 11 cost time: 3.270939350128174
Epoch: 11, Steps: 9 | Train Loss: 0.162 Vali Loss: 0.518 Vali Acc: 0.797 Test Loss: 0.518 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.5659492015838623
Epoch: 12, Steps: 9 | Train Loss: 0.126 Vali Loss: 0.484 Vali Acc: 0.841 Test Loss: 0.484 Test Acc: 0.841
Validation loss decreased (-0.811588 --> -0.840575).  Saving model ...
Epoch: 13 cost time: 3.0921671390533447
Epoch: 13, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.443 Vali Acc: 0.848 Test Loss: 0.443 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 14 cost time: 3.1838343143463135
Epoch: 14, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.456 Vali Acc: 0.826 Test Loss: 0.456 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.067718505859375
Epoch: 15, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.403 Vali Acc: 0.862 Test Loss: 0.403 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862315).  Saving model ...
Epoch: 16 cost time: 3.2201664447784424
Epoch: 16, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.413 Vali Acc: 0.870 Test Loss: 0.413 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 17 cost time: 3.073974370956421
Epoch: 17, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.419 Vali Acc: 0.877 Test Loss: 0.419 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 18 cost time: 3.161977529525757
Epoch: 18, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.397 Vali Acc: 0.862 Test Loss: 0.397 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.349625587463379
Epoch: 19, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.413 Vali Acc: 0.877 Test Loss: 0.413 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 20 cost time: 3.3289546966552734
Epoch: 20, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.402 Vali Acc: 0.855 Test Loss: 0.402 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.218078136444092
Epoch: 21, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.397 Vali Acc: 0.870 Test Loss: 0.397 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.3896000385284424
Epoch: 22, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.388 Vali Acc: 0.870 Test Loss: 0.388 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.4569711685180664
Epoch: 23, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.393 Vali Acc: 0.870 Test Loss: 0.393 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.303351402282715
Epoch: 24, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.408 Vali Acc: 0.870 Test Loss: 0.408 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.3101372718811035
Epoch: 25, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.399 Vali Acc: 0.870 Test Loss: 0.399 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.1559271812438965
Epoch: 26, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.384 Vali Acc: 0.870 Test Loss: 0.384 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.2394747734069824
Epoch: 27, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.391 Vali Acc: 0.877 Test Loss: 0.391 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876808).  Saving model ...
Epoch: 28 cost time: 3.040278196334839
Epoch: 28, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.396 Vali Acc: 0.877 Test Loss: 0.396 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.042797803878784
Epoch: 29, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.389 Vali Acc: 0.870 Test Loss: 0.389 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.116260528564453
Epoch: 30, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.380 Vali Acc: 0.877 Test Loss: 0.380 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 31 cost time: 3.1712610721588135
Epoch: 31, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.373 Vali Acc: 0.877 Test Loss: 0.373 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 32 cost time: 3.1852123737335205
Epoch: 32, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.395 Vali Acc: 0.884 Test Loss: 0.395 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884054).  Saving model ...
Epoch: 33 cost time: 3.7059824466705322
Epoch: 33, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.389 Vali Acc: 0.884 Test Loss: 0.389 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 34 cost time: 3.483182668685913
Epoch: 34, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.383 Vali Acc: 0.877 Test Loss: 0.383 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.5999417304992676
Epoch: 35, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.386 Vali Acc: 0.870 Test Loss: 0.386 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.4747073650360107
Epoch: 36, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.388 Vali Acc: 0.884 Test Loss: 0.388 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 37 cost time: 3.5466151237487793
Epoch: 37, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.393 Vali Acc: 0.884 Test Loss: 0.393 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.644451379776001
Epoch: 38, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.397 Vali Acc: 0.877 Test Loss: 0.397 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.452287197113037
Epoch: 39, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.393 Vali Acc: 0.884 Test Loss: 0.393 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.615511655807495
Epoch: 40, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.384 Vali Acc: 0.870 Test Loss: 0.384 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 3.400452136993408
Epoch: 41, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.386 Vali Acc: 0.877 Test Loss: 0.386 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 3.4954659938812256
Epoch: 42, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.389 Vali Acc: 0.877 Test Loss: 0.389 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 3.5201244354248047
Epoch: 43, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.397 Vali Acc: 0.891 Test Loss: 0.397 Test Acc: 0.891
Validation loss decreased (-0.884054 --> -0.891300).  Saving model ...
Epoch: 44 cost time: 3.5586578845977783
Epoch: 44, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.404 Vali Acc: 0.891 Test Loss: 0.404 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.880650758743286
Epoch: 45, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.399 Vali Acc: 0.884 Test Loss: 0.399 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 3.328035593032837
Epoch: 46, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.406 Vali Acc: 0.884 Test Loss: 0.406 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 3.739361524581909
Epoch: 47, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.393 Vali Acc: 0.877 Test Loss: 0.393 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 3.4661898612976074
Epoch: 48, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.386 Vali Acc: 0.877 Test Loss: 0.386 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 3.439112901687622
Epoch: 49, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.403 Vali Acc: 0.891 Test Loss: 0.403 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 3.59220552444458
Epoch: 50, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.409 Vali Acc: 0.899 Test Loss: 0.409 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898547).  Saving model ...
Epoch: 51 cost time: 3.4530739784240723
Epoch: 51, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.400 Vali Acc: 0.891 Test Loss: 0.400 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 3.8365638256073
Epoch: 52, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.396 Vali Acc: 0.884 Test Loss: 0.396 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 3.4807515144348145
Epoch: 53, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.406 Vali Acc: 0.884 Test Loss: 0.406 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 3.945483446121216
Epoch: 54, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.401 Vali Acc: 0.884 Test Loss: 0.401 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 3.46960186958313
Epoch: 55, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.401 Vali Acc: 0.870 Test Loss: 0.401 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 3.6152727603912354
Epoch: 56, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.405 Vali Acc: 0.877 Test Loss: 0.405 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 3.524562358856201
Epoch: 57, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.409 Vali Acc: 0.899 Test Loss: 0.409 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 3.3093535900115967
Epoch: 58, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.408 Vali Acc: 0.891 Test Loss: 0.408 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 3.4585630893707275
Epoch: 59, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.406 Vali Acc: 0.884 Test Loss: 0.406 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 3.3221700191497803
Epoch: 60, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.404 Vali Acc: 0.884 Test Loss: 0.404 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma83_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 265796
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         62                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma62_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.598215818405151
Epoch: 1, Steps: 9 | Train Loss: 1.435 Vali Loss: 1.387 Vali Acc: 0.268 Test Loss: 1.387 Test Acc: 0.268
Validation loss decreased (inf --> -0.268102).  Saving model ...
Epoch: 2 cost time: 3.178941488265991
Epoch: 2, Steps: 9 | Train Loss: 1.350 Vali Loss: 1.317 Vali Acc: 0.413 Test Loss: 1.317 Test Acc: 0.413
Validation loss decreased (-0.268102 --> -0.413030).  Saving model ...
Epoch: 3 cost time: 3.1514368057250977
Epoch: 3, Steps: 9 | Train Loss: 1.231 Vali Loss: 1.236 Vali Acc: 0.435 Test Loss: 1.236 Test Acc: 0.435
Validation loss decreased (-0.413030 --> -0.434770).  Saving model ...
Epoch: 4 cost time: 3.4917256832122803
Epoch: 4, Steps: 9 | Train Loss: 1.081 Vali Loss: 1.129 Vali Acc: 0.572 Test Loss: 1.129 Test Acc: 0.572
Validation loss decreased (-0.434770 --> -0.572452).  Saving model ...
Epoch: 5 cost time: 3.3791086673736572
Epoch: 5, Steps: 9 | Train Loss: 0.907 Vali Loss: 1.029 Vali Acc: 0.659 Test Loss: 1.029 Test Acc: 0.659
Validation loss decreased (-0.572452 --> -0.659410).  Saving model ...
Epoch: 6 cost time: 3.3054347038269043
Epoch: 6, Steps: 9 | Train Loss: 0.730 Vali Loss: 0.916 Vali Acc: 0.703 Test Loss: 0.916 Test Acc: 0.703
Validation loss decreased (-0.659410 --> -0.702889).  Saving model ...
Epoch: 7 cost time: 3.1446385383605957
Epoch: 7, Steps: 9 | Train Loss: 0.574 Vali Loss: 0.811 Vali Acc: 0.761 Test Loss: 0.811 Test Acc: 0.761
Validation loss decreased (-0.702889 --> -0.760861).  Saving model ...
Epoch: 8 cost time: 2.986013412475586
Epoch: 8, Steps: 9 | Train Loss: 0.421 Vali Loss: 0.701 Vali Acc: 0.797 Test Loss: 0.701 Test Acc: 0.797
Validation loss decreased (-0.760861 --> -0.797094).  Saving model ...
Epoch: 9 cost time: 3.4868311882019043
Epoch: 9, Steps: 9 | Train Loss: 0.297 Vali Loss: 0.617 Vali Acc: 0.826 Test Loss: 0.617 Test Acc: 0.826
Validation loss decreased (-0.797094 --> -0.826081).  Saving model ...
Epoch: 10 cost time: 3.2694432735443115
Epoch: 10, Steps: 9 | Train Loss: 0.233 Vali Loss: 0.538 Vali Acc: 0.855 Test Loss: 0.538 Test Acc: 0.855
Validation loss decreased (-0.826081 --> -0.855067).  Saving model ...
Epoch: 11 cost time: 3.10837984085083
Epoch: 11, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.488 Vali Acc: 0.877 Test Loss: 0.488 Test Acc: 0.877
Validation loss decreased (-0.855067 --> -0.876807).  Saving model ...
Epoch: 12 cost time: 3.2296841144561768
Epoch: 12, Steps: 9 | Train Loss: 0.109 Vali Loss: 0.463 Vali Acc: 0.870 Test Loss: 0.463 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.092803955078125
Epoch: 13, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.425 Vali Acc: 0.870 Test Loss: 0.425 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.1904397010803223
Epoch: 14, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.434 Vali Acc: 0.906 Test Loss: 0.434 Test Acc: 0.906
Validation loss decreased (-0.876807 --> -0.905793).  Saving model ...
Epoch: 15 cost time: 3.5031871795654297
Epoch: 15, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.398 Vali Acc: 0.877 Test Loss: 0.398 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.2787511348724365
Epoch: 16, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.403 Vali Acc: 0.899 Test Loss: 0.403 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.375211715698242
Epoch: 17, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.416 Vali Acc: 0.906 Test Loss: 0.416 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905793).  Saving model ...
Epoch: 18 cost time: 3.469204902648926
Epoch: 18, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.396 Vali Acc: 0.906 Test Loss: 0.396 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905793).  Saving model ...
Epoch: 19 cost time: 3.3573639392852783
Epoch: 19, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.406 Vali Acc: 0.899 Test Loss: 0.406 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.4420416355133057
Epoch: 20, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.403 Vali Acc: 0.906 Test Loss: 0.403 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.1452059745788574
Epoch: 21, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.397 Vali Acc: 0.906 Test Loss: 0.397 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.1798253059387207
Epoch: 22, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.390 Vali Acc: 0.891 Test Loss: 0.390 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.862642765045166
Epoch: 23, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.391 Vali Acc: 0.899 Test Loss: 0.391 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.2337212562561035
Epoch: 24, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.402 Vali Acc: 0.920 Test Loss: 0.402 Test Acc: 0.920
Validation loss decreased (-0.905793 --> -0.920286).  Saving model ...
Epoch: 25 cost time: 3.2861454486846924
Epoch: 25, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.396 Vali Acc: 0.920 Test Loss: 0.396 Test Acc: 0.920
Validation loss decreased (-0.920286 --> -0.920286).  Saving model ...
Epoch: 26 cost time: 3.6451191902160645
Epoch: 26, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.391 Vali Acc: 0.913 Test Loss: 0.391 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.3129472732543945
Epoch: 27, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.398 Vali Acc: 0.906 Test Loss: 0.398 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.4009318351745605
Epoch: 28, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.395 Vali Acc: 0.928 Test Loss: 0.395 Test Acc: 0.928
Validation loss decreased (-0.920286 --> -0.927532).  Saving model ...
Epoch: 29 cost time: 3.366981029510498
Epoch: 29, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.390 Vali Acc: 0.928 Test Loss: 0.390 Test Acc: 0.928
Validation loss decreased (-0.927532 --> -0.927532).  Saving model ...
Epoch: 30 cost time: 3.366032600402832
Epoch: 30, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.385 Vali Acc: 0.920 Test Loss: 0.385 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.4308934211730957
Epoch: 31, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.377 Vali Acc: 0.913 Test Loss: 0.377 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.5319619178771973
Epoch: 32, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.392 Vali Acc: 0.920 Test Loss: 0.392 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.3981826305389404
Epoch: 33, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.387 Vali Acc: 0.920 Test Loss: 0.387 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.2974815368652344
Epoch: 34, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.383 Vali Acc: 0.920 Test Loss: 0.383 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.3144655227661133
Epoch: 35, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.388 Vali Acc: 0.920 Test Loss: 0.388 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.2213730812072754
Epoch: 36, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.391 Vali Acc: 0.928 Test Loss: 0.391 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.231713056564331
Epoch: 37, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.394 Vali Acc: 0.920 Test Loss: 0.394 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 3.3814773559570312
Epoch: 38, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.394 Vali Acc: 0.928 Test Loss: 0.394 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 3.4209041595458984
Epoch: 39, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.390 Vali Acc: 0.920 Test Loss: 0.390 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma62_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.927536231884058
model parameter : 265796
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         42                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.5353453159332275
Epoch: 1, Steps: 9 | Train Loss: 1.446 Vali Loss: 1.398 Vali Acc: 0.304 Test Loss: 1.398 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 3.3442764282226562
Epoch: 2, Steps: 9 | Train Loss: 1.365 Vali Loss: 1.311 Vali Acc: 0.420 Test Loss: 1.311 Test Acc: 0.420
Validation loss decreased (-0.304334 --> -0.420277).  Saving model ...
Epoch: 3 cost time: 3.3343048095703125
Epoch: 3, Steps: 9 | Train Loss: 1.239 Vali Loss: 1.213 Vali Acc: 0.500 Test Loss: 1.213 Test Acc: 0.500
Validation loss decreased (-0.420277 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 2.906151056289673
Epoch: 4, Steps: 9 | Train Loss: 1.064 Vali Loss: 1.091 Vali Acc: 0.659 Test Loss: 1.091 Test Acc: 0.659
Validation loss decreased (-0.499988 --> -0.659409).  Saving model ...
Epoch: 5 cost time: 3.0390782356262207
Epoch: 5, Steps: 9 | Train Loss: 0.885 Vali Loss: 0.975 Vali Acc: 0.696 Test Loss: 0.975 Test Acc: 0.696
Validation loss decreased (-0.659409 --> -0.695642).  Saving model ...
Epoch: 6 cost time: 3.609262704849243
Epoch: 6, Steps: 9 | Train Loss: 0.697 Vali Loss: 0.855 Vali Acc: 0.717 Test Loss: 0.855 Test Acc: 0.717
Validation loss decreased (-0.695642 --> -0.717383).  Saving model ...
Epoch: 7 cost time: 3.046097755432129
Epoch: 7, Steps: 9 | Train Loss: 0.543 Vali Loss: 0.744 Vali Acc: 0.768 Test Loss: 0.744 Test Acc: 0.768
Validation loss decreased (-0.717383 --> -0.768109).  Saving model ...
Epoch: 8 cost time: 2.882453680038452
Epoch: 8, Steps: 9 | Train Loss: 0.394 Vali Loss: 0.637 Vali Acc: 0.790 Test Loss: 0.637 Test Acc: 0.790
Validation loss decreased (-0.768109 --> -0.789849).  Saving model ...
Epoch: 9 cost time: 3.7345521450042725
Epoch: 9, Steps: 9 | Train Loss: 0.271 Vali Loss: 0.564 Vali Acc: 0.848 Test Loss: 0.564 Test Acc: 0.848
Validation loss decreased (-0.789849 --> -0.847820).  Saving model ...
Epoch: 10 cost time: 3.6902196407318115
Epoch: 10, Steps: 9 | Train Loss: 0.218 Vali Loss: 0.486 Vali Acc: 0.870 Test Loss: 0.486 Test Acc: 0.870
Validation loss decreased (-0.847820 --> -0.869560).  Saving model ...
Epoch: 11 cost time: 3.7493951320648193
Epoch: 11, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.442 Vali Acc: 0.870 Test Loss: 0.442 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869561).  Saving model ...
Epoch: 12 cost time: 3.7765872478485107
Epoch: 12, Steps: 9 | Train Loss: 0.109 Vali Loss: 0.409 Vali Acc: 0.899 Test Loss: 0.409 Test Acc: 0.899
Validation loss decreased (-0.869561 --> -0.898547).  Saving model ...
Epoch: 13 cost time: 3.7353031635284424
Epoch: 13, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.377 Vali Acc: 0.913 Test Loss: 0.377 Test Acc: 0.913
Validation loss decreased (-0.898547 --> -0.913040).  Saving model ...
Epoch: 14 cost time: 3.7083990573883057
Epoch: 14, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.377 Vali Acc: 0.899 Test Loss: 0.377 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.4613418579101562
Epoch: 15, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.344 Vali Acc: 0.906 Test Loss: 0.344 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.656898260116577
Epoch: 16, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.354 Vali Acc: 0.906 Test Loss: 0.354 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.475713014602661
Epoch: 17, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.358 Vali Acc: 0.913 Test Loss: 0.358 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 18 cost time: 3.495251178741455
Epoch: 18, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.335 Vali Acc: 0.913 Test Loss: 0.335 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 19 cost time: 3.467034101486206
Epoch: 19, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.347 Vali Acc: 0.913 Test Loss: 0.347 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.6473915576934814
Epoch: 20, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.339 Vali Acc: 0.913 Test Loss: 0.339 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.5994558334350586
Epoch: 21, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.338 Vali Acc: 0.913 Test Loss: 0.338 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.2483904361724854
Epoch: 22, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.326 Vali Acc: 0.913 Test Loss: 0.326 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 23 cost time: 3.543520927429199
Epoch: 23, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.327 Vali Acc: 0.913 Test Loss: 0.327 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.3972153663635254
Epoch: 24, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.346 Vali Acc: 0.899 Test Loss: 0.346 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.458923816680908
Epoch: 25, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.336 Vali Acc: 0.913 Test Loss: 0.336 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.287370204925537
Epoch: 26, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.327 Vali Acc: 0.913 Test Loss: 0.327 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.452194929122925
Epoch: 27, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.340 Vali Acc: 0.906 Test Loss: 0.340 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.223308801651001
Epoch: 28, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.334 Vali Acc: 0.913 Test Loss: 0.334 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.3074612617492676
Epoch: 29, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.328 Vali Acc: 0.913 Test Loss: 0.328 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.172424554824829
Epoch: 30, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.315 Vali Acc: 0.906 Test Loss: 0.315 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.2333264350891113
Epoch: 31, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.315 Vali Acc: 0.913 Test Loss: 0.315 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 32 cost time: 3.1633880138397217
Epoch: 32, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.330 Vali Acc: 0.913 Test Loss: 0.330 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.124403715133667
Epoch: 33, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.319 Vali Acc: 0.913 Test Loss: 0.319 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.0825564861297607
Epoch: 34, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.312 Vali Acc: 0.913 Test Loss: 0.312 Test Acc: 0.913
Validation loss decreased (-0.913040 --> -0.913040).  Saving model ...
Epoch: 35 cost time: 3.180157423019409
Epoch: 35, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.322 Vali Acc: 0.913 Test Loss: 0.322 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.3803274631500244
Epoch: 36, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.328 Vali Acc: 0.913 Test Loss: 0.328 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.524714231491089
Epoch: 37, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.328 Vali Acc: 0.913 Test Loss: 0.328 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.452444553375244
Epoch: 38, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.327 Vali Acc: 0.913 Test Loss: 0.327 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.5362110137939453
Epoch: 39, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.326 Vali Acc: 0.920 Test Loss: 0.326 Test Acc: 0.920
Validation loss decreased (-0.913040 --> -0.920287).  Saving model ...
Epoch: 40 cost time: 3.6334848403930664
Epoch: 40, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.320 Vali Acc: 0.920 Test Loss: 0.320 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 41 cost time: 3.508746385574341
Epoch: 41, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.317 Vali Acc: 0.920 Test Loss: 0.317 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 42 cost time: 3.282381772994995
Epoch: 42, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.320 Vali Acc: 0.913 Test Loss: 0.320 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.5973215103149414
Epoch: 43, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.326 Vali Acc: 0.913 Test Loss: 0.326 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.5417141914367676
Epoch: 44, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.326 Vali Acc: 0.913 Test Loss: 0.326 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.420947790145874
Epoch: 45, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.322 Vali Acc: 0.913 Test Loss: 0.322 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 3.338238477706909
Epoch: 46, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.328 Vali Acc: 0.913 Test Loss: 0.328 Test Acc: 0.913
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 3.479145050048828
Epoch: 47, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.322 Vali Acc: 0.913 Test Loss: 0.322 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 3.6805152893066406
Epoch: 48, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.314 Vali Acc: 0.920 Test Loss: 0.314 Test Acc: 0.920
Validation loss decreased (-0.920287 --> -0.920287).  Saving model ...
Epoch: 49 cost time: 3.9958910942077637
Epoch: 49, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.326 Vali Acc: 0.920 Test Loss: 0.326 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.8698599338531494
Epoch: 50, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.327 Vali Acc: 0.913 Test Loss: 0.327 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 3.887296676635742
Epoch: 51, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.320 Vali Acc: 0.920 Test Loss: 0.320 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 3.9855594635009766
Epoch: 52, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.320 Vali Acc: 0.920 Test Loss: 0.320 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 3.727219581604004
Epoch: 53, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.328 Vali Acc: 0.920 Test Loss: 0.328 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 3.5083627700805664
Epoch: 54, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.322 Vali Acc: 0.920 Test Loss: 0.322 Test Acc: 0.920
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 3.3300609588623047
Epoch: 55, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.318 Vali Acc: 0.920 Test Loss: 0.318 Test Acc: 0.920
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 3.2286248207092285
Epoch: 56, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.321 Vali Acc: 0.920 Test Loss: 0.321 Test Acc: 0.920
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 3.242060899734497
Epoch: 57, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.323 Vali Acc: 0.920 Test Loss: 0.323 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 3.3565433025360107
Epoch: 58, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.323 Vali Acc: 0.920 Test Loss: 0.323 Test Acc: 0.920
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 265796
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.876861810684204
Epoch: 1, Steps: 9 | Train Loss: 1.424 Vali Loss: 1.386 Vali Acc: 0.297 Test Loss: 1.386 Test Acc: 0.297
Validation loss decreased (inf --> -0.297088).  Saving model ...
Epoch: 2 cost time: 3.2350337505340576
Epoch: 2, Steps: 9 | Train Loss: 1.337 Vali Loss: 1.312 Vali Acc: 0.428 Test Loss: 1.312 Test Acc: 0.428
Validation loss decreased (-0.297088 --> -0.427523).  Saving model ...
Epoch: 3 cost time: 3.1421446800231934
Epoch: 3, Steps: 9 | Train Loss: 1.215 Vali Loss: 1.223 Vali Acc: 0.486 Test Loss: 1.223 Test Acc: 0.486
Validation loss decreased (-0.427523 --> -0.485495).  Saving model ...
Epoch: 4 cost time: 3.141871452331543
Epoch: 4, Steps: 9 | Train Loss: 1.059 Vali Loss: 1.112 Vali Acc: 0.609 Test Loss: 1.112 Test Acc: 0.609
Validation loss decreased (-0.485495 --> -0.608685).  Saving model ...
Epoch: 5 cost time: 3.4356184005737305
Epoch: 5, Steps: 9 | Train Loss: 0.880 Vali Loss: 1.000 Vali Acc: 0.652 Test Loss: 1.000 Test Acc: 0.652
Validation loss decreased (-0.608685 --> -0.652164).  Saving model ...
Epoch: 6 cost time: 3.118760585784912
Epoch: 6, Steps: 9 | Train Loss: 0.710 Vali Loss: 0.876 Vali Acc: 0.717 Test Loss: 0.876 Test Acc: 0.717
Validation loss decreased (-0.652164 --> -0.717383).  Saving model ...
Epoch: 7 cost time: 3.3357934951782227
Epoch: 7, Steps: 9 | Train Loss: 0.559 Vali Loss: 0.761 Vali Acc: 0.768 Test Loss: 0.761 Test Acc: 0.768
Validation loss decreased (-0.717383 --> -0.768108).  Saving model ...
Epoch: 8 cost time: 3.0380911827087402
Epoch: 8, Steps: 9 | Train Loss: 0.416 Vali Loss: 0.652 Vali Acc: 0.804 Test Loss: 0.652 Test Acc: 0.804
Validation loss decreased (-0.768108 --> -0.804341).  Saving model ...
Epoch: 9 cost time: 3.09197998046875
Epoch: 9, Steps: 9 | Train Loss: 0.299 Vali Loss: 0.569 Vali Acc: 0.826 Test Loss: 0.569 Test Acc: 0.826
Validation loss decreased (-0.804341 --> -0.826081).  Saving model ...
Epoch: 10 cost time: 2.908923864364624
Epoch: 10, Steps: 9 | Train Loss: 0.241 Vali Loss: 0.491 Vali Acc: 0.848 Test Loss: 0.491 Test Acc: 0.848
Validation loss decreased (-0.826081 --> -0.847821).  Saving model ...
Epoch: 11 cost time: 2.9871268272399902
Epoch: 11, Steps: 9 | Train Loss: 0.161 Vali Loss: 0.434 Vali Acc: 0.862 Test Loss: 0.434 Test Acc: 0.862
Validation loss decreased (-0.847821 --> -0.862315).  Saving model ...
Epoch: 12 cost time: 2.8503079414367676
Epoch: 12, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.410 Vali Acc: 0.870 Test Loss: 0.410 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 13 cost time: 3.01835298538208
Epoch: 13, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.362 Vali Acc: 0.906 Test Loss: 0.362 Test Acc: 0.906
Validation loss decreased (-0.869561 --> -0.905793).  Saving model ...
Epoch: 14 cost time: 3.174894094467163
Epoch: 14, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.365 Vali Acc: 0.877 Test Loss: 0.365 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.1536502838134766
Epoch: 15, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.324 Vali Acc: 0.920 Test Loss: 0.324 Test Acc: 0.920
Validation loss decreased (-0.905793 --> -0.920287).  Saving model ...
Epoch: 16 cost time: 3.4239280223846436
Epoch: 16, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.330 Vali Acc: 0.884 Test Loss: 0.330 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.300645589828491
Epoch: 17, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.323 Vali Acc: 0.899 Test Loss: 0.323 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.4061121940612793
Epoch: 18, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.305 Vali Acc: 0.906 Test Loss: 0.305 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.402405023574829
Epoch: 19, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.317 Vali Acc: 0.891 Test Loss: 0.317 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.9707581996917725
Epoch: 20, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.300 Vali Acc: 0.906 Test Loss: 0.300 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.152219772338867
Epoch: 21, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.295 Vali Acc: 0.913 Test Loss: 0.295 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.191455125808716
Epoch: 22, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.286 Vali Acc: 0.913 Test Loss: 0.286 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.9965736865997314
Epoch: 23, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.288 Vali Acc: 0.906 Test Loss: 0.288 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.2278196811676025
Epoch: 24, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.287 Vali Acc: 0.913 Test Loss: 0.287 Test Acc: 0.913
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.109143018722534
Epoch: 25, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.284 Vali Acc: 0.913 Test Loss: 0.284 Test Acc: 0.913
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9202898550724637
model parameter : 265796
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.200004577636719
Epoch: 1, Steps: 9 | Train Loss: 1.418 Vali Loss: 1.397 Vali Acc: 0.304 Test Loss: 1.397 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 3.550053834915161
Epoch: 2, Steps: 9 | Train Loss: 1.332 Vali Loss: 1.325 Vali Acc: 0.384 Test Loss: 1.325 Test Acc: 0.384
Validation loss decreased (-0.304334 --> -0.384045).  Saving model ...
Epoch: 3 cost time: 3.3140828609466553
Epoch: 3, Steps: 9 | Train Loss: 1.236 Vali Loss: 1.241 Vali Acc: 0.486 Test Loss: 1.241 Test Acc: 0.486
Validation loss decreased (-0.384045 --> -0.485495).  Saving model ...
Epoch: 4 cost time: 3.36053466796875
Epoch: 4, Steps: 9 | Train Loss: 1.093 Vali Loss: 1.136 Vali Acc: 0.580 Test Loss: 1.136 Test Acc: 0.580
Validation loss decreased (-0.485495 --> -0.579699).  Saving model ...
Epoch: 5 cost time: 3.4085004329681396
Epoch: 5, Steps: 9 | Train Loss: 0.918 Vali Loss: 1.039 Vali Acc: 0.645 Test Loss: 1.039 Test Acc: 0.645
Validation loss decreased (-0.579699 --> -0.644917).  Saving model ...
Epoch: 6 cost time: 3.258432388305664
Epoch: 6, Steps: 9 | Train Loss: 0.752 Vali Loss: 0.920 Vali Acc: 0.681 Test Loss: 0.920 Test Acc: 0.681
Validation loss decreased (-0.644917 --> -0.681150).  Saving model ...
Epoch: 7 cost time: 3.1296229362487793
Epoch: 7, Steps: 9 | Train Loss: 0.616 Vali Loss: 0.810 Vali Acc: 0.732 Test Loss: 0.810 Test Acc: 0.732
Validation loss decreased (-0.681150 --> -0.731876).  Saving model ...
Epoch: 8 cost time: 3.3137779235839844
Epoch: 8, Steps: 9 | Train Loss: 0.472 Vali Loss: 0.705 Vali Acc: 0.754 Test Loss: 0.705 Test Acc: 0.754
Validation loss decreased (-0.731876 --> -0.753616).  Saving model ...
Epoch: 9 cost time: 2.9763596057891846
Epoch: 9, Steps: 9 | Train Loss: 0.364 Vali Loss: 0.637 Vali Acc: 0.783 Test Loss: 0.637 Test Acc: 0.783
Validation loss decreased (-0.753616 --> -0.782602).  Saving model ...
Epoch: 10 cost time: 3.323202610015869
Epoch: 10, Steps: 9 | Train Loss: 0.294 Vali Loss: 0.544 Vali Acc: 0.833 Test Loss: 0.544 Test Acc: 0.833
Validation loss decreased (-0.782602 --> -0.833328).  Saving model ...
Epoch: 11 cost time: 3.2401044368743896
Epoch: 11, Steps: 9 | Train Loss: 0.210 Vali Loss: 0.477 Vali Acc: 0.819 Test Loss: 0.477 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.544337749481201
Epoch: 12, Steps: 9 | Train Loss: 0.170 Vali Loss: 0.447 Vali Acc: 0.848 Test Loss: 0.447 Test Acc: 0.848
Validation loss decreased (-0.833328 --> -0.847822).  Saving model ...
Epoch: 13 cost time: 3.810218572616577
Epoch: 13, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.422 Vali Acc: 0.855 Test Loss: 0.422 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 14 cost time: 3.616544723510742
Epoch: 14, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.430 Vali Acc: 0.862 Test Loss: 0.430 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 15 cost time: 3.4451355934143066
Epoch: 15, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.395 Vali Acc: 0.855 Test Loss: 0.395 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.634432554244995
Epoch: 16, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.410 Vali Acc: 0.848 Test Loss: 0.410 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.49055814743042
Epoch: 17, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.401 Vali Acc: 0.862 Test Loss: 0.401 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 18 cost time: 3.3914873600006104
Epoch: 18, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.384 Vali Acc: 0.862 Test Loss: 0.384 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 19 cost time: 3.3027737140655518
Epoch: 19, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.398 Vali Acc: 0.855 Test Loss: 0.398 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.3207101821899414
Epoch: 20, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.396 Vali Acc: 0.848 Test Loss: 0.396 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.1558260917663574
Epoch: 21, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.376 Vali Acc: 0.862 Test Loss: 0.376 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 22 cost time: 3.358149290084839
Epoch: 22, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.388 Vali Acc: 0.870 Test Loss: 0.388 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 23 cost time: 3.6929609775543213
Epoch: 23, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.385 Vali Acc: 0.870 Test Loss: 0.385 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 24 cost time: 3.887906789779663
Epoch: 24, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.377 Vali Acc: 0.884 Test Loss: 0.377 Test Acc: 0.884
Validation loss decreased (-0.869561 --> -0.884054).  Saving model ...
Epoch: 25 cost time: 3.5496041774749756
Epoch: 25, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.368 Vali Acc: 0.884 Test Loss: 0.368 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 26 cost time: 3.67704176902771
Epoch: 26, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.368 Vali Acc: 0.877 Test Loss: 0.368 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.435603380203247
Epoch: 27, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.360 Vali Acc: 0.870 Test Loss: 0.360 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.434882402420044
Epoch: 28, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.367 Vali Acc: 0.877 Test Loss: 0.367 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.21881103515625
Epoch: 29, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.365 Vali Acc: 0.870 Test Loss: 0.365 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.2035868167877197
Epoch: 30, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.360 Vali Acc: 0.870 Test Loss: 0.360 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.0503716468811035
Epoch: 31, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.350 Vali Acc: 0.870 Test Loss: 0.350 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.345216751098633
Epoch: 32, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.365 Vali Acc: 0.877 Test Loss: 0.365 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.275902032852173
Epoch: 33, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.375 Vali Acc: 0.877 Test Loss: 0.375 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.3228378295898438
Epoch: 34, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.376 Vali Acc: 0.877 Test Loss: 0.376 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.266308546066284
Epoch: 35, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.365 Vali Acc: 0.870 Test Loss: 0.365 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 265796
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.7774786949157715
Epoch: 1, Steps: 9 | Train Loss: 1.415 Vali Loss: 1.351 Vali Acc: 0.362 Test Loss: 1.351 Test Acc: 0.362
Validation loss decreased (inf --> -0.362305).  Saving model ...
Epoch: 2 cost time: 3.39855694770813
Epoch: 2, Steps: 9 | Train Loss: 1.350 Vali Loss: 1.258 Vali Acc: 0.493 Test Loss: 1.258 Test Acc: 0.493
Validation loss decreased (-0.362305 --> -0.492741).  Saving model ...
Epoch: 3 cost time: 3.4256887435913086
Epoch: 3, Steps: 9 | Train Loss: 1.204 Vali Loss: 1.151 Vali Acc: 0.580 Test Loss: 1.151 Test Acc: 0.580
Validation loss decreased (-0.492741 --> -0.579699).  Saving model ...
Epoch: 4 cost time: 3.301637649536133
Epoch: 4, Steps: 9 | Train Loss: 1.036 Vali Loss: 1.036 Vali Acc: 0.616 Test Loss: 1.036 Test Acc: 0.616
Validation loss decreased (-0.579699 --> -0.615932).  Saving model ...
Epoch: 5 cost time: 3.4903311729431152
Epoch: 5, Steps: 9 | Train Loss: 0.831 Vali Loss: 0.936 Vali Acc: 0.638 Test Loss: 0.936 Test Acc: 0.638
Validation loss decreased (-0.615932 --> -0.637672).  Saving model ...
Epoch: 6 cost time: 3.147184133529663
Epoch: 6, Steps: 9 | Train Loss: 0.671 Vali Loss: 0.833 Vali Acc: 0.688 Test Loss: 0.833 Test Acc: 0.688
Validation loss decreased (-0.637672 --> -0.688397).  Saving model ...
Epoch: 7 cost time: 3.149423599243164
Epoch: 7, Steps: 9 | Train Loss: 0.515 Vali Loss: 0.754 Vali Acc: 0.710 Test Loss: 0.754 Test Acc: 0.710
Validation loss decreased (-0.688397 --> -0.710137).  Saving model ...
Epoch: 8 cost time: 3.1288321018218994
Epoch: 8, Steps: 9 | Train Loss: 0.396 Vali Loss: 0.686 Vali Acc: 0.725 Test Loss: 0.686 Test Acc: 0.725
Validation loss decreased (-0.710137 --> -0.724631).  Saving model ...
Epoch: 9 cost time: 3.2199840545654297
Epoch: 9, Steps: 9 | Train Loss: 0.316 Vali Loss: 0.635 Vali Acc: 0.754 Test Loss: 0.635 Test Acc: 0.754
Validation loss decreased (-0.724631 --> -0.753617).  Saving model ...
Epoch: 10 cost time: 3.0573227405548096
Epoch: 10, Steps: 9 | Train Loss: 0.257 Vali Loss: 0.598 Vali Acc: 0.754 Test Loss: 0.598 Test Acc: 0.754
Validation loss decreased (-0.753617 --> -0.753617).  Saving model ...
Epoch: 11 cost time: 3.3901875019073486
Epoch: 11, Steps: 9 | Train Loss: 0.205 Vali Loss: 0.558 Vali Acc: 0.841 Test Loss: 0.558 Test Acc: 0.841
Validation loss decreased (-0.753617 --> -0.840574).  Saving model ...
Epoch: 12 cost time: 3.25447154045105
Epoch: 12, Steps: 9 | Train Loss: 0.162 Vali Loss: 0.551 Vali Acc: 0.761 Test Loss: 0.551 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.748849868774414
Epoch: 13, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.526 Vali Acc: 0.819 Test Loss: 0.526 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.389101982116699
Epoch: 14, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.531 Vali Acc: 0.812 Test Loss: 0.531 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.5721042156219482
Epoch: 15, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.518 Vali Acc: 0.833 Test Loss: 0.518 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.4035258293151855
Epoch: 16, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.526 Vali Acc: 0.826 Test Loss: 0.526 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.1804847717285156
Epoch: 17, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.517 Vali Acc: 0.804 Test Loss: 0.517 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.3302605152130127
Epoch: 18, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.508 Vali Acc: 0.812 Test Loss: 0.508 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.0122499465942383
Epoch: 19, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.532 Vali Acc: 0.833 Test Loss: 0.532 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.3935132026672363
Epoch: 20, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.530 Vali Acc: 0.819 Test Loss: 0.530 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.4156954288482666
Epoch: 21, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.539 Vali Acc: 0.812 Test Loss: 0.539 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 265796
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.175269365310669
Epoch: 1, Steps: 9 | Train Loss: 1.417 Vali Loss: 1.391 Vali Acc: 0.239 Test Loss: 1.391 Test Acc: 0.239
Validation loss decreased (inf --> -0.239117).  Saving model ...
Epoch: 2 cost time: 3.35440993309021
Epoch: 2, Steps: 9 | Train Loss: 1.415 Vali Loss: 1.365 Vali Acc: 0.290 Test Loss: 1.365 Test Acc: 0.290
Validation loss decreased (-0.239117 --> -0.289841).  Saving model ...
Epoch: 3 cost time: 3.4300801753997803
Epoch: 3, Steps: 9 | Train Loss: 1.300 Vali Loss: 1.329 Vali Acc: 0.355 Test Loss: 1.329 Test Acc: 0.355
Validation loss decreased (-0.289841 --> -0.355059).  Saving model ...
Epoch: 4 cost time: 3.5056893825531006
Epoch: 4, Steps: 9 | Train Loss: 1.202 Vali Loss: 1.292 Vali Acc: 0.377 Test Loss: 1.292 Test Acc: 0.377
Validation loss decreased (-0.355059 --> -0.376799).  Saving model ...
Epoch: 5 cost time: 3.562397003173828
Epoch: 5, Steps: 9 | Train Loss: 1.068 Vali Loss: 1.247 Vali Acc: 0.435 Test Loss: 1.247 Test Acc: 0.435
Validation loss decreased (-0.376799 --> -0.434770).  Saving model ...
Epoch: 6 cost time: 3.3316376209259033
Epoch: 6, Steps: 9 | Train Loss: 0.916 Vali Loss: 1.199 Vali Acc: 0.500 Test Loss: 1.199 Test Acc: 0.500
Validation loss decreased (-0.434770 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 3.380047082901001
Epoch: 7, Steps: 9 | Train Loss: 0.794 Vali Loss: 1.152 Vali Acc: 0.486 Test Loss: 1.152 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.634343147277832
Epoch: 8, Steps: 9 | Train Loss: 0.658 Vali Loss: 1.110 Vali Acc: 0.486 Test Loss: 1.110 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.3957948684692383
Epoch: 9, Steps: 9 | Train Loss: 0.590 Vali Loss: 1.064 Vali Acc: 0.522 Test Loss: 1.064 Test Acc: 0.522
Validation loss decreased (-0.499988 --> -0.521728).  Saving model ...
Epoch: 10 cost time: 3.42927885055542
Epoch: 10, Steps: 9 | Train Loss: 0.494 Vali Loss: 1.055 Vali Acc: 0.500 Test Loss: 1.055 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.3046059608459473
Epoch: 11, Steps: 9 | Train Loss: 0.410 Vali Loss: 1.081 Vali Acc: 0.457 Test Loss: 1.081 Test Acc: 0.457
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.5948128700256348
Epoch: 12, Steps: 9 | Train Loss: 0.355 Vali Loss: 1.090 Vali Acc: 0.464 Test Loss: 1.090 Test Acc: 0.464
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.902982711791992
Epoch: 13, Steps: 9 | Train Loss: 0.277 Vali Loss: 1.136 Vali Acc: 0.500 Test Loss: 1.136 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.329378604888916
Epoch: 14, Steps: 9 | Train Loss: 0.214 Vali Loss: 1.177 Vali Acc: 0.464 Test Loss: 1.177 Test Acc: 0.464
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.7898809909820557
Epoch: 15, Steps: 9 | Train Loss: 0.173 Vali Loss: 1.187 Vali Acc: 0.529 Test Loss: 1.187 Test Acc: 0.529
Validation loss decreased (-0.521728 --> -0.528974).  Saving model ...
Epoch: 16 cost time: 3.4638211727142334
Epoch: 16, Steps: 9 | Train Loss: 0.134 Vali Loss: 1.247 Vali Acc: 0.471 Test Loss: 1.247 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.974421739578247
Epoch: 17, Steps: 9 | Train Loss: 0.129 Vali Loss: 1.240 Vali Acc: 0.449 Test Loss: 1.240 Test Acc: 0.449
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.6188907623291016
Epoch: 18, Steps: 9 | Train Loss: 0.090 Vali Loss: 1.263 Vali Acc: 0.486 Test Loss: 1.263 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.446199417114258
Epoch: 19, Steps: 9 | Train Loss: 0.079 Vali Loss: 1.354 Vali Acc: 0.478 Test Loss: 1.354 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.432036876678467
Epoch: 20, Steps: 9 | Train Loss: 0.071 Vali Loss: 1.400 Vali Acc: 0.471 Test Loss: 1.400 Test Acc: 0.471
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.2961220741271973
Epoch: 21, Steps: 9 | Train Loss: 0.054 Vali Loss: 1.330 Vali Acc: 0.522 Test Loss: 1.330 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.3453080654144287
Epoch: 22, Steps: 9 | Train Loss: 0.053 Vali Loss: 1.329 Vali Acc: 0.486 Test Loss: 1.329 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.1358909606933594
Epoch: 23, Steps: 9 | Train Loss: 0.046 Vali Loss: 1.400 Vali Acc: 0.471 Test Loss: 1.400 Test Acc: 0.471
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.125187873840332
Epoch: 24, Steps: 9 | Train Loss: 0.039 Vali Loss: 1.454 Vali Acc: 0.478 Test Loss: 1.454 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.01863169670105
Epoch: 25, Steps: 9 | Train Loss: 0.034 Vali Loss: 1.439 Vali Acc: 0.514 Test Loss: 1.439 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5289855072463768
model parameter : 265796
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.824904680252075
Epoch: 1, Steps: 9 | Train Loss: 1.459 Vali Loss: 1.406 Vali Acc: 0.326 Test Loss: 1.406 Test Acc: 0.326
Validation loss decreased (inf --> -0.326073).  Saving model ...
Epoch: 2 cost time: 2.9945785999298096
Epoch: 2, Steps: 9 | Train Loss: 1.474 Vali Loss: 1.401 Vali Acc: 0.312 Test Loss: 1.401 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.5271668434143066
Epoch: 3, Steps: 9 | Train Loss: 1.408 Vali Loss: 1.397 Vali Acc: 0.304 Test Loss: 1.397 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.2745556831359863
Epoch: 4, Steps: 9 | Train Loss: 1.374 Vali Loss: 1.393 Vali Acc: 0.312 Test Loss: 1.393 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.5098061561584473
Epoch: 5, Steps: 9 | Train Loss: 1.247 Vali Loss: 1.388 Vali Acc: 0.333 Test Loss: 1.388 Test Acc: 0.333
Validation loss decreased (-0.326073 --> -0.333319).  Saving model ...
Epoch: 6 cost time: 3.432140350341797
Epoch: 6, Steps: 9 | Train Loss: 1.142 Vali Loss: 1.386 Vali Acc: 0.333 Test Loss: 1.386 Test Acc: 0.333
Validation loss decreased (-0.333319 --> -0.333319).  Saving model ...
Epoch: 7 cost time: 3.4345760345458984
Epoch: 7, Steps: 9 | Train Loss: 1.086 Vali Loss: 1.386 Vali Acc: 0.312 Test Loss: 1.386 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.8011274337768555
Epoch: 8, Steps: 9 | Train Loss: 0.983 Vali Loss: 1.435 Vali Acc: 0.326 Test Loss: 1.435 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.415508985519409
Epoch: 9, Steps: 9 | Train Loss: 0.907 Vali Loss: 1.456 Vali Acc: 0.333 Test Loss: 1.456 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.4322941303253174
Epoch: 10, Steps: 9 | Train Loss: 0.775 Vali Loss: 1.448 Vali Acc: 0.333 Test Loss: 1.448 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.4363977909088135
Epoch: 11, Steps: 9 | Train Loss: 0.697 Vali Loss: 1.639 Vali Acc: 0.341 Test Loss: 1.639 Test Acc: 0.341
Validation loss decreased (-0.333319 --> -0.340563).  Saving model ...
Epoch: 12 cost time: 3.530573606491089
Epoch: 12, Steps: 9 | Train Loss: 0.609 Vali Loss: 1.734 Vali Acc: 0.326 Test Loss: 1.734 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.660801887512207
Epoch: 13, Steps: 9 | Train Loss: 0.487 Vali Loss: 1.852 Vali Acc: 0.333 Test Loss: 1.852 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.3369038105010986
Epoch: 14, Steps: 9 | Train Loss: 0.454 Vali Loss: 1.965 Vali Acc: 0.333 Test Loss: 1.965 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.2392406463623047
Epoch: 15, Steps: 9 | Train Loss: 0.370 Vali Loss: 2.089 Vali Acc: 0.319 Test Loss: 2.089 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.1884965896606445
Epoch: 16, Steps: 9 | Train Loss: 0.292 Vali Loss: 2.261 Vali Acc: 0.326 Test Loss: 2.261 Test Acc: 0.326
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.2128446102142334
Epoch: 17, Steps: 9 | Train Loss: 0.263 Vali Loss: 2.380 Vali Acc: 0.319 Test Loss: 2.380 Test Acc: 0.319
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.65203595161438
Epoch: 18, Steps: 9 | Train Loss: 0.212 Vali Loss: 2.469 Vali Acc: 0.333 Test Loss: 2.469 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.461613416671753
Epoch: 19, Steps: 9 | Train Loss: 0.197 Vali Loss: 2.626 Vali Acc: 0.319 Test Loss: 2.626 Test Acc: 0.319
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.8001739978790283
Epoch: 20, Steps: 9 | Train Loss: 0.177 Vali Loss: 2.655 Vali Acc: 0.341 Test Loss: 2.655 Test Acc: 0.341
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.7023112773895264
Epoch: 21, Steps: 9 | Train Loss: 0.120 Vali Loss: 2.679 Vali Acc: 0.341 Test Loss: 2.679 Test Acc: 0.341
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.34057971014492755
model parameter : 265796
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.699661493301392
Epoch: 1, Steps: 9 | Train Loss: 1.449 Vali Loss: 1.445 Vali Acc: 0.246 Test Loss: 1.445 Test Acc: 0.246
Validation loss decreased (inf --> -0.246362).  Saving model ...
Epoch: 2 cost time: 3.2412636280059814
Epoch: 2, Steps: 9 | Train Loss: 1.495 Vali Loss: 1.441 Vali Acc: 0.254 Test Loss: 1.441 Test Acc: 0.254
Validation loss decreased (-0.246362 --> -0.253609).  Saving model ...
Epoch: 3 cost time: 3.052480459213257
Epoch: 3, Steps: 9 | Train Loss: 1.356 Vali Loss: 1.428 Vali Acc: 0.290 Test Loss: 1.428 Test Acc: 0.290
Validation loss decreased (-0.253609 --> -0.289841).  Saving model ...
Epoch: 4 cost time: 2.90714168548584
Epoch: 4, Steps: 9 | Train Loss: 1.356 Vali Loss: 1.416 Vali Acc: 0.290 Test Loss: 1.416 Test Acc: 0.290
Validation loss decreased (-0.289841 --> -0.289841).  Saving model ...
Epoch: 5 cost time: 3.000293731689453
Epoch: 5, Steps: 9 | Train Loss: 1.212 Vali Loss: 1.397 Vali Acc: 0.312 Test Loss: 1.397 Test Acc: 0.312
Validation loss decreased (-0.289841 --> -0.311580).  Saving model ...
Epoch: 6 cost time: 2.9488537311553955
Epoch: 6, Steps: 9 | Train Loss: 1.099 Vali Loss: 1.378 Vali Acc: 0.319 Test Loss: 1.378 Test Acc: 0.319
Validation loss decreased (-0.311580 --> -0.318827).  Saving model ...
Epoch: 7 cost time: 3.1474905014038086
Epoch: 7, Steps: 9 | Train Loss: 1.049 Vali Loss: 1.367 Vali Acc: 0.304 Test Loss: 1.367 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.2025997638702393
Epoch: 8, Steps: 9 | Train Loss: 0.895 Vali Loss: 1.381 Vali Acc: 0.319 Test Loss: 1.381 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.1363842487335205
Epoch: 9, Steps: 9 | Train Loss: 0.837 Vali Loss: 1.356 Vali Acc: 0.348 Test Loss: 1.356 Test Acc: 0.348
Validation loss decreased (-0.318827 --> -0.347813).  Saving model ...
Epoch: 10 cost time: 3.2314724922180176
Epoch: 10, Steps: 9 | Train Loss: 0.719 Vali Loss: 1.312 Vali Acc: 0.362 Test Loss: 1.312 Test Acc: 0.362
Validation loss decreased (-0.347813 --> -0.362306).  Saving model ...
Epoch: 11 cost time: 3.2867774963378906
Epoch: 11, Steps: 9 | Train Loss: 0.627 Vali Loss: 1.383 Vali Acc: 0.362 Test Loss: 1.383 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.568328619003296
Epoch: 12, Steps: 9 | Train Loss: 0.562 Vali Loss: 1.398 Vali Acc: 0.362 Test Loss: 1.398 Test Acc: 0.362
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.375462770462036
Epoch: 13, Steps: 9 | Train Loss: 0.473 Vali Loss: 1.453 Vali Acc: 0.348 Test Loss: 1.453 Test Acc: 0.348
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.5602097511291504
Epoch: 14, Steps: 9 | Train Loss: 0.396 Vali Loss: 1.484 Vali Acc: 0.355 Test Loss: 1.484 Test Acc: 0.355
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.4910078048706055
Epoch: 15, Steps: 9 | Train Loss: 0.318 Vali Loss: 1.533 Vali Acc: 0.362 Test Loss: 1.533 Test Acc: 0.362
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.4117271900177
Epoch: 16, Steps: 9 | Train Loss: 0.238 Vali Loss: 1.636 Vali Acc: 0.348 Test Loss: 1.636 Test Acc: 0.348
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.1880042552948
Epoch: 17, Steps: 9 | Train Loss: 0.211 Vali Loss: 1.682 Vali Acc: 0.370 Test Loss: 1.682 Test Acc: 0.370
Validation loss decreased (-0.362306 --> -0.369548).  Saving model ...
Epoch: 18 cost time: 3.037264585494995
Epoch: 18, Steps: 9 | Train Loss: 0.159 Vali Loss: 1.772 Vali Acc: 0.362 Test Loss: 1.772 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.0369720458984375
Epoch: 19, Steps: 9 | Train Loss: 0.147 Vali Loss: 1.825 Vali Acc: 0.362 Test Loss: 1.825 Test Acc: 0.362
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.009404182434082
Epoch: 20, Steps: 9 | Train Loss: 0.117 Vali Loss: 1.929 Vali Acc: 0.384 Test Loss: 1.929 Test Acc: 0.384
Validation loss decreased (-0.369548 --> -0.384039).  Saving model ...
Epoch: 21 cost time: 3.230506658554077
Epoch: 21, Steps: 9 | Train Loss: 0.092 Vali Loss: 1.822 Vali Acc: 0.384 Test Loss: 1.822 Test Acc: 0.384
Validation loss decreased (-0.384039 --> -0.384040).  Saving model ...
Epoch: 22 cost time: 3.163952589035034
Epoch: 22, Steps: 9 | Train Loss: 0.082 Vali Loss: 1.933 Vali Acc: 0.399 Test Loss: 1.933 Test Acc: 0.399
Validation loss decreased (-0.384040 --> -0.398531).  Saving model ...
Epoch: 23 cost time: 3.1885881423950195
Epoch: 23, Steps: 9 | Train Loss: 0.072 Vali Loss: 1.996 Vali Acc: 0.384 Test Loss: 1.996 Test Acc: 0.384
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.162684679031372
Epoch: 24, Steps: 9 | Train Loss: 0.059 Vali Loss: 2.034 Vali Acc: 0.362 Test Loss: 2.034 Test Acc: 0.362
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.3902297019958496
Epoch: 25, Steps: 9 | Train Loss: 0.058 Vali Loss: 1.884 Vali Acc: 0.413 Test Loss: 1.884 Test Acc: 0.413
Validation loss decreased (-0.398531 --> -0.413025).  Saving model ...
Epoch: 26 cost time: 3.2887284755706787
Epoch: 26, Steps: 9 | Train Loss: 0.042 Vali Loss: 2.010 Vali Acc: 0.384 Test Loss: 2.010 Test Acc: 0.384
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.222179412841797
Epoch: 27, Steps: 9 | Train Loss: 0.044 Vali Loss: 2.007 Vali Acc: 0.384 Test Loss: 2.007 Test Acc: 0.384
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.1874442100524902
Epoch: 28, Steps: 9 | Train Loss: 0.044 Vali Loss: 1.874 Vali Acc: 0.399 Test Loss: 1.874 Test Acc: 0.399
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.2004709243774414
Epoch: 29, Steps: 9 | Train Loss: 0.037 Vali Loss: 1.994 Vali Acc: 0.391 Test Loss: 1.994 Test Acc: 0.391
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.4143338203430176
Epoch: 30, Steps: 9 | Train Loss: 0.031 Vali Loss: 1.952 Vali Acc: 0.377 Test Loss: 1.952 Test Acc: 0.377
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.239424228668213
Epoch: 31, Steps: 9 | Train Loss: 0.028 Vali Loss: 1.828 Vali Acc: 0.406 Test Loss: 1.828 Test Acc: 0.406
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.1494321823120117
Epoch: 32, Steps: 9 | Train Loss: 0.023 Vali Loss: 1.864 Vali Acc: 0.420 Test Loss: 1.864 Test Acc: 0.420
Validation loss decreased (-0.413025 --> -0.420271).  Saving model ...
Epoch: 33 cost time: 2.9120235443115234
Epoch: 33, Steps: 9 | Train Loss: 0.022 Vali Loss: 1.872 Vali Acc: 0.384 Test Loss: 1.872 Test Acc: 0.384
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.7753984928131104
Epoch: 34, Steps: 9 | Train Loss: 0.018 Vali Loss: 1.782 Vali Acc: 0.384 Test Loss: 1.782 Test Acc: 0.384
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.9333689212799072
Epoch: 35, Steps: 9 | Train Loss: 0.019 Vali Loss: 1.845 Vali Acc: 0.413 Test Loss: 1.845 Test Acc: 0.413
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.1379239559173584
Epoch: 36, Steps: 9 | Train Loss: 0.016 Vali Loss: 1.821 Vali Acc: 0.406 Test Loss: 1.821 Test Acc: 0.406
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.9208579063415527
Epoch: 37, Steps: 9 | Train Loss: 0.019 Vali Loss: 1.745 Vali Acc: 0.406 Test Loss: 1.745 Test Acc: 0.406
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.2204298973083496
Epoch: 38, Steps: 9 | Train Loss: 0.016 Vali Loss: 1.658 Vali Acc: 0.435 Test Loss: 1.658 Test Acc: 0.435
Validation loss decreased (-0.420271 --> -0.434766).  Saving model ...
Epoch: 39 cost time: 3.2722222805023193
Epoch: 39, Steps: 9 | Train Loss: 0.015 Vali Loss: 1.839 Vali Acc: 0.399 Test Loss: 1.839 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.3225488662719727
Epoch: 40, Steps: 9 | Train Loss: 0.015 Vali Loss: 1.861 Vali Acc: 0.406 Test Loss: 1.861 Test Acc: 0.406
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.3069581985473633
Epoch: 41, Steps: 9 | Train Loss: 0.011 Vali Loss: 1.747 Vali Acc: 0.420 Test Loss: 1.747 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.077439308166504
Epoch: 42, Steps: 9 | Train Loss: 0.013 Vali Loss: 1.763 Vali Acc: 0.435 Test Loss: 1.763 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 3.2343571186065674
Epoch: 43, Steps: 9 | Train Loss: 0.011 Vali Loss: 1.673 Vali Acc: 0.435 Test Loss: 1.673 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 3.2783703804016113
Epoch: 44, Steps: 9 | Train Loss: 0.011 Vali Loss: 1.657 Vali Acc: 0.442 Test Loss: 1.657 Test Acc: 0.442
Validation loss decreased (-0.434766 --> -0.442012).  Saving model ...
Epoch: 45 cost time: 3.035660743713379
Epoch: 45, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.738 Vali Acc: 0.442 Test Loss: 1.738 Test Acc: 0.442
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.8184735774993896
Epoch: 46, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.634 Vali Acc: 0.420 Test Loss: 1.634 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.1236684322357178
Epoch: 47, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.618 Vali Acc: 0.435 Test Loss: 1.618 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.11017107963562
Epoch: 48, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.590 Vali Acc: 0.442 Test Loss: 1.590 Test Acc: 0.442
Validation loss decreased (-0.442012 --> -0.442013).  Saving model ...
Epoch: 49 cost time: 3.212688684463501
Epoch: 49, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.591 Vali Acc: 0.442 Test Loss: 1.591 Test Acc: 0.442
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.2489609718322754
Epoch: 50, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.570 Vali Acc: 0.449 Test Loss: 1.570 Test Acc: 0.449
Validation loss decreased (-0.442013 --> -0.449260).  Saving model ...
Epoch: 51 cost time: 3.2538063526153564
Epoch: 51, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.581 Vali Acc: 0.457 Test Loss: 1.581 Test Acc: 0.457
Validation loss decreased (-0.449260 --> -0.456506).  Saving model ...
Epoch: 52 cost time: 3.464899778366089
Epoch: 52, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.582 Vali Acc: 0.457 Test Loss: 1.582 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 3.1981897354125977
Epoch: 53, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.689 Vali Acc: 0.428 Test Loss: 1.689 Test Acc: 0.428
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 3.3885436058044434
Epoch: 54, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.550 Vali Acc: 0.457 Test Loss: 1.550 Test Acc: 0.457
Validation loss decreased (-0.456506 --> -0.456506).  Saving model ...
Epoch: 55 cost time: 3.437720775604248
Epoch: 55, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.517 Vali Acc: 0.471 Test Loss: 1.517 Test Acc: 0.471
Validation loss decreased (-0.456506 --> -0.470999).  Saving model ...
Epoch: 56 cost time: 3.205934762954712
Epoch: 56, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.539 Vali Acc: 0.471 Test Loss: 1.539 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 3.3302054405212402
Epoch: 57, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.509 Vali Acc: 0.486 Test Loss: 1.509 Test Acc: 0.486
Validation loss decreased (-0.470999 --> -0.485492).  Saving model ...
Epoch: 58 cost time: 3.442898750305176
Epoch: 58, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.632 Vali Acc: 0.457 Test Loss: 1.632 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 3.219601631164551
Epoch: 59, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.642 Vali Acc: 0.449 Test Loss: 1.642 Test Acc: 0.449
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 3.3885531425476074
Epoch: 60, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.558 Vali Acc: 0.464 Test Loss: 1.558 Test Acc: 0.464
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 3.1711013317108154
Epoch: 61, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.524 Vali Acc: 0.478 Test Loss: 1.524 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 3.251774549484253
Epoch: 62, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.558 Vali Acc: 0.471 Test Loss: 1.558 Test Acc: 0.471
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 3.2058682441711426
Epoch: 63, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.548 Vali Acc: 0.471 Test Loss: 1.548 Test Acc: 0.471
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 3.302952527999878
Epoch: 64, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.531 Vali Acc: 0.478 Test Loss: 1.531 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 3.464073896408081
Epoch: 65, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.502 Vali Acc: 0.486 Test Loss: 1.502 Test Acc: 0.486
Validation loss decreased (-0.485492 --> -0.485492).  Saving model ...
Epoch: 66 cost time: 3.3592112064361572
Epoch: 66, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.486 Vali Acc: 0.486 Test Loss: 1.486 Test Acc: 0.486
Validation loss decreased (-0.485492 --> -0.485492).  Saving model ...
Epoch: 67 cost time: 3.363966703414917
Epoch: 67, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.430 Vali Acc: 0.522 Test Loss: 1.430 Test Acc: 0.522
Validation loss decreased (-0.485492 --> -0.521725).  Saving model ...
Epoch: 68 cost time: 3.368633508682251
Epoch: 68, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.459 Vali Acc: 0.514 Test Loss: 1.459 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 3.387495756149292
Epoch: 69, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.619 Vali Acc: 0.471 Test Loss: 1.619 Test Acc: 0.471
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 3.3611321449279785
Epoch: 70, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.576 Vali Acc: 0.486 Test Loss: 1.576 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 3.090010643005371
Epoch: 71, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.508 Vali Acc: 0.500 Test Loss: 1.508 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 3.1886966228485107
Epoch: 72, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.519 Vali Acc: 0.500 Test Loss: 1.519 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 3.339756727218628
Epoch: 73, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.520 Vali Acc: 0.500 Test Loss: 1.520 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 3.4198803901672363
Epoch: 74, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.487 Vali Acc: 0.507 Test Loss: 1.487 Test Acc: 0.507
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 3.0086352825164795
Epoch: 75, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.453 Vali Acc: 0.529 Test Loss: 1.453 Test Acc: 0.529
Validation loss decreased (-0.521725 --> -0.528971).  Saving model ...
Epoch: 76 cost time: 3.147350311279297
Epoch: 76, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.454 Vali Acc: 0.529 Test Loss: 1.454 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 3.045513868331909
Epoch: 77, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.462 Vali Acc: 0.514 Test Loss: 1.462 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 3.4045662879943848
Epoch: 78, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.455 Vali Acc: 0.536 Test Loss: 1.455 Test Acc: 0.536
Validation loss decreased (-0.528971 --> -0.536217).  Saving model ...
Epoch: 79 cost time: 3.3459653854370117
Epoch: 79, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.433 Vali Acc: 0.551 Test Loss: 1.433 Test Acc: 0.551
Validation loss decreased (-0.536217 --> -0.550710).  Saving model ...
Epoch: 80 cost time: 3.3572967052459717
Epoch: 80, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.413 Vali Acc: 0.551 Test Loss: 1.413 Test Acc: 0.551
Validation loss decreased (-0.550710 --> -0.550711).  Saving model ...
Epoch: 81 cost time: 3.2806713581085205
Epoch: 81, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.424 Vali Acc: 0.551 Test Loss: 1.424 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 3.3362717628479004
Epoch: 82, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.457 Vali Acc: 0.543 Test Loss: 1.457 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 3.273454189300537
Epoch: 83, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.506 Vali Acc: 0.536 Test Loss: 1.506 Test Acc: 0.536
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 3.0580825805664062
Epoch: 84, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.485 Vali Acc: 0.543 Test Loss: 1.485 Test Acc: 0.543
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 2.988206386566162
Epoch: 85, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.471 Vali Acc: 0.551 Test Loss: 1.471 Test Acc: 0.551
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 3.099700689315796
Epoch: 86, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.435 Vali Acc: 0.558 Test Loss: 1.435 Test Acc: 0.558
Validation loss decreased (-0.550711 --> -0.557957).  Saving model ...
Epoch: 87 cost time: 3.179300546646118
Epoch: 87, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.454 Vali Acc: 0.558 Test Loss: 1.454 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 3.239004611968994
Epoch: 88, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.446 Vali Acc: 0.551 Test Loss: 1.446 Test Acc: 0.551
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 3.0368704795837402
Epoch: 89, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.469 Vali Acc: 0.551 Test Loss: 1.469 Test Acc: 0.551
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 3.094407558441162
Epoch: 90, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.474 Vali Acc: 0.551 Test Loss: 1.474 Test Acc: 0.551
EarlyStopping counter: 4 out of 10
Epoch: 91 cost time: 3.231008768081665
Epoch: 91, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.487 Vali Acc: 0.536 Test Loss: 1.487 Test Acc: 0.536
EarlyStopping counter: 5 out of 10
Epoch: 92 cost time: 3.389862060546875
Epoch: 92, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.496 Vali Acc: 0.522 Test Loss: 1.496 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 93 cost time: 3.215043783187866
Epoch: 93, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.477 Vali Acc: 0.536 Test Loss: 1.477 Test Acc: 0.536
EarlyStopping counter: 7 out of 10
Epoch: 94 cost time: 3.2088918685913086
Epoch: 94, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.443 Vali Acc: 0.558 Test Loss: 1.443 Test Acc: 0.558
EarlyStopping counter: 8 out of 10
Epoch: 95 cost time: 3.3852996826171875
Epoch: 95, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.424 Vali Acc: 0.565 Test Loss: 1.424 Test Acc: 0.565
Validation loss decreased (-0.557957 --> -0.565203).  Saving model ...
Epoch: 96 cost time: 3.36598539352417
Epoch: 96, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.439 Vali Acc: 0.565 Test Loss: 1.439 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 3.0613842010498047
Epoch: 97, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.468 Vali Acc: 0.551 Test Loss: 1.468 Test Acc: 0.551
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 3.0578622817993164
Epoch: 98, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.467 Vali Acc: 0.543 Test Loss: 1.467 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 99 cost time: 3.183401346206665
Epoch: 99, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.445 Vali Acc: 0.551 Test Loss: 1.445 Test Acc: 0.551
EarlyStopping counter: 4 out of 10
Epoch: 100 cost time: 3.261956214904785
Epoch: 100, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.417 Vali Acc: 0.572 Test Loss: 1.417 Test Acc: 0.572
Validation loss decreased (-0.565203 --> -0.572450).  Saving model ...
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.572463768115942
model parameter : 265796
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         103                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df512_ma103_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.416077613830566
Epoch: 1, Steps: 9 | Train Loss: 1.467 Vali Loss: 1.378 Vali Acc: 0.428 Test Loss: 1.378 Test Acc: 0.428
Validation loss decreased (inf --> -0.427522).  Saving model ...
Epoch: 2 cost time: 3.3502581119537354
Epoch: 2, Steps: 9 | Train Loss: 1.304 Vali Loss: 1.277 Vali Acc: 0.457 Test Loss: 1.277 Test Acc: 0.457
Validation loss decreased (-0.427522 --> -0.456509).  Saving model ...
Epoch: 3 cost time: 3.316732406616211
Epoch: 3, Steps: 9 | Train Loss: 1.195 Vali Loss: 1.187 Vali Acc: 0.522 Test Loss: 1.187 Test Acc: 0.522
Validation loss decreased (-0.456509 --> -0.521727).  Saving model ...
Epoch: 4 cost time: 3.4615025520324707
Epoch: 4, Steps: 9 | Train Loss: 1.052 Vali Loss: 1.104 Vali Acc: 0.580 Test Loss: 1.104 Test Acc: 0.580
Validation loss decreased (-0.521727 --> -0.579699).  Saving model ...
Epoch: 5 cost time: 3.4203131198883057
Epoch: 5, Steps: 9 | Train Loss: 0.903 Vali Loss: 1.049 Vali Acc: 0.609 Test Loss: 1.049 Test Acc: 0.609
Validation loss decreased (-0.579699 --> -0.608685).  Saving model ...
Epoch: 6 cost time: 3.493480682373047
Epoch: 6, Steps: 9 | Train Loss: 0.737 Vali Loss: 0.964 Vali Acc: 0.638 Test Loss: 0.964 Test Acc: 0.638
Validation loss decreased (-0.608685 --> -0.637672).  Saving model ...
Epoch: 7 cost time: 3.3409037590026855
Epoch: 7, Steps: 9 | Train Loss: 0.613 Vali Loss: 0.899 Vali Acc: 0.659 Test Loss: 0.899 Test Acc: 0.659
Validation loss decreased (-0.637672 --> -0.659411).  Saving model ...
Epoch: 8 cost time: 3.201551914215088
Epoch: 8, Steps: 9 | Train Loss: 0.488 Vali Loss: 0.813 Vali Acc: 0.703 Test Loss: 0.813 Test Acc: 0.703
Validation loss decreased (-0.659411 --> -0.702890).  Saving model ...
Epoch: 9 cost time: 3.292156457901001
Epoch: 9, Steps: 9 | Train Loss: 0.367 Vali Loss: 0.753 Vali Acc: 0.717 Test Loss: 0.753 Test Acc: 0.717
Validation loss decreased (-0.702890 --> -0.717384).  Saving model ...
Epoch: 10 cost time: 3.1890647411346436
Epoch: 10, Steps: 9 | Train Loss: 0.278 Vali Loss: 0.686 Vali Acc: 0.732 Test Loss: 0.686 Test Acc: 0.732
Validation loss decreased (-0.717384 --> -0.731877).  Saving model ...
Epoch: 11 cost time: 3.036790609359741
Epoch: 11, Steps: 9 | Train Loss: 0.204 Vali Loss: 0.623 Vali Acc: 0.775 Test Loss: 0.623 Test Acc: 0.775
Validation loss decreased (-0.731877 --> -0.775356).  Saving model ...
Epoch: 12 cost time: 3.374906539916992
Epoch: 12, Steps: 9 | Train Loss: 0.159 Vali Loss: 0.569 Vali Acc: 0.761 Test Loss: 0.569 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.209327459335327
Epoch: 13, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.549 Vali Acc: 0.804 Test Loss: 0.549 Test Acc: 0.804
Validation loss decreased (-0.775356 --> -0.804342).  Saving model ...
Epoch: 14 cost time: 3.6140201091766357
Epoch: 14, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.524 Vali Acc: 0.826 Test Loss: 0.524 Test Acc: 0.826
Validation loss decreased (-0.804342 --> -0.826082).  Saving model ...
Epoch: 15 cost time: 3.530600070953369
Epoch: 15, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.506 Vali Acc: 0.819 Test Loss: 0.506 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.5680811405181885
Epoch: 16, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.470 Vali Acc: 0.804 Test Loss: 0.470 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.5673975944519043
Epoch: 17, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.477 Vali Acc: 0.833 Test Loss: 0.477 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833329).  Saving model ...
Epoch: 18 cost time: 3.574580430984497
Epoch: 18, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.475 Vali Acc: 0.841 Test Loss: 0.475 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 19 cost time: 3.5800282955169678
Epoch: 19, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.467 Vali Acc: 0.833 Test Loss: 0.467 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.5180368423461914
Epoch: 20, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.444 Vali Acc: 0.841 Test Loss: 0.444 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 21 cost time: 3.6127333641052246
Epoch: 21, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.454 Vali Acc: 0.848 Test Loss: 0.454 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 22 cost time: 3.4294729232788086
Epoch: 22, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.465 Vali Acc: 0.848 Test Loss: 0.465 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.499797821044922
Epoch: 23, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.477 Vali Acc: 0.848 Test Loss: 0.477 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.350947380065918
Epoch: 24, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.440 Vali Acc: 0.841 Test Loss: 0.440 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.405809164047241
Epoch: 25, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.436 Vali Acc: 0.833 Test Loss: 0.436 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.6825571060180664
Epoch: 26, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.448 Vali Acc: 0.855 Test Loss: 0.448 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 27 cost time: 3.7057676315307617
Epoch: 27, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.450 Vali Acc: 0.855 Test Loss: 0.450 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.591834783554077
Epoch: 28, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.442 Vali Acc: 0.855 Test Loss: 0.442 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 29 cost time: 3.558469295501709
Epoch: 29, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.440 Vali Acc: 0.855 Test Loss: 0.440 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 30 cost time: 3.6724936962127686
Epoch: 30, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.440 Vali Acc: 0.855 Test Loss: 0.440 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 31 cost time: 3.7706196308135986
Epoch: 31, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.442 Vali Acc: 0.855 Test Loss: 0.442 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.6221771240234375
Epoch: 32, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.442 Vali Acc: 0.855 Test Loss: 0.442 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.418844699859619
Epoch: 33, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.445 Vali Acc: 0.855 Test Loss: 0.445 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.1997666358947754
Epoch: 34, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.442 Vali Acc: 0.855 Test Loss: 0.442 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.0678279399871826
Epoch: 35, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.446 Vali Acc: 0.862 Test Loss: 0.446 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862314).  Saving model ...
Epoch: 36 cost time: 3.2282347679138184
Epoch: 36, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.451 Vali Acc: 0.862 Test Loss: 0.451 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.159205913543701
Epoch: 37, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.446 Vali Acc: 0.862 Test Loss: 0.446 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 38 cost time: 3.236884117126465
Epoch: 38, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.433 Vali Acc: 0.855 Test Loss: 0.433 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.6904616355895996
Epoch: 39, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.438 Vali Acc: 0.855 Test Loss: 0.438 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.1276004314422607
Epoch: 40, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.441 Vali Acc: 0.855 Test Loss: 0.441 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 3.4478759765625
Epoch: 41, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.452 Vali Acc: 0.855 Test Loss: 0.452 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 3.322575807571411
Epoch: 42, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.443 Vali Acc: 0.855 Test Loss: 0.443 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 3.4392216205596924
Epoch: 43, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.446 Vali Acc: 0.855 Test Loss: 0.446 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 3.231088638305664
Epoch: 44, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.443 Vali Acc: 0.855 Test Loss: 0.443 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 2.6589515209198
Epoch: 45, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.453 Vali Acc: 0.855 Test Loss: 0.453 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 3.2293994426727295
Epoch: 46, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.457 Vali Acc: 0.855 Test Loss: 0.457 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 3.090726375579834
Epoch: 47, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.452 Vali Acc: 0.855 Test Loss: 0.452 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df512_ma103_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 167492
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         83                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df512_ma83_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.256201982498169
Epoch: 1, Steps: 9 | Train Loss: 1.479 Vali Loss: 1.393 Vali Acc: 0.406 Test Loss: 1.393 Test Acc: 0.406
Validation loss decreased (inf --> -0.405783).  Saving model ...
Epoch: 2 cost time: 3.436922788619995
Epoch: 2, Steps: 9 | Train Loss: 1.313 Vali Loss: 1.288 Vali Acc: 0.464 Test Loss: 1.288 Test Acc: 0.464
Validation loss decreased (-0.405783 --> -0.463755).  Saving model ...
Epoch: 3 cost time: 3.562694549560547
Epoch: 3, Steps: 9 | Train Loss: 1.208 Vali Loss: 1.197 Vali Acc: 0.514 Test Loss: 1.197 Test Acc: 0.514
Validation loss decreased (-0.463755 --> -0.514481).  Saving model ...
Epoch: 4 cost time: 3.462677001953125
Epoch: 4, Steps: 9 | Train Loss: 1.059 Vali Loss: 1.115 Vali Acc: 0.594 Test Loss: 1.115 Test Acc: 0.594
Validation loss decreased (-0.514481 --> -0.594192).  Saving model ...
Epoch: 5 cost time: 3.53792405128479
Epoch: 5, Steps: 9 | Train Loss: 0.916 Vali Loss: 1.062 Vali Acc: 0.587 Test Loss: 1.062 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1779260635375977
Epoch: 6, Steps: 9 | Train Loss: 0.750 Vali Loss: 0.979 Vali Acc: 0.638 Test Loss: 0.979 Test Acc: 0.638
Validation loss decreased (-0.594192 --> -0.637671).  Saving model ...
Epoch: 7 cost time: 3.4022231101989746
Epoch: 7, Steps: 9 | Train Loss: 0.624 Vali Loss: 0.912 Vali Acc: 0.652 Test Loss: 0.912 Test Acc: 0.652
Validation loss decreased (-0.637671 --> -0.652165).  Saving model ...
Epoch: 8 cost time: 3.2807326316833496
Epoch: 8, Steps: 9 | Train Loss: 0.500 Vali Loss: 0.825 Vali Acc: 0.688 Test Loss: 0.825 Test Acc: 0.688
Validation loss decreased (-0.652165 --> -0.688398).  Saving model ...
Epoch: 9 cost time: 3.30354642868042
Epoch: 9, Steps: 9 | Train Loss: 0.380 Vali Loss: 0.767 Vali Acc: 0.710 Test Loss: 0.767 Test Acc: 0.710
Validation loss decreased (-0.688398 --> -0.710137).  Saving model ...
Epoch: 10 cost time: 3.0785067081451416
Epoch: 10, Steps: 9 | Train Loss: 0.287 Vali Loss: 0.702 Vali Acc: 0.746 Test Loss: 0.702 Test Acc: 0.746
Validation loss decreased (-0.710137 --> -0.746370).  Saving model ...
Epoch: 11 cost time: 3.091374635696411
Epoch: 11, Steps: 9 | Train Loss: 0.211 Vali Loss: 0.629 Vali Acc: 0.790 Test Loss: 0.629 Test Acc: 0.790
Validation loss decreased (-0.746370 --> -0.789849).  Saving model ...
Epoch: 12 cost time: 3.251678466796875
Epoch: 12, Steps: 9 | Train Loss: 0.163 Vali Loss: 0.577 Vali Acc: 0.790 Test Loss: 0.577 Test Acc: 0.790
Validation loss decreased (-0.789849 --> -0.789849).  Saving model ...
Epoch: 13 cost time: 3.077211618423462
Epoch: 13, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.551 Vali Acc: 0.797 Test Loss: 0.551 Test Acc: 0.797
Validation loss decreased (-0.789849 --> -0.797096).  Saving model ...
Epoch: 14 cost time: 3.1244449615478516
Epoch: 14, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.533 Vali Acc: 0.804 Test Loss: 0.533 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804342).  Saving model ...
Epoch: 15 cost time: 3.160217046737671
Epoch: 15, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.503 Vali Acc: 0.812 Test Loss: 0.503 Test Acc: 0.812
Validation loss decreased (-0.804342 --> -0.811589).  Saving model ...
Epoch: 16 cost time: 3.2545278072357178
Epoch: 16, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.469 Vali Acc: 0.848 Test Loss: 0.469 Test Acc: 0.848
Validation loss decreased (-0.811589 --> -0.847821).  Saving model ...
Epoch: 17 cost time: 3.2494618892669678
Epoch: 17, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.485 Vali Acc: 0.826 Test Loss: 0.485 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.003800630569458
Epoch: 18, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.472 Vali Acc: 0.848 Test Loss: 0.472 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.158522605895996
Epoch: 19, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.457 Vali Acc: 0.848 Test Loss: 0.457 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847822).  Saving model ...
Epoch: 20 cost time: 3.294821262359619
Epoch: 20, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.444 Vali Acc: 0.862 Test Loss: 0.444 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862314).  Saving model ...
Epoch: 21 cost time: 3.1799113750457764
Epoch: 21, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.459 Vali Acc: 0.862 Test Loss: 0.459 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.2072789669036865
Epoch: 22, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.463 Vali Acc: 0.870 Test Loss: 0.463 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869561).  Saving model ...
Epoch: 23 cost time: 3.1373467445373535
Epoch: 23, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.473 Vali Acc: 0.855 Test Loss: 0.473 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.1626546382904053
Epoch: 24, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.426 Vali Acc: 0.877 Test Loss: 0.426 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 25 cost time: 2.817012071609497
Epoch: 25, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.422 Vali Acc: 0.877 Test Loss: 0.422 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 26 cost time: 2.9946420192718506
Epoch: 26, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.444 Vali Acc: 0.862 Test Loss: 0.444 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.5130481719970703
Epoch: 27, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.447 Vali Acc: 0.862 Test Loss: 0.447 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.6208088397979736
Epoch: 28, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.435 Vali Acc: 0.870 Test Loss: 0.435 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.344616174697876
Epoch: 29, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.434 Vali Acc: 0.877 Test Loss: 0.434 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.4389452934265137
Epoch: 30, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.430 Vali Acc: 0.884 Test Loss: 0.430 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884054).  Saving model ...
Epoch: 31 cost time: 3.3143043518066406
Epoch: 31, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.435 Vali Acc: 0.877 Test Loss: 0.435 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.248825788497925
Epoch: 32, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.434 Vali Acc: 0.877 Test Loss: 0.434 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.5708048343658447
Epoch: 33, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.430 Vali Acc: 0.884 Test Loss: 0.430 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 34 cost time: 3.412290334701538
Epoch: 34, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.422 Vali Acc: 0.884 Test Loss: 0.422 Test Acc: 0.884
Validation loss decreased (-0.884054 --> -0.884054).  Saving model ...
Epoch: 35 cost time: 2.976959705352783
Epoch: 35, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.437 Vali Acc: 0.877 Test Loss: 0.437 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.19645094871521
Epoch: 36, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.449 Vali Acc: 0.870 Test Loss: 0.449 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.186309814453125
Epoch: 37, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.445 Vali Acc: 0.877 Test Loss: 0.445 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.447330951690674
Epoch: 38, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.423 Vali Acc: 0.884 Test Loss: 0.423 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.2394473552703857
Epoch: 39, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.424 Vali Acc: 0.884 Test Loss: 0.424 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.451117753982544
Epoch: 40, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.425 Vali Acc: 0.884 Test Loss: 0.425 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 3.288379430770874
Epoch: 41, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.441 Vali Acc: 0.877 Test Loss: 0.441 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 3.393289804458618
Epoch: 42, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.432 Vali Acc: 0.884 Test Loss: 0.432 Test Acc: 0.884
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.5179975032806396
Epoch: 43, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.435 Vali Acc: 0.884 Test Loss: 0.435 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 3.4519505500793457
Epoch: 44, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.429 Vali Acc: 0.884 Test Loss: 0.429 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df512_ma83_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 167492
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         62                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df512_ma62_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.724021911621094
Epoch: 1, Steps: 9 | Train Loss: 1.475 Vali Loss: 1.408 Vali Acc: 0.370 Test Loss: 1.408 Test Acc: 0.370
Validation loss decreased (inf --> -0.369551).  Saving model ...
Epoch: 2 cost time: 3.323692798614502
Epoch: 2, Steps: 9 | Train Loss: 1.323 Vali Loss: 1.304 Vali Acc: 0.435 Test Loss: 1.304 Test Acc: 0.435
Validation loss decreased (-0.369551 --> -0.434770).  Saving model ...
Epoch: 3 cost time: 3.05680513381958
Epoch: 3, Steps: 9 | Train Loss: 1.219 Vali Loss: 1.215 Vali Acc: 0.514 Test Loss: 1.215 Test Acc: 0.514
Validation loss decreased (-0.434770 --> -0.514481).  Saving model ...
Epoch: 4 cost time: 3.18880033493042
Epoch: 4, Steps: 9 | Train Loss: 1.072 Vali Loss: 1.128 Vali Acc: 0.587 Test Loss: 1.128 Test Acc: 0.587
Validation loss decreased (-0.514481 --> -0.586945).  Saving model ...
Epoch: 5 cost time: 3.2210283279418945
Epoch: 5, Steps: 9 | Train Loss: 0.920 Vali Loss: 1.066 Vali Acc: 0.594 Test Loss: 1.066 Test Acc: 0.594
Validation loss decreased (-0.586945 --> -0.594192).  Saving model ...
Epoch: 6 cost time: 3.409304141998291
Epoch: 6, Steps: 9 | Train Loss: 0.751 Vali Loss: 0.978 Vali Acc: 0.674 Test Loss: 0.978 Test Acc: 0.674
Validation loss decreased (-0.594192 --> -0.673903).  Saving model ...
Epoch: 7 cost time: 3.3044607639312744
Epoch: 7, Steps: 9 | Train Loss: 0.612 Vali Loss: 0.898 Vali Acc: 0.696 Test Loss: 0.898 Test Acc: 0.696
Validation loss decreased (-0.673903 --> -0.695643).  Saving model ...
Epoch: 8 cost time: 3.3056013584136963
Epoch: 8, Steps: 9 | Train Loss: 0.489 Vali Loss: 0.807 Vali Acc: 0.739 Test Loss: 0.807 Test Acc: 0.739
Validation loss decreased (-0.695643 --> -0.739122).  Saving model ...
Epoch: 9 cost time: 3.2574853897094727
Epoch: 9, Steps: 9 | Train Loss: 0.365 Vali Loss: 0.737 Vali Acc: 0.761 Test Loss: 0.737 Test Acc: 0.761
Validation loss decreased (-0.739122 --> -0.760862).  Saving model ...
Epoch: 10 cost time: 3.2700252532958984
Epoch: 10, Steps: 9 | Train Loss: 0.269 Vali Loss: 0.658 Vali Acc: 0.783 Test Loss: 0.658 Test Acc: 0.783
Validation loss decreased (-0.760862 --> -0.782602).  Saving model ...
Epoch: 11 cost time: 3.5212936401367188
Epoch: 11, Steps: 9 | Train Loss: 0.195 Vali Loss: 0.594 Vali Acc: 0.812 Test Loss: 0.594 Test Acc: 0.812
Validation loss decreased (-0.782602 --> -0.811588).  Saving model ...
Epoch: 12 cost time: 3.0853042602539062
Epoch: 12, Steps: 9 | Train Loss: 0.148 Vali Loss: 0.547 Vali Acc: 0.841 Test Loss: 0.547 Test Acc: 0.841
Validation loss decreased (-0.811588 --> -0.840574).  Saving model ...
Epoch: 13 cost time: 3.11399245262146
Epoch: 13, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.508 Vali Acc: 0.855 Test Loss: 0.508 Test Acc: 0.855
Validation loss decreased (-0.840574 --> -0.855067).  Saving model ...
Epoch: 14 cost time: 3.2329494953155518
Epoch: 14, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.510 Vali Acc: 0.870 Test Loss: 0.510 Test Acc: 0.870
Validation loss decreased (-0.855067 --> -0.869560).  Saving model ...
Epoch: 15 cost time: 3.166954278945923
Epoch: 15, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.477 Vali Acc: 0.862 Test Loss: 0.477 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.139331579208374
Epoch: 16, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.446 Vali Acc: 0.870 Test Loss: 0.446 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869561).  Saving model ...
Epoch: 17 cost time: 3.276524782180786
Epoch: 17, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.462 Vali Acc: 0.877 Test Loss: 0.462 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 18 cost time: 3.2672386169433594
Epoch: 18, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.452 Vali Acc: 0.884 Test Loss: 0.452 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884053).  Saving model ...
Epoch: 19 cost time: 3.1916615962982178
Epoch: 19, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.435 Vali Acc: 0.891 Test Loss: 0.435 Test Acc: 0.891
Validation loss decreased (-0.884053 --> -0.891300).  Saving model ...
Epoch: 20 cost time: 3.407984495162964
Epoch: 20, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.424 Vali Acc: 0.884 Test Loss: 0.424 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.497816324234009
Epoch: 21, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.436 Vali Acc: 0.891 Test Loss: 0.436 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.384312152862549
Epoch: 22, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.441 Vali Acc: 0.891 Test Loss: 0.441 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.364403247833252
Epoch: 23, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.449 Vali Acc: 0.891 Test Loss: 0.449 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.2314906120300293
Epoch: 24, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.416 Vali Acc: 0.891 Test Loss: 0.416 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 25 cost time: 3.097607374191284
Epoch: 25, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.413 Vali Acc: 0.891 Test Loss: 0.413 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 26 cost time: 3.116848945617676
Epoch: 26, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.426 Vali Acc: 0.891 Test Loss: 0.426 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.997149705886841
Epoch: 27, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.428 Vali Acc: 0.891 Test Loss: 0.428 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.086223840713501
Epoch: 28, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.415 Vali Acc: 0.891 Test Loss: 0.415 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.2344658374786377
Epoch: 29, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.418 Vali Acc: 0.891 Test Loss: 0.418 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.15474796295166
Epoch: 30, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.413 Vali Acc: 0.891 Test Loss: 0.413 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.2265684604644775
Epoch: 31, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.411 Vali Acc: 0.899 Test Loss: 0.411 Test Acc: 0.899
Validation loss decreased (-0.891300 --> -0.898547).  Saving model ...
Epoch: 32 cost time: 3.36210036277771
Epoch: 32, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.412 Vali Acc: 0.899 Test Loss: 0.412 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.2410619258880615
Epoch: 33, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.410 Vali Acc: 0.899 Test Loss: 0.410 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 34 cost time: 3.1593708992004395
Epoch: 34, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.405 Vali Acc: 0.899 Test Loss: 0.405 Test Acc: 0.899
Validation loss decreased (-0.898547 --> -0.898547).  Saving model ...
Epoch: 35 cost time: 3.4250848293304443
Epoch: 35, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.416 Vali Acc: 0.891 Test Loss: 0.416 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.3926239013671875
Epoch: 36, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.426 Vali Acc: 0.891 Test Loss: 0.426 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.2158989906311035
Epoch: 37, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.422 Vali Acc: 0.891 Test Loss: 0.422 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.0162179470062256
Epoch: 38, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.405 Vali Acc: 0.899 Test Loss: 0.405 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.183898687362671
Epoch: 39, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.407 Vali Acc: 0.899 Test Loss: 0.407 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.0793778896331787
Epoch: 40, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.408 Vali Acc: 0.899 Test Loss: 0.408 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 3.2556374073028564
Epoch: 41, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.419 Vali Acc: 0.899 Test Loss: 0.419 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 3.1791136264801025
Epoch: 42, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.413 Vali Acc: 0.899 Test Loss: 0.413 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.30260968208313
Epoch: 43, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.415 Vali Acc: 0.899 Test Loss: 0.415 Test Acc: 0.899
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 3.311358690261841
Epoch: 44, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.415 Vali Acc: 0.899 Test Loss: 0.415 Test Acc: 0.899
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df512_ma62_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 167492
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         42                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df512_ma42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.857029676437378
Epoch: 1, Steps: 9 | Train Loss: 1.473 Vali Loss: 1.398 Vali Acc: 0.384 Test Loss: 1.398 Test Acc: 0.384
Validation loss decreased (inf --> -0.384044).  Saving model ...
Epoch: 2 cost time: 3.4836952686309814
Epoch: 2, Steps: 9 | Train Loss: 1.325 Vali Loss: 1.291 Vali Acc: 0.471 Test Loss: 1.291 Test Acc: 0.471
Validation loss decreased (-0.384044 --> -0.471002).  Saving model ...
Epoch: 3 cost time: 3.1683666706085205
Epoch: 3, Steps: 9 | Train Loss: 1.207 Vali Loss: 1.190 Vali Acc: 0.514 Test Loss: 1.190 Test Acc: 0.514
Validation loss decreased (-0.471002 --> -0.514481).  Saving model ...
Epoch: 4 cost time: 3.1289236545562744
Epoch: 4, Steps: 9 | Train Loss: 1.057 Vali Loss: 1.093 Vali Acc: 0.609 Test Loss: 1.093 Test Acc: 0.609
Validation loss decreased (-0.514481 --> -0.608685).  Saving model ...
Epoch: 5 cost time: 3.1410233974456787
Epoch: 5, Steps: 9 | Train Loss: 0.896 Vali Loss: 1.025 Vali Acc: 0.616 Test Loss: 1.025 Test Acc: 0.616
Validation loss decreased (-0.608685 --> -0.615932).  Saving model ...
Epoch: 6 cost time: 3.165827512741089
Epoch: 6, Steps: 9 | Train Loss: 0.722 Vali Loss: 0.935 Vali Acc: 0.674 Test Loss: 0.935 Test Acc: 0.674
Validation loss decreased (-0.615932 --> -0.673904).  Saving model ...
Epoch: 7 cost time: 3.2123899459838867
Epoch: 7, Steps: 9 | Train Loss: 0.581 Vali Loss: 0.857 Vali Acc: 0.696 Test Loss: 0.857 Test Acc: 0.696
Validation loss decreased (-0.673904 --> -0.695644).  Saving model ...
Epoch: 8 cost time: 3.0021841526031494
Epoch: 8, Steps: 9 | Train Loss: 0.463 Vali Loss: 0.765 Vali Acc: 0.725 Test Loss: 0.765 Test Acc: 0.725
Validation loss decreased (-0.695644 --> -0.724630).  Saving model ...
Epoch: 9 cost time: 3.0669522285461426
Epoch: 9, Steps: 9 | Train Loss: 0.339 Vali Loss: 0.700 Vali Acc: 0.746 Test Loss: 0.700 Test Acc: 0.746
Validation loss decreased (-0.724630 --> -0.746370).  Saving model ...
Epoch: 10 cost time: 3.001390218734741
Epoch: 10, Steps: 9 | Train Loss: 0.260 Vali Loss: 0.627 Vali Acc: 0.754 Test Loss: 0.627 Test Acc: 0.754
Validation loss decreased (-0.746370 --> -0.753617).  Saving model ...
Epoch: 11 cost time: 3.012120246887207
Epoch: 11, Steps: 9 | Train Loss: 0.180 Vali Loss: 0.577 Vali Acc: 0.819 Test Loss: 0.577 Test Acc: 0.819
Validation loss decreased (-0.753617 --> -0.818835).  Saving model ...
Epoch: 12 cost time: 2.76637864112854
Epoch: 12, Steps: 9 | Train Loss: 0.142 Vali Loss: 0.535 Vali Acc: 0.833 Test Loss: 0.535 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833328).  Saving model ...
Epoch: 13 cost time: 3.0109825134277344
Epoch: 13, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.487 Vali Acc: 0.833 Test Loss: 0.487 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 14 cost time: 3.006502389907837
Epoch: 14, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.492 Vali Acc: 0.841 Test Loss: 0.492 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840575).  Saving model ...
Epoch: 15 cost time: 3.20475172996521
Epoch: 15, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.467 Vali Acc: 0.848 Test Loss: 0.467 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 16 cost time: 3.183603286743164
Epoch: 16, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.428 Vali Acc: 0.848 Test Loss: 0.428 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847822).  Saving model ...
Epoch: 17 cost time: 3.2073798179626465
Epoch: 17, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.449 Vali Acc: 0.862 Test Loss: 0.449 Test Acc: 0.862
Validation loss decreased (-0.847822 --> -0.862314).  Saving model ...
Epoch: 18 cost time: 3.4270641803741455
Epoch: 18, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.448 Vali Acc: 0.862 Test Loss: 0.448 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 19 cost time: 3.4043173789978027
Epoch: 19, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.435 Vali Acc: 0.862 Test Loss: 0.435 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 20 cost time: 3.5112624168395996
Epoch: 20, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.407 Vali Acc: 0.855 Test Loss: 0.407 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.2209084033966064
Epoch: 21, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.411 Vali Acc: 0.862 Test Loss: 0.411 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862315).  Saving model ...
Epoch: 22 cost time: 3.3008675575256348
Epoch: 22, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.425 Vali Acc: 0.862 Test Loss: 0.425 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.252851963043213
Epoch: 23, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.426 Vali Acc: 0.862 Test Loss: 0.426 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.208453893661499
Epoch: 24, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.398 Vali Acc: 0.862 Test Loss: 0.398 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 25 cost time: 3.122950315475464
Epoch: 25, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.395 Vali Acc: 0.870 Test Loss: 0.395 Test Acc: 0.870
Validation loss decreased (-0.862315 --> -0.869561).  Saving model ...
Epoch: 26 cost time: 3.1341371536254883
Epoch: 26, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.401 Vali Acc: 0.862 Test Loss: 0.401 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.835303783416748
Epoch: 27, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.406 Vali Acc: 0.862 Test Loss: 0.406 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.2347612380981445
Epoch: 28, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.388 Vali Acc: 0.862 Test Loss: 0.388 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.3076982498168945
Epoch: 29, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.400 Vali Acc: 0.862 Test Loss: 0.400 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.5009634494781494
Epoch: 30, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.394 Vali Acc: 0.862 Test Loss: 0.394 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.325206995010376
Epoch: 31, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.389 Vali Acc: 0.862 Test Loss: 0.389 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.3717057704925537
Epoch: 32, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.385 Vali Acc: 0.870 Test Loss: 0.385 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 33 cost time: 3.5030462741851807
Epoch: 33, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.396 Vali Acc: 0.862 Test Loss: 0.396 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.0153748989105225
Epoch: 34, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.400 Vali Acc: 0.862 Test Loss: 0.400 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.083220958709717
Epoch: 35, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.402 Vali Acc: 0.862 Test Loss: 0.402 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.934788465499878
Epoch: 36, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.403 Vali Acc: 0.862 Test Loss: 0.403 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.017641305923462
Epoch: 37, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.391 Vali Acc: 0.870 Test Loss: 0.391 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 2.8620457649230957
Epoch: 38, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.379 Vali Acc: 0.870 Test Loss: 0.379 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 39 cost time: 2.792607307434082
Epoch: 39, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.386 Vali Acc: 0.870 Test Loss: 0.386 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.543637752532959
Epoch: 40, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.387 Vali Acc: 0.870 Test Loss: 0.387 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.2938690185546875
Epoch: 41, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.392 Vali Acc: 0.870 Test Loss: 0.392 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.285256862640381
Epoch: 42, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.377 Vali Acc: 0.870 Test Loss: 0.377 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 43 cost time: 3.3789174556732178
Epoch: 43, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.382 Vali Acc: 0.870 Test Loss: 0.382 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.323286533355713
Epoch: 44, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.387 Vali Acc: 0.870 Test Loss: 0.387 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.417715311050415
Epoch: 45, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.405 Vali Acc: 0.862 Test Loss: 0.405 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.0704519748687744
Epoch: 46, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.400 Vali Acc: 0.870 Test Loss: 0.400 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 3.131073236465454
Epoch: 47, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.385 Vali Acc: 0.870 Test Loss: 0.385 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 3.1560750007629395
Epoch: 48, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.376 Vali Acc: 0.870 Test Loss: 0.376 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 49 cost time: 3.034569025039673
Epoch: 49, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.384 Vali Acc: 0.870 Test Loss: 0.384 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.0113070011138916
Epoch: 50, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.392 Vali Acc: 0.870 Test Loss: 0.392 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 3.0553348064422607
Epoch: 51, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.390 Vali Acc: 0.870 Test Loss: 0.390 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 3.3275229930877686
Epoch: 52, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.389 Vali Acc: 0.870 Test Loss: 0.389 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 3.4052507877349854
Epoch: 53, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.390 Vali Acc: 0.870 Test Loss: 0.390 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 3.34564208984375
Epoch: 54, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.394 Vali Acc: 0.870 Test Loss: 0.394 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 3.5408377647399902
Epoch: 55, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.389 Vali Acc: 0.870 Test Loss: 0.389 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 3.43096923828125
Epoch: 56, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.389 Vali Acc: 0.870 Test Loss: 0.389 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 3.591270685195923
Epoch: 57, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.398 Vali Acc: 0.870 Test Loss: 0.398 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 3.1891109943389893
Epoch: 58, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.391 Vali Acc: 0.870 Test Loss: 0.391 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df512_ma42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 167492
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df512_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.501055002212524
Epoch: 1, Steps: 9 | Train Loss: 1.495 Vali Loss: 1.418 Vali Acc: 0.326 Test Loss: 1.418 Test Acc: 0.326
Validation loss decreased (inf --> -0.326073).  Saving model ...
Epoch: 2 cost time: 3.2641894817352295
Epoch: 2, Steps: 9 | Train Loss: 1.327 Vali Loss: 1.321 Vali Acc: 0.413 Test Loss: 1.321 Test Acc: 0.413
Validation loss decreased (-0.326073 --> -0.413030).  Saving model ...
Epoch: 3 cost time: 3.44376277923584
Epoch: 3, Steps: 9 | Train Loss: 1.217 Vali Loss: 1.230 Vali Acc: 0.514 Test Loss: 1.230 Test Acc: 0.514
Validation loss decreased (-0.413030 --> -0.514480).  Saving model ...
Epoch: 4 cost time: 3.278707265853882
Epoch: 4, Steps: 9 | Train Loss: 1.082 Vali Loss: 1.140 Vali Acc: 0.609 Test Loss: 1.140 Test Acc: 0.609
Validation loss decreased (-0.514480 --> -0.608684).  Saving model ...
Epoch: 5 cost time: 3.358480453491211
Epoch: 5, Steps: 9 | Train Loss: 0.917 Vali Loss: 1.064 Vali Acc: 0.609 Test Loss: 1.064 Test Acc: 0.609
Validation loss decreased (-0.608684 --> -0.608685).  Saving model ...
Epoch: 6 cost time: 3.461310625076294
Epoch: 6, Steps: 9 | Train Loss: 0.747 Vali Loss: 0.971 Vali Acc: 0.667 Test Loss: 0.971 Test Acc: 0.667
Validation loss decreased (-0.608685 --> -0.666657).  Saving model ...
Epoch: 7 cost time: 3.164621114730835
Epoch: 7, Steps: 9 | Train Loss: 0.611 Vali Loss: 0.884 Vali Acc: 0.688 Test Loss: 0.884 Test Acc: 0.688
Validation loss decreased (-0.666657 --> -0.688397).  Saving model ...
Epoch: 8 cost time: 3.2007267475128174
Epoch: 8, Steps: 9 | Train Loss: 0.487 Vali Loss: 0.782 Vali Acc: 0.732 Test Loss: 0.782 Test Acc: 0.732
Validation loss decreased (-0.688397 --> -0.731876).  Saving model ...
Epoch: 9 cost time: 3.0783438682556152
Epoch: 9, Steps: 9 | Train Loss: 0.387 Vali Loss: 0.703 Vali Acc: 0.768 Test Loss: 0.703 Test Acc: 0.768
Validation loss decreased (-0.731876 --> -0.768109).  Saving model ...
Epoch: 10 cost time: 2.902308702468872
Epoch: 10, Steps: 9 | Train Loss: 0.278 Vali Loss: 0.626 Vali Acc: 0.826 Test Loss: 0.626 Test Acc: 0.826
Validation loss decreased (-0.768109 --> -0.826081).  Saving model ...
Epoch: 11 cost time: 2.778778314590454
Epoch: 11, Steps: 9 | Train Loss: 0.209 Vali Loss: 0.562 Vali Acc: 0.826 Test Loss: 0.562 Test Acc: 0.826
Validation loss decreased (-0.826081 --> -0.826081).  Saving model ...
Epoch: 12 cost time: 3.1075453758239746
Epoch: 12, Steps: 9 | Train Loss: 0.158 Vali Loss: 0.510 Vali Acc: 0.855 Test Loss: 0.510 Test Acc: 0.855
Validation loss decreased (-0.826081 --> -0.855067).  Saving model ...
Epoch: 13 cost time: 2.9436283111572266
Epoch: 13, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.470 Vali Acc: 0.870 Test Loss: 0.470 Test Acc: 0.870
Validation loss decreased (-0.855067 --> -0.869561).  Saving model ...
Epoch: 14 cost time: 3.1374871730804443
Epoch: 14, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.461 Vali Acc: 0.870 Test Loss: 0.461 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 15 cost time: 3.022594928741455
Epoch: 15, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.436 Vali Acc: 0.848 Test Loss: 0.436 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.0495989322662354
Epoch: 16, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.403 Vali Acc: 0.870 Test Loss: 0.403 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 17 cost time: 3.4216976165771484
Epoch: 17, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.421 Vali Acc: 0.870 Test Loss: 0.421 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.359672784805298
Epoch: 18, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.406 Vali Acc: 0.877 Test Loss: 0.406 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876808).  Saving model ...
Epoch: 19 cost time: 3.3008129596710205
Epoch: 19, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.393 Vali Acc: 0.877 Test Loss: 0.393 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 20 cost time: 3.140195369720459
Epoch: 20, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.375 Vali Acc: 0.877 Test Loss: 0.375 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 21 cost time: 3.0433552265167236
Epoch: 21, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.365 Vali Acc: 0.877 Test Loss: 0.365 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 22 cost time: 3.063307285308838
Epoch: 22, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.375 Vali Acc: 0.877 Test Loss: 0.375 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.1790387630462646
Epoch: 23, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.368 Vali Acc: 0.877 Test Loss: 0.368 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.1401207447052
Epoch: 24, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.356 Vali Acc: 0.877 Test Loss: 0.356 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 25 cost time: 3.1094791889190674
Epoch: 25, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.355 Vali Acc: 0.877 Test Loss: 0.355 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 26 cost time: 2.9740099906921387
Epoch: 26, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.356 Vali Acc: 0.877 Test Loss: 0.356 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.2048511505126953
Epoch: 27, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.360 Vali Acc: 0.877 Test Loss: 0.360 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.284818172454834
Epoch: 28, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.341 Vali Acc: 0.877 Test Loss: 0.341 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 29 cost time: 3.4508893489837646
Epoch: 29, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.349 Vali Acc: 0.877 Test Loss: 0.349 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.6838107109069824
Epoch: 30, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.347 Vali Acc: 0.877 Test Loss: 0.347 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.5721161365509033
Epoch: 31, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.338 Vali Acc: 0.877 Test Loss: 0.338 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 32 cost time: 3.4576127529144287
Epoch: 32, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.327 Vali Acc: 0.877 Test Loss: 0.327 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 33 cost time: 3.2614848613739014
Epoch: 33, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.342 Vali Acc: 0.877 Test Loss: 0.342 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.3501675128936768
Epoch: 34, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.345 Vali Acc: 0.877 Test Loss: 0.345 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.4402642250061035
Epoch: 35, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.344 Vali Acc: 0.877 Test Loss: 0.344 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.2239813804626465
Epoch: 36, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.347 Vali Acc: 0.877 Test Loss: 0.347 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.9808671474456787
Epoch: 37, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.338 Vali Acc: 0.877 Test Loss: 0.338 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.091836929321289
Epoch: 38, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.328 Vali Acc: 0.877 Test Loss: 0.328 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.396479368209839
Epoch: 39, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.325 Vali Acc: 0.877 Test Loss: 0.325 Test Acc: 0.877
Validation loss decreased (-0.876808 --> -0.876808).  Saving model ...
Epoch: 40 cost time: 3.3211257457733154
Epoch: 40, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.324 Vali Acc: 0.884 Test Loss: 0.324 Test Acc: 0.884
Validation loss decreased (-0.876808 --> -0.884055).  Saving model ...
Epoch: 41 cost time: 3.4898998737335205
Epoch: 41, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.331 Vali Acc: 0.884 Test Loss: 0.331 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.4884321689605713
Epoch: 42, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.327 Vali Acc: 0.884 Test Loss: 0.327 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.5032799243927
Epoch: 43, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.334 Vali Acc: 0.884 Test Loss: 0.334 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.4157204627990723
Epoch: 44, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.332 Vali Acc: 0.884 Test Loss: 0.332 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 3.08426570892334
Epoch: 45, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.334 Vali Acc: 0.884 Test Loss: 0.334 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 3.2427468299865723
Epoch: 46, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.331 Vali Acc: 0.884 Test Loss: 0.331 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 3.1879770755767822
Epoch: 47, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.319 Vali Acc: 0.884 Test Loss: 0.319 Test Acc: 0.884
Validation loss decreased (-0.884055 --> -0.884055).  Saving model ...
Epoch: 48 cost time: 3.0258233547210693
Epoch: 48, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.315 Vali Acc: 0.891 Test Loss: 0.315 Test Acc: 0.891
Validation loss decreased (-0.884055 --> -0.891301).  Saving model ...
Epoch: 49 cost time: 3.11812424659729
Epoch: 49, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.323 Vali Acc: 0.884 Test Loss: 0.323 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.1074225902557373
Epoch: 50, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.326 Vali Acc: 0.884 Test Loss: 0.326 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 3.3180646896362305
Epoch: 51, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.321 Vali Acc: 0.884 Test Loss: 0.321 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 3.452134847640991
Epoch: 52, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.317 Vali Acc: 0.891 Test Loss: 0.317 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 3.3553881645202637
Epoch: 53, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.324 Vali Acc: 0.884 Test Loss: 0.324 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 3.3795619010925293
Epoch: 54, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.322 Vali Acc: 0.891 Test Loss: 0.322 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 3.296640157699585
Epoch: 55, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.308 Vali Acc: 0.891 Test Loss: 0.308 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 56 cost time: 3.2265431880950928
Epoch: 56, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.312 Vali Acc: 0.891 Test Loss: 0.312 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 2.803161144256592
Epoch: 57, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.319 Vali Acc: 0.891 Test Loss: 0.319 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 2.751725673675537
Epoch: 58, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.322 Vali Acc: 0.891 Test Loss: 0.322 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 2.946545124053955
Epoch: 59, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.326 Vali Acc: 0.891 Test Loss: 0.326 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 2.909411907196045
Epoch: 60, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.325 Vali Acc: 0.891 Test Loss: 0.325 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 2.7833092212677
Epoch: 61, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.322 Vali Acc: 0.891 Test Loss: 0.322 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 2.9125044345855713
Epoch: 62, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.316 Vali Acc: 0.891 Test Loss: 0.316 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 2.9280641078948975
Epoch: 63, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.312 Vali Acc: 0.891 Test Loss: 0.312 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 2.935981035232544
Epoch: 64, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.309 Vali Acc: 0.891 Test Loss: 0.309 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 3.03482723236084
Epoch: 65, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.305 Vali Acc: 0.891 Test Loss: 0.305 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 66 cost time: 3.387876272201538
Epoch: 66, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.305 Vali Acc: 0.891 Test Loss: 0.305 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 3.093256711959839
Epoch: 67, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.300 Vali Acc: 0.891 Test Loss: 0.300 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 68 cost time: 3.1839518547058105
Epoch: 68, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.300 Vali Acc: 0.891 Test Loss: 0.300 Test Acc: 0.891
Validation loss decreased (-0.891301 --> -0.891301).  Saving model ...
Epoch: 69 cost time: 3.211954116821289
Epoch: 69, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.306 Vali Acc: 0.891 Test Loss: 0.306 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 3.099562168121338
Epoch: 70, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.310 Vali Acc: 0.891 Test Loss: 0.310 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 3.2043979167938232
Epoch: 71, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.310 Vali Acc: 0.891 Test Loss: 0.310 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 3.1414027214050293
Epoch: 72, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.307 Vali Acc: 0.891 Test Loss: 0.307 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 3.0796639919281006
Epoch: 73, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.301 Vali Acc: 0.891 Test Loss: 0.301 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 3.1689236164093018
Epoch: 74, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.307 Vali Acc: 0.891 Test Loss: 0.307 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 3.234898090362549
Epoch: 75, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.314 Vali Acc: 0.891 Test Loss: 0.314 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 3.554647207260132
Epoch: 76, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.312 Vali Acc: 0.891 Test Loss: 0.312 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 3.6066842079162598
Epoch: 77, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.306 Vali Acc: 0.891 Test Loss: 0.306 Test Acc: 0.891
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 3.536785840988159
Epoch: 78, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.307 Vali Acc: 0.891 Test Loss: 0.307 Test Acc: 0.891
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df512_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 167492
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df512_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.858427286148071
Epoch: 1, Steps: 9 | Train Loss: 1.468 Vali Loss: 1.414 Vali Acc: 0.326 Test Loss: 1.414 Test Acc: 0.326
Validation loss decreased (inf --> -0.326073).  Saving model ...
Epoch: 2 cost time: 3.177980899810791
Epoch: 2, Steps: 9 | Train Loss: 1.343 Vali Loss: 1.326 Vali Acc: 0.406 Test Loss: 1.326 Test Acc: 0.406
Validation loss decreased (-0.326073 --> -0.405784).  Saving model ...
Epoch: 3 cost time: 3.1411683559417725
Epoch: 3, Steps: 9 | Train Loss: 1.220 Vali Loss: 1.240 Vali Acc: 0.457 Test Loss: 1.240 Test Acc: 0.457
Validation loss decreased (-0.405784 --> -0.456509).  Saving model ...
Epoch: 4 cost time: 3.2452051639556885
Epoch: 4, Steps: 9 | Train Loss: 1.092 Vali Loss: 1.159 Vali Acc: 0.594 Test Loss: 1.159 Test Acc: 0.594
Validation loss decreased (-0.456509 --> -0.594191).  Saving model ...
Epoch: 5 cost time: 3.182603359222412
Epoch: 5, Steps: 9 | Train Loss: 0.953 Vali Loss: 1.086 Vali Acc: 0.580 Test Loss: 1.086 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.244004964828491
Epoch: 6, Steps: 9 | Train Loss: 0.788 Vali Loss: 1.003 Vali Acc: 0.638 Test Loss: 1.003 Test Acc: 0.638
Validation loss decreased (-0.594191 --> -0.637671).  Saving model ...
Epoch: 7 cost time: 3.7269487380981445
Epoch: 7, Steps: 9 | Train Loss: 0.655 Vali Loss: 0.918 Vali Acc: 0.652 Test Loss: 0.918 Test Acc: 0.652
Validation loss decreased (-0.637671 --> -0.652165).  Saving model ...
Epoch: 8 cost time: 3.7203080654144287
Epoch: 8, Steps: 9 | Train Loss: 0.542 Vali Loss: 0.818 Vali Acc: 0.717 Test Loss: 0.818 Test Acc: 0.717
Validation loss decreased (-0.652165 --> -0.717383).  Saving model ...
Epoch: 9 cost time: 3.543088674545288
Epoch: 9, Steps: 9 | Train Loss: 0.423 Vali Loss: 0.746 Vali Acc: 0.725 Test Loss: 0.746 Test Acc: 0.725
Validation loss decreased (-0.717383 --> -0.724630).  Saving model ...
Epoch: 10 cost time: 3.50268816947937
Epoch: 10, Steps: 9 | Train Loss: 0.331 Vali Loss: 0.677 Vali Acc: 0.746 Test Loss: 0.677 Test Acc: 0.746
Validation loss decreased (-0.724630 --> -0.746370).  Saving model ...
Epoch: 11 cost time: 3.386709451675415
Epoch: 11, Steps: 9 | Train Loss: 0.252 Vali Loss: 0.605 Vali Acc: 0.775 Test Loss: 0.605 Test Acc: 0.775
Validation loss decreased (-0.746370 --> -0.775356).  Saving model ...
Epoch: 12 cost time: 3.39693284034729
Epoch: 12, Steps: 9 | Train Loss: 0.206 Vali Loss: 0.568 Vali Acc: 0.797 Test Loss: 0.568 Test Acc: 0.797
Validation loss decreased (-0.775356 --> -0.797096).  Saving model ...
Epoch: 13 cost time: 3.3070242404937744
Epoch: 13, Steps: 9 | Train Loss: 0.150 Vali Loss: 0.533 Vali Acc: 0.812 Test Loss: 0.533 Test Acc: 0.812
Validation loss decreased (-0.797096 --> -0.811589).  Saving model ...
Epoch: 14 cost time: 3.3648478984832764
Epoch: 14, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.504 Vali Acc: 0.804 Test Loss: 0.504 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.991464853286743
Epoch: 15, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.480 Vali Acc: 0.848 Test Loss: 0.480 Test Acc: 0.848
Validation loss decreased (-0.811589 --> -0.847821).  Saving model ...
Epoch: 16 cost time: 3.0749757289886475
Epoch: 16, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.476 Vali Acc: 0.804 Test Loss: 0.476 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.127288579940796
Epoch: 17, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.470 Vali Acc: 0.841 Test Loss: 0.470 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.06095290184021
Epoch: 18, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.452 Vali Acc: 0.841 Test Loss: 0.452 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.6327223777770996
Epoch: 19, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.453 Vali Acc: 0.848 Test Loss: 0.453 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847822).  Saving model ...
Epoch: 20 cost time: 3.379948616027832
Epoch: 20, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.447 Vali Acc: 0.826 Test Loss: 0.447 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.514456272125244
Epoch: 21, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.444 Vali Acc: 0.826 Test Loss: 0.444 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.202810525894165
Epoch: 22, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.443 Vali Acc: 0.833 Test Loss: 0.443 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.4304473400115967
Epoch: 23, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.443 Vali Acc: 0.833 Test Loss: 0.443 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.32116436958313
Epoch: 24, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.425 Vali Acc: 0.826 Test Loss: 0.425 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.4353878498077393
Epoch: 25, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.426 Vali Acc: 0.833 Test Loss: 0.426 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.433999538421631
Epoch: 26, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.441 Vali Acc: 0.833 Test Loss: 0.441 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.455768585205078
Epoch: 27, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.424 Vali Acc: 0.833 Test Loss: 0.424 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.0439867973327637
Epoch: 28, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.410 Vali Acc: 0.826 Test Loss: 0.410 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.513345718383789
Epoch: 29, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.424 Vali Acc: 0.833 Test Loss: 0.424 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df512_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 167492
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df512_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.412598609924316
Epoch: 1, Steps: 9 | Train Loss: 1.448 Vali Loss: 1.416 Vali Acc: 0.275 Test Loss: 1.416 Test Acc: 0.275
Validation loss decreased (inf --> -0.275348).  Saving model ...
Epoch: 2 cost time: 3.436110734939575
Epoch: 2, Steps: 9 | Train Loss: 1.303 Vali Loss: 1.320 Vali Acc: 0.420 Test Loss: 1.320 Test Acc: 0.420
Validation loss decreased (-0.275348 --> -0.420277).  Saving model ...
Epoch: 3 cost time: 3.330273151397705
Epoch: 3, Steps: 9 | Train Loss: 1.199 Vali Loss: 1.216 Vali Acc: 0.493 Test Loss: 1.216 Test Acc: 0.493
Validation loss decreased (-0.420277 --> -0.492741).  Saving model ...
Epoch: 4 cost time: 3.1585607528686523
Epoch: 4, Steps: 9 | Train Loss: 1.070 Vali Loss: 1.118 Vali Acc: 0.580 Test Loss: 1.118 Test Acc: 0.580
Validation loss decreased (-0.492741 --> -0.579699).  Saving model ...
Epoch: 5 cost time: 3.0763142108917236
Epoch: 5, Steps: 9 | Train Loss: 0.899 Vali Loss: 1.047 Vali Acc: 0.580 Test Loss: 1.047 Test Acc: 0.580
Validation loss decreased (-0.579699 --> -0.579700).  Saving model ...
Epoch: 6 cost time: 3.1767306327819824
Epoch: 6, Steps: 9 | Train Loss: 0.756 Vali Loss: 0.973 Vali Acc: 0.601 Test Loss: 0.973 Test Acc: 0.601
Validation loss decreased (-0.579700 --> -0.601440).  Saving model ...
Epoch: 7 cost time: 3.0247092247009277
Epoch: 7, Steps: 9 | Train Loss: 0.596 Vali Loss: 0.896 Vali Acc: 0.638 Test Loss: 0.896 Test Acc: 0.638
Validation loss decreased (-0.601440 --> -0.637672).  Saving model ...
Epoch: 8 cost time: 2.923352003097534
Epoch: 8, Steps: 9 | Train Loss: 0.499 Vali Loss: 0.815 Vali Acc: 0.667 Test Loss: 0.815 Test Acc: 0.667
Validation loss decreased (-0.637672 --> -0.666659).  Saving model ...
Epoch: 9 cost time: 3.113626480102539
Epoch: 9, Steps: 9 | Train Loss: 0.368 Vali Loss: 0.784 Vali Acc: 0.703 Test Loss: 0.784 Test Acc: 0.703
Validation loss decreased (-0.666659 --> -0.702891).  Saving model ...
Epoch: 10 cost time: 3.0802664756774902
Epoch: 10, Steps: 9 | Train Loss: 0.282 Vali Loss: 0.723 Vali Acc: 0.732 Test Loss: 0.723 Test Acc: 0.732
Validation loss decreased (-0.702891 --> -0.731877).  Saving model ...
Epoch: 11 cost time: 3.1073081493377686
Epoch: 11, Steps: 9 | Train Loss: 0.224 Vali Loss: 0.686 Vali Acc: 0.732 Test Loss: 0.686 Test Acc: 0.732
Validation loss decreased (-0.731877 --> -0.731877).  Saving model ...
Epoch: 12 cost time: 3.1153476238250732
Epoch: 12, Steps: 9 | Train Loss: 0.194 Vali Loss: 0.665 Vali Acc: 0.761 Test Loss: 0.665 Test Acc: 0.761
Validation loss decreased (-0.731877 --> -0.760863).  Saving model ...
Epoch: 13 cost time: 3.1100692749023438
Epoch: 13, Steps: 9 | Train Loss: 0.151 Vali Loss: 0.640 Vali Acc: 0.746 Test Loss: 0.640 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.4154582023620605
Epoch: 14, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.634 Vali Acc: 0.746 Test Loss: 0.634 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.6568658351898193
Epoch: 15, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.624 Vali Acc: 0.754 Test Loss: 0.624 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.241905689239502
Epoch: 16, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.609 Vali Acc: 0.761 Test Loss: 0.609 Test Acc: 0.761
Validation loss decreased (-0.760863 --> -0.760863).  Saving model ...
Epoch: 17 cost time: 2.9756805896759033
Epoch: 17, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.620 Vali Acc: 0.768 Test Loss: 0.620 Test Acc: 0.768
Validation loss decreased (-0.760863 --> -0.768110).  Saving model ...
Epoch: 18 cost time: 2.966691255569458
Epoch: 18, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.618 Vali Acc: 0.775 Test Loss: 0.618 Test Acc: 0.775
Validation loss decreased (-0.768110 --> -0.775356).  Saving model ...
Epoch: 19 cost time: 3.0006730556488037
Epoch: 19, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.613 Vali Acc: 0.775 Test Loss: 0.613 Test Acc: 0.775
Validation loss decreased (-0.775356 --> -0.775356).  Saving model ...
Epoch: 20 cost time: 3.0709660053253174
Epoch: 20, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.605 Vali Acc: 0.797 Test Loss: 0.605 Test Acc: 0.797
Validation loss decreased (-0.775356 --> -0.797095).  Saving model ...
Epoch: 21 cost time: 3.0992250442504883
Epoch: 21, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.606 Vali Acc: 0.797 Test Loss: 0.606 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.998561382293701
Epoch: 22, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.621 Vali Acc: 0.790 Test Loss: 0.621 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.3221356868743896
Epoch: 23, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.617 Vali Acc: 0.790 Test Loss: 0.617 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.4078919887542725
Epoch: 24, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.607 Vali Acc: 0.790 Test Loss: 0.607 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.601588249206543
Epoch: 25, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.622 Vali Acc: 0.790 Test Loss: 0.622 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.613906145095825
Epoch: 26, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.633 Vali Acc: 0.790 Test Loss: 0.633 Test Acc: 0.790
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.1987829208374023
Epoch: 27, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.623 Vali Acc: 0.790 Test Loss: 0.623 Test Acc: 0.790
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.4819705486297607
Epoch: 28, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.621 Vali Acc: 0.790 Test Loss: 0.621 Test Acc: 0.790
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.2175791263580322
Epoch: 29, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.630 Vali Acc: 0.797 Test Loss: 0.630 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.220194101333618
Epoch: 30, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.633 Vali Acc: 0.812 Test Loss: 0.633 Test Acc: 0.812
Validation loss decreased (-0.797095 --> -0.811588).  Saving model ...
Epoch: 31 cost time: 3.187926769256592
Epoch: 31, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.636 Vali Acc: 0.804 Test Loss: 0.636 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.9968364238739014
Epoch: 32, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.639 Vali Acc: 0.804 Test Loss: 0.639 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.1667213439941406
Epoch: 33, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.652 Vali Acc: 0.804 Test Loss: 0.652 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.2271311283111572
Epoch: 34, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.643 Vali Acc: 0.797 Test Loss: 0.643 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.2459583282470703
Epoch: 35, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.651 Vali Acc: 0.804 Test Loss: 0.651 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.433063507080078
Epoch: 36, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.656 Vali Acc: 0.804 Test Loss: 0.656 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.3100595474243164
Epoch: 37, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.657 Vali Acc: 0.804 Test Loss: 0.657 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.5491020679473877
Epoch: 38, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.651 Vali Acc: 0.790 Test Loss: 0.651 Test Acc: 0.790
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 3.5722110271453857
Epoch: 39, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.655 Vali Acc: 0.790 Test Loss: 0.655 Test Acc: 0.790
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 3.929422616958618
Epoch: 40, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.657 Vali Acc: 0.797 Test Loss: 0.657 Test Acc: 0.797
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df512_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8115942028985508
model parameter : 167492
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.017232656478882
Epoch: 1, Steps: 9 | Train Loss: 1.427 Vali Loss: 1.460 Vali Acc: 0.254 Test Loss: 1.460 Test Acc: 0.254
Validation loss decreased (inf --> -0.253609).  Saving model ...
Epoch: 2 cost time: 2.997105121612549
Epoch: 2, Steps: 9 | Train Loss: 1.341 Vali Loss: 1.424 Vali Acc: 0.268 Test Loss: 1.424 Test Acc: 0.268
Validation loss decreased (-0.253609 --> -0.268102).  Saving model ...
Epoch: 3 cost time: 2.8058886528015137
Epoch: 3, Steps: 9 | Train Loss: 1.280 Vali Loss: 1.386 Vali Acc: 0.290 Test Loss: 1.386 Test Acc: 0.290
Validation loss decreased (-0.268102 --> -0.289841).  Saving model ...
Epoch: 4 cost time: 3.09159255027771
Epoch: 4, Steps: 9 | Train Loss: 1.212 Vali Loss: 1.369 Vali Acc: 0.326 Test Loss: 1.369 Test Acc: 0.326
Validation loss decreased (-0.289841 --> -0.326073).  Saving model ...
Epoch: 5 cost time: 3.170485734939575
Epoch: 5, Steps: 9 | Train Loss: 1.070 Vali Loss: 1.349 Vali Acc: 0.348 Test Loss: 1.349 Test Acc: 0.348
Validation loss decreased (-0.326073 --> -0.347813).  Saving model ...
Epoch: 6 cost time: 3.2213635444641113
Epoch: 6, Steps: 9 | Train Loss: 0.980 Vali Loss: 1.310 Vali Acc: 0.406 Test Loss: 1.310 Test Acc: 0.406
Validation loss decreased (-0.347813 --> -0.405784).  Saving model ...
Epoch: 7 cost time: 3.2021849155426025
Epoch: 7, Steps: 9 | Train Loss: 0.842 Vali Loss: 1.292 Vali Acc: 0.399 Test Loss: 1.292 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.2393691539764404
Epoch: 8, Steps: 9 | Train Loss: 0.740 Vali Loss: 1.262 Vali Acc: 0.377 Test Loss: 1.262 Test Acc: 0.377
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.9404208660125732
Epoch: 9, Steps: 9 | Train Loss: 0.635 Vali Loss: 1.233 Vali Acc: 0.435 Test Loss: 1.233 Test Acc: 0.435
Validation loss decreased (-0.405784 --> -0.434770).  Saving model ...
Epoch: 10 cost time: 3.355658531188965
Epoch: 10, Steps: 9 | Train Loss: 0.541 Vali Loss: 1.227 Vali Acc: 0.442 Test Loss: 1.227 Test Acc: 0.442
Validation loss decreased (-0.434770 --> -0.442017).  Saving model ...
Epoch: 11 cost time: 2.989093780517578
Epoch: 11, Steps: 9 | Train Loss: 0.444 Vali Loss: 1.226 Vali Acc: 0.435 Test Loss: 1.226 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.134666919708252
Epoch: 12, Steps: 9 | Train Loss: 0.404 Vali Loss: 1.190 Vali Acc: 0.457 Test Loss: 1.190 Test Acc: 0.457
Validation loss decreased (-0.442017 --> -0.456510).  Saving model ...
Epoch: 13 cost time: 2.9785521030426025
Epoch: 13, Steps: 9 | Train Loss: 0.310 Vali Loss: 1.223 Vali Acc: 0.471 Test Loss: 1.223 Test Acc: 0.471
Validation loss decreased (-0.456510 --> -0.471002).  Saving model ...
Epoch: 14 cost time: 3.4238216876983643
Epoch: 14, Steps: 9 | Train Loss: 0.267 Vali Loss: 1.228 Vali Acc: 0.464 Test Loss: 1.228 Test Acc: 0.464
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.096722364425659
Epoch: 15, Steps: 9 | Train Loss: 0.196 Vali Loss: 1.187 Vali Acc: 0.486 Test Loss: 1.187 Test Acc: 0.486
Validation loss decreased (-0.471002 --> -0.485495).  Saving model ...
Epoch: 16 cost time: 3.0076942443847656
Epoch: 16, Steps: 9 | Train Loss: 0.165 Vali Loss: 1.302 Vali Acc: 0.449 Test Loss: 1.302 Test Acc: 0.449
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.133823871612549
Epoch: 17, Steps: 9 | Train Loss: 0.137 Vali Loss: 1.330 Vali Acc: 0.449 Test Loss: 1.330 Test Acc: 0.449
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.252751350402832
Epoch: 18, Steps: 9 | Train Loss: 0.127 Vali Loss: 1.238 Vali Acc: 0.493 Test Loss: 1.238 Test Acc: 0.493
Validation loss decreased (-0.485495 --> -0.492741).  Saving model ...
Epoch: 19 cost time: 2.990873098373413
Epoch: 19, Steps: 9 | Train Loss: 0.101 Vali Loss: 1.337 Vali Acc: 0.442 Test Loss: 1.337 Test Acc: 0.442
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.1706888675689697
Epoch: 20, Steps: 9 | Train Loss: 0.092 Vali Loss: 1.397 Vali Acc: 0.449 Test Loss: 1.397 Test Acc: 0.449
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.156575918197632
Epoch: 21, Steps: 9 | Train Loss: 0.070 Vali Loss: 1.383 Vali Acc: 0.435 Test Loss: 1.383 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.151458978652954
Epoch: 22, Steps: 9 | Train Loss: 0.062 Vali Loss: 1.355 Vali Acc: 0.449 Test Loss: 1.355 Test Acc: 0.449
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.0945472717285156
Epoch: 23, Steps: 9 | Train Loss: 0.057 Vali Loss: 1.342 Vali Acc: 0.464 Test Loss: 1.342 Test Acc: 0.464
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.0517168045043945
Epoch: 24, Steps: 9 | Train Loss: 0.051 Vali Loss: 1.447 Vali Acc: 0.478 Test Loss: 1.447 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.325155735015869
Epoch: 25, Steps: 9 | Train Loss: 0.042 Vali Loss: 1.369 Vali Acc: 0.478 Test Loss: 1.369 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.258500576019287
Epoch: 26, Steps: 9 | Train Loss: 0.038 Vali Loss: 1.357 Vali Acc: 0.478 Test Loss: 1.357 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.270920991897583
Epoch: 27, Steps: 9 | Train Loss: 0.031 Vali Loss: 1.404 Vali Acc: 0.464 Test Loss: 1.404 Test Acc: 0.464
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.4334006309509277
Epoch: 28, Steps: 9 | Train Loss: 0.030 Vali Loss: 1.429 Vali Acc: 0.471 Test Loss: 1.429 Test Acc: 0.471
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.4927536231884058
model parameter : 167492
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.16109824180603
Epoch: 1, Steps: 9 | Train Loss: 1.422 Vali Loss: 1.454 Vali Acc: 0.239 Test Loss: 1.454 Test Acc: 0.239
Validation loss decreased (inf --> -0.239116).  Saving model ...
Epoch: 2 cost time: 2.9162681102752686
Epoch: 2, Steps: 9 | Train Loss: 1.384 Vali Loss: 1.437 Vali Acc: 0.246 Test Loss: 1.437 Test Acc: 0.246
Validation loss decreased (-0.239116 --> -0.246362).  Saving model ...
Epoch: 3 cost time: 2.7086751461029053
Epoch: 3, Steps: 9 | Train Loss: 1.346 Vali Loss: 1.418 Vali Acc: 0.297 Test Loss: 1.418 Test Acc: 0.297
Validation loss decreased (-0.246362 --> -0.297087).  Saving model ...
Epoch: 4 cost time: 2.8127849102020264
Epoch: 4, Steps: 9 | Train Loss: 1.303 Vali Loss: 1.423 Vali Acc: 0.297 Test Loss: 1.423 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7322800159454346
Epoch: 5, Steps: 9 | Train Loss: 1.229 Vali Loss: 1.435 Vali Acc: 0.304 Test Loss: 1.435 Test Acc: 0.304
Validation loss decreased (-0.297087 --> -0.304333).  Saving model ...
Epoch: 6 cost time: 2.9503848552703857
Epoch: 6, Steps: 9 | Train Loss: 1.142 Vali Loss: 1.441 Vali Acc: 0.275 Test Loss: 1.441 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.092959403991699
Epoch: 7, Steps: 9 | Train Loss: 1.027 Vali Loss: 1.467 Vali Acc: 0.290 Test Loss: 1.467 Test Acc: 0.290
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.0555672645568848
Epoch: 8, Steps: 9 | Train Loss: 0.975 Vali Loss: 1.502 Vali Acc: 0.297 Test Loss: 1.502 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.0593955516815186
Epoch: 9, Steps: 9 | Train Loss: 0.890 Vali Loss: 1.517 Vali Acc: 0.297 Test Loss: 1.517 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.184014081954956
Epoch: 10, Steps: 9 | Train Loss: 0.762 Vali Loss: 1.635 Vali Acc: 0.290 Test Loss: 1.635 Test Acc: 0.290
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.0851378440856934
Epoch: 11, Steps: 9 | Train Loss: 0.677 Vali Loss: 1.691 Vali Acc: 0.283 Test Loss: 1.691 Test Acc: 0.283
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.970869302749634
Epoch: 12, Steps: 9 | Train Loss: 0.614 Vali Loss: 1.788 Vali Acc: 0.304 Test Loss: 1.788 Test Acc: 0.304
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.348371744155884
Epoch: 13, Steps: 9 | Train Loss: 0.527 Vali Loss: 1.956 Vali Acc: 0.268 Test Loss: 1.956 Test Acc: 0.268
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.9796841144561768
Epoch: 14, Steps: 9 | Train Loss: 0.424 Vali Loss: 1.967 Vali Acc: 0.319 Test Loss: 1.967 Test Acc: 0.319
Validation loss decreased (-0.304333 --> -0.318821).  Saving model ...
Epoch: 15 cost time: 3.3703956604003906
Epoch: 15, Steps: 9 | Train Loss: 0.386 Vali Loss: 2.021 Vali Acc: 0.283 Test Loss: 2.021 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.3459813594818115
Epoch: 16, Steps: 9 | Train Loss: 0.329 Vali Loss: 2.459 Vali Acc: 0.283 Test Loss: 2.459 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.08744478225708
Epoch: 17, Steps: 9 | Train Loss: 0.269 Vali Loss: 2.424 Vali Acc: 0.319 Test Loss: 2.424 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.270582437515259
Epoch: 18, Steps: 9 | Train Loss: 0.237 Vali Loss: 2.556 Vali Acc: 0.297 Test Loss: 2.556 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.5277037620544434
Epoch: 19, Steps: 9 | Train Loss: 0.180 Vali Loss: 2.736 Vali Acc: 0.283 Test Loss: 2.736 Test Acc: 0.283
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.5658507347106934
Epoch: 20, Steps: 9 | Train Loss: 0.200 Vali Loss: 2.726 Vali Acc: 0.312 Test Loss: 2.726 Test Acc: 0.312
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.7024929523468018
Epoch: 21, Steps: 9 | Train Loss: 0.196 Vali Loss: 2.739 Vali Acc: 0.304 Test Loss: 2.739 Test Acc: 0.304
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.7044787406921387
Epoch: 22, Steps: 9 | Train Loss: 0.125 Vali Loss: 2.711 Vali Acc: 0.326 Test Loss: 2.711 Test Acc: 0.326
Validation loss decreased (-0.318821 --> -0.326060).  Saving model ...
Epoch: 23 cost time: 3.6981465816497803
Epoch: 23, Steps: 9 | Train Loss: 0.105 Vali Loss: 2.785 Vali Acc: 0.304 Test Loss: 2.785 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.2959320545196533
Epoch: 24, Steps: 9 | Train Loss: 0.085 Vali Loss: 2.864 Vali Acc: 0.312 Test Loss: 2.864 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.5329580307006836
Epoch: 25, Steps: 9 | Train Loss: 0.076 Vali Loss: 2.603 Vali Acc: 0.319 Test Loss: 2.603 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.5006601810455322
Epoch: 26, Steps: 9 | Train Loss: 0.072 Vali Loss: 2.735 Vali Acc: 0.319 Test Loss: 2.735 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.1123905181884766
Epoch: 27, Steps: 9 | Train Loss: 0.062 Vali Loss: 2.647 Vali Acc: 0.319 Test Loss: 2.647 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.3360161781311035
Epoch: 28, Steps: 9 | Train Loss: 0.055 Vali Loss: 2.564 Vali Acc: 0.326 Test Loss: 2.564 Test Acc: 0.326
Validation loss decreased (-0.326060 --> -0.326061).  Saving model ...
Epoch: 29 cost time: 3.280560255050659
Epoch: 29, Steps: 9 | Train Loss: 0.046 Vali Loss: 2.514 Vali Acc: 0.341 Test Loss: 2.514 Test Acc: 0.341
Validation loss decreased (-0.326061 --> -0.340555).  Saving model ...
Epoch: 30 cost time: 3.1861419677734375
Epoch: 30, Steps: 9 | Train Loss: 0.046 Vali Loss: 2.632 Vali Acc: 0.326 Test Loss: 2.632 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.1789422035217285
Epoch: 31, Steps: 9 | Train Loss: 0.038 Vali Loss: 2.609 Vali Acc: 0.333 Test Loss: 2.609 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.227534055709839
Epoch: 32, Steps: 9 | Train Loss: 0.036 Vali Loss: 2.570 Vali Acc: 0.341 Test Loss: 2.570 Test Acc: 0.341
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.3633525371551514
Epoch: 33, Steps: 9 | Train Loss: 0.031 Vali Loss: 2.462 Vali Acc: 0.341 Test Loss: 2.462 Test Acc: 0.341
Validation loss decreased (-0.340555 --> -0.340555).  Saving model ...
Epoch: 34 cost time: 3.3929364681243896
Epoch: 34, Steps: 9 | Train Loss: 0.034 Vali Loss: 2.545 Vali Acc: 0.326 Test Loss: 2.545 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.0847702026367188
Epoch: 35, Steps: 9 | Train Loss: 0.033 Vali Loss: 2.491 Vali Acc: 0.362 Test Loss: 2.491 Test Acc: 0.362
Validation loss decreased (-0.340555 --> -0.362294).  Saving model ...
Epoch: 36 cost time: 3.0176146030426025
Epoch: 36, Steps: 9 | Train Loss: 0.022 Vali Loss: 2.567 Vali Acc: 0.355 Test Loss: 2.567 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.170307159423828
Epoch: 37, Steps: 9 | Train Loss: 0.026 Vali Loss: 2.482 Vali Acc: 0.355 Test Loss: 2.482 Test Acc: 0.355
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.3094727993011475
Epoch: 38, Steps: 9 | Train Loss: 0.022 Vali Loss: 2.446 Vali Acc: 0.362 Test Loss: 2.446 Test Acc: 0.362
Validation loss decreased (-0.362294 --> -0.362294).  Saving model ...
Epoch: 39 cost time: 3.2005231380462646
Epoch: 39, Steps: 9 | Train Loss: 0.024 Vali Loss: 2.399 Vali Acc: 0.355 Test Loss: 2.399 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.0560226440429688
Epoch: 40, Steps: 9 | Train Loss: 0.020 Vali Loss: 2.429 Vali Acc: 0.362 Test Loss: 2.429 Test Acc: 0.362
Validation loss decreased (-0.362294 --> -0.362295).  Saving model ...
Epoch: 41 cost time: 2.9361164569854736
Epoch: 41, Steps: 9 | Train Loss: 0.022 Vali Loss: 2.389 Vali Acc: 0.355 Test Loss: 2.389 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.0199384689331055
Epoch: 42, Steps: 9 | Train Loss: 0.016 Vali Loss: 2.311 Vali Acc: 0.362 Test Loss: 2.311 Test Acc: 0.362
Validation loss decreased (-0.362295 --> -0.362296).  Saving model ...
Epoch: 43 cost time: 3.054529905319214
Epoch: 43, Steps: 9 | Train Loss: 0.017 Vali Loss: 2.368 Vali Acc: 0.362 Test Loss: 2.368 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.0646603107452393
Epoch: 44, Steps: 9 | Train Loss: 0.018 Vali Loss: 2.487 Vali Acc: 0.370 Test Loss: 2.487 Test Acc: 0.370
Validation loss decreased (-0.362296 --> -0.369540).  Saving model ...
Epoch: 45 cost time: 3.2417924404144287
Epoch: 45, Steps: 9 | Train Loss: 0.012 Vali Loss: 2.309 Vali Acc: 0.370 Test Loss: 2.309 Test Acc: 0.370
Validation loss decreased (-0.369540 --> -0.369542).  Saving model ...
Epoch: 46 cost time: 3.3856728076934814
Epoch: 46, Steps: 9 | Train Loss: 0.015 Vali Loss: 2.288 Vali Acc: 0.370 Test Loss: 2.288 Test Acc: 0.370
Validation loss decreased (-0.369542 --> -0.369542).  Saving model ...
Epoch: 47 cost time: 3.4800727367401123
Epoch: 47, Steps: 9 | Train Loss: 0.012 Vali Loss: 2.354 Vali Acc: 0.370 Test Loss: 2.354 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.451071262359619
Epoch: 48, Steps: 9 | Train Loss: 0.011 Vali Loss: 2.295 Vali Acc: 0.384 Test Loss: 2.295 Test Acc: 0.384
Validation loss decreased (-0.369542 --> -0.384035).  Saving model ...
Epoch: 49 cost time: 3.5244946479797363
Epoch: 49, Steps: 9 | Train Loss: 0.014 Vali Loss: 2.259 Vali Acc: 0.370 Test Loss: 2.259 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.510535478591919
Epoch: 50, Steps: 9 | Train Loss: 0.010 Vali Loss: 2.299 Vali Acc: 0.362 Test Loss: 2.299 Test Acc: 0.362
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 3.335456609725952
Epoch: 51, Steps: 9 | Train Loss: 0.011 Vali Loss: 2.289 Vali Acc: 0.413 Test Loss: 2.289 Test Acc: 0.413
Validation loss decreased (-0.384035 --> -0.413021).  Saving model ...
Epoch: 52 cost time: 2.9670557975769043
Epoch: 52, Steps: 9 | Train Loss: 0.012 Vali Loss: 2.268 Vali Acc: 0.435 Test Loss: 2.268 Test Acc: 0.435
Validation loss decreased (-0.413021 --> -0.434760).  Saving model ...
Epoch: 53 cost time: 3.089766502380371
Epoch: 53, Steps: 9 | Train Loss: 0.009 Vali Loss: 2.270 Vali Acc: 0.399 Test Loss: 2.270 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 3.124051809310913
Epoch: 54, Steps: 9 | Train Loss: 0.009 Vali Loss: 2.186 Vali Acc: 0.413 Test Loss: 2.186 Test Acc: 0.413
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 3.053956985473633
Epoch: 55, Steps: 9 | Train Loss: 0.008 Vali Loss: 2.190 Vali Acc: 0.442 Test Loss: 2.190 Test Acc: 0.442
Validation loss decreased (-0.434760 --> -0.442007).  Saving model ...
Epoch: 56 cost time: 3.1951639652252197
Epoch: 56, Steps: 9 | Train Loss: 0.006 Vali Loss: 2.222 Vali Acc: 0.449 Test Loss: 2.222 Test Acc: 0.449
Validation loss decreased (-0.442007 --> -0.449253).  Saving model ...
Epoch: 57 cost time: 3.3756344318389893
Epoch: 57, Steps: 9 | Train Loss: 0.007 Vali Loss: 2.276 Vali Acc: 0.435 Test Loss: 2.276 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 3.2551095485687256
Epoch: 58, Steps: 9 | Train Loss: 0.008 Vali Loss: 2.307 Vali Acc: 0.391 Test Loss: 2.307 Test Acc: 0.391
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 3.2742745876312256
Epoch: 59, Steps: 9 | Train Loss: 0.006 Vali Loss: 2.209 Vali Acc: 0.420 Test Loss: 2.209 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 3.219269037246704
Epoch: 60, Steps: 9 | Train Loss: 0.006 Vali Loss: 2.242 Vali Acc: 0.435 Test Loss: 2.242 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 3.5201027393341064
Epoch: 61, Steps: 9 | Train Loss: 0.006 Vali Loss: 2.258 Vali Acc: 0.413 Test Loss: 2.258 Test Acc: 0.413
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 3.365959405899048
Epoch: 62, Steps: 9 | Train Loss: 0.006 Vali Loss: 2.255 Vali Acc: 0.413 Test Loss: 2.255 Test Acc: 0.413
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 3.2414262294769287
Epoch: 63, Steps: 9 | Train Loss: 0.007 Vali Loss: 2.257 Vali Acc: 0.449 Test Loss: 2.257 Test Acc: 0.449
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 3.061671257019043
Epoch: 64, Steps: 9 | Train Loss: 0.006 Vali Loss: 2.336 Vali Acc: 0.442 Test Loss: 2.336 Test Acc: 0.442
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 2.9550395011901855
Epoch: 65, Steps: 9 | Train Loss: 0.006 Vali Loss: 2.416 Vali Acc: 0.391 Test Loss: 2.416 Test Acc: 0.391
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 2.9191529750823975
Epoch: 66, Steps: 9 | Train Loss: 0.004 Vali Loss: 2.359 Vali Acc: 0.420 Test Loss: 2.359 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.4492753623188406
model parameter : 167492
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.231362581253052
Epoch: 1, Steps: 9 | Train Loss: 1.450 Vali Loss: 1.451 Vali Acc: 0.275 Test Loss: 1.451 Test Acc: 0.275
Validation loss decreased (inf --> -0.275348).  Saving model ...
Epoch: 2 cost time: 3.154118061065674
Epoch: 2, Steps: 9 | Train Loss: 1.420 Vali Loss: 1.433 Vali Acc: 0.283 Test Loss: 1.433 Test Acc: 0.283
Validation loss decreased (-0.275348 --> -0.282594).  Saving model ...
Epoch: 3 cost time: 3.1694681644439697
Epoch: 3, Steps: 9 | Train Loss: 1.365 Vali Loss: 1.416 Vali Acc: 0.254 Test Loss: 1.416 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.023139715194702
Epoch: 4, Steps: 9 | Train Loss: 1.286 Vali Loss: 1.411 Vali Acc: 0.261 Test Loss: 1.411 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.1796696186065674
Epoch: 5, Steps: 9 | Train Loss: 1.223 Vali Loss: 1.402 Vali Acc: 0.268 Test Loss: 1.402 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.0367050170898438
Epoch: 6, Steps: 9 | Train Loss: 1.115 Vali Loss: 1.389 Vali Acc: 0.283 Test Loss: 1.389 Test Acc: 0.283
Validation loss decreased (-0.282594 --> -0.282595).  Saving model ...
Epoch: 7 cost time: 3.297652006149292
Epoch: 7, Steps: 9 | Train Loss: 1.016 Vali Loss: 1.382 Vali Acc: 0.283 Test Loss: 1.382 Test Acc: 0.283
Validation loss decreased (-0.282595 --> -0.282595).  Saving model ...
Epoch: 8 cost time: 2.958639621734619
Epoch: 8, Steps: 9 | Train Loss: 0.926 Vali Loss: 1.380 Vali Acc: 0.319 Test Loss: 1.380 Test Acc: 0.319
Validation loss decreased (-0.282595 --> -0.318827).  Saving model ...
Epoch: 9 cost time: 2.8742480278015137
Epoch: 9, Steps: 9 | Train Loss: 0.839 Vali Loss: 1.366 Vali Acc: 0.348 Test Loss: 1.366 Test Acc: 0.348
Validation loss decreased (-0.318827 --> -0.347812).  Saving model ...
Epoch: 10 cost time: 2.8791937828063965
Epoch: 10, Steps: 9 | Train Loss: 0.747 Vali Loss: 1.401 Vali Acc: 0.319 Test Loss: 1.401 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.8813838958740234
Epoch: 11, Steps: 9 | Train Loss: 0.633 Vali Loss: 1.426 Vali Acc: 0.333 Test Loss: 1.426 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.995142936706543
Epoch: 12, Steps: 9 | Train Loss: 0.567 Vali Loss: 1.419 Vali Acc: 0.348 Test Loss: 1.419 Test Acc: 0.348
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.026487112045288
Epoch: 13, Steps: 9 | Train Loss: 0.428 Vali Loss: 1.505 Vali Acc: 0.326 Test Loss: 1.505 Test Acc: 0.326
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.5796456336975098
Epoch: 14, Steps: 9 | Train Loss: 0.386 Vali Loss: 1.555 Vali Acc: 0.333 Test Loss: 1.555 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.3171586990356445
Epoch: 15, Steps: 9 | Train Loss: 0.323 Vali Loss: 1.534 Vali Acc: 0.355 Test Loss: 1.534 Test Acc: 0.355
Validation loss decreased (-0.347812 --> -0.355057).  Saving model ...
Epoch: 16 cost time: 3.3844802379608154
Epoch: 16, Steps: 9 | Train Loss: 0.255 Vali Loss: 1.744 Vali Acc: 0.341 Test Loss: 1.744 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.2549211978912354
Epoch: 17, Steps: 9 | Train Loss: 0.215 Vali Loss: 1.768 Vali Acc: 0.341 Test Loss: 1.768 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.3633220195770264
Epoch: 18, Steps: 9 | Train Loss: 0.197 Vali Loss: 1.810 Vali Acc: 0.362 Test Loss: 1.810 Test Acc: 0.362
Validation loss decreased (-0.355057 --> -0.362301).  Saving model ...
Epoch: 19 cost time: 3.304842233657837
Epoch: 19, Steps: 9 | Train Loss: 0.142 Vali Loss: 1.932 Vali Acc: 0.355 Test Loss: 1.932 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.398683786392212
Epoch: 20, Steps: 9 | Train Loss: 0.153 Vali Loss: 1.919 Vali Acc: 0.362 Test Loss: 1.919 Test Acc: 0.362
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.0921831130981445
Epoch: 21, Steps: 9 | Train Loss: 0.139 Vali Loss: 1.817 Vali Acc: 0.355 Test Loss: 1.817 Test Acc: 0.355
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.272656202316284
Epoch: 22, Steps: 9 | Train Loss: 0.083 Vali Loss: 1.894 Vali Acc: 0.355 Test Loss: 1.894 Test Acc: 0.355
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.172009229660034
Epoch: 23, Steps: 9 | Train Loss: 0.075 Vali Loss: 1.898 Vali Acc: 0.355 Test Loss: 1.898 Test Acc: 0.355
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.3526134490966797
Epoch: 24, Steps: 9 | Train Loss: 0.068 Vali Loss: 1.937 Vali Acc: 0.355 Test Loss: 1.937 Test Acc: 0.355
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.2661097049713135
Epoch: 25, Steps: 9 | Train Loss: 0.054 Vali Loss: 1.771 Vali Acc: 0.362 Test Loss: 1.771 Test Acc: 0.362
Validation loss decreased (-0.362301 --> -0.362301).  Saving model ...
Epoch: 26 cost time: 3.559328079223633
Epoch: 26, Steps: 9 | Train Loss: 0.055 Vali Loss: 1.835 Vali Acc: 0.355 Test Loss: 1.835 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.485590696334839
Epoch: 27, Steps: 9 | Train Loss: 0.042 Vali Loss: 1.815 Vali Acc: 0.362 Test Loss: 1.815 Test Acc: 0.362
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.5860636234283447
Epoch: 28, Steps: 9 | Train Loss: 0.039 Vali Loss: 1.757 Vali Acc: 0.377 Test Loss: 1.757 Test Acc: 0.377
Validation loss decreased (-0.362301 --> -0.376794).  Saving model ...
Epoch: 29 cost time: 3.4820258617401123
Epoch: 29, Steps: 9 | Train Loss: 0.035 Vali Loss: 1.697 Vali Acc: 0.370 Test Loss: 1.697 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.331310272216797
Epoch: 30, Steps: 9 | Train Loss: 0.034 Vali Loss: 1.784 Vali Acc: 0.362 Test Loss: 1.784 Test Acc: 0.362
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.477213144302368
Epoch: 31, Steps: 9 | Train Loss: 0.034 Vali Loss: 1.794 Vali Acc: 0.362 Test Loss: 1.794 Test Acc: 0.362
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.4393715858459473
Epoch: 32, Steps: 9 | Train Loss: 0.031 Vali Loss: 1.788 Vali Acc: 0.362 Test Loss: 1.788 Test Acc: 0.362
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.184019088745117
Epoch: 33, Steps: 9 | Train Loss: 0.023 Vali Loss: 1.646 Vali Acc: 0.370 Test Loss: 1.646 Test Acc: 0.370
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.1860768795013428
Epoch: 34, Steps: 9 | Train Loss: 0.027 Vali Loss: 1.681 Vali Acc: 0.377 Test Loss: 1.681 Test Acc: 0.377
Validation loss decreased (-0.376794 --> -0.376795).  Saving model ...
Epoch: 35 cost time: 3.2690250873565674
Epoch: 35, Steps: 9 | Train Loss: 0.024 Vali Loss: 1.698 Vali Acc: 0.384 Test Loss: 1.698 Test Acc: 0.384
Validation loss decreased (-0.376795 --> -0.384041).  Saving model ...
Epoch: 36 cost time: 3.331291675567627
Epoch: 36, Steps: 9 | Train Loss: 0.019 Vali Loss: 1.674 Vali Acc: 0.391 Test Loss: 1.674 Test Acc: 0.391
Validation loss decreased (-0.384041 --> -0.391288).  Saving model ...
Epoch: 37 cost time: 3.267822504043579
Epoch: 37, Steps: 9 | Train Loss: 0.015 Vali Loss: 1.606 Vali Acc: 0.406 Test Loss: 1.606 Test Acc: 0.406
Validation loss decreased (-0.391288 --> -0.405781).  Saving model ...
Epoch: 38 cost time: 3.1124379634857178
Epoch: 38, Steps: 9 | Train Loss: 0.018 Vali Loss: 1.586 Vali Acc: 0.406 Test Loss: 1.586 Test Acc: 0.406
Validation loss decreased (-0.405781 --> -0.405781).  Saving model ...
Epoch: 39 cost time: 3.570289134979248
Epoch: 39, Steps: 9 | Train Loss: 0.017 Vali Loss: 1.564 Vali Acc: 0.406 Test Loss: 1.564 Test Acc: 0.406
Validation loss decreased (-0.405781 --> -0.405781).  Saving model ...
Epoch: 40 cost time: 3.3480842113494873
Epoch: 40, Steps: 9 | Train Loss: 0.015 Vali Loss: 1.574 Vali Acc: 0.406 Test Loss: 1.574 Test Acc: 0.406
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.2478697299957275
Epoch: 41, Steps: 9 | Train Loss: 0.015 Vali Loss: 1.502 Vali Acc: 0.442 Test Loss: 1.502 Test Acc: 0.442
Validation loss decreased (-0.405781 --> -0.442014).  Saving model ...
Epoch: 42 cost time: 3.32370662689209
Epoch: 42, Steps: 9 | Train Loss: 0.014 Vali Loss: 1.482 Vali Acc: 0.442 Test Loss: 1.482 Test Acc: 0.442
Validation loss decreased (-0.442014 --> -0.442014).  Saving model ...
Epoch: 43 cost time: 3.215855360031128
Epoch: 43, Steps: 9 | Train Loss: 0.012 Vali Loss: 1.502 Vali Acc: 0.435 Test Loss: 1.502 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.196531057357788
Epoch: 44, Steps: 9 | Train Loss: 0.011 Vali Loss: 1.546 Vali Acc: 0.442 Test Loss: 1.546 Test Acc: 0.442
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.1505520343780518
Epoch: 45, Steps: 9 | Train Loss: 0.010 Vali Loss: 1.475 Vali Acc: 0.457 Test Loss: 1.475 Test Acc: 0.457
Validation loss decreased (-0.442014 --> -0.456507).  Saving model ...
Epoch: 46 cost time: 2.9772281646728516
Epoch: 46, Steps: 9 | Train Loss: 0.010 Vali Loss: 1.461 Vali Acc: 0.457 Test Loss: 1.461 Test Acc: 0.457
Validation loss decreased (-0.456507 --> -0.456507).  Saving model ...
Epoch: 47 cost time: 2.9556117057800293
Epoch: 47, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.477 Vali Acc: 0.464 Test Loss: 1.477 Test Acc: 0.464
Validation loss decreased (-0.456507 --> -0.463753).  Saving model ...
Epoch: 48 cost time: 2.7096409797668457
Epoch: 48, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.485 Vali Acc: 0.464 Test Loss: 1.485 Test Acc: 0.464
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.864854335784912
Epoch: 49, Steps: 9 | Train Loss: 0.010 Vali Loss: 1.506 Vali Acc: 0.442 Test Loss: 1.506 Test Acc: 0.442
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 2.883115291595459
Epoch: 50, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.538 Vali Acc: 0.435 Test Loss: 1.538 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 3.2493300437927246
Epoch: 51, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.442 Vali Acc: 0.493 Test Loss: 1.442 Test Acc: 0.493
Validation loss decreased (-0.463753 --> -0.492739).  Saving model ...
Epoch: 52 cost time: 3.287099838256836
Epoch: 52, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.403 Vali Acc: 0.500 Test Loss: 1.403 Test Acc: 0.500
Validation loss decreased (-0.492739 --> -0.499986).  Saving model ...
Epoch: 53 cost time: 3.301356315612793
Epoch: 53, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.440 Vali Acc: 0.486 Test Loss: 1.440 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 3.453181028366089
Epoch: 54, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.461 Vali Acc: 0.486 Test Loss: 1.461 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 3.407120704650879
Epoch: 55, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.430 Vali Acc: 0.486 Test Loss: 1.430 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 3.581507921218872
Epoch: 56, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.431 Vali Acc: 0.493 Test Loss: 1.431 Test Acc: 0.493
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 3.0202693939208984
Epoch: 57, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.399 Vali Acc: 0.507 Test Loss: 1.399 Test Acc: 0.507
Validation loss decreased (-0.499986 --> -0.507232).  Saving model ...
Epoch: 58 cost time: 3.2808725833892822
Epoch: 58, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.389 Vali Acc: 0.514 Test Loss: 1.389 Test Acc: 0.514
Validation loss decreased (-0.507232 --> -0.514479).  Saving model ...
Epoch: 59 cost time: 3.3577845096588135
Epoch: 59, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.389 Vali Acc: 0.507 Test Loss: 1.389 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 3.268484354019165
Epoch: 60, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.396 Vali Acc: 0.514 Test Loss: 1.396 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 3.2129924297332764
Epoch: 61, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.392 Vali Acc: 0.536 Test Loss: 1.392 Test Acc: 0.536
Validation loss decreased (-0.514479 --> -0.536218).  Saving model ...
Epoch: 62 cost time: 3.287081480026245
Epoch: 62, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.384 Vali Acc: 0.536 Test Loss: 1.384 Test Acc: 0.536
Validation loss decreased (-0.536218 --> -0.536218).  Saving model ...
Epoch: 63 cost time: 3.56369686126709
Epoch: 63, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.363 Vali Acc: 0.551 Test Loss: 1.363 Test Acc: 0.551
Validation loss decreased (-0.536218 --> -0.550711).  Saving model ...
Epoch: 64 cost time: 3.5101919174194336
Epoch: 64, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.378 Vali Acc: 0.529 Test Loss: 1.378 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 3.3861544132232666
Epoch: 65, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.418 Vali Acc: 0.514 Test Loss: 1.418 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 3.609776020050049
Epoch: 66, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.395 Vali Acc: 0.514 Test Loss: 1.395 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 3.5493531227111816
Epoch: 67, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.369 Vali Acc: 0.529 Test Loss: 1.369 Test Acc: 0.529
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 3.7299160957336426
Epoch: 68, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.369 Vali Acc: 0.551 Test Loss: 1.369 Test Acc: 0.551
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 3.173552989959717
Epoch: 69, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.369 Vali Acc: 0.529 Test Loss: 1.369 Test Acc: 0.529
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 3.3654844760894775
Epoch: 70, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.397 Vali Acc: 0.551 Test Loss: 1.397 Test Acc: 0.551
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 3.1580810546875
Epoch: 71, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.427 Vali Acc: 0.514 Test Loss: 1.427 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 3.3494601249694824
Epoch: 72, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.398 Vali Acc: 0.522 Test Loss: 1.398 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 3.3992273807525635
Epoch: 73, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.361 Vali Acc: 0.558 Test Loss: 1.361 Test Acc: 0.558
Validation loss decreased (-0.550711 --> -0.557957).  Saving model ...
Epoch: 74 cost time: 3.6041946411132812
Epoch: 74, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.345 Vali Acc: 0.572 Test Loss: 1.345 Test Acc: 0.572
Validation loss decreased (-0.557957 --> -0.572450).  Saving model ...
Epoch: 75 cost time: 3.5870444774627686
Epoch: 75, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.335 Vali Acc: 0.565 Test Loss: 1.335 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 3.5479252338409424
Epoch: 76, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.344 Vali Acc: 0.551 Test Loss: 1.344 Test Acc: 0.551
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 3.3939692974090576
Epoch: 77, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.351 Vali Acc: 0.543 Test Loss: 1.351 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 3.3267409801483154
Epoch: 78, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.356 Vali Acc: 0.565 Test Loss: 1.356 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 3.391294002532959
Epoch: 79, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.351 Vali Acc: 0.572 Test Loss: 1.351 Test Acc: 0.572
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 3.4601314067840576
Epoch: 80, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.384 Vali Acc: 0.536 Test Loss: 1.384 Test Acc: 0.536
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 3.0175998210906982
Epoch: 81, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.344 Vali Acc: 0.565 Test Loss: 1.344 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 82 cost time: 3.086904287338257
Epoch: 82, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.334 Vali Acc: 0.565 Test Loss: 1.334 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 83 cost time: 3.1418163776397705
Epoch: 83, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.331 Vali Acc: 0.572 Test Loss: 1.331 Test Acc: 0.572
Validation loss decreased (-0.572450 --> -0.572450).  Saving model ...
Epoch: 84 cost time: 3.4357495307922363
Epoch: 84, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.345 Vali Acc: 0.565 Test Loss: 1.345 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 3.218549966812134
Epoch: 85, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.308 Vali Acc: 0.587 Test Loss: 1.308 Test Acc: 0.587
Validation loss decreased (-0.572450 --> -0.586943).  Saving model ...
Epoch: 86 cost time: 3.0025954246520996
Epoch: 86, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.301 Vali Acc: 0.587 Test Loss: 1.301 Test Acc: 0.587
Validation loss decreased (-0.586943 --> -0.586944).  Saving model ...
Epoch: 87 cost time: 3.4819273948669434
Epoch: 87, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.309 Vali Acc: 0.580 Test Loss: 1.309 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 3.5586416721343994
Epoch: 88, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.310 Vali Acc: 0.594 Test Loss: 1.310 Test Acc: 0.594
Validation loss decreased (-0.586944 --> -0.594190).  Saving model ...
Epoch: 89 cost time: 3.3160009384155273
Epoch: 89, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.318 Vali Acc: 0.572 Test Loss: 1.318 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 3.2716104984283447
Epoch: 90, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.315 Vali Acc: 0.601 Test Loss: 1.315 Test Acc: 0.601
Validation loss decreased (-0.594190 --> -0.601436).  Saving model ...
Epoch: 91 cost time: 3.7013094425201416
Epoch: 91, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.321 Vali Acc: 0.565 Test Loss: 1.321 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 3.122551918029785
Epoch: 92, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.330 Vali Acc: 0.565 Test Loss: 1.330 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 3.36936092376709
Epoch: 93, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.322 Vali Acc: 0.565 Test Loss: 1.322 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 3.125222682952881
Epoch: 94, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.297 Vali Acc: 0.594 Test Loss: 1.297 Test Acc: 0.594
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 3.298140525817871
Epoch: 95, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.310 Vali Acc: 0.594 Test Loss: 1.310 Test Acc: 0.594
EarlyStopping counter: 5 out of 10
Epoch: 96 cost time: 3.188575506210327
Epoch: 96, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.320 Vali Acc: 0.594 Test Loss: 1.320 Test Acc: 0.594
EarlyStopping counter: 6 out of 10
Epoch: 97 cost time: 3.4594850540161133
Epoch: 97, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.317 Vali Acc: 0.587 Test Loss: 1.317 Test Acc: 0.587
EarlyStopping counter: 7 out of 10
Epoch: 98 cost time: 3.50961971282959
Epoch: 98, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.324 Vali Acc: 0.594 Test Loss: 1.324 Test Acc: 0.594
EarlyStopping counter: 8 out of 10
Epoch: 99 cost time: 3.4814772605895996
Epoch: 99, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.328 Vali Acc: 0.587 Test Loss: 1.328 Test Acc: 0.587
EarlyStopping counter: 9 out of 10
Epoch: 100 cost time: 3.420388698577881
Epoch: 100, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.334 Vali Acc: 0.572 Test Loss: 1.334 Test Acc: 0.572
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.6014492753623188
model parameter : 167492
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         103                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df256_ma103_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.834275245666504
Epoch: 1, Steps: 9 | Train Loss: 1.413 Vali Loss: 1.379 Vali Acc: 0.326 Test Loss: 1.379 Test Acc: 0.326
Validation loss decreased (inf --> -0.326073).  Saving model ...
Epoch: 2 cost time: 3.170677900314331
Epoch: 2, Steps: 9 | Train Loss: 1.320 Vali Loss: 1.312 Vali Acc: 0.420 Test Loss: 1.312 Test Acc: 0.420
Validation loss decreased (-0.326073 --> -0.420277).  Saving model ...
Epoch: 3 cost time: 3.3101484775543213
Epoch: 3, Steps: 9 | Train Loss: 1.227 Vali Loss: 1.226 Vali Acc: 0.486 Test Loss: 1.226 Test Acc: 0.486
Validation loss decreased (-0.420277 --> -0.485495).  Saving model ...
Epoch: 4 cost time: 2.992140531539917
Epoch: 4, Steps: 9 | Train Loss: 1.075 Vali Loss: 1.147 Vali Acc: 0.529 Test Loss: 1.147 Test Acc: 0.529
Validation loss decreased (-0.485495 --> -0.528974).  Saving model ...
Epoch: 5 cost time: 3.1111338138580322
Epoch: 5, Steps: 9 | Train Loss: 0.936 Vali Loss: 1.060 Vali Acc: 0.609 Test Loss: 1.060 Test Acc: 0.609
Validation loss decreased (-0.528974 --> -0.608685).  Saving model ...
Epoch: 6 cost time: 3.1072614192962646
Epoch: 6, Steps: 9 | Train Loss: 0.805 Vali Loss: 0.999 Vali Acc: 0.623 Test Loss: 0.999 Test Acc: 0.623
Validation loss decreased (-0.608685 --> -0.623178).  Saving model ...
Epoch: 7 cost time: 3.255443811416626
Epoch: 7, Steps: 9 | Train Loss: 0.640 Vali Loss: 0.903 Vali Acc: 0.659 Test Loss: 0.903 Test Acc: 0.659
Validation loss decreased (-0.623178 --> -0.659411).  Saving model ...
Epoch: 8 cost time: 3.1843173503875732
Epoch: 8, Steps: 9 | Train Loss: 0.530 Vali Loss: 0.855 Vali Acc: 0.696 Test Loss: 0.855 Test Acc: 0.696
Validation loss decreased (-0.659411 --> -0.695644).  Saving model ...
Epoch: 9 cost time: 3.460012197494507
Epoch: 9, Steps: 9 | Train Loss: 0.432 Vali Loss: 0.783 Vali Acc: 0.703 Test Loss: 0.783 Test Acc: 0.703
Validation loss decreased (-0.695644 --> -0.702891).  Saving model ...
Epoch: 10 cost time: 3.7871241569519043
Epoch: 10, Steps: 9 | Train Loss: 0.335 Vali Loss: 0.724 Vali Acc: 0.768 Test Loss: 0.724 Test Acc: 0.768
Validation loss decreased (-0.702891 --> -0.768109).  Saving model ...
Epoch: 11 cost time: 3.4659056663513184
Epoch: 11, Steps: 9 | Train Loss: 0.235 Vali Loss: 0.661 Vali Acc: 0.775 Test Loss: 0.661 Test Acc: 0.775
Validation loss decreased (-0.768109 --> -0.775356).  Saving model ...
Epoch: 12 cost time: 3.551619052886963
Epoch: 12, Steps: 9 | Train Loss: 0.170 Vali Loss: 0.633 Vali Acc: 0.761 Test Loss: 0.633 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.686171531677246
Epoch: 13, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.603 Vali Acc: 0.775 Test Loss: 0.603 Test Acc: 0.775
Validation loss decreased (-0.775356 --> -0.775356).  Saving model ...
Epoch: 14 cost time: 3.1024343967437744
Epoch: 14, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.564 Vali Acc: 0.804 Test Loss: 0.564 Test Acc: 0.804
Validation loss decreased (-0.775356 --> -0.804342).  Saving model ...
Epoch: 15 cost time: 3.543569803237915
Epoch: 15, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.542 Vali Acc: 0.804 Test Loss: 0.542 Test Acc: 0.804
Validation loss decreased (-0.804342 --> -0.804342).  Saving model ...
Epoch: 16 cost time: 3.1035749912261963
Epoch: 16, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.535 Vali Acc: 0.804 Test Loss: 0.535 Test Acc: 0.804
Validation loss decreased (-0.804342 --> -0.804342).  Saving model ...
Epoch: 17 cost time: 3.106916904449463
Epoch: 17, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.520 Vali Acc: 0.804 Test Loss: 0.520 Test Acc: 0.804
Validation loss decreased (-0.804342 --> -0.804343).  Saving model ...
Epoch: 18 cost time: 3.16344952583313
Epoch: 18, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.515 Vali Acc: 0.819 Test Loss: 0.515 Test Acc: 0.819
Validation loss decreased (-0.804343 --> -0.818835).  Saving model ...
Epoch: 19 cost time: 3.3323302268981934
Epoch: 19, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.486 Vali Acc: 0.833 Test Loss: 0.486 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833328).  Saving model ...
Epoch: 20 cost time: 3.3783159255981445
Epoch: 20, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.490 Vali Acc: 0.826 Test Loss: 0.490 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.346491813659668
Epoch: 21, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.492 Vali Acc: 0.826 Test Loss: 0.492 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.306110143661499
Epoch: 22, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.494 Vali Acc: 0.833 Test Loss: 0.494 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.3423311710357666
Epoch: 23, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.483 Vali Acc: 0.833 Test Loss: 0.483 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833329).  Saving model ...
Epoch: 24 cost time: 3.193840503692627
Epoch: 24, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.472 Vali Acc: 0.841 Test Loss: 0.472 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 25 cost time: 3.266815662384033
Epoch: 25, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.469 Vali Acc: 0.841 Test Loss: 0.469 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 26 cost time: 3.366588830947876
Epoch: 26, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.467 Vali Acc: 0.841 Test Loss: 0.467 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 27 cost time: 3.410506248474121
Epoch: 27, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.478 Vali Acc: 0.841 Test Loss: 0.478 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.0830047130584717
Epoch: 28, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.471 Vali Acc: 0.841 Test Loss: 0.471 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.3014426231384277
Epoch: 29, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.466 Vali Acc: 0.855 Test Loss: 0.466 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855068).  Saving model ...
Epoch: 30 cost time: 3.1900320053100586
Epoch: 30, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.464 Vali Acc: 0.848 Test Loss: 0.464 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.1980702877044678
Epoch: 31, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.478 Vali Acc: 0.848 Test Loss: 0.478 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.50777006149292
Epoch: 32, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.475 Vali Acc: 0.848 Test Loss: 0.475 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.4101037979125977
Epoch: 33, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.468 Vali Acc: 0.848 Test Loss: 0.468 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.424440622329712
Epoch: 34, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.463 Vali Acc: 0.841 Test Loss: 0.463 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.359290361404419
Epoch: 35, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.465 Vali Acc: 0.841 Test Loss: 0.465 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.3934133052825928
Epoch: 36, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.472 Vali Acc: 0.848 Test Loss: 0.472 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.4767701625823975
Epoch: 37, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.470 Vali Acc: 0.848 Test Loss: 0.470 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 3.1421897411346436
Epoch: 38, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.462 Vali Acc: 0.855 Test Loss: 0.462 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 39 cost time: 3.2756967544555664
Epoch: 39, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.458 Vali Acc: 0.848 Test Loss: 0.458 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.9719560146331787
Epoch: 40, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.460 Vali Acc: 0.855 Test Loss: 0.460 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 41 cost time: 3.3195972442626953
Epoch: 41, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.462 Vali Acc: 0.848 Test Loss: 0.462 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.087526798248291
Epoch: 42, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.458 Vali Acc: 0.848 Test Loss: 0.458 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.1472487449645996
Epoch: 43, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.463 Vali Acc: 0.848 Test Loss: 0.463 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.269263744354248
Epoch: 44, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.463 Vali Acc: 0.848 Test Loss: 0.463 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 3.285548686981201
Epoch: 45, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.466 Vali Acc: 0.848 Test Loss: 0.466 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 3.2231156826019287
Epoch: 46, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.461 Vali Acc: 0.848 Test Loss: 0.461 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 3.2826921939849854
Epoch: 47, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.462 Vali Acc: 0.848 Test Loss: 0.462 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 3.4003138542175293
Epoch: 48, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.462 Vali Acc: 0.848 Test Loss: 0.462 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 3.078629970550537
Epoch: 49, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.459 Vali Acc: 0.848 Test Loss: 0.459 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 3.093738317489624
Epoch: 50, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.463 Vali Acc: 0.855 Test Loss: 0.463 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df256_ma103_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 118340
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         83                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df256_ma83_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.524163007736206
Epoch: 1, Steps: 9 | Train Loss: 1.425 Vali Loss: 1.375 Vali Acc: 0.384 Test Loss: 1.375 Test Acc: 0.384
Validation loss decreased (inf --> -0.384044).  Saving model ...
Epoch: 2 cost time: 3.4077115058898926
Epoch: 2, Steps: 9 | Train Loss: 1.329 Vali Loss: 1.305 Vali Acc: 0.486 Test Loss: 1.305 Test Acc: 0.486
Validation loss decreased (-0.384044 --> -0.485494).  Saving model ...
Epoch: 3 cost time: 3.4365646839141846
Epoch: 3, Steps: 9 | Train Loss: 1.228 Vali Loss: 1.220 Vali Acc: 0.529 Test Loss: 1.220 Test Acc: 0.529
Validation loss decreased (-0.485494 --> -0.528973).  Saving model ...
Epoch: 4 cost time: 3.36435866355896
Epoch: 4, Steps: 9 | Train Loss: 1.082 Vali Loss: 1.142 Vali Acc: 0.536 Test Loss: 1.142 Test Acc: 0.536
Validation loss decreased (-0.528973 --> -0.536220).  Saving model ...
Epoch: 5 cost time: 3.3826122283935547
Epoch: 5, Steps: 9 | Train Loss: 0.949 Vali Loss: 1.055 Vali Acc: 0.594 Test Loss: 1.055 Test Acc: 0.594
Validation loss decreased (-0.536220 --> -0.594192).  Saving model ...
Epoch: 6 cost time: 3.2716219425201416
Epoch: 6, Steps: 9 | Train Loss: 0.811 Vali Loss: 0.995 Vali Acc: 0.638 Test Loss: 0.995 Test Acc: 0.638
Validation loss decreased (-0.594192 --> -0.637671).  Saving model ...
Epoch: 7 cost time: 3.2278831005096436
Epoch: 7, Steps: 9 | Train Loss: 0.643 Vali Loss: 0.894 Vali Acc: 0.710 Test Loss: 0.894 Test Acc: 0.710
Validation loss decreased (-0.637671 --> -0.710136).  Saving model ...
Epoch: 8 cost time: 3.0032639503479004
Epoch: 8, Steps: 9 | Train Loss: 0.531 Vali Loss: 0.850 Vali Acc: 0.681 Test Loss: 0.850 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.9994993209838867
Epoch: 9, Steps: 9 | Train Loss: 0.428 Vali Loss: 0.777 Vali Acc: 0.725 Test Loss: 0.777 Test Acc: 0.725
Validation loss decreased (-0.710136 --> -0.724630).  Saving model ...
Epoch: 10 cost time: 3.0364105701446533
Epoch: 10, Steps: 9 | Train Loss: 0.333 Vali Loss: 0.716 Vali Acc: 0.768 Test Loss: 0.716 Test Acc: 0.768
Validation loss decreased (-0.724630 --> -0.768109).  Saving model ...
Epoch: 11 cost time: 3.226594924926758
Epoch: 11, Steps: 9 | Train Loss: 0.232 Vali Loss: 0.650 Vali Acc: 0.790 Test Loss: 0.650 Test Acc: 0.790
Validation loss decreased (-0.768109 --> -0.789849).  Saving model ...
Epoch: 12 cost time: 3.2867391109466553
Epoch: 12, Steps: 9 | Train Loss: 0.168 Vali Loss: 0.625 Vali Acc: 0.797 Test Loss: 0.625 Test Acc: 0.797
Validation loss decreased (-0.789849 --> -0.797095).  Saving model ...
Epoch: 13 cost time: 3.220168113708496
Epoch: 13, Steps: 9 | Train Loss: 0.135 Vali Loss: 0.596 Vali Acc: 0.790 Test Loss: 0.596 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.28352952003479
Epoch: 14, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.550 Vali Acc: 0.826 Test Loss: 0.550 Test Acc: 0.826
Validation loss decreased (-0.797095 --> -0.826081).  Saving model ...
Epoch: 15 cost time: 3.4304091930389404
Epoch: 15, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.528 Vali Acc: 0.848 Test Loss: 0.528 Test Acc: 0.848
Validation loss decreased (-0.826081 --> -0.847821).  Saving model ...
Epoch: 16 cost time: 3.334552764892578
Epoch: 16, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.531 Vali Acc: 0.841 Test Loss: 0.531 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.611699342727661
Epoch: 17, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.523 Vali Acc: 0.848 Test Loss: 0.523 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847821).  Saving model ...
Epoch: 18 cost time: 3.4379916191101074
Epoch: 18, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.505 Vali Acc: 0.841 Test Loss: 0.505 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.219562530517578
Epoch: 19, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.473 Vali Acc: 0.870 Test Loss: 0.473 Test Acc: 0.870
Validation loss decreased (-0.847821 --> -0.869560).  Saving model ...
Epoch: 20 cost time: 3.2771544456481934
Epoch: 20, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.489 Vali Acc: 0.855 Test Loss: 0.489 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.309899091720581
Epoch: 21, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.488 Vali Acc: 0.862 Test Loss: 0.488 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.059048652648926
Epoch: 22, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.481 Vali Acc: 0.870 Test Loss: 0.481 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.2428503036499023
Epoch: 23, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.467 Vali Acc: 0.877 Test Loss: 0.467 Test Acc: 0.877
Validation loss decreased (-0.869560 --> -0.876807).  Saving model ...
Epoch: 24 cost time: 3.4618990421295166
Epoch: 24, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.460 Vali Acc: 0.870 Test Loss: 0.460 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.4064829349517822
Epoch: 25, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.461 Vali Acc: 0.870 Test Loss: 0.461 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.337130308151245
Epoch: 26, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.459 Vali Acc: 0.877 Test Loss: 0.459 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 27 cost time: 3.219219923019409
Epoch: 27, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.472 Vali Acc: 0.870 Test Loss: 0.472 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.443899154663086
Epoch: 28, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.463 Vali Acc: 0.877 Test Loss: 0.463 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.192584991455078
Epoch: 29, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.454 Vali Acc: 0.877 Test Loss: 0.454 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 30 cost time: 3.3270390033721924
Epoch: 30, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.454 Vali Acc: 0.877 Test Loss: 0.454 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 31 cost time: 3.413951873779297
Epoch: 31, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.473 Vali Acc: 0.877 Test Loss: 0.473 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.208033800125122
Epoch: 32, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.469 Vali Acc: 0.870 Test Loss: 0.469 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.443272352218628
Epoch: 33, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.459 Vali Acc: 0.877 Test Loss: 0.459 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.076991319656372
Epoch: 34, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.452 Vali Acc: 0.877 Test Loss: 0.452 Test Acc: 0.877
Validation loss decreased (-0.876807 --> -0.876807).  Saving model ...
Epoch: 35 cost time: 3.1638600826263428
Epoch: 35, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.457 Vali Acc: 0.891 Test Loss: 0.457 Test Acc: 0.891
Validation loss decreased (-0.876807 --> -0.891300).  Saving model ...
Epoch: 36 cost time: 3.1869406700134277
Epoch: 36, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.464 Vali Acc: 0.884 Test Loss: 0.464 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.475569248199463
Epoch: 37, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.465 Vali Acc: 0.877 Test Loss: 0.465 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.4892120361328125
Epoch: 38, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.453 Vali Acc: 0.877 Test Loss: 0.453 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.1669416427612305
Epoch: 39, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.452 Vali Acc: 0.884 Test Loss: 0.452 Test Acc: 0.884
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.4200830459594727
Epoch: 40, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.456 Vali Acc: 0.877 Test Loss: 0.456 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 3.4230687618255615
Epoch: 41, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.456 Vali Acc: 0.884 Test Loss: 0.456 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 3.4198391437530518
Epoch: 42, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.452 Vali Acc: 0.891 Test Loss: 0.452 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 43 cost time: 3.3296914100646973
Epoch: 43, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.459 Vali Acc: 0.891 Test Loss: 0.459 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.516993761062622
Epoch: 44, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.460 Vali Acc: 0.891 Test Loss: 0.460 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.215409517288208
Epoch: 45, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.463 Vali Acc: 0.891 Test Loss: 0.463 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.1912219524383545
Epoch: 46, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.455 Vali Acc: 0.891 Test Loss: 0.455 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 3.435230255126953
Epoch: 47, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.455 Vali Acc: 0.891 Test Loss: 0.455 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 3.0517826080322266
Epoch: 48, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.455 Vali Acc: 0.891 Test Loss: 0.455 Test Acc: 0.891
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 3.369746446609497
Epoch: 49, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.454 Vali Acc: 0.891 Test Loss: 0.454 Test Acc: 0.891
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 3.285198926925659
Epoch: 50, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.460 Vali Acc: 0.891 Test Loss: 0.460 Test Acc: 0.891
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 3.5851328372955322
Epoch: 51, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.463 Vali Acc: 0.884 Test Loss: 0.463 Test Acc: 0.884
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 3.590762138366699
Epoch: 52, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.465 Vali Acc: 0.884 Test Loss: 0.465 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df256_ma83_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 118340
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         62                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df256_ma62_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.5781519412994385
Epoch: 1, Steps: 9 | Train Loss: 1.413 Vali Loss: 1.386 Vali Acc: 0.312 Test Loss: 1.386 Test Acc: 0.312
Validation loss decreased (inf --> -0.311580).  Saving model ...
Epoch: 2 cost time: 3.085125684738159
Epoch: 2, Steps: 9 | Train Loss: 1.321 Vali Loss: 1.319 Vali Acc: 0.428 Test Loss: 1.319 Test Acc: 0.428
Validation loss decreased (-0.311580 --> -0.427523).  Saving model ...
Epoch: 3 cost time: 2.890843391418457
Epoch: 3, Steps: 9 | Train Loss: 1.221 Vali Loss: 1.234 Vali Acc: 0.514 Test Loss: 1.234 Test Acc: 0.514
Validation loss decreased (-0.427523 --> -0.514480).  Saving model ...
Epoch: 4 cost time: 3.0398130416870117
Epoch: 4, Steps: 9 | Train Loss: 1.067 Vali Loss: 1.152 Vali Acc: 0.536 Test Loss: 1.152 Test Acc: 0.536
Validation loss decreased (-0.514480 --> -0.536220).  Saving model ...
Epoch: 5 cost time: 3.1339948177337646
Epoch: 5, Steps: 9 | Train Loss: 0.932 Vali Loss: 1.061 Vali Acc: 0.623 Test Loss: 1.061 Test Acc: 0.623
Validation loss decreased (-0.536220 --> -0.623178).  Saving model ...
Epoch: 6 cost time: 3.212240219116211
Epoch: 6, Steps: 9 | Train Loss: 0.807 Vali Loss: 1.000 Vali Acc: 0.623 Test Loss: 1.000 Test Acc: 0.623
Validation loss decreased (-0.623178 --> -0.623178).  Saving model ...
Epoch: 7 cost time: 3.033869981765747
Epoch: 7, Steps: 9 | Train Loss: 0.628 Vali Loss: 0.894 Vali Acc: 0.717 Test Loss: 0.894 Test Acc: 0.717
Validation loss decreased (-0.623178 --> -0.717382).  Saving model ...
Epoch: 8 cost time: 3.0460283756256104
Epoch: 8, Steps: 9 | Train Loss: 0.516 Vali Loss: 0.841 Vali Acc: 0.717 Test Loss: 0.841 Test Acc: 0.717
Validation loss decreased (-0.717382 --> -0.717383).  Saving model ...
Epoch: 9 cost time: 3.5800063610076904
Epoch: 9, Steps: 9 | Train Loss: 0.406 Vali Loss: 0.768 Vali Acc: 0.790 Test Loss: 0.768 Test Acc: 0.790
Validation loss decreased (-0.717383 --> -0.789847).  Saving model ...
Epoch: 10 cost time: 3.3256194591522217
Epoch: 10, Steps: 9 | Train Loss: 0.310 Vali Loss: 0.703 Vali Acc: 0.804 Test Loss: 0.703 Test Acc: 0.804
Validation loss decreased (-0.789847 --> -0.804341).  Saving model ...
Epoch: 11 cost time: 3.572749614715576
Epoch: 11, Steps: 9 | Train Loss: 0.219 Vali Loss: 0.636 Vali Acc: 0.826 Test Loss: 0.636 Test Acc: 0.826
Validation loss decreased (-0.804341 --> -0.826081).  Saving model ...
Epoch: 12 cost time: 3.592162609100342
Epoch: 12, Steps: 9 | Train Loss: 0.153 Vali Loss: 0.596 Vali Acc: 0.833 Test Loss: 0.596 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833327).  Saving model ...
Epoch: 13 cost time: 3.703587293624878
Epoch: 13, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.570 Vali Acc: 0.841 Test Loss: 0.570 Test Acc: 0.841
Validation loss decreased (-0.833327 --> -0.840574).  Saving model ...
Epoch: 14 cost time: 3.33785080909729
Epoch: 14, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.531 Vali Acc: 0.862 Test Loss: 0.531 Test Acc: 0.862
Validation loss decreased (-0.840574 --> -0.862314).  Saving model ...
Epoch: 15 cost time: 3.3659050464630127
Epoch: 15, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.507 Vali Acc: 0.862 Test Loss: 0.507 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 16 cost time: 3.1791927814483643
Epoch: 16, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.513 Vali Acc: 0.862 Test Loss: 0.513 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.221646547317505
Epoch: 17, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.497 Vali Acc: 0.862 Test Loss: 0.497 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 18 cost time: 3.075263738632202
Epoch: 18, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.482 Vali Acc: 0.870 Test Loss: 0.482 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869560).  Saving model ...
Epoch: 19 cost time: 3.015369415283203
Epoch: 19, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.464 Vali Acc: 0.870 Test Loss: 0.464 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869561).  Saving model ...
Epoch: 20 cost time: 3.097013235092163
Epoch: 20, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.470 Vali Acc: 0.877 Test Loss: 0.470 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 21 cost time: 3.2064054012298584
Epoch: 21, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.462 Vali Acc: 0.891 Test Loss: 0.462 Test Acc: 0.891
Validation loss decreased (-0.876807 --> -0.891300).  Saving model ...
Epoch: 22 cost time: 3.34547758102417
Epoch: 22, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.463 Vali Acc: 0.884 Test Loss: 0.463 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.5936317443847656
Epoch: 23, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.451 Vali Acc: 0.884 Test Loss: 0.451 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.29799222946167
Epoch: 24, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.443 Vali Acc: 0.884 Test Loss: 0.443 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.1045048236846924
Epoch: 25, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.444 Vali Acc: 0.891 Test Loss: 0.444 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 26 cost time: 3.200129508972168
Epoch: 26, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.444 Vali Acc: 0.891 Test Loss: 0.444 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.0370075702667236
Epoch: 27, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.450 Vali Acc: 0.891 Test Loss: 0.450 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.9467570781707764
Epoch: 28, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.439 Vali Acc: 0.891 Test Loss: 0.439 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 29 cost time: 2.981914758682251
Epoch: 29, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.442 Vali Acc: 0.891 Test Loss: 0.442 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.85113787651062
Epoch: 30, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.442 Vali Acc: 0.891 Test Loss: 0.442 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.062553882598877
Epoch: 31, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.444 Vali Acc: 0.891 Test Loss: 0.444 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.1586837768554688
Epoch: 32, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.442 Vali Acc: 0.891 Test Loss: 0.442 Test Acc: 0.891
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.342388153076172
Epoch: 33, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.441 Vali Acc: 0.891 Test Loss: 0.441 Test Acc: 0.891
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.302746057510376
Epoch: 34, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.437 Vali Acc: 0.884 Test Loss: 0.437 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.317878007888794
Epoch: 35, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.439 Vali Acc: 0.891 Test Loss: 0.439 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 36 cost time: 3.6162450313568115
Epoch: 36, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.439 Vali Acc: 0.891 Test Loss: 0.439 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 37 cost time: 3.5061490535736084
Epoch: 37, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.440 Vali Acc: 0.891 Test Loss: 0.440 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.5037786960601807
Epoch: 38, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.434 Vali Acc: 0.891 Test Loss: 0.434 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 39 cost time: 3.3117942810058594
Epoch: 39, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.434 Vali Acc: 0.891 Test Loss: 0.434 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 40 cost time: 3.47932767868042
Epoch: 40, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.440 Vali Acc: 0.891 Test Loss: 0.440 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.9403083324432373
Epoch: 41, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.438 Vali Acc: 0.891 Test Loss: 0.438 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.1608924865722656
Epoch: 42, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.432 Vali Acc: 0.906 Test Loss: 0.432 Test Acc: 0.906
Validation loss decreased (-0.891300 --> -0.905793).  Saving model ...
Epoch: 43 cost time: 3.229874849319458
Epoch: 43, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.440 Vali Acc: 0.891 Test Loss: 0.440 Test Acc: 0.891
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.193262815475464
Epoch: 44, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.444 Vali Acc: 0.891 Test Loss: 0.444 Test Acc: 0.891
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.214244842529297
Epoch: 45, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.444 Vali Acc: 0.891 Test Loss: 0.444 Test Acc: 0.891
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.2367770671844482
Epoch: 46, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.434 Vali Acc: 0.906 Test Loss: 0.434 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 3.050527572631836
Epoch: 47, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.432 Vali Acc: 0.906 Test Loss: 0.432 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 3.357250213623047
Epoch: 48, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.433 Vali Acc: 0.906 Test Loss: 0.433 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 3.2428765296936035
Epoch: 49, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.430 Vali Acc: 0.906 Test Loss: 0.430 Test Acc: 0.906
Validation loss decreased (-0.905793 --> -0.905793).  Saving model ...
Epoch: 50 cost time: 3.3010311126708984
Epoch: 50, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.435 Vali Acc: 0.899 Test Loss: 0.435 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 3.0279462337493896
Epoch: 51, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.438 Vali Acc: 0.899 Test Loss: 0.438 Test Acc: 0.899
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 3.518833875656128
Epoch: 52, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.440 Vali Acc: 0.899 Test Loss: 0.440 Test Acc: 0.899
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 3.4601447582244873
Epoch: 53, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.441 Vali Acc: 0.899 Test Loss: 0.441 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 3.529188871383667
Epoch: 54, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.438 Vali Acc: 0.899 Test Loss: 0.438 Test Acc: 0.899
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 3.1585540771484375
Epoch: 55, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.438 Vali Acc: 0.899 Test Loss: 0.438 Test Acc: 0.899
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 3.1812686920166016
Epoch: 56, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.438 Vali Acc: 0.899 Test Loss: 0.438 Test Acc: 0.899
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 2.9909071922302246
Epoch: 57, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.438 Vali Acc: 0.899 Test Loss: 0.438 Test Acc: 0.899
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 2.972587823867798
Epoch: 58, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.442 Vali Acc: 0.899 Test Loss: 0.442 Test Acc: 0.899
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 3.0782408714294434
Epoch: 59, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.443 Vali Acc: 0.899 Test Loss: 0.443 Test Acc: 0.899
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df256_ma62_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.9057971014492754
model parameter : 118340
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         42                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df256_ma42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.407155513763428
Epoch: 1, Steps: 9 | Train Loss: 1.400 Vali Loss: 1.375 Vali Acc: 0.362 Test Loss: 1.375 Test Acc: 0.362
Validation loss decreased (inf --> -0.362305).  Saving model ...
Epoch: 2 cost time: 3.084195852279663
Epoch: 2, Steps: 9 | Train Loss: 1.298 Vali Loss: 1.299 Vali Acc: 0.449 Test Loss: 1.299 Test Acc: 0.449
Validation loss decreased (-0.362305 --> -0.449262).  Saving model ...
Epoch: 3 cost time: 3.177088975906372
Epoch: 3, Steps: 9 | Train Loss: 1.206 Vali Loss: 1.203 Vali Acc: 0.529 Test Loss: 1.203 Test Acc: 0.529
Validation loss decreased (-0.449262 --> -0.528973).  Saving model ...
Epoch: 4 cost time: 3.3043289184570312
Epoch: 4, Steps: 9 | Train Loss: 1.052 Vali Loss: 1.113 Vali Acc: 0.536 Test Loss: 1.113 Test Acc: 0.536
Validation loss decreased (-0.528973 --> -0.536221).  Saving model ...
Epoch: 5 cost time: 3.1880366802215576
Epoch: 5, Steps: 9 | Train Loss: 0.903 Vali Loss: 1.015 Vali Acc: 0.638 Test Loss: 1.015 Test Acc: 0.638
Validation loss decreased (-0.536221 --> -0.637671).  Saving model ...
Epoch: 6 cost time: 3.059025526046753
Epoch: 6, Steps: 9 | Train Loss: 0.764 Vali Loss: 0.949 Vali Acc: 0.645 Test Loss: 0.949 Test Acc: 0.645
Validation loss decreased (-0.637671 --> -0.644918).  Saving model ...
Epoch: 7 cost time: 3.305257797241211
Epoch: 7, Steps: 9 | Train Loss: 0.592 Vali Loss: 0.839 Vali Acc: 0.761 Test Loss: 0.839 Test Acc: 0.761
Validation loss decreased (-0.644918 --> -0.760861).  Saving model ...
Epoch: 8 cost time: 3.181877374649048
Epoch: 8, Steps: 9 | Train Loss: 0.476 Vali Loss: 0.782 Vali Acc: 0.761 Test Loss: 0.782 Test Acc: 0.761
Validation loss decreased (-0.760861 --> -0.760862).  Saving model ...
Epoch: 9 cost time: 2.915104389190674
Epoch: 9, Steps: 9 | Train Loss: 0.373 Vali Loss: 0.709 Vali Acc: 0.775 Test Loss: 0.709 Test Acc: 0.775
Validation loss decreased (-0.760862 --> -0.775355).  Saving model ...
Epoch: 10 cost time: 2.75742506980896
Epoch: 10, Steps: 9 | Train Loss: 0.277 Vali Loss: 0.637 Vali Acc: 0.812 Test Loss: 0.637 Test Acc: 0.812
Validation loss decreased (-0.775355 --> -0.811588).  Saving model ...
Epoch: 11 cost time: 3.0501763820648193
Epoch: 11, Steps: 9 | Train Loss: 0.201 Vali Loss: 0.582 Vali Acc: 0.826 Test Loss: 0.582 Test Acc: 0.826
Validation loss decreased (-0.811588 --> -0.826081).  Saving model ...
Epoch: 12 cost time: 3.014071464538574
Epoch: 12, Steps: 9 | Train Loss: 0.143 Vali Loss: 0.548 Vali Acc: 0.833 Test Loss: 0.548 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833328).  Saving model ...
Epoch: 13 cost time: 3.1110050678253174
Epoch: 13, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.517 Vali Acc: 0.826 Test Loss: 0.517 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.982097625732422
Epoch: 14, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.495 Vali Acc: 0.819 Test Loss: 0.495 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.2055253982543945
Epoch: 15, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.469 Vali Acc: 0.833 Test Loss: 0.469 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833329).  Saving model ...
Epoch: 16 cost time: 3.143564224243164
Epoch: 16, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.469 Vali Acc: 0.841 Test Loss: 0.469 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840575).  Saving model ...
Epoch: 17 cost time: 3.4466536045074463
Epoch: 17, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.462 Vali Acc: 0.848 Test Loss: 0.462 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847821).  Saving model ...
Epoch: 18 cost time: 3.204586982727051
Epoch: 18, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.446 Vali Acc: 0.848 Test Loss: 0.446 Test Acc: 0.848
Validation loss decreased (-0.847821 --> -0.847822).  Saving model ...
Epoch: 19 cost time: 3.3140006065368652
Epoch: 19, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.430 Vali Acc: 0.848 Test Loss: 0.430 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 20 cost time: 3.2580015659332275
Epoch: 20, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.428 Vali Acc: 0.848 Test Loss: 0.428 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 21 cost time: 3.3835251331329346
Epoch: 21, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.421 Vali Acc: 0.833 Test Loss: 0.421 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.146662950515747
Epoch: 22, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.426 Vali Acc: 0.826 Test Loss: 0.426 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.9237022399902344
Epoch: 23, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.420 Vali Acc: 0.841 Test Loss: 0.420 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.1284220218658447
Epoch: 24, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.410 Vali Acc: 0.848 Test Loss: 0.410 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 25 cost time: 2.993922472000122
Epoch: 25, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.409 Vali Acc: 0.848 Test Loss: 0.409 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 26 cost time: 2.9846537113189697
Epoch: 26, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.398 Vali Acc: 0.848 Test Loss: 0.398 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 27 cost time: 3.0573947429656982
Epoch: 27, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.403 Vali Acc: 0.841 Test Loss: 0.403 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.891867160797119
Epoch: 28, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.394 Vali Acc: 0.870 Test Loss: 0.394 Test Acc: 0.870
Validation loss decreased (-0.847822 --> -0.869561).  Saving model ...
Epoch: 29 cost time: 3.279210329055786
Epoch: 29, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.407 Vali Acc: 0.855 Test Loss: 0.407 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.1434805393218994
Epoch: 30, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.403 Vali Acc: 0.855 Test Loss: 0.403 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.198859930038452
Epoch: 31, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.401 Vali Acc: 0.841 Test Loss: 0.401 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.3035573959350586
Epoch: 32, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.401 Vali Acc: 0.841 Test Loss: 0.401 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.1867973804473877
Epoch: 33, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.403 Vali Acc: 0.862 Test Loss: 0.403 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.274864673614502
Epoch: 34, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.401 Vali Acc: 0.862 Test Loss: 0.401 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.98962664604187
Epoch: 35, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.403 Vali Acc: 0.855 Test Loss: 0.403 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.9791266918182373
Epoch: 36, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.404 Vali Acc: 0.862 Test Loss: 0.404 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.9733827114105225
Epoch: 37, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.402 Vali Acc: 0.862 Test Loss: 0.402 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 2.910918951034546
Epoch: 38, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.396 Vali Acc: 0.862 Test Loss: 0.396 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df256_ma42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 118340
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df256_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.422640800476074
Epoch: 1, Steps: 9 | Train Loss: 1.425 Vali Loss: 1.435 Vali Acc: 0.210 Test Loss: 1.435 Test Acc: 0.210
Validation loss decreased (inf --> -0.210131).  Saving model ...
Epoch: 2 cost time: 3.2998504638671875
Epoch: 2, Steps: 9 | Train Loss: 1.335 Vali Loss: 1.363 Vali Acc: 0.377 Test Loss: 1.363 Test Acc: 0.377
Validation loss decreased (-0.210131 --> -0.376798).  Saving model ...
Epoch: 3 cost time: 3.1268808841705322
Epoch: 3, Steps: 9 | Train Loss: 1.232 Vali Loss: 1.271 Vali Acc: 0.514 Test Loss: 1.271 Test Acc: 0.514
Validation loss decreased (-0.376798 --> -0.514480).  Saving model ...
Epoch: 4 cost time: 3.2072808742523193
Epoch: 4, Steps: 9 | Train Loss: 1.082 Vali Loss: 1.178 Vali Acc: 0.580 Test Loss: 1.178 Test Acc: 0.580
Validation loss decreased (-0.514480 --> -0.579698).  Saving model ...
Epoch: 5 cost time: 3.3091719150543213
Epoch: 5, Steps: 9 | Train Loss: 0.935 Vali Loss: 1.078 Vali Acc: 0.659 Test Loss: 1.078 Test Acc: 0.659
Validation loss decreased (-0.579698 --> -0.659410).  Saving model ...
Epoch: 6 cost time: 3.225924015045166
Epoch: 6, Steps: 9 | Train Loss: 0.798 Vali Loss: 1.003 Vali Acc: 0.659 Test Loss: 1.003 Test Acc: 0.659
Validation loss decreased (-0.659410 --> -0.659410).  Saving model ...
Epoch: 7 cost time: 3.2202329635620117
Epoch: 7, Steps: 9 | Train Loss: 0.625 Vali Loss: 0.885 Vali Acc: 0.754 Test Loss: 0.885 Test Acc: 0.754
Validation loss decreased (-0.659410 --> -0.753614).  Saving model ...
Epoch: 8 cost time: 2.891732692718506
Epoch: 8, Steps: 9 | Train Loss: 0.500 Vali Loss: 0.813 Vali Acc: 0.746 Test Loss: 0.813 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.1308860778808594
Epoch: 9, Steps: 9 | Train Loss: 0.394 Vali Loss: 0.722 Vali Acc: 0.819 Test Loss: 0.722 Test Acc: 0.819
Validation loss decreased (-0.753614 --> -0.818833).  Saving model ...
Epoch: 10 cost time: 2.865204095840454
Epoch: 10, Steps: 9 | Train Loss: 0.299 Vali Loss: 0.647 Vali Acc: 0.833 Test Loss: 0.647 Test Acc: 0.833
Validation loss decreased (-0.818833 --> -0.833327).  Saving model ...
Epoch: 11 cost time: 2.913440704345703
Epoch: 11, Steps: 9 | Train Loss: 0.221 Vali Loss: 0.588 Vali Acc: 0.848 Test Loss: 0.588 Test Acc: 0.848
Validation loss decreased (-0.833327 --> -0.847820).  Saving model ...
Epoch: 12 cost time: 2.907505989074707
Epoch: 12, Steps: 9 | Train Loss: 0.156 Vali Loss: 0.538 Vali Acc: 0.855 Test Loss: 0.538 Test Acc: 0.855
Validation loss decreased (-0.847820 --> -0.855067).  Saving model ...
Epoch: 13 cost time: 3.028681993484497
Epoch: 13, Steps: 9 | Train Loss: 0.131 Vali Loss: 0.509 Vali Acc: 0.855 Test Loss: 0.509 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 14 cost time: 3.0007083415985107
Epoch: 14, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.460 Vali Acc: 0.870 Test Loss: 0.460 Test Acc: 0.870
Validation loss decreased (-0.855067 --> -0.869561).  Saving model ...
Epoch: 15 cost time: 3.254944086074829
Epoch: 15, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.437 Vali Acc: 0.870 Test Loss: 0.437 Test Acc: 0.870
Validation loss decreased (-0.869561 --> -0.869561).  Saving model ...
Epoch: 16 cost time: 3.12599778175354
Epoch: 16, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.437 Vali Acc: 0.877 Test Loss: 0.437 Test Acc: 0.877
Validation loss decreased (-0.869561 --> -0.876807).  Saving model ...
Epoch: 17 cost time: 3.257499933242798
Epoch: 17, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.424 Vali Acc: 0.891 Test Loss: 0.424 Test Acc: 0.891
Validation loss decreased (-0.876807 --> -0.891300).  Saving model ...
Epoch: 18 cost time: 3.2189934253692627
Epoch: 18, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.404 Vali Acc: 0.891 Test Loss: 0.404 Test Acc: 0.891
Validation loss decreased (-0.891300 --> -0.891300).  Saving model ...
Epoch: 19 cost time: 3.2062997817993164
Epoch: 19, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.382 Vali Acc: 0.877 Test Loss: 0.382 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.345008611679077
Epoch: 20, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.394 Vali Acc: 0.877 Test Loss: 0.394 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.3207430839538574
Epoch: 21, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.386 Vali Acc: 0.870 Test Loss: 0.386 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.1813900470733643
Epoch: 22, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.377 Vali Acc: 0.877 Test Loss: 0.377 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.229773998260498
Epoch: 23, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.370 Vali Acc: 0.877 Test Loss: 0.370 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.179176092147827
Epoch: 24, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.357 Vali Acc: 0.884 Test Loss: 0.357 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.291205644607544
Epoch: 25, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.355 Vali Acc: 0.884 Test Loss: 0.355 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.246469259262085
Epoch: 26, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.358 Vali Acc: 0.877 Test Loss: 0.358 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.5789554119110107
Epoch: 27, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.363 Vali Acc: 0.870 Test Loss: 0.363 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.329827308654785
Epoch: 28, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.348 Vali Acc: 0.884 Test Loss: 0.348 Test Acc: 0.884
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df256_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 118340
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df256_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.74761438369751
Epoch: 1, Steps: 9 | Train Loss: 1.439 Vali Loss: 1.397 Vali Acc: 0.297 Test Loss: 1.397 Test Acc: 0.297
Validation loss decreased (inf --> -0.297087).  Saving model ...
Epoch: 2 cost time: 3.268007516860962
Epoch: 2, Steps: 9 | Train Loss: 1.346 Vali Loss: 1.334 Vali Acc: 0.420 Test Loss: 1.334 Test Acc: 0.420
Validation loss decreased (-0.297087 --> -0.420277).  Saving model ...
Epoch: 3 cost time: 3.0529966354370117
Epoch: 3, Steps: 9 | Train Loss: 1.247 Vali Loss: 1.247 Vali Acc: 0.522 Test Loss: 1.247 Test Acc: 0.522
Validation loss decreased (-0.420277 --> -0.521727).  Saving model ...
Epoch: 4 cost time: 2.805954933166504
Epoch: 4, Steps: 9 | Train Loss: 1.099 Vali Loss: 1.164 Vali Acc: 0.536 Test Loss: 1.164 Test Acc: 0.536
Validation loss decreased (-0.521727 --> -0.536220).  Saving model ...
Epoch: 5 cost time: 3.129631280899048
Epoch: 5, Steps: 9 | Train Loss: 0.971 Vali Loss: 1.068 Vali Acc: 0.630 Test Loss: 1.068 Test Acc: 0.630
Validation loss decreased (-0.536220 --> -0.630424).  Saving model ...
Epoch: 6 cost time: 2.8144094944000244
Epoch: 6, Steps: 9 | Train Loss: 0.819 Vali Loss: 0.999 Vali Acc: 0.630 Test Loss: 0.999 Test Acc: 0.630
Validation loss decreased (-0.630424 --> -0.630425).  Saving model ...
Epoch: 7 cost time: 3.014324188232422
Epoch: 7, Steps: 9 | Train Loss: 0.669 Vali Loss: 0.895 Vali Acc: 0.696 Test Loss: 0.895 Test Acc: 0.696
Validation loss decreased (-0.630425 --> -0.695643).  Saving model ...
Epoch: 8 cost time: 3.046586751937866
Epoch: 8, Steps: 9 | Train Loss: 0.550 Vali Loss: 0.844 Vali Acc: 0.732 Test Loss: 0.844 Test Acc: 0.732
Validation loss decreased (-0.695643 --> -0.731876).  Saving model ...
Epoch: 9 cost time: 3.1476337909698486
Epoch: 9, Steps: 9 | Train Loss: 0.459 Vali Loss: 0.772 Vali Acc: 0.761 Test Loss: 0.772 Test Acc: 0.761
Validation loss decreased (-0.731876 --> -0.760862).  Saving model ...
Epoch: 10 cost time: 3.1844239234924316
Epoch: 10, Steps: 9 | Train Loss: 0.349 Vali Loss: 0.694 Vali Acc: 0.775 Test Loss: 0.694 Test Acc: 0.775
Validation loss decreased (-0.760862 --> -0.775355).  Saving model ...
Epoch: 11 cost time: 3.1100597381591797
Epoch: 11, Steps: 9 | Train Loss: 0.265 Vali Loss: 0.641 Vali Acc: 0.775 Test Loss: 0.641 Test Acc: 0.775
Validation loss decreased (-0.775355 --> -0.775356).  Saving model ...
Epoch: 12 cost time: 3.1040966510772705
Epoch: 12, Steps: 9 | Train Loss: 0.196 Vali Loss: 0.615 Vali Acc: 0.783 Test Loss: 0.615 Test Acc: 0.783
Validation loss decreased (-0.775356 --> -0.782603).  Saving model ...
Epoch: 13 cost time: 3.498093366622925
Epoch: 13, Steps: 9 | Train Loss: 0.178 Vali Loss: 0.583 Vali Acc: 0.797 Test Loss: 0.583 Test Acc: 0.797
Validation loss decreased (-0.782603 --> -0.797096).  Saving model ...
Epoch: 14 cost time: 3.253042697906494
Epoch: 14, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.552 Vali Acc: 0.797 Test Loss: 0.552 Test Acc: 0.797
Validation loss decreased (-0.797096 --> -0.797096).  Saving model ...
Epoch: 15 cost time: 3.3286969661712646
Epoch: 15, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.521 Vali Acc: 0.804 Test Loss: 0.521 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804343).  Saving model ...
Epoch: 16 cost time: 3.3116044998168945
Epoch: 16, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.552 Vali Acc: 0.783 Test Loss: 0.552 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.104123830795288
Epoch: 17, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.508 Vali Acc: 0.819 Test Loss: 0.508 Test Acc: 0.819
Validation loss decreased (-0.804343 --> -0.818836).  Saving model ...
Epoch: 18 cost time: 3.1536591053009033
Epoch: 18, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.502 Vali Acc: 0.812 Test Loss: 0.502 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.031870126724243
Epoch: 19, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.496 Vali Acc: 0.826 Test Loss: 0.496 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826082).  Saving model ...
Epoch: 20 cost time: 3.205768585205078
Epoch: 20, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.517 Vali Acc: 0.804 Test Loss: 0.517 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.1167385578155518
Epoch: 21, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.473 Vali Acc: 0.826 Test Loss: 0.473 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 22 cost time: 3.200446844100952
Epoch: 22, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.471 Vali Acc: 0.826 Test Loss: 0.471 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 23 cost time: 3.4622862339019775
Epoch: 23, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.495 Vali Acc: 0.804 Test Loss: 0.495 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.2777411937713623
Epoch: 24, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.479 Vali Acc: 0.826 Test Loss: 0.479 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.2159409523010254
Epoch: 25, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.468 Vali Acc: 0.833 Test Loss: 0.468 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833329).  Saving model ...
Epoch: 26 cost time: 3.4293034076690674
Epoch: 26, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.467 Vali Acc: 0.833 Test Loss: 0.467 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 27 cost time: 3.6110074520111084
Epoch: 27, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.481 Vali Acc: 0.826 Test Loss: 0.481 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.224695920944214
Epoch: 28, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.453 Vali Acc: 0.833 Test Loss: 0.453 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 29 cost time: 3.0575013160705566
Epoch: 29, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.480 Vali Acc: 0.819 Test Loss: 0.480 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.777327299118042
Epoch: 30, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.470 Vali Acc: 0.826 Test Loss: 0.470 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.9982659816741943
Epoch: 31, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.461 Vali Acc: 0.826 Test Loss: 0.461 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.8884692192077637
Epoch: 32, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.470 Vali Acc: 0.826 Test Loss: 0.470 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.0003538131713867
Epoch: 33, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.490 Vali Acc: 0.826 Test Loss: 0.490 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.9648239612579346
Epoch: 34, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.470 Vali Acc: 0.826 Test Loss: 0.470 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.238542318344116
Epoch: 35, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.462 Vali Acc: 0.833 Test Loss: 0.462 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 3.3387436866760254
Epoch: 36, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.474 Vali Acc: 0.826 Test Loss: 0.474 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.3539516925811768
Epoch: 37, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.470 Vali Acc: 0.826 Test Loss: 0.470 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.09309720993042
Epoch: 38, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.463 Vali Acc: 0.833 Test Loss: 0.463 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df256_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 118340
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df256_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.500800609588623
Epoch: 1, Steps: 9 | Train Loss: 1.409 Vali Loss: 1.373 Vali Acc: 0.341 Test Loss: 1.373 Test Acc: 0.341
Validation loss decreased (inf --> -0.340566).  Saving model ...
Epoch: 2 cost time: 3.218071460723877
Epoch: 2, Steps: 9 | Train Loss: 1.310 Vali Loss: 1.291 Vali Acc: 0.514 Test Loss: 1.291 Test Acc: 0.514
Validation loss decreased (-0.340566 --> -0.514480).  Saving model ...
Epoch: 3 cost time: 3.4398128986358643
Epoch: 3, Steps: 9 | Train Loss: 1.225 Vali Loss: 1.189 Vali Acc: 0.580 Test Loss: 1.189 Test Acc: 0.580
Validation loss decreased (-0.514480 --> -0.579698).  Saving model ...
Epoch: 4 cost time: 3.294950008392334
Epoch: 4, Steps: 9 | Train Loss: 1.049 Vali Loss: 1.098 Vali Acc: 0.609 Test Loss: 1.098 Test Acc: 0.609
Validation loss decreased (-0.579698 --> -0.608685).  Saving model ...
Epoch: 5 cost time: 3.2292184829711914
Epoch: 5, Steps: 9 | Train Loss: 0.915 Vali Loss: 1.011 Vali Acc: 0.616 Test Loss: 1.011 Test Acc: 0.616
Validation loss decreased (-0.608685 --> -0.615932).  Saving model ...
Epoch: 6 cost time: 3.4626288414001465
Epoch: 6, Steps: 9 | Train Loss: 0.776 Vali Loss: 0.956 Vali Acc: 0.630 Test Loss: 0.956 Test Acc: 0.630
Validation loss decreased (-0.615932 --> -0.630425).  Saving model ...
Epoch: 7 cost time: 3.5108087062835693
Epoch: 7, Steps: 9 | Train Loss: 0.621 Vali Loss: 0.858 Vali Acc: 0.696 Test Loss: 0.858 Test Acc: 0.696
Validation loss decreased (-0.630425 --> -0.695644).  Saving model ...
Epoch: 8 cost time: 3.3332624435424805
Epoch: 8, Steps: 9 | Train Loss: 0.519 Vali Loss: 0.806 Vali Acc: 0.710 Test Loss: 0.806 Test Acc: 0.710
Validation loss decreased (-0.695644 --> -0.710137).  Saving model ...
Epoch: 9 cost time: 3.38773250579834
Epoch: 9, Steps: 9 | Train Loss: 0.416 Vali Loss: 0.784 Vali Acc: 0.681 Test Loss: 0.784 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.3655636310577393
Epoch: 10, Steps: 9 | Train Loss: 0.337 Vali Loss: 0.740 Vali Acc: 0.717 Test Loss: 0.740 Test Acc: 0.717
Validation loss decreased (-0.710137 --> -0.717384).  Saving model ...
Epoch: 11 cost time: 3.32670259475708
Epoch: 11, Steps: 9 | Train Loss: 0.269 Vali Loss: 0.698 Vali Acc: 0.703 Test Loss: 0.698 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.6034770011901855
Epoch: 12, Steps: 9 | Train Loss: 0.197 Vali Loss: 0.685 Vali Acc: 0.717 Test Loss: 0.685 Test Acc: 0.717
Validation loss decreased (-0.717384 --> -0.717384).  Saving model ...
Epoch: 13 cost time: 3.14554500579834
Epoch: 13, Steps: 9 | Train Loss: 0.169 Vali Loss: 0.665 Vali Acc: 0.725 Test Loss: 0.665 Test Acc: 0.725
Validation loss decreased (-0.717384 --> -0.724631).  Saving model ...
Epoch: 14 cost time: 3.535295248031616
Epoch: 14, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.640 Vali Acc: 0.761 Test Loss: 0.640 Test Acc: 0.761
Validation loss decreased (-0.724631 --> -0.760863).  Saving model ...
Epoch: 15 cost time: 3.433465003967285
Epoch: 15, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.627 Vali Acc: 0.768 Test Loss: 0.627 Test Acc: 0.768
Validation loss decreased (-0.760863 --> -0.768110).  Saving model ...
Epoch: 16 cost time: 3.265615463256836
Epoch: 16, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.636 Vali Acc: 0.746 Test Loss: 0.636 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.6415960788726807
Epoch: 17, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.622 Vali Acc: 0.746 Test Loss: 0.622 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.2925221920013428
Epoch: 18, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.621 Vali Acc: 0.739 Test Loss: 0.621 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.5528476238250732
Epoch: 19, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.608 Vali Acc: 0.790 Test Loss: 0.608 Test Acc: 0.790
Validation loss decreased (-0.768110 --> -0.789849).  Saving model ...
Epoch: 20 cost time: 3.346438407897949
Epoch: 20, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.607 Vali Acc: 0.790 Test Loss: 0.607 Test Acc: 0.790
Validation loss decreased (-0.789849 --> -0.789849).  Saving model ...
Epoch: 21 cost time: 3.4430618286132812
Epoch: 21, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.614 Vali Acc: 0.775 Test Loss: 0.614 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.5525686740875244
Epoch: 22, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.613 Vali Acc: 0.775 Test Loss: 0.613 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.499551773071289
Epoch: 23, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.614 Vali Acc: 0.761 Test Loss: 0.614 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.35125470161438
Epoch: 24, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.613 Vali Acc: 0.761 Test Loss: 0.613 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.4670193195343018
Epoch: 25, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.612 Vali Acc: 0.775 Test Loss: 0.612 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.2161848545074463
Epoch: 26, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.611 Vali Acc: 0.783 Test Loss: 0.611 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.3999991416931152
Epoch: 27, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.618 Vali Acc: 0.790 Test Loss: 0.618 Test Acc: 0.790
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.5045015811920166
Epoch: 28, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.620 Vali Acc: 0.790 Test Loss: 0.620 Test Acc: 0.790
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.4492645263671875
Epoch: 29, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.627 Vali Acc: 0.783 Test Loss: 0.627 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.310482978820801
Epoch: 30, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.625 Vali Acc: 0.797 Test Loss: 0.625 Test Acc: 0.797
Validation loss decreased (-0.789849 --> -0.797095).  Saving model ...
Epoch: 31 cost time: 3.3561086654663086
Epoch: 31, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.635 Vali Acc: 0.783 Test Loss: 0.635 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.6808788776397705
Epoch: 32, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.638 Vali Acc: 0.797 Test Loss: 0.638 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.2152907848358154
Epoch: 33, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.635 Vali Acc: 0.775 Test Loss: 0.635 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.286203384399414
Epoch: 34, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.625 Vali Acc: 0.783 Test Loss: 0.625 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.5258076190948486
Epoch: 35, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.631 Vali Acc: 0.790 Test Loss: 0.631 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.5040526390075684
Epoch: 36, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.643 Vali Acc: 0.783 Test Loss: 0.643 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.9497060775756836
Epoch: 37, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.645 Vali Acc: 0.790 Test Loss: 0.645 Test Acc: 0.790
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.006941318511963
Epoch: 38, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.643 Vali Acc: 0.790 Test Loss: 0.643 Test Acc: 0.790
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 3.0996756553649902
Epoch: 39, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.638 Vali Acc: 0.790 Test Loss: 0.638 Test Acc: 0.790
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 2.857003688812256
Epoch: 40, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.642 Vali Acc: 0.797 Test Loss: 0.642 Test Acc: 0.797
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df256_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7971014492753623
model parameter : 118340
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.278194904327393
Epoch: 1, Steps: 9 | Train Loss: 1.455 Vali Loss: 1.404 Vali Acc: 0.290 Test Loss: 1.404 Test Acc: 0.290
Validation loss decreased (inf --> -0.289841).  Saving model ...
Epoch: 2 cost time: 3.393789052963257
Epoch: 2, Steps: 9 | Train Loss: 1.324 Vali Loss: 1.378 Vali Acc: 0.312 Test Loss: 1.378 Test Acc: 0.312
Validation loss decreased (-0.289841 --> -0.311580).  Saving model ...
Epoch: 3 cost time: 3.759462356567383
Epoch: 3, Steps: 9 | Train Loss: 1.257 Vali Loss: 1.350 Vali Acc: 0.355 Test Loss: 1.350 Test Acc: 0.355
Validation loss decreased (-0.311580 --> -0.355059).  Saving model ...
Epoch: 4 cost time: 3.564115524291992
Epoch: 4, Steps: 9 | Train Loss: 1.181 Vali Loss: 1.319 Vali Acc: 0.399 Test Loss: 1.319 Test Acc: 0.399
Validation loss decreased (-0.355059 --> -0.398538).  Saving model ...
Epoch: 5 cost time: 3.262255907058716
Epoch: 5, Steps: 9 | Train Loss: 1.126 Vali Loss: 1.288 Vali Acc: 0.420 Test Loss: 1.288 Test Acc: 0.420
Validation loss decreased (-0.398538 --> -0.420277).  Saving model ...
Epoch: 6 cost time: 3.5515100955963135
Epoch: 6, Steps: 9 | Train Loss: 0.953 Vali Loss: 1.263 Vali Acc: 0.399 Test Loss: 1.263 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.2813363075256348
Epoch: 7, Steps: 9 | Train Loss: 0.871 Vali Loss: 1.231 Vali Acc: 0.442 Test Loss: 1.231 Test Acc: 0.442
Validation loss decreased (-0.420277 --> -0.442017).  Saving model ...
Epoch: 8 cost time: 3.0550999641418457
Epoch: 8, Steps: 9 | Train Loss: 0.766 Vali Loss: 1.203 Vali Acc: 0.478 Test Loss: 1.203 Test Acc: 0.478
Validation loss decreased (-0.442017 --> -0.478249).  Saving model ...
Epoch: 9 cost time: 3.3214752674102783
Epoch: 9, Steps: 9 | Train Loss: 0.670 Vali Loss: 1.191 Vali Acc: 0.478 Test Loss: 1.191 Test Acc: 0.478
Validation loss decreased (-0.478249 --> -0.478249).  Saving model ...
Epoch: 10 cost time: 3.2199385166168213
Epoch: 10, Steps: 9 | Train Loss: 0.559 Vali Loss: 1.154 Vali Acc: 0.500 Test Loss: 1.154 Test Acc: 0.500
Validation loss decreased (-0.478249 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 3.1035819053649902
Epoch: 11, Steps: 9 | Train Loss: 0.490 Vali Loss: 1.154 Vali Acc: 0.486 Test Loss: 1.154 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.3989579677581787
Epoch: 12, Steps: 9 | Train Loss: 0.360 Vali Loss: 1.172 Vali Acc: 0.493 Test Loss: 1.172 Test Acc: 0.493
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.232811212539673
Epoch: 13, Steps: 9 | Train Loss: 0.332 Vali Loss: 1.148 Vali Acc: 0.478 Test Loss: 1.148 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.3943397998809814
Epoch: 14, Steps: 9 | Train Loss: 0.253 Vali Loss: 1.172 Vali Acc: 0.493 Test Loss: 1.172 Test Acc: 0.493
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.7080748081207275
Epoch: 15, Steps: 9 | Train Loss: 0.214 Vali Loss: 1.182 Vali Acc: 0.478 Test Loss: 1.182 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.127708673477173
Epoch: 16, Steps: 9 | Train Loss: 0.173 Vali Loss: 1.222 Vali Acc: 0.478 Test Loss: 1.222 Test Acc: 0.478
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.3770010471343994
Epoch: 17, Steps: 9 | Train Loss: 0.142 Vali Loss: 1.289 Vali Acc: 0.420 Test Loss: 1.289 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.201061487197876
Epoch: 18, Steps: 9 | Train Loss: 0.138 Vali Loss: 1.235 Vali Acc: 0.478 Test Loss: 1.235 Test Acc: 0.478
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.369133949279785
Epoch: 19, Steps: 9 | Train Loss: 0.100 Vali Loss: 1.285 Vali Acc: 0.478 Test Loss: 1.285 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.167815685272217
Epoch: 20, Steps: 9 | Train Loss: 0.087 Vali Loss: 1.352 Vali Acc: 0.442 Test Loss: 1.352 Test Acc: 0.442
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5
model parameter : 118340
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.181579113006592
Epoch: 1, Steps: 9 | Train Loss: 1.441 Vali Loss: 1.455 Vali Acc: 0.290 Test Loss: 1.455 Test Acc: 0.290
Validation loss decreased (inf --> -0.289841).  Saving model ...
Epoch: 2 cost time: 3.116760730743408
Epoch: 2, Steps: 9 | Train Loss: 1.423 Vali Loss: 1.449 Vali Acc: 0.275 Test Loss: 1.449 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.087245225906372
Epoch: 3, Steps: 9 | Train Loss: 1.315 Vali Loss: 1.453 Vali Acc: 0.312 Test Loss: 1.453 Test Acc: 0.312
Validation loss decreased (-0.289841 --> -0.311580).  Saving model ...
Epoch: 4 cost time: 3.188722610473633
Epoch: 4, Steps: 9 | Train Loss: 1.310 Vali Loss: 1.452 Vali Acc: 0.297 Test Loss: 1.452 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.3032617568969727
Epoch: 5, Steps: 9 | Train Loss: 1.218 Vali Loss: 1.442 Vali Acc: 0.333 Test Loss: 1.442 Test Acc: 0.333
Validation loss decreased (-0.311580 --> -0.333319).  Saving model ...
Epoch: 6 cost time: 3.228262186050415
Epoch: 6, Steps: 9 | Train Loss: 1.158 Vali Loss: 1.456 Vali Acc: 0.326 Test Loss: 1.456 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.5880672931671143
Epoch: 7, Steps: 9 | Train Loss: 1.062 Vali Loss: 1.469 Vali Acc: 0.326 Test Loss: 1.469 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.279582977294922
Epoch: 8, Steps: 9 | Train Loss: 0.971 Vali Loss: 1.492 Vali Acc: 0.319 Test Loss: 1.492 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.395017385482788
Epoch: 9, Steps: 9 | Train Loss: 0.906 Vali Loss: 1.571 Vali Acc: 0.319 Test Loss: 1.571 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.31315541267395
Epoch: 10, Steps: 9 | Train Loss: 0.789 Vali Loss: 1.569 Vali Acc: 0.326 Test Loss: 1.569 Test Acc: 0.326
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.2809534072875977
Epoch: 11, Steps: 9 | Train Loss: 0.787 Vali Loss: 1.597 Vali Acc: 0.326 Test Loss: 1.597 Test Acc: 0.326
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.518075704574585
Epoch: 12, Steps: 9 | Train Loss: 0.640 Vali Loss: 1.729 Vali Acc: 0.341 Test Loss: 1.729 Test Acc: 0.341
Validation loss decreased (-0.333319 --> -0.340562).  Saving model ...
Epoch: 13 cost time: 3.2850286960601807
Epoch: 13, Steps: 9 | Train Loss: 0.619 Vali Loss: 1.820 Vali Acc: 0.304 Test Loss: 1.820 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.3864705562591553
Epoch: 14, Steps: 9 | Train Loss: 0.504 Vali Loss: 1.980 Vali Acc: 0.290 Test Loss: 1.980 Test Acc: 0.290
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.3197689056396484
Epoch: 15, Steps: 9 | Train Loss: 0.414 Vali Loss: 2.024 Vali Acc: 0.304 Test Loss: 2.024 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.9580187797546387
Epoch: 16, Steps: 9 | Train Loss: 0.360 Vali Loss: 2.174 Vali Acc: 0.297 Test Loss: 2.174 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.7373921871185303
Epoch: 17, Steps: 9 | Train Loss: 0.305 Vali Loss: 2.261 Vali Acc: 0.333 Test Loss: 2.261 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.4080841541290283
Epoch: 18, Steps: 9 | Train Loss: 0.296 Vali Loss: 2.392 Vali Acc: 0.333 Test Loss: 2.392 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.807610034942627
Epoch: 19, Steps: 9 | Train Loss: 0.213 Vali Loss: 2.566 Vali Acc: 0.319 Test Loss: 2.566 Test Acc: 0.319
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.262080669403076
Epoch: 20, Steps: 9 | Train Loss: 0.187 Vali Loss: 2.564 Vali Acc: 0.326 Test Loss: 2.564 Test Acc: 0.326
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.3405086994171143
Epoch: 21, Steps: 9 | Train Loss: 0.167 Vali Loss: 2.588 Vali Acc: 0.362 Test Loss: 2.588 Test Acc: 0.362
Validation loss decreased (-0.340562 --> -0.362293).  Saving model ...
Epoch: 22 cost time: 3.3203792572021484
Epoch: 22, Steps: 9 | Train Loss: 0.139 Vali Loss: 2.851 Vali Acc: 0.333 Test Loss: 2.851 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.9389989376068115
Epoch: 23, Steps: 9 | Train Loss: 0.106 Vali Loss: 2.704 Vali Acc: 0.341 Test Loss: 2.704 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.6114981174468994
Epoch: 24, Steps: 9 | Train Loss: 0.101 Vali Loss: 2.850 Vali Acc: 0.355 Test Loss: 2.850 Test Acc: 0.355
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.00970196723938
Epoch: 25, Steps: 9 | Train Loss: 0.084 Vali Loss: 2.826 Vali Acc: 0.355 Test Loss: 2.826 Test Acc: 0.355
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.152320146560669
Epoch: 26, Steps: 9 | Train Loss: 0.073 Vali Loss: 2.783 Vali Acc: 0.348 Test Loss: 2.783 Test Acc: 0.348
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.171095371246338
Epoch: 27, Steps: 9 | Train Loss: 0.066 Vali Loss: 2.923 Vali Acc: 0.355 Test Loss: 2.923 Test Acc: 0.355
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.8254966735839844
Epoch: 28, Steps: 9 | Train Loss: 0.063 Vali Loss: 2.876 Vali Acc: 0.348 Test Loss: 2.876 Test Acc: 0.348
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.984203577041626
Epoch: 29, Steps: 9 | Train Loss: 0.056 Vali Loss: 2.922 Vali Acc: 0.355 Test Loss: 2.922 Test Acc: 0.355
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.212938070297241
Epoch: 30, Steps: 9 | Train Loss: 0.048 Vali Loss: 2.910 Vali Acc: 0.355 Test Loss: 2.910 Test Acc: 0.355
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.5795280933380127
Epoch: 31, Steps: 9 | Train Loss: 0.046 Vali Loss: 2.959 Vali Acc: 0.355 Test Loss: 2.959 Test Acc: 0.355
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.36231884057971014
model parameter : 118340
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.64920973777771
Epoch: 1, Steps: 9 | Train Loss: 1.411 Vali Loss: 1.420 Vali Acc: 0.326 Test Loss: 1.420 Test Acc: 0.326
Validation loss decreased (inf --> -0.326073).  Saving model ...
Epoch: 2 cost time: 3.208867073059082
Epoch: 2, Steps: 9 | Train Loss: 1.419 Vali Loss: 1.409 Vali Acc: 0.312 Test Loss: 1.409 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.144878387451172
Epoch: 3, Steps: 9 | Train Loss: 1.361 Vali Loss: 1.405 Vali Acc: 0.319 Test Loss: 1.405 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.1561763286590576
Epoch: 4, Steps: 9 | Train Loss: 1.305 Vali Loss: 1.395 Vali Acc: 0.341 Test Loss: 1.395 Test Acc: 0.341
Validation loss decreased (-0.326073 --> -0.340566).  Saving model ...
Epoch: 5 cost time: 3.087355613708496
Epoch: 5, Steps: 9 | Train Loss: 1.229 Vali Loss: 1.376 Vali Acc: 0.355 Test Loss: 1.376 Test Acc: 0.355
Validation loss decreased (-0.340566 --> -0.355059).  Saving model ...
Epoch: 6 cost time: 2.946237087249756
Epoch: 6, Steps: 9 | Train Loss: 1.136 Vali Loss: 1.372 Vali Acc: 0.333 Test Loss: 1.372 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.064192056655884
Epoch: 7, Steps: 9 | Train Loss: 1.031 Vali Loss: 1.362 Vali Acc: 0.355 Test Loss: 1.362 Test Acc: 0.355
Validation loss decreased (-0.355059 --> -0.355059).  Saving model ...
Epoch: 8 cost time: 2.9968762397766113
Epoch: 8, Steps: 9 | Train Loss: 0.944 Vali Loss: 1.347 Vali Acc: 0.348 Test Loss: 1.347 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.4733691215515137
Epoch: 9, Steps: 9 | Train Loss: 0.906 Vali Loss: 1.363 Vali Acc: 0.362 Test Loss: 1.363 Test Acc: 0.362
Validation loss decreased (-0.355059 --> -0.362305).  Saving model ...
Epoch: 10 cost time: 3.5960686206817627
Epoch: 10, Steps: 9 | Train Loss: 0.751 Vali Loss: 1.348 Vali Acc: 0.341 Test Loss: 1.348 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.2674930095672607
Epoch: 11, Steps: 9 | Train Loss: 0.707 Vali Loss: 1.365 Vali Acc: 0.384 Test Loss: 1.365 Test Acc: 0.384
Validation loss decreased (-0.362305 --> -0.384044).  Saving model ...
Epoch: 12 cost time: 3.388930559158325
Epoch: 12, Steps: 9 | Train Loss: 0.590 Vali Loss: 1.418 Vali Acc: 0.377 Test Loss: 1.418 Test Acc: 0.377
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.498237133026123
Epoch: 13, Steps: 9 | Train Loss: 0.516 Vali Loss: 1.420 Vali Acc: 0.362 Test Loss: 1.420 Test Acc: 0.362
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.3686025142669678
Epoch: 14, Steps: 9 | Train Loss: 0.447 Vali Loss: 1.441 Vali Acc: 0.377 Test Loss: 1.441 Test Acc: 0.377
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.331789970397949
Epoch: 15, Steps: 9 | Train Loss: 0.376 Vali Loss: 1.465 Vali Acc: 0.362 Test Loss: 1.465 Test Acc: 0.362
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.142745018005371
Epoch: 16, Steps: 9 | Train Loss: 0.303 Vali Loss: 1.536 Vali Acc: 0.384 Test Loss: 1.536 Test Acc: 0.384
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.1220059394836426
Epoch: 17, Steps: 9 | Train Loss: 0.245 Vali Loss: 1.637 Vali Acc: 0.341 Test Loss: 1.637 Test Acc: 0.341
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.118441343307495
Epoch: 18, Steps: 9 | Train Loss: 0.246 Vali Loss: 1.652 Vali Acc: 0.384 Test Loss: 1.652 Test Acc: 0.384
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.9613935947418213
Epoch: 19, Steps: 9 | Train Loss: 0.177 Vali Loss: 1.711 Vali Acc: 0.370 Test Loss: 1.711 Test Acc: 0.370
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.479175090789795
Epoch: 20, Steps: 9 | Train Loss: 0.140 Vali Loss: 1.766 Vali Acc: 0.355 Test Loss: 1.766 Test Acc: 0.355
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.4346632957458496
Epoch: 21, Steps: 9 | Train Loss: 0.135 Vali Loss: 1.728 Vali Acc: 0.355 Test Loss: 1.728 Test Acc: 0.355
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.38405797101449274
model parameter : 118340
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         103                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df128_ma103_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.623270750045776
Epoch: 1, Steps: 9 | Train Loss: 1.462 Vali Loss: 1.385 Vali Acc: 0.399 Test Loss: 1.385 Test Acc: 0.399
Validation loss decreased (inf --> -0.398537).  Saving model ...
Epoch: 2 cost time: 3.139063596725464
Epoch: 2, Steps: 9 | Train Loss: 1.326 Vali Loss: 1.326 Vali Acc: 0.464 Test Loss: 1.326 Test Acc: 0.464
Validation loss decreased (-0.398537 --> -0.463755).  Saving model ...
Epoch: 3 cost time: 3.0680909156799316
Epoch: 3, Steps: 9 | Train Loss: 1.218 Vali Loss: 1.247 Vali Acc: 0.536 Test Loss: 1.247 Test Acc: 0.536
Validation loss decreased (-0.463755 --> -0.536219).  Saving model ...
Epoch: 4 cost time: 3.2685112953186035
Epoch: 4, Steps: 9 | Train Loss: 1.066 Vali Loss: 1.172 Vali Acc: 0.565 Test Loss: 1.172 Test Acc: 0.565
Validation loss decreased (-0.536219 --> -0.565206).  Saving model ...
Epoch: 5 cost time: 3.438476324081421
Epoch: 5, Steps: 9 | Train Loss: 0.927 Vali Loss: 1.096 Vali Acc: 0.594 Test Loss: 1.096 Test Acc: 0.594
Validation loss decreased (-0.565206 --> -0.594192).  Saving model ...
Epoch: 6 cost time: 3.484086513519287
Epoch: 6, Steps: 9 | Train Loss: 0.786 Vali Loss: 1.018 Vali Acc: 0.630 Test Loss: 1.018 Test Acc: 0.630
Validation loss decreased (-0.594192 --> -0.630425).  Saving model ...
Epoch: 7 cost time: 3.182711124420166
Epoch: 7, Steps: 9 | Train Loss: 0.660 Vali Loss: 0.972 Vali Acc: 0.638 Test Loss: 0.972 Test Acc: 0.638
Validation loss decreased (-0.630425 --> -0.637671).  Saving model ...
Epoch: 8 cost time: 3.251654863357544
Epoch: 8, Steps: 9 | Train Loss: 0.548 Vali Loss: 0.901 Vali Acc: 0.681 Test Loss: 0.901 Test Acc: 0.681
Validation loss decreased (-0.637671 --> -0.681150).  Saving model ...
Epoch: 9 cost time: 3.5291013717651367
Epoch: 9, Steps: 9 | Train Loss: 0.460 Vali Loss: 0.848 Vali Acc: 0.703 Test Loss: 0.848 Test Acc: 0.703
Validation loss decreased (-0.681150 --> -0.702890).  Saving model ...
Epoch: 10 cost time: 3.560412645339966
Epoch: 10, Steps: 9 | Train Loss: 0.358 Vali Loss: 0.812 Vali Acc: 0.688 Test Loss: 0.812 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.451930284500122
Epoch: 11, Steps: 9 | Train Loss: 0.269 Vali Loss: 0.753 Vali Acc: 0.696 Test Loss: 0.753 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.1805357933044434
Epoch: 12, Steps: 9 | Train Loss: 0.222 Vali Loss: 0.752 Vali Acc: 0.717 Test Loss: 0.752 Test Acc: 0.717
Validation loss decreased (-0.702890 --> -0.717384).  Saving model ...
Epoch: 13 cost time: 3.3377740383148193
Epoch: 13, Steps: 9 | Train Loss: 0.160 Vali Loss: 0.696 Vali Acc: 0.717 Test Loss: 0.696 Test Acc: 0.717
Validation loss decreased (-0.717384 --> -0.717384).  Saving model ...
Epoch: 14 cost time: 3.3328299522399902
Epoch: 14, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.673 Vali Acc: 0.732 Test Loss: 0.673 Test Acc: 0.732
Validation loss decreased (-0.717384 --> -0.731877).  Saving model ...
Epoch: 15 cost time: 3.4321651458740234
Epoch: 15, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.639 Vali Acc: 0.746 Test Loss: 0.639 Test Acc: 0.746
Validation loss decreased (-0.731877 --> -0.746370).  Saving model ...
Epoch: 16 cost time: 3.5029821395874023
Epoch: 16, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.623 Vali Acc: 0.754 Test Loss: 0.623 Test Acc: 0.754
Validation loss decreased (-0.746370 --> -0.753617).  Saving model ...
Epoch: 17 cost time: 3.2738778591156006
Epoch: 17, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.619 Vali Acc: 0.754 Test Loss: 0.619 Test Acc: 0.754
Validation loss decreased (-0.753617 --> -0.753617).  Saving model ...
Epoch: 18 cost time: 3.338144063949585
Epoch: 18, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.622 Vali Acc: 0.768 Test Loss: 0.622 Test Acc: 0.768
Validation loss decreased (-0.753617 --> -0.768110).  Saving model ...
Epoch: 19 cost time: 3.71128249168396
Epoch: 19, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.603 Vali Acc: 0.761 Test Loss: 0.603 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.5624887943267822
Epoch: 20, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.593 Vali Acc: 0.768 Test Loss: 0.593 Test Acc: 0.768
Validation loss decreased (-0.768110 --> -0.768110).  Saving model ...
Epoch: 21 cost time: 3.7599599361419678
Epoch: 21, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.591 Vali Acc: 0.754 Test Loss: 0.591 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.3045735359191895
Epoch: 22, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.590 Vali Acc: 0.768 Test Loss: 0.590 Test Acc: 0.768
Validation loss decreased (-0.768110 --> -0.768110).  Saving model ...
Epoch: 23 cost time: 3.3013575077056885
Epoch: 23, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.567 Vali Acc: 0.775 Test Loss: 0.567 Test Acc: 0.775
Validation loss decreased (-0.768110 --> -0.775357).  Saving model ...
Epoch: 24 cost time: 3.6205568313598633
Epoch: 24, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.567 Vali Acc: 0.783 Test Loss: 0.567 Test Acc: 0.783
Validation loss decreased (-0.775357 --> -0.782603).  Saving model ...
Epoch: 25 cost time: 3.482767343521118
Epoch: 25, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.603 Vali Acc: 0.783 Test Loss: 0.603 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.210691213607788
Epoch: 26, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.573 Vali Acc: 0.775 Test Loss: 0.573 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.3949525356292725
Epoch: 27, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.571 Vali Acc: 0.783 Test Loss: 0.571 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.3762638568878174
Epoch: 28, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.563 Vali Acc: 0.783 Test Loss: 0.563 Test Acc: 0.783
Validation loss decreased (-0.782603 --> -0.782603).  Saving model ...
Epoch: 29 cost time: 3.698232889175415
Epoch: 29, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.556 Vali Acc: 0.797 Test Loss: 0.556 Test Acc: 0.797
Validation loss decreased (-0.782603 --> -0.797096).  Saving model ...
Epoch: 30 cost time: 3.2394680976867676
Epoch: 30, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.565 Vali Acc: 0.790 Test Loss: 0.565 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.390982151031494
Epoch: 31, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.569 Vali Acc: 0.790 Test Loss: 0.569 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.2963602542877197
Epoch: 32, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.571 Vali Acc: 0.797 Test Loss: 0.571 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.3182339668273926
Epoch: 33, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.560 Vali Acc: 0.783 Test Loss: 0.560 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.142514228820801
Epoch: 34, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.553 Vali Acc: 0.790 Test Loss: 0.553 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.6054508686065674
Epoch: 35, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.555 Vali Acc: 0.797 Test Loss: 0.555 Test Acc: 0.797
Validation loss decreased (-0.797096 --> -0.797096).  Saving model ...
Epoch: 36 cost time: 3.2044596672058105
Epoch: 36, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.565 Vali Acc: 0.797 Test Loss: 0.565 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.2031731605529785
Epoch: 37, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.563 Vali Acc: 0.790 Test Loss: 0.563 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.286684513092041
Epoch: 38, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.558 Vali Acc: 0.790 Test Loss: 0.558 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.5077285766601562
Epoch: 39, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.558 Vali Acc: 0.775 Test Loss: 0.558 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 3.5591166019439697
Epoch: 40, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.551 Vali Acc: 0.768 Test Loss: 0.551 Test Acc: 0.768
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 3.3701179027557373
Epoch: 41, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.547 Vali Acc: 0.783 Test Loss: 0.547 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 3.524689197540283
Epoch: 42, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.548 Vali Acc: 0.783 Test Loss: 0.548 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 3.4935193061828613
Epoch: 43, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.550 Vali Acc: 0.783 Test Loss: 0.550 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 3.7284133434295654
Epoch: 44, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.555 Vali Acc: 0.783 Test Loss: 0.555 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 3.521029472351074
Epoch: 45, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.558 Vali Acc: 0.775 Test Loss: 0.558 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df128_ma103_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7971014492753623
model parameter : 93764
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         83                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df128_ma83_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.463667154312134
Epoch: 1, Steps: 9 | Train Loss: 1.457 Vali Loss: 1.380 Vali Acc: 0.384 Test Loss: 1.380 Test Acc: 0.384
Validation loss decreased (inf --> -0.384044).  Saving model ...
Epoch: 2 cost time: 3.4535210132598877
Epoch: 2, Steps: 9 | Train Loss: 1.323 Vali Loss: 1.325 Vali Acc: 0.464 Test Loss: 1.325 Test Acc: 0.464
Validation loss decreased (-0.384044 --> -0.463755).  Saving model ...
Epoch: 3 cost time: 3.3189351558685303
Epoch: 3, Steps: 9 | Train Loss: 1.225 Vali Loss: 1.248 Vali Acc: 0.529 Test Loss: 1.248 Test Acc: 0.529
Validation loss decreased (-0.463755 --> -0.528973).  Saving model ...
Epoch: 4 cost time: 3.756152391433716
Epoch: 4, Steps: 9 | Train Loss: 1.071 Vali Loss: 1.176 Vali Acc: 0.543 Test Loss: 1.176 Test Acc: 0.543
Validation loss decreased (-0.528973 --> -0.543467).  Saving model ...
Epoch: 5 cost time: 3.9001448154449463
Epoch: 5, Steps: 9 | Train Loss: 0.935 Vali Loss: 1.102 Vali Acc: 0.580 Test Loss: 1.102 Test Acc: 0.580
Validation loss decreased (-0.543467 --> -0.579699).  Saving model ...
Epoch: 6 cost time: 3.7454187870025635
Epoch: 6, Steps: 9 | Train Loss: 0.797 Vali Loss: 1.024 Vali Acc: 0.616 Test Loss: 1.024 Test Acc: 0.616
Validation loss decreased (-0.579699 --> -0.615932).  Saving model ...
Epoch: 7 cost time: 3.2884750366210938
Epoch: 7, Steps: 9 | Train Loss: 0.669 Vali Loss: 0.980 Vali Acc: 0.630 Test Loss: 0.980 Test Acc: 0.630
Validation loss decreased (-0.615932 --> -0.630425).  Saving model ...
Epoch: 8 cost time: 3.7381229400634766
Epoch: 8, Steps: 9 | Train Loss: 0.555 Vali Loss: 0.907 Vali Acc: 0.710 Test Loss: 0.907 Test Acc: 0.710
Validation loss decreased (-0.630425 --> -0.710136).  Saving model ...
Epoch: 9 cost time: 3.688004970550537
Epoch: 9, Steps: 9 | Train Loss: 0.462 Vali Loss: 0.850 Vali Acc: 0.703 Test Loss: 0.850 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.189540147781372
Epoch: 10, Steps: 9 | Train Loss: 0.360 Vali Loss: 0.811 Vali Acc: 0.696 Test Loss: 0.811 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.345715045928955
Epoch: 11, Steps: 9 | Train Loss: 0.270 Vali Loss: 0.748 Vali Acc: 0.703 Test Loss: 0.748 Test Acc: 0.703
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.2309093475341797
Epoch: 12, Steps: 9 | Train Loss: 0.221 Vali Loss: 0.756 Vali Acc: 0.717 Test Loss: 0.756 Test Acc: 0.717
Validation loss decreased (-0.710136 --> -0.717384).  Saving model ...
Epoch: 13 cost time: 3.404968023300171
Epoch: 13, Steps: 9 | Train Loss: 0.162 Vali Loss: 0.698 Vali Acc: 0.732 Test Loss: 0.698 Test Acc: 0.732
Validation loss decreased (-0.717384 --> -0.731877).  Saving model ...
Epoch: 14 cost time: 3.2397358417510986
Epoch: 14, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.663 Vali Acc: 0.761 Test Loss: 0.663 Test Acc: 0.761
Validation loss decreased (-0.731877 --> -0.760863).  Saving model ...
Epoch: 15 cost time: 3.1955926418304443
Epoch: 15, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.637 Vali Acc: 0.761 Test Loss: 0.637 Test Acc: 0.761
Validation loss decreased (-0.760863 --> -0.760863).  Saving model ...
Epoch: 16 cost time: 3.3858869075775146
Epoch: 16, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.619 Vali Acc: 0.768 Test Loss: 0.619 Test Acc: 0.768
Validation loss decreased (-0.760863 --> -0.768110).  Saving model ...
Epoch: 17 cost time: 3.4777743816375732
Epoch: 17, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.600 Vali Acc: 0.790 Test Loss: 0.600 Test Acc: 0.790
Validation loss decreased (-0.768110 --> -0.789849).  Saving model ...
Epoch: 18 cost time: 3.5603067874908447
Epoch: 18, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.609 Vali Acc: 0.775 Test Loss: 0.609 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.6731109619140625
Epoch: 19, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.603 Vali Acc: 0.775 Test Loss: 0.603 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.249563217163086
Epoch: 20, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.580 Vali Acc: 0.783 Test Loss: 0.580 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.5545859336853027
Epoch: 21, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.568 Vali Acc: 0.790 Test Loss: 0.568 Test Acc: 0.790
Validation loss decreased (-0.789849 --> -0.789849).  Saving model ...
Epoch: 22 cost time: 3.236741542816162
Epoch: 22, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.571 Vali Acc: 0.783 Test Loss: 0.571 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.4297094345092773
Epoch: 23, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.549 Vali Acc: 0.790 Test Loss: 0.549 Test Acc: 0.790
Validation loss decreased (-0.789849 --> -0.789850).  Saving model ...
Epoch: 24 cost time: 3.4343926906585693
Epoch: 24, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.549 Vali Acc: 0.797 Test Loss: 0.549 Test Acc: 0.797
Validation loss decreased (-0.789850 --> -0.797096).  Saving model ...
Epoch: 25 cost time: 3.4797136783599854
Epoch: 25, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.575 Vali Acc: 0.783 Test Loss: 0.575 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.245181083679199
Epoch: 26, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.550 Vali Acc: 0.790 Test Loss: 0.550 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.5684282779693604
Epoch: 27, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.557 Vali Acc: 0.790 Test Loss: 0.557 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.41054105758667
Epoch: 28, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.547 Vali Acc: 0.783 Test Loss: 0.547 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.653517007827759
Epoch: 29, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.528 Vali Acc: 0.804 Test Loss: 0.528 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804343).  Saving model ...
Epoch: 30 cost time: 3.4627997875213623
Epoch: 30, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.539 Vali Acc: 0.797 Test Loss: 0.539 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.4589459896087646
Epoch: 31, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.547 Vali Acc: 0.783 Test Loss: 0.547 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.3622798919677734
Epoch: 32, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.545 Vali Acc: 0.797 Test Loss: 0.545 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.183563470840454
Epoch: 33, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.530 Vali Acc: 0.804 Test Loss: 0.530 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.54292631149292
Epoch: 34, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.523 Vali Acc: 0.797 Test Loss: 0.523 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.1880762577056885
Epoch: 35, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.527 Vali Acc: 0.790 Test Loss: 0.527 Test Acc: 0.790
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.295413017272949
Epoch: 36, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.538 Vali Acc: 0.812 Test Loss: 0.538 Test Acc: 0.812
Validation loss decreased (-0.804343 --> -0.811589).  Saving model ...
Epoch: 37 cost time: 3.333472728729248
Epoch: 37, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.535 Vali Acc: 0.804 Test Loss: 0.535 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.4611151218414307
Epoch: 38, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.527 Vali Acc: 0.804 Test Loss: 0.527 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.525578498840332
Epoch: 39, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.524 Vali Acc: 0.812 Test Loss: 0.524 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811589).  Saving model ...
Epoch: 40 cost time: 3.331303358078003
Epoch: 40, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.522 Vali Acc: 0.812 Test Loss: 0.522 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811589).  Saving model ...
Epoch: 41 cost time: 3.1419260501861572
Epoch: 41, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.523 Vali Acc: 0.812 Test Loss: 0.523 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.328949451446533
Epoch: 42, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.524 Vali Acc: 0.812 Test Loss: 0.524 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.4618611335754395
Epoch: 43, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.522 Vali Acc: 0.797 Test Loss: 0.522 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 2.9882590770721436
Epoch: 44, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.522 Vali Acc: 0.812 Test Loss: 0.522 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 3.232621431350708
Epoch: 45, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.525 Vali Acc: 0.819 Test Loss: 0.525 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818835).  Saving model ...
Epoch: 46 cost time: 3.000192165374756
Epoch: 46, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.530 Vali Acc: 0.812 Test Loss: 0.530 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.1220297813415527
Epoch: 47, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.532 Vali Acc: 0.833 Test Loss: 0.532 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833328).  Saving model ...
Epoch: 48 cost time: 2.979008674621582
Epoch: 48, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.534 Vali Acc: 0.833 Test Loss: 0.534 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.2838551998138428
Epoch: 49, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.531 Vali Acc: 0.833 Test Loss: 0.531 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 50 cost time: 3.3914566040039062
Epoch: 50, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.527 Vali Acc: 0.826 Test Loss: 0.527 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 3.3131229877471924
Epoch: 51, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.522 Vali Acc: 0.826 Test Loss: 0.522 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 3.5298004150390625
Epoch: 52, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.526 Vali Acc: 0.826 Test Loss: 0.526 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 3.2665088176727295
Epoch: 53, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.531 Vali Acc: 0.833 Test Loss: 0.531 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 54 cost time: 3.4386017322540283
Epoch: 54, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.535 Vali Acc: 0.826 Test Loss: 0.535 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 3.675748109817505
Epoch: 55, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.541 Vali Acc: 0.833 Test Loss: 0.541 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 3.6762075424194336
Epoch: 56, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.526 Vali Acc: 0.848 Test Loss: 0.526 Test Acc: 0.848
Validation loss decreased (-0.833328 --> -0.847821).  Saving model ...
Epoch: 57 cost time: 3.52875018119812
Epoch: 57, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.522 Vali Acc: 0.841 Test Loss: 0.522 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 3.4533839225769043
Epoch: 58, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.521 Vali Acc: 0.841 Test Loss: 0.521 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 3.213632106781006
Epoch: 59, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.527 Vali Acc: 0.848 Test Loss: 0.527 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 3.400763750076294
Epoch: 60, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.526 Vali Acc: 0.841 Test Loss: 0.526 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 3.49333119392395
Epoch: 61, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.532 Vali Acc: 0.848 Test Loss: 0.532 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 3.8615663051605225
Epoch: 62, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.533 Vali Acc: 0.848 Test Loss: 0.533 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 3.4608166217803955
Epoch: 63, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.531 Vali Acc: 0.848 Test Loss: 0.531 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 3.490464210510254
Epoch: 64, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.533 Vali Acc: 0.848 Test Loss: 0.533 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 3.6575512886047363
Epoch: 65, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.531 Vali Acc: 0.848 Test Loss: 0.531 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 3.825450897216797
Epoch: 66, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.530 Vali Acc: 0.848 Test Loss: 0.530 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df128_ma83_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 93764
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         62                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df128_ma62_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.207223892211914
Epoch: 1, Steps: 9 | Train Loss: 1.456 Vali Loss: 1.400 Vali Acc: 0.377 Test Loss: 1.400 Test Acc: 0.377
Validation loss decreased (inf --> -0.376798).  Saving model ...
Epoch: 2 cost time: 2.995452404022217
Epoch: 2, Steps: 9 | Train Loss: 1.331 Vali Loss: 1.342 Vali Acc: 0.428 Test Loss: 1.342 Test Acc: 0.428
Validation loss decreased (-0.376798 --> -0.427523).  Saving model ...
Epoch: 3 cost time: 2.989541530609131
Epoch: 3, Steps: 9 | Train Loss: 1.233 Vali Loss: 1.265 Vali Acc: 0.522 Test Loss: 1.265 Test Acc: 0.522
Validation loss decreased (-0.427523 --> -0.521726).  Saving model ...
Epoch: 4 cost time: 2.8488786220550537
Epoch: 4, Steps: 9 | Train Loss: 1.078 Vali Loss: 1.191 Vali Acc: 0.536 Test Loss: 1.191 Test Acc: 0.536
Validation loss decreased (-0.521726 --> -0.536220).  Saving model ...
Epoch: 5 cost time: 2.9171433448791504
Epoch: 5, Steps: 9 | Train Loss: 0.928 Vali Loss: 1.113 Vali Acc: 0.587 Test Loss: 1.113 Test Acc: 0.587
Validation loss decreased (-0.536220 --> -0.586945).  Saving model ...
Epoch: 6 cost time: 3.3410370349884033
Epoch: 6, Steps: 9 | Train Loss: 0.796 Vali Loss: 1.034 Vali Acc: 0.638 Test Loss: 1.034 Test Acc: 0.638
Validation loss decreased (-0.586945 --> -0.637671).  Saving model ...
Epoch: 7 cost time: 3.306501865386963
Epoch: 7, Steps: 9 | Train Loss: 0.659 Vali Loss: 0.983 Vali Acc: 0.688 Test Loss: 0.983 Test Acc: 0.688
Validation loss decreased (-0.637671 --> -0.688396).  Saving model ...
Epoch: 8 cost time: 3.1498258113861084
Epoch: 8, Steps: 9 | Train Loss: 0.542 Vali Loss: 0.905 Vali Acc: 0.703 Test Loss: 0.905 Test Acc: 0.703
Validation loss decreased (-0.688396 --> -0.702890).  Saving model ...
Epoch: 9 cost time: 3.307401657104492
Epoch: 9, Steps: 9 | Train Loss: 0.450 Vali Loss: 0.846 Vali Acc: 0.739 Test Loss: 0.846 Test Acc: 0.739
Validation loss decreased (-0.702890 --> -0.739122).  Saving model ...
Epoch: 10 cost time: 3.4714083671569824
Epoch: 10, Steps: 9 | Train Loss: 0.346 Vali Loss: 0.798 Vali Acc: 0.732 Test Loss: 0.798 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.124943971633911
Epoch: 11, Steps: 9 | Train Loss: 0.258 Vali Loss: 0.730 Vali Acc: 0.746 Test Loss: 0.730 Test Acc: 0.746
Validation loss decreased (-0.739122 --> -0.746370).  Saving model ...
Epoch: 12 cost time: 3.05432391166687
Epoch: 12, Steps: 9 | Train Loss: 0.209 Vali Loss: 0.729 Vali Acc: 0.761 Test Loss: 0.729 Test Acc: 0.761
Validation loss decreased (-0.746370 --> -0.760862).  Saving model ...
Epoch: 13 cost time: 3.0159122943878174
Epoch: 13, Steps: 9 | Train Loss: 0.155 Vali Loss: 0.669 Vali Acc: 0.804 Test Loss: 0.669 Test Acc: 0.804
Validation loss decreased (-0.760862 --> -0.804341).  Saving model ...
Epoch: 14 cost time: 3.018373966217041
Epoch: 14, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.635 Vali Acc: 0.819 Test Loss: 0.635 Test Acc: 0.819
Validation loss decreased (-0.804341 --> -0.818834).  Saving model ...
Epoch: 15 cost time: 2.9623148441314697
Epoch: 15, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.603 Vali Acc: 0.826 Test Loss: 0.603 Test Acc: 0.826
Validation loss decreased (-0.818834 --> -0.826081).  Saving model ...
Epoch: 16 cost time: 2.9035239219665527
Epoch: 16, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.596 Vali Acc: 0.819 Test Loss: 0.596 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.1160683631896973
Epoch: 17, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.569 Vali Acc: 0.826 Test Loss: 0.569 Test Acc: 0.826
Validation loss decreased (-0.826081 --> -0.826081).  Saving model ...
Epoch: 18 cost time: 3.265242099761963
Epoch: 18, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.567 Vali Acc: 0.819 Test Loss: 0.567 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.2997214794158936
Epoch: 19, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.575 Vali Acc: 0.812 Test Loss: 0.575 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.1516079902648926
Epoch: 20, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.548 Vali Acc: 0.826 Test Loss: 0.548 Test Acc: 0.826
Validation loss decreased (-0.826081 --> -0.826081).  Saving model ...
Epoch: 21 cost time: 3.2381746768951416
Epoch: 21, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.533 Vali Acc: 0.855 Test Loss: 0.533 Test Acc: 0.855
Validation loss decreased (-0.826081 --> -0.855067).  Saving model ...
Epoch: 22 cost time: 3.139655351638794
Epoch: 22, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.530 Vali Acc: 0.848 Test Loss: 0.530 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.29913067817688
Epoch: 23, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.515 Vali Acc: 0.848 Test Loss: 0.515 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.0591325759887695
Epoch: 24, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.515 Vali Acc: 0.848 Test Loss: 0.515 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.9675378799438477
Epoch: 25, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.533 Vali Acc: 0.841 Test Loss: 0.533 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.961721658706665
Epoch: 26, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.514 Vali Acc: 0.841 Test Loss: 0.514 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.964243173599243
Epoch: 27, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.517 Vali Acc: 0.855 Test Loss: 0.517 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 28 cost time: 2.9040369987487793
Epoch: 28, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.507 Vali Acc: 0.841 Test Loss: 0.507 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.00520396232605
Epoch: 29, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.496 Vali Acc: 0.848 Test Loss: 0.496 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.9494285583496094
Epoch: 30, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.506 Vali Acc: 0.833 Test Loss: 0.506 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.2908506393432617
Epoch: 31, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.510 Vali Acc: 0.848 Test Loss: 0.510 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.350182056427002
Epoch: 32, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.502 Vali Acc: 0.848 Test Loss: 0.502 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.112215518951416
Epoch: 33, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.490 Vali Acc: 0.862 Test Loss: 0.490 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862314).  Saving model ...
Epoch: 34 cost time: 3.3852744102478027
Epoch: 34, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.490 Vali Acc: 0.862 Test Loss: 0.490 Test Acc: 0.862
Validation loss decreased (-0.862314 --> -0.862314).  Saving model ...
Epoch: 35 cost time: 3.556238889694214
Epoch: 35, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.494 Vali Acc: 0.855 Test Loss: 0.494 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.3119149208068848
Epoch: 36, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.504 Vali Acc: 0.848 Test Loss: 0.504 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.9553442001342773
Epoch: 37, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.502 Vali Acc: 0.848 Test Loss: 0.502 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.969050884246826
Epoch: 38, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.493 Vali Acc: 0.862 Test Loss: 0.493 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.010885000228882
Epoch: 39, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.487 Vali Acc: 0.870 Test Loss: 0.487 Test Acc: 0.870
Validation loss decreased (-0.862314 --> -0.869560).  Saving model ...
Epoch: 40 cost time: 3.0902016162872314
Epoch: 40, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.483 Vali Acc: 0.870 Test Loss: 0.483 Test Acc: 0.870
Validation loss decreased (-0.869560 --> -0.869560).  Saving model ...
Epoch: 41 cost time: 2.9385552406311035
Epoch: 41, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.486 Vali Acc: 0.855 Test Loss: 0.486 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.036376476287842
Epoch: 42, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.487 Vali Acc: 0.862 Test Loss: 0.487 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.3700029850006104
Epoch: 43, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.489 Vali Acc: 0.848 Test Loss: 0.489 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.2984955310821533
Epoch: 44, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.490 Vali Acc: 0.855 Test Loss: 0.490 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 3.398683547973633
Epoch: 45, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.491 Vali Acc: 0.848 Test Loss: 0.491 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 3.618917465209961
Epoch: 46, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.497 Vali Acc: 0.848 Test Loss: 0.497 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 3.624729871749878
Epoch: 47, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.499 Vali Acc: 0.855 Test Loss: 0.499 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 3.611095905303955
Epoch: 48, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.502 Vali Acc: 0.862 Test Loss: 0.502 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 3.3448984622955322
Epoch: 49, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.495 Vali Acc: 0.862 Test Loss: 0.495 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 3.1855900287628174
Epoch: 50, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.490 Vali Acc: 0.855 Test Loss: 0.490 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df128_ma62_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 93764
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         42                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df128_ma42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.745386600494385
Epoch: 1, Steps: 9 | Train Loss: 1.451 Vali Loss: 1.358 Vali Acc: 0.406 Test Loss: 1.358 Test Acc: 0.406
Validation loss decreased (inf --> -0.405784).  Saving model ...
Epoch: 2 cost time: 3.438370704650879
Epoch: 2, Steps: 9 | Train Loss: 1.316 Vali Loss: 1.292 Vali Acc: 0.464 Test Loss: 1.292 Test Acc: 0.464
Validation loss decreased (-0.405784 --> -0.463755).  Saving model ...
Epoch: 3 cost time: 3.4437828063964844
Epoch: 3, Steps: 9 | Train Loss: 1.223 Vali Loss: 1.205 Vali Acc: 0.551 Test Loss: 1.205 Test Acc: 0.551
Validation loss decreased (-0.463755 --> -0.550713).  Saving model ...
Epoch: 4 cost time: 3.74859356880188
Epoch: 4, Steps: 9 | Train Loss: 1.060 Vali Loss: 1.127 Vali Acc: 0.558 Test Loss: 1.127 Test Acc: 0.558
Validation loss decreased (-0.550713 --> -0.557960).  Saving model ...
Epoch: 5 cost time: 3.5890393257141113
Epoch: 5, Steps: 9 | Train Loss: 0.902 Vali Loss: 1.050 Vali Acc: 0.630 Test Loss: 1.050 Test Acc: 0.630
Validation loss decreased (-0.557960 --> -0.630424).  Saving model ...
Epoch: 6 cost time: 3.3330087661743164
Epoch: 6, Steps: 9 | Train Loss: 0.771 Vali Loss: 0.963 Vali Acc: 0.681 Test Loss: 0.963 Test Acc: 0.681
Validation loss decreased (-0.630424 --> -0.681150).  Saving model ...
Epoch: 7 cost time: 3.492692470550537
Epoch: 7, Steps: 9 | Train Loss: 0.625 Vali Loss: 0.907 Vali Acc: 0.710 Test Loss: 0.907 Test Acc: 0.710
Validation loss decreased (-0.681150 --> -0.710136).  Saving model ...
Epoch: 8 cost time: 3.4900879859924316
Epoch: 8, Steps: 9 | Train Loss: 0.518 Vali Loss: 0.833 Vali Acc: 0.717 Test Loss: 0.833 Test Acc: 0.717
Validation loss decreased (-0.710136 --> -0.717383).  Saving model ...
Epoch: 9 cost time: 3.7403273582458496
Epoch: 9, Steps: 9 | Train Loss: 0.418 Vali Loss: 0.777 Vali Acc: 0.754 Test Loss: 0.777 Test Acc: 0.754
Validation loss decreased (-0.717383 --> -0.753615).  Saving model ...
Epoch: 10 cost time: 3.3865480422973633
Epoch: 10, Steps: 9 | Train Loss: 0.320 Vali Loss: 0.725 Vali Acc: 0.754 Test Loss: 0.725 Test Acc: 0.754
Validation loss decreased (-0.753615 --> -0.753616).  Saving model ...
Epoch: 11 cost time: 3.5226471424102783
Epoch: 11, Steps: 9 | Train Loss: 0.237 Vali Loss: 0.667 Vali Acc: 0.775 Test Loss: 0.667 Test Acc: 0.775
Validation loss decreased (-0.753616 --> -0.775356).  Saving model ...
Epoch: 12 cost time: 3.35990047454834
Epoch: 12, Steps: 9 | Train Loss: 0.197 Vali Loss: 0.657 Vali Acc: 0.768 Test Loss: 0.657 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.602660894393921
Epoch: 13, Steps: 9 | Train Loss: 0.143 Vali Loss: 0.595 Vali Acc: 0.790 Test Loss: 0.595 Test Acc: 0.790
Validation loss decreased (-0.775356 --> -0.789849).  Saving model ...
Epoch: 14 cost time: 3.496727466583252
Epoch: 14, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.580 Vali Acc: 0.797 Test Loss: 0.580 Test Acc: 0.797
Validation loss decreased (-0.789849 --> -0.797096).  Saving model ...
Epoch: 15 cost time: 3.346935749053955
Epoch: 15, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.550 Vali Acc: 0.804 Test Loss: 0.550 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804342).  Saving model ...
Epoch: 16 cost time: 3.4893298149108887
Epoch: 16, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.536 Vali Acc: 0.812 Test Loss: 0.536 Test Acc: 0.812
Validation loss decreased (-0.804342 --> -0.811589).  Saving model ...
Epoch: 17 cost time: 3.468705654144287
Epoch: 17, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.517 Vali Acc: 0.812 Test Loss: 0.517 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811589).  Saving model ...
Epoch: 18 cost time: 3.616668701171875
Epoch: 18, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.515 Vali Acc: 0.812 Test Loss: 0.515 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811589).  Saving model ...
Epoch: 19 cost time: 3.2672431468963623
Epoch: 19, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.512 Vali Acc: 0.812 Test Loss: 0.512 Test Acc: 0.812
Validation loss decreased (-0.811589 --> -0.811589).  Saving model ...
Epoch: 20 cost time: 3.4581809043884277
Epoch: 20, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.495 Vali Acc: 0.826 Test Loss: 0.495 Test Acc: 0.826
Validation loss decreased (-0.811589 --> -0.826082).  Saving model ...
Epoch: 21 cost time: 3.1039443016052246
Epoch: 21, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.490 Vali Acc: 0.819 Test Loss: 0.490 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.1089489459991455
Epoch: 22, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.491 Vali Acc: 0.819 Test Loss: 0.491 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.082838773727417
Epoch: 23, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.464 Vali Acc: 0.833 Test Loss: 0.464 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833329).  Saving model ...
Epoch: 24 cost time: 2.9293673038482666
Epoch: 24, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.466 Vali Acc: 0.833 Test Loss: 0.466 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.4390735626220703
Epoch: 25, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.491 Vali Acc: 0.826 Test Loss: 0.491 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.2668073177337646
Epoch: 26, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.468 Vali Acc: 0.833 Test Loss: 0.468 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.3698019981384277
Epoch: 27, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.473 Vali Acc: 0.833 Test Loss: 0.473 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.7428958415985107
Epoch: 28, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.458 Vali Acc: 0.833 Test Loss: 0.458 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 29 cost time: 3.498368978500366
Epoch: 29, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.445 Vali Acc: 0.833 Test Loss: 0.445 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 30 cost time: 3.2754719257354736
Epoch: 30, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.462 Vali Acc: 0.833 Test Loss: 0.462 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.2400269508361816
Epoch: 31, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.466 Vali Acc: 0.833 Test Loss: 0.466 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.306508779525757
Epoch: 32, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.454 Vali Acc: 0.833 Test Loss: 0.454 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.1983234882354736
Epoch: 33, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.445 Vali Acc: 0.833 Test Loss: 0.445 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 34 cost time: 3.4142279624938965
Epoch: 34, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.446 Vali Acc: 0.833 Test Loss: 0.446 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.4848601818084717
Epoch: 35, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.449 Vali Acc: 0.833 Test Loss: 0.449 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.5287625789642334
Epoch: 36, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.455 Vali Acc: 0.833 Test Loss: 0.455 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.388730525970459
Epoch: 37, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.450 Vali Acc: 0.833 Test Loss: 0.450 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.6220762729644775
Epoch: 38, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.449 Vali Acc: 0.833 Test Loss: 0.449 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.4218058586120605
Epoch: 39, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.445 Vali Acc: 0.833 Test Loss: 0.445 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.3775928020477295
Epoch: 40, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.437 Vali Acc: 0.848 Test Loss: 0.437 Test Acc: 0.848
Validation loss decreased (-0.833329 --> -0.847822).  Saving model ...
Epoch: 41 cost time: 3.3299219608306885
Epoch: 41, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.437 Vali Acc: 0.848 Test Loss: 0.437 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 42 cost time: 3.4622366428375244
Epoch: 42, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.439 Vali Acc: 0.841 Test Loss: 0.439 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.3542869091033936
Epoch: 43, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.443 Vali Acc: 0.841 Test Loss: 0.443 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.1079583168029785
Epoch: 44, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.444 Vali Acc: 0.848 Test Loss: 0.444 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.2408642768859863
Epoch: 45, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.445 Vali Acc: 0.841 Test Loss: 0.445 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 3.276364803314209
Epoch: 46, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.454 Vali Acc: 0.841 Test Loss: 0.454 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 3.3443500995635986
Epoch: 47, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.453 Vali Acc: 0.841 Test Loss: 0.453 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 3.2566723823547363
Epoch: 48, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.455 Vali Acc: 0.841 Test Loss: 0.455 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 3.595930576324463
Epoch: 49, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.451 Vali Acc: 0.848 Test Loss: 0.451 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 3.53458309173584
Epoch: 50, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.446 Vali Acc: 0.855 Test Loss: 0.446 Test Acc: 0.855
Validation loss decreased (-0.847822 --> -0.855068).  Saving model ...
Epoch: 51 cost time: 3.4386556148529053
Epoch: 51, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.438 Vali Acc: 0.855 Test Loss: 0.438 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 52 cost time: 3.6507623195648193
Epoch: 52, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.438 Vali Acc: 0.855 Test Loss: 0.438 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 3.427304983139038
Epoch: 53, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.442 Vali Acc: 0.855 Test Loss: 0.442 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 3.032140016555786
Epoch: 54, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.451 Vali Acc: 0.848 Test Loss: 0.451 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 3.2185938358306885
Epoch: 55, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.458 Vali Acc: 0.848 Test Loss: 0.458 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 3.4426865577697754
Epoch: 56, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.437 Vali Acc: 0.855 Test Loss: 0.437 Test Acc: 0.855
Validation loss decreased (-0.855068 --> -0.855068).  Saving model ...
Epoch: 57 cost time: 3.8309245109558105
Epoch: 57, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.430 Vali Acc: 0.862 Test Loss: 0.430 Test Acc: 0.862
Validation loss decreased (-0.855068 --> -0.862315).  Saving model ...
Epoch: 58 cost time: 3.4580416679382324
Epoch: 58, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.429 Vali Acc: 0.862 Test Loss: 0.429 Test Acc: 0.862
Validation loss decreased (-0.862315 --> -0.862315).  Saving model ...
Epoch: 59 cost time: 3.362335443496704
Epoch: 59, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.435 Vali Acc: 0.862 Test Loss: 0.435 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 3.5958075523376465
Epoch: 60, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.440 Vali Acc: 0.855 Test Loss: 0.440 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 3.4330408573150635
Epoch: 61, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.443 Vali Acc: 0.855 Test Loss: 0.443 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 3.6064512729644775
Epoch: 62, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.443 Vali Acc: 0.855 Test Loss: 0.443 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 3.4954612255096436
Epoch: 63, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.441 Vali Acc: 0.862 Test Loss: 0.441 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 3.4778530597686768
Epoch: 64, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.446 Vali Acc: 0.855 Test Loss: 0.446 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 3.3635380268096924
Epoch: 65, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.447 Vali Acc: 0.862 Test Loss: 0.447 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 3.137136936187744
Epoch: 66, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.444 Vali Acc: 0.862 Test Loss: 0.444 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 3.2572715282440186
Epoch: 67, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.439 Vali Acc: 0.862 Test Loss: 0.439 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 3.488823890686035
Epoch: 68, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.441 Vali Acc: 0.862 Test Loss: 0.441 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df128_ma42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 93764
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         21                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df128_ma21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.552151918411255
Epoch: 1, Steps: 9 | Train Loss: 1.473 Vali Loss: 1.407 Vali Acc: 0.304 Test Loss: 1.407 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 3.0731964111328125
Epoch: 2, Steps: 9 | Train Loss: 1.349 Vali Loss: 1.347 Vali Acc: 0.406 Test Loss: 1.347 Test Acc: 0.406
Validation loss decreased (-0.304334 --> -0.405784).  Saving model ...
Epoch: 3 cost time: 3.130129337310791
Epoch: 3, Steps: 9 | Train Loss: 1.234 Vali Loss: 1.268 Vali Acc: 0.478 Test Loss: 1.268 Test Acc: 0.478
Validation loss decreased (-0.405784 --> -0.478248).  Saving model ...
Epoch: 4 cost time: 3.3663361072540283
Epoch: 4, Steps: 9 | Train Loss: 1.090 Vali Loss: 1.187 Vali Acc: 0.543 Test Loss: 1.187 Test Acc: 0.543
Validation loss decreased (-0.478248 --> -0.543466).  Saving model ...
Epoch: 5 cost time: 3.197554111480713
Epoch: 5, Steps: 9 | Train Loss: 0.946 Vali Loss: 1.103 Vali Acc: 0.587 Test Loss: 1.103 Test Acc: 0.587
Validation loss decreased (-0.543466 --> -0.586945).  Saving model ...
Epoch: 6 cost time: 3.0475873947143555
Epoch: 6, Steps: 9 | Train Loss: 0.810 Vali Loss: 1.014 Vali Acc: 0.652 Test Loss: 1.014 Test Acc: 0.652
Validation loss decreased (-0.586945 --> -0.652164).  Saving model ...
Epoch: 7 cost time: 3.0373647212982178
Epoch: 7, Steps: 9 | Train Loss: 0.660 Vali Loss: 0.945 Vali Acc: 0.688 Test Loss: 0.945 Test Acc: 0.688
Validation loss decreased (-0.652164 --> -0.688396).  Saving model ...
Epoch: 8 cost time: 3.286409616470337
Epoch: 8, Steps: 9 | Train Loss: 0.540 Vali Loss: 0.863 Vali Acc: 0.739 Test Loss: 0.863 Test Acc: 0.739
Validation loss decreased (-0.688396 --> -0.739122).  Saving model ...
Epoch: 9 cost time: 2.9262232780456543
Epoch: 9, Steps: 9 | Train Loss: 0.442 Vali Loss: 0.793 Vali Acc: 0.775 Test Loss: 0.793 Test Acc: 0.775
Validation loss decreased (-0.739122 --> -0.775354).  Saving model ...
Epoch: 10 cost time: 2.831045150756836
Epoch: 10, Steps: 9 | Train Loss: 0.344 Vali Loss: 0.736 Vali Acc: 0.768 Test Loss: 0.736 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.076917886734009
Epoch: 11, Steps: 9 | Train Loss: 0.260 Vali Loss: 0.665 Vali Acc: 0.819 Test Loss: 0.665 Test Acc: 0.819
Validation loss decreased (-0.775354 --> -0.818834).  Saving model ...
Epoch: 12 cost time: 3.0510804653167725
Epoch: 12, Steps: 9 | Train Loss: 0.213 Vali Loss: 0.645 Vali Acc: 0.819 Test Loss: 0.645 Test Acc: 0.819
Validation loss decreased (-0.818834 --> -0.818834).  Saving model ...
Epoch: 13 cost time: 3.0708794593811035
Epoch: 13, Steps: 9 | Train Loss: 0.161 Vali Loss: 0.577 Vali Acc: 0.833 Test Loss: 0.577 Test Acc: 0.833
Validation loss decreased (-0.818834 --> -0.833328).  Saving model ...
Epoch: 14 cost time: 3.375861406326294
Epoch: 14, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.541 Vali Acc: 0.833 Test Loss: 0.541 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833328).  Saving model ...
Epoch: 15 cost time: 3.29382586479187
Epoch: 15, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.515 Vali Acc: 0.855 Test Loss: 0.515 Test Acc: 0.855
Validation loss decreased (-0.833328 --> -0.855067).  Saving model ...
Epoch: 16 cost time: 3.4485318660736084
Epoch: 16, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.507 Vali Acc: 0.855 Test Loss: 0.507 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 17 cost time: 3.2516794204711914
Epoch: 17, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.470 Vali Acc: 0.848 Test Loss: 0.470 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.498044490814209
Epoch: 18, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.466 Vali Acc: 0.841 Test Loss: 0.466 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.4556167125701904
Epoch: 19, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.477 Vali Acc: 0.848 Test Loss: 0.477 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.013948678970337
Epoch: 20, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.453 Vali Acc: 0.848 Test Loss: 0.453 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.2208752632141113
Epoch: 21, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.444 Vali Acc: 0.848 Test Loss: 0.444 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.525664806365967
Epoch: 22, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.433 Vali Acc: 0.848 Test Loss: 0.433 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.3719611167907715
Epoch: 23, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.418 Vali Acc: 0.848 Test Loss: 0.418 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.267439603805542
Epoch: 24, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.417 Vali Acc: 0.841 Test Loss: 0.417 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.0674326419830322
Epoch: 25, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.434 Vali Acc: 0.848 Test Loss: 0.434 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.4154117107391357
Epoch: 26, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.428 Vali Acc: 0.848 Test Loss: 0.428 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df128_ma21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 93764
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         11                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df128_ma11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.831433296203613
Epoch: 1, Steps: 9 | Train Loss: 1.461 Vali Loss: 1.397 Vali Acc: 0.348 Test Loss: 1.397 Test Acc: 0.348
Validation loss decreased (inf --> -0.347812).  Saving model ...
Epoch: 2 cost time: 3.5747196674346924
Epoch: 2, Steps: 9 | Train Loss: 1.305 Vali Loss: 1.342 Vali Acc: 0.435 Test Loss: 1.342 Test Acc: 0.435
Validation loss decreased (-0.347812 --> -0.434769).  Saving model ...
Epoch: 3 cost time: 4.104206800460815
Epoch: 3, Steps: 9 | Train Loss: 1.268 Vali Loss: 1.268 Vali Acc: 0.493 Test Loss: 1.268 Test Acc: 0.493
Validation loss decreased (-0.434769 --> -0.492741).  Saving model ...
Epoch: 4 cost time: 3.3608975410461426
Epoch: 4, Steps: 9 | Train Loss: 1.093 Vali Loss: 1.192 Vali Acc: 0.565 Test Loss: 1.192 Test Acc: 0.565
Validation loss decreased (-0.492741 --> -0.565205).  Saving model ...
Epoch: 5 cost time: 3.4410717487335205
Epoch: 5, Steps: 9 | Train Loss: 0.972 Vali Loss: 1.116 Vali Acc: 0.638 Test Loss: 1.116 Test Acc: 0.638
Validation loss decreased (-0.565205 --> -0.637670).  Saving model ...
Epoch: 6 cost time: 3.266007661819458
Epoch: 6, Steps: 9 | Train Loss: 0.832 Vali Loss: 1.028 Vali Acc: 0.638 Test Loss: 1.028 Test Acc: 0.638
Validation loss decreased (-0.637670 --> -0.637671).  Saving model ...
Epoch: 7 cost time: 3.1911380290985107
Epoch: 7, Steps: 9 | Train Loss: 0.689 Vali Loss: 0.959 Vali Acc: 0.696 Test Loss: 0.959 Test Acc: 0.696
Validation loss decreased (-0.637671 --> -0.695643).  Saving model ...
Epoch: 8 cost time: 3.1863386631011963
Epoch: 8, Steps: 9 | Train Loss: 0.583 Vali Loss: 0.882 Vali Acc: 0.710 Test Loss: 0.882 Test Acc: 0.710
Validation loss decreased (-0.695643 --> -0.710136).  Saving model ...
Epoch: 9 cost time: 3.337280035018921
Epoch: 9, Steps: 9 | Train Loss: 0.486 Vali Loss: 0.813 Vali Acc: 0.732 Test Loss: 0.813 Test Acc: 0.732
Validation loss decreased (-0.710136 --> -0.731876).  Saving model ...
Epoch: 10 cost time: 3.074756383895874
Epoch: 10, Steps: 9 | Train Loss: 0.401 Vali Loss: 0.761 Vali Acc: 0.754 Test Loss: 0.761 Test Acc: 0.754
Validation loss decreased (-0.731876 --> -0.753616).  Saving model ...
Epoch: 11 cost time: 3.272207260131836
Epoch: 11, Steps: 9 | Train Loss: 0.307 Vali Loss: 0.710 Vali Acc: 0.775 Test Loss: 0.710 Test Acc: 0.775
Validation loss decreased (-0.753616 --> -0.775355).  Saving model ...
Epoch: 12 cost time: 3.079336404800415
Epoch: 12, Steps: 9 | Train Loss: 0.243 Vali Loss: 0.678 Vali Acc: 0.754 Test Loss: 0.678 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.145845651626587
Epoch: 13, Steps: 9 | Train Loss: 0.199 Vali Loss: 0.649 Vali Acc: 0.761 Test Loss: 0.649 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.1960818767547607
Epoch: 14, Steps: 9 | Train Loss: 0.156 Vali Loss: 0.580 Vali Acc: 0.804 Test Loss: 0.580 Test Acc: 0.804
Validation loss decreased (-0.775355 --> -0.804342).  Saving model ...
Epoch: 15 cost time: 3.1774845123291016
Epoch: 15, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.563 Vali Acc: 0.797 Test Loss: 0.563 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.289155960083008
Epoch: 16, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.537 Vali Acc: 0.826 Test Loss: 0.537 Test Acc: 0.826
Validation loss decreased (-0.804342 --> -0.826082).  Saving model ...
Epoch: 17 cost time: 3.4273290634155273
Epoch: 17, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.524 Vali Acc: 0.819 Test Loss: 0.524 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.681710720062256
Epoch: 18, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.534 Vali Acc: 0.826 Test Loss: 0.534 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 19 cost time: 3.535212278366089
Epoch: 19, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.511 Vali Acc: 0.819 Test Loss: 0.511 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.748225688934326
Epoch: 20, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.495 Vali Acc: 0.826 Test Loss: 0.495 Test Acc: 0.826
Validation loss decreased (-0.826082 --> -0.826082).  Saving model ...
Epoch: 21 cost time: 3.496732711791992
Epoch: 21, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.486 Vali Acc: 0.841 Test Loss: 0.486 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840575).  Saving model ...
Epoch: 22 cost time: 3.744662046432495
Epoch: 22, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.475 Vali Acc: 0.833 Test Loss: 0.475 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.666339635848999
Epoch: 23, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.467 Vali Acc: 0.833 Test Loss: 0.467 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.3200361728668213
Epoch: 24, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.488 Vali Acc: 0.841 Test Loss: 0.488 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.3481454849243164
Epoch: 25, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.478 Vali Acc: 0.841 Test Loss: 0.478 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 26 cost time: 3.309211254119873
Epoch: 26, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.462 Vali Acc: 0.841 Test Loss: 0.462 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 27 cost time: 3.3278088569641113
Epoch: 27, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.463 Vali Acc: 0.841 Test Loss: 0.463 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.094118118286133
Epoch: 28, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.465 Vali Acc: 0.826 Test Loss: 0.465 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.314257860183716
Epoch: 29, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.455 Vali Acc: 0.833 Test Loss: 0.455 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.5887043476104736
Epoch: 30, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.464 Vali Acc: 0.841 Test Loss: 0.464 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.5469233989715576
Epoch: 31, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.472 Vali Acc: 0.841 Test Loss: 0.472 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.5062859058380127
Epoch: 32, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.463 Vali Acc: 0.841 Test Loss: 0.463 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.6690280437469482
Epoch: 33, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.458 Vali Acc: 0.833 Test Loss: 0.458 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.6088359355926514
Epoch: 34, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.449 Vali Acc: 0.841 Test Loss: 0.449 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 35 cost time: 3.4388670921325684
Epoch: 35, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.456 Vali Acc: 0.841 Test Loss: 0.456 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.3963515758514404
Epoch: 36, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.459 Vali Acc: 0.841 Test Loss: 0.459 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.601379871368408
Epoch: 37, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.458 Vali Acc: 0.833 Test Loss: 0.458 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.426363229751587
Epoch: 38, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.442 Vali Acc: 0.841 Test Loss: 0.442 Test Acc: 0.841
Validation loss decreased (-0.840575 --> -0.840575).  Saving model ...
Epoch: 39 cost time: 3.3651695251464844
Epoch: 39, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.443 Vali Acc: 0.841 Test Loss: 0.443 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.512263774871826
Epoch: 40, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.445 Vali Acc: 0.841 Test Loss: 0.445 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.503770589828491
Epoch: 41, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.440 Vali Acc: 0.848 Test Loss: 0.440 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847822).  Saving model ...
Epoch: 42 cost time: 3.6129977703094482
Epoch: 42, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.449 Vali Acc: 0.841 Test Loss: 0.449 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.5096473693847656
Epoch: 43, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.459 Vali Acc: 0.833 Test Loss: 0.459 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.746229887008667
Epoch: 44, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.455 Vali Acc: 0.833 Test Loss: 0.455 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.5923967361450195
Epoch: 45, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.440 Vali Acc: 0.841 Test Loss: 0.440 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 3.522810697555542
Epoch: 46, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.439 Vali Acc: 0.848 Test Loss: 0.439 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 47 cost time: 3.084231376647949
Epoch: 47, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.443 Vali Acc: 0.848 Test Loss: 0.443 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.0794167518615723
Epoch: 48, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.449 Vali Acc: 0.848 Test Loss: 0.449 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 3.037489175796509
Epoch: 49, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.444 Vali Acc: 0.848 Test Loss: 0.444 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 3.254807472229004
Epoch: 50, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.438 Vali Acc: 0.848 Test Loss: 0.438 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 51 cost time: 3.302456855773926
Epoch: 51, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.433 Vali Acc: 0.848 Test Loss: 0.433 Test Acc: 0.848
Validation loss decreased (-0.847822 --> -0.847822).  Saving model ...
Epoch: 52 cost time: 3.2274863719940186
Epoch: 52, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.440 Vali Acc: 0.848 Test Loss: 0.440 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 3.6879754066467285
Epoch: 53, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.450 Vali Acc: 0.841 Test Loss: 0.450 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 3.504936456680298
Epoch: 54, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.453 Vali Acc: 0.841 Test Loss: 0.453 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 3.6795358657836914
Epoch: 55, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.455 Vali Acc: 0.841 Test Loss: 0.455 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 3.4638333320617676
Epoch: 56, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.450 Vali Acc: 0.848 Test Loss: 0.450 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 3.5664098262786865
Epoch: 57, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.450 Vali Acc: 0.848 Test Loss: 0.450 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 3.649088144302368
Epoch: 58, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.454 Vali Acc: 0.833 Test Loss: 0.454 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 3.3425893783569336
Epoch: 59, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.455 Vali Acc: 0.841 Test Loss: 0.455 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 3.4263205528259277
Epoch: 60, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.453 Vali Acc: 0.841 Test Loss: 0.453 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 3.447362184524536
Epoch: 61, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.453 Vali Acc: 0.841 Test Loss: 0.453 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df128_ma11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 93764
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         7                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df128_ma7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.946493864059448
Epoch: 1, Steps: 9 | Train Loss: 1.440 Vali Loss: 1.361 Vali Acc: 0.333 Test Loss: 1.361 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 3.4567556381225586
Epoch: 2, Steps: 9 | Train Loss: 1.292 Vali Loss: 1.291 Vali Acc: 0.457 Test Loss: 1.291 Test Acc: 0.457
Validation loss decreased (-0.333320 --> -0.456509).  Saving model ...
Epoch: 3 cost time: 3.4660661220550537
Epoch: 3, Steps: 9 | Train Loss: 1.187 Vali Loss: 1.196 Vali Acc: 0.536 Test Loss: 1.196 Test Acc: 0.536
Validation loss decreased (-0.456509 --> -0.536220).  Saving model ...
Epoch: 4 cost time: 3.3144140243530273
Epoch: 4, Steps: 9 | Train Loss: 1.031 Vali Loss: 1.108 Vali Acc: 0.580 Test Loss: 1.108 Test Acc: 0.580
Validation loss decreased (-0.536220 --> -0.579699).  Saving model ...
Epoch: 5 cost time: 3.5785882472991943
Epoch: 5, Steps: 9 | Train Loss: 0.908 Vali Loss: 1.033 Vali Acc: 0.594 Test Loss: 1.033 Test Acc: 0.594
Validation loss decreased (-0.579699 --> -0.594193).  Saving model ...
Epoch: 6 cost time: 3.4382481575012207
Epoch: 6, Steps: 9 | Train Loss: 0.765 Vali Loss: 0.955 Vali Acc: 0.623 Test Loss: 0.955 Test Acc: 0.623
Validation loss decreased (-0.594193 --> -0.623179).  Saving model ...
Epoch: 7 cost time: 3.491115093231201
Epoch: 7, Steps: 9 | Train Loss: 0.640 Vali Loss: 0.905 Vali Acc: 0.659 Test Loss: 0.905 Test Acc: 0.659
Validation loss decreased (-0.623179 --> -0.659411).  Saving model ...
Epoch: 8 cost time: 3.328240394592285
Epoch: 8, Steps: 9 | Train Loss: 0.545 Vali Loss: 0.844 Vali Acc: 0.688 Test Loss: 0.844 Test Acc: 0.688
Validation loss decreased (-0.659411 --> -0.688397).  Saving model ...
Epoch: 9 cost time: 3.241553544998169
Epoch: 9, Steps: 9 | Train Loss: 0.421 Vali Loss: 0.810 Vali Acc: 0.688 Test Loss: 0.810 Test Acc: 0.688
Validation loss decreased (-0.688397 --> -0.688398).  Saving model ...
Epoch: 10 cost time: 3.0288662910461426
Epoch: 10, Steps: 9 | Train Loss: 0.350 Vali Loss: 0.779 Vali Acc: 0.696 Test Loss: 0.779 Test Acc: 0.696
Validation loss decreased (-0.688398 --> -0.695644).  Saving model ...
Epoch: 11 cost time: 3.1216986179351807
Epoch: 11, Steps: 9 | Train Loss: 0.283 Vali Loss: 0.736 Vali Acc: 0.710 Test Loss: 0.736 Test Acc: 0.710
Validation loss decreased (-0.695644 --> -0.710138).  Saving model ...
Epoch: 12 cost time: 3.039879083633423
Epoch: 12, Steps: 9 | Train Loss: 0.240 Vali Loss: 0.748 Vali Acc: 0.703 Test Loss: 0.748 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.14676570892334
Epoch: 13, Steps: 9 | Train Loss: 0.183 Vali Loss: 0.711 Vali Acc: 0.696 Test Loss: 0.711 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.1655657291412354
Epoch: 14, Steps: 9 | Train Loss: 0.151 Vali Loss: 0.691 Vali Acc: 0.717 Test Loss: 0.691 Test Acc: 0.717
Validation loss decreased (-0.710138 --> -0.717384).  Saving model ...
Epoch: 15 cost time: 3.362576484680176
Epoch: 15, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.678 Vali Acc: 0.717 Test Loss: 0.678 Test Acc: 0.717
Validation loss decreased (-0.717384 --> -0.717385).  Saving model ...
Epoch: 16 cost time: 3.1428301334381104
Epoch: 16, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.671 Vali Acc: 0.739 Test Loss: 0.671 Test Acc: 0.739
Validation loss decreased (-0.717385 --> -0.739124).  Saving model ...
Epoch: 17 cost time: 3.5344600677490234
Epoch: 17, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.664 Vali Acc: 0.725 Test Loss: 0.664 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.2411386966705322
Epoch: 18, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.677 Vali Acc: 0.725 Test Loss: 0.677 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.144721269607544
Epoch: 19, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.665 Vali Acc: 0.732 Test Loss: 0.665 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.9329681396484375
Epoch: 20, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.667 Vali Acc: 0.739 Test Loss: 0.667 Test Acc: 0.739
Validation loss decreased (-0.739124 --> -0.739124).  Saving model ...
Epoch: 21 cost time: 2.946791648864746
Epoch: 21, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.668 Vali Acc: 0.739 Test Loss: 0.668 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.300930976867676
Epoch: 22, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.662 Vali Acc: 0.746 Test Loss: 0.662 Test Acc: 0.746
Validation loss decreased (-0.739124 --> -0.746370).  Saving model ...
Epoch: 23 cost time: 3.3035542964935303
Epoch: 23, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.659 Vali Acc: 0.761 Test Loss: 0.659 Test Acc: 0.761
Validation loss decreased (-0.746370 --> -0.760863).  Saving model ...
Epoch: 24 cost time: 3.1241531372070312
Epoch: 24, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.663 Vali Acc: 0.761 Test Loss: 0.663 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.472323179244995
Epoch: 25, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.680 Vali Acc: 0.754 Test Loss: 0.680 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.381336212158203
Epoch: 26, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.687 Vali Acc: 0.754 Test Loss: 0.687 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.7128360271453857
Epoch: 27, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.689 Vali Acc: 0.754 Test Loss: 0.689 Test Acc: 0.754
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.3925559520721436
Epoch: 28, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.671 Vali Acc: 0.761 Test Loss: 0.671 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.310265064239502
Epoch: 29, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.661 Vali Acc: 0.761 Test Loss: 0.661 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.490987777709961
Epoch: 30, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.675 Vali Acc: 0.754 Test Loss: 0.675 Test Acc: 0.754
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 3.5723512172698975
Epoch: 31, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.687 Vali Acc: 0.761 Test Loss: 0.687 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.0266525745391846
Epoch: 32, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.693 Vali Acc: 0.761 Test Loss: 0.693 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.1917309761047363
Epoch: 33, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.681 Vali Acc: 0.754 Test Loss: 0.681 Test Acc: 0.754
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df128_ma7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7608695652173914
model parameter : 93764
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.5118727684021
Epoch: 1, Steps: 9 | Train Loss: 1.459 Vali Loss: 1.424 Vali Acc: 0.297 Test Loss: 1.424 Test Acc: 0.297
Validation loss decreased (inf --> -0.297087).  Saving model ...
Epoch: 2 cost time: 2.992053508758545
Epoch: 2, Steps: 9 | Train Loss: 1.358 Vali Loss: 1.410 Vali Acc: 0.319 Test Loss: 1.410 Test Acc: 0.319
Validation loss decreased (-0.297087 --> -0.318826).  Saving model ...
Epoch: 3 cost time: 3.3353681564331055
Epoch: 3, Steps: 9 | Train Loss: 1.297 Vali Loss: 1.386 Vali Acc: 0.297 Test Loss: 1.386 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.2353007793426514
Epoch: 4, Steps: 9 | Train Loss: 1.187 Vali Loss: 1.354 Vali Acc: 0.399 Test Loss: 1.354 Test Acc: 0.399
Validation loss decreased (-0.318826 --> -0.398537).  Saving model ...
Epoch: 5 cost time: 3.266951560974121
Epoch: 5, Steps: 9 | Train Loss: 1.084 Vali Loss: 1.330 Vali Acc: 0.384 Test Loss: 1.330 Test Acc: 0.384
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.264204740524292
Epoch: 6, Steps: 9 | Train Loss: 0.959 Vali Loss: 1.298 Vali Acc: 0.384 Test Loss: 1.298 Test Acc: 0.384
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.255434513092041
Epoch: 7, Steps: 9 | Train Loss: 0.889 Vali Loss: 1.275 Vali Acc: 0.406 Test Loss: 1.275 Test Acc: 0.406
Validation loss decreased (-0.398537 --> -0.405784).  Saving model ...
Epoch: 8 cost time: 3.1649515628814697
Epoch: 8, Steps: 9 | Train Loss: 0.774 Vali Loss: 1.255 Vali Acc: 0.406 Test Loss: 1.255 Test Acc: 0.406
Validation loss decreased (-0.405784 --> -0.405785).  Saving model ...
Epoch: 9 cost time: 2.8725554943084717
Epoch: 9, Steps: 9 | Train Loss: 0.667 Vali Loss: 1.256 Vali Acc: 0.406 Test Loss: 1.256 Test Acc: 0.406
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9269983768463135
Epoch: 10, Steps: 9 | Train Loss: 0.576 Vali Loss: 1.236 Vali Acc: 0.413 Test Loss: 1.236 Test Acc: 0.413
Validation loss decreased (-0.405785 --> -0.413031).  Saving model ...
Epoch: 11 cost time: 2.9764702320098877
Epoch: 11, Steps: 9 | Train Loss: 0.478 Vali Loss: 1.217 Vali Acc: 0.413 Test Loss: 1.217 Test Acc: 0.413
Validation loss decreased (-0.413031 --> -0.413031).  Saving model ...
Epoch: 12 cost time: 3.07551646232605
Epoch: 12, Steps: 9 | Train Loss: 0.431 Vali Loss: 1.188 Vali Acc: 0.435 Test Loss: 1.188 Test Acc: 0.435
Validation loss decreased (-0.413031 --> -0.434771).  Saving model ...
Epoch: 13 cost time: 3.1103975772857666
Epoch: 13, Steps: 9 | Train Loss: 0.347 Vali Loss: 1.212 Vali Acc: 0.449 Test Loss: 1.212 Test Acc: 0.449
Validation loss decreased (-0.434771 --> -0.449263).  Saving model ...
Epoch: 14 cost time: 3.0816190242767334
Epoch: 14, Steps: 9 | Train Loss: 0.283 Vali Loss: 1.212 Vali Acc: 0.449 Test Loss: 1.212 Test Acc: 0.449
Validation loss decreased (-0.449263 --> -0.449263).  Saving model ...
Epoch: 15 cost time: 3.1155428886413574
Epoch: 15, Steps: 9 | Train Loss: 0.247 Vali Loss: 1.243 Vali Acc: 0.449 Test Loss: 1.243 Test Acc: 0.449
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.3504843711853027
Epoch: 16, Steps: 9 | Train Loss: 0.206 Vali Loss: 1.250 Vali Acc: 0.471 Test Loss: 1.250 Test Acc: 0.471
Validation loss decreased (-0.449263 --> -0.471002).  Saving model ...
Epoch: 17 cost time: 3.2755115032196045
Epoch: 17, Steps: 9 | Train Loss: 0.164 Vali Loss: 1.291 Vali Acc: 0.435 Test Loss: 1.291 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.2992188930511475
Epoch: 18, Steps: 9 | Train Loss: 0.153 Vali Loss: 1.293 Vali Acc: 0.435 Test Loss: 1.293 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.298034191131592
Epoch: 19, Steps: 9 | Train Loss: 0.111 Vali Loss: 1.265 Vali Acc: 0.435 Test Loss: 1.265 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.433349370956421
Epoch: 20, Steps: 9 | Train Loss: 0.098 Vali Loss: 1.326 Vali Acc: 0.442 Test Loss: 1.326 Test Acc: 0.442
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.349694013595581
Epoch: 21, Steps: 9 | Train Loss: 0.080 Vali Loss: 1.330 Vali Acc: 0.428 Test Loss: 1.330 Test Acc: 0.428
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.2188210487365723
Epoch: 22, Steps: 9 | Train Loss: 0.079 Vali Loss: 1.293 Vali Acc: 0.449 Test Loss: 1.293 Test Acc: 0.449
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.305482864379883
Epoch: 23, Steps: 9 | Train Loss: 0.065 Vali Loss: 1.348 Vali Acc: 0.442 Test Loss: 1.348 Test Acc: 0.442
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.2654781341552734
Epoch: 24, Steps: 9 | Train Loss: 0.057 Vali Loss: 1.386 Vali Acc: 0.435 Test Loss: 1.386 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.185281276702881
Epoch: 25, Steps: 9 | Train Loss: 0.047 Vali Loss: 1.332 Vali Acc: 0.464 Test Loss: 1.332 Test Acc: 0.464
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.042776107788086
Epoch: 26, Steps: 9 | Train Loss: 0.044 Vali Loss: 1.325 Vali Acc: 0.464 Test Loss: 1.325 Test Acc: 0.464
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.47101449275362317
model parameter : 93764
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.104343891143799
Epoch: 1, Steps: 9 | Train Loss: 1.440 Vali Loss: 1.465 Vali Acc: 0.159 Test Loss: 1.465 Test Acc: 0.159
Validation loss decreased (inf --> -0.159406).  Saving model ...
Epoch: 2 cost time: 3.4211089611053467
Epoch: 2, Steps: 9 | Train Loss: 1.422 Vali Loss: 1.468 Vali Acc: 0.203 Test Loss: 1.468 Test Acc: 0.203
Validation loss decreased (-0.159406 --> -0.202884).  Saving model ...
Epoch: 3 cost time: 3.586982011795044
Epoch: 3, Steps: 9 | Train Loss: 1.343 Vali Loss: 1.473 Vali Acc: 0.232 Test Loss: 1.473 Test Acc: 0.232
Validation loss decreased (-0.202884 --> -0.231869).  Saving model ...
Epoch: 4 cost time: 3.2834181785583496
Epoch: 4, Steps: 9 | Train Loss: 1.280 Vali Loss: 1.476 Vali Acc: 0.261 Test Loss: 1.476 Test Acc: 0.261
Validation loss decreased (-0.231869 --> -0.260855).  Saving model ...
Epoch: 5 cost time: 3.371861219406128
Epoch: 5, Steps: 9 | Train Loss: 1.215 Vali Loss: 1.468 Vali Acc: 0.239 Test Loss: 1.468 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.074317693710327
Epoch: 6, Steps: 9 | Train Loss: 1.129 Vali Loss: 1.467 Vali Acc: 0.268 Test Loss: 1.467 Test Acc: 0.268
Validation loss decreased (-0.260855 --> -0.268101).  Saving model ...
Epoch: 7 cost time: 3.290144920349121
Epoch: 7, Steps: 9 | Train Loss: 1.091 Vali Loss: 1.463 Vali Acc: 0.268 Test Loss: 1.463 Test Acc: 0.268
Validation loss decreased (-0.268101 --> -0.268101).  Saving model ...
Epoch: 8 cost time: 3.0546975135803223
Epoch: 8, Steps: 9 | Train Loss: 1.032 Vali Loss: 1.484 Vali Acc: 0.268 Test Loss: 1.484 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.319074869155884
Epoch: 9, Steps: 9 | Train Loss: 0.933 Vali Loss: 1.559 Vali Acc: 0.261 Test Loss: 1.559 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.0010039806365967
Epoch: 10, Steps: 9 | Train Loss: 0.860 Vali Loss: 1.559 Vali Acc: 0.290 Test Loss: 1.559 Test Acc: 0.290
Validation loss decreased (-0.268101 --> -0.289839).  Saving model ...
Epoch: 11 cost time: 3.1989543437957764
Epoch: 11, Steps: 9 | Train Loss: 0.758 Vali Loss: 1.612 Vali Acc: 0.268 Test Loss: 1.612 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.3093039989471436
Epoch: 12, Steps: 9 | Train Loss: 0.673 Vali Loss: 1.617 Vali Acc: 0.283 Test Loss: 1.617 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.2521889209747314
Epoch: 13, Steps: 9 | Train Loss: 0.592 Vali Loss: 1.748 Vali Acc: 0.312 Test Loss: 1.748 Test Acc: 0.312
Validation loss decreased (-0.289839 --> -0.311577).  Saving model ...
Epoch: 14 cost time: 3.1666371822357178
Epoch: 14, Steps: 9 | Train Loss: 0.544 Vali Loss: 1.857 Vali Acc: 0.268 Test Loss: 1.857 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.5128121376037598
Epoch: 15, Steps: 9 | Train Loss: 0.471 Vali Loss: 1.884 Vali Acc: 0.312 Test Loss: 1.884 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.3739044666290283
Epoch: 16, Steps: 9 | Train Loss: 0.398 Vali Loss: 1.999 Vali Acc: 0.312 Test Loss: 1.999 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.462739944458008
Epoch: 17, Steps: 9 | Train Loss: 0.350 Vali Loss: 2.220 Vali Acc: 0.304 Test Loss: 2.220 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.265819787979126
Epoch: 18, Steps: 9 | Train Loss: 0.303 Vali Loss: 2.289 Vali Acc: 0.297 Test Loss: 2.289 Test Acc: 0.297
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.197566270828247
Epoch: 19, Steps: 9 | Train Loss: 0.259 Vali Loss: 2.245 Vali Acc: 0.304 Test Loss: 2.245 Test Acc: 0.304
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.1724021434783936
Epoch: 20, Steps: 9 | Train Loss: 0.235 Vali Loss: 2.472 Vali Acc: 0.319 Test Loss: 2.472 Test Acc: 0.319
Validation loss decreased (-0.311577 --> -0.318816).  Saving model ...
Epoch: 21 cost time: 3.239626884460449
Epoch: 21, Steps: 9 | Train Loss: 0.184 Vali Loss: 2.507 Vali Acc: 0.312 Test Loss: 2.507 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.2829039096832275
Epoch: 22, Steps: 9 | Train Loss: 0.146 Vali Loss: 2.455 Vali Acc: 0.333 Test Loss: 2.455 Test Acc: 0.333
Validation loss decreased (-0.318816 --> -0.333309).  Saving model ...
Epoch: 23 cost time: 3.266765594482422
Epoch: 23, Steps: 9 | Train Loss: 0.124 Vali Loss: 2.562 Vali Acc: 0.304 Test Loss: 2.562 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.367703437805176
Epoch: 24, Steps: 9 | Train Loss: 0.121 Vali Loss: 2.556 Vali Acc: 0.326 Test Loss: 2.556 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.3289682865142822
Epoch: 25, Steps: 9 | Train Loss: 0.093 Vali Loss: 2.553 Vali Acc: 0.319 Test Loss: 2.553 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.505117654800415
Epoch: 26, Steps: 9 | Train Loss: 0.077 Vali Loss: 2.522 Vali Acc: 0.333 Test Loss: 2.522 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.5926566123962402
Epoch: 27, Steps: 9 | Train Loss: 0.077 Vali Loss: 2.500 Vali Acc: 0.326 Test Loss: 2.500 Test Acc: 0.326
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.511000394821167
Epoch: 28, Steps: 9 | Train Loss: 0.081 Vali Loss: 2.616 Vali Acc: 0.312 Test Loss: 2.616 Test Acc: 0.312
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.535280227661133
Epoch: 29, Steps: 9 | Train Loss: 0.067 Vali Loss: 2.463 Vali Acc: 0.326 Test Loss: 2.463 Test Acc: 0.326
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.210411548614502
Epoch: 30, Steps: 9 | Train Loss: 0.055 Vali Loss: 2.347 Vali Acc: 0.319 Test Loss: 2.347 Test Acc: 0.319
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.3549578189849854
Epoch: 31, Steps: 9 | Train Loss: 0.045 Vali Loss: 2.504 Vali Acc: 0.326 Test Loss: 2.504 Test Acc: 0.326
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.0285263061523438
Epoch: 32, Steps: 9 | Train Loss: 0.052 Vali Loss: 2.481 Vali Acc: 0.348 Test Loss: 2.481 Test Acc: 0.348
Validation loss decreased (-0.333309 --> -0.347801).  Saving model ...
Epoch: 33 cost time: 3.284663677215576
Epoch: 33, Steps: 9 | Train Loss: 0.048 Vali Loss: 2.437 Vali Acc: 0.348 Test Loss: 2.437 Test Acc: 0.348
Validation loss decreased (-0.347801 --> -0.347802).  Saving model ...
Epoch: 34 cost time: 3.2220101356506348
Epoch: 34, Steps: 9 | Train Loss: 0.032 Vali Loss: 2.417 Vali Acc: 0.341 Test Loss: 2.417 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.3918116092681885
Epoch: 35, Steps: 9 | Train Loss: 0.029 Vali Loss: 2.483 Vali Acc: 0.333 Test Loss: 2.483 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.2564120292663574
Epoch: 36, Steps: 9 | Train Loss: 0.033 Vali Loss: 2.376 Vali Acc: 0.348 Test Loss: 2.376 Test Acc: 0.348
Validation loss decreased (-0.347802 --> -0.347802).  Saving model ...
Epoch: 37 cost time: 3.2218551635742188
Epoch: 37, Steps: 9 | Train Loss: 0.031 Vali Loss: 2.324 Vali Acc: 0.362 Test Loss: 2.324 Test Acc: 0.362
Validation loss decreased (-0.347802 --> -0.362296).  Saving model ...
Epoch: 38 cost time: 3.278754472732544
Epoch: 38, Steps: 9 | Train Loss: 0.023 Vali Loss: 2.283 Vali Acc: 0.362 Test Loss: 2.283 Test Acc: 0.362
Validation loss decreased (-0.362296 --> -0.362296).  Saving model ...
Epoch: 39 cost time: 3.282513380050659
Epoch: 39, Steps: 9 | Train Loss: 0.023 Vali Loss: 2.258 Vali Acc: 0.370 Test Loss: 2.258 Test Acc: 0.370
Validation loss decreased (-0.362296 --> -0.369543).  Saving model ...
Epoch: 40 cost time: 3.1650798320770264
Epoch: 40, Steps: 9 | Train Loss: 0.022 Vali Loss: 2.337 Vali Acc: 0.341 Test Loss: 2.337 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.0043716430664062
Epoch: 41, Steps: 9 | Train Loss: 0.019 Vali Loss: 2.411 Vali Acc: 0.370 Test Loss: 2.411 Test Acc: 0.370
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.062279224395752
Epoch: 42, Steps: 9 | Train Loss: 0.020 Vali Loss: 2.249 Vali Acc: 0.362 Test Loss: 2.249 Test Acc: 0.362
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.2697248458862305
Epoch: 43, Steps: 9 | Train Loss: 0.019 Vali Loss: 2.138 Vali Acc: 0.384 Test Loss: 2.138 Test Acc: 0.384
Validation loss decreased (-0.369543 --> -0.384037).  Saving model ...
Epoch: 44 cost time: 3.095529794692993
Epoch: 44, Steps: 9 | Train Loss: 0.018 Vali Loss: 2.352 Vali Acc: 0.377 Test Loss: 2.352 Test Acc: 0.377
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.1722805500030518
Epoch: 45, Steps: 9 | Train Loss: 0.013 Vali Loss: 2.463 Vali Acc: 0.370 Test Loss: 2.463 Test Acc: 0.370
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 3.260934352874756
Epoch: 46, Steps: 9 | Train Loss: 0.015 Vali Loss: 2.388 Vali Acc: 0.362 Test Loss: 2.388 Test Acc: 0.362
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 3.5021653175354004
Epoch: 47, Steps: 9 | Train Loss: 0.010 Vali Loss: 2.287 Vali Acc: 0.384 Test Loss: 2.287 Test Acc: 0.384
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 3.4089179039001465
Epoch: 48, Steps: 9 | Train Loss: 0.011 Vali Loss: 2.162 Vali Acc: 0.391 Test Loss: 2.162 Test Acc: 0.391
Validation loss decreased (-0.384037 --> -0.391283).  Saving model ...
Epoch: 49 cost time: 4.016082763671875
Epoch: 49, Steps: 9 | Train Loss: 0.012 Vali Loss: 2.173 Vali Acc: 0.399 Test Loss: 2.173 Test Acc: 0.399
Validation loss decreased (-0.391283 --> -0.398529).  Saving model ...
Epoch: 50 cost time: 3.474320888519287
Epoch: 50, Steps: 9 | Train Loss: 0.010 Vali Loss: 2.202 Vali Acc: 0.384 Test Loss: 2.202 Test Acc: 0.384
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 3.3896729946136475
Epoch: 51, Steps: 9 | Train Loss: 0.009 Vali Loss: 2.256 Vali Acc: 0.391 Test Loss: 2.256 Test Acc: 0.391
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 3.4811840057373047
Epoch: 52, Steps: 9 | Train Loss: 0.012 Vali Loss: 2.238 Vali Acc: 0.391 Test Loss: 2.238 Test Acc: 0.391
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 3.5757312774658203
Epoch: 53, Steps: 9 | Train Loss: 0.010 Vali Loss: 2.209 Vali Acc: 0.399 Test Loss: 2.209 Test Acc: 0.399
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 3.407733678817749
Epoch: 54, Steps: 9 | Train Loss: 0.011 Vali Loss: 2.188 Vali Acc: 0.399 Test Loss: 2.188 Test Acc: 0.399
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 3.4389584064483643
Epoch: 55, Steps: 9 | Train Loss: 0.007 Vali Loss: 2.177 Vali Acc: 0.391 Test Loss: 2.177 Test Acc: 0.391
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 3.2667994499206543
Epoch: 56, Steps: 9 | Train Loss: 0.008 Vali Loss: 2.219 Vali Acc: 0.391 Test Loss: 2.219 Test Acc: 0.391
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 3.248478412628174
Epoch: 57, Steps: 9 | Train Loss: 0.007 Vali Loss: 2.203 Vali Acc: 0.399 Test Loss: 2.203 Test Acc: 0.399
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 3.195974826812744
Epoch: 58, Steps: 9 | Train Loss: 0.008 Vali Loss: 2.208 Vali Acc: 0.413 Test Loss: 2.208 Test Acc: 0.413
Validation loss decreased (-0.398529 --> -0.413021).  Saving model ...
Epoch: 59 cost time: 3.3996737003326416
Epoch: 59, Steps: 9 | Train Loss: 0.006 Vali Loss: 2.180 Vali Acc: 0.442 Test Loss: 2.180 Test Acc: 0.442
Validation loss decreased (-0.413021 --> -0.442007).  Saving model ...
Epoch: 60 cost time: 3.498748779296875
Epoch: 60, Steps: 9 | Train Loss: 0.007 Vali Loss: 2.193 Vali Acc: 0.420 Test Loss: 2.193 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 3.483975648880005
Epoch: 61, Steps: 9 | Train Loss: 0.006 Vali Loss: 2.182 Vali Acc: 0.406 Test Loss: 2.182 Test Acc: 0.406
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 3.395843029022217
Epoch: 62, Steps: 9 | Train Loss: 0.005 Vali Loss: 2.194 Vali Acc: 0.399 Test Loss: 2.194 Test Acc: 0.399
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 3.4757180213928223
Epoch: 63, Steps: 9 | Train Loss: 0.005 Vali Loss: 2.158 Vali Acc: 0.420 Test Loss: 2.158 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 3.412388324737549
Epoch: 64, Steps: 9 | Train Loss: 0.005 Vali Loss: 2.152 Vali Acc: 0.420 Test Loss: 2.152 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 3.042970895767212
Epoch: 65, Steps: 9 | Train Loss: 0.004 Vali Loss: 2.158 Vali Acc: 0.428 Test Loss: 2.158 Test Acc: 0.428
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 3.330146074295044
Epoch: 66, Steps: 9 | Train Loss: 0.008 Vali Loss: 2.249 Vali Acc: 0.399 Test Loss: 2.249 Test Acc: 0.399
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 2.9601023197174072
Epoch: 67, Steps: 9 | Train Loss: 0.004 Vali Loss: 2.277 Vali Acc: 0.391 Test Loss: 2.277 Test Acc: 0.391
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 2.972877264022827
Epoch: 68, Steps: 9 | Train Loss: 0.005 Vali Loss: 2.178 Vali Acc: 0.413 Test Loss: 2.178 Test Acc: 0.413
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 3.0259389877319336
Epoch: 69, Steps: 9 | Train Loss: 0.004 Vali Loss: 2.169 Vali Acc: 0.428 Test Loss: 2.169 Test Acc: 0.428
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.4420289855072464
model parameter : 93764
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
fourier enhanced block used!
modes=32, index=[2, 3, 4, 6, 8, 13, 22, 23, 28, 30, 32, 34, 35, 37, 46, 47, 58, 60, 61, 64, 67, 69, 76, 77, 78, 80, 82, 92, 96, 98, 99, 100]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 17, 18, 20, 21, 22, 23, 27, 28, 29, 30, 31, 34, 35, 37, 40, 44, 47, 48, 50]
 fourier enhanced cross attention used!
modes_q=32, index_q=[0, 1, 6, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 29, 30, 32, 33, 34, 35, 38, 39, 40, 41, 42, 45, 47]
modes_kv=32, index_kv=[5, 9, 12, 16, 21, 22, 23, 25, 28, 30, 40, 41, 42, 56, 58, 60, 63, 64, 65, 66, 68, 71, 74, 76, 79, 80, 81, 84, 85, 88, 95, 102]
>>>>>>>start training : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.557245969772339
Epoch: 1, Steps: 9 | Train Loss: 1.455 Vali Loss: 1.438 Vali Acc: 0.261 Test Loss: 1.438 Test Acc: 0.261
Validation loss decreased (inf --> -0.260855).  Saving model ...
Epoch: 2 cost time: 3.6702072620391846
Epoch: 2, Steps: 9 | Train Loss: 1.343 Vali Loss: 1.438 Vali Acc: 0.261 Test Loss: 1.438 Test Acc: 0.261
Validation loss decreased (-0.260855 --> -0.260855).  Saving model ...
Epoch: 3 cost time: 3.5554239749908447
Epoch: 3, Steps: 9 | Train Loss: 1.359 Vali Loss: 1.435 Vali Acc: 0.254 Test Loss: 1.435 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.3355729579925537
Epoch: 4, Steps: 9 | Train Loss: 1.279 Vali Loss: 1.424 Vali Acc: 0.268 Test Loss: 1.424 Test Acc: 0.268
Validation loss decreased (-0.260855 --> -0.268102).  Saving model ...
Epoch: 5 cost time: 3.3509442806243896
Epoch: 5, Steps: 9 | Train Loss: 1.184 Vali Loss: 1.419 Vali Acc: 0.290 Test Loss: 1.419 Test Acc: 0.290
Validation loss decreased (-0.268102 --> -0.289841).  Saving model ...
Epoch: 6 cost time: 3.1870317459106445
Epoch: 6, Steps: 9 | Train Loss: 1.141 Vali Loss: 1.402 Vali Acc: 0.283 Test Loss: 1.402 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.3168866634368896
Epoch: 7, Steps: 9 | Train Loss: 1.055 Vali Loss: 1.387 Vali Acc: 0.312 Test Loss: 1.387 Test Acc: 0.312
Validation loss decreased (-0.289841 --> -0.311580).  Saving model ...
Epoch: 8 cost time: 3.5108261108398438
Epoch: 8, Steps: 9 | Train Loss: 0.960 Vali Loss: 1.382 Vali Acc: 0.319 Test Loss: 1.382 Test Acc: 0.319
Validation loss decreased (-0.311580 --> -0.318827).  Saving model ...
Epoch: 9 cost time: 3.1201977729797363
Epoch: 9, Steps: 9 | Train Loss: 0.863 Vali Loss: 1.418 Vali Acc: 0.319 Test Loss: 1.418 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.1572983264923096
Epoch: 10, Steps: 9 | Train Loss: 0.785 Vali Loss: 1.407 Vali Acc: 0.319 Test Loss: 1.407 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.3858535289764404
Epoch: 11, Steps: 9 | Train Loss: 0.695 Vali Loss: 1.413 Vali Acc: 0.341 Test Loss: 1.413 Test Acc: 0.341
Validation loss decreased (-0.318827 --> -0.340566).  Saving model ...
Epoch: 12 cost time: 3.715961456298828
Epoch: 12, Steps: 9 | Train Loss: 0.621 Vali Loss: 1.372 Vali Acc: 0.333 Test Loss: 1.372 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.715480327606201
Epoch: 13, Steps: 9 | Train Loss: 0.541 Vali Loss: 1.447 Vali Acc: 0.326 Test Loss: 1.447 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.372425079345703
Epoch: 14, Steps: 9 | Train Loss: 0.490 Vali Loss: 1.499 Vali Acc: 0.319 Test Loss: 1.499 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.198845624923706
Epoch: 15, Steps: 9 | Train Loss: 0.414 Vali Loss: 1.511 Vali Acc: 0.326 Test Loss: 1.511 Test Acc: 0.326
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.2198851108551025
Epoch: 16, Steps: 9 | Train Loss: 0.344 Vali Loss: 1.506 Vali Acc: 0.319 Test Loss: 1.506 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.231424331665039
Epoch: 17, Steps: 9 | Train Loss: 0.304 Vali Loss: 1.618 Vali Acc: 0.341 Test Loss: 1.618 Test Acc: 0.341
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.8868346214294434
Epoch: 18, Steps: 9 | Train Loss: 0.239 Vali Loss: 1.720 Vali Acc: 0.333 Test Loss: 1.720 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.3717384338378906
Epoch: 19, Steps: 9 | Train Loss: 0.199 Vali Loss: 1.621 Vali Acc: 0.355 Test Loss: 1.621 Test Acc: 0.355
Validation loss decreased (-0.340566 --> -0.355056).  Saving model ...
Epoch: 20 cost time: 3.281712770462036
Epoch: 20, Steps: 9 | Train Loss: 0.185 Vali Loss: 1.784 Vali Acc: 0.341 Test Loss: 1.784 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.423175573348999
Epoch: 21, Steps: 9 | Train Loss: 0.156 Vali Loss: 1.847 Vali Acc: 0.348 Test Loss: 1.847 Test Acc: 0.348
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.314730167388916
Epoch: 22, Steps: 9 | Train Loss: 0.111 Vali Loss: 1.700 Vali Acc: 0.362 Test Loss: 1.700 Test Acc: 0.362
Validation loss decreased (-0.355056 --> -0.362302).  Saving model ...
Epoch: 23 cost time: 3.327207326889038
Epoch: 23, Steps: 9 | Train Loss: 0.098 Vali Loss: 1.729 Vali Acc: 0.370 Test Loss: 1.729 Test Acc: 0.370
Validation loss decreased (-0.362302 --> -0.369548).  Saving model ...
Epoch: 24 cost time: 3.5689220428466797
Epoch: 24, Steps: 9 | Train Loss: 0.094 Vali Loss: 1.817 Vali Acc: 0.370 Test Loss: 1.817 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.50138521194458
Epoch: 25, Steps: 9 | Train Loss: 0.072 Vali Loss: 1.761 Vali Acc: 0.355 Test Loss: 1.761 Test Acc: 0.355
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.903947591781616
Epoch: 26, Steps: 9 | Train Loss: 0.057 Vali Loss: 1.729 Vali Acc: 0.348 Test Loss: 1.729 Test Acc: 0.348
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.5931756496429443
Epoch: 27, Steps: 9 | Train Loss: 0.060 Vali Loss: 1.719 Vali Acc: 0.355 Test Loss: 1.719 Test Acc: 0.355
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.6177706718444824
Epoch: 28, Steps: 9 | Train Loss: 0.057 Vali Loss: 1.812 Vali Acc: 0.370 Test Loss: 1.812 Test Acc: 0.370
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 4.383749008178711
Epoch: 29, Steps: 9 | Train Loss: 0.055 Vali Loss: 1.789 Vali Acc: 0.362 Test Loss: 1.789 Test Acc: 0.362
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 4.080583095550537
Epoch: 30, Steps: 9 | Train Loss: 0.039 Vali Loss: 1.652 Vali Acc: 0.384 Test Loss: 1.652 Test Acc: 0.384
Validation loss decreased (-0.369548 --> -0.384041).  Saving model ...
Epoch: 31 cost time: 4.533709764480591
Epoch: 31, Steps: 9 | Train Loss: 0.034 Vali Loss: 1.671 Vali Acc: 0.377 Test Loss: 1.671 Test Acc: 0.377
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 4.199313640594482
Epoch: 32, Steps: 9 | Train Loss: 0.038 Vali Loss: 1.647 Vali Acc: 0.391 Test Loss: 1.647 Test Acc: 0.391
Validation loss decreased (-0.384041 --> -0.391288).  Saving model ...
Epoch: 33 cost time: 4.286271333694458
Epoch: 33, Steps: 9 | Train Loss: 0.038 Vali Loss: 1.646 Vali Acc: 0.399 Test Loss: 1.646 Test Acc: 0.399
Validation loss decreased (-0.391288 --> -0.398534).  Saving model ...
Epoch: 34 cost time: 3.9864425659179688
Epoch: 34, Steps: 9 | Train Loss: 0.022 Vali Loss: 1.622 Vali Acc: 0.377 Test Loss: 1.622 Test Acc: 0.377
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 4.289870977401733
Epoch: 35, Steps: 9 | Train Loss: 0.025 Vali Loss: 1.602 Vali Acc: 0.377 Test Loss: 1.602 Test Acc: 0.377
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 4.067245006561279
Epoch: 36, Steps: 9 | Train Loss: 0.023 Vali Loss: 1.572 Vali Acc: 0.391 Test Loss: 1.572 Test Acc: 0.391
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 4.236441612243652
Epoch: 37, Steps: 9 | Train Loss: 0.023 Vali Loss: 1.535 Vali Acc: 0.413 Test Loss: 1.535 Test Acc: 0.413
Validation loss decreased (-0.398534 --> -0.413028).  Saving model ...
Epoch: 38 cost time: 4.2468485832214355
Epoch: 38, Steps: 9 | Train Loss: 0.021 Vali Loss: 1.531 Vali Acc: 0.391 Test Loss: 1.531 Test Acc: 0.391
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 4.414980411529541
Epoch: 39, Steps: 9 | Train Loss: 0.016 Vali Loss: 1.470 Vali Acc: 0.420 Test Loss: 1.470 Test Acc: 0.420
Validation loss decreased (-0.413028 --> -0.420275).  Saving model ...
Epoch: 40 cost time: 4.420002222061157
Epoch: 40, Steps: 9 | Train Loss: 0.019 Vali Loss: 1.456 Vali Acc: 0.435 Test Loss: 1.456 Test Acc: 0.435
Validation loss decreased (-0.420275 --> -0.434768).  Saving model ...
Epoch: 41 cost time: 5.0281689167022705
Epoch: 41, Steps: 9 | Train Loss: 0.014 Vali Loss: 1.472 Vali Acc: 0.435 Test Loss: 1.472 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 4.304707288742065
Epoch: 42, Steps: 9 | Train Loss: 0.014 Vali Loss: 1.440 Vali Acc: 0.457 Test Loss: 1.440 Test Acc: 0.457
Validation loss decreased (-0.434768 --> -0.456507).  Saving model ...
Epoch: 43 cost time: 4.326874494552612
Epoch: 43, Steps: 9 | Train Loss: 0.013 Vali Loss: 1.424 Vali Acc: 0.449 Test Loss: 1.424 Test Acc: 0.449
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 4.325529336929321
Epoch: 44, Steps: 9 | Train Loss: 0.013 Vali Loss: 1.459 Vali Acc: 0.442 Test Loss: 1.459 Test Acc: 0.442
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 4.315217971801758
Epoch: 45, Steps: 9 | Train Loss: 0.012 Vali Loss: 1.487 Vali Acc: 0.457 Test Loss: 1.487 Test Acc: 0.457
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 4.127035856246948
Epoch: 46, Steps: 9 | Train Loss: 0.011 Vali Loss: 1.459 Vali Acc: 0.449 Test Loss: 1.459 Test Acc: 0.449
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 3.888077974319458
Epoch: 47, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.463 Vali Acc: 0.464 Test Loss: 1.463 Test Acc: 0.464
Validation loss decreased (-0.456507 --> -0.463753).  Saving model ...
Epoch: 48 cost time: 4.396622180938721
Epoch: 48, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.429 Vali Acc: 0.493 Test Loss: 1.429 Test Acc: 0.493
Validation loss decreased (-0.463753 --> -0.492739).  Saving model ...
Epoch: 49 cost time: 4.8575921058654785
Epoch: 49, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.412 Vali Acc: 0.507 Test Loss: 1.412 Test Acc: 0.507
Validation loss decreased (-0.492739 --> -0.507232).  Saving model ...
Epoch: 50 cost time: 4.762115478515625
Epoch: 50, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.409 Vali Acc: 0.500 Test Loss: 1.409 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 4.3921778202056885
Epoch: 51, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.401 Vali Acc: 0.486 Test Loss: 1.401 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 5.54914665222168
Epoch: 52, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.407 Vali Acc: 0.486 Test Loss: 1.407 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 5.11849045753479
Epoch: 53, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.407 Vali Acc: 0.486 Test Loss: 1.407 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 5.00968337059021
Epoch: 54, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.410 Vali Acc: 0.493 Test Loss: 1.410 Test Acc: 0.493
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 5.083628416061401
Epoch: 55, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.390 Vali Acc: 0.486 Test Loss: 1.390 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 5.055762529373169
Epoch: 56, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.407 Vali Acc: 0.471 Test Loss: 1.407 Test Acc: 0.471
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 4.869521141052246
Epoch: 57, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.394 Vali Acc: 0.493 Test Loss: 1.394 Test Acc: 0.493
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 4.783987045288086
Epoch: 58, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.405 Vali Acc: 0.507 Test Loss: 1.405 Test Acc: 0.507
Validation loss decreased (-0.507232 --> -0.507232).  Saving model ...
Epoch: 59 cost time: 5.167438268661499
Epoch: 59, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.400 Vali Acc: 0.514 Test Loss: 1.400 Test Acc: 0.514
Validation loss decreased (-0.507232 --> -0.514479).  Saving model ...
Epoch: 60 cost time: 5.070742845535278
Epoch: 60, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.396 Vali Acc: 0.514 Test Loss: 1.396 Test Acc: 0.514
Validation loss decreased (-0.514479 --> -0.514479).  Saving model ...
Epoch: 61 cost time: 4.434900522232056
Epoch: 61, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.409 Vali Acc: 0.529 Test Loss: 1.409 Test Acc: 0.529
Validation loss decreased (-0.514479 --> -0.528971).  Saving model ...
Epoch: 62 cost time: 4.244816780090332
Epoch: 62, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.396 Vali Acc: 0.514 Test Loss: 1.396 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 4.591181755065918
Epoch: 63, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.374 Vali Acc: 0.522 Test Loss: 1.374 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 4.323419094085693
Epoch: 64, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.349 Vali Acc: 0.529 Test Loss: 1.349 Test Acc: 0.529
Validation loss decreased (-0.528971 --> -0.528972).  Saving model ...
Epoch: 65 cost time: 4.734281539916992
Epoch: 65, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.353 Vali Acc: 0.522 Test Loss: 1.353 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 4.842071771621704
Epoch: 66, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.363 Vali Acc: 0.514 Test Loss: 1.363 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 4.4192540645599365
Epoch: 67, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.369 Vali Acc: 0.536 Test Loss: 1.369 Test Acc: 0.536
Validation loss decreased (-0.528972 --> -0.536218).  Saving model ...
Epoch: 68 cost time: 4.43568229675293
Epoch: 68, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.350 Vali Acc: 0.529 Test Loss: 1.350 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 4.956676006317139
Epoch: 69, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.351 Vali Acc: 0.536 Test Loss: 1.351 Test Acc: 0.536
Validation loss decreased (-0.536218 --> -0.536218).  Saving model ...
Epoch: 70 cost time: 4.61059045791626
Epoch: 70, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.372 Vali Acc: 0.514 Test Loss: 1.372 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 4.901360034942627
Epoch: 71, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.366 Vali Acc: 0.514 Test Loss: 1.366 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 4.630459547042847
Epoch: 72, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.346 Vali Acc: 0.529 Test Loss: 1.346 Test Acc: 0.529
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 5.404963493347168
Epoch: 73, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.351 Vali Acc: 0.536 Test Loss: 1.351 Test Acc: 0.536
Validation loss decreased (-0.536218 --> -0.536218).  Saving model ...
Epoch: 74 cost time: 5.012933731079102
Epoch: 74, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.351 Vali Acc: 0.536 Test Loss: 1.351 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 4.9940855503082275
Epoch: 75, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.346 Vali Acc: 0.529 Test Loss: 1.346 Test Acc: 0.529
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 5.240250825881958
Epoch: 76, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.355 Vali Acc: 0.536 Test Loss: 1.355 Test Acc: 0.536
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 4.934776544570923
Epoch: 77, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.359 Vali Acc: 0.529 Test Loss: 1.359 Test Acc: 0.529
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 4.592556715011597
Epoch: 78, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.367 Vali Acc: 0.536 Test Loss: 1.367 Test Acc: 0.536
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 5.564387559890747
Epoch: 79, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.353 Vali Acc: 0.536 Test Loss: 1.353 Test Acc: 0.536
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 5.518912315368652
Epoch: 80, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.357 Vali Acc: 0.543 Test Loss: 1.357 Test Acc: 0.543
Validation loss decreased (-0.536218 --> -0.543465).  Saving model ...
Epoch: 81 cost time: 5.313719987869263
Epoch: 81, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.357 Vali Acc: 0.543 Test Loss: 1.357 Test Acc: 0.543
Validation loss decreased (-0.543465 --> -0.543465).  Saving model ...
Epoch: 82 cost time: 5.090348482131958
Epoch: 82, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.380 Vali Acc: 0.529 Test Loss: 1.380 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 4.7417213916778564
Epoch: 83, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.378 Vali Acc: 0.529 Test Loss: 1.378 Test Acc: 0.529
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 5.318445444107056
Epoch: 84, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.397 Vali Acc: 0.507 Test Loss: 1.397 Test Acc: 0.507
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 4.863515853881836
Epoch: 85, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.385 Vali Acc: 0.514 Test Loss: 1.385 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 4.816273927688599
Epoch: 86, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.371 Vali Acc: 0.529 Test Loss: 1.371 Test Acc: 0.529
EarlyStopping counter: 5 out of 10
Epoch: 87 cost time: 4.780666828155518
Epoch: 87, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.357 Vali Acc: 0.536 Test Loss: 1.357 Test Acc: 0.536
EarlyStopping counter: 6 out of 10
Epoch: 88 cost time: 4.99012565612793
Epoch: 88, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.352 Vali Acc: 0.551 Test Loss: 1.352 Test Acc: 0.551
Validation loss decreased (-0.543465 --> -0.550711).  Saving model ...
Epoch: 89 cost time: 5.557608366012573
Epoch: 89, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.338 Vali Acc: 0.543 Test Loss: 1.338 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 4.78128981590271
Epoch: 90, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.352 Vali Acc: 0.543 Test Loss: 1.352 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 5.608187675476074
Epoch: 91, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.374 Vali Acc: 0.551 Test Loss: 1.374 Test Acc: 0.551
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 5.069606304168701
Epoch: 92, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.376 Vali Acc: 0.558 Test Loss: 1.376 Test Acc: 0.558
Validation loss decreased (-0.550711 --> -0.557957).  Saving model ...
Epoch: 93 cost time: 5.101383209228516
Epoch: 93, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.384 Vali Acc: 0.551 Test Loss: 1.384 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 4.608151912689209
Epoch: 94, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.377 Vali Acc: 0.536 Test Loss: 1.377 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 5.56539511680603
Epoch: 95, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.373 Vali Acc: 0.536 Test Loss: 1.373 Test Acc: 0.536
EarlyStopping counter: 3 out of 10
Epoch: 96 cost time: 5.335179805755615
Epoch: 96, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.384 Vali Acc: 0.551 Test Loss: 1.384 Test Acc: 0.551
EarlyStopping counter: 4 out of 10
Epoch: 97 cost time: 5.290432453155518
Epoch: 97, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.385 Vali Acc: 0.551 Test Loss: 1.385 Test Acc: 0.551
EarlyStopping counter: 5 out of 10
Epoch: 98 cost time: 5.11568021774292
Epoch: 98, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.377 Vali Acc: 0.551 Test Loss: 1.377 Test Acc: 0.551
EarlyStopping counter: 6 out of 10
Epoch: 99 cost time: 5.536609888076782
Epoch: 99, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.363 Vali Acc: 0.551 Test Loss: 1.363 Test Acc: 0.551
EarlyStopping counter: 7 out of 10
Epoch: 100 cost time: 4.895745038986206
Epoch: 100, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.359 Vali Acc: 0.551 Test Loss: 1.359 Test Acc: 0.551
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_FEDformer_UEA_ftM_sl206_ll0_pl0_dm32_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.5579710144927537
model parameter : 93764
model size : 1.60MB
