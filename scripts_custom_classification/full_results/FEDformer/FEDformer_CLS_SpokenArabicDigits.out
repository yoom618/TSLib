Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         47                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0661394
	speed: 0.2956s/iter; left time: 12179.1750s
	iters: 200, epoch: 1 | loss: 0.6309752
	speed: 0.2855s/iter; left time: 11735.0590s
	iters: 300, epoch: 1 | loss: 0.0899168
	speed: 0.2899s/iter; left time: 11887.5334s
	iters: 400, epoch: 1 | loss: 0.0046759
	speed: 0.2876s/iter; left time: 11763.8171s
Epoch: 1 cost time: 119.53380942344666
Epoch: 1, Steps: 413 | Train Loss: 0.358 Vali Loss: 0.182 Vali Acc: 0.951 Test Loss: 0.182 Test Acc: 0.951
Validation loss decreased (inf --> -0.951340).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0214266
	speed: 0.5474s/iter; left time: 22327.6577s
	iters: 200, epoch: 2 | loss: 0.1562218
	speed: 0.2821s/iter; left time: 11477.3383s
	iters: 300, epoch: 2 | loss: 0.1659341
	speed: 0.3038s/iter; left time: 12328.8290s
	iters: 400, epoch: 2 | loss: 0.4855300
	speed: 0.2977s/iter; left time: 12051.5522s
Epoch: 2 cost time: 119.94116854667664
Epoch: 2, Steps: 413 | Train Loss: 0.275 Vali Loss: 0.288 Vali Acc: 0.936 Test Loss: 0.288 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0204893
	speed: 0.5958s/iter; left time: 24055.3976s
	iters: 200, epoch: 3 | loss: 0.2586626
	speed: 0.2937s/iter; left time: 11830.4197s
	iters: 300, epoch: 3 | loss: 0.0015036
	speed: 0.2911s/iter; left time: 11695.5392s
	iters: 400, epoch: 3 | loss: 2.5316126
	speed: 0.2796s/iter; left time: 11206.9110s
Epoch: 3 cost time: 120.40666723251343
Epoch: 3, Steps: 413 | Train Loss: 0.314 Vali Loss: 0.281 Vali Acc: 0.965 Test Loss: 0.281 Test Acc: 0.965
Validation loss decreased (-0.951340 --> -0.964527).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0009491
	speed: 0.6001s/iter; left time: 23979.5723s
	iters: 200, epoch: 4 | loss: 0.0002993
	speed: 0.2970s/iter; left time: 11838.4860s
	iters: 300, epoch: 4 | loss: 0.2545219
	speed: 0.3186s/iter; left time: 12667.6921s
	iters: 400, epoch: 4 | loss: 0.0000932
	speed: 0.3113s/iter; left time: 12345.4834s
Epoch: 4 cost time: 127.40568494796753
Epoch: 4, Steps: 413 | Train Loss: 0.347 Vali Loss: 0.321 Vali Acc: 0.956 Test Loss: 0.321 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0002378
	speed: 0.6161s/iter; left time: 24365.5023s
	iters: 200, epoch: 5 | loss: 0.4018174
	speed: 0.3249s/iter; left time: 12815.9337s
	iters: 300, epoch: 5 | loss: 0.0000004
	speed: 0.2890s/iter; left time: 11372.4401s
	iters: 400, epoch: 5 | loss: 0.0585972
	speed: 0.3036s/iter; left time: 11917.4545s
Epoch: 5 cost time: 128.70956993103027
Epoch: 5, Steps: 413 | Train Loss: 0.344 Vali Loss: 0.640 Vali Acc: 0.926 Test Loss: 0.640 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000224
	speed: 0.6085s/iter; left time: 23814.1543s
	iters: 200, epoch: 6 | loss: 0.0000007
	speed: 0.3031s/iter; left time: 11831.1898s
	iters: 300, epoch: 6 | loss: 0.1051878
	speed: 0.3242s/iter; left time: 12621.4486s
	iters: 400, epoch: 6 | loss: 0.0000015
	speed: 0.3138s/iter; left time: 12186.7099s
Epoch: 6 cost time: 128.88917779922485
Epoch: 6, Steps: 413 | Train Loss: 0.272 Vali Loss: 0.259 Vali Acc: 0.972 Test Loss: 0.259 Test Acc: 0.972
Validation loss decreased (-0.964527 --> -0.971803).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0002290
	speed: 0.6083s/iter; left time: 23554.1691s
	iters: 200, epoch: 7 | loss: 0.0003461
	speed: 0.3058s/iter; left time: 11809.5602s
	iters: 300, epoch: 7 | loss: 0.0000450
	speed: 0.3017s/iter; left time: 11623.9890s
	iters: 400, epoch: 7 | loss: 0.0002427
	speed: 0.3155s/iter; left time: 12121.8436s
Epoch: 7 cost time: 127.46738362312317
Epoch: 7, Steps: 413 | Train Loss: 0.235 Vali Loss: 0.565 Vali Acc: 0.951 Test Loss: 0.565 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.6190s/iter; left time: 23715.3504s
	iters: 200, epoch: 8 | loss: 1.0038028
	speed: 0.3201s/iter; left time: 12232.7780s
	iters: 300, epoch: 8 | loss: 0.0000075
	speed: 0.3145s/iter; left time: 11985.3046s
	iters: 400, epoch: 8 | loss: 0.2537926
	speed: 0.2731s/iter; left time: 10382.1083s
Epoch: 8 cost time: 124.85888051986694
Epoch: 8, Steps: 413 | Train Loss: 0.195 Vali Loss: 0.524 Vali Acc: 0.957 Test Loss: 0.524 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000101
	speed: 0.5820s/iter; left time: 22055.8491s
	iters: 200, epoch: 9 | loss: 0.0000001
	speed: 0.3018s/iter; left time: 11407.4443s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.2991s/iter; left time: 11273.8835s
	iters: 400, epoch: 9 | loss: 0.0169800
	speed: 0.3107s/iter; left time: 11682.2557s
Epoch: 9 cost time: 126.44479727745056
Epoch: 9, Steps: 413 | Train Loss: 0.142 Vali Loss: 0.246 Vali Acc: 0.971 Test Loss: 0.246 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0001004
	speed: 0.6137s/iter; left time: 23005.3237s
	iters: 200, epoch: 10 | loss: 0.0000033
	speed: 0.3228s/iter; left time: 12067.6711s
	iters: 300, epoch: 10 | loss: 0.0000041
	speed: 0.3005s/iter; left time: 11202.1955s
	iters: 400, epoch: 10 | loss: 0.0028279
	speed: 0.2907s/iter; left time: 10808.7470s
Epoch: 10 cost time: 125.9796679019928
Epoch: 10, Steps: 413 | Train Loss: 0.148 Vali Loss: 0.353 Vali Acc: 0.962 Test Loss: 0.353 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.5929s/iter; left time: 21980.3222s
	iters: 200, epoch: 11 | loss: 0.0000210
	speed: 0.2752s/iter; left time: 10172.9022s
	iters: 300, epoch: 11 | loss: 0.7067101
	speed: 0.3042s/iter; left time: 11216.5148s
	iters: 400, epoch: 11 | loss: 0.3499082
	speed: 0.3101s/iter; left time: 11403.1824s
Epoch: 11 cost time: 123.11400532722473
Epoch: 11, Steps: 413 | Train Loss: 0.130 Vali Loss: 0.301 Vali Acc: 0.972 Test Loss: 0.301 Test Acc: 0.972
Validation loss decreased (-0.971803 --> -0.972257).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.6240s/iter; left time: 22875.4791s
	iters: 200, epoch: 12 | loss: 0.0000005
	speed: 0.3124s/iter; left time: 11419.3074s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.2816s/iter; left time: 10268.3641s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.2974s/iter; left time: 10814.1784s
Epoch: 12 cost time: 124.50885677337646
Epoch: 12, Steps: 413 | Train Loss: 0.163 Vali Loss: 0.305 Vali Acc: 0.969 Test Loss: 0.305 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.5985s/iter; left time: 21693.4374s
	iters: 200, epoch: 13 | loss: 0.0182945
	speed: 0.2795s/iter; left time: 10101.7898s
	iters: 300, epoch: 13 | loss: 0.0000032
	speed: 0.2880s/iter; left time: 10381.5450s
	iters: 400, epoch: 13 | loss: 0.0000992
	speed: 0.2906s/iter; left time: 10446.4528s
Epoch: 13 cost time: 119.61702466011047
Epoch: 13, Steps: 413 | Train Loss: 0.121 Vali Loss: 0.335 Vali Acc: 0.966 Test Loss: 0.335 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.5897s/iter; left time: 21131.7279s
	iters: 200, epoch: 14 | loss: 0.0000121
	speed: 0.3140s/iter; left time: 11221.3081s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.2908s/iter; left time: 10361.5203s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.3062s/iter; left time: 10880.7713s
Epoch: 14 cost time: 126.43710041046143
Epoch: 14, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.224 Vali Acc: 0.977 Test Loss: 0.224 Test Acc: 0.977
Validation loss decreased (-0.972257 --> -0.976805).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.6158s/iter; left time: 21810.3719s
	iters: 200, epoch: 15 | loss: 0.0013746
	speed: 0.2989s/iter; left time: 10555.2559s
	iters: 300, epoch: 15 | loss: 0.6747932
	speed: 0.3206s/iter; left time: 11292.4293s
	iters: 400, epoch: 15 | loss: 0.0000127
	speed: 0.2972s/iter; left time: 10438.8225s
Epoch: 15 cost time: 125.84813141822815
Epoch: 15, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.213 Vali Acc: 0.976 Test Loss: 0.213 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.5822s/iter; left time: 20380.1798s
	iters: 200, epoch: 16 | loss: 0.1510180
	speed: 0.3023s/iter; left time: 10551.0799s
	iters: 300, epoch: 16 | loss: 0.0000015
	speed: 0.2877s/iter; left time: 10014.1402s
	iters: 400, epoch: 16 | loss: 0.0000002
	speed: 0.2989s/iter; left time: 10373.9205s
Epoch: 16 cost time: 123.34976387023926
Epoch: 16, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.391 Vali Acc: 0.965 Test Loss: 0.391 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000833
	speed: 0.6196s/iter; left time: 21433.1075s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.3156s/iter; left time: 10885.2941s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.3102s/iter; left time: 10667.0985s
	iters: 400, epoch: 17 | loss: 0.0000208
	speed: 0.2903s/iter; left time: 9956.5108s
Epoch: 17 cost time: 127.10619497299194
Epoch: 17, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.449 Vali Acc: 0.966 Test Loss: 0.449 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000001
	speed: 0.5638s/iter; left time: 19270.7644s
	iters: 200, epoch: 18 | loss: 0.0000046
	speed: 0.2930s/iter; left time: 9984.9628s
	iters: 300, epoch: 18 | loss: 1.0516535
	speed: 0.2881s/iter; left time: 9789.6378s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.3139s/iter; left time: 10633.8314s
Epoch: 18 cost time: 123.25964522361755
Epoch: 18, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.635 Vali Acc: 0.965 Test Loss: 0.635 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.5991s/iter; left time: 20230.7388s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.3146s/iter; left time: 10590.6617s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.3080s/iter; left time: 10337.3101s
	iters: 400, epoch: 19 | loss: 0.5673871
	speed: 0.2606s/iter; left time: 8720.3075s
Epoch: 19 cost time: 121.64595293998718
Epoch: 19, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.262 Vali Acc: 0.976 Test Loss: 0.262 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0498598
	speed: 0.5816s/iter; left time: 19398.3543s
	iters: 200, epoch: 20 | loss: 0.1638378
	speed: 0.2829s/iter; left time: 9408.0461s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.3026s/iter; left time: 10032.7506s
	iters: 400, epoch: 20 | loss: 0.0002275
	speed: 0.2997s/iter; left time: 9906.1167s
Epoch: 20 cost time: 123.52937340736389
Epoch: 20, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.275 Vali Acc: 0.973 Test Loss: 0.275 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0002869
	speed: 0.6009s/iter; left time: 19795.4471s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.2933s/iter; left time: 9631.9180s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.2984s/iter; left time: 9768.9758s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.2973s/iter; left time: 9705.5845s
Epoch: 21 cost time: 124.31685996055603
Epoch: 21, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.204 Vali Acc: 0.977 Test Loss: 0.204 Test Acc: 0.977
Validation loss decreased (-0.976805 --> -0.977260).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0018599
	speed: 0.5562s/iter; left time: 18092.2826s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.3166s/iter; left time: 10266.9760s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.3016s/iter; left time: 9749.6204s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.2864s/iter; left time: 9231.6921s
Epoch: 22 cost time: 122.61826753616333
Epoch: 22, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.237 Vali Acc: 0.979 Test Loss: 0.237 Test Acc: 0.979
Validation loss decreased (-0.977260 --> -0.979079).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000908
	speed: 0.6148s/iter; left time: 19743.6071s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.2975s/iter; left time: 9523.2251s
	iters: 300, epoch: 23 | loss: 0.0000012
	speed: 0.2960s/iter; left time: 9446.9335s
	iters: 400, epoch: 23 | loss: 0.0000003
	speed: 0.3020s/iter; left time: 9607.2356s
Epoch: 23 cost time: 123.72875189781189
Epoch: 23, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.304 Vali Acc: 0.980 Test Loss: 0.304 Test Acc: 0.980
Validation loss decreased (-0.979079 --> -0.979988).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000001
	speed: 0.5681s/iter; left time: 18011.1712s
	iters: 200, epoch: 24 | loss: 0.0000197
	speed: 0.3076s/iter; left time: 9720.9483s
	iters: 300, epoch: 24 | loss: 0.8758032
	speed: 0.3047s/iter; left time: 9597.3514s
	iters: 400, epoch: 24 | loss: 0.1316337
	speed: 0.2982s/iter; left time: 9364.3330s
Epoch: 24 cost time: 124.05745911598206
Epoch: 24, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.262 Vali Acc: 0.975 Test Loss: 0.262 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.1117527
	speed: 0.5928s/iter; left time: 18547.1581s
	iters: 200, epoch: 25 | loss: 0.0000001
	speed: 0.2630s/iter; left time: 8203.2280s
	iters: 300, epoch: 25 | loss: 0.0005714
	speed: 0.2866s/iter; left time: 8910.6521s
	iters: 400, epoch: 25 | loss: 0.0002329
	speed: 0.2831s/iter; left time: 8772.9862s
Epoch: 25 cost time: 116.15456342697144
Epoch: 25, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.246 Vali Acc: 0.971 Test Loss: 0.246 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.5333s/iter; left time: 16466.8561s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.2934s/iter; left time: 9028.5292s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.2775s/iter; left time: 8511.1947s
	iters: 400, epoch: 26 | loss: 0.0000042
	speed: 0.2797s/iter; left time: 8550.7686s
Epoch: 26 cost time: 116.80879783630371
Epoch: 26, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.279 Vali Acc: 0.975 Test Loss: 0.279 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.5646s/iter; left time: 17199.4796s
	iters: 200, epoch: 27 | loss: 0.6681328
	speed: 0.2687s/iter; left time: 8157.4287s
	iters: 300, epoch: 27 | loss: 0.0000036
	speed: 0.2740s/iter; left time: 8292.3623s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.2911s/iter; left time: 8780.0661s
Epoch: 27 cost time: 115.98837184906006
Epoch: 27, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.283 Vali Acc: 0.976 Test Loss: 0.283 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0000001
	speed: 0.5379s/iter; left time: 16163.8210s
	iters: 200, epoch: 28 | loss: 0.1302415
	speed: 0.2937s/iter; left time: 8794.9912s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.2861s/iter; left time: 8539.2095s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.2574s/iter; left time: 7658.0045s
Epoch: 28 cost time: 114.746169090271
Epoch: 28, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.228 Vali Acc: 0.976 Test Loss: 0.228 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.5830s/iter; left time: 17279.0938s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.2577s/iter; left time: 7613.1490s
	iters: 300, epoch: 29 | loss: 0.0001966
	speed: 0.2710s/iter; left time: 7977.0793s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.2989s/iter; left time: 8768.5554s
Epoch: 29 cost time: 117.04164266586304
Epoch: 29, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.154 Vali Acc: 0.977 Test Loss: 0.154 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0792097
	speed: 0.5545s/iter; left time: 16204.8486s
	iters: 200, epoch: 30 | loss: 0.0000165
	speed: 0.2898s/iter; left time: 8439.5358s
	iters: 300, epoch: 30 | loss: 0.0202688
	speed: 0.2955s/iter; left time: 8577.3204s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.2551s/iter; left time: 7379.2394s
Epoch: 30 cost time: 115.60954642295837
Epoch: 30, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.503 Vali Acc: 0.965 Test Loss: 0.503 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0000068
	speed: 0.5536s/iter; left time: 15950.6882s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.2755s/iter; left time: 7908.9491s
	iters: 300, epoch: 31 | loss: 0.0003688
	speed: 0.2773s/iter; left time: 7935.0201s
	iters: 400, epoch: 31 | loss: 0.0003292
	speed: 0.2812s/iter; left time: 8017.5297s
Epoch: 31 cost time: 116.38268065452576
Epoch: 31, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.221 Vali Acc: 0.978 Test Loss: 0.221 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0000001
	speed: 0.5637s/iter; left time: 16008.1317s
	iters: 200, epoch: 32 | loss: 0.0001486
	speed: 0.2721s/iter; left time: 7699.2739s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.2899s/iter; left time: 8174.8141s
	iters: 400, epoch: 32 | loss: 0.0000001
	speed: 0.2671s/iter; left time: 7505.6532s
Epoch: 32 cost time: 114.86644148826599
Epoch: 32, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.203 Vali Acc: 0.975 Test Loss: 0.203 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0000316
	speed: 0.5439s/iter; left time: 15220.1185s
	iters: 200, epoch: 33 | loss: 0.0000005
	speed: 0.2901s/iter; left time: 8090.6266s
	iters: 300, epoch: 33 | loss: 0.0000096
	speed: 0.2736s/iter; left time: 7602.1493s
	iters: 400, epoch: 33 | loss: 0.0001729
	speed: 0.2771s/iter; left time: 7671.5988s
Epoch: 33 cost time: 116.2965784072876
Epoch: 33, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.301 Vali Acc: 0.969 Test Loss: 0.301 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9799909049567985
model parameter : 16118794
model size : 81.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         38                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0885884
	speed: 0.3021s/iter; left time: 12445.2952s
	iters: 200, epoch: 1 | loss: 0.3511348
	speed: 0.2994s/iter; left time: 12303.9963s
	iters: 300, epoch: 1 | loss: 0.8374364
	speed: 0.2920s/iter; left time: 11974.2080s
	iters: 400, epoch: 1 | loss: 0.1212582
	speed: 0.2701s/iter; left time: 11048.1367s
Epoch: 1 cost time: 119.7214024066925
Epoch: 1, Steps: 413 | Train Loss: 0.373 Vali Loss: 0.281 Vali Acc: 0.937 Test Loss: 0.281 Test Acc: 0.937
Validation loss decreased (inf --> -0.936787).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6497207
	speed: 0.5563s/iter; left time: 22691.2608s
	iters: 200, epoch: 2 | loss: 0.4065172
	speed: 0.2748s/iter; left time: 11181.8757s
	iters: 300, epoch: 2 | loss: 0.3989254
	speed: 0.2895s/iter; left time: 11750.2670s
	iters: 400, epoch: 2 | loss: 0.1466709
	speed: 0.3028s/iter; left time: 12259.2051s
Epoch: 2 cost time: 121.0725588798523
Epoch: 2, Steps: 413 | Train Loss: 0.311 Vali Loss: 0.510 Vali Acc: 0.902 Test Loss: 0.510 Test Acc: 0.902
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0041260
	speed: 0.6112s/iter; left time: 24675.8538s
	iters: 200, epoch: 3 | loss: 1.1224862
	speed: 0.2897s/iter; left time: 11667.8453s
	iters: 300, epoch: 3 | loss: 0.0001719
	speed: 0.2997s/iter; left time: 12038.7086s
	iters: 400, epoch: 3 | loss: 1.9125092
	speed: 0.2782s/iter; left time: 11150.8130s
Epoch: 3 cost time: 119.95318126678467
Epoch: 3, Steps: 413 | Train Loss: 0.350 Vali Loss: 0.239 Vali Acc: 0.964 Test Loss: 0.239 Test Acc: 0.964
Validation loss decreased (-0.936787 --> -0.963617).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0880366
	speed: 0.5654s/iter; left time: 22596.0819s
	iters: 200, epoch: 4 | loss: 1.4072254
	speed: 0.2814s/iter; left time: 11216.9701s
	iters: 300, epoch: 4 | loss: 0.7397969
	speed: 0.2795s/iter; left time: 11114.2273s
	iters: 400, epoch: 4 | loss: 0.0284187
	speed: 0.2748s/iter; left time: 10898.7858s
Epoch: 4 cost time: 117.97595691680908
Epoch: 4, Steps: 413 | Train Loss: 0.299 Vali Loss: 0.427 Vali Acc: 0.950 Test Loss: 0.427 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000262
	speed: 0.5611s/iter; left time: 22190.8711s
	iters: 200, epoch: 5 | loss: 0.1162499
	speed: 0.2970s/iter; left time: 11717.8243s
	iters: 300, epoch: 5 | loss: 0.0000003
	speed: 0.3078s/iter; left time: 12112.8469s
	iters: 400, epoch: 5 | loss: 0.5004056
	speed: 0.2888s/iter; left time: 11333.8771s
Epoch: 5 cost time: 121.28494691848755
Epoch: 5, Steps: 413 | Train Loss: 0.299 Vali Loss: 0.481 Vali Acc: 0.951 Test Loss: 0.481 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.3526760
	speed: 0.5322s/iter; left time: 20828.2519s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.2891s/iter; left time: 11284.0511s
	iters: 300, epoch: 6 | loss: 0.1468280
	speed: 0.2732s/iter; left time: 10638.8290s
	iters: 400, epoch: 6 | loss: 0.0181032
	speed: 0.2664s/iter; left time: 10346.7865s
Epoch: 6 cost time: 113.86123561859131
Epoch: 6, Steps: 413 | Train Loss: 0.323 Vali Loss: 0.390 Vali Acc: 0.958 Test Loss: 0.390 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0001764
	speed: 0.5880s/iter; left time: 22769.2063s
	iters: 200, epoch: 7 | loss: 0.0164697
	speed: 0.3045s/iter; left time: 11761.2179s
	iters: 300, epoch: 7 | loss: 0.0000094
	speed: 0.3057s/iter; left time: 11775.0016s
	iters: 400, epoch: 7 | loss: 0.0003445
	speed: 0.2944s/iter; left time: 11312.5525s
Epoch: 7 cost time: 124.73265862464905
Epoch: 7, Steps: 413 | Train Loss: 0.194 Vali Loss: 0.453 Vali Acc: 0.953 Test Loss: 0.453 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.7147062
	speed: 0.5270s/iter; left time: 20189.8155s
	iters: 200, epoch: 8 | loss: 1.1399809
	speed: 0.2940s/iter; left time: 11232.1007s
	iters: 300, epoch: 8 | loss: 0.0000117
	speed: 0.2891s/iter; left time: 11017.7851s
	iters: 400, epoch: 8 | loss: 0.3787541
	speed: 0.2734s/iter; left time: 10390.6259s
Epoch: 8 cost time: 116.46679377555847
Epoch: 8, Steps: 413 | Train Loss: 0.194 Vali Loss: 1.409 Vali Acc: 0.910 Test Loss: 1.409 Test Acc: 0.910
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0001632
	speed: 0.5966s/iter; left time: 22609.4400s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.2899s/iter; left time: 10957.7417s
	iters: 300, epoch: 9 | loss: 0.0655755
	speed: 0.2751s/iter; left time: 10371.9844s
	iters: 400, epoch: 9 | loss: 0.0000917
	speed: 0.2833s/iter; left time: 10652.8478s
Epoch: 9 cost time: 119.24340295791626
Epoch: 9, Steps: 413 | Train Loss: 0.209 Vali Loss: 0.297 Vali Acc: 0.966 Test Loss: 0.297 Test Acc: 0.966
Validation loss decreased (-0.963617 --> -0.966345).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.5546s/iter; left time: 20790.1108s
	iters: 200, epoch: 10 | loss: 0.0009512
	speed: 0.2878s/iter; left time: 10758.9176s
	iters: 300, epoch: 10 | loss: 0.6972141
	speed: 0.2983s/iter; left time: 11122.4119s
	iters: 400, epoch: 10 | loss: 0.4426907
	speed: 0.2903s/iter; left time: 10793.4214s
Epoch: 10 cost time: 118.95206093788147
Epoch: 10, Steps: 413 | Train Loss: 0.174 Vali Loss: 0.263 Vali Acc: 0.971 Test Loss: 0.263 Test Acc: 0.971
Validation loss decreased (-0.966345 --> -0.971348).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0001314
	speed: 0.5847s/iter; left time: 21675.2475s
	iters: 200, epoch: 11 | loss: 0.0000010
	speed: 0.2930s/iter; left time: 10831.0472s
	iters: 300, epoch: 11 | loss: 0.0000258
	speed: 0.2625s/iter; left time: 9677.0556s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.2832s/iter; left time: 10412.3020s
Epoch: 11 cost time: 117.15309286117554
Epoch: 11, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.391 Vali Acc: 0.966 Test Loss: 0.391 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0135767
	speed: 0.5758s/iter; left time: 21107.7104s
	iters: 200, epoch: 12 | loss: 0.0602921
	speed: 0.2976s/iter; left time: 10881.0729s
	iters: 300, epoch: 12 | loss: 0.0114416
	speed: 0.3024s/iter; left time: 11024.8816s
	iters: 400, epoch: 12 | loss: 1.0302857
	speed: 0.2949s/iter; left time: 10721.6229s
Epoch: 12 cost time: 122.50618815422058
Epoch: 12, Steps: 413 | Train Loss: 0.133 Vali Loss: 0.650 Vali Acc: 0.940 Test Loss: 0.650 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000020
	speed: 0.5765s/iter; left time: 20894.4920s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.2903s/iter; left time: 10493.5757s
	iters: 300, epoch: 13 | loss: 0.0170670
	speed: 0.2678s/iter; left time: 9654.4708s
	iters: 400, epoch: 13 | loss: 0.0368531
	speed: 0.2838s/iter; left time: 10201.6083s
Epoch: 13 cost time: 118.27682638168335
Epoch: 13, Steps: 413 | Train Loss: 0.126 Vali Loss: 0.391 Vali Acc: 0.960 Test Loss: 0.391 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0068463
	speed: 0.5602s/iter; left time: 20074.1337s
	iters: 200, epoch: 14 | loss: 0.0257684
	speed: 0.2681s/iter; left time: 9578.4489s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.2937s/iter; left time: 10465.7096s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.2868s/iter; left time: 10189.6763s
Epoch: 14 cost time: 115.34211754798889
Epoch: 14, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.421 Vali Acc: 0.963 Test Loss: 0.421 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000021
	speed: 0.5611s/iter; left time: 19875.0678s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.2944s/iter; left time: 10399.1879s
	iters: 300, epoch: 15 | loss: 0.0000753
	speed: 0.2852s/iter; left time: 10044.7623s
	iters: 400, epoch: 15 | loss: 0.0000031
	speed: 0.2856s/iter; left time: 10031.6534s
Epoch: 15 cost time: 119.53232145309448
Epoch: 15, Steps: 413 | Train Loss: 0.120 Vali Loss: 0.607 Vali Acc: 0.958 Test Loss: 0.607 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000016
	speed: 0.5454s/iter; left time: 19091.6618s
	iters: 200, epoch: 16 | loss: 0.0000173
	speed: 0.2863s/iter; left time: 9992.3739s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.2760s/iter; left time: 9605.0936s
	iters: 400, epoch: 16 | loss: 0.0000463
	speed: 0.2904s/iter; left time: 10077.5579s
Epoch: 16 cost time: 117.76449656486511
Epoch: 16, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.175 Vali Acc: 0.975 Test Loss: 0.175 Test Acc: 0.975
Validation loss decreased (-0.971348 --> -0.975442).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.5862s/iter; left time: 20277.3247s
	iters: 200, epoch: 17 | loss: 0.0008525
	speed: 0.2746s/iter; left time: 9471.4311s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.2989s/iter; left time: 10281.5093s
	iters: 400, epoch: 17 | loss: 0.3009614
	speed: 0.2751s/iter; left time: 9434.6462s
Epoch: 17 cost time: 117.5863995552063
Epoch: 17, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.225 Vali Acc: 0.975 Test Loss: 0.225 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0024649
	speed: 0.5447s/iter; left time: 18616.8138s
	iters: 200, epoch: 18 | loss: 0.0000131
	speed: 0.2927s/iter; left time: 9975.7728s
	iters: 300, epoch: 18 | loss: 0.2197897
	speed: 0.2740s/iter; left time: 9309.3916s
	iters: 400, epoch: 18 | loss: 0.0000145
	speed: 0.2866s/iter; left time: 9708.9383s
Epoch: 18 cost time: 117.8521146774292
Epoch: 18, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.156 Vali Acc: 0.981 Test Loss: 0.156 Test Acc: 0.981
Validation loss decreased (-0.975442 --> -0.980899).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000005
	speed: 0.6129s/iter; left time: 20695.0718s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.2752s/iter; left time: 9263.6909s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.2893s/iter; left time: 9709.7159s
	iters: 400, epoch: 19 | loss: 0.0000001
	speed: 0.2916s/iter; left time: 9759.0907s
Epoch: 19 cost time: 120.03613424301147
Epoch: 19, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.235 Vali Acc: 0.975 Test Loss: 0.235 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.1513951
	speed: 0.5252s/iter; left time: 17515.9156s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.2883s/iter; left time: 9587.5924s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.2972s/iter; left time: 9851.7694s
	iters: 400, epoch: 20 | loss: 1.7170794
	speed: 0.2968s/iter; left time: 9810.5915s
Epoch: 20 cost time: 119.03667068481445
Epoch: 20, Steps: 413 | Train Loss: 0.111 Vali Loss: 0.182 Vali Acc: 0.975 Test Loss: 0.182 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.5839s/iter; left time: 19235.8475s
	iters: 200, epoch: 21 | loss: 0.0000003
	speed: 0.2868s/iter; left time: 9419.1539s
	iters: 300, epoch: 21 | loss: 0.0037968
	speed: 0.2748s/iter; left time: 8998.2086s
	iters: 400, epoch: 21 | loss: 0.4857979
	speed: 0.2787s/iter; left time: 9098.6676s
Epoch: 21 cost time: 115.9352502822876
Epoch: 21, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.224 Vali Acc: 0.972 Test Loss: 0.224 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0000001
	speed: 0.5548s/iter; left time: 18045.5100s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.3043s/iter; left time: 9869.1358s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.2885s/iter; left time: 9327.7002s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.2727s/iter; left time: 8787.6636s
Epoch: 22 cost time: 119.16517758369446
Epoch: 22, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.231 Vali Acc: 0.970 Test Loss: 0.231 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0000039
	speed: 0.5705s/iter; left time: 18322.3400s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.2530s/iter; left time: 8098.5466s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.2896s/iter; left time: 9242.2649s
	iters: 400, epoch: 23 | loss: 0.0000001
	speed: 0.3038s/iter; left time: 9665.5500s
Epoch: 23 cost time: 117.66906309127808
Epoch: 23, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.187 Vali Acc: 0.974 Test Loss: 0.187 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.5598s/iter; left time: 17746.4523s
	iters: 200, epoch: 24 | loss: 0.0036785
	speed: 0.3015s/iter; left time: 9527.0693s
	iters: 300, epoch: 24 | loss: 0.0000043
	speed: 0.2813s/iter; left time: 8861.7508s
	iters: 400, epoch: 24 | loss: 0.0549064
	speed: 0.2773s/iter; left time: 8709.1267s
Epoch: 24 cost time: 119.80166482925415
Epoch: 24, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.263 Vali Acc: 0.969 Test Loss: 0.263 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0000277
	speed: 0.5744s/iter; left time: 17972.3820s
	iters: 200, epoch: 25 | loss: 0.0350806
	speed: 0.2815s/iter; left time: 8779.3409s
	iters: 300, epoch: 25 | loss: 0.0212250
	speed: 0.2979s/iter; left time: 9262.6714s
	iters: 400, epoch: 25 | loss: 0.0000001
	speed: 0.2867s/iter; left time: 8886.0648s
Epoch: 25 cost time: 118.65345525741577
Epoch: 25, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.203 Vali Acc: 0.975 Test Loss: 0.203 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0000103
	speed: 0.5436s/iter; left time: 16783.2752s
	iters: 200, epoch: 26 | loss: 0.0000012
	speed: 0.3064s/iter; left time: 9430.7370s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.2959s/iter; left time: 9078.4187s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.2967s/iter; left time: 9070.5454s
Epoch: 26 cost time: 122.98128533363342
Epoch: 26, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.191 Vali Acc: 0.977 Test Loss: 0.191 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.5750s/iter; left time: 17515.5588s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.2697s/iter; left time: 8189.7797s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.2754s/iter; left time: 8335.4467s
	iters: 400, epoch: 27 | loss: 0.0000127
	speed: 0.2809s/iter; left time: 8473.2994s
Epoch: 27 cost time: 114.74035286903381
Epoch: 27, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.230 Vali Acc: 0.969 Test Loss: 0.230 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0000254
	speed: 0.5537s/iter; left time: 16637.2880s
	iters: 200, epoch: 28 | loss: 0.0000001
	speed: 0.2992s/iter; left time: 8959.9790s
	iters: 300, epoch: 28 | loss: 0.0000001
	speed: 0.2951s/iter; left time: 8807.7579s
	iters: 400, epoch: 28 | loss: 0.4345778
	speed: 0.2747s/iter; left time: 8171.8911s
Epoch: 28 cost time: 120.05253291130066
Epoch: 28, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.241 Vali Acc: 0.975 Test Loss: 0.241 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9809004092769441
model parameter : 16118794
model size : 81.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         28                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0781459
	speed: 0.3020s/iter; left time: 12441.2476s
	iters: 200, epoch: 1 | loss: 0.0481638
	speed: 0.2752s/iter; left time: 11312.9464s
	iters: 300, epoch: 1 | loss: 0.9940068
	speed: 0.3012s/iter; left time: 12348.4594s
	iters: 400, epoch: 1 | loss: 0.0479062
	speed: 0.3058s/iter; left time: 12505.8177s
Epoch: 1 cost time: 122.38872623443604
Epoch: 1, Steps: 413 | Train Loss: 0.408 Vali Loss: 0.168 Vali Acc: 0.957 Test Loss: 0.168 Test Acc: 0.957
Validation loss decreased (inf --> -0.956797).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0159367
	speed: 0.5987s/iter; left time: 24421.6768s
	iters: 200, epoch: 2 | loss: 0.5734767
	speed: 0.3073s/iter; left time: 12502.0616s
	iters: 300, epoch: 2 | loss: 1.6355137
	speed: 0.2902s/iter; left time: 11778.9259s
	iters: 400, epoch: 2 | loss: 0.1220959
	speed: 0.2986s/iter; left time: 12090.1048s
Epoch: 2 cost time: 125.5693850517273
Epoch: 2, Steps: 413 | Train Loss: 0.269 Vali Loss: 0.272 Vali Acc: 0.950 Test Loss: 0.272 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0081404
	speed: 0.5522s/iter; left time: 22295.8671s
	iters: 200, epoch: 3 | loss: 0.7618656
	speed: 0.2873s/iter; left time: 11570.8091s
	iters: 300, epoch: 3 | loss: 0.0010527
	speed: 0.2987s/iter; left time: 11999.4855s
	iters: 400, epoch: 3 | loss: 2.8061545
	speed: 0.2861s/iter; left time: 11466.0261s
Epoch: 3 cost time: 119.55681443214417
Epoch: 3, Steps: 413 | Train Loss: 0.423 Vali Loss: 0.566 Vali Acc: 0.920 Test Loss: 0.566 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0026146
	speed: 0.5889s/iter; left time: 23533.6324s
	iters: 200, epoch: 4 | loss: 0.4054772
	speed: 0.2972s/iter; left time: 11846.9371s
	iters: 300, epoch: 4 | loss: 0.7185380
	speed: 0.2997s/iter; left time: 11915.4639s
	iters: 400, epoch: 4 | loss: 0.3923403
	speed: 0.3037s/iter; left time: 12047.1949s
Epoch: 4 cost time: 124.8753981590271
Epoch: 4, Steps: 413 | Train Loss: 0.318 Vali Loss: 0.226 Vali Acc: 0.964 Test Loss: 0.226 Test Acc: 0.964
Validation loss decreased (-0.956797 --> -0.964072).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.5485s/iter; left time: 21694.2982s
	iters: 200, epoch: 5 | loss: 0.0014955
	speed: 0.2853s/iter; left time: 11254.2140s
	iters: 300, epoch: 5 | loss: 0.4845868
	speed: 0.2931s/iter; left time: 11532.5622s
	iters: 400, epoch: 5 | loss: 0.0000139
	speed: 0.3018s/iter; left time: 11844.5276s
Epoch: 5 cost time: 118.86196756362915
Epoch: 5, Steps: 413 | Train Loss: 0.269 Vali Loss: 0.322 Vali Acc: 0.956 Test Loss: 0.322 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.7364287
	speed: 0.5990s/iter; left time: 23442.7397s
	iters: 200, epoch: 6 | loss: 0.1739115
	speed: 0.2687s/iter; left time: 10487.6833s
	iters: 300, epoch: 6 | loss: 0.1699939
	speed: 0.2630s/iter; left time: 10240.3402s
	iters: 400, epoch: 6 | loss: 0.0052160
	speed: 0.2997s/iter; left time: 11638.2080s
Epoch: 6 cost time: 118.00641536712646
Epoch: 6, Steps: 413 | Train Loss: 0.308 Vali Loss: 0.428 Vali Acc: 0.945 Test Loss: 0.428 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000409
	speed: 0.5273s/iter; left time: 20417.8032s
	iters: 200, epoch: 7 | loss: 0.2380608
	speed: 0.2930s/iter; left time: 11318.4169s
	iters: 300, epoch: 7 | loss: 0.0000001
	speed: 0.3090s/iter; left time: 11903.8108s
	iters: 400, epoch: 7 | loss: 0.0002543
	speed: 0.3061s/iter; left time: 11763.1499s
Epoch: 7 cost time: 121.64091992378235
Epoch: 7, Steps: 413 | Train Loss: 0.157 Vali Loss: 0.542 Vali Acc: 0.947 Test Loss: 0.542 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000084
	speed: 0.5928s/iter; left time: 22711.4274s
	iters: 200, epoch: 8 | loss: 0.5126709
	speed: 0.2686s/iter; left time: 10263.2793s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.2629s/iter; left time: 10019.3790s
	iters: 400, epoch: 8 | loss: 1.0649544
	speed: 0.2934s/iter; left time: 11151.9553s
Epoch: 8 cost time: 118.19655299186707
Epoch: 8, Steps: 413 | Train Loss: 0.180 Vali Loss: 0.630 Vali Acc: 0.956 Test Loss: 0.630 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000077
	speed: 0.5476s/iter; left time: 20750.6647s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.2717s/iter; left time: 10268.1092s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.2940s/iter; left time: 11082.6037s
	iters: 400, epoch: 9 | loss: 0.0390853
	speed: 0.2801s/iter; left time: 10531.7666s
Epoch: 9 cost time: 116.07147979736328
Epoch: 9, Steps: 413 | Train Loss: 0.137 Vali Loss: 0.507 Vali Acc: 0.957 Test Loss: 0.507 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.2866755
	speed: 0.5588s/iter; left time: 20945.2349s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.2867s/iter; left time: 10717.9549s
	iters: 300, epoch: 10 | loss: 0.1043652
	speed: 0.2764s/iter; left time: 10306.8160s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.2683s/iter; left time: 9975.4422s
Epoch: 10 cost time: 116.93154048919678
Epoch: 10, Steps: 413 | Train Loss: 0.146 Vali Loss: 0.265 Vali Acc: 0.972 Test Loss: 0.265 Test Acc: 0.972
Validation loss decreased (-0.964072 --> -0.972257).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.6065145
	speed: 0.5309s/iter; left time: 19681.3284s
	iters: 200, epoch: 11 | loss: 0.0011204
	speed: 0.2664s/iter; left time: 9850.0647s
	iters: 300, epoch: 11 | loss: 1.7037617
	speed: 0.2963s/iter; left time: 10923.1156s
	iters: 400, epoch: 11 | loss: 1.0328627
	speed: 0.2995s/iter; left time: 11013.5204s
Epoch: 11 cost time: 116.63202667236328
Epoch: 11, Steps: 413 | Train Loss: 0.134 Vali Loss: 0.269 Vali Acc: 0.969 Test Loss: 0.269 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0035768
	speed: 0.5265s/iter; left time: 19300.5326s
	iters: 200, epoch: 12 | loss: 0.0000098
	speed: 0.2876s/iter; left time: 10515.4032s
	iters: 300, epoch: 12 | loss: 0.0002178
	speed: 0.2635s/iter; left time: 9606.8627s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.2509s/iter; left time: 9123.6086s
Epoch: 12 cost time: 108.99280524253845
Epoch: 12, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.438 Vali Acc: 0.965 Test Loss: 0.438 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.5551s/iter; left time: 20121.3071s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.2842s/iter; left time: 10272.5886s
	iters: 300, epoch: 13 | loss: 0.0000204
	speed: 0.2730s/iter; left time: 9840.8873s
	iters: 400, epoch: 13 | loss: 0.0000002
	speed: 0.2828s/iter; left time: 10164.5428s
Epoch: 13 cost time: 117.37702345848083
Epoch: 13, Steps: 413 | Train Loss: 0.121 Vali Loss: 0.315 Vali Acc: 0.970 Test Loss: 0.315 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.5408s/iter; left time: 19377.8840s
	iters: 200, epoch: 14 | loss: 0.0001722
	speed: 0.2794s/iter; left time: 9984.1185s
	iters: 300, epoch: 14 | loss: 0.1324659
	speed: 0.3170s/iter; left time: 11297.1048s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.3019s/iter; left time: 10727.9600s
Epoch: 14 cost time: 120.74224901199341
Epoch: 14, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.218 Vali Acc: 0.975 Test Loss: 0.218 Test Acc: 0.975
Validation loss decreased (-0.972257 --> -0.974532).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0017892
	speed: 0.5412s/iter; left time: 19167.8688s
	iters: 200, epoch: 15 | loss: 0.0627498
	speed: 0.2905s/iter; left time: 10259.2520s
	iters: 300, epoch: 15 | loss: 0.0017679
	speed: 0.2742s/iter; left time: 9655.9671s
	iters: 400, epoch: 15 | loss: 0.0019869
	speed: 0.2894s/iter; left time: 10161.9499s
Epoch: 15 cost time: 118.67423009872437
Epoch: 15, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.514 Vali Acc: 0.962 Test Loss: 0.514 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.2143944
	speed: 0.5543s/iter; left time: 19404.4760s
	iters: 200, epoch: 16 | loss: 0.0000001
	speed: 0.2593s/iter; left time: 9052.5705s
	iters: 300, epoch: 16 | loss: 0.0000001
	speed: 0.2773s/iter; left time: 9650.3405s
	iters: 400, epoch: 16 | loss: 0.5246369
	speed: 0.2796s/iter; left time: 9702.1917s
Epoch: 16 cost time: 112.45028138160706
Epoch: 16, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.293 Vali Acc: 0.975 Test Loss: 0.293 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.5434409
	speed: 0.5295s/iter; left time: 18315.3923s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.3033s/iter; left time: 10463.0238s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.2942s/iter; left time: 10117.6356s
	iters: 400, epoch: 17 | loss: 0.0000170
	speed: 0.2738s/iter; left time: 9390.4417s
Epoch: 17 cost time: 119.54593062400818
Epoch: 17, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.328 Vali Acc: 0.971 Test Loss: 0.328 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0011755
	speed: 0.5391s/iter; left time: 18427.5292s
	iters: 200, epoch: 18 | loss: 0.0000021
	speed: 0.2549s/iter; left time: 8688.5357s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.2811s/iter; left time: 9552.7207s
	iters: 400, epoch: 18 | loss: 0.0000773
	speed: 0.2943s/iter; left time: 9970.9230s
Epoch: 18 cost time: 114.27736854553223
Epoch: 18, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.361 Vali Acc: 0.967 Test Loss: 0.361 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.5287s/iter; left time: 17851.3753s
	iters: 200, epoch: 19 | loss: 0.2260647
	speed: 0.2856s/iter; left time: 9615.1550s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.2795s/iter; left time: 9381.0756s
	iters: 400, epoch: 19 | loss: 0.0000007
	speed: 0.2690s/iter; left time: 9004.1119s
Epoch: 19 cost time: 113.2592306137085
Epoch: 19, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.406 Vali Acc: 0.968 Test Loss: 0.406 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.5653682
	speed: 0.5373s/iter; left time: 17920.9440s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.2816s/iter; left time: 9362.6650s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.2539s/iter; left time: 8418.7350s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.2697s/iter; left time: 8913.1634s
Epoch: 20 cost time: 112.4971809387207
Epoch: 20, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.337 Vali Acc: 0.973 Test Loss: 0.337 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0000977
	speed: 0.5469s/iter; left time: 18015.9849s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.2650s/iter; left time: 8702.5545s
	iters: 300, epoch: 21 | loss: 0.3525401
	speed: 0.3036s/iter; left time: 9941.6903s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.2989s/iter; left time: 9754.7710s
Epoch: 21 cost time: 118.38355779647827
Epoch: 21, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.273 Vali Acc: 0.973 Test Loss: 0.273 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0900172
	speed: 0.5780s/iter; left time: 18801.7725s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.2770s/iter; left time: 8983.9795s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.2940s/iter; left time: 9504.9353s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.2880s/iter; left time: 9280.7936s
Epoch: 22 cost time: 120.03729891777039
Epoch: 22, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.333 Vali Acc: 0.971 Test Loss: 0.333 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.7798534
	speed: 0.5947s/iter; left time: 19099.6935s
	iters: 200, epoch: 23 | loss: 0.0070802
	speed: 0.2994s/iter; left time: 9585.1616s
	iters: 300, epoch: 23 | loss: 0.8734353
	speed: 0.2910s/iter; left time: 9288.4278s
	iters: 400, epoch: 23 | loss: 0.0000277
	speed: 0.2849s/iter; left time: 9064.1544s
Epoch: 23 cost time: 122.78080081939697
Epoch: 23, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.178 Vali Acc: 0.979 Test Loss: 0.178 Test Acc: 0.979
Validation loss decreased (-0.974532 --> -0.979080).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.5897s/iter; left time: 18694.6373s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.2964s/iter; left time: 9366.9114s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.2741s/iter; left time: 8635.6472s
	iters: 400, epoch: 24 | loss: 0.0016590
	speed: 0.2988s/iter; left time: 9381.5395s
Epoch: 24 cost time: 120.54948258399963
Epoch: 24, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.199 Vali Acc: 0.982 Test Loss: 0.199 Test Acc: 0.982
Validation loss decreased (-0.979080 --> -0.982263).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0073963
	speed: 0.5823s/iter; left time: 18218.8031s
	iters: 200, epoch: 25 | loss: 0.0019802
	speed: 0.2948s/iter; left time: 9193.3396s
	iters: 300, epoch: 25 | loss: 0.0000002
	speed: 0.2960s/iter; left time: 9203.8870s
	iters: 400, epoch: 25 | loss: 0.0000004
	speed: 0.2947s/iter; left time: 9131.5337s
Epoch: 25 cost time: 122.26282405853271
Epoch: 25, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.168 Vali Acc: 0.980 Test Loss: 0.168 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0000015
	speed: 0.5841s/iter; left time: 18036.1141s
	iters: 200, epoch: 26 | loss: 0.0000073
	speed: 0.3075s/iter; left time: 9463.1037s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.2949s/iter; left time: 9045.9888s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.2867s/iter; left time: 8767.0528s
Epoch: 26 cost time: 123.57018065452576
Epoch: 26, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.243 Vali Acc: 0.978 Test Loss: 0.243 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.5844s/iter; left time: 17803.4634s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.2946s/iter; left time: 8944.0253s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.2883s/iter; left time: 8723.6534s
	iters: 400, epoch: 27 | loss: 0.0001033
	speed: 0.3030s/iter; left time: 9139.4946s
Epoch: 27 cost time: 122.793297290802
Epoch: 27, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.235 Vali Acc: 0.975 Test Loss: 0.235 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0000054
	speed: 0.5964s/iter; left time: 17920.5336s
	iters: 200, epoch: 28 | loss: 0.5155640
	speed: 0.2751s/iter; left time: 8239.0486s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.2992s/iter; left time: 8931.5534s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.2879s/iter; left time: 8564.4749s
Epoch: 28 cost time: 121.14262628555298
Epoch: 28, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.137 Vali Acc: 0.984 Test Loss: 0.137 Test Acc: 0.984
Validation loss decreased (-0.982263 --> -0.983628).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0000001
	speed: 0.5937s/iter; left time: 17595.6097s
	iters: 200, epoch: 29 | loss: 0.0000016
	speed: 0.3066s/iter; left time: 9057.2406s
	iters: 300, epoch: 29 | loss: 0.0000002
	speed: 0.3068s/iter; left time: 9031.0355s
	iters: 400, epoch: 29 | loss: 0.0159789
	speed: 0.3034s/iter; left time: 8899.4977s
Epoch: 29 cost time: 126.35205602645874
Epoch: 29, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.119 Vali Acc: 0.984 Test Loss: 0.119 Test Acc: 0.984
Validation loss decreased (-0.983628 --> -0.984082).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0001289
	speed: 0.6165s/iter; left time: 18017.3590s
	iters: 200, epoch: 30 | loss: 0.0000001
	speed: 0.3059s/iter; left time: 8908.6340s
	iters: 300, epoch: 30 | loss: 0.0000002
	speed: 0.3031s/iter; left time: 8796.8317s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.3121s/iter; left time: 9026.5956s
Epoch: 30 cost time: 127.47037315368652
Epoch: 30, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.114 Vali Acc: 0.981 Test Loss: 0.114 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.5943s/iter; left time: 17123.5633s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.2970s/iter; left time: 8527.0829s
	iters: 300, epoch: 31 | loss: 0.0925863
	speed: 0.3224s/iter; left time: 9224.3243s
	iters: 400, epoch: 31 | loss: 0.0000005
	speed: 0.3005s/iter; left time: 8566.6413s
Epoch: 31 cost time: 127.17871308326721
Epoch: 31, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.190 Vali Acc: 0.979 Test Loss: 0.190 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.5721s/iter; left time: 16247.6264s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.2887s/iter; left time: 8169.2133s
	iters: 300, epoch: 32 | loss: 0.0004535
	speed: 0.3021s/iter; left time: 8519.8140s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.3162s/iter; left time: 8884.3645s
Epoch: 32 cost time: 122.491055727005
Epoch: 32, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.268 Vali Acc: 0.975 Test Loss: 0.268 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.6365666
	speed: 0.5750s/iter; left time: 16092.2529s
	iters: 200, epoch: 33 | loss: 0.0048086
	speed: 0.3228s/iter; left time: 9000.6935s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.3106s/iter; left time: 8630.6169s
	iters: 400, epoch: 33 | loss: 0.0001396
	speed: 0.3032s/iter; left time: 8395.0799s
Epoch: 33 cost time: 127.57573509216309
Epoch: 33, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.230 Vali Acc: 0.969 Test Loss: 0.230 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.0000773
	speed: 0.5694s/iter; left time: 15700.7980s
	iters: 200, epoch: 34 | loss: 0.0000079
	speed: 0.3090s/iter; left time: 8489.1611s
	iters: 300, epoch: 34 | loss: 0.0000010
	speed: 0.3076s/iter; left time: 8419.9270s
	iters: 400, epoch: 34 | loss: 0.0000179
	speed: 0.2843s/iter; left time: 7754.3072s
Epoch: 34 cost time: 124.01518082618713
Epoch: 34, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.105 Vali Acc: 0.989 Test Loss: 0.105 Test Acc: 0.989
Validation loss decreased (-0.984082 --> -0.988630).  Saving model ...
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.6009s/iter; left time: 16319.3152s
	iters: 200, epoch: 35 | loss: 0.0000001
	speed: 0.3288s/iter; left time: 8898.2665s
	iters: 300, epoch: 35 | loss: 0.0003360
	speed: 0.2901s/iter; left time: 7821.9292s
	iters: 400, epoch: 35 | loss: 0.0000145
	speed: 0.3017s/iter; left time: 8104.3524s
Epoch: 35 cost time: 126.89306092262268
Epoch: 35, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.986 Test Loss: 0.090 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 0.0000001
	speed: 0.5899s/iter; left time: 15776.8977s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.2834s/iter; left time: 7551.0599s
	iters: 300, epoch: 36 | loss: 0.0001116
	speed: 0.3081s/iter; left time: 8179.1121s
	iters: 400, epoch: 36 | loss: 0.4406768
	speed: 0.2905s/iter; left time: 7682.0853s
Epoch: 36 cost time: 123.88589215278625
Epoch: 36, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.985 Test Loss: 0.119 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.6061s/iter; left time: 15960.4798s
	iters: 200, epoch: 37 | loss: 0.0000002
	speed: 0.3073s/iter; left time: 8061.6969s
	iters: 300, epoch: 37 | loss: 0.0014886
	speed: 0.2813s/iter; left time: 7351.6671s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.2773s/iter; left time: 7217.9881s
Epoch: 37 cost time: 122.42699694633484
Epoch: 37, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.267 Vali Acc: 0.968 Test Loss: 0.267 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.5841s/iter; left time: 15139.2074s
	iters: 200, epoch: 38 | loss: 0.0282030
	speed: 0.2839s/iter; left time: 7331.3043s
	iters: 300, epoch: 38 | loss: 0.0000001
	speed: 0.2845s/iter; left time: 7318.6258s
	iters: 400, epoch: 38 | loss: 0.0010494
	speed: 0.3126s/iter; left time: 8007.7574s
Epoch: 38 cost time: 122.3163857460022
Epoch: 38, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.115 Vali Acc: 0.982 Test Loss: 0.115 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 39 | loss: 0.0000005
	speed: 0.6000s/iter; left time: 15303.6211s
	iters: 200, epoch: 39 | loss: 0.0000000
	speed: 0.2944s/iter; left time: 7480.1368s
	iters: 300, epoch: 39 | loss: 0.0000003
	speed: 0.3141s/iter; left time: 7947.6776s
	iters: 400, epoch: 39 | loss: 1.6588628
	speed: 0.3055s/iter; left time: 7701.8255s
Epoch: 39 cost time: 126.26381421089172
Epoch: 39, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.119 Vali Acc: 0.982 Test Loss: 0.119 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 40 | loss: 0.0000005
	speed: 0.5782s/iter; left time: 14509.1055s
	iters: 200, epoch: 40 | loss: 0.0000463
	speed: 0.3052s/iter; left time: 7627.4146s
	iters: 300, epoch: 40 | loss: 0.0000001
	speed: 0.3087s/iter; left time: 7684.8784s
	iters: 400, epoch: 40 | loss: 0.0000009
	speed: 0.2979s/iter; left time: 7386.2589s
Epoch: 40 cost time: 124.72979021072388
Epoch: 40, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.106 Vali Acc: 0.983 Test Loss: 0.106 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 41 | loss: 0.0000000
	speed: 0.5777s/iter; left time: 14257.8418s
	iters: 200, epoch: 41 | loss: 0.0000052
	speed: 0.3197s/iter; left time: 7857.3330s
	iters: 300, epoch: 41 | loss: 0.0000183
	speed: 0.3005s/iter; left time: 7357.7215s
	iters: 400, epoch: 41 | loss: 0.0000000
	speed: 0.2911s/iter; left time: 7096.8336s
Epoch: 41 cost time: 124.83097124099731
Epoch: 41, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.134 Vali Acc: 0.982 Test Loss: 0.134 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 42 | loss: 0.0000001
	speed: 0.5800s/iter; left time: 14074.6051s
	iters: 200, epoch: 42 | loss: 0.0000001
	speed: 0.2962s/iter; left time: 7157.4776s
	iters: 300, epoch: 42 | loss: 0.0006621
	speed: 0.3002s/iter; left time: 7224.2279s
	iters: 400, epoch: 42 | loss: 0.0000000
	speed: 0.2920s/iter; left time: 6999.0999s
Epoch: 42 cost time: 124.83178496360779
Epoch: 42, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.984 Test Loss: 0.088 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 43 | loss: 0.0006511
	speed: 0.6113s/iter; left time: 14582.3841s
	iters: 200, epoch: 43 | loss: 0.0000231
	speed: 0.3094s/iter; left time: 7348.7364s
	iters: 300, epoch: 43 | loss: 0.0000134
	speed: 0.2536s/iter; left time: 5997.9067s
	iters: 400, epoch: 43 | loss: 0.0000022
	speed: 0.3152s/iter; left time: 7424.3704s
Epoch: 43 cost time: 123.47952651977539
Epoch: 43, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.182 Vali Acc: 0.981 Test Loss: 0.182 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 44 | loss: 0.0025135
	speed: 0.5916s/iter; left time: 13868.9154s
	iters: 200, epoch: 44 | loss: 0.0000004
	speed: 0.2749s/iter; left time: 6416.8511s
	iters: 300, epoch: 44 | loss: 0.0000000
	speed: 0.2897s/iter; left time: 6732.6140s
	iters: 400, epoch: 44 | loss: 0.0000020
	speed: 0.3150s/iter; left time: 7290.7022s
Epoch: 44 cost time: 123.23703742027283
Epoch: 44, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.090 Vali Acc: 0.987 Test Loss: 0.090 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.988631195998181
model parameter : 16118794
model size : 81.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1150053
	speed: 0.2816s/iter; left time: 11604.1600s
	iters: 200, epoch: 1 | loss: 0.1240881
	speed: 0.2742s/iter; left time: 11268.5699s
	iters: 300, epoch: 1 | loss: 0.7170855
	speed: 0.2661s/iter; left time: 10910.7147s
	iters: 400, epoch: 1 | loss: 0.0591043
	speed: 0.2772s/iter; left time: 11339.6601s
Epoch: 1 cost time: 113.50528478622437
Epoch: 1, Steps: 413 | Train Loss: 0.434 Vali Loss: 0.128 Vali Acc: 0.960 Test Loss: 0.128 Test Acc: 0.960
Validation loss decreased (inf --> -0.959526).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0903390
	speed: 0.5614s/iter; left time: 22897.1706s
	iters: 200, epoch: 2 | loss: 0.2492919
	speed: 0.2982s/iter; left time: 12132.1657s
	iters: 300, epoch: 2 | loss: 0.2099865
	speed: 0.2975s/iter; left time: 12074.8323s
	iters: 400, epoch: 2 | loss: 0.0029493
	speed: 0.3070s/iter; left time: 12431.1291s
Epoch: 2 cost time: 123.96402430534363
Epoch: 2, Steps: 413 | Train Loss: 0.304 Vali Loss: 0.364 Vali Acc: 0.941 Test Loss: 0.364 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.5215707
	speed: 0.5695s/iter; left time: 22992.3570s
	iters: 200, epoch: 3 | loss: 0.8484713
	speed: 0.2875s/iter; left time: 11580.8663s
	iters: 300, epoch: 3 | loss: 0.0001317
	speed: 0.2996s/iter; left time: 12034.5086s
	iters: 400, epoch: 3 | loss: 3.7285655
	speed: 0.2794s/iter; left time: 11197.9337s
Epoch: 3 cost time: 120.6110291481018
Epoch: 3, Steps: 413 | Train Loss: 0.380 Vali Loss: 0.320 Vali Acc: 0.956 Test Loss: 0.320 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.9984181
	speed: 0.5857s/iter; left time: 23406.0059s
	iters: 200, epoch: 4 | loss: 0.0378240
	speed: 0.3071s/iter; left time: 12243.1375s
	iters: 300, epoch: 4 | loss: 0.9432301
	speed: 0.2842s/iter; left time: 11300.9422s
	iters: 400, epoch: 4 | loss: 0.0002566
	speed: 0.3015s/iter; left time: 11958.9493s
Epoch: 4 cost time: 124.2958173751831
Epoch: 4, Steps: 413 | Train Loss: 0.316 Vali Loss: 0.435 Vali Acc: 0.950 Test Loss: 0.435 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.5198144
	speed: 0.5893s/iter; left time: 23307.5049s
	iters: 200, epoch: 5 | loss: 0.0885882
	speed: 0.2826s/iter; left time: 11149.8586s
	iters: 300, epoch: 5 | loss: 0.0000191
	speed: 0.2807s/iter; left time: 11045.3566s
	iters: 400, epoch: 5 | loss: 0.0001866
	speed: 0.2882s/iter; left time: 11310.7380s
Epoch: 5 cost time: 118.81593251228333
Epoch: 5, Steps: 413 | Train Loss: 0.240 Vali Loss: 0.463 Vali Acc: 0.956 Test Loss: 0.463 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.6721995
	speed: 0.5564s/iter; left time: 21773.6559s
	iters: 200, epoch: 6 | loss: 0.0000005
	speed: 0.2669s/iter; left time: 10418.7335s
	iters: 300, epoch: 6 | loss: 0.0789447
	speed: 0.2919s/iter; left time: 11365.5502s
	iters: 400, epoch: 6 | loss: 0.1043396
	speed: 0.2941s/iter; left time: 11423.0175s
Epoch: 6 cost time: 118.37036371231079
Epoch: 6, Steps: 413 | Train Loss: 0.219 Vali Loss: 0.436 Vali Acc: 0.953 Test Loss: 0.436 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.5883s/iter; left time: 22780.3562s
	iters: 200, epoch: 7 | loss: 0.0000086
	speed: 0.2966s/iter; left time: 11457.1331s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.2922s/iter; left time: 11256.2645s
	iters: 400, epoch: 7 | loss: 0.5414484
	speed: 0.3122s/iter; left time: 11994.3256s
Epoch: 7 cost time: 124.10176277160645
Epoch: 7, Steps: 413 | Train Loss: 0.146 Vali Loss: 0.369 Vali Acc: 0.963 Test Loss: 0.369 Test Acc: 0.963
Validation loss decreased (-0.959526 --> -0.963161).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000462
	speed: 0.5484s/iter; left time: 21008.2629s
	iters: 200, epoch: 8 | loss: 2.1503224
	speed: 0.2682s/iter; left time: 10246.4681s
	iters: 300, epoch: 8 | loss: 0.0000002
	speed: 0.2990s/iter; left time: 11394.5439s
	iters: 400, epoch: 8 | loss: 1.8663330
	speed: 0.2837s/iter; left time: 10784.3284s
Epoch: 8 cost time: 117.87237977981567
Epoch: 8, Steps: 413 | Train Loss: 0.203 Vali Loss: 0.370 Vali Acc: 0.967 Test Loss: 0.370 Test Acc: 0.967
Validation loss decreased (-0.963161 --> -0.967254).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.7700135
	speed: 0.5939s/iter; left time: 22506.8565s
	iters: 200, epoch: 9 | loss: 0.0000070
	speed: 0.2949s/iter; left time: 11148.2040s
	iters: 300, epoch: 9 | loss: 0.0000011
	speed: 0.2893s/iter; left time: 10906.2814s
	iters: 400, epoch: 9 | loss: 0.0045041
	speed: 0.2913s/iter; left time: 10952.1563s
Epoch: 9 cost time: 122.1638252735138
Epoch: 9, Steps: 413 | Train Loss: 0.144 Vali Loss: 0.268 Vali Acc: 0.975 Test Loss: 0.268 Test Acc: 0.975
Validation loss decreased (-0.967254 --> -0.974531).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000389
	speed: 0.5631s/iter; left time: 21105.8031s
	iters: 200, epoch: 10 | loss: 0.0260600
	speed: 0.2944s/iter; left time: 11007.6580s
	iters: 300, epoch: 10 | loss: 0.0000769
	speed: 0.2964s/iter; left time: 11050.8007s
	iters: 400, epoch: 10 | loss: 0.0001316
	speed: 0.2980s/iter; left time: 11080.6346s
Epoch: 10 cost time: 121.80206823348999
Epoch: 10, Steps: 413 | Train Loss: 0.111 Vali Loss: 0.621 Vali Acc: 0.959 Test Loss: 0.621 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.3555936
	speed: 0.5810s/iter; left time: 21539.2372s
	iters: 200, epoch: 11 | loss: 0.9356594
	speed: 0.2969s/iter; left time: 10977.8681s
	iters: 300, epoch: 11 | loss: 0.3732339
	speed: 0.3059s/iter; left time: 11278.4603s
	iters: 400, epoch: 11 | loss: 0.0000187
	speed: 0.2875s/iter; left time: 10570.5821s
Epoch: 11 cost time: 123.04748439788818
Epoch: 11, Steps: 413 | Train Loss: 0.193 Vali Loss: 0.391 Vali Acc: 0.964 Test Loss: 0.391 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.5581s/iter; left time: 20460.6288s
	iters: 200, epoch: 12 | loss: 0.0000055
	speed: 0.3016s/iter; left time: 11024.6035s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.2960s/iter; left time: 10792.1269s
	iters: 400, epoch: 12 | loss: 0.0201484
	speed: 0.2940s/iter; left time: 10689.5274s
Epoch: 12 cost time: 120.51863980293274
Epoch: 12, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.362 Vali Acc: 0.969 Test Loss: 0.362 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.5747s/iter; left time: 20829.2462s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.2920s/iter; left time: 10554.8186s
	iters: 300, epoch: 13 | loss: 0.3561527
	speed: 0.2957s/iter; left time: 10658.5147s
	iters: 400, epoch: 13 | loss: 0.0000142
	speed: 0.3060s/iter; left time: 10997.4965s
Epoch: 13 cost time: 123.86800813674927
Epoch: 13, Steps: 413 | Train Loss: 0.111 Vali Loss: 0.278 Vali Acc: 0.971 Test Loss: 0.278 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.5527s/iter; left time: 19804.2703s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.2715s/iter; left time: 9702.3549s
	iters: 300, epoch: 14 | loss: 0.0001442
	speed: 0.2940s/iter; left time: 10475.8915s
	iters: 400, epoch: 14 | loss: 0.0116831
	speed: 0.2847s/iter; left time: 10116.7548s
Epoch: 14 cost time: 116.70552849769592
Epoch: 14, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.550 Vali Acc: 0.958 Test Loss: 0.550 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.3198471
	speed: 0.6019s/iter; left time: 21318.1070s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.3022s/iter; left time: 10674.3564s
	iters: 300, epoch: 15 | loss: 0.0000018
	speed: 0.2736s/iter; left time: 9634.6549s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.3001s/iter; left time: 10537.8206s
Epoch: 15 cost time: 123.08197164535522
Epoch: 15, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.320 Vali Acc: 0.971 Test Loss: 0.320 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.1365588
	speed: 0.5637s/iter; left time: 19732.5193s
	iters: 200, epoch: 16 | loss: 0.0716720
	speed: 0.2978s/iter; left time: 10394.8250s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.2872s/iter; left time: 9995.4233s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.2995s/iter; left time: 10394.9293s
Epoch: 16 cost time: 121.2806601524353
Epoch: 16, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.484 Vali Acc: 0.967 Test Loss: 0.484 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0000030
	speed: 0.5823s/iter; left time: 20143.1026s
	iters: 200, epoch: 17 | loss: 0.0723777
	speed: 0.2942s/iter; left time: 10149.5395s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.3048s/iter; left time: 10483.8110s
	iters: 400, epoch: 17 | loss: 0.3877545
	speed: 0.2997s/iter; left time: 10278.5104s
Epoch: 17 cost time: 124.0582377910614
Epoch: 17, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.353 Vali Acc: 0.981 Test Loss: 0.353 Test Acc: 0.981
Validation loss decreased (-0.974531 --> -0.981352).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000009
	speed: 0.5770s/iter; left time: 19720.1985s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.2938s/iter; left time: 10011.2292s
	iters: 300, epoch: 18 | loss: 0.6047947
	speed: 0.2935s/iter; left time: 9973.0890s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.2938s/iter; left time: 9953.9739s
Epoch: 18 cost time: 121.14367604255676
Epoch: 18, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.371 Vali Acc: 0.968 Test Loss: 0.371 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000311
	speed: 0.5798s/iter; left time: 19578.1660s
	iters: 200, epoch: 19 | loss: 0.6550965
	speed: 0.3034s/iter; left time: 10213.8712s
	iters: 300, epoch: 19 | loss: 0.0000013
	speed: 0.2825s/iter; left time: 9482.6953s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.2910s/iter; left time: 9738.4713s
Epoch: 19 cost time: 121.27939343452454
Epoch: 19, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.313 Vali Acc: 0.971 Test Loss: 0.313 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.5653s/iter; left time: 18856.0154s
	iters: 200, epoch: 20 | loss: 0.0000001
	speed: 0.2842s/iter; left time: 9449.8503s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.3059s/iter; left time: 10140.3208s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.3035s/iter; left time: 10030.9371s
Epoch: 20 cost time: 123.88354420661926
Epoch: 20, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.155 Vali Acc: 0.984 Test Loss: 0.155 Test Acc: 0.984
Validation loss decreased (-0.981352 --> -0.984082).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.5906s/iter; left time: 19453.9073s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.2917s/iter; left time: 9578.8963s
	iters: 300, epoch: 21 | loss: 0.0000002
	speed: 0.2823s/iter; left time: 9242.9891s
	iters: 400, epoch: 21 | loss: 1.1967703
	speed: 0.2834s/iter; left time: 9250.3787s
Epoch: 21 cost time: 119.82005858421326
Epoch: 21, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.257 Vali Acc: 0.974 Test Loss: 0.257 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0941657
	speed: 0.5765s/iter; left time: 18753.0599s
	iters: 200, epoch: 22 | loss: 0.0000001
	speed: 0.3116s/iter; left time: 10103.3525s
	iters: 300, epoch: 22 | loss: 0.0000002
	speed: 0.2813s/iter; left time: 9095.0395s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.3056s/iter; left time: 9848.1227s
Epoch: 22 cost time: 123.28585052490234
Epoch: 22, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.219 Vali Acc: 0.975 Test Loss: 0.219 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 1.9247705
	speed: 0.5647s/iter; left time: 18136.8585s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.2908s/iter; left time: 9309.1937s
	iters: 300, epoch: 23 | loss: 0.8654425
	speed: 0.2913s/iter; left time: 9297.1580s
	iters: 400, epoch: 23 | loss: 0.0003592
	speed: 0.2797s/iter; left time: 8897.5422s
Epoch: 23 cost time: 119.32949018478394
Epoch: 23, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.300 Vali Acc: 0.971 Test Loss: 0.300 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.5347s/iter; left time: 16952.2619s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.2710s/iter; left time: 8564.7648s
	iters: 300, epoch: 24 | loss: 0.0000017
	speed: 0.2805s/iter; left time: 8837.8816s
	iters: 400, epoch: 24 | loss: 0.0682383
	speed: 0.3033s/iter; left time: 9524.1855s
Epoch: 24 cost time: 116.45053839683533
Epoch: 24, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.180 Vali Acc: 0.976 Test Loss: 0.180 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000003
	speed: 0.5942s/iter; left time: 18591.6520s
	iters: 200, epoch: 25 | loss: 0.0000004
	speed: 0.2988s/iter; left time: 9318.1442s
	iters: 300, epoch: 25 | loss: 0.0000034
	speed: 0.2828s/iter; left time: 8790.7011s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.2933s/iter; left time: 9088.6211s
Epoch: 25 cost time: 121.66297912597656
Epoch: 25, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.205 Vali Acc: 0.979 Test Loss: 0.205 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.5656s/iter; left time: 17463.3992s
	iters: 200, epoch: 26 | loss: 0.0000328
	speed: 0.2772s/iter; left time: 8531.3000s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.3117s/iter; left time: 9560.9963s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.2944s/iter; left time: 9003.0007s
Epoch: 26 cost time: 123.00780844688416
Epoch: 26, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.242 Vali Acc: 0.977 Test Loss: 0.242 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.6122s/iter; left time: 18650.8552s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.3160s/iter; left time: 9595.6425s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.2755s/iter; left time: 8337.0980s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.2962s/iter; left time: 8933.4310s
Epoch: 27 cost time: 124.58387637138367
Epoch: 27, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.168 Vali Acc: 0.983 Test Loss: 0.168 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0000087
	speed: 0.5599s/iter; left time: 16825.8715s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.2758s/iter; left time: 8260.9351s
	iters: 300, epoch: 28 | loss: 0.0001791
	speed: 0.3061s/iter; left time: 9138.0788s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.2988s/iter; left time: 8888.1950s
Epoch: 28 cost time: 121.90820288658142
Epoch: 28, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.212 Vali Acc: 0.977 Test Loss: 0.212 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0005564
	speed: 0.5996s/iter; left time: 17768.8734s
	iters: 200, epoch: 29 | loss: 0.4016150
	speed: 0.2966s/iter; left time: 8760.2682s
	iters: 300, epoch: 29 | loss: 0.0000002
	speed: 0.2791s/iter; left time: 8216.3910s
	iters: 400, epoch: 29 | loss: 0.0000134
	speed: 0.2834s/iter; left time: 8313.5940s
Epoch: 29 cost time: 120.60961771011353
Epoch: 29, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.414 Vali Acc: 0.965 Test Loss: 0.414 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0000002
	speed: 0.5519s/iter; left time: 16129.6510s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.2852s/iter; left time: 8307.1668s
	iters: 300, epoch: 30 | loss: 0.0000004
	speed: 0.2978s/iter; left time: 8644.1680s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.3013s/iter; left time: 8713.7229s
Epoch: 30 cost time: 120.8858757019043
Epoch: 30, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.321 Vali Acc: 0.969 Test Loss: 0.321 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9840836743974534
model parameter : 16118794
model size : 81.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2429830
	speed: 0.2923s/iter; left time: 12041.7822s
	iters: 200, epoch: 1 | loss: 0.4114437
	speed: 0.2741s/iter; left time: 11264.6481s
	iters: 300, epoch: 1 | loss: 0.7279873
	speed: 0.2958s/iter; left time: 12127.1547s
	iters: 400, epoch: 1 | loss: 0.4468004
	speed: 0.2891s/iter; left time: 11825.3543s
Epoch: 1 cost time: 118.7972023487091
Epoch: 1, Steps: 413 | Train Loss: 0.531 Vali Loss: 0.277 Vali Acc: 0.940 Test Loss: 0.277 Test Acc: 0.940
Validation loss decreased (inf --> -0.939970).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1984659
	speed: 0.5704s/iter; left time: 23266.9758s
	iters: 200, epoch: 2 | loss: 0.0029510
	speed: 0.3047s/iter; left time: 12396.4499s
	iters: 300, epoch: 2 | loss: 0.0486822
	speed: 0.2985s/iter; left time: 12114.5388s
	iters: 400, epoch: 2 | loss: 0.0129635
	speed: 0.3014s/iter; left time: 12204.2395s
Epoch: 2 cost time: 123.46317434310913
Epoch: 2, Steps: 413 | Train Loss: 0.331 Vali Loss: 0.369 Vali Acc: 0.934 Test Loss: 0.369 Test Acc: 0.934
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.6339498
	speed: 0.5795s/iter; left time: 23397.0929s
	iters: 200, epoch: 3 | loss: 0.0537846
	speed: 0.2881s/iter; left time: 11601.5080s
	iters: 300, epoch: 3 | loss: 0.0026683
	speed: 0.2741s/iter; left time: 11011.1113s
	iters: 400, epoch: 3 | loss: 2.8876224
	speed: 0.2938s/iter; left time: 11773.9827s
Epoch: 3 cost time: 119.36277794837952
Epoch: 3, Steps: 413 | Train Loss: 0.309 Vali Loss: 0.259 Vali Acc: 0.950 Test Loss: 0.259 Test Acc: 0.950
Validation loss decreased (-0.939970 --> -0.949520).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.1725131
	speed: 0.5755s/iter; left time: 22998.0951s
	iters: 200, epoch: 4 | loss: 0.4281912
	speed: 0.2978s/iter; left time: 11870.6604s
	iters: 300, epoch: 4 | loss: 1.0923138
	speed: 0.3016s/iter; left time: 11991.7776s
	iters: 400, epoch: 4 | loss: 0.0000094
	speed: 0.2949s/iter; left time: 11698.0699s
Epoch: 4 cost time: 122.92499995231628
Epoch: 4, Steps: 413 | Train Loss: 0.369 Vali Loss: 0.277 Vali Acc: 0.963 Test Loss: 0.277 Test Acc: 0.963
Validation loss decreased (-0.949520 --> -0.963162).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000186
	speed: 0.5902s/iter; left time: 23341.3238s
	iters: 200, epoch: 5 | loss: 0.7917477
	speed: 0.2795s/iter; left time: 11026.8237s
	iters: 300, epoch: 5 | loss: 0.0112268
	speed: 0.2789s/iter; left time: 10974.5943s
	iters: 400, epoch: 5 | loss: 0.0000000
	speed: 0.2908s/iter; left time: 11411.7093s
Epoch: 5 cost time: 119.45786547660828
Epoch: 5, Steps: 413 | Train Loss: 0.240 Vali Loss: 0.185 Vali Acc: 0.976 Test Loss: 0.185 Test Acc: 0.976
Validation loss decreased (-0.963162 --> -0.975896).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.3246180
	speed: 0.5799s/iter; left time: 22694.4904s
	iters: 200, epoch: 6 | loss: 0.1234412
	speed: 0.2996s/iter; left time: 11695.9266s
	iters: 300, epoch: 6 | loss: 0.7926572
	speed: 0.3051s/iter; left time: 11877.6188s
	iters: 400, epoch: 6 | loss: 0.0001075
	speed: 0.3071s/iter; left time: 11926.1367s
Epoch: 6 cost time: 124.95427012443542
Epoch: 6, Steps: 413 | Train Loss: 0.279 Vali Loss: 0.266 Vali Acc: 0.971 Test Loss: 0.266 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000477
	speed: 0.5647s/iter; left time: 21868.0415s
	iters: 200, epoch: 7 | loss: 0.0008421
	speed: 0.2939s/iter; left time: 11350.0848s
	iters: 300, epoch: 7 | loss: 0.0001251
	speed: 0.2827s/iter; left time: 10890.4725s
	iters: 400, epoch: 7 | loss: 0.8250130
	speed: 0.2822s/iter; left time: 10843.1993s
Epoch: 7 cost time: 119.0968496799469
Epoch: 7, Steps: 413 | Train Loss: 0.189 Vali Loss: 0.426 Vali Acc: 0.961 Test Loss: 0.426 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0002759
	speed: 0.5615s/iter; left time: 21509.6335s
	iters: 200, epoch: 8 | loss: 0.2871574
	speed: 0.3014s/iter; left time: 11517.9270s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.3044s/iter; left time: 11602.0381s
	iters: 400, epoch: 8 | loss: 0.2750764
	speed: 0.2845s/iter; left time: 10815.1874s
Epoch: 8 cost time: 122.43421530723572
Epoch: 8, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.686 Vali Acc: 0.942 Test Loss: 0.686 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000033
	speed: 0.5658s/iter; left time: 21443.1962s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.2946s/iter; left time: 11133.7269s
	iters: 300, epoch: 9 | loss: 0.0000230
	speed: 0.2727s/iter; left time: 10279.6066s
	iters: 400, epoch: 9 | loss: 0.0000098
	speed: 0.2906s/iter; left time: 10926.5678s
Epoch: 9 cost time: 117.75087714195251
Epoch: 9, Steps: 413 | Train Loss: 0.158 Vali Loss: 0.353 Vali Acc: 0.968 Test Loss: 0.353 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0890363
	speed: 0.5768s/iter; left time: 21622.4592s
	iters: 200, epoch: 10 | loss: 0.0439516
	speed: 0.2998s/iter; left time: 11209.4796s
	iters: 300, epoch: 10 | loss: 0.0006420
	speed: 0.3026s/iter; left time: 11282.7525s
	iters: 400, epoch: 10 | loss: 0.2569493
	speed: 0.2964s/iter; left time: 11020.9860s
Epoch: 10 cost time: 124.39407062530518
Epoch: 10, Steps: 413 | Train Loss: 0.113 Vali Loss: 0.174 Vali Acc: 0.982 Test Loss: 0.174 Test Acc: 0.982
Validation loss decreased (-0.975896 --> -0.981808).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000022
	speed: 0.5537s/iter; left time: 20525.5553s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.2956s/iter; left time: 10929.8247s
	iters: 300, epoch: 11 | loss: 0.0007592
	speed: 0.2616s/iter; left time: 9647.0651s
	iters: 400, epoch: 11 | loss: 0.0003934
	speed: 0.2942s/iter; left time: 10816.7094s
Epoch: 11 cost time: 115.18218207359314
Epoch: 11, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.212 Vali Acc: 0.974 Test Loss: 0.212 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000436
	speed: 0.5794s/iter; left time: 21238.0282s
	iters: 200, epoch: 12 | loss: 0.0000001
	speed: 0.2961s/iter; left time: 10823.4874s
	iters: 300, epoch: 12 | loss: 0.0004130
	speed: 0.2989s/iter; left time: 10896.8696s
	iters: 400, epoch: 12 | loss: 0.0000001
	speed: 0.2850s/iter; left time: 10361.9714s
Epoch: 12 cost time: 122.06639456748962
Epoch: 12, Steps: 413 | Train Loss: 0.148 Vali Loss: 0.268 Vali Acc: 0.967 Test Loss: 0.268 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.5686s/iter; left time: 20608.6140s
	iters: 200, epoch: 13 | loss: 0.0002090
	speed: 0.3046s/iter; left time: 11009.5103s
	iters: 300, epoch: 13 | loss: 0.0000002
	speed: 0.2761s/iter; left time: 9952.8039s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.2996s/iter; left time: 10770.8098s
Epoch: 13 cost time: 120.58274579048157
Epoch: 13, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.262 Vali Acc: 0.974 Test Loss: 0.262 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.5648s/iter; left time: 20238.3130s
	iters: 200, epoch: 14 | loss: 0.0049051
	speed: 0.3101s/iter; left time: 11081.9444s
	iters: 300, epoch: 14 | loss: 0.0066929
	speed: 0.2994s/iter; left time: 10667.9756s
	iters: 400, epoch: 14 | loss: 0.0000022
	speed: 0.2843s/iter; left time: 10102.1209s
Epoch: 14 cost time: 122.57749271392822
Epoch: 14, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.261 Vali Acc: 0.973 Test Loss: 0.261 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.5631s/iter; left time: 19943.0259s
	iters: 200, epoch: 15 | loss: 0.0001422
	speed: 0.2822s/iter; left time: 9966.3720s
	iters: 300, epoch: 15 | loss: 0.0601821
	speed: 0.2988s/iter; left time: 10524.9521s
	iters: 400, epoch: 15 | loss: 0.0000192
	speed: 0.2905s/iter; left time: 10200.5873s
Epoch: 15 cost time: 120.5810170173645
Epoch: 15, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.285 Vali Acc: 0.971 Test Loss: 0.285 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000003
	speed: 0.5807s/iter; left time: 20326.9867s
	iters: 200, epoch: 16 | loss: 0.0000032
	speed: 0.3100s/iter; left time: 10820.9959s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.2798s/iter; left time: 9740.4427s
	iters: 400, epoch: 16 | loss: 0.0000001
	speed: 0.2753s/iter; left time: 9555.7007s
Epoch: 16 cost time: 120.1783835887909
Epoch: 16, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.380 Vali Acc: 0.967 Test Loss: 0.380 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000505
	speed: 0.5704s/iter; left time: 19731.1740s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.2933s/iter; left time: 10117.9233s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.2949s/iter; left time: 10140.9130s
	iters: 400, epoch: 17 | loss: 0.0000906
	speed: 0.3018s/iter; left time: 10350.7668s
Epoch: 17 cost time: 123.01796269416809
Epoch: 17, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.177 Vali Acc: 0.981 Test Loss: 0.177 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.5731s/iter; left time: 19590.0032s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.3073s/iter; left time: 10472.0429s
	iters: 300, epoch: 18 | loss: 0.0000091
	speed: 0.2864s/iter; left time: 9730.7231s
	iters: 400, epoch: 18 | loss: 0.0000107
	speed: 0.3020s/iter; left time: 10231.5609s
Epoch: 18 cost time: 123.18983387947083
Epoch: 18, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.376 Vali Acc: 0.970 Test Loss: 0.376 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0224442
	speed: 0.5771s/iter; left time: 19488.3822s
	iters: 200, epoch: 19 | loss: 0.0267063
	speed: 0.2841s/iter; left time: 9564.7039s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.3060s/iter; left time: 10270.0663s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.3002s/iter; left time: 10047.1894s
Epoch: 19 cost time: 124.09371256828308
Epoch: 19, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.171 Vali Acc: 0.974 Test Loss: 0.171 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.1203934
	speed: 0.5911s/iter; left time: 19717.0915s
	iters: 200, epoch: 20 | loss: 0.0022877
	speed: 0.3038s/iter; left time: 10103.2357s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.2857s/iter; left time: 9472.2518s
	iters: 400, epoch: 20 | loss: 0.0000034
	speed: 0.3017s/iter; left time: 9971.4223s
Epoch: 20 cost time: 123.31371927261353
Epoch: 20, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.158 Vali Acc: 0.978 Test Loss: 0.158 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9818099135970896
model parameter : 16118794
model size : 81.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1431781
	speed: 0.3178s/iter; left time: 13094.4047s
	iters: 200, epoch: 1 | loss: 0.5393464
	speed: 0.2898s/iter; left time: 11910.7497s
	iters: 300, epoch: 1 | loss: 1.0407127
	speed: 0.3009s/iter; left time: 12335.5751s
	iters: 400, epoch: 1 | loss: 0.3609045
	speed: 0.3027s/iter; left time: 12379.9531s
Epoch: 1 cost time: 125.41829681396484
Epoch: 1, Steps: 413 | Train Loss: 0.563 Vali Loss: 0.302 Vali Acc: 0.930 Test Loss: 0.302 Test Acc: 0.930
Validation loss decreased (inf --> -0.929510).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1384906
	speed: 0.5831s/iter; left time: 23782.7503s
	iters: 200, epoch: 2 | loss: 0.0146845
	speed: 0.3112s/iter; left time: 12660.8935s
	iters: 300, epoch: 2 | loss: 0.2991789
	speed: 0.2870s/iter; left time: 11647.1415s
	iters: 400, epoch: 2 | loss: 0.0265793
	speed: 0.3054s/iter; left time: 12365.2850s
Epoch: 2 cost time: 124.16221952438354
Epoch: 2, Steps: 413 | Train Loss: 0.318 Vali Loss: 0.235 Vali Acc: 0.946 Test Loss: 0.235 Test Acc: 0.946
Validation loss decreased (-0.929510 --> -0.946337).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.9305449
	speed: 0.5897s/iter; left time: 23808.8107s
	iters: 200, epoch: 3 | loss: 0.5172310
	speed: 0.2959s/iter; left time: 11917.1759s
	iters: 300, epoch: 3 | loss: 0.0024845
	speed: 0.3048s/iter; left time: 12243.7451s
	iters: 400, epoch: 3 | loss: 2.3476851
	speed: 0.3070s/iter; left time: 12301.1239s
Epoch: 3 cost time: 126.0308587551117
Epoch: 3, Steps: 413 | Train Loss: 0.427 Vali Loss: 0.287 Vali Acc: 0.950 Test Loss: 0.287 Test Acc: 0.950
Validation loss decreased (-0.946337 --> -0.949974).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000061
	speed: 0.5885s/iter; left time: 23519.4606s
	iters: 200, epoch: 4 | loss: 0.2805228
	speed: 0.2915s/iter; left time: 11620.2669s
	iters: 300, epoch: 4 | loss: 0.0000007
	speed: 0.2917s/iter; left time: 11600.0426s
	iters: 400, epoch: 4 | loss: 0.2843513
	speed: 0.2841s/iter; left time: 11267.0053s
Epoch: 4 cost time: 120.16365075111389
Epoch: 4, Steps: 413 | Train Loss: 0.257 Vali Loss: 0.261 Vali Acc: 0.965 Test Loss: 0.261 Test Acc: 0.965
Validation loss decreased (-0.949974 --> -0.964527).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.5783s/iter; left time: 22872.9096s
	iters: 200, epoch: 5 | loss: 0.2039252
	speed: 0.3051s/iter; left time: 12036.3857s
	iters: 300, epoch: 5 | loss: 0.1296951
	speed: 0.2999s/iter; left time: 11801.9444s
	iters: 400, epoch: 5 | loss: 0.0000020
	speed: 0.3128s/iter; left time: 12278.1334s
Epoch: 5 cost time: 124.93554759025574
Epoch: 5, Steps: 413 | Train Loss: 0.249 Vali Loss: 0.384 Vali Acc: 0.962 Test Loss: 0.384 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0091119
	speed: 0.5664s/iter; left time: 22165.8051s
	iters: 200, epoch: 6 | loss: 0.0000004
	speed: 0.2854s/iter; left time: 11139.7732s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.2884s/iter; left time: 11229.1421s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.2711s/iter; left time: 10529.6167s
Epoch: 6 cost time: 118.52530169487
Epoch: 6, Steps: 413 | Train Loss: 0.216 Vali Loss: 0.290 Vali Acc: 0.969 Test Loss: 0.290 Test Acc: 0.969
Validation loss decreased (-0.964527 --> -0.969074).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000009
	speed: 0.5696s/iter; left time: 22055.1954s
	iters: 200, epoch: 7 | loss: 0.0000014
	speed: 0.2821s/iter; left time: 10896.3128s
	iters: 300, epoch: 7 | loss: 0.0017595
	speed: 0.3073s/iter; left time: 11840.0312s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.3086s/iter; left time: 11858.0955s
Epoch: 7 cost time: 121.87870192527771
Epoch: 7, Steps: 413 | Train Loss: 0.122 Vali Loss: 0.469 Vali Acc: 0.959 Test Loss: 0.469 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0659451
	speed: 0.5700s/iter; left time: 21837.9085s
	iters: 200, epoch: 8 | loss: 0.8079662
	speed: 0.2910s/iter; left time: 11118.8074s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.2774s/iter; left time: 10573.0303s
	iters: 400, epoch: 8 | loss: 0.1217316
	speed: 0.2881s/iter; left time: 10952.0141s
Epoch: 8 cost time: 119.04951000213623
Epoch: 8, Steps: 413 | Train Loss: 0.187 Vali Loss: 0.550 Vali Acc: 0.962 Test Loss: 0.550 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000004
	speed: 0.6209s/iter; left time: 23530.9661s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.3223s/iter; left time: 12183.7573s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.3416s/iter; left time: 12877.2353s
	iters: 400, epoch: 9 | loss: 0.1058471
	speed: 0.3431s/iter; left time: 12899.8640s
Epoch: 9 cost time: 138.3908166885376
Epoch: 9, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.286 Vali Acc: 0.965 Test Loss: 0.286 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0022966
	speed: 0.6375s/iter; left time: 23897.2881s
	iters: 200, epoch: 10 | loss: 0.8619253
	speed: 0.3309s/iter; left time: 12371.7175s
	iters: 300, epoch: 10 | loss: 0.9410594
	speed: 0.3177s/iter; left time: 11846.4580s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.3094s/iter; left time: 11506.3474s
Epoch: 10 cost time: 132.20870757102966
Epoch: 10, Steps: 413 | Train Loss: 0.126 Vali Loss: 0.199 Vali Acc: 0.973 Test Loss: 0.199 Test Acc: 0.973
Validation loss decreased (-0.969074 --> -0.973168).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.6672s/iter; left time: 24732.5992s
	iters: 200, epoch: 11 | loss: 0.0000017
	speed: 0.3266s/iter; left time: 12075.3636s
	iters: 300, epoch: 11 | loss: 0.0023992
	speed: 0.3183s/iter; left time: 11734.7627s
	iters: 400, epoch: 11 | loss: 0.0001663
	speed: 0.3266s/iter; left time: 12009.0744s
Epoch: 11 cost time: 135.5505154132843
Epoch: 11, Steps: 413 | Train Loss: 0.108 Vali Loss: 0.276 Vali Acc: 0.973 Test Loss: 0.276 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.2967937
	speed: 0.6277s/iter; left time: 23009.5088s
	iters: 200, epoch: 12 | loss: 0.0009073
	speed: 0.2926s/iter; left time: 10697.4950s
	iters: 300, epoch: 12 | loss: 0.0000087
	speed: 0.2925s/iter; left time: 10664.1221s
	iters: 400, epoch: 12 | loss: 0.0677778
	speed: 0.3018s/iter; left time: 10971.7767s
Epoch: 12 cost time: 123.76549410820007
Epoch: 12, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.143 Vali Acc: 0.980 Test Loss: 0.143 Test Acc: 0.980
Validation loss decreased (-0.973168 --> -0.979535).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.5929s/iter; left time: 21491.0757s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.2957s/iter; left time: 10688.4418s
	iters: 300, epoch: 13 | loss: 0.0000005
	speed: 0.2911s/iter; left time: 10493.7837s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.2997s/iter; left time: 10771.7340s
Epoch: 13 cost time: 122.3770911693573
Epoch: 13, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.385 Vali Acc: 0.962 Test Loss: 0.385 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.5835s/iter; left time: 20909.5314s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.2871s/iter; left time: 10257.4932s
	iters: 300, epoch: 14 | loss: 0.2789261
	speed: 0.2923s/iter; left time: 10413.9470s
	iters: 400, epoch: 14 | loss: 0.0000236
	speed: 0.2888s/iter; left time: 10260.4023s
Epoch: 14 cost time: 122.66612076759338
Epoch: 14, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.209 Vali Acc: 0.981 Test Loss: 0.209 Test Acc: 0.981
Validation loss decreased (-0.979535 --> -0.980898).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.5939s/iter; left time: 21035.8835s
	iters: 200, epoch: 15 | loss: 0.0000001
	speed: 0.3069s/iter; left time: 10838.5173s
	iters: 300, epoch: 15 | loss: 0.0009116
	speed: 0.3028s/iter; left time: 10665.0388s
	iters: 400, epoch: 15 | loss: 0.0232912
	speed: 0.2988s/iter; left time: 10494.3111s
Epoch: 15 cost time: 124.51799035072327
Epoch: 15, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.304 Vali Acc: 0.965 Test Loss: 0.304 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0061434
	speed: 0.5627s/iter; left time: 19696.2815s
	iters: 200, epoch: 16 | loss: 0.9483150
	speed: 0.3025s/iter; left time: 10560.3171s
	iters: 300, epoch: 16 | loss: 0.0000003
	speed: 0.2758s/iter; left time: 9599.1223s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.2886s/iter; left time: 10017.4268s
Epoch: 16 cost time: 119.58232474327087
Epoch: 16, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.137 Vali Acc: 0.981 Test Loss: 0.137 Test Acc: 0.981
Validation loss decreased (-0.980898 --> -0.980899).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000004
	speed: 0.5840s/iter; left time: 20202.5237s
	iters: 200, epoch: 17 | loss: 0.0326128
	speed: 0.3103s/iter; left time: 10703.1832s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.2959s/iter; left time: 10178.1947s
	iters: 400, epoch: 17 | loss: 0.0476963
	speed: 0.3027s/iter; left time: 10381.5610s
Epoch: 17 cost time: 123.39338397979736
Epoch: 17, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.333 Vali Acc: 0.965 Test Loss: 0.333 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000064
	speed: 0.5696s/iter; left time: 19469.8617s
	iters: 200, epoch: 18 | loss: 0.0000021
	speed: 0.3021s/iter; left time: 10296.0628s
	iters: 300, epoch: 18 | loss: 0.0000002
	speed: 0.2819s/iter; left time: 9579.2128s
	iters: 400, epoch: 18 | loss: 0.0000014
	speed: 0.3001s/iter; left time: 10168.6901s
Epoch: 18 cost time: 122.0705406665802
Epoch: 18, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.213 Vali Acc: 0.972 Test Loss: 0.213 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0013692
	speed: 0.5668s/iter; left time: 19139.2170s
	iters: 200, epoch: 19 | loss: 0.0000003
	speed: 0.2877s/iter; left time: 9686.2779s
	iters: 300, epoch: 19 | loss: 0.0000228
	speed: 0.3060s/iter; left time: 10271.2420s
	iters: 400, epoch: 19 | loss: 0.0000001
	speed: 0.2976s/iter; left time: 9961.0792s
Epoch: 19 cost time: 123.80921697616577
Epoch: 19, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.207 Vali Acc: 0.979 Test Loss: 0.207 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000004
	speed: 0.5815s/iter; left time: 19393.8012s
	iters: 200, epoch: 20 | loss: 0.0001419
	speed: 0.2915s/iter; left time: 9692.3299s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.2915s/iter; left time: 9663.8870s
	iters: 400, epoch: 20 | loss: 0.0000167
	speed: 0.2873s/iter; left time: 9495.7816s
Epoch: 20 cost time: 120.60988140106201
Epoch: 20, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.399 Vali Acc: 0.953 Test Loss: 0.399 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000001
	speed: 0.5806s/iter; left time: 19124.4762s
	iters: 200, epoch: 21 | loss: 0.0002688
	speed: 0.3076s/iter; left time: 10101.6857s
	iters: 300, epoch: 21 | loss: 0.0000463
	speed: 0.2823s/iter; left time: 9243.9648s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.3014s/iter; left time: 9839.1647s
Epoch: 21 cost time: 122.53378891944885
Epoch: 21, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.073 Vali Acc: 0.989 Test Loss: 0.073 Test Acc: 0.989
Validation loss decreased (-0.980899 --> -0.988630).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0055522
	speed: 0.5989s/iter; left time: 19482.5497s
	iters: 200, epoch: 22 | loss: 0.0468841
	speed: 0.3079s/iter; left time: 9986.1034s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.3017s/iter; left time: 9754.6123s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.3075s/iter; left time: 9909.3369s
Epoch: 22 cost time: 127.03458499908447
Epoch: 22, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.098 Vali Acc: 0.984 Test Loss: 0.098 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.5431s/iter; left time: 17441.2748s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.2883s/iter; left time: 9228.8427s
	iters: 300, epoch: 23 | loss: 0.0000013
	speed: 0.2935s/iter; left time: 9365.5294s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.2760s/iter; left time: 8782.3046s
Epoch: 23 cost time: 116.63046145439148
Epoch: 23, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.133 Vali Acc: 0.980 Test Loss: 0.133 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.5609s/iter; left time: 17780.4879s
	iters: 200, epoch: 24 | loss: 0.0000006
	speed: 0.2811s/iter; left time: 8883.0160s
	iters: 300, epoch: 24 | loss: 0.0000001
	speed: 0.2741s/iter; left time: 8633.2463s
	iters: 400, epoch: 24 | loss: 0.0000082
	speed: 0.2617s/iter; left time: 8218.8229s
Epoch: 24 cost time: 114.29229354858398
Epoch: 24, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.157 Vali Acc: 0.981 Test Loss: 0.157 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.2189551
	speed: 0.5447s/iter; left time: 17043.7086s
	iters: 200, epoch: 25 | loss: 0.0089276
	speed: 0.2843s/iter; left time: 8868.0325s
	iters: 300, epoch: 25 | loss: 0.0020456
	speed: 0.2815s/iter; left time: 8751.6748s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.2850s/iter; left time: 8832.0176s
Epoch: 25 cost time: 115.58882308006287
Epoch: 25, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.117 Vali Acc: 0.982 Test Loss: 0.117 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.5859s/iter; left time: 18089.2153s
	iters: 200, epoch: 26 | loss: 0.0000243
	speed: 0.2862s/iter; left time: 8807.1867s
	iters: 300, epoch: 26 | loss: 0.0000030
	speed: 0.2924s/iter; left time: 8970.2716s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.2884s/iter; left time: 8819.2931s
Epoch: 26 cost time: 121.29658222198486
Epoch: 26, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.158 Vali Acc: 0.980 Test Loss: 0.158 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.5669s/iter; left time: 17269.5273s
	iters: 200, epoch: 27 | loss: 0.0002721
	speed: 0.2973s/iter; left time: 9025.4032s
	iters: 300, epoch: 27 | loss: 0.0000115
	speed: 0.3079s/iter; left time: 9316.9932s
	iters: 400, epoch: 27 | loss: 0.0009567
	speed: 0.2888s/iter; left time: 8712.3782s
Epoch: 27 cost time: 123.66769242286682
Epoch: 27, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.121 Vali Acc: 0.983 Test Loss: 0.121 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0000606
	speed: 0.5734s/iter; left time: 17231.0182s
	iters: 200, epoch: 28 | loss: 0.1760331
	speed: 0.2980s/iter; left time: 8925.5229s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.2834s/iter; left time: 8458.7004s
	iters: 400, epoch: 28 | loss: 0.0000518
	speed: 0.2965s/iter; left time: 8819.5245s
Epoch: 28 cost time: 119.93955492973328
Epoch: 28, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.099 Vali Acc: 0.987 Test Loss: 0.099 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0000001
	speed: 0.5810s/iter; left time: 17219.4436s
	iters: 200, epoch: 29 | loss: 0.0014477
	speed: 0.2851s/iter; left time: 8419.5227s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.2914s/iter; left time: 8576.9012s
	iters: 400, epoch: 29 | loss: 0.0000420
	speed: 0.2957s/iter; left time: 8674.2134s
Epoch: 29 cost time: 120.39215278625488
Epoch: 29, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.145 Vali Acc: 0.979 Test Loss: 0.145 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0000004
	speed: 0.5785s/iter; left time: 16904.7371s
	iters: 200, epoch: 30 | loss: 0.0000035
	speed: 0.2874s/iter; left time: 8369.0946s
	iters: 300, epoch: 30 | loss: 0.0000010
	speed: 0.3110s/iter; left time: 9025.9711s
	iters: 400, epoch: 30 | loss: 0.0000004
	speed: 0.2839s/iter; left time: 8210.5154s
Epoch: 30 cost time: 122.43324565887451
Epoch: 30, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.151 Vali Acc: 0.981 Test Loss: 0.151 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0000012
	speed: 0.5901s/iter; left time: 17001.0965s
	iters: 200, epoch: 31 | loss: 0.0020375
	speed: 0.2992s/iter; left time: 8590.2357s
	iters: 300, epoch: 31 | loss: 0.0000026
	speed: 0.2964s/iter; left time: 8480.8385s
	iters: 400, epoch: 31 | loss: 0.0000028
	speed: 0.3108s/iter; left time: 8860.0830s
Epoch: 31 cost time: 124.55735111236572
Epoch: 31, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.110 Vali Acc: 0.984 Test Loss: 0.110 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.988631195998181
model parameter : 16118794
model size : 81.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1826582
	speed: 0.2845s/iter; left time: 11722.8097s
	iters: 200, epoch: 1 | loss: 0.4000461
	speed: 0.2669s/iter; left time: 10970.7182s
	iters: 300, epoch: 1 | loss: 0.8059757
	speed: 0.2721s/iter; left time: 11155.7839s
	iters: 400, epoch: 1 | loss: 0.4339893
	speed: 0.2503s/iter; left time: 10238.4069s
Epoch: 1 cost time: 111.29899835586548
Epoch: 1, Steps: 413 | Train Loss: 0.559 Vali Loss: 0.273 Vali Acc: 0.934 Test Loss: 0.273 Test Acc: 0.934
Validation loss decreased (inf --> -0.934058).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1841827
	speed: 0.5649s/iter; left time: 23039.2721s
	iters: 200, epoch: 2 | loss: 0.3306416
	speed: 0.3015s/iter; left time: 12266.6172s
	iters: 300, epoch: 2 | loss: 0.8180346
	speed: 0.2953s/iter; left time: 11986.2084s
	iters: 400, epoch: 2 | loss: 1.1058911
	speed: 0.3081s/iter; left time: 12473.0197s
Epoch: 2 cost time: 122.7210681438446
Epoch: 2, Steps: 413 | Train Loss: 0.395 Vali Loss: 0.586 Vali Acc: 0.899 Test Loss: 0.586 Test Acc: 0.899
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0045035
	speed: 0.5704s/iter; left time: 23029.9785s
	iters: 200, epoch: 3 | loss: 0.7316543
	speed: 0.2921s/iter; left time: 11765.0073s
	iters: 300, epoch: 3 | loss: 0.0004161
	speed: 0.2821s/iter; left time: 11334.7570s
	iters: 400, epoch: 3 | loss: 2.7536345
	speed: 0.2946s/iter; left time: 11806.8726s
Epoch: 3 cost time: 120.33483719825745
Epoch: 3, Steps: 413 | Train Loss: 0.465 Vali Loss: 0.383 Vali Acc: 0.937 Test Loss: 0.383 Test Acc: 0.937
Validation loss decreased (-0.934058 --> -0.937240).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0978435
	speed: 0.5754s/iter; left time: 22994.5064s
	iters: 200, epoch: 4 | loss: 0.0328092
	speed: 0.2863s/iter; left time: 11412.7104s
	iters: 300, epoch: 4 | loss: 0.2447957
	speed: 0.2971s/iter; left time: 11813.5239s
	iters: 400, epoch: 4 | loss: 0.0074773
	speed: 0.2906s/iter; left time: 11527.6790s
Epoch: 4 cost time: 120.57581114768982
Epoch: 4, Steps: 413 | Train Loss: 0.398 Vali Loss: 0.225 Vali Acc: 0.955 Test Loss: 0.225 Test Acc: 0.955
Validation loss decreased (-0.937240 --> -0.954977).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000705
	speed: 0.5669s/iter; left time: 22419.3235s
	iters: 200, epoch: 5 | loss: 0.0184482
	speed: 0.3074s/iter; left time: 12126.4187s
	iters: 300, epoch: 5 | loss: 0.3358721
	speed: 0.2893s/iter; left time: 11384.5845s
	iters: 400, epoch: 5 | loss: 0.0011601
	speed: 0.2702s/iter; left time: 10605.4159s
Epoch: 5 cost time: 117.76883578300476
Epoch: 5, Steps: 413 | Train Loss: 0.212 Vali Loss: 0.276 Vali Acc: 0.955 Test Loss: 0.276 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0470041
	speed: 0.5466s/iter; left time: 21393.4024s
	iters: 200, epoch: 6 | loss: 0.0000255
	speed: 0.2950s/iter; left time: 11515.1232s
	iters: 300, epoch: 6 | loss: 0.0000007
	speed: 0.2972s/iter; left time: 11573.6245s
	iters: 400, epoch: 6 | loss: 0.0202972
	speed: 0.2960s/iter; left time: 11496.0922s
Epoch: 6 cost time: 120.07405471801758
Epoch: 6, Steps: 413 | Train Loss: 0.207 Vali Loss: 0.220 Vali Acc: 0.962 Test Loss: 0.220 Test Acc: 0.962
Validation loss decreased (-0.954977 --> -0.962253).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0002137
	speed: 0.5713s/iter; left time: 22121.0519s
	iters: 200, epoch: 7 | loss: 0.3747099
	speed: 0.2983s/iter; left time: 11521.6158s
	iters: 300, epoch: 7 | loss: 0.0000245
	speed: 0.2639s/iter; left time: 10167.2381s
	iters: 400, epoch: 7 | loss: 0.0880348
	speed: 0.2729s/iter; left time: 10485.5992s
Epoch: 7 cost time: 115.44805836677551
Epoch: 7, Steps: 413 | Train Loss: 0.166 Vali Loss: 0.697 Vali Acc: 0.920 Test Loss: 0.697 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1566355
	speed: 0.5508s/iter; left time: 21102.3570s
	iters: 200, epoch: 8 | loss: 0.0283986
	speed: 0.2941s/iter; left time: 11236.3081s
	iters: 300, epoch: 8 | loss: 0.0000058
	speed: 0.3085s/iter; left time: 11757.7314s
	iters: 400, epoch: 8 | loss: 1.6193161
	speed: 0.3040s/iter; left time: 11554.2155s
Epoch: 8 cost time: 124.88719630241394
Epoch: 8, Steps: 413 | Train Loss: 0.158 Vali Loss: 0.384 Vali Acc: 0.955 Test Loss: 0.384 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0176277
	speed: 0.5537s/iter; left time: 20982.8911s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.2891s/iter; left time: 10925.3922s
	iters: 300, epoch: 9 | loss: 0.0000004
	speed: 0.2655s/iter; left time: 10007.0117s
	iters: 400, epoch: 9 | loss: 0.0613311
	speed: 0.2887s/iter; left time: 10853.0325s
Epoch: 9 cost time: 114.81850051879883
Epoch: 9, Steps: 413 | Train Loss: 0.125 Vali Loss: 0.271 Vali Acc: 0.957 Test Loss: 0.271 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0873004
	speed: 0.5689s/iter; left time: 21322.7820s
	iters: 200, epoch: 10 | loss: 0.0017346
	speed: 0.3059s/iter; left time: 11436.7638s
	iters: 300, epoch: 10 | loss: 0.0000025
	speed: 0.3072s/iter; left time: 11453.0233s
	iters: 400, epoch: 10 | loss: 0.4682741
	speed: 0.2977s/iter; left time: 11071.3940s
Epoch: 10 cost time: 125.21298289299011
Epoch: 10, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.276 Vali Acc: 0.973 Test Loss: 0.276 Test Acc: 0.973
Validation loss decreased (-0.962253 --> -0.973167).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0281099
	speed: 0.5824s/iter; left time: 21588.9932s
	iters: 200, epoch: 11 | loss: 0.0032787
	speed: 0.2916s/iter; left time: 10779.3632s
	iters: 300, epoch: 11 | loss: 0.0027121
	speed: 0.2975s/iter; left time: 10968.6451s
	iters: 400, epoch: 11 | loss: 0.0002116
	speed: 0.2766s/iter; left time: 10169.0596s
Epoch: 11 cost time: 119.83922696113586
Epoch: 11, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.199 Vali Acc: 0.974 Test Loss: 0.199 Test Acc: 0.974
Validation loss decreased (-0.973167 --> -0.974077).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0736065
	speed: 0.5792s/iter; left time: 21233.3400s
	iters: 200, epoch: 12 | loss: 0.7309716
	speed: 0.2928s/iter; left time: 10704.7882s
	iters: 300, epoch: 12 | loss: 0.0519219
	speed: 0.2978s/iter; left time: 10855.7275s
	iters: 400, epoch: 12 | loss: 0.0004607
	speed: 0.3049s/iter; left time: 11084.5327s
Epoch: 12 cost time: 121.6422393321991
Epoch: 12, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.346 Vali Acc: 0.954 Test Loss: 0.346 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000029
	speed: 0.5834s/iter; left time: 21145.4606s
	iters: 200, epoch: 13 | loss: 0.0697604
	speed: 0.2893s/iter; left time: 10456.2921s
	iters: 300, epoch: 13 | loss: 0.0674534
	speed: 0.2932s/iter; left time: 10568.8457s
	iters: 400, epoch: 13 | loss: 0.0000018
	speed: 0.2764s/iter; left time: 9934.6796s
Epoch: 13 cost time: 119.05178165435791
Epoch: 13, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.203 Vali Acc: 0.972 Test Loss: 0.203 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000005
	speed: 0.5895s/iter; left time: 21122.0449s
	iters: 200, epoch: 14 | loss: 0.1947782
	speed: 0.2906s/iter; left time: 10383.9623s
	iters: 300, epoch: 14 | loss: 0.0056354
	speed: 0.3145s/iter; left time: 11205.4161s
	iters: 400, epoch: 14 | loss: 0.0000003
	speed: 0.3068s/iter; left time: 10901.8737s
Epoch: 14 cost time: 126.6656904220581
Epoch: 14, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.254 Vali Acc: 0.963 Test Loss: 0.254 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000020
	speed: 0.6222s/iter; left time: 22038.4748s
	iters: 200, epoch: 15 | loss: 0.0000007
	speed: 0.2985s/iter; left time: 10542.4839s
	iters: 300, epoch: 15 | loss: 0.0046981
	speed: 0.2953s/iter; left time: 10399.1409s
	iters: 400, epoch: 15 | loss: 0.2117867
	speed: 0.2851s/iter; left time: 10012.8979s
Epoch: 15 cost time: 122.84680938720703
Epoch: 15, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.330 Vali Acc: 0.964 Test Loss: 0.330 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0354873
	speed: 0.6213s/iter; left time: 21749.5008s
	iters: 200, epoch: 16 | loss: 0.0002264
	speed: 0.3163s/iter; left time: 11041.9154s
	iters: 300, epoch: 16 | loss: 0.0000004
	speed: 0.3128s/iter; left time: 10887.6121s
	iters: 400, epoch: 16 | loss: 0.0000002
	speed: 0.3164s/iter; left time: 10981.9169s
Epoch: 16 cost time: 130.38838171958923
Epoch: 16, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.110 Vali Acc: 0.978 Test Loss: 0.110 Test Acc: 0.978
Validation loss decreased (-0.974077 --> -0.978171).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000187
	speed: 0.6222s/iter; left time: 21524.0397s
	iters: 200, epoch: 17 | loss: 0.0082327
	speed: 0.2988s/iter; left time: 10305.1842s
	iters: 300, epoch: 17 | loss: 0.1102082
	speed: 0.3018s/iter; left time: 10379.9066s
	iters: 400, epoch: 17 | loss: 0.9776331
	speed: 0.3041s/iter; left time: 10427.8149s
Epoch: 17 cost time: 126.71752595901489
Epoch: 17, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.165 Vali Acc: 0.975 Test Loss: 0.165 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000167
	speed: 0.6217s/iter; left time: 21250.6888s
	iters: 200, epoch: 18 | loss: 0.0012346
	speed: 0.3027s/iter; left time: 10317.6334s
	iters: 300, epoch: 18 | loss: 0.0139476
	speed: 0.2994s/iter; left time: 10171.9675s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.3021s/iter; left time: 10236.2471s
Epoch: 18 cost time: 127.50728249549866
Epoch: 18, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.300 Vali Acc: 0.960 Test Loss: 0.300 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000010
	speed: 0.6332s/iter; left time: 21382.6025s
	iters: 200, epoch: 19 | loss: 0.0000004
	speed: 0.3065s/iter; left time: 10318.2581s
	iters: 300, epoch: 19 | loss: 0.0050441
	speed: 0.2966s/iter; left time: 9956.8851s
	iters: 400, epoch: 19 | loss: 0.0018178
	speed: 0.3070s/iter; left time: 10275.2008s
Epoch: 19 cost time: 127.72718167304993
Epoch: 19, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.134 Vali Acc: 0.974 Test Loss: 0.134 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000011
	speed: 0.6140s/iter; left time: 20479.7725s
	iters: 200, epoch: 20 | loss: 0.0013481
	speed: 0.2831s/iter; left time: 9414.1604s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.3053s/iter; left time: 10120.6697s
	iters: 400, epoch: 20 | loss: 0.0000198
	speed: 0.2959s/iter; left time: 9780.9119s
Epoch: 20 cost time: 122.64979195594788
Epoch: 20, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.177 Vali Acc: 0.970 Test Loss: 0.177 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0005719
	speed: 0.6005s/iter; left time: 19779.7130s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.2871s/iter; left time: 9427.6642s
	iters: 300, epoch: 21 | loss: 0.3151107
	speed: 0.2945s/iter; left time: 9640.7029s
	iters: 400, epoch: 21 | loss: 0.0138936
	speed: 0.3050s/iter; left time: 9954.9648s
Epoch: 21 cost time: 122.88639736175537
Epoch: 21, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.424 Vali Acc: 0.966 Test Loss: 0.424 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0042217
	speed: 0.6049s/iter; left time: 19674.8359s
	iters: 200, epoch: 22 | loss: 0.0000620
	speed: 0.3183s/iter; left time: 10321.5069s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.3255s/iter; left time: 10521.7136s
	iters: 400, epoch: 22 | loss: 0.0002040
	speed: 0.3259s/iter; left time: 10501.9234s
Epoch: 22 cost time: 131.8001217842102
Epoch: 22, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.267 Vali Acc: 0.956 Test Loss: 0.267 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0000168
	speed: 0.6039s/iter; left time: 19395.7052s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.3161s/iter; left time: 10120.1415s
	iters: 300, epoch: 23 | loss: 0.2503867
	speed: 0.2988s/iter; left time: 9535.7988s
	iters: 400, epoch: 23 | loss: 0.0000285
	speed: 0.2938s/iter; left time: 9346.7825s
Epoch: 23 cost time: 126.67878890037537
Epoch: 23, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.135 Vali Acc: 0.975 Test Loss: 0.135 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0000084
	speed: 0.6360s/iter; left time: 20161.4480s
	iters: 200, epoch: 24 | loss: 0.0000003
	speed: 0.2932s/iter; left time: 9264.1876s
	iters: 300, epoch: 24 | loss: 0.0000004
	speed: 0.2738s/iter; left time: 8626.1262s
	iters: 400, epoch: 24 | loss: 0.0038391
	speed: 0.2814s/iter; left time: 8836.6031s
Epoch: 24 cost time: 120.36217212677002
Epoch: 24, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0000047
	speed: 0.6107s/iter; left time: 19108.0851s
	iters: 200, epoch: 25 | loss: 0.0000001
	speed: 0.3035s/iter; left time: 9465.6510s
	iters: 300, epoch: 25 | loss: 0.0139543
	speed: 0.3080s/iter; left time: 9574.4561s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.3068s/iter; left time: 9505.9271s
Epoch: 25 cost time: 127.4703586101532
Epoch: 25, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.187 Vali Acc: 0.975 Test Loss: 0.187 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0000002
	speed: 0.5933s/iter; left time: 18319.7666s
	iters: 200, epoch: 26 | loss: 0.0000009
	speed: 0.2929s/iter; left time: 9013.1595s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.2821s/iter; left time: 8653.0688s
	iters: 400, epoch: 26 | loss: 0.0000001
	speed: 0.2843s/iter; left time: 8692.8321s
Epoch: 26 cost time: 119.06546783447266
Epoch: 26, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.139 Vali Acc: 0.975 Test Loss: 0.139 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9781718963165075
model parameter : 16118794
model size : 81.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1508046
	speed: 0.3366s/iter; left time: 13869.5423s
	iters: 200, epoch: 1 | loss: 0.4501964
	speed: 0.3134s/iter; left time: 12880.2934s
	iters: 300, epoch: 1 | loss: 0.2002595
	speed: 0.3166s/iter; left time: 12979.4820s
	iters: 400, epoch: 1 | loss: 0.8077817
	speed: 0.3117s/iter; left time: 12747.2323s
Epoch: 1 cost time: 132.24935054779053
Epoch: 1, Steps: 413 | Train Loss: 0.533 Vali Loss: 0.730 Vali Acc: 0.858 Test Loss: 0.730 Test Acc: 0.858
Validation loss decreased (inf --> -0.857655).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5217752
	speed: 0.6559s/iter; left time: 26754.7906s
	iters: 200, epoch: 2 | loss: 0.0836023
	speed: 0.3335s/iter; left time: 13570.4140s
	iters: 300, epoch: 2 | loss: 0.1370409
	speed: 0.3103s/iter; left time: 12595.4636s
	iters: 400, epoch: 2 | loss: 0.6241618
	speed: 0.3117s/iter; left time: 12620.4229s
Epoch: 2 cost time: 133.3757312297821
Epoch: 2, Steps: 413 | Train Loss: 0.358 Vali Loss: 0.634 Vali Acc: 0.902 Test Loss: 0.634 Test Acc: 0.902
Validation loss decreased (-0.857655 --> -0.901767).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1530049
	speed: 0.6814s/iter; left time: 27512.6366s
	iters: 200, epoch: 3 | loss: 0.0057406
	speed: 0.3518s/iter; left time: 14167.2657s
	iters: 300, epoch: 3 | loss: 0.0002636
	speed: 0.3435s/iter; left time: 13798.6721s
	iters: 400, epoch: 3 | loss: 3.9343314
	speed: 0.3333s/iter; left time: 13358.4315s
Epoch: 3 cost time: 141.8648819923401
Epoch: 3, Steps: 413 | Train Loss: 0.410 Vali Loss: 0.394 Vali Acc: 0.934 Test Loss: 0.394 Test Acc: 0.934
Validation loss decreased (-0.901767 --> -0.933602).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0923785
	speed: 0.5971s/iter; left time: 23862.1751s
	iters: 200, epoch: 4 | loss: 0.5213023
	speed: 0.3082s/iter; left time: 12283.9394s
	iters: 300, epoch: 4 | loss: 0.2496021
	speed: 0.3015s/iter; left time: 11987.1474s
	iters: 400, epoch: 4 | loss: 0.0059128
	speed: 0.3224s/iter; left time: 12787.0730s
Epoch: 4 cost time: 127.36977219581604
Epoch: 4, Steps: 413 | Train Loss: 0.344 Vali Loss: 0.338 Vali Acc: 0.953 Test Loss: 0.338 Test Acc: 0.953
Validation loss decreased (-0.933602 --> -0.952702).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0237970
	speed: 0.6066s/iter; left time: 23990.1308s
	iters: 200, epoch: 5 | loss: 0.0000752
	speed: 0.3332s/iter; left time: 13146.3114s
	iters: 300, epoch: 5 | loss: 0.2058952
	speed: 0.3431s/iter; left time: 13499.6053s
	iters: 400, epoch: 5 | loss: 0.0017941
	speed: 0.3430s/iter; left time: 13462.9464s
Epoch: 5 cost time: 137.22709965705872
Epoch: 5, Steps: 413 | Train Loss: 0.207 Vali Loss: 0.314 Vali Acc: 0.950 Test Loss: 0.314 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.2330201
	speed: 0.6611s/iter; left time: 25870.8967s
	iters: 200, epoch: 6 | loss: 0.0000003
	speed: 0.3365s/iter; left time: 13137.0186s
	iters: 300, epoch: 6 | loss: 0.1181669
	speed: 0.3358s/iter; left time: 13075.0186s
	iters: 400, epoch: 6 | loss: 0.0008517
	speed: 0.3448s/iter; left time: 13388.8975s
Epoch: 6 cost time: 139.65583634376526
Epoch: 6, Steps: 413 | Train Loss: 0.193 Vali Loss: 0.263 Vali Acc: 0.962 Test Loss: 0.263 Test Acc: 0.962
Validation loss decreased (-0.952702 --> -0.961798).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000006
	speed: 0.6719s/iter; left time: 26019.7091s
	iters: 200, epoch: 7 | loss: 0.0399905
	speed: 0.3381s/iter; left time: 13060.3637s
	iters: 300, epoch: 7 | loss: 0.0000023
	speed: 0.3625s/iter; left time: 13966.2706s
	iters: 400, epoch: 7 | loss: 0.1084448
	speed: 0.3673s/iter; left time: 14111.0604s
Epoch: 7 cost time: 145.38783526420593
Epoch: 7, Steps: 413 | Train Loss: 0.146 Vali Loss: 0.395 Vali Acc: 0.957 Test Loss: 0.395 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0020989
	speed: 0.6792s/iter; left time: 26019.0303s
	iters: 200, epoch: 8 | loss: 0.1067725
	speed: 0.3336s/iter; left time: 12747.6849s
	iters: 300, epoch: 8 | loss: 0.0000001
	speed: 0.3569s/iter; left time: 13602.1530s
	iters: 400, epoch: 8 | loss: 0.0000401
	speed: 0.3692s/iter; left time: 14034.7623s
Epoch: 8 cost time: 143.9727509021759
Epoch: 8, Steps: 413 | Train Loss: 0.164 Vali Loss: 0.258 Vali Acc: 0.963 Test Loss: 0.258 Test Acc: 0.963
Validation loss decreased (-0.961798 --> -0.963162).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000732
	speed: 0.7167s/iter; left time: 27159.7692s
	iters: 200, epoch: 9 | loss: 0.0000078
	speed: 0.3519s/iter; left time: 13302.4070s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.3397s/iter; left time: 12806.6452s
	iters: 400, epoch: 9 | loss: 0.3620576
	speed: 0.3482s/iter; left time: 13090.7568s
Epoch: 9 cost time: 144.6253092288971
Epoch: 9, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.346 Vali Acc: 0.958 Test Loss: 0.346 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.5287611
	speed: 0.7389s/iter; left time: 27697.3567s
	iters: 200, epoch: 10 | loss: 0.0000067
	speed: 0.3526s/iter; left time: 13179.7487s
	iters: 300, epoch: 10 | loss: 0.1217498
	speed: 0.3542s/iter; left time: 13204.8761s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.3610s/iter; left time: 13423.2745s
Epoch: 10 cost time: 149.2112169265747
Epoch: 10, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.187 Vali Acc: 0.973 Test Loss: 0.187 Test Acc: 0.973
Validation loss decreased (-0.963162 --> -0.972713).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.2956151
	speed: 0.7234s/iter; left time: 26817.4845s
	iters: 200, epoch: 11 | loss: 0.0801595
	speed: 0.3613s/iter; left time: 13357.0783s
	iters: 300, epoch: 11 | loss: 0.8644283
	speed: 0.3645s/iter; left time: 13438.6246s
	iters: 400, epoch: 11 | loss: 0.0859020
	speed: 0.3617s/iter; left time: 13298.5170s
Epoch: 11 cost time: 149.10987854003906
Epoch: 11, Steps: 413 | Train Loss: 0.140 Vali Loss: 0.186 Vali Acc: 0.970 Test Loss: 0.186 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.7173s/iter; left time: 26296.3704s
	iters: 200, epoch: 12 | loss: 0.0000199
	speed: 0.3747s/iter; left time: 13699.0865s
	iters: 300, epoch: 12 | loss: 0.0031712
	speed: 0.3445s/iter; left time: 12561.1343s
	iters: 400, epoch: 12 | loss: 0.0000169
	speed: 0.3287s/iter; left time: 11952.6922s
Epoch: 12 cost time: 145.83855390548706
Epoch: 12, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.326 Vali Acc: 0.958 Test Loss: 0.326 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.6793s/iter; left time: 24621.8064s
	iters: 200, epoch: 13 | loss: 0.0000014
	speed: 0.3496s/iter; left time: 12637.4964s
	iters: 300, epoch: 13 | loss: 0.2804684
	speed: 0.3391s/iter; left time: 12222.8453s
	iters: 400, epoch: 13 | loss: 0.0000003
	speed: 0.3226s/iter; left time: 11597.2783s
Epoch: 13 cost time: 140.36640167236328
Epoch: 13, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.356 Vali Acc: 0.961 Test Loss: 0.356 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000005
	speed: 0.6337s/iter; left time: 22708.4529s
	iters: 200, epoch: 14 | loss: 0.0001225
	speed: 0.3275s/iter; left time: 11701.9033s
	iters: 300, epoch: 14 | loss: 0.0000016
	speed: 0.3296s/iter; left time: 11742.5405s
	iters: 400, epoch: 14 | loss: 0.0000189
	speed: 0.3281s/iter; left time: 11658.4594s
Epoch: 14 cost time: 135.18132424354553
Epoch: 14, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.152 Vali Acc: 0.977 Test Loss: 0.152 Test Acc: 0.977
Validation loss decreased (-0.972713 --> -0.976806).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0068958
	speed: 0.6699s/iter; left time: 23727.7437s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.3370s/iter; left time: 11903.6425s
	iters: 300, epoch: 15 | loss: 0.0164827
	speed: 0.3399s/iter; left time: 11971.8527s
	iters: 400, epoch: 15 | loss: 0.0017092
	speed: 0.3472s/iter; left time: 12193.1070s
Epoch: 15 cost time: 140.53059887886047
Epoch: 15, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.149 Vali Acc: 0.968 Test Loss: 0.149 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000004
	speed: 0.6971s/iter; left time: 24403.0163s
	iters: 200, epoch: 16 | loss: 0.0776654
	speed: 0.3335s/iter; left time: 11641.1513s
	iters: 300, epoch: 16 | loss: 0.0618925
	speed: 0.3271s/iter; left time: 11385.8639s
	iters: 400, epoch: 16 | loss: 0.0000057
	speed: 0.3428s/iter; left time: 11895.5611s
Epoch: 16 cost time: 139.54611921310425
Epoch: 16, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.139 Vali Acc: 0.980 Test Loss: 0.139 Test Acc: 0.980
Validation loss decreased (-0.976806 --> -0.979990).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000014
	speed: 0.7093s/iter; left time: 24536.4626s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.3327s/iter; left time: 11476.8685s
	iters: 300, epoch: 17 | loss: 0.0000599
	speed: 0.3459s/iter; left time: 11895.4292s
	iters: 400, epoch: 17 | loss: 0.1468225
	speed: 0.3454s/iter; left time: 11844.4254s
Epoch: 17 cost time: 142.89992475509644
Epoch: 17, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.209 Vali Acc: 0.970 Test Loss: 0.209 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000001
	speed: 0.6813s/iter; left time: 23288.2676s
	iters: 200, epoch: 18 | loss: 0.0001122
	speed: 0.3461s/iter; left time: 11793.5017s
	iters: 300, epoch: 18 | loss: 0.4467955
	speed: 0.3475s/iter; left time: 11807.2659s
	iters: 400, epoch: 18 | loss: 0.0000023
	speed: 0.3313s/iter; left time: 11223.7461s
Epoch: 18 cost time: 140.23720741271973
Epoch: 18, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.166 Vali Acc: 0.972 Test Loss: 0.166 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000753
	speed: 0.6461s/iter; left time: 21815.8819s
	iters: 200, epoch: 19 | loss: 0.0000108
	speed: 0.3401s/iter; left time: 11450.7273s
	iters: 300, epoch: 19 | loss: 0.0000001
	speed: 0.3449s/iter; left time: 11578.0376s
	iters: 400, epoch: 19 | loss: 0.0000034
	speed: 0.3456s/iter; left time: 11567.1829s
Epoch: 19 cost time: 141.53096413612366
Epoch: 19, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979990 --> -0.980444).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000161
	speed: 0.6965s/iter; left time: 23230.9090s
	iters: 200, epoch: 20 | loss: 0.0003869
	speed: 0.3663s/iter; left time: 12182.2456s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.3575s/iter; left time: 11852.0435s
	iters: 400, epoch: 20 | loss: 0.4375140
	speed: 0.3452s/iter; left time: 11410.2647s
Epoch: 20 cost time: 146.7762713432312
Epoch: 20, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.152 Vali Acc: 0.975 Test Loss: 0.152 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000204
	speed: 0.6825s/iter; left time: 22481.2180s
	iters: 200, epoch: 21 | loss: 0.0887647
	speed: 0.3340s/iter; left time: 10968.5501s
	iters: 300, epoch: 21 | loss: 0.0000016
	speed: 0.3394s/iter; left time: 11110.7357s
	iters: 400, epoch: 21 | loss: 0.2168607
	speed: 0.3431s/iter; left time: 11197.5214s
Epoch: 21 cost time: 140.60883450508118
Epoch: 21, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.354 Vali Acc: 0.955 Test Loss: 0.354 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.1750619
	speed: 0.6766s/iter; left time: 22007.0840s
	iters: 200, epoch: 22 | loss: 0.0000100
	speed: 0.3230s/iter; left time: 10475.3898s
	iters: 300, epoch: 22 | loss: 0.0005478
	speed: 0.3363s/iter; left time: 10870.9628s
	iters: 400, epoch: 22 | loss: 0.0618461
	speed: 0.3522s/iter; left time: 11352.2551s
Epoch: 22 cost time: 138.77674889564514
Epoch: 22, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.121 Vali Acc: 0.979 Test Loss: 0.121 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0000861
	speed: 0.6804s/iter; left time: 21852.6426s
	iters: 200, epoch: 23 | loss: 0.0000004
	speed: 0.3241s/iter; left time: 10374.9839s
	iters: 300, epoch: 23 | loss: 0.0001186
	speed: 0.3319s/iter; left time: 10592.4139s
	iters: 400, epoch: 23 | loss: 0.0000069
	speed: 0.3441s/iter; left time: 10947.9650s
Epoch: 23 cost time: 138.3055944442749
Epoch: 23, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.166 Vali Acc: 0.977 Test Loss: 0.166 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.7104s/iter; left time: 22522.5548s
	iters: 200, epoch: 24 | loss: 0.0000954
	speed: 0.3558s/iter; left time: 11243.9443s
	iters: 300, epoch: 24 | loss: 0.0000320
	speed: 0.3519s/iter; left time: 11084.8981s
	iters: 400, epoch: 24 | loss: 0.0014887
	speed: 0.3426s/iter; left time: 10757.4185s
Epoch: 24 cost time: 145.7241232395172
Epoch: 24, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0623892
	speed: 0.6934s/iter; left time: 21696.6615s
	iters: 200, epoch: 25 | loss: 0.0000289
	speed: 0.3477s/iter; left time: 10843.6249s
	iters: 300, epoch: 25 | loss: 0.0008351
	speed: 0.3399s/iter; left time: 10568.3348s
	iters: 400, epoch: 25 | loss: 0.0009018
	speed: 0.3344s/iter; left time: 10363.7533s
Epoch: 25 cost time: 141.8570442199707
Epoch: 25, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.144 Vali Acc: 0.974 Test Loss: 0.144 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0003526
	speed: 0.7005s/iter; left time: 21629.9998s
	iters: 200, epoch: 26 | loss: 0.0000214
	speed: 0.3729s/iter; left time: 11477.6876s
	iters: 300, epoch: 26 | loss: 0.0000101
	speed: 0.3805s/iter; left time: 11672.3215s
	iters: 400, epoch: 26 | loss: 0.0000009
	speed: 0.3644s/iter; left time: 11141.1818s
Epoch: 26 cost time: 153.29049730300903
Epoch: 26, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.163 Vali Acc: 0.972 Test Loss: 0.163 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0000002
	speed: 0.7328s/iter; left time: 22322.2226s
	iters: 200, epoch: 27 | loss: 0.0055764
	speed: 0.3563s/iter; left time: 10817.6025s
	iters: 300, epoch: 27 | loss: 0.0000311
	speed: 0.3407s/iter; left time: 10311.1023s
	iters: 400, epoch: 27 | loss: 0.0187661
	speed: 0.3499s/iter; left time: 10552.6483s
Epoch: 27 cost time: 145.44830584526062
Epoch: 27, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0004542
	speed: 0.6656s/iter; left time: 20001.2422s
	iters: 200, epoch: 28 | loss: 0.0000006
	speed: 0.3354s/iter; left time: 10044.0721s
	iters: 300, epoch: 28 | loss: 0.0000004
	speed: 0.3549s/iter; left time: 10594.5010s
	iters: 400, epoch: 28 | loss: 0.0002105
	speed: 0.3640s/iter; left time: 10829.3181s
Epoch: 28 cost time: 143.13006925582886
Epoch: 28, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.347 Vali Acc: 0.966 Test Loss: 0.347 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0617249
	speed: 0.6594s/iter; left time: 19542.8984s
	iters: 200, epoch: 29 | loss: 0.0455220
	speed: 0.3214s/iter; left time: 9494.2034s
	iters: 300, epoch: 29 | loss: 0.0000082
	speed: 0.3289s/iter; left time: 9682.4455s
	iters: 400, epoch: 29 | loss: 0.0000040
	speed: 0.3362s/iter; left time: 9863.5728s
Epoch: 29 cost time: 135.76872181892395
Epoch: 29, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.086 Vali Acc: 0.982 Test Loss: 0.086 Test Acc: 0.982
Validation loss decreased (-0.980444 --> -0.981809).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0000253
	speed: 0.6490s/iter; left time: 18966.0090s
	iters: 200, epoch: 30 | loss: 0.0000029
	speed: 0.3280s/iter; left time: 9552.7546s
	iters: 300, epoch: 30 | loss: 0.0060040
	speed: 0.3299s/iter; left time: 9575.5507s
	iters: 400, epoch: 30 | loss: 0.0000002
	speed: 0.3400s/iter; left time: 9833.6891s
Epoch: 30 cost time: 136.9627103805542
Epoch: 30, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0000007
	speed: 0.6807s/iter; left time: 19612.5604s
	iters: 200, epoch: 31 | loss: 0.0000045
	speed: 0.3324s/iter; left time: 9542.9877s
	iters: 300, epoch: 31 | loss: 0.0000025
	speed: 0.3359s/iter; left time: 9609.1100s
	iters: 400, epoch: 31 | loss: 0.0000087
	speed: 0.3373s/iter; left time: 9616.6995s
Epoch: 31 cost time: 138.93303179740906
Epoch: 31, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.7157s/iter; left time: 20323.3129s
	iters: 200, epoch: 32 | loss: 0.0000087
	speed: 0.3792s/iter; left time: 10731.3195s
	iters: 300, epoch: 32 | loss: 0.0015400
	speed: 0.3589s/iter; left time: 10119.5223s
	iters: 400, epoch: 32 | loss: 0.1153570
	speed: 0.3672s/iter; left time: 10316.3035s
Epoch: 32 cost time: 152.69714260101318
Epoch: 32, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.0001049
	speed: 0.7448s/iter; left time: 20842.9519s
	iters: 200, epoch: 33 | loss: 0.0479044
	speed: 0.3624s/iter; left time: 10104.8934s
	iters: 300, epoch: 33 | loss: 0.0000429
	speed: 0.3595s/iter; left time: 9987.6541s
	iters: 400, epoch: 33 | loss: 0.0002123
	speed: 0.3580s/iter; left time: 9912.2526s
Epoch: 33 cost time: 150.92798590660095
Epoch: 33, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.113 Vali Acc: 0.971 Test Loss: 0.113 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.0002846
	speed: 0.7131s/iter; left time: 19662.6488s
	iters: 200, epoch: 34 | loss: 0.0000026
	speed: 0.3895s/iter; left time: 10700.5567s
	iters: 300, epoch: 34 | loss: 0.0001443
	speed: 0.3795s/iter; left time: 10386.8568s
	iters: 400, epoch: 34 | loss: 0.0003065
	speed: 0.3588s/iter; left time: 9785.3130s
Epoch: 34 cost time: 155.23389649391174
Epoch: 34, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.143 Vali Acc: 0.975 Test Loss: 0.143 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.0000065
	speed: 0.7302s/iter; left time: 19831.0860s
	iters: 200, epoch: 35 | loss: 0.0025240
	speed: 0.3527s/iter; left time: 9544.7454s
	iters: 300, epoch: 35 | loss: 0.0000026
	speed: 0.3630s/iter; left time: 9787.1826s
	iters: 400, epoch: 35 | loss: 0.0000042
	speed: 0.3581s/iter; left time: 9617.6490s
Epoch: 35 cost time: 148.638854265213
Epoch: 35, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.073 Vali Acc: 0.984 Test Loss: 0.073 Test Acc: 0.984
Validation loss decreased (-0.981809 --> -0.983628).  Saving model ...
	iters: 100, epoch: 36 | loss: 0.0102109
	speed: 0.7208s/iter; left time: 19278.7375s
	iters: 200, epoch: 36 | loss: 0.0000401
	speed: 0.3757s/iter; left time: 10010.1908s
	iters: 300, epoch: 36 | loss: 0.0000030
	speed: 0.3823s/iter; left time: 10149.7555s
	iters: 400, epoch: 36 | loss: 0.0005269
	speed: 0.3563s/iter; left time: 9422.6538s
Epoch: 36 cost time: 152.24092650413513
Epoch: 36, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.156 Vali Acc: 0.975 Test Loss: 0.156 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 0.0002588
	speed: 0.6845s/iter; left time: 18025.4481s
	iters: 200, epoch: 37 | loss: 0.0008395
	speed: 0.3466s/iter; left time: 9091.6581s
	iters: 300, epoch: 37 | loss: 0.0000199
	speed: 0.3603s/iter; left time: 9415.7289s
	iters: 400, epoch: 37 | loss: 0.0000071
	speed: 0.3631s/iter; left time: 9453.7042s
Epoch: 37 cost time: 145.90370321273804
Epoch: 37, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 0.0000301
	speed: 0.7122s/iter; left time: 18461.2804s
	iters: 200, epoch: 38 | loss: 0.0000490
	speed: 0.3792s/iter; left time: 9789.7041s
	iters: 300, epoch: 38 | loss: 0.0000033
	speed: 0.3693s/iter; left time: 9499.1717s
	iters: 400, epoch: 38 | loss: 0.0000005
	speed: 0.3726s/iter; left time: 9547.0321s
Epoch: 38 cost time: 154.4700665473938
Epoch: 38, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 39 | loss: 0.0000568
	speed: 0.7284s/iter; left time: 18579.0094s
	iters: 200, epoch: 39 | loss: 0.0013687
	speed: 0.3555s/iter; left time: 9033.4150s
	iters: 300, epoch: 39 | loss: 0.0002358
	speed: 0.3716s/iter; left time: 9402.9964s
	iters: 400, epoch: 39 | loss: 0.0001246
	speed: 0.3801s/iter; left time: 9582.0332s
Epoch: 39 cost time: 152.4054033756256
Epoch: 39, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.117 Vali Acc: 0.971 Test Loss: 0.117 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 40 | loss: 0.0008814
	speed: 0.7241s/iter; left time: 18169.8026s
	iters: 200, epoch: 40 | loss: 0.0136911
	speed: 0.3996s/iter; left time: 9988.3976s
	iters: 300, epoch: 40 | loss: 0.0258734
	speed: 0.3983s/iter; left time: 9915.5771s
	iters: 400, epoch: 40 | loss: 0.0616353
	speed: 0.3615s/iter; left time: 8964.1086s
Epoch: 40 cost time: 156.56610679626465
Epoch: 40, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 41 | loss: 0.0107878
	speed: 0.7213s/iter; left time: 17801.3153s
	iters: 200, epoch: 41 | loss: 0.0000430
	speed: 0.3566s/iter; left time: 8766.6190s
	iters: 300, epoch: 41 | loss: 0.0000005
	speed: 0.3389s/iter; left time: 8297.5450s
	iters: 400, epoch: 41 | loss: 0.0019570
	speed: 0.3636s/iter; left time: 8865.3603s
Epoch: 41 cost time: 147.33413791656494
Epoch: 41, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.091 Vali Acc: 0.981 Test Loss: 0.091 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 42 | loss: 0.0000023
	speed: 0.7457s/iter; left time: 18097.7350s
	iters: 200, epoch: 42 | loss: 0.0002279
	speed: 0.3646s/iter; left time: 8812.0967s
	iters: 300, epoch: 42 | loss: 0.0037881
	speed: 0.3696s/iter; left time: 8894.4071s
	iters: 400, epoch: 42 | loss: 0.0000121
	speed: 0.3586s/iter; left time: 8593.9869s
Epoch: 42 cost time: 151.50760436058044
Epoch: 42, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 43 | loss: 0.0001131
	speed: 0.7148s/iter; left time: 17050.6591s
	iters: 200, epoch: 43 | loss: 0.0051397
	speed: 0.3489s/iter; left time: 8287.0107s
	iters: 300, epoch: 43 | loss: 0.0000122
	speed: 0.3469s/iter; left time: 8205.5092s
	iters: 400, epoch: 43 | loss: 0.0000339
	speed: 0.3650s/iter; left time: 8597.7627s
Epoch: 43 cost time: 147.0902693271637
Epoch: 43, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.053 Vali Acc: 0.985 Test Loss: 0.053 Test Acc: 0.985
Validation loss decreased (-0.983628 --> -0.985447).  Saving model ...
	iters: 100, epoch: 44 | loss: 0.0000213
	speed: 0.7300s/iter; left time: 17111.8137s
	iters: 200, epoch: 44 | loss: 0.0000076
	speed: 0.3782s/iter; left time: 8827.1361s
	iters: 300, epoch: 44 | loss: 0.0000001
	speed: 0.3670s/iter; left time: 8529.9033s
	iters: 400, epoch: 44 | loss: 0.0000000
	speed: 0.3619s/iter; left time: 8375.3608s
Epoch: 44 cost time: 151.133935213089
Epoch: 44, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.053 Vali Acc: 0.986 Test Loss: 0.053 Test Acc: 0.986
Validation loss decreased (-0.985447 --> -0.985902).  Saving model ...
	iters: 100, epoch: 45 | loss: 0.0000008
	speed: 0.7067s/iter; left time: 16274.3483s
	iters: 200, epoch: 45 | loss: 0.0000009
	speed: 0.3594s/iter; left time: 8241.1951s
	iters: 300, epoch: 45 | loss: 0.0000008
	speed: 0.3378s/iter; left time: 7710.9291s
	iters: 400, epoch: 45 | loss: 0.0000019
	speed: 0.3483s/iter; left time: 7916.7050s
Epoch: 45 cost time: 144.7252631187439
Epoch: 45, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.056 Vali Acc: 0.986 Test Loss: 0.056 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 46 | loss: 0.0000000
	speed: 0.7424s/iter; left time: 16790.0128s
	iters: 200, epoch: 46 | loss: 0.0000033
	speed: 0.3696s/iter; left time: 8321.9490s
	iters: 300, epoch: 46 | loss: 0.0000300
	speed: 0.3667s/iter; left time: 8220.1023s
	iters: 400, epoch: 46 | loss: 0.0000000
	speed: 0.3647s/iter; left time: 8139.7331s
Epoch: 46 cost time: 152.82860374450684
Epoch: 46, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
Validation loss decreased (-0.985902 --> -0.987266).  Saving model ...
	iters: 100, epoch: 47 | loss: 0.0000022
	speed: 0.7427s/iter; left time: 16490.9482s
	iters: 200, epoch: 47 | loss: 0.0000003
	speed: 0.3503s/iter; left time: 7742.6985s
	iters: 300, epoch: 47 | loss: 0.0000024
	speed: 0.3642s/iter; left time: 8013.9178s
	iters: 400, epoch: 47 | loss: 0.0000322
	speed: 0.3843s/iter; left time: 8416.3218s
Epoch: 47 cost time: 152.18212413787842
Epoch: 47, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 48 | loss: 0.0000001
	speed: 0.7454s/iter; left time: 16243.1982s
	iters: 200, epoch: 48 | loss: 0.0000003
	speed: 0.3838s/iter; left time: 8324.4638s
	iters: 300, epoch: 48 | loss: 0.0000031
	speed: 0.3758s/iter; left time: 8114.5922s
	iters: 400, epoch: 48 | loss: 0.0000036
	speed: 0.3536s/iter; left time: 7599.2493s
Epoch: 48 cost time: 153.81095266342163
Epoch: 48, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.986 Test Loss: 0.060 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 49 | loss: 0.0000002
	speed: 0.7429s/iter; left time: 15880.4059s
	iters: 200, epoch: 49 | loss: 0.0000014
	speed: 0.3676s/iter; left time: 7820.8968s
	iters: 300, epoch: 49 | loss: 0.0000013
	speed: 0.3609s/iter; left time: 7642.7982s
	iters: 400, epoch: 49 | loss: 0.0000069
	speed: 0.3845s/iter; left time: 8103.5856s
Epoch: 49 cost time: 154.56635069847107
Epoch: 49, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.058 Vali Acc: 0.986 Test Loss: 0.058 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 50 | loss: 0.0000002
	speed: 0.7328s/iter; left time: 15361.4362s
	iters: 200, epoch: 50 | loss: 0.0000032
	speed: 0.3565s/iter; left time: 7437.9167s
	iters: 300, epoch: 50 | loss: 0.0000005
	speed: 0.3730s/iter; left time: 7745.6352s
	iters: 400, epoch: 50 | loss: 0.0000008
	speed: 0.3672s/iter; left time: 7588.3017s
Epoch: 50 cost time: 150.66539430618286
Epoch: 50, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.058 Vali Acc: 0.986 Test Loss: 0.058 Test Acc: 0.986
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 51 | loss: 0.0000039
	speed: 0.7110s/iter; left time: 14612.2123s
	iters: 200, epoch: 51 | loss: 0.0000091
	speed: 0.3654s/iter; left time: 7471.9357s
	iters: 300, epoch: 51 | loss: 0.0000060
	speed: 0.3566s/iter; left time: 7256.3915s
	iters: 400, epoch: 51 | loss: 0.0000000
	speed: 0.3696s/iter; left time: 7483.9622s
Epoch: 51 cost time: 150.3186571598053
Epoch: 51, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.987 Test Loss: 0.059 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 52 | loss: 0.0000004
	speed: 0.7207s/iter; left time: 14512.7091s
	iters: 200, epoch: 52 | loss: 0.0000009
	speed: 0.3642s/iter; left time: 7298.6774s
	iters: 300, epoch: 52 | loss: 0.0000000
	speed: 0.3609s/iter; left time: 7195.0307s
	iters: 400, epoch: 52 | loss: 0.0000001
	speed: 0.3636s/iter; left time: 7213.7282s
Epoch: 52 cost time: 150.41034650802612
Epoch: 52, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.056 Vali Acc: 0.989 Test Loss: 0.056 Test Acc: 0.989
Validation loss decreased (-0.987266 --> -0.988631).  Saving model ...
	iters: 100, epoch: 53 | loss: 0.0000000
	speed: 0.7274s/iter; left time: 14348.8143s
	iters: 200, epoch: 53 | loss: 0.0000228
	speed: 0.3683s/iter; left time: 7227.0975s
	iters: 300, epoch: 53 | loss: 0.0000011
	speed: 0.3711s/iter; left time: 7246.3762s
	iters: 400, epoch: 53 | loss: 0.0000017
	speed: 0.3832s/iter; left time: 7444.2008s
Epoch: 53 cost time: 154.05363416671753
Epoch: 53, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.058 Vali Acc: 0.988 Test Loss: 0.058 Test Acc: 0.988
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 54 | loss: 0.0000070
	speed: 0.7592s/iter; left time: 14661.4195s
	iters: 200, epoch: 54 | loss: 0.0000000
	speed: 0.3589s/iter; left time: 6894.8035s
	iters: 300, epoch: 54 | loss: 0.0000000
	speed: 0.3496s/iter; left time: 6682.2106s
	iters: 400, epoch: 54 | loss: 0.0000001
	speed: 0.3687s/iter; left time: 7009.1638s
Epoch: 54 cost time: 151.1039867401123
Epoch: 54, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.988 Test Loss: 0.057 Test Acc: 0.988
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 55 | loss: 0.0000000
	speed: 0.7212s/iter; left time: 13630.0244s
	iters: 200, epoch: 55 | loss: 0.0000004
	speed: 0.3643s/iter; left time: 6848.0950s
	iters: 300, epoch: 55 | loss: 0.0000002
	speed: 0.3930s/iter; left time: 7347.7890s
	iters: 400, epoch: 55 | loss: 0.0000047
	speed: 0.3751s/iter; left time: 6976.9088s
Epoch: 55 cost time: 153.8888647556305
Epoch: 55, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.989 Test Loss: 0.057 Test Acc: 0.989
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 56 | loss: 0.0000000
	speed: 0.7233s/iter; left time: 13370.6730s
	iters: 200, epoch: 56 | loss: 0.0000000
	speed: 0.3694s/iter; left time: 6791.2991s
	iters: 300, epoch: 56 | loss: 0.0000000
	speed: 0.3644s/iter; left time: 6664.2170s
	iters: 400, epoch: 56 | loss: 0.0000000
	speed: 0.3465s/iter; left time: 6301.2928s
Epoch: 56 cost time: 149.66287875175476
Epoch: 56, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.989 Test Loss: 0.057 Test Acc: 0.989
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 57 | loss: 0.0000000
	speed: 0.7089s/iter; left time: 12811.3805s
	iters: 200, epoch: 57 | loss: 0.0000019
	speed: 0.3793s/iter; left time: 6816.7037s
	iters: 300, epoch: 57 | loss: 0.0000004
	speed: 0.3650s/iter; left time: 6523.0778s
	iters: 400, epoch: 57 | loss: 0.0000024
	speed: 0.3764s/iter; left time: 6690.5906s
Epoch: 57 cost time: 154.54953122138977
Epoch: 57, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.056 Vali Acc: 0.987 Test Loss: 0.056 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 58 | loss: 0.0000002
	speed: 0.7449s/iter; left time: 13154.3549s
	iters: 200, epoch: 58 | loss: 0.0000021
	speed: 0.3581s/iter; left time: 6288.6015s
	iters: 300, epoch: 58 | loss: 0.0000000
	speed: 0.3501s/iter; left time: 6112.4158s
	iters: 400, epoch: 58 | loss: 0.0000001
	speed: 0.3641s/iter; left time: 6320.4825s
Epoch: 58 cost time: 149.0820460319519
Epoch: 58, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.056 Vali Acc: 0.988 Test Loss: 0.056 Test Acc: 0.988
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 59 | loss: 0.0000000
	speed: 0.7300s/iter; left time: 12590.7643s
	iters: 200, epoch: 59 | loss: 0.0000001
	speed: 0.3616s/iter; left time: 6200.0250s
	iters: 300, epoch: 59 | loss: 0.0000000
	speed: 0.3662s/iter; left time: 6242.5534s
	iters: 400, epoch: 59 | loss: 0.0000000
	speed: 0.3615s/iter; left time: 6126.8394s
Epoch: 59 cost time: 151.06539583206177
Epoch: 59, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 60 | loss: 0.0000000
	speed: 0.7270s/iter; left time: 12238.7433s
	iters: 200, epoch: 60 | loss: 0.0000000
	speed: 0.3616s/iter; left time: 6051.5582s
	iters: 300, epoch: 60 | loss: 0.0000001
	speed: 0.3573s/iter; left time: 5942.7306s
	iters: 400, epoch: 60 | loss: 0.0000009
	speed: 0.3806s/iter; left time: 6292.0658s
Epoch: 60 cost time: 151.62366700172424
Epoch: 60, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.987 Test Loss: 0.061 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 61 | loss: 0.0000001
	speed: 0.7297s/iter; left time: 11982.0922s
	iters: 200, epoch: 61 | loss: 0.0000003
	speed: 0.3828s/iter; left time: 6247.1578s
	iters: 300, epoch: 61 | loss: 0.0000000
	speed: 0.3900s/iter; left time: 6325.8226s
	iters: 400, epoch: 61 | loss: 0.0000033
	speed: 0.3606s/iter; left time: 5812.5944s
Epoch: 61 cost time: 154.57386922836304
Epoch: 61, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.987 Test Loss: 0.059 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 62 | loss: 0.0000000
	speed: 0.7230s/iter; left time: 11573.1009s
	iters: 200, epoch: 62 | loss: 0.0000000
	speed: 0.3739s/iter; left time: 5947.2200s
	iters: 300, epoch: 62 | loss: 0.0000005
	speed: 0.3505s/iter; left time: 5541.0812s
	iters: 400, epoch: 62 | loss: 0.0000006
	speed: 0.3600s/iter; left time: 5654.9634s
Epoch: 62 cost time: 150.82122325897217
Epoch: 62, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.988631195998181
model parameter : 16118794
model size : 81.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.3032956
	speed: 0.3436s/iter; left time: 14155.9026s
	iters: 200, epoch: 1 | loss: 2.3026729
	speed: 0.3392s/iter; left time: 13940.5326s
	iters: 300, epoch: 1 | loss: 2.3014665
	speed: 0.3342s/iter; left time: 13703.8932s
	iters: 400, epoch: 1 | loss: 2.3033106
	speed: 0.3260s/iter; left time: 13335.2983s
Epoch: 1 cost time: 139.07926273345947
Epoch: 1, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (inf --> -0.100022).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3052273
	speed: 0.7128s/iter; left time: 29074.3736s
	iters: 200, epoch: 2 | loss: 2.3031478
	speed: 0.3445s/iter; left time: 14015.8222s
	iters: 300, epoch: 2 | loss: 2.3053412
	speed: 0.3267s/iter; left time: 13260.5395s
	iters: 400, epoch: 2 | loss: 2.3034525
	speed: 0.3403s/iter; left time: 13776.1247s
Epoch: 2 cost time: 142.3442256450653
Epoch: 2, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3015230
	speed: 0.6949s/iter; left time: 28055.3649s
	iters: 200, epoch: 3 | loss: 2.3024058
	speed: 0.3510s/iter; left time: 14134.8384s
	iters: 300, epoch: 3 | loss: 2.3040533
	speed: 0.3536s/iter; left time: 14205.3481s
	iters: 400, epoch: 3 | loss: 2.3037953
	speed: 0.3362s/iter; left time: 13472.6637s
Epoch: 3 cost time: 142.6707694530487
Epoch: 3, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3030756
	speed: 0.6926s/iter; left time: 27678.8958s
	iters: 200, epoch: 4 | loss: 2.3044140
	speed: 0.3510s/iter; left time: 13991.5272s
	iters: 300, epoch: 4 | loss: 2.3042495
	speed: 0.3337s/iter; left time: 13269.3939s
	iters: 400, epoch: 4 | loss: 2.3016012
	speed: 0.3550s/iter; left time: 14078.4530s
Epoch: 4 cost time: 143.69026446342468
Epoch: 4, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.3041949
	speed: 0.6935s/iter; left time: 27426.8715s
	iters: 200, epoch: 5 | loss: 2.3020287
	speed: 0.3430s/iter; left time: 13529.3052s
	iters: 300, epoch: 5 | loss: 2.3021379
	speed: 0.3411s/iter; left time: 13421.4440s
	iters: 400, epoch: 5 | loss: 2.3016229
	speed: 0.3476s/iter; left time: 13641.9130s
Epoch: 5 cost time: 142.87465000152588
Epoch: 5, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.3040175
	speed: 0.6783s/iter; left time: 26544.8646s
	iters: 200, epoch: 6 | loss: 2.3028336
	speed: 0.3228s/iter; left time: 12602.4029s
	iters: 300, epoch: 6 | loss: 2.3012693
	speed: 0.3218s/iter; left time: 12531.1078s
	iters: 400, epoch: 6 | loss: 2.3019412
	speed: 0.3069s/iter; left time: 11917.0526s
Epoch: 6 cost time: 133.7480034828186
Epoch: 6, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 2.3085260
	speed: 0.6541s/iter; left time: 25328.9832s
	iters: 200, epoch: 7 | loss: 2.3063960
	speed: 0.3298s/iter; left time: 12739.6183s
	iters: 300, epoch: 7 | loss: 2.3031349
	speed: 0.3156s/iter; left time: 12157.8248s
	iters: 400, epoch: 7 | loss: 2.3037221
	speed: 0.3217s/iter; left time: 12362.1609s
Epoch: 7 cost time: 134.6692967414856
Epoch: 7, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 2.3007114
	speed: 0.6535s/iter; left time: 25036.3399s
	iters: 200, epoch: 8 | loss: 2.3004572
	speed: 0.3089s/iter; left time: 11801.2474s
	iters: 300, epoch: 8 | loss: 2.3019321
	speed: 0.3287s/iter; left time: 12527.7128s
	iters: 400, epoch: 8 | loss: 2.3047605
	speed: 0.3285s/iter; left time: 12484.6043s
Epoch: 8 cost time: 133.20668244361877
Epoch: 8, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 2.3044462
	speed: 0.6849s/iter; left time: 25955.3026s
	iters: 200, epoch: 9 | loss: 2.3022830
	speed: 0.3564s/iter; left time: 13470.6684s
	iters: 300, epoch: 9 | loss: 2.3001802
	speed: 0.3454s/iter; left time: 13020.7666s
	iters: 400, epoch: 9 | loss: 2.3032780
	speed: 0.3323s/iter; left time: 12494.9910s
Epoch: 9 cost time: 143.50046253204346
Epoch: 9, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 2.3012004
	speed: 0.6912s/iter; left time: 25908.9285s
	iters: 200, epoch: 10 | loss: 2.3011711
	speed: 0.3332s/iter; left time: 12455.5405s
	iters: 300, epoch: 10 | loss: 2.3027241
	speed: 0.3295s/iter; left time: 12284.5431s
	iters: 400, epoch: 10 | loss: 2.3050494
	speed: 0.3381s/iter; left time: 12571.1707s
Epoch: 10 cost time: 139.94825100898743
Epoch: 10, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 2.3028481
	speed: 0.6962s/iter; left time: 25808.6266s
	iters: 200, epoch: 11 | loss: 2.3023937
	speed: 0.3410s/iter; left time: 12606.1270s
	iters: 300, epoch: 11 | loss: 2.3009975
	speed: 0.3367s/iter; left time: 12412.8822s
	iters: 400, epoch: 11 | loss: 2.3028154
	speed: 0.3348s/iter; left time: 12309.4634s
Epoch: 11 cost time: 140.58394312858582
Epoch: 11, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 2.3016984
	speed: 0.6703s/iter; left time: 24570.6750s
	iters: 200, epoch: 12 | loss: 2.3045642
	speed: 0.3384s/iter; left time: 12371.2833s
	iters: 300, epoch: 12 | loss: 2.3028708
	speed: 0.3354s/iter; left time: 12227.2781s
	iters: 400, epoch: 12 | loss: 2.3016338
	speed: 0.3360s/iter; left time: 12215.4267s
Epoch: 12 cost time: 140.28816056251526
Epoch: 12, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 2.3042793
	speed: 0.7044s/iter; left time: 25532.0776s
	iters: 200, epoch: 13 | loss: 2.3031201
	speed: 0.3392s/iter; left time: 12260.5090s
	iters: 300, epoch: 13 | loss: 2.3013318
	speed: 0.3385s/iter; left time: 12201.3766s
	iters: 400, epoch: 13 | loss: 2.3023746
	speed: 0.3318s/iter; left time: 11926.8501s
Epoch: 13 cost time: 140.5482792854309
Epoch: 13, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.10004547521600728
model parameter : 16118794
model size : 81.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         47                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2843261
	speed: 0.3370s/iter; left time: 13884.9936s
	iters: 200, epoch: 1 | loss: 0.0107721
	speed: 0.3202s/iter; left time: 13160.6759s
	iters: 300, epoch: 1 | loss: 0.1134397
	speed: 0.3279s/iter; left time: 13446.2395s
	iters: 400, epoch: 1 | loss: 0.3461444
	speed: 0.3268s/iter; left time: 13368.1446s
Epoch: 1 cost time: 135.95453786849976
Epoch: 1, Steps: 413 | Train Loss: 0.331 Vali Loss: 0.204 Vali Acc: 0.945 Test Loss: 0.204 Test Acc: 0.945
Validation loss decreased (inf --> -0.945428).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3353288
	speed: 0.7027s/iter; left time: 28660.6323s
	iters: 200, epoch: 2 | loss: 0.0020252
	speed: 0.3264s/iter; left time: 13280.9701s
	iters: 300, epoch: 2 | loss: 0.2481756
	speed: 0.3189s/iter; left time: 12945.1088s
	iters: 400, epoch: 2 | loss: 1.2286990
	speed: 0.3250s/iter; left time: 13159.7109s
Epoch: 2 cost time: 136.40511846542358
Epoch: 2, Steps: 413 | Train Loss: 0.259 Vali Loss: 0.402 Vali Acc: 0.930 Test Loss: 0.402 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0000473
	speed: 0.6712s/iter; left time: 27100.6388s
	iters: 200, epoch: 3 | loss: 0.4146862
	speed: 0.3492s/iter; left time: 14064.5640s
	iters: 300, epoch: 3 | loss: 0.0580064
	speed: 0.3570s/iter; left time: 14341.0878s
	iters: 400, epoch: 3 | loss: 0.0186105
	speed: 0.3461s/iter; left time: 13868.9024s
Epoch: 3 cost time: 143.64241647720337
Epoch: 3, Steps: 413 | Train Loss: 0.348 Vali Loss: 0.466 Vali Acc: 0.941 Test Loss: 0.466 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0548767
	speed: 0.7297s/iter; left time: 29161.7338s
	iters: 200, epoch: 4 | loss: 0.0542722
	speed: 0.3335s/iter; left time: 13292.7649s
	iters: 300, epoch: 4 | loss: 0.0000182
	speed: 0.3354s/iter; left time: 13335.5963s
	iters: 400, epoch: 4 | loss: 0.5282689
	speed: 0.3351s/iter; left time: 13291.1404s
Epoch: 4 cost time: 141.2450225353241
Epoch: 4, Steps: 413 | Train Loss: 0.318 Vali Loss: 0.331 Vali Acc: 0.958 Test Loss: 0.331 Test Acc: 0.958
Validation loss decreased (-0.945428 --> -0.957705).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1185195
	speed: 0.6835s/iter; left time: 27033.5407s
	iters: 200, epoch: 5 | loss: 0.0000002
	speed: 0.3434s/iter; left time: 13548.5376s
	iters: 300, epoch: 5 | loss: 0.0004024
	speed: 0.3482s/iter; left time: 13703.1624s
	iters: 400, epoch: 5 | loss: 0.2036802
	speed: 0.3601s/iter; left time: 14134.8112s
Epoch: 5 cost time: 143.4141206741333
Epoch: 5, Steps: 413 | Train Loss: 0.331 Vali Loss: 0.385 Vali Acc: 0.950 Test Loss: 0.385 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0739296
	speed: 0.7158s/iter; left time: 28013.5042s
	iters: 200, epoch: 6 | loss: 0.0000152
	speed: 0.3427s/iter; left time: 13378.8448s
	iters: 300, epoch: 6 | loss: 0.2880507
	speed: 0.3413s/iter; left time: 13288.1773s
	iters: 400, epoch: 6 | loss: 0.0196865
	speed: 0.3569s/iter; left time: 13861.5781s
Epoch: 6 cost time: 144.75129342079163
Epoch: 6, Steps: 413 | Train Loss: 0.312 Vali Loss: 0.275 Vali Acc: 0.965 Test Loss: 0.275 Test Acc: 0.965
Validation loss decreased (-0.957705 --> -0.964527).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0417504
	speed: 0.7357s/iter; left time: 28487.2575s
	iters: 200, epoch: 7 | loss: 0.7191654
	speed: 0.3533s/iter; left time: 13646.4082s
	iters: 300, epoch: 7 | loss: 0.0000029
	speed: 0.3656s/iter; left time: 14085.9169s
	iters: 400, epoch: 7 | loss: 0.0875176
	speed: 0.3591s/iter; left time: 13796.7194s
Epoch: 7 cost time: 149.512943983078
Epoch: 7, Steps: 413 | Train Loss: 0.286 Vali Loss: 0.943 Vali Acc: 0.928 Test Loss: 0.943 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0295074
	speed: 0.6878s/iter; left time: 26349.6937s
	iters: 200, epoch: 8 | loss: 0.0014656
	speed: 0.3444s/iter; left time: 13158.7216s
	iters: 300, epoch: 8 | loss: 0.4289809
	speed: 0.3441s/iter; left time: 13114.7722s
	iters: 400, epoch: 8 | loss: 0.0000001
	speed: 0.3402s/iter; left time: 12931.7425s
Epoch: 8 cost time: 142.56034088134766
Epoch: 8, Steps: 413 | Train Loss: 0.194 Vali Loss: 0.411 Vali Acc: 0.959 Test Loss: 0.411 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000230
	speed: 0.7055s/iter; left time: 26735.3982s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.3500s/iter; left time: 13229.3364s
	iters: 300, epoch: 9 | loss: 0.0104507
	speed: 0.3473s/iter; left time: 13091.3409s
	iters: 400, epoch: 9 | loss: 0.0000120
	speed: 0.3552s/iter; left time: 13352.7794s
Epoch: 9 cost time: 145.4830687046051
Epoch: 9, Steps: 413 | Train Loss: 0.234 Vali Loss: 0.417 Vali Acc: 0.955 Test Loss: 0.417 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000082
	speed: 0.6861s/iter; left time: 25717.4681s
	iters: 200, epoch: 10 | loss: 0.3902312
	speed: 0.3451s/iter; left time: 12901.1968s
	iters: 300, epoch: 10 | loss: 0.0000121
	speed: 0.3466s/iter; left time: 12923.4149s
	iters: 400, epoch: 10 | loss: 0.0267625
	speed: 0.3326s/iter; left time: 12368.0387s
Epoch: 10 cost time: 140.78454518318176
Epoch: 10, Steps: 413 | Train Loss: 0.178 Vali Loss: 0.449 Vali Acc: 0.960 Test Loss: 0.449 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.7039s/iter; left time: 26093.2454s
	iters: 200, epoch: 11 | loss: 0.4567306
	speed: 0.3461s/iter; left time: 12795.5151s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.3478s/iter; left time: 12825.3726s
	iters: 400, epoch: 11 | loss: 1.1562133
	speed: 0.3639s/iter; left time: 13380.0824s
Epoch: 11 cost time: 146.0560290813446
Epoch: 11, Steps: 413 | Train Loss: 0.149 Vali Loss: 0.568 Vali Acc: 0.953 Test Loss: 0.568 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0161824
	speed: 0.6830s/iter; left time: 25036.2786s
	iters: 200, epoch: 12 | loss: 0.0000049
	speed: 0.3471s/iter; left time: 12688.2374s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.3422s/iter; left time: 12477.1347s
	iters: 400, epoch: 12 | loss: 0.0000006
	speed: 0.3491s/iter; left time: 12694.0655s
Epoch: 12 cost time: 141.49072980880737
Epoch: 12, Steps: 413 | Train Loss: 0.162 Vali Loss: 0.604 Vali Acc: 0.956 Test Loss: 0.604 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000003
	speed: 0.6794s/iter; left time: 24625.2414s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.3626s/iter; left time: 13107.1539s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.3430s/iter; left time: 12361.8402s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.3493s/iter; left time: 12554.1339s
Epoch: 13 cost time: 144.69774985313416
Epoch: 13, Steps: 413 | Train Loss: 0.143 Vali Loss: 0.384 Vali Acc: 0.959 Test Loss: 0.384 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000025
	speed: 0.7429s/iter; left time: 26617.9882s
	iters: 200, epoch: 14 | loss: 0.0000061
	speed: 0.3552s/iter; left time: 12690.6614s
	iters: 300, epoch: 14 | loss: 0.2549304
	speed: 0.3417s/iter; left time: 12174.5981s
	iters: 400, epoch: 14 | loss: 0.0044733
	speed: 0.3508s/iter; left time: 12465.5217s
Epoch: 14 cost time: 146.96042847633362
Epoch: 14, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.320 Vali Acc: 0.966 Test Loss: 0.320 Test Acc: 0.966
Validation loss decreased (-0.964527 --> -0.965890).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000006
	speed: 0.7032s/iter; left time: 24908.0314s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.3468s/iter; left time: 12248.0207s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.3538s/iter; left time: 12459.9926s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.3446s/iter; left time: 12103.5877s
Epoch: 15 cost time: 143.31640934944153
Epoch: 15, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.337 Vali Acc: 0.970 Test Loss: 0.337 Test Acc: 0.970
Validation loss decreased (-0.965890 --> -0.969983).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.7420s/iter; left time: 25974.1193s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.3486s/iter; left time: 12168.3379s
	iters: 300, epoch: 16 | loss: 0.0001091
	speed: 0.3251s/iter; left time: 11314.8168s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.3330s/iter; left time: 11557.6064s
Epoch: 16 cost time: 142.97551250457764
Epoch: 16, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.514 Vali Acc: 0.960 Test Loss: 0.514 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.3549590
	speed: 0.6808s/iter; left time: 23551.0510s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.3475s/iter; left time: 11987.5265s
	iters: 300, epoch: 17 | loss: 0.0000001
	speed: 0.3667s/iter; left time: 12612.7550s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.3593s/iter; left time: 12321.9592s
Epoch: 17 cost time: 146.13066983222961
Epoch: 17, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.365 Vali Acc: 0.968 Test Loss: 0.365 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000017
	speed: 0.7146s/iter; left time: 24423.3974s
	iters: 200, epoch: 18 | loss: 0.0231180
	speed: 0.3491s/iter; left time: 11896.1645s
	iters: 300, epoch: 18 | loss: 0.0000001
	speed: 0.3311s/iter; left time: 11250.3407s
	iters: 400, epoch: 18 | loss: 0.0001271
	speed: 0.3317s/iter; left time: 11237.3723s
Epoch: 18 cost time: 141.33385181427002
Epoch: 18, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.380 Vali Acc: 0.975 Test Loss: 0.380 Test Acc: 0.975
Validation loss decreased (-0.969983 --> -0.974985).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.6845s/iter; left time: 23114.6693s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.3514s/iter; left time: 11831.6004s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.3649s/iter; left time: 12247.4104s
	iters: 400, epoch: 19 | loss: 0.0000044
	speed: 0.3469s/iter; left time: 11608.5327s
Epoch: 19 cost time: 145.17830657958984
Epoch: 19, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.653 Vali Acc: 0.955 Test Loss: 0.653 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000001
	speed: 0.6870s/iter; left time: 22913.2849s
	iters: 200, epoch: 20 | loss: 0.0674257
	speed: 0.3373s/iter; left time: 11217.1397s
	iters: 300, epoch: 20 | loss: 0.0004976
	speed: 0.3337s/iter; left time: 11062.8366s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.3393s/iter; left time: 11213.7577s
Epoch: 20 cost time: 139.41706371307373
Epoch: 20, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.405 Vali Acc: 0.961 Test Loss: 0.405 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000004
	speed: 0.6891s/iter; left time: 22698.5711s
	iters: 200, epoch: 21 | loss: 0.0000050
	speed: 0.3519s/iter; left time: 11558.2574s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.3527s/iter; left time: 11547.5272s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.3501s/iter; left time: 11427.2802s
Epoch: 21 cost time: 145.69007182121277
Epoch: 21, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.584 Vali Acc: 0.952 Test Loss: 0.584 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.6665s/iter; left time: 21681.5292s
	iters: 200, epoch: 22 | loss: 0.0000010
	speed: 0.3178s/iter; left time: 10304.9880s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.3315s/iter; left time: 10717.1234s
	iters: 400, epoch: 22 | loss: 0.0089890
	speed: 0.3462s/iter; left time: 11158.6925s
Epoch: 22 cost time: 137.06530737876892
Epoch: 22, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.465 Vali Acc: 0.964 Test Loss: 0.465 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.6844s/iter; left time: 21980.6590s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.3584s/iter; left time: 11474.3492s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.3494s/iter; left time: 11150.8482s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.3355s/iter; left time: 10674.7611s
Epoch: 23 cost time: 143.67853808403015
Epoch: 23, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.428 Vali Acc: 0.966 Test Loss: 0.428 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.6820s/iter; left time: 21620.8137s
	iters: 200, epoch: 24 | loss: 0.0000006
	speed: 0.3233s/iter; left time: 10216.2278s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.3210s/iter; left time: 10111.6210s
	iters: 400, epoch: 24 | loss: 0.1778806
	speed: 0.3462s/iter; left time: 10870.3596s
Epoch: 24 cost time: 137.50171875953674
Epoch: 24, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.281 Vali Acc: 0.971 Test Loss: 0.281 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0000333
	speed: 0.7026s/iter; left time: 21983.9035s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.3535s/iter; left time: 11025.2367s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.3483s/iter; left time: 10828.4485s
	iters: 400, epoch: 25 | loss: 0.0000057
	speed: 0.3523s/iter; left time: 10917.1639s
Epoch: 25 cost time: 145.74281907081604
Epoch: 25, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.199 Vali Acc: 0.975 Test Loss: 0.199 Test Acc: 0.975
Validation loss decreased (-0.974985 --> -0.975441).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.6866s/iter; left time: 21199.8488s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.3540s/iter; left time: 10895.0844s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.3429s/iter; left time: 10519.0464s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.3421s/iter; left time: 10461.0486s
Epoch: 26 cost time: 142.33789992332458
Epoch: 26, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.458 Vali Acc: 0.965 Test Loss: 0.458 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0000001
	speed: 0.6797s/iter; left time: 20706.7703s
	iters: 200, epoch: 27 | loss: 0.0000080
	speed: 0.3339s/iter; left time: 10139.0011s
	iters: 300, epoch: 27 | loss: 0.0000079
	speed: 0.3233s/iter; left time: 9783.2323s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.3241s/iter; left time: 9776.3015s
Epoch: 27 cost time: 137.02651119232178
Epoch: 27, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.277 Vali Acc: 0.979 Test Loss: 0.277 Test Acc: 0.979
Validation loss decreased (-0.975441 --> -0.978624).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.6692s/iter; left time: 20110.6032s
	iters: 200, epoch: 28 | loss: 0.0000143
	speed: 0.3180s/iter; left time: 9525.2603s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.3228s/iter; left time: 9636.9444s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.3221s/iter; left time: 9583.3818s
Epoch: 28 cost time: 134.3531413078308
Epoch: 28, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.389 Vali Acc: 0.967 Test Loss: 0.389 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0017323
	speed: 0.6504s/iter; left time: 19275.0046s
	iters: 200, epoch: 29 | loss: 0.1539636
	speed: 0.3292s/iter; left time: 9722.7829s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.3375s/iter; left time: 9935.1020s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.3381s/iter; left time: 9918.6060s
Epoch: 29 cost time: 137.30769562721252
Epoch: 29, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.155 Vali Acc: 0.981 Test Loss: 0.155 Test Acc: 0.981
Validation loss decreased (-0.978624 --> -0.981354).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.6929s/iter; left time: 20250.2804s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.3399s/iter; left time: 9898.6420s
	iters: 300, epoch: 30 | loss: 0.0013904
	speed: 0.3321s/iter; left time: 9640.1079s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.3114s/iter; left time: 9008.1765s
Epoch: 30 cost time: 135.85251474380493
Epoch: 30, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.426 Vali Acc: 0.968 Test Loss: 0.426 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0000036
	speed: 0.6406s/iter; left time: 18456.5349s
	iters: 200, epoch: 31 | loss: 0.0177433
	speed: 0.3313s/iter; left time: 9510.9428s
	iters: 300, epoch: 31 | loss: 0.0000002
	speed: 0.3110s/iter; left time: 8896.8341s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.3217s/iter; left time: 9171.3909s
Epoch: 31 cost time: 133.02333283424377
Epoch: 31, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.377 Vali Acc: 0.966 Test Loss: 0.377 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.6602s/iter; left time: 18747.0743s
	iters: 200, epoch: 32 | loss: 1.1050309
	speed: 0.3149s/iter; left time: 8910.3862s
	iters: 300, epoch: 32 | loss: 0.0000001
	speed: 0.3189s/iter; left time: 8992.0887s
	iters: 400, epoch: 32 | loss: 0.0000003
	speed: 0.3253s/iter; left time: 9139.0857s
Epoch: 32 cost time: 133.14884662628174
Epoch: 32, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.186 Vali Acc: 0.976 Test Loss: 0.186 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.6386s/iter; left time: 17870.6924s
	iters: 200, epoch: 33 | loss: 0.0019511
	speed: 0.3335s/iter; left time: 9298.3961s
	iters: 300, epoch: 33 | loss: 0.0000003
	speed: 0.3371s/iter; left time: 9365.9761s
	iters: 400, epoch: 33 | loss: 0.0000076
	speed: 0.3164s/iter; left time: 8759.5897s
Epoch: 33 cost time: 135.39312076568604
Epoch: 33, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.218 Vali Acc: 0.973 Test Loss: 0.218 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 1.1913792
	speed: 0.6552s/iter; left time: 18066.0921s
	iters: 200, epoch: 34 | loss: 0.0000004
	speed: 0.3118s/iter; left time: 8565.7032s
	iters: 300, epoch: 34 | loss: 0.0000188
	speed: 0.3066s/iter; left time: 8392.4934s
	iters: 400, epoch: 34 | loss: 0.0002433
	speed: 0.3142s/iter; left time: 8568.9037s
Epoch: 34 cost time: 129.3092381954193
Epoch: 34, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.157 Vali Acc: 0.982 Test Loss: 0.157 Test Acc: 0.982
Validation loss decreased (-0.981354 --> -0.982263).  Saving model ...
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.6425s/iter; left time: 17449.5325s
	iters: 200, epoch: 35 | loss: 0.0000003
	speed: 0.3330s/iter; left time: 9011.0077s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.3400s/iter; left time: 9166.5835s
	iters: 400, epoch: 35 | loss: 0.0000132
	speed: 0.3260s/iter; left time: 8756.2300s
Epoch: 35 cost time: 135.63816285133362
Epoch: 35, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.219 Vali Acc: 0.970 Test Loss: 0.219 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 0.0000019
	speed: 0.6525s/iter; left time: 17451.7208s
	iters: 200, epoch: 36 | loss: 0.0035877
	speed: 0.3245s/iter; left time: 8647.4400s
	iters: 300, epoch: 36 | loss: 0.0000007
	speed: 0.3013s/iter; left time: 7998.1576s
	iters: 400, epoch: 36 | loss: 0.0202880
	speed: 0.3114s/iter; left time: 8234.0013s
Epoch: 36 cost time: 130.53376579284668
Epoch: 36, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.152 Vali Acc: 0.981 Test Loss: 0.152 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 0.0010666
	speed: 0.6471s/iter; left time: 17039.2560s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.3279s/iter; left time: 8600.6335s
	iters: 300, epoch: 37 | loss: 0.0000010
	speed: 0.3184s/iter; left time: 8320.5267s
	iters: 400, epoch: 37 | loss: 0.0008044
	speed: 0.3285s/iter; left time: 8551.8691s
Epoch: 37 cost time: 135.05203461647034
Epoch: 37, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.259 Vali Acc: 0.971 Test Loss: 0.259 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 0.0000060
	speed: 0.6528s/iter; left time: 16919.6980s
	iters: 200, epoch: 38 | loss: 0.0000764
	speed: 0.3113s/iter; left time: 8038.8810s
	iters: 300, epoch: 38 | loss: 0.0000885
	speed: 0.3280s/iter; left time: 8435.2859s
	iters: 400, epoch: 38 | loss: 0.0000154
	speed: 0.3229s/iter; left time: 8273.7660s
Epoch: 38 cost time: 131.97410917282104
Epoch: 38, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 39 | loss: 0.0000004
	speed: 0.6415s/iter; left time: 16362.8081s
	iters: 200, epoch: 39 | loss: 0.0000000
	speed: 0.3354s/iter; left time: 8521.5105s
	iters: 300, epoch: 39 | loss: 0.0000010
	speed: 0.3256s/iter; left time: 8239.5114s
	iters: 400, epoch: 39 | loss: 0.0000000
	speed: 0.3182s/iter; left time: 8020.7162s
Epoch: 39 cost time: 134.63051676750183
Epoch: 39, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.250 Vali Acc: 0.975 Test Loss: 0.250 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 40 | loss: 0.0000000
	speed: 0.6694s/iter; left time: 16796.8120s
	iters: 200, epoch: 40 | loss: 0.0000000
	speed: 0.3134s/iter; left time: 7833.1100s
	iters: 300, epoch: 40 | loss: 0.0000000
	speed: 0.3233s/iter; left time: 8047.5166s
	iters: 400, epoch: 40 | loss: 0.0000464
	speed: 0.3436s/iter; left time: 8518.2254s
Epoch: 40 cost time: 136.54269433021545
Epoch: 40, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.231 Vali Acc: 0.971 Test Loss: 0.231 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 41 | loss: 0.0027668
	speed: 0.6761s/iter; left time: 16687.9618s
	iters: 200, epoch: 41 | loss: 0.0000001
	speed: 0.3489s/iter; left time: 8576.7533s
	iters: 300, epoch: 41 | loss: 0.0515457
	speed: 0.3370s/iter; left time: 8250.3709s
	iters: 400, epoch: 41 | loss: 0.0000000
	speed: 0.3317s/iter; left time: 8086.8381s
Epoch: 41 cost time: 139.70877265930176
Epoch: 41, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.177 Vali Acc: 0.977 Test Loss: 0.177 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 42 | loss: 0.0000000
	speed: 0.6734s/iter; left time: 16341.3667s
	iters: 200, epoch: 42 | loss: 0.0000087
	speed: 0.3203s/iter; left time: 7741.2522s
	iters: 300, epoch: 42 | loss: 0.1678829
	speed: 0.3253s/iter; left time: 7829.2335s
	iters: 400, epoch: 42 | loss: 0.0000000
	speed: 0.3283s/iter; left time: 7868.8986s
Epoch: 42 cost time: 135.74331212043762
Epoch: 42, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.145 Vali Acc: 0.980 Test Loss: 0.145 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 43 | loss: 0.0000000
	speed: 0.6622s/iter; left time: 15796.2149s
	iters: 200, epoch: 43 | loss: 0.0000015
	speed: 0.3218s/iter; left time: 7644.7638s
	iters: 300, epoch: 43 | loss: 0.0000010
	speed: 0.3313s/iter; left time: 7837.6215s
	iters: 400, epoch: 43 | loss: 0.0000000
	speed: 0.3467s/iter; left time: 8166.4753s
Epoch: 43 cost time: 137.5583884716034
Epoch: 43, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.142 Vali Acc: 0.976 Test Loss: 0.142 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 44 | loss: 0.0000069
	speed: 0.6736s/iter; left time: 15790.0027s
	iters: 200, epoch: 44 | loss: 0.0000000
	speed: 0.3415s/iter; left time: 7970.1552s
	iters: 300, epoch: 44 | loss: 0.0000000
	speed: 0.3423s/iter; left time: 7955.5080s
	iters: 400, epoch: 44 | loss: 0.0000291
	speed: 0.3332s/iter; left time: 7711.5560s
Epoch: 44 cost time: 139.77852487564087
Epoch: 44, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.164 Vali Acc: 0.975 Test Loss: 0.164 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9822646657571623
model parameter : 12973066
model size : 69.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         38                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2179886
	speed: 0.3549s/iter; left time: 14621.2360s
	iters: 200, epoch: 1 | loss: 0.0065379
	speed: 0.3376s/iter; left time: 13875.7261s
	iters: 300, epoch: 1 | loss: 0.2087066
	speed: 0.3383s/iter; left time: 13869.9363s
	iters: 400, epoch: 1 | loss: 0.2706097
	speed: 0.3474s/iter; left time: 14207.1495s
Epoch: 1 cost time: 142.60420942306519
Epoch: 1, Steps: 413 | Train Loss: 0.361 Vali Loss: 0.149 Vali Acc: 0.961 Test Loss: 0.149 Test Acc: 0.961
Validation loss decreased (inf --> -0.960890).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0042876
	speed: 0.6688s/iter; left time: 27277.4047s
	iters: 200, epoch: 2 | loss: 0.0342466
	speed: 0.3427s/iter; left time: 13942.3119s
	iters: 300, epoch: 2 | loss: 0.9239772
	speed: 0.3268s/iter; left time: 13264.0799s
	iters: 400, epoch: 2 | loss: 0.8545244
	speed: 0.3165s/iter; left time: 12815.6332s
Epoch: 2 cost time: 136.41524648666382
Epoch: 2, Steps: 413 | Train Loss: 0.273 Vali Loss: 0.387 Vali Acc: 0.935 Test Loss: 0.387 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.3150192
	speed: 0.6876s/iter; left time: 27761.5327s
	iters: 200, epoch: 3 | loss: 0.2332847
	speed: 0.3424s/iter; left time: 13790.5420s
	iters: 300, epoch: 3 | loss: 0.0003843
	speed: 0.3374s/iter; left time: 13553.2637s
	iters: 400, epoch: 3 | loss: 0.0974645
	speed: 0.3497s/iter; left time: 14013.9153s
Epoch: 3 cost time: 142.91983842849731
Epoch: 3, Steps: 413 | Train Loss: 0.288 Vali Loss: 0.410 Vali Acc: 0.939 Test Loss: 0.410 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.0653807
	speed: 0.6643s/iter; left time: 26544.8155s
	iters: 200, epoch: 4 | loss: 0.0000432
	speed: 0.3504s/iter; left time: 13966.6238s
	iters: 300, epoch: 4 | loss: 0.4383119
	speed: 0.3374s/iter; left time: 13415.0311s
	iters: 400, epoch: 4 | loss: 0.5041277
	speed: 0.3482s/iter; left time: 13809.8718s
Epoch: 4 cost time: 142.00941252708435
Epoch: 4, Steps: 413 | Train Loss: 0.336 Vali Loss: 0.534 Vali Acc: 0.935 Test Loss: 0.534 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0000299
	speed: 0.6903s/iter; left time: 27300.2798s
	iters: 200, epoch: 5 | loss: 0.5951542
	speed: 0.3362s/iter; left time: 13262.5517s
	iters: 300, epoch: 5 | loss: 0.0000194
	speed: 0.3411s/iter; left time: 13420.7583s
	iters: 400, epoch: 5 | loss: 0.0017146
	speed: 0.3388s/iter; left time: 13299.3797s
Epoch: 5 cost time: 141.32937932014465
Epoch: 5, Steps: 413 | Train Loss: 0.344 Vali Loss: 0.351 Vali Acc: 0.945 Test Loss: 0.351 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0000120
	speed: 0.6787s/iter; left time: 26563.4467s
	iters: 200, epoch: 6 | loss: 0.4550445
	speed: 0.3470s/iter; left time: 13544.0776s
	iters: 300, epoch: 6 | loss: 0.0000554
	speed: 0.3371s/iter; left time: 13126.8422s
	iters: 400, epoch: 6 | loss: 1.1692301
	speed: 0.3297s/iter; left time: 12802.4051s
Epoch: 6 cost time: 139.68451118469238
Epoch: 6, Steps: 413 | Train Loss: 0.278 Vali Loss: 0.598 Vali Acc: 0.930 Test Loss: 0.598 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.8446274
	speed: 0.6680s/iter; left time: 25865.9917s
	iters: 200, epoch: 7 | loss: 0.0000002
	speed: 0.3480s/iter; left time: 13440.5319s
	iters: 300, epoch: 7 | loss: 0.0000023
	speed: 0.3470s/iter; left time: 13367.3558s
	iters: 400, epoch: 7 | loss: 0.0000124
	speed: 0.3384s/iter; left time: 13001.1901s
Epoch: 7 cost time: 141.97908973693848
Epoch: 7, Steps: 413 | Train Loss: 0.268 Vali Loss: 0.286 Vali Acc: 0.970 Test Loss: 0.286 Test Acc: 0.970
Validation loss decreased (-0.960890 --> -0.969529).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2891569
	speed: 0.6707s/iter; left time: 25695.3134s
	iters: 200, epoch: 8 | loss: 0.3408012
	speed: 0.3328s/iter; left time: 12717.1416s
	iters: 300, epoch: 8 | loss: 0.8370984
	speed: 0.3482s/iter; left time: 13270.4128s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.3377s/iter; left time: 12835.8344s
Epoch: 8 cost time: 140.2762053012848
Epoch: 8, Steps: 413 | Train Loss: 0.251 Vali Loss: 0.231 Vali Acc: 0.976 Test Loss: 0.231 Test Acc: 0.976
Validation loss decreased (-0.969529 --> -0.975896).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.6944s/iter; left time: 26316.3931s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.3441s/iter; left time: 13005.8556s
	iters: 300, epoch: 9 | loss: 0.0000015
	speed: 0.3421s/iter; left time: 12896.6329s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.3424s/iter; left time: 12872.4393s
Epoch: 9 cost time: 142.76485466957092
Epoch: 9, Steps: 413 | Train Loss: 0.180 Vali Loss: 0.305 Vali Acc: 0.970 Test Loss: 0.305 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000011
	speed: 0.6739s/iter; left time: 25259.2047s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.3398s/iter; left time: 12703.2084s
	iters: 300, epoch: 10 | loss: 0.0000004
	speed: 0.3401s/iter; left time: 12681.1231s
	iters: 400, epoch: 10 | loss: 0.0001219
	speed: 0.3337s/iter; left time: 12407.2312s
Epoch: 10 cost time: 140.15187048912048
Epoch: 10, Steps: 413 | Train Loss: 0.136 Vali Loss: 0.373 Vali Acc: 0.963 Test Loss: 0.373 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.6763s/iter; left time: 25069.4506s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.3446s/iter; left time: 12740.5851s
	iters: 300, epoch: 11 | loss: 0.0000043
	speed: 0.3456s/iter; left time: 12741.7244s
	iters: 400, epoch: 11 | loss: 0.9682723
	speed: 0.3450s/iter; left time: 12686.5186s
Epoch: 11 cost time: 141.90553092956543
Epoch: 11, Steps: 413 | Train Loss: 0.125 Vali Loss: 0.179 Vali Acc: 0.978 Test Loss: 0.179 Test Acc: 0.978
Validation loss decreased (-0.975896 --> -0.978170).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.6777s/iter; left time: 24844.2833s
	iters: 200, epoch: 12 | loss: 1.5716261
	speed: 0.3340s/iter; left time: 12212.1242s
	iters: 300, epoch: 12 | loss: 0.0029636
	speed: 0.3404s/iter; left time: 12410.6556s
	iters: 400, epoch: 12 | loss: 0.4379686
	speed: 0.3390s/iter; left time: 12324.4284s
Epoch: 12 cost time: 139.40130996704102
Epoch: 12, Steps: 413 | Train Loss: 0.179 Vali Loss: 0.432 Vali Acc: 0.966 Test Loss: 0.432 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0052160
	speed: 0.6991s/iter; left time: 25337.6883s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.3505s/iter; left time: 12667.1073s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.3485s/iter; left time: 12560.9029s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.3400s/iter; left time: 12222.9471s
Epoch: 13 cost time: 143.74973464012146
Epoch: 13, Steps: 413 | Train Loss: 0.111 Vali Loss: 0.449 Vali Acc: 0.969 Test Loss: 0.449 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.4316849
	speed: 0.6713s/iter; left time: 24052.3533s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.3350s/iter; left time: 11968.4819s
	iters: 300, epoch: 14 | loss: 1.1895697
	speed: 0.3429s/iter; left time: 12217.6698s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.3381s/iter; left time: 12015.0591s
Epoch: 14 cost time: 139.87133479118347
Epoch: 14, Steps: 413 | Train Loss: 0.157 Vali Loss: 0.340 Vali Acc: 0.973 Test Loss: 0.340 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.6819s/iter; left time: 24152.4289s
	iters: 200, epoch: 15 | loss: 0.9538184
	speed: 0.3403s/iter; left time: 12019.6005s
	iters: 300, epoch: 15 | loss: 0.0001075
	speed: 0.3366s/iter; left time: 11853.7644s
	iters: 400, epoch: 15 | loss: 0.0008311
	speed: 0.3328s/iter; left time: 11688.3339s
Epoch: 15 cost time: 141.09347081184387
Epoch: 15, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.210 Vali Acc: 0.985 Test Loss: 0.210 Test Acc: 0.985
Validation loss decreased (-0.978170 --> -0.985446).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.2706782
	speed: 0.6904s/iter; left time: 24166.6211s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.3249s/iter; left time: 11342.2666s
	iters: 300, epoch: 16 | loss: 0.5428308
	speed: 0.3500s/iter; left time: 12181.6545s
	iters: 400, epoch: 16 | loss: 2.6084206
	speed: 0.3375s/iter; left time: 11714.5295s
Epoch: 16 cost time: 139.96684169769287
Epoch: 16, Steps: 413 | Train Loss: 0.126 Vali Loss: 0.493 Vali Acc: 0.964 Test Loss: 0.493 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.6764s/iter; left time: 23399.9384s
	iters: 200, epoch: 17 | loss: 0.0620063
	speed: 0.3467s/iter; left time: 11958.1521s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.3434s/iter; left time: 11810.3512s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.3419s/iter; left time: 11724.6099s
Epoch: 17 cost time: 143.0739347934723
Epoch: 17, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.365 Vali Acc: 0.973 Test Loss: 0.365 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0001902
	speed: 0.6791s/iter; left time: 23211.1930s
	iters: 200, epoch: 18 | loss: 0.2573115
	speed: 0.3321s/iter; left time: 11316.6491s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.3513s/iter; left time: 11936.8612s
	iters: 400, epoch: 18 | loss: 0.0000003
	speed: 0.3550s/iter; left time: 12025.9648s
Epoch: 18 cost time: 143.10349106788635
Epoch: 18, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.167 Vali Acc: 0.984 Test Loss: 0.167 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.6884s/iter; left time: 23245.2673s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.3376s/iter; left time: 11364.4689s
	iters: 300, epoch: 19 | loss: 0.3017120
	speed: 0.3309s/iter; left time: 11106.1286s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.3289s/iter; left time: 11008.6134s
Epoch: 19 cost time: 139.7085132598877
Epoch: 19, Steps: 413 | Train Loss: 0.108 Vali Loss: 0.357 Vali Acc: 0.974 Test Loss: 0.357 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.6617s/iter; left time: 22069.1963s
	iters: 200, epoch: 20 | loss: 0.6027648
	speed: 0.3296s/iter; left time: 10960.1803s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.3353s/iter; left time: 11115.9377s
	iters: 400, epoch: 20 | loss: 0.0024631
	speed: 0.3321s/iter; left time: 10976.9996s
Epoch: 20 cost time: 137.20384216308594
Epoch: 20, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.276 Vali Acc: 0.979 Test Loss: 0.276 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0544513
	speed: 0.6518s/iter; left time: 21471.1983s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.3347s/iter; left time: 10990.7326s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.3352s/iter; left time: 10974.7570s
	iters: 400, epoch: 21 | loss: 0.0000352
	speed: 0.3433s/iter; left time: 11204.4035s
Epoch: 21 cost time: 139.68872499465942
Epoch: 21, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.246 Vali Acc: 0.977 Test Loss: 0.246 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.6401s/iter; left time: 20822.3515s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.3209s/iter; left time: 10406.9141s
	iters: 300, epoch: 22 | loss: 0.0000009
	speed: 0.3321s/iter; left time: 10737.5746s
	iters: 400, epoch: 22 | loss: 0.0000045
	speed: 0.3164s/iter; left time: 10195.4933s
Epoch: 22 cost time: 132.75650024414062
Epoch: 22, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.298 Vali Acc: 0.974 Test Loss: 0.298 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.7866168
	speed: 0.6460s/iter; left time: 20745.5385s
	iters: 200, epoch: 23 | loss: 0.5536540
	speed: 0.3237s/iter; left time: 10363.1823s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.3079s/iter; left time: 9827.3580s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.3185s/iter; left time: 10132.5495s
Epoch: 23 cost time: 132.0171980857849
Epoch: 23, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.261 Vali Acc: 0.977 Test Loss: 0.261 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.6109s/iter; left time: 19367.6912s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.3218s/iter; left time: 10168.2581s
	iters: 300, epoch: 24 | loss: 0.2873703
	speed: 0.3385s/iter; left time: 10662.0455s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.3207s/iter; left time: 10069.9837s
Epoch: 24 cost time: 132.3871157169342
Epoch: 24, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.232 Vali Acc: 0.975 Test Loss: 0.232 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.6341s/iter; left time: 19839.1581s
	iters: 200, epoch: 25 | loss: 1.2959859
	speed: 0.3177s/iter; left time: 9907.3774s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.3098s/iter; left time: 9631.1464s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.3223s/iter; left time: 9987.0089s
Epoch: 25 cost time: 131.57590436935425
Epoch: 25, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.222 Vali Acc: 0.980 Test Loss: 0.222 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9854479308776717
model parameter : 12973066
model size : 69.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         28                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3063887
	speed: 0.3305s/iter; left time: 13618.4178s
	iters: 200, epoch: 1 | loss: 0.0023753
	speed: 0.3235s/iter; left time: 13296.6026s
	iters: 300, epoch: 1 | loss: 0.3328744
	speed: 0.3365s/iter; left time: 13798.8684s
	iters: 400, epoch: 1 | loss: 0.1361900
	speed: 0.3188s/iter; left time: 13039.5099s
Epoch: 1 cost time: 135.16623520851135
Epoch: 1, Steps: 413 | Train Loss: 0.382 Vali Loss: 0.251 Vali Acc: 0.939 Test Loss: 0.251 Test Acc: 0.939
Validation loss decreased (inf --> -0.939061).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0000144
	speed: 0.6564s/iter; left time: 26773.2458s
	iters: 200, epoch: 2 | loss: 0.0168325
	speed: 0.3174s/iter; left time: 12915.8222s
	iters: 300, epoch: 2 | loss: 0.5650078
	speed: 0.3212s/iter; left time: 13035.8457s
	iters: 400, epoch: 2 | loss: 0.3419701
	speed: 0.3282s/iter; left time: 13288.8185s
Epoch: 2 cost time: 134.0408103466034
Epoch: 2, Steps: 413 | Train Loss: 0.221 Vali Loss: 0.324 Vali Acc: 0.939 Test Loss: 0.324 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.5973220
	speed: 0.6622s/iter; left time: 26734.4298s
	iters: 200, epoch: 3 | loss: 0.1052811
	speed: 0.3576s/iter; left time: 14401.4793s
	iters: 300, epoch: 3 | loss: 0.0193697
	speed: 0.3440s/iter; left time: 13820.9317s
	iters: 400, epoch: 3 | loss: 0.0003339
	speed: 0.3275s/iter; left time: 13123.3622s
Epoch: 3 cost time: 141.74873113632202
Epoch: 3, Steps: 413 | Train Loss: 0.371 Vali Loss: 0.421 Vali Acc: 0.944 Test Loss: 0.421 Test Acc: 0.944
Validation loss decreased (-0.939061 --> -0.944061).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0001722
	speed: 0.6407s/iter; left time: 25604.4012s
	iters: 200, epoch: 4 | loss: 0.0247055
	speed: 0.3145s/iter; left time: 12538.5857s
	iters: 300, epoch: 4 | loss: 0.7362289
	speed: 0.2932s/iter; left time: 11657.7757s
	iters: 400, epoch: 4 | loss: 0.0002891
	speed: 0.3040s/iter; left time: 12055.7795s
Epoch: 4 cost time: 126.69103455543518
Epoch: 4, Steps: 413 | Train Loss: 0.376 Vali Loss: 0.372 Vali Acc: 0.958 Test Loss: 0.372 Test Acc: 0.958
Validation loss decreased (-0.944061 --> -0.958159).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9242754
	speed: 0.6287s/iter; left time: 24866.0459s
	iters: 200, epoch: 5 | loss: 0.0000230
	speed: 0.3386s/iter; left time: 13358.1199s
	iters: 300, epoch: 5 | loss: 0.0000881
	speed: 0.3290s/iter; left time: 12944.3445s
	iters: 400, epoch: 5 | loss: 0.0010848
	speed: 0.3306s/iter; left time: 12974.5639s
Epoch: 5 cost time: 136.1751275062561
Epoch: 5, Steps: 413 | Train Loss: 0.355 Vali Loss: 0.470 Vali Acc: 0.947 Test Loss: 0.470 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.5944338
	speed: 0.5985s/iter; left time: 23421.6581s
	iters: 200, epoch: 6 | loss: 0.0000088
	speed: 0.3069s/iter; left time: 11981.5346s
	iters: 300, epoch: 6 | loss: 0.6002238
	speed: 0.3063s/iter; left time: 11924.1904s
	iters: 400, epoch: 6 | loss: 0.0283842
	speed: 0.3129s/iter; left time: 12153.3061s
Epoch: 6 cost time: 126.68283486366272
Epoch: 6, Steps: 413 | Train Loss: 0.288 Vali Loss: 0.231 Vali Acc: 0.978 Test Loss: 0.231 Test Acc: 0.978
Validation loss decreased (-0.958159 --> -0.978170).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.3259614
	speed: 0.5992s/iter; left time: 23203.2718s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.2965s/iter; left time: 11451.4330s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.2966s/iter; left time: 11427.0019s
	iters: 400, epoch: 7 | loss: 0.4524433
	speed: 0.3027s/iter; left time: 11630.8406s
Epoch: 7 cost time: 123.80822920799255
Epoch: 7, Steps: 413 | Train Loss: 0.202 Vali Loss: 0.418 Vali Acc: 0.959 Test Loss: 0.418 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0001172
	speed: 0.6231s/iter; left time: 23869.3141s
	iters: 200, epoch: 8 | loss: 0.0000112
	speed: 0.3116s/iter; left time: 11904.4850s
	iters: 300, epoch: 8 | loss: 0.0982789
	speed: 0.3085s/iter; left time: 11758.4066s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.3046s/iter; left time: 11576.8459s
Epoch: 8 cost time: 127.79357528686523
Epoch: 8, Steps: 413 | Train Loss: 0.276 Vali Loss: 0.665 Vali Acc: 0.950 Test Loss: 0.665 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.5965s/iter; left time: 22604.7327s
	iters: 200, epoch: 9 | loss: 0.7975326
	speed: 0.3145s/iter; left time: 11888.9400s
	iters: 300, epoch: 9 | loss: 0.0000415
	speed: 0.3333s/iter; left time: 12563.8688s
	iters: 400, epoch: 9 | loss: 0.6779645
	speed: 0.3349s/iter; left time: 12590.8413s
Epoch: 9 cost time: 133.57945084571838
Epoch: 9, Steps: 413 | Train Loss: 0.167 Vali Loss: 0.247 Vali Acc: 0.977 Test Loss: 0.247 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0048519
	speed: 0.6440s/iter; left time: 24139.3326s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.3233s/iter; left time: 12086.9641s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.3193s/iter; left time: 11905.4290s
	iters: 400, epoch: 10 | loss: 0.0000001
	speed: 0.3186s/iter; left time: 11847.1188s
Epoch: 10 cost time: 133.11976504325867
Epoch: 10, Steps: 413 | Train Loss: 0.178 Vali Loss: 0.200 Vali Acc: 0.977 Test Loss: 0.200 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.1138608
	speed: 0.6463s/iter; left time: 23959.6508s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.3155s/iter; left time: 11662.7609s
	iters: 300, epoch: 11 | loss: 0.0000070
	speed: 0.3058s/iter; left time: 11273.4622s
	iters: 400, epoch: 11 | loss: 0.4750447
	speed: 0.3062s/iter; left time: 11259.5554s
Epoch: 11 cost time: 129.807382106781
Epoch: 11, Steps: 413 | Train Loss: 0.115 Vali Loss: 0.277 Vali Acc: 0.970 Test Loss: 0.277 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000043
	speed: 0.6171s/iter; left time: 22620.5439s
	iters: 200, epoch: 12 | loss: 0.0161722
	speed: 0.3166s/iter; left time: 11574.1057s
	iters: 300, epoch: 12 | loss: 1.6347059
	speed: 0.3314s/iter; left time: 12080.7202s
	iters: 400, epoch: 12 | loss: 0.0002368
	speed: 0.3040s/iter; left time: 11053.9584s
Epoch: 12 cost time: 131.06308102607727
Epoch: 12, Steps: 413 | Train Loss: 0.146 Vali Loss: 0.264 Vali Acc: 0.975 Test Loss: 0.264 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.6073s/iter; left time: 22011.9479s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.3130s/iter; left time: 11312.8788s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.3142s/iter; left time: 11326.7505s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.3248s/iter; left time: 11674.9715s
Epoch: 13 cost time: 130.48760199546814
Epoch: 13, Steps: 413 | Train Loss: 0.138 Vali Loss: 0.427 Vali Acc: 0.966 Test Loss: 0.427 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.6706s/iter; left time: 24029.3822s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.3233s/iter; left time: 11553.3745s
	iters: 300, epoch: 14 | loss: 0.0000114
	speed: 0.3087s/iter; left time: 11001.2165s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.3125s/iter; left time: 11103.7770s
Epoch: 14 cost time: 132.92818427085876
Epoch: 14, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.508 Vali Acc: 0.963 Test Loss: 0.508 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.6245s/iter; left time: 22117.4640s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.3233s/iter; left time: 11420.0707s
	iters: 300, epoch: 15 | loss: 0.0306183
	speed: 0.3231s/iter; left time: 11378.9648s
	iters: 400, epoch: 15 | loss: 0.0000099
	speed: 0.3152s/iter; left time: 11070.1459s
Epoch: 15 cost time: 132.0758020877838
Epoch: 15, Steps: 413 | Train Loss: 0.139 Vali Loss: 0.325 Vali Acc: 0.971 Test Loss: 0.325 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0001990
	speed: 0.6333s/iter; left time: 22169.4093s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.3055s/iter; left time: 10662.6416s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.3103s/iter; left time: 10800.4645s
	iters: 400, epoch: 16 | loss: 0.0034167
	speed: 0.3236s/iter; left time: 11230.7596s
Epoch: 16 cost time: 130.08688187599182
Epoch: 16, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.297 Vali Acc: 0.979 Test Loss: 0.297 Test Acc: 0.979
Validation loss decreased (-0.978170 --> -0.978624).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.6234s/iter; left time: 21563.9109s
	iters: 200, epoch: 17 | loss: 0.0329515
	speed: 0.3161s/iter; left time: 10904.6923s
	iters: 300, epoch: 17 | loss: 0.0055009
	speed: 0.3066s/iter; left time: 10544.2587s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.3059s/iter; left time: 10491.1520s
Epoch: 17 cost time: 128.40121150016785
Epoch: 17, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.279 Vali Acc: 0.977 Test Loss: 0.279 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.6438s/iter; left time: 22004.5076s
	iters: 200, epoch: 18 | loss: 0.5341004
	speed: 0.3188s/iter; left time: 10865.8972s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.3195s/iter; left time: 10856.5186s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.3264s/iter; left time: 11057.4257s
Epoch: 18 cost time: 133.56589126586914
Epoch: 18, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.321 Vali Acc: 0.980 Test Loss: 0.321 Test Acc: 0.980
Validation loss decreased (-0.978624 --> -0.979533).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.6340s/iter; left time: 21408.1490s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.3196s/iter; left time: 10759.1665s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.3136s/iter; left time: 10525.8374s
	iters: 400, epoch: 19 | loss: 1.1193130
	speed: 0.3110s/iter; left time: 10409.2392s
Epoch: 19 cost time: 129.89236402511597
Epoch: 19, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.468 Vali Acc: 0.963 Test Loss: 0.468 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.6284s/iter; left time: 20960.5516s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.3176s/iter; left time: 10560.2836s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.3243s/iter; left time: 10753.4875s
	iters: 400, epoch: 20 | loss: 0.0001855
	speed: 0.3196s/iter; left time: 10562.8721s
Epoch: 20 cost time: 132.52519154548645
Epoch: 20, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.379 Vali Acc: 0.973 Test Loss: 0.379 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000060
	speed: 0.6197s/iter; left time: 20413.7870s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.3215s/iter; left time: 10559.7067s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.3249s/iter; left time: 10638.8002s
	iters: 400, epoch: 21 | loss: 0.0000012
	speed: 0.3221s/iter; left time: 10513.9673s
Epoch: 21 cost time: 132.67162823677063
Epoch: 21, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.115 Vali Acc: 0.988 Test Loss: 0.115 Test Acc: 0.988
Validation loss decreased (-0.979533 --> -0.988175).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0000003
	speed: 0.6112s/iter; left time: 19881.8711s
	iters: 200, epoch: 22 | loss: 0.0004180
	speed: 0.3027s/iter; left time: 9817.2935s
	iters: 300, epoch: 22 | loss: 0.0000474
	speed: 0.3148s/iter; left time: 10177.4229s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.3249s/iter; left time: 10471.1716s
Epoch: 22 cost time: 129.7441656589508
Epoch: 22, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.123 Vali Acc: 0.989 Test Loss: 0.123 Test Acc: 0.989
Validation loss decreased (-0.988175 --> -0.988630).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.6448s/iter; left time: 20706.3131s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.3112s/iter; left time: 9961.5154s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.3150s/iter; left time: 10052.8226s
	iters: 400, epoch: 23 | loss: 0.0000005
	speed: 0.3348s/iter; left time: 10651.2250s
Epoch: 23 cost time: 132.28141069412231
Epoch: 23, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.225 Vali Acc: 0.977 Test Loss: 0.225 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.6455s/iter; left time: 20464.3842s
	iters: 200, epoch: 24 | loss: 0.0000002
	speed: 0.2935s/iter; left time: 9275.7754s
	iters: 300, epoch: 24 | loss: 0.0119633
	speed: 0.2928s/iter; left time: 9224.0277s
	iters: 400, epoch: 24 | loss: 0.0746398
	speed: 0.2927s/iter; left time: 9191.4766s
Epoch: 24 cost time: 124.22854089736938
Epoch: 24, Steps: 413 | Train Loss: 0.114 Vali Loss: 0.347 Vali Acc: 0.970 Test Loss: 0.347 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.6108s/iter; left time: 19111.0285s
	iters: 200, epoch: 25 | loss: 0.0000019
	speed: 0.3201s/iter; left time: 9985.0475s
	iters: 300, epoch: 25 | loss: 0.0400610
	speed: 0.3041s/iter; left time: 9453.6489s
	iters: 400, epoch: 25 | loss: 0.0000001
	speed: 0.3064s/iter; left time: 9496.3050s
Epoch: 25 cost time: 128.22023963928223
Epoch: 25, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.209 Vali Acc: 0.977 Test Loss: 0.209 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.6204s/iter; left time: 19155.0534s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.3144s/iter; left time: 9676.9928s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.2965s/iter; left time: 9094.9839s
	iters: 400, epoch: 26 | loss: 0.0000014
	speed: 0.3014s/iter; left time: 9214.4231s
Epoch: 26 cost time: 126.7484405040741
Epoch: 26, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.151 Vali Acc: 0.984 Test Loss: 0.151 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.5960s/iter; left time: 18154.4941s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.3146s/iter; left time: 9553.1351s
	iters: 300, epoch: 27 | loss: 0.0000033
	speed: 0.3192s/iter; left time: 9659.7102s
	iters: 400, epoch: 27 | loss: 0.0000001
	speed: 0.2978s/iter; left time: 8983.7723s
Epoch: 27 cost time: 128.13379192352295
Epoch: 27, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.402 Vali Acc: 0.968 Test Loss: 0.402 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.1697980
	speed: 0.6117s/iter; left time: 18380.2794s
	iters: 200, epoch: 28 | loss: 0.0845502
	speed: 0.3172s/iter; left time: 9499.9572s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.3049s/iter; left time: 9099.7963s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.2998s/iter; left time: 8918.4708s
Epoch: 28 cost time: 128.01913380622864
Epoch: 28, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.194 Vali Acc: 0.979 Test Loss: 0.194 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.3271992
	speed: 0.5584s/iter; left time: 16549.4156s
	iters: 200, epoch: 29 | loss: 0.0000005
	speed: 0.2910s/iter; left time: 8595.3265s
	iters: 300, epoch: 29 | loss: 0.0000202
	speed: 0.2970s/iter; left time: 8741.7284s
	iters: 400, epoch: 29 | loss: 0.1123078
	speed: 0.3059s/iter; left time: 8973.2095s
Epoch: 29 cost time: 121.9629259109497
Epoch: 29, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.094 Vali Acc: 0.990 Test Loss: 0.094 Test Acc: 0.990
Validation loss decreased (-0.988630 --> -0.989540).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.6189s/iter; left time: 18085.8168s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.3006s/iter; left time: 8755.7205s
	iters: 300, epoch: 30 | loss: 0.0000045
	speed: 0.2953s/iter; left time: 8571.7741s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.2961s/iter; left time: 8563.8597s
Epoch: 30 cost time: 124.15212440490723
Epoch: 30, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.116 Vali Acc: 0.982 Test Loss: 0.116 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0000018
	speed: 0.6017s/iter; left time: 17336.0054s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.2924s/iter; left time: 8393.9342s
	iters: 300, epoch: 31 | loss: 0.0000001
	speed: 0.2971s/iter; left time: 8499.9739s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.3030s/iter; left time: 8637.9097s
Epoch: 31 cost time: 123.4484190940857
Epoch: 31, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.319 Vali Acc: 0.969 Test Loss: 0.319 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0000009
	speed: 0.5983s/iter; left time: 16991.3346s
	iters: 200, epoch: 32 | loss: 0.0000006
	speed: 0.3120s/iter; left time: 8827.8672s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.3231s/iter; left time: 9111.5047s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.3145s/iter; left time: 8836.0674s
Epoch: 32 cost time: 129.42934370040894
Epoch: 32, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.191 Vali Acc: 0.979 Test Loss: 0.191 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.0000014
	speed: 0.5908s/iter; left time: 16533.8446s
	iters: 200, epoch: 33 | loss: 0.0000052
	speed: 0.3083s/iter; left time: 8596.6720s
	iters: 300, epoch: 33 | loss: 0.2058749
	speed: 0.3027s/iter; left time: 8410.1790s
	iters: 400, epoch: 33 | loss: 0.0000001
	speed: 0.2928s/iter; left time: 8105.8348s
Epoch: 33 cost time: 124.5914957523346
Epoch: 33, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.260 Vali Acc: 0.971 Test Loss: 0.260 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.5892s/iter; left time: 16244.2432s
	iters: 200, epoch: 34 | loss: 0.0000026
	speed: 0.2980s/iter; left time: 8185.4644s
	iters: 300, epoch: 34 | loss: 0.0104525
	speed: 0.2986s/iter; left time: 8174.1353s
	iters: 400, epoch: 34 | loss: 0.4671589
	speed: 0.2964s/iter; left time: 8082.1278s
Epoch: 34 cost time: 123.03902888298035
Epoch: 34, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.171 Vali Acc: 0.976 Test Loss: 0.171 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.0004656
	speed: 0.5971s/iter; left time: 16215.8320s
	iters: 200, epoch: 35 | loss: 0.0000006
	speed: 0.3123s/iter; left time: 8449.4436s
	iters: 300, epoch: 35 | loss: 0.0000037
	speed: 0.3016s/iter; left time: 8131.6534s
	iters: 400, epoch: 35 | loss: 0.0000476
	speed: 0.2845s/iter; left time: 7640.2353s
Epoch: 35 cost time: 123.92421698570251
Epoch: 35, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.162 Vali Acc: 0.978 Test Loss: 0.162 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.0000015
	speed: 0.5745s/iter; left time: 15365.2560s
	iters: 200, epoch: 36 | loss: 0.0000001
	speed: 0.3065s/iter; left time: 8168.0387s
	iters: 300, epoch: 36 | loss: 0.2967101
	speed: 0.3065s/iter; left time: 8136.1169s
	iters: 400, epoch: 36 | loss: 0.0000068
	speed: 0.3098s/iter; left time: 8192.4962s
Epoch: 36 cost time: 126.07217812538147
Epoch: 36, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.109 Vali Acc: 0.983 Test Loss: 0.109 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 0.0000003
	speed: 0.5834s/iter; left time: 15363.4733s
	iters: 200, epoch: 37 | loss: 0.0000091
	speed: 0.3018s/iter; left time: 7917.1036s
	iters: 300, epoch: 37 | loss: 0.0000343
	speed: 0.2964s/iter; left time: 7745.8382s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.3009s/iter; left time: 7832.4054s
Epoch: 37 cost time: 122.9338788986206
Epoch: 37, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.087 Vali Acc: 0.989 Test Loss: 0.087 Test Acc: 0.989
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 0.0000020
	speed: 0.6124s/iter; left time: 15874.3792s
	iters: 200, epoch: 38 | loss: 0.0426612
	speed: 0.2966s/iter; left time: 7659.0278s
	iters: 300, epoch: 38 | loss: 0.0215506
	speed: 0.2767s/iter; left time: 7117.9725s
	iters: 400, epoch: 38 | loss: 0.0000003
	speed: 0.2832s/iter; left time: 7254.5991s
Epoch: 38 cost time: 120.88963389396667
Epoch: 38, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.057 Vali Acc: 0.989 Test Loss: 0.057 Test Acc: 0.989
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 0.0000272
	speed: 0.6084s/iter; left time: 15519.1727s
	iters: 200, epoch: 39 | loss: 0.0000000
	speed: 0.3017s/iter; left time: 7664.5853s
	iters: 300, epoch: 39 | loss: 0.0000001
	speed: 0.2956s/iter; left time: 7480.7918s
	iters: 400, epoch: 39 | loss: 0.0000000
	speed: 0.2780s/iter; left time: 7007.4060s
Epoch: 39 cost time: 122.21273803710938
Epoch: 39, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.182 Vali Acc: 0.984 Test Loss: 0.182 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9895407003183265
model parameter : 12973066
model size : 69.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4746272
	speed: 0.3058s/iter; left time: 12599.8198s
	iters: 200, epoch: 1 | loss: 0.0127923
	speed: 0.2941s/iter; left time: 12089.1935s
	iters: 300, epoch: 1 | loss: 0.2765116
	speed: 0.2808s/iter; left time: 11514.5312s
	iters: 400, epoch: 1 | loss: 0.1269640
	speed: 0.2822s/iter; left time: 11541.3585s
Epoch: 1 cost time: 120.24877285957336
Epoch: 1, Steps: 413 | Train Loss: 0.424 Vali Loss: 0.174 Vali Acc: 0.952 Test Loss: 0.174 Test Acc: 0.952
Validation loss decreased (inf --> -0.952249).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0003411
	speed: 0.5888s/iter; left time: 24017.8315s
	iters: 200, epoch: 2 | loss: 0.0036859
	speed: 0.2920s/iter; left time: 11882.3514s
	iters: 300, epoch: 2 | loss: 0.6357943
	speed: 0.2882s/iter; left time: 11698.1473s
	iters: 400, epoch: 2 | loss: 0.8043516
	speed: 0.2917s/iter; left time: 11811.6487s
Epoch: 2 cost time: 121.15537881851196
Epoch: 2, Steps: 413 | Train Loss: 0.277 Vali Loss: 0.238 Vali Acc: 0.939 Test Loss: 0.238 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.5159051
	speed: 0.6023s/iter; left time: 24316.4861s
	iters: 200, epoch: 3 | loss: 0.0024930
	speed: 0.3142s/iter; left time: 12652.6406s
	iters: 300, epoch: 3 | loss: 0.0366907
	speed: 0.3053s/iter; left time: 12263.9184s
	iters: 400, epoch: 3 | loss: 0.2121967
	speed: 0.2904s/iter; left time: 11639.7444s
Epoch: 3 cost time: 126.22066330909729
Epoch: 3, Steps: 413 | Train Loss: 0.345 Vali Loss: 0.353 Vali Acc: 0.947 Test Loss: 0.353 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0000004
	speed: 0.5988s/iter; left time: 23928.0730s
	iters: 200, epoch: 4 | loss: 0.0000008
	speed: 0.3243s/iter; left time: 12925.4740s
	iters: 300, epoch: 4 | loss: 0.0000217
	speed: 0.3205s/iter; left time: 12742.1937s
	iters: 400, epoch: 4 | loss: 0.0283637
	speed: 0.3165s/iter; left time: 12551.9786s
Epoch: 4 cost time: 131.32135152816772
Epoch: 4, Steps: 413 | Train Loss: 0.364 Vali Loss: 0.882 Vali Acc: 0.916 Test Loss: 0.882 Test Acc: 0.916
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.5662441
	speed: 0.5886s/iter; left time: 23280.2875s
	iters: 200, epoch: 5 | loss: 0.2404880
	speed: 0.3032s/iter; left time: 11960.3593s
	iters: 300, epoch: 5 | loss: 0.0005051
	speed: 0.3094s/iter; left time: 12174.7400s
	iters: 400, epoch: 5 | loss: 0.0139124
	speed: 0.3206s/iter; left time: 12583.8586s
Epoch: 5 cost time: 127.14690780639648
Epoch: 5, Steps: 413 | Train Loss: 0.326 Vali Loss: 0.909 Vali Acc: 0.934 Test Loss: 0.909 Test Acc: 0.934
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0000001
	speed: 0.6144s/iter; left time: 24043.5101s
	iters: 200, epoch: 6 | loss: 0.0000341
	speed: 0.3047s/iter; left time: 11892.7921s
	iters: 300, epoch: 6 | loss: 0.2661288
	speed: 0.3240s/iter; left time: 12617.0322s
	iters: 400, epoch: 6 | loss: 0.0002866
	speed: 0.3197s/iter; left time: 12415.3850s
Epoch: 6 cost time: 129.6627972126007
Epoch: 6, Steps: 413 | Train Loss: 0.277 Vali Loss: 0.267 Vali Acc: 0.966 Test Loss: 0.267 Test Acc: 0.966
Validation loss decreased (-0.952249 --> -0.965891).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.6475558
	speed: 0.6293s/iter; left time: 24366.9668s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.3052s/iter; left time: 11788.1008s
	iters: 300, epoch: 7 | loss: 0.4846712
	speed: 0.3234s/iter; left time: 12459.6429s
	iters: 400, epoch: 7 | loss: 0.0700083
	speed: 0.3183s/iter; left time: 12228.2302s
Epoch: 7 cost time: 131.05739617347717
Epoch: 7, Steps: 413 | Train Loss: 0.231 Vali Loss: 0.464 Vali Acc: 0.962 Test Loss: 0.464 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.3738632
	speed: 0.5807s/iter; left time: 22245.2519s
	iters: 200, epoch: 8 | loss: 0.5120106
	speed: 0.3107s/iter; left time: 11870.7441s
	iters: 300, epoch: 8 | loss: 0.0002702
	speed: 0.3254s/iter; left time: 12401.4995s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.3213s/iter; left time: 12213.9323s
Epoch: 8 cost time: 129.58728122711182
Epoch: 8, Steps: 413 | Train Loss: 0.217 Vali Loss: 0.263 Vali Acc: 0.968 Test Loss: 0.263 Test Acc: 0.968
Validation loss decreased (-0.965891 --> -0.968165).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000245
	speed: 0.6402s/iter; left time: 24261.0386s
	iters: 200, epoch: 9 | loss: 0.0000004
	speed: 0.3134s/iter; left time: 11843.8162s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.3173s/iter; left time: 11962.6764s
	iters: 400, epoch: 9 | loss: 0.0000604
	speed: 0.3203s/iter; left time: 12043.2790s
Epoch: 9 cost time: 130.54702186584473
Epoch: 9, Steps: 413 | Train Loss: 0.131 Vali Loss: 0.444 Vali Acc: 0.960 Test Loss: 0.444 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000022
	speed: 0.5920s/iter; left time: 22192.3089s
	iters: 200, epoch: 10 | loss: 0.8607560
	speed: 0.3056s/iter; left time: 11426.0971s
	iters: 300, epoch: 10 | loss: 0.0007050
	speed: 0.3204s/iter; left time: 11947.0660s
	iters: 400, epoch: 10 | loss: 1.3092082
	speed: 0.3155s/iter; left time: 11731.5270s
Epoch: 10 cost time: 128.5493049621582
Epoch: 10, Steps: 413 | Train Loss: 0.204 Vali Loss: 0.289 Vali Acc: 0.965 Test Loss: 0.289 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000004
	speed: 0.6205s/iter; left time: 23002.8663s
	iters: 200, epoch: 11 | loss: 0.0000001
	speed: 0.2998s/iter; left time: 11083.9899s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.3180s/iter; left time: 11724.2520s
	iters: 400, epoch: 11 | loss: 0.3147686
	speed: 0.3150s/iter; left time: 11581.8235s
Epoch: 11 cost time: 126.97402620315552
Epoch: 11, Steps: 413 | Train Loss: 0.129 Vali Loss: 0.296 Vali Acc: 0.970 Test Loss: 0.296 Test Acc: 0.970
Validation loss decreased (-0.968165 --> -0.970438).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0004356
	speed: 0.6421s/iter; left time: 23537.4037s
	iters: 200, epoch: 12 | loss: 0.0000045
	speed: 0.3091s/iter; left time: 11301.6057s
	iters: 300, epoch: 12 | loss: 0.0008110
	speed: 0.3025s/iter; left time: 11029.9460s
	iters: 400, epoch: 12 | loss: 0.0000007
	speed: 0.3053s/iter; left time: 11100.9344s
Epoch: 12 cost time: 127.80010294914246
Epoch: 12, Steps: 413 | Train Loss: 0.112 Vali Loss: 0.408 Vali Acc: 0.970 Test Loss: 0.408 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0010826
	speed: 0.6311s/iter; left time: 22874.7240s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.3282s/iter; left time: 11862.3198s
	iters: 300, epoch: 13 | loss: 0.0012289
	speed: 0.3247s/iter; left time: 11703.6165s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.3140s/iter; left time: 11286.9736s
Epoch: 13 cost time: 132.8935317993164
Epoch: 13, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.469 Vali Acc: 0.959 Test Loss: 0.469 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.6099s/iter; left time: 21855.0862s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.3246s/iter; left time: 11597.5224s
	iters: 300, epoch: 14 | loss: 0.2473803
	speed: 0.3044s/iter; left time: 10846.0519s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.2958s/iter; left time: 10511.1005s
Epoch: 14 cost time: 128.77266263961792
Epoch: 14, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.579 Vali Acc: 0.960 Test Loss: 0.579 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.6389s/iter; left time: 22628.5312s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.3087s/iter; left time: 10903.6174s
	iters: 300, epoch: 15 | loss: 0.0000048
	speed: 0.3157s/iter; left time: 11117.6086s
	iters: 400, epoch: 15 | loss: 0.2201096
	speed: 0.3281s/iter; left time: 11523.6838s
Epoch: 15 cost time: 131.63629746437073
Epoch: 15, Steps: 413 | Train Loss: 0.113 Vali Loss: 0.547 Vali Acc: 0.964 Test Loss: 0.547 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000062
	speed: 0.6426s/iter; left time: 22493.7577s
	iters: 200, epoch: 16 | loss: 0.0000011
	speed: 0.3256s/iter; left time: 11366.1921s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.3089s/iter; left time: 10751.9450s
	iters: 400, epoch: 16 | loss: 0.0000022
	speed: 0.2957s/iter; left time: 10263.9502s
Epoch: 16 cost time: 129.42895531654358
Epoch: 16, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.532 Vali Acc: 0.963 Test Loss: 0.532 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000073
	speed: 0.6418s/iter; left time: 22201.7322s
	iters: 200, epoch: 17 | loss: 0.8424166
	speed: 0.3330s/iter; left time: 11487.7607s
	iters: 300, epoch: 17 | loss: 0.0000006
	speed: 0.3287s/iter; left time: 11304.1415s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.3249s/iter; left time: 11140.4411s
Epoch: 17 cost time: 136.25070023536682
Epoch: 17, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.277 Vali Acc: 0.975 Test Loss: 0.277 Test Acc: 0.975
Validation loss decreased (-0.970438 --> -0.974986).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.6518s/iter; left time: 22278.1472s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.3122s/iter; left time: 10640.3387s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.3230s/iter; left time: 10975.7118s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.3247s/iter; left time: 11001.0003s
Epoch: 18 cost time: 132.57183837890625
Epoch: 18, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.478 Vali Acc: 0.964 Test Loss: 0.478 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.5837s/iter; left time: 19708.1702s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.3243s/iter; left time: 10917.3903s
	iters: 300, epoch: 19 | loss: 0.2464343
	speed: 0.3320s/iter; left time: 11145.7381s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.3347s/iter; left time: 11200.8796s
Epoch: 19 cost time: 132.7596776485443
Epoch: 19, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.241 Vali Acc: 0.977 Test Loss: 0.241 Test Acc: 0.977
Validation loss decreased (-0.974986 --> -0.976805).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000032
	speed: 0.6588s/iter; left time: 21972.7594s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.3142s/iter; left time: 10447.2827s
	iters: 300, epoch: 20 | loss: 0.0000001
	speed: 0.3109s/iter; left time: 10308.7163s
	iters: 400, epoch: 20 | loss: 0.0000020
	speed: 0.3278s/iter; left time: 10833.5278s
Epoch: 20 cost time: 131.973126411438
Epoch: 20, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.308 Vali Acc: 0.967 Test Loss: 0.308 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000001
	speed: 0.6274s/iter; left time: 20666.0815s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.3163s/iter; left time: 10388.2873s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.3207s/iter; left time: 10499.0874s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.3206s/iter; left time: 10465.4082s
Epoch: 21 cost time: 131.65205311775208
Epoch: 21, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.659 Vali Acc: 0.959 Test Loss: 0.659 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.6438s/iter; left time: 20942.1071s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.3288s/iter; left time: 10662.3267s
	iters: 300, epoch: 22 | loss: 3.2175398
	speed: 0.3016s/iter; left time: 9750.2804s
	iters: 400, epoch: 22 | loss: 0.0000782
	speed: 0.2912s/iter; left time: 9386.3149s
Epoch: 22 cost time: 129.70826387405396
Epoch: 22, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.268 Vali Acc: 0.972 Test Loss: 0.268 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.7783942
	speed: 0.6207s/iter; left time: 19934.5076s
	iters: 200, epoch: 23 | loss: 0.0000002
	speed: 0.3085s/iter; left time: 9875.8798s
	iters: 300, epoch: 23 | loss: 0.0000004
	speed: 0.3115s/iter; left time: 9940.4242s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.3160s/iter; left time: 10053.8169s
Epoch: 23 cost time: 129.71977162361145
Epoch: 23, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.151 Vali Acc: 0.983 Test Loss: 0.151 Test Acc: 0.983
Validation loss decreased (-0.976805 --> -0.982718).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.6391s/iter; left time: 20259.1895s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.3074s/iter; left time: 9715.2477s
	iters: 300, epoch: 24 | loss: 0.0163636
	speed: 0.3042s/iter; left time: 9581.7831s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.2900s/iter; left time: 9105.8539s
Epoch: 24 cost time: 125.92094445228577
Epoch: 24, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.242 Vali Acc: 0.975 Test Loss: 0.242 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0008364
	speed: 0.6139s/iter; left time: 19209.4554s
	iters: 200, epoch: 25 | loss: 0.0000001
	speed: 0.3240s/iter; left time: 10105.3369s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.3083s/iter; left time: 9584.1402s
	iters: 400, epoch: 25 | loss: 0.0000569
	speed: 0.3010s/iter; left time: 9328.0981s
Epoch: 25 cost time: 129.75541949272156
Epoch: 25, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.273 Vali Acc: 0.976 Test Loss: 0.273 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.6340s/iter; left time: 19575.3942s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.3005s/iter; left time: 9248.2733s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.2847s/iter; left time: 8733.7649s
	iters: 400, epoch: 26 | loss: 0.0000044
	speed: 0.3050s/iter; left time: 9324.9431s
Epoch: 26 cost time: 124.85289072990417
Epoch: 26, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.275 Vali Acc: 0.974 Test Loss: 0.275 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0000010
	speed: 0.6216s/iter; left time: 18936.2816s
	iters: 200, epoch: 27 | loss: 0.0000042
	speed: 0.3157s/iter; left time: 9585.1182s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.3149s/iter; left time: 9528.7393s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.3168s/iter; left time: 9555.6199s
Epoch: 27 cost time: 131.2805528640747
Epoch: 27, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.161 Vali Acc: 0.980 Test Loss: 0.161 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0000040
	speed: 0.6012s/iter; left time: 18066.0624s
	iters: 200, epoch: 28 | loss: 0.0000044
	speed: 0.3314s/iter; left time: 9924.7418s
	iters: 300, epoch: 28 | loss: 0.0000001
	speed: 0.3265s/iter; left time: 9746.3715s
	iters: 400, epoch: 28 | loss: 0.0000470
	speed: 0.3273s/iter; left time: 9737.8143s
Epoch: 28 cost time: 134.34343791007996
Epoch: 28, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.165 Vali Acc: 0.983 Test Loss: 0.165 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0000041
	speed: 0.6476s/iter; left time: 19192.7137s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.3003s/iter; left time: 8870.1198s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.3100s/iter; left time: 9124.6538s
	iters: 400, epoch: 29 | loss: 0.0008324
	speed: 0.3220s/iter; left time: 9447.7308s
Epoch: 29 cost time: 128.91435480117798
Epoch: 29, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.172 Vali Acc: 0.979 Test Loss: 0.172 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0000001
	speed: 0.6513s/iter; left time: 19032.2604s
	iters: 200, epoch: 30 | loss: 0.0000001
	speed: 0.3046s/iter; left time: 8870.4771s
	iters: 300, epoch: 30 | loss: 0.0000072
	speed: 0.3411s/iter; left time: 9899.7019s
	iters: 400, epoch: 30 | loss: 0.0000225
	speed: 0.3413s/iter; left time: 9870.8178s
Epoch: 30 cost time: 134.86630511283875
Epoch: 30, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.344 Vali Acc: 0.971 Test Loss: 0.344 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0000001
	speed: 0.6396s/iter; left time: 18427.1467s
	iters: 200, epoch: 31 | loss: 0.0000019
	speed: 0.3242s/iter; left time: 9308.1730s
	iters: 300, epoch: 31 | loss: 0.0003353
	speed: 0.3107s/iter; left time: 8888.1832s
	iters: 400, epoch: 31 | loss: 0.0000023
	speed: 0.3148s/iter; left time: 8975.1039s
Epoch: 31 cost time: 131.61974120140076
Epoch: 31, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.188 Vali Acc: 0.982 Test Loss: 0.188 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.6679s/iter; left time: 18966.7536s
	iters: 200, epoch: 32 | loss: 0.0000287
	speed: 0.2886s/iter; left time: 8165.6143s
	iters: 300, epoch: 32 | loss: 0.0000269
	speed: 0.2962s/iter; left time: 8352.3670s
	iters: 400, epoch: 32 | loss: 0.0000298
	speed: 0.3316s/iter; left time: 9317.8387s
Epoch: 32 cost time: 129.46301460266113
Epoch: 32, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.157 Vali Acc: 0.979 Test Loss: 0.157 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0000003
	speed: 0.6204s/iter; left time: 17360.6604s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.2890s/iter; left time: 8058.3512s
	iters: 300, epoch: 33 | loss: 0.0000344
	speed: 0.3090s/iter; left time: 8584.2717s
	iters: 400, epoch: 33 | loss: 0.0009227
	speed: 0.2942s/iter; left time: 8145.6867s
Epoch: 33 cost time: 124.07924914360046
Epoch: 33, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.110 Vali Acc: 0.984 Test Loss: 0.110 Test Acc: 0.984
Validation loss decreased (-0.982718 --> -0.983628).  Saving model ...
	iters: 100, epoch: 34 | loss: 0.0000003
	speed: 0.5906s/iter; left time: 16283.6342s
	iters: 200, epoch: 34 | loss: 0.0000052
	speed: 0.3010s/iter; left time: 8269.6124s
	iters: 300, epoch: 34 | loss: 0.0014364
	speed: 0.2868s/iter; left time: 7850.5339s
	iters: 400, epoch: 34 | loss: 0.0000029
	speed: 0.3038s/iter; left time: 8286.2071s
Epoch: 34 cost time: 123.1624448299408
Epoch: 34, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
Validation loss decreased (-0.983628 --> -0.986812).  Saving model ...
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.6449s/iter; left time: 17513.8204s
	iters: 200, epoch: 35 | loss: 0.0000005
	speed: 0.3182s/iter; left time: 8611.1688s
	iters: 300, epoch: 35 | loss: 0.0000001
	speed: 0.3028s/iter; left time: 8163.7182s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.2939s/iter; left time: 7895.1724s
Epoch: 35 cost time: 127.31999206542969
Epoch: 35, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.054 Vali Acc: 0.991 Test Loss: 0.054 Test Acc: 0.991
Validation loss decreased (-0.986812 --> -0.990904).  Saving model ...
	iters: 100, epoch: 36 | loss: 0.0019042
	speed: 0.5927s/iter; left time: 15852.0532s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.3135s/iter; left time: 8352.2415s
	iters: 300, epoch: 36 | loss: 0.0000147
	speed: 0.3085s/iter; left time: 8188.3196s
	iters: 400, epoch: 36 | loss: 0.0004325
	speed: 0.3095s/iter; left time: 8184.8254s
Epoch: 36 cost time: 126.71407127380371
Epoch: 36, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.263 Vali Acc: 0.967 Test Loss: 0.263 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 0.0000210
	speed: 0.6145s/iter; left time: 16181.5574s
	iters: 200, epoch: 37 | loss: 0.0002182
	speed: 0.3101s/iter; left time: 8133.9004s
	iters: 300, epoch: 37 | loss: 0.0093644
	speed: 0.3120s/iter; left time: 8154.0667s
	iters: 400, epoch: 37 | loss: 1.3453786
	speed: 0.3192s/iter; left time: 8309.6406s
Epoch: 37 cost time: 129.4168713092804
Epoch: 37, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.246 Vali Acc: 0.961 Test Loss: 0.246 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 0.0000062
	speed: 0.6065s/iter; left time: 15721.0882s
	iters: 200, epoch: 38 | loss: 0.0082300
	speed: 0.3037s/iter; left time: 7841.7720s
	iters: 300, epoch: 38 | loss: 0.0002340
	speed: 0.3024s/iter; left time: 7778.4370s
	iters: 400, epoch: 38 | loss: 0.0001613
	speed: 0.3053s/iter; left time: 7820.8493s
Epoch: 38 cost time: 125.25262212753296
Epoch: 38, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.100 Vali Acc: 0.985 Test Loss: 0.100 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 39 | loss: 0.0000020
	speed: 0.6331s/iter; left time: 16149.0306s
	iters: 200, epoch: 39 | loss: 0.0010485
	speed: 0.3027s/iter; left time: 7689.6884s
	iters: 300, epoch: 39 | loss: 0.0001506
	speed: 0.3115s/iter; left time: 7882.7880s
	iters: 400, epoch: 39 | loss: 0.0000124
	speed: 0.3044s/iter; left time: 7672.0391s
Epoch: 39 cost time: 127.43075799942017
Epoch: 39, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 40 | loss: 0.0000000
	speed: 0.6188s/iter; left time: 15528.9109s
	iters: 200, epoch: 40 | loss: 0.0000242
	speed: 0.3101s/iter; left time: 7751.1475s
	iters: 300, epoch: 40 | loss: 0.0000001
	speed: 0.2958s/iter; left time: 7363.5972s
	iters: 400, epoch: 40 | loss: 0.0000037
	speed: 0.3001s/iter; left time: 7441.7605s
Epoch: 40 cost time: 126.10418176651001
Epoch: 40, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 41 | loss: 0.0000004
	speed: 0.6166s/iter; left time: 15218.4340s
	iters: 200, epoch: 41 | loss: 0.0001124
	speed: 0.3117s/iter; left time: 7662.6676s
	iters: 300, epoch: 41 | loss: 0.0001487
	speed: 0.3044s/iter; left time: 7450.9736s
	iters: 400, epoch: 41 | loss: 0.0000037
	speed: 0.3122s/iter; left time: 7612.5276s
Epoch: 41 cost time: 128.63752007484436
Epoch: 41, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.072 Vali Acc: 0.985 Test Loss: 0.072 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 42 | loss: 0.0000007
	speed: 0.6034s/iter; left time: 14642.8017s
	iters: 200, epoch: 42 | loss: 0.0004802
	speed: 0.2949s/iter; left time: 7126.7760s
	iters: 300, epoch: 42 | loss: 0.0000154
	speed: 0.3001s/iter; left time: 7223.4299s
	iters: 400, epoch: 42 | loss: 0.0000001
	speed: 0.2936s/iter; left time: 7037.6140s
Epoch: 42 cost time: 122.93901491165161
Epoch: 42, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.060 Vali Acc: 0.988 Test Loss: 0.060 Test Acc: 0.988
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 43 | loss: 0.0000019
	speed: 0.5931s/iter; left time: 14148.9626s
	iters: 200, epoch: 43 | loss: 0.0000073
	speed: 0.2998s/iter; left time: 7121.9036s
	iters: 300, epoch: 43 | loss: 0.0000019
	speed: 0.2950s/iter; left time: 6979.1460s
	iters: 400, epoch: 43 | loss: 0.0000000
	speed: 0.3117s/iter; left time: 7342.7036s
Epoch: 43 cost time: 125.42445588111877
Epoch: 43, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 44 | loss: 0.0000158
	speed: 0.6009s/iter; left time: 14087.1300s
	iters: 200, epoch: 44 | loss: 0.0000198
	speed: 0.3111s/iter; left time: 7260.9054s
	iters: 300, epoch: 44 | loss: 0.0000000
	speed: 0.3064s/iter; left time: 7121.2670s
	iters: 400, epoch: 44 | loss: 0.0000015
	speed: 0.3093s/iter; left time: 7157.0689s
Epoch: 44 cost time: 126.79789710044861
Epoch: 44, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.986 Test Loss: 0.067 Test Acc: 0.986
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 45 | loss: 0.0000002
	speed: 0.5730s/iter; left time: 13196.2007s
	iters: 200, epoch: 45 | loss: 0.0000001
	speed: 0.2914s/iter; left time: 6680.3832s
	iters: 300, epoch: 45 | loss: 0.0000004
	speed: 0.3109s/iter; left time: 7097.6248s
	iters: 400, epoch: 45 | loss: 0.0000006
	speed: 0.3030s/iter; left time: 6888.0191s
Epoch: 45 cost time: 123.47876334190369
Epoch: 45, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9909049567985448
model parameter : 12973066
model size : 69.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3741135
	speed: 0.3232s/iter; left time: 13315.1582s
	iters: 200, epoch: 1 | loss: 0.0833202
	speed: 0.3027s/iter; left time: 12440.9754s
	iters: 300, epoch: 1 | loss: 0.5831724
	speed: 0.3065s/iter; left time: 12567.4366s
	iters: 400, epoch: 1 | loss: 0.1167022
	speed: 0.3168s/iter; left time: 12957.4246s
Epoch: 1 cost time: 129.2141284942627
Epoch: 1, Steps: 413 | Train Loss: 0.523 Vali Loss: 0.368 Vali Acc: 0.902 Test Loss: 0.368 Test Acc: 0.902
Validation loss decreased (inf --> -0.901770).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0024584
	speed: 0.6134s/iter; left time: 25020.0545s
	iters: 200, epoch: 2 | loss: 0.2391876
	speed: 0.3082s/iter; left time: 12538.6844s
	iters: 300, epoch: 2 | loss: 1.0974150
	speed: 0.2862s/iter; left time: 11615.9928s
	iters: 400, epoch: 2 | loss: 1.8184396
	speed: 0.3038s/iter; left time: 12302.0389s
Epoch: 2 cost time: 124.98513507843018
Epoch: 2, Steps: 413 | Train Loss: 0.285 Vali Loss: 0.323 Vali Acc: 0.942 Test Loss: 0.323 Test Acc: 0.942
Validation loss decreased (-0.901770 --> -0.942243).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1850066
	speed: 0.6404s/iter; left time: 25856.8883s
	iters: 200, epoch: 3 | loss: 0.0000771
	speed: 0.3073s/iter; left time: 12376.7290s
	iters: 300, epoch: 3 | loss: 0.0797179
	speed: 0.2954s/iter; left time: 11869.1410s
	iters: 400, epoch: 3 | loss: 0.0000296
	speed: 0.2966s/iter; left time: 11887.6603s
Epoch: 3 cost time: 125.94398331642151
Epoch: 3, Steps: 413 | Train Loss: 0.342 Vali Loss: 0.585 Vali Acc: 0.929 Test Loss: 0.585 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.2403846
	speed: 0.5820s/iter; left time: 23256.2043s
	iters: 200, epoch: 4 | loss: 0.0840620
	speed: 0.3008s/iter; left time: 11989.4807s
	iters: 300, epoch: 4 | loss: 0.0182563
	speed: 0.2963s/iter; left time: 11780.7198s
	iters: 400, epoch: 4 | loss: 0.1572732
	speed: 0.2858s/iter; left time: 11337.0987s
Epoch: 4 cost time: 123.39656329154968
Epoch: 4, Steps: 413 | Train Loss: 0.321 Vali Loss: 0.381 Vali Acc: 0.949 Test Loss: 0.381 Test Acc: 0.949
Validation loss decreased (-0.942243 --> -0.949064).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.7580154
	speed: 0.5491s/iter; left time: 21717.6309s
	iters: 200, epoch: 5 | loss: 0.0000200
	speed: 0.2951s/iter; left time: 11640.4202s
	iters: 300, epoch: 5 | loss: 0.3020875
	speed: 0.3076s/iter; left time: 12105.0156s
	iters: 400, epoch: 5 | loss: 0.0000000
	speed: 0.2999s/iter; left time: 11771.8079s
Epoch: 5 cost time: 122.73198533058167
Epoch: 5, Steps: 413 | Train Loss: 0.272 Vali Loss: 0.313 Vali Acc: 0.957 Test Loss: 0.313 Test Acc: 0.957
Validation loss decreased (-0.949064 --> -0.956795).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.2849985
	speed: 0.5809s/iter; left time: 22734.0217s
	iters: 200, epoch: 6 | loss: 0.0000022
	speed: 0.2982s/iter; left time: 11639.4936s
	iters: 300, epoch: 6 | loss: 0.3315968
	speed: 0.2840s/iter; left time: 11058.5141s
	iters: 400, epoch: 6 | loss: 0.0005022
	speed: 0.2992s/iter; left time: 11620.3938s
Epoch: 6 cost time: 121.74028944969177
Epoch: 6, Steps: 413 | Train Loss: 0.217 Vali Loss: 0.278 Vali Acc: 0.969 Test Loss: 0.278 Test Acc: 0.969
Validation loss decreased (-0.956795 --> -0.968619).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8524348
	speed: 0.6057s/iter; left time: 23454.9778s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.2999s/iter; left time: 11583.7005s
	iters: 300, epoch: 7 | loss: 0.0000030
	speed: 0.2859s/iter; left time: 11013.4167s
	iters: 400, epoch: 7 | loss: 0.0004727
	speed: 0.2943s/iter; left time: 11309.6223s
Epoch: 7 cost time: 123.38620352745056
Epoch: 7, Steps: 413 | Train Loss: 0.214 Vali Loss: 0.292 Vali Acc: 0.964 Test Loss: 0.292 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0002418
	speed: 0.5869s/iter; left time: 22485.0287s
	iters: 200, epoch: 8 | loss: 0.0747200
	speed: 0.2997s/iter; left time: 11452.9613s
	iters: 300, epoch: 8 | loss: 0.2690549
	speed: 0.3017s/iter; left time: 11496.5604s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.2861s/iter; left time: 10873.4532s
Epoch: 8 cost time: 123.39095664024353
Epoch: 8, Steps: 413 | Train Loss: 0.182 Vali Loss: 0.533 Vali Acc: 0.945 Test Loss: 0.533 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.5629s/iter; left time: 21333.3880s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.3072s/iter; left time: 11609.8815s
	iters: 300, epoch: 9 | loss: 0.0141077
	speed: 0.2980s/iter; left time: 11232.8737s
	iters: 400, epoch: 9 | loss: 0.0006141
	speed: 0.2921s/iter; left time: 10981.7764s
Epoch: 9 cost time: 123.47037172317505
Epoch: 9, Steps: 413 | Train Loss: 0.202 Vali Loss: 0.368 Vali Acc: 0.963 Test Loss: 0.368 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0002515
	speed: 0.5130s/iter; left time: 19228.2355s
	iters: 200, epoch: 10 | loss: 0.0013106
	speed: 0.2628s/iter; left time: 9824.1439s
	iters: 300, epoch: 10 | loss: 0.0000333
	speed: 0.2788s/iter; left time: 10394.7024s
	iters: 400, epoch: 10 | loss: 0.1236711
	speed: 0.2931s/iter; left time: 10897.2070s
Epoch: 10 cost time: 113.2497570514679
Epoch: 10, Steps: 413 | Train Loss: 0.124 Vali Loss: 0.310 Vali Acc: 0.974 Test Loss: 0.310 Test Acc: 0.974
Validation loss decreased (-0.968619 --> -0.974076).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0059512
	speed: 0.5657s/iter; left time: 20969.9423s
	iters: 200, epoch: 11 | loss: 0.0008766
	speed: 0.2734s/iter; left time: 10108.9314s
	iters: 300, epoch: 11 | loss: 0.0003851
	speed: 0.2710s/iter; left time: 9992.6882s
	iters: 400, epoch: 11 | loss: 0.2500104
	speed: 0.2824s/iter; left time: 10385.6671s
Epoch: 11 cost time: 115.22029614448547
Epoch: 11, Steps: 413 | Train Loss: 0.127 Vali Loss: 0.328 Vali Acc: 0.970 Test Loss: 0.328 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000139
	speed: 0.5586s/iter; left time: 20475.8816s
	iters: 200, epoch: 12 | loss: 0.0138942
	speed: 0.2916s/iter; left time: 10661.3243s
	iters: 300, epoch: 12 | loss: 0.0000015
	speed: 0.2814s/iter; left time: 10260.2244s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.2580s/iter; left time: 9379.3751s
Epoch: 12 cost time: 114.94615268707275
Epoch: 12, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.198 Vali Acc: 0.975 Test Loss: 0.198 Test Acc: 0.975
Validation loss decreased (-0.974076 --> -0.974987).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.5474s/iter; left time: 19839.8109s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.2886s/iter; left time: 10432.5189s
	iters: 300, epoch: 13 | loss: 0.0000001
	speed: 0.2945s/iter; left time: 10616.9764s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.2891s/iter; left time: 10390.2554s
Epoch: 13 cost time: 119.6851556301117
Epoch: 13, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.252 Vali Acc: 0.971 Test Loss: 0.252 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.5412s/iter; left time: 19392.1440s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.2762s/iter; left time: 9868.4967s
	iters: 300, epoch: 14 | loss: 0.7782863
	speed: 0.2881s/iter; left time: 10265.8641s
	iters: 400, epoch: 14 | loss: 0.5493522
	speed: 0.2870s/iter; left time: 10196.7252s
Epoch: 14 cost time: 115.96836495399475
Epoch: 14, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.242 Vali Acc: 0.976 Test Loss: 0.242 Test Acc: 0.976
Validation loss decreased (-0.974987 --> -0.976350).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.5539s/iter; left time: 19619.3634s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.2735s/iter; left time: 9659.2909s
	iters: 300, epoch: 15 | loss: 0.0000002
	speed: 0.2867s/iter; left time: 10099.0217s
	iters: 400, epoch: 15 | loss: 0.0000004
	speed: 0.2940s/iter; left time: 10326.5282s
Epoch: 15 cost time: 117.36931681632996
Epoch: 15, Steps: 413 | Train Loss: 0.111 Vali Loss: 0.367 Vali Acc: 0.962 Test Loss: 0.367 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000126
	speed: 0.5715s/iter; left time: 20006.2929s
	iters: 200, epoch: 16 | loss: 0.0000005
	speed: 0.2743s/iter; left time: 9576.1324s
	iters: 300, epoch: 16 | loss: 0.0025640
	speed: 0.2800s/iter; left time: 9746.3342s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.2872s/iter; left time: 9967.4117s
Epoch: 16 cost time: 117.20349597930908
Epoch: 16, Steps: 413 | Train Loss: 0.113 Vali Loss: 0.562 Vali Acc: 0.953 Test Loss: 0.562 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.5820s/iter; left time: 20134.7189s
	iters: 200, epoch: 17 | loss: 0.0000084
	speed: 0.2752s/iter; left time: 9492.9903s
	iters: 300, epoch: 17 | loss: 0.0000095
	speed: 0.2956s/iter; left time: 10167.6097s
	iters: 400, epoch: 17 | loss: 0.0436308
	speed: 0.2901s/iter; left time: 9948.6774s
Epoch: 17 cost time: 120.42645645141602
Epoch: 17, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.151 Vali Acc: 0.978 Test Loss: 0.151 Test Acc: 0.978
Validation loss decreased (-0.976350 --> -0.977716).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.5672s/iter; left time: 19385.4975s
	iters: 200, epoch: 18 | loss: 0.0815489
	speed: 0.2742s/iter; left time: 9344.0243s
	iters: 300, epoch: 18 | loss: 0.0000001
	speed: 0.2862s/iter; left time: 9724.6157s
	iters: 400, epoch: 18 | loss: 0.0000394
	speed: 0.2935s/iter; left time: 9942.6891s
Epoch: 18 cost time: 118.59056091308594
Epoch: 18, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.228 Vali Acc: 0.974 Test Loss: 0.228 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0589630
	speed: 0.5477s/iter; left time: 18493.2102s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.2740s/iter; left time: 9225.0599s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.2910s/iter; left time: 9768.5546s
	iters: 400, epoch: 19 | loss: 0.0208580
	speed: 0.2956s/iter; left time: 9891.8823s
Epoch: 19 cost time: 117.67590951919556
Epoch: 19, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.182 Vali Acc: 0.977 Test Loss: 0.182 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000001
	speed: 0.5735s/iter; left time: 19129.1137s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.2668s/iter; left time: 8873.5247s
	iters: 300, epoch: 20 | loss: 0.0000126
	speed: 0.2590s/iter; left time: 8587.0090s
	iters: 400, epoch: 20 | loss: 0.8073952
	speed: 0.2739s/iter; left time: 9054.6140s
Epoch: 20 cost time: 113.04965901374817
Epoch: 20, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.327 Vali Acc: 0.968 Test Loss: 0.327 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000001
	speed: 0.5726s/iter; left time: 18860.9355s
	iters: 200, epoch: 21 | loss: 0.0040545
	speed: 0.2652s/iter; left time: 8709.1393s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.2755s/iter; left time: 9020.9441s
	iters: 400, epoch: 21 | loss: 0.0000447
	speed: 0.2745s/iter; left time: 8959.4261s
Epoch: 21 cost time: 114.39715552330017
Epoch: 21, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.258 Vali Acc: 0.974 Test Loss: 0.258 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0000031
	speed: 0.5670s/iter; left time: 18442.0826s
	iters: 200, epoch: 22 | loss: 0.0000899
	speed: 0.2877s/iter; left time: 9328.8361s
	iters: 300, epoch: 22 | loss: 0.4757088
	speed: 0.2735s/iter; left time: 8842.6906s
	iters: 400, epoch: 22 | loss: 0.0002871
	speed: 0.2772s/iter; left time: 8932.5813s
Epoch: 22 cost time: 117.05824685096741
Epoch: 22, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.158 Vali Acc: 0.979 Test Loss: 0.158 Test Acc: 0.979
Validation loss decreased (-0.977716 --> -0.979080).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0354257
	speed: 0.5615s/iter; left time: 18032.1423s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.2877s/iter; left time: 9210.4802s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.2788s/iter; left time: 8897.5898s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.2757s/iter; left time: 8770.3455s
Epoch: 23 cost time: 117.26875853538513
Epoch: 23, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.360 Vali Acc: 0.965 Test Loss: 0.360 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0000821
	speed: 0.5436s/iter; left time: 17234.1518s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.2872s/iter; left time: 9074.5388s
	iters: 300, epoch: 24 | loss: 0.0000694
	speed: 0.2741s/iter; left time: 8635.1612s
	iters: 400, epoch: 24 | loss: 0.0000882
	speed: 0.2724s/iter; left time: 8553.2397s
Epoch: 24 cost time: 115.56879496574402
Epoch: 24, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.086 Vali Acc: 0.987 Test Loss: 0.086 Test Acc: 0.987
Validation loss decreased (-0.979080 --> -0.986811).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.5449s/iter; left time: 17050.8138s
	iters: 200, epoch: 25 | loss: 0.1741304
	speed: 0.2865s/iter; left time: 8935.2375s
	iters: 300, epoch: 25 | loss: 0.0134295
	speed: 0.2844s/iter; left time: 8841.9507s
	iters: 400, epoch: 25 | loss: 0.2507956
	speed: 0.2739s/iter; left time: 8486.6458s
Epoch: 25 cost time: 115.96115255355835
Epoch: 25, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.205 Vali Acc: 0.973 Test Loss: 0.205 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0000020
	speed: 0.5246s/iter; left time: 16197.3853s
	iters: 200, epoch: 26 | loss: 0.0019973
	speed: 0.2781s/iter; left time: 8559.3172s
	iters: 300, epoch: 26 | loss: 0.0000001
	speed: 0.2849s/iter; left time: 8738.7943s
	iters: 400, epoch: 26 | loss: 0.0000001
	speed: 0.2929s/iter; left time: 8956.8096s
Epoch: 26 cost time: 116.60951828956604
Epoch: 26, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.096 Vali Acc: 0.985 Test Loss: 0.096 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0000141
	speed: 0.5496s/iter; left time: 16742.6563s
	iters: 200, epoch: 27 | loss: 0.0000451
	speed: 0.2770s/iter; left time: 8410.7799s
	iters: 300, epoch: 27 | loss: 0.0000013
	speed: 0.2901s/iter; left time: 8778.5536s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.2877s/iter; left time: 8678.6150s
Epoch: 27 cost time: 117.15690922737122
Epoch: 27, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.115 Vali Acc: 0.985 Test Loss: 0.115 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0023737
	speed: 0.5336s/iter; left time: 16034.8952s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.2685s/iter; left time: 8042.3846s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.2747s/iter; left time: 8200.7677s
	iters: 400, epoch: 28 | loss: 0.0000004
	speed: 0.2902s/iter; left time: 8633.3015s
Epoch: 28 cost time: 114.79346466064453
Epoch: 28, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.313 Vali Acc: 0.967 Test Loss: 0.313 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0000577
	speed: 0.5570s/iter; left time: 16507.6885s
	iters: 200, epoch: 29 | loss: 0.0095068
	speed: 0.2872s/iter; left time: 8481.6245s
	iters: 300, epoch: 29 | loss: 0.0002946
	speed: 0.2799s/iter; left time: 8240.0104s
	iters: 400, epoch: 29 | loss: 0.0000003
	speed: 0.2764s/iter; left time: 8109.9092s
Epoch: 29 cost time: 116.25717997550964
Epoch: 29, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.278 Vali Acc: 0.970 Test Loss: 0.278 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0000419
	speed: 0.5545s/iter; left time: 16205.0452s
	iters: 200, epoch: 30 | loss: 0.0111444
	speed: 0.2801s/iter; left time: 8158.1807s
	iters: 300, epoch: 30 | loss: 0.9882876
	speed: 0.2778s/iter; left time: 8061.6948s
	iters: 400, epoch: 30 | loss: 0.0000011
	speed: 0.2709s/iter; left time: 7835.4636s
Epoch: 30 cost time: 115.20428991317749
Epoch: 30, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.0093080
	speed: 0.5687s/iter; left time: 16385.7467s
	iters: 200, epoch: 31 | loss: 0.0000009
	speed: 0.2888s/iter; left time: 8290.6917s
	iters: 300, epoch: 31 | loss: 0.0002877
	speed: 0.2925s/iter; left time: 8368.3225s
	iters: 400, epoch: 31 | loss: 0.0000001
	speed: 0.2792s/iter; left time: 7961.2964s
Epoch: 31 cost time: 119.87532782554626
Epoch: 31, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.987 Test Loss: 0.081 Test Acc: 0.987
Validation loss decreased (-0.986811 --> -0.987266).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.0000038
	speed: 0.5746s/iter; left time: 16317.2576s
	iters: 200, epoch: 32 | loss: 0.0233703
	speed: 0.2717s/iter; left time: 7689.8983s
	iters: 300, epoch: 32 | loss: 0.0000141
	speed: 0.2787s/iter; left time: 7857.3875s
	iters: 400, epoch: 32 | loss: 0.0001470
	speed: 0.2835s/iter; left time: 7965.9108s
Epoch: 32 cost time: 117.06776928901672
Epoch: 32, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.107 Vali Acc: 0.982 Test Loss: 0.107 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.5704399
	speed: 0.5729s/iter; left time: 16033.0564s
	iters: 200, epoch: 33 | loss: 0.0000087
	speed: 0.2789s/iter; left time: 7777.6104s
	iters: 300, epoch: 33 | loss: 0.0000240
	speed: 0.2793s/iter; left time: 7761.0511s
	iters: 400, epoch: 33 | loss: 0.0000118
	speed: 0.2897s/iter; left time: 8021.3516s
Epoch: 33 cost time: 118.33320617675781
Epoch: 33, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.039 Vali Acc: 0.991 Test Loss: 0.039 Test Acc: 0.991
Validation loss decreased (-0.987266 --> -0.990905).  Saving model ...
	iters: 100, epoch: 34 | loss: 0.0000078
	speed: 0.5601s/iter; left time: 15442.7831s
	iters: 200, epoch: 34 | loss: 0.0000130
	speed: 0.2819s/iter; left time: 7743.6111s
	iters: 300, epoch: 34 | loss: 0.0000005
	speed: 0.2789s/iter; left time: 7633.7365s
	iters: 400, epoch: 34 | loss: 0.0020360
	speed: 0.2708s/iter; left time: 7383.9921s
Epoch: 34 cost time: 116.08997106552124
Epoch: 34, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 0.0000540
	speed: 0.5530s/iter; left time: 15017.9809s
	iters: 200, epoch: 35 | loss: 0.0004611
	speed: 0.2907s/iter; left time: 7867.2753s
	iters: 300, epoch: 35 | loss: 0.0000154
	speed: 0.2905s/iter; left time: 7831.9073s
	iters: 400, epoch: 35 | loss: 0.0000033
	speed: 0.2751s/iter; left time: 7389.8309s
Epoch: 35 cost time: 118.35184359550476
Epoch: 35, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 36 | loss: 0.0871475
	speed: 0.5529s/iter; left time: 14787.8070s
	iters: 200, epoch: 36 | loss: 0.0000773
	speed: 0.2998s/iter; left time: 7989.2873s
	iters: 300, epoch: 36 | loss: 0.0106803
	speed: 0.2783s/iter; left time: 7388.5946s
	iters: 400, epoch: 36 | loss: 0.0022935
	speed: 0.2644s/iter; left time: 6993.2871s
Epoch: 36 cost time: 117.02426409721375
Epoch: 36, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.5551s/iter; left time: 14618.6333s
	iters: 200, epoch: 37 | loss: 0.0267494
	speed: 0.2937s/iter; left time: 7704.5623s
	iters: 300, epoch: 37 | loss: 0.0003636
	speed: 0.2886s/iter; left time: 7542.2721s
	iters: 400, epoch: 37 | loss: 0.0001424
	speed: 0.2960s/iter; left time: 7704.5885s
Epoch: 37 cost time: 121.23674201965332
Epoch: 37, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.227 Vali Acc: 0.970 Test Loss: 0.227 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 38 | loss: 0.0000516
	speed: 0.5699s/iter; left time: 14770.8170s
	iters: 200, epoch: 38 | loss: 0.0002498
	speed: 0.2793s/iter; left time: 7211.5608s
	iters: 300, epoch: 38 | loss: 0.0000040
	speed: 0.2875s/iter; left time: 7393.9557s
	iters: 400, epoch: 38 | loss: 0.0025179
	speed: 0.2970s/iter; left time: 7608.8516s
Epoch: 38 cost time: 119.43622303009033
Epoch: 38, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.071 Vali Acc: 0.986 Test Loss: 0.071 Test Acc: 0.986
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 39 | loss: 0.0000023
	speed: 0.5478s/iter; left time: 13971.7866s
	iters: 200, epoch: 39 | loss: 0.0000050
	speed: 0.2869s/iter; left time: 7288.7505s
	iters: 300, epoch: 39 | loss: 0.0047996
	speed: 0.2947s/iter; left time: 7456.7978s
	iters: 400, epoch: 39 | loss: 0.0000763
	speed: 0.2887s/iter; left time: 7277.3277s
Epoch: 39 cost time: 118.37226176261902
Epoch: 39, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 40 | loss: 0.0000003
	speed: 0.5579s/iter; left time: 14000.1111s
	iters: 200, epoch: 40 | loss: 0.0000000
	speed: 0.2906s/iter; left time: 7263.8504s
	iters: 300, epoch: 40 | loss: 0.0000010
	speed: 0.2767s/iter; left time: 6886.9294s
	iters: 400, epoch: 40 | loss: 0.0000046
	speed: 0.2780s/iter; left time: 6893.0031s
Epoch: 40 cost time: 117.56283116340637
Epoch: 40, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.048 Vali Acc: 0.990 Test Loss: 0.048 Test Acc: 0.990
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 41 | loss: 0.0000235
	speed: 0.5685s/iter; left time: 14032.2690s
	iters: 200, epoch: 41 | loss: 0.0000006
	speed: 0.2853s/iter; left time: 7013.2517s
	iters: 300, epoch: 41 | loss: 0.1097841
	speed: 0.2710s/iter; left time: 6633.4565s
	iters: 400, epoch: 41 | loss: 0.0079781
	speed: 0.2878s/iter; left time: 7015.7183s
Epoch: 41 cost time: 117.66635632514954
Epoch: 41, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.982 Test Loss: 0.094 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 42 | loss: 0.0000482
	speed: 0.5721s/iter; left time: 13883.6378s
	iters: 200, epoch: 42 | loss: 0.3597533
	speed: 0.2927s/iter; left time: 7073.3382s
	iters: 300, epoch: 42 | loss: 0.0000812
	speed: 0.2847s/iter; left time: 6851.9673s
	iters: 400, epoch: 42 | loss: 0.0000001
	speed: 0.2846s/iter; left time: 6820.9846s
Epoch: 42 cost time: 119.63341617584229
Epoch: 42, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.146 Vali Acc: 0.971 Test Loss: 0.146 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 43 | loss: 0.0001808
	speed: 0.5872s/iter; left time: 14007.8999s
	iters: 200, epoch: 43 | loss: 0.0000101
	speed: 0.3171s/iter; left time: 7532.7039s
	iters: 300, epoch: 43 | loss: 0.0000213
	speed: 0.2967s/iter; left time: 7017.3766s
	iters: 400, epoch: 43 | loss: 0.0000001
	speed: 0.2946s/iter; left time: 6938.7570s
Epoch: 43 cost time: 125.94537401199341
Epoch: 43, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9909049567985448
model parameter : 12973066
model size : 69.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3835098
	speed: 0.3002s/iter; left time: 12369.5069s
	iters: 200, epoch: 1 | loss: 0.0285144
	speed: 0.2767s/iter; left time: 11372.4215s
	iters: 300, epoch: 1 | loss: 0.7883704
	speed: 0.2617s/iter; left time: 10729.9263s
	iters: 400, epoch: 1 | loss: 0.5145189
	speed: 0.2635s/iter; left time: 10777.6702s
Epoch: 1 cost time: 114.10558724403381
Epoch: 1, Steps: 413 | Train Loss: 0.544 Vali Loss: 0.414 Vali Acc: 0.905 Test Loss: 0.414 Test Acc: 0.905
Validation loss decreased (inf --> -0.904498).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0032903
	speed: 0.5489s/iter; left time: 22387.4781s
	iters: 200, epoch: 2 | loss: 0.0043261
	speed: 0.2705s/iter; left time: 11005.3665s
	iters: 300, epoch: 2 | loss: 1.3715249
	speed: 0.2609s/iter; left time: 10589.4921s
	iters: 400, epoch: 2 | loss: 0.5987079
	speed: 0.2755s/iter; left time: 11155.6653s
Epoch: 2 cost time: 112.34071826934814
Epoch: 2, Steps: 413 | Train Loss: 0.318 Vali Loss: 0.347 Vali Acc: 0.938 Test Loss: 0.347 Test Acc: 0.938
Validation loss decreased (-0.904498 --> -0.937695).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0114648
	speed: 0.5555s/iter; left time: 22426.7583s
	iters: 200, epoch: 3 | loss: 0.0143236
	speed: 0.2753s/iter; left time: 11086.1259s
	iters: 300, epoch: 3 | loss: 0.4936607
	speed: 0.2806s/iter; left time: 11273.9168s
	iters: 400, epoch: 3 | loss: 0.5667471
	speed: 0.2870s/iter; left time: 11500.0116s
Epoch: 3 cost time: 115.78553938865662
Epoch: 3, Steps: 413 | Train Loss: 0.359 Vali Loss: 0.442 Vali Acc: 0.925 Test Loss: 0.442 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0961744
	speed: 0.5302s/iter; left time: 21186.1164s
	iters: 200, epoch: 4 | loss: 0.0197125
	speed: 0.2634s/iter; left time: 10498.5839s
	iters: 300, epoch: 4 | loss: 0.0153510
	speed: 0.2742s/iter; left time: 10901.0096s
	iters: 400, epoch: 4 | loss: 0.0848141
	speed: 0.2788s/iter; left time: 11058.2862s
Epoch: 4 cost time: 112.51285314559937
Epoch: 4, Steps: 413 | Train Loss: 0.319 Vali Loss: 0.313 Vali Acc: 0.958 Test Loss: 0.313 Test Acc: 0.958
Validation loss decreased (-0.937695 --> -0.957705).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0708703
	speed: 0.5417s/iter; left time: 21422.2434s
	iters: 200, epoch: 5 | loss: 0.5324274
	speed: 0.2742s/iter; left time: 10818.5539s
	iters: 300, epoch: 5 | loss: 0.3968235
	speed: 0.2816s/iter; left time: 11080.2244s
	iters: 400, epoch: 5 | loss: 0.0007054
	speed: 0.2755s/iter; left time: 10812.8356s
Epoch: 5 cost time: 113.94905114173889
Epoch: 5, Steps: 413 | Train Loss: 0.269 Vali Loss: 0.352 Vali Acc: 0.947 Test Loss: 0.352 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.9966177
	speed: 0.5518s/iter; left time: 21595.4783s
	iters: 200, epoch: 6 | loss: 0.0015561
	speed: 0.2758s/iter; left time: 10766.9533s
	iters: 300, epoch: 6 | loss: 0.0288699
	speed: 0.2682s/iter; left time: 10443.2500s
	iters: 400, epoch: 6 | loss: 1.5329374
	speed: 0.2526s/iter; left time: 9808.2688s
Epoch: 6 cost time: 111.76985120773315
Epoch: 6, Steps: 413 | Train Loss: 0.249 Vali Loss: 0.337 Vali Acc: 0.951 Test Loss: 0.337 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.2186739
	speed: 0.5374s/iter; left time: 20810.8631s
	iters: 200, epoch: 7 | loss: 0.0000249
	speed: 0.2777s/iter; left time: 10726.6197s
	iters: 300, epoch: 7 | loss: 0.0012627
	speed: 0.2767s/iter; left time: 10659.6479s
	iters: 400, epoch: 7 | loss: 0.0000327
	speed: 0.2675s/iter; left time: 10278.3365s
Epoch: 7 cost time: 114.3842670917511
Epoch: 7, Steps: 413 | Train Loss: 0.171 Vali Loss: 0.236 Vali Acc: 0.965 Test Loss: 0.236 Test Acc: 0.965
Validation loss decreased (-0.957705 --> -0.964982).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0182883
	speed: 0.5670s/iter; left time: 21721.7033s
	iters: 200, epoch: 8 | loss: 0.2827284
	speed: 0.2823s/iter; left time: 10786.2436s
	iters: 300, epoch: 8 | loss: 0.0573916
	speed: 0.2822s/iter; left time: 10754.2748s
	iters: 400, epoch: 8 | loss: 0.3735059
	speed: 0.2808s/iter; left time: 10673.7270s
Epoch: 8 cost time: 116.55544590950012
Epoch: 8, Steps: 413 | Train Loss: 0.142 Vali Loss: 0.323 Vali Acc: 0.960 Test Loss: 0.323 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.5330s/iter; left time: 20197.4761s
	iters: 200, epoch: 9 | loss: 0.5566693
	speed: 0.2641s/iter; left time: 9983.2332s
	iters: 300, epoch: 9 | loss: 0.0000210
	speed: 0.2710s/iter; left time: 10216.8371s
	iters: 400, epoch: 9 | loss: 0.0000038
	speed: 0.2771s/iter; left time: 10418.6310s
Epoch: 9 cost time: 111.80019402503967
Epoch: 9, Steps: 413 | Train Loss: 0.139 Vali Loss: 0.410 Vali Acc: 0.954 Test Loss: 0.410 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0005944
	speed: 0.5300s/iter; left time: 19866.3077s
	iters: 200, epoch: 10 | loss: 0.0000138
	speed: 0.2788s/iter; left time: 10422.1106s
	iters: 300, epoch: 10 | loss: 0.3979818
	speed: 0.2777s/iter; left time: 10355.1744s
	iters: 400, epoch: 10 | loss: 0.0000273
	speed: 0.2745s/iter; left time: 10205.4668s
Epoch: 10 cost time: 114.1503357887268
Epoch: 10, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.335 Vali Acc: 0.953 Test Loss: 0.335 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.5370s/iter; left time: 19906.8614s
	iters: 200, epoch: 11 | loss: 0.8732917
	speed: 0.2567s/iter; left time: 9490.8995s
	iters: 300, epoch: 11 | loss: 0.0000282
	speed: 0.2774s/iter; left time: 10226.3765s
	iters: 400, epoch: 11 | loss: 0.0117068
	speed: 0.2676s/iter; left time: 9840.9018s
Epoch: 11 cost time: 110.36031246185303
Epoch: 11, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.116 Vali Acc: 0.984 Test Loss: 0.116 Test Acc: 0.984
Validation loss decreased (-0.964982 --> -0.984083).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0089082
	speed: 0.5420s/iter; left time: 19870.2744s
	iters: 200, epoch: 12 | loss: 0.1619376
	speed: 0.2634s/iter; left time: 9629.4897s
	iters: 300, epoch: 12 | loss: 0.0017692
	speed: 0.2638s/iter; left time: 9618.2837s
	iters: 400, epoch: 12 | loss: 0.0003459
	speed: 0.2844s/iter; left time: 10340.9490s
Epoch: 12 cost time: 113.21032547950745
Epoch: 12, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.152 Vali Acc: 0.980 Test Loss: 0.152 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0021058
	speed: 0.5479s/iter; left time: 19859.8198s
	iters: 200, epoch: 13 | loss: 0.0003665
	speed: 0.2848s/iter; left time: 10293.4222s
	iters: 300, epoch: 13 | loss: 0.0000619
	speed: 0.2726s/iter; left time: 9826.0915s
	iters: 400, epoch: 13 | loss: 0.0000001
	speed: 0.2625s/iter; left time: 9434.4955s
Epoch: 13 cost time: 113.82067894935608
Epoch: 13, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000069
	speed: 0.5289s/iter; left time: 18950.3918s
	iters: 200, epoch: 14 | loss: 0.0000002
	speed: 0.2632s/iter; left time: 9406.3140s
	iters: 300, epoch: 14 | loss: 0.0000327
	speed: 0.2765s/iter; left time: 9852.4191s
	iters: 400, epoch: 14 | loss: 1.4767842
	speed: 0.2746s/iter; left time: 9757.3863s
Epoch: 14 cost time: 111.28794932365417
Epoch: 14, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.230 Vali Acc: 0.968 Test Loss: 0.230 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.5386s/iter; left time: 19076.0251s
	iters: 200, epoch: 15 | loss: 0.0000001
	speed: 0.2797s/iter; left time: 9879.3559s
	iters: 300, epoch: 15 | loss: 0.0000001
	speed: 0.2786s/iter; left time: 9812.1894s
	iters: 400, epoch: 15 | loss: 0.0000002
	speed: 0.2754s/iter; left time: 9670.9476s
Epoch: 15 cost time: 115.41303420066833
Epoch: 15, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.274 Vali Acc: 0.965 Test Loss: 0.274 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000718
	speed: 0.5165s/iter; left time: 18078.9963s
	iters: 200, epoch: 16 | loss: 0.0000491
	speed: 0.2754s/iter; left time: 9612.0022s
	iters: 300, epoch: 16 | loss: 0.3554557
	speed: 0.2724s/iter; left time: 9480.2032s
	iters: 400, epoch: 16 | loss: 0.0000005
	speed: 0.2774s/iter; left time: 9626.4554s
Epoch: 16 cost time: 112.73361492156982
Epoch: 16, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.130 Vali Acc: 0.982 Test Loss: 0.130 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.5518s/iter; left time: 19088.7719s
	iters: 200, epoch: 17 | loss: 0.0001898
	speed: 0.2771s/iter; left time: 9556.8948s
	iters: 300, epoch: 17 | loss: 0.0000484
	speed: 0.2834s/iter; left time: 9747.5894s
	iters: 400, epoch: 17 | loss: 0.0000017
	speed: 0.2767s/iter; left time: 9488.0960s
Epoch: 17 cost time: 115.78840565681458
Epoch: 17, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.264 Vali Acc: 0.966 Test Loss: 0.264 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000005
	speed: 0.5510s/iter; left time: 18832.5277s
	iters: 200, epoch: 18 | loss: 0.0000767
	speed: 0.2675s/iter; left time: 9115.8413s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.2616s/iter; left time: 8888.7869s
	iters: 400, epoch: 18 | loss: 0.0000006
	speed: 0.2904s/iter; left time: 9840.0558s
Epoch: 18 cost time: 114.30725026130676
Epoch: 18, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.179 Vali Acc: 0.967 Test Loss: 0.179 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000003
	speed: 0.5495s/iter; left time: 18555.5790s
	iters: 200, epoch: 19 | loss: 0.0000008
	speed: 0.2832s/iter; left time: 9533.8427s
	iters: 300, epoch: 19 | loss: 0.0000031
	speed: 0.2776s/iter; left time: 9318.4125s
	iters: 400, epoch: 19 | loss: 0.2459362
	speed: 0.2839s/iter; left time: 9502.6700s
Epoch: 19 cost time: 116.78392028808594
Epoch: 19, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.194 Vali Acc: 0.970 Test Loss: 0.194 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000073
	speed: 0.5554s/iter; left time: 18526.3481s
	iters: 200, epoch: 20 | loss: 0.0000008
	speed: 0.2786s/iter; left time: 9264.8838s
	iters: 300, epoch: 20 | loss: 0.0022444
	speed: 0.2758s/iter; left time: 9144.8289s
	iters: 400, epoch: 20 | loss: 0.1326171
	speed: 0.2753s/iter; left time: 9101.2039s
Epoch: 20 cost time: 114.7769136428833
Epoch: 20, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.225 Vali Acc: 0.972 Test Loss: 0.225 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0000407
	speed: 0.5467s/iter; left time: 18008.8389s
	iters: 200, epoch: 21 | loss: 0.0064046
	speed: 0.2682s/iter; left time: 8809.1352s
	iters: 300, epoch: 21 | loss: 0.0000082
	speed: 0.2749s/iter; left time: 9000.3114s
	iters: 400, epoch: 21 | loss: 0.0000006
	speed: 0.2709s/iter; left time: 8842.0115s
Epoch: 21 cost time: 112.97733616828918
Epoch: 21, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.262 Vali Acc: 0.968 Test Loss: 0.262 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9840836743974534
model parameter : 12973066
model size : 69.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3409034
	speed: 0.3153s/iter; left time: 12991.8329s
	iters: 200, epoch: 1 | loss: 0.0112573
	speed: 0.2888s/iter; left time: 11871.8184s
	iters: 300, epoch: 1 | loss: 0.5172828
	speed: 0.2988s/iter; left time: 12253.1480s
	iters: 400, epoch: 1 | loss: 0.2076150
	speed: 0.2755s/iter; left time: 11266.9261s
Epoch: 1 cost time: 122.00828003883362
Epoch: 1, Steps: 413 | Train Loss: 0.545 Vali Loss: 0.259 Vali Acc: 0.936 Test Loss: 0.259 Test Acc: 0.936
Validation loss decreased (inf --> -0.936332).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4215387
	speed: 0.5782s/iter; left time: 23582.4096s
	iters: 200, epoch: 2 | loss: 0.0050477
	speed: 0.2919s/iter; left time: 11876.3197s
	iters: 300, epoch: 2 | loss: 0.7028273
	speed: 0.2825s/iter; left time: 11464.9929s
	iters: 400, epoch: 2 | loss: 0.9338281
	speed: 0.2976s/iter; left time: 12049.2596s
Epoch: 2 cost time: 120.83657717704773
Epoch: 2, Steps: 413 | Train Loss: 0.372 Vali Loss: 0.395 Vali Acc: 0.926 Test Loss: 0.395 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0039618
	speed: 0.5684s/iter; left time: 22947.8556s
	iters: 200, epoch: 3 | loss: 0.1498354
	speed: 0.2943s/iter; left time: 11852.7246s
	iters: 300, epoch: 3 | loss: 0.8820196
	speed: 0.2890s/iter; left time: 11611.4233s
	iters: 400, epoch: 3 | loss: 0.2579536
	speed: 0.2930s/iter; left time: 11742.8524s
Epoch: 3 cost time: 122.93590068817139
Epoch: 3, Steps: 413 | Train Loss: 0.445 Vali Loss: 0.550 Vali Acc: 0.914 Test Loss: 0.550 Test Acc: 0.914
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.5571361
	speed: 0.5555s/iter; left time: 22199.9955s
	iters: 200, epoch: 4 | loss: 0.0014934
	speed: 0.2907s/iter; left time: 11589.6768s
	iters: 300, epoch: 4 | loss: 0.0226872
	speed: 0.2995s/iter; left time: 11910.3613s
	iters: 400, epoch: 4 | loss: 0.0001557
	speed: 0.2961s/iter; left time: 11745.0681s
Epoch: 4 cost time: 120.55121326446533
Epoch: 4, Steps: 413 | Train Loss: 0.411 Vali Loss: 0.316 Vali Acc: 0.959 Test Loss: 0.316 Test Acc: 0.959
Validation loss decreased (-0.936332 --> -0.959069).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1527104
	speed: 0.5604s/iter; left time: 22162.7996s
	iters: 200, epoch: 5 | loss: 0.0117914
	speed: 0.2908s/iter; left time: 11471.1895s
	iters: 300, epoch: 5 | loss: 0.4272666
	speed: 0.3005s/iter; left time: 11823.3631s
	iters: 400, epoch: 5 | loss: 0.0040668
	speed: 0.2999s/iter; left time: 11770.3195s
Epoch: 5 cost time: 122.27515888214111
Epoch: 5, Steps: 413 | Train Loss: 0.341 Vali Loss: 0.777 Vali Acc: 0.920 Test Loss: 0.777 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.5141550
	speed: 0.5674s/iter; left time: 22207.6231s
	iters: 200, epoch: 6 | loss: 0.0139588
	speed: 0.2802s/iter; left time: 10938.9779s
	iters: 300, epoch: 6 | loss: 0.1039087
	speed: 0.2889s/iter; left time: 11246.7441s
	iters: 400, epoch: 6 | loss: 0.5500162
	speed: 0.3001s/iter; left time: 11656.4041s
Epoch: 6 cost time: 120.34135055541992
Epoch: 6, Steps: 413 | Train Loss: 0.280 Vali Loss: 0.322 Vali Acc: 0.950 Test Loss: 0.322 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.4759780
	speed: 0.5639s/iter; left time: 21834.9960s
	iters: 200, epoch: 7 | loss: 0.0000014
	speed: 0.2928s/iter; left time: 11310.6786s
	iters: 300, epoch: 7 | loss: 0.0001402
	speed: 0.2918s/iter; left time: 11239.8109s
	iters: 400, epoch: 7 | loss: 0.0024618
	speed: 0.2936s/iter; left time: 11279.1441s
Epoch: 7 cost time: 120.59273982048035
Epoch: 7, Steps: 413 | Train Loss: 0.199 Vali Loss: 0.296 Vali Acc: 0.962 Test Loss: 0.296 Test Acc: 0.962
Validation loss decreased (-0.959069 --> -0.961798).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.4354442
	speed: 0.5841s/iter; left time: 22376.3257s
	iters: 200, epoch: 8 | loss: 0.0240745
	speed: 0.2875s/iter; left time: 10987.2760s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.2921s/iter; left time: 11130.2532s
	iters: 400, epoch: 8 | loss: 0.0000058
	speed: 0.2636s/iter; left time: 10017.6883s
Epoch: 8 cost time: 117.85888862609863
Epoch: 8, Steps: 413 | Train Loss: 0.152 Vali Loss: 0.441 Vali Acc: 0.955 Test Loss: 0.441 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.5697s/iter; left time: 21589.4178s
	iters: 200, epoch: 9 | loss: 0.0039129
	speed: 0.3093s/iter; left time: 11691.7580s
	iters: 300, epoch: 9 | loss: 0.0071111
	speed: 0.2865s/iter; left time: 10798.7661s
	iters: 400, epoch: 9 | loss: 0.0000397
	speed: 0.2677s/iter; left time: 10064.1952s
Epoch: 9 cost time: 120.41176009178162
Epoch: 9, Steps: 413 | Train Loss: 0.171 Vali Loss: 0.484 Vali Acc: 0.936 Test Loss: 0.484 Test Acc: 0.936
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.5789s/iter; left time: 21699.5157s
	iters: 200, epoch: 10 | loss: 0.0029743
	speed: 0.3081s/iter; left time: 11516.8812s
	iters: 300, epoch: 10 | loss: 0.1693371
	speed: 0.2997s/iter; left time: 11174.2131s
	iters: 400, epoch: 10 | loss: 2.0776038
	speed: 0.2738s/iter; left time: 10182.2296s
Epoch: 10 cost time: 122.45660519599915
Epoch: 10, Steps: 413 | Train Loss: 0.124 Vali Loss: 0.146 Vali Acc: 0.975 Test Loss: 0.146 Test Acc: 0.975
Validation loss decreased (-0.961798 --> -0.974532).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0254321
	speed: 0.5671s/iter; left time: 21023.3466s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.2986s/iter; left time: 11039.9420s
	iters: 300, epoch: 11 | loss: 0.0000279
	speed: 0.2827s/iter; left time: 10423.3861s
	iters: 400, epoch: 11 | loss: 0.3531621
	speed: 0.2815s/iter; left time: 10352.7848s
Epoch: 11 cost time: 119.61917662620544
Epoch: 11, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.202 Vali Acc: 0.974 Test Loss: 0.202 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.1741223
	speed: 0.5823s/iter; left time: 21344.3865s
	iters: 200, epoch: 12 | loss: 0.0000789
	speed: 0.2774s/iter; left time: 10139.5820s
	iters: 300, epoch: 12 | loss: 0.0000001
	speed: 0.3020s/iter; left time: 11009.2080s
	iters: 400, epoch: 12 | loss: 0.0000001
	speed: 0.2864s/iter; left time: 10412.0022s
Epoch: 12 cost time: 121.34924006462097
Epoch: 12, Steps: 413 | Train Loss: 0.131 Vali Loss: 0.430 Vali Acc: 0.951 Test Loss: 0.430 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0014007
	speed: 0.5693s/iter; left time: 20635.7384s
	iters: 200, epoch: 13 | loss: 0.0477175
	speed: 0.2700s/iter; left time: 9757.8343s
	iters: 300, epoch: 13 | loss: 0.0009453
	speed: 0.2688s/iter; left time: 9688.2123s
	iters: 400, epoch: 13 | loss: 0.0000001
	speed: 0.2662s/iter; left time: 9569.5412s
Epoch: 13 cost time: 113.71306085586548
Epoch: 13, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.264 Vali Acc: 0.965 Test Loss: 0.264 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000149
	speed: 0.5517s/iter; left time: 19767.1522s
	iters: 200, epoch: 14 | loss: 0.0000006
	speed: 0.2779s/iter; left time: 9930.3520s
	iters: 300, epoch: 14 | loss: 0.0014216
	speed: 0.2729s/iter; left time: 9725.0853s
	iters: 400, epoch: 14 | loss: 0.0000008
	speed: 0.2806s/iter; left time: 9971.5704s
Epoch: 14 cost time: 115.42654228210449
Epoch: 14, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.258 Vali Acc: 0.969 Test Loss: 0.258 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.5349s/iter; left time: 18946.0817s
	iters: 200, epoch: 15 | loss: 0.0000057
	speed: 0.2705s/iter; left time: 9552.7869s
	iters: 300, epoch: 15 | loss: 0.1184926
	speed: 0.2716s/iter; left time: 9566.3899s
	iters: 400, epoch: 15 | loss: 0.0009356
	speed: 0.2723s/iter; left time: 9563.8897s
Epoch: 15 cost time: 112.6463851928711
Epoch: 15, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.371 Vali Acc: 0.954 Test Loss: 0.371 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000057
	speed: 0.5498s/iter; left time: 19245.9776s
	iters: 200, epoch: 16 | loss: 0.0000033
	speed: 0.2821s/iter; left time: 9846.3082s
	iters: 300, epoch: 16 | loss: 0.0000005
	speed: 0.2807s/iter; left time: 9770.5425s
	iters: 400, epoch: 16 | loss: 0.0000013
	speed: 0.2794s/iter; left time: 9695.3406s
Epoch: 16 cost time: 116.40922021865845
Epoch: 16, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.173 Vali Acc: 0.971 Test Loss: 0.173 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.5485s/iter; left time: 18974.0960s
	iters: 200, epoch: 17 | loss: 0.5745940
	speed: 0.2713s/iter; left time: 9358.4941s
	iters: 300, epoch: 17 | loss: 0.0013973
	speed: 0.2692s/iter; left time: 9259.9316s
	iters: 400, epoch: 17 | loss: 0.0000001
	speed: 0.2793s/iter; left time: 9578.2858s
Epoch: 17 cost time: 113.67824339866638
Epoch: 17, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.189 Vali Acc: 0.976 Test Loss: 0.189 Test Acc: 0.976
Validation loss decreased (-0.974532 --> -0.976351).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000010
	speed: 0.5584s/iter; left time: 19084.7559s
	iters: 200, epoch: 18 | loss: 0.1342727
	speed: 0.2764s/iter; left time: 9419.4862s
	iters: 300, epoch: 18 | loss: 0.0000015
	speed: 0.2843s/iter; left time: 9660.4034s
	iters: 400, epoch: 18 | loss: 0.0003745
	speed: 0.2801s/iter; left time: 9491.3680s
Epoch: 18 cost time: 116.56784749031067
Epoch: 18, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.246 Vali Acc: 0.970 Test Loss: 0.246 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0001001
	speed: 0.5543s/iter; left time: 18715.6834s
	iters: 200, epoch: 19 | loss: 0.0003992
	speed: 0.2767s/iter; left time: 9316.7336s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.2734s/iter; left time: 9178.0673s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.2824s/iter; left time: 9452.7074s
Epoch: 19 cost time: 115.41724634170532
Epoch: 19, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.356 Vali Acc: 0.955 Test Loss: 0.356 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000135
	speed: 0.5153s/iter; left time: 17188.2615s
	iters: 200, epoch: 20 | loss: 0.2777994
	speed: 0.2803s/iter; left time: 9322.4483s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.3031s/iter; left time: 10049.5398s
	iters: 400, epoch: 20 | loss: 0.0000024
	speed: 0.2868s/iter; left time: 9478.7946s
Epoch: 20 cost time: 116.9846704006195
Epoch: 20, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.206 Vali Acc: 0.974 Test Loss: 0.206 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000069
	speed: 0.5385s/iter; left time: 17737.3247s
	iters: 200, epoch: 21 | loss: 0.0000229
	speed: 0.2698s/iter; left time: 8861.8676s
	iters: 300, epoch: 21 | loss: 0.0003454
	speed: 0.2694s/iter; left time: 8820.1154s
	iters: 400, epoch: 21 | loss: 0.0000001
	speed: 0.2889s/iter; left time: 9430.3094s
Epoch: 21 cost time: 113.97356748580933
Epoch: 21, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.272 Vali Acc: 0.975 Test Loss: 0.272 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0000004
	speed: 0.5081s/iter; left time: 16526.0915s
	iters: 200, epoch: 22 | loss: 0.0171192
	speed: 0.2608s/iter; left time: 8457.2381s
	iters: 300, epoch: 22 | loss: 0.0000002
	speed: 0.2682s/iter; left time: 8669.8877s
	iters: 400, epoch: 22 | loss: 0.0224775
	speed: 0.2716s/iter; left time: 8753.5043s
Epoch: 22 cost time: 110.6818859577179
Epoch: 22, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.311 Vali Acc: 0.969 Test Loss: 0.311 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.5669s/iter; left time: 18205.1287s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.2844s/iter; left time: 9106.6160s
	iters: 300, epoch: 23 | loss: 0.0000002
	speed: 0.2812s/iter; left time: 8975.4032s
	iters: 400, epoch: 23 | loss: 0.0000421
	speed: 0.2534s/iter; left time: 8061.3209s
Epoch: 23 cost time: 114.30946707725525
Epoch: 23, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.456 Vali Acc: 0.960 Test Loss: 0.456 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0536273
	speed: 0.5316s/iter; left time: 16852.6927s
	iters: 200, epoch: 24 | loss: 0.0000005
	speed: 0.2816s/iter; left time: 8900.0559s
	iters: 300, epoch: 24 | loss: 0.0003329
	speed: 0.2750s/iter; left time: 8662.1777s
	iters: 400, epoch: 24 | loss: 0.0000002
	speed: 0.2723s/iter; left time: 8549.3495s
Epoch: 24 cost time: 114.37240505218506
Epoch: 24, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.237 Vali Acc: 0.976 Test Loss: 0.237 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.5157s/iter; left time: 16135.2346s
	iters: 200, epoch: 25 | loss: 0.0000308
	speed: 0.2674s/iter; left time: 8339.7787s
	iters: 300, epoch: 25 | loss: 0.0000242
	speed: 0.2936s/iter; left time: 9129.0201s
	iters: 400, epoch: 25 | loss: 0.1915235
	speed: 0.2855s/iter; left time: 8847.8200s
Epoch: 25 cost time: 115.75074696540833
Epoch: 25, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.200 Vali Acc: 0.977 Test Loss: 0.200 Test Acc: 0.977
Validation loss decreased (-0.976351 --> -0.976806).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0033171
	speed: 0.5129s/iter; left time: 15835.0723s
	iters: 200, epoch: 26 | loss: 0.0000266
	speed: 0.2403s/iter; left time: 7396.8908s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.2944s/iter; left time: 9031.2693s
	iters: 400, epoch: 26 | loss: 0.1024613
	speed: 0.2967s/iter; left time: 9073.0785s
Epoch: 26 cost time: 112.38700866699219
Epoch: 26, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.148 Vali Acc: 0.976 Test Loss: 0.148 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0013333
	speed: 0.5560s/iter; left time: 16938.0519s
	iters: 200, epoch: 27 | loss: 0.0002319
	speed: 0.2685s/iter; left time: 8151.5161s
	iters: 300, epoch: 27 | loss: 0.0000003
	speed: 0.2791s/iter; left time: 8445.1384s
	iters: 400, epoch: 27 | loss: 0.0000003
	speed: 0.2972s/iter; left time: 8964.0351s
Epoch: 27 cost time: 117.73328232765198
Epoch: 27, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
Validation loss decreased (-0.976806 --> -0.977261).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0002049
	speed: 0.5240s/iter; left time: 15745.2910s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.2438s/iter; left time: 7301.0388s
	iters: 300, epoch: 28 | loss: 0.0000111
	speed: 0.2535s/iter; left time: 7565.8563s
	iters: 400, epoch: 28 | loss: 0.0000518
	speed: 0.2749s/iter; left time: 8178.3983s
Epoch: 28 cost time: 106.64384603500366
Epoch: 28, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.234 Vali Acc: 0.970 Test Loss: 0.234 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0185228
	speed: 0.5408s/iter; left time: 16028.7942s
	iters: 200, epoch: 29 | loss: 0.0046921
	speed: 0.2897s/iter; left time: 8556.9983s
	iters: 300, epoch: 29 | loss: 0.0009055
	speed: 0.2867s/iter; left time: 8438.2992s
	iters: 400, epoch: 29 | loss: 0.0000001
	speed: 0.2782s/iter; left time: 8161.6401s
Epoch: 29 cost time: 117.12653183937073
Epoch: 29, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.099 Vali Acc: 0.979 Test Loss: 0.099 Test Acc: 0.979
Validation loss decreased (-0.977261 --> -0.978626).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0000079
	speed: 0.5268s/iter; left time: 15394.5426s
	iters: 200, epoch: 30 | loss: 0.0098848
	speed: 0.2604s/iter; left time: 7584.4338s
	iters: 300, epoch: 30 | loss: 0.0000185
	speed: 0.2616s/iter; left time: 7592.1803s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.2966s/iter; left time: 8577.7974s
Epoch: 30 cost time: 111.41034984588623
Epoch: 30, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.245 Vali Acc: 0.964 Test Loss: 0.245 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0053539
	speed: 0.5083s/iter; left time: 14644.5649s
	iters: 200, epoch: 31 | loss: 0.0015575
	speed: 0.2878s/iter; left time: 8262.3504s
	iters: 300, epoch: 31 | loss: 0.0002864
	speed: 0.2945s/iter; left time: 8426.7502s
	iters: 400, epoch: 31 | loss: 0.0000117
	speed: 0.2850s/iter; left time: 8125.5739s
Epoch: 31 cost time: 115.93475270271301
Epoch: 31, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.117 Vali Acc: 0.981 Test Loss: 0.117 Test Acc: 0.981
Validation loss decreased (-0.978626 --> -0.980899).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.0003668
	speed: 0.5556s/iter; left time: 15779.0425s
	iters: 200, epoch: 32 | loss: 0.0007569
	speed: 0.2787s/iter; left time: 7885.4836s
	iters: 300, epoch: 32 | loss: 0.0000206
	speed: 0.2767s/iter; left time: 7803.3254s
	iters: 400, epoch: 32 | loss: 0.0000028
	speed: 0.2823s/iter; left time: 7930.8993s
Epoch: 32 cost time: 114.78127789497375
Epoch: 32, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.146 Vali Acc: 0.975 Test Loss: 0.146 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.0000102
	speed: 0.5213s/iter; left time: 14587.8819s
	iters: 200, epoch: 33 | loss: 0.0000121
	speed: 0.2880s/iter; left time: 8031.0269s
	iters: 300, epoch: 33 | loss: 0.0000056
	speed: 0.2818s/iter; left time: 7828.9471s
	iters: 400, epoch: 33 | loss: 0.0035431
	speed: 0.2843s/iter; left time: 7872.0800s
Epoch: 33 cost time: 115.99079370498657
Epoch: 33, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.083 Vali Acc: 0.984 Test Loss: 0.083 Test Acc: 0.984
Validation loss decreased (-0.980899 --> -0.983628).  Saving model ...
	iters: 100, epoch: 34 | loss: 0.0003127
	speed: 0.5510s/iter; left time: 15191.9021s
	iters: 200, epoch: 34 | loss: 0.0000003
	speed: 0.2646s/iter; left time: 7267.7231s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.2608s/iter; left time: 7137.3551s
	iters: 400, epoch: 34 | loss: 0.0000318
	speed: 0.2939s/iter; left time: 8014.3647s
Epoch: 34 cost time: 112.52038836479187
Epoch: 34, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 0.0000111
	speed: 0.5353s/iter; left time: 14537.1728s
	iters: 200, epoch: 35 | loss: 0.0386130
	speed: 0.2562s/iter; left time: 6933.5516s
	iters: 300, epoch: 35 | loss: 0.0000006
	speed: 0.2638s/iter; left time: 7111.9855s
	iters: 400, epoch: 35 | loss: 0.0000385
	speed: 0.2936s/iter; left time: 7885.3368s
Epoch: 35 cost time: 112.50600552558899
Epoch: 35, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.118 Vali Acc: 0.974 Test Loss: 0.118 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 36 | loss: 0.0000573
	speed: 0.5642s/iter; left time: 15090.3462s
	iters: 200, epoch: 36 | loss: 0.0000059
	speed: 0.2624s/iter; left time: 6992.1340s
	iters: 300, epoch: 36 | loss: 0.0000007
	speed: 0.2561s/iter; left time: 6799.5595s
	iters: 400, epoch: 36 | loss: 0.0568160
	speed: 0.2710s/iter; left time: 7166.5675s
Epoch: 36 cost time: 111.28816723823547
Epoch: 36, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.162 Vali Acc: 0.975 Test Loss: 0.162 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 37 | loss: 0.0000146
	speed: 0.5678s/iter; left time: 14951.9441s
	iters: 200, epoch: 37 | loss: 0.0013514
	speed: 0.2705s/iter; left time: 7095.0572s
	iters: 300, epoch: 37 | loss: 0.0765957
	speed: 0.2379s/iter; left time: 6215.8290s
	iters: 400, epoch: 37 | loss: 0.0000013
	speed: 0.2681s/iter; left time: 6980.3230s
Epoch: 37 cost time: 111.24619388580322
Epoch: 37, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.103 Vali Acc: 0.981 Test Loss: 0.103 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 38 | loss: 0.0000183
	speed: 0.5993s/iter; left time: 15534.6073s
	iters: 200, epoch: 38 | loss: 0.0004661
	speed: 0.2758s/iter; left time: 7121.6290s
	iters: 300, epoch: 38 | loss: 0.0000466
	speed: 0.2728s/iter; left time: 7016.2194s
	iters: 400, epoch: 38 | loss: 0.0000530
	speed: 0.2922s/iter; left time: 7486.1582s
Epoch: 38 cost time: 118.7040524482727
Epoch: 38, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.984 Test Loss: 0.095 Test Acc: 0.984
Validation loss decreased (-0.983628 --> -0.984083).  Saving model ...
	iters: 100, epoch: 39 | loss: 0.0000027
	speed: 0.5700s/iter; left time: 14539.9980s
	iters: 200, epoch: 39 | loss: 0.0042545
	speed: 0.2721s/iter; left time: 6912.2190s
	iters: 300, epoch: 39 | loss: 0.0000183
	speed: 0.2573s/iter; left time: 6511.5140s
	iters: 400, epoch: 39 | loss: 0.0000514
	speed: 0.2696s/iter; left time: 6797.0058s
Epoch: 39 cost time: 113.12115955352783
Epoch: 39, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.150 Vali Acc: 0.976 Test Loss: 0.150 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 40 | loss: 0.0000363
	speed: 0.5838s/iter; left time: 14649.1268s
	iters: 200, epoch: 40 | loss: 0.0000153
	speed: 0.2899s/iter; left time: 7245.2606s
	iters: 300, epoch: 40 | loss: 0.0000011
	speed: 0.2832s/iter; left time: 7050.0908s
	iters: 400, epoch: 40 | loss: 0.0007001
	speed: 0.2219s/iter; left time: 5502.4639s
Epoch: 40 cost time: 113.6074230670929
Epoch: 40, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.145 Vali Acc: 0.974 Test Loss: 0.145 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 41 | loss: 0.0000008
	speed: 0.5469s/iter; left time: 13498.5951s
	iters: 200, epoch: 41 | loss: 0.0001600
	speed: 0.3052s/iter; left time: 7501.5690s
	iters: 300, epoch: 41 | loss: 0.0303008
	speed: 0.2557s/iter; left time: 6260.2118s
	iters: 400, epoch: 41 | loss: 0.0009746
	speed: 0.2661s/iter; left time: 6488.4735s
Epoch: 41 cost time: 116.49167943000793
Epoch: 41, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.167 Vali Acc: 0.970 Test Loss: 0.167 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 42 | loss: 0.0000885
	speed: 0.5596s/iter; left time: 13580.4119s
	iters: 200, epoch: 42 | loss: 0.0000090
	speed: 0.2947s/iter; left time: 7122.8784s
	iters: 300, epoch: 42 | loss: 0.0137270
	speed: 0.2720s/iter; left time: 6545.4363s
	iters: 400, epoch: 42 | loss: 0.0000002
	speed: 0.2831s/iter; left time: 6786.2869s
Epoch: 42 cost time: 119.43884468078613
Epoch: 42, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.103 Vali Acc: 0.979 Test Loss: 0.103 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 43 | loss: 0.0392204
	speed: 0.5314s/iter; left time: 12676.0229s
	iters: 200, epoch: 43 | loss: 0.0000186
	speed: 0.2813s/iter; left time: 6681.2679s
	iters: 300, epoch: 43 | loss: 0.0784615
	speed: 0.2619s/iter; left time: 6196.3564s
	iters: 400, epoch: 43 | loss: 0.0000120
	speed: 0.2671s/iter; left time: 6292.4415s
Epoch: 43 cost time: 112.11282777786255
Epoch: 43, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.197 Vali Acc: 0.971 Test Loss: 0.197 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 44 | loss: 0.0007285
	speed: 0.5627s/iter; left time: 13190.8331s
	iters: 200, epoch: 44 | loss: 0.0000041
	speed: 0.2913s/iter; left time: 6798.6221s
	iters: 300, epoch: 44 | loss: 0.0000025
	speed: 0.2745s/iter; left time: 6378.8243s
	iters: 400, epoch: 44 | loss: 0.0126669
	speed: 0.2857s/iter; left time: 6612.2980s
Epoch: 44 cost time: 119.30008292198181
Epoch: 44, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 45 | loss: 0.0000011
	speed: 0.5582s/iter; left time: 12853.6723s
	iters: 200, epoch: 45 | loss: 0.0008383
	speed: 0.2820s/iter; left time: 6466.5866s
	iters: 300, epoch: 45 | loss: 0.0000530
	speed: 0.2732s/iter; left time: 6236.4982s
	iters: 400, epoch: 45 | loss: 0.0000109
	speed: 0.2628s/iter; left time: 5973.7580s
Epoch: 45 cost time: 113.24501633644104
Epoch: 45, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.053 Vali Acc: 0.987 Test Loss: 0.053 Test Acc: 0.987
Validation loss decreased (-0.984083 --> -0.986812).  Saving model ...
	iters: 100, epoch: 46 | loss: 0.0000101
	speed: 0.5552s/iter; left time: 12556.4612s
	iters: 200, epoch: 46 | loss: 0.0004953
	speed: 0.2928s/iter; left time: 6593.3224s
	iters: 300, epoch: 46 | loss: 0.0000023
	speed: 0.2791s/iter; left time: 6255.8588s
	iters: 400, epoch: 46 | loss: 0.0000746
	speed: 0.2618s/iter; left time: 5842.4456s
Epoch: 46 cost time: 116.06340384483337
Epoch: 46, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.045 Vali Acc: 0.988 Test Loss: 0.045 Test Acc: 0.988
Validation loss decreased (-0.986812 --> -0.988176).  Saving model ...
	iters: 100, epoch: 47 | loss: 0.0000147
	speed: 0.5733s/iter; left time: 12729.2026s
	iters: 200, epoch: 47 | loss: 0.0000013
	speed: 0.2662s/iter; left time: 5884.7494s
	iters: 300, epoch: 47 | loss: 0.0000039
	speed: 0.2688s/iter; left time: 5915.3526s
	iters: 400, epoch: 47 | loss: 0.0000004
	speed: 0.2880s/iter; left time: 6308.7547s
Epoch: 47 cost time: 116.31886839866638
Epoch: 47, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.045 Vali Acc: 0.988 Test Loss: 0.045 Test Acc: 0.988
Validation loss decreased (-0.988176 --> -0.988176).  Saving model ...
	iters: 100, epoch: 48 | loss: 0.0000108
	speed: 0.5544s/iter; left time: 12079.6469s
	iters: 200, epoch: 48 | loss: 0.0000012
	speed: 0.2796s/iter; left time: 6064.1078s
	iters: 300, epoch: 48 | loss: 0.0000205
	speed: 0.2972s/iter; left time: 6416.3332s
	iters: 400, epoch: 48 | loss: 0.0000028
	speed: 0.2846s/iter; left time: 6116.5300s
Epoch: 48 cost time: 117.777756690979
Epoch: 48, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.043 Vali Acc: 0.989 Test Loss: 0.043 Test Acc: 0.989
Validation loss decreased (-0.988176 --> -0.989086).  Saving model ...
	iters: 100, epoch: 49 | loss: 0.0000004
	speed: 0.5782s/iter; left time: 12359.9540s
	iters: 200, epoch: 49 | loss: 0.0000012
	speed: 0.2718s/iter; left time: 5783.0211s
	iters: 300, epoch: 49 | loss: 0.0000502
	speed: 0.2474s/iter; left time: 5239.3250s
	iters: 400, epoch: 49 | loss: 0.0000384
	speed: 0.2808s/iter; left time: 5917.7965s
Epoch: 49 cost time: 112.94866991043091
Epoch: 49, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.041 Vali Acc: 0.989 Test Loss: 0.041 Test Acc: 0.989
Validation loss decreased (-0.989086 --> -0.989086).  Saving model ...
	iters: 100, epoch: 50 | loss: 0.0000092
	speed: 0.5824s/iter; left time: 12210.3354s
	iters: 200, epoch: 50 | loss: 0.0000016
	speed: 0.2248s/iter; left time: 4689.4840s
	iters: 300, epoch: 50 | loss: 0.0000004
	speed: 0.2459s/iter; left time: 5105.2683s
	iters: 400, epoch: 50 | loss: 0.0000037
	speed: 0.2991s/iter; left time: 6179.8156s
Epoch: 50 cost time: 110.83722162246704
Epoch: 50, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.038 Vali Acc: 0.989 Test Loss: 0.038 Test Acc: 0.989
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 51 | loss: 0.0000037
	speed: 0.5682s/iter; left time: 11677.6218s
	iters: 200, epoch: 51 | loss: 0.0000449
	speed: 0.2735s/iter; left time: 5593.4863s
	iters: 300, epoch: 51 | loss: 0.0000482
	speed: 0.2823s/iter; left time: 5744.0907s
	iters: 400, epoch: 51 | loss: 0.0000039
	speed: 0.2787s/iter; left time: 5643.1947s
Epoch: 51 cost time: 115.76727819442749
Epoch: 51, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.038 Vali Acc: 0.989 Test Loss: 0.038 Test Acc: 0.989
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 52 | loss: 0.0000000
	speed: 0.5374s/iter; left time: 10822.5149s
	iters: 200, epoch: 52 | loss: 0.0001860
	speed: 0.3063s/iter; left time: 6136.7290s
	iters: 300, epoch: 52 | loss: 0.0000011
	speed: 0.2875s/iter; left time: 5731.7731s
	iters: 400, epoch: 52 | loss: 0.0001844
	speed: 0.2733s/iter; left time: 5421.6113s
Epoch: 52 cost time: 119.07851982116699
Epoch: 52, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.038 Vali Acc: 0.989 Test Loss: 0.038 Test Acc: 0.989
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 53 | loss: 0.0000000
	speed: 0.5962s/iter; left time: 11759.2708s
	iters: 200, epoch: 53 | loss: 0.0000114
	speed: 0.2919s/iter; left time: 5728.8888s
	iters: 300, epoch: 53 | loss: 0.0000001
	speed: 0.2780s/iter; left time: 5426.9975s
	iters: 400, epoch: 53 | loss: 0.0000001
	speed: 0.2851s/iter; left time: 5538.0698s
Epoch: 53 cost time: 119.59875178337097
Epoch: 53, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.038 Vali Acc: 0.989 Test Loss: 0.038 Test Acc: 0.989
Validation loss decreased (-0.989086 --> -0.989086).  Saving model ...
	iters: 100, epoch: 54 | loss: 0.0000019
	speed: 0.5734s/iter; left time: 11074.4317s
	iters: 200, epoch: 54 | loss: 0.0000013
	speed: 0.2744s/iter; left time: 5272.2002s
	iters: 300, epoch: 54 | loss: 0.0000000
	speed: 0.2954s/iter; left time: 5644.7797s
	iters: 400, epoch: 54 | loss: 0.0000002
	speed: 0.2793s/iter; left time: 5310.8963s
Epoch: 54 cost time: 118.18604016304016
Epoch: 54, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.040 Vali Acc: 0.989 Test Loss: 0.040 Test Acc: 0.989
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 55 | loss: 0.0000000
	speed: 0.5367s/iter; left time: 10142.4718s
	iters: 200, epoch: 55 | loss: 0.0000034
	speed: 0.3061s/iter; left time: 5754.6823s
	iters: 300, epoch: 55 | loss: 0.0000000
	speed: 0.2876s/iter; left time: 5378.1196s
	iters: 400, epoch: 55 | loss: 0.0000000
	speed: 0.2844s/iter; left time: 5290.4769s
Epoch: 55 cost time: 121.54958915710449
Epoch: 55, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.040 Vali Acc: 0.989 Test Loss: 0.040 Test Acc: 0.989
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 56 | loss: 0.0000045
	speed: 0.5551s/iter; left time: 10262.2062s
	iters: 200, epoch: 56 | loss: 0.0000048
	speed: 0.2775s/iter; left time: 5102.0431s
	iters: 300, epoch: 56 | loss: 0.0000000
	speed: 0.2629s/iter; left time: 4808.2318s
	iters: 400, epoch: 56 | loss: 0.0000001
	speed: 0.2764s/iter; left time: 5027.2599s
Epoch: 56 cost time: 114.61751914024353
Epoch: 56, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.040 Vali Acc: 0.990 Test Loss: 0.040 Test Acc: 0.990
Validation loss decreased (-0.989086 --> -0.989995).  Saving model ...
	iters: 100, epoch: 57 | loss: 0.0000001
	speed: 0.5541s/iter; left time: 10014.4932s
	iters: 200, epoch: 57 | loss: 0.0000002
	speed: 0.3032s/iter; left time: 5449.4719s
	iters: 300, epoch: 57 | loss: 0.0000001
	speed: 0.2726s/iter; left time: 4871.4546s
	iters: 400, epoch: 57 | loss: 0.0000003
	speed: 0.2793s/iter; left time: 4964.4146s
Epoch: 57 cost time: 117.39293909072876
Epoch: 57, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.040 Vali Acc: 0.990 Test Loss: 0.040 Test Acc: 0.990
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 58 | loss: 0.0000019
	speed: 0.5488s/iter; left time: 9691.3042s
	iters: 200, epoch: 58 | loss: 0.0000001
	speed: 0.2923s/iter; left time: 5132.8580s
	iters: 300, epoch: 58 | loss: 0.0000021
	speed: 0.2741s/iter; left time: 4786.4525s
	iters: 400, epoch: 58 | loss: 0.0000002
	speed: 0.2897s/iter; left time: 5029.3628s
Epoch: 58 cost time: 117.12583899497986
Epoch: 58, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.040 Vali Acc: 0.990 Test Loss: 0.040 Test Acc: 0.990
Validation loss decreased (-0.989995 --> -0.990450).  Saving model ...
	iters: 100, epoch: 59 | loss: 0.0000007
	speed: 0.5612s/iter; left time: 9678.2029s
	iters: 200, epoch: 59 | loss: 0.0000017
	speed: 0.3088s/iter; left time: 5295.7745s
	iters: 300, epoch: 59 | loss: 0.0000002
	speed: 0.2773s/iter; left time: 4727.3415s
	iters: 400, epoch: 59 | loss: 0.0000000
	speed: 0.2821s/iter; left time: 4779.9696s
Epoch: 59 cost time: 119.90816712379456
Epoch: 59, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.042 Vali Acc: 0.990 Test Loss: 0.042 Test Acc: 0.990
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 60 | loss: 0.0000000
	speed: 0.5603s/iter; left time: 9431.5354s
	iters: 200, epoch: 60 | loss: 0.0000004
	speed: 0.2928s/iter; left time: 4899.8718s
	iters: 300, epoch: 60 | loss: 0.0000026
	speed: 0.2833s/iter; left time: 4711.7591s
	iters: 400, epoch: 60 | loss: 0.0000000
	speed: 0.2784s/iter; left time: 4603.3658s
Epoch: 60 cost time: 118.19198036193848
Epoch: 60, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.041 Vali Acc: 0.990 Test Loss: 0.041 Test Acc: 0.990
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 61 | loss: 0.0000000
	speed: 0.5418s/iter; left time: 8897.0147s
	iters: 200, epoch: 61 | loss: 0.0000000
	speed: 0.2889s/iter; left time: 4714.5161s
	iters: 300, epoch: 61 | loss: 0.0000021
	speed: 0.2762s/iter; left time: 4479.9338s
	iters: 400, epoch: 61 | loss: 0.0000001
	speed: 0.2566s/iter; left time: 4136.3394s
Epoch: 61 cost time: 113.90932083129883
Epoch: 61, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.042 Vali Acc: 0.990 Test Loss: 0.042 Test Acc: 0.990
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 62 | loss: 0.0000003
	speed: 0.5694s/iter; left time: 9114.1862s
	iters: 200, epoch: 62 | loss: 0.0000003
	speed: 0.3029s/iter; left time: 4818.8693s
	iters: 300, epoch: 62 | loss: 0.0000004
	speed: 0.2908s/iter; left time: 4597.6722s
	iters: 400, epoch: 62 | loss: 0.0000003
	speed: 0.2746s/iter; left time: 4313.9406s
Epoch: 62 cost time: 119.84051203727722
Epoch: 62, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.040 Vali Acc: 0.991 Test Loss: 0.040 Test Acc: 0.991
Validation loss decreased (-0.990450 --> -0.991359).  Saving model ...
	iters: 100, epoch: 63 | loss: 0.0000054
	speed: 0.5535s/iter; left time: 8631.2368s
	iters: 200, epoch: 63 | loss: 0.0000006
	speed: 0.2904s/iter; left time: 4500.3410s
	iters: 300, epoch: 63 | loss: 0.0000000
	speed: 0.2778s/iter; left time: 4276.4940s
	iters: 400, epoch: 63 | loss: 0.0000007
	speed: 0.2836s/iter; left time: 4337.4699s
Epoch: 63 cost time: 116.03137683868408
Epoch: 63, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.040 Vali Acc: 0.991 Test Loss: 0.040 Test Acc: 0.991
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 64 | loss: 0.0000001
	speed: 0.5671s/iter; left time: 8609.8870s
	iters: 200, epoch: 64 | loss: 0.0000000
	speed: 0.2893s/iter; left time: 4363.0768s
	iters: 300, epoch: 64 | loss: 0.0000000
	speed: 0.2902s/iter; left time: 4347.8093s
	iters: 400, epoch: 64 | loss: 0.0000000
	speed: 0.2896s/iter; left time: 4310.3262s
Epoch: 64 cost time: 120.28017687797546
Epoch: 64, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.040 Vali Acc: 0.991 Test Loss: 0.040 Test Acc: 0.991
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 65 | loss: 0.0000002
	speed: 0.5319s/iter; left time: 7856.2970s
	iters: 200, epoch: 65 | loss: 0.0000061
	speed: 0.2620s/iter; left time: 3842.9294s
	iters: 300, epoch: 65 | loss: 0.0000001
	speed: 0.2619s/iter; left time: 3815.7718s
	iters: 400, epoch: 65 | loss: 0.0000011
	speed: 0.2863s/iter; left time: 4142.3382s
Epoch: 65 cost time: 112.52240228652954
Epoch: 65, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.041 Vali Acc: 0.991 Test Loss: 0.041 Test Acc: 0.991
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 66 | loss: 0.7482598
	speed: 0.5489s/iter; left time: 7879.4533s
	iters: 200, epoch: 66 | loss: 0.0004232
	speed: 0.2777s/iter; left time: 3958.8365s
	iters: 300, epoch: 66 | loss: 0.0406921
	speed: 0.2842s/iter; left time: 4023.2835s
	iters: 400, epoch: 66 | loss: 0.0023609
	speed: 0.2819s/iter; left time: 3962.5789s
Epoch: 66 cost time: 115.96035671234131
Epoch: 66, Steps: 413 | Train Loss: 0.111 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 67 | loss: 0.0004961
	speed: 0.5744s/iter; left time: 8009.1179s
	iters: 200, epoch: 67 | loss: 0.0022645
	speed: 0.2760s/iter; left time: 3821.0303s
	iters: 300, epoch: 67 | loss: 0.0827641
	speed: 0.2625s/iter; left time: 3607.0515s
	iters: 400, epoch: 67 | loss: 0.0000879
	speed: 0.2829s/iter; left time: 3859.6035s
Epoch: 67 cost time: 114.71955466270447
Epoch: 67, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.059 Vali Acc: 0.984 Test Loss: 0.059 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 68 | loss: 0.0015377
	speed: 0.5565s/iter; left time: 7529.4858s
	iters: 200, epoch: 68 | loss: 0.0040154
	speed: 0.2725s/iter; left time: 3659.6422s
	iters: 300, epoch: 68 | loss: 0.0001407
	speed: 0.2744s/iter; left time: 3657.5543s
	iters: 400, epoch: 68 | loss: 0.0007255
	speed: 0.2869s/iter; left time: 3795.7467s
Epoch: 68 cost time: 115.32035422325134
Epoch: 68, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.055 Vali Acc: 0.986 Test Loss: 0.055 Test Acc: 0.986
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 69 | loss: 0.0000263
	speed: 0.5667s/iter; left time: 7433.7603s
	iters: 200, epoch: 69 | loss: 0.0000146
	speed: 0.2938s/iter; left time: 3823.9555s
	iters: 300, epoch: 69 | loss: 0.0024739
	speed: 0.2868s/iter; left time: 3704.6477s
	iters: 400, epoch: 69 | loss: 0.2796349
	speed: 0.2795s/iter; left time: 3582.8532s
Epoch: 69 cost time: 119.57762217521667
Epoch: 69, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.117 Vali Acc: 0.979 Test Loss: 0.117 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 70 | loss: 0.0003989
	speed: 0.4896s/iter; left time: 6219.3908s
	iters: 200, epoch: 70 | loss: 0.0000068
	speed: 0.2861s/iter; left time: 3606.2815s
	iters: 300, epoch: 70 | loss: 0.0000034
	speed: 0.2955s/iter; left time: 3695.3277s
	iters: 400, epoch: 70 | loss: 0.0001623
	speed: 0.2906s/iter; left time: 3605.1647s
Epoch: 70 cost time: 115.49415707588196
Epoch: 70, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.074 Vali Acc: 0.985 Test Loss: 0.074 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 71 | loss: 0.0000010
	speed: 0.5268s/iter; left time: 6474.5574s
	iters: 200, epoch: 71 | loss: 0.0000566
	speed: 0.2858s/iter; left time: 3484.6521s
	iters: 300, epoch: 71 | loss: 0.0000862
	speed: 0.2959s/iter; left time: 3577.1940s
	iters: 400, epoch: 71 | loss: 0.0000106
	speed: 0.2885s/iter; left time: 3458.8984s
Epoch: 71 cost time: 117.37855124473572
Epoch: 71, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 72 | loss: 0.0032552
	speed: 0.5142s/iter; left time: 6108.2104s
	iters: 200, epoch: 72 | loss: 0.0000093
	speed: 0.2707s/iter; left time: 3188.0815s
	iters: 300, epoch: 72 | loss: 0.0000063
	speed: 0.2873s/iter; left time: 3355.2431s
	iters: 400, epoch: 72 | loss: 0.0000254
	speed: 0.2975s/iter; left time: 3444.9698s
Epoch: 72 cost time: 115.98381328582764
Epoch: 72, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9913597089586176
model parameter : 12973066
model size : 69.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3295760
	speed: 0.3098s/iter; left time: 12764.6162s
	iters: 200, epoch: 1 | loss: 0.0100279
	speed: 0.2861s/iter; left time: 11760.0939s
	iters: 300, epoch: 1 | loss: 0.4101795
	speed: 0.2612s/iter; left time: 10708.0666s
	iters: 400, epoch: 1 | loss: 0.6906236
	speed: 0.2740s/iter; left time: 11208.8216s
Epoch: 1 cost time: 117.41790008544922
Epoch: 1, Steps: 413 | Train Loss: 0.528 Vali Loss: 0.385 Vali Acc: 0.919 Test Loss: 0.385 Test Acc: 0.919
Validation loss decreased (inf --> -0.919050).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0023790
	speed: 0.5568s/iter; left time: 22711.9283s
	iters: 200, epoch: 2 | loss: 0.0019505
	speed: 0.2653s/iter; left time: 10793.4009s
	iters: 300, epoch: 2 | loss: 1.4072459
	speed: 0.2575s/iter; left time: 10452.3799s
	iters: 400, epoch: 2 | loss: 0.3524939
	speed: 0.2694s/iter; left time: 10906.0706s
Epoch: 2 cost time: 109.90393257141113
Epoch: 2, Steps: 413 | Train Loss: 0.308 Vali Loss: 0.345 Vali Acc: 0.932 Test Loss: 0.345 Test Acc: 0.932
Validation loss decreased (-0.919050 --> -0.931784).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0010017
	speed: 0.5699s/iter; left time: 23010.3053s
	iters: 200, epoch: 3 | loss: 0.1890234
	speed: 0.2938s/iter; left time: 11830.8375s
	iters: 300, epoch: 3 | loss: 0.4128539
	speed: 0.2957s/iter; left time: 11878.6397s
	iters: 400, epoch: 3 | loss: 0.4917913
	speed: 0.2837s/iter; left time: 11369.7887s
Epoch: 3 cost time: 120.68059206008911
Epoch: 3, Steps: 413 | Train Loss: 0.396 Vali Loss: 0.414 Vali Acc: 0.941 Test Loss: 0.414 Test Acc: 0.941
Validation loss decreased (-0.931784 --> -0.940878).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.1542288
	speed: 0.5456s/iter; left time: 21803.7865s
	iters: 200, epoch: 4 | loss: 0.4608647
	speed: 0.2895s/iter; left time: 11538.4332s
	iters: 300, epoch: 4 | loss: 0.0251887
	speed: 0.2821s/iter; left time: 11215.2716s
	iters: 400, epoch: 4 | loss: 0.0006708
	speed: 0.2834s/iter; left time: 11238.6056s
Epoch: 4 cost time: 117.83827686309814
Epoch: 4, Steps: 413 | Train Loss: 0.396 Vali Loss: 0.373 Vali Acc: 0.951 Test Loss: 0.373 Test Acc: 0.951
Validation loss decreased (-0.940878 --> -0.950883).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1243315
	speed: 0.5601s/iter; left time: 22152.7350s
	iters: 200, epoch: 5 | loss: 0.0000019
	speed: 0.2818s/iter; left time: 11117.2718s
	iters: 300, epoch: 5 | loss: 0.5255690
	speed: 0.2875s/iter; left time: 11312.7274s
	iters: 400, epoch: 5 | loss: 0.0001683
	speed: 0.2918s/iter; left time: 11453.3742s
Epoch: 5 cost time: 118.17024850845337
Epoch: 5, Steps: 413 | Train Loss: 0.316 Vali Loss: 0.430 Vali Acc: 0.935 Test Loss: 0.430 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.1987410
	speed: 0.5301s/iter; left time: 20745.7282s
	iters: 200, epoch: 6 | loss: 1.0261828
	speed: 0.2655s/iter; left time: 10362.6167s
	iters: 300, epoch: 6 | loss: 0.0000001
	speed: 0.2795s/iter; left time: 10884.0176s
	iters: 400, epoch: 6 | loss: 2.5228555
	speed: 0.2956s/iter; left time: 11480.3422s
Epoch: 6 cost time: 115.4871621131897
Epoch: 6, Steps: 413 | Train Loss: 0.282 Vali Loss: 0.643 Vali Acc: 0.928 Test Loss: 0.643 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.8270444
	speed: 0.5659s/iter; left time: 21913.5634s
	iters: 200, epoch: 7 | loss: 0.0000001
	speed: 0.2836s/iter; left time: 10952.3670s
	iters: 300, epoch: 7 | loss: 0.0270577
	speed: 0.2891s/iter; left time: 11135.2923s
	iters: 400, epoch: 7 | loss: 0.3426225
	speed: 0.2910s/iter; left time: 11181.0701s
Epoch: 7 cost time: 120.69723868370056
Epoch: 7, Steps: 413 | Train Loss: 0.214 Vali Loss: 0.424 Vali Acc: 0.963 Test Loss: 0.424 Test Acc: 0.963
Validation loss decreased (-0.950883 --> -0.962706).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0020959
	speed: 0.5713s/iter; left time: 21886.0867s
	iters: 200, epoch: 8 | loss: 0.1556059
	speed: 0.2784s/iter; left time: 10636.6341s
	iters: 300, epoch: 8 | loss: 1.1400300
	speed: 0.2521s/iter; left time: 9606.0740s
	iters: 400, epoch: 8 | loss: 0.0000050
	speed: 0.2770s/iter; left time: 10527.2609s
Epoch: 8 cost time: 112.94054913520813
Epoch: 8, Steps: 413 | Train Loss: 0.189 Vali Loss: 0.367 Vali Acc: 0.961 Test Loss: 0.367 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000218
	speed: 0.5535s/iter; left time: 20976.9026s
	iters: 200, epoch: 9 | loss: 0.0028548
	speed: 0.2829s/iter; left time: 10691.6904s
	iters: 300, epoch: 9 | loss: 0.0477667
	speed: 0.2844s/iter; left time: 10720.0717s
	iters: 400, epoch: 9 | loss: 0.0012971
	speed: 0.2836s/iter; left time: 10663.1106s
Epoch: 9 cost time: 118.47130632400513
Epoch: 9, Steps: 413 | Train Loss: 0.183 Vali Loss: 0.437 Vali Acc: 0.946 Test Loss: 0.437 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.5278s/iter; left time: 19783.7932s
	iters: 200, epoch: 10 | loss: 0.0001701
	speed: 0.3004s/iter; left time: 11229.3447s
	iters: 300, epoch: 10 | loss: 0.0000792
	speed: 0.2848s/iter; left time: 10618.2677s
	iters: 400, epoch: 10 | loss: 0.0002506
	speed: 0.2813s/iter; left time: 10458.4338s
Epoch: 10 cost time: 118.28662014007568
Epoch: 10, Steps: 413 | Train Loss: 0.103 Vali Loss: 0.337 Vali Acc: 0.966 Test Loss: 0.337 Test Acc: 0.966
Validation loss decreased (-0.962706 --> -0.966345).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0045844
	speed: 0.5359s/iter; left time: 19865.7686s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.2988s/iter; left time: 11048.3910s
	iters: 300, epoch: 11 | loss: 0.0012995
	speed: 0.3038s/iter; left time: 11201.8207s
	iters: 400, epoch: 11 | loss: 0.0001353
	speed: 0.2917s/iter; left time: 10726.8305s
Epoch: 11 cost time: 120.99427127838135
Epoch: 11, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.100 Vali Acc: 0.982 Test Loss: 0.100 Test Acc: 0.982
Validation loss decreased (-0.966345 --> -0.982264).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000334
	speed: 0.5400s/iter; left time: 19795.6360s
	iters: 200, epoch: 12 | loss: 0.3989431
	speed: 0.2761s/iter; left time: 10094.6960s
	iters: 300, epoch: 12 | loss: 0.0000008
	speed: 0.2877s/iter; left time: 10489.7416s
	iters: 400, epoch: 12 | loss: 0.0000001
	speed: 0.2992s/iter; left time: 10877.7543s
Epoch: 12 cost time: 118.20564270019531
Epoch: 12, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.188 Vali Acc: 0.976 Test Loss: 0.188 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0061905
	speed: 0.5439s/iter; left time: 19713.2262s
	iters: 200, epoch: 13 | loss: 0.0000008
	speed: 0.2759s/iter; left time: 9973.3640s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.2820s/iter; left time: 10165.7075s
	iters: 400, epoch: 13 | loss: 0.0001479
	speed: 0.2886s/iter; left time: 10373.7163s
Epoch: 13 cost time: 116.23571705818176
Epoch: 13, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.302 Vali Acc: 0.963 Test Loss: 0.302 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0059484
	speed: 0.5617s/iter; left time: 20126.8284s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.2808s/iter; left time: 10033.9751s
	iters: 300, epoch: 14 | loss: 0.0005859
	speed: 0.2815s/iter; left time: 10030.4819s
	iters: 400, epoch: 14 | loss: 0.0000001
	speed: 0.2571s/iter; left time: 9135.5256s
Epoch: 14 cost time: 113.87297630310059
Epoch: 14, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.208 Vali Acc: 0.970 Test Loss: 0.208 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000032
	speed: 0.5567s/iter; left time: 19718.9444s
	iters: 200, epoch: 15 | loss: 0.0000029
	speed: 0.2893s/iter; left time: 10217.5365s
	iters: 300, epoch: 15 | loss: 0.0000006
	speed: 0.2853s/iter; left time: 10046.6447s
	iters: 400, epoch: 15 | loss: 0.0000334
	speed: 0.2772s/iter; left time: 9735.6603s
Epoch: 15 cost time: 118.52019596099854
Epoch: 15, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.334 Vali Acc: 0.962 Test Loss: 0.334 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.9756320
	speed: 0.5830s/iter; left time: 20407.1736s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.2848s/iter; left time: 9942.0688s
	iters: 300, epoch: 16 | loss: 0.0000503
	speed: 0.2714s/iter; left time: 9447.5070s
	iters: 400, epoch: 16 | loss: 0.0018236
	speed: 0.2605s/iter; left time: 9040.2802s
Epoch: 16 cost time: 116.3556215763092
Epoch: 16, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.343 Vali Acc: 0.958 Test Loss: 0.343 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.2965491
	speed: 0.5382s/iter; left time: 18617.2947s
	iters: 200, epoch: 17 | loss: 0.0010355
	speed: 0.2865s/iter; left time: 9880.6722s
	iters: 300, epoch: 17 | loss: 0.0000002
	speed: 0.2734s/iter; left time: 9402.5495s
	iters: 400, epoch: 17 | loss: 0.0000011
	speed: 0.2914s/iter; left time: 9994.6021s
Epoch: 17 cost time: 118.366140127182
Epoch: 17, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.256 Vali Acc: 0.973 Test Loss: 0.256 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000005
	speed: 0.5738s/iter; left time: 19612.5455s
	iters: 200, epoch: 18 | loss: 0.0021384
	speed: 0.2893s/iter; left time: 9859.8822s
	iters: 300, epoch: 18 | loss: 0.0000033
	speed: 0.2700s/iter; left time: 9174.9706s
	iters: 400, epoch: 18 | loss: 0.0000003
	speed: 0.2772s/iter; left time: 9390.9835s
Epoch: 18 cost time: 117.51493287086487
Epoch: 18, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.5294s/iter; left time: 17877.1825s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.2541s/iter; left time: 8553.2938s
	iters: 300, epoch: 19 | loss: 0.0000001
	speed: 0.2570s/iter; left time: 8626.1458s
	iters: 400, epoch: 19 | loss: 0.0194776
	speed: 0.2922s/iter; left time: 9778.5878s
Epoch: 19 cost time: 111.382315158844
Epoch: 19, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.266 Vali Acc: 0.964 Test Loss: 0.266 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000072
	speed: 0.5631s/iter; left time: 18780.6936s
	iters: 200, epoch: 20 | loss: 0.0000255
	speed: 0.2815s/iter; left time: 9361.3700s
	iters: 300, epoch: 20 | loss: 0.0000002
	speed: 0.2898s/iter; left time: 9609.6209s
	iters: 400, epoch: 20 | loss: 0.0002956
	speed: 0.2844s/iter; left time: 9400.5582s
Epoch: 20 cost time: 119.122234582901
Epoch: 20, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.350 Vali Acc: 0.961 Test Loss: 0.350 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0026066
	speed: 0.5545s/iter; left time: 18265.8458s
	iters: 200, epoch: 21 | loss: 0.0000001
	speed: 0.2478s/iter; left time: 8138.4292s
	iters: 300, epoch: 21 | loss: 0.0005587
	speed: 0.2606s/iter; left time: 8531.7107s
	iters: 400, epoch: 21 | loss: 0.0000006
	speed: 0.2774s/iter; left time: 9056.1013s
Epoch: 21 cost time: 110.84058332443237
Epoch: 21, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.262 Vali Acc: 0.965 Test Loss: 0.262 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9822646657571623
model parameter : 12973066
model size : 69.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.3038471
	speed: 0.2629s/iter; left time: 10830.9593s
	iters: 200, epoch: 1 | loss: 2.3018403
	speed: 0.2520s/iter; left time: 10358.2551s
	iters: 300, epoch: 1 | loss: 2.3014612
	speed: 0.2874s/iter; left time: 11783.2806s
	iters: 400, epoch: 1 | loss: 2.3029270
	speed: 0.2879s/iter; left time: 11776.0659s
Epoch: 1 cost time: 113.11645817756653
Epoch: 1, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (inf --> -0.100022).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3028314
	speed: 0.5227s/iter; left time: 21319.0656s
	iters: 200, epoch: 2 | loss: 2.3029077
	speed: 0.2693s/iter; left time: 10956.1278s
	iters: 300, epoch: 2 | loss: 2.3030794
	speed: 0.2659s/iter; left time: 10791.1080s
	iters: 400, epoch: 2 | loss: 2.3038518
	speed: 0.2972s/iter; left time: 12035.0104s
Epoch: 2 cost time: 112.01173734664917
Epoch: 2, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3015139
	speed: 0.5715s/iter; left time: 23076.0202s
	iters: 200, epoch: 3 | loss: 2.3028264
	speed: 0.2670s/iter; left time: 10753.9812s
	iters: 300, epoch: 3 | loss: 2.3017039
	speed: 0.2724s/iter; left time: 10945.4274s
	iters: 400, epoch: 3 | loss: 2.3039980
	speed: 0.2967s/iter; left time: 11888.2758s
Epoch: 3 cost time: 115.60638380050659
Epoch: 3, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.3015621
	speed: 0.5239s/iter; left time: 20935.0351s
	iters: 200, epoch: 4 | loss: 2.3026557
	speed: 0.2741s/iter; left time: 10924.3578s
	iters: 300, epoch: 4 | loss: 2.3009181
	speed: 0.2742s/iter; left time: 10902.0759s
	iters: 400, epoch: 4 | loss: 2.3028333
	speed: 0.2875s/iter; left time: 11404.2485s
Epoch: 4 cost time: 112.55088925361633
Epoch: 4, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.3042858
	speed: 0.5566s/iter; left time: 22013.1408s
	iters: 200, epoch: 5 | loss: 2.3016088
	speed: 0.2724s/iter; left time: 10745.6949s
	iters: 300, epoch: 5 | loss: 2.3018916
	speed: 0.2546s/iter; left time: 10018.7175s
	iters: 400, epoch: 5 | loss: 2.3026733
	speed: 0.2824s/iter; left time: 11085.0321s
Epoch: 5 cost time: 113.34798502922058
Epoch: 5, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.3019848
	speed: 0.5640s/iter; left time: 22072.2550s
	iters: 200, epoch: 6 | loss: 2.2998869
	speed: 0.2796s/iter; left time: 10914.9557s
	iters: 300, epoch: 6 | loss: 2.3051980
	speed: 0.2838s/iter; left time: 11048.3718s
	iters: 400, epoch: 6 | loss: 2.3019993
	speed: 0.2703s/iter; left time: 10499.1638s
Epoch: 6 cost time: 116.52746367454529
Epoch: 6, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 2.3026857
	speed: 0.5169s/iter; left time: 20017.2748s
	iters: 200, epoch: 7 | loss: 2.2997367
	speed: 0.2838s/iter; left time: 10962.7474s
	iters: 300, epoch: 7 | loss: 2.3029532
	speed: 0.2889s/iter; left time: 11130.0034s
	iters: 400, epoch: 7 | loss: 2.3014593
	speed: 0.2832s/iter; left time: 10882.1119s
Epoch: 7 cost time: 116.9404399394989
Epoch: 7, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 2.3028867
	speed: 0.5126s/iter; left time: 19636.8534s
	iters: 200, epoch: 8 | loss: 2.3016367
	speed: 0.2835s/iter; left time: 10834.2538s
	iters: 300, epoch: 8 | loss: 2.3028152
	speed: 0.2935s/iter; left time: 11185.3867s
	iters: 400, epoch: 8 | loss: 2.3026171
	speed: 0.2874s/iter; left time: 10925.7216s
Epoch: 8 cost time: 116.45686101913452
Epoch: 8, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 2.3012481
	speed: 0.4921s/iter; left time: 18648.9360s
	iters: 200, epoch: 9 | loss: 2.2996216
	speed: 0.2552s/iter; left time: 9647.2745s
	iters: 300, epoch: 9 | loss: 2.3027351
	speed: 0.2742s/iter; left time: 10336.4976s
	iters: 400, epoch: 9 | loss: 2.3022828
	speed: 0.2936s/iter; left time: 11039.5260s
Epoch: 9 cost time: 112.06096768379211
Epoch: 9, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 2.3031919
	speed: 0.5637s/iter; left time: 21129.1862s
	iters: 200, epoch: 10 | loss: 2.3021073
	speed: 0.2617s/iter; left time: 9784.0945s
	iters: 300, epoch: 10 | loss: 2.3028793
	speed: 0.2977s/iter; left time: 11100.2154s
	iters: 400, epoch: 10 | loss: 2.3030591
	speed: 0.3016s/iter; left time: 11215.6273s
Epoch: 10 cost time: 119.28255105018616
Epoch: 10, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 2.3005056
	speed: 0.5278s/iter; left time: 19565.4490s
	iters: 200, epoch: 11 | loss: 2.3001723
	speed: 0.2491s/iter; left time: 9209.9412s
	iters: 300, epoch: 11 | loss: 2.3064499
	speed: 0.2534s/iter; left time: 9341.7025s
	iters: 400, epoch: 11 | loss: 2.3024387
	speed: 0.2951s/iter; left time: 10852.4462s
Epoch: 11 cost time: 111.25050449371338
Epoch: 11, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 2.3066094
	speed: 0.5617s/iter; left time: 20591.5972s
	iters: 200, epoch: 12 | loss: 2.3054056
	speed: 0.2845s/iter; left time: 10399.1066s
	iters: 300, epoch: 12 | loss: 2.3035579
	speed: 0.2857s/iter; left time: 10414.2905s
	iters: 400, epoch: 12 | loss: 2.3042336
	speed: 0.2825s/iter; left time: 10272.1595s
Epoch: 12 cost time: 117.50737476348877
Epoch: 12, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.3034377
	speed: 0.5575s/iter; left time: 20206.0732s
	iters: 200, epoch: 13 | loss: 2.2983243
	speed: 0.2880s/iter; left time: 10409.5467s
	iters: 300, epoch: 13 | loss: 2.3016589
	speed: 0.2574s/iter; left time: 9277.6979s
	iters: 400, epoch: 13 | loss: 2.3024573
	speed: 0.2563s/iter; left time: 9210.9425s
Epoch: 13 cost time: 113.10663414001465
Epoch: 13, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.3019161
	speed: 0.5898s/iter; left time: 21134.5585s
	iters: 200, epoch: 14 | loss: 2.3004093
	speed: 0.2820s/iter; left time: 10075.4328s
	iters: 300, epoch: 14 | loss: 2.3046942
	speed: 0.2829s/iter; left time: 10081.9098s
	iters: 400, epoch: 14 | loss: 2.3024285
	speed: 0.2966s/iter; left time: 10538.8506s
Epoch: 14 cost time: 119.64618039131165
Epoch: 14, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.3018174
	speed: 0.5543s/iter; left time: 19634.4194s
	iters: 200, epoch: 15 | loss: 2.3020604
	speed: 0.2822s/iter; left time: 9965.9749s
	iters: 300, epoch: 15 | loss: 2.3036633
	speed: 0.2885s/iter; left time: 10161.5857s
	iters: 400, epoch: 15 | loss: 2.3025217
	speed: 0.2625s/iter; left time: 9220.2078s
Epoch: 15 cost time: 115.23674392700195
Epoch: 15, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 2.3009057
	speed: 0.5569s/iter; left time: 19496.0231s
	iters: 200, epoch: 16 | loss: 2.3011935
	speed: 0.2984s/iter; left time: 10416.9782s
	iters: 300, epoch: 16 | loss: 2.3046014
	speed: 0.2637s/iter; left time: 9177.2345s
	iters: 400, epoch: 16 | loss: 2.3027861
	speed: 0.2732s/iter; left time: 9480.8861s
Epoch: 16 cost time: 117.11574506759644
Epoch: 16, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 17 | loss: 2.3022354
	speed: 0.5757s/iter; left time: 19914.9894s
	iters: 200, epoch: 17 | loss: 2.3033161
	speed: 0.2810s/iter; left time: 9692.6246s
	iters: 300, epoch: 17 | loss: 2.3021617
	speed: 0.2759s/iter; left time: 9487.3825s
	iters: 400, epoch: 17 | loss: 2.3040972
	speed: 0.2728s/iter; left time: 9355.4784s
Epoch: 17 cost time: 114.99374723434448
Epoch: 17, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 2.3054945
	speed: 0.5697s/iter; left time: 19471.7612s
	iters: 200, epoch: 18 | loss: 2.3040743
	speed: 0.3045s/iter; left time: 10377.3832s
	iters: 300, epoch: 18 | loss: 2.3049753
	speed: 0.2781s/iter; left time: 9450.2699s
	iters: 400, epoch: 18 | loss: 2.3040190
	speed: 0.2651s/iter; left time: 8982.9710s
Epoch: 18 cost time: 117.39109230041504
Epoch: 18, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 19 | loss: 2.3066792
	speed: 0.5802s/iter; left time: 19592.0100s
	iters: 200, epoch: 19 | loss: 2.3067462
	speed: 0.2794s/iter; left time: 9405.2479s
	iters: 300, epoch: 19 | loss: 2.3036883
	speed: 0.2656s/iter; left time: 8916.0562s
	iters: 400, epoch: 19 | loss: 2.3026614
	speed: 0.2845s/iter; left time: 9520.7890s
Epoch: 19 cost time: 116.65802001953125
Epoch: 19, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 2.3024473
	speed: 0.5652s/iter; left time: 18852.5191s
	iters: 200, epoch: 20 | loss: 2.3028760
	speed: 0.2960s/iter; left time: 9843.3559s
	iters: 300, epoch: 20 | loss: 2.3046625
	speed: 0.2962s/iter; left time: 9819.6983s
	iters: 400, epoch: 20 | loss: 2.3018782
	speed: 0.2601s/iter; left time: 8596.6880s
Epoch: 20 cost time: 118.11584663391113
Epoch: 20, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 2.3024216
	speed: 0.5451s/iter; left time: 17956.5894s
	iters: 200, epoch: 21 | loss: 2.3020482
	speed: 0.2878s/iter; left time: 9453.0657s
	iters: 300, epoch: 21 | loss: 2.3024271
	speed: 0.2663s/iter; left time: 8717.9365s
	iters: 400, epoch: 21 | loss: 2.3029017
	speed: 0.2690s/iter; left time: 8780.3073s
Epoch: 21 cost time: 114.92203903198242
Epoch: 21, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 2.2992935
	speed: 0.5675s/iter; left time: 18458.3427s
	iters: 200, epoch: 22 | loss: 2.3023529
	speed: 0.2957s/iter; left time: 9588.1598s
	iters: 300, epoch: 22 | loss: 2.3026896
	speed: 0.2846s/iter; left time: 9201.6755s
	iters: 400, epoch: 22 | loss: 2.3016798
	speed: 0.2952s/iter; left time: 9514.6341s
Epoch: 22 cost time: 120.12897610664368
Epoch: 22, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 2.3014908
	speed: 0.5321s/iter; left time: 17089.2185s
	iters: 200, epoch: 23 | loss: 2.3008454
	speed: 0.3019s/iter; left time: 9665.3570s
	iters: 300, epoch: 23 | loss: 2.3060625
	speed: 0.2881s/iter; left time: 9194.1880s
	iters: 400, epoch: 23 | loss: 2.3042686
	speed: 0.2746s/iter; left time: 8736.1564s
Epoch: 23 cost time: 117.20887613296509
Epoch: 23, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 2.3024614
	speed: 0.5575s/iter; left time: 17672.4640s
	iters: 200, epoch: 24 | loss: 2.3031459
	speed: 0.2839s/iter; left time: 8972.2331s
	iters: 300, epoch: 24 | loss: 2.3050480
	speed: 0.2853s/iter; left time: 8989.0174s
	iters: 400, epoch: 24 | loss: 2.3045213
	speed: 0.2703s/iter; left time: 8487.6675s
Epoch: 24 cost time: 118.0547137260437
Epoch: 24, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 2.3003192
	speed: 0.5747s/iter; left time: 17982.5908s
	iters: 200, epoch: 25 | loss: 2.3029068
	speed: 0.2473s/iter; left time: 7711.8710s
	iters: 300, epoch: 25 | loss: 2.3004706
	speed: 0.2604s/iter; left time: 8094.4287s
	iters: 400, epoch: 25 | loss: 2.3025513
	speed: 0.2780s/iter; left time: 8616.2072s
Epoch: 25 cost time: 111.93341946601868
Epoch: 25, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 2.2999494
	speed: 0.5114s/iter; left time: 15789.9769s
	iters: 200, epoch: 26 | loss: 2.3064454
	speed: 0.2882s/iter; left time: 8868.4086s
	iters: 300, epoch: 26 | loss: 2.3011253
	speed: 0.2625s/iter; left time: 8051.7390s
	iters: 400, epoch: 26 | loss: 2.3025875
	speed: 0.2701s/iter; left time: 8259.3793s
Epoch: 26 cost time: 112.75022101402283
Epoch: 26, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 2.3056870
	speed: 0.5352s/iter; left time: 16302.3162s
	iters: 200, epoch: 27 | loss: 2.3012061
	speed: 0.2907s/iter; left time: 8826.6574s
	iters: 300, epoch: 27 | loss: 2.3016837
	speed: 0.2617s/iter; left time: 7919.6256s
	iters: 400, epoch: 27 | loss: 2.3031540
	speed: 0.2574s/iter; left time: 7763.9266s
Epoch: 27 cost time: 111.86673665046692
Epoch: 27, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 2.3026690
	speed: 0.5366s/iter; left time: 16123.6161s
	iters: 200, epoch: 28 | loss: 2.3006592
	speed: 0.2832s/iter; left time: 8480.7399s
	iters: 300, epoch: 28 | loss: 2.3053346
	speed: 0.2863s/iter; left time: 8545.3246s
	iters: 400, epoch: 28 | loss: 2.3023832
	speed: 0.2561s/iter; left time: 7617.9566s
Epoch: 28 cost time: 112.95854330062866
Epoch: 28, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.10004547521600728
model parameter : 12973066
model size : 69.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         47                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df512_ma47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0410887
	speed: 0.2988s/iter; left time: 12311.0338s
	iters: 200, epoch: 1 | loss: 0.2448975
	speed: 0.3075s/iter; left time: 12637.0386s
	iters: 300, epoch: 1 | loss: 0.1551268
	speed: 0.2829s/iter; left time: 11598.1083s
	iters: 400, epoch: 1 | loss: 0.1337394
	speed: 0.2919s/iter; left time: 11938.6018s
Epoch: 1 cost time: 122.56205439567566
Epoch: 1, Steps: 413 | Train Loss: 0.342 Vali Loss: 0.142 Vali Acc: 0.966 Test Loss: 0.142 Test Acc: 0.966
Validation loss decreased (inf --> -0.965892).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0001685
	speed: 0.5813s/iter; left time: 23710.3101s
	iters: 200, epoch: 2 | loss: 0.0049967
	speed: 0.3062s/iter; left time: 12460.5041s
	iters: 300, epoch: 2 | loss: 0.0019121
	speed: 0.2861s/iter; left time: 11613.5088s
	iters: 400, epoch: 2 | loss: 0.3828335
	speed: 0.3083s/iter; left time: 12484.0551s
Epoch: 2 cost time: 123.97709560394287
Epoch: 2, Steps: 413 | Train Loss: 0.236 Vali Loss: 0.217 Vali Acc: 0.972 Test Loss: 0.217 Test Acc: 0.972
Validation loss decreased (-0.965892 --> -0.971803).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3395718
	speed: 0.5678s/iter; left time: 22924.1256s
	iters: 200, epoch: 3 | loss: 0.0004412
	speed: 0.3038s/iter; left time: 12234.1396s
	iters: 300, epoch: 3 | loss: 2.8542738
	speed: 0.2675s/iter; left time: 10747.3321s
	iters: 400, epoch: 3 | loss: 0.0335882
	speed: 0.2902s/iter; left time: 11629.8264s
Epoch: 3 cost time: 119.71205258369446
Epoch: 3, Steps: 413 | Train Loss: 0.288 Vali Loss: 0.381 Vali Acc: 0.956 Test Loss: 0.381 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.3459170
	speed: 0.5682s/iter; left time: 22705.1323s
	iters: 200, epoch: 4 | loss: 1.0896165
	speed: 0.2991s/iter; left time: 11923.9815s
	iters: 300, epoch: 4 | loss: 0.2653748
	speed: 0.2744s/iter; left time: 10909.2843s
	iters: 400, epoch: 4 | loss: 0.0000198
	speed: 0.3121s/iter; left time: 12379.8005s
Epoch: 4 cost time: 121.92872714996338
Epoch: 4, Steps: 413 | Train Loss: 0.322 Vali Loss: 0.730 Vali Acc: 0.918 Test Loss: 0.730 Test Acc: 0.918
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0150256
	speed: 0.5429s/iter; left time: 21470.0508s
	iters: 200, epoch: 5 | loss: 0.9204054
	speed: 0.3007s/iter; left time: 11862.0699s
	iters: 300, epoch: 5 | loss: 0.0000078
	speed: 0.2716s/iter; left time: 10686.9750s
	iters: 400, epoch: 5 | loss: 0.0964661
	speed: 0.2907s/iter; left time: 11407.9667s
Epoch: 5 cost time: 116.62188816070557
Epoch: 5, Steps: 413 | Train Loss: 0.346 Vali Loss: 0.540 Vali Acc: 0.938 Test Loss: 0.540 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0858939
	speed: 0.5550s/iter; left time: 21722.1426s
	iters: 200, epoch: 6 | loss: 0.1409743
	speed: 0.2948s/iter; left time: 11507.9228s
	iters: 300, epoch: 6 | loss: 0.0100221
	speed: 0.2914s/iter; left time: 11346.1493s
	iters: 400, epoch: 6 | loss: 0.0001187
	speed: 0.2804s/iter; left time: 10890.8119s
Epoch: 6 cost time: 119.19229197502136
Epoch: 6, Steps: 413 | Train Loss: 0.352 Vali Loss: 0.373 Vali Acc: 0.967 Test Loss: 0.373 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0001575
	speed: 0.5431s/iter; left time: 21030.8921s
	iters: 200, epoch: 7 | loss: 0.0000269
	speed: 0.2731s/iter; left time: 10547.0037s
	iters: 300, epoch: 7 | loss: 0.0004022
	speed: 0.2838s/iter; left time: 10931.3818s
	iters: 400, epoch: 7 | loss: 1.0036122
	speed: 0.2888s/iter; left time: 11096.3399s
Epoch: 7 cost time: 116.25675344467163
Epoch: 7, Steps: 413 | Train Loss: 0.269 Vali Loss: 0.483 Vali Acc: 0.955 Test Loss: 0.483 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0000001
	speed: 0.5470s/iter; left time: 20955.5815s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.2574s/iter; left time: 9836.8697s
	iters: 300, epoch: 8 | loss: 0.0000088
	speed: 0.3020s/iter; left time: 11508.0773s
	iters: 400, epoch: 8 | loss: 0.0003248
	speed: 0.2966s/iter; left time: 11274.4947s
Epoch: 8 cost time: 118.58138465881348
Epoch: 8, Steps: 413 | Train Loss: 0.287 Vali Loss: 0.231 Vali Acc: 0.975 Test Loss: 0.231 Test Acc: 0.975
Validation loss decreased (-0.971803 --> -0.974986).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000010
	speed: 0.5245s/iter; left time: 19878.7375s
	iters: 200, epoch: 9 | loss: 0.1065754
	speed: 0.2532s/iter; left time: 9568.4621s
	iters: 300, epoch: 9 | loss: 0.0033126
	speed: 0.2535s/iter; left time: 9557.2340s
	iters: 400, epoch: 9 | loss: 0.0024199
	speed: 0.2718s/iter; left time: 10218.9725s
Epoch: 9 cost time: 107.3249876499176
Epoch: 9, Steps: 413 | Train Loss: 0.182 Vali Loss: 0.793 Vali Acc: 0.950 Test Loss: 0.793 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000001
	speed: 0.5541s/iter; left time: 20771.1723s
	iters: 200, epoch: 10 | loss: 0.7103087
	speed: 0.2881s/iter; left time: 10769.7018s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.2741s/iter; left time: 10221.0408s
	iters: 400, epoch: 10 | loss: 0.0000707
	speed: 0.2737s/iter; left time: 10178.7822s
Epoch: 10 cost time: 114.91846108436584
Epoch: 10, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.463 Vali Acc: 0.962 Test Loss: 0.463 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0004493
	speed: 0.5754s/iter; left time: 21331.2430s
	iters: 200, epoch: 11 | loss: 0.0000429
	speed: 0.2838s/iter; left time: 10493.4516s
	iters: 300, epoch: 11 | loss: 1.6734508
	speed: 0.2595s/iter; left time: 9568.1246s
	iters: 400, epoch: 11 | loss: 0.0000008
	speed: 0.2510s/iter; left time: 9228.7333s
Epoch: 11 cost time: 113.3018798828125
Epoch: 11, Steps: 413 | Train Loss: 0.164 Vali Loss: 0.747 Vali Acc: 0.942 Test Loss: 0.747 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.9884003
	speed: 0.5307s/iter; left time: 19454.0435s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.2901s/iter; left time: 10606.1180s
	iters: 300, epoch: 12 | loss: 0.6919586
	speed: 0.3074s/iter; left time: 11207.5160s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.2956s/iter; left time: 10747.0272s
Epoch: 12 cost time: 120.90447902679443
Epoch: 12, Steps: 413 | Train Loss: 0.185 Vali Loss: 0.753 Vali Acc: 0.949 Test Loss: 0.753 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.5562s/iter; left time: 20160.3150s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.2865s/iter; left time: 10356.8055s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.2668s/iter; left time: 9617.0770s
	iters: 400, epoch: 13 | loss: 0.8608905
	speed: 0.2707s/iter; left time: 9731.4281s
Epoch: 13 cost time: 114.69753241539001
Epoch: 13, Steps: 413 | Train Loss: 0.160 Vali Loss: 0.393 Vali Acc: 0.973 Test Loss: 0.393 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 2.0017760
	speed: 0.5652s/iter; left time: 20252.2318s
	iters: 200, epoch: 14 | loss: 0.0000626
	speed: 0.2790s/iter; left time: 9969.9908s
	iters: 300, epoch: 14 | loss: 0.0002255
	speed: 0.2767s/iter; left time: 9858.3794s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.2749s/iter; left time: 9766.3791s
Epoch: 14 cost time: 117.29778122901917
Epoch: 14, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.281 Vali Acc: 0.969 Test Loss: 0.281 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.5753s/iter; left time: 20376.7255s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.2746s/iter; left time: 9699.2163s
	iters: 300, epoch: 15 | loss: 0.0000004
	speed: 0.2650s/iter; left time: 9333.6296s
	iters: 400, epoch: 15 | loss: 0.0449117
	speed: 0.2380s/iter; left time: 8357.1523s
Epoch: 15 cost time: 110.75775027275085
Epoch: 15, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.463 Vali Acc: 0.967 Test Loss: 0.463 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.5234s/iter; left time: 18321.9546s
	iters: 200, epoch: 16 | loss: 0.0000101
	speed: 0.2924s/iter; left time: 10208.0746s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.2709s/iter; left time: 9428.1437s
	iters: 400, epoch: 16 | loss: 0.0000012
	speed: 0.2684s/iter; left time: 9314.4171s
Epoch: 16 cost time: 113.89439606666565
Epoch: 16, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.368 Vali Acc: 0.971 Test Loss: 0.368 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.5541s/iter; left time: 19169.4465s
	iters: 200, epoch: 17 | loss: 0.0000005
	speed: 0.2783s/iter; left time: 9598.4484s
	iters: 300, epoch: 17 | loss: 0.0000424
	speed: 0.2860s/iter; left time: 9835.1271s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.2678s/iter; left time: 9183.8601s
Epoch: 17 cost time: 115.81629085540771
Epoch: 17, Steps: 413 | Train Loss: 0.110 Vali Loss: 0.397 Vali Acc: 0.973 Test Loss: 0.397 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.3700805
	speed: 0.5295s/iter; left time: 18099.2874s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.2707s/iter; left time: 9226.2790s
	iters: 300, epoch: 18 | loss: 0.0001046
	speed: 0.2756s/iter; left time: 9363.4461s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.3025s/iter; left time: 10250.1940s
Epoch: 18 cost time: 117.0428831577301
Epoch: 18, Steps: 413 | Train Loss: 0.114 Vali Loss: 0.766 Vali Acc: 0.950 Test Loss: 0.766 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df512_ma47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9749886311959982
model parameter : 11400202
model size : 63.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         38                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df512_ma38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0583640
	speed: 0.2950s/iter; left time: 12152.5313s
	iters: 200, epoch: 1 | loss: 0.3761558
	speed: 0.2623s/iter; left time: 10779.5642s
	iters: 300, epoch: 1 | loss: 0.1439050
	speed: 0.2786s/iter; left time: 11424.2850s
	iters: 400, epoch: 1 | loss: 0.1533573
	speed: 0.2821s/iter; left time: 11539.0197s
Epoch: 1 cost time: 115.68414282798767
Epoch: 1, Steps: 413 | Train Loss: 0.356 Vali Loss: 0.172 Vali Acc: 0.956 Test Loss: 0.172 Test Acc: 0.956
Validation loss decreased (inf --> -0.956342).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0085532
	speed: 0.5094s/iter; left time: 20776.2583s
	iters: 200, epoch: 2 | loss: 0.0388198
	speed: 0.2337s/iter; left time: 9509.2918s
	iters: 300, epoch: 2 | loss: 0.2356333
	speed: 0.2703s/iter; left time: 10969.9608s
	iters: 400, epoch: 2 | loss: 0.3653716
	speed: 0.2835s/iter; left time: 11480.3386s
Epoch: 2 cost time: 107.9220757484436
Epoch: 2, Steps: 413 | Train Loss: 0.223 Vali Loss: 0.351 Vali Acc: 0.945 Test Loss: 0.351 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0000061
	speed: 0.5601s/iter; left time: 22614.9016s
	iters: 200, epoch: 3 | loss: 0.4088043
	speed: 0.2637s/iter; left time: 10619.0259s
	iters: 300, epoch: 3 | loss: 0.0026651
	speed: 0.2551s/iter; left time: 10247.9937s
	iters: 400, epoch: 3 | loss: 0.0027061
	speed: 0.2528s/iter; left time: 10130.5328s
Epoch: 3 cost time: 109.69454026222229
Epoch: 3, Steps: 413 | Train Loss: 0.295 Vali Loss: 0.234 Vali Acc: 0.961 Test Loss: 0.234 Test Acc: 0.961
Validation loss decreased (-0.956342 --> -0.960889).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7911842
	speed: 0.5321s/iter; left time: 21263.6487s
	iters: 200, epoch: 4 | loss: 0.0340436
	speed: 0.2618s/iter; left time: 10433.9097s
	iters: 300, epoch: 4 | loss: 0.0060091
	speed: 0.2574s/iter; left time: 10233.2580s
	iters: 400, epoch: 4 | loss: 0.0002065
	speed: 0.2693s/iter; left time: 10680.8122s
Epoch: 4 cost time: 108.77984428405762
Epoch: 4, Steps: 413 | Train Loss: 0.386 Vali Loss: 0.230 Vali Acc: 0.971 Test Loss: 0.230 Test Acc: 0.971
Validation loss decreased (-0.960889 --> -0.970894).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.1938107
	speed: 0.5279s/iter; left time: 20878.6755s
	iters: 200, epoch: 5 | loss: 0.2251604
	speed: 0.2653s/iter; left time: 10464.2621s
	iters: 300, epoch: 5 | loss: 0.0000008
	speed: 0.2725s/iter; left time: 10721.8824s
	iters: 400, epoch: 5 | loss: 0.0449838
	speed: 0.2983s/iter; left time: 11706.4936s
Epoch: 5 cost time: 113.37347173690796
Epoch: 5, Steps: 413 | Train Loss: 0.397 Vali Loss: 1.000 Vali Acc: 0.920 Test Loss: 1.000 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0033398
	speed: 0.5376s/iter; left time: 21038.9257s
	iters: 200, epoch: 6 | loss: 0.0055109
	speed: 0.2467s/iter; left time: 9630.9713s
	iters: 300, epoch: 6 | loss: 0.0000181
	speed: 0.2644s/iter; left time: 10293.0255s
	iters: 400, epoch: 6 | loss: 1.0024240
	speed: 0.2843s/iter; left time: 11041.2073s
Epoch: 6 cost time: 110.44921875
Epoch: 6, Steps: 413 | Train Loss: 0.301 Vali Loss: 0.482 Vali Acc: 0.954 Test Loss: 0.482 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0096240
	speed: 0.5375s/iter; left time: 20814.0625s
	iters: 200, epoch: 7 | loss: 0.0016823
	speed: 0.2534s/iter; left time: 9787.9274s
	iters: 300, epoch: 7 | loss: 0.0006700
	speed: 0.2540s/iter; left time: 9785.8021s
	iters: 400, epoch: 7 | loss: 0.6845475
	speed: 0.2671s/iter; left time: 10263.3501s
Epoch: 7 cost time: 108.58156251907349
Epoch: 7, Steps: 413 | Train Loss: 0.263 Vali Loss: 0.852 Vali Acc: 0.935 Test Loss: 0.852 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.6875529
	speed: 0.5771s/iter; left time: 22110.3286s
	iters: 200, epoch: 8 | loss: 0.2068319
	speed: 0.2779s/iter; left time: 10617.7820s
	iters: 300, epoch: 8 | loss: 0.0000161
	speed: 0.2538s/iter; left time: 9673.1817s
	iters: 400, epoch: 8 | loss: 0.0008066
	speed: 0.2599s/iter; left time: 9878.2189s
Epoch: 8 cost time: 112.34570527076721
Epoch: 8, Steps: 413 | Train Loss: 0.273 Vali Loss: 0.683 Vali Acc: 0.953 Test Loss: 0.683 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000002
	speed: 0.5062s/iter; left time: 19182.8255s
	iters: 200, epoch: 9 | loss: 0.0000002
	speed: 0.3058s/iter; left time: 11556.8588s
	iters: 300, epoch: 9 | loss: 0.0265355
	speed: 0.2795s/iter; left time: 10537.0161s
	iters: 400, epoch: 9 | loss: 0.8711820
	speed: 0.2556s/iter; left time: 9610.9154s
Epoch: 9 cost time: 115.18543910980225
Epoch: 9, Steps: 413 | Train Loss: 0.196 Vali Loss: 0.425 Vali Acc: 0.958 Test Loss: 0.425 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0071261
	speed: 0.5143s/iter; left time: 19278.5649s
	iters: 200, epoch: 10 | loss: 0.0000114
	speed: 0.2746s/iter; left time: 10263.9081s
	iters: 300, epoch: 10 | loss: 0.0137504
	speed: 0.2660s/iter; left time: 9918.8869s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.2851s/iter; left time: 10600.3517s
Epoch: 10 cost time: 112.84658217430115
Epoch: 10, Steps: 413 | Train Loss: 0.162 Vali Loss: 0.642 Vali Acc: 0.953 Test Loss: 0.642 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000002
	speed: 0.4819s/iter; left time: 17866.0656s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.2639s/iter; left time: 9757.7993s
	iters: 300, epoch: 11 | loss: 0.0010794
	speed: 0.2674s/iter; left time: 9858.6566s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.2851s/iter; left time: 10483.8814s
Epoch: 11 cost time: 109.73495125770569
Epoch: 11, Steps: 413 | Train Loss: 0.127 Vali Loss: 0.873 Vali Acc: 0.945 Test Loss: 0.873 Test Acc: 0.945
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.5404s/iter; left time: 19809.5713s
	iters: 200, epoch: 12 | loss: 0.0590950
	speed: 0.2720s/iter; left time: 9945.1146s
	iters: 300, epoch: 12 | loss: 0.0011994
	speed: 0.2715s/iter; left time: 9897.1598s
	iters: 400, epoch: 12 | loss: 0.0000001
	speed: 0.2801s/iter; left time: 10182.8092s
Epoch: 12 cost time: 112.76073861122131
Epoch: 12, Steps: 413 | Train Loss: 0.188 Vali Loss: 0.377 Vali Acc: 0.961 Test Loss: 0.377 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.4166094
	speed: 0.5102s/iter; left time: 18493.2476s
	iters: 200, epoch: 13 | loss: 0.6426100
	speed: 0.2369s/iter; left time: 8563.4220s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.2612s/iter; left time: 9413.1969s
	iters: 400, epoch: 13 | loss: 1.4606967
	speed: 0.2910s/iter; left time: 10458.3710s
Epoch: 13 cost time: 107.71335172653198
Epoch: 13, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.674 Vali Acc: 0.959 Test Loss: 0.674 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000119
	speed: 0.5454s/iter; left time: 19543.0105s
	iters: 200, epoch: 14 | loss: 0.0892527
	speed: 0.2735s/iter; left time: 9772.4324s
	iters: 300, epoch: 14 | loss: 0.0000002
	speed: 0.2715s/iter; left time: 9675.4501s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.2825s/iter; left time: 10036.0350s
Epoch: 14 cost time: 113.61848306655884
Epoch: 14, Steps: 413 | Train Loss: 0.109 Vali Loss: 0.270 Vali Acc: 0.970 Test Loss: 0.270 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df512_ma38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9708958617553434
model parameter : 11400202
model size : 63.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         28                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df512_ma28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1544345
	speed: 0.2731s/iter; left time: 11252.8230s
	iters: 200, epoch: 1 | loss: 0.2689450
	speed: 0.2676s/iter; left time: 10997.1396s
	iters: 300, epoch: 1 | loss: 0.0723397
	speed: 0.2840s/iter; left time: 11644.8537s
	iters: 400, epoch: 1 | loss: 0.0285323
	speed: 0.2667s/iter; left time: 10908.5445s
Epoch: 1 cost time: 112.72426509857178
Epoch: 1, Steps: 413 | Train Loss: 0.384 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
Validation loss decreased (inf --> -0.965438).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0470445
	speed: 0.5457s/iter; left time: 22259.9055s
	iters: 200, epoch: 2 | loss: 0.1499121
	speed: 0.2841s/iter; left time: 11560.0831s
	iters: 300, epoch: 2 | loss: 0.0396365
	speed: 0.2959s/iter; left time: 12010.3678s
	iters: 400, epoch: 2 | loss: 0.7407686
	speed: 0.2919s/iter; left time: 11818.9732s
Epoch: 2 cost time: 119.52887082099915
Epoch: 2, Steps: 413 | Train Loss: 0.198 Vali Loss: 0.190 Vali Acc: 0.962 Test Loss: 0.190 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0321124
	speed: 0.5234s/iter; left time: 21133.9102s
	iters: 200, epoch: 3 | loss: 0.1714589
	speed: 0.2728s/iter; left time: 10987.8379s
	iters: 300, epoch: 3 | loss: 1.8226870
	speed: 0.2762s/iter; left time: 11096.1404s
	iters: 400, epoch: 3 | loss: 0.1143993
	speed: 0.2473s/iter; left time: 9909.0575s
Epoch: 3 cost time: 109.78871011734009
Epoch: 3, Steps: 413 | Train Loss: 0.342 Vali Loss: 0.391 Vali Acc: 0.941 Test Loss: 0.391 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.3707713
	speed: 0.5007s/iter; left time: 20007.7008s
	iters: 200, epoch: 4 | loss: 1.1355764
	speed: 0.2832s/iter; left time: 11288.5505s
	iters: 300, epoch: 4 | loss: 0.4936868
	speed: 0.2751s/iter; left time: 10937.3147s
	iters: 400, epoch: 4 | loss: 0.0000062
	speed: 0.2734s/iter; left time: 10844.9452s
Epoch: 4 cost time: 113.77843976020813
Epoch: 4, Steps: 413 | Train Loss: 0.361 Vali Loss: 0.703 Vali Acc: 0.927 Test Loss: 0.703 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.5174422
	speed: 0.5209s/iter; left time: 20601.9425s
	iters: 200, epoch: 5 | loss: 0.1859081
	speed: 0.2679s/iter; left time: 10568.4653s
	iters: 300, epoch: 5 | loss: 0.0000412
	speed: 0.2647s/iter; left time: 10416.0637s
	iters: 400, epoch: 5 | loss: 0.0010059
	speed: 0.2656s/iter; left time: 10425.7146s
Epoch: 5 cost time: 109.56902074813843
Epoch: 5, Steps: 413 | Train Loss: 0.328 Vali Loss: 0.471 Vali Acc: 0.941 Test Loss: 0.471 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0000782
	speed: 0.5121s/iter; left time: 20041.7523s
	iters: 200, epoch: 6 | loss: 0.0000122
	speed: 0.2761s/iter; left time: 10779.7727s
	iters: 300, epoch: 6 | loss: 0.0000549
	speed: 0.2727s/iter; left time: 10618.9586s
	iters: 400, epoch: 6 | loss: 0.0002223
	speed: 0.2613s/iter; left time: 10146.9041s
Epoch: 6 cost time: 110.99526047706604
Epoch: 6, Steps: 413 | Train Loss: 0.300 Vali Loss: 0.221 Vali Acc: 0.970 Test Loss: 0.221 Test Acc: 0.970
Validation loss decreased (-0.965438 --> -0.970439).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0011240
	speed: 0.5134s/iter; left time: 19880.3060s
	iters: 200, epoch: 7 | loss: 0.0035633
	speed: 0.2770s/iter; left time: 10699.8095s
	iters: 300, epoch: 7 | loss: 0.0000042
	speed: 0.2764s/iter; left time: 10648.4728s
	iters: 400, epoch: 7 | loss: 0.0105247
	speed: 0.2680s/iter; left time: 10295.7179s
Epoch: 7 cost time: 112.00547194480896
Epoch: 7, Steps: 413 | Train Loss: 0.258 Vali Loss: 0.350 Vali Acc: 0.969 Test Loss: 0.350 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.2275906
	speed: 0.4978s/iter; left time: 19071.9068s
	iters: 200, epoch: 8 | loss: 0.7321526
	speed: 0.2719s/iter; left time: 10389.8371s
	iters: 300, epoch: 8 | loss: 0.0000012
	speed: 0.2753s/iter; left time: 10492.0852s
	iters: 400, epoch: 8 | loss: 0.0001925
	speed: 0.2703s/iter; left time: 10273.5234s
Epoch: 8 cost time: 110.20117521286011
Epoch: 8, Steps: 413 | Train Loss: 0.259 Vali Loss: 0.542 Vali Acc: 0.948 Test Loss: 0.542 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.5358s/iter; left time: 20306.0193s
	iters: 200, epoch: 9 | loss: 0.0016627
	speed: 0.2756s/iter; left time: 10415.8988s
	iters: 300, epoch: 9 | loss: 1.0010792
	speed: 0.2733s/iter; left time: 10302.1770s
	iters: 400, epoch: 9 | loss: 0.0078216
	speed: 0.2483s/iter; left time: 9335.2472s
Epoch: 9 cost time: 110.41017079353333
Epoch: 9, Steps: 413 | Train Loss: 0.163 Vali Loss: 0.692 Vali Acc: 0.945 Test Loss: 0.692 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000532
	speed: 0.5005s/iter; left time: 18762.1242s
	iters: 200, epoch: 10 | loss: 0.0000095
	speed: 0.2680s/iter; left time: 10017.5649s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.2731s/iter; left time: 10180.9001s
	iters: 400, epoch: 10 | loss: 1.4543664
	speed: 0.2589s/iter; left time: 9628.1601s
Epoch: 10 cost time: 109.48375844955444
Epoch: 10, Steps: 413 | Train Loss: 0.150 Vali Loss: 1.149 Vali Acc: 0.927 Test Loss: 1.149 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000180
	speed: 0.4907s/iter; left time: 18191.6159s
	iters: 200, epoch: 11 | loss: 0.0000003
	speed: 0.2615s/iter; left time: 9666.7795s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.2758s/iter; left time: 10170.5653s
	iters: 400, epoch: 11 | loss: 0.0053439
	speed: 0.2732s/iter; left time: 10045.0219s
Epoch: 11 cost time: 110.22691106796265
Epoch: 11, Steps: 413 | Train Loss: 0.184 Vali Loss: 0.327 Vali Acc: 0.973 Test Loss: 0.327 Test Acc: 0.973
Validation loss decreased (-0.970439 --> -0.972712).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.5126s/iter; left time: 18789.6757s
	iters: 200, epoch: 12 | loss: 0.0463803
	speed: 0.2609s/iter; left time: 9536.6651s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.2640s/iter; left time: 9623.4872s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.2618s/iter; left time: 9517.6116s
Epoch: 12 cost time: 107.69599986076355
Epoch: 12, Steps: 413 | Train Loss: 0.165 Vali Loss: 0.230 Vali Acc: 0.978 Test Loss: 0.230 Test Acc: 0.978
Validation loss decreased (-0.972712 --> -0.978170).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.5208s/iter; left time: 18877.0927s
	iters: 200, epoch: 13 | loss: 0.0000001
	speed: 0.2578s/iter; left time: 9318.3994s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.2778s/iter; left time: 10013.2388s
	iters: 400, epoch: 13 | loss: 0.8574041
	speed: 0.2840s/iter; left time: 10209.5828s
Epoch: 13 cost time: 112.1503427028656
Epoch: 13, Steps: 413 | Train Loss: 0.141 Vali Loss: 0.400 Vali Acc: 0.963 Test Loss: 0.400 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.5218s/iter; left time: 18696.5430s
	iters: 200, epoch: 14 | loss: 0.0029657
	speed: 0.2713s/iter; left time: 9694.0843s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.2746s/iter; left time: 9783.4686s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.2687s/iter; left time: 9546.4359s
Epoch: 14 cost time: 111.75144028663635
Epoch: 14, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.323 Vali Acc: 0.972 Test Loss: 0.323 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.4899s/iter; left time: 17350.3505s
	iters: 200, epoch: 15 | loss: 0.0000294
	speed: 0.2737s/iter; left time: 9667.1600s
	iters: 300, epoch: 15 | loss: 0.0000001
	speed: 0.2844s/iter; left time: 10018.0058s
	iters: 400, epoch: 15 | loss: 0.6932374
	speed: 0.2760s/iter; left time: 9692.5183s
Epoch: 15 cost time: 112.50120782852173
Epoch: 15, Steps: 413 | Train Loss: 0.164 Vali Loss: 0.246 Vali Acc: 0.979 Test Loss: 0.246 Test Acc: 0.979
Validation loss decreased (-0.978170 --> -0.978624).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.5346s/iter; left time: 18715.5350s
	iters: 200, epoch: 16 | loss: 0.4783750
	speed: 0.2556s/iter; left time: 8920.3326s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.2681s/iter; left time: 9331.2408s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.2715s/iter; left time: 9422.8132s
Epoch: 16 cost time: 110.38949584960938
Epoch: 16, Steps: 413 | Train Loss: 0.102 Vali Loss: 0.229 Vali Acc: 0.975 Test Loss: 0.229 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.5104s/iter; left time: 17656.4203s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.2662s/iter; left time: 9182.7997s
	iters: 300, epoch: 17 | loss: 0.2361359
	speed: 0.2672s/iter; left time: 9190.6255s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.2722s/iter; left time: 9335.0612s
Epoch: 17 cost time: 110.47250962257385
Epoch: 17, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.474 Vali Acc: 0.966 Test Loss: 0.474 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000799
	speed: 0.5614s/iter; left time: 19188.7206s
	iters: 200, epoch: 18 | loss: 0.6266521
	speed: 0.2594s/iter; left time: 8839.6316s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.2743s/iter; left time: 9322.3522s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.2691s/iter; left time: 9115.7713s
Epoch: 18 cost time: 113.91937828063965
Epoch: 18, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.278 Vali Acc: 0.978 Test Loss: 0.278 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.5099s/iter; left time: 17216.5666s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.2598s/iter; left time: 8745.4754s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.2584s/iter; left time: 8674.6088s
	iters: 400, epoch: 19 | loss: 1.8595412
	speed: 0.2638s/iter; left time: 8829.5048s
Epoch: 19 cost time: 107.16465044021606
Epoch: 19, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.281 Vali Acc: 0.975 Test Loss: 0.281 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000135
	speed: 0.5202s/iter; left time: 17349.4275s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.2637s/iter; left time: 8770.2572s
	iters: 300, epoch: 20 | loss: 0.0000007
	speed: 0.2796s/iter; left time: 9269.2209s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.2647s/iter; left time: 8747.9254s
Epoch: 20 cost time: 111.45075678825378
Epoch: 20, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.405 Vali Acc: 0.968 Test Loss: 0.405 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0000003
	speed: 0.5330s/iter; left time: 17556.6622s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.2735s/iter; left time: 8982.4349s
	iters: 300, epoch: 21 | loss: 0.0005135
	speed: 0.2559s/iter; left time: 8378.6397s
	iters: 400, epoch: 21 | loss: 0.0030277
	speed: 0.2637s/iter; left time: 8607.4212s
Epoch: 21 cost time: 110.82862687110901
Epoch: 21, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.340 Vali Acc: 0.977 Test Loss: 0.340 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.5208s/iter; left time: 16941.8125s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.2587s/iter; left time: 8387.8295s
	iters: 300, epoch: 22 | loss: 0.0000004
	speed: 0.2732s/iter; left time: 8830.6687s
	iters: 400, epoch: 22 | loss: 0.0174808
	speed: 0.2742s/iter; left time: 8838.2971s
Epoch: 22 cost time: 110.66270780563354
Epoch: 22, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.281 Vali Acc: 0.973 Test Loss: 0.281 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.5232s/iter; left time: 16801.8727s
	iters: 200, epoch: 23 | loss: 0.0539288
	speed: 0.2785s/iter; left time: 8916.7667s
	iters: 300, epoch: 23 | loss: 0.0000008
	speed: 0.2861s/iter; left time: 9131.6370s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.2739s/iter; left time: 8715.5119s
Epoch: 23 cost time: 114.5405068397522
Epoch: 23, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.298 Vali Acc: 0.975 Test Loss: 0.298 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0000001
	speed: 0.5176s/iter; left time: 16408.2226s
	iters: 200, epoch: 24 | loss: 0.0000455
	speed: 0.2719s/iter; left time: 8591.5967s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.2699s/iter; left time: 8501.5707s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.2653s/iter; left time: 8332.4650s
Epoch: 24 cost time: 111.568430185318
Epoch: 24, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.269 Vali Acc: 0.980 Test Loss: 0.269 Test Acc: 0.980
Validation loss decreased (-0.978624 --> -0.979988).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0069263
	speed: 0.5568s/iter; left time: 17422.2426s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.2953s/iter; left time: 9209.9404s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.2892s/iter; left time: 8990.4538s
	iters: 400, epoch: 25 | loss: 0.1750180
	speed: 0.2920s/iter; left time: 9047.6419s
Epoch: 25 cost time: 119.48027205467224
Epoch: 25, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.298 Vali Acc: 0.973 Test Loss: 0.298 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.5178s/iter; left time: 15988.6352s
	iters: 200, epoch: 26 | loss: 0.0000001
	speed: 0.2868s/iter; left time: 8826.3512s
	iters: 300, epoch: 26 | loss: 0.3624779
	speed: 0.2869s/iter; left time: 8799.6736s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.2744s/iter; left time: 8389.3155s
Epoch: 26 cost time: 115.10959601402283
Epoch: 26, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.377 Vali Acc: 0.972 Test Loss: 0.377 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0000091
	speed: 0.5586s/iter; left time: 17017.7957s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.2876s/iter; left time: 8731.4468s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.2829s/iter; left time: 8561.7247s
	iters: 400, epoch: 27 | loss: 0.0000020
	speed: 0.2714s/iter; left time: 8186.7654s
Epoch: 27 cost time: 118.14769554138184
Epoch: 27, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.173 Vali Acc: 0.986 Test Loss: 0.173 Test Acc: 0.986
Validation loss decreased (-0.979988 --> -0.985901).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.5495s/iter; left time: 16512.1132s
	iters: 200, epoch: 28 | loss: 0.8218819
	speed: 0.2802s/iter; left time: 8392.6531s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.2871s/iter; left time: 8568.8208s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.2931s/iter; left time: 8718.9426s
Epoch: 28 cost time: 117.49551129341125
Epoch: 28, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 1.0510786
	speed: 0.5252s/iter; left time: 15565.7354s
	iters: 200, epoch: 29 | loss: 0.0000457
	speed: 0.2941s/iter; left time: 8685.4805s
	iters: 300, epoch: 29 | loss: 0.0010278
	speed: 0.2909s/iter; left time: 8562.2308s
	iters: 400, epoch: 29 | loss: 0.0000030
	speed: 0.2757s/iter; left time: 8088.0465s
Epoch: 29 cost time: 117.40759491920471
Epoch: 29, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.208 Vali Acc: 0.979 Test Loss: 0.208 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.5540s/iter; left time: 16189.9850s
	iters: 200, epoch: 30 | loss: 0.0000037
	speed: 0.2709s/iter; left time: 7890.3990s
	iters: 300, epoch: 30 | loss: 0.0000001
	speed: 0.2560s/iter; left time: 7431.3908s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.2885s/iter; left time: 8345.4700s
Epoch: 30 cost time: 114.41514730453491
Epoch: 30, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.176 Vali Acc: 0.980 Test Loss: 0.176 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.5471s/iter; left time: 15761.7955s
	iters: 200, epoch: 31 | loss: 0.0016942
	speed: 0.2814s/iter; left time: 8079.9758s
	iters: 300, epoch: 31 | loss: 0.0000468
	speed: 0.3039s/iter; left time: 8694.9919s
	iters: 400, epoch: 31 | loss: 0.0020188
	speed: 0.2753s/iter; left time: 7848.4938s
Epoch: 31 cost time: 116.93503713607788
Epoch: 31, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.211 Vali Acc: 0.978 Test Loss: 0.211 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.0000009
	speed: 0.5443s/iter; left time: 15457.1865s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.3031s/iter; left time: 8576.4311s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.2745s/iter; left time: 7740.4991s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.2562s/iter; left time: 7198.1251s
Epoch: 32 cost time: 115.79870057106018
Epoch: 32, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.142 Vali Acc: 0.982 Test Loss: 0.142 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.5561s/iter; left time: 15562.0387s
	iters: 200, epoch: 33 | loss: 0.0000059
	speed: 0.2695s/iter; left time: 7514.3156s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.2961s/iter; left time: 8227.3701s
	iters: 400, epoch: 33 | loss: 0.0000001
	speed: 0.2963s/iter; left time: 8203.0395s
Epoch: 33 cost time: 117.93690657615662
Epoch: 33, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.134 Vali Acc: 0.980 Test Loss: 0.134 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.5117s/iter; left time: 14109.2097s
	iters: 200, epoch: 34 | loss: 0.0032108
	speed: 0.2861s/iter; left time: 7860.7713s
	iters: 300, epoch: 34 | loss: 0.3626120
	speed: 0.2724s/iter; left time: 7456.6519s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.2588s/iter; left time: 7056.8771s
Epoch: 34 cost time: 112.00179553031921
Epoch: 34, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.249 Vali Acc: 0.975 Test Loss: 0.249 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.5427s/iter; left time: 14739.9008s
	iters: 200, epoch: 35 | loss: 0.0011690
	speed: 0.2835s/iter; left time: 7672.0961s
	iters: 300, epoch: 35 | loss: 0.0000623
	speed: 0.2734s/iter; left time: 7369.8207s
	iters: 400, epoch: 35 | loss: 0.0000373
	speed: 0.2806s/iter; left time: 7535.5187s
Epoch: 35 cost time: 116.4815673828125
Epoch: 35, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.232 Vali Acc: 0.975 Test Loss: 0.232 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 0.0002136
	speed: 0.5713s/iter; left time: 15278.8446s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.2773s/iter; left time: 7388.2654s
	iters: 300, epoch: 36 | loss: 0.0000001
	speed: 0.2818s/iter; left time: 7480.7829s
	iters: 400, epoch: 36 | loss: 0.0001151
	speed: 0.2699s/iter; left time: 7137.5611s
Epoch: 36 cost time: 114.65799689292908
Epoch: 36, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.114 Vali Acc: 0.987 Test Loss: 0.114 Test Acc: 0.987
Validation loss decreased (-0.985901 --> -0.986811).  Saving model ...
	iters: 100, epoch: 37 | loss: 0.0000006
	speed: 0.5144s/iter; left time: 13544.4084s
	iters: 200, epoch: 37 | loss: 0.0000003
	speed: 0.2870s/iter; left time: 7529.8413s
	iters: 300, epoch: 37 | loss: 0.0000004
	speed: 0.2806s/iter; left time: 7332.4914s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.2749s/iter; left time: 7156.9610s
Epoch: 37 cost time: 114.2650158405304
Epoch: 37, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.228 Vali Acc: 0.976 Test Loss: 0.228 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 38 | loss: 0.0015776
	speed: 0.5570s/iter; left time: 14438.4141s
	iters: 200, epoch: 38 | loss: 0.0000007
	speed: 0.2820s/iter; left time: 7280.9759s
	iters: 300, epoch: 38 | loss: 0.0000008
	speed: 0.2705s/iter; left time: 6957.6645s
	iters: 400, epoch: 38 | loss: 0.0000008
	speed: 0.2932s/iter; left time: 7512.9463s
Epoch: 38 cost time: 117.31950902938843
Epoch: 38, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.132 Vali Acc: 0.980 Test Loss: 0.132 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 39 | loss: 0.0000000
	speed: 0.5506s/iter; left time: 14044.5228s
	iters: 200, epoch: 39 | loss: 0.0000011
	speed: 0.2672s/iter; left time: 6787.6505s
	iters: 300, epoch: 39 | loss: 0.0013056
	speed: 0.2802s/iter; left time: 7091.5066s
	iters: 400, epoch: 39 | loss: 0.0001238
	speed: 0.2677s/iter; left time: 6747.9186s
Epoch: 39 cost time: 112.80408787727356
Epoch: 39, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.117 Vali Acc: 0.981 Test Loss: 0.117 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 40 | loss: 0.0000001
	speed: 0.5507s/iter; left time: 13819.9599s
	iters: 200, epoch: 40 | loss: 0.0000032
	speed: 0.2770s/iter; left time: 6923.7470s
	iters: 300, epoch: 40 | loss: 0.0215291
	speed: 0.2960s/iter; left time: 7368.3183s
	iters: 400, epoch: 40 | loss: 0.0001939
	speed: 0.2728s/iter; left time: 6764.7694s
Epoch: 40 cost time: 116.26683378219604
Epoch: 40, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.114 Vali Acc: 0.979 Test Loss: 0.114 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 41 | loss: 0.0000002
	speed: 0.5324s/iter; left time: 13139.7515s
	iters: 200, epoch: 41 | loss: 0.0017903
	speed: 0.2789s/iter; left time: 6854.8144s
	iters: 300, epoch: 41 | loss: 0.0000000
	speed: 0.2908s/iter; left time: 7119.5124s
	iters: 400, epoch: 41 | loss: 0.0000004
	speed: 0.2718s/iter; left time: 6626.8706s
Epoch: 41 cost time: 115.17031860351562
Epoch: 41, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 42 | loss: 0.0000007
	speed: 0.5436s/iter; left time: 13190.8798s
	iters: 200, epoch: 42 | loss: 0.0000003
	speed: 0.2679s/iter; left time: 6473.6215s
	iters: 300, epoch: 42 | loss: 0.0000001
	speed: 0.2937s/iter; left time: 7068.2198s
	iters: 400, epoch: 42 | loss: 0.0000045
	speed: 0.2757s/iter; left time: 6608.9713s
Epoch: 42 cost time: 116.10205602645874
Epoch: 42, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.067 Vali Acc: 0.988 Test Loss: 0.067 Test Acc: 0.988
Validation loss decreased (-0.986811 --> -0.987721).  Saving model ...
	iters: 100, epoch: 43 | loss: 0.0000005
	speed: 0.5671s/iter; left time: 13528.3877s
	iters: 200, epoch: 43 | loss: 0.0000006
	speed: 0.3020s/iter; left time: 7174.9101s
	iters: 300, epoch: 43 | loss: 0.0000386
	speed: 0.2780s/iter; left time: 6575.9277s
	iters: 400, epoch: 43 | loss: 0.0001849
	speed: 0.2742s/iter; left time: 6457.6670s
Epoch: 43 cost time: 118.55748963356018
Epoch: 43, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.127 Vali Acc: 0.979 Test Loss: 0.127 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 44 | loss: 0.0000107
	speed: 0.5688s/iter; left time: 13334.9648s
	iters: 200, epoch: 44 | loss: 0.0000007
	speed: 0.2526s/iter; left time: 5895.6291s
	iters: 300, epoch: 44 | loss: 0.0000000
	speed: 0.2889s/iter; left time: 6714.6522s
	iters: 400, epoch: 44 | loss: 0.0000159
	speed: 0.2588s/iter; left time: 5988.6414s
Epoch: 44 cost time: 112.71900248527527
Epoch: 44, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 45 | loss: 0.0000000
	speed: 0.5576s/iter; left time: 12841.1695s
	iters: 200, epoch: 45 | loss: 0.0000000
	speed: 0.2829s/iter; left time: 6487.1187s
	iters: 300, epoch: 45 | loss: 0.0000026
	speed: 0.2902s/iter; left time: 6626.0498s
	iters: 400, epoch: 45 | loss: 0.2589473
	speed: 0.2859s/iter; left time: 6498.7042s
Epoch: 45 cost time: 118.83416867256165
Epoch: 45, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.202 Vali Acc: 0.963 Test Loss: 0.202 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 46 | loss: 0.0000652
	speed: 0.5409s/iter; left time: 12233.6901s
	iters: 200, epoch: 46 | loss: 0.0003553
	speed: 0.2442s/iter; left time: 5497.3827s
	iters: 300, epoch: 46 | loss: 0.0000136
	speed: 0.2753s/iter; left time: 6170.2131s
	iters: 400, epoch: 46 | loss: 0.8094476
	speed: 0.2901s/iter; left time: 6473.5207s
Epoch: 46 cost time: 112.01378560066223
Epoch: 46, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 47 | loss: 0.0000059
	speed: 0.5634s/iter; left time: 12508.5681s
	iters: 200, epoch: 47 | loss: 0.0000362
	speed: 0.2936s/iter; left time: 6489.4116s
	iters: 300, epoch: 47 | loss: 0.0010321
	speed: 0.2905s/iter; left time: 6391.7505s
	iters: 400, epoch: 47 | loss: 0.0000000
	speed: 0.2720s/iter; left time: 5957.7153s
Epoch: 47 cost time: 119.2152988910675
Epoch: 47, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.041 Vali Acc: 0.990 Test Loss: 0.041 Test Acc: 0.990
Validation loss decreased (-0.987721 --> -0.989995).  Saving model ...
	iters: 100, epoch: 48 | loss: 0.0008366
	speed: 0.5644s/iter; left time: 12297.2459s
	iters: 200, epoch: 48 | loss: 0.0000019
	speed: 0.2720s/iter; left time: 5899.7526s
	iters: 300, epoch: 48 | loss: 0.0011606
	speed: 0.2928s/iter; left time: 6321.2610s
	iters: 400, epoch: 48 | loss: 0.0015806
	speed: 0.2685s/iter; left time: 5770.7974s
Epoch: 48 cost time: 116.99036073684692
Epoch: 48, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.054 Vali Acc: 0.986 Test Loss: 0.054 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 49 | loss: 0.0001073
	speed: 0.5436s/iter; left time: 11620.4593s
	iters: 200, epoch: 49 | loss: 0.0001220
	speed: 0.2670s/iter; left time: 5681.5230s
	iters: 300, epoch: 49 | loss: 0.0000776
	speed: 0.2914s/iter; left time: 6170.1525s
	iters: 400, epoch: 49 | loss: 0.0133296
	speed: 0.2925s/iter; left time: 6164.0321s
Epoch: 49 cost time: 117.78541207313538
Epoch: 49, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.052 Vali Acc: 0.985 Test Loss: 0.052 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 50 | loss: 0.0000025
	speed: 0.5556s/iter; left time: 11647.2733s
	iters: 200, epoch: 50 | loss: 0.0000324
	speed: 0.2572s/iter; left time: 5366.2401s
	iters: 300, epoch: 50 | loss: 0.0000062
	speed: 0.2617s/iter; left time: 5433.1824s
	iters: 400, epoch: 50 | loss: 0.0000003
	speed: 0.2878s/iter; left time: 5947.4116s
Epoch: 50 cost time: 113.07032537460327
Epoch: 50, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.049 Vali Acc: 0.988 Test Loss: 0.049 Test Acc: 0.988
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 51 | loss: 0.0000202
	speed: 0.5402s/iter; left time: 11101.5373s
	iters: 200, epoch: 51 | loss: 0.0000002
	speed: 0.2814s/iter; left time: 5754.7068s
	iters: 300, epoch: 51 | loss: 0.0000641
	speed: 0.2839s/iter; left time: 5778.1709s
	iters: 400, epoch: 51 | loss: 0.0000006
	speed: 0.3008s/iter; left time: 6091.6207s
Epoch: 51 cost time: 119.34422016143799
Epoch: 51, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.040 Vali Acc: 0.990 Test Loss: 0.040 Test Acc: 0.990
Validation loss decreased (-0.989995 --> -0.990450).  Saving model ...
	iters: 100, epoch: 52 | loss: 0.0000006
	speed: 0.5950s/iter; left time: 11981.1316s
	iters: 200, epoch: 52 | loss: 0.0000104
	speed: 0.2883s/iter; left time: 5777.8172s
	iters: 300, epoch: 52 | loss: 0.0000019
	speed: 0.2852s/iter; left time: 5687.1962s
	iters: 400, epoch: 52 | loss: 0.0000002
	speed: 0.2797s/iter; left time: 5549.2251s
Epoch: 52 cost time: 118.49347376823425
Epoch: 52, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.041 Vali Acc: 0.990 Test Loss: 0.041 Test Acc: 0.990
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 53 | loss: 0.0000020
	speed: 0.5827s/iter; left time: 11494.2643s
	iters: 200, epoch: 53 | loss: 0.0000008
	speed: 0.2611s/iter; left time: 5124.0591s
	iters: 300, epoch: 53 | loss: 0.0000079
	speed: 0.2714s/iter; left time: 5298.3425s
	iters: 400, epoch: 53 | loss: 0.0000008
	speed: 0.2743s/iter; left time: 5327.3700s
Epoch: 53 cost time: 114.0249559879303
Epoch: 53, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.041 Vali Acc: 0.990 Test Loss: 0.041 Test Acc: 0.990
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 54 | loss: 0.0000009
	speed: 0.5926s/iter; left time: 11444.2050s
	iters: 200, epoch: 54 | loss: 0.0000003
	speed: 0.2913s/iter; left time: 5596.4329s
	iters: 300, epoch: 54 | loss: 0.0000075
	speed: 0.2826s/iter; left time: 5400.7836s
	iters: 400, epoch: 54 | loss: 0.0000321
	speed: 0.2812s/iter; left time: 5346.2560s
Epoch: 54 cost time: 120.03899192810059
Epoch: 54, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.042 Vali Acc: 0.990 Test Loss: 0.042 Test Acc: 0.990
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 55 | loss: 0.0000008
	speed: 0.5900s/iter; left time: 11149.8821s
	iters: 200, epoch: 55 | loss: 0.0000113
	speed: 0.2934s/iter; left time: 5515.1286s
	iters: 300, epoch: 55 | loss: 0.0000038
	speed: 0.2933s/iter; left time: 5484.7396s
	iters: 400, epoch: 55 | loss: 0.0000004
	speed: 0.2762s/iter; left time: 5136.3564s
Epoch: 55 cost time: 120.06204605102539
Epoch: 55, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.042 Vali Acc: 0.990 Test Loss: 0.042 Test Acc: 0.990
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 56 | loss: 0.0000096
	speed: 0.5519s/iter; left time: 10203.0845s
	iters: 200, epoch: 56 | loss: 0.0000000
	speed: 0.2996s/iter; left time: 5508.8671s
	iters: 300, epoch: 56 | loss: 0.0000015
	speed: 0.2980s/iter; left time: 5449.7842s
	iters: 400, epoch: 56 | loss: 0.0000000
	speed: 0.3000s/iter; left time: 5456.4444s
Epoch: 56 cost time: 121.94524478912354
Epoch: 56, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.041 Vali Acc: 0.991 Test Loss: 0.041 Test Acc: 0.991
Validation loss decreased (-0.990450 --> -0.991359).  Saving model ...
	iters: 100, epoch: 57 | loss: 0.0000000
	speed: 0.5488s/iter; left time: 9919.1224s
	iters: 200, epoch: 57 | loss: 0.0000032
	speed: 0.2832s/iter; left time: 5089.8309s
	iters: 300, epoch: 57 | loss: 0.0000015
	speed: 0.2843s/iter; left time: 5082.1247s
	iters: 400, epoch: 57 | loss: 0.0000004
	speed: 0.2988s/iter; left time: 5310.5294s
Epoch: 57 cost time: 117.34608507156372
Epoch: 57, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.041 Vali Acc: 0.992 Test Loss: 0.041 Test Acc: 0.992
Validation loss decreased (-0.991359 --> -0.991814).  Saving model ...
	iters: 100, epoch: 58 | loss: 0.0000005
	speed: 0.5643s/iter; left time: 9965.3294s
	iters: 200, epoch: 58 | loss: 0.0001278
	speed: 0.2866s/iter; left time: 5033.5589s
	iters: 300, epoch: 58 | loss: 0.0000111
	speed: 0.2793s/iter; left time: 4876.6430s
	iters: 400, epoch: 58 | loss: 0.0000087
	speed: 0.2909s/iter; left time: 5049.7668s
Epoch: 58 cost time: 118.84667110443115
Epoch: 58, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.039 Vali Acc: 0.991 Test Loss: 0.039 Test Acc: 0.991
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 59 | loss: 0.0000005
	speed: 0.5817s/iter; left time: 10032.6641s
	iters: 200, epoch: 59 | loss: 0.0000001
	speed: 0.2772s/iter; left time: 4753.1866s
	iters: 300, epoch: 59 | loss: 0.0000013
	speed: 0.2881s/iter; left time: 4910.8035s
	iters: 400, epoch: 59 | loss: 0.0000001
	speed: 0.2725s/iter; left time: 4617.9411s
Epoch: 59 cost time: 116.81958961486816
Epoch: 59, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.038 Vali Acc: 0.991 Test Loss: 0.038 Test Acc: 0.991
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 60 | loss: 0.0000016
	speed: 0.5869s/iter; left time: 9879.1803s
	iters: 200, epoch: 60 | loss: 0.0000001
	speed: 0.2977s/iter; left time: 4981.1514s
	iters: 300, epoch: 60 | loss: 0.0000015
	speed: 0.2865s/iter; left time: 4765.2542s
	iters: 400, epoch: 60 | loss: 0.0000002
	speed: 0.2943s/iter; left time: 4865.9402s
Epoch: 60 cost time: 122.10229015350342
Epoch: 60, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.039 Vali Acc: 0.991 Test Loss: 0.039 Test Acc: 0.991
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 61 | loss: 0.0000005
	speed: 0.5811s/iter; left time: 9542.3259s
	iters: 200, epoch: 61 | loss: 0.0000000
	speed: 0.2767s/iter; left time: 4515.3482s
	iters: 300, epoch: 61 | loss: 0.0000000
	speed: 0.2990s/iter; left time: 4849.3215s
	iters: 400, epoch: 61 | loss: 0.0000012
	speed: 0.2862s/iter; left time: 4614.6140s
Epoch: 61 cost time: 120.68096542358398
Epoch: 61, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.039 Vali Acc: 0.992 Test Loss: 0.039 Test Acc: 0.992
Validation loss decreased (-0.991814 --> -0.991814).  Saving model ...
	iters: 100, epoch: 62 | loss: 0.0000005
	speed: 0.5585s/iter; left time: 8940.8516s
	iters: 200, epoch: 62 | loss: 0.0000018
	speed: 0.2821s/iter; left time: 4488.0392s
	iters: 300, epoch: 62 | loss: 0.0000000
	speed: 0.2973s/iter; left time: 4699.7717s
	iters: 400, epoch: 62 | loss: 0.0000005
	speed: 0.3142s/iter; left time: 4936.0556s
Epoch: 62 cost time: 122.47530269622803
Epoch: 62, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.039 Vali Acc: 0.992 Test Loss: 0.039 Test Acc: 0.992
Validation loss decreased (-0.991814 --> -0.991814).  Saving model ...
	iters: 100, epoch: 63 | loss: 0.0000008
	speed: 0.5753s/iter; left time: 8971.3970s
	iters: 200, epoch: 63 | loss: 0.0000000
	speed: 0.2934s/iter; left time: 4546.8173s
	iters: 300, epoch: 63 | loss: 0.0000014
	speed: 0.2899s/iter; left time: 4462.8696s
	iters: 400, epoch: 63 | loss: 0.0000034
	speed: 0.3023s/iter; left time: 4623.5615s
Epoch: 63 cost time: 122.14742469787598
Epoch: 63, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.040 Vali Acc: 0.992 Test Loss: 0.040 Test Acc: 0.992
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 64 | loss: 0.0000001
	speed: 0.5770s/iter; left time: 8759.9455s
	iters: 200, epoch: 64 | loss: 0.0000001
	speed: 0.2763s/iter; left time: 4167.3684s
	iters: 300, epoch: 64 | loss: 0.0000000
	speed: 0.2916s/iter; left time: 4369.3519s
	iters: 400, epoch: 64 | loss: 0.0000002
	speed: 0.2921s/iter; left time: 4346.5909s
Epoch: 64 cost time: 118.72000455856323
Epoch: 64, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.041 Vali Acc: 0.992 Test Loss: 0.041 Test Acc: 0.992
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 65 | loss: 0.0000004
	speed: 0.5913s/iter; left time: 8732.5746s
	iters: 200, epoch: 65 | loss: 0.0000000
	speed: 0.2925s/iter; left time: 4291.0410s
	iters: 300, epoch: 65 | loss: 0.0000000
	speed: 0.2879s/iter; left time: 4195.0527s
	iters: 400, epoch: 65 | loss: 0.0000002
	speed: 0.2878s/iter; left time: 4164.2270s
Epoch: 65 cost time: 120.68078851699829
Epoch: 65, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.040 Vali Acc: 0.991 Test Loss: 0.040 Test Acc: 0.991
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 66 | loss: 0.0000053
	speed: 0.5771s/iter; left time: 8284.4172s
	iters: 200, epoch: 66 | loss: 0.0000000
	speed: 0.3063s/iter; left time: 4366.0817s
	iters: 300, epoch: 66 | loss: 0.0000105
	speed: 0.2879s/iter; left time: 4074.8437s
	iters: 400, epoch: 66 | loss: 0.0000008
	speed: 0.2868s/iter; left time: 4031.6986s
Epoch: 66 cost time: 121.60396885871887
Epoch: 66, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.040 Vali Acc: 0.991 Test Loss: 0.040 Test Acc: 0.991
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 67 | loss: 0.0000000
	speed: 0.5923s/iter; left time: 8258.6099s
	iters: 200, epoch: 67 | loss: 0.0000008
	speed: 0.3016s/iter; left time: 4175.7337s
	iters: 300, epoch: 67 | loss: 0.0000002
	speed: 0.3040s/iter; left time: 4177.8943s
	iters: 400, epoch: 67 | loss: 0.0000480
	speed: 0.2957s/iter; left time: 4033.7408s
Epoch: 67 cost time: 124.85279154777527
Epoch: 67, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.042 Vali Acc: 0.991 Test Loss: 0.042 Test Acc: 0.991
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 68 | loss: 0.0000000
	speed: 0.5585s/iter; left time: 7556.2804s
	iters: 200, epoch: 68 | loss: 0.0000000
	speed: 0.2700s/iter; left time: 3626.7483s
	iters: 300, epoch: 68 | loss: 0.0000004
	speed: 0.2779s/iter; left time: 3704.1014s
	iters: 400, epoch: 68 | loss: 0.0000001
	speed: 0.2918s/iter; left time: 3860.2258s
Epoch: 68 cost time: 117.38504338264465
Epoch: 68, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.041 Vali Acc: 0.992 Test Loss: 0.041 Test Acc: 0.992
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 69 | loss: 0.0000000
	speed: 0.5774s/iter; left time: 7573.5319s
	iters: 200, epoch: 69 | loss: 0.0000000
	speed: 0.2959s/iter; left time: 3851.1906s
	iters: 300, epoch: 69 | loss: 0.0000000
	speed: 0.3010s/iter; left time: 3887.8065s
	iters: 400, epoch: 69 | loss: 0.0000000
	speed: 0.2998s/iter; left time: 3842.7733s
Epoch: 69 cost time: 121.96974563598633
Epoch: 69, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.042 Vali Acc: 0.991 Test Loss: 0.042 Test Acc: 0.991
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 70 | loss: 0.0000032
	speed: 0.5573s/iter; left time: 7080.5580s
	iters: 200, epoch: 70 | loss: 0.0000000
	speed: 0.2798s/iter; left time: 3526.5387s
	iters: 300, epoch: 70 | loss: 0.0000001
	speed: 0.2768s/iter; left time: 3460.7295s
	iters: 400, epoch: 70 | loss: 0.0000000
	speed: 0.2906s/iter; left time: 3604.8725s
Epoch: 70 cost time: 117.762864112854
Epoch: 70, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.043 Vali Acc: 0.991 Test Loss: 0.043 Test Acc: 0.991
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 71 | loss: 0.0000002
	speed: 0.5808s/iter; left time: 7138.1105s
	iters: 200, epoch: 71 | loss: 0.0000015
	speed: 0.2983s/iter; left time: 3636.5751s
	iters: 300, epoch: 71 | loss: 0.0000009
	speed: 0.3052s/iter; left time: 3690.4895s
	iters: 400, epoch: 71 | loss: 0.0000003
	speed: 0.2965s/iter; left time: 3555.3358s
Epoch: 71 cost time: 124.2349443435669
Epoch: 71, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.045 Vali Acc: 0.990 Test Loss: 0.045 Test Acc: 0.990
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 72 | loss: 0.0000000
	speed: 0.5640s/iter; left time: 6699.7263s
	iters: 200, epoch: 72 | loss: 0.0000000
	speed: 0.2852s/iter; left time: 3358.6354s
	iters: 300, epoch: 72 | loss: 0.0000000
	speed: 0.3068s/iter; left time: 3583.1441s
	iters: 400, epoch: 72 | loss: 0.0000000
	speed: 0.3078s/iter; left time: 3563.2112s
Epoch: 72 cost time: 123.06021213531494
Epoch: 72, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.041 Vali Acc: 0.991 Test Loss: 0.041 Test Acc: 0.991
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df512_ma28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9918144611186903
model parameter : 11400202
model size : 63.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df512_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2416499
	speed: 0.2955s/iter; left time: 12173.7874s
	iters: 200, epoch: 1 | loss: 0.1622780
	speed: 0.2794s/iter; left time: 11481.6385s
	iters: 300, epoch: 1 | loss: 0.3496600
	speed: 0.2970s/iter; left time: 12175.8802s
	iters: 400, epoch: 1 | loss: 0.1414070
	speed: 0.2919s/iter; left time: 11938.4429s
Epoch: 1 cost time: 120.26774573326111
Epoch: 1, Steps: 413 | Train Loss: 0.419 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
Validation loss decreased (inf --> -0.962254).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0086042
	speed: 0.5429s/iter; left time: 22145.1831s
	iters: 200, epoch: 2 | loss: 0.2113351
	speed: 0.2800s/iter; left time: 11391.4100s
	iters: 300, epoch: 2 | loss: 0.0060609
	speed: 0.2804s/iter; left time: 11380.6174s
	iters: 400, epoch: 2 | loss: 0.1262240
	speed: 0.2889s/iter; left time: 11694.9907s
Epoch: 2 cost time: 116.15250897407532
Epoch: 2, Steps: 413 | Train Loss: 0.199 Vali Loss: 0.351 Vali Acc: 0.944 Test Loss: 0.351 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.2731842
	speed: 0.5603s/iter; left time: 22622.3739s
	iters: 200, epoch: 3 | loss: 0.0010500
	speed: 0.2722s/iter; left time: 10962.2027s
	iters: 300, epoch: 3 | loss: 0.3818713
	speed: 0.2822s/iter; left time: 11335.6258s
	iters: 400, epoch: 3 | loss: 0.0096188
	speed: 0.2839s/iter; left time: 11376.1149s
Epoch: 3 cost time: 115.83778524398804
Epoch: 3, Steps: 413 | Train Loss: 0.323 Vali Loss: 0.380 Vali Acc: 0.948 Test Loss: 0.380 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0186424
	speed: 0.5641s/iter; left time: 22543.0303s
	iters: 200, epoch: 4 | loss: 0.0934269
	speed: 0.2686s/iter; left time: 10705.5568s
	iters: 300, epoch: 4 | loss: 0.6933753
	speed: 0.2746s/iter; left time: 10916.6701s
	iters: 400, epoch: 4 | loss: 0.0004447
	speed: 0.2728s/iter; left time: 10818.4569s
Epoch: 4 cost time: 114.17220163345337
Epoch: 4, Steps: 413 | Train Loss: 0.380 Vali Loss: 0.511 Vali Acc: 0.949 Test Loss: 0.511 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.9220653
	speed: 0.5563s/iter; left time: 22000.6222s
	iters: 200, epoch: 5 | loss: 0.8103410
	speed: 0.2985s/iter; left time: 11776.1777s
	iters: 300, epoch: 5 | loss: 0.0000000
	speed: 0.2888s/iter; left time: 11364.2329s
	iters: 400, epoch: 5 | loss: 0.0013926
	speed: 0.2682s/iter; left time: 10525.0623s
Epoch: 5 cost time: 118.14625644683838
Epoch: 5, Steps: 413 | Train Loss: 0.346 Vali Loss: 0.443 Vali Acc: 0.957 Test Loss: 0.443 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0141615
	speed: 0.5579s/iter; left time: 21832.5068s
	iters: 200, epoch: 6 | loss: 1.1951660
	speed: 0.2787s/iter; left time: 10880.8533s
	iters: 300, epoch: 6 | loss: 0.0000507
	speed: 0.2813s/iter; left time: 10952.1542s
	iters: 400, epoch: 6 | loss: 0.2426867
	speed: 0.2884s/iter; left time: 11201.5410s
Epoch: 6 cost time: 117.4994306564331
Epoch: 6, Steps: 413 | Train Loss: 0.249 Vali Loss: 0.601 Vali Acc: 0.948 Test Loss: 0.601 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0885546
	speed: 0.5798s/iter; left time: 22452.9568s
	iters: 200, epoch: 7 | loss: 0.0000005
	speed: 0.2885s/iter; left time: 11142.6585s
	iters: 300, epoch: 7 | loss: 0.1694359
	speed: 0.2915s/iter; left time: 11228.5901s
	iters: 400, epoch: 7 | loss: 0.6205833
	speed: 0.2902s/iter; left time: 11149.4878s
Epoch: 7 cost time: 120.39009666442871
Epoch: 7, Steps: 413 | Train Loss: 0.226 Vali Loss: 0.409 Vali Acc: 0.953 Test Loss: 0.409 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.0000282
	speed: 0.5807s/iter; left time: 22245.7829s
	iters: 200, epoch: 8 | loss: 0.6203828
	speed: 0.2903s/iter; left time: 11091.7279s
	iters: 300, epoch: 8 | loss: 0.0001661
	speed: 0.2772s/iter; left time: 10564.5874s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.2757s/iter; left time: 10481.2313s
Epoch: 8 cost time: 117.59924483299255
Epoch: 8, Steps: 413 | Train Loss: 0.216 Vali Loss: 0.707 Vali Acc: 0.952 Test Loss: 0.707 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.0000325
	speed: 0.5381s/iter; left time: 20392.5795s
	iters: 200, epoch: 9 | loss: 0.3548997
	speed: 0.2795s/iter; left time: 10566.1118s
	iters: 300, epoch: 9 | loss: 0.3508963
	speed: 0.2794s/iter; left time: 10533.1475s
	iters: 400, epoch: 9 | loss: 0.0005077
	speed: 0.2933s/iter; left time: 11028.0165s
Epoch: 9 cost time: 116.36021089553833
Epoch: 9, Steps: 413 | Train Loss: 0.179 Vali Loss: 0.576 Vali Acc: 0.959 Test Loss: 0.576 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.5572s/iter; left time: 20886.8833s
	iters: 200, epoch: 10 | loss: 0.0000009
	speed: 0.2791s/iter; left time: 10432.2387s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.2825s/iter; left time: 10531.8833s
	iters: 400, epoch: 10 | loss: 0.0000027
	speed: 0.2816s/iter; left time: 10472.7567s
Epoch: 10 cost time: 115.82256031036377
Epoch: 10, Steps: 413 | Train Loss: 0.147 Vali Loss: 0.340 Vali Acc: 0.963 Test Loss: 0.340 Test Acc: 0.963
Validation loss decreased (-0.962254 --> -0.963162).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000460
	speed: 0.5541s/iter; left time: 20539.2826s
	iters: 200, epoch: 11 | loss: 0.0000700
	speed: 0.2730s/iter; left time: 10094.5097s
	iters: 300, epoch: 11 | loss: 0.1058863
	speed: 0.2645s/iter; left time: 9753.6921s
	iters: 400, epoch: 11 | loss: 0.6129113
	speed: 0.2748s/iter; left time: 10106.0850s
Epoch: 11 cost time: 112.32331490516663
Epoch: 11, Steps: 413 | Train Loss: 0.172 Vali Loss: 0.434 Vali Acc: 0.967 Test Loss: 0.434 Test Acc: 0.967
Validation loss decreased (-0.963162 --> -0.966799).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.5595s/iter; left time: 20508.6999s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.2766s/iter; left time: 10111.4580s
	iters: 300, epoch: 12 | loss: 1.5210491
	speed: 0.2824s/iter; left time: 10295.1812s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.2805s/iter; left time: 10198.2942s
Epoch: 12 cost time: 116.14036917686462
Epoch: 12, Steps: 413 | Train Loss: 0.138 Vali Loss: 0.295 Vali Acc: 0.976 Test Loss: 0.295 Test Acc: 0.976
Validation loss decreased (-0.966799 --> -0.975895).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.5285s/iter; left time: 19155.3657s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.2606s/iter; left time: 9419.9438s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.2751s/iter; left time: 9915.2766s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.2862s/iter; left time: 10285.9581s
Epoch: 13 cost time: 111.94754195213318
Epoch: 13, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.359 Vali Acc: 0.970 Test Loss: 0.359 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000157
	speed: 0.5488s/iter; left time: 19664.3206s
	iters: 200, epoch: 14 | loss: 0.6188790
	speed: 0.2687s/iter; left time: 9599.8057s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.2715s/iter; left time: 9673.8249s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.2786s/iter; left time: 9899.9134s
Epoch: 14 cost time: 113.25101804733276
Epoch: 14, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.427 Vali Acc: 0.968 Test Loss: 0.427 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0048003
	speed: 0.5457s/iter; left time: 19327.9914s
	iters: 200, epoch: 15 | loss: 0.0066913
	speed: 0.2738s/iter; left time: 9669.5011s
	iters: 300, epoch: 15 | loss: 0.6382053
	speed: 0.2695s/iter; left time: 9490.0605s
	iters: 400, epoch: 15 | loss: 0.0001300
	speed: 0.2734s/iter; left time: 9601.1035s
Epoch: 15 cost time: 112.56058287620544
Epoch: 15, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.363 Vali Acc: 0.968 Test Loss: 0.363 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.5453s/iter; left time: 19087.2736s
	iters: 200, epoch: 16 | loss: 0.0000118
	speed: 0.2751s/iter; left time: 9602.0032s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.2682s/iter; left time: 9335.3800s
	iters: 400, epoch: 16 | loss: 0.9853643
	speed: 0.2845s/iter; left time: 9874.7864s
Epoch: 16 cost time: 114.14228463172913
Epoch: 16, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.459 Vali Acc: 0.971 Test Loss: 0.459 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.5439s/iter; left time: 18814.4887s
	iters: 200, epoch: 17 | loss: 0.0000754
	speed: 0.2702s/iter; left time: 9321.6990s
	iters: 300, epoch: 17 | loss: 0.4143283
	speed: 0.2755s/iter; left time: 9473.5566s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.2778s/iter; left time: 9525.6459s
Epoch: 17 cost time: 113.48373246192932
Epoch: 17, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.652 Vali Acc: 0.969 Test Loss: 0.652 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.5459s/iter; left time: 18658.5562s
	iters: 200, epoch: 18 | loss: 1.6162640
	speed: 0.2606s/iter; left time: 8880.2686s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.2682s/iter; left time: 9114.6602s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.2947s/iter; left time: 9984.7050s
Epoch: 18 cost time: 114.15862274169922
Epoch: 18, Steps: 413 | Train Loss: 0.119 Vali Loss: 0.299 Vali Acc: 0.971 Test Loss: 0.299 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.5620s/iter; left time: 18977.8321s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.2629s/iter; left time: 8850.9695s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.2704s/iter; left time: 9077.2197s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.2794s/iter; left time: 9349.4921s
Epoch: 19 cost time: 112.76530957221985
Epoch: 19, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.367 Vali Acc: 0.975 Test Loss: 0.367 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.5495s/iter; left time: 18328.6386s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.2748s/iter; left time: 9139.2722s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.2528s/iter; left time: 8382.2638s
	iters: 400, epoch: 20 | loss: 0.0000297
	speed: 0.2637s/iter; left time: 8716.3151s
Epoch: 20 cost time: 110.87422227859497
Epoch: 20, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.309 Vali Acc: 0.967 Test Loss: 0.309 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000017
	speed: 0.5480s/iter; left time: 18050.6538s
	iters: 200, epoch: 21 | loss: 0.0000196
	speed: 0.2667s/iter; left time: 8759.8756s
	iters: 300, epoch: 21 | loss: 0.0000001
	speed: 0.2804s/iter; left time: 9180.7015s
	iters: 400, epoch: 21 | loss: 0.0003683
	speed: 0.2713s/iter; left time: 8856.3097s
Epoch: 21 cost time: 113.4997832775116
Epoch: 21, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.485 Vali Acc: 0.957 Test Loss: 0.485 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.5465s/iter; left time: 17778.0903s
	iters: 200, epoch: 22 | loss: 0.0000011
	speed: 0.2775s/iter; left time: 8997.2003s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.2789s/iter; left time: 9017.0232s
	iters: 400, epoch: 22 | loss: 0.0000001
	speed: 0.2741s/iter; left time: 8834.6032s
Epoch: 22 cost time: 114.58492374420166
Epoch: 22, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.387 Vali Acc: 0.977 Test Loss: 0.387 Test Acc: 0.977
Validation loss decreased (-0.975895 --> -0.976804).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.5470s/iter; left time: 17566.9155s
	iters: 200, epoch: 23 | loss: 0.0000001
	speed: 0.2817s/iter; left time: 9017.2320s
	iters: 300, epoch: 23 | loss: 0.0234834
	speed: 0.2722s/iter; left time: 8688.6628s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.2665s/iter; left time: 8477.1828s
Epoch: 23 cost time: 114.52650713920593
Epoch: 23, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.186 Vali Acc: 0.981 Test Loss: 0.186 Test Acc: 0.981
Validation loss decreased (-0.976804 --> -0.981353).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.5551s/iter; left time: 17597.8191s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.2750s/iter; left time: 8692.0539s
	iters: 300, epoch: 24 | loss: 0.0000001
	speed: 0.2779s/iter; left time: 8753.1322s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.2754s/iter; left time: 8648.0744s
Epoch: 24 cost time: 115.05982613563538
Epoch: 24, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.191 Vali Acc: 0.985 Test Loss: 0.191 Test Acc: 0.985
Validation loss decreased (-0.981353 --> -0.984537).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.5507s/iter; left time: 17231.2162s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.2677s/iter; left time: 8349.2963s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.2746s/iter; left time: 8537.2510s
	iters: 400, epoch: 25 | loss: 0.9891717
	speed: 0.2792s/iter; left time: 8650.6835s
Epoch: 25 cost time: 114.12392950057983
Epoch: 25, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.385 Vali Acc: 0.971 Test Loss: 0.385 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0000199
	speed: 0.5345s/iter; left time: 16502.9817s
	iters: 200, epoch: 26 | loss: 0.0000571
	speed: 0.2734s/iter; left time: 8414.3163s
	iters: 300, epoch: 26 | loss: 0.0008556
	speed: 0.2882s/iter; left time: 8839.3637s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.2796s/iter; left time: 8548.7012s
Epoch: 26 cost time: 115.67755699157715
Epoch: 26, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.211 Vali Acc: 0.977 Test Loss: 0.211 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0000059
	speed: 0.5429s/iter; left time: 16537.3221s
	iters: 200, epoch: 27 | loss: 0.0000092
	speed: 0.2700s/iter; left time: 8199.0841s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.2739s/iter; left time: 8290.3617s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.2756s/iter; left time: 8313.6280s
Epoch: 27 cost time: 113.0475127696991
Epoch: 27, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.305 Vali Acc: 0.974 Test Loss: 0.305 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.6232061
	speed: 0.5577s/iter; left time: 16758.0829s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.2686s/iter; left time: 8045.3391s
	iters: 300, epoch: 28 | loss: 0.0005281
	speed: 0.2715s/iter; left time: 8102.9902s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.2902s/iter; left time: 8632.8833s
Epoch: 28 cost time: 114.91877150535583
Epoch: 28, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.138 Vali Acc: 0.985 Test Loss: 0.138 Test Acc: 0.985
Validation loss decreased (-0.984537 --> -0.984992).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0000002
	speed: 0.5690s/iter; left time: 16862.9859s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.2667s/iter; left time: 7876.8960s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.2660s/iter; left time: 7830.9527s
	iters: 400, epoch: 29 | loss: 0.0102501
	speed: 0.2764s/iter; left time: 8108.3890s
Epoch: 29 cost time: 112.79760503768921
Epoch: 29, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.152 Vali Acc: 0.985 Test Loss: 0.152 Test Acc: 0.985
Validation loss decreased (-0.984992 --> -0.985446).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.5531s/iter; left time: 16164.2134s
	iters: 200, epoch: 30 | loss: 0.0000135
	speed: 0.2722s/iter; left time: 7928.6312s
	iters: 300, epoch: 30 | loss: 0.7155133
	speed: 0.2713s/iter; left time: 7874.5632s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.2827s/iter; left time: 8175.4243s
Epoch: 30 cost time: 114.62341070175171
Epoch: 30, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.178 Vali Acc: 0.979 Test Loss: 0.178 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.5561s/iter; left time: 16020.3695s
	iters: 200, epoch: 31 | loss: 0.0276887
	speed: 0.2771s/iter; left time: 7955.1840s
	iters: 300, epoch: 31 | loss: 0.0009394
	speed: 0.2804s/iter; left time: 8023.1143s
	iters: 400, epoch: 31 | loss: 0.0003177
	speed: 0.2833s/iter; left time: 8076.1753s
Epoch: 31 cost time: 116.02604269981384
Epoch: 31, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.181 Vali Acc: 0.981 Test Loss: 0.181 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0000001
	speed: 0.5435s/iter; left time: 15434.0882s
	iters: 200, epoch: 32 | loss: 0.0000024
	speed: 0.2686s/iter; left time: 7599.6682s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.2732s/iter; left time: 7702.8855s
	iters: 400, epoch: 32 | loss: 0.0000006
	speed: 0.2885s/iter; left time: 8105.8271s
Epoch: 32 cost time: 113.92423892021179
Epoch: 32, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.255 Vali Acc: 0.976 Test Loss: 0.255 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.1216068
	speed: 0.5706s/iter; left time: 15969.1635s
	iters: 200, epoch: 33 | loss: 0.0000010
	speed: 0.2776s/iter; left time: 7740.3296s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.2776s/iter; left time: 7711.9354s
	iters: 400, epoch: 33 | loss: 0.0000005
	speed: 0.2812s/iter; left time: 7785.6971s
Epoch: 33 cost time: 116.14040541648865
Epoch: 33, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.154 Vali Acc: 0.980 Test Loss: 0.154 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.0000003
	speed: 0.5471s/iter; left time: 15084.6935s
	iters: 200, epoch: 34 | loss: 0.0024976
	speed: 0.2673s/iter; left time: 7343.3411s
	iters: 300, epoch: 34 | loss: 0.0000001
	speed: 0.2856s/iter; left time: 7817.1872s
	iters: 400, epoch: 34 | loss: 0.0000003
	speed: 0.2848s/iter; left time: 7766.1548s
Epoch: 34 cost time: 114.91690683364868
Epoch: 34, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.104 Vali Acc: 0.986 Test Loss: 0.104 Test Acc: 0.986
Validation loss decreased (-0.985446 --> -0.986356).  Saving model ...
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.5704s/iter; left time: 15490.8142s
	iters: 200, epoch: 35 | loss: 0.0000002
	speed: 0.2766s/iter; left time: 7485.4284s
	iters: 300, epoch: 35 | loss: 0.0000001
	speed: 0.2793s/iter; left time: 7528.7180s
	iters: 400, epoch: 35 | loss: 0.0003628
	speed: 0.2788s/iter; left time: 7488.2192s
Epoch: 35 cost time: 116.23129892349243
Epoch: 35, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.205 Vali Acc: 0.975 Test Loss: 0.205 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 0.0000489
	speed: 0.5899s/iter; left time: 15776.5771s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.2914s/iter; left time: 7765.7490s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.3068s/iter; left time: 8145.3952s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.3000s/iter; left time: 7934.3543s
Epoch: 36 cost time: 124.13404583930969
Epoch: 36, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.181 Vali Acc: 0.983 Test Loss: 0.181 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.6244s/iter; left time: 16442.5868s
	iters: 200, epoch: 37 | loss: 0.0008728
	speed: 0.3258s/iter; left time: 8545.9386s
	iters: 300, epoch: 37 | loss: 0.0000000
	speed: 0.3309s/iter; left time: 8646.3620s
	iters: 400, epoch: 37 | loss: 0.0000002
	speed: 0.3091s/iter; left time: 8047.7802s
Epoch: 37 cost time: 132.94595432281494
Epoch: 37, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.740 Vali Acc: 0.936 Test Loss: 0.740 Test Acc: 0.936
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 0.0000198
	speed: 0.5767s/iter; left time: 14949.1300s
	iters: 200, epoch: 38 | loss: 0.0000561
	speed: 0.3037s/iter; left time: 7840.7211s
	iters: 300, epoch: 38 | loss: 0.0000004
	speed: 0.2981s/iter; left time: 7667.7358s
	iters: 400, epoch: 38 | loss: 0.0011904
	speed: 0.2953s/iter; left time: 7564.8873s
Epoch: 38 cost time: 122.29664206504822
Epoch: 38, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.196 Vali Acc: 0.980 Test Loss: 0.196 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 39 | loss: 0.0000000
	speed: 0.5813s/iter; left time: 14826.7672s
	iters: 200, epoch: 39 | loss: 0.0000000
	speed: 0.3129s/iter; left time: 7949.6946s
	iters: 300, epoch: 39 | loss: 0.0000003
	speed: 0.2856s/iter; left time: 7226.7282s
	iters: 400, epoch: 39 | loss: 0.0000000
	speed: 0.3031s/iter; left time: 7640.9538s
Epoch: 39 cost time: 124.27421474456787
Epoch: 39, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.152 Vali Acc: 0.981 Test Loss: 0.152 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 40 | loss: 0.0000032
	speed: 0.5770s/iter; left time: 14479.3389s
	iters: 200, epoch: 40 | loss: 0.0000000
	speed: 0.2871s/iter; left time: 7176.9916s
	iters: 300, epoch: 40 | loss: 0.0000046
	speed: 0.3031s/iter; left time: 7544.5270s
	iters: 400, epoch: 40 | loss: 0.4701481
	speed: 0.2893s/iter; left time: 7173.0481s
Epoch: 40 cost time: 119.9914448261261
Epoch: 40, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.122 Vali Acc: 0.983 Test Loss: 0.122 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 41 | loss: 0.0000006
	speed: 0.5785s/iter; left time: 14278.5791s
	iters: 200, epoch: 41 | loss: 0.0079968
	speed: 0.3219s/iter; left time: 7912.0903s
	iters: 300, epoch: 41 | loss: 0.6197494
	speed: 0.3000s/iter; left time: 7345.3364s
	iters: 400, epoch: 41 | loss: 0.0003824
	speed: 0.2942s/iter; left time: 7171.8711s
Epoch: 41 cost time: 125.27576661109924
Epoch: 41, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.094 Vali Acc: 0.984 Test Loss: 0.094 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 42 | loss: 0.0398526
	speed: 0.5854s/iter; left time: 14206.5618s
	iters: 200, epoch: 42 | loss: 0.0000005
	speed: 0.2891s/iter; left time: 6986.8966s
	iters: 300, epoch: 42 | loss: 0.0457311
	speed: 0.2895s/iter; left time: 6967.4729s
	iters: 400, epoch: 42 | loss: 0.0166031
	speed: 0.2963s/iter; left time: 7102.0457s
Epoch: 42 cost time: 122.09286141395569
Epoch: 42, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.177 Vali Acc: 0.978 Test Loss: 0.177 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 43 | loss: 0.0000000
	speed: 0.5790s/iter; left time: 13812.5770s
	iters: 200, epoch: 43 | loss: 0.0000002
	speed: 0.2981s/iter; left time: 7081.6346s
	iters: 300, epoch: 43 | loss: 0.0000007
	speed: 0.3011s/iter; left time: 7121.8548s
	iters: 400, epoch: 43 | loss: 0.0000014
	speed: 0.2980s/iter; left time: 7018.8035s
Epoch: 43 cost time: 122.98700833320618
Epoch: 43, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.088 Vali Acc: 0.984 Test Loss: 0.088 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 44 | loss: 0.0003321
	speed: 0.5403s/iter; left time: 12666.6167s
	iters: 200, epoch: 44 | loss: 0.0000000
	speed: 0.3005s/iter; left time: 7014.3972s
	iters: 300, epoch: 44 | loss: 0.0000000
	speed: 0.2896s/iter; left time: 6730.8998s
	iters: 400, epoch: 44 | loss: 0.0006913
	speed: 0.2898s/iter; left time: 6706.5014s
Epoch: 44 cost time: 119.76539754867554
Epoch: 44, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
Validation loss decreased (-0.986356 --> -0.986812).  Saving model ...
	iters: 100, epoch: 45 | loss: 0.0000631
	speed: 0.6107s/iter; left time: 14064.8525s
	iters: 200, epoch: 45 | loss: 0.0000001
	speed: 0.2891s/iter; left time: 6629.5188s
	iters: 300, epoch: 45 | loss: 0.0000021
	speed: 0.3000s/iter; left time: 6848.8157s
	iters: 400, epoch: 45 | loss: 0.0000002
	speed: 0.3049s/iter; left time: 6929.3676s
Epoch: 45 cost time: 125.13849925994873
Epoch: 45, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.109 Vali Acc: 0.979 Test Loss: 0.109 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 46 | loss: 0.0000000
	speed: 0.5516s/iter; left time: 12475.5034s
	iters: 200, epoch: 46 | loss: 0.0006686
	speed: 0.3006s/iter; left time: 6769.2200s
	iters: 300, epoch: 46 | loss: 0.0000820
	speed: 0.2903s/iter; left time: 6508.3468s
	iters: 400, epoch: 46 | loss: 0.1560844
	speed: 0.2866s/iter; left time: 6396.2505s
Epoch: 46 cost time: 120.2345838546753
Epoch: 46, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.078 Vali Acc: 0.986 Test Loss: 0.078 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 47 | loss: 0.0000177
	speed: 0.5824s/iter; left time: 12929.9602s
	iters: 200, epoch: 47 | loss: 0.0000432
	speed: 0.2940s/iter; left time: 6497.3735s
	iters: 300, epoch: 47 | loss: 0.0001731
	speed: 0.3011s/iter; left time: 6625.6812s
	iters: 400, epoch: 47 | loss: 0.0000498
	speed: 0.3059s/iter; left time: 6700.0190s
Epoch: 47 cost time: 124.45658016204834
Epoch: 47, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.048 Vali Acc: 0.987 Test Loss: 0.048 Test Acc: 0.987
Validation loss decreased (-0.986812 --> -0.986812).  Saving model ...
	iters: 100, epoch: 48 | loss: 0.0000119
	speed: 0.5783s/iter; left time: 12600.0907s
	iters: 200, epoch: 48 | loss: 0.0000022
	speed: 0.2869s/iter; left time: 6223.7917s
	iters: 300, epoch: 48 | loss: 0.0000024
	speed: 0.3081s/iter; left time: 6652.8794s
	iters: 400, epoch: 48 | loss: 0.0000001
	speed: 0.2909s/iter; left time: 6250.4821s
Epoch: 48 cost time: 121.03968977928162
Epoch: 48, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
Validation loss decreased (-0.986812 --> -0.987266).  Saving model ...
	iters: 100, epoch: 49 | loss: 0.0002066
	speed: 0.5768s/iter; left time: 12330.9072s
	iters: 200, epoch: 49 | loss: 0.0000000
	speed: 0.3040s/iter; left time: 6467.4596s
	iters: 300, epoch: 49 | loss: 0.0000001
	speed: 0.3073s/iter; left time: 6508.4830s
	iters: 400, epoch: 49 | loss: 0.0002129
	speed: 0.3175s/iter; left time: 6692.4712s
Epoch: 49 cost time: 127.67544627189636
Epoch: 49, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.051 Vali Acc: 0.989 Test Loss: 0.051 Test Acc: 0.989
Validation loss decreased (-0.987266 --> -0.988631).  Saving model ...
	iters: 100, epoch: 50 | loss: 0.0000745
	speed: 0.5897s/iter; left time: 12362.6177s
	iters: 200, epoch: 50 | loss: 0.0000009
	speed: 0.2696s/iter; left time: 5625.6050s
	iters: 300, epoch: 50 | loss: 0.0000029
	speed: 0.2826s/iter; left time: 5867.6962s
	iters: 400, epoch: 50 | loss: 0.0000034
	speed: 0.2814s/iter; left time: 5815.1578s
Epoch: 50 cost time: 116.88287353515625
Epoch: 50, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.051 Vali Acc: 0.989 Test Loss: 0.051 Test Acc: 0.989
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 51 | loss: 0.0000000
	speed: 0.5425s/iter; left time: 11148.7908s
	iters: 200, epoch: 51 | loss: 0.0001011
	speed: 0.2863s/iter; left time: 5854.7536s
	iters: 300, epoch: 51 | loss: 0.0000040
	speed: 0.2885s/iter; left time: 5871.9394s
	iters: 400, epoch: 51 | loss: 0.0000000
	speed: 0.2759s/iter; left time: 5586.4173s
Epoch: 51 cost time: 116.3513412475586
Epoch: 51, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.052 Vali Acc: 0.989 Test Loss: 0.052 Test Acc: 0.989
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 52 | loss: 0.0000061
	speed: 0.5753s/iter; left time: 11584.6321s
	iters: 200, epoch: 52 | loss: 0.0000035
	speed: 0.2832s/iter; left time: 5674.4744s
	iters: 300, epoch: 52 | loss: 0.0000033
	speed: 0.2930s/iter; left time: 5842.0054s
	iters: 400, epoch: 52 | loss: 0.0000006
	speed: 0.2807s/iter; left time: 5568.7903s
Epoch: 52 cost time: 119.41718053817749
Epoch: 52, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.054 Vali Acc: 0.988 Test Loss: 0.054 Test Acc: 0.988
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 53 | loss: 0.0000000
	speed: 0.5972s/iter; left time: 11780.1710s
	iters: 200, epoch: 53 | loss: 0.0000010
	speed: 0.2938s/iter; left time: 5765.8554s
	iters: 300, epoch: 53 | loss: 0.0000003
	speed: 0.3078s/iter; left time: 6010.5410s
	iters: 400, epoch: 53 | loss: 0.0000000
	speed: 0.3336s/iter; left time: 6480.6001s
Epoch: 53 cost time: 128.38383030891418
Epoch: 53, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.054 Vali Acc: 0.989 Test Loss: 0.054 Test Acc: 0.989
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 54 | loss: 0.0000196
	speed: 0.6020s/iter; left time: 11625.3649s
	iters: 200, epoch: 54 | loss: 0.0000001
	speed: 0.3098s/iter; left time: 5952.8040s
	iters: 300, epoch: 54 | loss: 0.0000129
	speed: 0.3085s/iter; left time: 5896.7530s
	iters: 400, epoch: 54 | loss: 0.0000594
	speed: 0.3053s/iter; left time: 5804.5206s
Epoch: 54 cost time: 126.49773502349854
Epoch: 54, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.055 Vali Acc: 0.988 Test Loss: 0.055 Test Acc: 0.988
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 55 | loss: 0.0000000
	speed: 0.6029s/iter; left time: 11393.8850s
	iters: 200, epoch: 55 | loss: 0.0000000
	speed: 0.3040s/iter; left time: 5714.4208s
	iters: 300, epoch: 55 | loss: 0.0000001
	speed: 0.3071s/iter; left time: 5742.6177s
	iters: 400, epoch: 55 | loss: 0.0000119
	speed: 0.3103s/iter; left time: 5771.4467s
Epoch: 55 cost time: 127.01518559455872
Epoch: 55, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.050 Vali Acc: 0.990 Test Loss: 0.050 Test Acc: 0.990
Validation loss decreased (-0.988631 --> -0.989540).  Saving model ...
	iters: 100, epoch: 56 | loss: 0.0000163
	speed: 0.5982s/iter; left time: 11058.2904s
	iters: 200, epoch: 56 | loss: 0.0000000
	speed: 0.3196s/iter; left time: 5875.8855s
	iters: 300, epoch: 56 | loss: 0.0000024
	speed: 0.3194s/iter; left time: 5840.6473s
	iters: 400, epoch: 56 | loss: 0.0000003
	speed: 0.2890s/iter; left time: 5255.5193s
Epoch: 56 cost time: 125.83407545089722
Epoch: 56, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.055 Vali Acc: 0.989 Test Loss: 0.055 Test Acc: 0.989
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 57 | loss: 0.0000001
	speed: 0.5844s/iter; left time: 10562.1210s
	iters: 200, epoch: 57 | loss: 0.0000036
	speed: 0.3105s/iter; left time: 5579.8780s
	iters: 300, epoch: 57 | loss: 0.0000015
	speed: 0.3144s/iter; left time: 5618.5190s
	iters: 400, epoch: 57 | loss: 0.0000001
	speed: 0.2898s/iter; left time: 5150.3793s
Epoch: 57 cost time: 124.83756732940674
Epoch: 57, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.055 Vali Acc: 0.989 Test Loss: 0.055 Test Acc: 0.989
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 58 | loss: 0.0000021
	speed: 0.6207s/iter; left time: 10962.2480s
	iters: 200, epoch: 58 | loss: 0.0000049
	speed: 0.2950s/iter; left time: 5180.9244s
	iters: 300, epoch: 58 | loss: 0.0000000
	speed: 0.3088s/iter; left time: 5391.4349s
	iters: 400, epoch: 58 | loss: 0.0000046
	speed: 0.2983s/iter; left time: 5178.4387s
Epoch: 58 cost time: 125.76260995864868
Epoch: 58, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.056 Vali Acc: 0.989 Test Loss: 0.056 Test Acc: 0.989
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 59 | loss: 0.0000018
	speed: 0.6261s/iter; left time: 10798.6903s
	iters: 200, epoch: 59 | loss: 0.0000008
	speed: 0.2910s/iter; left time: 4990.6130s
	iters: 300, epoch: 59 | loss: 0.0000000
	speed: 0.3057s/iter; left time: 5211.9620s
	iters: 400, epoch: 59 | loss: 0.0000021
	speed: 0.3114s/iter; left time: 5277.8262s
Epoch: 59 cost time: 127.84960317611694
Epoch: 59, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.058 Vali Acc: 0.989 Test Loss: 0.058 Test Acc: 0.989
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 60 | loss: 0.0000000
	speed: 0.5821s/iter; left time: 9798.9937s
	iters: 200, epoch: 60 | loss: 0.0000017
	speed: 0.3030s/iter; left time: 5070.7358s
	iters: 300, epoch: 60 | loss: 0.0000002
	speed: 0.2982s/iter; left time: 4960.8317s
	iters: 400, epoch: 60 | loss: 0.0000001
	speed: 0.3023s/iter; left time: 4998.2642s
Epoch: 60 cost time: 124.70527029037476
Epoch: 60, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.990 Test Loss: 0.060 Test Acc: 0.990
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 61 | loss: 0.0000033
	speed: 0.6010s/iter; left time: 9869.2756s
	iters: 200, epoch: 61 | loss: 0.0000000
	speed: 0.2975s/iter; left time: 4855.7992s
	iters: 300, epoch: 61 | loss: 0.0000010
	speed: 0.3126s/iter; left time: 5070.9067s
	iters: 400, epoch: 61 | loss: 0.0000001
	speed: 0.2943s/iter; left time: 4744.7933s
Epoch: 61 cost time: 125.71759557723999
Epoch: 61, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.990 Test Loss: 0.059 Test Acc: 0.990
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 62 | loss: 0.0000005
	speed: 0.5727s/iter; left time: 9167.8509s
	iters: 200, epoch: 62 | loss: 0.0000144
	speed: 0.3083s/iter; left time: 4903.8976s
	iters: 300, epoch: 62 | loss: 0.0000000
	speed: 0.3127s/iter; left time: 4942.9849s
	iters: 400, epoch: 62 | loss: 0.0000002
	speed: 0.3167s/iter; left time: 4974.6081s
Epoch: 62 cost time: 127.94818139076233
Epoch: 62, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.990 Test Loss: 0.059 Test Acc: 0.990
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 63 | loss: 0.0000001
	speed: 0.5754s/iter; left time: 8973.6098s
	iters: 200, epoch: 63 | loss: 0.0000002
	speed: 0.3033s/iter; left time: 4700.2910s
	iters: 300, epoch: 63 | loss: 0.0001328
	speed: 0.3150s/iter; left time: 4849.4869s
	iters: 400, epoch: 63 | loss: 0.0000002
	speed: 0.3029s/iter; left time: 4632.2921s
Epoch: 63 cost time: 126.2056257724762
Epoch: 63, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.137 Vali Acc: 0.974 Test Loss: 0.137 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 64 | loss: 0.0029229
	speed: 0.5896s/iter; left time: 8950.5681s
	iters: 200, epoch: 64 | loss: 0.0043396
	speed: 0.2871s/iter; left time: 4329.8823s
	iters: 300, epoch: 64 | loss: 0.0011742
	speed: 0.3087s/iter; left time: 4625.4685s
	iters: 400, epoch: 64 | loss: 0.0112874
	speed: 0.2988s/iter; left time: 4446.6500s
Epoch: 64 cost time: 124.24307608604431
Epoch: 64, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.053 Vali Acc: 0.987 Test Loss: 0.053 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 65 | loss: 0.0000553
	speed: 0.6013s/iter; left time: 8880.5294s
	iters: 200, epoch: 65 | loss: 0.0003998
	speed: 0.2969s/iter; left time: 4355.1868s
	iters: 300, epoch: 65 | loss: 0.0000345
	speed: 0.2948s/iter; left time: 4295.6237s
	iters: 400, epoch: 65 | loss: 0.0002508
	speed: 0.2896s/iter; left time: 4189.5982s
Epoch: 65 cost time: 123.26475596427917
Epoch: 65, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.048 Vali Acc: 0.988 Test Loss: 0.048 Test Acc: 0.988
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df512_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9895407003183265
model parameter : 11400202
model size : 63.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df512_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3052888
	speed: 0.2994s/iter; left time: 12335.1827s
	iters: 200, epoch: 1 | loss: 0.1234639
	speed: 0.2788s/iter; left time: 11457.9570s
	iters: 300, epoch: 1 | loss: 0.2387345
	speed: 0.3066s/iter; left time: 12570.2638s
	iters: 400, epoch: 1 | loss: 0.0263125
	speed: 0.2917s/iter; left time: 11931.5937s
Epoch: 1 cost time: 121.36903285980225
Epoch: 1, Steps: 413 | Train Loss: 0.524 Vali Loss: 0.197 Vali Acc: 0.956 Test Loss: 0.197 Test Acc: 0.956
Validation loss decreased (inf --> -0.956342).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3119553
	speed: 0.5776s/iter; left time: 23559.7384s
	iters: 200, epoch: 2 | loss: 0.4013253
	speed: 0.2898s/iter; left time: 11792.1498s
	iters: 300, epoch: 2 | loss: 0.1156769
	speed: 0.2884s/iter; left time: 11704.7988s
	iters: 400, epoch: 2 | loss: 0.2875656
	speed: 0.2850s/iter; left time: 11539.9962s
Epoch: 2 cost time: 120.7162938117981
Epoch: 2, Steps: 413 | Train Loss: 0.238 Vali Loss: 0.424 Vali Acc: 0.942 Test Loss: 0.424 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0000787
	speed: 0.5771s/iter; left time: 23300.2900s
	iters: 200, epoch: 3 | loss: 0.0033450
	speed: 0.2862s/iter; left time: 11525.9080s
	iters: 300, epoch: 3 | loss: 1.7000766
	speed: 0.2878s/iter; left time: 11562.5102s
	iters: 400, epoch: 3 | loss: 0.0363495
	speed: 0.2929s/iter; left time: 11738.1123s
Epoch: 3 cost time: 120.34631395339966
Epoch: 3, Steps: 413 | Train Loss: 0.336 Vali Loss: 0.405 Vali Acc: 0.942 Test Loss: 0.405 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.4030594
	speed: 0.5681s/iter; left time: 22701.0589s
	iters: 200, epoch: 4 | loss: 0.0000318
	speed: 0.2949s/iter; left time: 11753.3509s
	iters: 300, epoch: 4 | loss: 1.0139039
	speed: 0.2951s/iter; left time: 11735.4514s
	iters: 400, epoch: 4 | loss: 0.0002467
	speed: 0.2961s/iter; left time: 11744.5749s
Epoch: 4 cost time: 122.91644930839539
Epoch: 4, Steps: 413 | Train Loss: 0.368 Vali Loss: 0.542 Vali Acc: 0.931 Test Loss: 0.542 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 2.0783792
	speed: 0.5588s/iter; left time: 22098.4683s
	iters: 200, epoch: 5 | loss: 1.4916072
	speed: 0.2760s/iter; left time: 10889.7075s
	iters: 300, epoch: 5 | loss: 0.0000753
	speed: 0.2759s/iter; left time: 10858.1535s
	iters: 400, epoch: 5 | loss: 0.9094897
	speed: 0.2758s/iter; left time: 10823.9042s
Epoch: 5 cost time: 115.58054518699646
Epoch: 5, Steps: 413 | Train Loss: 0.344 Vali Loss: 0.458 Vali Acc: 0.949 Test Loss: 0.458 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.2103588
	speed: 0.5471s/iter; left time: 21412.1380s
	iters: 200, epoch: 6 | loss: 0.0000000
	speed: 0.3028s/iter; left time: 11818.5581s
	iters: 300, epoch: 6 | loss: 0.3535367
	speed: 0.3042s/iter; left time: 11844.2481s
	iters: 400, epoch: 6 | loss: 0.0186491
	speed: 0.2944s/iter; left time: 11431.5798s
Epoch: 6 cost time: 122.4045135974884
Epoch: 6, Steps: 413 | Train Loss: 0.288 Vali Loss: 0.307 Vali Acc: 0.962 Test Loss: 0.307 Test Acc: 0.962
Validation loss decreased (-0.956342 --> -0.961798).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0004443
	speed: 0.5509s/iter; left time: 21332.9200s
	iters: 200, epoch: 7 | loss: 0.2926988
	speed: 0.2819s/iter; left time: 10889.7495s
	iters: 300, epoch: 7 | loss: 0.0002463
	speed: 0.2961s/iter; left time: 11407.3734s
	iters: 400, epoch: 7 | loss: 0.0230538
	speed: 0.2905s/iter; left time: 11162.8380s
Epoch: 7 cost time: 118.86573195457458
Epoch: 7, Steps: 413 | Train Loss: 0.237 Vali Loss: 0.370 Vali Acc: 0.961 Test Loss: 0.370 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000001
	speed: 0.5493s/iter; left time: 21044.5675s
	iters: 200, epoch: 8 | loss: 0.0004034
	speed: 0.2830s/iter; left time: 10812.6148s
	iters: 300, epoch: 8 | loss: 0.1054356
	speed: 0.2985s/iter; left time: 11377.2243s
	iters: 400, epoch: 8 | loss: 0.0000018
	speed: 0.3034s/iter; left time: 11531.9548s
Epoch: 8 cost time: 120.32691049575806
Epoch: 8, Steps: 413 | Train Loss: 0.208 Vali Loss: 0.359 Vali Acc: 0.965 Test Loss: 0.359 Test Acc: 0.965
Validation loss decreased (-0.961798 --> -0.964980).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000205
	speed: 0.5964s/iter; left time: 22601.2432s
	iters: 200, epoch: 9 | loss: 0.0235616
	speed: 0.2797s/iter; left time: 10573.7081s
	iters: 300, epoch: 9 | loss: 0.0001781
	speed: 0.2814s/iter; left time: 10609.4798s
	iters: 400, epoch: 9 | loss: 0.2330767
	speed: 0.2906s/iter; left time: 10924.8093s
Epoch: 9 cost time: 118.8485586643219
Epoch: 9, Steps: 413 | Train Loss: 0.171 Vali Loss: 0.236 Vali Acc: 0.970 Test Loss: 0.236 Test Acc: 0.970
Validation loss decreased (-0.964980 --> -0.969529).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.5766s/iter; left time: 21613.4727s
	iters: 200, epoch: 10 | loss: 0.0590272
	speed: 0.2676s/iter; left time: 10005.7007s
	iters: 300, epoch: 10 | loss: 0.0549258
	speed: 0.2918s/iter; left time: 10879.1851s
	iters: 400, epoch: 10 | loss: 0.2216176
	speed: 0.3003s/iter; left time: 11164.9030s
Epoch: 10 cost time: 118.56043267250061
Epoch: 10, Steps: 413 | Train Loss: 0.143 Vali Loss: 0.254 Vali Acc: 0.974 Test Loss: 0.254 Test Acc: 0.974
Validation loss decreased (-0.969529 --> -0.974077).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.5940s/iter; left time: 22019.9836s
	iters: 200, epoch: 11 | loss: 0.3349673
	speed: 0.2833s/iter; left time: 10474.6802s
	iters: 300, epoch: 11 | loss: 0.0000180
	speed: 0.2764s/iter; left time: 10192.6408s
	iters: 400, epoch: 11 | loss: 0.0000037
	speed: 0.3041s/iter; left time: 11183.8548s
Epoch: 11 cost time: 120.94645977020264
Epoch: 11, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.415 Vali Acc: 0.967 Test Loss: 0.415 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.3167686
	speed: 0.5762s/iter; left time: 21120.9667s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.2926s/iter; left time: 10695.8965s
	iters: 300, epoch: 12 | loss: 0.0010008
	speed: 0.2829s/iter; left time: 10315.0818s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.2918s/iter; left time: 10610.5682s
Epoch: 12 cost time: 120.56877017021179
Epoch: 12, Steps: 413 | Train Loss: 0.109 Vali Loss: 0.196 Vali Acc: 0.977 Test Loss: 0.196 Test Acc: 0.977
Validation loss decreased (-0.974077 --> -0.977260).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000003
	speed: 0.5870s/iter; left time: 21274.1003s
	iters: 200, epoch: 13 | loss: 0.0004132
	speed: 0.3050s/iter; left time: 11024.0557s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.2825s/iter; left time: 10182.5521s
	iters: 400, epoch: 13 | loss: 0.0000002
	speed: 0.2680s/iter; left time: 9633.1059s
Epoch: 13 cost time: 118.72641944885254
Epoch: 13, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.312 Vali Acc: 0.969 Test Loss: 0.312 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.5448s/iter; left time: 19521.7782s
	iters: 200, epoch: 14 | loss: 0.0000002
	speed: 0.2965s/iter; left time: 10594.2605s
	iters: 300, epoch: 14 | loss: 0.0014640
	speed: 0.2997s/iter; left time: 10677.7821s
	iters: 400, epoch: 14 | loss: 0.0000002
	speed: 0.3026s/iter; left time: 10752.5593s
Epoch: 14 cost time: 122.76854491233826
Epoch: 14, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.185 Vali Acc: 0.978 Test Loss: 0.185 Test Acc: 0.978
Validation loss decreased (-0.977260 --> -0.978170).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.5737s/iter; left time: 20319.1025s
	iters: 200, epoch: 15 | loss: 0.0004020
	speed: 0.2972s/iter; left time: 10496.9789s
	iters: 300, epoch: 15 | loss: 0.0000019
	speed: 0.2924s/iter; left time: 10297.1364s
	iters: 400, epoch: 15 | loss: 0.0001594
	speed: 0.2885s/iter; left time: 10133.2610s
Epoch: 15 cost time: 119.85561966896057
Epoch: 15, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.214 Vali Acc: 0.973 Test Loss: 0.214 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.5611s/iter; left time: 19640.8440s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.2780s/iter; left time: 9704.8982s
	iters: 300, epoch: 16 | loss: 0.0000093
	speed: 0.2824s/iter; left time: 9828.4613s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.2922s/iter; left time: 10140.8184s
Epoch: 16 cost time: 117.40242743492126
Epoch: 16, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.163 Vali Acc: 0.980 Test Loss: 0.163 Test Acc: 0.980
Validation loss decreased (-0.978170 --> -0.980444).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000401
	speed: 0.5931s/iter; left time: 20516.4890s
	iters: 200, epoch: 17 | loss: 0.0000009
	speed: 0.2870s/iter; left time: 9899.8829s
	iters: 300, epoch: 17 | loss: 0.0000054
	speed: 0.2980s/iter; left time: 10249.1974s
	iters: 400, epoch: 17 | loss: 0.0013528
	speed: 0.3068s/iter; left time: 10521.7766s
Epoch: 17 cost time: 123.6768479347229
Epoch: 17, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.277 Vali Acc: 0.979 Test Loss: 0.277 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0146823
	speed: 0.5764s/iter; left time: 19702.6359s
	iters: 200, epoch: 18 | loss: 0.0759453
	speed: 0.2935s/iter; left time: 10002.4591s
	iters: 300, epoch: 18 | loss: 0.0000001
	speed: 0.2870s/iter; left time: 9752.6640s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.2847s/iter; left time: 9645.4148s
Epoch: 18 cost time: 119.16980791091919
Epoch: 18, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.352 Vali Acc: 0.962 Test Loss: 0.352 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.5744s/iter; left time: 19395.3722s
	iters: 200, epoch: 19 | loss: 0.0000014
	speed: 0.3026s/iter; left time: 10186.0280s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.3156s/iter; left time: 10594.4751s
	iters: 400, epoch: 19 | loss: 0.0000006
	speed: 0.3094s/iter; left time: 10353.6746s
Epoch: 19 cost time: 126.92501783370972
Epoch: 19, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.231 Vali Acc: 0.974 Test Loss: 0.231 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0001153
	speed: 0.5864s/iter; left time: 19557.1196s
	iters: 200, epoch: 20 | loss: 0.0000163
	speed: 0.2959s/iter; left time: 9839.4562s
	iters: 300, epoch: 20 | loss: 0.0000003
	speed: 0.2965s/iter; left time: 9829.4678s
	iters: 400, epoch: 20 | loss: 0.0010639
	speed: 0.2858s/iter; left time: 9447.4933s
Epoch: 20 cost time: 121.65931105613708
Epoch: 20, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.201 Vali Acc: 0.980 Test Loss: 0.201 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0027134
	speed: 0.5578s/iter; left time: 18373.0946s
	iters: 200, epoch: 21 | loss: 0.0000001
	speed: 0.3022s/iter; left time: 9925.2183s
	iters: 300, epoch: 21 | loss: 0.0000075
	speed: 0.3005s/iter; left time: 9839.4315s
	iters: 400, epoch: 21 | loss: 0.0000002
	speed: 0.2983s/iter; left time: 9737.7982s
Epoch: 21 cost time: 123.07766079902649
Epoch: 21, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.243 Vali Acc: 0.972 Test Loss: 0.243 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0010365
	speed: 0.5804s/iter; left time: 18877.8804s
	iters: 200, epoch: 22 | loss: 0.0000007
	speed: 0.2858s/iter; left time: 9268.0857s
	iters: 300, epoch: 22 | loss: 0.0000046
	speed: 0.2914s/iter; left time: 9420.4255s
	iters: 400, epoch: 22 | loss: 0.0013675
	speed: 0.2981s/iter; left time: 9607.9103s
Epoch: 22 cost time: 121.27197527885437
Epoch: 22, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.251 Vali Acc: 0.973 Test Loss: 0.251 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.5725s/iter; left time: 18385.2813s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.2858s/iter; left time: 9150.0876s
	iters: 300, epoch: 23 | loss: 0.0000001
	speed: 0.3033s/iter; left time: 9680.2978s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.3010s/iter; left time: 9576.0402s
Epoch: 23 cost time: 122.47888159751892
Epoch: 23, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.216 Vali Acc: 0.974 Test Loss: 0.216 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.6062s/iter; left time: 19216.5727s
	iters: 200, epoch: 24 | loss: 0.3619275
	speed: 0.2935s/iter; left time: 9274.6299s
	iters: 300, epoch: 24 | loss: 0.0000020
	speed: 0.2777s/iter; left time: 8748.9975s
	iters: 400, epoch: 24 | loss: 0.0000157
	speed: 0.2850s/iter; left time: 8949.3777s
Epoch: 24 cost time: 120.44839811325073
Epoch: 24, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.180 Vali Acc: 0.978 Test Loss: 0.180 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0000002
	speed: 0.5816s/iter; left time: 18198.0932s
	iters: 200, epoch: 25 | loss: 0.2923737
	speed: 0.2916s/iter; left time: 9093.1613s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.2861s/iter; left time: 8893.4580s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.2870s/iter; left time: 8893.8170s
Epoch: 25 cost time: 120.27925610542297
Epoch: 25, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.154 Vali Acc: 0.978 Test Loss: 0.154 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0003954
	speed: 0.5698s/iter; left time: 17593.4241s
	iters: 200, epoch: 26 | loss: 0.0000002
	speed: 0.2979s/iter; left time: 9168.5853s
	iters: 300, epoch: 26 | loss: 0.0999840
	speed: 0.3047s/iter; left time: 9348.4521s
	iters: 400, epoch: 26 | loss: 0.0000001
	speed: 0.2920s/iter; left time: 8927.9275s
Epoch: 26 cost time: 122.24957585334778
Epoch: 26, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.147 Vali Acc: 0.979 Test Loss: 0.147 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df512_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9804456571168713
model parameter : 11400202
model size : 63.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3390505
	speed: 0.2930s/iter; left time: 12071.0241s
	iters: 200, epoch: 1 | loss: 0.6182856
	speed: 0.2825s/iter; left time: 11612.8996s
	iters: 300, epoch: 1 | loss: 0.6248479
	speed: 0.2944s/iter; left time: 12070.9726s
	iters: 400, epoch: 1 | loss: 0.0740659
	speed: 0.2913s/iter; left time: 11914.4355s
Epoch: 1 cost time: 120.0959734916687
Epoch: 1, Steps: 413 | Train Loss: 0.551 Vali Loss: 0.162 Vali Acc: 0.947 Test Loss: 0.162 Test Acc: 0.947
Validation loss decreased (inf --> -0.947247).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3115403
	speed: 0.5544s/iter; left time: 22611.7791s
	iters: 200, epoch: 2 | loss: 0.0413927
	speed: 0.2759s/iter; left time: 11224.0844s
	iters: 300, epoch: 2 | loss: 0.1204600
	speed: 0.2912s/iter; left time: 11817.6986s
	iters: 400, epoch: 2 | loss: 0.1615728
	speed: 0.3024s/iter; left time: 12244.9894s
Epoch: 2 cost time: 119.26959371566772
Epoch: 2, Steps: 413 | Train Loss: 0.284 Vali Loss: 0.524 Vali Acc: 0.928 Test Loss: 0.524 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0004755
	speed: 0.5675s/iter; left time: 22913.4826s
	iters: 200, epoch: 3 | loss: 0.1625351
	speed: 0.2850s/iter; left time: 11478.5897s
	iters: 300, epoch: 3 | loss: 0.1827402
	speed: 0.2914s/iter; left time: 11707.0157s
	iters: 400, epoch: 3 | loss: 0.0002121
	speed: 0.2878s/iter; left time: 11533.2448s
Epoch: 3 cost time: 119.82147359848022
Epoch: 3, Steps: 413 | Train Loss: 0.321 Vali Loss: 0.434 Vali Acc: 0.943 Test Loss: 0.434 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.9854810
	speed: 0.5551s/iter; left time: 22182.1791s
	iters: 200, epoch: 4 | loss: 0.0000331
	speed: 0.2874s/iter; left time: 11454.4277s
	iters: 300, epoch: 4 | loss: 0.2643954
	speed: 0.3025s/iter; left time: 12027.9487s
	iters: 400, epoch: 4 | loss: 0.0000334
	speed: 0.2947s/iter; left time: 11689.4117s
Epoch: 4 cost time: 120.47135305404663
Epoch: 4, Steps: 413 | Train Loss: 0.323 Vali Loss: 0.541 Vali Acc: 0.935 Test Loss: 0.541 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0630310
	speed: 0.5782s/iter; left time: 22868.1294s
	iters: 200, epoch: 5 | loss: 0.2687597
	speed: 0.3012s/iter; left time: 11883.9649s
	iters: 300, epoch: 5 | loss: 0.0098610
	speed: 0.2971s/iter; left time: 11688.8310s
	iters: 400, epoch: 5 | loss: 0.3173105
	speed: 0.2664s/iter; left time: 10456.2299s
Epoch: 5 cost time: 119.35344910621643
Epoch: 5, Steps: 413 | Train Loss: 0.370 Vali Loss: 0.838 Vali Acc: 0.902 Test Loss: 0.838 Test Acc: 0.902
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.1145739
	speed: 0.5507s/iter; left time: 21550.7956s
	iters: 200, epoch: 6 | loss: 0.0000289
	speed: 0.2905s/iter; left time: 11339.5257s
	iters: 300, epoch: 6 | loss: 0.0000019
	speed: 0.2898s/iter; left time: 11285.1516s
	iters: 400, epoch: 6 | loss: 0.7493274
	speed: 0.2945s/iter; left time: 11437.4051s
Epoch: 6 cost time: 120.58241629600525
Epoch: 6, Steps: 413 | Train Loss: 0.257 Vali Loss: 0.313 Vali Acc: 0.969 Test Loss: 0.313 Test Acc: 0.969
Validation loss decreased (-0.947247 --> -0.968619).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0107652
	speed: 0.5817s/iter; left time: 22527.0672s
	iters: 200, epoch: 7 | loss: 0.0000579
	speed: 0.2899s/iter; left time: 11196.3301s
	iters: 300, epoch: 7 | loss: 0.0001690
	speed: 0.2837s/iter; left time: 10927.2180s
	iters: 400, epoch: 7 | loss: 0.0092391
	speed: 0.2743s/iter; left time: 10538.0858s
Epoch: 7 cost time: 117.92642784118652
Epoch: 7, Steps: 413 | Train Loss: 0.225 Vali Loss: 0.325 Vali Acc: 0.953 Test Loss: 0.325 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.5575s/iter; left time: 21358.1467s
	iters: 200, epoch: 8 | loss: 0.0000178
	speed: 0.2979s/iter; left time: 11381.3212s
	iters: 300, epoch: 8 | loss: 0.0000001
	speed: 0.2783s/iter; left time: 10607.4845s
	iters: 400, epoch: 8 | loss: 0.2138495
	speed: 0.3000s/iter; left time: 11401.1931s
Epoch: 8 cost time: 120.84012722969055
Epoch: 8, Steps: 413 | Train Loss: 0.222 Vali Loss: 0.421 Vali Acc: 0.955 Test Loss: 0.421 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000049
	speed: 0.5783s/iter; left time: 21913.9768s
	iters: 200, epoch: 9 | loss: 1.2774690
	speed: 0.3096s/iter; left time: 11702.6821s
	iters: 300, epoch: 9 | loss: 0.0853274
	speed: 0.2897s/iter; left time: 10921.3961s
	iters: 400, epoch: 9 | loss: 0.0001647
	speed: 0.2981s/iter; left time: 11208.7818s
Epoch: 9 cost time: 123.45349192619324
Epoch: 9, Steps: 413 | Train Loss: 0.158 Vali Loss: 0.580 Vali Acc: 0.941 Test Loss: 0.580 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.5811s/iter; left time: 21780.5600s
	iters: 200, epoch: 10 | loss: 0.0003473
	speed: 0.2923s/iter; left time: 10926.9312s
	iters: 300, epoch: 10 | loss: 0.0000358
	speed: 0.2910s/iter; left time: 10849.5568s
	iters: 400, epoch: 10 | loss: 0.2823628
	speed: 0.2866s/iter; left time: 10658.6899s
Epoch: 10 cost time: 120.3618392944336
Epoch: 10, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.306 Vali Acc: 0.963 Test Loss: 0.306 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0456986
	speed: 0.5764s/iter; left time: 21367.6850s
	iters: 200, epoch: 11 | loss: 0.0205264
	speed: 0.2850s/iter; left time: 10536.0770s
	iters: 300, epoch: 11 | loss: 0.0165082
	speed: 0.3009s/iter; left time: 11096.0343s
	iters: 400, epoch: 11 | loss: 0.0000451
	speed: 0.3039s/iter; left time: 11174.4509s
Epoch: 11 cost time: 122.48604536056519
Epoch: 11, Steps: 413 | Train Loss: 0.111 Vali Loss: 0.321 Vali Acc: 0.965 Test Loss: 0.321 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0029953
	speed: 0.5792s/iter; left time: 21232.8267s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.2740s/iter; left time: 10017.2986s
	iters: 300, epoch: 12 | loss: 0.0000001
	speed: 0.2848s/iter; left time: 10383.2833s
	iters: 400, epoch: 12 | loss: 0.0000001
	speed: 0.3080s/iter; left time: 11198.0018s
Epoch: 12 cost time: 119.89946269989014
Epoch: 12, Steps: 413 | Train Loss: 0.113 Vali Loss: 0.324 Vali Acc: 0.958 Test Loss: 0.324 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000002
	speed: 0.5839s/iter; left time: 21162.3230s
	iters: 200, epoch: 13 | loss: 0.0001055
	speed: 0.2976s/iter; left time: 10757.4686s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.3050s/iter; left time: 10995.4150s
	iters: 400, epoch: 13 | loss: 0.0003865
	speed: 0.3052s/iter; left time: 10969.4950s
Epoch: 13 cost time: 124.11566352844238
Epoch: 13, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.240 Vali Acc: 0.971 Test Loss: 0.240 Test Acc: 0.971
Validation loss decreased (-0.968619 --> -0.970893).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0072162
	speed: 0.6040s/iter; left time: 21642.0595s
	iters: 200, epoch: 14 | loss: 0.0000369
	speed: 0.2891s/iter; left time: 10328.3900s
	iters: 300, epoch: 14 | loss: 0.0000002
	speed: 0.2965s/iter; left time: 10563.1298s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.2981s/iter; left time: 10593.5425s
Epoch: 14 cost time: 122.9240357875824
Epoch: 14, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.144 Vali Acc: 0.975 Test Loss: 0.144 Test Acc: 0.975
Validation loss decreased (-0.970893 --> -0.974532).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000060
	speed: 0.5630s/iter; left time: 19942.0276s
	iters: 200, epoch: 15 | loss: 0.0010011
	speed: 0.2804s/iter; left time: 9905.0607s
	iters: 300, epoch: 15 | loss: 0.0002232
	speed: 0.3168s/iter; left time: 11158.9399s
	iters: 400, epoch: 15 | loss: 0.0000004
	speed: 0.2926s/iter; left time: 10276.5679s
Epoch: 15 cost time: 121.81548404693604
Epoch: 15, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.197 Vali Acc: 0.977 Test Loss: 0.197 Test Acc: 0.977
Validation loss decreased (-0.974532 --> -0.977260).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.5982s/iter; left time: 20941.8960s
	iters: 200, epoch: 16 | loss: 0.4873884
	speed: 0.2976s/iter; left time: 10389.5439s
	iters: 300, epoch: 16 | loss: 0.0000002
	speed: 0.2921s/iter; left time: 10165.4040s
	iters: 400, epoch: 16 | loss: 0.0000020
	speed: 0.2912s/iter; left time: 10107.6563s
Epoch: 16 cost time: 122.88714623451233
Epoch: 16, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.163 Vali Acc: 0.981 Test Loss: 0.163 Test Acc: 0.981
Validation loss decreased (-0.977260 --> -0.980899).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0005717
	speed: 0.5891s/iter; left time: 20377.9389s
	iters: 200, epoch: 17 | loss: 0.0000001
	speed: 0.2989s/iter; left time: 10311.1450s
	iters: 300, epoch: 17 | loss: 0.4400380
	speed: 0.3139s/iter; left time: 10796.8582s
	iters: 400, epoch: 17 | loss: 0.0000013
	speed: 0.2880s/iter; left time: 9875.7554s
Epoch: 17 cost time: 123.50004553794861
Epoch: 17, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.159 Vali Acc: 0.981 Test Loss: 0.159 Test Acc: 0.981
Validation loss decreased (-0.980899 --> -0.980899).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000003
	speed: 0.5805s/iter; left time: 19840.4300s
	iters: 200, epoch: 18 | loss: 0.0018201
	speed: 0.3051s/iter; left time: 10397.3613s
	iters: 300, epoch: 18 | loss: 0.0130356
	speed: 0.2999s/iter; left time: 10191.7210s
	iters: 400, epoch: 18 | loss: 0.0000562
	speed: 0.2795s/iter; left time: 9470.6141s
Epoch: 18 cost time: 122.52213430404663
Epoch: 18, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.270 Vali Acc: 0.971 Test Loss: 0.270 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.5548s/iter; left time: 18734.4041s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.2932s/iter; left time: 9871.8434s
	iters: 300, epoch: 19 | loss: 0.0172766
	speed: 0.2770s/iter; left time: 9299.5985s
	iters: 400, epoch: 19 | loss: 0.8682721
	speed: 0.2881s/iter; left time: 9641.6261s
Epoch: 19 cost time: 118.88963627815247
Epoch: 19, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.293 Vali Acc: 0.968 Test Loss: 0.293 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000223
	speed: 0.5858s/iter; left time: 19538.8031s
	iters: 200, epoch: 20 | loss: 0.0000107
	speed: 0.3142s/iter; left time: 10448.9038s
	iters: 300, epoch: 20 | loss: 0.0005849
	speed: 0.2936s/iter; left time: 9733.1176s
	iters: 400, epoch: 20 | loss: 0.0902324
	speed: 0.2928s/iter; left time: 9678.8878s
Epoch: 20 cost time: 124.33692812919617
Epoch: 20, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.348 Vali Acc: 0.956 Test Loss: 0.348 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0005318
	speed: 0.5997s/iter; left time: 19755.3091s
	iters: 200, epoch: 21 | loss: 0.0000903
	speed: 0.3100s/iter; left time: 10180.6566s
	iters: 300, epoch: 21 | loss: 0.0000002
	speed: 0.2861s/iter; left time: 9365.9874s
	iters: 400, epoch: 21 | loss: 0.0000047
	speed: 0.2906s/iter; left time: 9484.5094s
Epoch: 21 cost time: 123.99851107597351
Epoch: 21, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.112 Vali Acc: 0.979 Test Loss: 0.112 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0929008
	speed: 0.5850s/iter; left time: 19029.3008s
	iters: 200, epoch: 22 | loss: 0.0014820
	speed: 0.3045s/iter; left time: 9875.3551s
	iters: 300, epoch: 22 | loss: 0.0000012
	speed: 0.3010s/iter; left time: 9731.0686s
	iters: 400, epoch: 22 | loss: 0.0000318
	speed: 0.2903s/iter; left time: 9355.8653s
Epoch: 22 cost time: 124.22875428199768
Epoch: 22, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.252 Vali Acc: 0.969 Test Loss: 0.252 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.6017s/iter; left time: 19323.4531s
	iters: 200, epoch: 23 | loss: 0.0000465
	speed: 0.3046s/iter; left time: 9751.1134s
	iters: 300, epoch: 23 | loss: 0.0017755
	speed: 0.3006s/iter; left time: 9592.7327s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.2969s/iter; left time: 9445.3803s
Epoch: 23 cost time: 125.3578131198883
Epoch: 23, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.275 Vali Acc: 0.965 Test Loss: 0.275 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0016625
	speed: 0.6034s/iter; left time: 19127.6579s
	iters: 200, epoch: 24 | loss: 0.0001335
	speed: 0.2896s/iter; left time: 9152.3431s
	iters: 300, epoch: 24 | loss: 0.0000001
	speed: 0.3038s/iter; left time: 9569.6304s
	iters: 400, epoch: 24 | loss: 0.0000476
	speed: 0.2917s/iter; left time: 9158.6306s
Epoch: 24 cost time: 123.78905034065247
Epoch: 24, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.328 Vali Acc: 0.960 Test Loss: 0.328 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0000005
	speed: 0.6046s/iter; left time: 18918.4641s
	iters: 200, epoch: 25 | loss: 0.0000008
	speed: 0.3022s/iter; left time: 9426.0356s
	iters: 300, epoch: 25 | loss: 0.0135510
	speed: 0.2913s/iter; left time: 9057.7653s
	iters: 400, epoch: 25 | loss: 0.0212924
	speed: 0.2964s/iter; left time: 9184.3211s
Epoch: 25 cost time: 123.6025071144104
Epoch: 25, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.161 Vali Acc: 0.975 Test Loss: 0.161 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0000094
	speed: 0.5924s/iter; left time: 18289.4977s
	iters: 200, epoch: 26 | loss: 0.0000003
	speed: 0.2941s/iter; left time: 9051.2375s
	iters: 300, epoch: 26 | loss: 0.0741629
	speed: 0.2968s/iter; left time: 9103.4505s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.3138s/iter; left time: 9595.6359s
Epoch: 26 cost time: 125.471506357193
Epoch: 26, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.187 Vali Acc: 0.978 Test Loss: 0.187 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.6158s/iter; left time: 18760.3193s
	iters: 200, epoch: 27 | loss: 0.0000059
	speed: 0.3084s/iter; left time: 9363.1215s
	iters: 300, epoch: 27 | loss: 0.0000001
	speed: 0.3031s/iter; left time: 9173.3320s
	iters: 400, epoch: 27 | loss: 0.0000132
	speed: 0.2938s/iter; left time: 8863.3697s
Epoch: 27 cost time: 126.17215180397034
Epoch: 27, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9809004092769441
model parameter : 11400202
model size : 63.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3027076
	speed: 0.3086s/iter; left time: 12713.2344s
	iters: 200, epoch: 1 | loss: 0.4504572
	speed: 0.2802s/iter; left time: 11516.3301s
	iters: 300, epoch: 1 | loss: 0.5616860
	speed: 0.2743s/iter; left time: 11244.6378s
	iters: 400, epoch: 1 | loss: 0.0061574
	speed: 0.2837s/iter; left time: 11605.2623s
Epoch: 1 cost time: 118.71596884727478
Epoch: 1, Steps: 413 | Train Loss: 0.552 Vali Loss: 0.196 Vali Acc: 0.954 Test Loss: 0.196 Test Acc: 0.954
Validation loss decreased (inf --> -0.953613).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4165344
	speed: 0.6127s/iter; left time: 24989.7204s
	iters: 200, epoch: 2 | loss: 0.0242474
	speed: 0.2703s/iter; left time: 10998.8276s
	iters: 300, epoch: 2 | loss: 0.4848602
	speed: 0.2710s/iter; left time: 10997.7428s
	iters: 400, epoch: 2 | loss: 0.6178572
	speed: 0.2793s/iter; left time: 11307.9979s
Epoch: 2 cost time: 116.75210690498352
Epoch: 2, Steps: 413 | Train Loss: 0.277 Vali Loss: 0.387 Vali Acc: 0.938 Test Loss: 0.387 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.5139696
	speed: 0.5454s/iter; left time: 22018.9094s
	iters: 200, epoch: 3 | loss: 0.0000700
	speed: 0.2845s/iter; left time: 11458.9657s
	iters: 300, epoch: 3 | loss: 1.1018349
	speed: 0.2796s/iter; left time: 11234.8009s
	iters: 400, epoch: 3 | loss: 0.0021596
	speed: 0.2634s/iter; left time: 10554.3437s
Epoch: 3 cost time: 113.66570615768433
Epoch: 3, Steps: 413 | Train Loss: 0.361 Vali Loss: 0.327 Vali Acc: 0.947 Test Loss: 0.327 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0641320
	speed: 0.5423s/iter; left time: 21670.0960s
	iters: 200, epoch: 4 | loss: 0.3892705
	speed: 0.2779s/iter; left time: 11076.9832s
	iters: 300, epoch: 4 | loss: 0.0000907
	speed: 0.2744s/iter; left time: 10909.4276s
	iters: 400, epoch: 4 | loss: 0.9538215
	speed: 0.2735s/iter; left time: 10846.1637s
Epoch: 4 cost time: 114.55233192443848
Epoch: 4, Steps: 413 | Train Loss: 0.374 Vali Loss: 0.626 Vali Acc: 0.921 Test Loss: 0.626 Test Acc: 0.921
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.4694536
	speed: 0.5436s/iter; left time: 21497.0271s
	iters: 200, epoch: 5 | loss: 0.0302446
	speed: 0.2723s/iter; left time: 10740.0428s
	iters: 300, epoch: 5 | loss: 0.0211676
	speed: 0.2604s/iter; left time: 10245.5702s
	iters: 400, epoch: 5 | loss: 0.0015722
	speed: 0.2707s/iter; left time: 10624.1039s
Epoch: 5 cost time: 111.47635626792908
Epoch: 5, Steps: 413 | Train Loss: 0.410 Vali Loss: 0.392 Vali Acc: 0.940 Test Loss: 0.392 Test Acc: 0.940
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0000213
	speed: 0.5689s/iter; left time: 22265.0416s
	iters: 200, epoch: 6 | loss: 0.0613608
	speed: 0.2779s/iter; left time: 10849.5209s
	iters: 300, epoch: 6 | loss: 0.8261296
	speed: 0.2820s/iter; left time: 10978.6899s
	iters: 400, epoch: 6 | loss: 0.3554394
	speed: 0.2825s/iter; left time: 10970.7528s
Epoch: 6 cost time: 116.07766723632812
Epoch: 6, Steps: 413 | Train Loss: 0.326 Vali Loss: 0.590 Vali Acc: 0.938 Test Loss: 0.590 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0001105
	speed: 0.5268s/iter; left time: 20400.8287s
	iters: 200, epoch: 7 | loss: 0.1431007
	speed: 0.2831s/iter; left time: 10934.9561s
	iters: 300, epoch: 7 | loss: 0.0000375
	speed: 0.2777s/iter; left time: 10699.3055s
	iters: 400, epoch: 7 | loss: 0.0000414
	speed: 0.2748s/iter; left time: 10559.1882s
Epoch: 7 cost time: 113.71973419189453
Epoch: 7, Steps: 413 | Train Loss: 0.300 Vali Loss: 0.274 Vali Acc: 0.961 Test Loss: 0.274 Test Acc: 0.961
Validation loss decreased (-0.953613 --> -0.961343).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000004
	speed: 0.5552s/iter; left time: 21267.8861s
	iters: 200, epoch: 8 | loss: 0.0031136
	speed: 0.2815s/iter; left time: 10757.5203s
	iters: 300, epoch: 8 | loss: 0.0000051
	speed: 0.2807s/iter; left time: 10697.8161s
	iters: 400, epoch: 8 | loss: 0.0000001
	speed: 0.2838s/iter; left time: 10788.3019s
Epoch: 8 cost time: 116.6596429347992
Epoch: 8, Steps: 413 | Train Loss: 0.285 Vali Loss: 0.413 Vali Acc: 0.957 Test Loss: 0.413 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000712
	speed: 0.5578s/iter; left time: 21137.9504s
	iters: 200, epoch: 9 | loss: 2.9121342
	speed: 0.2696s/iter; left time: 10190.6817s
	iters: 300, epoch: 9 | loss: 0.1773803
	speed: 0.2757s/iter; left time: 10391.4928s
	iters: 400, epoch: 9 | loss: 0.1288567
	speed: 0.2777s/iter; left time: 10441.1639s
Epoch: 9 cost time: 114.05476140975952
Epoch: 9, Steps: 413 | Train Loss: 0.217 Vali Loss: 0.480 Vali Acc: 0.952 Test Loss: 0.480 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000014
	speed: 0.5680s/iter; left time: 21289.9597s
	iters: 200, epoch: 10 | loss: 0.7373195
	speed: 0.2880s/iter; left time: 10768.0035s
	iters: 300, epoch: 10 | loss: 0.0000015
	speed: 0.2820s/iter; left time: 10513.4607s
	iters: 400, epoch: 10 | loss: 0.0491589
	speed: 0.2811s/iter; left time: 10454.1350s
Epoch: 10 cost time: 117.34155464172363
Epoch: 10, Steps: 413 | Train Loss: 0.212 Vali Loss: 0.327 Vali Acc: 0.965 Test Loss: 0.327 Test Acc: 0.965
Validation loss decreased (-0.961343 --> -0.964981).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000313
	speed: 0.5639s/iter; left time: 20902.9735s
	iters: 200, epoch: 11 | loss: 0.0000573
	speed: 0.2827s/iter; left time: 10451.2980s
	iters: 300, epoch: 11 | loss: 0.0000025
	speed: 0.2839s/iter; left time: 10467.5242s
	iters: 400, epoch: 11 | loss: 0.0000752
	speed: 0.2809s/iter; left time: 10330.0137s
Epoch: 11 cost time: 117.44824314117432
Epoch: 11, Steps: 413 | Train Loss: 0.164 Vali Loss: 0.217 Vali Acc: 0.972 Test Loss: 0.217 Test Acc: 0.972
Validation loss decreased (-0.964981 --> -0.972258).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.8871679
	speed: 0.5499s/iter; left time: 20157.9375s
	iters: 200, epoch: 12 | loss: 0.0103459
	speed: 0.2591s/iter; left time: 9471.1087s
	iters: 300, epoch: 12 | loss: 0.3878539
	speed: 0.2860s/iter; left time: 10428.7018s
	iters: 400, epoch: 12 | loss: 0.0000007
	speed: 0.2858s/iter; left time: 10391.6045s
Epoch: 12 cost time: 114.13016653060913
Epoch: 12, Steps: 413 | Train Loss: 0.128 Vali Loss: 0.244 Vali Acc: 0.973 Test Loss: 0.244 Test Acc: 0.973
Validation loss decreased (-0.972258 --> -0.972712).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.5500s/iter; left time: 19934.7933s
	iters: 200, epoch: 13 | loss: 0.0092397
	speed: 0.2935s/iter; left time: 10607.8092s
	iters: 300, epoch: 13 | loss: 0.0010271
	speed: 0.3051s/iter; left time: 10996.3214s
	iters: 400, epoch: 13 | loss: 0.1747723
	speed: 0.3035s/iter; left time: 10907.8278s
Epoch: 13 cost time: 122.14653491973877
Epoch: 13, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.364 Vali Acc: 0.965 Test Loss: 0.364 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0016181
	speed: 0.6163s/iter; left time: 22084.3483s
	iters: 200, epoch: 14 | loss: 0.2659301
	speed: 0.2869s/iter; left time: 10250.7555s
	iters: 300, epoch: 14 | loss: 0.3039924
	speed: 0.2812s/iter; left time: 10019.0801s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.2928s/iter; left time: 10405.1065s
Epoch: 14 cost time: 121.08824896812439
Epoch: 14, Steps: 413 | Train Loss: 0.156 Vali Loss: 0.391 Vali Acc: 0.960 Test Loss: 0.391 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000054
	speed: 0.5678s/iter; left time: 20109.1428s
	iters: 200, epoch: 15 | loss: 0.0000094
	speed: 0.3159s/iter; left time: 11158.0817s
	iters: 300, epoch: 15 | loss: 0.0000131
	speed: 0.3101s/iter; left time: 10919.7554s
	iters: 400, epoch: 15 | loss: 0.0012279
	speed: 0.2968s/iter; left time: 10423.9858s
Epoch: 15 cost time: 124.28420519828796
Epoch: 15, Steps: 413 | Train Loss: 0.112 Vali Loss: 0.277 Vali Acc: 0.965 Test Loss: 0.277 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000609
	speed: 0.6054s/iter; left time: 21194.2476s
	iters: 200, epoch: 16 | loss: 0.0088229
	speed: 0.3270s/iter; left time: 11414.7456s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.2993s/iter; left time: 10417.0003s
	iters: 400, epoch: 16 | loss: 0.0000005
	speed: 0.3016s/iter; left time: 10467.7463s
Epoch: 16 cost time: 128.90210700035095
Epoch: 16, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.275 Vali Acc: 0.971 Test Loss: 0.275 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000012
	speed: 0.5688s/iter; left time: 19678.0469s
	iters: 200, epoch: 17 | loss: 0.0000049
	speed: 0.2954s/iter; left time: 10188.2676s
	iters: 300, epoch: 17 | loss: 0.4112216
	speed: 0.3017s/iter; left time: 10377.9976s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.2968s/iter; left time: 10179.3426s
Epoch: 17 cost time: 122.00400471687317
Epoch: 17, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.445 Vali Acc: 0.963 Test Loss: 0.445 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 2.4852397
	speed: 0.5914s/iter; left time: 20212.8965s
	iters: 200, epoch: 18 | loss: 0.0000035
	speed: 0.3096s/iter; left time: 10549.8813s
	iters: 300, epoch: 18 | loss: 0.1283446
	speed: 0.3125s/iter; left time: 10617.6337s
	iters: 400, epoch: 18 | loss: 0.0000010
	speed: 0.3073s/iter; left time: 10411.3063s
Epoch: 18 cost time: 127.00203514099121
Epoch: 18, Steps: 413 | Train Loss: 0.114 Vali Loss: 0.377 Vali Acc: 0.968 Test Loss: 0.377 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0005799
	speed: 0.6009s/iter; left time: 20289.2998s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.3074s/iter; left time: 10348.8705s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.3166s/iter; left time: 10627.4047s
	iters: 400, epoch: 19 | loss: 0.9555272
	speed: 0.2863s/iter; left time: 9582.7089s
Epoch: 19 cost time: 124.34130501747131
Epoch: 19, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.190 Vali Acc: 0.972 Test Loss: 0.190 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.6297612
	speed: 0.5965s/iter; left time: 19895.8493s
	iters: 200, epoch: 20 | loss: 0.0000024
	speed: 0.3005s/iter; left time: 9992.3568s
	iters: 300, epoch: 20 | loss: 0.0000669
	speed: 0.2993s/iter; left time: 9923.8819s
	iters: 400, epoch: 20 | loss: 0.0089291
	speed: 0.3026s/iter; left time: 10001.1768s
Epoch: 20 cost time: 124.16894102096558
Epoch: 20, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.471 Vali Acc: 0.949 Test Loss: 0.471 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0001325
	speed: 0.6107s/iter; left time: 20115.6775s
	iters: 200, epoch: 21 | loss: 0.0000002
	speed: 0.3154s/iter; left time: 10357.0094s
	iters: 300, epoch: 21 | loss: 0.0000006
	speed: 0.3077s/iter; left time: 10072.8034s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.3044s/iter; left time: 9934.6383s
Epoch: 21 cost time: 127.86940360069275
Epoch: 21, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.337 Vali Acc: 0.964 Test Loss: 0.337 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0006715
	speed: 0.6067s/iter; left time: 19733.8416s
	iters: 200, epoch: 22 | loss: 0.0000574
	speed: 0.3340s/iter; left time: 10830.1433s
	iters: 300, epoch: 22 | loss: 0.0032561
	speed: 0.3061s/iter; left time: 9895.8051s
	iters: 400, epoch: 22 | loss: 0.0000270
	speed: 0.3012s/iter; left time: 9708.5628s
Epoch: 22 cost time: 128.2479546070099
Epoch: 22, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.371 Vali Acc: 0.966 Test Loss: 0.371 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9727148703956344
model parameter : 11400202
model size : 63.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3357043
	speed: 0.3146s/iter; left time: 12960.9390s
	iters: 200, epoch: 1 | loss: 0.6237943
	speed: 0.2959s/iter; left time: 12163.6448s
	iters: 300, epoch: 1 | loss: 0.2459688
	speed: 0.2732s/iter; left time: 11199.6592s
	iters: 400, epoch: 1 | loss: 0.0878603
	speed: 0.3021s/iter; left time: 12356.5794s
Epoch: 1 cost time: 122.66503238677979
Epoch: 1, Steps: 413 | Train Loss: 0.515 Vali Loss: 0.189 Vali Acc: 0.949 Test Loss: 0.189 Test Acc: 0.949
Validation loss decreased (inf --> -0.948611).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6126283
	speed: 0.5765s/iter; left time: 23514.4083s
	iters: 200, epoch: 2 | loss: 0.5233594
	speed: 0.2900s/iter; left time: 11798.2785s
	iters: 300, epoch: 2 | loss: 0.0792149
	speed: 0.2861s/iter; left time: 11612.3447s
	iters: 400, epoch: 2 | loss: 0.9263883
	speed: 0.2963s/iter; left time: 11995.8449s
Epoch: 2 cost time: 121.1579360961914
Epoch: 2, Steps: 413 | Train Loss: 0.263 Vali Loss: 0.218 Vali Acc: 0.960 Test Loss: 0.218 Test Acc: 0.960
Validation loss decreased (-0.948611 --> -0.959980).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1334848
	speed: 0.6069s/iter; left time: 24501.8124s
	iters: 200, epoch: 3 | loss: 0.0002614
	speed: 0.2978s/iter; left time: 11992.7183s
	iters: 300, epoch: 3 | loss: 0.4698256
	speed: 0.2760s/iter; left time: 11087.5338s
	iters: 400, epoch: 3 | loss: 0.1777047
	speed: 0.3026s/iter; left time: 12125.9618s
Epoch: 3 cost time: 123.41613531112671
Epoch: 3, Steps: 413 | Train Loss: 0.347 Vali Loss: 0.276 Vali Acc: 0.957 Test Loss: 0.276 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.5827731
	speed: 0.5708s/iter; left time: 22810.9575s
	iters: 200, epoch: 4 | loss: 0.2433678
	speed: 0.3027s/iter; left time: 12066.6060s
	iters: 300, epoch: 4 | loss: 0.7849439
	speed: 0.2989s/iter; left time: 11884.7815s
	iters: 400, epoch: 4 | loss: 0.1451472
	speed: 0.3066s/iter; left time: 12159.4092s
Epoch: 4 cost time: 124.92173838615417
Epoch: 4, Steps: 413 | Train Loss: 0.370 Vali Loss: 0.498 Vali Acc: 0.940 Test Loss: 0.498 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0154860
	speed: 0.6052s/iter; left time: 23933.3718s
	iters: 200, epoch: 5 | loss: 0.2839507
	speed: 0.2989s/iter; left time: 11791.6335s
	iters: 300, epoch: 5 | loss: 0.0000000
	speed: 0.2781s/iter; left time: 10943.5133s
	iters: 400, epoch: 5 | loss: 0.0004173
	speed: 0.3154s/iter; left time: 12377.7091s
Epoch: 5 cost time: 123.92822027206421
Epoch: 5, Steps: 413 | Train Loss: 0.310 Vali Loss: 0.504 Vali Acc: 0.950 Test Loss: 0.504 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0000460
	speed: 0.5796s/iter; left time: 22681.3884s
	iters: 200, epoch: 6 | loss: 0.0602206
	speed: 0.3103s/iter; left time: 12114.2638s
	iters: 300, epoch: 6 | loss: 0.2069769
	speed: 0.2952s/iter; left time: 11493.2594s
	iters: 400, epoch: 6 | loss: 0.0055230
	speed: 0.2889s/iter; left time: 11219.7233s
Epoch: 6 cost time: 122.47664093971252
Epoch: 6, Steps: 413 | Train Loss: 0.258 Vali Loss: 0.457 Vali Acc: 0.958 Test Loss: 0.457 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.1626846
	speed: 0.5753s/iter; left time: 22277.5662s
	iters: 200, epoch: 7 | loss: 0.0265881
	speed: 0.3088s/iter; left time: 11927.2929s
	iters: 300, epoch: 7 | loss: 0.0132202
	speed: 0.2947s/iter; left time: 11351.8080s
	iters: 400, epoch: 7 | loss: 0.0014125
	speed: 0.2934s/iter; left time: 11273.8602s
Epoch: 7 cost time: 122.54793572425842
Epoch: 7, Steps: 413 | Train Loss: 0.260 Vali Loss: 0.322 Vali Acc: 0.960 Test Loss: 0.322 Test Acc: 0.960
Validation loss decreased (-0.959980 --> -0.960433).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.4332724
	speed: 0.5874s/iter; left time: 22503.8046s
	iters: 200, epoch: 8 | loss: 2.8613997
	speed: 0.3067s/iter; left time: 11719.8461s
	iters: 300, epoch: 8 | loss: 0.0517897
	speed: 0.2828s/iter; left time: 10776.6034s
	iters: 400, epoch: 8 | loss: 0.3052569
	speed: 0.2822s/iter; left time: 10726.7780s
Epoch: 8 cost time: 120.43109512329102
Epoch: 8, Steps: 413 | Train Loss: 0.217 Vali Loss: 0.582 Vali Acc: 0.948 Test Loss: 0.582 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000854
	speed: 0.5811s/iter; left time: 22021.5323s
	iters: 200, epoch: 9 | loss: 0.0000148
	speed: 0.2928s/iter; left time: 11065.3467s
	iters: 300, epoch: 9 | loss: 0.4578035
	speed: 0.2963s/iter; left time: 11169.2890s
	iters: 400, epoch: 9 | loss: 0.0017324
	speed: 0.2985s/iter; left time: 11222.7673s
Epoch: 9 cost time: 122.26196265220642
Epoch: 9, Steps: 413 | Train Loss: 0.185 Vali Loss: 0.734 Vali Acc: 0.935 Test Loss: 0.734 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000001
	speed: 0.5694s/iter; left time: 21343.9777s
	iters: 200, epoch: 10 | loss: 0.0000015
	speed: 0.2988s/iter; left time: 11169.5291s
	iters: 300, epoch: 10 | loss: 1.8812982
	speed: 0.3061s/iter; left time: 11412.4373s
	iters: 400, epoch: 10 | loss: 0.3512076
	speed: 0.2871s/iter; left time: 10675.6892s
Epoch: 10 cost time: 120.73929452896118
Epoch: 10, Steps: 413 | Train Loss: 0.192 Vali Loss: 0.403 Vali Acc: 0.962 Test Loss: 0.403 Test Acc: 0.962
Validation loss decreased (-0.960433 --> -0.961797).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.5664s/iter; left time: 20996.1039s
	iters: 200, epoch: 11 | loss: 0.0000005
	speed: 0.2738s/iter; left time: 10121.9189s
	iters: 300, epoch: 11 | loss: 0.0000017
	speed: 0.2746s/iter; left time: 10126.0403s
	iters: 400, epoch: 11 | loss: 0.1168091
	speed: 0.2760s/iter; left time: 10148.6306s
Epoch: 11 cost time: 114.25287914276123
Epoch: 11, Steps: 413 | Train Loss: 0.145 Vali Loss: 0.356 Vali Acc: 0.960 Test Loss: 0.356 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000003
	speed: 0.5660s/iter; left time: 20749.7723s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.2931s/iter; left time: 10714.6752s
	iters: 300, epoch: 12 | loss: 0.0051974
	speed: 0.2822s/iter; left time: 10288.7738s
	iters: 400, epoch: 12 | loss: 0.0012216
	speed: 0.2672s/iter; left time: 9715.5179s
Epoch: 12 cost time: 117.41529989242554
Epoch: 12, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.228 Vali Acc: 0.973 Test Loss: 0.228 Test Acc: 0.973
Validation loss decreased (-0.961797 --> -0.973167).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000007
	speed: 0.5444s/iter; left time: 19733.0495s
	iters: 200, epoch: 13 | loss: 0.0031816
	speed: 0.2814s/iter; left time: 10169.7306s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.2827s/iter; left time: 10191.1538s
	iters: 400, epoch: 13 | loss: 0.0404191
	speed: 0.2765s/iter; left time: 9937.4642s
Epoch: 13 cost time: 115.15182518959045
Epoch: 13, Steps: 413 | Train Loss: 0.129 Vali Loss: 0.228 Vali Acc: 0.974 Test Loss: 0.228 Test Acc: 0.974
Validation loss decreased (-0.973167 --> -0.973622).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.5575s/iter; left time: 19974.7302s
	iters: 200, epoch: 14 | loss: 0.0000006
	speed: 0.2794s/iter; left time: 9982.2118s
	iters: 300, epoch: 14 | loss: 0.6934246
	speed: 0.2898s/iter; left time: 10326.0920s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.2813s/iter; left time: 9994.4345s
Epoch: 14 cost time: 116.6901285648346
Epoch: 14, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.279 Vali Acc: 0.970 Test Loss: 0.279 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0937206
	speed: 0.5443s/iter; left time: 19280.0857s
	iters: 200, epoch: 15 | loss: 0.0001256
	speed: 0.2633s/iter; left time: 9300.2633s
	iters: 300, epoch: 15 | loss: 0.3219021
	speed: 0.2772s/iter; left time: 9763.2697s
	iters: 400, epoch: 15 | loss: 0.0091166
	speed: 0.2780s/iter; left time: 9762.8994s
Epoch: 15 cost time: 113.50139284133911
Epoch: 15, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.368 Vali Acc: 0.962 Test Loss: 0.368 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0039643
	speed: 0.5461s/iter; left time: 19118.3104s
	iters: 200, epoch: 16 | loss: 0.0000043
	speed: 0.2758s/iter; left time: 9628.6739s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.2848s/iter; left time: 9912.2503s
	iters: 400, epoch: 16 | loss: 0.0000031
	speed: 0.2934s/iter; left time: 10181.9875s
Epoch: 16 cost time: 117.0036449432373
Epoch: 16, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.229 Vali Acc: 0.970 Test Loss: 0.229 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.5749s/iter; left time: 19888.1002s
	iters: 200, epoch: 17 | loss: 0.2226600
	speed: 0.2681s/iter; left time: 9246.4303s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.2725s/iter; left time: 9371.6535s
	iters: 400, epoch: 17 | loss: 0.0000020
	speed: 0.2716s/iter; left time: 9315.4375s
Epoch: 17 cost time: 114.06239223480225
Epoch: 17, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.232 Vali Acc: 0.970 Test Loss: 0.232 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0002076
	speed: 0.5588s/iter; left time: 19098.4465s
	iters: 200, epoch: 18 | loss: 0.2634367
	speed: 0.2821s/iter; left time: 9615.5322s
	iters: 300, epoch: 18 | loss: 0.0182117
	speed: 0.2817s/iter; left time: 9571.1135s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.2734s/iter; left time: 9261.6277s
Epoch: 18 cost time: 116.4405996799469
Epoch: 18, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.239 Vali Acc: 0.971 Test Loss: 0.239 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.5614s/iter; left time: 18957.7376s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.2805s/iter; left time: 9442.1340s
	iters: 300, epoch: 19 | loss: 0.0000012
	speed: 0.2773s/iter; left time: 9306.8451s
	iters: 400, epoch: 19 | loss: 0.0034694
	speed: 0.2800s/iter; left time: 9372.4298s
Epoch: 19 cost time: 117.00086641311646
Epoch: 19, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.373 Vali Acc: 0.961 Test Loss: 0.373 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0000123
	speed: 0.5587s/iter; left time: 18634.3370s
	iters: 200, epoch: 20 | loss: 0.0000003
	speed: 0.3086s/iter; left time: 10261.4484s
	iters: 300, epoch: 20 | loss: 0.2408955
	speed: 0.2919s/iter; left time: 9678.5845s
	iters: 400, epoch: 20 | loss: 0.0001862
	speed: 0.2880s/iter; left time: 9520.0935s
Epoch: 20 cost time: 121.6425392627716
Epoch: 20, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.252 Vali Acc: 0.973 Test Loss: 0.252 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0003485
	speed: 0.5434s/iter; left time: 17900.1987s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.2760s/iter; left time: 9065.7274s
	iters: 300, epoch: 21 | loss: 0.0000019
	speed: 0.2960s/iter; left time: 9692.9553s
	iters: 400, epoch: 21 | loss: 0.0409129
	speed: 0.2949s/iter; left time: 9626.6641s
Epoch: 21 cost time: 118.11183333396912
Epoch: 21, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.264 Vali Acc: 0.970 Test Loss: 0.264 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0000434
	speed: 0.5609s/iter; left time: 18244.6786s
	iters: 200, epoch: 22 | loss: 0.0230375
	speed: 0.2897s/iter; left time: 9393.4052s
	iters: 300, epoch: 22 | loss: 0.0000016
	speed: 0.2995s/iter; left time: 9681.3874s
	iters: 400, epoch: 22 | loss: 0.0000004
	speed: 0.3019s/iter; left time: 9731.1209s
Epoch: 22 cost time: 121.9211003780365
Epoch: 22, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.267 Vali Acc: 0.969 Test Loss: 0.267 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0000007
	speed: 0.5474s/iter; left time: 17579.2950s
	iters: 200, epoch: 23 | loss: 0.0000651
	speed: 0.2641s/iter; left time: 8455.1818s
	iters: 300, epoch: 23 | loss: 0.0000004
	speed: 0.3019s/iter; left time: 9635.8931s
	iters: 400, epoch: 23 | loss: 0.0010455
	speed: 0.3054s/iter; left time: 9715.7839s
Epoch: 23 cost time: 119.7900857925415
Epoch: 23, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.220 Vali Acc: 0.975 Test Loss: 0.220 Test Acc: 0.975
Validation loss decreased (-0.973622 --> -0.974986).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.5806s/iter; left time: 18405.8866s
	iters: 200, epoch: 24 | loss: 0.0000067
	speed: 0.2843s/iter; left time: 8983.0641s
	iters: 300, epoch: 24 | loss: 0.0002080
	speed: 0.3047s/iter; left time: 9597.2934s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.2915s/iter; left time: 9152.3503s
Epoch: 24 cost time: 120.19837474822998
Epoch: 24, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.379 Vali Acc: 0.961 Test Loss: 0.379 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0000143
	speed: 0.5558s/iter; left time: 17389.3278s
	iters: 200, epoch: 25 | loss: 0.0164081
	speed: 0.2825s/iter; left time: 8810.9553s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.2810s/iter; left time: 8736.2565s
	iters: 400, epoch: 25 | loss: 0.0000002
	speed: 0.2873s/iter; left time: 8903.3096s
Epoch: 25 cost time: 117.68103694915771
Epoch: 25, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.262 Vali Acc: 0.973 Test Loss: 0.262 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0000031
	speed: 0.5774s/iter; left time: 17828.8864s
	iters: 200, epoch: 26 | loss: 0.0000002
	speed: 0.2801s/iter; left time: 8621.0966s
	iters: 300, epoch: 26 | loss: 0.3279450
	speed: 0.2872s/iter; left time: 8811.2407s
	iters: 400, epoch: 26 | loss: 0.0000032
	speed: 0.2779s/iter; left time: 8497.9723s
Epoch: 26 cost time: 118.08154892921448
Epoch: 26, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.305 Vali Acc: 0.968 Test Loss: 0.305 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0000014
	speed: 0.5916s/iter; left time: 18021.2566s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.3000s/iter; left time: 9110.0504s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.2893s/iter; left time: 8755.4167s
	iters: 400, epoch: 27 | loss: 0.0000079
	speed: 0.2897s/iter; left time: 8739.0268s
Epoch: 27 cost time: 123.03114366531372
Epoch: 27, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.387 Vali Acc: 0.967 Test Loss: 0.387 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0000001
	speed: 0.5598s/iter; left time: 16820.8006s
	iters: 200, epoch: 28 | loss: 0.1211595
	speed: 0.2988s/iter; left time: 8950.1244s
	iters: 300, epoch: 28 | loss: 0.0237940
	speed: 0.3018s/iter; left time: 9007.7907s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.2963s/iter; left time: 8814.4582s
Epoch: 28 cost time: 122.78380703926086
Epoch: 28, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.122 Vali Acc: 0.981 Test Loss: 0.122 Test Acc: 0.981
Validation loss decreased (-0.974986 --> -0.980899).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0000131
	speed: 0.6170s/iter; left time: 18285.2863s
	iters: 200, epoch: 29 | loss: 0.0615241
	speed: 0.2904s/iter; left time: 8577.4042s
	iters: 300, epoch: 29 | loss: 0.0000003
	speed: 0.2876s/iter; left time: 8467.1958s
	iters: 400, epoch: 29 | loss: 0.0823852
	speed: 0.2720s/iter; left time: 7980.8506s
Epoch: 29 cost time: 119.66800689697266
Epoch: 29, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.158 Vali Acc: 0.973 Test Loss: 0.158 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0000011
	speed: 0.5541s/iter; left time: 16193.1458s
	iters: 200, epoch: 30 | loss: 0.0000170
	speed: 0.3029s/iter; left time: 8820.8731s
	iters: 300, epoch: 30 | loss: 0.0000030
	speed: 0.3128s/iter; left time: 9079.1376s
	iters: 400, epoch: 30 | loss: 0.0070582
	speed: 0.2860s/iter; left time: 8272.2603s
Epoch: 30 cost time: 123.9762954711914
Epoch: 30, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.206 Vali Acc: 0.974 Test Loss: 0.206 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.5623s/iter; left time: 16199.9977s
	iters: 200, epoch: 31 | loss: 0.0000002
	speed: 0.2997s/iter; left time: 8603.4936s
	iters: 300, epoch: 31 | loss: 0.0000028
	speed: 0.2897s/iter; left time: 8287.8891s
	iters: 400, epoch: 31 | loss: 0.0000388
	speed: 0.2921s/iter; left time: 8326.7438s
Epoch: 31 cost time: 120.72408318519592
Epoch: 31, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.223 Vali Acc: 0.973 Test Loss: 0.223 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.0000004
	speed: 0.5602s/iter; left time: 15908.8821s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.2884s/iter; left time: 8160.7372s
	iters: 300, epoch: 32 | loss: 0.0000001
	speed: 0.2905s/iter; left time: 8191.3809s
	iters: 400, epoch: 32 | loss: 0.0000007
	speed: 0.3016s/iter; left time: 8475.3540s
Epoch: 32 cost time: 121.75601506233215
Epoch: 32, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.144 Vali Acc: 0.978 Test Loss: 0.144 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.0000006
	speed: 0.5634s/iter; left time: 15766.9156s
	iters: 200, epoch: 33 | loss: 0.0000060
	speed: 0.2876s/iter; left time: 8019.9250s
	iters: 300, epoch: 33 | loss: 0.0000004
	speed: 0.2914s/iter; left time: 8097.5860s
	iters: 400, epoch: 33 | loss: 0.0000051
	speed: 0.2939s/iter; left time: 8137.4786s
Epoch: 33 cost time: 121.26469588279724
Epoch: 33, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.169 Vali Acc: 0.972 Test Loss: 0.169 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.0000043
	speed: 0.5602s/iter; left time: 15445.2896s
	iters: 200, epoch: 34 | loss: 0.0000224
	speed: 0.2802s/iter; left time: 7698.8264s
	iters: 300, epoch: 34 | loss: 0.0007027
	speed: 0.2831s/iter; left time: 7748.4969s
	iters: 400, epoch: 34 | loss: 0.0000026
	speed: 0.3041s/iter; left time: 8293.9473s
Epoch: 34 cost time: 118.83211016654968
Epoch: 34, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.085 Vali Acc: 0.982 Test Loss: 0.085 Test Acc: 0.982
Validation loss decreased (-0.980899 --> -0.982264).  Saving model ...
	iters: 100, epoch: 35 | loss: 0.0000007
	speed: 0.5880s/iter; left time: 15970.0698s
	iters: 200, epoch: 35 | loss: 0.0000002
	speed: 0.2941s/iter; left time: 7959.3036s
	iters: 300, epoch: 35 | loss: 0.0028201
	speed: 0.2804s/iter; left time: 7558.7285s
	iters: 400, epoch: 35 | loss: 0.0001805
	speed: 0.2956s/iter; left time: 7938.6698s
Epoch: 35 cost time: 121.059730052948
Epoch: 35, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.050 Vali Acc: 0.986 Test Loss: 0.050 Test Acc: 0.986
Validation loss decreased (-0.982264 --> -0.986357).  Saving model ...
	iters: 100, epoch: 36 | loss: 0.0000062
	speed: 0.5789s/iter; left time: 15483.1020s
	iters: 200, epoch: 36 | loss: 0.0000010
	speed: 0.2971s/iter; left time: 7916.6737s
	iters: 300, epoch: 36 | loss: 0.0000223
	speed: 0.2890s/iter; left time: 7672.3350s
	iters: 400, epoch: 36 | loss: 0.1787110
	speed: 0.2875s/iter; left time: 7602.4211s
Epoch: 36 cost time: 120.77631378173828
Epoch: 36, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.088 Vali Acc: 0.984 Test Loss: 0.088 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 0.0000068
	speed: 0.5966s/iter; left time: 15710.8333s
	iters: 200, epoch: 37 | loss: 0.0006315
	speed: 0.2887s/iter; left time: 7573.0471s
	iters: 300, epoch: 37 | loss: 0.0000099
	speed: 0.2977s/iter; left time: 7779.2558s
	iters: 400, epoch: 37 | loss: 0.0000898
	speed: 0.2949s/iter; left time: 7676.6854s
Epoch: 37 cost time: 122.98588585853577
Epoch: 37, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.076 Vali Acc: 0.984 Test Loss: 0.076 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 0.0000432
	speed: 0.6006s/iter; left time: 15568.2945s
	iters: 200, epoch: 38 | loss: 0.0000146
	speed: 0.2940s/iter; left time: 7591.6686s
	iters: 300, epoch: 38 | loss: 0.0000795
	speed: 0.3008s/iter; left time: 7737.7443s
	iters: 400, epoch: 38 | loss: 0.0000326
	speed: 0.2997s/iter; left time: 7677.8612s
Epoch: 38 cost time: 124.4643166065216
Epoch: 38, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.070 Vali Acc: 0.988 Test Loss: 0.070 Test Acc: 0.988
Validation loss decreased (-0.986357 --> -0.987721).  Saving model ...
	iters: 100, epoch: 39 | loss: 0.0000038
	speed: 0.5873s/iter; left time: 14979.7546s
	iters: 200, epoch: 39 | loss: 0.0000021
	speed: 0.3107s/iter; left time: 7893.3486s
	iters: 300, epoch: 39 | loss: 0.0000277
	speed: 0.3047s/iter; left time: 7712.2281s
	iters: 400, epoch: 39 | loss: 0.0000024
	speed: 0.2938s/iter; left time: 7404.8899s
Epoch: 39 cost time: 125.47731685638428
Epoch: 39, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.985 Test Loss: 0.079 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 40 | loss: 0.0000104
	speed: 0.5934s/iter; left time: 14891.3316s
	iters: 200, epoch: 40 | loss: 0.0000007
	speed: 0.2866s/iter; left time: 7162.0830s
	iters: 300, epoch: 40 | loss: 0.0000080
	speed: 0.2926s/iter; left time: 7285.1115s
	iters: 400, epoch: 40 | loss: 0.0000530
	speed: 0.2942s/iter; left time: 7294.8015s
Epoch: 40 cost time: 121.63119006156921
Epoch: 40, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.052 Vali Acc: 0.986 Test Loss: 0.052 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 41 | loss: 0.0000022
	speed: 0.5840s/iter; left time: 14412.7509s
	iters: 200, epoch: 41 | loss: 0.0000057
	speed: 0.2997s/iter; left time: 7365.7876s
	iters: 300, epoch: 41 | loss: 0.0000118
	speed: 0.3032s/iter; left time: 7423.4693s
	iters: 400, epoch: 41 | loss: 0.0000001
	speed: 0.3005s/iter; left time: 7325.5176s
Epoch: 41 cost time: 124.69277501106262
Epoch: 41, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.048 Vali Acc: 0.987 Test Loss: 0.048 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 42 | loss: 0.0000018
	speed: 0.5838s/iter; left time: 14167.6690s
	iters: 200, epoch: 42 | loss: 0.0000001
	speed: 0.3006s/iter; left time: 7263.8212s
	iters: 300, epoch: 42 | loss: 0.0000068
	speed: 0.3024s/iter; left time: 7277.7224s
	iters: 400, epoch: 42 | loss: 0.0000057
	speed: 0.3049s/iter; left time: 7308.2072s
Epoch: 42 cost time: 124.00220084190369
Epoch: 42, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.044 Vali Acc: 0.988 Test Loss: 0.044 Test Acc: 0.988
Validation loss decreased (-0.987721 --> -0.987721).  Saving model ...
	iters: 100, epoch: 43 | loss: 0.0000176
	speed: 0.5779s/iter; left time: 13786.1044s
	iters: 200, epoch: 43 | loss: 0.0000720
	speed: 0.2896s/iter; left time: 6878.4171s
	iters: 300, epoch: 43 | loss: 0.0000820
	speed: 0.2879s/iter; left time: 6809.9385s
	iters: 400, epoch: 43 | loss: 0.0000011
	speed: 0.2806s/iter; left time: 6609.8078s
Epoch: 43 cost time: 118.8087112903595
Epoch: 43, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 44 | loss: 0.0001005
	speed: 0.5573s/iter; left time: 13063.3309s
	iters: 200, epoch: 44 | loss: 0.0000001
	speed: 0.2884s/iter; left time: 6732.0583s
	iters: 300, epoch: 44 | loss: 0.0000031
	speed: 0.2874s/iter; left time: 6680.6287s
	iters: 400, epoch: 44 | loss: 0.0000016
	speed: 0.2754s/iter; left time: 6372.9127s
Epoch: 44 cost time: 117.44967031478882
Epoch: 44, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.049 Vali Acc: 0.988 Test Loss: 0.049 Test Acc: 0.988
Validation loss decreased (-0.987721 --> -0.988176).  Saving model ...
	iters: 100, epoch: 45 | loss: 0.0000001
	speed: 0.5401s/iter; left time: 12438.7549s
	iters: 200, epoch: 45 | loss: 0.0005316
	speed: 0.2784s/iter; left time: 6384.2474s
	iters: 300, epoch: 45 | loss: 0.0363315
	speed: 0.2857s/iter; left time: 6523.3054s
	iters: 400, epoch: 45 | loss: 0.0382844
	speed: 0.2770s/iter; left time: 6296.4382s
Epoch: 45 cost time: 114.87691640853882
Epoch: 45, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.171 Vali Acc: 0.967 Test Loss: 0.171 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 46 | loss: 0.0001081
	speed: 0.5472s/iter; left time: 12374.7651s
	iters: 200, epoch: 46 | loss: 0.0000566
	speed: 0.2759s/iter; left time: 6212.2403s
	iters: 300, epoch: 46 | loss: 0.0005090
	speed: 0.2764s/iter; left time: 6196.0236s
	iters: 400, epoch: 46 | loss: 0.0000586
	speed: 0.2791s/iter; left time: 6228.8981s
Epoch: 46 cost time: 114.52905297279358
Epoch: 46, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.121 Vali Acc: 0.969 Test Loss: 0.121 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 47 | loss: 0.0010761
	speed: 0.5506s/iter; left time: 12224.9588s
	iters: 200, epoch: 47 | loss: 0.0011541
	speed: 0.2870s/iter; left time: 6342.8263s
	iters: 300, epoch: 47 | loss: 0.0000063
	speed: 0.2823s/iter; left time: 6212.3349s
	iters: 400, epoch: 47 | loss: 0.0000021
	speed: 0.2700s/iter; left time: 5912.9231s
Epoch: 47 cost time: 115.88974714279175
Epoch: 47, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 48 | loss: 0.0000164
	speed: 0.5530s/iter; left time: 12050.2275s
	iters: 200, epoch: 48 | loss: 0.0000156
	speed: 0.2888s/iter; left time: 6263.6368s
	iters: 300, epoch: 48 | loss: 0.0001123
	speed: 0.2815s/iter; left time: 6078.0662s
	iters: 400, epoch: 48 | loss: 0.0000085
	speed: 0.2803s/iter; left time: 6024.5536s
Epoch: 48 cost time: 117.53841781616211
Epoch: 48, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.985 Test Loss: 0.063 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 49 | loss: 0.0000220
	speed: 0.5471s/iter; left time: 11696.2848s
	iters: 200, epoch: 49 | loss: 0.0000052
	speed: 0.2848s/iter; left time: 6060.5908s
	iters: 300, epoch: 49 | loss: 0.0000599
	speed: 0.2872s/iter; left time: 6082.7110s
	iters: 400, epoch: 49 | loss: 0.0025618
	speed: 0.2741s/iter; left time: 5776.8720s
Epoch: 49 cost time: 116.34535145759583
Epoch: 49, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.986 Test Loss: 0.062 Test Acc: 0.986
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 50 | loss: 0.0000015
	speed: 0.5428s/iter; left time: 11379.0448s
	iters: 200, epoch: 50 | loss: 0.0000056
	speed: 0.2815s/iter; left time: 5872.5088s
	iters: 300, epoch: 50 | loss: 0.0000105
	speed: 0.2763s/iter; left time: 5736.9798s
	iters: 400, epoch: 50 | loss: 0.0000879
	speed: 0.2705s/iter; left time: 5589.2981s
Epoch: 50 cost time: 114.05193638801575
Epoch: 50, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.986 Test Loss: 0.061 Test Acc: 0.986
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 51 | loss: 0.0000018
	speed: 0.5747s/iter; left time: 11810.7539s
	iters: 200, epoch: 51 | loss: 0.0000024
	speed: 0.2857s/iter; left time: 5841.8348s
	iters: 300, epoch: 51 | loss: 0.0002186
	speed: 0.2770s/iter; left time: 5637.3500s
	iters: 400, epoch: 51 | loss: 0.0000122
	speed: 0.2822s/iter; left time: 5714.0454s
Epoch: 51 cost time: 117.96675419807434
Epoch: 51, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.986 Test Loss: 0.061 Test Acc: 0.986
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 52 | loss: 0.0000102
	speed: 0.5551s/iter; left time: 11178.4117s
	iters: 200, epoch: 52 | loss: 0.0000030
	speed: 0.2842s/iter; left time: 5695.2824s
	iters: 300, epoch: 52 | loss: 0.0000563
	speed: 0.2732s/iter; left time: 5446.1135s
	iters: 400, epoch: 52 | loss: 0.0000009
	speed: 0.2703s/iter; left time: 5361.8863s
Epoch: 52 cost time: 115.05123329162598
Epoch: 52, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.986 Test Loss: 0.061 Test Acc: 0.986
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 53 | loss: 0.0000015
	speed: 0.5644s/iter; left time: 11133.5991s
	iters: 200, epoch: 53 | loss: 0.0000017
	speed: 0.2755s/iter; left time: 5406.9803s
	iters: 300, epoch: 53 | loss: 0.0000019
	speed: 0.2771s/iter; left time: 5409.7022s
	iters: 400, epoch: 53 | loss: 0.0000162
	speed: 0.2793s/iter; left time: 5426.1519s
Epoch: 53 cost time: 116.21034383773804
Epoch: 53, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.986 Test Loss: 0.060 Test Acc: 0.986
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 54 | loss: 0.0000154
	speed: 0.5693s/iter; left time: 10994.2866s
	iters: 200, epoch: 54 | loss: 0.0000006
	speed: 0.2920s/iter; left time: 5610.7480s
	iters: 300, epoch: 54 | loss: 0.0000366
	speed: 0.2806s/iter; left time: 5362.0920s
	iters: 400, epoch: 54 | loss: 0.0000004
	speed: 0.2741s/iter; left time: 5211.4538s
Epoch: 54 cost time: 117.3779444694519
Epoch: 54, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.987 Test Loss: 0.060 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9881764438381082
model parameter : 11400202
model size : 63.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.3026659
	speed: 0.2905s/iter; left time: 11967.2272s
	iters: 200, epoch: 1 | loss: 2.3020713
	speed: 0.2642s/iter; left time: 10859.4832s
	iters: 300, epoch: 1 | loss: 2.3026516
	speed: 0.2649s/iter; left time: 10862.6473s
	iters: 400, epoch: 1 | loss: 2.3020792
	speed: 0.2944s/iter; left time: 12040.6960s
Epoch: 1 cost time: 115.28566527366638
Epoch: 1, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (inf --> -0.100022).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3032434
	speed: 0.5698s/iter; left time: 23241.7863s
	iters: 200, epoch: 2 | loss: 2.3018954
	speed: 0.3028s/iter; left time: 12320.9744s
	iters: 300, epoch: 2 | loss: 2.3020730
	speed: 0.2914s/iter; left time: 11827.7594s
	iters: 400, epoch: 2 | loss: 2.3026512
	speed: 0.2905s/iter; left time: 11760.0568s
Epoch: 2 cost time: 121.09442520141602
Epoch: 2, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3021669
	speed: 0.5781s/iter; left time: 23340.8243s
	iters: 200, epoch: 3 | loss: 2.3024726
	speed: 0.2676s/iter; left time: 10779.2629s
	iters: 300, epoch: 3 | loss: 2.3049350
	speed: 0.2705s/iter; left time: 10867.6313s
	iters: 400, epoch: 3 | loss: 2.3032331
	speed: 0.2873s/iter; left time: 11511.8816s
Epoch: 3 cost time: 114.48717975616455
Epoch: 3, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.3026674
	speed: 0.5545s/iter; left time: 22160.3477s
	iters: 200, epoch: 4 | loss: 2.3034530
	speed: 0.2897s/iter; left time: 11546.9182s
	iters: 300, epoch: 4 | loss: 2.3016636
	speed: 0.2888s/iter; left time: 11483.8848s
	iters: 400, epoch: 4 | loss: 2.3026187
	speed: 0.3078s/iter; left time: 12207.7421s
Epoch: 4 cost time: 120.48803424835205
Epoch: 4, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.3002403
	speed: 0.5831s/iter; left time: 23060.3064s
	iters: 200, epoch: 5 | loss: 2.3026822
	speed: 0.2798s/iter; left time: 11036.0738s
	iters: 300, epoch: 5 | loss: 2.3025792
	speed: 0.2904s/iter; left time: 11426.1047s
	iters: 400, epoch: 5 | loss: 2.3021932
	speed: 0.2879s/iter; left time: 11298.6069s
Epoch: 5 cost time: 119.69967889785767
Epoch: 5, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 2.3029425
	speed: 0.5305s/iter; left time: 20759.7593s
	iters: 200, epoch: 6 | loss: 2.3041329
	speed: 0.2779s/iter; left time: 10847.6861s
	iters: 300, epoch: 6 | loss: 2.3021750
	speed: 0.2843s/iter; left time: 11069.8989s
	iters: 400, epoch: 6 | loss: 2.3021708
	speed: 0.2943s/iter; left time: 11430.6508s
Epoch: 6 cost time: 116.86584663391113
Epoch: 6, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 2.3015978
	speed: 0.5783s/iter; left time: 22394.7518s
	iters: 200, epoch: 7 | loss: 2.3012044
	speed: 0.2807s/iter; left time: 10841.8973s
	iters: 300, epoch: 7 | loss: 2.3035858
	speed: 0.2924s/iter; left time: 11263.9146s
	iters: 400, epoch: 7 | loss: 2.3040707
	speed: 0.2948s/iter; left time: 11326.0900s
Epoch: 7 cost time: 119.97453427314758
Epoch: 7, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 2.3022215
	speed: 0.5394s/iter; left time: 20665.9830s
	iters: 200, epoch: 8 | loss: 2.3065188
	speed: 0.2827s/iter; left time: 10803.3055s
	iters: 300, epoch: 8 | loss: 2.3048837
	speed: 0.2914s/iter; left time: 11104.8354s
	iters: 400, epoch: 8 | loss: 2.3052776
	speed: 0.2880s/iter; left time: 10946.7495s
Epoch: 8 cost time: 118.48493361473083
Epoch: 8, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 2.3033581
	speed: 0.5529s/iter; left time: 20952.3762s
	iters: 200, epoch: 9 | loss: 2.3063185
	speed: 0.3027s/iter; left time: 11442.0721s
	iters: 300, epoch: 9 | loss: 2.2998972
	speed: 0.2989s/iter; left time: 11265.8714s
	iters: 400, epoch: 9 | loss: 2.3046064
	speed: 0.2847s/iter; left time: 10705.3309s
Epoch: 9 cost time: 119.96450781822205
Epoch: 9, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 2.3034265
	speed: 0.5497s/iter; left time: 20606.0418s
	iters: 200, epoch: 10 | loss: 2.3031712
	speed: 0.2868s/iter; left time: 10722.1612s
	iters: 300, epoch: 10 | loss: 2.3008792
	speed: 0.2986s/iter; left time: 11133.8259s
	iters: 400, epoch: 10 | loss: 2.3034618
	speed: 0.2833s/iter; left time: 10533.9846s
Epoch: 10 cost time: 118.93402361869812
Epoch: 10, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 2.2990458
	speed: 0.5583s/iter; left time: 20698.2861s
	iters: 200, epoch: 11 | loss: 2.3022349
	speed: 0.3038s/iter; left time: 11232.1459s
	iters: 300, epoch: 11 | loss: 2.3045545
	speed: 0.3058s/iter; left time: 11274.3058s
	iters: 400, epoch: 11 | loss: 2.3046308
	speed: 0.2823s/iter; left time: 10381.0378s
Epoch: 11 cost time: 122.31861758232117
Epoch: 11, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 2.3053665
	speed: 0.5770s/iter; left time: 21152.9337s
	iters: 200, epoch: 12 | loss: 2.3043673
	speed: 0.2934s/iter; left time: 10724.3062s
	iters: 300, epoch: 12 | loss: 2.3041210
	speed: 0.2824s/iter; left time: 10295.0168s
	iters: 400, epoch: 12 | loss: 2.3048477
	speed: 0.2814s/iter; left time: 10230.7625s
Epoch: 12 cost time: 119.78715872764587
Epoch: 12, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.3021080
	speed: 0.5786s/iter; left time: 20970.8647s
	iters: 200, epoch: 13 | loss: 2.3040607
	speed: 0.2936s/iter; left time: 10610.7008s
	iters: 300, epoch: 13 | loss: 2.3058360
	speed: 0.2842s/iter; left time: 10244.8579s
	iters: 400, epoch: 13 | loss: 2.3017466
	speed: 0.2899s/iter; left time: 10419.9410s
Epoch: 13 cost time: 119.93388199806213
Epoch: 13, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 2.3002331
	speed: 0.5768s/iter; left time: 20666.9488s
	iters: 200, epoch: 14 | loss: 2.3049486
	speed: 0.2826s/iter; left time: 10098.2627s
	iters: 300, epoch: 14 | loss: 2.3020515
	speed: 0.2764s/iter; left time: 9847.4946s
	iters: 400, epoch: 14 | loss: 2.3026218
	speed: 0.2903s/iter; left time: 10315.0176s
Epoch: 14 cost time: 118.66844582557678
Epoch: 14, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 2.3038824
	speed: 0.5859s/iter; left time: 20753.1431s
	iters: 200, epoch: 15 | loss: 2.3038211
	speed: 0.2918s/iter; left time: 10306.5995s
	iters: 300, epoch: 15 | loss: 2.3043988
	speed: 0.2895s/iter; left time: 10197.3344s
	iters: 400, epoch: 15 | loss: 2.3039224
	speed: 0.2883s/iter; left time: 10125.7894s
Epoch: 15 cost time: 120.75273299217224
Epoch: 15, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 2.3040650
	speed: 0.5652s/iter; left time: 19785.6225s
	iters: 200, epoch: 16 | loss: 2.3034523
	speed: 0.2777s/iter; left time: 9693.7571s
	iters: 300, epoch: 16 | loss: 2.3020144
	speed: 0.2710s/iter; left time: 9433.6655s
	iters: 400, epoch: 16 | loss: 2.3016944
	speed: 0.2989s/iter; left time: 10373.6762s
Epoch: 16 cost time: 117.84073781967163
Epoch: 16, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 2.3016803
	speed: 0.5822s/iter; left time: 20139.5300s
	iters: 200, epoch: 17 | loss: 2.3010302
	speed: 0.3121s/iter; left time: 10765.1721s
	iters: 300, epoch: 17 | loss: 2.3033524
	speed: 0.2983s/iter; left time: 10258.2033s
	iters: 400, epoch: 17 | loss: 2.3032069
	speed: 0.2968s/iter; left time: 10178.8462s
Epoch: 17 cost time: 123.86281061172485
Epoch: 17, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 2.3031049
	speed: 0.5533s/iter; left time: 18911.7670s
	iters: 200, epoch: 18 | loss: 2.3039460
	speed: 0.2788s/iter; left time: 9500.9964s
	iters: 300, epoch: 18 | loss: 2.3051324
	speed: 0.2700s/iter; left time: 9174.0770s
	iters: 400, epoch: 18 | loss: 2.3023753
	speed: 0.2631s/iter; left time: 8915.4395s
Epoch: 18 cost time: 112.954669713974
Epoch: 18, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 2.3029768
	speed: 0.5599s/iter; left time: 18907.1696s
	iters: 200, epoch: 19 | loss: 2.3064535
	speed: 0.2742s/iter; left time: 9230.7023s
	iters: 300, epoch: 19 | loss: 2.3002503
	speed: 0.2778s/iter; left time: 9325.2037s
	iters: 400, epoch: 19 | loss: 2.3013985
	speed: 0.2872s/iter; left time: 9613.2347s
Epoch: 19 cost time: 116.39114451408386
Epoch: 19, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 2.3031049
	speed: 0.5646s/iter; left time: 18830.0982s
	iters: 200, epoch: 20 | loss: 2.3042157
	speed: 0.2708s/iter; left time: 9006.6615s
	iters: 300, epoch: 20 | loss: 2.3016076
	speed: 0.2802s/iter; left time: 9291.3043s
	iters: 400, epoch: 20 | loss: 2.3047023
	speed: 0.2718s/iter; left time: 8983.4535s
Epoch: 20 cost time: 114.05715012550354
Epoch: 20, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 2.3020849
	speed: 0.5297s/iter; left time: 17450.3844s
	iters: 200, epoch: 21 | loss: 2.3051291
	speed: 0.2825s/iter; left time: 9279.0165s
	iters: 300, epoch: 21 | loss: 2.3061342
	speed: 0.2729s/iter; left time: 8935.9173s
	iters: 400, epoch: 21 | loss: 2.3044221
	speed: 0.2757s/iter; left time: 9000.1870s
Epoch: 21 cost time: 114.00744915008545
Epoch: 21, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 2.3029165
	speed: 0.5720s/iter; left time: 18605.4168s
	iters: 200, epoch: 22 | loss: 2.3027890
	speed: 0.2792s/iter; left time: 9053.4055s
	iters: 300, epoch: 22 | loss: 2.3023186
	speed: 0.2699s/iter; left time: 8724.5708s
	iters: 400, epoch: 22 | loss: 2.3045731
	speed: 0.2852s/iter; left time: 9191.3424s
Epoch: 22 cost time: 116.362957239151
Epoch: 22, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.10004547521600728
model parameter : 11400202
model size : 63.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         47                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df256_ma47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0486747
	speed: 0.2871s/iter; left time: 11828.6256s
	iters: 200, epoch: 1 | loss: 0.4632372
	speed: 0.2834s/iter; left time: 11646.7739s
	iters: 300, epoch: 1 | loss: 0.1673881
	speed: 0.2787s/iter; left time: 11426.9951s
	iters: 400, epoch: 1 | loss: 0.0000667
	speed: 0.2781s/iter; left time: 11375.8945s
Epoch: 1 cost time: 116.66680717468262
Epoch: 1, Steps: 413 | Train Loss: 0.334 Vali Loss: 0.148 Vali Acc: 0.960 Test Loss: 0.148 Test Acc: 0.960
Validation loss decreased (inf --> -0.960435).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5569804
	speed: 0.5723s/iter; left time: 23341.4685s
	iters: 200, epoch: 2 | loss: 0.0226236
	speed: 0.2834s/iter; left time: 11529.7996s
	iters: 300, epoch: 2 | loss: 0.0001998
	speed: 0.2723s/iter; left time: 11050.4924s
	iters: 400, epoch: 2 | loss: 0.0006108
	speed: 0.2716s/iter; left time: 10995.0254s
Epoch: 2 cost time: 116.35596370697021
Epoch: 2, Steps: 413 | Train Loss: 0.185 Vali Loss: 0.153 Vali Acc: 0.966 Test Loss: 0.153 Test Acc: 0.966
Validation loss decreased (-0.960435 --> -0.965892).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0077823
	speed: 0.5560s/iter; left time: 22449.9431s
	iters: 200, epoch: 3 | loss: 0.0001209
	speed: 0.2663s/iter; left time: 10725.0654s
	iters: 300, epoch: 3 | loss: 0.0032194
	speed: 0.2793s/iter; left time: 11220.0932s
	iters: 400, epoch: 3 | loss: 0.2125862
	speed: 0.2809s/iter; left time: 11255.7302s
Epoch: 3 cost time: 114.02131342887878
Epoch: 3, Steps: 413 | Train Loss: 0.257 Vali Loss: 0.437 Vali Acc: 0.949 Test Loss: 0.437 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0857562
	speed: 0.5464s/iter; left time: 21834.3311s
	iters: 200, epoch: 4 | loss: 0.1631189
	speed: 0.2799s/iter; left time: 11156.5964s
	iters: 300, epoch: 4 | loss: 1.7404556
	speed: 0.2956s/iter; left time: 11753.4544s
	iters: 400, epoch: 4 | loss: 0.4136346
	speed: 0.2753s/iter; left time: 10919.8161s
Epoch: 4 cost time: 117.12955665588379
Epoch: 4, Steps: 413 | Train Loss: 0.311 Vali Loss: 0.544 Vali Acc: 0.941 Test Loss: 0.544 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.7930267
	speed: 0.5727s/iter; left time: 22647.7771s
	iters: 200, epoch: 5 | loss: 1.1908901
	speed: 0.2899s/iter; left time: 11434.5354s
	iters: 300, epoch: 5 | loss: 0.0001861
	speed: 0.2694s/iter; left time: 10602.2440s
	iters: 400, epoch: 5 | loss: 0.0018356
	speed: 0.2790s/iter; left time: 10952.3035s
Epoch: 5 cost time: 118.49762463569641
Epoch: 5, Steps: 413 | Train Loss: 0.382 Vali Loss: 0.632 Vali Acc: 0.931 Test Loss: 0.632 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0000014
	speed: 0.5650s/iter; left time: 22112.2863s
	iters: 200, epoch: 6 | loss: 0.6217334
	speed: 0.2742s/iter; left time: 10702.1446s
	iters: 300, epoch: 6 | loss: 0.0068681
	speed: 0.2834s/iter; left time: 11035.1630s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.2899s/iter; left time: 11258.9512s
Epoch: 6 cost time: 117.47615790367126
Epoch: 6, Steps: 413 | Train Loss: 0.341 Vali Loss: 0.206 Vali Acc: 0.974 Test Loss: 0.206 Test Acc: 0.974
Validation loss decreased (-0.965892 --> -0.974077).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1663902
	speed: 0.5624s/iter; left time: 21777.9919s
	iters: 200, epoch: 7 | loss: 0.0042408
	speed: 0.2916s/iter; left time: 11262.3561s
	iters: 300, epoch: 7 | loss: 0.4537704
	speed: 0.2789s/iter; left time: 10745.5988s
	iters: 400, epoch: 7 | loss: 0.0003407
	speed: 0.2785s/iter; left time: 10700.7886s
Epoch: 7 cost time: 117.33498954772949
Epoch: 7, Steps: 413 | Train Loss: 0.387 Vali Loss: 0.374 Vali Acc: 0.957 Test Loss: 0.374 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.6049902
	speed: 0.5804s/iter; left time: 22236.6186s
	iters: 200, epoch: 8 | loss: 0.0000001
	speed: 0.2759s/iter; left time: 10543.9269s
	iters: 300, epoch: 8 | loss: 0.0000004
	speed: 0.2717s/iter; left time: 10353.5697s
	iters: 400, epoch: 8 | loss: 0.6426656
	speed: 0.2767s/iter; left time: 10516.9260s
Epoch: 8 cost time: 116.69475817680359
Epoch: 8, Steps: 413 | Train Loss: 0.285 Vali Loss: 0.368 Vali Acc: 0.966 Test Loss: 0.368 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000091
	speed: 0.5492s/iter; left time: 20811.3903s
	iters: 200, epoch: 9 | loss: 0.0000009
	speed: 0.2619s/iter; left time: 9897.6690s
	iters: 300, epoch: 9 | loss: 0.0000403
	speed: 0.2753s/iter; left time: 10378.5698s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.2839s/iter; left time: 10672.0532s
Epoch: 9 cost time: 113.51585221290588
Epoch: 9, Steps: 413 | Train Loss: 0.274 Vali Loss: 0.472 Vali Acc: 0.961 Test Loss: 0.472 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0078264
	speed: 0.5523s/iter; left time: 20701.2975s
	iters: 200, epoch: 10 | loss: 0.7029969
	speed: 0.2864s/iter; left time: 10708.2131s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.2811s/iter; left time: 10482.2611s
	iters: 400, epoch: 10 | loss: 0.0001866
	speed: 0.2809s/iter; left time: 10445.4094s
Epoch: 10 cost time: 116.98780465126038
Epoch: 10, Steps: 413 | Train Loss: 0.269 Vali Loss: 0.299 Vali Acc: 0.972 Test Loss: 0.299 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000001
	speed: 0.5524s/iter; left time: 20478.0609s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.2779s/iter; left time: 10275.1216s
	iters: 300, epoch: 11 | loss: 0.8076004
	speed: 0.2653s/iter; left time: 9780.4494s
	iters: 400, epoch: 11 | loss: 0.0000008
	speed: 0.2708s/iter; left time: 9957.1458s
Epoch: 11 cost time: 114.74085855484009
Epoch: 11, Steps: 413 | Train Loss: 0.239 Vali Loss: 0.367 Vali Acc: 0.970 Test Loss: 0.367 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.5626s/iter; left time: 20624.0009s
	iters: 200, epoch: 12 | loss: 2.3305743
	speed: 0.2763s/iter; left time: 10100.3599s
	iters: 300, epoch: 12 | loss: 0.6916552
	speed: 0.2883s/iter; left time: 10509.5105s
	iters: 400, epoch: 12 | loss: 0.0000058
	speed: 0.2880s/iter; left time: 10470.2947s
Epoch: 12 cost time: 117.6581757068634
Epoch: 12, Steps: 413 | Train Loss: 0.205 Vali Loss: 0.283 Vali Acc: 0.973 Test Loss: 0.283 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0034128
	speed: 0.5592s/iter; left time: 20266.5063s
	iters: 200, epoch: 13 | loss: 0.0167118
	speed: 0.2736s/iter; left time: 9889.3843s
	iters: 300, epoch: 13 | loss: 0.7424497
	speed: 0.2823s/iter; left time: 10175.0816s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.2681s/iter; left time: 9638.3605s
Epoch: 13 cost time: 113.94761681556702
Epoch: 13, Steps: 413 | Train Loss: 0.139 Vali Loss: 0.377 Vali Acc: 0.966 Test Loss: 0.377 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.5690s/iter; left time: 20388.7046s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.3044s/iter; left time: 10875.8961s
	iters: 300, epoch: 14 | loss: 0.0000514
	speed: 0.2925s/iter; left time: 10422.9649s
	iters: 400, epoch: 14 | loss: 0.0000548
	speed: 0.2868s/iter; left time: 10189.1650s
Epoch: 14 cost time: 122.72057723999023
Epoch: 14, Steps: 413 | Train Loss: 0.170 Vali Loss: 0.544 Vali Acc: 0.965 Test Loss: 0.544 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0000166
	speed: 0.5969s/iter; left time: 21140.2372s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.3009s/iter; left time: 10627.4545s
	iters: 300, epoch: 15 | loss: 0.9701183
	speed: 0.3058s/iter; left time: 10769.8868s
	iters: 400, epoch: 15 | loss: 0.9212713
	speed: 0.3098s/iter; left time: 10880.6064s
Epoch: 15 cost time: 126.7295024394989
Epoch: 15, Steps: 413 | Train Loss: 0.183 Vali Loss: 0.409 Vali Acc: 0.973 Test Loss: 0.409 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.5877s/iter; left time: 20573.0242s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.3064s/iter; left time: 10696.4637s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.3039s/iter; left time: 10575.8914s
	iters: 400, epoch: 16 | loss: 0.0000052
	speed: 0.2978s/iter; left time: 10334.1074s
Epoch: 16 cost time: 124.64061188697815
Epoch: 16, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.282 Vali Acc: 0.975 Test Loss: 0.282 Test Acc: 0.975
Validation loss decreased (-0.974077 --> -0.974531).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.5794s/iter; left time: 20043.2375s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.2882s/iter; left time: 9941.3693s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.2993s/iter; left time: 10292.9506s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.2849s/iter; left time: 9769.7685s
Epoch: 17 cost time: 119.48734092712402
Epoch: 17, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.381 Vali Acc: 0.968 Test Loss: 0.381 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0030400
	speed: 0.5611s/iter; left time: 19179.2804s
	iters: 200, epoch: 18 | loss: 0.6977132
	speed: 0.2711s/iter; left time: 9239.5057s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.2839s/iter; left time: 9648.0795s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.2655s/iter; left time: 8996.4715s
Epoch: 18 cost time: 114.01657843589783
Epoch: 18, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.264 Vali Acc: 0.977 Test Loss: 0.264 Test Acc: 0.977
Validation loss decreased (-0.974531 --> -0.976805).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.5638s/iter; left time: 19036.9289s
	iters: 200, epoch: 19 | loss: 0.1883689
	speed: 0.2781s/iter; left time: 9362.0920s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.2815s/iter; left time: 9450.2582s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.2859s/iter; left time: 9568.9560s
Epoch: 19 cost time: 118.30971026420593
Epoch: 19, Steps: 413 | Train Loss: 0.115 Vali Loss: 0.680 Vali Acc: 0.955 Test Loss: 0.680 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000049
	speed: 0.5598s/iter; left time: 18670.5543s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.2775s/iter; left time: 9226.8302s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.2708s/iter; left time: 8978.7097s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.2783s/iter; left time: 9200.4777s
Epoch: 20 cost time: 115.19491577148438
Epoch: 20, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.392 Vali Acc: 0.973 Test Loss: 0.392 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.5303s/iter; left time: 17467.0530s
	iters: 200, epoch: 21 | loss: 0.8380749
	speed: 0.2875s/iter; left time: 9440.9548s
	iters: 300, epoch: 21 | loss: 0.0076691
	speed: 0.2766s/iter; left time: 9057.3225s
	iters: 400, epoch: 21 | loss: 0.0003302
	speed: 0.2843s/iter; left time: 9280.5571s
Epoch: 21 cost time: 116.6776487827301
Epoch: 21, Steps: 413 | Train Loss: 0.190 Vali Loss: 0.639 Vali Acc: 0.951 Test Loss: 0.639 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0000991
	speed: 0.5480s/iter; left time: 17825.5663s
	iters: 200, epoch: 22 | loss: 0.0000117
	speed: 0.2983s/iter; left time: 9674.4601s
	iters: 300, epoch: 22 | loss: 0.0000034
	speed: 0.2739s/iter; left time: 8854.5020s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.2789s/iter; left time: 8988.0355s
Epoch: 22 cost time: 116.56108260154724
Epoch: 22, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.259 Vali Acc: 0.978 Test Loss: 0.259 Test Acc: 0.978
Validation loss decreased (-0.976805 --> -0.977715).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.5447s/iter; left time: 17494.4305s
	iters: 200, epoch: 23 | loss: 0.4346673
	speed: 0.2808s/iter; left time: 8990.3285s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.2804s/iter; left time: 8948.1130s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.2780s/iter; left time: 8844.1994s
Epoch: 23 cost time: 114.71999144554138
Epoch: 23, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.191 Vali Acc: 0.980 Test Loss: 0.191 Test Acc: 0.980
Validation loss decreased (-0.977715 --> -0.980444).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.5693s/iter; left time: 18049.3505s
	iters: 200, epoch: 24 | loss: 0.0000051
	speed: 0.2875s/iter; left time: 9086.8425s
	iters: 300, epoch: 24 | loss: 0.0001421
	speed: 0.2913s/iter; left time: 9176.5804s
	iters: 400, epoch: 24 | loss: 0.0049526
	speed: 0.2743s/iter; left time: 8612.0719s
Epoch: 24 cost time: 117.82755327224731
Epoch: 24, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.476 Vali Acc: 0.969 Test Loss: 0.476 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.5783s/iter; left time: 18095.1009s
	iters: 200, epoch: 25 | loss: 0.0013840
	speed: 0.2815s/iter; left time: 8778.3078s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.2975s/iter; left time: 9247.8316s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.2745s/iter; left time: 8507.0700s
Epoch: 25 cost time: 118.89645338058472
Epoch: 25, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.403 Vali Acc: 0.960 Test Loss: 0.403 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.5808s/iter; left time: 17931.5154s
	iters: 200, epoch: 26 | loss: 0.0015808
	speed: 0.3026s/iter; left time: 9313.0705s
	iters: 300, epoch: 26 | loss: 0.0000011
	speed: 0.3070s/iter; left time: 9416.8646s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.3038s/iter; left time: 9288.4936s
Epoch: 26 cost time: 125.89687514305115
Epoch: 26, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.297 Vali Acc: 0.970 Test Loss: 0.297 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.5973s/iter; left time: 18195.5149s
	iters: 200, epoch: 27 | loss: 0.0005714
	speed: 0.3010s/iter; left time: 9139.0896s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.3099s/iter; left time: 9380.0030s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.2980s/iter; left time: 8989.9393s
Epoch: 27 cost time: 126.61667799949646
Epoch: 27, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.751 Vali Acc: 0.948 Test Loss: 0.751 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.5777s/iter; left time: 17359.9480s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.2872s/iter; left time: 8600.5587s
	iters: 300, epoch: 28 | loss: 0.0000453
	speed: 0.3070s/iter; left time: 9164.6687s
	iters: 400, epoch: 28 | loss: 0.0000011
	speed: 0.2901s/iter; left time: 8629.9319s
Epoch: 28 cost time: 121.90485286712646
Epoch: 28, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.244 Vali Acc: 0.973 Test Loss: 0.244 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0000001
	speed: 0.5892s/iter; left time: 17461.3294s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.2986s/iter; left time: 8818.5532s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.3058s/iter; left time: 9002.9711s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.2985s/iter; left time: 8757.6620s
Epoch: 29 cost time: 124.55539512634277
Epoch: 29, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.416 Vali Acc: 0.972 Test Loss: 0.416 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.5516s/iter; left time: 16120.6318s
	iters: 200, epoch: 30 | loss: 0.0008018
	speed: 0.2827s/iter; left time: 8233.3170s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.2833s/iter; left time: 8223.0047s
	iters: 400, epoch: 30 | loss: 0.0000001
	speed: 0.2789s/iter; left time: 8066.8054s
Epoch: 30 cost time: 116.72346377372742
Epoch: 30, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.225 Vali Acc: 0.973 Test Loss: 0.225 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.5361s/iter; left time: 15444.8809s
	iters: 200, epoch: 31 | loss: 0.0000004
	speed: 0.2893s/iter; left time: 8307.5146s
	iters: 300, epoch: 31 | loss: 0.0000033
	speed: 0.2833s/iter; left time: 8106.2880s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.2924s/iter; left time: 8337.7695s
Epoch: 31 cost time: 119.14855527877808
Epoch: 31, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.238 Vali Acc: 0.978 Test Loss: 0.238 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.5585s/iter; left time: 15860.0817s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.2770s/iter; left time: 7839.5954s
	iters: 300, epoch: 32 | loss: 0.0000172
	speed: 0.2693s/iter; left time: 7595.0737s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.2651s/iter; left time: 7448.3377s
Epoch: 32 cost time: 113.76544260978699
Epoch: 32, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.247 Vali Acc: 0.975 Test Loss: 0.247 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.5401s/iter; left time: 15113.8349s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.2701s/iter; left time: 7533.0115s
	iters: 300, epoch: 33 | loss: 0.3081035
	speed: 0.2761s/iter; left time: 7671.7978s
	iters: 400, epoch: 33 | loss: 0.0000644
	speed: 0.2743s/iter; left time: 7592.7859s
Epoch: 33 cost time: 113.12912583351135
Epoch: 33, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.295 Vali Acc: 0.970 Test Loss: 0.295 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df256_ma47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9804456571168713
model parameter : 10613770
model size : 60.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         38                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df256_ma38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.0999138
	speed: 0.3304s/iter; left time: 13614.3950s
	iters: 200, epoch: 1 | loss: 0.3045888
	speed: 0.2947s/iter; left time: 12111.9096s
	iters: 300, epoch: 1 | loss: 0.0840968
	speed: 0.2835s/iter; left time: 11624.6218s
	iters: 400, epoch: 1 | loss: 0.0371565
	speed: 0.2815s/iter; left time: 11514.9954s
Epoch: 1 cost time: 123.07355999946594
Epoch: 1, Steps: 413 | Train Loss: 0.351 Vali Loss: 0.146 Vali Acc: 0.953 Test Loss: 0.146 Test Acc: 0.953
Validation loss decreased (inf --> -0.953159).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2434580
	speed: 0.5788s/iter; left time: 23607.1037s
	iters: 200, epoch: 2 | loss: 0.6713663
	speed: 0.2929s/iter; left time: 11915.8879s
	iters: 300, epoch: 2 | loss: 0.0264685
	speed: 0.2866s/iter; left time: 11633.6524s
	iters: 400, epoch: 2 | loss: 0.0006279
	speed: 0.2932s/iter; left time: 11870.7931s
Epoch: 2 cost time: 120.59946012496948
Epoch: 2, Steps: 413 | Train Loss: 0.163 Vali Loss: 0.293 Vali Acc: 0.951 Test Loss: 0.293 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0822894
	speed: 0.5852s/iter; left time: 23629.3608s
	iters: 200, epoch: 3 | loss: 1.1343284
	speed: 0.3066s/iter; left time: 12349.1363s
	iters: 300, epoch: 3 | loss: 0.0001543
	speed: 0.3034s/iter; left time: 12187.5958s
	iters: 400, epoch: 3 | loss: 0.0240919
	speed: 0.2869s/iter; left time: 11498.8935s
Epoch: 3 cost time: 123.45416593551636
Epoch: 3, Steps: 413 | Train Loss: 0.269 Vali Loss: 0.515 Vali Acc: 0.927 Test Loss: 0.515 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.7856271
	speed: 0.5739s/iter; left time: 22935.4116s
	iters: 200, epoch: 4 | loss: 0.0206606
	speed: 0.3171s/iter; left time: 12640.6225s
	iters: 300, epoch: 4 | loss: 0.0132532
	speed: 0.3026s/iter; left time: 12031.9873s
	iters: 400, epoch: 4 | loss: 0.9823545
	speed: 0.2824s/iter; left time: 11201.5627s
Epoch: 4 cost time: 124.44817066192627
Epoch: 4, Steps: 413 | Train Loss: 0.326 Vali Loss: 0.539 Vali Acc: 0.940 Test Loss: 0.539 Test Acc: 0.940
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.5801740
	speed: 0.5645s/iter; left time: 22324.5763s
	iters: 200, epoch: 5 | loss: 0.4023972
	speed: 0.3013s/iter; left time: 11884.1883s
	iters: 300, epoch: 5 | loss: 0.1434741
	speed: 0.2902s/iter; left time: 11417.3217s
	iters: 400, epoch: 5 | loss: 0.0728483
	speed: 0.2751s/iter; left time: 10798.5232s
Epoch: 5 cost time: 120.2089831829071
Epoch: 5, Steps: 413 | Train Loss: 0.384 Vali Loss: 0.953 Vali Acc: 0.899 Test Loss: 0.953 Test Acc: 0.899
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0001188
	speed: 0.5820s/iter; left time: 22777.6462s
	iters: 200, epoch: 6 | loss: 0.5204670
	speed: 0.3036s/iter; left time: 11851.6098s
	iters: 300, epoch: 6 | loss: 0.0044413
	speed: 0.2963s/iter; left time: 11535.2108s
	iters: 400, epoch: 6 | loss: 0.0005156
	speed: 0.2894s/iter; left time: 11240.5792s
Epoch: 6 cost time: 122.7922134399414
Epoch: 6, Steps: 413 | Train Loss: 0.304 Vali Loss: 0.566 Vali Acc: 0.955 Test Loss: 0.566 Test Acc: 0.955
Validation loss decreased (-0.953159 --> -0.954519).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1102672
	speed: 0.5688s/iter; left time: 22023.9135s
	iters: 200, epoch: 7 | loss: 0.0000004
	speed: 0.3006s/iter; left time: 11609.6723s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.2989s/iter; left time: 11514.5619s
	iters: 400, epoch: 7 | loss: 0.9039181
	speed: 0.2875s/iter; left time: 11045.7245s
Epoch: 7 cost time: 121.38224506378174
Epoch: 7, Steps: 413 | Train Loss: 0.384 Vali Loss: 0.405 Vali Acc: 0.956 Test Loss: 0.405 Test Acc: 0.956
Validation loss decreased (-0.954519 --> -0.956340).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.5822s/iter; left time: 22303.3594s
	iters: 200, epoch: 8 | loss: 0.0157043
	speed: 0.2900s/iter; left time: 11081.8188s
	iters: 300, epoch: 8 | loss: 0.4617115
	speed: 0.2999s/iter; left time: 11430.8565s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.3183s/iter; left time: 12098.3565s
Epoch: 8 cost time: 125.36738395690918
Epoch: 8, Steps: 413 | Train Loss: 0.306 Vali Loss: 0.359 Vali Acc: 0.968 Test Loss: 0.359 Test Acc: 0.968
Validation loss decreased (-0.956340 --> -0.968164).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000010
	speed: 0.5809s/iter; left time: 22014.8676s
	iters: 200, epoch: 9 | loss: 0.0055427
	speed: 0.2939s/iter; left time: 11108.6690s
	iters: 300, epoch: 9 | loss: 0.0000001
	speed: 0.2895s/iter; left time: 10912.8508s
	iters: 400, epoch: 9 | loss: 0.0159047
	speed: 0.2899s/iter; left time: 10898.5612s
Epoch: 9 cost time: 120.92260193824768
Epoch: 9, Steps: 413 | Train Loss: 0.222 Vali Loss: 0.645 Vali Acc: 0.954 Test Loss: 0.645 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.5747s/iter; left time: 21542.1840s
	iters: 200, epoch: 10 | loss: 0.0202731
	speed: 0.2919s/iter; left time: 10911.2182s
	iters: 300, epoch: 10 | loss: 0.9198603
	speed: 0.3060s/iter; left time: 11407.2866s
	iters: 400, epoch: 10 | loss: 0.0000012
	speed: 0.3177s/iter; left time: 11814.6445s
Epoch: 10 cost time: 124.5784740447998
Epoch: 10, Steps: 413 | Train Loss: 0.176 Vali Loss: 0.717 Vali Acc: 0.940 Test Loss: 0.717 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.6070s/iter; left time: 22501.7305s
	iters: 200, epoch: 11 | loss: 0.0002446
	speed: 0.2982s/iter; left time: 11026.0167s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.2856s/iter; left time: 10531.4586s
	iters: 400, epoch: 11 | loss: 0.0000799
	speed: 0.2855s/iter; left time: 10497.6149s
Epoch: 11 cost time: 120.94271540641785
Epoch: 11, Steps: 413 | Train Loss: 0.228 Vali Loss: 0.369 Vali Acc: 0.966 Test Loss: 0.369 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.5895s/iter; left time: 21610.6832s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.2962s/iter; left time: 10830.0107s
	iters: 300, epoch: 12 | loss: 0.2351784
	speed: 0.2964s/iter; left time: 10805.6799s
	iters: 400, epoch: 12 | loss: 0.0000787
	speed: 0.2916s/iter; left time: 10601.9634s
Epoch: 12 cost time: 122.42926096916199
Epoch: 12, Steps: 413 | Train Loss: 0.203 Vali Loss: 0.401 Vali Acc: 0.970 Test Loss: 0.401 Test Acc: 0.970
Validation loss decreased (-0.968164 --> -0.969528).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0932811
	speed: 0.6039s/iter; left time: 21887.5369s
	iters: 200, epoch: 13 | loss: 0.0001313
	speed: 0.2955s/iter; left time: 10681.6324s
	iters: 300, epoch: 13 | loss: 0.0062959
	speed: 0.3029s/iter; left time: 10917.4917s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.2961s/iter; left time: 10641.5580s
Epoch: 13 cost time: 124.29416275024414
Epoch: 13, Steps: 413 | Train Loss: 0.135 Vali Loss: 0.387 Vali Acc: 0.971 Test Loss: 0.387 Test Acc: 0.971
Validation loss decreased (-0.969528 --> -0.970892).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.1291161
	speed: 0.5898s/iter; left time: 21133.7638s
	iters: 200, epoch: 14 | loss: 0.0000301
	speed: 0.2955s/iter; left time: 10557.2661s
	iters: 300, epoch: 14 | loss: 0.0003210
	speed: 0.2769s/iter; left time: 9867.1596s
	iters: 400, epoch: 14 | loss: 1.2804835
	speed: 0.2907s/iter; left time: 10328.8060s
Epoch: 14 cost time: 120.47856259346008
Epoch: 14, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.202 Vali Acc: 0.976 Test Loss: 0.202 Test Acc: 0.976
Validation loss decreased (-0.970892 --> -0.976351).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.5962s/iter; left time: 21115.5395s
	iters: 200, epoch: 15 | loss: 0.0270551
	speed: 0.3023s/iter; left time: 10675.2278s
	iters: 300, epoch: 15 | loss: 0.0000561
	speed: 0.3022s/iter; left time: 10644.0605s
	iters: 400, epoch: 15 | loss: 1.0399702
	speed: 0.2927s/iter; left time: 10278.8778s
Epoch: 15 cost time: 124.10211443901062
Epoch: 15, Steps: 413 | Train Loss: 0.154 Vali Loss: 0.373 Vali Acc: 0.969 Test Loss: 0.373 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000001
	speed: 0.5839s/iter; left time: 20440.4334s
	iters: 200, epoch: 16 | loss: 0.1080756
	speed: 0.3068s/iter; left time: 10708.0787s
	iters: 300, epoch: 16 | loss: 0.0000001
	speed: 0.3196s/iter; left time: 11123.6821s
	iters: 400, epoch: 16 | loss: 0.0000013
	speed: 0.2925s/iter; left time: 10150.0395s
Epoch: 16 cost time: 126.10984206199646
Epoch: 16, Steps: 413 | Train Loss: 0.124 Vali Loss: 0.228 Vali Acc: 0.975 Test Loss: 0.228 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.5718s/iter; left time: 19781.7037s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.2992s/iter; left time: 10319.7149s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.3116s/iter; left time: 10716.9783s
	iters: 400, epoch: 17 | loss: 0.1413841
	speed: 0.2975s/iter; left time: 10201.2030s
Epoch: 17 cost time: 124.63729786872864
Epoch: 17, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.457 Vali Acc: 0.965 Test Loss: 0.457 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.5809s/iter; left time: 19853.9700s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.3097s/iter; left time: 10555.3519s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.3066s/iter; left time: 10419.1875s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.3040s/iter; left time: 10300.8965s
Epoch: 18 cost time: 126.11239385604858
Epoch: 18, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.253 Vali Acc: 0.975 Test Loss: 0.253 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000001
	speed: 0.5519s/iter; left time: 18634.6780s
	iters: 200, epoch: 19 | loss: 0.0030546
	speed: 0.2848s/iter; left time: 9586.6849s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.3021s/iter; left time: 10140.4930s
	iters: 400, epoch: 19 | loss: 0.8275170
	speed: 0.2969s/iter; left time: 9936.9459s
Epoch: 19 cost time: 120.5943672657013
Epoch: 19, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.430 Vali Acc: 0.968 Test Loss: 0.430 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.5701s/iter; left time: 19015.7160s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.2869s/iter; left time: 9540.9935s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.3000s/iter; left time: 9946.0263s
	iters: 400, epoch: 20 | loss: 0.0000007
	speed: 0.2919s/iter; left time: 9647.1243s
Epoch: 20 cost time: 120.67973518371582
Epoch: 20, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.397 Vali Acc: 0.974 Test Loss: 0.397 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.5781s/iter; left time: 19044.7918s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.2961s/iter; left time: 9724.3392s
	iters: 300, epoch: 21 | loss: 1.1203887
	speed: 0.2908s/iter; left time: 9521.9164s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.3058s/iter; left time: 9980.4079s
Epoch: 21 cost time: 122.32004570960999
Epoch: 21, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.325 Vali Acc: 0.975 Test Loss: 0.325 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0000591
	speed: 0.5777s/iter; left time: 18792.2260s
	iters: 200, epoch: 22 | loss: 0.0000031
	speed: 0.3023s/iter; left time: 9801.8875s
	iters: 300, epoch: 22 | loss: 0.0016812
	speed: 0.2900s/iter; left time: 9376.7346s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.3043s/iter; left time: 9805.4036s
Epoch: 22 cost time: 123.97359347343445
Epoch: 22, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.383 Vali Acc: 0.975 Test Loss: 0.383 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.6005s/iter; left time: 19286.5266s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.2784s/iter; left time: 8912.6052s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.2943s/iter; left time: 9393.6050s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.3055s/iter; left time: 9719.2611s
Epoch: 23 cost time: 123.03799200057983
Epoch: 23, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.278 Vali Acc: 0.976 Test Loss: 0.278 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.5956s/iter; left time: 18882.1744s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.3038s/iter; left time: 9600.3081s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.2975s/iter; left time: 9373.3610s
	iters: 400, epoch: 24 | loss: 0.0000003
	speed: 0.3032s/iter; left time: 9520.1451s
Epoch: 24 cost time: 125.69357466697693
Epoch: 24, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.266 Vali Acc: 0.976 Test Loss: 0.266 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df256_ma38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9763528876762164
model parameter : 10613770
model size : 60.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         28                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df256_ma28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2847199
	speed: 0.3082s/iter; left time: 12700.0302s
	iters: 200, epoch: 1 | loss: 0.2979406
	speed: 0.2793s/iter; left time: 11481.5517s
	iters: 300, epoch: 1 | loss: 0.1234691
	speed: 0.2686s/iter; left time: 11014.5083s
	iters: 400, epoch: 1 | loss: 0.0002981
	speed: 0.2685s/iter; left time: 10983.4222s
Epoch: 1 cost time: 115.97121238708496
Epoch: 1, Steps: 413 | Train Loss: 0.375 Vali Loss: 0.171 Vali Acc: 0.952 Test Loss: 0.171 Test Acc: 0.952
Validation loss decreased (inf --> -0.951795).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1386800
	speed: 0.5277s/iter; left time: 21522.8493s
	iters: 200, epoch: 2 | loss: 0.0712625
	speed: 0.2718s/iter; left time: 11059.4329s
	iters: 300, epoch: 2 | loss: 0.3205417
	speed: 0.2754s/iter; left time: 11179.7274s
	iters: 400, epoch: 2 | loss: 0.2195316
	speed: 0.2747s/iter; left time: 11123.1345s
Epoch: 2 cost time: 112.38183856010437
Epoch: 2, Steps: 413 | Train Loss: 0.214 Vali Loss: 0.304 Vali Acc: 0.944 Test Loss: 0.304 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0039782
	speed: 0.5388s/iter; left time: 21755.8636s
	iters: 200, epoch: 3 | loss: 0.0030750
	speed: 0.2709s/iter; left time: 10911.9706s
	iters: 300, epoch: 3 | loss: 0.0541853
	speed: 0.2771s/iter; left time: 11131.4238s
	iters: 400, epoch: 3 | loss: 0.0035621
	speed: 0.2779s/iter; left time: 11138.5002s
Epoch: 3 cost time: 114.25475573539734
Epoch: 3, Steps: 413 | Train Loss: 0.259 Vali Loss: 0.583 Vali Acc: 0.931 Test Loss: 0.583 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.2428833
	speed: 0.5283s/iter; left time: 21111.4636s
	iters: 200, epoch: 4 | loss: 0.7233093
	speed: 0.2725s/iter; left time: 10862.7786s
	iters: 300, epoch: 4 | loss: 1.2046814
	speed: 0.2846s/iter; left time: 11315.8444s
	iters: 400, epoch: 4 | loss: 0.2662872
	speed: 0.2743s/iter; left time: 10877.5628s
Epoch: 4 cost time: 113.07995867729187
Epoch: 4, Steps: 413 | Train Loss: 0.277 Vali Loss: 0.793 Vali Acc: 0.932 Test Loss: 0.793 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.4346647
	speed: 0.5359s/iter; left time: 21194.4582s
	iters: 200, epoch: 5 | loss: 0.0000645
	speed: 0.2699s/iter; left time: 10646.5314s
	iters: 300, epoch: 5 | loss: 0.4015155
	speed: 0.2774s/iter; left time: 10914.1892s
	iters: 400, epoch: 5 | loss: 0.7708237
	speed: 0.2776s/iter; left time: 10896.2994s
Epoch: 5 cost time: 113.90038323402405
Epoch: 5, Steps: 413 | Train Loss: 0.384 Vali Loss: 0.705 Vali Acc: 0.924 Test Loss: 0.705 Test Acc: 0.924
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.1778950
	speed: 0.5365s/iter; left time: 20994.8653s
	iters: 200, epoch: 6 | loss: 0.8014947
	speed: 0.2750s/iter; left time: 10736.3588s
	iters: 300, epoch: 6 | loss: 0.3376648
	speed: 0.2778s/iter; left time: 10816.5604s
	iters: 400, epoch: 6 | loss: 0.0818711
	speed: 0.2826s/iter; left time: 10974.5935s
Epoch: 6 cost time: 114.76412224769592
Epoch: 6, Steps: 413 | Train Loss: 0.373 Vali Loss: 0.540 Vali Acc: 0.951 Test Loss: 0.540 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0000010
	speed: 0.5602s/iter; left time: 21691.1082s
	iters: 200, epoch: 7 | loss: 0.0002948
	speed: 0.3073s/iter; left time: 11869.1018s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.2858s/iter; left time: 11010.5054s
	iters: 400, epoch: 7 | loss: 0.1324365
	speed: 0.2705s/iter; left time: 10391.6202s
Epoch: 7 cost time: 119.19420981407166
Epoch: 7, Steps: 413 | Train Loss: 0.272 Vali Loss: 0.340 Vali Acc: 0.968 Test Loss: 0.340 Test Acc: 0.968
Validation loss decreased (-0.951795 --> -0.967709).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1915472
	speed: 0.5426s/iter; left time: 20788.1185s
	iters: 200, epoch: 8 | loss: 0.0000081
	speed: 0.2718s/iter; left time: 10385.9154s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.2813s/iter; left time: 10718.7561s
	iters: 400, epoch: 8 | loss: 0.7946661
	speed: 0.2794s/iter; left time: 10620.3073s
Epoch: 8 cost time: 114.76738381385803
Epoch: 8, Steps: 413 | Train Loss: 0.279 Vali Loss: 0.326 Vali Acc: 0.969 Test Loss: 0.326 Test Acc: 0.969
Validation loss decreased (-0.967709 --> -0.969074).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000002
	speed: 0.5469s/iter; left time: 20726.7744s
	iters: 200, epoch: 9 | loss: 0.1781954
	speed: 0.2800s/iter; left time: 10584.9009s
	iters: 300, epoch: 9 | loss: 0.0505061
	speed: 0.2881s/iter; left time: 10859.0467s
	iters: 400, epoch: 9 | loss: 0.0000004
	speed: 0.2703s/iter; left time: 10163.5581s
Epoch: 9 cost time: 114.83383679389954
Epoch: 9, Steps: 413 | Train Loss: 0.224 Vali Loss: 0.739 Vali Acc: 0.956 Test Loss: 0.739 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0386101
	speed: 0.5370s/iter; left time: 20128.4634s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.2934s/iter; left time: 10968.1704s
	iters: 300, epoch: 10 | loss: 0.0232998
	speed: 0.2830s/iter; left time: 10553.0864s
	iters: 400, epoch: 10 | loss: 0.1646685
	speed: 0.2850s/iter; left time: 10595.6379s
Epoch: 10 cost time: 117.81655526161194
Epoch: 10, Steps: 413 | Train Loss: 0.221 Vali Loss: 0.354 Vali Acc: 0.967 Test Loss: 0.354 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.5514s/iter; left time: 20440.2753s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.2815s/iter; left time: 10405.5202s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.2819s/iter; left time: 10392.3834s
	iters: 400, epoch: 11 | loss: 0.0000085
	speed: 0.2718s/iter; left time: 9995.4351s
Epoch: 11 cost time: 115.59075117111206
Epoch: 11, Steps: 413 | Train Loss: 0.154 Vali Loss: 0.498 Vali Acc: 0.961 Test Loss: 0.498 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.5522s/iter; left time: 20241.5486s
	iters: 200, epoch: 12 | loss: 0.0009270
	speed: 0.2949s/iter; left time: 10781.5913s
	iters: 300, epoch: 12 | loss: 0.0000005
	speed: 0.2833s/iter; left time: 10329.0154s
	iters: 400, epoch: 12 | loss: 0.0000003
	speed: 0.2735s/iter; left time: 9945.6106s
Epoch: 12 cost time: 118.10694789886475
Epoch: 12, Steps: 413 | Train Loss: 0.126 Vali Loss: 0.357 Vali Acc: 0.969 Test Loss: 0.357 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000001
	speed: 0.5912s/iter; left time: 21428.4721s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.3100s/iter; left time: 11205.5982s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.2988s/iter; left time: 10771.6240s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.3013s/iter; left time: 10831.9734s
Epoch: 13 cost time: 125.66245985031128
Epoch: 13, Steps: 413 | Train Loss: 0.115 Vali Loss: 0.302 Vali Acc: 0.972 Test Loss: 0.302 Test Acc: 0.972
Validation loss decreased (-0.969074 --> -0.972257).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0468398
	speed: 0.5728s/iter; left time: 20524.7268s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.3021s/iter; left time: 10794.6700s
	iters: 300, epoch: 14 | loss: 0.0000176
	speed: 0.2897s/iter; left time: 10321.0785s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.3067s/iter; left time: 10897.4880s
Epoch: 14 cost time: 123.48307251930237
Epoch: 14, Steps: 413 | Train Loss: 0.144 Vali Loss: 0.747 Vali Acc: 0.959 Test Loss: 0.747 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.2213615
	speed: 0.5917s/iter; left time: 20957.2359s
	iters: 200, epoch: 15 | loss: 0.0000014
	speed: 0.3166s/iter; left time: 11183.2729s
	iters: 300, epoch: 15 | loss: 0.2303311
	speed: 0.3040s/iter; left time: 10705.5621s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.2876s/iter; left time: 10101.5467s
Epoch: 15 cost time: 125.70492625236511
Epoch: 15, Steps: 413 | Train Loss: 0.179 Vali Loss: 0.456 Vali Acc: 0.971 Test Loss: 0.456 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 2.7441564
	speed: 0.5715s/iter; left time: 20007.1626s
	iters: 200, epoch: 16 | loss: 0.8114063
	speed: 0.3091s/iter; left time: 10789.0097s
	iters: 300, epoch: 16 | loss: 0.0509333
	speed: 0.2706s/iter; left time: 9417.5727s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.2729s/iter; left time: 9471.3659s
Epoch: 16 cost time: 119.3604667186737
Epoch: 16, Steps: 413 | Train Loss: 0.181 Vali Loss: 0.438 Vali Acc: 0.968 Test Loss: 0.438 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.5866s/iter; left time: 20293.0016s
	iters: 200, epoch: 17 | loss: 0.9061955
	speed: 0.2812s/iter; left time: 9699.9418s
	iters: 300, epoch: 17 | loss: 0.0000363
	speed: 0.2641s/iter; left time: 9082.3688s
	iters: 400, epoch: 17 | loss: 0.1022320
	speed: 0.2741s/iter; left time: 9400.0195s
Epoch: 17 cost time: 116.34709930419922
Epoch: 17, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.387 Vali Acc: 0.971 Test Loss: 0.387 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 2.7579396
	speed: 0.5361s/iter; left time: 18323.6768s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.2722s/iter; left time: 9276.3399s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.2693s/iter; left time: 9149.7638s
	iters: 400, epoch: 18 | loss: 0.0000017
	speed: 0.2703s/iter; left time: 9158.0002s
Epoch: 18 cost time: 112.65880131721497
Epoch: 18, Steps: 413 | Train Loss: 0.125 Vali Loss: 0.297 Vali Acc: 0.975 Test Loss: 0.297 Test Acc: 0.975
Validation loss decreased (-0.972257 --> -0.974986).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.5600s/iter; left time: 18909.2844s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.2677s/iter; left time: 9013.5372s
	iters: 300, epoch: 19 | loss: 0.0000005
	speed: 0.2616s/iter; left time: 8781.3928s
	iters: 400, epoch: 19 | loss: 0.0000003
	speed: 0.2719s/iter; left time: 9099.2718s
Epoch: 19 cost time: 112.43626499176025
Epoch: 19, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.179 Vali Acc: 0.983 Test Loss: 0.179 Test Acc: 0.983
Validation loss decreased (-0.974986 --> -0.983172).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.5422s/iter; left time: 18084.8800s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.2685s/iter; left time: 8929.7075s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.2727s/iter; left time: 9039.6658s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.2709s/iter; left time: 8953.2105s
Epoch: 20 cost time: 111.72656440734863
Epoch: 20, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.339 Vali Acc: 0.975 Test Loss: 0.339 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.5393s/iter; left time: 17766.1627s
	iters: 200, epoch: 21 | loss: 0.0074595
	speed: 0.2615s/iter; left time: 8586.6506s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.2602s/iter; left time: 8520.7037s
	iters: 400, epoch: 21 | loss: 0.0000068
	speed: 0.2620s/iter; left time: 8551.1593s
Epoch: 21 cost time: 109.56856369972229
Epoch: 21, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.206 Vali Acc: 0.978 Test Loss: 0.206 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0017370
	speed: 0.5265s/iter; left time: 17125.7937s
	iters: 200, epoch: 22 | loss: 0.2177433
	speed: 0.2500s/iter; left time: 8106.6339s
	iters: 300, epoch: 22 | loss: 0.0000129
	speed: 0.2630s/iter; left time: 8503.6862s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.2747s/iter; left time: 8852.9474s
Epoch: 22 cost time: 108.89135980606079
Epoch: 22, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.516 Vali Acc: 0.969 Test Loss: 0.516 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0000168
	speed: 0.5461s/iter; left time: 17536.6518s
	iters: 200, epoch: 23 | loss: 0.0000108
	speed: 0.2718s/iter; left time: 8701.2661s
	iters: 300, epoch: 23 | loss: 0.0018470
	speed: 0.2733s/iter; left time: 8722.5914s
	iters: 400, epoch: 23 | loss: 0.0138872
	speed: 0.2686s/iter; left time: 8546.8089s
Epoch: 23 cost time: 113.17630624771118
Epoch: 23, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.129 Vali Acc: 0.984 Test Loss: 0.129 Test Acc: 0.984
Validation loss decreased (-0.983172 --> -0.984082).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.5301s/iter; left time: 16804.9198s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.2565s/iter; left time: 8105.5662s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.2589s/iter; left time: 8157.2777s
	iters: 400, epoch: 24 | loss: 0.0000025
	speed: 0.2732s/iter; left time: 8578.2701s
Epoch: 24 cost time: 108.89082098007202
Epoch: 24, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.171 Vali Acc: 0.983 Test Loss: 0.171 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.1599845
	speed: 0.5526s/iter; left time: 17289.0999s
	iters: 200, epoch: 25 | loss: 0.0062561
	speed: 0.2716s/iter; left time: 8470.5956s
	iters: 300, epoch: 25 | loss: 0.0000187
	speed: 0.2862s/iter; left time: 8898.2445s
	iters: 400, epoch: 25 | loss: 0.0000001
	speed: 0.2823s/iter; left time: 8747.5465s
Epoch: 25 cost time: 115.70633339881897
Epoch: 25, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.362 Vali Acc: 0.967 Test Loss: 0.362 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.5205s/iter; left time: 16071.6597s
	iters: 200, epoch: 26 | loss: 0.0000675
	speed: 0.2489s/iter; left time: 7659.7507s
	iters: 300, epoch: 26 | loss: 0.0000001
	speed: 0.2520s/iter; left time: 7730.3261s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.2688s/iter; left time: 8218.2924s
Epoch: 26 cost time: 106.78525924682617
Epoch: 26, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.308 Vali Acc: 0.976 Test Loss: 0.308 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.5305s/iter; left time: 16159.3888s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.2496s/iter; left time: 7577.3307s
	iters: 300, epoch: 27 | loss: 0.0000129
	speed: 0.2612s/iter; left time: 7906.0199s
	iters: 400, epoch: 27 | loss: 0.6079591
	speed: 0.2807s/iter; left time: 8466.5652s
Epoch: 27 cost time: 108.98328232765198
Epoch: 27, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.347 Vali Acc: 0.969 Test Loss: 0.347 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0000553
	speed: 0.5467s/iter; left time: 16429.3590s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.2680s/iter; left time: 8025.9284s
	iters: 300, epoch: 28 | loss: 0.0422578
	speed: 0.2708s/iter; left time: 8083.1691s
	iters: 400, epoch: 28 | loss: 0.0000002
	speed: 0.2723s/iter; left time: 8102.0550s
Epoch: 28 cost time: 112.43026161193848
Epoch: 28, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.532 Vali Acc: 0.957 Test Loss: 0.532 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.5213s/iter; left time: 15448.4820s
	iters: 200, epoch: 29 | loss: 0.0213842
	speed: 0.2658s/iter; left time: 7851.6313s
	iters: 300, epoch: 29 | loss: 0.0000030
	speed: 0.2728s/iter; left time: 8031.8145s
	iters: 400, epoch: 29 | loss: 0.0001213
	speed: 0.2746s/iter; left time: 8055.8342s
Epoch: 29 cost time: 111.77758884429932
Epoch: 29, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.179 Vali Acc: 0.981 Test Loss: 0.179 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.5062s/iter; left time: 14793.2954s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.2579s/iter; left time: 7512.3775s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.2665s/iter; left time: 7734.5401s
	iters: 400, epoch: 30 | loss: 0.0041381
	speed: 0.2758s/iter; left time: 7976.3224s
Epoch: 30 cost time: 108.84331727027893
Epoch: 30, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.179 Vali Acc: 0.978 Test Loss: 0.179 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0000001
	speed: 0.5301s/iter; left time: 15273.9378s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.2704s/iter; left time: 7764.4994s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.2667s/iter; left time: 7630.9344s
	iters: 400, epoch: 31 | loss: 0.0000003
	speed: 0.2790s/iter; left time: 7954.2109s
Epoch: 31 cost time: 112.49607419967651
Epoch: 31, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.241 Vali Acc: 0.979 Test Loss: 0.241 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0000007
	speed: 0.5238s/iter; left time: 14875.9403s
	iters: 200, epoch: 32 | loss: 0.0000802
	speed: 0.2570s/iter; left time: 7273.8448s
	iters: 300, epoch: 32 | loss: 0.0000001
	speed: 0.2738s/iter; left time: 7720.4119s
	iters: 400, epoch: 32 | loss: 0.0004851
	speed: 0.2604s/iter; left time: 7317.9865s
Epoch: 32 cost time: 107.85460925102234
Epoch: 32, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.137 Vali Acc: 0.983 Test Loss: 0.137 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.4940s/iter; left time: 13825.1155s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.2773s/iter; left time: 7731.2253s
	iters: 300, epoch: 33 | loss: 0.0000001
	speed: 0.2806s/iter; left time: 7797.7278s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.2646s/iter; left time: 7324.1059s
Epoch: 33 cost time: 111.83626174926758
Epoch: 33, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.082 Vali Acc: 0.987 Test Loss: 0.082 Test Acc: 0.987
Validation loss decreased (-0.984082 --> -0.987266).  Saving model ...
	iters: 100, epoch: 34 | loss: 0.8818524
	speed: 0.5389s/iter; left time: 14859.6783s
	iters: 200, epoch: 34 | loss: 0.1471849
	speed: 0.2597s/iter; left time: 7133.1442s
	iters: 300, epoch: 34 | loss: 0.0003920
	speed: 0.2596s/iter; left time: 7105.2057s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.2658s/iter; left time: 7248.7965s
Epoch: 34 cost time: 110.37053322792053
Epoch: 34, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.155 Vali Acc: 0.982 Test Loss: 0.155 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.5315s/iter; left time: 14434.0934s
	iters: 200, epoch: 35 | loss: 0.0000003
	speed: 0.2615s/iter; left time: 7076.3939s
	iters: 300, epoch: 35 | loss: 0.0000141
	speed: 0.2773s/iter; left time: 7476.4931s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.2778s/iter; left time: 7461.3300s
Epoch: 35 cost time: 112.38150238990784
Epoch: 35, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.131 Vali Acc: 0.981 Test Loss: 0.131 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.5255s/iter; left time: 14054.6532s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.2734s/iter; left time: 7283.9741s
	iters: 300, epoch: 36 | loss: 0.0000007
	speed: 0.2744s/iter; left time: 7284.1970s
	iters: 400, epoch: 36 | loss: 0.0000111
	speed: 0.2564s/iter; left time: 6780.6365s
Epoch: 36 cost time: 110.39099955558777
Epoch: 36, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.155 Vali Acc: 0.984 Test Loss: 0.155 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 37 | loss: 0.0000019
	speed: 0.5152s/iter; left time: 13566.4126s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.2800s/iter; left time: 7345.1472s
	iters: 300, epoch: 37 | loss: 0.0000041
	speed: 0.2607s/iter; left time: 6813.6203s
	iters: 400, epoch: 37 | loss: 0.0188795
	speed: 0.2579s/iter; left time: 6714.6975s
Epoch: 37 cost time: 110.71408796310425
Epoch: 37, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.155 Vali Acc: 0.984 Test Loss: 0.155 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 38 | loss: 0.0000034
	speed: 0.5472s/iter; left time: 14182.9743s
	iters: 200, epoch: 38 | loss: 0.0000000
	speed: 0.2701s/iter; left time: 6972.7501s
	iters: 300, epoch: 38 | loss: 0.0000004
	speed: 0.2688s/iter; left time: 6913.7873s
	iters: 400, epoch: 38 | loss: 0.0000017
	speed: 0.2818s/iter; left time: 7220.9052s
Epoch: 38 cost time: 114.10512137413025
Epoch: 38, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.201 Vali Acc: 0.975 Test Loss: 0.201 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 39 | loss: 0.0025646
	speed: 0.5154s/iter; left time: 13145.4819s
	iters: 200, epoch: 39 | loss: 0.0129724
	speed: 0.2712s/iter; left time: 6891.1562s
	iters: 300, epoch: 39 | loss: 0.0000001
	speed: 0.2766s/iter; left time: 6999.0870s
	iters: 400, epoch: 39 | loss: 0.0000001
	speed: 0.2731s/iter; left time: 6883.4707s
Epoch: 39 cost time: 111.41950583457947
Epoch: 39, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.131 Vali Acc: 0.981 Test Loss: 0.131 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 40 | loss: 0.0075147
	speed: 0.5175s/iter; left time: 12985.8548s
	iters: 200, epoch: 40 | loss: 0.0000276
	speed: 0.2752s/iter; left time: 6879.4504s
	iters: 300, epoch: 40 | loss: 0.0000001
	speed: 0.2689s/iter; left time: 6693.9567s
	iters: 400, epoch: 40 | loss: 0.0000002
	speed: 0.2605s/iter; left time: 6458.0321s
Epoch: 40 cost time: 111.22887706756592
Epoch: 40, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.249 Vali Acc: 0.968 Test Loss: 0.249 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 41 | loss: 0.0000006
	speed: 0.5427s/iter; left time: 13393.3213s
	iters: 200, epoch: 41 | loss: 0.0023730
	speed: 0.2630s/iter; left time: 6465.7274s
	iters: 300, epoch: 41 | loss: 0.0104491
	speed: 0.2569s/iter; left time: 6288.7044s
	iters: 400, epoch: 41 | loss: 0.0000007
	speed: 0.2834s/iter; left time: 6909.9327s
Epoch: 41 cost time: 111.40522336959839
Epoch: 41, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 42 | loss: 0.0000008
	speed: 0.5255s/iter; left time: 12753.3598s
	iters: 200, epoch: 42 | loss: 0.0000005
	speed: 0.2629s/iter; left time: 6354.5136s
	iters: 300, epoch: 42 | loss: 0.0000001
	speed: 0.2758s/iter; left time: 6638.0304s
	iters: 400, epoch: 42 | loss: 0.0021162
	speed: 0.2630s/iter; left time: 6304.4182s
Epoch: 42 cost time: 110.89394164085388
Epoch: 42, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.142 Vali Acc: 0.981 Test Loss: 0.142 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 43 | loss: 0.0000549
	speed: 0.5472s/iter; left time: 13053.3170s
	iters: 200, epoch: 43 | loss: 0.0000000
	speed: 0.2855s/iter; left time: 6782.0409s
	iters: 300, epoch: 43 | loss: 0.0000610
	speed: 0.2798s/iter; left time: 6619.5812s
	iters: 400, epoch: 43 | loss: 0.0000025
	speed: 0.2712s/iter; left time: 6388.2354s
Epoch: 43 cost time: 115.95090961456299
Epoch: 43, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.119 Vali Acc: 0.979 Test Loss: 0.119 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df256_ma28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9872669395179627
model parameter : 10613770
model size : 60.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df256_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1239101
	speed: 0.2905s/iter; left time: 11967.3684s
	iters: 200, epoch: 1 | loss: 0.4002646
	speed: 0.2740s/iter; left time: 11262.3621s
	iters: 300, epoch: 1 | loss: 0.1559835
	speed: 0.2814s/iter; left time: 11539.3416s
	iters: 400, epoch: 1 | loss: 0.0001626
	speed: 0.2763s/iter; left time: 11299.1800s
Epoch: 1 cost time: 115.91501927375793
Epoch: 1, Steps: 413 | Train Loss: 0.436 Vali Loss: 0.242 Vali Acc: 0.939 Test Loss: 0.242 Test Acc: 0.939
Validation loss decreased (inf --> -0.938606).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2311126
	speed: 0.5381s/iter; left time: 21946.4808s
	iters: 200, epoch: 2 | loss: 0.1387057
	speed: 0.2859s/iter; left time: 11633.2930s
	iters: 300, epoch: 2 | loss: 0.0398453
	speed: 0.2823s/iter; left time: 11457.1423s
	iters: 400, epoch: 2 | loss: 0.0033441
	speed: 0.2793s/iter; left time: 11308.4690s
Epoch: 2 cost time: 116.72453045845032
Epoch: 2, Steps: 413 | Train Loss: 0.200 Vali Loss: 0.360 Vali Acc: 0.956 Test Loss: 0.360 Test Acc: 0.956
Validation loss decreased (-0.938606 --> -0.956340).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0972696
	speed: 0.5569s/iter; left time: 22482.8729s
	iters: 200, epoch: 3 | loss: 0.0000697
	speed: 0.2518s/iter; left time: 10140.6165s
	iters: 300, epoch: 3 | loss: 0.0195464
	speed: 0.2473s/iter; left time: 9936.5792s
	iters: 400, epoch: 3 | loss: 0.5845496
	speed: 0.2733s/iter; left time: 10951.8601s
Epoch: 3 cost time: 109.04012298583984
Epoch: 3, Steps: 413 | Train Loss: 0.247 Vali Loss: 0.366 Vali Acc: 0.958 Test Loss: 0.366 Test Acc: 0.958
Validation loss decreased (-0.956340 --> -0.958159).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.4688206
	speed: 0.5222s/iter; left time: 20867.3327s
	iters: 200, epoch: 4 | loss: 0.3205718
	speed: 0.2541s/iter; left time: 10127.4646s
	iters: 300, epoch: 4 | loss: 0.0662687
	speed: 0.2771s/iter; left time: 11016.3016s
	iters: 400, epoch: 4 | loss: 0.0011720
	speed: 0.2774s/iter; left time: 11002.8678s
Epoch: 4 cost time: 110.14191722869873
Epoch: 4, Steps: 413 | Train Loss: 0.336 Vali Loss: 0.352 Vali Acc: 0.960 Test Loss: 0.352 Test Acc: 0.960
Validation loss decreased (-0.958159 --> -0.959978).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9611864
	speed: 0.5479s/iter; left time: 21666.9810s
	iters: 200, epoch: 5 | loss: 0.0000116
	speed: 0.2779s/iter; left time: 10962.4340s
	iters: 300, epoch: 5 | loss: 1.1570760
	speed: 0.2749s/iter; left time: 10817.0383s
	iters: 400, epoch: 5 | loss: 0.0000306
	speed: 0.2678s/iter; left time: 10510.9488s
Epoch: 5 cost time: 114.24760913848877
Epoch: 5, Steps: 413 | Train Loss: 0.345 Vali Loss: 0.496 Vali Acc: 0.961 Test Loss: 0.496 Test Acc: 0.961
Validation loss decreased (-0.959978 --> -0.960886).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000088
	speed: 0.5218s/iter; left time: 20421.4447s
	iters: 200, epoch: 6 | loss: 1.3181238
	speed: 0.2506s/iter; left time: 9781.8054s
	iters: 300, epoch: 6 | loss: 0.3771527
	speed: 0.2698s/iter; left time: 10505.2702s
	iters: 400, epoch: 6 | loss: 0.0021723
	speed: 0.2743s/iter; left time: 10654.5811s
Epoch: 6 cost time: 110.79699110984802
Epoch: 6, Steps: 413 | Train Loss: 0.301 Vali Loss: 0.443 Vali Acc: 0.960 Test Loss: 0.443 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000005
	speed: 0.5177s/iter; left time: 20045.3451s
	iters: 200, epoch: 7 | loss: 0.3560247
	speed: 0.2798s/iter; left time: 10806.6121s
	iters: 300, epoch: 7 | loss: 0.0006316
	speed: 0.2632s/iter; left time: 10139.4114s
	iters: 400, epoch: 7 | loss: 0.0023087
	speed: 0.2883s/iter; left time: 11075.6299s
Epoch: 7 cost time: 114.68725442886353
Epoch: 7, Steps: 413 | Train Loss: 0.308 Vali Loss: 0.457 Vali Acc: 0.960 Test Loss: 0.457 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.5305s/iter; left time: 20322.6409s
	iters: 200, epoch: 8 | loss: 0.2039887
	speed: 0.2768s/iter; left time: 10577.9643s
	iters: 300, epoch: 8 | loss: 0.0002362
	speed: 0.2779s/iter; left time: 10591.6495s
	iters: 400, epoch: 8 | loss: 0.0034193
	speed: 0.2824s/iter; left time: 10734.1697s
Epoch: 8 cost time: 115.43949747085571
Epoch: 8, Steps: 413 | Train Loss: 0.235 Vali Loss: 0.294 Vali Acc: 0.969 Test Loss: 0.294 Test Acc: 0.969
Validation loss decreased (-0.960886 --> -0.969074).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000001
	speed: 0.5369s/iter; left time: 20345.6644s
	iters: 200, epoch: 9 | loss: 0.0012758
	speed: 0.2836s/iter; left time: 10717.8344s
	iters: 300, epoch: 9 | loss: 0.0010340
	speed: 0.2698s/iter; left time: 10171.9674s
	iters: 400, epoch: 9 | loss: 0.0000687
	speed: 0.2808s/iter; left time: 10556.0080s
Epoch: 9 cost time: 115.06857991218567
Epoch: 9, Steps: 413 | Train Loss: 0.197 Vali Loss: 0.353 Vali Acc: 0.968 Test Loss: 0.353 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.8058315
	speed: 0.5440s/iter; left time: 20390.0332s
	iters: 200, epoch: 10 | loss: 0.1419113
	speed: 0.2837s/iter; left time: 10607.2977s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.2821s/iter; left time: 10518.8629s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.2824s/iter; left time: 10501.7019s
Epoch: 10 cost time: 116.03836441040039
Epoch: 10, Steps: 413 | Train Loss: 0.187 Vali Loss: 0.325 Vali Acc: 0.965 Test Loss: 0.325 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000013
	speed: 0.5452s/iter; left time: 20212.9566s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.2833s/iter; left time: 10475.1821s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.2663s/iter; left time: 9819.5519s
	iters: 400, epoch: 11 | loss: 1.3410915
	speed: 0.2602s/iter; left time: 9568.7156s
Epoch: 11 cost time: 112.83344650268555
Epoch: 11, Steps: 413 | Train Loss: 0.200 Vali Loss: 0.545 Vali Acc: 0.963 Test Loss: 0.545 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.5469s/iter; left time: 20047.3849s
	iters: 200, epoch: 12 | loss: 0.0144979
	speed: 0.2804s/iter; left time: 10251.3477s
	iters: 300, epoch: 12 | loss: 0.0000079
	speed: 0.2871s/iter; left time: 10467.7121s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.2807s/iter; left time: 10204.0597s
Epoch: 12 cost time: 116.1432273387909
Epoch: 12, Steps: 413 | Train Loss: 0.164 Vali Loss: 0.474 Vali Acc: 0.964 Test Loss: 0.474 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.5455s/iter; left time: 19771.4675s
	iters: 200, epoch: 13 | loss: 0.2858049
	speed: 0.2758s/iter; left time: 9970.3106s
	iters: 300, epoch: 13 | loss: 0.0045427
	speed: 0.2702s/iter; left time: 9738.1251s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.2463s/iter; left time: 8852.3216s
Epoch: 13 cost time: 110.28177881240845
Epoch: 13, Steps: 413 | Train Loss: 0.110 Vali Loss: 0.328 Vali Acc: 0.977 Test Loss: 0.328 Test Acc: 0.977
Validation loss decreased (-0.969074 --> -0.977259).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.5459s/iter; left time: 19559.5169s
	iters: 200, epoch: 14 | loss: 0.0000003
	speed: 0.2650s/iter; left time: 9468.6637s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.2917s/iter; left time: 10394.5953s
	iters: 400, epoch: 14 | loss: 2.9342463
	speed: 0.2737s/iter; left time: 9726.6730s
Epoch: 14 cost time: 113.80014491081238
Epoch: 14, Steps: 413 | Train Loss: 0.148 Vali Loss: 0.260 Vali Acc: 0.980 Test Loss: 0.260 Test Acc: 0.980
Validation loss decreased (-0.977259 --> -0.979988).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0011309
	speed: 0.5573s/iter; left time: 19738.2611s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.2722s/iter; left time: 9612.3582s
	iters: 300, epoch: 15 | loss: 0.0000024
	speed: 0.2787s/iter; left time: 9815.6804s
	iters: 400, epoch: 15 | loss: 0.4196254
	speed: 0.2561s/iter; left time: 8994.6038s
Epoch: 15 cost time: 112.63765382766724
Epoch: 15, Steps: 413 | Train Loss: 0.119 Vali Loss: 0.319 Vali Acc: 0.975 Test Loss: 0.319 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000018
	speed: 0.5410s/iter; left time: 18938.3162s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.2641s/iter; left time: 9219.2493s
	iters: 300, epoch: 16 | loss: 0.7724805
	speed: 0.2781s/iter; left time: 9680.1181s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.2788s/iter; left time: 9675.3029s
Epoch: 16 cost time: 114.40218806266785
Epoch: 16, Steps: 413 | Train Loss: 0.115 Vali Loss: 0.774 Vali Acc: 0.954 Test Loss: 0.774 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.5616s/iter; left time: 19425.8009s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.2866s/iter; left time: 9885.6869s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.2727s/iter; left time: 9377.3301s
	iters: 400, epoch: 17 | loss: 0.4057860
	speed: 0.2769s/iter; left time: 9495.5361s
Epoch: 17 cost time: 117.06225228309631
Epoch: 17, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.195 Vali Acc: 0.983 Test Loss: 0.195 Test Acc: 0.983
Validation loss decreased (-0.979988 --> -0.982717).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000005
	speed: 0.5246s/iter; left time: 17929.3317s
	iters: 200, epoch: 18 | loss: 0.0451918
	speed: 0.2755s/iter; left time: 9387.6256s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.2663s/iter; left time: 9048.8531s
	iters: 400, epoch: 18 | loss: 0.0000064
	speed: 0.2706s/iter; left time: 9168.5424s
Epoch: 18 cost time: 112.06782603263855
Epoch: 18, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.267 Vali Acc: 0.982 Test Loss: 0.267 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000048
	speed: 0.5501s/iter; left time: 18576.3774s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.2762s/iter; left time: 9299.1436s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.2664s/iter; left time: 8942.4034s
	iters: 400, epoch: 19 | loss: 0.0000158
	speed: 0.2656s/iter; left time: 8889.1475s
Epoch: 19 cost time: 113.10956621170044
Epoch: 19, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.349 Vali Acc: 0.976 Test Loss: 0.349 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.5357s/iter; left time: 17866.3343s
	iters: 200, epoch: 20 | loss: 0.8196838
	speed: 0.2805s/iter; left time: 9328.2962s
	iters: 300, epoch: 20 | loss: 0.0001620
	speed: 0.2694s/iter; left time: 8931.4925s
	iters: 400, epoch: 20 | loss: 0.0000025
	speed: 0.2565s/iter; left time: 8477.6379s
Epoch: 20 cost time: 111.6603193283081
Epoch: 20, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.421 Vali Acc: 0.974 Test Loss: 0.421 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000001
	speed: 0.5131s/iter; left time: 16903.3785s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.2806s/iter; left time: 9216.7598s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.2748s/iter; left time: 8998.0703s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.2674s/iter; left time: 8729.0620s
Epoch: 21 cost time: 112.70492696762085
Epoch: 21, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.143 Vali Acc: 0.984 Test Loss: 0.143 Test Acc: 0.984
Validation loss decreased (-0.982717 --> -0.984082).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0000001
	speed: 0.5296s/iter; left time: 17226.7662s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.2714s/iter; left time: 8799.8306s
	iters: 300, epoch: 22 | loss: 0.0000003
	speed: 0.2806s/iter; left time: 9070.1176s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.2821s/iter; left time: 9091.6209s
Epoch: 22 cost time: 114.10429096221924
Epoch: 22, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.322 Vali Acc: 0.979 Test Loss: 0.322 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.5262s/iter; left time: 16899.3349s
	iters: 200, epoch: 23 | loss: 0.0001954
	speed: 0.2680s/iter; left time: 8578.7562s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.2567s/iter; left time: 8193.1588s
	iters: 400, epoch: 23 | loss: 0.7188165
	speed: 0.2749s/iter; left time: 8746.6732s
Epoch: 23 cost time: 110.23664832115173
Epoch: 23, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.259 Vali Acc: 0.974 Test Loss: 0.259 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.5322s/iter; left time: 16872.4491s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.2799s/iter; left time: 8843.9933s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.2798s/iter; left time: 8814.6482s
	iters: 400, epoch: 24 | loss: 0.0000015
	speed: 0.2761s/iter; left time: 8671.6163s
Epoch: 24 cost time: 114.54630041122437
Epoch: 24, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.472 Vali Acc: 0.965 Test Loss: 0.472 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0144180
	speed: 0.5637s/iter; left time: 17639.0020s
	iters: 200, epoch: 25 | loss: 0.0029600
	speed: 0.2772s/iter; left time: 8645.3300s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.2632s/iter; left time: 8181.6776s
	iters: 400, epoch: 25 | loss: 0.0037989
	speed: 0.2646s/iter; left time: 8199.0472s
Epoch: 25 cost time: 113.1254358291626
Epoch: 25, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.355 Vali Acc: 0.962 Test Loss: 0.355 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.5310s/iter; left time: 16396.2386s
	iters: 200, epoch: 26 | loss: 0.2185912
	speed: 0.2831s/iter; left time: 8711.1613s
	iters: 300, epoch: 26 | loss: 0.2660865
	speed: 0.2910s/iter; left time: 8927.9762s
	iters: 400, epoch: 26 | loss: 0.0071856
	speed: 0.2840s/iter; left time: 8683.5185s
Epoch: 26 cost time: 116.90024065971375
Epoch: 26, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.240 Vali Acc: 0.973 Test Loss: 0.240 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0000002
	speed: 0.5528s/iter; left time: 16839.6466s
	iters: 200, epoch: 27 | loss: 0.0005487
	speed: 0.2798s/iter; left time: 8495.8553s
	iters: 300, epoch: 27 | loss: 1.1218830
	speed: 0.2743s/iter; left time: 8300.3407s
	iters: 400, epoch: 27 | loss: 0.0000002
	speed: 0.2689s/iter; left time: 8111.2113s
Epoch: 27 cost time: 114.12135934829712
Epoch: 27, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.122 Vali Acc: 0.984 Test Loss: 0.122 Test Acc: 0.984
Validation loss decreased (-0.984082 --> -0.984082).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.5085s/iter; left time: 15280.9433s
	iters: 200, epoch: 28 | loss: 0.0000095
	speed: 0.2633s/iter; left time: 7884.8821s
	iters: 300, epoch: 28 | loss: 0.0000026
	speed: 0.2644s/iter; left time: 7891.2055s
	iters: 400, epoch: 28 | loss: 0.0000118
	speed: 0.2683s/iter; left time: 7981.8336s
Epoch: 28 cost time: 110.58596444129944
Epoch: 28, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.266 Vali Acc: 0.972 Test Loss: 0.266 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0000001
	speed: 0.5397s/iter; left time: 15995.2665s
	iters: 200, epoch: 29 | loss: 0.0000008
	speed: 0.2682s/iter; left time: 7922.7865s
	iters: 300, epoch: 29 | loss: 0.0252537
	speed: 0.2586s/iter; left time: 7613.3001s
	iters: 400, epoch: 29 | loss: 0.0000131
	speed: 0.2643s/iter; left time: 7754.8403s
Epoch: 29 cost time: 109.40011954307556
Epoch: 29, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.119 Vali Acc: 0.983 Test Loss: 0.119 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0000001
	speed: 0.4959s/iter; left time: 14492.1460s
	iters: 200, epoch: 30 | loss: 0.0000001
	speed: 0.2617s/iter; left time: 7621.4578s
	iters: 300, epoch: 30 | loss: 0.0000020
	speed: 0.2544s/iter; left time: 7382.7042s
	iters: 400, epoch: 30 | loss: 0.0013137
	speed: 0.2433s/iter; left time: 7036.5307s
Epoch: 30 cost time: 104.71588945388794
Epoch: 30, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.077 Vali Acc: 0.988 Test Loss: 0.077 Test Acc: 0.988
Validation loss decreased (-0.984082 --> -0.988176).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.0006390
	speed: 0.5007s/iter; left time: 14426.1311s
	iters: 200, epoch: 31 | loss: 0.0000001
	speed: 0.2775s/iter; left time: 7967.0387s
	iters: 300, epoch: 31 | loss: 0.0179712
	speed: 0.2714s/iter; left time: 7763.9926s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.2577s/iter; left time: 7348.0170s
Epoch: 31 cost time: 110.75732040405273
Epoch: 31, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.100 Vali Acc: 0.985 Test Loss: 0.100 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.4957s/iter; left time: 14075.6692s
	iters: 200, epoch: 32 | loss: 0.2038780
	speed: 0.2663s/iter; left time: 7537.0451s
	iters: 300, epoch: 32 | loss: 0.0026532
	speed: 0.2608s/iter; left time: 7353.0749s
	iters: 400, epoch: 32 | loss: 0.0000002
	speed: 0.2557s/iter; left time: 7184.1349s
Epoch: 32 cost time: 107.36364459991455
Epoch: 32, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.201 Vali Acc: 0.975 Test Loss: 0.201 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.0214124
	speed: 0.5027s/iter; left time: 14067.6165s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.2521s/iter; left time: 7029.3680s
	iters: 300, epoch: 33 | loss: 0.0000044
	speed: 0.2660s/iter; left time: 7390.4823s
	iters: 400, epoch: 33 | loss: 0.0000031
	speed: 0.2850s/iter; left time: 7889.3259s
Epoch: 33 cost time: 110.41123175621033
Epoch: 33, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.156 Vali Acc: 0.984 Test Loss: 0.156 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.5276s/iter; left time: 14547.4873s
	iters: 200, epoch: 34 | loss: 0.0000378
	speed: 0.2634s/iter; left time: 7235.5280s
	iters: 300, epoch: 34 | loss: 0.0000005
	speed: 0.2624s/iter; left time: 7182.6236s
	iters: 400, epoch: 34 | loss: 0.0000174
	speed: 0.2386s/iter; left time: 6508.3665s
Epoch: 34 cost time: 105.76437568664551
Epoch: 34, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.187 Vali Acc: 0.975 Test Loss: 0.187 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.0790920
	speed: 0.5166s/iter; left time: 14030.8191s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.2723s/iter; left time: 7368.9481s
	iters: 300, epoch: 35 | loss: 0.0054199
	speed: 0.2463s/iter; left time: 6639.8269s
	iters: 400, epoch: 35 | loss: 0.0064952
	speed: 0.2471s/iter; left time: 6636.9987s
Epoch: 35 cost time: 107.04341578483582
Epoch: 35, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.147 Vali Acc: 0.980 Test Loss: 0.147 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 0.0001659
	speed: 0.4938s/iter; left time: 13206.6488s
	iters: 200, epoch: 36 | loss: 0.0000007
	speed: 0.2611s/iter; left time: 6956.5455s
	iters: 300, epoch: 36 | loss: 0.0370296
	speed: 0.2666s/iter; left time: 7077.0523s
	iters: 400, epoch: 36 | loss: 0.0000005
	speed: 0.2421s/iter; left time: 6401.2567s
Epoch: 36 cost time: 106.71944642066956
Epoch: 36, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.089 Vali Acc: 0.985 Test Loss: 0.089 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 0.0009586
	speed: 0.5188s/iter; left time: 13661.3411s
	iters: 200, epoch: 37 | loss: 0.0000023
	speed: 0.2710s/iter; left time: 7108.5703s
	iters: 300, epoch: 37 | loss: 0.0000085
	speed: 0.2730s/iter; left time: 7133.2765s
	iters: 400, epoch: 37 | loss: 0.0000054
	speed: 0.2801s/iter; left time: 7292.7362s
Epoch: 37 cost time: 112.81976509094238
Epoch: 37, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.109 Vali Acc: 0.987 Test Loss: 0.109 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 38 | loss: 0.0000009
	speed: 0.5001s/iter; left time: 12962.9721s
	iters: 200, epoch: 38 | loss: 0.0000187
	speed: 0.2469s/iter; left time: 6375.6499s
	iters: 300, epoch: 38 | loss: 0.0001755
	speed: 0.2657s/iter; left time: 6834.1939s
	iters: 400, epoch: 38 | loss: 0.0001051
	speed: 0.2608s/iter; left time: 6680.8286s
Epoch: 38 cost time: 105.9942877292633
Epoch: 38, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.043 Vali Acc: 0.990 Test Loss: 0.043 Test Acc: 0.990
Validation loss decreased (-0.988176 --> -0.990450).  Saving model ...
	iters: 100, epoch: 39 | loss: 0.0000574
	speed: 0.5247s/iter; left time: 13383.8009s
	iters: 200, epoch: 39 | loss: 0.0016715
	speed: 0.2705s/iter; left time: 6872.6985s
	iters: 300, epoch: 39 | loss: 0.0001746
	speed: 0.2723s/iter; left time: 6891.6118s
	iters: 400, epoch: 39 | loss: 0.0008734
	speed: 0.2614s/iter; left time: 6590.1903s
Epoch: 39 cost time: 110.86487150192261
Epoch: 39, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.051 Vali Acc: 0.989 Test Loss: 0.051 Test Acc: 0.989
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 40 | loss: 0.0003015
	speed: 0.5721s/iter; left time: 14357.0287s
	iters: 200, epoch: 40 | loss: 0.0000000
	speed: 0.2806s/iter; left time: 7012.8008s
	iters: 300, epoch: 40 | loss: 0.0000007
	speed: 0.2745s/iter; left time: 6834.0170s
	iters: 400, epoch: 40 | loss: 0.0000002
	speed: 0.2593s/iter; left time: 6429.2316s
Epoch: 40 cost time: 115.69975972175598
Epoch: 40, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.050 Vali Acc: 0.989 Test Loss: 0.050 Test Acc: 0.989
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 41 | loss: 0.0181981
	speed: 0.5435s/iter; left time: 13415.0333s
	iters: 200, epoch: 41 | loss: 0.0003975
	speed: 0.2969s/iter; left time: 7298.9334s
	iters: 300, epoch: 41 | loss: 0.0011757
	speed: 0.2713s/iter; left time: 6642.7577s
	iters: 400, epoch: 41 | loss: 0.0001335
	speed: 0.2807s/iter; left time: 6843.2896s
Epoch: 41 cost time: 118.7318983078003
Epoch: 41, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.062 Vali Acc: 0.986 Test Loss: 0.062 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 42 | loss: 0.0000046
	speed: 0.5308s/iter; left time: 12881.1695s
	iters: 200, epoch: 42 | loss: 0.0000001
	speed: 0.2748s/iter; left time: 6641.8327s
	iters: 300, epoch: 42 | loss: 0.0000001
	speed: 0.2775s/iter; left time: 6679.5786s
	iters: 400, epoch: 42 | loss: 0.0000390
	speed: 0.2585s/iter; left time: 6194.5596s
Epoch: 42 cost time: 111.42477059364319
Epoch: 42, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.079 Vali Acc: 0.987 Test Loss: 0.079 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 43 | loss: 0.0020817
	speed: 0.5044s/iter; left time: 12032.2351s
	iters: 200, epoch: 43 | loss: 0.0000551
	speed: 0.2682s/iter; left time: 6371.0923s
	iters: 300, epoch: 43 | loss: 0.0001102
	speed: 0.2706s/iter; left time: 6401.0598s
	iters: 400, epoch: 43 | loss: 0.0000051
	speed: 0.2693s/iter; left time: 6342.3981s
Epoch: 43 cost time: 111.18766927719116
Epoch: 43, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.071 Vali Acc: 0.985 Test Loss: 0.071 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 44 | loss: 0.0000100
	speed: 0.5271s/iter; left time: 12357.4091s
	iters: 200, epoch: 44 | loss: 0.0000207
	speed: 0.2598s/iter; left time: 6064.7900s
	iters: 300, epoch: 44 | loss: 0.0001326
	speed: 0.2639s/iter; left time: 6133.6513s
	iters: 400, epoch: 44 | loss: 0.0000005
	speed: 0.2677s/iter; left time: 6195.2505s
Epoch: 44 cost time: 109.72412037849426
Epoch: 44, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.071 Vali Acc: 0.985 Test Loss: 0.071 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 45 | loss: 0.0000197
	speed: 0.5270s/iter; left time: 12136.4779s
	iters: 200, epoch: 45 | loss: 0.0000010
	speed: 0.2533s/iter; left time: 5808.1639s
	iters: 300, epoch: 45 | loss: 0.0000013
	speed: 0.2573s/iter; left time: 5874.5366s
	iters: 400, epoch: 45 | loss: 0.0000127
	speed: 0.2577s/iter; left time: 5857.7727s
Epoch: 45 cost time: 106.921395778656
Epoch: 45, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.052 Vali Acc: 0.988 Test Loss: 0.052 Test Acc: 0.988
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 46 | loss: 0.0000582
	speed: 0.5247s/iter; left time: 11865.9530s
	iters: 200, epoch: 46 | loss: 0.0000160
	speed: 0.2614s/iter; left time: 5885.4304s
	iters: 300, epoch: 46 | loss: 0.0000009
	speed: 0.2686s/iter; left time: 6021.7195s
	iters: 400, epoch: 46 | loss: 0.0000101
	speed: 0.2581s/iter; left time: 5758.6578s
Epoch: 46 cost time: 108.82804322242737
Epoch: 46, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.040 Vali Acc: 0.990 Test Loss: 0.040 Test Acc: 0.990
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 47 | loss: 0.0000099
	speed: 0.5075s/iter; left time: 11268.3122s
	iters: 200, epoch: 47 | loss: 0.0000155
	speed: 0.2807s/iter; left time: 6204.5201s
	iters: 300, epoch: 47 | loss: 0.0000223
	speed: 0.2765s/iter; left time: 6082.7681s
	iters: 400, epoch: 47 | loss: 0.0000037
	speed: 0.2618s/iter; left time: 5733.9927s
Epoch: 47 cost time: 111.40310430526733
Epoch: 47, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.045 Vali Acc: 0.990 Test Loss: 0.045 Test Acc: 0.990
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 48 | loss: 0.0000024
	speed: 0.5055s/iter; left time: 11014.2212s
	iters: 200, epoch: 48 | loss: 0.0000010
	speed: 0.2507s/iter; left time: 5436.9126s
	iters: 300, epoch: 48 | loss: 0.0000040
	speed: 0.2602s/iter; left time: 5617.6325s
	iters: 400, epoch: 48 | loss: 0.0000002
	speed: 0.2641s/iter; left time: 5676.0664s
Epoch: 48 cost time: 106.8523108959198
Epoch: 48, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.045 Vali Acc: 0.989 Test Loss: 0.045 Test Acc: 0.989
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df256_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.990450204638472
model parameter : 10613770
model size : 60.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df256_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2379332
	speed: 0.2778s/iter; left time: 11446.0040s
	iters: 200, epoch: 1 | loss: 0.1444327
	speed: 0.2601s/iter; left time: 10690.9311s
	iters: 300, epoch: 1 | loss: 0.1189477
	speed: 0.2671s/iter; left time: 10950.2137s
	iters: 400, epoch: 1 | loss: 0.0005993
	speed: 0.2870s/iter; left time: 11737.2566s
Epoch: 1 cost time: 113.1248049736023
Epoch: 1, Steps: 413 | Train Loss: 0.524 Vali Loss: 0.274 Vali Acc: 0.936 Test Loss: 0.274 Test Acc: 0.936
Validation loss decreased (inf --> -0.935877).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4634527
	speed: 0.5410s/iter; left time: 22064.5423s
	iters: 200, epoch: 2 | loss: 0.6334252
	speed: 0.2565s/iter; left time: 10438.3498s
	iters: 300, epoch: 2 | loss: 0.0395664
	speed: 0.2534s/iter; left time: 10285.5447s
	iters: 400, epoch: 2 | loss: 0.4879949
	speed: 0.2574s/iter; left time: 10420.2094s
Epoch: 2 cost time: 107.22615194320679
Epoch: 2, Steps: 413 | Train Loss: 0.291 Vali Loss: 0.479 Vali Acc: 0.920 Test Loss: 0.479 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1765919
	speed: 0.5473s/iter; left time: 22098.8134s
	iters: 200, epoch: 3 | loss: 0.0294811
	speed: 0.2774s/iter; left time: 11172.4744s
	iters: 300, epoch: 3 | loss: 0.0020353
	speed: 0.2794s/iter; left time: 11222.9432s
	iters: 400, epoch: 3 | loss: 0.0018552
	speed: 0.2753s/iter; left time: 11033.6656s
Epoch: 3 cost time: 115.00956535339355
Epoch: 3, Steps: 413 | Train Loss: 0.310 Vali Loss: 0.358 Vali Acc: 0.951 Test Loss: 0.358 Test Acc: 0.951
Validation loss decreased (-0.935877 --> -0.951338).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0002707
	speed: 0.5499s/iter; left time: 21976.1705s
	iters: 200, epoch: 4 | loss: 0.0000529
	speed: 0.2846s/iter; left time: 11343.1943s
	iters: 300, epoch: 4 | loss: 0.0000112
	speed: 0.2705s/iter; left time: 10754.6863s
	iters: 400, epoch: 4 | loss: 0.0029487
	speed: 0.2543s/iter; left time: 10085.2541s
Epoch: 4 cost time: 112.58253026008606
Epoch: 4, Steps: 413 | Train Loss: 0.331 Vali Loss: 0.310 Vali Acc: 0.961 Test Loss: 0.310 Test Acc: 0.961
Validation loss decreased (-0.951338 --> -0.961343).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2333006
	speed: 0.5065s/iter; left time: 20029.7228s
	iters: 200, epoch: 5 | loss: 0.1599428
	speed: 0.2790s/iter; left time: 11006.4252s
	iters: 300, epoch: 5 | loss: 0.0015052
	speed: 0.2691s/iter; left time: 10588.9176s
	iters: 400, epoch: 5 | loss: 0.0000137
	speed: 0.2695s/iter; left time: 10578.4267s
Epoch: 5 cost time: 111.23600101470947
Epoch: 5, Steps: 413 | Train Loss: 0.323 Vali Loss: 0.489 Vali Acc: 0.940 Test Loss: 0.489 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000091
	speed: 0.5374s/iter; left time: 21031.9429s
	iters: 200, epoch: 6 | loss: 0.0000003
	speed: 0.2659s/iter; left time: 10378.3764s
	iters: 300, epoch: 6 | loss: 2.1904216
	speed: 0.2792s/iter; left time: 10870.2797s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.2736s/iter; left time: 10626.0634s
Epoch: 6 cost time: 112.86848711967468
Epoch: 6, Steps: 413 | Train Loss: 0.265 Vali Loss: 0.413 Vali Acc: 0.959 Test Loss: 0.413 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000397
	speed: 0.5244s/iter; left time: 20307.2078s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.2595s/iter; left time: 10022.3597s
	iters: 300, epoch: 7 | loss: 0.0000000
	speed: 0.2718s/iter; left time: 10468.9159s
	iters: 400, epoch: 7 | loss: 0.8999710
	speed: 0.2681s/iter; left time: 10301.9833s
Epoch: 7 cost time: 109.59190654754639
Epoch: 7, Steps: 413 | Train Loss: 0.213 Vali Loss: 0.245 Vali Acc: 0.966 Test Loss: 0.245 Test Acc: 0.966
Validation loss decreased (-0.961343 --> -0.966346).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3320116
	speed: 0.5350s/iter; left time: 20496.9246s
	iters: 200, epoch: 8 | loss: 0.0536131
	speed: 0.2802s/iter; left time: 10707.0631s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.2677s/iter; left time: 10202.9583s
	iters: 400, epoch: 8 | loss: 0.0000031
	speed: 0.2649s/iter; left time: 10069.8378s
Epoch: 8 cost time: 112.89404296875
Epoch: 8, Steps: 413 | Train Loss: 0.222 Vali Loss: 0.358 Vali Acc: 0.965 Test Loss: 0.358 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.5470s/iter; left time: 20729.1271s
	iters: 200, epoch: 9 | loss: 0.0000001
	speed: 0.2844s/iter; left time: 10750.1151s
	iters: 300, epoch: 9 | loss: 0.0000080
	speed: 0.2725s/iter; left time: 10272.6016s
	iters: 400, epoch: 9 | loss: 0.7115140
	speed: 0.2616s/iter; left time: 9836.0969s
Epoch: 9 cost time: 114.04235553741455
Epoch: 9, Steps: 413 | Train Loss: 0.208 Vali Loss: 0.747 Vali Acc: 0.956 Test Loss: 0.747 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.3871384
	speed: 0.5600s/iter; left time: 20991.5435s
	iters: 200, epoch: 10 | loss: 0.1160255
	speed: 0.2998s/iter; left time: 11208.6655s
	iters: 300, epoch: 10 | loss: 0.0000557
	speed: 0.2696s/iter; left time: 10051.1979s
	iters: 400, epoch: 10 | loss: 0.0000986
	speed: 0.2809s/iter; left time: 10443.4567s
Epoch: 10 cost time: 118.88833975791931
Epoch: 10, Steps: 413 | Train Loss: 0.202 Vali Loss: 0.280 Vali Acc: 0.965 Test Loss: 0.280 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.5489808
	speed: 0.5657s/iter; left time: 20969.5778s
	iters: 200, epoch: 11 | loss: 0.0179664
	speed: 0.3027s/iter; left time: 11190.7394s
	iters: 300, epoch: 11 | loss: 0.0000032
	speed: 0.3019s/iter; left time: 11130.5606s
	iters: 400, epoch: 11 | loss: 0.0000072
	speed: 0.2798s/iter; left time: 10288.9655s
Epoch: 11 cost time: 121.61267447471619
Epoch: 11, Steps: 413 | Train Loss: 0.150 Vali Loss: 0.372 Vali Acc: 0.966 Test Loss: 0.372 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.6003s/iter; left time: 22004.9767s
	iters: 200, epoch: 12 | loss: 0.0009567
	speed: 0.2878s/iter; left time: 10522.1507s
	iters: 300, epoch: 12 | loss: 0.0000514
	speed: 0.2859s/iter; left time: 10421.6435s
	iters: 400, epoch: 12 | loss: 0.1681812
	speed: 0.2948s/iter; left time: 10717.2936s
Epoch: 12 cost time: 121.92128610610962
Epoch: 12, Steps: 413 | Train Loss: 0.114 Vali Loss: 0.652 Vali Acc: 0.950 Test Loss: 0.652 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.5847s/iter; left time: 21192.9884s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.2879s/iter; left time: 10405.1125s
	iters: 300, epoch: 13 | loss: 0.6539903
	speed: 0.3055s/iter; left time: 11010.4705s
	iters: 400, epoch: 13 | loss: 0.2454683
	speed: 0.2939s/iter; left time: 10564.2623s
Epoch: 13 cost time: 122.78095865249634
Epoch: 13, Steps: 413 | Train Loss: 0.120 Vali Loss: 0.292 Vali Acc: 0.969 Test Loss: 0.292 Test Acc: 0.969
Validation loss decreased (-0.966346 --> -0.969074).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.6012086
	speed: 0.5956s/iter; left time: 21342.0553s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.2880s/iter; left time: 10289.5373s
	iters: 300, epoch: 14 | loss: 0.0000015
	speed: 0.2878s/iter; left time: 10256.5012s
	iters: 400, epoch: 14 | loss: 0.0000015
	speed: 0.2979s/iter; left time: 10583.6012s
Epoch: 14 cost time: 120.88017797470093
Epoch: 14, Steps: 413 | Train Loss: 0.155 Vali Loss: 0.395 Vali Acc: 0.969 Test Loss: 0.395 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.3813705
	speed: 0.5961s/iter; left time: 21112.6707s
	iters: 200, epoch: 15 | loss: 0.2715847
	speed: 0.2908s/iter; left time: 10269.3813s
	iters: 300, epoch: 15 | loss: 0.0015268
	speed: 0.2937s/iter; left time: 10342.3049s
	iters: 400, epoch: 15 | loss: 0.0001059
	speed: 0.2924s/iter; left time: 10268.4378s
Epoch: 15 cost time: 122.90204644203186
Epoch: 15, Steps: 413 | Train Loss: 0.137 Vali Loss: 0.346 Vali Acc: 0.970 Test Loss: 0.346 Test Acc: 0.970
Validation loss decreased (-0.969074 --> -0.969528).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0001272
	speed: 0.5973s/iter; left time: 20907.6983s
	iters: 200, epoch: 16 | loss: 0.1045136
	speed: 0.2728s/iter; left time: 9521.1943s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.2981s/iter; left time: 10374.7917s
	iters: 400, epoch: 16 | loss: 0.0000033
	speed: 0.2961s/iter; left time: 10276.9204s
Epoch: 16 cost time: 121.04752850532532
Epoch: 16, Steps: 413 | Train Loss: 0.115 Vali Loss: 0.238 Vali Acc: 0.980 Test Loss: 0.238 Test Acc: 0.980
Validation loss decreased (-0.969528 --> -0.979534).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.5831s/iter; left time: 20172.1809s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.2953s/iter; left time: 10187.3905s
	iters: 300, epoch: 17 | loss: 0.0153888
	speed: 0.2908s/iter; left time: 10002.0702s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.3002s/iter; left time: 10294.0494s
Epoch: 17 cost time: 121.89109230041504
Epoch: 17, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.316 Vali Acc: 0.970 Test Loss: 0.316 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000354
	speed: 0.5800s/iter; left time: 19825.9083s
	iters: 200, epoch: 18 | loss: 0.0000012
	speed: 0.2843s/iter; left time: 9688.9660s
	iters: 300, epoch: 18 | loss: 0.0208897
	speed: 0.2831s/iter; left time: 9619.8322s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.2988s/iter; left time: 10124.5020s
Epoch: 18 cost time: 120.68674492835999
Epoch: 18, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.265 Vali Acc: 0.974 Test Loss: 0.265 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000004
	speed: 0.5801s/iter; left time: 19587.2150s
	iters: 200, epoch: 19 | loss: 0.0000108
	speed: 0.2891s/iter; left time: 9734.0629s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.3059s/iter; left time: 10267.1242s
	iters: 400, epoch: 19 | loss: 0.0000004
	speed: 0.2965s/iter; left time: 9922.1112s
Epoch: 19 cost time: 122.0195722579956
Epoch: 19, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.459 Vali Acc: 0.957 Test Loss: 0.459 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000001
	speed: 0.5755s/iter; left time: 19196.0233s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.2806s/iter; left time: 9330.2009s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.2934s/iter; left time: 9726.7216s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.2977s/iter; left time: 9840.1826s
Epoch: 20 cost time: 120.80761957168579
Epoch: 20, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.243 Vali Acc: 0.976 Test Loss: 0.243 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.5898s/iter; left time: 19430.0085s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.3063s/iter; left time: 10060.0910s
	iters: 300, epoch: 21 | loss: 0.2156725
	speed: 0.3073s/iter; left time: 10061.0326s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.3112s/iter; left time: 10157.7133s
Epoch: 21 cost time: 127.02673482894897
Epoch: 21, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.170 Vali Acc: 0.980 Test Loss: 0.170 Test Acc: 0.980
Validation loss decreased (-0.979534 --> -0.979989).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.5861s/iter; left time: 19063.9569s
	iters: 200, epoch: 22 | loss: 0.0000162
	speed: 0.2999s/iter; left time: 9726.4848s
	iters: 300, epoch: 22 | loss: 0.0000005
	speed: 0.3082s/iter; left time: 9964.2361s
	iters: 400, epoch: 22 | loss: 0.0000001
	speed: 0.2852s/iter; left time: 9190.3942s
Epoch: 22 cost time: 122.69185972213745
Epoch: 22, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.219 Vali Acc: 0.976 Test Loss: 0.219 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0000767
	speed: 0.5828s/iter; left time: 18715.8289s
	iters: 200, epoch: 23 | loss: 0.0335673
	speed: 0.3080s/iter; left time: 9859.9705s
	iters: 300, epoch: 23 | loss: 0.0775932
	speed: 0.3044s/iter; left time: 9716.4618s
	iters: 400, epoch: 23 | loss: 0.0000024
	speed: 0.2855s/iter; left time: 9081.8887s
Epoch: 23 cost time: 124.04551219940186
Epoch: 23, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.206 Vali Acc: 0.980 Test Loss: 0.206 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.5854s/iter; left time: 18559.0240s
	iters: 200, epoch: 24 | loss: 0.2003872
	speed: 0.3040s/iter; left time: 9605.9122s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.3039s/iter; left time: 9574.0171s
	iters: 400, epoch: 24 | loss: 0.0300242
	speed: 0.2893s/iter; left time: 9083.8511s
Epoch: 24 cost time: 123.82516860961914
Epoch: 24, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.332 Vali Acc: 0.967 Test Loss: 0.332 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0000008
	speed: 0.5818s/iter; left time: 18204.9331s
	iters: 200, epoch: 25 | loss: 0.0009258
	speed: 0.3035s/iter; left time: 9464.8290s
	iters: 300, epoch: 25 | loss: 0.0000004
	speed: 0.2895s/iter; left time: 9000.1027s
	iters: 400, epoch: 25 | loss: 0.0004452
	speed: 0.2703s/iter; left time: 8377.6982s
Epoch: 25 cost time: 119.84797215461731
Epoch: 25, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.153 Vali Acc: 0.973 Test Loss: 0.153 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0000173
	speed: 0.5985s/iter; left time: 18477.8930s
	iters: 200, epoch: 26 | loss: 0.0025697
	speed: 0.2996s/iter; left time: 9220.4498s
	iters: 300, epoch: 26 | loss: 0.0000255
	speed: 0.2839s/iter; left time: 8708.2014s
	iters: 400, epoch: 26 | loss: 0.0000164
	speed: 0.2944s/iter; left time: 9001.1886s
Epoch: 26 cost time: 123.20338797569275
Epoch: 26, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.181 Vali Acc: 0.971 Test Loss: 0.181 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.6004s/iter; left time: 18290.2037s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.3093s/iter; left time: 9389.8393s
	iters: 300, epoch: 27 | loss: 0.0000020
	speed: 0.3089s/iter; left time: 9347.0775s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.2834s/iter; left time: 8548.0457s
Epoch: 27 cost time: 125.3997061252594
Epoch: 27, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.132 Vali Acc: 0.981 Test Loss: 0.132 Test Acc: 0.981
Validation loss decreased (-0.979989 --> -0.980899).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.6000s/iter; left time: 18028.7001s
	iters: 200, epoch: 28 | loss: 0.0112203
	speed: 0.2975s/iter; left time: 8911.4556s
	iters: 300, epoch: 28 | loss: 0.0009154
	speed: 0.2835s/iter; left time: 8463.7345s
	iters: 400, epoch: 28 | loss: 0.0000001
	speed: 0.2897s/iter; left time: 8618.3404s
Epoch: 28 cost time: 122.11033082008362
Epoch: 28, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.109 Vali Acc: 0.984 Test Loss: 0.109 Test Acc: 0.984
Validation loss decreased (-0.980899 --> -0.983628).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.6242s/iter; left time: 18499.3134s
	iters: 200, epoch: 29 | loss: 0.0000155
	speed: 0.3009s/iter; left time: 8889.0202s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.3049s/iter; left time: 8975.7239s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.2876s/iter; left time: 8437.6937s
Epoch: 29 cost time: 124.50267338752747
Epoch: 29, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.136 Vali Acc: 0.982 Test Loss: 0.136 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.9170949
	speed: 0.6258s/iter; left time: 18288.1720s
	iters: 200, epoch: 30 | loss: 0.0280991
	speed: 0.3063s/iter; left time: 8921.7037s
	iters: 300, epoch: 30 | loss: 0.0068949
	speed: 0.2843s/iter; left time: 8250.3536s
	iters: 400, epoch: 30 | loss: 0.0005658
	speed: 0.2760s/iter; left time: 7983.5152s
Epoch: 30 cost time: 122.68632745742798
Epoch: 30, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.0000022
	speed: 0.6001s/iter; left time: 17290.1429s
	iters: 200, epoch: 31 | loss: 0.0000001
	speed: 0.2770s/iter; left time: 7951.5999s
	iters: 300, epoch: 31 | loss: 0.0000281
	speed: 0.2809s/iter; left time: 8036.7621s
	iters: 400, epoch: 31 | loss: 0.0000103
	speed: 0.2972s/iter; left time: 8473.5173s
Epoch: 31 cost time: 120.10733151435852
Epoch: 31, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.0000287
	speed: 0.6223s/iter; left time: 17671.8008s
	iters: 200, epoch: 32 | loss: 0.0000243
	speed: 0.2954s/iter; left time: 8358.9983s
	iters: 300, epoch: 32 | loss: 0.0001655
	speed: 0.2938s/iter; left time: 8283.4092s
	iters: 400, epoch: 32 | loss: 0.0001041
	speed: 0.3038s/iter; left time: 8535.4225s
Epoch: 32 cost time: 125.21804451942444
Epoch: 32, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.080 Vali Acc: 0.985 Test Loss: 0.080 Test Acc: 0.985
Validation loss decreased (-0.983628 --> -0.984538).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.0000097
	speed: 0.6080s/iter; left time: 17013.5784s
	iters: 200, epoch: 33 | loss: 0.0001561
	speed: 0.2938s/iter; left time: 8191.9249s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.2930s/iter; left time: 8142.3197s
	iters: 400, epoch: 33 | loss: 0.0000028
	speed: 0.3016s/iter; left time: 8348.8879s
Epoch: 33 cost time: 123.28765749931335
Epoch: 33, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 0.0000013
	speed: 0.5799s/iter; left time: 15989.3258s
	iters: 200, epoch: 34 | loss: 0.1425657
	speed: 0.2712s/iter; left time: 7450.4916s
	iters: 300, epoch: 34 | loss: 0.0000052
	speed: 0.2983s/iter; left time: 8165.2215s
	iters: 400, epoch: 34 | loss: 0.0000149
	speed: 0.3024s/iter; left time: 8246.7699s
Epoch: 34 cost time: 120.83331632614136
Epoch: 34, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.6126s/iter; left time: 16638.9381s
	iters: 200, epoch: 35 | loss: 0.0000114
	speed: 0.2881s/iter; left time: 7796.3549s
	iters: 300, epoch: 35 | loss: 0.0000221
	speed: 0.3066s/iter; left time: 8265.9007s
	iters: 400, epoch: 35 | loss: 0.0003193
	speed: 0.3085s/iter; left time: 8285.4207s
Epoch: 35 cost time: 125.85063576698303
Epoch: 35, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.088 Vali Acc: 0.985 Test Loss: 0.088 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 36 | loss: 0.0003789
	speed: 0.5866s/iter; left time: 15690.4845s
	iters: 200, epoch: 36 | loss: 0.1249906
	speed: 0.2916s/iter; left time: 7770.1006s
	iters: 300, epoch: 36 | loss: 0.0000054
	speed: 0.2917s/iter; left time: 7743.3771s
	iters: 400, epoch: 36 | loss: 0.0000007
	speed: 0.3028s/iter; left time: 8007.8419s
Epoch: 36 cost time: 121.49195957183838
Epoch: 36, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.050 Vali Acc: 0.990 Test Loss: 0.050 Test Acc: 0.990
Validation loss decreased (-0.984538 --> -0.989540).  Saving model ...
	iters: 100, epoch: 37 | loss: 0.0011626
	speed: 0.5987s/iter; left time: 15766.4065s
	iters: 200, epoch: 37 | loss: 0.0000083
	speed: 0.2889s/iter; left time: 7578.8254s
	iters: 300, epoch: 37 | loss: 0.8854249
	speed: 0.2967s/iter; left time: 7754.3662s
	iters: 400, epoch: 37 | loss: 0.0069736
	speed: 0.3106s/iter; left time: 8085.1626s
Epoch: 37 cost time: 123.0216372013092
Epoch: 37, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.135 Vali Acc: 0.977 Test Loss: 0.135 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 38 | loss: 0.0007146
	speed: 0.5978s/iter; left time: 15496.2532s
	iters: 200, epoch: 38 | loss: 0.0000569
	speed: 0.3142s/iter; left time: 8112.4984s
	iters: 300, epoch: 38 | loss: 0.0000028
	speed: 0.3013s/iter; left time: 7749.4116s
	iters: 400, epoch: 38 | loss: 0.0000286
	speed: 0.3096s/iter; left time: 7931.5458s
Epoch: 38 cost time: 127.84224677085876
Epoch: 38, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.068 Vali Acc: 0.987 Test Loss: 0.068 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 39 | loss: 0.0000016
	speed: 0.6189s/iter; left time: 15785.0971s
	iters: 200, epoch: 39 | loss: 0.8721328
	speed: 0.2930s/iter; left time: 7444.4340s
	iters: 300, epoch: 39 | loss: 0.0000048
	speed: 0.2757s/iter; left time: 6977.4899s
	iters: 400, epoch: 39 | loss: 0.0004941
	speed: 0.2833s/iter; left time: 7141.0931s
Epoch: 39 cost time: 122.06825733184814
Epoch: 39, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.156 Vali Acc: 0.971 Test Loss: 0.156 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 40 | loss: 0.0016511
	speed: 0.5613s/iter; left time: 14084.1342s
	iters: 200, epoch: 40 | loss: 0.0000037
	speed: 0.2713s/iter; left time: 6779.9625s
	iters: 300, epoch: 40 | loss: 0.0000077
	speed: 0.2817s/iter; left time: 7012.9641s
	iters: 400, epoch: 40 | loss: 0.0000222
	speed: 0.2875s/iter; left time: 7128.0260s
Epoch: 40 cost time: 115.90619659423828
Epoch: 40, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.130 Vali Acc: 0.974 Test Loss: 0.130 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 41 | loss: 0.0003106
	speed: 0.5652s/iter; left time: 13950.5109s
	iters: 200, epoch: 41 | loss: 0.0000189
	speed: 0.2962s/iter; left time: 7279.8744s
	iters: 300, epoch: 41 | loss: 0.0012977
	speed: 0.2840s/iter; left time: 6953.3952s
	iters: 400, epoch: 41 | loss: 0.0002697
	speed: 0.2868s/iter; left time: 6991.7872s
Epoch: 41 cost time: 119.32622456550598
Epoch: 41, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.147 Vali Acc: 0.976 Test Loss: 0.147 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 42 | loss: 0.0001248
	speed: 0.5496s/iter; left time: 13336.6262s
	iters: 200, epoch: 42 | loss: 0.0001171
	speed: 0.2853s/iter; left time: 6894.7484s
	iters: 300, epoch: 42 | loss: 0.0267750
	speed: 0.2725s/iter; left time: 6559.0136s
	iters: 400, epoch: 42 | loss: 0.0001762
	speed: 0.2757s/iter; left time: 6606.8802s
Epoch: 42 cost time: 115.37008142471313
Epoch: 42, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 43 | loss: 0.0000137
	speed: 0.5595s/iter; left time: 13345.8208s
	iters: 200, epoch: 43 | loss: 0.0000001
	speed: 0.2720s/iter; left time: 6460.5277s
	iters: 300, epoch: 43 | loss: 0.0000008
	speed: 0.2868s/iter; left time: 6784.2970s
	iters: 400, epoch: 43 | loss: 0.0006642
	speed: 0.2868s/iter; left time: 6755.9300s
Epoch: 43 cost time: 116.90205788612366
Epoch: 43, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 44 | loss: 0.0006296
	speed: 0.5633s/iter; left time: 13204.6203s
	iters: 200, epoch: 44 | loss: 0.0000111
	speed: 0.2755s/iter; left time: 6431.3224s
	iters: 300, epoch: 44 | loss: 0.0000923
	speed: 0.2945s/iter; left time: 6845.7273s
	iters: 400, epoch: 44 | loss: 0.0000426
	speed: 0.2924s/iter; left time: 6766.3565s
Epoch: 44 cost time: 117.54224896430969
Epoch: 44, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 45 | loss: 0.0001609
	speed: 0.5344s/iter; left time: 12306.3851s
	iters: 200, epoch: 45 | loss: 0.0000013
	speed: 0.2813s/iter; left time: 6448.8626s
	iters: 300, epoch: 45 | loss: 0.0000200
	speed: 0.2869s/iter; left time: 6549.9457s
	iters: 400, epoch: 45 | loss: 0.0000655
	speed: 0.2721s/iter; left time: 6183.5233s
Epoch: 45 cost time: 114.8974187374115
Epoch: 45, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.069 Vali Acc: 0.984 Test Loss: 0.069 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 46 | loss: 0.0000376
	speed: 0.5398s/iter; left time: 12207.5802s
	iters: 200, epoch: 46 | loss: 0.0000031
	speed: 0.2828s/iter; left time: 6368.1460s
	iters: 300, epoch: 46 | loss: 0.0000006
	speed: 0.2918s/iter; left time: 6541.6175s
	iters: 400, epoch: 46 | loss: 0.0000619
	speed: 0.2810s/iter; left time: 6269.8660s
Epoch: 46 cost time: 117.69344139099121
Epoch: 46, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.981 Test Loss: 0.089 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df256_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9895407003183265
model parameter : 10613770
model size : 60.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1217625
	speed: 0.3235s/iter; left time: 13328.9397s
	iters: 200, epoch: 1 | loss: 0.2384941
	speed: 0.3081s/iter; left time: 12665.1428s
	iters: 300, epoch: 1 | loss: 0.0105621
	speed: 0.3174s/iter; left time: 13013.9871s
	iters: 400, epoch: 1 | loss: 0.0475822
	speed: 0.3092s/iter; left time: 12648.0365s
Epoch: 1 cost time: 130.34710550308228
Epoch: 1, Steps: 413 | Train Loss: 0.550 Vali Loss: 0.259 Vali Acc: 0.937 Test Loss: 0.259 Test Acc: 0.937
Validation loss decreased (inf --> -0.937242).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8161300
	speed: 0.5844s/iter; left time: 23836.0180s
	iters: 200, epoch: 2 | loss: 0.6998575
	speed: 0.3030s/iter; left time: 12329.9044s
	iters: 300, epoch: 2 | loss: 0.5189773
	speed: 0.3214s/iter; left time: 13044.7212s
	iters: 400, epoch: 2 | loss: 0.0543125
	speed: 0.2981s/iter; left time: 12070.6777s
Epoch: 2 cost time: 126.76381134986877
Epoch: 2, Steps: 413 | Train Loss: 0.276 Vali Loss: 0.314 Vali Acc: 0.945 Test Loss: 0.314 Test Acc: 0.945
Validation loss decreased (-0.937242 --> -0.945427).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0147291
	speed: 0.6272s/iter; left time: 25321.4586s
	iters: 200, epoch: 3 | loss: 0.0011204
	speed: 0.3133s/iter; left time: 12618.2828s
	iters: 300, epoch: 3 | loss: 0.8962058
	speed: 0.3178s/iter; left time: 12767.7045s
	iters: 400, epoch: 3 | loss: 0.0127833
	speed: 0.3198s/iter; left time: 12815.9197s
Epoch: 3 cost time: 130.84503531455994
Epoch: 3, Steps: 413 | Train Loss: 0.315 Vali Loss: 0.359 Vali Acc: 0.946 Test Loss: 0.359 Test Acc: 0.946
Validation loss decreased (-0.945427 --> -0.946336).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5568490
	speed: 0.6205s/iter; left time: 24794.8133s
	iters: 200, epoch: 4 | loss: 0.2448984
	speed: 0.2992s/iter; left time: 11926.9494s
	iters: 300, epoch: 4 | loss: 0.0001406
	speed: 0.3173s/iter; left time: 12617.4499s
	iters: 400, epoch: 4 | loss: 0.0035272
	speed: 0.3214s/iter; left time: 12749.0300s
Epoch: 4 cost time: 128.6477508544922
Epoch: 4, Steps: 413 | Train Loss: 0.293 Vali Loss: 0.394 Vali Acc: 0.950 Test Loss: 0.394 Test Acc: 0.950
Validation loss decreased (-0.946336 --> -0.949973).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.8619027
	speed: 0.5979s/iter; left time: 23647.8603s
	iters: 200, epoch: 5 | loss: 1.1721123
	speed: 0.3232s/iter; left time: 12749.4260s
	iters: 300, epoch: 5 | loss: 1.8466229
	speed: 0.3017s/iter; left time: 11872.9343s
	iters: 400, epoch: 5 | loss: 0.3396588
	speed: 0.2911s/iter; left time: 11424.1653s
Epoch: 5 cost time: 127.19459366798401
Epoch: 5, Steps: 413 | Train Loss: 0.294 Vali Loss: 0.256 Vali Acc: 0.970 Test Loss: 0.256 Test Acc: 0.970
Validation loss decreased (-0.949973 --> -0.969529).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000002
	speed: 0.6231s/iter; left time: 24387.4312s
	iters: 200, epoch: 6 | loss: 0.8244168
	speed: 0.2922s/iter; left time: 11406.5399s
	iters: 300, epoch: 6 | loss: 1.6181588
	speed: 0.3096s/iter; left time: 12056.0867s
	iters: 400, epoch: 6 | loss: 0.0098882
	speed: 0.3153s/iter; left time: 12246.4251s
Epoch: 6 cost time: 127.85381722450256
Epoch: 6, Steps: 413 | Train Loss: 0.247 Vali Loss: 0.736 Vali Acc: 0.926 Test Loss: 0.736 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.5922s/iter; left time: 22932.5500s
	iters: 200, epoch: 7 | loss: 0.0000103
	speed: 0.3144s/iter; left time: 12144.0836s
	iters: 300, epoch: 7 | loss: 0.2996019
	speed: 0.3212s/iter; left time: 12375.2774s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.3056s/iter; left time: 11743.6765s
Epoch: 7 cost time: 128.854722738266
Epoch: 7, Steps: 413 | Train Loss: 0.280 Vali Loss: 0.296 Vali Acc: 0.967 Test Loss: 0.296 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000006
	speed: 0.5921s/iter; left time: 22682.1982s
	iters: 200, epoch: 8 | loss: 0.4596514
	speed: 0.3125s/iter; left time: 11941.4365s
	iters: 300, epoch: 8 | loss: 0.0000065
	speed: 0.3076s/iter; left time: 11723.2965s
	iters: 400, epoch: 8 | loss: 0.0090895
	speed: 0.3005s/iter; left time: 11421.5186s
Epoch: 8 cost time: 126.7544014453888
Epoch: 8, Steps: 413 | Train Loss: 0.176 Vali Loss: 0.273 Vali Acc: 0.971 Test Loss: 0.273 Test Acc: 0.971
Validation loss decreased (-0.969529 --> -0.971348).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0004340
	speed: 0.6159s/iter; left time: 23340.2869s
	iters: 200, epoch: 9 | loss: 1.4898601
	speed: 0.3104s/iter; left time: 11730.5194s
	iters: 300, epoch: 9 | loss: 0.0000003
	speed: 0.3086s/iter; left time: 11632.0957s
	iters: 400, epoch: 9 | loss: 0.0000432
	speed: 0.3108s/iter; left time: 11684.4520s
Epoch: 9 cost time: 128.25474405288696
Epoch: 9, Steps: 413 | Train Loss: 0.131 Vali Loss: 0.283 Vali Acc: 0.967 Test Loss: 0.283 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.0130554
	speed: 0.5951s/iter; left time: 22306.5048s
	iters: 200, epoch: 10 | loss: 0.4376640
	speed: 0.2970s/iter; left time: 11104.1122s
	iters: 300, epoch: 10 | loss: 0.0001547
	speed: 0.3136s/iter; left time: 11693.4632s
	iters: 400, epoch: 10 | loss: 0.0000001
	speed: 0.2951s/iter; left time: 10973.2988s
Epoch: 10 cost time: 124.3204734325409
Epoch: 10, Steps: 413 | Train Loss: 0.200 Vali Loss: 0.511 Vali Acc: 0.954 Test Loss: 0.511 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.3050133
	speed: 0.5955s/iter; left time: 22076.9943s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.3030s/iter; left time: 11201.7782s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.3045s/iter; left time: 11226.8716s
	iters: 400, epoch: 11 | loss: 0.2837255
	speed: 0.2980s/iter; left time: 10958.0133s
Epoch: 11 cost time: 125.08653998374939
Epoch: 11, Steps: 413 | Train Loss: 0.143 Vali Loss: 0.466 Vali Acc: 0.961 Test Loss: 0.466 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000411
	speed: 0.6014s/iter; left time: 22046.1857s
	iters: 200, epoch: 12 | loss: 0.0000014
	speed: 0.2885s/iter; left time: 10546.9871s
	iters: 300, epoch: 12 | loss: 0.0000016
	speed: 0.2921s/iter; left time: 10647.9856s
	iters: 400, epoch: 12 | loss: 0.3954232
	speed: 0.2994s/iter; left time: 10884.6767s
Epoch: 12 cost time: 122.47598624229431
Epoch: 12, Steps: 413 | Train Loss: 0.141 Vali Loss: 0.489 Vali Acc: 0.953 Test Loss: 0.489 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.5763s/iter; left time: 20888.7970s
	iters: 200, epoch: 13 | loss: 0.0006702
	speed: 0.2860s/iter; left time: 10338.0368s
	iters: 300, epoch: 13 | loss: 0.0000019
	speed: 0.2915s/iter; left time: 10506.3281s
	iters: 400, epoch: 13 | loss: 0.9590334
	speed: 0.3112s/iter; left time: 11185.1048s
Epoch: 13 cost time: 121.68378949165344
Epoch: 13, Steps: 413 | Train Loss: 0.168 Vali Loss: 0.452 Vali Acc: 0.966 Test Loss: 0.452 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.6219s/iter; left time: 22283.6805s
	iters: 200, epoch: 14 | loss: 0.6816361
	speed: 0.3158s/iter; left time: 11283.5399s
	iters: 300, epoch: 14 | loss: 0.1397867
	speed: 0.2997s/iter; left time: 10680.1879s
	iters: 400, epoch: 14 | loss: 0.0358970
	speed: 0.3015s/iter; left time: 10712.1334s
Epoch: 14 cost time: 127.54676914215088
Epoch: 14, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.468 Vali Acc: 0.955 Test Loss: 0.468 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.3802174
	speed: 0.5949s/iter; left time: 21070.4853s
	iters: 200, epoch: 15 | loss: 1.4733113
	speed: 0.3028s/iter; left time: 10694.1244s
	iters: 300, epoch: 15 | loss: 0.0000032
	speed: 0.3079s/iter; left time: 10843.3315s
	iters: 400, epoch: 15 | loss: 0.0012047
	speed: 0.2960s/iter; left time: 10395.4461s
Epoch: 15 cost time: 124.04943060874939
Epoch: 15, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.154 Vali Acc: 0.980 Test Loss: 0.154 Test Acc: 0.980
Validation loss decreased (-0.971348 --> -0.979535).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.2319143
	speed: 0.6361s/iter; left time: 22268.4906s
	iters: 200, epoch: 16 | loss: 0.7716883
	speed: 0.3046s/iter; left time: 10632.2933s
	iters: 300, epoch: 16 | loss: 0.0000962
	speed: 0.3371s/iter; left time: 11732.6154s
	iters: 400, epoch: 16 | loss: 0.0033139
	speed: 0.3194s/iter; left time: 11085.4143s
Epoch: 16 cost time: 132.14283776283264
Epoch: 16, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.362 Vali Acc: 0.965 Test Loss: 0.362 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000001
	speed: 0.5980s/iter; left time: 20686.9391s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.3114s/iter; left time: 10740.5460s
	iters: 300, epoch: 17 | loss: 0.3112034
	speed: 0.3117s/iter; left time: 10719.3850s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.3175s/iter; left time: 10886.4329s
Epoch: 17 cost time: 129.44390630722046
Epoch: 17, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.336 Vali Acc: 0.968 Test Loss: 0.336 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000006
	speed: 0.6132s/iter; left time: 20958.3720s
	iters: 200, epoch: 18 | loss: 0.0227544
	speed: 0.3332s/iter; left time: 11354.5635s
	iters: 300, epoch: 18 | loss: 0.0207520
	speed: 0.3248s/iter; left time: 11036.9669s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.3165s/iter; left time: 10723.4358s
Epoch: 18 cost time: 133.58143210411072
Epoch: 18, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.600 Vali Acc: 0.963 Test Loss: 0.600 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0644262
	speed: 0.6284s/iter; left time: 21220.3554s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.3098s/iter; left time: 10431.5071s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.3159s/iter; left time: 10604.6813s
	iters: 400, epoch: 19 | loss: 0.2221375
	speed: 0.3101s/iter; left time: 10377.0165s
Epoch: 19 cost time: 128.92822337150574
Epoch: 19, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.231 Vali Acc: 0.976 Test Loss: 0.231 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0010190
	speed: 0.6116s/iter; left time: 20399.1141s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.3135s/iter; left time: 10425.5486s
	iters: 300, epoch: 20 | loss: 0.0000992
	speed: 0.3321s/iter; left time: 11011.7334s
	iters: 400, epoch: 20 | loss: 0.0000004
	speed: 0.3262s/iter; left time: 10783.1015s
Epoch: 20 cost time: 131.516259431839
Epoch: 20, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.305 Vali Acc: 0.970 Test Loss: 0.305 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0083422
	speed: 0.6195s/iter; left time: 20407.6398s
	iters: 200, epoch: 21 | loss: 0.0002056
	speed: 0.3197s/iter; left time: 10500.1373s
	iters: 300, epoch: 21 | loss: 0.9224261
	speed: 0.3133s/iter; left time: 10257.2213s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.3035s/iter; left time: 9906.2489s
Epoch: 21 cost time: 129.35560393333435
Epoch: 21, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.295 Vali Acc: 0.975 Test Loss: 0.295 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0000069
	speed: 0.6126s/iter; left time: 19927.3005s
	iters: 200, epoch: 22 | loss: 0.0038187
	speed: 0.3172s/iter; left time: 10287.5490s
	iters: 300, epoch: 22 | loss: 0.0058091
	speed: 0.3222s/iter; left time: 10415.7518s
	iters: 400, epoch: 22 | loss: 0.0001820
	speed: 0.3371s/iter; left time: 10863.1119s
Epoch: 22 cost time: 134.15649127960205
Epoch: 22, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.332 Vali Acc: 0.967 Test Loss: 0.332 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.6279s/iter; left time: 20164.0901s
	iters: 200, epoch: 23 | loss: 0.0000467
	speed: 0.3311s/iter; left time: 10601.1015s
	iters: 300, epoch: 23 | loss: 0.0000001
	speed: 0.3194s/iter; left time: 10193.5405s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.3006s/iter; left time: 9563.2739s
Epoch: 23 cost time: 132.3886399269104
Epoch: 23, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.184 Vali Acc: 0.978 Test Loss: 0.184 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0000002
	speed: 0.5791s/iter; left time: 18359.1497s
	iters: 200, epoch: 24 | loss: 0.0001395
	speed: 0.2988s/iter; left time: 9442.5153s
	iters: 300, epoch: 24 | loss: 0.0000005
	speed: 0.2986s/iter; left time: 9407.3228s
	iters: 400, epoch: 24 | loss: 0.0000012
	speed: 0.2967s/iter; left time: 9315.6408s
Epoch: 24 cost time: 122.83224391937256
Epoch: 24, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.174 Vali Acc: 0.978 Test Loss: 0.174 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.6103s/iter; left time: 19095.9444s
	iters: 200, epoch: 25 | loss: 0.0000064
	speed: 0.3018s/iter; left time: 9413.9376s
	iters: 300, epoch: 25 | loss: 0.0000008
	speed: 0.3083s/iter; left time: 9583.7534s
	iters: 400, epoch: 25 | loss: 0.2193614
	speed: 0.3020s/iter; left time: 9357.5924s
Epoch: 25 cost time: 125.50901460647583
Epoch: 25, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.215 Vali Acc: 0.974 Test Loss: 0.215 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9795361527967258
model parameter : 10613770
model size : 60.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1323959
	speed: 0.3290s/iter; left time: 13556.0646s
	iters: 200, epoch: 1 | loss: 0.3318522
	speed: 0.3003s/iter; left time: 12344.3799s
	iters: 300, epoch: 1 | loss: 0.2015675
	speed: 0.3155s/iter; left time: 12936.8341s
	iters: 400, epoch: 1 | loss: 0.0073377
	speed: 0.3022s/iter; left time: 12361.3657s
Epoch: 1 cost time: 128.30207920074463
Epoch: 1, Steps: 413 | Train Loss: 0.545 Vali Loss: 0.255 Vali Acc: 0.948 Test Loss: 0.255 Test Acc: 0.948
Validation loss decreased (inf --> -0.947701).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4654832
	speed: 0.5883s/iter; left time: 23994.1635s
	iters: 200, epoch: 2 | loss: 1.4965919
	speed: 0.2920s/iter; left time: 11881.5057s
	iters: 300, epoch: 2 | loss: 0.3655163
	speed: 0.2764s/iter; left time: 11217.6595s
	iters: 400, epoch: 2 | loss: 0.0004006
	speed: 0.3011s/iter; left time: 12192.5663s
Epoch: 2 cost time: 122.08115077018738
Epoch: 2, Steps: 413 | Train Loss: 0.273 Vali Loss: 0.265 Vali Acc: 0.955 Test Loss: 0.265 Test Acc: 0.955
Validation loss decreased (-0.947701 --> -0.954522).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.9014207
	speed: 0.5502s/iter; left time: 22212.3409s
	iters: 200, epoch: 3 | loss: 0.0128019
	speed: 0.3049s/iter; left time: 12279.4589s
	iters: 300, epoch: 3 | loss: 0.1813533
	speed: 0.2908s/iter; left time: 11680.9166s
	iters: 400, epoch: 3 | loss: 0.5706232
	speed: 0.2904s/iter; left time: 11639.5292s
Epoch: 3 cost time: 120.32194566726685
Epoch: 3, Steps: 413 | Train Loss: 0.352 Vali Loss: 0.397 Vali Acc: 0.950 Test Loss: 0.397 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0021326
	speed: 0.5949s/iter; left time: 23772.0293s
	iters: 200, epoch: 4 | loss: 0.6979572
	speed: 0.2868s/iter; left time: 11432.2508s
	iters: 300, epoch: 4 | loss: 0.0000000
	speed: 0.3026s/iter; left time: 12033.2933s
	iters: 400, epoch: 4 | loss: 0.2207059
	speed: 0.3000s/iter; left time: 11900.4528s
Epoch: 4 cost time: 122.39265751838684
Epoch: 4, Steps: 413 | Train Loss: 0.371 Vali Loss: 0.196 Vali Acc: 0.973 Test Loss: 0.196 Test Acc: 0.973
Validation loss decreased (-0.954522 --> -0.972713).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.9069780
	speed: 0.6186s/iter; left time: 24466.6739s
	iters: 200, epoch: 5 | loss: 0.0000129
	speed: 0.3002s/iter; left time: 11843.5937s
	iters: 300, epoch: 5 | loss: 0.0030801
	speed: 0.2972s/iter; left time: 11693.7569s
	iters: 400, epoch: 5 | loss: 0.0332333
	speed: 0.2764s/iter; left time: 10846.6445s
Epoch: 5 cost time: 122.40227365493774
Epoch: 5, Steps: 413 | Train Loss: 0.238 Vali Loss: 0.279 Vali Acc: 0.962 Test Loss: 0.279 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0150660
	speed: 0.5674s/iter; left time: 22205.4111s
	iters: 200, epoch: 6 | loss: 0.4527252
	speed: 0.2968s/iter; left time: 11587.6898s
	iters: 300, epoch: 6 | loss: 1.1645478
	speed: 0.2881s/iter; left time: 11219.2851s
	iters: 400, epoch: 6 | loss: 0.2189876
	speed: 0.2963s/iter; left time: 11507.5755s
Epoch: 6 cost time: 121.61507439613342
Epoch: 6, Steps: 413 | Train Loss: 0.293 Vali Loss: 0.698 Vali Acc: 0.940 Test Loss: 0.698 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.1623841
	speed: 0.5560s/iter; left time: 21530.0513s
	iters: 200, epoch: 7 | loss: 0.2653162
	speed: 0.2794s/iter; left time: 10791.6229s
	iters: 300, epoch: 7 | loss: 0.0398751
	speed: 0.2885s/iter; left time: 11114.1102s
	iters: 400, epoch: 7 | loss: 0.5756590
	speed: 0.2784s/iter; left time: 10697.9684s
Epoch: 7 cost time: 117.41079044342041
Epoch: 7, Steps: 413 | Train Loss: 0.284 Vali Loss: 0.362 Vali Acc: 0.964 Test Loss: 0.362 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.8726383
	speed: 0.5622s/iter; left time: 21539.5207s
	iters: 200, epoch: 8 | loss: 0.0000208
	speed: 0.3075s/iter; left time: 11748.2315s
	iters: 300, epoch: 8 | loss: 0.0000031
	speed: 0.2948s/iter; left time: 11233.3627s
	iters: 400, epoch: 8 | loss: 0.0854426
	speed: 0.3184s/iter; left time: 12100.7180s
Epoch: 8 cost time: 124.8403844833374
Epoch: 8, Steps: 413 | Train Loss: 0.259 Vali Loss: 0.268 Vali Acc: 0.970 Test Loss: 0.268 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.2961452
	speed: 0.6156s/iter; left time: 23330.4682s
	iters: 200, epoch: 9 | loss: 0.8719724
	speed: 0.2919s/iter; left time: 11033.9075s
	iters: 300, epoch: 9 | loss: 0.0000193
	speed: 0.2708s/iter; left time: 10209.1778s
	iters: 400, epoch: 9 | loss: 0.4039793
	speed: 0.2923s/iter; left time: 10990.1323s
Epoch: 9 cost time: 120.553884267807
Epoch: 9, Steps: 413 | Train Loss: 0.217 Vali Loss: 1.176 Vali Acc: 0.929 Test Loss: 1.176 Test Acc: 0.929
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0000870
	speed: 0.5729s/iter; left time: 21473.1105s
	iters: 200, epoch: 10 | loss: 0.6789798
	speed: 0.2745s/iter; left time: 10260.8188s
	iters: 300, epoch: 10 | loss: 0.0000004
	speed: 0.2729s/iter; left time: 10175.0228s
	iters: 400, epoch: 10 | loss: 0.0012852
	speed: 0.2715s/iter; left time: 10096.7710s
Epoch: 10 cost time: 114.8995954990387
Epoch: 10, Steps: 413 | Train Loss: 0.223 Vali Loss: 1.180 Vali Acc: 0.915 Test Loss: 1.180 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0022614
	speed: 0.5731s/iter; left time: 21247.1289s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.2955s/iter; left time: 10925.5949s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.2857s/iter; left time: 10534.8399s
	iters: 400, epoch: 11 | loss: 0.0002229
	speed: 0.2803s/iter; left time: 10305.7211s
Epoch: 11 cost time: 119.43089056015015
Epoch: 11, Steps: 413 | Train Loss: 0.228 Vali Loss: 0.443 Vali Acc: 0.962 Test Loss: 0.443 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.5851s/iter; left time: 21447.8413s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.2986s/iter; left time: 10917.4075s
	iters: 300, epoch: 12 | loss: 1.0776037
	speed: 0.2970s/iter; left time: 10827.9851s
	iters: 400, epoch: 12 | loss: 0.0000001
	speed: 0.2828s/iter; left time: 10281.6071s
Epoch: 12 cost time: 121.51925539970398
Epoch: 12, Steps: 413 | Train Loss: 0.138 Vali Loss: 0.443 Vali Acc: 0.958 Test Loss: 0.443 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0000010
	speed: 0.5665s/iter; left time: 20531.3819s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.2899s/iter; left time: 10476.9626s
	iters: 300, epoch: 13 | loss: 0.0000002
	speed: 0.2879s/iter; left time: 10377.8299s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.2972s/iter; left time: 10682.3798s
Epoch: 13 cost time: 119.71388578414917
Epoch: 13, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.451 Vali Acc: 0.961 Test Loss: 0.451 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000001
	speed: 0.5517s/iter; left time: 19770.2903s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.2944s/iter; left time: 10519.4136s
	iters: 300, epoch: 14 | loss: 0.4857421
	speed: 0.2957s/iter; left time: 10537.2283s
	iters: 400, epoch: 14 | loss: 0.0000020
	speed: 0.2927s/iter; left time: 10401.9362s
Epoch: 14 cost time: 120.46309781074524
Epoch: 14, Steps: 413 | Train Loss: 0.129 Vali Loss: 0.342 Vali Acc: 0.969 Test Loss: 0.342 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9727148703956344
model parameter : 10613770
model size : 60.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1121371
	speed: 0.3220s/iter; left time: 13268.3041s
	iters: 200, epoch: 1 | loss: 0.4015100
	speed: 0.3033s/iter; left time: 12464.2762s
	iters: 300, epoch: 1 | loss: 0.8169909
	speed: 0.3121s/iter; left time: 12796.6709s
	iters: 400, epoch: 1 | loss: 0.0001301
	speed: 0.3156s/iter; left time: 12908.2315s
Epoch: 1 cost time: 130.17905139923096
Epoch: 1, Steps: 413 | Train Loss: 0.525 Vali Loss: 0.250 Vali Acc: 0.948 Test Loss: 0.250 Test Acc: 0.948
Validation loss decreased (inf --> -0.947701).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0387603
	speed: 0.6183s/iter; left time: 25217.2089s
	iters: 200, epoch: 2 | loss: 0.3202845
	speed: 0.3202s/iter; left time: 13027.1772s
	iters: 300, epoch: 2 | loss: 0.4920239
	speed: 0.3149s/iter; left time: 12780.0385s
	iters: 400, epoch: 2 | loss: 0.0012538
	speed: 0.3203s/iter; left time: 12969.7457s
Epoch: 2 cost time: 131.92543148994446
Epoch: 2, Steps: 413 | Train Loss: 0.316 Vali Loss: 0.214 Vali Acc: 0.964 Test Loss: 0.214 Test Acc: 0.964
Validation loss decreased (-0.947701 --> -0.963618).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4419788
	speed: 0.6342s/iter; left time: 25605.5040s
	iters: 200, epoch: 3 | loss: 0.0011983
	speed: 0.2890s/iter; left time: 11639.6794s
	iters: 300, epoch: 3 | loss: 0.0253619
	speed: 0.2934s/iter; left time: 11786.7712s
	iters: 400, epoch: 3 | loss: 0.1658408
	speed: 0.3057s/iter; left time: 12251.7783s
Epoch: 3 cost time: 124.75099539756775
Epoch: 3, Steps: 413 | Train Loss: 0.281 Vali Loss: 0.369 Vali Acc: 0.950 Test Loss: 0.369 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.3793671
	speed: 0.6004s/iter; left time: 23991.5688s
	iters: 200, epoch: 4 | loss: 0.0082100
	speed: 0.2940s/iter; left time: 11719.6076s
	iters: 300, epoch: 4 | loss: 0.0004142
	speed: 0.2815s/iter; left time: 11194.0019s
	iters: 400, epoch: 4 | loss: 0.1552875
	speed: 0.2946s/iter; left time: 11683.1844s
Epoch: 4 cost time: 122.37104082107544
Epoch: 4, Steps: 413 | Train Loss: 0.296 Vali Loss: 0.778 Vali Acc: 0.923 Test Loss: 0.778 Test Acc: 0.923
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000538
	speed: 0.6055s/iter; left time: 23946.8985s
	iters: 200, epoch: 5 | loss: 1.9255750
	speed: 0.3146s/iter; left time: 12412.5815s
	iters: 300, epoch: 5 | loss: 0.3959094
	speed: 0.2947s/iter; left time: 11596.7026s
	iters: 400, epoch: 5 | loss: 0.0113342
	speed: 0.3022s/iter; left time: 11859.7522s
Epoch: 5 cost time: 126.16384267807007
Epoch: 5, Steps: 413 | Train Loss: 0.275 Vali Loss: 0.953 Vali Acc: 0.911 Test Loss: 0.953 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0000002
	speed: 0.5840s/iter; left time: 22856.7807s
	iters: 200, epoch: 6 | loss: 0.0982893
	speed: 0.3068s/iter; left time: 11978.1708s
	iters: 300, epoch: 6 | loss: 0.1213899
	speed: 0.3062s/iter; left time: 11920.7350s
	iters: 400, epoch: 6 | loss: 0.0020280
	speed: 0.2963s/iter; left time: 11507.2347s
Epoch: 6 cost time: 125.27779746055603
Epoch: 6, Steps: 413 | Train Loss: 0.255 Vali Loss: 0.382 Vali Acc: 0.960 Test Loss: 0.382 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0141494
	speed: 0.5884s/iter; left time: 22782.9419s
	iters: 200, epoch: 7 | loss: 0.0008327
	speed: 0.3109s/iter; left time: 12008.8262s
	iters: 300, epoch: 7 | loss: 0.0000034
	speed: 0.3195s/iter; left time: 12307.3725s
	iters: 400, epoch: 7 | loss: 1.0929242
	speed: 0.2980s/iter; left time: 11448.9359s
Epoch: 7 cost time: 127.22182607650757
Epoch: 7, Steps: 413 | Train Loss: 0.275 Vali Loss: 0.522 Vali Acc: 0.953 Test Loss: 0.522 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0000001
	speed: 0.5940s/iter; left time: 22754.4735s
	iters: 200, epoch: 8 | loss: 0.0024017
	speed: 0.3247s/iter; left time: 12405.5492s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.2999s/iter; left time: 11428.8298s
	iters: 400, epoch: 8 | loss: 0.0000001
	speed: 0.3026s/iter; left time: 11501.3646s
Epoch: 8 cost time: 128.10230231285095
Epoch: 8, Steps: 413 | Train Loss: 0.257 Vali Loss: 0.320 Vali Acc: 0.966 Test Loss: 0.320 Test Acc: 0.966
Validation loss decreased (-0.963618 --> -0.965890).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.5926s/iter; left time: 22457.7089s
	iters: 200, epoch: 9 | loss: 0.0000001
	speed: 0.3064s/iter; left time: 11581.8634s
	iters: 300, epoch: 9 | loss: 0.0305611
	speed: 0.3119s/iter; left time: 11758.3761s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.3125s/iter; left time: 11748.1494s
Epoch: 9 cost time: 127.22819113731384
Epoch: 9, Steps: 413 | Train Loss: 0.140 Vali Loss: 0.690 Vali Acc: 0.958 Test Loss: 0.690 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000018
	speed: 0.6032s/iter; left time: 22609.7458s
	iters: 200, epoch: 10 | loss: 0.0000022
	speed: 0.3013s/iter; left time: 11263.0311s
	iters: 300, epoch: 10 | loss: 0.0007374
	speed: 0.3113s/iter; left time: 11606.1128s
	iters: 400, epoch: 10 | loss: 0.0000007
	speed: 0.3311s/iter; left time: 12311.4691s
Epoch: 10 cost time: 130.21208548545837
Epoch: 10, Steps: 413 | Train Loss: 0.178 Vali Loss: 0.475 Vali Acc: 0.951 Test Loss: 0.475 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0001294
	speed: 0.5968s/iter; left time: 22123.6133s
	iters: 200, epoch: 11 | loss: 0.5751154
	speed: 0.2965s/iter; left time: 10962.6420s
	iters: 300, epoch: 11 | loss: 0.0000001
	speed: 0.2978s/iter; left time: 10979.3867s
	iters: 400, epoch: 11 | loss: 0.0000767
	speed: 0.3098s/iter; left time: 11391.6530s
Epoch: 11 cost time: 124.7822208404541
Epoch: 11, Steps: 413 | Train Loss: 0.215 Vali Loss: 0.686 Vali Acc: 0.944 Test Loss: 0.686 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000002
	speed: 0.5909s/iter; left time: 21660.2933s
	iters: 200, epoch: 12 | loss: 0.0000137
	speed: 0.2877s/iter; left time: 10518.1842s
	iters: 300, epoch: 12 | loss: 0.0000423
	speed: 0.2943s/iter; left time: 10728.2855s
	iters: 400, epoch: 12 | loss: 0.0000083
	speed: 0.2781s/iter; left time: 10109.5969s
Epoch: 12 cost time: 119.82980990409851
Epoch: 12, Steps: 413 | Train Loss: 0.156 Vali Loss: 0.328 Vali Acc: 0.964 Test Loss: 0.328 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.2052616
	speed: 0.5973s/iter; left time: 21650.6039s
	iters: 200, epoch: 13 | loss: 0.0136340
	speed: 0.2990s/iter; left time: 10805.6456s
	iters: 300, epoch: 13 | loss: 0.5897689
	speed: 0.2945s/iter; left time: 10616.1147s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.2912s/iter; left time: 10467.2336s
Epoch: 13 cost time: 123.11511945724487
Epoch: 13, Steps: 413 | Train Loss: 0.103 Vali Loss: 0.177 Vali Acc: 0.975 Test Loss: 0.177 Test Acc: 0.975
Validation loss decreased (-0.965890 --> -0.975442).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.2482477
	speed: 0.5984s/iter; left time: 21442.0872s
	iters: 200, epoch: 14 | loss: 0.0000508
	speed: 0.3028s/iter; left time: 10820.8007s
	iters: 300, epoch: 14 | loss: 0.0000001
	speed: 0.2877s/iter; left time: 10252.3383s
	iters: 400, epoch: 14 | loss: 0.2832573
	speed: 0.2893s/iter; left time: 10279.3448s
Epoch: 14 cost time: 121.7563087940216
Epoch: 14, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.388 Vali Acc: 0.967 Test Loss: 0.388 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.6300021
	speed: 0.5774s/iter; left time: 20449.3709s
	iters: 200, epoch: 15 | loss: 0.0000003
	speed: 0.2890s/iter; left time: 10208.0466s
	iters: 300, epoch: 15 | loss: 0.0001385
	speed: 0.2956s/iter; left time: 10411.2783s
	iters: 400, epoch: 15 | loss: 0.3004051
	speed: 0.2886s/iter; left time: 10135.3119s
Epoch: 15 cost time: 121.35449647903442
Epoch: 15, Steps: 413 | Train Loss: 0.110 Vali Loss: 0.248 Vali Acc: 0.974 Test Loss: 0.248 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.5784s/iter; left time: 20247.4054s
	iters: 200, epoch: 16 | loss: 0.5234085
	speed: 0.2990s/iter; left time: 10436.9163s
	iters: 300, epoch: 16 | loss: 0.0504532
	speed: 0.3131s/iter; left time: 10896.8371s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.3096s/iter; left time: 10744.1671s
Epoch: 16 cost time: 126.65493631362915
Epoch: 16, Steps: 413 | Train Loss: 0.131 Vali Loss: 0.211 Vali Acc: 0.980 Test Loss: 0.211 Test Acc: 0.980
Validation loss decreased (-0.975442 --> -0.979534).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.4448965
	speed: 0.6036s/iter; left time: 20880.1211s
	iters: 200, epoch: 17 | loss: 0.6016055
	speed: 0.2983s/iter; left time: 10290.1680s
	iters: 300, epoch: 17 | loss: 0.0000016
	speed: 0.3020s/iter; left time: 10385.3716s
	iters: 400, epoch: 17 | loss: 0.0000010
	speed: 0.3079s/iter; left time: 10558.9680s
Epoch: 17 cost time: 124.90823078155518
Epoch: 17, Steps: 413 | Train Loss: 0.139 Vali Loss: 0.378 Vali Acc: 0.954 Test Loss: 0.378 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.5857s/iter; left time: 20019.1173s
	iters: 200, epoch: 18 | loss: 0.0000173
	speed: 0.2853s/iter; left time: 9722.9406s
	iters: 300, epoch: 18 | loss: 0.0000201
	speed: 0.2992s/iter; left time: 10166.4645s
	iters: 400, epoch: 18 | loss: 0.0015162
	speed: 0.3191s/iter; left time: 10812.4584s
Epoch: 18 cost time: 124.94587826728821
Epoch: 18, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.249 Vali Acc: 0.968 Test Loss: 0.249 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.4788127
	speed: 0.6222s/iter; left time: 21008.9761s
	iters: 200, epoch: 19 | loss: 0.0993780
	speed: 0.2959s/iter; left time: 9961.6866s
	iters: 300, epoch: 19 | loss: 0.0000003
	speed: 0.2999s/iter; left time: 10065.3241s
	iters: 400, epoch: 19 | loss: 0.0000184
	speed: 0.2925s/iter; left time: 9788.5433s
Epoch: 19 cost time: 125.53365516662598
Epoch: 19, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.150 Vali Acc: 0.978 Test Loss: 0.150 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000078
	speed: 0.6047s/iter; left time: 20168.5679s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.2979s/iter; left time: 9906.4738s
	iters: 300, epoch: 20 | loss: 0.0001115
	speed: 0.2924s/iter; left time: 9694.0759s
	iters: 400, epoch: 20 | loss: 0.0019528
	speed: 0.2955s/iter; left time: 9767.5744s
Epoch: 20 cost time: 123.28757667541504
Epoch: 20, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.407 Vali Acc: 0.955 Test Loss: 0.407 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.5953s/iter; left time: 19609.0990s
	iters: 200, epoch: 21 | loss: 0.0006154
	speed: 0.3038s/iter; left time: 9976.2131s
	iters: 300, epoch: 21 | loss: 0.0026855
	speed: 0.2965s/iter; left time: 9707.5358s
	iters: 400, epoch: 21 | loss: 0.0000001
	speed: 0.2986s/iter; left time: 9747.1227s
Epoch: 21 cost time: 124.04737377166748
Epoch: 21, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.310 Vali Acc: 0.969 Test Loss: 0.310 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0000267
	speed: 0.5922s/iter; left time: 19262.2293s
	iters: 200, epoch: 22 | loss: 0.0000499
	speed: 0.3096s/iter; left time: 10041.2767s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.2989s/iter; left time: 9661.3179s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.2972s/iter; left time: 9577.2951s
Epoch: 22 cost time: 124.90357494354248
Epoch: 22, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.208 Vali Acc: 0.970 Test Loss: 0.208 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0049697
	speed: 0.5891s/iter; left time: 18917.7616s
	iters: 200, epoch: 23 | loss: 0.9703844
	speed: 0.2960s/iter; left time: 9477.7187s
	iters: 300, epoch: 23 | loss: 0.1731684
	speed: 0.3024s/iter; left time: 9651.0986s
	iters: 400, epoch: 23 | loss: 0.0000142
	speed: 0.3057s/iter; left time: 9726.0967s
Epoch: 23 cost time: 124.59620594978333
Epoch: 23, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.425 Vali Acc: 0.963 Test Loss: 0.425 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0000130
	speed: 0.6039s/iter; left time: 19144.6663s
	iters: 200, epoch: 24 | loss: 0.0062838
	speed: 0.3053s/iter; left time: 9647.7130s
	iters: 300, epoch: 24 | loss: 0.0000022
	speed: 0.3034s/iter; left time: 9558.6846s
	iters: 400, epoch: 24 | loss: 0.0000504
	speed: 0.3071s/iter; left time: 9643.2407s
Epoch: 24 cost time: 126.32623434066772
Epoch: 24, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.249 Vali Acc: 0.966 Test Loss: 0.249 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0124656
	speed: 0.5811s/iter; left time: 18182.8288s
	iters: 200, epoch: 25 | loss: 0.0096584
	speed: 0.2930s/iter; left time: 9139.5804s
	iters: 300, epoch: 25 | loss: 0.0000282
	speed: 0.2916s/iter; left time: 9067.0414s
	iters: 400, epoch: 25 | loss: 0.0002836
	speed: 0.3061s/iter; left time: 9484.9849s
Epoch: 25 cost time: 123.25132751464844
Epoch: 25, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.271 Vali Acc: 0.968 Test Loss: 0.271 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.5719s/iter; left time: 17656.5865s
	iters: 200, epoch: 26 | loss: 0.0018179
	speed: 0.2892s/iter; left time: 8899.0546s
	iters: 300, epoch: 26 | loss: 0.0000107
	speed: 0.2955s/iter; left time: 9063.9612s
	iters: 400, epoch: 26 | loss: 0.0006034
	speed: 0.2921s/iter; left time: 8930.3896s
Epoch: 26 cost time: 120.7954318523407
Epoch: 26, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.294 Vali Acc: 0.962 Test Loss: 0.294 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9795361527967258
model parameter : 10613770
model size : 60.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.3013937
	speed: 0.3249s/iter; left time: 13387.0005s
	iters: 200, epoch: 1 | loss: 2.3025720
	speed: 0.2989s/iter; left time: 12283.3668s
	iters: 300, epoch: 1 | loss: 2.3025885
	speed: 0.3004s/iter; left time: 12318.5789s
	iters: 400, epoch: 1 | loss: 2.3014791
	speed: 0.3013s/iter; left time: 12321.6547s
Epoch: 1 cost time: 126.63132333755493
Epoch: 1, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (inf --> -0.100022).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3014715
	speed: 0.5993s/iter; left time: 24444.1025s
	iters: 200, epoch: 2 | loss: 2.3018909
	speed: 0.3094s/iter; left time: 12588.1988s
	iters: 300, epoch: 2 | loss: 2.3012221
	speed: 0.3103s/iter; left time: 12592.8283s
	iters: 400, epoch: 2 | loss: 2.3042955
	speed: 0.3067s/iter; left time: 12418.8674s
Epoch: 2 cost time: 127.04017782211304
Epoch: 2, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.3035586
	speed: 0.6064s/iter; left time: 24484.3284s
	iters: 200, epoch: 3 | loss: 2.3023601
	speed: 0.2940s/iter; left time: 11840.9981s
	iters: 300, epoch: 3 | loss: 2.3044369
	speed: 0.2919s/iter; left time: 11725.7075s
	iters: 400, epoch: 3 | loss: 2.3021240
	speed: 0.3054s/iter; left time: 12239.4009s
Epoch: 3 cost time: 123.73318862915039
Epoch: 3, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2999530
	speed: 0.5909s/iter; left time: 23614.6673s
	iters: 200, epoch: 4 | loss: 2.3021505
	speed: 0.2918s/iter; left time: 11630.9749s
	iters: 300, epoch: 4 | loss: 2.3030901
	speed: 0.2917s/iter; left time: 11599.0940s
	iters: 400, epoch: 4 | loss: 2.3035643
	speed: 0.2967s/iter; left time: 11766.4296s
Epoch: 4 cost time: 121.33631134033203
Epoch: 4, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.3035655
	speed: 0.6002s/iter; left time: 23735.7402s
	iters: 200, epoch: 5 | loss: 2.3013484
	speed: 0.2872s/iter; left time: 11330.0295s
	iters: 300, epoch: 5 | loss: 2.3026419
	speed: 0.2996s/iter; left time: 11788.2275s
	iters: 400, epoch: 5 | loss: 2.3042309
	speed: 0.2933s/iter; left time: 11511.2736s
Epoch: 5 cost time: 123.36825275421143
Epoch: 5, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.3044291
	speed: 0.6001s/iter; left time: 23484.1213s
	iters: 200, epoch: 6 | loss: 2.3035467
	speed: 0.2894s/iter; left time: 11297.6353s
	iters: 300, epoch: 6 | loss: 2.3065772
	speed: 0.2969s/iter; left time: 11561.4966s
	iters: 400, epoch: 6 | loss: 2.3026214
	speed: 0.2918s/iter; left time: 11334.0380s
Epoch: 6 cost time: 121.88170719146729
Epoch: 6, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 2.3021004
	speed: 0.5696s/iter; left time: 22056.2335s
	iters: 200, epoch: 7 | loss: 2.3043091
	speed: 0.2884s/iter; left time: 11137.3613s
	iters: 300, epoch: 7 | loss: 2.3025601
	speed: 0.2944s/iter; left time: 11341.5525s
	iters: 400, epoch: 7 | loss: 2.3039606
	speed: 0.2877s/iter; left time: 11055.2182s
Epoch: 7 cost time: 119.91830134391785
Epoch: 7, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 2.3050566
	speed: 0.5817s/iter; left time: 22283.9147s
	iters: 200, epoch: 8 | loss: 2.3027742
	speed: 0.2966s/iter; left time: 11332.1632s
	iters: 300, epoch: 8 | loss: 2.3066256
	speed: 0.2892s/iter; left time: 11022.6428s
	iters: 400, epoch: 8 | loss: 2.3031700
	speed: 0.2968s/iter; left time: 11281.2288s
Epoch: 8 cost time: 121.30484652519226
Epoch: 8, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 2.2995446
	speed: 0.5725s/iter; left time: 21697.6652s
	iters: 200, epoch: 9 | loss: 2.3026669
	speed: 0.2934s/iter; left time: 11091.1283s
	iters: 300, epoch: 9 | loss: 2.3026762
	speed: 0.2997s/iter; left time: 11298.5190s
	iters: 400, epoch: 9 | loss: 2.3027439
	speed: 0.3066s/iter; left time: 11526.0229s
Epoch: 9 cost time: 123.36515712738037
Epoch: 9, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.3010483
	speed: 0.6067s/iter; left time: 22740.5323s
	iters: 200, epoch: 10 | loss: 2.3029790
	speed: 0.3097s/iter; left time: 11578.5936s
	iters: 300, epoch: 10 | loss: 2.3027005
	speed: 0.3104s/iter; left time: 11572.5994s
	iters: 400, epoch: 10 | loss: 2.3045132
	speed: 0.3226s/iter; left time: 11994.9185s
Epoch: 10 cost time: 129.5925521850586
Epoch: 10, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.3013022
	speed: 0.6368s/iter; left time: 23607.5493s
	iters: 200, epoch: 11 | loss: 2.3035889
	speed: 0.3081s/iter; left time: 11390.7068s
	iters: 300, epoch: 11 | loss: 2.3023305
	speed: 0.3062s/iter; left time: 11289.6959s
	iters: 400, epoch: 11 | loss: 2.3044834
	speed: 0.3049s/iter; left time: 11212.7313s
Epoch: 11 cost time: 128.23395919799805
Epoch: 11, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 2.3049381
	speed: 0.5811s/iter; left time: 21302.2808s
	iters: 200, epoch: 12 | loss: 2.3016515
	speed: 0.2973s/iter; left time: 10867.4056s
	iters: 300, epoch: 12 | loss: 2.3076775
	speed: 0.2900s/iter; left time: 10574.5053s
	iters: 400, epoch: 12 | loss: 2.3025784
	speed: 0.2930s/iter; left time: 10654.4351s
Epoch: 12 cost time: 121.6079511642456
Epoch: 12, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 2.2938583
	speed: 0.5716s/iter; left time: 20718.3575s
	iters: 200, epoch: 13 | loss: 2.3049989
	speed: 0.3073s/iter; left time: 11107.8432s
	iters: 300, epoch: 13 | loss: 2.3038390
	speed: 0.3042s/iter; left time: 10963.4206s
	iters: 400, epoch: 13 | loss: 2.3056226
	speed: 0.3136s/iter; left time: 11273.5618s
Epoch: 13 cost time: 125.68883061408997
Epoch: 13, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 2.3018243
	speed: 0.5936s/iter; left time: 21270.1994s
	iters: 200, epoch: 14 | loss: 2.2989800
	speed: 0.2975s/iter; left time: 10631.5446s
	iters: 300, epoch: 14 | loss: 2.3020086
	speed: 0.3041s/iter; left time: 10835.6804s
	iters: 400, epoch: 14 | loss: 2.3031390
	speed: 0.3025s/iter; left time: 10748.6444s
Epoch: 14 cost time: 124.53650450706482
Epoch: 14, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 2.3038239
	speed: 0.5766s/iter; left time: 20422.0266s
	iters: 200, epoch: 15 | loss: 2.3038132
	speed: 0.3018s/iter; left time: 10659.2695s
	iters: 300, epoch: 15 | loss: 2.3007636
	speed: 0.3135s/iter; left time: 11039.8649s
	iters: 400, epoch: 15 | loss: 2.3024116
	speed: 0.3163s/iter; left time: 11107.3429s
Epoch: 15 cost time: 127.0009195804596
Epoch: 15, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 2.3048525
	speed: 0.6054s/iter; left time: 21192.8465s
	iters: 200, epoch: 16 | loss: 2.3039212
	speed: 0.3201s/iter; left time: 11174.1946s
	iters: 300, epoch: 16 | loss: 2.3048122
	speed: 0.3156s/iter; left time: 10985.4623s
	iters: 400, epoch: 16 | loss: 2.3041861
	speed: 0.3059s/iter; left time: 10616.0866s
Epoch: 16 cost time: 128.92293763160706
Epoch: 16, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 2.3052328
	speed: 0.5670s/iter; left time: 19615.4866s
	iters: 200, epoch: 17 | loss: 2.3011270
	speed: 0.2957s/iter; left time: 10199.6730s
	iters: 300, epoch: 17 | loss: 2.3037276
	speed: 0.3046s/iter; left time: 10477.2373s
	iters: 400, epoch: 17 | loss: 2.3027637
	speed: 0.2988s/iter; left time: 10245.6129s
Epoch: 17 cost time: 123.4618866443634
Epoch: 17, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 2.3013771
	speed: 0.6028s/iter; left time: 20602.7633s
	iters: 200, epoch: 18 | loss: 2.3035190
	speed: 0.3297s/iter; left time: 11235.7519s
	iters: 300, epoch: 18 | loss: 2.2997074
	speed: 0.3258s/iter; left time: 11071.5056s
	iters: 400, epoch: 18 | loss: 2.3020771
	speed: 0.3054s/iter; left time: 10348.4325s
Epoch: 18 cost time: 131.36987328529358
Epoch: 18, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 2.3027165
	speed: 0.5966s/iter; left time: 20146.2340s
	iters: 200, epoch: 19 | loss: 2.3013146
	speed: 0.2922s/iter; left time: 9836.6475s
	iters: 300, epoch: 19 | loss: 2.3048046
	speed: 0.2942s/iter; left time: 9873.8265s
	iters: 400, epoch: 19 | loss: 2.3035867
	speed: 0.3017s/iter; left time: 10097.7773s
Epoch: 19 cost time: 122.99026107788086
Epoch: 19, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.10004547521600728
model parameter : 10613770
model size : 60.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         47                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df128_ma47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5781476
	speed: 0.3261s/iter; left time: 13434.1803s
	iters: 200, epoch: 1 | loss: 0.0178169
	speed: 0.3182s/iter; left time: 13076.3416s
	iters: 300, epoch: 1 | loss: 0.2705701
	speed: 0.3160s/iter; left time: 12956.9156s
	iters: 400, epoch: 1 | loss: 0.0388273
	speed: 0.3206s/iter; left time: 13112.1161s
Epoch: 1 cost time: 132.36956477165222
Epoch: 1, Steps: 413 | Train Loss: 0.335 Vali Loss: 0.125 Vali Acc: 0.964 Test Loss: 0.125 Test Acc: 0.964
Validation loss decreased (inf --> -0.963619).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1776564
	speed: 0.6211s/iter; left time: 25335.4584s
	iters: 200, epoch: 2 | loss: 0.0035415
	speed: 0.3139s/iter; left time: 12772.8788s
	iters: 300, epoch: 2 | loss: 0.3594436
	speed: 0.3217s/iter; left time: 13058.7471s
	iters: 400, epoch: 2 | loss: 0.0083610
	speed: 0.3018s/iter; left time: 12217.3106s
Epoch: 2 cost time: 129.90183901786804
Epoch: 2, Steps: 413 | Train Loss: 0.141 Vali Loss: 0.329 Vali Acc: 0.938 Test Loss: 0.329 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.4797241
	speed: 0.6080s/iter; left time: 24549.0535s
	iters: 200, epoch: 3 | loss: 0.0129722
	speed: 0.3071s/iter; left time: 12368.9423s
	iters: 300, epoch: 3 | loss: 0.0121125
	speed: 0.2933s/iter; left time: 11784.3082s
	iters: 400, epoch: 3 | loss: 0.0704375
	speed: 0.2915s/iter; left time: 11683.5655s
Epoch: 3 cost time: 124.1433961391449
Epoch: 3, Steps: 413 | Train Loss: 0.246 Vali Loss: 0.483 Vali Acc: 0.931 Test Loss: 0.483 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.1860797
	speed: 0.6148s/iter; left time: 24568.5091s
	iters: 200, epoch: 4 | loss: 1.3336531
	speed: 0.3178s/iter; left time: 12668.6927s
	iters: 300, epoch: 4 | loss: 0.0096170
	speed: 0.3111s/iter; left time: 12371.3591s
	iters: 400, epoch: 4 | loss: 0.0079040
	speed: 0.2903s/iter; left time: 11514.1774s
Epoch: 4 cost time: 127.72370600700378
Epoch: 4, Steps: 413 | Train Loss: 0.303 Vali Loss: 0.344 Vali Acc: 0.958 Test Loss: 0.344 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.1009418
	speed: 0.6615s/iter; left time: 26161.2964s
	iters: 200, epoch: 5 | loss: 0.2659399
	speed: 0.3019s/iter; left time: 11909.6887s
	iters: 300, epoch: 5 | loss: 0.2746225
	speed: 0.2919s/iter; left time: 11484.6483s
	iters: 400, epoch: 5 | loss: 0.0000000
	speed: 0.2896s/iter; left time: 11366.5462s
Epoch: 5 cost time: 125.53582453727722
Epoch: 5, Steps: 413 | Train Loss: 0.308 Vali Loss: 0.359 Vali Acc: 0.962 Test Loss: 0.359 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0000002
	speed: 0.6095s/iter; left time: 23853.0791s
	iters: 200, epoch: 6 | loss: 0.0017516
	speed: 0.3074s/iter; left time: 11997.9174s
	iters: 300, epoch: 6 | loss: 0.0000000
	speed: 0.3084s/iter; left time: 12007.4094s
	iters: 400, epoch: 6 | loss: 0.0000002
	speed: 0.2917s/iter; left time: 11327.2702s
Epoch: 6 cost time: 125.64360046386719
Epoch: 6, Steps: 413 | Train Loss: 0.263 Vali Loss: 0.347 Vali Acc: 0.964 Test Loss: 0.347 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.5354229
	speed: 0.6144s/iter; left time: 23792.3567s
	iters: 200, epoch: 7 | loss: 0.0658668
	speed: 0.2998s/iter; left time: 11578.4677s
	iters: 300, epoch: 7 | loss: 0.8479971
	speed: 0.2943s/iter; left time: 11336.4955s
	iters: 400, epoch: 7 | loss: 0.9523672
	speed: 0.2931s/iter; left time: 11260.3553s
Epoch: 7 cost time: 123.9748125076294
Epoch: 7, Steps: 413 | Train Loss: 0.353 Vali Loss: 0.358 Vali Acc: 0.967 Test Loss: 0.358 Test Acc: 0.967
Validation loss decreased (-0.963619 --> -0.967254).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1130254
	speed: 0.5994s/iter; left time: 22962.6401s
	iters: 200, epoch: 8 | loss: 1.1392820
	speed: 0.2694s/iter; left time: 10292.6980s
	iters: 300, epoch: 8 | loss: 0.3556154
	speed: 0.2779s/iter; left time: 10591.0401s
	iters: 400, epoch: 8 | loss: 5.4701233
	speed: 0.2734s/iter; left time: 10393.4281s
Epoch: 8 cost time: 115.83573126792908
Epoch: 8, Steps: 413 | Train Loss: 0.343 Vali Loss: 0.566 Vali Acc: 0.958 Test Loss: 0.566 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.6026s/iter; left time: 22837.8905s
	iters: 200, epoch: 9 | loss: 0.1519553
	speed: 0.2770s/iter; left time: 10471.3106s
	iters: 300, epoch: 9 | loss: 0.0001765
	speed: 0.2820s/iter; left time: 10629.4696s
	iters: 400, epoch: 9 | loss: 1.1793813
	speed: 0.2871s/iter; left time: 10793.4522s
Epoch: 9 cost time: 119.17437529563904
Epoch: 9, Steps: 413 | Train Loss: 0.342 Vali Loss: 0.498 Vali Acc: 0.955 Test Loss: 0.498 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.5939s/iter; left time: 22260.9693s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.2814s/iter; left time: 10518.1866s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.2809s/iter; left time: 10474.4750s
	iters: 400, epoch: 10 | loss: 0.0000125
	speed: 0.2817s/iter; left time: 10474.6333s
Epoch: 10 cost time: 117.11357045173645
Epoch: 10, Steps: 413 | Train Loss: 0.271 Vali Loss: 0.435 Vali Acc: 0.961 Test Loss: 0.435 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.5807s/iter; left time: 21525.4468s
	iters: 200, epoch: 11 | loss: 0.0000047
	speed: 0.3020s/iter; left time: 11165.1436s
	iters: 300, epoch: 11 | loss: 0.0000009
	speed: 0.2797s/iter; left time: 10313.9893s
	iters: 400, epoch: 11 | loss: 0.0048906
	speed: 0.2849s/iter; left time: 10476.4157s
Epoch: 11 cost time: 121.02859210968018
Epoch: 11, Steps: 413 | Train Loss: 0.247 Vali Loss: 0.675 Vali Acc: 0.950 Test Loss: 0.675 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.6075s/iter; left time: 22270.7908s
	iters: 200, epoch: 12 | loss: 0.0002928
	speed: 0.2750s/iter; left time: 10054.8873s
	iters: 300, epoch: 12 | loss: 0.0000021
	speed: 0.2734s/iter; left time: 9968.2507s
	iters: 400, epoch: 12 | loss: 0.6425456
	speed: 0.2892s/iter; left time: 10513.7213s
Epoch: 12 cost time: 118.31910586357117
Epoch: 12, Steps: 413 | Train Loss: 0.289 Vali Loss: 0.383 Vali Acc: 0.969 Test Loss: 0.383 Test Acc: 0.969
Validation loss decreased (-0.967254 --> -0.968618).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0016920
	speed: 0.5786s/iter; left time: 20972.3089s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.2821s/iter; left time: 10195.8030s
	iters: 300, epoch: 13 | loss: 0.0000005
	speed: 0.2954s/iter; left time: 10646.8189s
	iters: 400, epoch: 13 | loss: 1.1523559
	speed: 0.2883s/iter; left time: 10361.3798s
Epoch: 13 cost time: 118.64117741584778
Epoch: 13, Steps: 413 | Train Loss: 0.176 Vali Loss: 0.303 Vali Acc: 0.974 Test Loss: 0.303 Test Acc: 0.974
Validation loss decreased (-0.968618 --> -0.973621).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.6494840
	speed: 0.5569s/iter; left time: 19954.8654s
	iters: 200, epoch: 14 | loss: 0.0000001
	speed: 0.2910s/iter; left time: 10396.9265s
	iters: 300, epoch: 14 | loss: 0.0000001
	speed: 0.2758s/iter; left time: 9826.3259s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.2770s/iter; left time: 9843.2711s
Epoch: 14 cost time: 116.52832198143005
Epoch: 14, Steps: 413 | Train Loss: 0.137 Vali Loss: 0.399 Vali Acc: 0.973 Test Loss: 0.399 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000373
	speed: 0.5740s/iter; left time: 20328.9095s
	iters: 200, epoch: 15 | loss: 0.1135037
	speed: 0.2840s/iter; left time: 10030.5125s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.2797s/iter; left time: 9852.3052s
	iters: 400, epoch: 15 | loss: 0.7449112
	speed: 0.2906s/iter; left time: 10206.0057s
Epoch: 15 cost time: 118.77183604240417
Epoch: 15, Steps: 413 | Train Loss: 0.156 Vali Loss: 0.205 Vali Acc: 0.981 Test Loss: 0.205 Test Acc: 0.981
Validation loss decreased (-0.973621 --> -0.981353).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.6022s/iter; left time: 21079.1560s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.2881s/iter; left time: 10057.3230s
	iters: 300, epoch: 16 | loss: 0.0000059
	speed: 0.2847s/iter; left time: 9909.2342s
	iters: 400, epoch: 16 | loss: 0.5877463
	speed: 0.2815s/iter; left time: 9769.5956s
Epoch: 16 cost time: 118.93844938278198
Epoch: 16, Steps: 413 | Train Loss: 0.174 Vali Loss: 0.621 Vali Acc: 0.955 Test Loss: 0.621 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.1888103
	speed: 0.5412s/iter; left time: 18723.3452s
	iters: 200, epoch: 17 | loss: 0.0008715
	speed: 0.2922s/iter; left time: 10078.0938s
	iters: 300, epoch: 17 | loss: 0.0002380
	speed: 0.2731s/iter; left time: 9393.2893s
	iters: 400, epoch: 17 | loss: 0.0000001
	speed: 0.2734s/iter; left time: 9374.1891s
Epoch: 17 cost time: 115.90715599060059
Epoch: 17, Steps: 413 | Train Loss: 0.112 Vali Loss: 0.583 Vali Acc: 0.966 Test Loss: 0.583 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.5685s/iter; left time: 19432.3826s
	iters: 200, epoch: 18 | loss: 0.0016281
	speed: 0.2723s/iter; left time: 9281.4614s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.2693s/iter; left time: 9150.8262s
	iters: 400, epoch: 18 | loss: 0.6687012
	speed: 0.2774s/iter; left time: 9399.3008s
Epoch: 18 cost time: 114.44593405723572
Epoch: 18, Steps: 413 | Train Loss: 0.130 Vali Loss: 0.316 Vali Acc: 0.979 Test Loss: 0.316 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.5461s/iter; left time: 18440.7197s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.2774s/iter; left time: 9339.9390s
	iters: 300, epoch: 19 | loss: 0.0000049
	speed: 0.2821s/iter; left time: 9469.2503s
	iters: 400, epoch: 19 | loss: 0.0000001
	speed: 0.2852s/iter; left time: 9544.0308s
Epoch: 19 cost time: 115.66019225120544
Epoch: 19, Steps: 413 | Train Loss: 0.173 Vali Loss: 0.554 Vali Acc: 0.967 Test Loss: 0.554 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.5525s/iter; left time: 18427.9452s
	iters: 200, epoch: 20 | loss: 0.0000003
	speed: 0.2797s/iter; left time: 9301.3228s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.2798s/iter; left time: 9275.6784s
	iters: 400, epoch: 20 | loss: 0.5310367
	speed: 0.2824s/iter; left time: 9332.8613s
Epoch: 20 cost time: 115.90753197669983
Epoch: 20, Steps: 413 | Train Loss: 0.150 Vali Loss: 0.956 Vali Acc: 0.955 Test Loss: 0.956 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0000083
	speed: 0.5593s/iter; left time: 18423.4356s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.2844s/iter; left time: 9340.8854s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.2622s/iter; left time: 8585.8869s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.2882s/iter; left time: 9406.9061s
Epoch: 21 cost time: 115.65008878707886
Epoch: 21, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.388 Vali Acc: 0.983 Test Loss: 0.388 Test Acc: 0.983
Validation loss decreased (-0.981353 --> -0.982716).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.5782s/iter; left time: 18809.0218s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.2828s/iter; left time: 9171.6363s
	iters: 300, epoch: 22 | loss: 0.0000014
	speed: 0.2903s/iter; left time: 9384.5216s
	iters: 400, epoch: 22 | loss: 0.0000003
	speed: 0.2844s/iter; left time: 9166.4923s
Epoch: 22 cost time: 118.07562398910522
Epoch: 22, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.231 Vali Acc: 0.982 Test Loss: 0.231 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.5395s/iter; left time: 17325.5290s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.2912s/iter; left time: 9322.7068s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.2733s/iter; left time: 8722.5920s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.2680s/iter; left time: 8524.9868s
Epoch: 23 cost time: 114.24480843544006
Epoch: 23, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.368 Vali Acc: 0.978 Test Loss: 0.368 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.5614s/iter; left time: 17797.1657s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.2711s/iter; left time: 8568.8323s
	iters: 300, epoch: 24 | loss: 0.9099534
	speed: 0.2704s/iter; left time: 8517.3905s
	iters: 400, epoch: 24 | loss: 0.0053684
	speed: 0.2854s/iter; left time: 8961.0114s
Epoch: 24 cost time: 115.45613288879395
Epoch: 24, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.600 Vali Acc: 0.960 Test Loss: 0.600 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0015864
	speed: 0.5698s/iter; left time: 17829.6345s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.2853s/iter; left time: 8897.6323s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.2812s/iter; left time: 8743.3638s
	iters: 400, epoch: 25 | loss: 0.0000314
	speed: 0.2802s/iter; left time: 8682.3552s
Epoch: 25 cost time: 117.45250201225281
Epoch: 25, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.243 Vali Acc: 0.979 Test Loss: 0.243 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.5520s/iter; left time: 17044.0347s
	iters: 200, epoch: 26 | loss: 0.0000423
	speed: 0.2881s/iter; left time: 8865.2409s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.2833s/iter; left time: 8691.9617s
	iters: 400, epoch: 26 | loss: 0.0000033
	speed: 0.2790s/iter; left time: 8531.6050s
Epoch: 26 cost time: 116.76954531669617
Epoch: 26, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.353 Vali Acc: 0.972 Test Loss: 0.353 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0003189
	speed: 0.5724s/iter; left time: 17437.4111s
	iters: 200, epoch: 27 | loss: 0.0000176
	speed: 0.2771s/iter; left time: 8413.2639s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.2814s/iter; left time: 8515.5516s
	iters: 400, epoch: 27 | loss: 0.0000823
	speed: 0.2847s/iter; left time: 8586.2577s
Epoch: 27 cost time: 117.07953691482544
Epoch: 27, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.391 Vali Acc: 0.973 Test Loss: 0.391 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.5742s/iter; left time: 17255.7603s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.2710s/iter; left time: 8116.5164s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.2855s/iter; left time: 8520.8576s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.2874s/iter; left time: 8551.1909s
Epoch: 28 cost time: 116.25439667701721
Epoch: 28, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.465 Vali Acc: 0.970 Test Loss: 0.465 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.5447s/iter; left time: 16144.6586s
	iters: 200, epoch: 29 | loss: 0.0000001
	speed: 0.2783s/iter; left time: 8219.7974s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.2821s/iter; left time: 8305.6184s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.2718s/iter; left time: 7974.6330s
Epoch: 29 cost time: 114.57238698005676
Epoch: 29, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.212 Vali Acc: 0.979 Test Loss: 0.212 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0000004
	speed: 0.5805s/iter; left time: 16963.3125s
	iters: 200, epoch: 30 | loss: 0.0331716
	speed: 0.2768s/iter; left time: 8062.2114s
	iters: 300, epoch: 30 | loss: 0.0000003
	speed: 0.2784s/iter; left time: 8079.2396s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.2769s/iter; left time: 8009.1491s
Epoch: 30 cost time: 117.3471212387085
Epoch: 30, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.266 Vali Acc: 0.979 Test Loss: 0.266 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0224267
	speed: 0.5594s/iter; left time: 16116.8508s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.2700s/iter; left time: 7752.7699s
	iters: 300, epoch: 31 | loss: 0.0000005
	speed: 0.2718s/iter; left time: 7777.0190s
	iters: 400, epoch: 31 | loss: 0.0000747
	speed: 0.2802s/iter; left time: 7988.6239s
Epoch: 31 cost time: 113.92097425460815
Epoch: 31, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.359 Vali Acc: 0.971 Test Loss: 0.359 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df128_ma47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9827194179172352
model parameter : 10220554
model size : 58.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         38                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df128_ma38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3295308
	speed: 0.3029s/iter; left time: 12478.9058s
	iters: 200, epoch: 1 | loss: 0.0170195
	speed: 0.2979s/iter; left time: 12242.7376s
	iters: 300, epoch: 1 | loss: 0.5261066
	speed: 0.2853s/iter; left time: 11696.8965s
	iters: 400, epoch: 1 | loss: 0.5238661
	speed: 0.2909s/iter; left time: 11897.4099s
Epoch: 1 cost time: 121.8648009300232
Epoch: 1, Steps: 413 | Train Loss: 0.360 Vali Loss: 0.158 Vali Acc: 0.963 Test Loss: 0.158 Test Acc: 0.963
Validation loss decreased (inf --> -0.962709).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0065758
	speed: 0.5920s/iter; left time: 24144.7701s
	iters: 200, epoch: 2 | loss: 0.0484383
	speed: 0.2830s/iter; left time: 11513.3780s
	iters: 300, epoch: 2 | loss: 0.2776648
	speed: 0.2893s/iter; left time: 11743.4782s
	iters: 400, epoch: 2 | loss: 0.0151906
	speed: 0.2806s/iter; left time: 11361.3886s
Epoch: 2 cost time: 119.62259888648987
Epoch: 2, Steps: 413 | Train Loss: 0.147 Vali Loss: 0.228 Vali Acc: 0.963 Test Loss: 0.228 Test Acc: 0.963
Validation loss decreased (-0.962709 --> -0.963163).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0018668
	speed: 0.5861s/iter; left time: 23663.0321s
	iters: 200, epoch: 3 | loss: 0.1448565
	speed: 0.2788s/iter; left time: 11230.5288s
	iters: 300, epoch: 3 | loss: 0.0725925
	speed: 0.2884s/iter; left time: 11586.9903s
	iters: 400, epoch: 3 | loss: 0.0768167
	speed: 0.2875s/iter; left time: 11520.7762s
Epoch: 3 cost time: 118.8542959690094
Epoch: 3, Steps: 413 | Train Loss: 0.212 Vali Loss: 0.234 Vali Acc: 0.967 Test Loss: 0.234 Test Acc: 0.967
Validation loss decreased (-0.963163 --> -0.966801).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0709814
	speed: 0.6160s/iter; left time: 24617.2960s
	iters: 200, epoch: 4 | loss: 0.0004343
	speed: 0.3182s/iter; left time: 12683.9319s
	iters: 300, epoch: 4 | loss: 0.0004331
	speed: 0.3241s/iter; left time: 12886.6275s
	iters: 400, epoch: 4 | loss: 0.1396359
	speed: 0.2998s/iter; left time: 11889.1280s
Epoch: 4 cost time: 129.77882432937622
Epoch: 4, Steps: 413 | Train Loss: 0.310 Vali Loss: 0.328 Vali Acc: 0.959 Test Loss: 0.328 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.8744045
	speed: 0.6008s/iter; left time: 23761.2318s
	iters: 200, epoch: 5 | loss: 0.0000038
	speed: 0.3007s/iter; left time: 11863.0021s
	iters: 300, epoch: 5 | loss: 0.0000581
	speed: 0.3017s/iter; left time: 11870.8726s
	iters: 400, epoch: 5 | loss: 1.1689889
	speed: 0.2991s/iter; left time: 11739.9422s
Epoch: 5 cost time: 125.8001959323883
Epoch: 5, Steps: 413 | Train Loss: 0.323 Vali Loss: 0.396 Vali Acc: 0.956 Test Loss: 0.396 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0006325
	speed: 0.6175s/iter; left time: 24165.5576s
	iters: 200, epoch: 6 | loss: 0.0176170
	speed: 0.3218s/iter; left time: 12562.6999s
	iters: 300, epoch: 6 | loss: 0.1004823
	speed: 0.3264s/iter; left time: 12710.5846s
	iters: 400, epoch: 6 | loss: 0.4445569
	speed: 0.3117s/iter; left time: 12103.3354s
Epoch: 6 cost time: 131.24077248573303
Epoch: 6, Steps: 413 | Train Loss: 0.347 Vali Loss: 0.513 Vali Acc: 0.943 Test Loss: 0.513 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.6012s/iter; left time: 23278.5545s
	iters: 200, epoch: 7 | loss: 0.5866759
	speed: 0.3171s/iter; left time: 12247.3246s
	iters: 300, epoch: 7 | loss: 5.0088091
	speed: 0.2994s/iter; left time: 11533.4888s
	iters: 400, epoch: 7 | loss: 0.1839725
	speed: 0.3028s/iter; left time: 11634.2667s
Epoch: 7 cost time: 125.43504309654236
Epoch: 7, Steps: 413 | Train Loss: 0.363 Vali Loss: 0.500 Vali Acc: 0.946 Test Loss: 0.500 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.5626s/iter; left time: 21552.6575s
	iters: 200, epoch: 8 | loss: 0.6924964
	speed: 0.2876s/iter; left time: 10990.5639s
	iters: 300, epoch: 8 | loss: 0.0000156
	speed: 0.2879s/iter; left time: 10972.4873s
	iters: 400, epoch: 8 | loss: 1.6085296
	speed: 0.2907s/iter; left time: 11047.9152s
Epoch: 8 cost time: 119.14341044425964
Epoch: 8, Steps: 413 | Train Loss: 0.309 Vali Loss: 0.413 Vali Acc: 0.963 Test Loss: 0.413 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000002
	speed: 0.5885s/iter; left time: 22302.3889s
	iters: 200, epoch: 9 | loss: 0.0000030
	speed: 0.3014s/iter; left time: 11393.8799s
	iters: 300, epoch: 9 | loss: 0.3945767
	speed: 0.2888s/iter; left time: 10887.6038s
	iters: 400, epoch: 9 | loss: 0.0002274
	speed: 0.2854s/iter; left time: 10728.4718s
Epoch: 9 cost time: 121.1212968826294
Epoch: 9, Steps: 413 | Train Loss: 0.298 Vali Loss: 0.423 Vali Acc: 0.968 Test Loss: 0.423 Test Acc: 0.968
Validation loss decreased (-0.966801 --> -0.967708).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000665
	speed: 0.5596s/iter; left time: 20974.7642s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.2918s/iter; left time: 10908.5611s
	iters: 300, epoch: 10 | loss: 0.0000095
	speed: 0.2775s/iter; left time: 10347.7792s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.2809s/iter; left time: 10446.0341s
Epoch: 10 cost time: 117.31876111030579
Epoch: 10, Steps: 413 | Train Loss: 0.297 Vali Loss: 0.645 Vali Acc: 0.954 Test Loss: 0.645 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000017
	speed: 0.5453s/iter; left time: 20216.6006s
	iters: 200, epoch: 11 | loss: 0.0585596
	speed: 0.2898s/iter; left time: 10712.5165s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.2854s/iter; left time: 10521.4972s
	iters: 400, epoch: 11 | loss: 0.1508748
	speed: 0.2767s/iter; left time: 10174.6451s
Epoch: 11 cost time: 116.22889161109924
Epoch: 11, Steps: 413 | Train Loss: 0.206 Vali Loss: 0.513 Vali Acc: 0.955 Test Loss: 0.513 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.5723s/iter; left time: 20980.1364s
	iters: 200, epoch: 12 | loss: 0.0037263
	speed: 0.2889s/iter; left time: 10563.1508s
	iters: 300, epoch: 12 | loss: 2.5648992
	speed: 0.2903s/iter; left time: 10583.1882s
	iters: 400, epoch: 12 | loss: 2.4613836
	speed: 0.2867s/iter; left time: 10422.9670s
Epoch: 12 cost time: 119.79724717140198
Epoch: 12, Steps: 413 | Train Loss: 0.184 Vali Loss: 0.308 Vali Acc: 0.970 Test Loss: 0.308 Test Acc: 0.970
Validation loss decreased (-0.967708 --> -0.970438).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.5800s/iter; left time: 21021.9006s
	iters: 200, epoch: 13 | loss: 1.2321641
	speed: 0.2808s/iter; left time: 10149.1166s
	iters: 300, epoch: 13 | loss: 0.0000407
	speed: 0.2826s/iter; left time: 10185.2780s
	iters: 400, epoch: 13 | loss: 0.0000006
	speed: 0.2809s/iter; left time: 10097.3071s
Epoch: 13 cost time: 116.46317434310913
Epoch: 13, Steps: 413 | Train Loss: 0.171 Vali Loss: 0.274 Vali Acc: 0.977 Test Loss: 0.274 Test Acc: 0.977
Validation loss decreased (-0.970438 --> -0.976805).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0168989
	speed: 0.5655s/iter; left time: 20263.4864s
	iters: 200, epoch: 14 | loss: 0.0154013
	speed: 0.2929s/iter; left time: 10464.8108s
	iters: 300, epoch: 14 | loss: 0.0000053
	speed: 0.2942s/iter; left time: 10483.1647s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.2908s/iter; left time: 10332.4683s
Epoch: 14 cost time: 120.03704166412354
Epoch: 14, Steps: 413 | Train Loss: 0.153 Vali Loss: 0.524 Vali Acc: 0.968 Test Loss: 0.524 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.5674s/iter; left time: 20095.5264s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.2954s/iter; left time: 10431.7598s
	iters: 300, epoch: 15 | loss: 0.2318285
	speed: 0.2948s/iter; left time: 10382.3704s
	iters: 400, epoch: 15 | loss: 0.0003683
	speed: 0.2736s/iter; left time: 9609.1424s
Epoch: 15 cost time: 119.45973777770996
Epoch: 15, Steps: 413 | Train Loss: 0.131 Vali Loss: 0.411 Vali Acc: 0.968 Test Loss: 0.411 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.4727477
	speed: 0.5581s/iter; left time: 19536.6495s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.2856s/iter; left time: 9969.2147s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.2973s/iter; left time: 10346.5766s
	iters: 400, epoch: 16 | loss: 0.0000001
	speed: 0.2730s/iter; left time: 9476.2174s
Epoch: 16 cost time: 118.0739734172821
Epoch: 16, Steps: 413 | Train Loss: 0.102 Vali Loss: 0.694 Vali Acc: 0.949 Test Loss: 0.694 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0008103
	speed: 0.5705s/iter; left time: 19734.3529s
	iters: 200, epoch: 17 | loss: 0.0914449
	speed: 0.2831s/iter; left time: 9765.2122s
	iters: 300, epoch: 17 | loss: 0.0000187
	speed: 0.2924s/iter; left time: 10058.2144s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.2880s/iter; left time: 9875.4057s
Epoch: 17 cost time: 120.01701092720032
Epoch: 17, Steps: 413 | Train Loss: 0.150 Vali Loss: 0.737 Vali Acc: 0.954 Test Loss: 0.737 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000593
	speed: 0.5580s/iter; left time: 19072.9108s
	iters: 200, epoch: 18 | loss: 0.0044252
	speed: 0.2789s/iter; left time: 9504.6395s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.2892s/iter; left time: 9826.4912s
	iters: 400, epoch: 18 | loss: 0.0000002
	speed: 0.2929s/iter; left time: 9924.7551s
Epoch: 18 cost time: 118.66466975212097
Epoch: 18, Steps: 413 | Train Loss: 0.111 Vali Loss: 0.576 Vali Acc: 0.970 Test Loss: 0.576 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.5910s/iter; left time: 19955.4123s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.2923s/iter; left time: 9840.3967s
	iters: 300, epoch: 19 | loss: 0.0000078
	speed: 0.2898s/iter; left time: 9726.5885s
	iters: 400, epoch: 19 | loss: 0.0002421
	speed: 0.2900s/iter; left time: 9706.6624s
Epoch: 19 cost time: 121.66724848747253
Epoch: 19, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.288 Vali Acc: 0.978 Test Loss: 0.288 Test Acc: 0.978
Validation loss decreased (-0.976805 --> -0.978169).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.5826s/iter; left time: 19430.6320s
	iters: 200, epoch: 20 | loss: 0.0000002
	speed: 0.2804s/iter; left time: 9325.1435s
	iters: 300, epoch: 20 | loss: 0.0529426
	speed: 0.2802s/iter; left time: 9291.0060s
	iters: 400, epoch: 20 | loss: 0.4344284
	speed: 0.2781s/iter; left time: 9191.2142s
Epoch: 20 cost time: 116.96911644935608
Epoch: 20, Steps: 413 | Train Loss: 0.153 Vali Loss: 0.587 Vali Acc: 0.952 Test Loss: 0.587 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000009
	speed: 0.5629s/iter; left time: 18543.5129s
	iters: 200, epoch: 21 | loss: 0.5278252
	speed: 0.2880s/iter; left time: 9456.9788s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.2794s/iter; left time: 9146.6265s
	iters: 400, epoch: 21 | loss: 0.0000003
	speed: 0.2766s/iter; left time: 9029.4819s
Epoch: 21 cost time: 117.82872080802917
Epoch: 21, Steps: 413 | Train Loss: 0.123 Vali Loss: 0.308 Vali Acc: 0.970 Test Loss: 0.308 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.5612s/iter; left time: 18253.3874s
	iters: 200, epoch: 22 | loss: 0.0000511
	speed: 0.2936s/iter; left time: 9519.9254s
	iters: 300, epoch: 22 | loss: 0.0001366
	speed: 0.2862s/iter; left time: 9252.9084s
	iters: 400, epoch: 22 | loss: 0.5082622
	speed: 0.2811s/iter; left time: 9058.1251s
Epoch: 22 cost time: 119.60574507713318
Epoch: 22, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.260 Vali Acc: 0.979 Test Loss: 0.260 Test Acc: 0.979
Validation loss decreased (-0.978169 --> -0.978624).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.5696s/iter; left time: 18291.5550s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.2948s/iter; left time: 9439.6012s
	iters: 300, epoch: 23 | loss: 0.0734518
	speed: 0.2953s/iter; left time: 9423.3910s
	iters: 400, epoch: 23 | loss: 0.0002438
	speed: 0.2949s/iter; left time: 9382.3699s
Epoch: 23 cost time: 121.59160995483398
Epoch: 23, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.216 Vali Acc: 0.979 Test Loss: 0.216 Test Acc: 0.979
Validation loss decreased (-0.978624 --> -0.979079).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.5691s/iter; left time: 18042.9834s
	iters: 200, epoch: 24 | loss: 0.0117818
	speed: 0.2915s/iter; left time: 9211.1886s
	iters: 300, epoch: 24 | loss: 0.0000057
	speed: 0.2955s/iter; left time: 9307.5341s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.2936s/iter; left time: 9218.3658s
Epoch: 24 cost time: 120.88823866844177
Epoch: 24, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.283 Vali Acc: 0.973 Test Loss: 0.283 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0009947
	speed: 0.5688s/iter; left time: 17795.7329s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.2862s/iter; left time: 8926.7352s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.2962s/iter; left time: 9208.9104s
	iters: 400, epoch: 25 | loss: 0.0297841
	speed: 0.2911s/iter; left time: 9020.2345s
Epoch: 25 cost time: 120.66337084770203
Epoch: 25, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.288 Vali Acc: 0.978 Test Loss: 0.288 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0000017
	speed: 0.5514s/iter; left time: 17024.1442s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.2751s/iter; left time: 8467.8241s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.2747s/iter; left time: 8427.7548s
	iters: 400, epoch: 26 | loss: 0.0000155
	speed: 0.2911s/iter; left time: 8900.8252s
Epoch: 26 cost time: 116.43269920349121
Epoch: 26, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.288 Vali Acc: 0.976 Test Loss: 0.288 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.5952s/iter; left time: 18131.4777s
	iters: 200, epoch: 27 | loss: 0.0000095
	speed: 0.2910s/iter; left time: 8834.6107s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.2923s/iter; left time: 8845.2631s
	iters: 400, epoch: 27 | loss: 0.0293724
	speed: 0.2908s/iter; left time: 8772.8555s
Epoch: 27 cost time: 121.21124958992004
Epoch: 27, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.240 Vali Acc: 0.974 Test Loss: 0.240 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0000399
	speed: 0.5676s/iter; left time: 17055.8267s
	iters: 200, epoch: 28 | loss: 0.0000001
	speed: 0.2771s/iter; left time: 8298.4999s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.2734s/iter; left time: 8161.8932s
	iters: 400, epoch: 28 | loss: 0.0000101
	speed: 0.2656s/iter; left time: 7900.9434s
Epoch: 28 cost time: 114.2626326084137
Epoch: 28, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.263 Vali Acc: 0.975 Test Loss: 0.263 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.5762s/iter; left time: 17075.5303s
	iters: 200, epoch: 29 | loss: 0.0000012
	speed: 0.2949s/iter; left time: 8710.7715s
	iters: 300, epoch: 29 | loss: 0.0000001
	speed: 0.2865s/iter; left time: 8434.9851s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.2879s/iter; left time: 8444.7845s
Epoch: 29 cost time: 121.08609008789062
Epoch: 29, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.174 Vali Acc: 0.982 Test Loss: 0.174 Test Acc: 0.982
Validation loss decreased (-0.979079 --> -0.981808).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0000949
	speed: 0.5698s/iter; left time: 16651.5996s
	iters: 200, epoch: 30 | loss: 0.0000003
	speed: 0.2982s/iter; left time: 8684.4892s
	iters: 300, epoch: 30 | loss: 0.0000002
	speed: 0.2911s/iter; left time: 8448.0556s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.2802s/iter; left time: 8103.0815s
Epoch: 30 cost time: 119.62113618850708
Epoch: 30, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.107 Vali Acc: 0.986 Test Loss: 0.107 Test Acc: 0.986
Validation loss decreased (-0.981808 --> -0.986356).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.0000013
	speed: 0.5597s/iter; left time: 16124.1493s
	iters: 200, epoch: 31 | loss: 0.0000039
	speed: 0.2885s/iter; left time: 8283.7369s
	iters: 300, epoch: 31 | loss: 0.0001675
	speed: 0.2921s/iter; left time: 8356.9405s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.2945s/iter; left time: 8396.0312s
Epoch: 31 cost time: 120.39475917816162
Epoch: 31, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.198 Vali Acc: 0.980 Test Loss: 0.198 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.5917s/iter; left time: 16804.3411s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.2870s/iter; left time: 8121.0208s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.2839s/iter; left time: 8005.3671s
	iters: 400, epoch: 32 | loss: 0.0000104
	speed: 0.2852s/iter; left time: 8012.8426s
Epoch: 32 cost time: 120.15286874771118
Epoch: 32, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.376 Vali Acc: 0.968 Test Loss: 0.376 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.5692s/iter; left time: 15928.7344s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.2910s/iter; left time: 8115.3042s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.2881s/iter; left time: 8004.1587s
	iters: 400, epoch: 33 | loss: 0.0000002
	speed: 0.2947s/iter; left time: 8158.1749s
Epoch: 33 cost time: 120.93005776405334
Epoch: 33, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.419 Vali Acc: 0.970 Test Loss: 0.419 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.5789s/iter; left time: 15960.9604s
	iters: 200, epoch: 34 | loss: 0.0256492
	speed: 0.2837s/iter; left time: 7794.3279s
	iters: 300, epoch: 34 | loss: 0.0000109
	speed: 0.2831s/iter; left time: 7747.7141s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.2914s/iter; left time: 7946.8648s
Epoch: 34 cost time: 119.10938382148743
Epoch: 34, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.337 Vali Acc: 0.970 Test Loss: 0.337 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.0000006
	speed: 0.5692s/iter; left time: 15458.2042s
	iters: 200, epoch: 35 | loss: 0.0000006
	speed: 0.2881s/iter; left time: 7795.6910s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.2846s/iter; left time: 7672.9385s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.2850s/iter; left time: 7654.0622s
Epoch: 35 cost time: 118.69912934303284
Epoch: 35, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.154 Vali Acc: 0.982 Test Loss: 0.154 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.5705s/iter; left time: 15259.0990s
	iters: 200, epoch: 36 | loss: 0.0006733
	speed: 0.2940s/iter; left time: 7834.1257s
	iters: 300, epoch: 36 | loss: 0.0000003
	speed: 0.2933s/iter; left time: 7785.8036s
	iters: 400, epoch: 36 | loss: 0.0033770
	speed: 0.2945s/iter; left time: 7788.1379s
Epoch: 36 cost time: 122.09679365158081
Epoch: 36, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.161 Vali Acc: 0.983 Test Loss: 0.161 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 0.0000142
	speed: 0.5803s/iter; left time: 15280.8651s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.3010s/iter; left time: 7895.3433s
	iters: 300, epoch: 37 | loss: 0.0000436
	speed: 0.2951s/iter; left time: 7712.8297s
	iters: 400, epoch: 37 | loss: 0.8270873
	speed: 0.2827s/iter; left time: 7358.7304s
Epoch: 37 cost time: 122.05392122268677
Epoch: 37, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.358 Vali Acc: 0.965 Test Loss: 0.358 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 38 | loss: 0.0554409
	speed: 0.5478s/iter; left time: 14200.0210s
	iters: 200, epoch: 38 | loss: 0.0000264
	speed: 0.2797s/iter; left time: 7222.7671s
	iters: 300, epoch: 38 | loss: 0.0000385
	speed: 0.2894s/iter; left time: 7443.5846s
	iters: 400, epoch: 38 | loss: 0.1395891
	speed: 0.2894s/iter; left time: 7414.0688s
Epoch: 38 cost time: 118.77229523658752
Epoch: 38, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.168 Vali Acc: 0.974 Test Loss: 0.168 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 39 | loss: 0.0000003
	speed: 0.5674s/iter; left time: 14471.4876s
	iters: 200, epoch: 39 | loss: 0.0000001
	speed: 0.2989s/iter; left time: 7594.1431s
	iters: 300, epoch: 39 | loss: 0.3984421
	speed: 0.3021s/iter; left time: 7645.4345s
	iters: 400, epoch: 39 | loss: 0.0116013
	speed: 0.3015s/iter; left time: 7599.7231s
Epoch: 39 cost time: 123.82098817825317
Epoch: 39, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.127 Vali Acc: 0.982 Test Loss: 0.127 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 40 | loss: 0.0000000
	speed: 0.5536s/iter; left time: 13892.7132s
	iters: 200, epoch: 40 | loss: 0.0000000
	speed: 0.2729s/iter; left time: 6819.8727s
	iters: 300, epoch: 40 | loss: 0.0000037
	speed: 0.2919s/iter; left time: 7266.4107s
	iters: 400, epoch: 40 | loss: 0.0002900
	speed: 0.2938s/iter; left time: 7285.1581s
Epoch: 40 cost time: 118.53718590736389
Epoch: 40, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.141 Vali Acc: 0.977 Test Loss: 0.141 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df128_ma38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9863574351978172
model parameter : 10220554
model size : 58.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         28                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df128_ma28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2454575
	speed: 0.3139s/iter; left time: 12934.5360s
	iters: 200, epoch: 1 | loss: 0.0676661
	speed: 0.2864s/iter; left time: 11770.9208s
	iters: 300, epoch: 1 | loss: 0.3622368
	speed: 0.2954s/iter; left time: 12110.5225s
	iters: 400, epoch: 1 | loss: 0.5969840
	speed: 0.3068s/iter; left time: 12548.3804s
Epoch: 1 cost time: 124.48212957382202
Epoch: 1, Steps: 413 | Train Loss: 0.394 Vali Loss: 0.190 Vali Acc: 0.954 Test Loss: 0.190 Test Acc: 0.954
Validation loss decreased (inf --> -0.953613).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0041686
	speed: 0.5835s/iter; left time: 23800.2323s
	iters: 200, epoch: 2 | loss: 0.0063390
	speed: 0.3048s/iter; left time: 12400.2285s
	iters: 300, epoch: 2 | loss: 0.8324685
	speed: 0.2883s/iter; left time: 11700.5435s
	iters: 400, epoch: 2 | loss: 0.0003880
	speed: 0.2974s/iter; left time: 12039.4054s
Epoch: 2 cost time: 122.95046925544739
Epoch: 2, Steps: 413 | Train Loss: 0.150 Vali Loss: 0.276 Vali Acc: 0.951 Test Loss: 0.276 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0372866
	speed: 0.5831s/iter; left time: 23543.0378s
	iters: 200, epoch: 3 | loss: 0.0137908
	speed: 0.2973s/iter; left time: 11972.2262s
	iters: 300, epoch: 3 | loss: 0.0012040
	speed: 0.2866s/iter; left time: 11512.8780s
	iters: 400, epoch: 3 | loss: 0.1816700
	speed: 0.2983s/iter; left time: 11952.5139s
Epoch: 3 cost time: 121.84897112846375
Epoch: 3, Steps: 413 | Train Loss: 0.282 Vali Loss: 0.226 Vali Acc: 0.968 Test Loss: 0.226 Test Acc: 0.968
Validation loss decreased (-0.953613 --> -0.968165).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0916047
	speed: 0.5864s/iter; left time: 23435.3753s
	iters: 200, epoch: 4 | loss: 0.0000000
	speed: 0.2941s/iter; left time: 11723.1142s
	iters: 300, epoch: 4 | loss: 0.0000001
	speed: 0.2969s/iter; left time: 11806.3455s
	iters: 400, epoch: 4 | loss: 0.2066458
	speed: 0.2974s/iter; left time: 11796.4260s
Epoch: 4 cost time: 122.8061249256134
Epoch: 4, Steps: 413 | Train Loss: 0.286 Vali Loss: 0.313 Vali Acc: 0.954 Test Loss: 0.313 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0008045
	speed: 0.5787s/iter; left time: 22888.8929s
	iters: 200, epoch: 5 | loss: 0.0000230
	speed: 0.2948s/iter; left time: 11629.9030s
	iters: 300, epoch: 5 | loss: 0.0000090
	speed: 0.2901s/iter; left time: 11415.8989s
	iters: 400, epoch: 5 | loss: 0.0000001
	speed: 0.2856s/iter; left time: 11209.4091s
Epoch: 5 cost time: 120.99650859832764
Epoch: 5, Steps: 413 | Train Loss: 0.319 Vali Loss: 0.693 Vali Acc: 0.945 Test Loss: 0.693 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000628
	speed: 0.5893s/iter; left time: 23063.7647s
	iters: 200, epoch: 6 | loss: 1.8664997
	speed: 0.2994s/iter; left time: 11688.8940s
	iters: 300, epoch: 6 | loss: 0.0002204
	speed: 0.2927s/iter; left time: 11395.7572s
	iters: 400, epoch: 6 | loss: 1.6429026
	speed: 0.2947s/iter; left time: 11443.7640s
Epoch: 6 cost time: 123.13105726242065
Epoch: 6, Steps: 413 | Train Loss: 0.348 Vali Loss: 1.337 Vali Acc: 0.896 Test Loss: 1.337 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.5760s/iter; left time: 22306.1004s
	iters: 200, epoch: 7 | loss: 0.0000040
	speed: 0.3028s/iter; left time: 11696.9466s
	iters: 300, epoch: 7 | loss: 5.8944764
	speed: 0.2966s/iter; left time: 11424.4789s
	iters: 400, epoch: 7 | loss: 0.0005976
	speed: 0.2711s/iter; left time: 10417.1439s
Epoch: 7 cost time: 120.51931476593018
Epoch: 7, Steps: 413 | Train Loss: 0.320 Vali Loss: 0.398 Vali Acc: 0.969 Test Loss: 0.398 Test Acc: 0.969
Validation loss decreased (-0.968165 --> -0.969073).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1304068
	speed: 0.5420s/iter; left time: 20764.6432s
	iters: 200, epoch: 8 | loss: 0.1737286
	speed: 0.2957s/iter; left time: 11297.6762s
	iters: 300, epoch: 8 | loss: 0.0802084
	speed: 0.3018s/iter; left time: 11500.0198s
	iters: 400, epoch: 8 | loss: 0.1284497
	speed: 0.2962s/iter; left time: 11259.9083s
Epoch: 8 cost time: 122.47985816001892
Epoch: 8, Steps: 413 | Train Loss: 0.270 Vali Loss: 0.398 Vali Acc: 0.963 Test Loss: 0.398 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.7494369
	speed: 0.5904s/iter; left time: 22372.8000s
	iters: 200, epoch: 9 | loss: 0.0000009
	speed: 0.3122s/iter; left time: 11800.7330s
	iters: 300, epoch: 9 | loss: 0.7457175
	speed: 0.3047s/iter; left time: 11485.3819s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.2888s/iter; left time: 10858.2276s
Epoch: 9 cost time: 124.67315864562988
Epoch: 9, Steps: 413 | Train Loss: 0.202 Vali Loss: 0.338 Vali Acc: 0.967 Test Loss: 0.338 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000004
	speed: 0.5533s/iter; left time: 20739.8780s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.2920s/iter; left time: 10915.3917s
	iters: 300, epoch: 10 | loss: 0.2454594
	speed: 0.2956s/iter; left time: 11019.7345s
	iters: 400, epoch: 10 | loss: 1.3755203
	speed: 0.2944s/iter; left time: 10946.0217s
Epoch: 10 cost time: 119.86024260520935
Epoch: 10, Steps: 413 | Train Loss: 0.217 Vali Loss: 0.545 Vali Acc: 0.960 Test Loss: 0.545 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.5565s/iter; left time: 20630.8446s
	iters: 200, epoch: 11 | loss: 0.0025023
	speed: 0.2965s/iter; left time: 10963.7196s
	iters: 300, epoch: 11 | loss: 0.0001037
	speed: 0.3158s/iter; left time: 11645.2459s
	iters: 400, epoch: 11 | loss: 0.0009562
	speed: 0.3088s/iter; left time: 11356.0393s
Epoch: 11 cost time: 126.38267183303833
Epoch: 11, Steps: 413 | Train Loss: 0.266 Vali Loss: 0.310 Vali Acc: 0.968 Test Loss: 0.310 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000013
	speed: 0.5645s/iter; left time: 20694.6831s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.2970s/iter; left time: 10856.6919s
	iters: 300, epoch: 12 | loss: 0.1294900
	speed: 0.2901s/iter; left time: 10576.0666s
	iters: 400, epoch: 12 | loss: 1.5648261
	speed: 0.2895s/iter; left time: 10525.6021s
Epoch: 12 cost time: 120.86671876907349
Epoch: 12, Steps: 413 | Train Loss: 0.177 Vali Loss: 0.388 Vali Acc: 0.971 Test Loss: 0.388 Test Acc: 0.971
Validation loss decreased (-0.969073 --> -0.970892).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.3972810
	speed: 0.5962s/iter; left time: 21607.9531s
	iters: 200, epoch: 13 | loss: 0.0000223
	speed: 0.2925s/iter; left time: 10572.1622s
	iters: 300, epoch: 13 | loss: 0.4544732
	speed: 0.3011s/iter; left time: 10853.1868s
	iters: 400, epoch: 13 | loss: 0.6328759
	speed: 0.2915s/iter; left time: 10478.1852s
Epoch: 13 cost time: 123.6889169216156
Epoch: 13, Steps: 413 | Train Loss: 0.126 Vali Loss: 0.308 Vali Acc: 0.974 Test Loss: 0.308 Test Acc: 0.974
Validation loss decreased (-0.970892 --> -0.974076).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.2526683
	speed: 0.5929s/iter; left time: 21244.0950s
	iters: 200, epoch: 14 | loss: 0.0004563
	speed: 0.2848s/iter; left time: 10177.6593s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.2789s/iter; left time: 9936.4126s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.3018s/iter; left time: 10722.8934s
Epoch: 14 cost time: 120.46126127243042
Epoch: 14, Steps: 413 | Train Loss: 0.227 Vali Loss: 0.271 Vali Acc: 0.976 Test Loss: 0.271 Test Acc: 0.976
Validation loss decreased (-0.974076 --> -0.975895).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000029
	speed: 0.5782s/iter; left time: 20479.3960s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.2572s/iter; left time: 9085.4309s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.2913s/iter; left time: 10259.6647s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.2997s/iter; left time: 10523.7228s
Epoch: 15 cost time: 118.01378226280212
Epoch: 15, Steps: 413 | Train Loss: 0.109 Vali Loss: 0.314 Vali Acc: 0.974 Test Loss: 0.314 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.6353457
	speed: 0.6041s/iter; left time: 21147.4214s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.2990s/iter; left time: 10438.6272s
	iters: 300, epoch: 16 | loss: 0.0000112
	speed: 0.3152s/iter; left time: 10972.2920s
	iters: 400, epoch: 16 | loss: 0.9100232
	speed: 0.2970s/iter; left time: 10308.9401s
Epoch: 16 cost time: 126.56282901763916
Epoch: 16, Steps: 413 | Train Loss: 0.120 Vali Loss: 0.423 Vali Acc: 0.971 Test Loss: 0.423 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.5690s/iter; left time: 19682.4811s
	iters: 200, epoch: 17 | loss: 0.0000017
	speed: 0.2745s/iter; left time: 9469.9209s
	iters: 300, epoch: 17 | loss: 0.4119826
	speed: 0.2993s/iter; left time: 10294.7537s
	iters: 400, epoch: 17 | loss: 0.0000182
	speed: 0.2875s/iter; left time: 9859.9693s
Epoch: 17 cost time: 118.92284607887268
Epoch: 17, Steps: 413 | Train Loss: 0.126 Vali Loss: 0.310 Vali Acc: 0.975 Test Loss: 0.310 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.5456s/iter; left time: 18648.2956s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.3112s/iter; left time: 10605.9697s
	iters: 300, epoch: 18 | loss: 0.0009582
	speed: 0.3052s/iter; left time: 10372.3796s
	iters: 400, epoch: 18 | loss: 0.0000005
	speed: 0.2958s/iter; left time: 10022.1987s
Epoch: 18 cost time: 123.42460870742798
Epoch: 18, Steps: 413 | Train Loss: 0.143 Vali Loss: 0.401 Vali Acc: 0.974 Test Loss: 0.401 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.5867s/iter; left time: 19811.1031s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.2975s/iter; left time: 10016.1049s
	iters: 300, epoch: 19 | loss: 0.0000001
	speed: 0.2856s/iter; left time: 9585.9199s
	iters: 400, epoch: 19 | loss: 0.9014347
	speed: 0.2854s/iter; left time: 9550.3132s
Epoch: 19 cost time: 121.0991690158844
Epoch: 19, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.666 Vali Acc: 0.960 Test Loss: 0.666 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0001094
	speed: 0.5521s/iter; left time: 18416.1906s
	iters: 200, epoch: 20 | loss: 0.0000002
	speed: 0.3049s/iter; left time: 10140.7200s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.2970s/iter; left time: 9845.5369s
	iters: 400, epoch: 20 | loss: 1.1821280
	speed: 0.3043s/iter; left time: 10057.1644s
Epoch: 20 cost time: 124.30196928977966
Epoch: 20, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.391 Vali Acc: 0.970 Test Loss: 0.391 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.5959s/iter; left time: 19628.2730s
	iters: 200, epoch: 21 | loss: 0.0000003
	speed: 0.2986s/iter; left time: 9805.9618s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.2950s/iter; left time: 9659.7224s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.2850s/iter; left time: 9301.4700s
Epoch: 21 cost time: 123.25040769577026
Epoch: 21, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.178 Vali Acc: 0.983 Test Loss: 0.178 Test Acc: 0.983
Validation loss decreased (-0.975895 --> -0.983172).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0050191
	speed: 0.5925s/iter; left time: 19273.4893s
	iters: 200, epoch: 22 | loss: 0.0093907
	speed: 0.2854s/iter; left time: 9255.0130s
	iters: 300, epoch: 22 | loss: 0.0021461
	speed: 0.2687s/iter; left time: 8687.7662s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.2867s/iter; left time: 9240.4197s
Epoch: 22 cost time: 119.65534377098083
Epoch: 22, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.754 Vali Acc: 0.970 Test Loss: 0.754 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0008457
	speed: 0.5920s/iter; left time: 19012.6088s
	iters: 200, epoch: 23 | loss: 0.0000539
	speed: 0.3061s/iter; left time: 9801.2439s
	iters: 300, epoch: 23 | loss: 0.0002478
	speed: 0.3093s/iter; left time: 9872.0960s
	iters: 400, epoch: 23 | loss: 0.0000001
	speed: 0.3111s/iter; left time: 9896.3633s
Epoch: 23 cost time: 127.291663646698
Epoch: 23, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.559 Vali Acc: 0.962 Test Loss: 0.559 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.5960s/iter; left time: 18893.5233s
	iters: 200, epoch: 24 | loss: 0.0471521
	speed: 0.2931s/iter; left time: 9261.7006s
	iters: 300, epoch: 24 | loss: 0.0000004
	speed: 0.2780s/iter; left time: 8756.7842s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.2897s/iter; left time: 9095.9662s
Epoch: 24 cost time: 119.62627863883972
Epoch: 24, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.214 Vali Acc: 0.982 Test Loss: 0.214 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0000058
	speed: 0.5955s/iter; left time: 18633.8698s
	iters: 200, epoch: 25 | loss: 0.9848903
	speed: 0.2853s/iter; left time: 8899.6285s
	iters: 300, epoch: 25 | loss: 0.0016206
	speed: 0.3021s/iter; left time: 9392.2686s
	iters: 400, epoch: 25 | loss: 0.0119688
	speed: 0.3028s/iter; left time: 9385.0064s
Epoch: 25 cost time: 123.85543608665466
Epoch: 25, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.207 Vali Acc: 0.978 Test Loss: 0.207 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.8167588
	speed: 0.5749s/iter; left time: 17750.0367s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.2935s/iter; left time: 9033.2440s
	iters: 300, epoch: 26 | loss: 0.2307889
	speed: 0.3086s/iter; left time: 9466.2297s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.2984s/iter; left time: 9124.3317s
Epoch: 26 cost time: 124.1240451335907
Epoch: 26, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.262 Vali Acc: 0.975 Test Loss: 0.262 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0828162
	speed: 0.5973s/iter; left time: 18196.6912s
	iters: 200, epoch: 27 | loss: 0.0000008
	speed: 0.3046s/iter; left time: 9248.9541s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.2989s/iter; left time: 9046.9087s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.2986s/iter; left time: 9005.3832s
Epoch: 27 cost time: 124.7500491142273
Epoch: 27, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.110 Vali Acc: 0.984 Test Loss: 0.110 Test Acc: 0.984
Validation loss decreased (-0.983172 --> -0.983628).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.5781s/iter; left time: 17370.5293s
	iters: 200, epoch: 28 | loss: 0.7088065
	speed: 0.3013s/iter; left time: 9024.2566s
	iters: 300, epoch: 28 | loss: 0.0009103
	speed: 0.2998s/iter; left time: 8950.2362s
	iters: 400, epoch: 28 | loss: 0.0023110
	speed: 0.2875s/iter; left time: 8553.8813s
Epoch: 28 cost time: 121.86549520492554
Epoch: 28, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.228 Vali Acc: 0.981 Test Loss: 0.228 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.5816s/iter; left time: 17236.0798s
	iters: 200, epoch: 29 | loss: 0.0009540
	speed: 0.3113s/iter; left time: 9195.5738s
	iters: 300, epoch: 29 | loss: 0.0000001
	speed: 0.2950s/iter; left time: 8685.2175s
	iters: 400, epoch: 29 | loss: 0.0000003
	speed: 0.2889s/iter; left time: 8475.9038s
Epoch: 29 cost time: 123.830162525177
Epoch: 29, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.328 Vali Acc: 0.970 Test Loss: 0.328 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0000520
	speed: 0.5891s/iter; left time: 17214.8255s
	iters: 200, epoch: 30 | loss: 0.0000091
	speed: 0.3120s/iter; left time: 9086.0982s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.2851s/iter; left time: 8273.7201s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.2933s/iter; left time: 8483.5926s
Epoch: 30 cost time: 124.04965353012085
Epoch: 30, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.126 Vali Acc: 0.985 Test Loss: 0.126 Test Acc: 0.985
Validation loss decreased (-0.983628 --> -0.984992).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.0001895
	speed: 0.6265s/iter; left time: 18050.7868s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.2980s/iter; left time: 8556.4936s
	iters: 300, epoch: 31 | loss: 0.0879878
	speed: 0.2868s/iter; left time: 8205.5890s
	iters: 400, epoch: 31 | loss: 0.0000001
	speed: 0.3135s/iter; left time: 8937.1808s
Epoch: 31 cost time: 125.6618263721466
Epoch: 31, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.095 Vali Acc: 0.985 Test Loss: 0.095 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.0000002
	speed: 0.5853s/iter; left time: 16620.3854s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.2804s/iter; left time: 7935.5935s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.2694s/iter; left time: 7595.4973s
	iters: 400, epoch: 32 | loss: 0.0000009
	speed: 0.2904s/iter; left time: 8158.7376s
Epoch: 32 cost time: 117.29364585876465
Epoch: 32, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.295 Vali Acc: 0.972 Test Loss: 0.295 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.0003077
	speed: 0.5607s/iter; left time: 15691.2965s
	iters: 200, epoch: 33 | loss: 0.0002066
	speed: 0.2671s/iter; left time: 7448.0229s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.2953s/iter; left time: 8206.1511s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.3147s/iter; left time: 8713.4645s
Epoch: 33 cost time: 119.3676609992981
Epoch: 33, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.174 Vali Acc: 0.974 Test Loss: 0.174 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.0039481
	speed: 0.5909s/iter; left time: 16292.9345s
	iters: 200, epoch: 34 | loss: 0.0000001
	speed: 0.2937s/iter; left time: 8067.9652s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.3081s/iter; left time: 8432.0953s
	iters: 400, epoch: 34 | loss: 0.0000003
	speed: 0.2978s/iter; left time: 8122.8233s
Epoch: 34 cost time: 123.73035860061646
Epoch: 34, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.217 Vali Acc: 0.982 Test Loss: 0.217 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.0000054
	speed: 0.5589s/iter; left time: 15179.5649s
	iters: 200, epoch: 35 | loss: 0.0002495
	speed: 0.2678s/iter; left time: 7246.6714s
	iters: 300, epoch: 35 | loss: 0.0000354
	speed: 0.2877s/iter; left time: 7755.7028s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.2965s/iter; left time: 7963.6023s
Epoch: 35 cost time: 117.93576383590698
Epoch: 35, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.223 Vali Acc: 0.984 Test Loss: 0.223 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 0.1923127
	speed: 0.5564s/iter; left time: 14881.2035s
	iters: 200, epoch: 36 | loss: 0.0535836
	speed: 0.3037s/iter; left time: 8092.0181s
	iters: 300, epoch: 36 | loss: 0.0000009
	speed: 0.3032s/iter; left time: 8048.8666s
	iters: 400, epoch: 36 | loss: 0.0000001
	speed: 0.3074s/iter; left time: 8128.2056s
Epoch: 36 cost time: 123.32921290397644
Epoch: 36, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.092 Vali Acc: 0.986 Test Loss: 0.092 Test Acc: 0.986
Validation loss decreased (-0.984992 --> -0.985902).  Saving model ...
	iters: 100, epoch: 37 | loss: 0.0000124
	speed: 0.5683s/iter; left time: 14964.2276s
	iters: 200, epoch: 37 | loss: 0.0000016
	speed: 0.3055s/iter; left time: 8013.3475s
	iters: 300, epoch: 37 | loss: 0.0000056
	speed: 0.3004s/iter; left time: 7849.5351s
	iters: 400, epoch: 37 | loss: 0.0000128
	speed: 0.2983s/iter; left time: 7765.9119s
Epoch: 37 cost time: 123.65521597862244
Epoch: 37, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.104 Vali Acc: 0.984 Test Loss: 0.104 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 38 | loss: 0.0000001
	speed: 0.5656s/iter; left time: 14659.9041s
	iters: 200, epoch: 38 | loss: 0.0298560
	speed: 0.3047s/iter; left time: 7867.5394s
	iters: 300, epoch: 38 | loss: 0.0000000
	speed: 0.3106s/iter; left time: 7988.2888s
	iters: 400, epoch: 38 | loss: 0.0000028
	speed: 0.3053s/iter; left time: 7822.3152s
Epoch: 38 cost time: 125.64336204528809
Epoch: 38, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.124 Vali Acc: 0.985 Test Loss: 0.124 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 39 | loss: 0.0000000
	speed: 0.5846s/iter; left time: 14911.7783s
	iters: 200, epoch: 39 | loss: 0.0006307
	speed: 0.2996s/iter; left time: 7611.9881s
	iters: 300, epoch: 39 | loss: 0.0000004
	speed: 0.2744s/iter; left time: 6943.1619s
	iters: 400, epoch: 39 | loss: 0.5721641
	speed: 0.2805s/iter; left time: 7069.4255s
Epoch: 39 cost time: 119.44161748886108
Epoch: 39, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.109 Vali Acc: 0.986 Test Loss: 0.109 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 40 | loss: 0.0001307
	speed: 0.5499s/iter; left time: 13798.4250s
	iters: 200, epoch: 40 | loss: 0.0000007
	speed: 0.2913s/iter; left time: 7280.0062s
	iters: 300, epoch: 40 | loss: 0.0000000
	speed: 0.3014s/iter; left time: 7503.9534s
	iters: 400, epoch: 40 | loss: 0.0000466
	speed: 0.2994s/iter; left time: 7423.3662s
Epoch: 40 cost time: 121.66958546638489
Epoch: 40, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.153 Vali Acc: 0.981 Test Loss: 0.153 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 41 | loss: 0.0000167
	speed: 0.6014s/iter; left time: 14844.2741s
	iters: 200, epoch: 41 | loss: 0.0000001
	speed: 0.3027s/iter; left time: 7439.8220s
	iters: 300, epoch: 41 | loss: 0.0000022
	speed: 0.3030s/iter; left time: 7418.4299s
	iters: 400, epoch: 41 | loss: 0.0000122
	speed: 0.3049s/iter; left time: 7434.0277s
Epoch: 41 cost time: 125.8306679725647
Epoch: 41, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.176 Vali Acc: 0.979 Test Loss: 0.176 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 42 | loss: 0.0000000
	speed: 0.5469s/iter; left time: 13271.9068s
	iters: 200, epoch: 42 | loss: 0.0002789
	speed: 0.3003s/iter; left time: 7258.0173s
	iters: 300, epoch: 42 | loss: 0.0000001
	speed: 0.2998s/iter; left time: 7215.3327s
	iters: 400, epoch: 42 | loss: 0.0001757
	speed: 0.2819s/iter; left time: 6756.2370s
Epoch: 42 cost time: 119.14660143852234
Epoch: 42, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.117 Vali Acc: 0.981 Test Loss: 0.117 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 43 | loss: 0.0060306
	speed: 0.5694s/iter; left time: 13584.0924s
	iters: 200, epoch: 43 | loss: 0.0000002
	speed: 0.3021s/iter; left time: 7176.4169s
	iters: 300, epoch: 43 | loss: 0.0000527
	speed: 0.2834s/iter; left time: 6703.7193s
	iters: 400, epoch: 43 | loss: 0.0000027
	speed: 0.2957s/iter; left time: 6964.8885s
Epoch: 43 cost time: 122.53046679496765
Epoch: 43, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.083 Vali Acc: 0.989 Test Loss: 0.083 Test Acc: 0.989
Validation loss decreased (-0.985902 --> -0.988630).  Saving model ...
	iters: 100, epoch: 44 | loss: 0.0000015
	speed: 0.5744s/iter; left time: 13464.4268s
	iters: 200, epoch: 44 | loss: 0.0000078
	speed: 0.2825s/iter; left time: 6593.2117s
	iters: 300, epoch: 44 | loss: 0.0017552
	speed: 0.2955s/iter; left time: 6867.9596s
	iters: 400, epoch: 44 | loss: 0.0001422
	speed: 0.2953s/iter; left time: 6834.1939s
Epoch: 44 cost time: 120.51696991920471
Epoch: 44, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.049 Vali Acc: 0.989 Test Loss: 0.049 Test Acc: 0.989
Validation loss decreased (-0.988630 --> -0.988631).  Saving model ...
	iters: 100, epoch: 45 | loss: 0.0000002
	speed: 0.5833s/iter; left time: 13432.7600s
	iters: 200, epoch: 45 | loss: 0.0002147
	speed: 0.3061s/iter; left time: 7018.9496s
	iters: 300, epoch: 45 | loss: 0.0000046
	speed: 0.2884s/iter; left time: 6584.7119s
	iters: 400, epoch: 45 | loss: 0.0000136
	speed: 0.2833s/iter; left time: 6439.5943s
Epoch: 45 cost time: 121.63353657722473
Epoch: 45, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.059 Vali Acc: 0.986 Test Loss: 0.059 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 46 | loss: 0.0001054
	speed: 0.5724s/iter; left time: 12946.4609s
	iters: 200, epoch: 46 | loss: 0.0000007
	speed: 0.2831s/iter; left time: 6374.5151s
	iters: 300, epoch: 46 | loss: 0.0000799
	speed: 0.3006s/iter; left time: 6738.8944s
	iters: 400, epoch: 46 | loss: 0.0000166
	speed: 0.3060s/iter; left time: 6828.6262s
Epoch: 46 cost time: 121.61409425735474
Epoch: 46, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.072 Vali Acc: 0.986 Test Loss: 0.072 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 47 | loss: 0.0000947
	speed: 0.5512s/iter; left time: 12237.2818s
	iters: 200, epoch: 47 | loss: 0.0000000
	speed: 0.3065s/iter; left time: 6773.5052s
	iters: 300, epoch: 47 | loss: 0.0001129
	speed: 0.2989s/iter; left time: 6577.7560s
	iters: 400, epoch: 47 | loss: 0.0000012
	speed: 0.2890s/iter; left time: 6329.2472s
Epoch: 47 cost time: 122.4769127368927
Epoch: 47, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.060 Vali Acc: 0.988 Test Loss: 0.060 Test Acc: 0.988
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 48 | loss: 0.0000002
	speed: 0.5982s/iter; left time: 13035.1969s
	iters: 200, epoch: 48 | loss: 0.0012169
	speed: 0.2884s/iter; left time: 6255.7315s
	iters: 300, epoch: 48 | loss: 0.0000242
	speed: 0.3004s/iter; left time: 6485.3356s
	iters: 400, epoch: 48 | loss: 0.1581715
	speed: 0.3037s/iter; left time: 6527.5415s
Epoch: 48 cost time: 124.09604096412659
Epoch: 48, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.047 Vali Acc: 0.987 Test Loss: 0.047 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 49 | loss: 0.0001010
	speed: 0.5615s/iter; left time: 12002.2395s
	iters: 200, epoch: 49 | loss: 0.0464731
	speed: 0.2903s/iter; left time: 6175.8172s
	iters: 300, epoch: 49 | loss: 0.0000815
	speed: 0.2918s/iter; left time: 6180.0558s
	iters: 400, epoch: 49 | loss: 0.0000530
	speed: 0.2815s/iter; left time: 5932.7749s
Epoch: 49 cost time: 119.50033473968506
Epoch: 49, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.053 Vali Acc: 0.991 Test Loss: 0.053 Test Acc: 0.991
Validation loss decreased (-0.988631 --> -0.990904).  Saving model ...
	iters: 100, epoch: 50 | loss: 0.0000019
	speed: 0.5866s/iter; left time: 12297.8969s
	iters: 200, epoch: 50 | loss: 0.0000064
	speed: 0.3018s/iter; left time: 6295.7756s
	iters: 300, epoch: 50 | loss: 0.0000022
	speed: 0.2985s/iter; left time: 6199.0406s
	iters: 400, epoch: 50 | loss: 0.0000194
	speed: 0.3049s/iter; left time: 6299.7101s
Epoch: 50 cost time: 125.531414270401
Epoch: 50, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.069 Vali Acc: 0.986 Test Loss: 0.069 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 51 | loss: 0.0220802
	speed: 0.5688s/iter; left time: 11689.8190s
	iters: 200, epoch: 51 | loss: 0.0000824
	speed: 0.2798s/iter; left time: 5721.4263s
	iters: 300, epoch: 51 | loss: 0.0000113
	speed: 0.3154s/iter; left time: 6418.5492s
	iters: 400, epoch: 51 | loss: 0.0001272
	speed: 0.2835s/iter; left time: 5741.8461s
Epoch: 51 cost time: 120.28371453285217
Epoch: 51, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.040 Vali Acc: 0.990 Test Loss: 0.040 Test Acc: 0.990
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 52 | loss: 0.0000041
	speed: 0.5670s/iter; left time: 11417.6820s
	iters: 200, epoch: 52 | loss: 0.0000002
	speed: 0.3070s/iter; left time: 6151.0647s
	iters: 300, epoch: 52 | loss: 0.0002272
	speed: 0.2941s/iter; left time: 5863.4916s
	iters: 400, epoch: 52 | loss: 0.0000914
	speed: 0.3148s/iter; left time: 6245.7498s
Epoch: 52 cost time: 126.64923357963562
Epoch: 52, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.052 Vali Acc: 0.990 Test Loss: 0.052 Test Acc: 0.990
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 53 | loss: 0.0000004
	speed: 0.6024s/iter; left time: 11881.3924s
	iters: 200, epoch: 53 | loss: 0.0000004
	speed: 0.2932s/iter; left time: 5753.3401s
	iters: 300, epoch: 53 | loss: 0.0000015
	speed: 0.2936s/iter; left time: 5731.8334s
	iters: 400, epoch: 53 | loss: 0.0000000
	speed: 0.2874s/iter; left time: 5581.7750s
Epoch: 53 cost time: 121.7322769165039
Epoch: 53, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.052 Vali Acc: 0.990 Test Loss: 0.052 Test Acc: 0.990
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 54 | loss: 0.0000113
	speed: 0.5469s/iter; left time: 10561.8488s
	iters: 200, epoch: 54 | loss: 0.0000933
	speed: 0.2871s/iter; left time: 5515.1167s
	iters: 300, epoch: 54 | loss: 0.0000003
	speed: 0.2988s/iter; left time: 5710.2873s
	iters: 400, epoch: 54 | loss: 0.0000021
	speed: 0.3008s/iter; left time: 5718.7698s
Epoch: 54 cost time: 120.69731783866882
Epoch: 54, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.051 Vali Acc: 0.990 Test Loss: 0.051 Test Acc: 0.990
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 55 | loss: 0.0000036
	speed: 0.6064s/iter; left time: 11461.0797s
	iters: 200, epoch: 55 | loss: 0.0000131
	speed: 0.3142s/iter; left time: 5906.6725s
	iters: 300, epoch: 55 | loss: 0.0000043
	speed: 0.2993s/iter; left time: 5595.7055s
	iters: 400, epoch: 55 | loss: 0.0000055
	speed: 0.3093s/iter; left time: 5753.1213s
Epoch: 55 cost time: 127.36220359802246
Epoch: 55, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.056 Vali Acc: 0.989 Test Loss: 0.056 Test Acc: 0.989
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 56 | loss: 0.0000130
	speed: 0.5437s/iter; left time: 10049.9893s
	iters: 200, epoch: 56 | loss: 0.0000015
	speed: 0.2976s/iter; left time: 5471.5524s
	iters: 300, epoch: 56 | loss: 0.0000463
	speed: 0.2860s/iter; left time: 5229.0390s
	iters: 400, epoch: 56 | loss: 0.0000651
	speed: 0.2835s/iter; left time: 5155.1730s
Epoch: 56 cost time: 118.41059374809265
Epoch: 56, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.119 Vali Acc: 0.976 Test Loss: 0.119 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 57 | loss: 0.0008159
	speed: 0.6010s/iter; left time: 10861.4804s
	iters: 200, epoch: 57 | loss: 0.0009326
	speed: 0.3130s/iter; left time: 5624.7698s
	iters: 300, epoch: 57 | loss: 0.0000183
	speed: 0.3040s/iter; left time: 5433.4400s
	iters: 400, epoch: 57 | loss: 0.0114413
	speed: 0.3235s/iter; left time: 5749.9451s
Epoch: 57 cost time: 129.8024332523346
Epoch: 57, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.049 Vali Acc: 0.989 Test Loss: 0.049 Test Acc: 0.989
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 58 | loss: 0.0407900
	speed: 0.5704s/iter; left time: 10073.2394s
	iters: 200, epoch: 58 | loss: 0.0001422
	speed: 0.2867s/iter; left time: 5035.1964s
	iters: 300, epoch: 58 | loss: 0.0006361
	speed: 0.3021s/iter; left time: 5274.3421s
	iters: 400, epoch: 58 | loss: 0.0239928
	speed: 0.2823s/iter; left time: 4901.5245s
Epoch: 58 cost time: 120.20981431007385
Epoch: 58, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.036 Vali Acc: 0.987 Test Loss: 0.036 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 59 | loss: 0.0000032
	speed: 0.5863s/iter; left time: 10111.8833s
	iters: 200, epoch: 59 | loss: 0.0000007
	speed: 0.3076s/iter; left time: 5274.2623s
	iters: 300, epoch: 59 | loss: 0.0000352
	speed: 0.3012s/iter; left time: 5134.6173s
	iters: 400, epoch: 59 | loss: 0.0000189
	speed: 0.3046s/iter; left time: 5161.4620s
Epoch: 59 cost time: 126.26610803604126
Epoch: 59, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.024 Vali Acc: 0.991 Test Loss: 0.024 Test Acc: 0.991
Validation loss decreased (-0.990904 --> -0.990905).  Saving model ...
	iters: 100, epoch: 60 | loss: 0.0000415
	speed: 0.6190s/iter; left time: 10420.6495s
	iters: 200, epoch: 60 | loss: 0.0000309
	speed: 0.2812s/iter; left time: 4705.0216s
	iters: 300, epoch: 60 | loss: 0.0000003
	speed: 0.2977s/iter; left time: 4951.5470s
	iters: 400, epoch: 60 | loss: 0.0000166
	speed: 0.2851s/iter; left time: 4713.5087s
Epoch: 60 cost time: 121.84656596183777
Epoch: 60, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.020 Vali Acc: 0.994 Test Loss: 0.020 Test Acc: 0.994
Validation loss decreased (-0.990905 --> -0.993633).  Saving model ...
	iters: 100, epoch: 61 | loss: 0.0000004
	speed: 0.5552s/iter; left time: 9116.4170s
	iters: 200, epoch: 61 | loss: 0.0011014
	speed: 0.3000s/iter; left time: 4896.6083s
	iters: 300, epoch: 61 | loss: 0.0000012
	speed: 0.2934s/iter; left time: 4758.9137s
	iters: 400, epoch: 61 | loss: 0.0000398
	speed: 0.2853s/iter; left time: 4599.0313s
Epoch: 61 cost time: 120.06446933746338
Epoch: 61, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.021 Vali Acc: 0.993 Test Loss: 0.021 Test Acc: 0.993
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 62 | loss: 0.0000069
	speed: 0.5673s/iter; left time: 9081.8438s
	iters: 200, epoch: 62 | loss: 0.0000171
	speed: 0.2995s/iter; left time: 4764.4732s
	iters: 300, epoch: 62 | loss: 0.0000066
	speed: 0.3088s/iter; left time: 4881.2536s
	iters: 400, epoch: 62 | loss: 0.0000019
	speed: 0.3025s/iter; left time: 4752.3600s
Epoch: 62 cost time: 122.92834711074829
Epoch: 62, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.022 Vali Acc: 0.993 Test Loss: 0.022 Test Acc: 0.993
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 63 | loss: 0.0000001
	speed: 0.5862s/iter; left time: 9142.0940s
	iters: 200, epoch: 63 | loss: 0.0000005
	speed: 0.2985s/iter; left time: 4624.8434s
	iters: 300, epoch: 63 | loss: 0.0000003
	speed: 0.2967s/iter; left time: 4568.4374s
	iters: 400, epoch: 63 | loss: 0.0000001
	speed: 0.2909s/iter; left time: 4449.8475s
Epoch: 63 cost time: 122.5351939201355
Epoch: 63, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.021 Vali Acc: 0.993 Test Loss: 0.021 Test Acc: 0.993
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 64 | loss: 0.0000001
	speed: 0.5640s/iter; left time: 8562.5605s
	iters: 200, epoch: 64 | loss: 0.0000004
	speed: 0.3009s/iter; left time: 4538.3641s
	iters: 300, epoch: 64 | loss: 0.0000002
	speed: 0.2847s/iter; left time: 4265.5209s
	iters: 400, epoch: 64 | loss: 0.0000044
	speed: 0.2847s/iter; left time: 4237.5837s
Epoch: 64 cost time: 120.06907272338867
Epoch: 64, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.018 Vali Acc: 0.993 Test Loss: 0.018 Test Acc: 0.993
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 65 | loss: 0.0000000
	speed: 0.5766s/iter; left time: 8515.9955s
	iters: 200, epoch: 65 | loss: 0.0000008
	speed: 0.2962s/iter; left time: 4344.2653s
	iters: 300, epoch: 65 | loss: 0.0000005
	speed: 0.3027s/iter; left time: 4410.6471s
	iters: 400, epoch: 65 | loss: 0.0000005
	speed: 0.3031s/iter; left time: 4386.2627s
Epoch: 65 cost time: 123.27549505233765
Epoch: 65, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.018 Vali Acc: 0.993 Test Loss: 0.018 Test Acc: 0.993
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 66 | loss: 0.0000035
	speed: 0.6023s/iter; left time: 8646.0061s
	iters: 200, epoch: 66 | loss: 0.0000026
	speed: 0.3034s/iter; left time: 4324.6158s
	iters: 300, epoch: 66 | loss: 0.0000002
	speed: 0.2781s/iter; left time: 3936.3470s
	iters: 400, epoch: 66 | loss: 0.0000119
	speed: 0.2852s/iter; left time: 4009.2290s
Epoch: 66 cost time: 120.81106090545654
Epoch: 66, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.018 Vali Acc: 0.994 Test Loss: 0.018 Test Acc: 0.994
Validation loss decreased (-0.993633 --> -0.993633).  Saving model ...
	iters: 100, epoch: 67 | loss: 0.0000225
	speed: 0.5854s/iter; left time: 8161.7961s
	iters: 200, epoch: 67 | loss: 0.0000096
	speed: 0.3019s/iter; left time: 4179.4489s
	iters: 300, epoch: 67 | loss: 0.0000010
	speed: 0.2908s/iter; left time: 3996.9552s
	iters: 400, epoch: 67 | loss: 0.0000127
	speed: 0.3006s/iter; left time: 4100.5772s
Epoch: 67 cost time: 121.96130084991455
Epoch: 67, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.018 Vali Acc: 0.994 Test Loss: 0.018 Test Acc: 0.994
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 68 | loss: 0.0000063
	speed: 0.5752s/iter; left time: 7782.5926s
	iters: 200, epoch: 68 | loss: 0.0000002
	speed: 0.2981s/iter; left time: 4003.4435s
	iters: 300, epoch: 68 | loss: 0.0000056
	speed: 0.2945s/iter; left time: 3926.0294s
	iters: 400, epoch: 68 | loss: 0.0000001
	speed: 0.2952s/iter; left time: 3905.3411s
Epoch: 68 cost time: 121.37059211730957
Epoch: 68, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.019 Vali Acc: 0.994 Test Loss: 0.019 Test Acc: 0.994
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 69 | loss: 0.0000010
	speed: 0.6098s/iter; left time: 7999.1116s
	iters: 200, epoch: 69 | loss: 0.0000001
	speed: 0.2954s/iter; left time: 3845.0940s
	iters: 300, epoch: 69 | loss: 0.0000007
	speed: 0.3104s/iter; left time: 4008.9412s
	iters: 400, epoch: 69 | loss: 0.0000008
	speed: 0.2940s/iter; left time: 3767.7371s
Epoch: 69 cost time: 126.00103402137756
Epoch: 69, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.019 Vali Acc: 0.994 Test Loss: 0.019 Test Acc: 0.994
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 70 | loss: 0.0000004
	speed: 0.6141s/iter; left time: 7800.9450s
	iters: 200, epoch: 70 | loss: 0.0000000
	speed: 0.2918s/iter; left time: 3678.0854s
	iters: 300, epoch: 70 | loss: 0.0000006
	speed: 0.2988s/iter; left time: 3736.2819s
	iters: 400, epoch: 70 | loss: 0.0000007
	speed: 0.2825s/iter; left time: 3504.2123s
Epoch: 70 cost time: 121.537522315979
Epoch: 70, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.020 Vali Acc: 0.994 Test Loss: 0.020 Test Acc: 0.994
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 71 | loss: 0.0000000
	speed: 0.5851s/iter; left time: 7191.0937s
	iters: 200, epoch: 71 | loss: 0.0000000
	speed: 0.2988s/iter; left time: 3643.1610s
	iters: 300, epoch: 71 | loss: 0.0000000
	speed: 0.3098s/iter; left time: 3746.0513s
	iters: 400, epoch: 71 | loss: 0.0000064
	speed: 0.3010s/iter; left time: 3609.0720s
Epoch: 71 cost time: 124.4904363155365
Epoch: 71, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.016 Vali Acc: 0.995 Test Loss: 0.016 Test Acc: 0.995
Validation loss decreased (-0.993633 --> -0.994543).  Saving model ...
	iters: 100, epoch: 72 | loss: 0.0000011
	speed: 0.6163s/iter; left time: 7320.5375s
	iters: 200, epoch: 72 | loss: 0.0000000
	speed: 0.3184s/iter; left time: 3749.9132s
	iters: 300, epoch: 72 | loss: 0.0000002
	speed: 0.3091s/iter; left time: 3609.9970s
	iters: 400, epoch: 72 | loss: 0.0000000
	speed: 0.2833s/iter; left time: 3280.3497s
Epoch: 72 cost time: 125.89427709579468
Epoch: 72, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.017 Vali Acc: 0.995 Test Loss: 0.017 Test Acc: 0.995
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 73 | loss: 0.0000011
	speed: 0.6040s/iter; left time: 6924.9124s
	iters: 200, epoch: 73 | loss: 0.0000002
	speed: 0.3014s/iter; left time: 3425.1374s
	iters: 300, epoch: 73 | loss: 0.0000002
	speed: 0.2888s/iter; left time: 3253.4582s
	iters: 400, epoch: 73 | loss: 0.0000002
	speed: 0.2853s/iter; left time: 3185.0430s
Epoch: 73 cost time: 122.80845546722412
Epoch: 73, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.017 Vali Acc: 0.994 Test Loss: 0.017 Test Acc: 0.994
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 74 | loss: 0.0000018
	speed: 0.5927s/iter; left time: 6550.2262s
	iters: 200, epoch: 74 | loss: 0.0000000
	speed: 0.3058s/iter; left time: 3348.7353s
	iters: 300, epoch: 74 | loss: 0.0000000
	speed: 0.2999s/iter; left time: 3254.9139s
	iters: 400, epoch: 74 | loss: 0.0000000
	speed: 0.2855s/iter; left time: 3069.2725s
Epoch: 74 cost time: 123.22335982322693
Epoch: 74, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.017 Vali Acc: 0.995 Test Loss: 0.017 Test Acc: 0.995
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 75 | loss: 0.0000000
	speed: 0.6202s/iter; left time: 6598.0394s
	iters: 200, epoch: 75 | loss: 0.0000008
	speed: 0.3075s/iter; left time: 3240.9476s
	iters: 300, epoch: 75 | loss: 0.0000000
	speed: 0.3062s/iter; left time: 3196.9408s
	iters: 400, epoch: 75 | loss: 0.0000001
	speed: 0.2923s/iter; left time: 3021.6526s
Epoch: 75 cost time: 125.19588899612427
Epoch: 75, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.017 Vali Acc: 0.995 Test Loss: 0.017 Test Acc: 0.995
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 76 | loss: 0.0000000
	speed: 0.5576s/iter; left time: 5701.8883s
	iters: 200, epoch: 76 | loss: 0.0000000
	speed: 0.2760s/iter; left time: 2794.7874s
	iters: 300, epoch: 76 | loss: 0.0034624
	speed: 0.2743s/iter; left time: 2749.9534s
	iters: 400, epoch: 76 | loss: 0.0002982
	speed: 0.2764s/iter; left time: 2743.4297s
Epoch: 76 cost time: 113.68447399139404
Epoch: 76, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 77 | loss: 0.0004252
	speed: 0.5678s/iter; left time: 5571.5056s
	iters: 200, epoch: 77 | loss: 0.0000582
	speed: 0.2937s/iter; left time: 2853.1228s
	iters: 300, epoch: 77 | loss: 0.0003246
	speed: 0.2696s/iter; left time: 2592.0478s
	iters: 400, epoch: 77 | loss: 0.0000538
	speed: 0.2762s/iter; left time: 2627.6536s
Epoch: 77 cost time: 116.53798842430115
Epoch: 77, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.060 Vali Acc: 0.987 Test Loss: 0.060 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 78 | loss: 0.0008670
	speed: 0.5658s/iter; left time: 5318.3818s
	iters: 200, epoch: 78 | loss: 0.0000335
	speed: 0.2854s/iter; left time: 2654.1340s
	iters: 300, epoch: 78 | loss: 0.0001871
	speed: 0.2821s/iter; left time: 2595.1261s
	iters: 400, epoch: 78 | loss: 0.0000775
	speed: 0.2792s/iter; left time: 2540.6521s
Epoch: 78 cost time: 117.89029693603516
Epoch: 78, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.061 Vali Acc: 0.985 Test Loss: 0.061 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 79 | loss: 0.0000098
	speed: 0.5599s/iter; left time: 5031.9322s
	iters: 200, epoch: 79 | loss: 0.0000195
	speed: 0.2826s/iter; left time: 2511.6265s
	iters: 300, epoch: 79 | loss: 0.0003397
	speed: 0.2923s/iter; left time: 2568.1008s
	iters: 400, epoch: 79 | loss: 0.0000287
	speed: 0.2862s/iter; left time: 2486.2439s
Epoch: 79 cost time: 118.8355495929718
Epoch: 79, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.056 Vali Acc: 0.987 Test Loss: 0.056 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 80 | loss: 0.0000059
	speed: 0.5579s/iter; left time: 4783.2633s
	iters: 200, epoch: 80 | loss: 0.0000173
	speed: 0.2859s/iter; left time: 2423.1388s
	iters: 300, epoch: 80 | loss: 0.0000025
	speed: 0.2863s/iter; left time: 2397.7385s
	iters: 400, epoch: 80 | loss: 0.0000017
	speed: 0.2765s/iter; left time: 2287.8282s
Epoch: 80 cost time: 116.89683222770691
Epoch: 80, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.055 Vali Acc: 0.989 Test Loss: 0.055 Test Acc: 0.989
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 81 | loss: 0.0000120
	speed: 0.5431s/iter; left time: 4432.1167s
	iters: 200, epoch: 81 | loss: 0.0000257
	speed: 0.2830s/iter; left time: 2280.9643s
	iters: 300, epoch: 81 | loss: 0.0000376
	speed: 0.2855s/iter; left time: 2273.0102s
	iters: 400, epoch: 81 | loss: 0.0000016
	speed: 0.2896s/iter; left time: 2276.7529s
Epoch: 81 cost time: 117.71795201301575
Epoch: 81, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.054 Vali Acc: 0.989 Test Loss: 0.054 Test Acc: 0.989
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df128_ma28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9945429740791268
model parameter : 10220554
model size : 58.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df128_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5068779
	speed: 0.3112s/iter; left time: 12822.3367s
	iters: 200, epoch: 1 | loss: 0.1026328
	speed: 0.3016s/iter; left time: 12394.6135s
	iters: 300, epoch: 1 | loss: 0.5615181
	speed: 0.2897s/iter; left time: 11878.6653s
	iters: 400, epoch: 1 | loss: 0.2084839
	speed: 0.2894s/iter; left time: 11837.6455s
Epoch: 1 cost time: 122.68833994865417
Epoch: 1, Steps: 413 | Train Loss: 0.441 Vali Loss: 0.127 Vali Acc: 0.964 Test Loss: 0.127 Test Acc: 0.964
Validation loss decreased (inf --> -0.964073).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1474653
	speed: 0.5474s/iter; left time: 22328.4647s
	iters: 200, epoch: 2 | loss: 0.1858231
	speed: 0.2789s/iter; left time: 11347.1769s
	iters: 300, epoch: 2 | loss: 0.7485496
	speed: 0.2824s/iter; left time: 11463.7792s
	iters: 400, epoch: 2 | loss: 0.0003092
	speed: 0.2775s/iter; left time: 11234.8419s
Epoch: 2 cost time: 115.67585492134094
Epoch: 2, Steps: 413 | Train Loss: 0.159 Vali Loss: 0.345 Vali Acc: 0.943 Test Loss: 0.345 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.4241853
	speed: 0.5489s/iter; left time: 22162.7606s
	iters: 200, epoch: 3 | loss: 0.0001872
	speed: 0.2926s/iter; left time: 11783.7360s
	iters: 300, epoch: 3 | loss: 0.6055306
	speed: 0.2939s/iter; left time: 11806.8288s
	iters: 400, epoch: 3 | loss: 0.3594429
	speed: 0.2931s/iter; left time: 11746.4030s
Epoch: 3 cost time: 120.3809003829956
Epoch: 3, Steps: 413 | Train Loss: 0.305 Vali Loss: 0.599 Vali Acc: 0.930 Test Loss: 0.599 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0024353
	speed: 0.5580s/iter; left time: 22297.0185s
	iters: 200, epoch: 4 | loss: 0.0000001
	speed: 0.2868s/iter; left time: 11433.6069s
	iters: 300, epoch: 4 | loss: 0.0000559
	speed: 0.2775s/iter; left time: 11032.1346s
	iters: 400, epoch: 4 | loss: 1.0066516
	speed: 0.2799s/iter; left time: 11100.9543s
Epoch: 4 cost time: 116.17280173301697
Epoch: 4, Steps: 413 | Train Loss: 0.269 Vali Loss: 0.320 Vali Acc: 0.962 Test Loss: 0.320 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 2.6437631
	speed: 0.5461s/iter; left time: 21596.8312s
	iters: 200, epoch: 5 | loss: 0.3339249
	speed: 0.2744s/iter; left time: 10825.9186s
	iters: 300, epoch: 5 | loss: 0.0000002
	speed: 0.2801s/iter; left time: 11023.0425s
	iters: 400, epoch: 5 | loss: 0.0000002
	speed: 0.2794s/iter; left time: 10965.2471s
Epoch: 5 cost time: 114.5604043006897
Epoch: 5, Steps: 413 | Train Loss: 0.305 Vali Loss: 0.414 Vali Acc: 0.948 Test Loss: 0.414 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0000005
	speed: 0.5676s/iter; left time: 22213.6500s
	iters: 200, epoch: 6 | loss: 4.2151155
	speed: 0.2881s/iter; left time: 11247.9344s
	iters: 300, epoch: 6 | loss: 0.0347121
	speed: 0.2909s/iter; left time: 11326.2534s
	iters: 400, epoch: 6 | loss: 0.3296606
	speed: 0.2780s/iter; left time: 10796.9648s
Epoch: 6 cost time: 118.77729678153992
Epoch: 6, Steps: 413 | Train Loss: 0.355 Vali Loss: 0.760 Vali Acc: 0.930 Test Loss: 0.760 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0000054
	speed: 0.5621s/iter; left time: 21765.4675s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.2712s/iter; left time: 10475.7598s
	iters: 300, epoch: 7 | loss: 2.2726753
	speed: 0.2739s/iter; left time: 10552.4204s
	iters: 400, epoch: 7 | loss: 0.0615030
	speed: 0.2787s/iter; left time: 10707.4860s
Epoch: 7 cost time: 114.59136128425598
Epoch: 7, Steps: 413 | Train Loss: 0.272 Vali Loss: 0.298 Vali Acc: 0.969 Test Loss: 0.298 Test Acc: 0.969
Validation loss decreased (-0.964073 --> -0.969074).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.5899933
	speed: 0.5704s/iter; left time: 21853.3905s
	iters: 200, epoch: 8 | loss: 0.0000050
	speed: 0.2879s/iter; left time: 11001.3859s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.2777s/iter; left time: 10584.4833s
	iters: 400, epoch: 8 | loss: 2.5131624
	speed: 0.2949s/iter; left time: 11209.4594s
Epoch: 8 cost time: 118.87680840492249
Epoch: 8, Steps: 413 | Train Loss: 0.251 Vali Loss: 0.762 Vali Acc: 0.930 Test Loss: 0.762 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0146838
	speed: 0.5848s/iter; left time: 22160.4091s
	iters: 200, epoch: 9 | loss: 0.2974009
	speed: 0.2849s/iter; left time: 10767.6379s
	iters: 300, epoch: 9 | loss: 0.1938160
	speed: 0.2824s/iter; left time: 10646.8975s
	iters: 400, epoch: 9 | loss: 0.8828043
	speed: 0.2764s/iter; left time: 10391.4924s
Epoch: 9 cost time: 117.748774766922
Epoch: 9, Steps: 413 | Train Loss: 0.246 Vali Loss: 0.355 Vali Acc: 0.967 Test Loss: 0.355 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.5451s/iter; left time: 20434.0533s
	iters: 200, epoch: 10 | loss: 1.9450121
	speed: 0.2834s/iter; left time: 10596.3894s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.2945s/iter; left time: 10980.0545s
	iters: 400, epoch: 10 | loss: 0.0000005
	speed: 0.2857s/iter; left time: 10623.4524s
Epoch: 10 cost time: 118.00880408287048
Epoch: 10, Steps: 413 | Train Loss: 0.176 Vali Loss: 0.465 Vali Acc: 0.967 Test Loss: 0.465 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0001494
	speed: 0.5539s/iter; left time: 20532.9811s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.2891s/iter; left time: 10687.7665s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.2878s/iter; left time: 10611.6435s
	iters: 400, epoch: 11 | loss: 0.0000084
	speed: 0.2983s/iter; left time: 10968.1052s
Epoch: 11 cost time: 119.6517333984375
Epoch: 11, Steps: 413 | Train Loss: 0.216 Vali Loss: 1.237 Vali Acc: 0.927 Test Loss: 1.237 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.5643s/iter; left time: 20686.2452s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.2801s/iter; left time: 10238.8500s
	iters: 300, epoch: 12 | loss: 0.2240687
	speed: 0.2671s/iter; left time: 9736.9085s
	iters: 400, epoch: 12 | loss: 0.8136728
	speed: 0.2896s/iter; left time: 10530.5401s
Epoch: 12 cost time: 116.21156287193298
Epoch: 12, Steps: 413 | Train Loss: 0.202 Vali Loss: 0.598 Vali Acc: 0.948 Test Loss: 0.598 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0163820
	speed: 0.5518s/iter; left time: 19998.5773s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.2911s/iter; left time: 10521.7516s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.3087s/iter; left time: 11126.9778s
	iters: 400, epoch: 13 | loss: 0.0047040
	speed: 0.3151s/iter; left time: 11325.1851s
Epoch: 13 cost time: 123.43723320960999
Epoch: 13, Steps: 413 | Train Loss: 0.177 Vali Loss: 0.214 Vali Acc: 0.976 Test Loss: 0.214 Test Acc: 0.976
Validation loss decreased (-0.969074 --> -0.975896).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0602404
	speed: 0.5984s/iter; left time: 21441.4708s
	iters: 200, epoch: 14 | loss: 0.0009339
	speed: 0.2718s/iter; left time: 9711.4187s
	iters: 300, epoch: 14 | loss: 0.0000389
	speed: 0.2651s/iter; left time: 9447.1035s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.2736s/iter; left time: 9720.0194s
Epoch: 14 cost time: 113.91283917427063
Epoch: 14, Steps: 413 | Train Loss: 0.138 Vali Loss: 0.422 Vali Acc: 0.967 Test Loss: 0.422 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.2347611
	speed: 0.5546s/iter; left time: 19644.1918s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.2763s/iter; left time: 9759.4141s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.2694s/iter; left time: 9489.1144s
	iters: 400, epoch: 15 | loss: 0.0005501
	speed: 0.2895s/iter; left time: 10165.7175s
Epoch: 15 cost time: 115.84470081329346
Epoch: 15, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.229 Vali Acc: 0.976 Test Loss: 0.229 Test Acc: 0.976
Validation loss decreased (-0.975896 --> -0.976351).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0002444
	speed: 0.5826s/iter; left time: 20395.6128s
	iters: 200, epoch: 16 | loss: 0.6722541
	speed: 0.2788s/iter; left time: 9733.3106s
	iters: 300, epoch: 16 | loss: 0.0000001
	speed: 0.2767s/iter; left time: 9630.6923s
	iters: 400, epoch: 16 | loss: 0.0096777
	speed: 0.2718s/iter; left time: 9434.5030s
Epoch: 16 cost time: 116.284339427948
Epoch: 16, Steps: 413 | Train Loss: 0.133 Vali Loss: 0.272 Vali Acc: 0.982 Test Loss: 0.272 Test Acc: 0.982
Validation loss decreased (-0.976351 --> -0.982262).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.5595s/iter; left time: 19354.6542s
	iters: 200, epoch: 17 | loss: 1.0404398
	speed: 0.2768s/iter; left time: 9546.6959s
	iters: 300, epoch: 17 | loss: 0.0000099
	speed: 0.2793s/iter; left time: 9607.0595s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.2842s/iter; left time: 9745.3529s
Epoch: 17 cost time: 116.09578776359558
Epoch: 17, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.419 Vali Acc: 0.969 Test Loss: 0.419 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.5489s/iter; left time: 18762.4946s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.2855s/iter; left time: 9729.3415s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.2877s/iter; left time: 9774.5363s
	iters: 400, epoch: 18 | loss: 1.8397596
	speed: 0.2856s/iter; left time: 9676.6460s
Epoch: 18 cost time: 116.94077014923096
Epoch: 18, Steps: 413 | Train Loss: 0.125 Vali Loss: 0.296 Vali Acc: 0.976 Test Loss: 0.296 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.5479s/iter; left time: 18500.4616s
	iters: 200, epoch: 19 | loss: 0.0000712
	speed: 0.2710s/iter; left time: 9124.3420s
	iters: 300, epoch: 19 | loss: 0.0000001
	speed: 0.2800s/iter; left time: 9400.3993s
	iters: 400, epoch: 19 | loss: 0.0111640
	speed: 0.2942s/iter; left time: 9847.5636s
Epoch: 19 cost time: 116.50578379631042
Epoch: 19, Steps: 413 | Train Loss: 0.124 Vali Loss: 0.283 Vali Acc: 0.979 Test Loss: 0.283 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000018
	speed: 0.5315s/iter; left time: 17727.5271s
	iters: 200, epoch: 20 | loss: 1.5544870
	speed: 0.2714s/iter; left time: 9025.9056s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.2643s/iter; left time: 8761.9321s
	iters: 400, epoch: 20 | loss: 0.0027252
	speed: 0.2764s/iter; left time: 9135.1784s
Epoch: 20 cost time: 111.61765360832214
Epoch: 20, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.486 Vali Acc: 0.971 Test Loss: 0.486 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000001
	speed: 0.5606s/iter; left time: 18468.2564s
	iters: 200, epoch: 21 | loss: 0.0000004
	speed: 0.2780s/iter; left time: 9130.9207s
	iters: 300, epoch: 21 | loss: 0.0000006
	speed: 0.2817s/iter; left time: 9223.0733s
	iters: 400, epoch: 21 | loss: 0.0000017
	speed: 0.2819s/iter; left time: 9201.4676s
Epoch: 21 cost time: 115.77889084815979
Epoch: 21, Steps: 413 | Train Loss: 0.115 Vali Loss: 0.243 Vali Acc: 0.978 Test Loss: 0.243 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.5815s/iter; left time: 18915.0758s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.2708s/iter; left time: 8781.8705s
	iters: 300, epoch: 22 | loss: 0.0004104
	speed: 0.2750s/iter; left time: 8889.5007s
	iters: 400, epoch: 22 | loss: 0.2526996
	speed: 0.2752s/iter; left time: 8869.9311s
Epoch: 22 cost time: 115.09964084625244
Epoch: 22, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.453 Vali Acc: 0.973 Test Loss: 0.453 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.5626s/iter; left time: 18068.4899s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.2832s/iter; left time: 9066.6734s
	iters: 300, epoch: 23 | loss: 0.0996921
	speed: 0.2832s/iter; left time: 9037.5630s
	iters: 400, epoch: 23 | loss: 0.0000048
	speed: 0.2790s/iter; left time: 8876.2648s
Epoch: 23 cost time: 116.31594061851501
Epoch: 23, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.186 Vali Acc: 0.982 Test Loss: 0.186 Test Acc: 0.982
Validation loss decreased (-0.982262 --> -0.982263).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.1985617
	speed: 0.5828s/iter; left time: 18476.1163s
	iters: 200, epoch: 24 | loss: 0.1151493
	speed: 0.2893s/iter; left time: 9140.9232s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.2871s/iter; left time: 9044.5770s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.2734s/iter; left time: 8584.6498s
Epoch: 24 cost time: 119.39619731903076
Epoch: 24, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.156 Vali Acc: 0.985 Test Loss: 0.156 Test Acc: 0.985
Validation loss decreased (-0.982263 --> -0.985446).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0010281
	speed: 0.5513s/iter; left time: 17249.1379s
	iters: 200, epoch: 25 | loss: 0.0000001
	speed: 0.2834s/iter; left time: 8839.1097s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.2886s/iter; left time: 8973.3940s
	iters: 400, epoch: 25 | loss: 0.2548376
	speed: 0.2741s/iter; left time: 8493.7560s
Epoch: 25 cost time: 115.57699966430664
Epoch: 25, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.332 Vali Acc: 0.974 Test Loss: 0.332 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 2.2530694
	speed: 0.5668s/iter; left time: 17500.5749s
	iters: 200, epoch: 26 | loss: 0.0000003
	speed: 0.2907s/iter; left time: 8946.3099s
	iters: 300, epoch: 26 | loss: 0.0000002
	speed: 0.3069s/iter; left time: 9413.8441s
	iters: 400, epoch: 26 | loss: 0.0000001
	speed: 0.2928s/iter; left time: 8954.1353s
Epoch: 26 cost time: 121.87403607368469
Epoch: 26, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.266 Vali Acc: 0.972 Test Loss: 0.266 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0000002
	speed: 0.5667s/iter; left time: 17262.9175s
	iters: 200, epoch: 27 | loss: 0.0109950
	speed: 0.2768s/iter; left time: 8405.8268s
	iters: 300, epoch: 27 | loss: 0.0000002
	speed: 0.2823s/iter; left time: 8543.4562s
	iters: 400, epoch: 27 | loss: 0.0000001
	speed: 0.2843s/iter; left time: 8574.7364s
Epoch: 27 cost time: 115.72682976722717
Epoch: 27, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.108 Vali Acc: 0.989 Test Loss: 0.108 Test Acc: 0.989
Validation loss decreased (-0.985446 --> -0.989085).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.5429s/iter; left time: 16314.9486s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.2704s/iter; left time: 8098.5278s
	iters: 300, epoch: 28 | loss: 0.0000002
	speed: 0.2855s/iter; left time: 8521.2443s
	iters: 400, epoch: 28 | loss: 0.0000017
	speed: 0.2832s/iter; left time: 8424.8208s
Epoch: 28 cost time: 113.99196290969849
Epoch: 28, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.264 Vali Acc: 0.983 Test Loss: 0.264 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0000413
	speed: 0.5832s/iter; left time: 17285.0715s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.2748s/iter; left time: 8117.5209s
	iters: 300, epoch: 29 | loss: 0.0004338
	speed: 0.2763s/iter; left time: 8133.7384s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.2793s/iter; left time: 8194.8801s
Epoch: 29 cost time: 116.89141154289246
Epoch: 29, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.335 Vali Acc: 0.967 Test Loss: 0.335 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.5484s/iter; left time: 16025.1729s
	iters: 200, epoch: 30 | loss: 0.0000115
	speed: 0.2984s/iter; left time: 8689.6783s
	iters: 300, epoch: 30 | loss: 0.2360462
	speed: 0.2814s/iter; left time: 8167.1620s
	iters: 400, epoch: 30 | loss: 0.0014924
	speed: 0.2682s/iter; left time: 7758.8554s
Epoch: 30 cost time: 116.94203209877014
Epoch: 30, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.204 Vali Acc: 0.977 Test Loss: 0.204 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.0000001
	speed: 0.5634s/iter; left time: 16230.9908s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.2810s/iter; left time: 8067.9518s
	iters: 300, epoch: 31 | loss: 0.0000009
	speed: 0.2673s/iter; left time: 7647.4403s
	iters: 400, epoch: 31 | loss: 0.0001564
	speed: 0.2653s/iter; left time: 7562.7047s
Epoch: 31 cost time: 114.39429831504822
Epoch: 31, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.225 Vali Acc: 0.976 Test Loss: 0.225 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 1.3826191
	speed: 0.5513s/iter; left time: 15655.9547s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.2709s/iter; left time: 7664.8811s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.2671s/iter; left time: 7530.7462s
	iters: 400, epoch: 32 | loss: 0.0095146
	speed: 0.2781s/iter; left time: 7814.7695s
Epoch: 32 cost time: 113.28846335411072
Epoch: 32, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.373 Vali Acc: 0.960 Test Loss: 0.373 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.0000007
	speed: 0.5612s/iter; left time: 15705.5900s
	iters: 200, epoch: 33 | loss: 0.0000896
	speed: 0.2742s/iter; left time: 7646.4090s
	iters: 300, epoch: 33 | loss: 0.0000027
	speed: 0.2769s/iter; left time: 7693.1598s
	iters: 400, epoch: 33 | loss: 0.0000006
	speed: 0.2780s/iter; left time: 7697.1425s
Epoch: 33 cost time: 115.15684032440186
Epoch: 33, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.141 Vali Acc: 0.982 Test Loss: 0.141 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.5766s/iter; left time: 15898.0094s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.2671s/iter; left time: 7337.5566s
	iters: 300, epoch: 34 | loss: 0.0003982
	speed: 0.2752s/iter; left time: 7532.4644s
	iters: 400, epoch: 34 | loss: 0.0000041
	speed: 0.2747s/iter; left time: 7492.1033s
Epoch: 34 cost time: 114.79139137268066
Epoch: 34, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.988 Test Loss: 0.102 Test Acc: 0.988
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.5839s/iter; left time: 15857.3046s
	iters: 200, epoch: 35 | loss: 0.0008037
	speed: 0.2724s/iter; left time: 7370.8447s
	iters: 300, epoch: 35 | loss: 0.1827388
	speed: 0.2926s/iter; left time: 7888.3616s
	iters: 400, epoch: 35 | loss: 0.0008273
	speed: 0.3014s/iter; left time: 8096.1894s
Epoch: 35 cost time: 120.69766902923584
Epoch: 35, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.206 Vali Acc: 0.975 Test Loss: 0.206 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 0.0000157
	speed: 0.5911s/iter; left time: 15808.4987s
	iters: 200, epoch: 36 | loss: 0.0000010
	speed: 0.2904s/iter; left time: 7737.0350s
	iters: 300, epoch: 36 | loss: 0.0000526
	speed: 0.3079s/iter; left time: 8172.7880s
	iters: 400, epoch: 36 | loss: 0.0000011
	speed: 0.2955s/iter; left time: 7814.2610s
Epoch: 36 cost time: 122.87867522239685
Epoch: 36, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.128 Vali Acc: 0.981 Test Loss: 0.128 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 0.0000077
	speed: 0.5798s/iter; left time: 15268.1162s
	iters: 200, epoch: 37 | loss: 0.0000023
	speed: 0.2744s/iter; left time: 7199.5912s
	iters: 300, epoch: 37 | loss: 0.0000001
	speed: 0.2770s/iter; left time: 7237.5513s
	iters: 400, epoch: 37 | loss: 0.0000003
	speed: 0.2937s/iter; left time: 7646.6081s
Epoch: 37 cost time: 117.46903467178345
Epoch: 37, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.072 Vali Acc: 0.988 Test Loss: 0.072 Test Acc: 0.988
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df128_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9890859481582538
model parameter : 10220554
model size : 58.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df128_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6044961
	speed: 0.2915s/iter; left time: 12011.5882s
	iters: 200, epoch: 1 | loss: 0.0969610
	speed: 0.2965s/iter; left time: 12184.6531s
	iters: 300, epoch: 1 | loss: 0.4586539
	speed: 0.3045s/iter; left time: 12485.2869s
	iters: 400, epoch: 1 | loss: 0.1124013
	speed: 0.2952s/iter; left time: 12075.1551s
Epoch: 1 cost time: 122.71065711975098
Epoch: 1, Steps: 413 | Train Loss: 0.540 Vali Loss: 0.118 Vali Acc: 0.964 Test Loss: 0.118 Test Acc: 0.964
Validation loss decreased (inf --> -0.964073).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6114932
	speed: 0.5865s/iter; left time: 23922.9835s
	iters: 200, epoch: 2 | loss: 0.0019808
	speed: 0.3085s/iter; left time: 12551.8953s
	iters: 300, epoch: 2 | loss: 1.6633803
	speed: 0.2934s/iter; left time: 11907.1867s
	iters: 400, epoch: 2 | loss: 0.0206617
	speed: 0.2799s/iter; left time: 11333.2665s
Epoch: 2 cost time: 122.18188047409058
Epoch: 2, Steps: 413 | Train Loss: 0.229 Vali Loss: 0.537 Vali Acc: 0.943 Test Loss: 0.537 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0049042
	speed: 0.5692s/iter; left time: 22979.5259s
	iters: 200, epoch: 3 | loss: 0.0154427
	speed: 0.3057s/iter; left time: 12310.7982s
	iters: 300, epoch: 3 | loss: 0.1797831
	speed: 0.2812s/iter; left time: 11295.5578s
	iters: 400, epoch: 3 | loss: 0.0018153
	speed: 0.2827s/iter; left time: 11328.4035s
Epoch: 3 cost time: 120.82815337181091
Epoch: 3, Steps: 413 | Train Loss: 0.325 Vali Loss: 0.641 Vali Acc: 0.925 Test Loss: 0.641 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.9577950
	speed: 0.5882s/iter; left time: 23506.4926s
	iters: 200, epoch: 4 | loss: 0.0000017
	speed: 0.2975s/iter; left time: 11858.3510s
	iters: 300, epoch: 4 | loss: 0.0247849
	speed: 0.2913s/iter; left time: 11581.3451s
	iters: 400, epoch: 4 | loss: 0.0017777
	speed: 0.2829s/iter; left time: 11221.7377s
Epoch: 4 cost time: 121.57781100273132
Epoch: 4, Steps: 413 | Train Loss: 0.306 Vali Loss: 0.327 Vali Acc: 0.959 Test Loss: 0.327 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.2912048
	speed: 0.6090s/iter; left time: 24083.6104s
	iters: 200, epoch: 5 | loss: 0.6989774
	speed: 0.3059s/iter; left time: 12066.9863s
	iters: 300, epoch: 5 | loss: 0.0000021
	speed: 0.2966s/iter; left time: 11670.8498s
	iters: 400, epoch: 5 | loss: 0.0000084
	speed: 0.2970s/iter; left time: 11656.2200s
Epoch: 5 cost time: 125.05141162872314
Epoch: 5, Steps: 413 | Train Loss: 0.350 Vali Loss: 0.509 Vali Acc: 0.950 Test Loss: 0.509 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.4131015
	speed: 0.5837s/iter; left time: 22845.5658s
	iters: 200, epoch: 6 | loss: 0.5447332
	speed: 0.2809s/iter; left time: 10966.3100s
	iters: 300, epoch: 6 | loss: 0.6446071
	speed: 0.2803s/iter; left time: 10915.0348s
	iters: 400, epoch: 6 | loss: 0.0000007
	speed: 0.2898s/iter; left time: 11252.7562s
Epoch: 6 cost time: 118.66431331634521
Epoch: 6, Steps: 413 | Train Loss: 0.257 Vali Loss: 0.574 Vali Acc: 0.943 Test Loss: 0.574 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0000228
	speed: 0.5791s/iter; left time: 22425.0619s
	iters: 200, epoch: 7 | loss: 0.2850119
	speed: 0.2861s/iter; left time: 11051.3425s
	iters: 300, epoch: 7 | loss: 2.2066960
	speed: 0.2983s/iter; left time: 11490.7557s
	iters: 400, epoch: 7 | loss: 0.0120190
	speed: 0.3021s/iter; left time: 11607.6569s
Epoch: 7 cost time: 122.28175210952759
Epoch: 7, Steps: 413 | Train Loss: 0.246 Vali Loss: 0.387 Vali Acc: 0.970 Test Loss: 0.387 Test Acc: 0.970
Validation loss decreased (-0.964073 --> -0.969528).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.4800050
	speed: 0.5978s/iter; left time: 22901.1781s
	iters: 200, epoch: 8 | loss: 1.1159983
	speed: 0.2833s/iter; left time: 10826.7436s
	iters: 300, epoch: 8 | loss: 0.0000705
	speed: 0.2704s/iter; left time: 10306.3150s
	iters: 400, epoch: 8 | loss: 0.2776360
	speed: 0.2963s/iter; left time: 11261.3523s
Epoch: 8 cost time: 117.47378921508789
Epoch: 8, Steps: 413 | Train Loss: 0.211 Vali Loss: 0.598 Vali Acc: 0.952 Test Loss: 0.598 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0873290
	speed: 0.5594s/iter; left time: 21199.9257s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.2862s/iter; left time: 10818.6957s
	iters: 300, epoch: 9 | loss: 0.1123144
	speed: 0.2911s/iter; left time: 10973.7626s
	iters: 400, epoch: 9 | loss: 0.0497192
	speed: 0.3016s/iter; left time: 11340.5397s
Epoch: 9 cost time: 120.2062509059906
Epoch: 9, Steps: 413 | Train Loss: 0.183 Vali Loss: 0.400 Vali Acc: 0.965 Test Loss: 0.400 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0019374
	speed: 0.5657s/iter; left time: 21206.4062s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.2774s/iter; left time: 10371.1838s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.2904s/iter; left time: 10826.8624s
	iters: 400, epoch: 10 | loss: 0.0003550
	speed: 0.2932s/iter; left time: 10901.7442s
Epoch: 10 cost time: 118.12941646575928
Epoch: 10, Steps: 413 | Train Loss: 0.189 Vali Loss: 0.414 Vali Acc: 0.958 Test Loss: 0.414 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000290
	speed: 0.5452s/iter; left time: 20210.8440s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.2851s/iter; left time: 10542.0029s
	iters: 300, epoch: 11 | loss: 0.0000014
	speed: 0.2888s/iter; left time: 10647.0560s
	iters: 400, epoch: 11 | loss: 0.0592092
	speed: 0.2869s/iter; left time: 10549.9346s
Epoch: 11 cost time: 117.43352317810059
Epoch: 11, Steps: 413 | Train Loss: 0.201 Vali Loss: 0.413 Vali Acc: 0.957 Test Loss: 0.413 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.5631s/iter; left time: 20642.9419s
	iters: 200, epoch: 12 | loss: 0.0000001
	speed: 0.2841s/iter; left time: 10384.8685s
	iters: 300, epoch: 12 | loss: 1.1110331
	speed: 0.2884s/iter; left time: 10514.6977s
	iters: 400, epoch: 12 | loss: 0.5804261
	speed: 0.2914s/iter; left time: 10595.2093s
Epoch: 12 cost time: 118.6031973361969
Epoch: 12, Steps: 413 | Train Loss: 0.175 Vali Loss: 0.346 Vali Acc: 0.972 Test Loss: 0.346 Test Acc: 0.972
Validation loss decreased (-0.969528 --> -0.972257).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000722
	speed: 0.5467s/iter; left time: 19815.7364s
	iters: 200, epoch: 13 | loss: 0.0012406
	speed: 0.2870s/iter; left time: 10373.9861s
	iters: 300, epoch: 13 | loss: 0.0000004
	speed: 0.2843s/iter; left time: 10246.4113s
	iters: 400, epoch: 13 | loss: 0.0000368
	speed: 0.2759s/iter; left time: 9916.2244s
Epoch: 13 cost time: 115.59663653373718
Epoch: 13, Steps: 413 | Train Loss: 0.201 Vali Loss: 0.396 Vali Acc: 0.965 Test Loss: 0.396 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.0539162
	speed: 0.5711s/iter; left time: 20463.7620s
	iters: 200, epoch: 14 | loss: 0.0012216
	speed: 0.3013s/iter; left time: 10766.7811s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.2984s/iter; left time: 10632.7238s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.2926s/iter; left time: 10396.5145s
Epoch: 14 cost time: 122.04431343078613
Epoch: 14, Steps: 413 | Train Loss: 0.149 Vali Loss: 0.453 Vali Acc: 0.966 Test Loss: 0.453 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.5686s/iter; left time: 20138.8148s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.2848s/iter; left time: 10060.0139s
	iters: 300, epoch: 15 | loss: 0.0000001
	speed: 0.2882s/iter; left time: 10150.0085s
	iters: 400, epoch: 15 | loss: 0.0380355
	speed: 0.2775s/iter; left time: 9745.5663s
Epoch: 15 cost time: 117.5310583114624
Epoch: 15, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.405 Vali Acc: 0.975 Test Loss: 0.405 Test Acc: 0.975
Validation loss decreased (-0.972257 --> -0.974530).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.5829s/iter; left time: 20403.9281s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.3083s/iter; left time: 10762.6018s
	iters: 300, epoch: 16 | loss: 0.0000194
	speed: 0.2981s/iter; left time: 10374.8939s
	iters: 400, epoch: 16 | loss: 0.0006872
	speed: 0.2993s/iter; left time: 10386.4218s
Epoch: 16 cost time: 125.39612174034119
Epoch: 16, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.440 Vali Acc: 0.975 Test Loss: 0.440 Test Acc: 0.975
Validation loss decreased (-0.974530 --> -0.975439).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.0094696
	speed: 0.6168s/iter; left time: 21336.0259s
	iters: 200, epoch: 17 | loss: 0.0004653
	speed: 0.3007s/iter; left time: 10371.5012s
	iters: 300, epoch: 17 | loss: 2.0159307
	speed: 0.2928s/iter; left time: 10071.5494s
	iters: 400, epoch: 17 | loss: 0.0030851
	speed: 0.2843s/iter; left time: 9749.2078s
Epoch: 17 cost time: 122.98594999313354
Epoch: 17, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.471 Vali Acc: 0.949 Test Loss: 0.471 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000001
	speed: 0.5689s/iter; left time: 19443.9511s
	iters: 200, epoch: 18 | loss: 0.0000029
	speed: 0.2768s/iter; left time: 9433.9932s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.2788s/iter; left time: 9473.0749s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.2653s/iter; left time: 8986.7376s
Epoch: 18 cost time: 115.7427875995636
Epoch: 18, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.579 Vali Acc: 0.961 Test Loss: 0.579 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000003
	speed: 0.5902s/iter; left time: 19928.4178s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.2901s/iter; left time: 9765.9154s
	iters: 300, epoch: 19 | loss: 0.0002158
	speed: 0.2938s/iter; left time: 9860.8980s
	iters: 400, epoch: 19 | loss: 0.2683915
	speed: 0.2873s/iter; left time: 9616.2274s
Epoch: 19 cost time: 120.8723874092102
Epoch: 19, Steps: 413 | Train Loss: 0.126 Vali Loss: 0.306 Vali Acc: 0.970 Test Loss: 0.306 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000001
	speed: 0.5967s/iter; left time: 19903.1238s
	iters: 200, epoch: 20 | loss: 0.0000321
	speed: 0.2877s/iter; left time: 9568.5146s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.2761s/iter; left time: 9154.2743s
	iters: 400, epoch: 20 | loss: 0.0289557
	speed: 0.2847s/iter; left time: 9409.0604s
Epoch: 20 cost time: 119.22998762130737
Epoch: 20, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.363 Vali Acc: 0.972 Test Loss: 0.363 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.1489699
	speed: 0.5547s/iter; left time: 18273.3338s
	iters: 200, epoch: 21 | loss: 0.7513051
	speed: 0.2864s/iter; left time: 9405.1950s
	iters: 300, epoch: 21 | loss: 0.0003893
	speed: 0.2857s/iter; left time: 9353.1978s
	iters: 400, epoch: 21 | loss: 0.0005978
	speed: 0.2980s/iter; left time: 9726.8595s
Epoch: 21 cost time: 119.77864098548889
Epoch: 21, Steps: 413 | Train Loss: 0.139 Vali Loss: 0.182 Vali Acc: 0.980 Test Loss: 0.182 Test Acc: 0.980
Validation loss decreased (-0.975439 --> -0.979534).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0023384
	speed: 0.5637s/iter; left time: 18334.4617s
	iters: 200, epoch: 22 | loss: 0.0000033
	speed: 0.2946s/iter; left time: 9552.4060s
	iters: 300, epoch: 22 | loss: 0.0000001
	speed: 0.2946s/iter; left time: 9524.7151s
	iters: 400, epoch: 22 | loss: 0.0000581
	speed: 0.2855s/iter; left time: 9200.7745s
Epoch: 22 cost time: 120.11486649513245
Epoch: 22, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.260 Vali Acc: 0.973 Test Loss: 0.260 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0000338
	speed: 0.6324s/iter; left time: 20310.6719s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.3103s/iter; left time: 9934.6883s
	iters: 300, epoch: 23 | loss: 0.0000008
	speed: 0.2965s/iter; left time: 9461.9678s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.2958s/iter; left time: 9410.9232s
Epoch: 23 cost time: 128.31207466125488
Epoch: 23, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.217 Vali Acc: 0.978 Test Loss: 0.217 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.6173s/iter; left time: 19569.0847s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.2815s/iter; left time: 8896.7738s
	iters: 300, epoch: 24 | loss: 0.0000521
	speed: 0.2938s/iter; left time: 9254.0182s
	iters: 400, epoch: 24 | loss: 0.0000134
	speed: 0.3008s/iter; left time: 9444.1931s
Epoch: 24 cost time: 123.99865674972534
Epoch: 24, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.336 Vali Acc: 0.967 Test Loss: 0.336 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0000288
	speed: 0.6042s/iter; left time: 18906.2780s
	iters: 200, epoch: 25 | loss: 0.0001531
	speed: 0.3170s/iter; left time: 9888.2316s
	iters: 300, epoch: 25 | loss: 0.0004613
	speed: 0.3139s/iter; left time: 9759.0286s
	iters: 400, epoch: 25 | loss: 0.0157828
	speed: 0.3032s/iter; left time: 9396.0515s
Epoch: 25 cost time: 129.14881229400635
Epoch: 25, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.348 Vali Acc: 0.968 Test Loss: 0.348 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0007116
	speed: 0.5974s/iter; left time: 18443.9497s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.3063s/iter; left time: 9426.4576s
	iters: 300, epoch: 26 | loss: 0.3024620
	speed: 0.2910s/iter; left time: 8925.6080s
	iters: 400, epoch: 26 | loss: 0.0000007
	speed: 0.2837s/iter; left time: 8673.1911s
Epoch: 26 cost time: 123.68274354934692
Epoch: 26, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.172 Vali Acc: 0.976 Test Loss: 0.172 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0001083
	speed: 0.5910s/iter; left time: 18002.9554s
	iters: 200, epoch: 27 | loss: 0.0000017
	speed: 0.3017s/iter; left time: 9160.6283s
	iters: 300, epoch: 27 | loss: 0.0023305
	speed: 0.3133s/iter; left time: 9480.6325s
	iters: 400, epoch: 27 | loss: 0.0007527
	speed: 0.3258s/iter; left time: 9827.5384s
Epoch: 27 cost time: 128.3561248779297
Epoch: 27, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.253 Vali Acc: 0.971 Test Loss: 0.253 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0000185
	speed: 0.6051s/iter; left time: 18184.5697s
	iters: 200, epoch: 28 | loss: 0.0000034
	speed: 0.3008s/iter; left time: 9009.7455s
	iters: 300, epoch: 28 | loss: 0.1877051
	speed: 0.2921s/iter; left time: 8718.8175s
	iters: 400, epoch: 28 | loss: 0.0003533
	speed: 0.2932s/iter; left time: 8723.8157s
Epoch: 28 cost time: 123.67020440101624
Epoch: 28, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.363 Vali Acc: 0.960 Test Loss: 0.363 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0000004
	speed: 0.6094s/iter; left time: 18060.4592s
	iters: 200, epoch: 29 | loss: 0.0000130
	speed: 0.3028s/iter; left time: 8943.6081s
	iters: 300, epoch: 29 | loss: 0.0000275
	speed: 0.3275s/iter; left time: 9639.1712s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.3198s/iter; left time: 9382.3786s
Epoch: 29 cost time: 130.2588815689087
Epoch: 29, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.207 Vali Acc: 0.968 Test Loss: 0.207 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0000007
	speed: 0.5974s/iter; left time: 17457.8944s
	iters: 200, epoch: 30 | loss: 0.0000009
	speed: 0.2963s/iter; left time: 8628.0863s
	iters: 300, epoch: 30 | loss: 0.0016157
	speed: 0.2825s/iter; left time: 8199.1649s
	iters: 400, epoch: 30 | loss: 0.0001362
	speed: 0.2907s/iter; left time: 8408.7061s
Epoch: 30 cost time: 121.1893663406372
Epoch: 30, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.274 Vali Acc: 0.970 Test Loss: 0.274 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0000001
	speed: 0.6000s/iter; left time: 17287.7254s
	iters: 200, epoch: 31 | loss: 0.0000033
	speed: 0.2886s/iter; left time: 8285.2168s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.2867s/iter; left time: 8202.1178s
	iters: 400, epoch: 31 | loss: 0.0140653
	speed: 0.2992s/iter; left time: 8529.8695s
Epoch: 31 cost time: 122.42951846122742
Epoch: 31, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.211 Vali Acc: 0.966 Test Loss: 0.211 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df128_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9795361527967258
model parameter : 10220554
model size : 58.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6626032
	speed: 0.3131s/iter; left time: 12900.5230s
	iters: 200, epoch: 1 | loss: 0.2648030
	speed: 0.3105s/iter; left time: 12762.2514s
	iters: 300, epoch: 1 | loss: 0.2326215
	speed: 0.3081s/iter; left time: 12633.8866s
	iters: 400, epoch: 1 | loss: 0.0597074
	speed: 0.2869s/iter; left time: 11732.6507s
Epoch: 1 cost time: 125.7472357749939
Epoch: 1, Steps: 413 | Train Loss: 0.544 Vali Loss: 0.331 Vali Acc: 0.922 Test Loss: 0.331 Test Acc: 0.922
Validation loss decreased (inf --> -0.921779).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1290572
	speed: 0.5907s/iter; left time: 24093.3944s
	iters: 200, epoch: 2 | loss: 0.0000433
	speed: 0.2963s/iter; left time: 12056.6257s
	iters: 300, epoch: 2 | loss: 2.3243203
	speed: 0.3015s/iter; left time: 12238.8005s
	iters: 400, epoch: 2 | loss: 0.0000207
	speed: 0.3179s/iter; left time: 12872.1546s
Epoch: 2 cost time: 127.19657945632935
Epoch: 2, Steps: 413 | Train Loss: 0.231 Vali Loss: 0.548 Vali Acc: 0.927 Test Loss: 0.548 Test Acc: 0.927
Validation loss decreased (-0.921779 --> -0.926779).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5049055
	speed: 0.7009s/iter; left time: 28299.3044s
	iters: 200, epoch: 3 | loss: 0.0113155
	speed: 0.3221s/iter; left time: 12972.3172s
	iters: 300, epoch: 3 | loss: 0.8080716
	speed: 0.3362s/iter; left time: 13508.4449s
	iters: 400, epoch: 3 | loss: 0.2346680
	speed: 0.3277s/iter; left time: 13133.7511s
Epoch: 3 cost time: 135.74949955940247
Epoch: 3, Steps: 413 | Train Loss: 0.317 Vali Loss: 0.679 Vali Acc: 0.931 Test Loss: 0.679 Test Acc: 0.931
Validation loss decreased (-0.926779 --> -0.930871).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0801685
	speed: 0.6524s/iter; left time: 26071.1323s
	iters: 200, epoch: 4 | loss: 0.0000678
	speed: 0.3058s/iter; left time: 12188.4032s
	iters: 300, epoch: 4 | loss: 0.0000010
	speed: 0.2948s/iter; left time: 11721.0965s
	iters: 400, epoch: 4 | loss: 1.1757438
	speed: 0.3025s/iter; left time: 11996.7034s
Epoch: 4 cost time: 128.14864110946655
Epoch: 4, Steps: 413 | Train Loss: 0.246 Vali Loss: 0.379 Vali Acc: 0.948 Test Loss: 0.379 Test Acc: 0.948
Validation loss decreased (-0.930871 --> -0.948154).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.8637744
	speed: 0.6463s/iter; left time: 25562.1084s
	iters: 200, epoch: 5 | loss: 0.1316788
	speed: 0.3149s/iter; left time: 12421.1140s
	iters: 300, epoch: 5 | loss: 0.0288227
	speed: 0.3246s/iter; left time: 12773.3538s
	iters: 400, epoch: 5 | loss: 0.0890431
	speed: 0.3189s/iter; left time: 12516.1714s
Epoch: 5 cost time: 132.97436141967773
Epoch: 5, Steps: 413 | Train Loss: 0.310 Vali Loss: 0.257 Vali Acc: 0.966 Test Loss: 0.257 Test Acc: 0.966
Validation loss decreased (-0.948154 --> -0.965891).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.6022s/iter; left time: 23569.0398s
	iters: 200, epoch: 6 | loss: 0.2346377
	speed: 0.3026s/iter; left time: 11811.6875s
	iters: 300, epoch: 6 | loss: 0.0330327
	speed: 0.2803s/iter; left time: 10914.0376s
	iters: 400, epoch: 6 | loss: 1.6608975
	speed: 0.2928s/iter; left time: 11372.3901s
Epoch: 6 cost time: 122.3462541103363
Epoch: 6, Steps: 413 | Train Loss: 0.278 Vali Loss: 0.396 Vali Acc: 0.955 Test Loss: 0.396 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000032
	speed: 0.6083s/iter; left time: 23554.1350s
	iters: 200, epoch: 7 | loss: 0.0000004
	speed: 0.2955s/iter; left time: 11413.3257s
	iters: 300, epoch: 7 | loss: 5.0990162
	speed: 0.2973s/iter; left time: 11453.0197s
	iters: 400, epoch: 7 | loss: 0.3763928
	speed: 0.3102s/iter; left time: 11917.2181s
Epoch: 7 cost time: 125.01135325431824
Epoch: 7, Steps: 413 | Train Loss: 0.273 Vali Loss: 0.207 Vali Acc: 0.974 Test Loss: 0.207 Test Acc: 0.974
Validation loss decreased (-0.965891 --> -0.974077).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000001
	speed: 0.6201s/iter; left time: 23755.4557s
	iters: 200, epoch: 8 | loss: 0.0832519
	speed: 0.3302s/iter; left time: 12617.9055s
	iters: 300, epoch: 8 | loss: 1.0335674
	speed: 0.3175s/iter; left time: 12100.1880s
	iters: 400, epoch: 8 | loss: 0.0003572
	speed: 0.3023s/iter; left time: 11489.0318s
Epoch: 8 cost time: 131.1151463985443
Epoch: 8, Steps: 413 | Train Loss: 0.182 Vali Loss: 0.233 Vali Acc: 0.973 Test Loss: 0.233 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.6180s/iter; left time: 23420.9025s
	iters: 200, epoch: 9 | loss: 0.0001950
	speed: 0.3017s/iter; left time: 11403.2608s
	iters: 300, epoch: 9 | loss: 0.0029925
	speed: 0.2904s/iter; left time: 10947.5248s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.3107s/iter; left time: 11682.8765s
Epoch: 9 cost time: 125.9600477218628
Epoch: 9, Steps: 413 | Train Loss: 0.204 Vali Loss: 0.334 Vali Acc: 0.969 Test Loss: 0.334 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.5758s/iter; left time: 21581.6458s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.3101s/iter; left time: 11594.5484s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.3027s/iter; left time: 11287.5885s
	iters: 400, epoch: 10 | loss: 0.6541110
	speed: 0.2889s/iter; left time: 10743.6893s
Epoch: 10 cost time: 123.27237033843994
Epoch: 10, Steps: 413 | Train Loss: 0.170 Vali Loss: 0.698 Vali Acc: 0.955 Test Loss: 0.698 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000001
	speed: 0.5891s/iter; left time: 21837.6447s
	iters: 200, epoch: 11 | loss: 0.0000005
	speed: 0.3072s/iter; left time: 11357.9460s
	iters: 300, epoch: 11 | loss: 0.0145324
	speed: 0.2887s/iter; left time: 10646.3072s
	iters: 400, epoch: 11 | loss: 0.0000751
	speed: 0.3108s/iter; left time: 11428.4554s
Epoch: 11 cost time: 125.41078519821167
Epoch: 11, Steps: 413 | Train Loss: 0.204 Vali Loss: 0.532 Vali Acc: 0.960 Test Loss: 0.532 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.5946s/iter; left time: 21796.8697s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.3084s/iter; left time: 11275.0781s
	iters: 300, epoch: 12 | loss: 0.9112512
	speed: 0.2901s/iter; left time: 10577.1100s
	iters: 400, epoch: 12 | loss: 0.8061890
	speed: 0.3175s/iter; left time: 11542.9123s
Epoch: 12 cost time: 126.39442324638367
Epoch: 12, Steps: 413 | Train Loss: 0.168 Vali Loss: 0.304 Vali Acc: 0.970 Test Loss: 0.304 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000316
	speed: 0.5853s/iter; left time: 21215.8003s
	iters: 200, epoch: 13 | loss: 0.0000091
	speed: 0.2967s/iter; left time: 10722.6186s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.3011s/iter; left time: 10854.0118s
	iters: 400, epoch: 13 | loss: 0.0055545
	speed: 0.3185s/iter; left time: 11447.7385s
Epoch: 13 cost time: 125.27401280403137
Epoch: 13, Steps: 413 | Train Loss: 0.135 Vali Loss: 0.305 Vali Acc: 0.975 Test Loss: 0.305 Test Acc: 0.975
Validation loss decreased (-0.974077 --> -0.975440).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0002025
	speed: 0.5833s/iter; left time: 20899.0401s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.3076s/iter; left time: 10992.6518s
	iters: 300, epoch: 14 | loss: 0.6899008
	speed: 0.2988s/iter; left time: 10645.3832s
	iters: 400, epoch: 14 | loss: 0.0026247
	speed: 0.2996s/iter; left time: 10646.7333s
Epoch: 14 cost time: 124.6279411315918
Epoch: 14, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.609 Vali Acc: 0.956 Test Loss: 0.609 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000002
	speed: 0.5841s/iter; left time: 20689.1573s
	iters: 200, epoch: 15 | loss: 0.0000011
	speed: 0.3138s/iter; left time: 11083.2098s
	iters: 300, epoch: 15 | loss: 1.1635844
	speed: 0.3172s/iter; left time: 11169.9577s
	iters: 400, epoch: 15 | loss: 0.0000442
	speed: 0.3143s/iter; left time: 11037.4105s
Epoch: 15 cost time: 128.9302339553833
Epoch: 15, Steps: 413 | Train Loss: 0.125 Vali Loss: 0.300 Vali Acc: 0.970 Test Loss: 0.300 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0002736
	speed: 0.6024s/iter; left time: 21087.6758s
	iters: 200, epoch: 16 | loss: 0.0000289
	speed: 0.3017s/iter; left time: 10530.0282s
	iters: 300, epoch: 16 | loss: 0.0004236
	speed: 0.2998s/iter; left time: 10433.5258s
	iters: 400, epoch: 16 | loss: 0.0238941
	speed: 0.3164s/iter; left time: 10980.0275s
Epoch: 16 cost time: 127.20204496383667
Epoch: 16, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.297 Vali Acc: 0.973 Test Loss: 0.297 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0454906
	speed: 0.5920s/iter; left time: 20478.5682s
	iters: 200, epoch: 17 | loss: 0.1653010
	speed: 0.2988s/iter; left time: 10307.2865s
	iters: 300, epoch: 17 | loss: 1.8889885
	speed: 0.2972s/iter; left time: 10221.0406s
	iters: 400, epoch: 17 | loss: 0.0094996
	speed: 0.3167s/iter; left time: 10859.5956s
Epoch: 17 cost time: 126.61069583892822
Epoch: 17, Steps: 413 | Train Loss: 0.133 Vali Loss: 0.257 Vali Acc: 0.975 Test Loss: 0.257 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.5863s/iter; left time: 20040.0798s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.2903s/iter; left time: 9893.1608s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.2815s/iter; left time: 9565.2855s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.3017s/iter; left time: 10221.5141s
Epoch: 18 cost time: 120.85895276069641
Epoch: 18, Steps: 413 | Train Loss: 0.112 Vali Loss: 0.250 Vali Acc: 0.974 Test Loss: 0.250 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0000067
	speed: 0.5701s/iter; left time: 19250.3905s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.2867s/iter; left time: 9653.3686s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.2750s/iter; left time: 9230.3180s
	iters: 400, epoch: 19 | loss: 2.6135435
	speed: 0.2863s/iter; left time: 9581.4861s
Epoch: 19 cost time: 116.9431848526001
Epoch: 19, Steps: 413 | Train Loss: 0.125 Vali Loss: 0.919 Vali Acc: 0.937 Test Loss: 0.919 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0000097
	speed: 0.5203s/iter; left time: 17355.2844s
	iters: 200, epoch: 20 | loss: 0.0624558
	speed: 0.2762s/iter; left time: 9184.1083s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.2694s/iter; left time: 8933.1348s
	iters: 400, epoch: 20 | loss: 0.3023771
	speed: 0.2776s/iter; left time: 9174.2701s
Epoch: 20 cost time: 111.73523187637329
Epoch: 20, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.555 Vali Acc: 0.963 Test Loss: 0.555 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0018660
	speed: 0.5407s/iter; left time: 17811.0198s
	iters: 200, epoch: 21 | loss: 0.0002426
	speed: 0.2740s/iter; left time: 8999.3262s
	iters: 300, epoch: 21 | loss: 0.0129947
	speed: 0.2808s/iter; left time: 9194.4798s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.2690s/iter; left time: 8781.8844s
Epoch: 21 cost time: 113.54208850860596
Epoch: 21, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.412 Vali Acc: 0.960 Test Loss: 0.412 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0000064
	speed: 0.5314s/iter; left time: 17285.0551s
	iters: 200, epoch: 22 | loss: 0.0010877
	speed: 0.2775s/iter; left time: 8997.8708s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.2675s/iter; left time: 8647.4554s
	iters: 400, epoch: 22 | loss: 0.3987086
	speed: 0.2545s/iter; left time: 8203.5003s
Epoch: 22 cost time: 109.86056447029114
Epoch: 22, Steps: 413 | Train Loss: 0.123 Vali Loss: 0.341 Vali Acc: 0.965 Test Loss: 0.341 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.5327s/iter; left time: 17108.7449s
	iters: 200, epoch: 23 | loss: 0.0000005
	speed: 0.2781s/iter; left time: 8903.3035s
	iters: 300, epoch: 23 | loss: 0.0001982
	speed: 0.2766s/iter; left time: 8828.2708s
	iters: 400, epoch: 23 | loss: 0.0000360
	speed: 0.2583s/iter; left time: 8219.1523s
Epoch: 23 cost time: 111.43946957588196
Epoch: 23, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.192 Vali Acc: 0.975 Test Loss: 0.192 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.975443383356071
model parameter : 10220554
model size : 58.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8114097
	speed: 0.3024s/iter; left time: 12459.6812s
	iters: 200, epoch: 1 | loss: 0.1372512
	speed: 0.2929s/iter; left time: 12037.0896s
	iters: 300, epoch: 1 | loss: 0.5129303
	speed: 0.2721s/iter; left time: 11157.2127s
	iters: 400, epoch: 1 | loss: 0.0783010
	speed: 0.3160s/iter; left time: 12922.8677s
Epoch: 1 cost time: 122.22713780403137
Epoch: 1, Steps: 413 | Train Loss: 0.554 Vali Loss: 0.315 Vali Acc: 0.928 Test Loss: 0.315 Test Acc: 0.928
Validation loss decreased (inf --> -0.927691).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4049945
	speed: 0.5775s/iter; left time: 23556.4959s
	iters: 200, epoch: 2 | loss: 0.0340001
	speed: 0.3096s/iter; left time: 12598.3823s
	iters: 300, epoch: 2 | loss: 2.2129776
	speed: 0.3005s/iter; left time: 12197.9024s
	iters: 400, epoch: 2 | loss: 0.2152923
	speed: 0.3141s/iter; left time: 12715.7819s
Epoch: 2 cost time: 127.10589098930359
Epoch: 2, Steps: 413 | Train Loss: 0.276 Vali Loss: 0.639 Vali Acc: 0.922 Test Loss: 0.639 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.0598623
	speed: 0.5731s/iter; left time: 23137.0589s
	iters: 200, epoch: 3 | loss: 0.0697802
	speed: 0.2976s/iter; left time: 11984.3290s
	iters: 300, epoch: 3 | loss: 0.0004026
	speed: 0.2867s/iter; left time: 11519.1021s
	iters: 400, epoch: 3 | loss: 1.4070954
	speed: 0.2898s/iter; left time: 11614.2556s
Epoch: 3 cost time: 120.53220200538635
Epoch: 3, Steps: 413 | Train Loss: 0.330 Vali Loss: 0.276 Vali Acc: 0.960 Test Loss: 0.276 Test Acc: 0.960
Validation loss decreased (-0.927691 --> -0.959524).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000007
	speed: 0.5916s/iter; left time: 23642.8239s
	iters: 200, epoch: 4 | loss: 0.0000137
	speed: 0.2886s/iter; left time: 11505.6234s
	iters: 300, epoch: 4 | loss: 0.0000017
	speed: 0.3029s/iter; left time: 12045.4412s
	iters: 400, epoch: 4 | loss: 0.0025079
	speed: 0.2779s/iter; left time: 11023.1204s
Epoch: 4 cost time: 120.58697366714478
Epoch: 4, Steps: 413 | Train Loss: 0.228 Vali Loss: 0.173 Vali Acc: 0.975 Test Loss: 0.173 Test Acc: 0.975
Validation loss decreased (-0.959524 --> -0.975442).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1682895
	speed: 0.5975s/iter; left time: 23631.5682s
	iters: 200, epoch: 5 | loss: 0.0000094
	speed: 0.3015s/iter; left time: 11893.1276s
	iters: 300, epoch: 5 | loss: 0.6624339
	speed: 0.3024s/iter; left time: 11897.7533s
	iters: 400, epoch: 5 | loss: 0.0010069
	speed: 0.3200s/iter; left time: 12559.2818s
Epoch: 5 cost time: 127.01866888999939
Epoch: 5, Steps: 413 | Train Loss: 0.277 Vali Loss: 0.267 Vali Acc: 0.965 Test Loss: 0.267 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.9087692
	speed: 0.6028s/iter; left time: 23591.4079s
	iters: 200, epoch: 6 | loss: 1.4628541
	speed: 0.2967s/iter; left time: 11581.8204s
	iters: 300, epoch: 6 | loss: 0.0004457
	speed: 0.2968s/iter; left time: 11557.7533s
	iters: 400, epoch: 6 | loss: 0.0000004
	speed: 0.2835s/iter; left time: 11008.9241s
Epoch: 6 cost time: 122.91296648979187
Epoch: 6, Steps: 413 | Train Loss: 0.351 Vali Loss: 0.604 Vali Acc: 0.946 Test Loss: 0.604 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.5717s/iter; left time: 22136.8183s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.3095s/iter; left time: 11952.7130s
	iters: 300, epoch: 7 | loss: 3.5488644
	speed: 0.3058s/iter; left time: 11778.5154s
	iters: 400, epoch: 7 | loss: 0.7820404
	speed: 0.2887s/iter; left time: 11091.7848s
Epoch: 7 cost time: 123.59852838516235
Epoch: 7, Steps: 413 | Train Loss: 0.219 Vali Loss: 0.248 Vali Acc: 0.968 Test Loss: 0.248 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0010672
	speed: 0.5626s/iter; left time: 21554.8375s
	iters: 200, epoch: 8 | loss: 0.9823787
	speed: 0.3010s/iter; left time: 11502.0010s
	iters: 300, epoch: 8 | loss: 0.0000081
	speed: 0.2994s/iter; left time: 11410.8349s
	iters: 400, epoch: 8 | loss: 0.0000007
	speed: 0.3083s/iter; left time: 11716.7788s
Epoch: 8 cost time: 124.73211121559143
Epoch: 8, Steps: 413 | Train Loss: 0.210 Vali Loss: 0.822 Vali Acc: 0.935 Test Loss: 0.822 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.5619s/iter; left time: 21295.5580s
	iters: 200, epoch: 9 | loss: 0.0212607
	speed: 0.2651s/iter; left time: 10020.0665s
	iters: 300, epoch: 9 | loss: 0.5009399
	speed: 0.2971s/iter; left time: 11201.0730s
	iters: 400, epoch: 9 | loss: 0.0000075
	speed: 0.3037s/iter; left time: 11416.9998s
Epoch: 9 cost time: 119.32454466819763
Epoch: 9, Steps: 413 | Train Loss: 0.165 Vali Loss: 0.390 Vali Acc: 0.967 Test Loss: 0.390 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.5649s/iter; left time: 21174.9088s
	iters: 200, epoch: 10 | loss: 1.1751732
	speed: 0.3004s/iter; left time: 11231.5438s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.2968s/iter; left time: 11064.4086s
	iters: 400, epoch: 10 | loss: 0.8434438
	speed: 0.3158s/iter; left time: 11741.5283s
Epoch: 10 cost time: 123.66203594207764
Epoch: 10, Steps: 413 | Train Loss: 0.180 Vali Loss: 0.517 Vali Acc: 0.959 Test Loss: 0.517 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0014843
	speed: 0.5854s/iter; left time: 21703.0677s
	iters: 200, epoch: 11 | loss: 0.0000161
	speed: 0.2947s/iter; left time: 10895.9578s
	iters: 300, epoch: 11 | loss: 1.0986189
	speed: 0.2910s/iter; left time: 10730.5988s
	iters: 400, epoch: 11 | loss: 0.3793135
	speed: 0.3015s/iter; left time: 11087.8402s
Epoch: 11 cost time: 122.3922472000122
Epoch: 11, Steps: 413 | Train Loss: 0.204 Vali Loss: 0.349 Vali Acc: 0.972 Test Loss: 0.349 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.5773s/iter; left time: 21163.5426s
	iters: 200, epoch: 12 | loss: 0.0000670
	speed: 0.2841s/iter; left time: 10386.8582s
	iters: 300, epoch: 12 | loss: 0.7576630
	speed: 0.2862s/iter; left time: 10433.5766s
	iters: 400, epoch: 12 | loss: 1.2663823
	speed: 0.2918s/iter; left time: 10608.4133s
Epoch: 12 cost time: 118.9557592868805
Epoch: 12, Steps: 413 | Train Loss: 0.198 Vali Loss: 0.439 Vali Acc: 0.955 Test Loss: 0.439 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0000377
	speed: 0.5694s/iter; left time: 20637.4491s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.2805s/iter; left time: 10140.2687s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.2810s/iter; left time: 10128.2861s
	iters: 400, epoch: 13 | loss: 0.0000255
	speed: 0.2788s/iter; left time: 10022.3963s
Epoch: 13 cost time: 116.59665632247925
Epoch: 13, Steps: 413 | Train Loss: 0.128 Vali Loss: 0.809 Vali Acc: 0.932 Test Loss: 0.809 Test Acc: 0.932
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.1767644
	speed: 0.5493s/iter; left time: 19682.8913s
	iters: 200, epoch: 14 | loss: 0.0505475
	speed: 0.2929s/iter; left time: 10465.8198s
	iters: 300, epoch: 14 | loss: 1.0023345
	speed: 0.2904s/iter; left time: 10346.8918s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.2958s/iter; left time: 10509.0788s
Epoch: 14 cost time: 120.92632555961609
Epoch: 14, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.188 Vali Acc: 0.977 Test Loss: 0.188 Test Acc: 0.977
Validation loss decreased (-0.975442 --> -0.976806).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.5775s/iter; left time: 20453.0569s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.2931s/iter; left time: 10353.3100s
	iters: 300, epoch: 15 | loss: 0.0000221
	speed: 0.2955s/iter; left time: 10406.8441s
	iters: 400, epoch: 15 | loss: 0.0131981
	speed: 0.2798s/iter; left time: 9825.3665s
Epoch: 15 cost time: 120.38440012931824
Epoch: 15, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.320 Vali Acc: 0.973 Test Loss: 0.320 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.2160903
	speed: 0.5407s/iter; left time: 18926.8557s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.2815s/iter; left time: 9825.2665s
	iters: 300, epoch: 16 | loss: 0.3109508
	speed: 0.2769s/iter; left time: 9639.0790s
	iters: 400, epoch: 16 | loss: 0.0010336
	speed: 0.2807s/iter; left time: 9741.6098s
Epoch: 16 cost time: 113.8248221874237
Epoch: 16, Steps: 413 | Train Loss: 0.145 Vali Loss: 0.319 Vali Acc: 0.968 Test Loss: 0.319 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000007
	speed: 0.5673s/iter; left time: 19623.3968s
	iters: 200, epoch: 17 | loss: 0.0000427
	speed: 0.2870s/iter; left time: 9898.1514s
	iters: 300, epoch: 17 | loss: 0.0000170
	speed: 0.2884s/iter; left time: 9918.3910s
	iters: 400, epoch: 17 | loss: 0.0048832
	speed: 0.2946s/iter; left time: 10104.0369s
Epoch: 17 cost time: 120.58247113227844
Epoch: 17, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.197 Vali Acc: 0.977 Test Loss: 0.197 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0066365
	speed: 0.5588s/iter; left time: 19101.4736s
	iters: 200, epoch: 18 | loss: 0.0000792
	speed: 0.2786s/iter; left time: 9493.1516s
	iters: 300, epoch: 18 | loss: 1.8299587
	speed: 0.2745s/iter; left time: 9328.4395s
	iters: 400, epoch: 18 | loss: 3.4433341
	speed: 0.2813s/iter; left time: 9530.5549s
Epoch: 18 cost time: 115.99364519119263
Epoch: 18, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.257 Vali Acc: 0.970 Test Loss: 0.257 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.5591s/iter; left time: 18879.5134s
	iters: 200, epoch: 19 | loss: 0.0000075
	speed: 0.2825s/iter; left time: 9512.2254s
	iters: 300, epoch: 19 | loss: 0.2056057
	speed: 0.2849s/iter; left time: 9564.2752s
	iters: 400, epoch: 19 | loss: 0.5480990
	speed: 0.2944s/iter; left time: 9853.4696s
Epoch: 19 cost time: 119.05201649665833
Epoch: 19, Steps: 413 | Train Loss: 0.108 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.976806 --> -0.977261).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000126
	speed: 0.5844s/iter; left time: 19492.6623s
	iters: 200, epoch: 20 | loss: 0.0000442
	speed: 0.2877s/iter; left time: 9567.6824s
	iters: 300, epoch: 20 | loss: 0.0000320
	speed: 0.2790s/iter; left time: 9248.5668s
	iters: 400, epoch: 20 | loss: 0.2307891
	speed: 0.2758s/iter; left time: 9117.0392s
Epoch: 20 cost time: 117.62503600120544
Epoch: 20, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.258 Vali Acc: 0.958 Test Loss: 0.258 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0022033
	speed: 0.5499s/iter; left time: 18115.4683s
	iters: 200, epoch: 21 | loss: 0.0029247
	speed: 0.2868s/iter; left time: 9418.4155s
	iters: 300, epoch: 21 | loss: 0.0040274
	speed: 0.2850s/iter; left time: 9332.0622s
	iters: 400, epoch: 21 | loss: 0.0543508
	speed: 0.2794s/iter; left time: 9120.5813s
Epoch: 21 cost time: 117.24985122680664
Epoch: 21, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.208 Vali Acc: 0.961 Test Loss: 0.208 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000989
	speed: 0.5529s/iter; left time: 17983.2210s
	iters: 200, epoch: 22 | loss: 0.2973067
	speed: 0.2945s/iter; left time: 9550.4627s
	iters: 300, epoch: 22 | loss: 0.1517294
	speed: 0.2893s/iter; left time: 9353.8675s
	iters: 400, epoch: 22 | loss: 0.0179800
	speed: 0.2880s/iter; left time: 9282.9684s
Epoch: 22 cost time: 119.60222673416138
Epoch: 22, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.075 Vali Acc: 0.986 Test Loss: 0.075 Test Acc: 0.986
Validation loss decreased (-0.977261 --> -0.985902).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000003
	speed: 0.5682s/iter; left time: 18248.2310s
	iters: 200, epoch: 23 | loss: 0.0000007
	speed: 0.2836s/iter; left time: 9080.1396s
	iters: 300, epoch: 23 | loss: 0.0000019
	speed: 0.2799s/iter; left time: 8932.1112s
	iters: 400, epoch: 23 | loss: 0.0011632
	speed: 0.2914s/iter; left time: 9269.3635s
Epoch: 23 cost time: 117.94159770011902
Epoch: 23, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.157 Vali Acc: 0.970 Test Loss: 0.157 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0009877
	speed: 0.5625s/iter; left time: 17832.4730s
	iters: 200, epoch: 24 | loss: 0.0000619
	speed: 0.2939s/iter; left time: 9288.2655s
	iters: 300, epoch: 24 | loss: 0.0001473
	speed: 0.2856s/iter; left time: 8997.6475s
	iters: 400, epoch: 24 | loss: 0.4082845
	speed: 0.2926s/iter; left time: 9187.3562s
Epoch: 24 cost time: 119.75381398200989
Epoch: 24, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.163 Vali Acc: 0.973 Test Loss: 0.163 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0000125
	speed: 0.5941s/iter; left time: 18589.1378s
	iters: 200, epoch: 25 | loss: 0.0002549
	speed: 0.2876s/iter; left time: 8968.9141s
	iters: 300, epoch: 25 | loss: 0.0000022
	speed: 0.2833s/iter; left time: 8806.2302s
	iters: 400, epoch: 25 | loss: 0.0000033
	speed: 0.2842s/iter; left time: 8805.9584s
Epoch: 25 cost time: 119.11436915397644
Epoch: 25, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0001484
	speed: 0.5548s/iter; left time: 17129.3638s
	iters: 200, epoch: 26 | loss: 0.0000462
	speed: 0.2855s/iter; left time: 8785.0401s
	iters: 300, epoch: 26 | loss: 0.0240992
	speed: 0.2746s/iter; left time: 8423.5111s
	iters: 400, epoch: 26 | loss: 0.0000422
	speed: 0.2636s/iter; left time: 8061.0715s
Epoch: 26 cost time: 114.44570183753967
Epoch: 26, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.1582546
	speed: 0.5831s/iter; left time: 17761.4716s
	iters: 200, epoch: 27 | loss: 0.0041909
	speed: 0.2899s/iter; left time: 8801.8676s
	iters: 300, epoch: 27 | loss: 0.0131007
	speed: 0.2938s/iter; left time: 8890.5893s
	iters: 400, epoch: 27 | loss: 0.0097144
	speed: 0.3011s/iter; left time: 9081.3367s
Epoch: 27 cost time: 123.03503465652466
Epoch: 27, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.109 Vali Acc: 0.979 Test Loss: 0.109 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0000447
	speed: 0.5884s/iter; left time: 17681.1926s
	iters: 200, epoch: 28 | loss: 0.0001548
	speed: 0.3027s/iter; left time: 9066.6557s
	iters: 300, epoch: 28 | loss: 0.2209241
	speed: 0.2868s/iter; left time: 8561.9772s
	iters: 400, epoch: 28 | loss: 0.0337994
	speed: 0.2701s/iter; left time: 8035.4850s
Epoch: 28 cost time: 119.70585894584656
Epoch: 28, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.133 Vali Acc: 0.965 Test Loss: 0.133 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0015763
	speed: 0.5459s/iter; left time: 16180.2395s
	iters: 200, epoch: 29 | loss: 0.0064173
	speed: 0.2872s/iter; left time: 8483.7505s
	iters: 300, epoch: 29 | loss: 0.0642624
	speed: 0.2913s/iter; left time: 8576.1377s
	iters: 400, epoch: 29 | loss: 0.0000530
	speed: 0.2948s/iter; left time: 8649.9312s
Epoch: 29 cost time: 118.93643379211426
Epoch: 29, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.063 Vali Acc: 0.982 Test Loss: 0.063 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0020625
	speed: 0.5463s/iter; left time: 15965.2108s
	iters: 200, epoch: 30 | loss: 0.0058894
	speed: 0.2817s/iter; left time: 8203.4279s
	iters: 300, epoch: 30 | loss: 0.0018397
	speed: 0.2942s/iter; left time: 8538.9780s
	iters: 400, epoch: 30 | loss: 0.0000034
	speed: 0.2908s/iter; left time: 8412.4887s
Epoch: 30 cost time: 118.92075228691101
Epoch: 30, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.046 Vali Acc: 0.986 Test Loss: 0.046 Test Acc: 0.986
Validation loss decreased (-0.985902 --> -0.985902).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.0000081
	speed: 0.5813s/iter; left time: 16746.5333s
	iters: 200, epoch: 31 | loss: 0.0002381
	speed: 0.2865s/iter; left time: 8224.8929s
	iters: 300, epoch: 31 | loss: 0.0002878
	speed: 0.2777s/iter; left time: 7945.2136s
	iters: 400, epoch: 31 | loss: 0.0001963
	speed: 0.2908s/iter; left time: 8290.3891s
Epoch: 31 cost time: 119.02603602409363
Epoch: 31, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.0065646
	speed: 0.5742s/iter; left time: 16307.1558s
	iters: 200, epoch: 32 | loss: 0.0224226
	speed: 0.2726s/iter; left time: 7713.9535s
	iters: 300, epoch: 32 | loss: 0.1556141
	speed: 0.2803s/iter; left time: 7903.2481s
	iters: 400, epoch: 32 | loss: 0.0000612
	speed: 0.2773s/iter; left time: 7792.8128s
Epoch: 32 cost time: 116.92821502685547
Epoch: 32, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.085 Vali Acc: 0.982 Test Loss: 0.085 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.0000305
	speed: 0.5748s/iter; left time: 16086.9715s
	iters: 200, epoch: 33 | loss: 0.0006669
	speed: 0.2988s/iter; left time: 8333.1458s
	iters: 300, epoch: 33 | loss: 0.0000866
	speed: 0.2912s/iter; left time: 8090.2593s
	iters: 400, epoch: 33 | loss: 0.0104195
	speed: 0.2809s/iter; left time: 7776.9605s
Epoch: 33 cost time: 120.35039687156677
Epoch: 33, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.164 Vali Acc: 0.961 Test Loss: 0.164 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.0009503
	speed: 0.5495s/iter; left time: 15151.2117s
	iters: 200, epoch: 34 | loss: 0.0299427
	speed: 0.2862s/iter; left time: 7862.4236s
	iters: 300, epoch: 34 | loss: 0.0000204
	speed: 0.3052s/iter; left time: 8353.7933s
	iters: 400, epoch: 34 | loss: 0.0109402
	speed: 0.2892s/iter; left time: 7887.9280s
Epoch: 34 cost time: 120.36700797080994
Epoch: 34, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.0023309
	speed: 0.5590s/iter; left time: 15182.2436s
	iters: 200, epoch: 35 | loss: 0.0013604
	speed: 0.2964s/iter; left time: 8020.8983s
	iters: 300, epoch: 35 | loss: 0.0000049
	speed: 0.2963s/iter; left time: 7987.5129s
	iters: 400, epoch: 35 | loss: 0.0007960
	speed: 0.2900s/iter; left time: 7790.3643s
Epoch: 35 cost time: 120.0169460773468
Epoch: 35, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 0.0000407
	speed: 0.5686s/iter; left time: 15207.8529s
	iters: 200, epoch: 36 | loss: 0.0005087
	speed: 0.2832s/iter; left time: 7545.6561s
	iters: 300, epoch: 36 | loss: 0.0019640
	speed: 0.2771s/iter; left time: 7355.8990s
	iters: 400, epoch: 36 | loss: 0.0014287
	speed: 0.2834s/iter; left time: 7494.8866s
Epoch: 36 cost time: 117.16071057319641
Epoch: 36, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 0.0979044
	speed: 0.5594s/iter; left time: 14731.2426s
	iters: 200, epoch: 37 | loss: 0.0031539
	speed: 0.2789s/iter; left time: 7316.0663s
	iters: 300, epoch: 37 | loss: 0.0009043
	speed: 0.2711s/iter; left time: 7084.5901s
	iters: 400, epoch: 37 | loss: 0.4402750
	speed: 0.2906s/iter; left time: 7565.5131s
Epoch: 37 cost time: 116.4107015132904
Epoch: 37, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 38 | loss: 0.0014489
	speed: 0.5963s/iter; left time: 15456.5543s
	iters: 200, epoch: 38 | loss: 0.0026777
	speed: 0.2787s/iter; left time: 7196.7245s
	iters: 300, epoch: 38 | loss: 0.0201099
	speed: 0.2729s/iter; left time: 7017.9090s
	iters: 400, epoch: 38 | loss: 0.0074674
	speed: 0.2840s/iter; left time: 7276.0968s
Epoch: 38 cost time: 117.28963875770569
Epoch: 38, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 39 | loss: 0.0000073
	speed: 0.5564s/iter; left time: 14193.0650s
	iters: 200, epoch: 39 | loss: 0.0031164
	speed: 0.2830s/iter; left time: 7190.9408s
	iters: 300, epoch: 39 | loss: 0.0068660
	speed: 0.2732s/iter; left time: 6915.0389s
	iters: 400, epoch: 39 | loss: 0.0116126
	speed: 0.2663s/iter; left time: 6712.3562s
Epoch: 39 cost time: 114.22771525382996
Epoch: 39, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.180 Vali Acc: 0.963 Test Loss: 0.180 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 40 | loss: 0.0000145
	speed: 0.5456s/iter; left time: 13690.9299s
	iters: 200, epoch: 40 | loss: 0.0000755
	speed: 0.2834s/iter; left time: 7083.1364s
	iters: 300, epoch: 40 | loss: 0.0767043
	speed: 0.2774s/iter; left time: 6905.6879s
	iters: 400, epoch: 40 | loss: 0.1716513
	speed: 0.2852s/iter; left time: 7070.2544s
Epoch: 40 cost time: 117.47475409507751
Epoch: 40, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.147 Vali Acc: 0.969 Test Loss: 0.147 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9859026830377444
model parameter : 10220554
model size : 58.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6809214
	speed: 0.3298s/iter; left time: 13587.4060s
	iters: 200, epoch: 1 | loss: 0.2057367
	speed: 0.2955s/iter; left time: 12147.3014s
	iters: 300, epoch: 1 | loss: 0.2523828
	speed: 0.2755s/iter; left time: 11295.2534s
	iters: 400, epoch: 1 | loss: 0.1058283
	speed: 0.2859s/iter; left time: 11692.5342s
Epoch: 1 cost time: 122.47019052505493
Epoch: 1, Steps: 413 | Train Loss: 0.543 Vali Loss: 0.302 Vali Acc: 0.929 Test Loss: 0.302 Test Acc: 0.929
Validation loss decreased (inf --> -0.929056).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3784012
	speed: 0.5863s/iter; left time: 23912.8984s
	iters: 200, epoch: 2 | loss: 0.0006438
	speed: 0.2807s/iter; left time: 11421.4369s
	iters: 300, epoch: 2 | loss: 1.9688282
	speed: 0.2886s/iter; left time: 11713.8003s
	iters: 400, epoch: 2 | loss: 0.0383790
	speed: 0.2830s/iter; left time: 11457.3737s
Epoch: 2 cost time: 119.26599097251892
Epoch: 2, Steps: 413 | Train Loss: 0.272 Vali Loss: 0.506 Vali Acc: 0.943 Test Loss: 0.506 Test Acc: 0.943
Validation loss decreased (-0.929056 --> -0.943151).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0008964
	speed: 0.6081s/iter; left time: 24552.5864s
	iters: 200, epoch: 3 | loss: 0.0237275
	speed: 0.2862s/iter; left time: 11526.8909s
	iters: 300, epoch: 3 | loss: 0.0009665
	speed: 0.2921s/iter; left time: 11733.6458s
	iters: 400, epoch: 3 | loss: 0.2205549
	speed: 0.2996s/iter; left time: 12004.6822s
Epoch: 3 cost time: 122.94336581230164
Epoch: 3, Steps: 413 | Train Loss: 0.289 Vali Loss: 0.480 Vali Acc: 0.935 Test Loss: 0.480 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0021603
	speed: 0.5716s/iter; left time: 22842.2369s
	iters: 200, epoch: 4 | loss: 1.1244379
	speed: 0.2834s/iter; left time: 11295.2421s
	iters: 300, epoch: 4 | loss: 0.0001418
	speed: 0.2721s/iter; left time: 10819.4133s
	iters: 400, epoch: 4 | loss: 0.0151336
	speed: 0.2920s/iter; left time: 11581.2357s
Epoch: 4 cost time: 117.30233883857727
Epoch: 4, Steps: 413 | Train Loss: 0.288 Vali Loss: 0.270 Vali Acc: 0.961 Test Loss: 0.270 Test Acc: 0.961
Validation loss decreased (-0.943151 --> -0.960889).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6294343
	speed: 0.5883s/iter; left time: 23267.5597s
	iters: 200, epoch: 5 | loss: 0.0065352
	speed: 0.2893s/iter; left time: 11414.3903s
	iters: 300, epoch: 5 | loss: 0.0001612
	speed: 0.2823s/iter; left time: 11108.6502s
	iters: 400, epoch: 5 | loss: 0.0000000
	speed: 0.3130s/iter; left time: 12283.4306s
Epoch: 5 cost time: 121.83619952201843
Epoch: 5, Steps: 413 | Train Loss: 0.269 Vali Loss: 0.300 Vali Acc: 0.970 Test Loss: 0.300 Test Acc: 0.970
Validation loss decreased (-0.960889 --> -0.970438).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0037581
	speed: 0.5997s/iter; left time: 23468.4704s
	iters: 200, epoch: 6 | loss: 0.1066330
	speed: 0.2825s/iter; left time: 11027.2780s
	iters: 300, epoch: 6 | loss: 0.0083446
	speed: 0.2875s/iter; left time: 11194.5483s
	iters: 400, epoch: 6 | loss: 0.3135988
	speed: 0.2793s/iter; left time: 10847.3870s
Epoch: 6 cost time: 118.1462664604187
Epoch: 6, Steps: 413 | Train Loss: 0.277 Vali Loss: 0.449 Vali Acc: 0.958 Test Loss: 0.449 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000009
	speed: 0.5589s/iter; left time: 21644.0863s
	iters: 200, epoch: 7 | loss: 0.0000001
	speed: 0.3016s/iter; left time: 11647.6232s
	iters: 300, epoch: 7 | loss: 2.1235452
	speed: 0.2974s/iter; left time: 11455.5507s
	iters: 400, epoch: 7 | loss: 0.0000000
	speed: 0.2894s/iter; left time: 11117.7097s
Epoch: 7 cost time: 121.73801922798157
Epoch: 7, Steps: 413 | Train Loss: 0.233 Vali Loss: 0.210 Vali Acc: 0.970 Test Loss: 0.210 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0042147
	speed: 0.5682s/iter; left time: 21768.6031s
	iters: 200, epoch: 8 | loss: 0.0000577
	speed: 0.3019s/iter; left time: 11535.0941s
	iters: 300, epoch: 8 | loss: 1.3295953
	speed: 0.3035s/iter; left time: 11567.7241s
	iters: 400, epoch: 8 | loss: 0.1114218
	speed: 0.2846s/iter; left time: 10817.2700s
Epoch: 8 cost time: 121.2088303565979
Epoch: 8, Steps: 413 | Train Loss: 0.210 Vali Loss: 0.428 Vali Acc: 0.960 Test Loss: 0.428 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0196657
	speed: 0.5652s/iter; left time: 21420.3847s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.2940s/iter; left time: 11111.1027s
	iters: 300, epoch: 9 | loss: 0.9790643
	speed: 0.2913s/iter; left time: 10981.1381s
	iters: 400, epoch: 9 | loss: 0.0000522
	speed: 0.2779s/iter; left time: 10447.0906s
Epoch: 9 cost time: 118.86859107017517
Epoch: 9, Steps: 413 | Train Loss: 0.184 Vali Loss: 0.427 Vali Acc: 0.950 Test Loss: 0.427 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.5716s/iter; left time: 21424.4320s
	iters: 200, epoch: 10 | loss: 0.0000198
	speed: 0.3005s/iter; left time: 11233.1791s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.3028s/iter; left time: 11289.4952s
	iters: 400, epoch: 10 | loss: 0.5409968
	speed: 0.2929s/iter; left time: 10892.5088s
Epoch: 10 cost time: 122.51843690872192
Epoch: 10, Steps: 413 | Train Loss: 0.178 Vali Loss: 0.382 Vali Acc: 0.966 Test Loss: 0.382 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0009519
	speed: 0.5850s/iter; left time: 21686.1861s
	iters: 200, epoch: 11 | loss: 0.0002579
	speed: 0.3026s/iter; left time: 11187.6458s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.2938s/iter; left time: 10834.1645s
	iters: 400, epoch: 11 | loss: 0.0000005
	speed: 0.2898s/iter; left time: 10657.0069s
Epoch: 11 cost time: 121.80307793617249
Epoch: 11, Steps: 413 | Train Loss: 0.133 Vali Loss: 0.769 Vali Acc: 0.947 Test Loss: 0.769 Test Acc: 0.947
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.5907s/iter; left time: 21655.3909s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.2879s/iter; left time: 10525.9009s
	iters: 300, epoch: 12 | loss: 0.9320220
	speed: 0.2745s/iter; left time: 10008.5789s
	iters: 400, epoch: 12 | loss: 0.0011573
	speed: 0.2862s/iter; left time: 10406.8069s
Epoch: 12 cost time: 119.02327919006348
Epoch: 12, Steps: 413 | Train Loss: 0.204 Vali Loss: 0.407 Vali Acc: 0.965 Test Loss: 0.407 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0000401
	speed: 0.5861s/iter; left time: 21242.5111s
	iters: 200, epoch: 13 | loss: 0.0000006
	speed: 0.2909s/iter; left time: 10514.9292s
	iters: 300, epoch: 13 | loss: 0.0000048
	speed: 0.2885s/iter; left time: 10397.5157s
	iters: 400, epoch: 13 | loss: 0.8685176
	speed: 0.2851s/iter; left time: 10246.4863s
Epoch: 13 cost time: 119.90075778961182
Epoch: 13, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.442 Vali Acc: 0.957 Test Loss: 0.442 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.0037911
	speed: 0.5876s/iter; left time: 21054.9636s
	iters: 200, epoch: 14 | loss: 0.0000005
	speed: 0.2765s/iter; left time: 9879.3238s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.2937s/iter; left time: 10465.5807s
	iters: 400, epoch: 14 | loss: 0.0032273
	speed: 0.2999s/iter; left time: 10655.5583s
Epoch: 14 cost time: 121.2299075126648
Epoch: 14, Steps: 413 | Train Loss: 0.157 Vali Loss: 0.442 Vali Acc: 0.969 Test Loss: 0.442 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0000001
	speed: 0.5729s/iter; left time: 20292.8718s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.2789s/iter; left time: 9851.2305s
	iters: 300, epoch: 15 | loss: 0.0000029
	speed: 0.3023s/iter; left time: 10647.1784s
	iters: 400, epoch: 15 | loss: 0.0006683
	speed: 0.2896s/iter; left time: 10172.1833s
Epoch: 15 cost time: 119.95918560028076
Epoch: 15, Steps: 413 | Train Loss: 0.119 Vali Loss: 0.438 Vali Acc: 0.964 Test Loss: 0.438 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9704411095952705
model parameter : 10220554
model size : 58.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.3030806
	speed: 0.3297s/iter; left time: 13582.2879s
	iters: 200, epoch: 1 | loss: 2.3017492
	speed: 0.3036s/iter; left time: 12477.5197s
	iters: 300, epoch: 1 | loss: 2.3020427
	speed: 0.3073s/iter; left time: 12601.4811s
	iters: 400, epoch: 1 | loss: 2.3022220
	speed: 0.3056s/iter; left time: 12498.1121s
Epoch: 1 cost time: 128.52503323554993
Epoch: 1, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (inf --> -0.100022).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3001859
	speed: 0.5759s/iter; left time: 23489.6718s
	iters: 200, epoch: 2 | loss: 2.3024008
	speed: 0.3029s/iter; left time: 12325.2864s
	iters: 300, epoch: 2 | loss: 2.3013027
	speed: 0.3100s/iter; left time: 12583.7091s
	iters: 400, epoch: 2 | loss: 2.3035703
	speed: 0.2981s/iter; left time: 12071.4095s
Epoch: 2 cost time: 124.72796702384949
Epoch: 2, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3017337
	speed: 0.6048s/iter; left time: 24417.1733s
	iters: 200, epoch: 3 | loss: 2.3010669
	speed: 0.3182s/iter; left time: 12814.3142s
	iters: 300, epoch: 3 | loss: 2.3035796
	speed: 0.3196s/iter; left time: 12840.8015s
	iters: 400, epoch: 3 | loss: 2.3033607
	speed: 0.3007s/iter; left time: 12052.2155s
Epoch: 3 cost time: 128.7948932647705
Epoch: 3, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3024926
	speed: 0.5952s/iter; left time: 23785.1745s
	iters: 200, epoch: 4 | loss: 2.3008890
	speed: 0.3135s/iter; left time: 12495.9932s
	iters: 300, epoch: 4 | loss: 2.3020806
	speed: 0.3163s/iter; left time: 12575.3596s
	iters: 400, epoch: 4 | loss: 2.3030121
	speed: 0.3058s/iter; left time: 12130.2155s
Epoch: 4 cost time: 128.54921770095825
Epoch: 4, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.3027990
	speed: 0.5927s/iter; left time: 23439.6928s
	iters: 200, epoch: 5 | loss: 2.3030539
	speed: 0.3055s/iter; left time: 12052.8431s
	iters: 300, epoch: 5 | loss: 2.3005307
	speed: 0.3109s/iter; left time: 12235.4588s
	iters: 400, epoch: 5 | loss: 2.3021021
	speed: 0.2969s/iter; left time: 11651.0701s
Epoch: 5 cost time: 125.7501049041748
Epoch: 5, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.3036218
	speed: 0.5743s/iter; left time: 22474.8562s
	iters: 200, epoch: 6 | loss: 2.3047545
	speed: 0.2994s/iter; left time: 11687.3214s
	iters: 300, epoch: 6 | loss: 2.3012471
	speed: 0.2832s/iter; left time: 11024.9387s
	iters: 400, epoch: 6 | loss: 2.3024979
	speed: 0.2936s/iter; left time: 11403.5677s
Epoch: 6 cost time: 122.62260389328003
Epoch: 6, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 2.2997038
	speed: 0.5747s/iter; left time: 22252.4949s
	iters: 200, epoch: 7 | loss: 2.3025579
	speed: 0.3003s/iter; left time: 11597.0192s
	iters: 300, epoch: 7 | loss: 2.3053153
	speed: 0.3003s/iter; left time: 11566.9668s
	iters: 400, epoch: 7 | loss: 2.3016822
	speed: 0.2926s/iter; left time: 11241.4758s
Epoch: 7 cost time: 124.10877251625061
Epoch: 7, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 2.3053277
	speed: 0.6005s/iter; left time: 23004.4330s
	iters: 200, epoch: 8 | loss: 2.3017583
	speed: 0.3085s/iter; left time: 11786.8343s
	iters: 300, epoch: 8 | loss: 2.3044493
	speed: 0.3051s/iter; left time: 11628.5227s
	iters: 400, epoch: 8 | loss: 2.3032417
	speed: 0.2965s/iter; left time: 11268.5077s
Epoch: 8 cost time: 126.16446852684021
Epoch: 8, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 2.3028789
	speed: 0.5996s/iter; left time: 22724.4372s
	iters: 200, epoch: 9 | loss: 2.3016431
	speed: 0.2812s/iter; left time: 10627.1738s
	iters: 300, epoch: 9 | loss: 2.3030615
	speed: 0.2801s/iter; left time: 10557.2683s
	iters: 400, epoch: 9 | loss: 2.3041270
	speed: 0.2931s/iter; left time: 11020.5388s
Epoch: 9 cost time: 120.246657371521
Epoch: 9, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.3037980
	speed: 0.6028s/iter; left time: 22593.8310s
	iters: 200, epoch: 10 | loss: 2.3059630
	speed: 0.3013s/iter; left time: 11264.2978s
	iters: 300, epoch: 10 | loss: 2.3017745
	speed: 0.3104s/iter; left time: 11574.6096s
	iters: 400, epoch: 10 | loss: 2.3031259
	speed: 0.3259s/iter; left time: 12117.6573s
Epoch: 10 cost time: 128.68371391296387
Epoch: 10, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.3029368
	speed: 0.5914s/iter; left time: 21923.7380s
	iters: 200, epoch: 11 | loss: 2.3051381
	speed: 0.2873s/iter; left time: 10622.7755s
	iters: 300, epoch: 11 | loss: 2.3076999
	speed: 0.2971s/iter; left time: 10955.4365s
	iters: 400, epoch: 11 | loss: 2.3049371
	speed: 0.3015s/iter; left time: 11085.2070s
Epoch: 11 cost time: 122.15601825714111
Epoch: 11, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.3044720
	speed: 0.5845s/iter; left time: 21426.6195s
	iters: 200, epoch: 12 | loss: 2.3021059
	speed: 0.3075s/iter; left time: 11242.9669s
	iters: 300, epoch: 12 | loss: 2.3026323
	speed: 0.3143s/iter; left time: 11457.2285s
	iters: 400, epoch: 12 | loss: 2.3042417
	speed: 0.3224s/iter; left time: 11721.9261s
Epoch: 12 cost time: 127.6233823299408
Epoch: 12, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 2.3019295
	speed: 0.5814s/iter; left time: 21071.1586s
	iters: 200, epoch: 13 | loss: 2.3019352
	speed: 0.3028s/iter; left time: 10944.5235s
	iters: 300, epoch: 13 | loss: 2.3017006
	speed: 0.2990s/iter; left time: 10777.9383s
	iters: 400, epoch: 13 | loss: 2.3027489
	speed: 0.2773s/iter; left time: 9965.8814s
Epoch: 13 cost time: 122.1636118888855
Epoch: 13, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 2.3026912
	speed: 0.5755s/iter; left time: 20622.8802s
	iters: 200, epoch: 14 | loss: 2.3014319
	speed: 0.2925s/iter; left time: 10452.1779s
	iters: 300, epoch: 14 | loss: 2.3019664
	speed: 0.2994s/iter; left time: 10669.2737s
	iters: 400, epoch: 14 | loss: 2.3017440
	speed: 0.3009s/iter; left time: 10691.9436s
Epoch: 14 cost time: 123.14249277114868
Epoch: 14, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 2.3019907
	speed: 0.5841s/iter; left time: 20689.8410s
	iters: 200, epoch: 15 | loss: 2.3041365
	speed: 0.3257s/iter; left time: 11503.2369s
	iters: 300, epoch: 15 | loss: 2.3045721
	speed: 0.3046s/iter; left time: 10727.3249s
	iters: 400, epoch: 15 | loss: 2.3022864
	speed: 0.2915s/iter; left time: 10237.0099s
Epoch: 15 cost time: 125.70140671730042
Epoch: 15, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 2.3017378
	speed: 0.5839s/iter; left time: 20441.0873s
	iters: 200, epoch: 16 | loss: 2.3041418
	speed: 0.2972s/iter; left time: 10372.7336s
	iters: 300, epoch: 16 | loss: 2.3020806
	speed: 0.2830s/iter; left time: 9851.8146s
	iters: 400, epoch: 16 | loss: 2.3018312
	speed: 0.3045s/iter; left time: 10567.4287s
Epoch: 16 cost time: 124.09698414802551
Epoch: 16, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 2.3019931
	speed: 0.5846s/iter; left time: 20222.5498s
	iters: 200, epoch: 17 | loss: 2.3033016
	speed: 0.2955s/iter; left time: 10192.5610s
	iters: 300, epoch: 17 | loss: 2.3028655
	speed: 0.3109s/iter; left time: 10692.5866s
	iters: 400, epoch: 17 | loss: 2.3062053
	speed: 0.3132s/iter; left time: 10739.6180s
Epoch: 17 cost time: 126.21621632575989
Epoch: 17, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 2.3020601
	speed: 0.5797s/iter; left time: 19814.6223s
	iters: 200, epoch: 18 | loss: 2.3027458
	speed: 0.3015s/iter; left time: 10276.8198s
	iters: 300, epoch: 18 | loss: 2.3024092
	speed: 0.2927s/iter; left time: 9945.8818s
	iters: 400, epoch: 18 | loss: 2.3036070
	speed: 0.2981s/iter; left time: 10099.8681s
Epoch: 18 cost time: 123.32947158813477
Epoch: 18, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 19 | loss: 2.3015096
	speed: 0.6092s/iter; left time: 20572.0819s
	iters: 200, epoch: 19 | loss: 2.3024936
	speed: 0.3106s/iter; left time: 10455.8982s
	iters: 300, epoch: 19 | loss: 2.3047855
	speed: 0.2988s/iter; left time: 10029.5687s
	iters: 400, epoch: 19 | loss: 2.3016088
	speed: 0.3159s/iter; left time: 10572.9509s
Epoch: 19 cost time: 129.16010856628418
Epoch: 19, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 2.3044806
	speed: 0.6013s/iter; left time: 20054.1395s
	iters: 200, epoch: 20 | loss: 2.2979727
	speed: 0.3016s/iter; left time: 10028.4797s
	iters: 300, epoch: 20 | loss: 2.3082438
	speed: 0.3238s/iter; left time: 10734.0384s
	iters: 400, epoch: 20 | loss: 2.3039739
	speed: 0.3092s/iter; left time: 10221.0940s
Epoch: 20 cost time: 127.3566632270813
Epoch: 20, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 2.3030360
	speed: 0.5873s/iter; left time: 19346.2907s
	iters: 200, epoch: 21 | loss: 2.3054960
	speed: 0.3176s/iter; left time: 10430.3985s
	iters: 300, epoch: 21 | loss: 2.3049407
	speed: 0.2947s/iter; left time: 9647.1767s
	iters: 400, epoch: 21 | loss: 2.3034475
	speed: 0.2937s/iter; left time: 9586.1121s
Epoch: 21 cost time: 125.07968235015869
Epoch: 21, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 2.3014278
	speed: 0.6091s/iter; left time: 19812.3276s
	iters: 200, epoch: 22 | loss: 2.3008876
	speed: 0.3043s/iter; left time: 9867.5046s
	iters: 300, epoch: 22 | loss: 2.3055060
	speed: 0.3124s/iter; left time: 10100.1647s
	iters: 400, epoch: 22 | loss: 2.3034229
	speed: 0.3248s/iter; left time: 10468.5046s
Epoch: 22 cost time: 129.92750716209412
Epoch: 22, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 2.3047779
	speed: 0.5860s/iter; left time: 18819.2773s
	iters: 200, epoch: 23 | loss: 2.3028622
	speed: 0.3118s/iter; left time: 9982.8897s
	iters: 300, epoch: 23 | loss: 2.3031788
	speed: 0.3049s/iter; left time: 9729.7637s
	iters: 400, epoch: 23 | loss: 2.3039358
	speed: 0.2835s/iter; left time: 9019.7312s
Epoch: 23 cost time: 124.0805435180664
Epoch: 23, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 2.3046496
	speed: 0.6060s/iter; left time: 19211.7544s
	iters: 200, epoch: 24 | loss: 2.2994831
	speed: 0.2921s/iter; left time: 9232.0825s
	iters: 300, epoch: 24 | loss: 2.3033378
	speed: 0.3027s/iter; left time: 9535.3714s
	iters: 400, epoch: 24 | loss: 2.3032146
	speed: 0.3193s/iter; left time: 10026.2005s
Epoch: 24 cost time: 127.47058367729187
Epoch: 24, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 2.2988281
	speed: 0.5946s/iter; left time: 18603.4680s
	iters: 200, epoch: 25 | loss: 2.3033760
	speed: 0.3141s/iter; left time: 9795.5719s
	iters: 300, epoch: 25 | loss: 2.3024330
	speed: 0.3012s/iter; left time: 9365.1858s
	iters: 400, epoch: 25 | loss: 2.3020635
	speed: 0.2773s/iter; left time: 8593.7459s
Epoch: 25 cost time: 122.95657753944397
Epoch: 25, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 2.3057625
	speed: 0.5800s/iter; left time: 17909.5328s
	iters: 200, epoch: 26 | loss: 2.3018026
	speed: 0.2930s/iter; left time: 9016.4700s
	iters: 300, epoch: 26 | loss: 2.3058443
	speed: 0.2763s/iter; left time: 8476.9320s
	iters: 400, epoch: 26 | loss: 2.3019700
	speed: 0.3025s/iter; left time: 9247.8506s
Epoch: 26 cost time: 122.13083028793335
Epoch: 26, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 2.3007553
	speed: 0.5962s/iter; left time: 18162.0330s
	iters: 200, epoch: 27 | loss: 2.3056848
	speed: 0.3023s/iter; left time: 9178.4003s
	iters: 300, epoch: 27 | loss: 2.3022792
	speed: 0.3223s/iter; left time: 9752.8039s
	iters: 400, epoch: 27 | loss: 2.3031526
	speed: 0.3090s/iter; left time: 9319.1013s
Epoch: 27 cost time: 128.03965520858765
Epoch: 27, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 28 | loss: 2.3017006
	speed: 0.6039s/iter; left time: 18148.2188s
	iters: 200, epoch: 28 | loss: 2.2999616
	speed: 0.2908s/iter; left time: 8710.0454s
	iters: 300, epoch: 28 | loss: 2.3020911
	speed: 0.2911s/iter; left time: 8690.3842s
	iters: 400, epoch: 28 | loss: 2.3031282
	speed: 0.2986s/iter; left time: 8884.6907s
Epoch: 28 cost time: 122.80693674087524
Epoch: 28, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 2.3008659
	speed: 0.5971s/iter; left time: 17695.1670s
	iters: 200, epoch: 29 | loss: 2.2985783
	speed: 0.3029s/iter; left time: 8947.2690s
	iters: 300, epoch: 29 | loss: 2.3024859
	speed: 0.3087s/iter; left time: 9087.8574s
	iters: 400, epoch: 29 | loss: 2.3037548
	speed: 0.3157s/iter; left time: 9261.5556s
Epoch: 29 cost time: 127.52717471122742
Epoch: 29, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 2.3014224
	speed: 0.5764s/iter; left time: 16843.2743s
	iters: 200, epoch: 30 | loss: 2.3040121
	speed: 0.3209s/iter; left time: 9345.7335s
	iters: 300, epoch: 30 | loss: 2.3041077
	speed: 0.2983s/iter; left time: 8657.1758s
	iters: 400, epoch: 30 | loss: 2.3014476
	speed: 0.2872s/iter; left time: 8305.8799s
Epoch: 30 cost time: 124.4504554271698
Epoch: 30, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 2.3027043
	speed: 0.5697s/iter; left time: 16412.5856s
	iters: 200, epoch: 31 | loss: 2.3022845
	speed: 0.2963s/iter; left time: 8507.5345s
	iters: 300, epoch: 31 | loss: 2.3020661
	speed: 0.2970s/iter; left time: 8496.4948s
	iters: 400, epoch: 31 | loss: 2.3017311
	speed: 0.2896s/iter; left time: 8256.2443s
Epoch: 31 cost time: 122.496342420578
Epoch: 31, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 2.2990289
	speed: 0.5721s/iter; left time: 16247.2531s
	iters: 200, epoch: 32 | loss: 2.3055387
	speed: 0.2930s/iter; left time: 8291.5688s
	iters: 300, epoch: 32 | loss: 2.3040516
	speed: 0.3027s/iter; left time: 8534.2531s
	iters: 400, epoch: 32 | loss: 2.3040476
	speed: 0.2956s/iter; left time: 8305.4279s
Epoch: 32 cost time: 121.47968053817749
Epoch: 32, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 2.3042159
	speed: 0.5477s/iter; left time: 15326.5000s
	iters: 200, epoch: 33 | loss: 2.3000679
	speed: 0.2771s/iter; left time: 7727.7054s
	iters: 300, epoch: 33 | loss: 2.3061824
	speed: 0.2971s/iter; left time: 8255.7649s
	iters: 400, epoch: 33 | loss: 2.3057206
	speed: 0.2784s/iter; left time: 7708.1055s
Epoch: 33 cost time: 116.83420991897583
Epoch: 33, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 2.3015869
	speed: 0.5879s/iter; left time: 16210.2492s
	iters: 200, epoch: 34 | loss: 2.3022664
	speed: 0.2892s/iter; left time: 7943.8328s
	iters: 300, epoch: 34 | loss: 2.3025279
	speed: 0.3007s/iter; left time: 8231.5776s
	iters: 400, epoch: 34 | loss: 2.3035786
	speed: 0.2907s/iter; left time: 7927.2629s
Epoch: 34 cost time: 121.73500323295593
Epoch: 34, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 2.3110785
	speed: 0.5894s/iter; left time: 16007.9510s
	iters: 200, epoch: 35 | loss: 2.3013358
	speed: 0.2739s/iter; left time: 7411.1505s
	iters: 300, epoch: 35 | loss: 2.3016160
	speed: 0.2904s/iter; left time: 7829.2552s
	iters: 400, epoch: 35 | loss: 2.3027723
	speed: 0.2900s/iter; left time: 7790.2782s
Epoch: 35 cost time: 119.9513156414032
Epoch: 35, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 36 | loss: 2.3026693
	speed: 0.5721s/iter; left time: 15301.4311s
	iters: 200, epoch: 36 | loss: 2.3060460
	speed: 0.2912s/iter; left time: 7758.6953s
	iters: 300, epoch: 36 | loss: 2.3030150
	speed: 0.2786s/iter; left time: 7394.4829s
	iters: 400, epoch: 36 | loss: 2.3007789
	speed: 0.2950s/iter; left time: 7800.5517s
Epoch: 36 cost time: 120.61891865730286
Epoch: 36, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 37 | loss: 2.3007205
	speed: 0.5782s/iter; left time: 15225.7170s
	iters: 200, epoch: 37 | loss: 2.2976158
	speed: 0.2990s/iter; left time: 7844.0931s
	iters: 300, epoch: 37 | loss: 2.3012712
	speed: 0.2720s/iter; left time: 7107.6798s
	iters: 400, epoch: 37 | loss: 2.3023734
	speed: 0.2952s/iter; left time: 7685.2678s
Epoch: 37 cost time: 120.07856607437134
Epoch: 37, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 38 | loss: 2.3052707
	speed: 0.5717s/iter; left time: 14818.4512s
	iters: 200, epoch: 38 | loss: 2.3029587
	speed: 0.2982s/iter; left time: 7698.4609s
	iters: 300, epoch: 38 | loss: 2.3047705
	speed: 0.3068s/iter; left time: 7891.0345s
	iters: 400, epoch: 38 | loss: 2.3026235
	speed: 0.2881s/iter; left time: 7382.3082s
Epoch: 38 cost time: 121.85344171524048
Epoch: 38, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 39 | loss: 2.3042114
	speed: 0.5878s/iter; left time: 14994.1441s
	iters: 200, epoch: 39 | loss: 2.3038239
	speed: 0.2912s/iter; left time: 7399.6649s
	iters: 300, epoch: 39 | loss: 2.3010814
	speed: 0.3036s/iter; left time: 7683.4778s
	iters: 400, epoch: 39 | loss: 2.3037503
	speed: 0.2795s/iter; left time: 7044.8593s
Epoch: 39 cost time: 120.25746536254883
Epoch: 39, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 40 | loss: 2.3019297
	speed: 0.5861s/iter; left time: 14707.9912s
	iters: 200, epoch: 40 | loss: 2.3060765
	speed: 0.2826s/iter; left time: 7063.7827s
	iters: 300, epoch: 40 | loss: 2.3020928
	speed: 0.3056s/iter; left time: 7606.9759s
	iters: 400, epoch: 40 | loss: 2.3022251
	speed: 0.2997s/iter; left time: 7430.4230s
Epoch: 40 cost time: 122.39260816574097
Epoch: 40, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 41 | loss: 2.3038414
	speed: 0.5861s/iter; left time: 14464.6911s
	iters: 200, epoch: 41 | loss: 2.3023546
	speed: 0.2803s/iter; left time: 6891.2181s
	iters: 300, epoch: 41 | loss: 2.3044319
	speed: 0.2867s/iter; left time: 7018.2378s
	iters: 400, epoch: 41 | loss: 2.3026445
	speed: 0.2900s/iter; left time: 7071.5511s
Epoch: 41 cost time: 119.401211977005
Epoch: 41, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 42 | loss: 2.3045402
	speed: 0.5652s/iter; left time: 13716.4169s
	iters: 200, epoch: 42 | loss: 2.3007247
	speed: 0.2773s/iter; left time: 6700.9665s
	iters: 300, epoch: 42 | loss: 2.3056931
	speed: 0.2818s/iter; left time: 6781.2627s
	iters: 400, epoch: 42 | loss: 2.3025210
	speed: 0.2880s/iter; left time: 6903.5501s
Epoch: 42 cost time: 118.28984117507935
Epoch: 42, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 43 | loss: 2.3022337
	speed: 0.5652s/iter; left time: 13482.1160s
	iters: 200, epoch: 43 | loss: 2.3047698
	speed: 0.2826s/iter; left time: 6712.6990s
	iters: 300, epoch: 43 | loss: 2.3062575
	speed: 0.2903s/iter; left time: 6866.5928s
	iters: 400, epoch: 43 | loss: 2.3052094
	speed: 0.2909s/iter; left time: 6852.0502s
Epoch: 43 cost time: 119.10689640045166
Epoch: 43, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 44 | loss: 2.3024654
	speed: 0.5557s/iter; left time: 13026.2392s
	iters: 200, epoch: 44 | loss: 2.3050432
	speed: 0.2878s/iter; left time: 6718.2760s
	iters: 300, epoch: 44 | loss: 2.3039105
	speed: 0.2718s/iter; left time: 6317.9963s
	iters: 400, epoch: 44 | loss: 2.3044093
	speed: 0.2948s/iter; left time: 6822.0977s
Epoch: 44 cost time: 119.32658195495605
Epoch: 44, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 45 | loss: 2.3055043
	speed: 0.5485s/iter; left time: 12631.8070s
	iters: 200, epoch: 45 | loss: 2.3027089
	speed: 0.2937s/iter; left time: 6734.0553s
	iters: 300, epoch: 45 | loss: 2.3017411
	speed: 0.2910s/iter; left time: 6642.8532s
	iters: 400, epoch: 45 | loss: 2.3031962
	speed: 0.2925s/iter; left time: 6648.1328s
Epoch: 45 cost time: 119.08212876319885
Epoch: 45, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 46 | loss: 2.2997775
	speed: 0.5892s/iter; left time: 13325.9242s
	iters: 200, epoch: 46 | loss: 2.3086972
	speed: 0.3025s/iter; left time: 6811.0525s
	iters: 300, epoch: 46 | loss: 2.3050070
	speed: 0.2838s/iter; left time: 6362.2820s
	iters: 400, epoch: 46 | loss: 2.3024664
	speed: 0.2965s/iter; left time: 6615.6803s
Epoch: 46 cost time: 122.96036505699158
Epoch: 46, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm512_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.10004547521600728
model parameter : 10220554
model size : 58.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         47                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2678246
	speed: 0.3110s/iter; left time: 12813.1483s
	iters: 200, epoch: 1 | loss: 0.1395350
	speed: 0.2877s/iter; left time: 11826.0564s
	iters: 300, epoch: 1 | loss: 0.0218418
	speed: 0.2808s/iter; left time: 11514.7986s
	iters: 400, epoch: 1 | loss: 0.0095564
	speed: 0.2966s/iter; left time: 12132.3434s
Epoch: 1 cost time: 122.18538522720337
Epoch: 1, Steps: 413 | Train Loss: 0.342 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
Validation loss decreased (inf --> -0.969531).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0271138
	speed: 0.5653s/iter; left time: 23059.3329s
	iters: 200, epoch: 2 | loss: 0.3909582
	speed: 0.2950s/iter; left time: 12003.3893s
	iters: 300, epoch: 2 | loss: 0.0161269
	speed: 0.2926s/iter; left time: 11877.5821s
	iters: 400, epoch: 2 | loss: 0.0003002
	speed: 0.3012s/iter; left time: 12194.4140s
Epoch: 2 cost time: 121.42104053497314
Epoch: 2, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.146 Vali Acc: 0.960 Test Loss: 0.146 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.3378462
	speed: 0.5614s/iter; left time: 22664.8827s
	iters: 200, epoch: 3 | loss: 0.0854651
	speed: 0.2834s/iter; left time: 11414.2920s
	iters: 300, epoch: 3 | loss: 0.0119944
	speed: 0.2891s/iter; left time: 11612.8657s
	iters: 400, epoch: 3 | loss: 0.0072217
	speed: 0.2879s/iter; left time: 11537.1317s
Epoch: 3 cost time: 118.51260495185852
Epoch: 3, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.2315987
	speed: 0.5818s/iter; left time: 23248.1184s
	iters: 200, epoch: 4 | loss: 0.0001336
	speed: 0.2815s/iter; left time: 11220.8922s
	iters: 300, epoch: 4 | loss: 0.0194663
	speed: 0.2831s/iter; left time: 11257.4910s
	iters: 400, epoch: 4 | loss: 0.0000046
	speed: 0.2890s/iter; left time: 11462.7242s
Epoch: 4 cost time: 119.680828332901
Epoch: 4, Steps: 413 | Train Loss: 0.122 Vali Loss: 0.158 Vali Acc: 0.971 Test Loss: 0.158 Test Acc: 0.971
Validation loss decreased (-0.969531 --> -0.970894).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2122751
	speed: 0.5728s/iter; left time: 22654.3079s
	iters: 200, epoch: 5 | loss: 0.0003015
	speed: 0.3152s/iter; left time: 12434.6752s
	iters: 300, epoch: 5 | loss: 0.0023826
	speed: 0.2851s/iter; left time: 11219.9221s
	iters: 400, epoch: 5 | loss: 0.1795983
	speed: 0.2663s/iter; left time: 10453.6031s
Epoch: 5 cost time: 119.44139266014099
Epoch: 5, Steps: 413 | Train Loss: 0.137 Vali Loss: 0.343 Vali Acc: 0.958 Test Loss: 0.343 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.3344924
	speed: 0.5385s/iter; left time: 21074.9870s
	iters: 200, epoch: 6 | loss: 0.0000028
	speed: 0.2776s/iter; left time: 10835.0616s
	iters: 300, epoch: 6 | loss: 0.0000043
	speed: 0.2839s/iter; left time: 11054.5518s
	iters: 400, epoch: 6 | loss: 0.0000153
	speed: 0.2725s/iter; left time: 10584.3891s
Epoch: 6 cost time: 114.69225645065308
Epoch: 6, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.160 Vali Acc: 0.971 Test Loss: 0.160 Test Acc: 0.971
Validation loss decreased (-0.970894 --> -0.971349).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0004261
	speed: 0.5294s/iter; left time: 20500.5654s
	iters: 200, epoch: 7 | loss: 0.0003193
	speed: 0.2737s/iter; left time: 10570.0567s
	iters: 300, epoch: 7 | loss: 0.3095989
	speed: 0.2887s/iter; left time: 11122.5495s
	iters: 400, epoch: 7 | loss: 0.0000955
	speed: 0.2922s/iter; left time: 11228.3828s
Epoch: 7 cost time: 116.79839444160461
Epoch: 7, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.333 Vali Acc: 0.956 Test Loss: 0.333 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1187946
	speed: 0.5441s/iter; left time: 20844.0374s
	iters: 200, epoch: 8 | loss: 0.0176530
	speed: 0.2731s/iter; left time: 10434.0407s
	iters: 300, epoch: 8 | loss: 0.3548060
	speed: 0.2775s/iter; left time: 10576.0715s
	iters: 400, epoch: 8 | loss: 1.2070916
	speed: 0.2900s/iter; left time: 11021.6987s
Epoch: 8 cost time: 116.58922410011292
Epoch: 8, Steps: 413 | Train Loss: 0.125 Vali Loss: 0.273 Vali Acc: 0.967 Test Loss: 0.273 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.2036558
	speed: 0.5431s/iter; left time: 20582.5643s
	iters: 200, epoch: 9 | loss: 0.6435819
	speed: 0.2732s/iter; left time: 10327.0682s
	iters: 300, epoch: 9 | loss: 0.0025307
	speed: 0.2784s/iter; left time: 10492.9948s
	iters: 400, epoch: 9 | loss: 0.2783318
	speed: 0.2822s/iter; left time: 10610.9049s
Epoch: 9 cost time: 114.83463859558105
Epoch: 9, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.219 Vali Acc: 0.976 Test Loss: 0.219 Test Acc: 0.976
Validation loss decreased (-0.971349 --> -0.976351).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000542
	speed: 0.5647s/iter; left time: 21166.7199s
	iters: 200, epoch: 10 | loss: 0.0000003
	speed: 0.2713s/iter; left time: 10140.4325s
	iters: 300, epoch: 10 | loss: 0.0478829
	speed: 0.2703s/iter; left time: 10077.6967s
	iters: 400, epoch: 10 | loss: 0.6385928
	speed: 0.2823s/iter; left time: 10498.4410s
Epoch: 10 cost time: 115.18480634689331
Epoch: 10, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.242 Vali Acc: 0.969 Test Loss: 0.242 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000058
	speed: 0.5437s/iter; left time: 20154.0478s
	iters: 200, epoch: 11 | loss: 0.0006295
	speed: 0.2742s/iter; left time: 10138.9260s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.2741s/iter; left time: 10107.4217s
	iters: 400, epoch: 11 | loss: 0.0000288
	speed: 0.2732s/iter; left time: 10044.0841s
Epoch: 11 cost time: 113.27145981788635
Epoch: 11, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.123 Vali Acc: 0.983 Test Loss: 0.123 Test Acc: 0.983
Validation loss decreased (-0.976351 --> -0.982718).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0003573
	speed: 0.5774s/iter; left time: 21165.8858s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.2978s/iter; left time: 10888.5868s
	iters: 300, epoch: 12 | loss: 0.8942949
	speed: 0.2909s/iter; left time: 10605.7985s
	iters: 400, epoch: 12 | loss: 0.0000007
	speed: 0.2924s/iter; left time: 10631.1739s
Epoch: 12 cost time: 121.42167448997498
Epoch: 12, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.240 Vali Acc: 0.974 Test Loss: 0.240 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.5996s/iter; left time: 21731.8774s
	iters: 200, epoch: 13 | loss: 0.0188225
	speed: 0.3019s/iter; left time: 10910.9147s
	iters: 300, epoch: 13 | loss: 0.0000049
	speed: 0.2943s/iter; left time: 10609.8157s
	iters: 400, epoch: 13 | loss: 0.0000003
	speed: 0.2867s/iter; left time: 10304.2996s
Epoch: 13 cost time: 122.93648910522461
Epoch: 13, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.231 Vali Acc: 0.973 Test Loss: 0.231 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0003852
	speed: 0.5697s/iter; left time: 20412.3072s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.3144s/iter; left time: 11233.0664s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.3011s/iter; left time: 10728.2084s
	iters: 400, epoch: 14 | loss: 0.8919780
	speed: 0.2910s/iter; left time: 10340.6323s
Epoch: 14 cost time: 124.94728446006775
Epoch: 14, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.317 Vali Acc: 0.965 Test Loss: 0.317 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000001
	speed: 0.5794s/iter; left time: 20521.1995s
	iters: 200, epoch: 15 | loss: 0.0069047
	speed: 0.2949s/iter; left time: 10415.4379s
	iters: 300, epoch: 15 | loss: 0.0005143
	speed: 0.3008s/iter; left time: 10594.8806s
	iters: 400, epoch: 15 | loss: 0.0007119
	speed: 0.2964s/iter; left time: 10407.8987s
Epoch: 15 cost time: 122.57763195037842
Epoch: 15, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.341 Vali Acc: 0.966 Test Loss: 0.341 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000335
	speed: 0.5474s/iter; left time: 19161.1610s
	iters: 200, epoch: 16 | loss: 0.0010817
	speed: 0.2829s/iter; left time: 9876.4846s
	iters: 300, epoch: 16 | loss: 0.0000003
	speed: 0.2978s/iter; left time: 10365.2036s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.2729s/iter; left time: 9471.3579s
Epoch: 16 cost time: 118.10702633857727
Epoch: 16, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.364 Vali Acc: 0.966 Test Loss: 0.364 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.5649s/iter; left time: 19540.3418s
	iters: 200, epoch: 17 | loss: 0.0000020
	speed: 0.3015s/iter; left time: 10399.5098s
	iters: 300, epoch: 17 | loss: 0.0000042
	speed: 0.2950s/iter; left time: 10147.3160s
	iters: 400, epoch: 17 | loss: 0.0144151
	speed: 0.2872s/iter; left time: 9849.5024s
Epoch: 17 cost time: 121.28319883346558
Epoch: 17, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.447 Vali Acc: 0.964 Test Loss: 0.447 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0019311
	speed: 0.5539s/iter; left time: 18931.3554s
	iters: 200, epoch: 18 | loss: 0.0003015
	speed: 0.2882s/iter; left time: 9822.7713s
	iters: 300, epoch: 18 | loss: 0.0000059
	speed: 0.2803s/iter; left time: 9524.6498s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.2786s/iter; left time: 9438.9394s
Epoch: 18 cost time: 117.14395761489868
Epoch: 18, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.475 Vali Acc: 0.967 Test Loss: 0.475 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0157517
	speed: 0.5411s/iter; left time: 18272.9746s
	iters: 200, epoch: 19 | loss: 1.2222143
	speed: 0.2770s/iter; left time: 9326.8856s
	iters: 300, epoch: 19 | loss: 0.0000007
	speed: 0.2735s/iter; left time: 9179.7203s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.2831s/iter; left time: 9475.9111s
Epoch: 19 cost time: 114.23750066757202
Epoch: 19, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.208 Vali Acc: 0.973 Test Loss: 0.208 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.5617s/iter; left time: 18735.6149s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.2901s/iter; left time: 9645.5681s
	iters: 300, epoch: 20 | loss: 0.4982424
	speed: 0.2843s/iter; left time: 9424.0268s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.2875s/iter; left time: 9501.4158s
Epoch: 20 cost time: 119.14438319206238
Epoch: 20, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.285 Vali Acc: 0.974 Test Loss: 0.285 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.6434566
	speed: 0.5805s/iter; left time: 19122.4699s
	iters: 200, epoch: 21 | loss: 0.0000020
	speed: 0.2735s/iter; left time: 8981.0137s
	iters: 300, epoch: 21 | loss: 0.0000009
	speed: 0.2717s/iter; left time: 8896.6698s
	iters: 400, epoch: 21 | loss: 0.0000001
	speed: 0.2708s/iter; left time: 8839.1478s
Epoch: 21 cost time: 115.14884734153748
Epoch: 21, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.231 Vali Acc: 0.977 Test Loss: 0.231 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9827194179172352
model parameter : 5732874
model size : 31.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         38                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2920946
	speed: 0.3051s/iter; left time: 12569.3778s
	iters: 200, epoch: 1 | loss: 0.0743547
	speed: 0.2864s/iter; left time: 11771.5948s
	iters: 300, epoch: 1 | loss: 0.0157931
	speed: 0.2824s/iter; left time: 11579.7110s
	iters: 400, epoch: 1 | loss: 0.0908277
	speed: 0.2815s/iter; left time: 11514.3365s
Epoch: 1 cost time: 119.60466265678406
Epoch: 1, Steps: 413 | Train Loss: 0.358 Vali Loss: 0.177 Vali Acc: 0.959 Test Loss: 0.177 Test Acc: 0.959
Validation loss decreased (inf --> -0.959071).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0097971
	speed: 0.5672s/iter; left time: 23134.9603s
	iters: 200, epoch: 2 | loss: 0.0248283
	speed: 0.2903s/iter; left time: 11811.2642s
	iters: 300, epoch: 2 | loss: 0.0093496
	speed: 0.2874s/iter; left time: 11666.5663s
	iters: 400, epoch: 2 | loss: 0.0531971
	speed: 0.2858s/iter; left time: 11570.3244s
Epoch: 2 cost time: 119.4974889755249
Epoch: 2, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
Validation loss decreased (-0.959071 --> -0.969985).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0856669
	speed: 0.5482s/iter; left time: 22134.1160s
	iters: 200, epoch: 3 | loss: 0.0992603
	speed: 0.2895s/iter; left time: 11659.7545s
	iters: 300, epoch: 3 | loss: 0.0033447
	speed: 0.2776s/iter; left time: 11151.0200s
	iters: 400, epoch: 3 | loss: 0.0006681
	speed: 0.2776s/iter; left time: 11126.6524s
Epoch: 3 cost time: 116.15920042991638
Epoch: 3, Steps: 413 | Train Loss: 0.109 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
Validation loss decreased (-0.969985 --> -0.975442).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1974954
	speed: 0.5428s/iter; left time: 21689.4162s
	iters: 200, epoch: 4 | loss: 0.0018226
	speed: 0.3022s/iter; left time: 12047.2055s
	iters: 300, epoch: 4 | loss: 0.0000006
	speed: 0.2944s/iter; left time: 11704.8556s
	iters: 400, epoch: 4 | loss: 0.0000834
	speed: 0.2871s/iter; left time: 11387.8328s
Epoch: 4 cost time: 121.23475456237793
Epoch: 4, Steps: 413 | Train Loss: 0.124 Vali Loss: 0.154 Vali Acc: 0.968 Test Loss: 0.154 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0142026
	speed: 0.5520s/iter; left time: 21830.8934s
	iters: 200, epoch: 5 | loss: 0.0036474
	speed: 0.2882s/iter; left time: 11371.0307s
	iters: 300, epoch: 5 | loss: 0.0168622
	speed: 0.2958s/iter; left time: 11640.9794s
	iters: 400, epoch: 5 | loss: 0.0002969
	speed: 0.2852s/iter; left time: 11192.0362s
Epoch: 5 cost time: 119.00532555580139
Epoch: 5, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.277 Vali Acc: 0.957 Test Loss: 0.277 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0048521
	speed: 0.5513s/iter; left time: 21576.6294s
	iters: 200, epoch: 6 | loss: 0.1252745
	speed: 0.2777s/iter; left time: 10839.9348s
	iters: 300, epoch: 6 | loss: 0.0001054
	speed: 0.2906s/iter; left time: 11313.1868s
	iters: 400, epoch: 6 | loss: 0.0007297
	speed: 0.2843s/iter; left time: 11041.3483s
Epoch: 6 cost time: 117.55747699737549
Epoch: 6, Steps: 413 | Train Loss: 0.113 Vali Loss: 0.167 Vali Acc: 0.971 Test Loss: 0.167 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000105
	speed: 0.5850s/iter; left time: 22651.6207s
	iters: 200, epoch: 7 | loss: 0.0304564
	speed: 0.2755s/iter; left time: 10639.9778s
	iters: 300, epoch: 7 | loss: 0.0000891
	speed: 0.2927s/iter; left time: 11274.3334s
	iters: 400, epoch: 7 | loss: 0.0000008
	speed: 0.2948s/iter; left time: 11328.5799s
Epoch: 7 cost time: 119.47176694869995
Epoch: 7, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.254 Vali Acc: 0.965 Test Loss: 0.254 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0000007
	speed: 0.5775s/iter; left time: 22124.6864s
	iters: 200, epoch: 8 | loss: 0.2783472
	speed: 0.2667s/iter; left time: 10191.2099s
	iters: 300, epoch: 8 | loss: 0.0001988
	speed: 0.2817s/iter; left time: 10737.4113s
	iters: 400, epoch: 8 | loss: 0.0124611
	speed: 0.2777s/iter; left time: 10555.5922s
Epoch: 8 cost time: 115.31963109970093
Epoch: 8, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.330 Vali Acc: 0.962 Test Loss: 0.330 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000026
	speed: 0.5814s/iter; left time: 22032.4832s
	iters: 200, epoch: 9 | loss: 0.0000002
	speed: 0.2770s/iter; left time: 10470.9170s
	iters: 300, epoch: 9 | loss: 0.2639325
	speed: 0.2811s/iter; left time: 10597.3218s
	iters: 400, epoch: 9 | loss: 1.2531397
	speed: 0.2931s/iter; left time: 11018.3963s
Epoch: 9 cost time: 119.01868629455566
Epoch: 9, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.249 Vali Acc: 0.965 Test Loss: 0.249 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0001152
	speed: 0.6164s/iter; left time: 23103.8338s
	iters: 200, epoch: 10 | loss: 0.0000059
	speed: 0.2916s/iter; left time: 10899.9475s
	iters: 300, epoch: 10 | loss: 0.7535329
	speed: 0.2668s/iter; left time: 9949.0650s
	iters: 400, epoch: 10 | loss: 0.0000006
	speed: 0.2779s/iter; left time: 10333.6942s
Epoch: 10 cost time: 118.06600069999695
Epoch: 10, Steps: 413 | Train Loss: 0.108 Vali Loss: 0.433 Vali Acc: 0.950 Test Loss: 0.433 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.2312021
	speed: 0.5520s/iter; left time: 20462.1466s
	iters: 200, epoch: 11 | loss: 0.1572274
	speed: 0.2911s/iter; left time: 10762.0135s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.2877s/iter; left time: 10606.7004s
	iters: 400, epoch: 11 | loss: 0.0000229
	speed: 0.2867s/iter; left time: 10542.1820s
Epoch: 11 cost time: 118.79159593582153
Epoch: 11, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.286 Vali Acc: 0.972 Test Loss: 0.286 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0100625
	speed: 0.5681s/iter; left time: 20825.7519s
	iters: 200, epoch: 12 | loss: 0.0003277
	speed: 0.2899s/iter; left time: 10598.8793s
	iters: 300, epoch: 12 | loss: 0.0000311
	speed: 0.2901s/iter; left time: 10574.6494s
	iters: 400, epoch: 12 | loss: 0.0022140
	speed: 0.2857s/iter; left time: 10386.8388s
Epoch: 12 cost time: 119.7189519405365
Epoch: 12, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.336 Vali Acc: 0.961 Test Loss: 0.336 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.2114961
	speed: 0.5737s/iter; left time: 20795.5584s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.2924s/iter; left time: 10567.7035s
	iters: 300, epoch: 13 | loss: 0.0008494
	speed: 0.2889s/iter; left time: 10412.0645s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.2853s/iter; left time: 10256.4594s
Epoch: 13 cost time: 119.77713823318481
Epoch: 13, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.596 Vali Acc: 0.947 Test Loss: 0.596 Test Acc: 0.947
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.975443383356071
model parameter : 5732874
model size : 31.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         28                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4067926
	speed: 0.3065s/iter; left time: 12629.9969s
	iters: 200, epoch: 1 | loss: 0.1181880
	speed: 0.2932s/iter; left time: 12049.5885s
	iters: 300, epoch: 1 | loss: 0.0208168
	speed: 0.3002s/iter; left time: 12310.5051s
	iters: 400, epoch: 1 | loss: 0.0115225
	speed: 0.2836s/iter; left time: 11598.3181s
Epoch: 1 cost time: 122.21536827087402
Epoch: 1, Steps: 413 | Train Loss: 0.391 Vali Loss: 0.175 Vali Acc: 0.945 Test Loss: 0.175 Test Acc: 0.945
Validation loss decreased (inf --> -0.945428).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0447726
	speed: 0.5695s/iter; left time: 23228.9152s
	iters: 200, epoch: 2 | loss: 0.4006876
	speed: 0.2917s/iter; left time: 11867.8902s
	iters: 300, epoch: 2 | loss: 0.0058159
	speed: 0.2842s/iter; left time: 11533.8070s
	iters: 400, epoch: 2 | loss: 0.0008919
	speed: 0.2907s/iter; left time: 11771.2507s
Epoch: 2 cost time: 119.66584634780884
Epoch: 2, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.175 Vali Acc: 0.947 Test Loss: 0.175 Test Acc: 0.947
Validation loss decreased (-0.945428 --> -0.947247).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2051637
	speed: 0.5627s/iter; left time: 22717.7644s
	iters: 200, epoch: 3 | loss: 0.0087928
	speed: 0.2773s/iter; left time: 11169.5514s
	iters: 300, epoch: 3 | loss: 0.0203272
	speed: 0.2653s/iter; left time: 10658.9524s
	iters: 400, epoch: 3 | loss: 0.0831583
	speed: 0.2800s/iter; left time: 11221.4521s
Epoch: 3 cost time: 114.73801946640015
Epoch: 3, Steps: 413 | Train Loss: 0.135 Vali Loss: 0.208 Vali Acc: 0.957 Test Loss: 0.208 Test Acc: 0.957
Validation loss decreased (-0.947247 --> -0.956796).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3862832
	speed: 0.5623s/iter; left time: 22472.5350s
	iters: 200, epoch: 4 | loss: 0.0016029
	speed: 0.2795s/iter; left time: 11141.4018s
	iters: 300, epoch: 4 | loss: 0.1270693
	speed: 0.2885s/iter; left time: 11470.4605s
	iters: 400, epoch: 4 | loss: 0.0001689
	speed: 0.2855s/iter; left time: 11323.9832s
Epoch: 4 cost time: 117.48885917663574
Epoch: 4, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.155 Vali Acc: 0.970 Test Loss: 0.155 Test Acc: 0.970
Validation loss decreased (-0.956796 --> -0.969530).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0593932
	speed: 0.5566s/iter; left time: 22012.4079s
	iters: 200, epoch: 5 | loss: 0.0025006
	speed: 0.2802s/iter; left time: 11054.5324s
	iters: 300, epoch: 5 | loss: 0.1821312
	speed: 0.2749s/iter; left time: 10815.8479s
	iters: 400, epoch: 5 | loss: 0.3533463
	speed: 0.2926s/iter; left time: 11484.2648s
Epoch: 5 cost time: 116.71358132362366
Epoch: 5, Steps: 413 | Train Loss: 0.108 Vali Loss: 0.313 Vali Acc: 0.959 Test Loss: 0.313 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0010796
	speed: 0.5460s/iter; left time: 21368.1733s
	iters: 200, epoch: 6 | loss: 0.0072663
	speed: 0.2805s/iter; left time: 10948.0630s
	iters: 300, epoch: 6 | loss: 0.3063869
	speed: 0.2785s/iter; left time: 10841.8874s
	iters: 400, epoch: 6 | loss: 0.1715702
	speed: 0.2887s/iter; left time: 11212.3857s
Epoch: 6 cost time: 115.95502996444702
Epoch: 6, Steps: 413 | Train Loss: 0.123 Vali Loss: 0.238 Vali Acc: 0.958 Test Loss: 0.238 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0018409
	speed: 0.5661s/iter; left time: 21922.5063s
	iters: 200, epoch: 7 | loss: 0.0091415
	speed: 0.2872s/iter; left time: 11094.2753s
	iters: 300, epoch: 7 | loss: 0.0101846
	speed: 0.2835s/iter; left time: 10920.2402s
	iters: 400, epoch: 7 | loss: 0.0000263
	speed: 0.2950s/iter; left time: 11333.9302s
Epoch: 7 cost time: 120.01867771148682
Epoch: 7, Steps: 413 | Train Loss: 0.115 Vali Loss: 0.161 Vali Acc: 0.972 Test Loss: 0.161 Test Acc: 0.972
Validation loss decreased (-0.969530 --> -0.971804).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000504
	speed: 0.5671s/iter; left time: 21724.0656s
	iters: 200, epoch: 8 | loss: 0.0024104
	speed: 0.2793s/iter; left time: 10671.5268s
	iters: 300, epoch: 8 | loss: 0.0000026
	speed: 0.2853s/iter; left time: 10871.0273s
	iters: 400, epoch: 8 | loss: 0.0018273
	speed: 0.2926s/iter; left time: 11121.8991s
Epoch: 8 cost time: 117.98283696174622
Epoch: 8, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.325 Vali Acc: 0.956 Test Loss: 0.325 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.1873275
	speed: 0.5500s/iter; left time: 20844.1138s
	iters: 200, epoch: 9 | loss: 0.0001713
	speed: 0.2866s/iter; left time: 10834.1913s
	iters: 300, epoch: 9 | loss: 0.0001520
	speed: 0.2922s/iter; left time: 11014.0072s
	iters: 400, epoch: 9 | loss: 0.0000016
	speed: 0.2772s/iter; left time: 10423.5170s
Epoch: 9 cost time: 117.63643383979797
Epoch: 9, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.294 Vali Acc: 0.960 Test Loss: 0.294 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000006
	speed: 0.5425s/iter; left time: 20335.0254s
	iters: 200, epoch: 10 | loss: 0.5025951
	speed: 0.2882s/iter; left time: 10772.5436s
	iters: 300, epoch: 10 | loss: 0.0721666
	speed: 0.2902s/iter; left time: 10821.0549s
	iters: 400, epoch: 10 | loss: 0.0005494
	speed: 0.2737s/iter; left time: 10175.7974s
Epoch: 10 cost time: 116.30912041664124
Epoch: 10, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.201 Vali Acc: 0.975 Test Loss: 0.201 Test Acc: 0.975
Validation loss decreased (-0.971804 --> -0.974532).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000010
	speed: 0.5619s/iter; left time: 20831.2890s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.3130s/iter; left time: 11572.6491s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.3162s/iter; left time: 11657.8673s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.2924s/iter; left time: 10751.3125s
Epoch: 11 cost time: 125.84634184837341
Epoch: 11, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.233 Vali Acc: 0.972 Test Loss: 0.233 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000011
	speed: 0.5980s/iter; left time: 21922.1189s
	iters: 200, epoch: 12 | loss: 0.0000063
	speed: 0.3187s/iter; left time: 11652.4590s
	iters: 300, epoch: 12 | loss: 0.0279793
	speed: 0.2861s/iter; left time: 10430.8300s
	iters: 400, epoch: 12 | loss: 0.0001696
	speed: 0.2803s/iter; left time: 10189.6789s
Epoch: 12 cost time: 123.75697731971741
Epoch: 12, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.193 Vali Acc: 0.983 Test Loss: 0.193 Test Acc: 0.983
Validation loss decreased (-0.974532 --> -0.983172).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000028
	speed: 0.6223s/iter; left time: 22553.5647s
	iters: 200, epoch: 13 | loss: 0.0000105
	speed: 0.2967s/iter; left time: 10722.4846s
	iters: 300, epoch: 13 | loss: 0.0001151
	speed: 0.2862s/iter; left time: 10315.8588s
	iters: 400, epoch: 13 | loss: 0.0067176
	speed: 0.3033s/iter; left time: 10901.6098s
Epoch: 13 cost time: 125.34443688392639
Epoch: 13, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.434 Vali Acc: 0.954 Test Loss: 0.434 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000305
	speed: 0.5627s/iter; left time: 20163.0689s
	iters: 200, epoch: 14 | loss: 1.6838300
	speed: 0.2736s/iter; left time: 9775.9389s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.2878s/iter; left time: 10256.5549s
	iters: 400, epoch: 14 | loss: 0.4615762
	speed: 0.2807s/iter; left time: 9974.3183s
Epoch: 14 cost time: 116.21549129486084
Epoch: 14, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.266 Vali Acc: 0.972 Test Loss: 0.266 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.5546s/iter; left time: 19644.8512s
	iters: 200, epoch: 15 | loss: 0.0000312
	speed: 0.2806s/iter; left time: 9909.3668s
	iters: 300, epoch: 15 | loss: 0.0000012
	speed: 0.2733s/iter; left time: 9625.1049s
	iters: 400, epoch: 15 | loss: 0.0000002
	speed: 0.2880s/iter; left time: 10116.0138s
Epoch: 15 cost time: 116.93962335586548
Epoch: 15, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.340 Vali Acc: 0.965 Test Loss: 0.340 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0002611
	speed: 0.5696s/iter; left time: 19938.2575s
	iters: 200, epoch: 16 | loss: 0.0000039
	speed: 0.2857s/iter; left time: 9973.9166s
	iters: 300, epoch: 16 | loss: 0.0000049
	speed: 0.2865s/iter; left time: 9972.3418s
	iters: 400, epoch: 16 | loss: 0.0000097
	speed: 0.2890s/iter; left time: 10029.3481s
Epoch: 16 cost time: 119.36246633529663
Epoch: 16, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.319 Vali Acc: 0.967 Test Loss: 0.319 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.5839s/iter; left time: 20199.2670s
	iters: 200, epoch: 17 | loss: 0.0012824
	speed: 0.3074s/iter; left time: 10602.0539s
	iters: 300, epoch: 17 | loss: 0.0000003
	speed: 0.2989s/iter; left time: 10281.0931s
	iters: 400, epoch: 17 | loss: 0.0600564
	speed: 0.2938s/iter; left time: 10075.3903s
Epoch: 17 cost time: 123.55791568756104
Epoch: 17, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.220 Vali Acc: 0.977 Test Loss: 0.220 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000008
	speed: 0.5607s/iter; left time: 19165.9334s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.2954s/iter; left time: 10066.1367s
	iters: 300, epoch: 18 | loss: 0.1175587
	speed: 0.3167s/iter; left time: 10760.0737s
	iters: 400, epoch: 18 | loss: 0.0000002
	speed: 0.3156s/iter; left time: 10692.3955s
Epoch: 18 cost time: 124.89498686790466
Epoch: 18, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.443 Vali Acc: 0.956 Test Loss: 0.443 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0006598
	speed: 0.6008s/iter; left time: 20286.9861s
	iters: 200, epoch: 19 | loss: 0.0712449
	speed: 0.3208s/iter; left time: 10801.8636s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.3277s/iter; left time: 10999.8675s
	iters: 400, epoch: 19 | loss: 0.0000001
	speed: 0.3127s/iter; left time: 10464.7032s
Epoch: 19 cost time: 131.84195828437805
Epoch: 19, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.542 Vali Acc: 0.944 Test Loss: 0.542 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.7278753
	speed: 0.5878s/iter; left time: 19605.6356s
	iters: 200, epoch: 20 | loss: 0.0000243
	speed: 0.3095s/iter; left time: 10290.6337s
	iters: 300, epoch: 20 | loss: 0.8339108
	speed: 0.3062s/iter; left time: 10151.0501s
	iters: 400, epoch: 20 | loss: 0.0000079
	speed: 0.3088s/iter; left time: 10208.4538s
Epoch: 20 cost time: 127.74143195152283
Epoch: 20, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.232 Vali Acc: 0.977 Test Loss: 0.232 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000002
	speed: 0.6147s/iter; left time: 20248.7027s
	iters: 200, epoch: 21 | loss: 0.0000305
	speed: 0.3153s/iter; left time: 10355.6978s
	iters: 300, epoch: 21 | loss: 0.0000166
	speed: 0.2910s/iter; left time: 9526.4910s
	iters: 400, epoch: 21 | loss: 0.0000002
	speed: 0.2876s/iter; left time: 9386.8392s
Epoch: 21 cost time: 125.26277017593384
Epoch: 21, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.311 Vali Acc: 0.970 Test Loss: 0.311 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000002
	speed: 0.5908s/iter; left time: 19218.6990s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.2959s/iter; left time: 9594.6045s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.2828s/iter; left time: 9141.7361s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.2899s/iter; left time: 9343.8665s
Epoch: 22 cost time: 121.10150218009949
Epoch: 22, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.307 Vali Acc: 0.970 Test Loss: 0.307 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9831741700773079
model parameter : 5732874
model size : 31.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3857835
	speed: 0.3093s/iter; left time: 12744.7959s
	iters: 200, epoch: 1 | loss: 0.2556896
	speed: 0.2860s/iter; left time: 11753.7100s
	iters: 300, epoch: 1 | loss: 0.1556431
	speed: 0.3029s/iter; left time: 12418.1773s
	iters: 400, epoch: 1 | loss: 0.0183254
	speed: 0.3074s/iter; left time: 12573.0020s
Epoch: 1 cost time: 125.12636995315552
Epoch: 1, Steps: 413 | Train Loss: 0.452 Vali Loss: 0.101 Vali Acc: 0.966 Test Loss: 0.101 Test Acc: 0.966
Validation loss decreased (inf --> -0.966347).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0149779
	speed: 0.5963s/iter; left time: 24323.7439s
	iters: 200, epoch: 2 | loss: 0.2505349
	speed: 0.2981s/iter; left time: 12128.2112s
	iters: 300, epoch: 2 | loss: 0.0021089
	speed: 0.3151s/iter; left time: 12789.2479s
	iters: 400, epoch: 2 | loss: 0.0410768
	speed: 0.3088s/iter; left time: 12501.4839s
Epoch: 2 cost time: 127.10114288330078
Epoch: 2, Steps: 413 | Train Loss: 0.112 Vali Loss: 0.202 Vali Acc: 0.950 Test Loss: 0.202 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.3425665
	speed: 0.5701s/iter; left time: 23019.5928s
	iters: 200, epoch: 3 | loss: 0.3100501
	speed: 0.2778s/iter; left time: 11187.4163s
	iters: 300, epoch: 3 | loss: 0.0395367
	speed: 0.3061s/iter; left time: 12297.1745s
	iters: 400, epoch: 3 | loss: 0.0004160
	speed: 0.2913s/iter; left time: 11675.5984s
Epoch: 3 cost time: 120.93108701705933
Epoch: 3, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0009050
	speed: 0.5671s/iter; left time: 22663.6484s
	iters: 200, epoch: 4 | loss: 0.0059554
	speed: 0.3057s/iter; left time: 12187.3005s
	iters: 300, epoch: 4 | loss: 0.0000267
	speed: 0.3086s/iter; left time: 12272.0481s
	iters: 400, epoch: 4 | loss: 0.0389694
	speed: 0.3114s/iter; left time: 12351.6790s
Epoch: 4 cost time: 126.57807660102844
Epoch: 4, Steps: 413 | Train Loss: 0.126 Vali Loss: 0.146 Vali Acc: 0.966 Test Loss: 0.146 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0007790
	speed: 0.5686s/iter; left time: 22486.5781s
	iters: 200, epoch: 5 | loss: 0.0004434
	speed: 0.3034s/iter; left time: 11968.8779s
	iters: 300, epoch: 5 | loss: 0.0470880
	speed: 0.2954s/iter; left time: 11623.8438s
	iters: 400, epoch: 5 | loss: 0.0008503
	speed: 0.2971s/iter; left time: 11662.2918s
Epoch: 5 cost time: 122.47280144691467
Epoch: 5, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.137 Vali Acc: 0.975 Test Loss: 0.137 Test Acc: 0.975
Validation loss decreased (-0.966347 --> -0.974987).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.2143613
	speed: 0.5740s/iter; left time: 22465.2995s
	iters: 200, epoch: 6 | loss: 0.0000048
	speed: 0.3048s/iter; left time: 11898.5130s
	iters: 300, epoch: 6 | loss: 0.0005542
	speed: 0.2975s/iter; left time: 11584.5269s
	iters: 400, epoch: 6 | loss: 0.0015499
	speed: 0.2886s/iter; left time: 11209.3830s
Epoch: 6 cost time: 122.75520849227905
Epoch: 6, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.211 Vali Acc: 0.967 Test Loss: 0.211 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0001583
	speed: 0.6037s/iter; left time: 23377.4889s
	iters: 200, epoch: 7 | loss: 0.0000596
	speed: 0.3077s/iter; left time: 11884.3507s
	iters: 300, epoch: 7 | loss: 0.1714728
	speed: 0.3128s/iter; left time: 12048.3030s
	iters: 400, epoch: 7 | loss: 0.0000024
	speed: 0.3047s/iter; left time: 11706.0636s
Epoch: 7 cost time: 128.17473578453064
Epoch: 7, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.351 Vali Acc: 0.961 Test Loss: 0.351 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000425
	speed: 0.5955s/iter; left time: 22812.5545s
	iters: 200, epoch: 8 | loss: 0.0000042
	speed: 0.2923s/iter; left time: 11167.1438s
	iters: 300, epoch: 8 | loss: 0.2194787
	speed: 0.2843s/iter; left time: 10835.2783s
	iters: 400, epoch: 8 | loss: 0.6142879
	speed: 0.2759s/iter; left time: 10487.3274s
Epoch: 8 cost time: 119.85224747657776
Epoch: 8, Steps: 413 | Train Loss: 0.110 Vali Loss: 0.203 Vali Acc: 0.970 Test Loss: 0.203 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0545003
	speed: 0.5836s/iter; left time: 22115.9595s
	iters: 200, epoch: 9 | loss: 0.0001451
	speed: 0.2922s/iter; left time: 11042.6563s
	iters: 300, epoch: 9 | loss: 0.0018252
	speed: 0.3120s/iter; left time: 11761.3102s
	iters: 400, epoch: 9 | loss: 0.0005535
	speed: 0.3067s/iter; left time: 11529.4340s
Epoch: 9 cost time: 125.90736413002014
Epoch: 9, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.288 Vali Acc: 0.961 Test Loss: 0.288 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0007492
	speed: 0.5892s/iter; left time: 22085.3662s
	iters: 200, epoch: 10 | loss: 0.1321092
	speed: 0.2980s/iter; left time: 11140.7574s
	iters: 300, epoch: 10 | loss: 0.0001406
	speed: 0.3108s/iter; left time: 11588.1275s
	iters: 400, epoch: 10 | loss: 0.1651376
	speed: 0.3082s/iter; left time: 11460.0950s
Epoch: 10 cost time: 126.01031422615051
Epoch: 10, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.256 Vali Acc: 0.975 Test Loss: 0.256 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000001
	speed: 0.5863s/iter; left time: 21732.9566s
	iters: 200, epoch: 11 | loss: 0.0001082
	speed: 0.2952s/iter; left time: 10913.4938s
	iters: 300, epoch: 11 | loss: 0.0000029
	speed: 0.2856s/iter; left time: 10530.6769s
	iters: 400, epoch: 11 | loss: 0.0000013
	speed: 0.3080s/iter; left time: 11326.9633s
Epoch: 11 cost time: 124.02883791923523
Epoch: 11, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.195 Vali Acc: 0.976 Test Loss: 0.195 Test Acc: 0.976
Validation loss decreased (-0.974987 --> -0.975896).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.6023s/iter; left time: 22078.6227s
	iters: 200, epoch: 12 | loss: 0.0000014
	speed: 0.2996s/iter; left time: 10951.1932s
	iters: 300, epoch: 12 | loss: 0.0197462
	speed: 0.3140s/iter; left time: 11449.0049s
	iters: 400, epoch: 12 | loss: 0.1903222
	speed: 0.2952s/iter; left time: 10733.3851s
Epoch: 12 cost time: 125.31533622741699
Epoch: 12, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.298 Vali Acc: 0.972 Test Loss: 0.298 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0010803
	speed: 0.5766s/iter; left time: 20900.3620s
	iters: 200, epoch: 13 | loss: 0.0007703
	speed: 0.3003s/iter; left time: 10854.6991s
	iters: 300, epoch: 13 | loss: 0.0001438
	speed: 0.2853s/iter; left time: 10284.2432s
	iters: 400, epoch: 13 | loss: 0.0000009
	speed: 0.2839s/iter; left time: 10204.7457s
Epoch: 13 cost time: 121.49732160568237
Epoch: 13, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.317 Vali Acc: 0.977 Test Loss: 0.317 Test Acc: 0.977
Validation loss decreased (-0.975896 --> -0.977259).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.5991s/iter; left time: 21467.6013s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.3137s/iter; left time: 11210.3770s
	iters: 300, epoch: 14 | loss: 0.0003567
	speed: 0.3146s/iter; left time: 11211.6000s
	iters: 400, epoch: 14 | loss: 0.0026395
	speed: 0.3247s/iter; left time: 11535.8221s
Epoch: 14 cost time: 130.38014841079712
Epoch: 14, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.145 Vali Acc: 0.981 Test Loss: 0.145 Test Acc: 0.981
Validation loss decreased (-0.977259 --> -0.980899).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0002109
	speed: 0.6051s/iter; left time: 21430.7184s
	iters: 200, epoch: 15 | loss: 0.1929273
	speed: 0.3089s/iter; left time: 10908.5939s
	iters: 300, epoch: 15 | loss: 0.5306751
	speed: 0.3058s/iter; left time: 10770.7998s
	iters: 400, epoch: 15 | loss: 0.0000001
	speed: 0.3012s/iter; left time: 10579.3677s
Epoch: 15 cost time: 127.6121563911438
Epoch: 15, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.204 Vali Acc: 0.971 Test Loss: 0.204 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000054
	speed: 0.5993s/iter; left time: 20979.3898s
	iters: 200, epoch: 16 | loss: 0.0000002
	speed: 0.2868s/iter; left time: 10010.6196s
	iters: 300, epoch: 16 | loss: 0.0839252
	speed: 0.3109s/iter; left time: 10821.2784s
	iters: 400, epoch: 16 | loss: 0.0000264
	speed: 0.3176s/iter; left time: 11022.6661s
Epoch: 16 cost time: 126.68205952644348
Epoch: 16, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.305 Vali Acc: 0.965 Test Loss: 0.305 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000249
	speed: 0.5997s/iter; left time: 20745.3782s
	iters: 200, epoch: 17 | loss: 0.0000001
	speed: 0.3133s/iter; left time: 10806.4723s
	iters: 300, epoch: 17 | loss: 0.6088864
	speed: 0.3015s/iter; left time: 10369.8211s
	iters: 400, epoch: 17 | loss: 0.0000263
	speed: 0.2837s/iter; left time: 9729.9220s
Epoch: 17 cost time: 125.23111867904663
Epoch: 17, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.293 Vali Acc: 0.970 Test Loss: 0.293 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000089
	speed: 0.5697s/iter; left time: 19471.7541s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.2715s/iter; left time: 9251.2492s
	iters: 300, epoch: 18 | loss: 0.0000002
	speed: 0.2913s/iter; left time: 9900.0067s
	iters: 400, epoch: 18 | loss: 0.0001677
	speed: 0.2889s/iter; left time: 9789.3823s
Epoch: 18 cost time: 117.89569783210754
Epoch: 18, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.282 Vali Acc: 0.972 Test Loss: 0.282 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.5587s/iter; left time: 18865.8117s
	iters: 200, epoch: 19 | loss: 0.0000436
	speed: 0.2932s/iter; left time: 9871.9568s
	iters: 300, epoch: 19 | loss: 0.0000015
	speed: 0.2873s/iter; left time: 9642.3497s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.2837s/iter; left time: 9494.7966s
Epoch: 19 cost time: 118.8026020526886
Epoch: 19, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.284 Vali Acc: 0.971 Test Loss: 0.284 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000117
	speed: 0.5521s/iter; left time: 18415.1191s
	iters: 200, epoch: 20 | loss: 0.2011971
	speed: 0.2761s/iter; left time: 9182.2304s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.2679s/iter; left time: 8880.3203s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.2781s/iter; left time: 9192.9926s
Epoch: 20 cost time: 114.86504769325256
Epoch: 20, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.255 Vali Acc: 0.972 Test Loss: 0.255 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0000237
	speed: 0.5335s/iter; left time: 17572.6187s
	iters: 200, epoch: 21 | loss: 0.0121146
	speed: 0.2847s/iter; left time: 9349.8972s
	iters: 300, epoch: 21 | loss: 0.0000001
	speed: 0.2937s/iter; left time: 9616.9934s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.2818s/iter; left time: 9199.0824s
Epoch: 21 cost time: 116.10754776000977
Epoch: 21, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.166 Vali Acc: 0.982 Test Loss: 0.166 Test Acc: 0.982
Validation loss decreased (-0.980899 --> -0.982263).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.5588s/iter; left time: 18177.9327s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.2926s/iter; left time: 9489.3039s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.2884s/iter; left time: 9323.5361s
	iters: 400, epoch: 22 | loss: 0.0000019
	speed: 0.2790s/iter; left time: 8991.3465s
Epoch: 22 cost time: 118.97896146774292
Epoch: 22, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.206 Vali Acc: 0.975 Test Loss: 0.206 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.5423s/iter; left time: 17415.2509s
	iters: 200, epoch: 23 | loss: 0.0074483
	speed: 0.2592s/iter; left time: 8299.2316s
	iters: 300, epoch: 23 | loss: 0.0000004
	speed: 0.2719s/iter; left time: 8678.5336s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.2773s/iter; left time: 8821.6694s
Epoch: 23 cost time: 110.80447387695312
Epoch: 23, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.281 Vali Acc: 0.977 Test Loss: 0.281 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0000002
	speed: 0.5307s/iter; left time: 16823.3083s
	iters: 200, epoch: 24 | loss: 0.0001287
	speed: 0.2885s/iter; left time: 9116.0647s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.2825s/iter; left time: 8898.9332s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.2730s/iter; left time: 8572.7038s
Epoch: 24 cost time: 115.81216669082642
Epoch: 24, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.180 Vali Acc: 0.980 Test Loss: 0.180 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0005691
	speed: 0.5735s/iter; left time: 17945.7101s
	iters: 200, epoch: 25 | loss: 0.0004034
	speed: 0.2960s/iter; left time: 9231.0357s
	iters: 300, epoch: 25 | loss: 0.0046066
	speed: 0.2708s/iter; left time: 8420.0367s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.2899s/iter; left time: 8982.5137s
Epoch: 25 cost time: 119.35190916061401
Epoch: 25, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.206 Vali Acc: 0.978 Test Loss: 0.206 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0003159
	speed: 0.5375s/iter; left time: 16596.1411s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.2776s/iter; left time: 8544.8588s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.2918s/iter; left time: 8952.3822s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.2725s/iter; left time: 8332.0927s
Epoch: 26 cost time: 115.0635392665863
Epoch: 26, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.404 Vali Acc: 0.967 Test Loss: 0.404 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0006084
	speed: 0.5613s/iter; left time: 17098.5436s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.2992s/iter; left time: 9083.7270s
	iters: 300, epoch: 27 | loss: 0.0000069
	speed: 0.2796s/iter; left time: 8462.7848s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.2891s/iter; left time: 8720.1542s
Epoch: 27 cost time: 120.47889685630798
Epoch: 27, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.315 Vali Acc: 0.966 Test Loss: 0.315 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0000001
	speed: 0.5724s/iter; left time: 17201.4258s
	iters: 200, epoch: 28 | loss: 0.0000168
	speed: 0.2631s/iter; left time: 7879.7811s
	iters: 300, epoch: 28 | loss: 0.0000003
	speed: 0.2807s/iter; left time: 8377.4525s
	iters: 400, epoch: 28 | loss: 0.0000003
	speed: 0.2760s/iter; left time: 8211.3878s
Epoch: 28 cost time: 114.51841688156128
Epoch: 28, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.452 Vali Acc: 0.968 Test Loss: 0.452 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0000011
	speed: 0.5188s/iter; left time: 15376.2530s
	iters: 200, epoch: 29 | loss: 0.0000252
	speed: 0.2834s/iter; left time: 8369.6883s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.2688s/iter; left time: 7912.2244s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.2555s/iter; left time: 7496.6485s
Epoch: 29 cost time: 111.12164449691772
Epoch: 29, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.239 Vali Acc: 0.979 Test Loss: 0.239 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.5375s/iter; left time: 15708.6824s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.2896s/iter; left time: 8433.5117s
	iters: 300, epoch: 30 | loss: 0.0000011
	speed: 0.2713s/iter; left time: 7874.5614s
	iters: 400, epoch: 30 | loss: 0.0000097
	speed: 0.2988s/iter; left time: 8642.7857s
Epoch: 30 cost time: 118.82168984413147
Epoch: 30, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.251 Vali Acc: 0.974 Test Loss: 0.251 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.5665s/iter; left time: 16320.4557s
	iters: 200, epoch: 31 | loss: 0.0000011
	speed: 0.2809s/iter; left time: 8063.4978s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.2802s/iter; left time: 8017.7435s
	iters: 400, epoch: 31 | loss: 0.0099102
	speed: 0.2877s/iter; left time: 8201.7827s
Epoch: 31 cost time: 117.82842993736267
Epoch: 31, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.223 Vali Acc: 0.974 Test Loss: 0.223 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9822646657571623
model parameter : 5732874
model size : 31.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5558046
	speed: 0.3051s/iter; left time: 12569.0632s
	iters: 200, epoch: 1 | loss: 0.1792469
	speed: 0.2847s/iter; left time: 11699.4033s
	iters: 300, epoch: 1 | loss: 0.1821866
	speed: 0.3054s/iter; left time: 12522.1477s
	iters: 400, epoch: 1 | loss: 0.0174632
	speed: 0.2888s/iter; left time: 11811.4624s
Epoch: 1 cost time: 122.6829583644867
Epoch: 1, Steps: 413 | Train Loss: 0.578 Vali Loss: 0.164 Vali Acc: 0.952 Test Loss: 0.164 Test Acc: 0.952
Validation loss decreased (inf --> -0.951795).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0125321
	speed: 0.5790s/iter; left time: 23616.6805s
	iters: 200, epoch: 2 | loss: 0.3048279
	speed: 0.2903s/iter; left time: 11811.8225s
	iters: 300, epoch: 2 | loss: 0.0048758
	speed: 0.3042s/iter; left time: 12346.9614s
	iters: 400, epoch: 2 | loss: 0.0039787
	speed: 0.2726s/iter; left time: 11037.7324s
Epoch: 2 cost time: 118.93261504173279
Epoch: 2, Steps: 413 | Train Loss: 0.153 Vali Loss: 0.175 Vali Acc: 0.955 Test Loss: 0.175 Test Acc: 0.955
Validation loss decreased (-0.951795 --> -0.955433).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0489396
	speed: 0.5682s/iter; left time: 22942.0360s
	iters: 200, epoch: 3 | loss: 0.0017106
	speed: 0.2784s/iter; left time: 11212.0870s
	iters: 300, epoch: 3 | loss: 0.2274159
	speed: 0.2826s/iter; left time: 11355.3489s
	iters: 400, epoch: 3 | loss: 0.0005446
	speed: 0.2889s/iter; left time: 11576.6360s
Epoch: 3 cost time: 117.8189024925232
Epoch: 3, Steps: 413 | Train Loss: 0.149 Vali Loss: 0.231 Vali Acc: 0.947 Test Loss: 0.231 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0146611
	speed: 0.5834s/iter; left time: 23312.3737s
	iters: 200, epoch: 4 | loss: 0.0001473
	speed: 0.2982s/iter; left time: 11887.8334s
	iters: 300, epoch: 4 | loss: 0.0001981
	speed: 0.2991s/iter; left time: 11892.7398s
	iters: 400, epoch: 4 | loss: 0.0002701
	speed: 0.2788s/iter; left time: 11058.4635s
Epoch: 4 cost time: 120.5695321559906
Epoch: 4, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.338 Vali Acc: 0.941 Test Loss: 0.338 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0423047
	speed: 0.5718s/iter; left time: 22613.8857s
	iters: 200, epoch: 5 | loss: 0.0049463
	speed: 0.3073s/iter; left time: 12123.0210s
	iters: 300, epoch: 5 | loss: 0.2903718
	speed: 0.2785s/iter; left time: 10959.9735s
	iters: 400, epoch: 5 | loss: 0.0381960
	speed: 0.2855s/iter; left time: 11205.0887s
Epoch: 5 cost time: 120.09740567207336
Epoch: 5, Steps: 413 | Train Loss: 0.133 Vali Loss: 0.275 Vali Acc: 0.952 Test Loss: 0.275 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.2660355
	speed: 0.5603s/iter; left time: 21929.1353s
	iters: 200, epoch: 6 | loss: 0.0000062
	speed: 0.2979s/iter; left time: 11630.2567s
	iters: 300, epoch: 6 | loss: 0.1096010
	speed: 0.2930s/iter; left time: 11407.6763s
	iters: 400, epoch: 6 | loss: 0.0002746
	speed: 0.2999s/iter; left time: 11645.8174s
Epoch: 6 cost time: 121.31006288528442
Epoch: 6, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.265 Vali Acc: 0.961 Test Loss: 0.265 Test Acc: 0.961
Validation loss decreased (-0.955433 --> -0.960889).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000027
	speed: 0.5766s/iter; left time: 22329.0238s
	iters: 200, epoch: 7 | loss: 0.0107294
	speed: 0.3107s/iter; left time: 11999.8882s
	iters: 300, epoch: 7 | loss: 0.5248556
	speed: 0.2904s/iter; left time: 11187.6387s
	iters: 400, epoch: 7 | loss: 0.0000753
	speed: 0.2969s/iter; left time: 11406.4725s
Epoch: 7 cost time: 123.17360091209412
Epoch: 7, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.232 Vali Acc: 0.961 Test Loss: 0.232 Test Acc: 0.961
Validation loss decreased (-0.960889 --> -0.960889).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000414
	speed: 0.5785s/iter; left time: 22160.7127s
	iters: 200, epoch: 8 | loss: 0.0054931
	speed: 0.3019s/iter; left time: 11536.4743s
	iters: 300, epoch: 8 | loss: 0.0009064
	speed: 0.3002s/iter; left time: 11438.9179s
	iters: 400, epoch: 8 | loss: 0.0021362
	speed: 0.2973s/iter; left time: 11301.3150s
Epoch: 8 cost time: 123.10002446174622
Epoch: 8, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.286 Vali Acc: 0.957 Test Loss: 0.286 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0018588
	speed: 0.5649s/iter; left time: 21409.6479s
	iters: 200, epoch: 9 | loss: 0.0087023
	speed: 0.3018s/iter; left time: 11405.3145s
	iters: 300, epoch: 9 | loss: 0.4892436
	speed: 0.2866s/iter; left time: 10802.1508s
	iters: 400, epoch: 9 | loss: 0.0007360
	speed: 0.3089s/iter; left time: 11613.7150s
Epoch: 9 cost time: 123.11090970039368
Epoch: 9, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.225 Vali Acc: 0.971 Test Loss: 0.225 Test Acc: 0.971
Validation loss decreased (-0.960889 --> -0.971348).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000011
	speed: 0.5918s/iter; left time: 22183.1755s
	iters: 200, epoch: 10 | loss: 0.0000074
	speed: 0.2857s/iter; left time: 10682.1946s
	iters: 300, epoch: 10 | loss: 0.8360447
	speed: 0.2814s/iter; left time: 10492.8231s
	iters: 400, epoch: 10 | loss: 0.0008927
	speed: 0.3003s/iter; left time: 11165.6843s
Epoch: 10 cost time: 121.52239489555359
Epoch: 10, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.204 Vali Acc: 0.972 Test Loss: 0.204 Test Acc: 0.972
Validation loss decreased (-0.971348 --> -0.971803).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000015
	speed: 0.5672s/iter; left time: 21027.0670s
	iters: 200, epoch: 11 | loss: 0.7265192
	speed: 0.2831s/iter; left time: 10467.4183s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.2827s/iter; left time: 10423.9667s
	iters: 400, epoch: 11 | loss: 0.0000164
	speed: 0.2882s/iter; left time: 10598.9834s
Epoch: 11 cost time: 119.08278203010559
Epoch: 11, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.218 Vali Acc: 0.972 Test Loss: 0.218 Test Acc: 0.972
Validation loss decreased (-0.971803 --> -0.972258).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000003
	speed: 0.5579s/iter; left time: 20453.1943s
	iters: 200, epoch: 12 | loss: 0.0000011
	speed: 0.2823s/iter; left time: 10322.0348s
	iters: 300, epoch: 12 | loss: 0.3292938
	speed: 0.2862s/iter; left time: 10436.0765s
	iters: 400, epoch: 12 | loss: 0.0144294
	speed: 0.2944s/iter; left time: 10705.5525s
Epoch: 12 cost time: 119.4543309211731
Epoch: 12, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.207 Vali Acc: 0.974 Test Loss: 0.207 Test Acc: 0.974
Validation loss decreased (-0.972258 --> -0.974077).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000005
	speed: 0.5590s/iter; left time: 20261.9640s
	iters: 200, epoch: 13 | loss: 0.0003808
	speed: 0.2809s/iter; left time: 10154.2769s
	iters: 300, epoch: 13 | loss: 0.0000016
	speed: 0.2721s/iter; left time: 9807.8041s
	iters: 400, epoch: 13 | loss: 0.0000063
	speed: 0.2767s/iter; left time: 9947.0104s
Epoch: 13 cost time: 115.28247165679932
Epoch: 13, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.317 Vali Acc: 0.964 Test Loss: 0.317 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000002
	speed: 0.5522s/iter; left time: 19786.5697s
	iters: 200, epoch: 14 | loss: 0.0012228
	speed: 0.2872s/iter; left time: 10261.7108s
	iters: 300, epoch: 14 | loss: 0.0000002
	speed: 0.2830s/iter; left time: 10085.4942s
	iters: 400, epoch: 14 | loss: 1.0347675
	speed: 0.2837s/iter; left time: 10080.4911s
Epoch: 14 cost time: 118.22928190231323
Epoch: 14, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.164 Vali Acc: 0.975 Test Loss: 0.164 Test Acc: 0.975
Validation loss decreased (-0.974077 --> -0.975442).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.5651s/iter; left time: 20016.6458s
	iters: 200, epoch: 15 | loss: 0.0000114
	speed: 0.2920s/iter; left time: 10313.3790s
	iters: 300, epoch: 15 | loss: 0.0000001
	speed: 0.2820s/iter; left time: 9930.3809s
	iters: 400, epoch: 15 | loss: 0.0000193
	speed: 0.2753s/iter; left time: 9668.2541s
Epoch: 15 cost time: 115.99561023712158
Epoch: 15, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.263 Vali Acc: 0.966 Test Loss: 0.263 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.5229058
	speed: 0.5373s/iter; left time: 18809.3053s
	iters: 200, epoch: 16 | loss: 0.0000001
	speed: 0.2906s/iter; left time: 10145.3270s
	iters: 300, epoch: 16 | loss: 0.0000001
	speed: 0.2932s/iter; left time: 10205.0276s
	iters: 400, epoch: 16 | loss: 0.0110595
	speed: 0.2886s/iter; left time: 10015.8537s
Epoch: 16 cost time: 118.39381217956543
Epoch: 16, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.217 Vali Acc: 0.973 Test Loss: 0.217 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000063
	speed: 0.5588s/iter; left time: 19331.5863s
	iters: 200, epoch: 17 | loss: 0.6195837
	speed: 0.2638s/iter; left time: 9100.1659s
	iters: 300, epoch: 17 | loss: 0.0018552
	speed: 0.2857s/iter; left time: 9824.5188s
	iters: 400, epoch: 17 | loss: 0.0000001
	speed: 0.2774s/iter; left time: 9513.9936s
Epoch: 17 cost time: 114.61024951934814
Epoch: 17, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.179 Vali Acc: 0.980 Test Loss: 0.179 Test Acc: 0.980
Validation loss decreased (-0.975442 --> -0.979534).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000002
	speed: 0.5461s/iter; left time: 18666.8153s
	iters: 200, epoch: 18 | loss: 0.8930945
	speed: 0.2777s/iter; left time: 9464.6095s
	iters: 300, epoch: 18 | loss: 0.0000014
	speed: 0.2717s/iter; left time: 9231.2175s
	iters: 400, epoch: 18 | loss: 0.0000037
	speed: 0.2769s/iter; left time: 9382.5642s
Epoch: 18 cost time: 114.44568967819214
Epoch: 18, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.216 Vali Acc: 0.976 Test Loss: 0.216 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0080097
	speed: 0.5718s/iter; left time: 19308.1270s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.2724s/iter; left time: 9172.0937s
	iters: 300, epoch: 19 | loss: 0.0000126
	speed: 0.2752s/iter; left time: 9238.4689s
	iters: 400, epoch: 19 | loss: 0.0000002
	speed: 0.2831s/iter; left time: 9475.7613s
Epoch: 19 cost time: 115.7111406326294
Epoch: 19, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.116 Vali Acc: 0.984 Test Loss: 0.116 Test Acc: 0.984
Validation loss decreased (-0.979534 --> -0.983628).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0012371
	speed: 0.5719s/iter; left time: 19076.7646s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.2843s/iter; left time: 9454.3172s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.2779s/iter; left time: 9213.1727s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.2817s/iter; left time: 9309.7834s
Epoch: 20 cost time: 117.55829095840454
Epoch: 20, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.211 Vali Acc: 0.979 Test Loss: 0.211 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000017
	speed: 0.5904s/iter; left time: 19448.2019s
	iters: 200, epoch: 21 | loss: 0.0006504
	speed: 0.2888s/iter; left time: 9485.3486s
	iters: 300, epoch: 21 | loss: 0.0000002
	speed: 0.2770s/iter; left time: 9068.9271s
	iters: 400, epoch: 21 | loss: 0.0000007
	speed: 0.2843s/iter; left time: 9280.0534s
Epoch: 21 cost time: 118.94019627571106
Epoch: 21, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.268 Vali Acc: 0.970 Test Loss: 0.268 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000184
	speed: 0.5733s/iter; left time: 18648.9122s
	iters: 200, epoch: 22 | loss: 0.0463314
	speed: 0.2918s/iter; left time: 9462.7619s
	iters: 300, epoch: 22 | loss: 0.1521939
	speed: 0.2894s/iter; left time: 9357.1319s
	iters: 400, epoch: 22 | loss: 0.0018066
	speed: 0.2837s/iter; left time: 9144.6321s
Epoch: 22 cost time: 119.68523049354553
Epoch: 22, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.243 Vali Acc: 0.973 Test Loss: 0.243 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.3372670
	speed: 0.5485s/iter; left time: 17615.0818s
	iters: 200, epoch: 23 | loss: 0.0000708
	speed: 0.2868s/iter; left time: 9182.9933s
	iters: 300, epoch: 23 | loss: 0.5914721
	speed: 0.2853s/iter; left time: 9104.9856s
	iters: 400, epoch: 23 | loss: 0.0000002
	speed: 0.2847s/iter; left time: 9058.4350s
Epoch: 23 cost time: 118.07897305488586
Epoch: 23, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.223 Vali Acc: 0.976 Test Loss: 0.223 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.5796s/iter; left time: 18373.6469s
	iters: 200, epoch: 24 | loss: 0.0000007
	speed: 0.2940s/iter; left time: 9290.7421s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.2899s/iter; left time: 9132.1955s
	iters: 400, epoch: 24 | loss: 0.0000006
	speed: 0.2773s/iter; left time: 8708.4495s
Epoch: 24 cost time: 119.26926183700562
Epoch: 24, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.207 Vali Acc: 0.975 Test Loss: 0.207 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.5506s/iter; left time: 17227.7744s
	iters: 200, epoch: 25 | loss: 0.0002771
	speed: 0.2870s/iter; left time: 8951.4416s
	iters: 300, epoch: 25 | loss: 0.1008952
	speed: 0.2921s/iter; left time: 9082.2301s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.2830s/iter; left time: 8769.4230s
Epoch: 25 cost time: 117.89729976654053
Epoch: 25, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.136 Vali Acc: 0.980 Test Loss: 0.136 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.5708s/iter; left time: 17624.1094s
	iters: 200, epoch: 26 | loss: 0.0000849
	speed: 0.2867s/iter; left time: 8822.3138s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.2887s/iter; left time: 8855.1152s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.2986s/iter; left time: 9131.3845s
Epoch: 26 cost time: 121.27254009246826
Epoch: 26, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.233 Vali Acc: 0.975 Test Loss: 0.233 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.5707s/iter; left time: 17386.5861s
	iters: 200, epoch: 27 | loss: 0.0000028
	speed: 0.2872s/iter; left time: 8721.4602s
	iters: 300, epoch: 27 | loss: 0.0005577
	speed: 0.2954s/iter; left time: 8939.5519s
	iters: 400, epoch: 27 | loss: 0.0000005
	speed: 0.2850s/iter; left time: 8597.0909s
Epoch: 27 cost time: 118.77027988433838
Epoch: 27, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.175 Vali Acc: 0.978 Test Loss: 0.175 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.5611s/iter; left time: 16860.8640s
	iters: 200, epoch: 28 | loss: 0.0000001
	speed: 0.2762s/iter; left time: 8271.0669s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.2784s/iter; left time: 8310.1062s
	iters: 400, epoch: 28 | loss: 0.0008298
	speed: 0.2913s/iter; left time: 8667.2978s
Epoch: 28 cost time: 116.95707988739014
Epoch: 28, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.129 Vali Acc: 0.981 Test Loss: 0.129 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.5741s/iter; left time: 17013.2209s
	iters: 200, epoch: 29 | loss: 0.0450593
	speed: 0.2783s/iter; left time: 8220.2927s
	iters: 300, epoch: 29 | loss: 0.0000010
	speed: 0.2776s/iter; left time: 8172.5872s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.2694s/iter; left time: 7904.1520s
Epoch: 29 cost time: 116.02539610862732
Epoch: 29, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.150 Vali Acc: 0.980 Test Loss: 0.150 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9836289222373806
model parameter : 5732874
model size : 31.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6892118
	speed: 0.2927s/iter; left time: 12057.8461s
	iters: 200, epoch: 1 | loss: 0.1028966
	speed: 0.2771s/iter; left time: 11389.9324s
	iters: 300, epoch: 1 | loss: 0.1465954
	speed: 0.2660s/iter; left time: 10907.1994s
	iters: 400, epoch: 1 | loss: 0.0386301
	speed: 0.2919s/iter; left time: 11940.7964s
Epoch: 1 cost time: 116.78533005714417
Epoch: 1, Steps: 413 | Train Loss: 0.620 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
Validation loss decreased (inf --> -0.948611).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0364048
	speed: 0.5689s/iter; left time: 23204.5708s
	iters: 200, epoch: 2 | loss: 0.4031343
	speed: 0.2852s/iter; left time: 11603.2178s
	iters: 300, epoch: 2 | loss: 0.0117523
	speed: 0.2843s/iter; left time: 11538.1998s
	iters: 400, epoch: 2 | loss: 0.0003639
	speed: 0.2907s/iter; left time: 11769.4938s
Epoch: 2 cost time: 119.24586796760559
Epoch: 2, Steps: 413 | Train Loss: 0.150 Vali Loss: 0.157 Vali Acc: 0.966 Test Loss: 0.157 Test Acc: 0.966
Validation loss decreased (-0.948611 --> -0.966347).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0790783
	speed: 0.5606s/iter; left time: 22635.4855s
	iters: 200, epoch: 3 | loss: 0.1579783
	speed: 0.2759s/iter; left time: 11110.1804s
	iters: 300, epoch: 3 | loss: 0.5101194
	speed: 0.2686s/iter; left time: 10789.2229s
	iters: 400, epoch: 3 | loss: 0.3297577
	speed: 0.2668s/iter; left time: 10690.1284s
Epoch: 3 cost time: 113.96989035606384
Epoch: 3, Steps: 413 | Train Loss: 0.144 Vali Loss: 0.165 Vali Acc: 0.959 Test Loss: 0.165 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0023841
	speed: 0.5717s/iter; left time: 22847.9308s
	iters: 200, epoch: 4 | loss: 0.0029523
	speed: 0.2921s/iter; left time: 11644.8384s
	iters: 300, epoch: 4 | loss: 0.0207695
	speed: 0.2835s/iter; left time: 11272.0028s
	iters: 400, epoch: 4 | loss: 0.0026745
	speed: 0.2911s/iter; left time: 11547.4923s
Epoch: 4 cost time: 120.71333861351013
Epoch: 4, Steps: 413 | Train Loss: 0.138 Vali Loss: 0.202 Vali Acc: 0.968 Test Loss: 0.202 Test Acc: 0.968
Validation loss decreased (-0.966347 --> -0.968165).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1545743
	speed: 0.5796s/iter; left time: 22920.7734s
	iters: 200, epoch: 5 | loss: 0.0000016
	speed: 0.2843s/iter; left time: 11216.5755s
	iters: 300, epoch: 5 | loss: 0.0866892
	speed: 0.2898s/iter; left time: 11405.0905s
	iters: 400, epoch: 5 | loss: 0.3860646
	speed: 0.2730s/iter; left time: 10713.7000s
Epoch: 5 cost time: 118.73564505577087
Epoch: 5, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.382 Vali Acc: 0.953 Test Loss: 0.382 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0145083
	speed: 0.5453s/iter; left time: 21339.0226s
	iters: 200, epoch: 6 | loss: 0.0000058
	speed: 0.2833s/iter; left time: 11058.1777s
	iters: 300, epoch: 6 | loss: 0.0031343
	speed: 0.2761s/iter; left time: 10750.9914s
	iters: 400, epoch: 6 | loss: 0.2513342
	speed: 0.2708s/iter; left time: 10514.8707s
Epoch: 6 cost time: 114.53150033950806
Epoch: 6, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.127 Vali Acc: 0.972 Test Loss: 0.127 Test Acc: 0.972
Validation loss decreased (-0.968165 --> -0.971804).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000345
	speed: 0.5387s/iter; left time: 20860.7732s
	iters: 200, epoch: 7 | loss: 0.0585155
	speed: 0.2895s/iter; left time: 11181.4140s
	iters: 300, epoch: 7 | loss: 0.3525928
	speed: 0.2889s/iter; left time: 11128.4075s
	iters: 400, epoch: 7 | loss: 0.6813679
	speed: 0.2900s/iter; left time: 11142.0869s
Epoch: 7 cost time: 117.9381148815155
Epoch: 7, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.243 Vali Acc: 0.959 Test Loss: 0.243 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000207
	speed: 0.5398s/iter; left time: 20679.0079s
	iters: 200, epoch: 8 | loss: 0.0018774
	speed: 0.2891s/iter; left time: 11047.4282s
	iters: 300, epoch: 8 | loss: 0.0267548
	speed: 0.2955s/iter; left time: 11261.0492s
	iters: 400, epoch: 8 | loss: 0.0643397
	speed: 0.2770s/iter; left time: 10528.5084s
Epoch: 8 cost time: 118.06549000740051
Epoch: 8, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.322 Vali Acc: 0.958 Test Loss: 0.322 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0282624
	speed: 0.5356s/iter; left time: 20297.9744s
	iters: 200, epoch: 9 | loss: 0.0029550
	speed: 0.2738s/iter; left time: 10348.4792s
	iters: 300, epoch: 9 | loss: 0.7529042
	speed: 0.2787s/iter; left time: 10507.5805s
	iters: 400, epoch: 9 | loss: 0.1867688
	speed: 0.2854s/iter; left time: 10731.0425s
Epoch: 9 cost time: 114.49509263038635
Epoch: 9, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.377 Vali Acc: 0.945 Test Loss: 0.377 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000001
	speed: 0.5577s/iter; left time: 20903.8225s
	iters: 200, epoch: 10 | loss: 0.1219756
	speed: 0.2957s/iter; left time: 11054.4786s
	iters: 300, epoch: 10 | loss: 0.6020733
	speed: 0.2878s/iter; left time: 10729.0576s
	iters: 400, epoch: 10 | loss: 0.0000277
	speed: 0.2927s/iter; left time: 10883.9605s
Epoch: 10 cost time: 120.83282232284546
Epoch: 10, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.308 Vali Acc: 0.965 Test Loss: 0.308 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000014
	speed: 0.5654s/iter; left time: 20958.1175s
	iters: 200, epoch: 11 | loss: 0.0000002
	speed: 0.2732s/iter; left time: 10100.6087s
	iters: 300, epoch: 11 | loss: 0.0000001
	speed: 0.2657s/iter; left time: 9797.3664s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.2753s/iter; left time: 10124.0050s
Epoch: 11 cost time: 113.7888171672821
Epoch: 11, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.286 Vali Acc: 0.966 Test Loss: 0.286 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000931
	speed: 0.5606s/iter; left time: 20550.1744s
	iters: 200, epoch: 12 | loss: 0.0000084
	speed: 0.2681s/iter; left time: 9800.0143s
	iters: 300, epoch: 12 | loss: 0.0000043
	speed: 0.2952s/iter; left time: 10762.5452s
	iters: 400, epoch: 12 | loss: 0.3479780
	speed: 0.3055s/iter; left time: 11105.8918s
Epoch: 12 cost time: 120.56867837905884
Epoch: 12, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.198 Vali Acc: 0.975 Test Loss: 0.198 Test Acc: 0.975
Validation loss decreased (-0.971804 --> -0.975441).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0491247
	speed: 0.5912s/iter; left time: 21426.6123s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.2941s/iter; left time: 10628.9837s
	iters: 300, epoch: 13 | loss: 0.4850535
	speed: 0.2941s/iter; left time: 10600.1447s
	iters: 400, epoch: 13 | loss: 0.0000013
	speed: 0.2781s/iter; left time: 9997.5471s
Epoch: 13 cost time: 121.91181445121765
Epoch: 13, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.282 Vali Acc: 0.963 Test Loss: 0.282 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0018025
	speed: 0.5719s/iter; left time: 20492.8342s
	iters: 200, epoch: 14 | loss: 0.0000113
	speed: 0.2736s/iter; left time: 9775.3064s
	iters: 300, epoch: 14 | loss: 0.0008448
	speed: 0.2735s/iter; left time: 9744.2696s
	iters: 400, epoch: 14 | loss: 0.9761550
	speed: 0.2872s/iter; left time: 10205.8988s
Epoch: 14 cost time: 116.43283033370972
Epoch: 14, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.350 Vali Acc: 0.960 Test Loss: 0.350 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.5572s/iter; left time: 19734.0119s
	iters: 200, epoch: 15 | loss: 0.0815736
	speed: 0.2914s/iter; left time: 10293.5806s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.2842s/iter; left time: 10008.0344s
	iters: 400, epoch: 15 | loss: 0.0000004
	speed: 0.2882s/iter; left time: 10121.4796s
Epoch: 15 cost time: 120.21392369270325
Epoch: 15, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.296 Vali Acc: 0.964 Test Loss: 0.296 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000013
	speed: 0.5741s/iter; left time: 20096.0898s
	iters: 200, epoch: 16 | loss: 0.0000880
	speed: 0.2902s/iter; left time: 10128.4991s
	iters: 300, epoch: 16 | loss: 0.0000001
	speed: 0.2675s/iter; left time: 9310.7467s
	iters: 400, epoch: 16 | loss: 0.0000244
	speed: 0.2780s/iter; left time: 9647.1317s
Epoch: 16 cost time: 116.82769274711609
Epoch: 16, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.172 Vali Acc: 0.975 Test Loss: 0.172 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000500
	speed: 0.5284s/iter; left time: 18280.1482s
	iters: 200, epoch: 17 | loss: 0.0002027
	speed: 0.2761s/iter; left time: 9521.9187s
	iters: 300, epoch: 17 | loss: 0.0000002
	speed: 0.2814s/iter; left time: 9678.6132s
	iters: 400, epoch: 17 | loss: 0.0000950
	speed: 0.2873s/iter; left time: 9853.3779s
Epoch: 17 cost time: 116.76477241516113
Epoch: 17, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.155 Vali Acc: 0.975 Test Loss: 0.155 Test Acc: 0.975
Validation loss decreased (-0.975441 --> -0.975442).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.5433s/iter; left time: 18570.5594s
	iters: 200, epoch: 18 | loss: 0.0000459
	speed: 0.2852s/iter; left time: 9720.9334s
	iters: 300, epoch: 18 | loss: 0.0000004
	speed: 0.2908s/iter; left time: 9880.4158s
	iters: 400, epoch: 18 | loss: 0.0059760
	speed: 0.2817s/iter; left time: 9542.7642s
Epoch: 18 cost time: 117.30673360824585
Epoch: 18, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.190 Vali Acc: 0.974 Test Loss: 0.190 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000092
	speed: 0.5052s/iter; left time: 17058.5342s
	iters: 200, epoch: 19 | loss: 0.0001380
	speed: 0.2780s/iter; left time: 9358.2281s
	iters: 300, epoch: 19 | loss: 0.1524861
	speed: 0.3004s/iter; left time: 10084.7153s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.2653s/iter; left time: 8879.7489s
Epoch: 19 cost time: 114.69370341300964
Epoch: 19, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.370 Vali Acc: 0.959 Test Loss: 0.370 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.1690205
	speed: 0.5270s/iter; left time: 17576.7309s
	iters: 200, epoch: 20 | loss: 0.0001480
	speed: 0.2978s/iter; left time: 9904.3432s
	iters: 300, epoch: 20 | loss: 0.0000020
	speed: 0.2862s/iter; left time: 9487.2921s
	iters: 400, epoch: 20 | loss: 0.0621657
	speed: 0.2876s/iter; left time: 9505.2277s
Epoch: 20 cost time: 119.99497103691101
Epoch: 20, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.542 Vali Acc: 0.961 Test Loss: 0.542 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.4523385
	speed: 0.5750s/iter; left time: 18941.0606s
	iters: 200, epoch: 21 | loss: 0.0000001
	speed: 0.2765s/iter; left time: 9081.2411s
	iters: 300, epoch: 21 | loss: 0.7488106
	speed: 0.2659s/iter; left time: 8706.1346s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.2736s/iter; left time: 8929.3178s
Epoch: 21 cost time: 114.69944667816162
Epoch: 21, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.156 Vali Acc: 0.982 Test Loss: 0.156 Test Acc: 0.982
Validation loss decreased (-0.975442 --> -0.982263).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0000003
	speed: 0.5199s/iter; left time: 16910.9730s
	iters: 200, epoch: 22 | loss: 0.0001244
	speed: 0.2641s/iter; left time: 8565.2810s
	iters: 300, epoch: 22 | loss: 0.0000001
	speed: 0.2714s/iter; left time: 8773.7150s
	iters: 400, epoch: 22 | loss: 0.0015933
	speed: 0.2944s/iter; left time: 9488.7530s
Epoch: 22 cost time: 113.65079426765442
Epoch: 22, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.353 Vali Acc: 0.957 Test Loss: 0.353 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0000002
	speed: 0.5707s/iter; left time: 18329.3745s
	iters: 200, epoch: 23 | loss: 0.0000009
	speed: 0.2796s/iter; left time: 8952.5490s
	iters: 300, epoch: 23 | loss: 0.2560796
	speed: 0.2860s/iter; left time: 9129.1547s
	iters: 400, epoch: 23 | loss: 0.0042941
	speed: 0.2785s/iter; left time: 8861.6101s
Epoch: 23 cost time: 117.0147635936737
Epoch: 23, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.358 Vali Acc: 0.965 Test Loss: 0.358 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0000001
	speed: 0.5307s/iter; left time: 16825.6278s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.2700s/iter; left time: 8532.1045s
	iters: 300, epoch: 24 | loss: 0.0000002
	speed: 0.2723s/iter; left time: 8579.4358s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.2907s/iter; left time: 9129.9536s
Epoch: 24 cost time: 113.55179238319397
Epoch: 24, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.168 Vali Acc: 0.981 Test Loss: 0.168 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.5290s/iter; left time: 16552.9034s
	iters: 200, epoch: 25 | loss: 0.0014507
	speed: 0.2660s/iter; left time: 8295.4191s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.2955s/iter; left time: 9187.6938s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.3011s/iter; left time: 9331.9296s
Epoch: 25 cost time: 116.64300632476807
Epoch: 25, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.159 Vali Acc: 0.983 Test Loss: 0.159 Test Acc: 0.983
Validation loss decreased (-0.982263 --> -0.983173).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0000018
	speed: 0.5427s/iter; left time: 16755.2337s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.2829s/iter; left time: 8706.1304s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.2938s/iter; left time: 9014.1405s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.2700s/iter; left time: 8256.8510s
Epoch: 26 cost time: 116.02322196960449
Epoch: 26, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.141 Vali Acc: 0.986 Test Loss: 0.141 Test Acc: 0.986
Validation loss decreased (-0.983173 --> -0.985901).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0000782
	speed: 0.5267s/iter; left time: 16044.7981s
	iters: 200, epoch: 27 | loss: 0.0000009
	speed: 0.2978s/iter; left time: 9042.2492s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.2964s/iter; left time: 8970.0095s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.2828s/iter; left time: 8530.3832s
Epoch: 27 cost time: 117.79595494270325
Epoch: 27, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.141 Vali Acc: 0.985 Test Loss: 0.141 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.5422s/iter; left time: 16293.2233s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.2915s/iter; left time: 8731.2322s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.2774s/iter; left time: 8280.8401s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.2670s/iter; left time: 7944.0897s
Epoch: 28 cost time: 115.67065358161926
Epoch: 28, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.985 Test Loss: 0.142 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.5419s/iter; left time: 16059.4379s
	iters: 200, epoch: 29 | loss: 0.0000464
	speed: 0.2857s/iter; left time: 8439.7529s
	iters: 300, epoch: 29 | loss: 0.0000006
	speed: 0.2943s/iter; left time: 8663.4508s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.2710s/iter; left time: 7949.4252s
Epoch: 29 cost time: 117.08752965927124
Epoch: 29, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.985 Test Loss: 0.142 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.5551s/iter; left time: 16223.5039s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.2666s/iter; left time: 7763.6212s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.2839s/iter; left time: 8241.0186s
	iters: 400, epoch: 30 | loss: 0.0000002
	speed: 0.2910s/iter; left time: 8417.3005s
Epoch: 30 cost time: 117.41911959648132
Epoch: 30, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.145 Vali Acc: 0.985 Test Loss: 0.145 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.5590s/iter; left time: 16105.4982s
	iters: 200, epoch: 31 | loss: 0.0000002
	speed: 0.2791s/iter; left time: 8012.4275s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.2788s/iter; left time: 7975.5811s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.2817s/iter; left time: 8030.2942s
Epoch: 31 cost time: 115.78997135162354
Epoch: 31, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.145 Vali Acc: 0.985 Test Loss: 0.145 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.5295s/iter; left time: 15037.7104s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.2682s/iter; left time: 7590.1063s
	iters: 300, epoch: 32 | loss: 0.0000004
	speed: 0.2871s/iter; left time: 8094.9501s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.2981s/iter; left time: 8376.1877s
Epoch: 32 cost time: 116.01296901702881
Epoch: 32, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.144 Vali Acc: 0.985 Test Loss: 0.144 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0000001
	speed: 0.5477s/iter; left time: 15327.9011s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.2882s/iter; left time: 8035.9788s
	iters: 300, epoch: 33 | loss: 0.0000001
	speed: 0.2958s/iter; left time: 8218.8111s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.2855s/iter; left time: 7903.4995s
Epoch: 33 cost time: 118.7509548664093
Epoch: 33, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.143 Vali Acc: 0.985 Test Loss: 0.143 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.5274s/iter; left time: 14540.8884s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.2722s/iter; left time: 7476.6646s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.2679s/iter; left time: 7332.3802s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.2816s/iter; left time: 7678.8663s
Epoch: 34 cost time: 114.58913350105286
Epoch: 34, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.985 Test Loss: 0.142 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.5746s/iter; left time: 15606.1019s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.3002s/iter; left time: 8123.9926s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.2866s/iter; left time: 7725.8670s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.2794s/iter; left time: 7504.2876s
Epoch: 35 cost time: 120.65528440475464
Epoch: 35, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.985 Test Loss: 0.142 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.5315s/iter; left time: 14215.2794s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.2899s/iter; left time: 7725.4472s
	iters: 300, epoch: 36 | loss: 0.0000012
	speed: 0.2492s/iter; left time: 6616.3528s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.2444s/iter; left time: 6463.1096s
Epoch: 36 cost time: 110.44781684875488
Epoch: 36, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.985 Test Loss: 0.142 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9859026830377444
model parameter : 5732874
model size : 31.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4798804
	speed: 0.3031s/iter; left time: 12486.0645s
	iters: 200, epoch: 1 | loss: 0.0534672
	speed: 0.2795s/iter; left time: 11489.3494s
	iters: 300, epoch: 1 | loss: 0.0411251
	speed: 0.2898s/iter; left time: 11880.3617s
	iters: 400, epoch: 1 | loss: 0.0065798
	speed: 0.2848s/iter; left time: 11647.2260s
Epoch: 1 cost time: 120.09093260765076
Epoch: 1, Steps: 413 | Train Loss: 0.616 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
Validation loss decreased (inf --> -0.953614).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0644533
	speed: 0.5659s/iter; left time: 23083.1835s
	iters: 200, epoch: 2 | loss: 0.4778593
	speed: 0.2582s/iter; left time: 10506.8947s
	iters: 300, epoch: 2 | loss: 0.0562288
	speed: 0.2726s/iter; left time: 11065.3374s
	iters: 400, epoch: 2 | loss: 0.0007649
	speed: 0.2893s/iter; left time: 11712.8335s
Epoch: 2 cost time: 114.31563901901245
Epoch: 2, Steps: 413 | Train Loss: 0.176 Vali Loss: 0.191 Vali Acc: 0.949 Test Loss: 0.191 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1634036
	speed: 0.5284s/iter; left time: 21333.4186s
	iters: 200, epoch: 3 | loss: 0.1021737
	speed: 0.2621s/iter; left time: 10555.6062s
	iters: 300, epoch: 3 | loss: 0.1692917
	speed: 0.2889s/iter; left time: 11604.6734s
	iters: 400, epoch: 3 | loss: 0.0353814
	speed: 0.3036s/iter; left time: 12168.7165s
Epoch: 3 cost time: 115.75589513778687
Epoch: 3, Steps: 413 | Train Loss: 0.170 Vali Loss: 0.186 Vali Acc: 0.962 Test Loss: 0.186 Test Acc: 0.962
Validation loss decreased (-0.953614 --> -0.961799).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000067
	speed: 0.5577s/iter; left time: 22284.9310s
	iters: 200, epoch: 4 | loss: 0.0002242
	speed: 0.2940s/iter; left time: 11720.7697s
	iters: 300, epoch: 4 | loss: 0.0076731
	speed: 0.2878s/iter; left time: 11442.1737s
	iters: 400, epoch: 4 | loss: 0.0044591
	speed: 0.2759s/iter; left time: 10942.2889s
Epoch: 4 cost time: 118.42992067337036
Epoch: 4, Steps: 413 | Train Loss: 0.153 Vali Loss: 0.219 Vali Acc: 0.954 Test Loss: 0.219 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.4063827
	speed: 0.5306s/iter; left time: 20983.9236s
	iters: 200, epoch: 5 | loss: 0.0001631
	speed: 0.2941s/iter; left time: 11600.9929s
	iters: 300, epoch: 5 | loss: 0.5957091
	speed: 0.3117s/iter; left time: 12265.6244s
	iters: 400, epoch: 5 | loss: 0.6765435
	speed: 0.2837s/iter; left time: 11134.3468s
Epoch: 5 cost time: 120.2624614238739
Epoch: 5, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.260 Vali Acc: 0.953 Test Loss: 0.260 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0013733
	speed: 0.5608s/iter; left time: 21948.4228s
	iters: 200, epoch: 6 | loss: 0.0002844
	speed: 0.3135s/iter; left time: 12237.1205s
	iters: 300, epoch: 6 | loss: 0.0013948
	speed: 0.2864s/iter; left time: 11151.7271s
	iters: 400, epoch: 6 | loss: 0.0093184
	speed: 0.2849s/iter; left time: 11066.2436s
Epoch: 6 cost time: 121.55697679519653
Epoch: 6, Steps: 413 | Train Loss: 0.140 Vali Loss: 0.166 Vali Acc: 0.965 Test Loss: 0.166 Test Acc: 0.965
Validation loss decreased (-0.961799 --> -0.964982).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1812970
	speed: 0.5763s/iter; left time: 22314.7104s
	iters: 200, epoch: 7 | loss: 0.0002628
	speed: 0.2928s/iter; left time: 11308.8849s
	iters: 300, epoch: 7 | loss: 0.3786302
	speed: 0.2717s/iter; left time: 10466.7661s
	iters: 400, epoch: 7 | loss: 0.0000180
	speed: 0.3003s/iter; left time: 11539.9495s
Epoch: 7 cost time: 120.89641785621643
Epoch: 7, Steps: 413 | Train Loss: 0.120 Vali Loss: 0.413 Vali Acc: 0.952 Test Loss: 0.413 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000049
	speed: 0.5692s/iter; left time: 21805.9672s
	iters: 200, epoch: 8 | loss: 0.0001098
	speed: 0.2894s/iter; left time: 11058.0120s
	iters: 300, epoch: 8 | loss: 0.0001008
	speed: 0.2908s/iter; left time: 11081.6029s
	iters: 400, epoch: 8 | loss: 0.0012624
	speed: 0.3034s/iter; left time: 11534.0479s
Epoch: 8 cost time: 122.06500387191772
Epoch: 8, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.301 Vali Acc: 0.949 Test Loss: 0.301 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0634078
	speed: 0.5890s/iter; left time: 22320.6437s
	iters: 200, epoch: 9 | loss: 0.0000049
	speed: 0.2812s/iter; left time: 10626.7637s
	iters: 300, epoch: 9 | loss: 0.0373846
	speed: 0.2879s/iter; left time: 10854.2363s
	iters: 400, epoch: 9 | loss: 0.0004818
	speed: 0.2942s/iter; left time: 11061.9344s
Epoch: 9 cost time: 121.71096754074097
Epoch: 9, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.442 Vali Acc: 0.947 Test Loss: 0.442 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000054
	speed: 0.5522s/iter; left time: 20700.4295s
	iters: 200, epoch: 10 | loss: 0.0000138
	speed: 0.2862s/iter; left time: 10699.3986s
	iters: 300, epoch: 10 | loss: 0.0043897
	speed: 0.2925s/iter; left time: 10905.8829s
	iters: 400, epoch: 10 | loss: 0.0003922
	speed: 0.2921s/iter; left time: 10862.8676s
Epoch: 10 cost time: 119.35817885398865
Epoch: 10, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.354 Vali Acc: 0.954 Test Loss: 0.354 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000002
	speed: 0.5789s/iter; left time: 21461.3452s
	iters: 200, epoch: 11 | loss: 0.0000034
	speed: 0.2993s/iter; left time: 11064.3576s
	iters: 300, epoch: 11 | loss: 0.0067266
	speed: 0.2879s/iter; left time: 10613.7096s
	iters: 400, epoch: 11 | loss: 0.0000020
	speed: 0.2987s/iter; left time: 10982.2667s
Epoch: 11 cost time: 122.26162600517273
Epoch: 11, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.192 Vali Acc: 0.968 Test Loss: 0.192 Test Acc: 0.968
Validation loss decreased (-0.964982 --> -0.967711).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0001391
	speed: 0.5834s/iter; left time: 21385.9895s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.2898s/iter; left time: 10593.9159s
	iters: 300, epoch: 12 | loss: 0.0000103
	speed: 0.2927s/iter; left time: 10672.9644s
	iters: 400, epoch: 12 | loss: 0.0040911
	speed: 0.2768s/iter; left time: 10064.2019s
Epoch: 12 cost time: 119.65181541442871
Epoch: 12, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.292 Vali Acc: 0.959 Test Loss: 0.292 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0018760
	speed: 0.5742s/iter; left time: 20812.8841s
	iters: 200, epoch: 13 | loss: 0.0000011
	speed: 0.3003s/iter; left time: 10855.9306s
	iters: 300, epoch: 13 | loss: 0.4147541
	speed: 0.2909s/iter; left time: 10486.8416s
	iters: 400, epoch: 13 | loss: 0.0011208
	speed: 0.3015s/iter; left time: 10838.8766s
Epoch: 13 cost time: 123.79807162284851
Epoch: 13, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.395 Vali Acc: 0.950 Test Loss: 0.395 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000003
	speed: 0.5521s/iter; left time: 19781.2625s
	iters: 200, epoch: 14 | loss: 0.0396430
	speed: 0.2755s/iter; left time: 9845.6820s
	iters: 300, epoch: 14 | loss: 0.0000054
	speed: 0.2943s/iter; left time: 10486.0999s
	iters: 400, epoch: 14 | loss: 0.0002759
	speed: 0.2753s/iter; left time: 9782.8787s
Epoch: 14 cost time: 114.76230049133301
Epoch: 14, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.169 Vali Acc: 0.969 Test Loss: 0.169 Test Acc: 0.969
Validation loss decreased (-0.967711 --> -0.969075).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000007
	speed: 0.5426s/iter; left time: 19219.1047s
	iters: 200, epoch: 15 | loss: 0.0000738
	speed: 0.2905s/iter; left time: 10259.0874s
	iters: 300, epoch: 15 | loss: 0.2808512
	speed: 0.2708s/iter; left time: 9537.1414s
	iters: 400, epoch: 15 | loss: 0.0001105
	speed: 0.2941s/iter; left time: 10327.9098s
Epoch: 15 cost time: 118.73164772987366
Epoch: 15, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.260 Vali Acc: 0.957 Test Loss: 0.260 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000001
	speed: 0.5834s/iter; left time: 20423.0187s
	iters: 200, epoch: 16 | loss: 0.0245790
	speed: 0.2668s/iter; left time: 9314.3391s
	iters: 300, epoch: 16 | loss: 0.0000178
	speed: 0.2830s/iter; left time: 9850.5397s
	iters: 400, epoch: 16 | loss: 0.0403152
	speed: 0.2899s/iter; left time: 10059.9427s
Epoch: 16 cost time: 118.09886312484741
Epoch: 16, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.303 Vali Acc: 0.960 Test Loss: 0.303 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000307
	speed: 0.5123s/iter; left time: 17721.8803s
	iters: 200, epoch: 17 | loss: 0.0001424
	speed: 0.3086s/iter; left time: 10643.9097s
	iters: 300, epoch: 17 | loss: 0.0000001
	speed: 0.2802s/iter; left time: 9636.3456s
	iters: 400, epoch: 17 | loss: 0.0002700
	speed: 0.2730s/iter; left time: 9362.3372s
Epoch: 17 cost time: 117.54315519332886
Epoch: 17, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.198 Vali Acc: 0.968 Test Loss: 0.198 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000002
	speed: 0.5857s/iter; left time: 20020.4421s
	iters: 200, epoch: 18 | loss: 0.0001194
	speed: 0.2961s/iter; left time: 10089.4830s
	iters: 300, epoch: 18 | loss: 0.0000001
	speed: 0.2916s/iter; left time: 9910.1011s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.3019s/iter; left time: 10227.2773s
Epoch: 18 cost time: 123.07951307296753
Epoch: 18, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.217 Vali Acc: 0.967 Test Loss: 0.217 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0028950
	speed: 0.5324s/iter; left time: 17977.9359s
	iters: 200, epoch: 19 | loss: 0.0001095
	speed: 0.3069s/iter; left time: 10332.4896s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.2697s/iter; left time: 9052.4933s
	iters: 400, epoch: 19 | loss: 0.0000125
	speed: 0.2814s/iter; left time: 9417.7033s
Epoch: 19 cost time: 116.74045538902283
Epoch: 19, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.108 Vali Acc: 0.982 Test Loss: 0.108 Test Acc: 0.982
Validation loss decreased (-0.969075 --> -0.981809).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0002088
	speed: 0.5862s/iter; left time: 19552.6590s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.2896s/iter; left time: 9630.9295s
	iters: 300, epoch: 20 | loss: 0.0055826
	speed: 0.2913s/iter; left time: 9658.7426s
	iters: 400, epoch: 20 | loss: 0.0000002
	speed: 0.3036s/iter; left time: 10035.5332s
Epoch: 20 cost time: 122.39814472198486
Epoch: 20, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.365 Vali Acc: 0.956 Test Loss: 0.365 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000055
	speed: 0.5567s/iter; left time: 18339.2518s
	iters: 200, epoch: 21 | loss: 0.0000154
	speed: 0.2952s/iter; left time: 9695.5005s
	iters: 300, epoch: 21 | loss: 0.0107316
	speed: 0.2834s/iter; left time: 9278.3906s
	iters: 400, epoch: 21 | loss: 0.0160301
	speed: 0.2753s/iter; left time: 8986.0559s
Epoch: 21 cost time: 118.14603328704834
Epoch: 21, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.337 Vali Acc: 0.959 Test Loss: 0.337 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000073
	speed: 0.5694s/iter; left time: 18520.6651s
	iters: 200, epoch: 22 | loss: 0.0092085
	speed: 0.2951s/iter; left time: 9570.7320s
	iters: 300, epoch: 22 | loss: 0.0000001
	speed: 0.2768s/iter; left time: 8949.7922s
	iters: 400, epoch: 22 | loss: 0.0006209
	speed: 0.3085s/iter; left time: 9940.7337s
Epoch: 22 cost time: 121.96371221542358
Epoch: 22, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.185 Vali Acc: 0.971 Test Loss: 0.185 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0000092
	speed: 0.5549s/iter; left time: 17819.5224s
	iters: 200, epoch: 23 | loss: 0.0000026
	speed: 0.2910s/iter; left time: 9315.9445s
	iters: 300, epoch: 23 | loss: 0.0006244
	speed: 0.3056s/iter; left time: 9754.1407s
	iters: 400, epoch: 23 | loss: 0.0000010
	speed: 0.2615s/iter; left time: 8318.3375s
Epoch: 23 cost time: 117.58153080940247
Epoch: 23, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.152 Vali Acc: 0.976 Test Loss: 0.152 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0000001
	speed: 0.5538s/iter; left time: 17557.4823s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.2962s/iter; left time: 9361.1531s
	iters: 300, epoch: 24 | loss: 0.0009411
	speed: 0.2879s/iter; left time: 9068.7751s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.2955s/iter; left time: 9279.8877s
Epoch: 24 cost time: 121.97359013557434
Epoch: 24, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.157 Vali Acc: 0.979 Test Loss: 0.157 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.4885594
	speed: 0.5694s/iter; left time: 17817.2326s
	iters: 200, epoch: 25 | loss: 0.0039902
	speed: 0.2826s/iter; left time: 8812.7552s
	iters: 300, epoch: 25 | loss: 0.0000002
	speed: 0.2997s/iter; left time: 9316.0840s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.2805s/iter; left time: 8691.2077s
Epoch: 25 cost time: 119.19088625907898
Epoch: 25, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.181 Vali Acc: 0.976 Test Loss: 0.181 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0021235
	speed: 0.5694s/iter; left time: 17580.6921s
	iters: 200, epoch: 26 | loss: 0.0000001
	speed: 0.2963s/iter; left time: 9117.8100s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.2810s/iter; left time: 8618.4705s
	iters: 400, epoch: 26 | loss: 0.0001113
	speed: 0.2947s/iter; left time: 9010.9143s
Epoch: 26 cost time: 121.64725852012634
Epoch: 26, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.233 Vali Acc: 0.969 Test Loss: 0.233 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0000002
	speed: 0.5704s/iter; left time: 17376.3422s
	iters: 200, epoch: 27 | loss: 0.0000014
	speed: 0.2836s/iter; left time: 8610.4497s
	iters: 300, epoch: 27 | loss: 0.0000001
	speed: 0.3074s/iter; left time: 9303.1935s
	iters: 400, epoch: 27 | loss: 0.0000099
	speed: 0.2826s/iter; left time: 8525.3976s
Epoch: 27 cost time: 119.14986801147461
Epoch: 27, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.198 Vali Acc: 0.970 Test Loss: 0.198 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0000004
	speed: 0.5519s/iter; left time: 16583.2107s
	iters: 200, epoch: 28 | loss: 0.0000029
	speed: 0.2975s/iter; left time: 8911.6216s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.2748s/iter; left time: 8202.0112s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.2713s/iter; left time: 8072.1249s
Epoch: 28 cost time: 117.94305777549744
Epoch: 28, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.152 Vali Acc: 0.976 Test Loss: 0.152 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.5838s/iter; left time: 17303.0618s
	iters: 200, epoch: 29 | loss: 0.0001590
	speed: 0.2649s/iter; left time: 7823.5003s
	iters: 300, epoch: 29 | loss: 0.0000062
	speed: 0.2763s/iter; left time: 8134.5800s
	iters: 400, epoch: 29 | loss: 0.0016299
	speed: 0.3012s/iter; left time: 8837.2258s
Epoch: 29 cost time: 118.03415870666504
Epoch: 29, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.171 Vali Acc: 0.973 Test Loss: 0.171 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9818099135970896
model parameter : 5732874
model size : 31.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5293775
	speed: 0.3148s/iter; left time: 12969.8717s
	iters: 200, epoch: 1 | loss: 0.0662916
	speed: 0.2830s/iter; left time: 11633.5118s
	iters: 300, epoch: 1 | loss: 0.1029639
	speed: 0.2891s/iter; left time: 11852.5270s
	iters: 400, epoch: 1 | loss: 0.0142731
	speed: 0.2820s/iter; left time: 11535.6922s
Epoch: 1 cost time: 120.88262939453125
Epoch: 1, Steps: 413 | Train Loss: 0.597 Vali Loss: 0.146 Vali Acc: 0.951 Test Loss: 0.146 Test Acc: 0.951
Validation loss decreased (inf --> -0.950885).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0128926
	speed: 0.5598s/iter; left time: 22832.5525s
	iters: 200, epoch: 2 | loss: 0.3390972
	speed: 0.3047s/iter; left time: 12396.5786s
	iters: 300, epoch: 2 | loss: 0.0134125
	speed: 0.2910s/iter; left time: 11811.8027s
	iters: 400, epoch: 2 | loss: 0.0055073
	speed: 0.2707s/iter; left time: 10960.5422s
Epoch: 2 cost time: 119.4471549987793
Epoch: 2, Steps: 413 | Train Loss: 0.150 Vali Loss: 0.158 Vali Acc: 0.955 Test Loss: 0.158 Test Acc: 0.955
Validation loss decreased (-0.950885 --> -0.955433).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0081804
	speed: 0.5722s/iter; left time: 23104.4648s
	iters: 200, epoch: 3 | loss: 0.4285780
	speed: 0.2998s/iter; left time: 12074.3565s
	iters: 300, epoch: 3 | loss: 0.3986585
	speed: 0.2859s/iter; left time: 11484.7058s
	iters: 400, epoch: 3 | loss: 0.0013723
	speed: 0.2933s/iter; left time: 11753.3352s
Epoch: 3 cost time: 120.94841194152832
Epoch: 3, Steps: 413 | Train Loss: 0.159 Vali Loss: 0.171 Vali Acc: 0.959 Test Loss: 0.171 Test Acc: 0.959
Validation loss decreased (-0.955433 --> -0.958616).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0055855
	speed: 0.5591s/iter; left time: 22340.8206s
	iters: 200, epoch: 4 | loss: 0.0199875
	speed: 0.3003s/iter; left time: 11970.2312s
	iters: 300, epoch: 4 | loss: 0.2334840
	speed: 0.2852s/iter; left time: 11340.3712s
	iters: 400, epoch: 4 | loss: 0.0921498
	speed: 0.2828s/iter; left time: 11214.6971s
Epoch: 4 cost time: 119.08564686775208
Epoch: 4, Steps: 413 | Train Loss: 0.147 Vali Loss: 0.191 Vali Acc: 0.957 Test Loss: 0.191 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2624939
	speed: 0.5430s/iter; left time: 21476.2135s
	iters: 200, epoch: 5 | loss: 0.0000215
	speed: 0.2786s/iter; left time: 10990.3862s
	iters: 300, epoch: 5 | loss: 0.0058200
	speed: 0.2867s/iter; left time: 11282.4155s
	iters: 400, epoch: 5 | loss: 0.6049058
	speed: 0.2955s/iter; left time: 11598.9664s
Epoch: 5 cost time: 117.96573972702026
Epoch: 5, Steps: 413 | Train Loss: 0.120 Vali Loss: 0.345 Vali Acc: 0.947 Test Loss: 0.345 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0403412
	speed: 0.5545s/iter; left time: 21702.5864s
	iters: 200, epoch: 6 | loss: 0.0000182
	speed: 0.2916s/iter; left time: 11383.7572s
	iters: 300, epoch: 6 | loss: 0.0619960
	speed: 0.2844s/iter; left time: 11074.8830s
	iters: 400, epoch: 6 | loss: 0.0073311
	speed: 0.2909s/iter; left time: 11298.7088s
Epoch: 6 cost time: 120.17056822776794
Epoch: 6, Steps: 413 | Train Loss: 0.120 Vali Loss: 0.358 Vali Acc: 0.945 Test Loss: 0.358 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000676
	speed: 0.5768s/iter; left time: 22336.9549s
	iters: 200, epoch: 7 | loss: 0.0003756
	speed: 0.2789s/iter; left time: 10771.5552s
	iters: 300, epoch: 7 | loss: 0.0000558
	speed: 0.2814s/iter; left time: 10840.9323s
	iters: 400, epoch: 7 | loss: 0.0002346
	speed: 0.2944s/iter; left time: 11309.8518s
Epoch: 7 cost time: 119.16045355796814
Epoch: 7, Steps: 413 | Train Loss: 0.121 Vali Loss: 0.144 Vali Acc: 0.973 Test Loss: 0.144 Test Acc: 0.973
Validation loss decreased (-0.958616 --> -0.973168).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000122
	speed: 0.5490s/iter; left time: 21031.2044s
	iters: 200, epoch: 8 | loss: 0.0003231
	speed: 0.2819s/iter; left time: 10772.5951s
	iters: 300, epoch: 8 | loss: 0.1913264
	speed: 0.2933s/iter; left time: 11176.0710s
	iters: 400, epoch: 8 | loss: 0.0019101
	speed: 0.2910s/iter; left time: 11062.6269s
Epoch: 8 cost time: 119.43675637245178
Epoch: 8, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.276 Vali Acc: 0.963 Test Loss: 0.276 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0052405
	speed: 0.5845s/iter; left time: 22152.5829s
	iters: 200, epoch: 9 | loss: 0.0000077
	speed: 0.2845s/iter; left time: 10754.7004s
	iters: 300, epoch: 9 | loss: 0.0585575
	speed: 0.3052s/iter; left time: 11506.4188s
	iters: 400, epoch: 9 | loss: 0.0391453
	speed: 0.2707s/iter; left time: 10178.6036s
Epoch: 9 cost time: 119.77545380592346
Epoch: 9, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.405 Vali Acc: 0.958 Test Loss: 0.405 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000249
	speed: 0.5558s/iter; left time: 20832.1844s
	iters: 200, epoch: 10 | loss: 0.1761381
	speed: 0.2772s/iter; left time: 10363.5091s
	iters: 300, epoch: 10 | loss: 0.8264475
	speed: 0.2917s/iter; left time: 10876.6581s
	iters: 400, epoch: 10 | loss: 0.0014927
	speed: 0.2888s/iter; left time: 10740.2636s
Epoch: 10 cost time: 118.5407383441925
Epoch: 10, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.303 Vali Acc: 0.952 Test Loss: 0.303 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0005807
	speed: 0.5858s/iter; left time: 21715.7974s
	iters: 200, epoch: 11 | loss: 0.0000008
	speed: 0.2950s/iter; left time: 10907.2440s
	iters: 300, epoch: 11 | loss: 0.0000605
	speed: 0.2918s/iter; left time: 10757.1798s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.3001s/iter; left time: 11033.1528s
Epoch: 11 cost time: 122.00609040260315
Epoch: 11, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.156 Vali Acc: 0.972 Test Loss: 0.156 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0553487
	speed: 0.5617s/iter; left time: 20590.4176s
	iters: 200, epoch: 12 | loss: 0.0000127
	speed: 0.3013s/iter; left time: 11014.9035s
	iters: 300, epoch: 12 | loss: 0.1641911
	speed: 0.2693s/iter; left time: 9819.1885s
	iters: 400, epoch: 12 | loss: 0.0089949
	speed: 0.2907s/iter; left time: 10569.4490s
Epoch: 12 cost time: 119.26807451248169
Epoch: 12, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.385 Vali Acc: 0.962 Test Loss: 0.385 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0007678
	speed: 0.5455s/iter; left time: 19772.3930s
	iters: 200, epoch: 13 | loss: 0.0000027
	speed: 0.2871s/iter; left time: 10375.7094s
	iters: 300, epoch: 13 | loss: 0.0000001
	speed: 0.2739s/iter; left time: 9873.0723s
	iters: 400, epoch: 13 | loss: 0.0000721
	speed: 0.3046s/iter; left time: 10949.6649s
Epoch: 13 cost time: 117.97855257987976
Epoch: 13, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.221 Vali Acc: 0.965 Test Loss: 0.221 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0000006
	speed: 0.5692s/iter; left time: 20394.6836s
	iters: 200, epoch: 14 | loss: 0.0000023
	speed: 0.2958s/iter; left time: 10568.6171s
	iters: 300, epoch: 14 | loss: 0.0000001
	speed: 0.2839s/iter; left time: 10117.5186s
	iters: 400, epoch: 14 | loss: 0.0024016
	speed: 0.2674s/iter; left time: 9500.9452s
Epoch: 14 cost time: 118.4562737941742
Epoch: 14, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.253 Vali Acc: 0.966 Test Loss: 0.253 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0000011
	speed: 0.5448s/iter; left time: 19294.5752s
	iters: 200, epoch: 15 | loss: 0.0088874
	speed: 0.2884s/iter; left time: 10187.7607s
	iters: 300, epoch: 15 | loss: 0.0022027
	speed: 0.2894s/iter; left time: 10193.3391s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.2883s/iter; left time: 10125.3469s
Epoch: 15 cost time: 118.2003526687622
Epoch: 15, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.188 Vali Acc: 0.970 Test Loss: 0.188 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0000015
	speed: 0.5525s/iter; left time: 19342.2219s
	iters: 200, epoch: 16 | loss: 0.0000001
	speed: 0.3032s/iter; left time: 10582.6699s
	iters: 300, epoch: 16 | loss: 0.0000381
	speed: 0.3050s/iter; left time: 10614.1460s
	iters: 400, epoch: 16 | loss: 0.1540158
	speed: 0.2814s/iter; left time: 9767.4597s
Epoch: 16 cost time: 122.1351215839386
Epoch: 16, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.251 Vali Acc: 0.971 Test Loss: 0.251 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0591049
	speed: 0.5466s/iter; left time: 18908.6019s
	iters: 200, epoch: 17 | loss: 0.0000488
	speed: 0.2899s/iter; left time: 9999.8501s
	iters: 300, epoch: 17 | loss: 0.0000028
	speed: 0.3010s/iter; left time: 10352.6695s
	iters: 400, epoch: 17 | loss: 0.0006288
	speed: 0.2871s/iter; left time: 9844.2561s
Epoch: 17 cost time: 120.6064190864563
Epoch: 17, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.134 Vali Acc: 0.979 Test Loss: 0.134 Test Acc: 0.979
Validation loss decreased (-0.973168 --> -0.979080).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000431
	speed: 0.5425s/iter; left time: 18540.9695s
	iters: 200, epoch: 18 | loss: 0.4690887
	speed: 0.2865s/iter; left time: 9765.0164s
	iters: 300, epoch: 18 | loss: 0.0000003
	speed: 0.2922s/iter; left time: 9928.8421s
	iters: 400, epoch: 18 | loss: 0.0001024
	speed: 0.2885s/iter; left time: 9773.9582s
Epoch: 18 cost time: 118.94168066978455
Epoch: 18, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.190 Vali Acc: 0.975 Test Loss: 0.190 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0058464
	speed: 0.5413s/iter; left time: 18276.5082s
	iters: 200, epoch: 19 | loss: 0.0000003
	speed: 0.2809s/iter; left time: 9455.8340s
	iters: 300, epoch: 19 | loss: 0.0001093
	speed: 0.2911s/iter; left time: 9770.2355s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.2906s/iter; left time: 9724.8793s
Epoch: 19 cost time: 117.27625226974487
Epoch: 19, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.215 Vali Acc: 0.972 Test Loss: 0.215 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0224336
	speed: 0.5342s/iter; left time: 17818.8551s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.2802s/iter; left time: 9318.4554s
	iters: 300, epoch: 20 | loss: 0.0000374
	speed: 0.2857s/iter; left time: 9472.5438s
	iters: 400, epoch: 20 | loss: 0.0001684
	speed: 0.2877s/iter; left time: 9510.7457s
Epoch: 20 cost time: 117.05278253555298
Epoch: 20, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.251 Vali Acc: 0.972 Test Loss: 0.251 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0935341
	speed: 0.5350s/iter; left time: 17622.7740s
	iters: 200, epoch: 21 | loss: 0.0000011
	speed: 0.2699s/iter; left time: 8863.7587s
	iters: 300, epoch: 21 | loss: 0.0024023
	speed: 0.2710s/iter; left time: 8872.1694s
	iters: 400, epoch: 21 | loss: 0.0000019
	speed: 0.2839s/iter; left time: 9267.8928s
Epoch: 21 cost time: 113.31516623497009
Epoch: 21, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.239 Vali Acc: 0.971 Test Loss: 0.239 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.5507s/iter; left time: 17912.8396s
	iters: 200, epoch: 22 | loss: 0.2221142
	speed: 0.2766s/iter; left time: 8970.1970s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.2706s/iter; left time: 8747.9914s
	iters: 400, epoch: 22 | loss: 0.0000656
	speed: 0.2816s/iter; left time: 9075.9450s
Epoch: 22 cost time: 114.48660707473755
Epoch: 22, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.249 Vali Acc: 0.968 Test Loss: 0.249 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0000048
	speed: 0.5526s/iter; left time: 17748.3523s
	iters: 200, epoch: 23 | loss: 0.0085948
	speed: 0.2709s/iter; left time: 8671.8346s
	iters: 300, epoch: 23 | loss: 0.0000004
	speed: 0.2820s/iter; left time: 8999.5271s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.2784s/iter; left time: 8858.6141s
Epoch: 23 cost time: 115.36384296417236
Epoch: 23, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.493 Vali Acc: 0.956 Test Loss: 0.493 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0000005
	speed: 0.5866s/iter; left time: 18596.5967s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.2911s/iter; left time: 9200.3275s
	iters: 300, epoch: 24 | loss: 0.0000001
	speed: 0.2933s/iter; left time: 9238.1739s
	iters: 400, epoch: 24 | loss: 0.0000084
	speed: 0.2843s/iter; left time: 8929.0380s
Epoch: 24 cost time: 120.68148517608643
Epoch: 24, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.248 Vali Acc: 0.976 Test Loss: 0.248 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0000001
	speed: 0.5593s/iter; left time: 17500.9708s
	iters: 200, epoch: 25 | loss: 0.0057006
	speed: 0.2806s/iter; left time: 8752.8214s
	iters: 300, epoch: 25 | loss: 0.0000059
	speed: 0.2780s/iter; left time: 8642.0274s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.2660s/iter; left time: 8244.5452s
Epoch: 25 cost time: 115.06585049629211
Epoch: 25, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.183 Vali Acc: 0.980 Test Loss: 0.183 Test Acc: 0.980
Validation loss decreased (-0.979080 --> -0.979989).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0000001
	speed: 0.5631s/iter; left time: 17385.5051s
	iters: 200, epoch: 26 | loss: 0.0000024
	speed: 0.2873s/iter; left time: 8840.4899s
	iters: 300, epoch: 26 | loss: 0.0001141
	speed: 0.2832s/iter; left time: 8686.2693s
	iters: 400, epoch: 26 | loss: 0.0000001
	speed: 0.2750s/iter; left time: 8409.6318s
Epoch: 26 cost time: 118.22475337982178
Epoch: 26, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.263 Vali Acc: 0.960 Test Loss: 0.263 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0001971
	speed: 0.5488s/iter; left time: 16718.2574s
	iters: 200, epoch: 27 | loss: 0.0000011
	speed: 0.2833s/iter; left time: 8601.8988s
	iters: 300, epoch: 27 | loss: 0.0000002
	speed: 0.2703s/iter; left time: 8179.6686s
	iters: 400, epoch: 27 | loss: 0.6525449
	speed: 0.2558s/iter; left time: 7716.1267s
Epoch: 27 cost time: 112.8042242527008
Epoch: 27, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.183 Vali Acc: 0.970 Test Loss: 0.183 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.5460s/iter; left time: 16406.4114s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.2866s/iter; left time: 8584.7143s
	iters: 300, epoch: 28 | loss: 0.0000003
	speed: 0.2902s/iter; left time: 8661.1056s
	iters: 400, epoch: 28 | loss: 0.0000005
	speed: 0.2889s/iter; left time: 8595.4489s
Epoch: 28 cost time: 118.69330763816833
Epoch: 28, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.284 Vali Acc: 0.970 Test Loss: 0.284 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0000012
	speed: 0.5482s/iter; left time: 16247.3068s
	iters: 200, epoch: 29 | loss: 0.0000009
	speed: 0.2888s/iter; left time: 8529.5853s
	iters: 300, epoch: 29 | loss: 0.0004552
	speed: 0.2853s/iter; left time: 8397.3778s
	iters: 400, epoch: 29 | loss: 0.0000001
	speed: 0.2800s/iter; left time: 8214.9759s
Epoch: 29 cost time: 117.06004285812378
Epoch: 29, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.190 Vali Acc: 0.975 Test Loss: 0.190 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.0000004
	speed: 0.5481s/iter; left time: 16018.5416s
	iters: 200, epoch: 30 | loss: 0.0000001
	speed: 0.2902s/iter; left time: 8451.6346s
	iters: 300, epoch: 30 | loss: 0.0000071
	speed: 0.2903s/iter; left time: 8426.9892s
	iters: 400, epoch: 30 | loss: 0.2631275
	speed: 0.2966s/iter; left time: 8579.9679s
Epoch: 30 cost time: 119.64146590232849
Epoch: 30, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.250 Vali Acc: 0.972 Test Loss: 0.250 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.0000007
	speed: 0.5467s/iter; left time: 15750.3141s
	iters: 200, epoch: 31 | loss: 0.0013781
	speed: 0.2873s/iter; left time: 8248.4246s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.2900s/iter; left time: 8297.5645s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.2960s/iter; left time: 8438.6793s
Epoch: 31 cost time: 120.1801130771637
Epoch: 31, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.450 Vali Acc: 0.965 Test Loss: 0.450 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.0000001
	speed: 0.5717s/iter; left time: 16234.4656s
	iters: 200, epoch: 32 | loss: 0.0000009
	speed: 0.2774s/iter; left time: 7849.1236s
	iters: 300, epoch: 32 | loss: 0.0000285
	speed: 0.2857s/iter; left time: 8055.4648s
	iters: 400, epoch: 32 | loss: 0.0000034
	speed: 0.2830s/iter; left time: 7951.7637s
Epoch: 32 cost time: 117.76250648498535
Epoch: 32, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.307 Vali Acc: 0.962 Test Loss: 0.307 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.0001170
	speed: 0.5359s/iter; left time: 14997.3574s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.2742s/iter; left time: 7646.8312s
	iters: 300, epoch: 33 | loss: 0.0002865
	speed: 0.2766s/iter; left time: 7685.2120s
	iters: 400, epoch: 33 | loss: 0.0027682
	speed: 0.2924s/iter; left time: 8094.6116s
Epoch: 33 cost time: 115.03426504135132
Epoch: 33, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.157 Vali Acc: 0.980 Test Loss: 0.157 Test Acc: 0.980
Validation loss decreased (-0.979989 --> -0.980444).  Saving model ...
	iters: 100, epoch: 34 | loss: 0.0000255
	speed: 0.5824s/iter; left time: 16057.4224s
	iters: 200, epoch: 34 | loss: 0.0000719
	speed: 0.2905s/iter; left time: 7979.8678s
	iters: 300, epoch: 34 | loss: 0.0000001
	speed: 0.2862s/iter; left time: 7832.9377s
	iters: 400, epoch: 34 | loss: 0.0000138
	speed: 0.2831s/iter; left time: 7721.5359s
Epoch: 34 cost time: 118.76448678970337
Epoch: 34, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.226 Vali Acc: 0.970 Test Loss: 0.226 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 0.0000011
	speed: 0.5623s/iter; left time: 15272.5040s
	iters: 200, epoch: 35 | loss: 0.0585437
	speed: 0.2751s/iter; left time: 7444.8954s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.2661s/iter; left time: 7173.0120s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.2826s/iter; left time: 7591.0546s
Epoch: 35 cost time: 115.05781650543213
Epoch: 35, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.083 Vali Acc: 0.985 Test Loss: 0.083 Test Acc: 0.985
Validation loss decreased (-0.980444 --> -0.984538).  Saving model ...
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.5857s/iter; left time: 15666.1571s
	iters: 200, epoch: 36 | loss: 0.0000103
	speed: 0.2829s/iter; left time: 7538.5869s
	iters: 300, epoch: 36 | loss: 0.0000033
	speed: 0.2922s/iter; left time: 7755.6210s
	iters: 400, epoch: 36 | loss: 0.0000306
	speed: 0.2791s/iter; left time: 7382.1332s
Epoch: 36 cost time: 119.02224969863892
Epoch: 36, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.133 Vali Acc: 0.978 Test Loss: 0.133 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 0.0000686
	speed: 0.5642s/iter; left time: 14855.8448s
	iters: 200, epoch: 37 | loss: 0.0061095
	speed: 0.2890s/iter; left time: 7581.0405s
	iters: 300, epoch: 37 | loss: 0.0000001
	speed: 0.2872s/iter; left time: 7505.9554s
	iters: 400, epoch: 37 | loss: 0.0000068
	speed: 0.2835s/iter; left time: 7381.1531s
Epoch: 37 cost time: 118.09722065925598
Epoch: 37, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.233 Vali Acc: 0.970 Test Loss: 0.233 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 0.0000138
	speed: 0.5722s/iter; left time: 14832.2273s
	iters: 200, epoch: 38 | loss: 0.0000005
	speed: 0.2911s/iter; left time: 7515.8620s
	iters: 300, epoch: 38 | loss: 0.0000003
	speed: 0.2739s/iter; left time: 7045.0751s
	iters: 400, epoch: 38 | loss: 0.0000000
	speed: 0.2814s/iter; left time: 7210.0027s
Epoch: 38 cost time: 117.42460989952087
Epoch: 38, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.120 Vali Acc: 0.981 Test Loss: 0.120 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 39 | loss: 0.0038095
	speed: 0.5496s/iter; left time: 14019.7177s
	iters: 200, epoch: 39 | loss: 0.0000028
	speed: 0.2917s/iter; left time: 7410.9365s
	iters: 300, epoch: 39 | loss: 0.0010058
	speed: 0.2798s/iter; left time: 7080.3028s
	iters: 400, epoch: 39 | loss: 0.0005301
	speed: 0.2653s/iter; left time: 6686.5992s
Epoch: 39 cost time: 116.43663191795349
Epoch: 39, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.231 Vali Acc: 0.970 Test Loss: 0.231 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 40 | loss: 0.0000000
	speed: 0.5307s/iter; left time: 13318.3772s
	iters: 200, epoch: 40 | loss: 0.0002237
	speed: 0.2857s/iter; left time: 7140.6752s
	iters: 300, epoch: 40 | loss: 0.0000000
	speed: 0.2838s/iter; left time: 7063.8713s
	iters: 400, epoch: 40 | loss: 0.0000130
	speed: 0.2760s/iter; left time: 6843.5399s
Epoch: 40 cost time: 115.14776754379272
Epoch: 40, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.167 Vali Acc: 0.979 Test Loss: 0.167 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 41 | loss: 0.0000177
	speed: 0.5376s/iter; left time: 13269.6162s
	iters: 200, epoch: 41 | loss: 0.0000007
	speed: 0.2874s/iter; left time: 7064.6181s
	iters: 300, epoch: 41 | loss: 0.0003945
	speed: 0.2939s/iter; left time: 7194.5582s
	iters: 400, epoch: 41 | loss: 0.0000132
	speed: 0.2959s/iter; left time: 7215.1322s
Epoch: 41 cost time: 120.12167596817017
Epoch: 41, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.152 Vali Acc: 0.981 Test Loss: 0.152 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 42 | loss: 0.0000002
	speed: 0.5578s/iter; left time: 13536.8773s
	iters: 200, epoch: 42 | loss: 0.0000033
	speed: 0.2870s/iter; left time: 6935.9465s
	iters: 300, epoch: 42 | loss: 0.0015054
	speed: 0.2839s/iter; left time: 6832.5582s
	iters: 400, epoch: 42 | loss: 0.0000000
	speed: 0.2794s/iter; left time: 6697.3298s
Epoch: 42 cost time: 116.80648446083069
Epoch: 42, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.117 Vali Acc: 0.979 Test Loss: 0.117 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 43 | loss: 0.0000001
	speed: 0.5097s/iter; left time: 12158.9963s
	iters: 200, epoch: 43 | loss: 0.0000026
	speed: 0.2573s/iter; left time: 6112.0111s
	iters: 300, epoch: 43 | loss: 0.1718539
	speed: 0.2754s/iter; left time: 6515.1712s
	iters: 400, epoch: 43 | loss: 0.0000000
	speed: 0.2896s/iter; left time: 6822.3524s
Epoch: 43 cost time: 113.03745365142822
Epoch: 43, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.170 Vali Acc: 0.974 Test Loss: 0.170 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 44 | loss: 0.7077720
	speed: 0.5864s/iter; left time: 13746.1798s
	iters: 200, epoch: 44 | loss: 0.0000028
	speed: 0.2918s/iter; left time: 6811.4709s
	iters: 300, epoch: 44 | loss: 0.0000007
	speed: 0.2939s/iter; left time: 6830.8238s
	iters: 400, epoch: 44 | loss: 0.0045325
	speed: 0.2938s/iter; left time: 6799.5549s
Epoch: 44 cost time: 122.06660723686218
Epoch: 44, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.135 Vali Acc: 0.974 Test Loss: 0.135 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 45 | loss: 0.0000006
	speed: 0.5611s/iter; left time: 12922.2664s
	iters: 200, epoch: 45 | loss: 0.0000294
	speed: 0.2747s/iter; left time: 6298.7514s
	iters: 300, epoch: 45 | loss: 0.1012035
	speed: 0.2840s/iter; left time: 6483.4533s
	iters: 400, epoch: 45 | loss: 0.0000000
	speed: 0.2839s/iter; left time: 6453.2428s
Epoch: 45 cost time: 117.2304356098175
Epoch: 45, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9845384265575261
model parameter : 5732874
model size : 31.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.3022757
	speed: 0.3167s/iter; left time: 13047.3024s
	iters: 200, epoch: 1 | loss: 2.3020701
	speed: 0.2904s/iter; left time: 11935.4371s
	iters: 300, epoch: 1 | loss: 2.3010416
	speed: 0.3005s/iter; left time: 12321.8313s
	iters: 400, epoch: 1 | loss: 2.3011432
	speed: 0.3020s/iter; left time: 12351.6146s
Epoch: 1 cost time: 125.21230721473694
Epoch: 1, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (inf --> -0.100022).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3016727
	speed: 0.5865s/iter; left time: 23924.0359s
	iters: 200, epoch: 2 | loss: 2.3028634
	speed: 0.2932s/iter; left time: 11929.6146s
	iters: 300, epoch: 2 | loss: 2.3036599
	speed: 0.2878s/iter; left time: 11682.1913s
	iters: 400, epoch: 2 | loss: 2.3032594
	speed: 0.2833s/iter; left time: 11470.8347s
Epoch: 2 cost time: 120.63030481338501
Epoch: 2, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.3023605
	speed: 0.5727s/iter; left time: 23124.0677s
	iters: 200, epoch: 3 | loss: 2.3033018
	speed: 0.2977s/iter; left time: 11990.6176s
	iters: 300, epoch: 3 | loss: 2.2986972
	speed: 0.2890s/iter; left time: 11610.5629s
	iters: 400, epoch: 3 | loss: 2.3025091
	speed: 0.2900s/iter; left time: 11623.2853s
Epoch: 3 cost time: 122.03237771987915
Epoch: 3, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 2.3049555
	speed: 0.6021s/iter; left time: 24060.6262s
	iters: 200, epoch: 4 | loss: 2.3017645
	speed: 0.2748s/iter; left time: 10952.5135s
	iters: 300, epoch: 4 | loss: 2.2997947
	speed: 0.2844s/iter; left time: 11309.2622s
	iters: 400, epoch: 4 | loss: 2.3027022
	speed: 0.3009s/iter; left time: 11934.1852s
Epoch: 4 cost time: 121.14509224891663
Epoch: 4, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 2.3003652
	speed: 0.6022s/iter; left time: 23816.4600s
	iters: 200, epoch: 5 | loss: 2.3014765
	speed: 0.2945s/iter; left time: 11617.0100s
	iters: 300, epoch: 5 | loss: 2.3043423
	speed: 0.2819s/iter; left time: 11093.1628s
	iters: 400, epoch: 5 | loss: 2.3037305
	speed: 0.3026s/iter; left time: 11875.6900s
Epoch: 5 cost time: 122.87869334220886
Epoch: 5, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 2.2998734
	speed: 0.5709s/iter; left time: 22342.4247s
	iters: 200, epoch: 6 | loss: 2.3030486
	speed: 0.2976s/iter; left time: 11618.8492s
	iters: 300, epoch: 6 | loss: 2.3031507
	speed: 0.3129s/iter; left time: 12182.4084s
	iters: 400, epoch: 6 | loss: 2.3020856
	speed: 0.3075s/iter; left time: 11943.8622s
Epoch: 6 cost time: 124.41488862037659
Epoch: 6, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 2.3023815
	speed: 0.5455s/iter; left time: 21125.2571s
	iters: 200, epoch: 7 | loss: 2.3013539
	speed: 0.3090s/iter; left time: 11934.5062s
	iters: 300, epoch: 7 | loss: 2.3001692
	speed: 0.3011s/iter; left time: 11600.4017s
	iters: 400, epoch: 7 | loss: 2.3022997
	speed: 0.2802s/iter; left time: 10765.1895s
Epoch: 7 cost time: 120.75307416915894
Epoch: 7, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 2.3047729
	speed: 0.5534s/iter; left time: 21200.5870s
	iters: 200, epoch: 8 | loss: 2.3048053
	speed: 0.3105s/iter; left time: 11863.4065s
	iters: 300, epoch: 8 | loss: 2.3035834
	speed: 0.2949s/iter; left time: 11237.5785s
	iters: 400, epoch: 8 | loss: 2.3024251
	speed: 0.3073s/iter; left time: 11679.5457s
Epoch: 8 cost time: 124.70824670791626
Epoch: 8, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 2.3021183
	speed: 0.6035s/iter; left time: 22869.4206s
	iters: 200, epoch: 9 | loss: 2.3023620
	speed: 0.2917s/iter; left time: 11025.5402s
	iters: 300, epoch: 9 | loss: 2.3007643
	speed: 0.2996s/iter; left time: 11294.8276s
	iters: 400, epoch: 9 | loss: 2.3022640
	speed: 0.2871s/iter; left time: 10792.4385s
Epoch: 9 cost time: 123.25055313110352
Epoch: 9, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 2.3000419
	speed: 0.5855s/iter; left time: 21948.2531s
	iters: 200, epoch: 10 | loss: 2.3062015
	speed: 0.2983s/iter; left time: 11153.5057s
	iters: 300, epoch: 10 | loss: 2.3026025
	speed: 0.2974s/iter; left time: 11086.8640s
	iters: 400, epoch: 10 | loss: 2.3054655
	speed: 0.2989s/iter; left time: 11114.5338s
Epoch: 10 cost time: 123.34460639953613
Epoch: 10, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 2.3007226
	speed: 0.5890s/iter; left time: 21836.3278s
	iters: 200, epoch: 11 | loss: 2.3063354
	speed: 0.2934s/iter; left time: 10846.5955s
	iters: 300, epoch: 11 | loss: 2.3032827
	speed: 0.2967s/iter; left time: 10938.3323s
	iters: 400, epoch: 11 | loss: 2.3024037
	speed: 0.2956s/iter; left time: 10870.8963s
Epoch: 11 cost time: 122.51313853263855
Epoch: 11, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.10004547521600728
model parameter : 5732874
model size : 31.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         47                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3419399
	speed: 0.2817s/iter; left time: 11604.8457s
	iters: 200, epoch: 1 | loss: 0.1402033
	speed: 0.2944s/iter; left time: 12098.7475s
	iters: 300, epoch: 1 | loss: 0.1375741
	speed: 0.2963s/iter; left time: 12146.9621s
	iters: 400, epoch: 1 | loss: 0.0376662
	speed: 0.2782s/iter; left time: 11380.2578s
Epoch: 1 cost time: 118.86921000480652
Epoch: 1, Steps: 413 | Train Loss: 0.357 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
Validation loss decreased (inf --> -0.970440).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0356634
	speed: 0.5466s/iter; left time: 22295.5379s
	iters: 200, epoch: 2 | loss: 0.3021350
	speed: 0.2910s/iter; left time: 11840.7588s
	iters: 300, epoch: 2 | loss: 0.0188843
	speed: 0.2805s/iter; left time: 11384.2501s
	iters: 400, epoch: 2 | loss: 0.2988212
	speed: 0.2787s/iter; left time: 11283.7192s
Epoch: 2 cost time: 117.52624225616455
Epoch: 2, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.422 Vali Acc: 0.907 Test Loss: 0.422 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.5043797
	speed: 0.5422s/iter; left time: 21892.8808s
	iters: 200, epoch: 3 | loss: 0.0302481
	speed: 0.2862s/iter; left time: 11526.3646s
	iters: 300, epoch: 3 | loss: 0.0025274
	speed: 0.2809s/iter; left time: 11285.8590s
	iters: 400, epoch: 3 | loss: 0.0098720
	speed: 0.2773s/iter; left time: 11114.3427s
Epoch: 3 cost time: 116.58856225013733
Epoch: 3, Steps: 413 | Train Loss: 0.128 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.4242617
	speed: 0.5499s/iter; left time: 21974.5379s
	iters: 200, epoch: 4 | loss: 0.0001851
	speed: 0.2759s/iter; left time: 10997.2372s
	iters: 300, epoch: 4 | loss: 0.0021122
	speed: 0.2659s/iter; left time: 10571.2519s
	iters: 400, epoch: 4 | loss: 0.0025099
	speed: 0.2663s/iter; left time: 10560.2580s
Epoch: 4 cost time: 112.7247838973999
Epoch: 4, Steps: 413 | Train Loss: 0.115 Vali Loss: 0.154 Vali Acc: 0.971 Test Loss: 0.154 Test Acc: 0.971
Validation loss decreased (-0.970440 --> -0.970894).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0847574
	speed: 0.5570s/iter; left time: 22027.2677s
	iters: 200, epoch: 5 | loss: 0.0008260
	speed: 0.2745s/iter; left time: 10828.9708s
	iters: 300, epoch: 5 | loss: 0.7745031
	speed: 0.2811s/iter; left time: 11062.2561s
	iters: 400, epoch: 5 | loss: 0.0096172
	speed: 0.2715s/iter; left time: 10654.8076s
Epoch: 5 cost time: 114.99126243591309
Epoch: 5, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.173 Vali Acc: 0.969 Test Loss: 0.173 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000452
	speed: 0.5620s/iter; left time: 21994.0577s
	iters: 200, epoch: 6 | loss: 0.0000266
	speed: 0.2651s/iter; left time: 10347.2260s
	iters: 300, epoch: 6 | loss: 0.0001280
	speed: 0.2620s/iter; left time: 10201.9008s
	iters: 400, epoch: 6 | loss: 0.0023424
	speed: 0.2666s/iter; left time: 10352.7230s
Epoch: 6 cost time: 111.77204895019531
Epoch: 6, Steps: 413 | Train Loss: 0.123 Vali Loss: 0.245 Vali Acc: 0.960 Test Loss: 0.245 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000098
	speed: 0.5455s/iter; left time: 21125.1905s
	iters: 200, epoch: 7 | loss: 0.4861512
	speed: 0.2826s/iter; left time: 10914.4599s
	iters: 300, epoch: 7 | loss: 0.0003267
	speed: 0.2806s/iter; left time: 10810.5889s
	iters: 400, epoch: 7 | loss: 0.0030803
	speed: 0.2901s/iter; left time: 11147.6774s
Epoch: 7 cost time: 117.60928964614868
Epoch: 7, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.212 Vali Acc: 0.972 Test Loss: 0.212 Test Acc: 0.972
Validation loss decreased (-0.970894 --> -0.972258).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0005776
	speed: 0.5648s/iter; left time: 21635.9785s
	iters: 200, epoch: 8 | loss: 0.0005223
	speed: 0.2616s/iter; left time: 9994.0164s
	iters: 300, epoch: 8 | loss: 0.0010477
	speed: 0.2793s/iter; left time: 10645.7637s
	iters: 400, epoch: 8 | loss: 1.1146078
	speed: 0.2738s/iter; left time: 10407.9748s
Epoch: 8 cost time: 113.65232634544373
Epoch: 8, Steps: 413 | Train Loss: 0.102 Vali Loss: 0.274 Vali Acc: 0.969 Test Loss: 0.274 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000032
	speed: 0.5126s/iter; left time: 19426.9705s
	iters: 200, epoch: 9 | loss: 0.0041449
	speed: 0.2706s/iter; left time: 10226.0813s
	iters: 300, epoch: 9 | loss: 0.0000456
	speed: 0.2753s/iter; left time: 10378.6121s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.2768s/iter; left time: 10407.6079s
Epoch: 9 cost time: 111.19234871864319
Epoch: 9, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.209 Vali Acc: 0.971 Test Loss: 0.209 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000004
	speed: 0.5522s/iter; left time: 20698.4542s
	iters: 200, epoch: 10 | loss: 0.0031836
	speed: 0.2652s/iter; left time: 9915.0898s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.2718s/iter; left time: 10133.0852s
	iters: 400, epoch: 10 | loss: 0.1118108
	speed: 0.2801s/iter; left time: 10415.0332s
Epoch: 10 cost time: 113.94218611717224
Epoch: 10, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.293 Vali Acc: 0.963 Test Loss: 0.293 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000029
	speed: 0.5137s/iter; left time: 19045.0146s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.2511s/iter; left time: 9285.0971s
	iters: 300, epoch: 11 | loss: 0.0004411
	speed: 0.2833s/iter; left time: 10445.9096s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.2783s/iter; left time: 10233.8586s
Epoch: 11 cost time: 110.85736632347107
Epoch: 11, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.172 Vali Acc: 0.975 Test Loss: 0.172 Test Acc: 0.975
Validation loss decreased (-0.972258 --> -0.974987).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0001218
	speed: 0.5399s/iter; left time: 19790.7397s
	iters: 200, epoch: 12 | loss: 0.0000001
	speed: 0.2830s/iter; left time: 10346.5231s
	iters: 300, epoch: 12 | loss: 0.0000037
	speed: 0.2818s/iter; left time: 10274.7886s
	iters: 400, epoch: 12 | loss: 0.3652109
	speed: 0.2785s/iter; left time: 10126.7952s
Epoch: 12 cost time: 115.57529973983765
Epoch: 12, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.506 Vali Acc: 0.959 Test Loss: 0.506 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000004
	speed: 0.5500s/iter; left time: 19935.4352s
	iters: 200, epoch: 13 | loss: 0.0000001
	speed: 0.2766s/iter; left time: 9996.4081s
	iters: 300, epoch: 13 | loss: 0.1447473
	speed: 0.2775s/iter; left time: 10000.8329s
	iters: 400, epoch: 13 | loss: 0.0000016
	speed: 0.2645s/iter; left time: 9506.6373s
Epoch: 13 cost time: 113.8558657169342
Epoch: 13, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.260 Vali Acc: 0.970 Test Loss: 0.260 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000005
	speed: 0.5006s/iter; left time: 17936.1784s
	iters: 200, epoch: 14 | loss: 0.0000392
	speed: 0.2815s/iter; left time: 10058.0302s
	iters: 300, epoch: 14 | loss: 0.0000044
	speed: 0.2739s/iter; left time: 9759.5037s
	iters: 400, epoch: 14 | loss: 0.0012203
	speed: 0.2533s/iter; left time: 8999.4398s
Epoch: 14 cost time: 110.49156165122986
Epoch: 14, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.246 Vali Acc: 0.977 Test Loss: 0.246 Test Acc: 0.977
Validation loss decreased (-0.974987 --> -0.977260).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000001
	speed: 0.5397s/iter; left time: 19113.8908s
	iters: 200, epoch: 15 | loss: 0.0000008
	speed: 0.2773s/iter; left time: 9792.4678s
	iters: 300, epoch: 15 | loss: 0.0000271
	speed: 0.2755s/iter; left time: 9701.4242s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.2665s/iter; left time: 9357.7328s
Epoch: 15 cost time: 113.82938361167908
Epoch: 15, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.286 Vali Acc: 0.970 Test Loss: 0.286 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0087359
	speed: 0.5451s/iter; left time: 19082.1741s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.2767s/iter; left time: 9659.8815s
	iters: 300, epoch: 16 | loss: 0.0000004
	speed: 0.2562s/iter; left time: 8916.7985s
	iters: 400, epoch: 16 | loss: 0.0067928
	speed: 0.2683s/iter; left time: 9310.4660s
Epoch: 16 cost time: 112.6216950416565
Epoch: 16, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.319 Vali Acc: 0.967 Test Loss: 0.319 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0061317
	speed: 0.5479s/iter; left time: 18953.7251s
	iters: 200, epoch: 17 | loss: 0.0151610
	speed: 0.2871s/iter; left time: 9901.3990s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.2793s/iter; left time: 9607.5623s
	iters: 400, epoch: 17 | loss: 0.0000014
	speed: 0.2894s/iter; left time: 9926.0218s
Epoch: 17 cost time: 118.47230195999146
Epoch: 17, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.448 Vali Acc: 0.965 Test Loss: 0.448 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0002796
	speed: 0.5660s/iter; left time: 19344.7446s
	iters: 200, epoch: 18 | loss: 0.0011849
	speed: 0.2816s/iter; left time: 9595.5298s
	iters: 300, epoch: 18 | loss: 0.0004096
	speed: 0.2680s/iter; left time: 9105.8540s
	iters: 400, epoch: 18 | loss: 0.0361336
	speed: 0.2729s/iter; left time: 9244.9175s
Epoch: 18 cost time: 114.73645329475403
Epoch: 18, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.199 Vali Acc: 0.978 Test Loss: 0.199 Test Acc: 0.978
Validation loss decreased (-0.977260 --> -0.977715).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.5475s/iter; left time: 18486.5355s
	iters: 200, epoch: 19 | loss: 0.0001085
	speed: 0.2755s/iter; left time: 9276.3842s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.2670s/iter; left time: 8960.9744s
	iters: 400, epoch: 19 | loss: 0.5283280
	speed: 0.2826s/iter; left time: 9457.0862s
Epoch: 19 cost time: 115.74292039871216
Epoch: 19, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.409 Vali Acc: 0.966 Test Loss: 0.409 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000001
	speed: 0.5507s/iter; left time: 18366.5054s
	iters: 200, epoch: 20 | loss: 0.0000001
	speed: 0.2640s/iter; left time: 8777.6220s
	iters: 300, epoch: 20 | loss: 0.9450887
	speed: 0.2799s/iter; left time: 9280.4872s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.2775s/iter; left time: 9173.0902s
Epoch: 20 cost time: 113.53282642364502
Epoch: 20, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.213 Vali Acc: 0.977 Test Loss: 0.213 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.5496s/iter; left time: 18104.0621s
	iters: 200, epoch: 21 | loss: 0.0000050
	speed: 0.2822s/iter; left time: 9267.8173s
	iters: 300, epoch: 21 | loss: 0.0000001
	speed: 0.2672s/iter; left time: 8748.4483s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.2582s/iter; left time: 8426.7355s
Epoch: 21 cost time: 112.89193367958069
Epoch: 21, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.269 Vali Acc: 0.976 Test Loss: 0.269 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0664370
	speed: 0.5700s/iter; left time: 18541.5337s
	iters: 200, epoch: 22 | loss: 0.1056324
	speed: 0.2669s/iter; left time: 8655.6780s
	iters: 300, epoch: 22 | loss: 0.0871459
	speed: 0.2676s/iter; left time: 8649.7373s
	iters: 400, epoch: 22 | loss: 0.0593266
	speed: 0.2867s/iter; left time: 9241.2044s
Epoch: 22 cost time: 114.89385533332825
Epoch: 22, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.655 Vali Acc: 0.950 Test Loss: 0.655 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0000448
	speed: 0.5674s/iter; left time: 18222.0898s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.2910s/iter; left time: 9317.1438s
	iters: 300, epoch: 23 | loss: 0.1515396
	speed: 0.2805s/iter; left time: 8951.5761s
	iters: 400, epoch: 23 | loss: 0.4083470
	speed: 0.2762s/iter; left time: 8786.9490s
Epoch: 23 cost time: 117.60154390335083
Epoch: 23, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.188 Vali Acc: 0.980 Test Loss: 0.188 Test Acc: 0.980
Validation loss decreased (-0.977715 --> -0.980444).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000001
	speed: 0.5674s/iter; left time: 17987.5877s
	iters: 200, epoch: 24 | loss: 0.0014039
	speed: 0.2939s/iter; left time: 9288.9924s
	iters: 300, epoch: 24 | loss: 0.0000389
	speed: 0.2700s/iter; left time: 8505.5651s
	iters: 400, epoch: 24 | loss: 0.0000012
	speed: 0.2770s/iter; left time: 8699.1356s
Epoch: 24 cost time: 118.30077147483826
Epoch: 24, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.360 Vali Acc: 0.971 Test Loss: 0.360 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.5798s/iter; left time: 18140.2840s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.2824s/iter; left time: 8806.3761s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.2880s/iter; left time: 8954.0958s
	iters: 400, epoch: 25 | loss: 0.2428587
	speed: 0.2868s/iter; left time: 8888.6013s
Epoch: 25 cost time: 119.57334613800049
Epoch: 25, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.242 Vali Acc: 0.977 Test Loss: 0.242 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.5514s/iter; left time: 17025.3271s
	iters: 200, epoch: 26 | loss: 0.0269501
	speed: 0.2926s/iter; left time: 9004.7958s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.2857s/iter; left time: 8764.6384s
	iters: 400, epoch: 26 | loss: 0.0000001
	speed: 0.2781s/iter; left time: 8502.2169s
Epoch: 26 cost time: 118.4384458065033
Epoch: 26, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.303 Vali Acc: 0.971 Test Loss: 0.303 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0000001
	speed: 0.5590s/iter; left time: 17029.7993s
	iters: 200, epoch: 27 | loss: 0.0000045
	speed: 0.2828s/iter; left time: 8586.8340s
	iters: 300, epoch: 27 | loss: 0.0000072
	speed: 0.2892s/iter; left time: 8751.8367s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.3005s/iter; left time: 9063.3239s
Epoch: 27 cost time: 119.52580833435059
Epoch: 27, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.243 Vali Acc: 0.975 Test Loss: 0.243 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0000007
	speed: 0.5397s/iter; left time: 16217.4022s
	iters: 200, epoch: 28 | loss: 0.0000092
	speed: 0.2955s/iter; left time: 8851.4548s
	iters: 300, epoch: 28 | loss: 0.0164376
	speed: 0.2806s/iter; left time: 8376.3393s
	iters: 400, epoch: 28 | loss: 0.0000061
	speed: 0.2896s/iter; left time: 8615.8142s
Epoch: 28 cost time: 117.94023704528809
Epoch: 28, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.268 Vali Acc: 0.981 Test Loss: 0.268 Test Acc: 0.981
Validation loss decreased (-0.980444 --> -0.980898).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0000001
	speed: 0.5817s/iter; left time: 17239.4796s
	iters: 200, epoch: 29 | loss: 0.0000002
	speed: 0.2845s/iter; left time: 8404.7029s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.2679s/iter; left time: 7886.3685s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.2831s/iter; left time: 8304.2072s
Epoch: 29 cost time: 117.60707378387451
Epoch: 29, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.231 Vali Acc: 0.977 Test Loss: 0.231 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.1769181
	speed: 0.5247s/iter; left time: 15333.7848s
	iters: 200, epoch: 30 | loss: 0.0000001
	speed: 0.2811s/iter; left time: 8186.4127s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.2854s/iter; left time: 8284.2805s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.2839s/iter; left time: 8210.6196s
Epoch: 30 cost time: 115.47793674468994
Epoch: 30, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.137 Vali Acc: 0.985 Test Loss: 0.137 Test Acc: 0.985
Validation loss decreased (-0.980898 --> -0.984992).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.0000001
	speed: 0.5751s/iter; left time: 16569.2231s
	iters: 200, epoch: 31 | loss: 0.0000001
	speed: 0.3007s/iter; left time: 8634.1049s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.2775s/iter; left time: 7939.4422s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.2718s/iter; left time: 7748.9411s
Epoch: 31 cost time: 118.98109650611877
Epoch: 31, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.286 Vali Acc: 0.976 Test Loss: 0.286 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.0000172
	speed: 0.5453s/iter; left time: 15485.1561s
	iters: 200, epoch: 32 | loss: 0.0000009
	speed: 0.2640s/iter; left time: 7472.0021s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.2828s/iter; left time: 7975.4900s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.2802s/iter; left time: 7873.8142s
Epoch: 32 cost time: 114.08330202102661
Epoch: 32, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.226 Vali Acc: 0.978 Test Loss: 0.226 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.0000003
	speed: 0.5490s/iter; left time: 15362.8474s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.2885s/iter; left time: 8044.3693s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.2719s/iter; left time: 7555.4895s
	iters: 400, epoch: 33 | loss: 0.0490043
	speed: 0.2668s/iter; left time: 7387.1442s
Epoch: 33 cost time: 114.8150589466095
Epoch: 33, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.310 Vali Acc: 0.971 Test Loss: 0.310 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.8114222
	speed: 0.5569s/iter; left time: 15355.6054s
	iters: 200, epoch: 34 | loss: 0.0001146
	speed: 0.2764s/iter; left time: 7592.0843s
	iters: 300, epoch: 34 | loss: 0.0001392
	speed: 0.2717s/iter; left time: 7435.8104s
	iters: 400, epoch: 34 | loss: 0.0000008
	speed: 0.2819s/iter; left time: 7688.0847s
Epoch: 34 cost time: 115.78448963165283
Epoch: 34, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.223 Vali Acc: 0.980 Test Loss: 0.223 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.0000037
	speed: 0.5527s/iter; left time: 15010.1232s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.2766s/iter; left time: 7483.3350s
	iters: 300, epoch: 35 | loss: 0.0037875
	speed: 0.2838s/iter; left time: 7650.5229s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.2756s/iter; left time: 7401.8100s
Epoch: 35 cost time: 114.94175505638123
Epoch: 35, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.243 Vali Acc: 0.974 Test Loss: 0.243 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 0.0000047
	speed: 0.5585s/iter; left time: 14938.7689s
	iters: 200, epoch: 36 | loss: 0.0000128
	speed: 0.2863s/iter; left time: 7628.5303s
	iters: 300, epoch: 36 | loss: 0.0000805
	speed: 0.2753s/iter; left time: 7308.6421s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.2731s/iter; left time: 7221.6895s
Epoch: 36 cost time: 116.0218575000763
Epoch: 36, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.245 Vali Acc: 0.975 Test Loss: 0.245 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.5381s/iter; left time: 14169.6755s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.2706s/iter; left time: 7099.3008s
	iters: 300, epoch: 37 | loss: 0.0000016
	speed: 0.2782s/iter; left time: 7269.9458s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.2784s/iter; left time: 7247.3420s
Epoch: 37 cost time: 113.28670692443848
Epoch: 37, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.181 Vali Acc: 0.980 Test Loss: 0.181 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.5479s/iter; left time: 14200.8442s
	iters: 200, epoch: 38 | loss: 0.0000040
	speed: 0.2911s/iter; left time: 7515.4425s
	iters: 300, epoch: 38 | loss: 0.0015963
	speed: 0.2818s/iter; left time: 7247.4494s
	iters: 400, epoch: 38 | loss: 0.0003610
	speed: 0.2773s/iter; left time: 7104.0378s
Epoch: 38 cost time: 117.21377491950989
Epoch: 38, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.247 Vali Acc: 0.973 Test Loss: 0.247 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 39 | loss: 0.0000000
	speed: 0.5587s/iter; left time: 14251.8982s
	iters: 200, epoch: 39 | loss: 0.0000000
	speed: 0.2630s/iter; left time: 6681.4616s
	iters: 300, epoch: 39 | loss: 0.0000009
	speed: 0.2676s/iter; left time: 6772.8215s
	iters: 400, epoch: 39 | loss: 0.0000000
	speed: 0.2729s/iter; left time: 6879.8535s
Epoch: 39 cost time: 112.85531806945801
Epoch: 39, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.160 Vali Acc: 0.982 Test Loss: 0.160 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 40 | loss: 0.0000114
	speed: 0.5347s/iter; left time: 13418.7227s
	iters: 200, epoch: 40 | loss: 0.0007153
	speed: 0.2676s/iter; left time: 6688.8327s
	iters: 300, epoch: 40 | loss: 0.0000000
	speed: 0.2751s/iter; left time: 6848.1794s
	iters: 400, epoch: 40 | loss: 0.0000000
	speed: 0.2717s/iter; left time: 6737.3108s
Epoch: 40 cost time: 112.16073608398438
Epoch: 40, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.196 Vali Acc: 0.981 Test Loss: 0.196 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.984993178717599
model parameter : 4160010
model size : 25.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         38                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3203456
	speed: 0.3037s/iter; left time: 12513.4074s
	iters: 200, epoch: 1 | loss: 0.1379063
	speed: 0.3028s/iter; left time: 12447.2312s
	iters: 300, epoch: 1 | loss: 0.1155473
	speed: 0.2847s/iter; left time: 11672.9248s
	iters: 400, epoch: 1 | loss: 0.0538216
	speed: 0.2846s/iter; left time: 11641.6509s
Epoch: 1 cost time: 122.0057384967804
Epoch: 1, Steps: 413 | Train Loss: 0.378 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (inf --> -0.976807).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0028888
	speed: 0.5661s/iter; left time: 23090.7333s
	iters: 200, epoch: 2 | loss: 0.2577629
	speed: 0.2943s/iter; left time: 11973.3245s
	iters: 300, epoch: 2 | loss: 0.4148867
	speed: 0.2817s/iter; left time: 11434.0635s
	iters: 400, epoch: 2 | loss: 0.1276422
	speed: 0.3030s/iter; left time: 12267.1442s
Epoch: 2 cost time: 121.07842326164246
Epoch: 2, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.190 Vali Acc: 0.946 Test Loss: 0.190 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0597917
	speed: 0.5739s/iter; left time: 23171.1787s
	iters: 200, epoch: 3 | loss: 0.0570625
	speed: 0.3199s/iter; left time: 12884.7988s
	iters: 300, epoch: 3 | loss: 0.2802076
	speed: 0.2985s/iter; left time: 11990.5290s
	iters: 400, epoch: 3 | loss: 0.0127563
	speed: 0.2913s/iter; left time: 11674.3454s
Epoch: 3 cost time: 124.95953226089478
Epoch: 3, Steps: 413 | Train Loss: 0.119 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
Validation loss decreased (-0.976807 --> -0.979080).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0017995
	speed: 0.5465s/iter; left time: 21837.4085s
	iters: 200, epoch: 4 | loss: 0.0017101
	speed: 0.2827s/iter; left time: 11267.2525s
	iters: 300, epoch: 4 | loss: 0.0036299
	speed: 0.2794s/iter; left time: 11109.8975s
	iters: 400, epoch: 4 | loss: 0.1464647
	speed: 0.2874s/iter; left time: 11397.1058s
Epoch: 4 cost time: 116.50351452827454
Epoch: 4, Steps: 413 | Train Loss: 0.108 Vali Loss: 0.365 Vali Acc: 0.939 Test Loss: 0.365 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2016316
	speed: 0.5539s/iter; left time: 21907.7781s
	iters: 200, epoch: 5 | loss: 0.0391960
	speed: 0.2908s/iter; left time: 11472.0090s
	iters: 300, epoch: 5 | loss: 0.0014893
	speed: 0.3096s/iter; left time: 12182.2240s
	iters: 400, epoch: 5 | loss: 0.0012503
	speed: 0.3029s/iter; left time: 11890.2517s
Epoch: 5 cost time: 124.49684071540833
Epoch: 5, Steps: 413 | Train Loss: 0.111 Vali Loss: 0.175 Vali Acc: 0.965 Test Loss: 0.175 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.2320609
	speed: 0.5650s/iter; left time: 22110.1185s
	iters: 200, epoch: 6 | loss: 0.0028648
	speed: 0.2846s/iter; left time: 11110.0204s
	iters: 300, epoch: 6 | loss: 0.6091810
	speed: 0.2892s/iter; left time: 11259.8253s
	iters: 400, epoch: 6 | loss: 0.0757932
	speed: 0.2751s/iter; left time: 10684.5764s
Epoch: 6 cost time: 117.00514721870422
Epoch: 6, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.339 Vali Acc: 0.948 Test Loss: 0.339 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0061636
	speed: 0.5566s/iter; left time: 21553.7763s
	iters: 200, epoch: 7 | loss: 0.0082178
	speed: 0.2886s/iter; left time: 11145.7366s
	iters: 300, epoch: 7 | loss: 0.0020959
	speed: 0.2921s/iter; left time: 11251.2602s
	iters: 400, epoch: 7 | loss: 0.2979198
	speed: 0.2915s/iter; left time: 11200.9818s
Epoch: 7 cost time: 119.69180297851562
Epoch: 7, Steps: 413 | Train Loss: 0.112 Vali Loss: 0.388 Vali Acc: 0.954 Test Loss: 0.388 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.7816752
	speed: 0.5758s/iter; left time: 22058.3188s
	iters: 200, epoch: 8 | loss: 0.2810619
	speed: 0.2870s/iter; left time: 10967.4492s
	iters: 300, epoch: 8 | loss: 0.0015889
	speed: 0.2826s/iter; left time: 10770.5120s
	iters: 400, epoch: 8 | loss: 0.2563766
	speed: 0.2658s/iter; left time: 10104.3962s
Epoch: 8 cost time: 116.37158179283142
Epoch: 8, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.258 Vali Acc: 0.962 Test Loss: 0.258 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.5494s/iter; left time: 20821.3628s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.2882s/iter; left time: 10892.5718s
	iters: 300, epoch: 9 | loss: 0.3579197
	speed: 0.2783s/iter; left time: 10491.5663s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.2752s/iter; left time: 10348.0025s
Epoch: 9 cost time: 115.87246823310852
Epoch: 9, Steps: 413 | Train Loss: 0.110 Vali Loss: 0.206 Vali Acc: 0.975 Test Loss: 0.206 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0000003
	speed: 0.5733s/iter; left time: 21487.8020s
	iters: 200, epoch: 10 | loss: 0.3008367
	speed: 0.2922s/iter; left time: 10925.0747s
	iters: 300, epoch: 10 | loss: 0.0000005
	speed: 0.2732s/iter; left time: 10186.7974s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.2812s/iter; left time: 10457.1158s
Epoch: 10 cost time: 118.4379026889801
Epoch: 10, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.186 Vali Acc: 0.974 Test Loss: 0.186 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0066328
	speed: 0.5266s/iter; left time: 19522.7596s
	iters: 200, epoch: 11 | loss: 0.0000001
	speed: 0.2912s/iter; left time: 10765.4648s
	iters: 300, epoch: 11 | loss: 0.0000001
	speed: 0.2768s/iter; left time: 10207.1793s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.2827s/iter; left time: 10396.5596s
Epoch: 11 cost time: 116.51637244224548
Epoch: 11, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.132 Vali Acc: 0.984 Test Loss: 0.132 Test Acc: 0.984
Validation loss decreased (-0.979080 --> -0.984082).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000007
	speed: 0.5558s/iter; left time: 20373.5149s
	iters: 200, epoch: 12 | loss: 0.0000472
	speed: 0.2856s/iter; left time: 10440.1196s
	iters: 300, epoch: 12 | loss: 0.3720872
	speed: 0.2902s/iter; left time: 10578.5195s
	iters: 400, epoch: 12 | loss: 0.0008172
	speed: 0.2906s/iter; left time: 10565.5024s
Epoch: 12 cost time: 118.78626561164856
Epoch: 12, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.231 Vali Acc: 0.971 Test Loss: 0.231 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000001
	speed: 0.5403s/iter; left time: 19583.4137s
	iters: 200, epoch: 13 | loss: 0.0026110
	speed: 0.2915s/iter; left time: 10534.7743s
	iters: 300, epoch: 13 | loss: 0.0286931
	speed: 0.2623s/iter; left time: 9456.4001s
	iters: 400, epoch: 13 | loss: 0.0217562
	speed: 0.2844s/iter; left time: 10222.5378s
Epoch: 13 cost time: 115.9922206401825
Epoch: 13, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.327 Vali Acc: 0.971 Test Loss: 0.327 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.5424s/iter; left time: 19436.9043s
	iters: 200, epoch: 14 | loss: 0.0001219
	speed: 0.2717s/iter; left time: 9706.6434s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.2673s/iter; left time: 9524.8155s
	iters: 400, epoch: 14 | loss: 0.0200871
	speed: 0.2648s/iter; left time: 9409.0465s
Epoch: 14 cost time: 111.21367645263672
Epoch: 14, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.246 Vali Acc: 0.977 Test Loss: 0.246 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000290
	speed: 0.5271s/iter; left time: 18669.5077s
	iters: 200, epoch: 15 | loss: 0.0000001
	speed: 0.2744s/iter; left time: 9690.4038s
	iters: 300, epoch: 15 | loss: 0.0011439
	speed: 0.2568s/iter; left time: 9045.3044s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.2739s/iter; left time: 9619.4520s
Epoch: 15 cost time: 112.38226509094238
Epoch: 15, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.259 Vali Acc: 0.974 Test Loss: 0.259 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.1232995
	speed: 0.5560s/iter; left time: 19464.8207s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.2759s/iter; left time: 9630.8917s
	iters: 300, epoch: 16 | loss: 0.0995279
	speed: 0.3046s/iter; left time: 10600.1697s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.2897s/iter; left time: 10056.0235s
Epoch: 16 cost time: 119.78318095207214
Epoch: 16, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.300 Vali Acc: 0.968 Test Loss: 0.300 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.2225807
	speed: 0.5641s/iter; left time: 19513.2515s
	iters: 200, epoch: 17 | loss: 0.1165620
	speed: 0.2951s/iter; left time: 10177.2104s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.2943s/iter; left time: 10123.0924s
	iters: 400, epoch: 17 | loss: 0.2042059
	speed: 0.2962s/iter; left time: 10156.1772s
Epoch: 17 cost time: 122.54735660552979
Epoch: 17, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.339 Vali Acc: 0.972 Test Loss: 0.339 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0001966
	speed: 0.5898s/iter; left time: 20158.4547s
	iters: 200, epoch: 18 | loss: 0.0000001
	speed: 0.2866s/iter; left time: 9765.6262s
	iters: 300, epoch: 18 | loss: 0.0001520
	speed: 0.2980s/iter; left time: 10125.5712s
	iters: 400, epoch: 18 | loss: 0.0000237
	speed: 0.2913s/iter; left time: 9870.7077s
Epoch: 18 cost time: 120.79408693313599
Epoch: 18, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.339 Vali Acc: 0.967 Test Loss: 0.339 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.5472s/iter; left time: 18476.6996s
	iters: 200, epoch: 19 | loss: 0.0007498
	speed: 0.2659s/iter; left time: 8952.8779s
	iters: 300, epoch: 19 | loss: 0.0000075
	speed: 0.2660s/iter; left time: 8928.4034s
	iters: 400, epoch: 19 | loss: 0.0000050
	speed: 0.2862s/iter; left time: 9577.0702s
Epoch: 19 cost time: 114.27464294433594
Epoch: 19, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.231 Vali Acc: 0.975 Test Loss: 0.231 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0084931
	speed: 0.5510s/iter; left time: 18377.5506s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.2868s/iter; left time: 9536.0313s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.2862s/iter; left time: 9489.7735s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.2805s/iter; left time: 9272.3411s
Epoch: 20 cost time: 116.9371120929718
Epoch: 20, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.276 Vali Acc: 0.977 Test Loss: 0.276 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.5257s/iter; left time: 17317.8508s
	iters: 200, epoch: 21 | loss: 0.0000110
	speed: 0.2757s/iter; left time: 9055.0760s
	iters: 300, epoch: 21 | loss: 0.1871911
	speed: 0.2687s/iter; left time: 8798.6184s
	iters: 400, epoch: 21 | loss: 0.0036389
	speed: 0.2765s/iter; left time: 9024.0400s
Epoch: 21 cost time: 114.31203484535217
Epoch: 21, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.357 Vali Acc: 0.965 Test Loss: 0.357 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9840836743974534
model parameter : 4160010
model size : 25.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         28                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3770778
	speed: 0.2981s/iter; left time: 12283.2959s
	iters: 200, epoch: 1 | loss: 0.1499087
	speed: 0.3014s/iter; left time: 12386.7397s
	iters: 300, epoch: 1 | loss: 0.2044594
	speed: 0.2999s/iter; left time: 12298.0429s
	iters: 400, epoch: 1 | loss: 0.0430815
	speed: 0.2862s/iter; left time: 11705.3369s
Epoch: 1 cost time: 122.35629606246948
Epoch: 1, Steps: 413 | Train Loss: 0.423 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
Validation loss decreased (inf --> -0.972714).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0362467
	speed: 0.5638s/iter; left time: 22995.7811s
	iters: 200, epoch: 2 | loss: 0.4760997
	speed: 0.2913s/iter; left time: 11851.1715s
	iters: 300, epoch: 2 | loss: 0.0408708
	speed: 0.2813s/iter; left time: 11415.8443s
	iters: 400, epoch: 2 | loss: 0.1073372
	speed: 0.3049s/iter; left time: 12345.0279s
Epoch: 2 cost time: 121.33402109146118
Epoch: 2, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.158 Vali Acc: 0.956 Test Loss: 0.158 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.4490463
	speed: 0.5626s/iter; left time: 22714.4663s
	iters: 200, epoch: 3 | loss: 0.0041219
	speed: 0.3038s/iter; left time: 12233.5941s
	iters: 300, epoch: 3 | loss: 0.4688859
	speed: 0.2911s/iter; left time: 11696.2188s
	iters: 400, epoch: 3 | loss: 0.1398207
	speed: 0.2949s/iter; left time: 11817.0647s
Epoch: 3 cost time: 121.84588885307312
Epoch: 3, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.221 Vali Acc: 0.946 Test Loss: 0.221 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.7377542
	speed: 0.6018s/iter; left time: 24049.7755s
	iters: 200, epoch: 4 | loss: 0.0000074
	speed: 0.2884s/iter; left time: 11497.3369s
	iters: 300, epoch: 4 | loss: 0.0037728
	speed: 0.2992s/iter; left time: 11897.2955s
	iters: 400, epoch: 4 | loss: 0.0002716
	speed: 0.3230s/iter; left time: 12811.4488s
Epoch: 4 cost time: 126.02081489562988
Epoch: 4, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.652 Vali Acc: 0.918 Test Loss: 0.652 Test Acc: 0.918
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0455363
	speed: 0.5601s/iter; left time: 22150.0220s
	iters: 200, epoch: 5 | loss: 0.0618835
	speed: 0.2943s/iter; left time: 11608.3782s
	iters: 300, epoch: 5 | loss: 0.0493611
	speed: 0.3147s/iter; left time: 12384.2386s
	iters: 400, epoch: 5 | loss: 0.0004090
	speed: 0.2997s/iter; left time: 11761.8472s
Epoch: 5 cost time: 124.08700823783875
Epoch: 5, Steps: 413 | Train Loss: 0.134 Vali Loss: 0.311 Vali Acc: 0.944 Test Loss: 0.311 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0002495
	speed: 0.6299s/iter; left time: 24653.6420s
	iters: 200, epoch: 6 | loss: 0.4682919
	speed: 0.3149s/iter; left time: 12292.9582s
	iters: 300, epoch: 6 | loss: 0.0856070
	speed: 0.3095s/iter; left time: 12050.4615s
	iters: 400, epoch: 6 | loss: 0.1400323
	speed: 0.3134s/iter; left time: 12169.5165s
Epoch: 6 cost time: 131.373441696167
Epoch: 6, Steps: 413 | Train Loss: 0.128 Vali Loss: 0.153 Vali Acc: 0.980 Test Loss: 0.153 Test Acc: 0.980
Validation loss decreased (-0.972714 --> -0.979989).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1556595
	speed: 0.5684s/iter; left time: 22009.8941s
	iters: 200, epoch: 7 | loss: 0.0016349
	speed: 0.3180s/iter; left time: 12281.9282s
	iters: 300, epoch: 7 | loss: 0.0000272
	speed: 0.2821s/iter; left time: 10869.0332s
	iters: 400, epoch: 7 | loss: 0.0056694
	speed: 0.3107s/iter; left time: 11937.3298s
Epoch: 7 cost time: 124.46713829040527
Epoch: 7, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.251 Vali Acc: 0.960 Test Loss: 0.251 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0009183
	speed: 0.5818s/iter; left time: 22289.4644s
	iters: 200, epoch: 8 | loss: 0.0299538
	speed: 0.3241s/iter; left time: 12382.9931s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.3163s/iter; left time: 12053.9229s
	iters: 400, epoch: 8 | loss: 0.0000011
	speed: 0.3237s/iter; left time: 12305.2214s
Epoch: 8 cost time: 130.64859056472778
Epoch: 8, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.275 Vali Acc: 0.960 Test Loss: 0.275 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000047
	speed: 0.6261s/iter; left time: 23727.6752s
	iters: 200, epoch: 9 | loss: 0.2005613
	speed: 0.3009s/iter; left time: 11374.3936s
	iters: 300, epoch: 9 | loss: 0.0000059
	speed: 0.3121s/iter; left time: 11764.1174s
	iters: 400, epoch: 9 | loss: 0.0257653
	speed: 0.2879s/iter; left time: 10822.3418s
Epoch: 9 cost time: 124.48631620407104
Epoch: 9, Steps: 413 | Train Loss: 0.133 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000001
	speed: 0.6089s/iter; left time: 22823.2930s
	iters: 200, epoch: 10 | loss: 0.0000031
	speed: 0.3130s/iter; left time: 11702.4057s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.3242s/iter; left time: 12089.2200s
	iters: 400, epoch: 10 | loss: 0.1820298
	speed: 0.3144s/iter; left time: 11691.6964s
Epoch: 10 cost time: 130.9875464439392
Epoch: 10, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.286 Vali Acc: 0.969 Test Loss: 0.286 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.6360s/iter; left time: 23578.0570s
	iters: 200, epoch: 11 | loss: 0.0000029
	speed: 0.3087s/iter; left time: 11413.8338s
	iters: 300, epoch: 11 | loss: 0.0000061
	speed: 0.3002s/iter; left time: 11069.7293s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.3158s/iter; left time: 11612.0911s
Epoch: 11 cost time: 129.74573945999146
Epoch: 11, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.196 Vali Acc: 0.973 Test Loss: 0.196 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.1580373
	speed: 0.5970s/iter; left time: 21886.0907s
	iters: 200, epoch: 12 | loss: 0.0000115
	speed: 0.3164s/iter; left time: 11565.8636s
	iters: 300, epoch: 12 | loss: 0.2176674
	speed: 0.2851s/iter; left time: 10392.6575s
	iters: 400, epoch: 12 | loss: 0.0151738
	speed: 0.3068s/iter; left time: 11155.8717s
Epoch: 12 cost time: 126.38371205329895
Epoch: 12, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.195 Vali Acc: 0.976 Test Loss: 0.195 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000475
	speed: 0.5936s/iter; left time: 21514.2213s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.3145s/iter; left time: 11366.8511s
	iters: 300, epoch: 13 | loss: 0.8067160
	speed: 0.3130s/iter; left time: 11283.3545s
	iters: 400, epoch: 13 | loss: 0.0000312
	speed: 0.3075s/iter; left time: 11051.6481s
Epoch: 13 cost time: 127.7820816040039
Epoch: 13, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.301 Vali Acc: 0.962 Test Loss: 0.301 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.6152s/iter; left time: 22044.2244s
	iters: 200, epoch: 14 | loss: 0.0000024
	speed: 0.3085s/iter; left time: 11023.3500s
	iters: 300, epoch: 14 | loss: 0.0000173
	speed: 0.3055s/iter; left time: 10886.2392s
	iters: 400, epoch: 14 | loss: 0.7154405
	speed: 0.2908s/iter; left time: 10334.2017s
Epoch: 14 cost time: 124.36001110076904
Epoch: 14, Steps: 413 | Train Loss: 0.124 Vali Loss: 0.379 Vali Acc: 0.963 Test Loss: 0.379 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0000006
	speed: 0.5778s/iter; left time: 20463.4775s
	iters: 200, epoch: 15 | loss: 0.2641732
	speed: 0.3030s/iter; left time: 10701.9112s
	iters: 300, epoch: 15 | loss: 0.0000613
	speed: 0.3115s/iter; left time: 10971.3741s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.3066s/iter; left time: 10767.5710s
Epoch: 15 cost time: 127.54827570915222
Epoch: 15, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.133 Vali Acc: 0.980 Test Loss: 0.133 Test Acc: 0.980
Validation loss decreased (-0.979989 --> -0.980444).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0158909
	speed: 0.6532s/iter; left time: 22866.5977s
	iters: 200, epoch: 16 | loss: 0.0007101
	speed: 0.3060s/iter; left time: 10680.9099s
	iters: 300, epoch: 16 | loss: 0.0000689
	speed: 0.3238s/iter; left time: 11269.9497s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.3034s/iter; left time: 10531.4130s
Epoch: 16 cost time: 132.047682762146
Epoch: 16, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.195 Vali Acc: 0.975 Test Loss: 0.195 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 3.0981665
	speed: 0.6126s/iter; left time: 21191.8445s
	iters: 200, epoch: 17 | loss: 0.0910695
	speed: 0.3160s/iter; left time: 10899.9403s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.3083s/iter; left time: 10604.1440s
	iters: 400, epoch: 17 | loss: 0.0000002
	speed: 0.3101s/iter; left time: 10635.1070s
Epoch: 17 cost time: 127.58031678199768
Epoch: 17, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.399 Vali Acc: 0.967 Test Loss: 0.399 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0004105
	speed: 0.6376s/iter; left time: 21792.7792s
	iters: 200, epoch: 18 | loss: 0.0018695
	speed: 0.3025s/iter; left time: 10308.5638s
	iters: 300, epoch: 18 | loss: 0.0053938
	speed: 0.2898s/iter; left time: 9847.2744s
	iters: 400, epoch: 18 | loss: 0.0072679
	speed: 0.3249s/iter; left time: 11007.1727s
Epoch: 18 cost time: 128.741623878479
Epoch: 18, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.191 Vali Acc: 0.976 Test Loss: 0.191 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.6312s/iter; left time: 21315.1316s
	iters: 200, epoch: 19 | loss: 0.0000524
	speed: 0.3090s/iter; left time: 10402.5606s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.3170s/iter; left time: 10640.1635s
	iters: 400, epoch: 19 | loss: 1.0367084
	speed: 0.3212s/iter; left time: 10749.4093s
Epoch: 19 cost time: 132.02268409729004
Epoch: 19, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.227 Vali Acc: 0.977 Test Loss: 0.227 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.6447s/iter; left time: 21502.4269s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.3106s/iter; left time: 10330.2555s
	iters: 300, epoch: 20 | loss: 0.0000803
	speed: 0.3222s/iter; left time: 10682.1685s
	iters: 400, epoch: 20 | loss: 0.0000993
	speed: 0.3142s/iter; left time: 10383.9277s
Epoch: 20 cost time: 131.0947778224945
Epoch: 20, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.159 Vali Acc: 0.979 Test Loss: 0.159 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0013858
	speed: 0.6330s/iter; left time: 20851.6699s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.3310s/iter; left time: 10870.9541s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.2969s/iter; left time: 9722.4085s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.3058s/iter; left time: 9982.1955s
Epoch: 21 cost time: 129.03538990020752
Epoch: 21, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.425 Vali Acc: 0.960 Test Loss: 0.425 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0000002
	speed: 0.5847s/iter; left time: 19019.3229s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.3134s/iter; left time: 10162.5099s
	iters: 300, epoch: 22 | loss: 0.1183729
	speed: 0.3039s/iter; left time: 9825.4178s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.3219s/iter; left time: 10373.7159s
Epoch: 22 cost time: 127.11101055145264
Epoch: 22, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.241 Vali Acc: 0.977 Test Loss: 0.241 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0000458
	speed: 0.6179s/iter; left time: 19843.8601s
	iters: 200, epoch: 23 | loss: 0.0000204
	speed: 0.3027s/iter; left time: 9690.1848s
	iters: 300, epoch: 23 | loss: 0.3823170
	speed: 0.2991s/iter; left time: 9546.9984s
	iters: 400, epoch: 23 | loss: 0.0000058
	speed: 0.3073s/iter; left time: 9777.2473s
Epoch: 23 cost time: 126.36528992652893
Epoch: 23, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.341 Vali Acc: 0.971 Test Loss: 0.341 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0000048
	speed: 0.6065s/iter; left time: 19226.5717s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.3170s/iter; left time: 10018.0463s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.3055s/iter; left time: 9623.2990s
	iters: 400, epoch: 24 | loss: 0.0000081
	speed: 0.3078s/iter; left time: 9665.4230s
Epoch: 24 cost time: 127.81208443641663
Epoch: 24, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.535 Vali Acc: 0.965 Test Loss: 0.535 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.6132s/iter; left time: 19186.4844s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.3114s/iter; left time: 9711.1526s
	iters: 300, epoch: 25 | loss: 0.0000002
	speed: 0.2952s/iter; left time: 9177.4187s
	iters: 400, epoch: 25 | loss: 0.0180951
	speed: 0.2883s/iter; left time: 8932.6586s
Epoch: 25 cost time: 123.56155586242676
Epoch: 25, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.219 Vali Acc: 0.977 Test Loss: 0.219 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9804456571168713
model parameter : 4160010
model size : 25.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5792128
	speed: 0.3161s/iter; left time: 13025.3017s
	iters: 200, epoch: 1 | loss: 0.1332135
	speed: 0.2931s/iter; left time: 12044.6923s
	iters: 300, epoch: 1 | loss: 0.1209652
	speed: 0.3002s/iter; left time: 12306.6165s
	iters: 400, epoch: 1 | loss: 0.0508881
	speed: 0.3157s/iter; left time: 12913.8879s
Epoch: 1 cost time: 127.31434535980225
Epoch: 1, Steps: 413 | Train Loss: 0.475 Vali Loss: 0.119 Vali Acc: 0.958 Test Loss: 0.119 Test Acc: 0.958
Validation loss decreased (inf --> -0.958162).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0014518
	speed: 0.6166s/iter; left time: 25149.1211s
	iters: 200, epoch: 2 | loss: 0.0643298
	speed: 0.3221s/iter; left time: 13107.6063s
	iters: 300, epoch: 2 | loss: 0.0261997
	speed: 0.3163s/iter; left time: 12838.9998s
	iters: 400, epoch: 2 | loss: 0.2481861
	speed: 0.3229s/iter; left time: 13073.2934s
Epoch: 2 cost time: 131.51936101913452
Epoch: 2, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.174 Vali Acc: 0.955 Test Loss: 0.174 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0245187
	speed: 0.5989s/iter; left time: 24181.1173s
	iters: 200, epoch: 3 | loss: 0.1015759
	speed: 0.3033s/iter; left time: 12215.8243s
	iters: 300, epoch: 3 | loss: 0.0005937
	speed: 0.2965s/iter; left time: 11913.1252s
	iters: 400, epoch: 3 | loss: 0.1306066
	speed: 0.3154s/iter; left time: 12641.0811s
Epoch: 3 cost time: 125.13593864440918
Epoch: 3, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.278 Vali Acc: 0.930 Test Loss: 0.278 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.4997268
	speed: 0.5698s/iter; left time: 22770.7578s
	iters: 200, epoch: 4 | loss: 0.0048583
	speed: 0.3087s/iter; left time: 12304.2647s
	iters: 300, epoch: 4 | loss: 0.1049788
	speed: 0.2960s/iter; left time: 11771.3835s
	iters: 400, epoch: 4 | loss: 0.2103424
	speed: 0.3106s/iter; left time: 12318.9091s
Epoch: 4 cost time: 123.70872688293457
Epoch: 4, Steps: 413 | Train Loss: 0.122 Vali Loss: 0.241 Vali Acc: 0.955 Test Loss: 0.241 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0339593
	speed: 0.6193s/iter; left time: 24491.3916s
	iters: 200, epoch: 5 | loss: 0.0100799
	speed: 0.3201s/iter; left time: 12628.1442s
	iters: 300, epoch: 5 | loss: 0.0909728
	speed: 0.3034s/iter; left time: 11936.6298s
	iters: 400, epoch: 5 | loss: 0.0000382
	speed: 0.3271s/iter; left time: 12837.0082s
Epoch: 5 cost time: 130.95398259162903
Epoch: 5, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.162 Vali Acc: 0.973 Test Loss: 0.162 Test Acc: 0.973
Validation loss decreased (-0.958162 --> -0.972713).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000088
	speed: 0.5878s/iter; left time: 23004.2481s
	iters: 200, epoch: 6 | loss: 0.0037966
	speed: 0.2986s/iter; left time: 11656.9945s
	iters: 300, epoch: 6 | loss: 0.0011032
	speed: 0.2938s/iter; left time: 11440.0311s
	iters: 400, epoch: 6 | loss: 0.0001279
	speed: 0.3051s/iter; left time: 11850.0463s
Epoch: 6 cost time: 123.11850762367249
Epoch: 6, Steps: 413 | Train Loss: 0.134 Vali Loss: 0.352 Vali Acc: 0.945 Test Loss: 0.352 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0049329
	speed: 0.5590s/iter; left time: 21645.5092s
	iters: 200, epoch: 7 | loss: 0.0000004
	speed: 0.3015s/iter; left time: 11644.7182s
	iters: 300, epoch: 7 | loss: 0.2307662
	speed: 0.3039s/iter; left time: 11706.6496s
	iters: 400, epoch: 7 | loss: 0.0001555
	speed: 0.2967s/iter; left time: 11399.3601s
Epoch: 7 cost time: 123.22412323951721
Epoch: 7, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.145 Vali Acc: 0.980 Test Loss: 0.145 Test Acc: 0.980
Validation loss decreased (-0.972713 --> -0.979535).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.3266951
	speed: 0.6019s/iter; left time: 23058.9503s
	iters: 200, epoch: 8 | loss: 0.0000529
	speed: 0.2946s/iter; left time: 11256.3486s
	iters: 300, epoch: 8 | loss: 0.0000195
	speed: 0.3037s/iter; left time: 11574.0384s
	iters: 400, epoch: 8 | loss: 0.0005907
	speed: 0.3097s/iter; left time: 11771.9127s
Epoch: 8 cost time: 125.5169746875763
Epoch: 8, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.288 Vali Acc: 0.965 Test Loss: 0.288 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000011
	speed: 0.5933s/iter; left time: 22484.6825s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.2988s/iter; left time: 11294.2195s
	iters: 300, epoch: 9 | loss: 0.0003983
	speed: 0.3009s/iter; left time: 11344.5021s
	iters: 400, epoch: 9 | loss: 0.0031539
	speed: 0.2959s/iter; left time: 11124.9370s
Epoch: 9 cost time: 123.56988286972046
Epoch: 9, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.286 Vali Acc: 0.957 Test Loss: 0.286 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000248
	speed: 0.6031s/iter; left time: 22607.5783s
	iters: 200, epoch: 10 | loss: 0.0000025
	speed: 0.2995s/iter; left time: 11195.7155s
	iters: 300, epoch: 10 | loss: 0.0000056
	speed: 0.3157s/iter; left time: 11770.2526s
	iters: 400, epoch: 10 | loss: 0.0026681
	speed: 0.3066s/iter; left time: 11399.1009s
Epoch: 10 cost time: 126.7092456817627
Epoch: 10, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.195 Vali Acc: 0.974 Test Loss: 0.195 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0038210
	speed: 0.6051s/iter; left time: 22430.2226s
	iters: 200, epoch: 11 | loss: 0.0000148
	speed: 0.3121s/iter; left time: 11539.8571s
	iters: 300, epoch: 11 | loss: 0.4191675
	speed: 0.3064s/iter; left time: 11298.8266s
	iters: 400, epoch: 11 | loss: 0.0000002
	speed: 0.3239s/iter; left time: 11911.7696s
Epoch: 11 cost time: 129.62215948104858
Epoch: 11, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.350 Vali Acc: 0.961 Test Loss: 0.350 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.1334858
	speed: 0.5907s/iter; left time: 21654.4975s
	iters: 200, epoch: 12 | loss: 0.0000166
	speed: 0.3061s/iter; left time: 11190.9059s
	iters: 300, epoch: 12 | loss: 0.0588812
	speed: 0.3077s/iter; left time: 11219.5381s
	iters: 400, epoch: 12 | loss: 0.0592080
	speed: 0.3136s/iter; left time: 11402.4764s
Epoch: 12 cost time: 126.0552761554718
Epoch: 12, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.132 Vali Acc: 0.981 Test Loss: 0.132 Test Acc: 0.981
Validation loss decreased (-0.979535 --> -0.981354).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.2157896
	speed: 0.6247s/iter; left time: 22642.9342s
	iters: 200, epoch: 13 | loss: 0.0000004
	speed: 0.2911s/iter; left time: 10523.2631s
	iters: 300, epoch: 13 | loss: 0.0000303
	speed: 0.2998s/iter; left time: 10807.3030s
	iters: 400, epoch: 13 | loss: 4.2090364
	speed: 0.3297s/iter; left time: 11850.2603s
Epoch: 13 cost time: 127.85019254684448
Epoch: 13, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.243 Vali Acc: 0.973 Test Loss: 0.243 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.5599s/iter; left time: 20062.7078s
	iters: 200, epoch: 14 | loss: 0.0000001
	speed: 0.2957s/iter; left time: 10564.6452s
	iters: 300, epoch: 14 | loss: 0.0000147
	speed: 0.2811s/iter; left time: 10015.9647s
	iters: 400, epoch: 14 | loss: 0.0000048
	speed: 0.2919s/iter; left time: 10373.3637s
Epoch: 14 cost time: 119.37886691093445
Epoch: 14, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.322 Vali Acc: 0.966 Test Loss: 0.322 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0004005
	speed: 0.6036s/iter; left time: 21379.8958s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.2761s/iter; left time: 9751.8820s
	iters: 300, epoch: 15 | loss: 0.2559670
	speed: 0.2899s/iter; left time: 10211.3318s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.3005s/iter; left time: 10554.1270s
Epoch: 15 cost time: 121.73427200317383
Epoch: 15, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.224 Vali Acc: 0.974 Test Loss: 0.224 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000067
	speed: 0.5615s/iter; left time: 19656.8827s
	iters: 200, epoch: 16 | loss: 0.0000129
	speed: 0.2945s/iter; left time: 10278.6345s
	iters: 300, epoch: 16 | loss: 0.0001010
	speed: 0.2911s/iter; left time: 10132.4221s
	iters: 400, epoch: 16 | loss: 0.0000002
	speed: 0.2980s/iter; left time: 10342.4131s
Epoch: 16 cost time: 120.74011373519897
Epoch: 16, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.251 Vali Acc: 0.975 Test Loss: 0.251 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.1657084
	speed: 0.6012s/iter; left time: 20796.9217s
	iters: 200, epoch: 17 | loss: 0.0208267
	speed: 0.2927s/iter; left time: 10095.8286s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.2916s/iter; left time: 10027.6879s
	iters: 400, epoch: 17 | loss: 0.2476954
	speed: 0.2905s/iter; left time: 9961.5216s
Epoch: 17 cost time: 122.81432104110718
Epoch: 17, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.339 Vali Acc: 0.967 Test Loss: 0.339 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0302762
	speed: 0.5660s/iter; left time: 19346.6494s
	iters: 200, epoch: 18 | loss: 0.0392034
	speed: 0.2837s/iter; left time: 9668.6853s
	iters: 300, epoch: 18 | loss: 0.0000104
	speed: 0.2968s/iter; left time: 10085.8488s
	iters: 400, epoch: 18 | loss: 0.0000003
	speed: 0.2898s/iter; left time: 9819.8159s
Epoch: 18 cost time: 118.68751120567322
Epoch: 18, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.306 Vali Acc: 0.973 Test Loss: 0.306 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0008447
	speed: 0.6043s/iter; left time: 20404.8682s
	iters: 200, epoch: 19 | loss: 0.0000149
	speed: 0.3052s/iter; left time: 10276.6182s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.3206s/iter; left time: 10762.5849s
	iters: 400, epoch: 19 | loss: 0.0000030
	speed: 0.3118s/iter; left time: 10436.0495s
Epoch: 19 cost time: 129.521954536438
Epoch: 19, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.270 Vali Acc: 0.974 Test Loss: 0.270 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000013
	speed: 0.6281s/iter; left time: 20949.7690s
	iters: 200, epoch: 20 | loss: 0.0000001
	speed: 0.3205s/iter; left time: 10658.5278s
	iters: 300, epoch: 20 | loss: 0.0000188
	speed: 0.3165s/iter; left time: 10492.0241s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.2946s/iter; left time: 9738.7080s
Epoch: 20 cost time: 128.85887742042542
Epoch: 20, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.275 Vali Acc: 0.970 Test Loss: 0.275 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000835
	speed: 0.6098s/iter; left time: 20088.2012s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.2786s/iter; left time: 9150.0542s
	iters: 300, epoch: 21 | loss: 0.0813901
	speed: 0.3110s/iter; left time: 10182.8851s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.3328s/iter; left time: 10862.4004s
Epoch: 21 cost time: 128.18813943862915
Epoch: 21, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.293 Vali Acc: 0.964 Test Loss: 0.293 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0046971
	speed: 0.6556s/iter; left time: 21324.7506s
	iters: 200, epoch: 22 | loss: 0.0209228
	speed: 0.3058s/iter; left time: 9917.1440s
	iters: 300, epoch: 22 | loss: 0.0000006
	speed: 0.3004s/iter; left time: 9711.5663s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.3161s/iter; left time: 10187.1040s
Epoch: 22 cost time: 130.4056580066681
Epoch: 22, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.234 Vali Acc: 0.972 Test Loss: 0.234 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9813551614370168
model parameter : 4160010
model size : 25.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8726045
	speed: 0.3356s/iter; left time: 13829.0533s
	iters: 200, epoch: 1 | loss: 0.1685138
	speed: 0.3180s/iter; left time: 13071.5601s
	iters: 300, epoch: 1 | loss: 0.0945449
	speed: 0.3177s/iter; left time: 13025.7015s
	iters: 400, epoch: 1 | loss: 0.3964614
	speed: 0.3141s/iter; left time: 12849.0324s
Epoch: 1 cost time: 132.30451273918152
Epoch: 1, Steps: 413 | Train Loss: 0.593 Vali Loss: 0.080 Vali Acc: 0.972 Test Loss: 0.080 Test Acc: 0.972
Validation loss decreased (inf --> -0.972259).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0088500
	speed: 0.5733s/iter; left time: 23383.3905s
	iters: 200, epoch: 2 | loss: 0.2014686
	speed: 0.2929s/iter; left time: 11915.8423s
	iters: 300, epoch: 2 | loss: 0.0787171
	speed: 0.2899s/iter; left time: 11765.1879s
	iters: 400, epoch: 2 | loss: 0.0044813
	speed: 0.2902s/iter; left time: 11747.7860s
Epoch: 2 cost time: 121.1816086769104
Epoch: 2, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.236 Vali Acc: 0.930 Test Loss: 0.236 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0027695
	speed: 0.5815s/iter; left time: 23479.2799s
	iters: 200, epoch: 3 | loss: 0.0115162
	speed: 0.3066s/iter; left time: 12349.2691s
	iters: 300, epoch: 3 | loss: 0.1050091
	speed: 0.3127s/iter; left time: 12561.5244s
	iters: 400, epoch: 3 | loss: 0.0050249
	speed: 0.2934s/iter; left time: 11759.3762s
Epoch: 3 cost time: 124.88658499717712
Epoch: 3, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0158418
	speed: 0.5847s/iter; left time: 23363.9370s
	iters: 200, epoch: 4 | loss: 0.0221414
	speed: 0.2846s/iter; left time: 11344.2787s
	iters: 300, epoch: 4 | loss: 0.9397975
	speed: 0.2977s/iter; left time: 11837.1147s
	iters: 400, epoch: 4 | loss: 0.1689325
	speed: 0.2959s/iter; left time: 11734.9313s
Epoch: 4 cost time: 121.89862275123596
Epoch: 4, Steps: 413 | Train Loss: 0.148 Vali Loss: 0.294 Vali Acc: 0.943 Test Loss: 0.294 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0057224
	speed: 0.5770s/iter; left time: 22819.9267s
	iters: 200, epoch: 5 | loss: 0.0006247
	speed: 0.2975s/iter; left time: 11734.5480s
	iters: 300, epoch: 5 | loss: 0.1284415
	speed: 0.2897s/iter; left time: 11400.2062s
	iters: 400, epoch: 5 | loss: 0.0004062
	speed: 0.3045s/iter; left time: 11950.8840s
Epoch: 5 cost time: 123.3429708480835
Epoch: 5, Steps: 413 | Train Loss: 0.156 Vali Loss: 0.183 Vali Acc: 0.965 Test Loss: 0.183 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0001753
	speed: 0.5407s/iter; left time: 21160.9691s
	iters: 200, epoch: 6 | loss: 0.0898311
	speed: 0.2838s/iter; left time: 11079.7903s
	iters: 300, epoch: 6 | loss: 0.0000016
	speed: 0.2758s/iter; left time: 10737.2607s
	iters: 400, epoch: 6 | loss: 0.0000391
	speed: 0.2718s/iter; left time: 10556.4647s
Epoch: 6 cost time: 113.29983758926392
Epoch: 6, Steps: 413 | Train Loss: 0.127 Vali Loss: 0.172 Vali Acc: 0.972 Test Loss: 0.172 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0851386
	speed: 0.5822s/iter; left time: 22542.9101s
	iters: 200, epoch: 7 | loss: 0.0001101
	speed: 0.2932s/iter; left time: 11324.4892s
	iters: 300, epoch: 7 | loss: 0.0000044
	speed: 0.3148s/iter; left time: 12126.2798s
	iters: 400, epoch: 7 | loss: 0.0000275
	speed: 0.3058s/iter; left time: 11749.9739s
Epoch: 7 cost time: 126.00813865661621
Epoch: 7, Steps: 413 | Train Loss: 0.121 Vali Loss: 0.254 Vali Acc: 0.965 Test Loss: 0.254 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.0110704
	speed: 0.5804s/iter; left time: 22234.4387s
	iters: 200, epoch: 8 | loss: 0.0386334
	speed: 0.2831s/iter; left time: 10815.9994s
	iters: 300, epoch: 8 | loss: 0.0000110
	speed: 0.3033s/iter; left time: 11557.7928s
	iters: 400, epoch: 8 | loss: 0.0086942
	speed: 0.2834s/iter; left time: 10773.8041s
Epoch: 8 cost time: 120.37091445922852
Epoch: 8, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.172 Vali Acc: 0.978 Test Loss: 0.172 Test Acc: 0.978
Validation loss decreased (-0.972259 --> -0.978170).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000005
	speed: 0.6196s/iter; left time: 23481.4917s
	iters: 200, epoch: 9 | loss: 0.0000068
	speed: 0.3086s/iter; left time: 11664.8963s
	iters: 300, epoch: 9 | loss: 0.1319126
	speed: 0.3119s/iter; left time: 11758.6784s
	iters: 400, epoch: 9 | loss: 0.0000084
	speed: 0.3170s/iter; left time: 11920.1026s
Epoch: 9 cost time: 128.5730013847351
Epoch: 9, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.235 Vali Acc: 0.968 Test Loss: 0.235 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.6313s/iter; left time: 23663.6815s
	iters: 200, epoch: 10 | loss: 0.0000022
	speed: 0.3150s/iter; left time: 11775.3384s
	iters: 300, epoch: 10 | loss: 0.0000002
	speed: 0.2764s/iter; left time: 10303.7803s
	iters: 400, epoch: 10 | loss: 0.0000001
	speed: 0.2889s/iter; left time: 10741.1734s
Epoch: 10 cost time: 123.16955208778381
Epoch: 10, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.149 Vali Acc: 0.976 Test Loss: 0.149 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0006034
	speed: 0.5757s/iter; left time: 21342.7781s
	iters: 200, epoch: 11 | loss: 0.0000031
	speed: 0.3040s/iter; left time: 11239.9489s
	iters: 300, epoch: 11 | loss: 0.0015883
	speed: 0.2852s/iter; left time: 10515.9450s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.3100s/iter; left time: 11399.4283s
Epoch: 11 cost time: 122.2972822189331
Epoch: 11, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.123 Vali Acc: 0.982 Test Loss: 0.123 Test Acc: 0.982
Validation loss decreased (-0.978170 --> -0.982263).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000328
	speed: 0.5834s/iter; left time: 21387.3174s
	iters: 200, epoch: 12 | loss: 0.0001317
	speed: 0.3153s/iter; left time: 11527.3091s
	iters: 300, epoch: 12 | loss: 0.0008275
	speed: 0.2940s/iter; left time: 10717.7357s
	iters: 400, epoch: 12 | loss: 0.0004181
	speed: 0.3047s/iter; left time: 11079.0919s
Epoch: 12 cost time: 125.48229670524597
Epoch: 12, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.167 Vali Acc: 0.977 Test Loss: 0.167 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.4603156
	speed: 0.6117s/iter; left time: 22170.3906s
	iters: 200, epoch: 13 | loss: 0.0027384
	speed: 0.3031s/iter; left time: 10956.6980s
	iters: 300, epoch: 13 | loss: 0.0064646
	speed: 0.2887s/iter; left time: 10405.7247s
	iters: 400, epoch: 13 | loss: 0.3181293
	speed: 0.3006s/iter; left time: 10803.4131s
Epoch: 13 cost time: 124.1299569606781
Epoch: 13, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.158 Vali Acc: 0.977 Test Loss: 0.158 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000021
	speed: 0.5668s/iter; left time: 20310.6102s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.2862s/iter; left time: 10228.1927s
	iters: 300, epoch: 14 | loss: 0.0000042
	speed: 0.2705s/iter; left time: 9637.3911s
	iters: 400, epoch: 14 | loss: 0.0014736
	speed: 0.3003s/iter; left time: 10669.3191s
Epoch: 14 cost time: 119.3715250492096
Epoch: 14, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.097 Vali Acc: 0.988 Test Loss: 0.097 Test Acc: 0.988
Validation loss decreased (-0.982263 --> -0.987721).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0071374
	speed: 0.5931s/iter; left time: 21007.2044s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.2940s/iter; left time: 10384.9182s
	iters: 300, epoch: 15 | loss: 1.2371606
	speed: 0.3050s/iter; left time: 10741.9601s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.3026s/iter; left time: 10626.4249s
Epoch: 15 cost time: 125.98563241958618
Epoch: 15, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.155 Vali Acc: 0.979 Test Loss: 0.155 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.5891s/iter; left time: 20621.5204s
	iters: 200, epoch: 16 | loss: 0.0000322
	speed: 0.2963s/iter; left time: 10342.4057s
	iters: 300, epoch: 16 | loss: 0.0002300
	speed: 0.3070s/iter; left time: 10686.1848s
	iters: 400, epoch: 16 | loss: 0.0005908
	speed: 0.2896s/iter; left time: 10051.7349s
Epoch: 16 cost time: 123.99432730674744
Epoch: 16, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.090 Vali Acc: 0.984 Test Loss: 0.090 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000707
	speed: 0.5990s/iter; left time: 20719.7351s
	iters: 200, epoch: 17 | loss: 0.0005345
	speed: 0.2975s/iter; left time: 10263.1869s
	iters: 300, epoch: 17 | loss: 0.0000007
	speed: 0.2916s/iter; left time: 10028.1284s
	iters: 400, epoch: 17 | loss: 0.0000008
	speed: 0.3021s/iter; left time: 10360.9035s
Epoch: 17 cost time: 123.10797595977783
Epoch: 17, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.169 Vali Acc: 0.974 Test Loss: 0.169 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0355567
	speed: 0.6483s/iter; left time: 22158.8806s
	iters: 200, epoch: 18 | loss: 0.0012200
	speed: 0.3190s/iter; left time: 10871.6339s
	iters: 300, epoch: 18 | loss: 0.0000040
	speed: 0.3116s/iter; left time: 10588.6798s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.3239s/iter; left time: 10973.4143s
Epoch: 18 cost time: 132.76014280319214
Epoch: 18, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.151 Vali Acc: 0.979 Test Loss: 0.151 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.6293s/iter; left time: 21250.5218s
	iters: 200, epoch: 19 | loss: 0.0000097
	speed: 0.2970s/iter; left time: 9997.7184s
	iters: 300, epoch: 19 | loss: 0.0000051
	speed: 0.3154s/iter; left time: 10587.3947s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.3046s/iter; left time: 10193.8321s
Epoch: 19 cost time: 128.71081829071045
Epoch: 19, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.143 Vali Acc: 0.977 Test Loss: 0.143 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000142
	speed: 0.6083s/iter; left time: 20288.4750s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.3138s/iter; left time: 10433.7134s
	iters: 300, epoch: 20 | loss: 0.0000169
	speed: 0.3191s/iter; left time: 10578.8561s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.3102s/iter; left time: 10252.5831s
Epoch: 20 cost time: 129.09873509407043
Epoch: 20, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.209 Vali Acc: 0.978 Test Loss: 0.209 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.6386s/iter; left time: 21036.5573s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.3204s/iter; left time: 10521.8041s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.3214s/iter; left time: 10522.6410s
	iters: 400, epoch: 21 | loss: 0.0000002
	speed: 0.3170s/iter; left time: 10346.2413s
Epoch: 21 cost time: 133.04861092567444
Epoch: 21, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.233 Vali Acc: 0.974 Test Loss: 0.233 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0008363
	speed: 0.6271s/iter; left time: 20399.8006s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.3055s/iter; left time: 9907.3264s
	iters: 300, epoch: 22 | loss: 0.0004304
	speed: 0.3108s/iter; left time: 10046.8049s
	iters: 400, epoch: 22 | loss: 0.0000144
	speed: 0.3234s/iter; left time: 10423.3634s
Epoch: 22 cost time: 130.61760663986206
Epoch: 22, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.166 Vali Acc: 0.976 Test Loss: 0.166 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0017586
	speed: 0.6217s/iter; left time: 19967.1705s
	iters: 200, epoch: 23 | loss: 0.0261578
	speed: 0.3315s/iter; left time: 10612.0999s
	iters: 300, epoch: 23 | loss: 0.9715427
	speed: 0.3332s/iter; left time: 10634.2890s
	iters: 400, epoch: 23 | loss: 0.0009432
	speed: 0.3257s/iter; left time: 10362.5843s
Epoch: 23 cost time: 135.58940720558167
Epoch: 23, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.269 Vali Acc: 0.971 Test Loss: 0.269 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0000002
	speed: 0.6886s/iter; left time: 21828.4552s
	iters: 200, epoch: 24 | loss: 0.6161095
	speed: 0.3007s/iter; left time: 9504.1212s
	iters: 300, epoch: 24 | loss: 0.1455560
	speed: 0.3042s/iter; left time: 9582.3609s
	iters: 400, epoch: 24 | loss: 0.0000001
	speed: 0.3263s/iter; left time: 10247.7644s
Epoch: 24 cost time: 132.77232933044434
Epoch: 24, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.155 Vali Acc: 0.979 Test Loss: 0.155 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9877216916780355
model parameter : 4160010
model size : 25.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8607134
	speed: 0.3193s/iter; left time: 13153.4783s
	iters: 200, epoch: 1 | loss: 0.1728184
	speed: 0.2908s/iter; left time: 11953.4251s
	iters: 300, epoch: 1 | loss: 0.1367776
	speed: 0.2822s/iter; left time: 11569.0267s
	iters: 400, epoch: 1 | loss: 0.2292851
	speed: 0.2937s/iter; left time: 12012.2174s
Epoch: 1 cost time: 122.66530084609985
Epoch: 1, Steps: 413 | Train Loss: 0.637 Vali Loss: 0.107 Vali Acc: 0.961 Test Loss: 0.107 Test Acc: 0.961
Validation loss decreased (inf --> -0.960890).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0887646
	speed: 0.6061s/iter; left time: 24723.0987s
	iters: 200, epoch: 2 | loss: 0.1541386
	speed: 0.2915s/iter; left time: 11858.8985s
	iters: 300, epoch: 2 | loss: 0.0255828
	speed: 0.3245s/iter; left time: 13172.4591s
	iters: 400, epoch: 2 | loss: 0.1758323
	speed: 0.3025s/iter; left time: 12246.2606s
Epoch: 2 cost time: 125.6053535938263
Epoch: 2, Steps: 413 | Train Loss: 0.122 Vali Loss: 0.144 Vali Acc: 0.960 Test Loss: 0.144 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.4350789
	speed: 0.5848s/iter; left time: 23611.5972s
	iters: 200, epoch: 3 | loss: 0.0143364
	speed: 0.3220s/iter; left time: 12970.0916s
	iters: 300, epoch: 3 | loss: 0.0686477
	speed: 0.2919s/iter; left time: 11728.4116s
	iters: 400, epoch: 3 | loss: 0.1997473
	speed: 0.2946s/iter; left time: 11807.9026s
Epoch: 3 cost time: 124.72691130638123
Epoch: 3, Steps: 413 | Train Loss: 0.130 Vali Loss: 0.262 Vali Acc: 0.949 Test Loss: 0.262 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0866407
	speed: 0.5915s/iter; left time: 23636.4047s
	iters: 200, epoch: 4 | loss: 0.0004784
	speed: 0.2995s/iter; left time: 11939.5445s
	iters: 300, epoch: 4 | loss: 0.0636477
	speed: 0.3215s/iter; left time: 12782.1101s
	iters: 400, epoch: 4 | loss: 0.0001581
	speed: 0.3355s/iter; left time: 13308.5107s
Epoch: 4 cost time: 129.83816289901733
Epoch: 4, Steps: 413 | Train Loss: 0.130 Vali Loss: 0.186 Vali Acc: 0.962 Test Loss: 0.186 Test Acc: 0.962
Validation loss decreased (-0.960890 --> -0.961799).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0070269
	speed: 0.6276s/iter; left time: 24820.0136s
	iters: 200, epoch: 5 | loss: 0.3085572
	speed: 0.3235s/iter; left time: 12763.1939s
	iters: 300, epoch: 5 | loss: 0.0004954
	speed: 0.3118s/iter; left time: 12269.6604s
	iters: 400, epoch: 5 | loss: 0.0062527
	speed: 0.2993s/iter; left time: 11745.4627s
Epoch: 5 cost time: 129.4779942035675
Epoch: 5, Steps: 413 | Train Loss: 0.140 Vali Loss: 0.360 Vali Acc: 0.933 Test Loss: 0.360 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0142811
	speed: 0.6542s/iter; left time: 25603.2136s
	iters: 200, epoch: 6 | loss: 0.0012952
	speed: 0.2953s/iter; left time: 11528.8237s
	iters: 300, epoch: 6 | loss: 0.0000347
	speed: 0.3237s/iter; left time: 12601.7345s
	iters: 400, epoch: 6 | loss: 0.0000000
	speed: 0.3192s/iter; left time: 12397.6484s
Epoch: 6 cost time: 130.19683599472046
Epoch: 6, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.133 Vali Acc: 0.978 Test Loss: 0.133 Test Acc: 0.978
Validation loss decreased (-0.961799 --> -0.977716).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0038723
	speed: 0.6401s/iter; left time: 24785.6787s
	iters: 200, epoch: 7 | loss: 0.0082516
	speed: 0.3200s/iter; left time: 12360.1866s
	iters: 300, epoch: 7 | loss: 0.0000747
	speed: 0.3150s/iter; left time: 12135.2252s
	iters: 400, epoch: 7 | loss: 0.0797640
	speed: 0.3213s/iter; left time: 12346.9131s
Epoch: 7 cost time: 132.22042608261108
Epoch: 7, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.362 Vali Acc: 0.956 Test Loss: 0.362 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.7716407
	speed: 0.6563s/iter; left time: 25144.7074s
	iters: 200, epoch: 8 | loss: 0.0004086
	speed: 0.3030s/iter; left time: 11578.0011s
	iters: 300, epoch: 8 | loss: 0.0000000
	speed: 0.3179s/iter; left time: 12116.8616s
	iters: 400, epoch: 8 | loss: 0.1747151
	speed: 0.3184s/iter; left time: 12102.0502s
Epoch: 8 cost time: 130.2074728012085
Epoch: 8, Steps: 413 | Train Loss: 0.111 Vali Loss: 0.157 Vali Acc: 0.969 Test Loss: 0.157 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0024731
	speed: 0.6266s/iter; left time: 23744.4620s
	iters: 200, epoch: 9 | loss: 0.0005110
	speed: 0.3355s/iter; left time: 12681.5354s
	iters: 300, epoch: 9 | loss: 0.0000016
	speed: 0.3153s/iter; left time: 11886.8664s
	iters: 400, epoch: 9 | loss: 0.0000004
	speed: 0.3126s/iter; left time: 11751.0378s
Epoch: 9 cost time: 132.90866923332214
Epoch: 9, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.240 Vali Acc: 0.968 Test Loss: 0.240 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000516
	speed: 0.6178s/iter; left time: 23156.3327s
	iters: 200, epoch: 10 | loss: 0.0000010
	speed: 0.3057s/iter; left time: 11429.5321s
	iters: 300, epoch: 10 | loss: 0.0000001
	speed: 0.3117s/iter; left time: 11619.8802s
	iters: 400, epoch: 10 | loss: 0.0000889
	speed: 0.3016s/iter; left time: 11216.2367s
Epoch: 10 cost time: 126.87734842300415
Epoch: 10, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.181 Vali Acc: 0.973 Test Loss: 0.181 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000130
	speed: 0.5891s/iter; left time: 21837.4198s
	iters: 200, epoch: 11 | loss: 0.0000001
	speed: 0.2977s/iter; left time: 11005.6970s
	iters: 300, epoch: 11 | loss: 0.0079403
	speed: 0.2911s/iter; left time: 10733.8198s
	iters: 400, epoch: 11 | loss: 0.0044829
	speed: 0.2908s/iter; left time: 10693.7207s
Epoch: 11 cost time: 122.02930760383606
Epoch: 11, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.142 Vali Acc: 0.975 Test Loss: 0.142 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0031425
	speed: 0.6103s/iter; left time: 22373.2937s
	iters: 200, epoch: 12 | loss: 0.0000535
	speed: 0.2905s/iter; left time: 10618.5860s
	iters: 300, epoch: 12 | loss: 0.0059656
	speed: 0.2832s/iter; left time: 10325.4324s
	iters: 400, epoch: 12 | loss: 0.0000892
	speed: 0.2947s/iter; left time: 10716.5097s
Epoch: 12 cost time: 121.69188189506531
Epoch: 12, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.302 Vali Acc: 0.964 Test Loss: 0.302 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.6511s/iter; left time: 23598.7897s
	iters: 200, epoch: 13 | loss: 0.0000141
	speed: 0.3051s/iter; left time: 11026.1304s
	iters: 300, epoch: 13 | loss: 0.9333406
	speed: 0.3123s/iter; left time: 11256.1046s
	iters: 400, epoch: 13 | loss: 0.1876875
	speed: 0.3185s/iter; left time: 11447.4630s
Epoch: 13 cost time: 130.48238587379456
Epoch: 13, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000685
	speed: 0.5784s/iter; left time: 20724.4396s
	iters: 200, epoch: 14 | loss: 0.0084571
	speed: 0.3080s/iter; left time: 11005.1233s
	iters: 300, epoch: 14 | loss: 0.0000001
	speed: 0.2799s/iter; left time: 9973.5595s
	iters: 400, epoch: 14 | loss: 0.0000032
	speed: 0.3021s/iter; left time: 10735.9175s
Epoch: 14 cost time: 123.14220857620239
Epoch: 14, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.098 Vali Acc: 0.981 Test Loss: 0.098 Test Acc: 0.981
Validation loss decreased (-0.977716 --> -0.980899).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000002
	speed: 0.6128s/iter; left time: 21704.2570s
	iters: 200, epoch: 15 | loss: 0.0000008
	speed: 0.3220s/iter; left time: 11372.0743s
	iters: 300, epoch: 15 | loss: 0.0007460
	speed: 0.3025s/iter; left time: 10655.4852s
	iters: 400, epoch: 15 | loss: 0.0000016
	speed: 0.2967s/iter; left time: 10418.8119s
Epoch: 15 cost time: 126.98864579200745
Epoch: 15, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.182 Vali Acc: 0.975 Test Loss: 0.182 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.6261s/iter; left time: 21917.1772s
	iters: 200, epoch: 16 | loss: 0.0001535
	speed: 0.2991s/iter; left time: 10441.0801s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.3093s/iter; left time: 10767.2245s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.3039s/iter; left time: 10545.9661s
Epoch: 16 cost time: 126.85470366477966
Epoch: 16, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.163 Vali Acc: 0.972 Test Loss: 0.163 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.2808298
	speed: 0.6265s/iter; left time: 21671.9130s
	iters: 200, epoch: 17 | loss: 0.4486139
	speed: 0.3043s/iter; left time: 10495.0851s
	iters: 300, epoch: 17 | loss: 0.0007097
	speed: 0.3249s/iter; left time: 11173.9084s
	iters: 400, epoch: 17 | loss: 0.2960982
	speed: 0.3266s/iter; left time: 11200.5150s
Epoch: 17 cost time: 131.51582026481628
Epoch: 17, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.132 Vali Acc: 0.980 Test Loss: 0.132 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0010377
	speed: 0.6237s/iter; left time: 21317.1384s
	iters: 200, epoch: 18 | loss: 0.0001811
	speed: 0.3257s/iter; left time: 11098.7128s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.2941s/iter; left time: 9993.7215s
	iters: 400, epoch: 18 | loss: 0.0000026
	speed: 0.3070s/iter; left time: 10402.0011s
Epoch: 18 cost time: 129.22377133369446
Epoch: 18, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.150 Vali Acc: 0.980 Test Loss: 0.150 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.6004s/iter; left time: 20274.8369s
	iters: 200, epoch: 19 | loss: 0.0000001
	speed: 0.3166s/iter; left time: 10658.5576s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.2973s/iter; left time: 9979.0852s
	iters: 400, epoch: 19 | loss: 0.0000130
	speed: 0.3103s/iter; left time: 10385.5123s
Epoch: 19 cost time: 127.68635320663452
Epoch: 19, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.347 Vali Acc: 0.966 Test Loss: 0.347 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000181
	speed: 0.5868s/iter; left time: 19573.2945s
	iters: 200, epoch: 20 | loss: 0.0000004
	speed: 0.3069s/iter; left time: 10204.2815s
	iters: 300, epoch: 20 | loss: 0.3254956
	speed: 0.3230s/iter; left time: 10708.6398s
	iters: 400, epoch: 20 | loss: 0.0000001
	speed: 0.2801s/iter; left time: 9257.4492s
Epoch: 20 cost time: 123.14083671569824
Epoch: 20, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.145 Vali Acc: 0.982 Test Loss: 0.145 Test Acc: 0.982
Validation loss decreased (-0.980899 --> -0.981808).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000300
	speed: 0.6026s/iter; left time: 19848.8854s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.2715s/iter; left time: 8915.8314s
	iters: 300, epoch: 21 | loss: 0.0000001
	speed: 0.2813s/iter; left time: 9210.3814s
	iters: 400, epoch: 21 | loss: 0.0000006
	speed: 0.2648s/iter; left time: 8644.5441s
Epoch: 21 cost time: 115.66623950004578
Epoch: 21, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.194 Vali Acc: 0.975 Test Loss: 0.194 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000002
	speed: 0.5734s/iter; left time: 18652.2591s
	iters: 200, epoch: 22 | loss: 0.0001036
	speed: 0.2990s/iter; left time: 9695.2672s
	iters: 300, epoch: 22 | loss: 0.0280572
	speed: 0.3211s/iter; left time: 10380.9178s
	iters: 400, epoch: 22 | loss: 0.0007282
	speed: 0.3260s/iter; left time: 10506.1865s
Epoch: 22 cost time: 129.11067366600037
Epoch: 22, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.181 Vali Acc: 0.974 Test Loss: 0.181 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0009511
	speed: 0.6118s/iter; left time: 19647.5395s
	iters: 200, epoch: 23 | loss: 0.0032950
	speed: 0.3219s/iter; left time: 10306.8042s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.3004s/iter; left time: 9586.6084s
	iters: 400, epoch: 23 | loss: 0.0000068
	speed: 0.3190s/iter; left time: 10147.6810s
Epoch: 23 cost time: 130.04654788970947
Epoch: 23, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.211 Vali Acc: 0.972 Test Loss: 0.211 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0000173
	speed: 0.5761s/iter; left time: 18262.2859s
	iters: 200, epoch: 24 | loss: 0.1046082
	speed: 0.3006s/iter; left time: 9498.8701s
	iters: 300, epoch: 24 | loss: 0.4408731
	speed: 0.3061s/iter; left time: 9642.4041s
	iters: 400, epoch: 24 | loss: 0.0071790
	speed: 0.3022s/iter; left time: 9490.7165s
Epoch: 24 cost time: 124.30080151557922
Epoch: 24, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.297 Vali Acc: 0.968 Test Loss: 0.297 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000001
	speed: 0.6010s/iter; left time: 18804.7768s
	iters: 200, epoch: 25 | loss: 0.0000001
	speed: 0.2938s/iter; left time: 9164.0592s
	iters: 300, epoch: 25 | loss: 0.4488056
	speed: 0.3055s/iter; left time: 9497.7274s
	iters: 400, epoch: 25 | loss: 0.0000002
	speed: 0.2984s/iter; left time: 9248.1562s
Epoch: 25 cost time: 123.81309962272644
Epoch: 25, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.211 Vali Acc: 0.977 Test Loss: 0.211 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0000064
	speed: 0.6075s/iter; left time: 18756.7603s
	iters: 200, epoch: 26 | loss: 0.0002735
	speed: 0.3000s/iter; left time: 9234.2151s
	iters: 300, epoch: 26 | loss: 1.3125257
	speed: 0.3124s/iter; left time: 9582.3506s
	iters: 400, epoch: 26 | loss: 0.0000036
	speed: 0.2855s/iter; left time: 8728.6470s
Epoch: 26 cost time: 123.07232284545898
Epoch: 26, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.178 Vali Acc: 0.978 Test Loss: 0.178 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.5922s/iter; left time: 18040.7836s
	iters: 200, epoch: 27 | loss: 0.0000100
	speed: 0.3099s/iter; left time: 9410.7557s
	iters: 300, epoch: 27 | loss: 0.0000252
	speed: 0.2913s/iter; left time: 8814.6023s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.3091s/iter; left time: 9322.2894s
Epoch: 27 cost time: 126.41063785552979
Epoch: 27, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.112 Vali Acc: 0.987 Test Loss: 0.112 Test Acc: 0.987
Validation loss decreased (-0.981808 --> -0.987266).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.5877s/iter; left time: 17659.9077s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.3064s/iter; left time: 9178.0227s
	iters: 300, epoch: 28 | loss: 0.0000007
	speed: 0.2879s/iter; left time: 8595.0400s
	iters: 400, epoch: 28 | loss: 0.0093659
	speed: 0.2890s/iter; left time: 8596.6127s
Epoch: 28 cost time: 122.18938827514648
Epoch: 28, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.240 Vali Acc: 0.969 Test Loss: 0.240 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0000123
	speed: 0.5619s/iter; left time: 16652.1336s
	iters: 200, epoch: 29 | loss: 0.0001494
	speed: 0.2791s/iter; left time: 8242.9698s
	iters: 300, epoch: 29 | loss: 0.0000092
	speed: 0.2924s/iter; left time: 8607.5559s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.2789s/iter; left time: 8181.5480s
Epoch: 29 cost time: 116.4530200958252
Epoch: 29, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0000015
	speed: 0.5662s/iter; left time: 16547.6644s
	iters: 200, epoch: 30 | loss: 0.0001903
	speed: 0.3006s/iter; left time: 8755.3590s
	iters: 300, epoch: 30 | loss: 0.0000118
	speed: 0.2928s/iter; left time: 8498.2919s
	iters: 400, epoch: 30 | loss: 0.0399024
	speed: 0.3125s/iter; left time: 9039.3504s
Epoch: 30 cost time: 123.98780012130737
Epoch: 30, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.176 Vali Acc: 0.972 Test Loss: 0.176 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.0000023
	speed: 0.6047s/iter; left time: 17421.4853s
	iters: 200, epoch: 31 | loss: 0.0005716
	speed: 0.3060s/iter; left time: 8784.9840s
	iters: 300, epoch: 31 | loss: 0.0000011
	speed: 0.2978s/iter; left time: 8519.8853s
	iters: 400, epoch: 31 | loss: 0.0000001
	speed: 0.2905s/iter; left time: 8283.1133s
Epoch: 31 cost time: 124.11567044258118
Epoch: 31, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.136 Vali Acc: 0.981 Test Loss: 0.136 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.0003681
	speed: 0.5778s/iter; left time: 16407.2388s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.2752s/iter; left time: 7788.3818s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.2968s/iter; left time: 8368.7654s
	iters: 400, epoch: 32 | loss: 0.0000026
	speed: 0.2961s/iter; left time: 8320.4791s
Epoch: 32 cost time: 120.7021861076355
Epoch: 32, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.064 Vali Acc: 0.986 Test Loss: 0.064 Test Acc: 0.986
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.5867s/iter; left time: 16418.8005s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.2914s/iter; left time: 8124.5522s
	iters: 300, epoch: 33 | loss: 0.0000001
	speed: 0.3133s/iter; left time: 8705.7264s
	iters: 400, epoch: 33 | loss: 0.0747786
	speed: 0.2954s/iter; left time: 8177.5923s
Epoch: 33 cost time: 124.25957703590393
Epoch: 33, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.232 Vali Acc: 0.969 Test Loss: 0.232 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.5889s/iter; left time: 16236.4137s
	iters: 200, epoch: 34 | loss: 0.0000008
	speed: 0.3059s/iter; left time: 8403.5917s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.2993s/iter; left time: 8193.4598s
	iters: 400, epoch: 34 | loss: 0.0000001
	speed: 0.2844s/iter; left time: 7756.1478s
Epoch: 34 cost time: 122.90483689308167
Epoch: 34, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 0.0000001
	speed: 0.5962s/iter; left time: 16191.7677s
	iters: 200, epoch: 35 | loss: 0.0000002
	speed: 0.2934s/iter; left time: 7939.6824s
	iters: 300, epoch: 35 | loss: 0.0003168
	speed: 0.2957s/iter; left time: 7970.5411s
	iters: 400, epoch: 35 | loss: 0.0000003
	speed: 0.2868s/iter; left time: 7703.6018s
Epoch: 35 cost time: 119.8675765991211
Epoch: 35, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.162 Vali Acc: 0.974 Test Loss: 0.162 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 0.0002259
	speed: 0.6019s/iter; left time: 16099.5560s
	iters: 200, epoch: 36 | loss: 0.0188584
	speed: 0.3032s/iter; left time: 8078.0606s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.2906s/iter; left time: 7714.1713s
	iters: 400, epoch: 36 | loss: 0.0000059
	speed: 0.3078s/iter; left time: 8138.9456s
Epoch: 36 cost time: 124.15974450111389
Epoch: 36, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.223 Vali Acc: 0.971 Test Loss: 0.223 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 0.0000004
	speed: 0.5931s/iter; left time: 15618.3485s
	iters: 200, epoch: 37 | loss: 0.0000071
	speed: 0.3065s/iter; left time: 8039.8896s
	iters: 300, epoch: 37 | loss: 0.0000003
	speed: 0.2922s/iter; left time: 7636.2672s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.3064s/iter; left time: 7975.8711s
Epoch: 37 cost time: 123.77619123458862
Epoch: 37, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.057 Vali Acc: 0.989 Test Loss: 0.057 Test Acc: 0.989
Validation loss decreased (-0.987266 --> -0.988631).  Saving model ...
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.6047s/iter; left time: 15673.6541s
	iters: 200, epoch: 38 | loss: 0.0000000
	speed: 0.3023s/iter; left time: 7805.8506s
	iters: 300, epoch: 38 | loss: 0.0000079
	speed: 0.2802s/iter; left time: 7207.0639s
	iters: 400, epoch: 38 | loss: 0.0000000
	speed: 0.2889s/iter; left time: 7402.2344s
Epoch: 38 cost time: 121.3821427822113
Epoch: 38, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.986 Test Loss: 0.073 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 39 | loss: 0.0000000
	speed: 0.6342s/iter; left time: 16177.0343s
	iters: 200, epoch: 39 | loss: 0.0000000
	speed: 0.3322s/iter; left time: 8440.5472s
	iters: 300, epoch: 39 | loss: 0.0000000
	speed: 0.3196s/iter; left time: 8089.2922s
	iters: 400, epoch: 39 | loss: 0.0000012
	speed: 0.3161s/iter; left time: 7968.3886s
Epoch: 39 cost time: 132.52404022216797
Epoch: 39, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.054 Vali Acc: 0.990 Test Loss: 0.054 Test Acc: 0.990
Validation loss decreased (-0.988631 --> -0.989995).  Saving model ...
	iters: 100, epoch: 40 | loss: 0.0000000
	speed: 0.6325s/iter; left time: 15873.0202s
	iters: 200, epoch: 40 | loss: 0.0000159
	speed: 0.3532s/iter; left time: 8828.3052s
	iters: 300, epoch: 40 | loss: 0.0000000
	speed: 0.3165s/iter; left time: 7879.9798s
	iters: 400, epoch: 40 | loss: 0.7640575
	speed: 0.3362s/iter; left time: 8335.8465s
Epoch: 40 cost time: 136.84817957878113
Epoch: 40, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.166 Vali Acc: 0.978 Test Loss: 0.166 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 41 | loss: 0.0000037
	speed: 0.6457s/iter; left time: 15937.0909s
	iters: 200, epoch: 41 | loss: 0.0026099
	speed: 0.3320s/iter; left time: 8161.0622s
	iters: 300, epoch: 41 | loss: 0.0000006
	speed: 0.3135s/iter; left time: 7675.8580s
	iters: 400, epoch: 41 | loss: 0.5671079
	speed: 0.3271s/iter; left time: 7974.3085s
Epoch: 41 cost time: 134.94825959205627
Epoch: 41, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.137 Vali Acc: 0.978 Test Loss: 0.137 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 42 | loss: 0.0000001
	speed: 0.6591s/iter; left time: 15995.6325s
	iters: 200, epoch: 42 | loss: 0.0000000
	speed: 0.3181s/iter; left time: 7688.1742s
	iters: 300, epoch: 42 | loss: 0.0000000
	speed: 0.3218s/iter; left time: 7744.0826s
	iters: 400, epoch: 42 | loss: 0.0001052
	speed: 0.3260s/iter; left time: 7813.3801s
Epoch: 42 cost time: 136.01204133033752
Epoch: 42, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.073 Vali Acc: 0.986 Test Loss: 0.073 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 43 | loss: 0.0000000
	speed: 0.6534s/iter; left time: 15586.2811s
	iters: 200, epoch: 43 | loss: 0.0001364
	speed: 0.3220s/iter; left time: 7649.7675s
	iters: 300, epoch: 43 | loss: 0.0140933
	speed: 0.3261s/iter; left time: 7713.1012s
	iters: 400, epoch: 43 | loss: 0.0000008
	speed: 0.3113s/iter; left time: 7331.6953s
Epoch: 43 cost time: 132.98458909988403
Epoch: 43, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.067 Vali Acc: 0.990 Test Loss: 0.067 Test Acc: 0.990
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 44 | loss: 0.0001774
	speed: 0.6584s/iter; left time: 15433.8094s
	iters: 200, epoch: 44 | loss: 0.0000000
	speed: 0.3264s/iter; left time: 7619.2413s
	iters: 300, epoch: 44 | loss: 0.0000000
	speed: 0.3189s/iter; left time: 7412.6688s
	iters: 400, epoch: 44 | loss: 0.0000001
	speed: 0.3224s/iter; left time: 7460.9852s
Epoch: 44 cost time: 134.51067399978638
Epoch: 44, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.986 Test Loss: 0.087 Test Acc: 0.986
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 45 | loss: 0.0000001
	speed: 0.6822s/iter; left time: 15710.1691s
	iters: 200, epoch: 45 | loss: 0.0000000
	speed: 0.3357s/iter; left time: 7696.2664s
	iters: 300, epoch: 45 | loss: 0.0000000
	speed: 0.3322s/iter; left time: 7583.0522s
	iters: 400, epoch: 45 | loss: 0.0000155
	speed: 0.3220s/iter; left time: 7319.1219s
Epoch: 45 cost time: 138.93864750862122
Epoch: 45, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.138 Vali Acc: 0.980 Test Loss: 0.138 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 46 | loss: 0.0000007
	speed: 0.6888s/iter; left time: 15577.2346s
	iters: 200, epoch: 46 | loss: 0.0000002
	speed: 0.3177s/iter; left time: 7153.5443s
	iters: 300, epoch: 46 | loss: 0.0107884
	speed: 0.3535s/iter; left time: 7924.2167s
	iters: 400, epoch: 46 | loss: 0.0000282
	speed: 0.3429s/iter; left time: 7652.3362s
Epoch: 46 cost time: 141.84606075286865
Epoch: 46, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.111 Vali Acc: 0.978 Test Loss: 0.111 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 47 | loss: 0.0000343
	speed: 0.6727s/iter; left time: 14935.9434s
	iters: 200, epoch: 47 | loss: 0.0000000
	speed: 0.3191s/iter; left time: 7053.7068s
	iters: 300, epoch: 47 | loss: 0.0002014
	speed: 0.3231s/iter; left time: 7110.2589s
	iters: 400, epoch: 47 | loss: 0.0000034
	speed: 0.3365s/iter; left time: 7371.3280s
Epoch: 47 cost time: 135.11137557029724
Epoch: 47, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 48 | loss: 0.0000009
	speed: 0.6788s/iter; left time: 14790.2990s
	iters: 200, epoch: 48 | loss: 0.0000546
	speed: 0.3464s/iter; left time: 7513.2063s
	iters: 300, epoch: 48 | loss: 0.0000000
	speed: 0.3611s/iter; left time: 7795.9964s
	iters: 400, epoch: 48 | loss: 0.0000000
	speed: 0.3298s/iter; left time: 7088.0792s
Epoch: 48 cost time: 143.89264035224915
Epoch: 48, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.072 Vali Acc: 0.986 Test Loss: 0.072 Test Acc: 0.986
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 49 | loss: 0.0000079
	speed: 0.6661s/iter; left time: 14239.5209s
	iters: 200, epoch: 49 | loss: 0.0000014
	speed: 0.3447s/iter; left time: 7334.9800s
	iters: 300, epoch: 49 | loss: 0.0132820
	speed: 0.3125s/iter; left time: 6617.2771s
	iters: 400, epoch: 49 | loss: 0.0000000
	speed: 0.3209s/iter; left time: 6763.9284s
Epoch: 49 cost time: 134.24321722984314
Epoch: 49, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.989 Test Loss: 0.066 Test Acc: 0.989
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9899954524783993
model parameter : 4160010
model size : 25.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8981595
	speed: 0.3418s/iter; left time: 14080.5244s
	iters: 200, epoch: 1 | loss: 0.2366785
	speed: 0.3163s/iter; left time: 13001.1252s
	iters: 300, epoch: 1 | loss: 0.1898897
	speed: 0.3264s/iter; left time: 13383.5708s
	iters: 400, epoch: 1 | loss: 0.3560647
	speed: 0.3009s/iter; left time: 12305.3764s
Epoch: 1 cost time: 132.62452673912048
Epoch: 1, Steps: 413 | Train Loss: 0.620 Vali Loss: 0.111 Vali Acc: 0.961 Test Loss: 0.111 Test Acc: 0.961
Validation loss decreased (inf --> -0.960890).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0230789
	speed: 0.6462s/iter; left time: 26356.9272s
	iters: 200, epoch: 2 | loss: 0.2143560
	speed: 0.3118s/iter; left time: 12684.8817s
	iters: 300, epoch: 2 | loss: 0.0923710
	speed: 0.3141s/iter; left time: 12746.7834s
	iters: 400, epoch: 2 | loss: 0.0339417
	speed: 0.3155s/iter; left time: 12775.2135s
Epoch: 2 cost time: 131.19868326187134
Epoch: 2, Steps: 413 | Train Loss: 0.126 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0145992
	speed: 0.6022s/iter; left time: 24314.5709s
	iters: 200, epoch: 3 | loss: 0.0248935
	speed: 0.3010s/iter; left time: 12121.6207s
	iters: 300, epoch: 3 | loss: 0.0012462
	speed: 0.3067s/iter; left time: 12322.7140s
	iters: 400, epoch: 3 | loss: 0.0082196
	speed: 0.2908s/iter; left time: 11654.1941s
Epoch: 3 cost time: 124.69390869140625
Epoch: 3, Steps: 413 | Train Loss: 0.156 Vali Loss: 0.141 Vali Acc: 0.964 Test Loss: 0.141 Test Acc: 0.964
Validation loss decreased (-0.960890 --> -0.963618).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0042965
	speed: 0.6292s/iter; left time: 25142.7458s
	iters: 200, epoch: 4 | loss: 0.0002900
	speed: 0.3126s/iter; left time: 12460.7724s
	iters: 300, epoch: 4 | loss: 0.0120878
	speed: 0.3098s/iter; left time: 12319.4705s
	iters: 400, epoch: 4 | loss: 0.1589337
	speed: 0.3122s/iter; left time: 12382.2740s
Epoch: 4 cost time: 129.41183304786682
Epoch: 4, Steps: 413 | Train Loss: 0.150 Vali Loss: 0.339 Vali Acc: 0.941 Test Loss: 0.339 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0474400
	speed: 0.5764s/iter; left time: 22795.9411s
	iters: 200, epoch: 5 | loss: 0.0001272
	speed: 0.3179s/iter; left time: 12541.5261s
	iters: 300, epoch: 5 | loss: 0.4826573
	speed: 0.3021s/iter; left time: 11885.7823s
	iters: 400, epoch: 5 | loss: 0.0036438
	speed: 0.3098s/iter; left time: 12158.8904s
Epoch: 5 cost time: 126.03364944458008
Epoch: 5, Steps: 413 | Train Loss: 0.154 Vali Loss: 0.363 Vali Acc: 0.940 Test Loss: 0.363 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0002267
	speed: 0.6265s/iter; left time: 24517.8424s
	iters: 200, epoch: 6 | loss: 0.2971705
	speed: 0.2995s/iter; left time: 11691.4169s
	iters: 300, epoch: 6 | loss: 0.0000235
	speed: 0.3081s/iter; left time: 11996.2790s
	iters: 400, epoch: 6 | loss: 0.0005494
	speed: 0.3209s/iter; left time: 12460.6332s
Epoch: 6 cost time: 128.95420169830322
Epoch: 6, Steps: 413 | Train Loss: 0.115 Vali Loss: 0.311 Vali Acc: 0.952 Test Loss: 0.311 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0003845
	speed: 0.6140s/iter; left time: 23776.0712s
	iters: 200, epoch: 7 | loss: 0.0075675
	speed: 0.3319s/iter; left time: 12819.6532s
	iters: 300, epoch: 7 | loss: 0.0000026
	speed: 0.3205s/iter; left time: 12347.3337s
	iters: 400, epoch: 7 | loss: 0.2070039
	speed: 0.3085s/iter; left time: 11855.2332s
Epoch: 7 cost time: 131.39050817489624
Epoch: 7, Steps: 413 | Train Loss: 0.119 Vali Loss: 0.202 Vali Acc: 0.961 Test Loss: 0.202 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0242669
	speed: 0.6052s/iter; left time: 23185.0130s
	iters: 200, epoch: 8 | loss: 0.0002035
	speed: 0.2978s/iter; left time: 11379.9320s
	iters: 300, epoch: 8 | loss: 0.0720053
	speed: 0.3034s/iter; left time: 11561.4953s
	iters: 400, epoch: 8 | loss: 0.8537818
	speed: 0.3261s/iter; left time: 12396.1200s
Epoch: 8 cost time: 128.0768563747406
Epoch: 8, Steps: 413 | Train Loss: 0.114 Vali Loss: 0.269 Vali Acc: 0.958 Test Loss: 0.269 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0008051
	speed: 0.6279s/iter; left time: 23796.9737s
	iters: 200, epoch: 9 | loss: 0.1566210
	speed: 0.3157s/iter; left time: 11931.8118s
	iters: 300, epoch: 9 | loss: 0.0684605
	speed: 0.3212s/iter; left time: 12106.8332s
	iters: 400, epoch: 9 | loss: 0.0000749
	speed: 0.2969s/iter; left time: 11163.6545s
Epoch: 9 cost time: 131.1657600402832
Epoch: 9, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.282 Vali Acc: 0.958 Test Loss: 0.282 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.5965s/iter; left time: 22360.5735s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.3050s/iter; left time: 11401.7060s
	iters: 300, epoch: 10 | loss: 0.0000030
	speed: 0.2961s/iter; left time: 11038.5531s
	iters: 400, epoch: 10 | loss: 0.0000018
	speed: 0.2864s/iter; left time: 10649.1064s
Epoch: 10 cost time: 121.34859347343445
Epoch: 10, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.161 Vali Acc: 0.977 Test Loss: 0.161 Test Acc: 0.977
Validation loss decreased (-0.963618 --> -0.977261).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000726
	speed: 0.5944s/iter; left time: 22035.9643s
	iters: 200, epoch: 11 | loss: 0.2060891
	speed: 0.3137s/iter; left time: 11596.2650s
	iters: 300, epoch: 11 | loss: 0.0000062
	speed: 0.2862s/iter; left time: 10553.9754s
	iters: 400, epoch: 11 | loss: 0.0000964
	speed: 0.3132s/iter; left time: 11515.4681s
Epoch: 11 cost time: 127.5876042842865
Epoch: 11, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.212 Vali Acc: 0.971 Test Loss: 0.212 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000642
	speed: 0.5808s/iter; left time: 21291.0607s
	iters: 200, epoch: 12 | loss: 0.0000944
	speed: 0.3135s/iter; left time: 11459.6887s
	iters: 300, epoch: 12 | loss: 0.0005045
	speed: 0.3116s/iter; left time: 11358.8059s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.2912s/iter; left time: 10587.6215s
Epoch: 12 cost time: 124.43664622306824
Epoch: 12, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.244 Vali Acc: 0.965 Test Loss: 0.244 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0003487
	speed: 0.5753s/iter; left time: 20850.7707s
	iters: 200, epoch: 13 | loss: 0.2789257
	speed: 0.3062s/iter; left time: 11067.4012s
	iters: 300, epoch: 13 | loss: 1.1707809
	speed: 0.2903s/iter; left time: 10464.2714s
	iters: 400, epoch: 13 | loss: 0.0000126
	speed: 0.2987s/iter; left time: 10736.5082s
Epoch: 13 cost time: 124.28653168678284
Epoch: 13, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.329 Vali Acc: 0.963 Test Loss: 0.329 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000050
	speed: 0.5777s/iter; left time: 20698.8887s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.2917s/iter; left time: 10423.1451s
	iters: 300, epoch: 14 | loss: 0.0000002
	speed: 0.2999s/iter; left time: 10684.5304s
	iters: 400, epoch: 14 | loss: 0.0000138
	speed: 0.2903s/iter; left time: 10314.1118s
Epoch: 14 cost time: 121.32009696960449
Epoch: 14, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.263 Vali Acc: 0.970 Test Loss: 0.263 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0143642
	speed: 0.5700s/iter; left time: 20189.7413s
	iters: 200, epoch: 15 | loss: 0.0000004
	speed: 0.3013s/iter; left time: 10640.5035s
	iters: 300, epoch: 15 | loss: 0.0003073
	speed: 0.2952s/iter; left time: 10397.2694s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.3192s/iter; left time: 11210.2246s
Epoch: 15 cost time: 125.9780523777008
Epoch: 15, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.206 Vali Acc: 0.973 Test Loss: 0.206 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.5939s/iter; left time: 20790.2319s
	iters: 200, epoch: 16 | loss: 0.0021013
	speed: 0.3105s/iter; left time: 10837.1395s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.2944s/iter; left time: 10247.6457s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.2976s/iter; left time: 10330.0793s
Epoch: 16 cost time: 124.87432742118835
Epoch: 16, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.214 Vali Acc: 0.972 Test Loss: 0.214 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0645925
	speed: 0.5767s/iter; left time: 19948.4467s
	iters: 200, epoch: 17 | loss: 0.0000854
	speed: 0.3006s/iter; left time: 10367.8774s
	iters: 300, epoch: 17 | loss: 0.0019238
	speed: 0.2894s/iter; left time: 9954.2202s
	iters: 400, epoch: 17 | loss: 0.2326502
	speed: 0.2934s/iter; left time: 10060.4927s
Epoch: 17 cost time: 120.27147030830383
Epoch: 17, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.230 Vali Acc: 0.972 Test Loss: 0.230 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0252757
	speed: 0.5836s/iter; left time: 19948.7645s
	iters: 200, epoch: 18 | loss: 0.0019016
	speed: 0.2985s/iter; left time: 10171.5785s
	iters: 300, epoch: 18 | loss: 0.2167086
	speed: 0.2963s/iter; left time: 10069.4574s
	iters: 400, epoch: 18 | loss: 0.0000630
	speed: 0.3034s/iter; left time: 10279.2439s
Epoch: 18 cost time: 123.62275266647339
Epoch: 18, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.255 Vali Acc: 0.962 Test Loss: 0.255 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.6048s/iter; left time: 20422.9138s
	iters: 200, epoch: 19 | loss: 0.0089239
	speed: 0.3093s/iter; left time: 10412.6548s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.3147s/iter; left time: 10564.3451s
	iters: 400, epoch: 19 | loss: 0.0477467
	speed: 0.2936s/iter; left time: 9827.0788s
Epoch: 19 cost time: 126.15504288673401
Epoch: 19, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.403 Vali Acc: 0.958 Test Loss: 0.403 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0041271
	speed: 0.6126s/iter; left time: 20433.0347s
	iters: 200, epoch: 20 | loss: 0.0000001
	speed: 0.2956s/iter; left time: 9828.7348s
	iters: 300, epoch: 20 | loss: 0.0000022
	speed: 0.3024s/iter; left time: 10026.2127s
	iters: 400, epoch: 20 | loss: 0.0019471
	speed: 0.2780s/iter; left time: 9187.8613s
Epoch: 20 cost time: 123.43629312515259
Epoch: 20, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.293 Vali Acc: 0.969 Test Loss: 0.293 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.977262391996362
model parameter : 4160010
model size : 25.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7838489
	speed: 0.3116s/iter; left time: 12839.2051s
	iters: 200, epoch: 1 | loss: 0.1600592
	speed: 0.2958s/iter; left time: 12158.3661s
	iters: 300, epoch: 1 | loss: 0.1674797
	speed: 0.3078s/iter; left time: 12621.6326s
	iters: 400, epoch: 1 | loss: 0.4016380
	speed: 0.2894s/iter; left time: 11837.3100s
Epoch: 1 cost time: 124.39000177383423
Epoch: 1, Steps: 413 | Train Loss: 0.610 Vali Loss: 0.059 Vali Acc: 0.979 Test Loss: 0.059 Test Acc: 0.979
Validation loss decreased (inf --> -0.978626).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0276986
	speed: 0.6094s/iter; left time: 24856.4578s
	iters: 200, epoch: 2 | loss: 0.0197540
	speed: 0.2844s/iter; left time: 11572.4503s
	iters: 300, epoch: 2 | loss: 0.0922907
	speed: 0.3017s/iter; left time: 12244.4063s
	iters: 400, epoch: 2 | loss: 0.0913125
	speed: 0.2860s/iter; left time: 11580.2852s
Epoch: 2 cost time: 122.75245308876038
Epoch: 2, Steps: 413 | Train Loss: 0.127 Vali Loss: 0.419 Vali Acc: 0.911 Test Loss: 0.419 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.2627798
	speed: 0.5830s/iter; left time: 23538.7616s
	iters: 200, epoch: 3 | loss: 0.0754204
	speed: 0.2776s/iter; left time: 11182.0962s
	iters: 300, epoch: 3 | loss: 0.0192114
	speed: 0.2840s/iter; left time: 11409.4848s
	iters: 400, epoch: 3 | loss: 0.0248521
	speed: 0.2907s/iter; left time: 11648.7089s
Epoch: 3 cost time: 119.0547788143158
Epoch: 3, Steps: 413 | Train Loss: 0.160 Vali Loss: 0.232 Vali Acc: 0.942 Test Loss: 0.232 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0013246
	speed: 0.5652s/iter; left time: 22588.2389s
	iters: 200, epoch: 4 | loss: 0.0143168
	speed: 0.2770s/iter; left time: 11040.9263s
	iters: 300, epoch: 4 | loss: 0.1289542
	speed: 0.2740s/iter; left time: 10894.0376s
	iters: 400, epoch: 4 | loss: 0.4116857
	speed: 0.2859s/iter; left time: 11340.9050s
Epoch: 4 cost time: 116.72679305076599
Epoch: 4, Steps: 413 | Train Loss: 0.143 Vali Loss: 0.184 Vali Acc: 0.964 Test Loss: 0.184 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0000332
	speed: 0.5405s/iter; left time: 21375.5034s
	iters: 200, epoch: 5 | loss: 0.0066051
	speed: 0.2820s/iter; left time: 11124.6141s
	iters: 300, epoch: 5 | loss: 0.0018203
	speed: 0.2746s/iter; left time: 10804.5328s
	iters: 400, epoch: 5 | loss: 0.0000389
	speed: 0.2864s/iter; left time: 11239.0797s
Epoch: 5 cost time: 116.73024296760559
Epoch: 5, Steps: 413 | Train Loss: 0.114 Vali Loss: 0.471 Vali Acc: 0.926 Test Loss: 0.471 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0005052
	speed: 0.5778s/iter; left time: 22613.2950s
	iters: 200, epoch: 6 | loss: 0.1869385
	speed: 0.3066s/iter; left time: 11966.5016s
	iters: 300, epoch: 6 | loss: 0.0006060
	speed: 0.2962s/iter; left time: 11533.7076s
	iters: 400, epoch: 6 | loss: 0.0030743
	speed: 0.2907s/iter; left time: 11288.9144s
Epoch: 6 cost time: 122.65433382987976
Epoch: 6, Steps: 413 | Train Loss: 0.139 Vali Loss: 0.220 Vali Acc: 0.961 Test Loss: 0.220 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0000119
	speed: 0.5860s/iter; left time: 22691.9635s
	iters: 200, epoch: 7 | loss: 0.0000599
	speed: 0.2913s/iter; left time: 11252.2045s
	iters: 300, epoch: 7 | loss: 0.0000571
	speed: 0.2989s/iter; left time: 11514.0483s
	iters: 400, epoch: 7 | loss: 0.6710508
	speed: 0.3008s/iter; left time: 11557.2231s
Epoch: 7 cost time: 122.63960266113281
Epoch: 7, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.189 Vali Acc: 0.966 Test Loss: 0.189 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.0243019
	speed: 0.5953s/iter; left time: 22807.7683s
	iters: 200, epoch: 8 | loss: 0.0356174
	speed: 0.2954s/iter; left time: 11286.9101s
	iters: 300, epoch: 8 | loss: 0.0000089
	speed: 0.2995s/iter; left time: 11415.2091s
	iters: 400, epoch: 8 | loss: 0.0000541
	speed: 0.2972s/iter; left time: 11296.8951s
Epoch: 8 cost time: 124.58703446388245
Epoch: 8, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.486 Vali Acc: 0.944 Test Loss: 0.486 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.0000207
	speed: 0.5984s/iter; left time: 22676.3274s
	iters: 200, epoch: 9 | loss: 0.0000001
	speed: 0.3093s/iter; left time: 11689.4253s
	iters: 300, epoch: 9 | loss: 0.0003916
	speed: 0.3051s/iter; left time: 11500.4029s
	iters: 400, epoch: 9 | loss: 0.9112200
	speed: 0.3228s/iter; left time: 12135.9560s
Epoch: 9 cost time: 127.40166664123535
Epoch: 9, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.0027394
	speed: 0.5499s/iter; left time: 20611.6115s
	iters: 200, epoch: 10 | loss: 0.0000380
	speed: 0.2749s/iter; left time: 10276.4534s
	iters: 300, epoch: 10 | loss: 0.0006854
	speed: 0.2830s/iter; left time: 10551.5879s
	iters: 400, epoch: 10 | loss: 0.0005380
	speed: 0.2594s/iter; left time: 9644.0017s
Epoch: 10 cost time: 114.57260489463806
Epoch: 10, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.256 Vali Acc: 0.960 Test Loss: 0.256 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.0002792
	speed: 0.5513s/iter; left time: 20438.3821s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.2932s/iter; left time: 10840.6454s
	iters: 300, epoch: 11 | loss: 0.0000011
	speed: 0.2833s/iter; left time: 10446.8971s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.2824s/iter; left time: 10384.8977s
Epoch: 11 cost time: 117.5026421546936
Epoch: 11, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.179 Vali Acc: 0.972 Test Loss: 0.179 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9786266484765803
model parameter : 4160010
model size : 25.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.3029130
	speed: 0.3172s/iter; left time: 13070.5986s
	iters: 200, epoch: 1 | loss: 2.3019049
	speed: 0.2859s/iter; left time: 11748.8467s
	iters: 300, epoch: 1 | loss: 2.3018882
	speed: 0.3008s/iter; left time: 12333.3428s
	iters: 400, epoch: 1 | loss: 2.3022094
	speed: 0.3005s/iter; left time: 12291.2877s
Epoch: 1 cost time: 124.7560977935791
Epoch: 1, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (inf --> -0.100022).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3024566
	speed: 0.5814s/iter; left time: 23713.9951s
	iters: 200, epoch: 2 | loss: 2.3011296
	speed: 0.2945s/iter; left time: 11982.7098s
	iters: 300, epoch: 2 | loss: 2.3033772
	speed: 0.2956s/iter; left time: 11997.3885s
	iters: 400, epoch: 2 | loss: 2.3027050
	speed: 0.3062s/iter; left time: 12397.7094s
Epoch: 2 cost time: 123.41086268424988
Epoch: 2, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.3025165
	speed: 0.5903s/iter; left time: 23832.5205s
	iters: 200, epoch: 3 | loss: 2.3025527
	speed: 0.2855s/iter; left time: 11497.4322s
	iters: 300, epoch: 3 | loss: 2.3047385
	speed: 0.3018s/iter; left time: 12122.8989s
	iters: 400, epoch: 3 | loss: 2.3019392
	speed: 0.3029s/iter; left time: 12137.7665s
Epoch: 3 cost time: 123.75673317909241
Epoch: 3, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3027020
	speed: 0.5858s/iter; left time: 23408.0668s
	iters: 200, epoch: 4 | loss: 2.3044267
	speed: 0.2949s/iter; left time: 11754.8968s
	iters: 300, epoch: 4 | loss: 2.3027720
	speed: 0.3035s/iter; left time: 12066.4276s
	iters: 400, epoch: 4 | loss: 2.3023510
	speed: 0.2944s/iter; left time: 11675.8338s
Epoch: 4 cost time: 122.20983982086182
Epoch: 4, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.3040488
	speed: 0.5720s/iter; left time: 22620.2291s
	iters: 200, epoch: 5 | loss: 2.3011355
	speed: 0.3033s/iter; left time: 11963.5863s
	iters: 300, epoch: 5 | loss: 2.3041484
	speed: 0.2945s/iter; left time: 11589.0354s
	iters: 400, epoch: 5 | loss: 2.3027387
	speed: 0.2798s/iter; left time: 10981.8403s
Epoch: 5 cost time: 121.09221029281616
Epoch: 5, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.3029130
	speed: 0.5880s/iter; left time: 23010.7499s
	iters: 200, epoch: 6 | loss: 2.3006661
	speed: 0.2980s/iter; left time: 11633.9174s
	iters: 300, epoch: 6 | loss: 2.3045101
	speed: 0.2873s/iter; left time: 11186.4654s
	iters: 400, epoch: 6 | loss: 2.3014712
	speed: 0.2816s/iter; left time: 10937.8467s
Epoch: 6 cost time: 120.88300323486328
Epoch: 6, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.3033149
	speed: 0.5753s/iter; left time: 22277.8060s
	iters: 200, epoch: 7 | loss: 2.3068478
	speed: 0.2782s/iter; left time: 10745.6467s
	iters: 300, epoch: 7 | loss: 2.3012464
	speed: 0.3005s/iter; left time: 11574.2893s
	iters: 400, epoch: 7 | loss: 2.3040936
	speed: 0.2969s/iter; left time: 11407.1688s
Epoch: 7 cost time: 120.49501872062683
Epoch: 7, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.3047736
	speed: 0.5725s/iter; left time: 21931.1192s
	iters: 200, epoch: 8 | loss: 2.3042841
	speed: 0.2880s/iter; left time: 11005.4670s
	iters: 300, epoch: 8 | loss: 2.3022079
	speed: 0.2963s/iter; left time: 11293.5649s
	iters: 400, epoch: 8 | loss: 2.3034675
	speed: 0.3012s/iter; left time: 11449.2623s
Epoch: 8 cost time: 123.11086702346802
Epoch: 8, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 2.3003178
	speed: 0.5967s/iter; left time: 22613.3702s
	iters: 200, epoch: 9 | loss: 2.3071373
	speed: 0.3130s/iter; left time: 11828.7322s
	iters: 300, epoch: 9 | loss: 2.3046055
	speed: 0.2975s/iter; left time: 11216.3006s
	iters: 400, epoch: 9 | loss: 2.3039134
	speed: 0.2940s/iter; left time: 11052.3910s
Epoch: 9 cost time: 125.88817977905273
Epoch: 9, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 2.3030241
	speed: 0.5798s/iter; left time: 21731.8207s
	iters: 200, epoch: 10 | loss: 2.3008368
	speed: 0.2941s/iter; left time: 10994.1326s
	iters: 300, epoch: 10 | loss: 2.3067198
	speed: 0.2957s/iter; left time: 11023.5145s
	iters: 400, epoch: 10 | loss: 2.3037457
	speed: 0.2773s/iter; left time: 10309.4449s
Epoch: 10 cost time: 119.16836333274841
Epoch: 10, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 2.3063967
	speed: 0.5833s/iter; left time: 21622.9955s
	iters: 200, epoch: 11 | loss: 2.3064902
	speed: 0.3132s/iter; left time: 11580.2881s
	iters: 300, epoch: 11 | loss: 2.3021290
	speed: 0.3084s/iter; left time: 11370.0882s
	iters: 400, epoch: 11 | loss: 2.3028498
	speed: 0.2970s/iter; left time: 10920.3464s
Epoch: 11 cost time: 125.91380548477173
Epoch: 11, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 2.3039718
	speed: 0.5578s/iter; left time: 20449.1554s
	iters: 200, epoch: 12 | loss: 2.3042476
	speed: 0.2928s/iter; left time: 10702.4245s
	iters: 300, epoch: 12 | loss: 2.3017290
	speed: 0.2790s/iter; left time: 10171.6550s
	iters: 400, epoch: 12 | loss: 2.3026900
	speed: 0.3044s/iter; left time: 11067.8698s
Epoch: 12 cost time: 121.15343189239502
Epoch: 12, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 2.3020153
	speed: 0.5821s/iter; left time: 21097.3498s
	iters: 200, epoch: 13 | loss: 2.3033514
	speed: 0.3154s/iter; left time: 11398.3850s
	iters: 300, epoch: 13 | loss: 2.3046968
	speed: 0.2965s/iter; left time: 10688.6710s
	iters: 400, epoch: 13 | loss: 2.3045063
	speed: 0.2993s/iter; left time: 10757.5833s
Epoch: 13 cost time: 124.95023036003113
Epoch: 13, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 2.3041606
	speed: 0.5658s/iter; left time: 20273.8647s
	iters: 200, epoch: 14 | loss: 2.3065407
	speed: 0.2767s/iter; left time: 9887.6035s
	iters: 300, epoch: 14 | loss: 2.3032918
	speed: 0.2960s/iter; left time: 10546.5833s
	iters: 400, epoch: 14 | loss: 2.3027444
	speed: 0.2839s/iter; left time: 10088.6386s
Epoch: 14 cost time: 117.22253632545471
Epoch: 14, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 2.3042998
	speed: 0.5354s/iter; left time: 18961.6215s
	iters: 200, epoch: 15 | loss: 2.3020189
	speed: 0.3131s/iter; left time: 11056.8941s
	iters: 300, epoch: 15 | loss: 2.3022671
	speed: 0.2854s/iter; left time: 10052.0727s
	iters: 400, epoch: 15 | loss: 2.3029199
	speed: 0.2971s/iter; left time: 10434.0606s
Epoch: 15 cost time: 121.53880572319031
Epoch: 15, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.10004547521600728
model parameter : 4160010
model size : 25.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         47                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df512_ma47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1250327
	speed: 0.3024s/iter; left time: 12457.8034s
	iters: 200, epoch: 1 | loss: 0.0222243
	speed: 0.2960s/iter; left time: 12165.0447s
	iters: 300, epoch: 1 | loss: 0.0554049
	speed: 0.2690s/iter; left time: 11028.3260s
	iters: 400, epoch: 1 | loss: 0.1594517
	speed: 0.2731s/iter; left time: 11170.3560s
Epoch: 1 cost time: 117.60253643989563
Epoch: 1, Steps: 413 | Train Loss: 0.349 Vali Loss: 0.187 Vali Acc: 0.946 Test Loss: 0.187 Test Acc: 0.946
Validation loss decreased (inf --> -0.945883).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0373123
	speed: 0.5417s/iter; left time: 22092.8478s
	iters: 200, epoch: 2 | loss: 0.0946333
	speed: 0.2718s/iter; left time: 11057.3284s
	iters: 300, epoch: 2 | loss: 0.0587124
	speed: 0.2914s/iter; left time: 11826.5933s
	iters: 400, epoch: 2 | loss: 0.0079766
	speed: 0.2918s/iter; left time: 11813.6103s
Epoch: 2 cost time: 116.06855034828186
Epoch: 2, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
Validation loss decreased (-0.945883 --> -0.973169).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0046169
	speed: 0.5628s/iter; left time: 22724.4164s
	iters: 200, epoch: 3 | loss: 0.0453448
	speed: 0.2939s/iter; left time: 11837.7358s
	iters: 300, epoch: 3 | loss: 0.1828603
	speed: 0.3036s/iter; left time: 12196.7071s
	iters: 400, epoch: 3 | loss: 0.4544717
	speed: 0.3087s/iter; left time: 12372.1152s
Epoch: 3 cost time: 126.32069849967957
Epoch: 3, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.244 Vali Acc: 0.948 Test Loss: 0.244 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0575903
	speed: 0.5559s/iter; left time: 22213.7677s
	iters: 200, epoch: 4 | loss: 0.0002526
	speed: 0.2833s/iter; left time: 11293.9686s
	iters: 300, epoch: 4 | loss: 0.0000136
	speed: 0.2795s/iter; left time: 11114.6958s
	iters: 400, epoch: 4 | loss: 0.0039404
	speed: 0.2783s/iter; left time: 11037.9960s
Epoch: 4 cost time: 115.4488615989685
Epoch: 4, Steps: 413 | Train Loss: 0.115 Vali Loss: 0.174 Vali Acc: 0.967 Test Loss: 0.174 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.5352710
	speed: 0.5615s/iter; left time: 22208.0290s
	iters: 200, epoch: 5 | loss: 0.0000931
	speed: 0.2805s/iter; left time: 11063.9636s
	iters: 300, epoch: 5 | loss: 0.1780660
	speed: 0.2817s/iter; left time: 11085.0876s
	iters: 400, epoch: 5 | loss: 0.0000061
	speed: 0.2990s/iter; left time: 11733.8612s
Epoch: 5 cost time: 120.18963146209717
Epoch: 5, Steps: 413 | Train Loss: 0.114 Vali Loss: 0.148 Vali Acc: 0.971 Test Loss: 0.148 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0002145
	speed: 0.5797s/iter; left time: 22686.9673s
	iters: 200, epoch: 6 | loss: 0.0114515
	speed: 0.3064s/iter; left time: 11961.1405s
	iters: 300, epoch: 6 | loss: 0.4653119
	speed: 0.2846s/iter; left time: 11080.8755s
	iters: 400, epoch: 6 | loss: 0.0000981
	speed: 0.2899s/iter; left time: 11257.0489s
Epoch: 6 cost time: 121.96792793273926
Epoch: 6, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.164 Vali Acc: 0.976 Test Loss: 0.164 Test Acc: 0.976
Validation loss decreased (-0.973169 --> -0.975896).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000208
	speed: 0.5573s/iter; left time: 21580.5076s
	iters: 200, epoch: 7 | loss: 0.2327903
	speed: 0.2708s/iter; left time: 10459.2574s
	iters: 300, epoch: 7 | loss: 0.0000008
	speed: 0.2849s/iter; left time: 10975.1501s
	iters: 400, epoch: 7 | loss: 0.8923733
	speed: 0.2772s/iter; left time: 10651.5942s
Epoch: 7 cost time: 115.06027221679688
Epoch: 7, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.319 Vali Acc: 0.956 Test Loss: 0.319 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.5814207
	speed: 0.5854s/iter; left time: 22428.3271s
	iters: 200, epoch: 8 | loss: 0.0000124
	speed: 0.3169s/iter; left time: 12109.0485s
	iters: 300, epoch: 8 | loss: 0.4026309
	speed: 0.2930s/iter; left time: 11164.6992s
	iters: 400, epoch: 8 | loss: 0.2227232
	speed: 0.2964s/iter; left time: 11264.5277s
Epoch: 8 cost time: 125.70682215690613
Epoch: 8, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.186 Vali Acc: 0.968 Test Loss: 0.186 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000172
	speed: 0.5533s/iter; left time: 20966.8703s
	iters: 200, epoch: 9 | loss: 0.0966912
	speed: 0.2824s/iter; left time: 10672.5660s
	iters: 300, epoch: 9 | loss: 0.0000001
	speed: 0.3073s/iter; left time: 11584.2832s
	iters: 400, epoch: 9 | loss: 0.0000040
	speed: 0.2843s/iter; left time: 10688.4806s
Epoch: 9 cost time: 118.29485511779785
Epoch: 9, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.199 Vali Acc: 0.974 Test Loss: 0.199 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000038
	speed: 0.5883s/iter; left time: 22052.6779s
	iters: 200, epoch: 10 | loss: 0.0001521
	speed: 0.2967s/iter; left time: 11091.7452s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.2913s/iter; left time: 10862.0169s
	iters: 400, epoch: 10 | loss: 0.0000423
	speed: 0.3020s/iter; left time: 11229.2057s
Epoch: 10 cost time: 124.53064489364624
Epoch: 10, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.242 Vali Acc: 0.975 Test Loss: 0.242 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.1941301
	speed: 0.5648s/iter; left time: 20936.1462s
	iters: 200, epoch: 11 | loss: 0.0350909
	speed: 0.2967s/iter; left time: 10970.3678s
	iters: 300, epoch: 11 | loss: 0.0003536
	speed: 0.2896s/iter; left time: 10679.5584s
	iters: 400, epoch: 11 | loss: 0.8065452
	speed: 0.2752s/iter; left time: 10118.2506s
Epoch: 11 cost time: 118.6208884716034
Epoch: 11, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.266 Vali Acc: 0.972 Test Loss: 0.266 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.5839s/iter; left time: 21402.7947s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.2851s/iter; left time: 10424.4445s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.2790s/iter; left time: 10173.0424s
	iters: 400, epoch: 12 | loss: 0.0000019
	speed: 0.2936s/iter; left time: 10673.2729s
Epoch: 12 cost time: 119.303542137146
Epoch: 12, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.144 Vali Acc: 0.981 Test Loss: 0.144 Test Acc: 0.981
Validation loss decreased (-0.975896 --> -0.981354).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000061
	speed: 0.5811s/iter; left time: 21062.4507s
	iters: 200, epoch: 13 | loss: 0.0084571
	speed: 0.2992s/iter; left time: 10815.5418s
	iters: 300, epoch: 13 | loss: 0.0001420
	speed: 0.2907s/iter; left time: 10479.4793s
	iters: 400, epoch: 13 | loss: 0.0000024
	speed: 0.2935s/iter; left time: 10549.6499s
Epoch: 13 cost time: 121.94135856628418
Epoch: 13, Steps: 413 | Train Loss: 0.120 Vali Loss: 0.264 Vali Acc: 0.971 Test Loss: 0.264 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0047923
	speed: 0.5504s/iter; left time: 19721.6009s
	iters: 200, epoch: 14 | loss: 0.0000001
	speed: 0.2945s/iter; left time: 10523.7267s
	iters: 300, epoch: 14 | loss: 0.0664516
	speed: 0.2746s/iter; left time: 9782.9620s
	iters: 400, epoch: 14 | loss: 0.0000003
	speed: 0.2871s/iter; left time: 10201.6054s
Epoch: 14 cost time: 118.26071453094482
Epoch: 14, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.120 Vali Acc: 0.982 Test Loss: 0.120 Test Acc: 0.982
Validation loss decreased (-0.981354 --> -0.982263).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000066
	speed: 0.5549s/iter; left time: 19655.3998s
	iters: 200, epoch: 15 | loss: 0.1099649
	speed: 0.3011s/iter; left time: 10632.9243s
	iters: 300, epoch: 15 | loss: 0.0000022
	speed: 0.2764s/iter; left time: 9736.2074s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.2981s/iter; left time: 10469.0953s
Epoch: 15 cost time: 119.51582145690918
Epoch: 15, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.214 Vali Acc: 0.980 Test Loss: 0.214 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0057106
	speed: 0.5514s/iter; left time: 19301.7004s
	iters: 200, epoch: 16 | loss: 0.0573339
	speed: 0.3004s/iter; left time: 10484.4316s
	iters: 300, epoch: 16 | loss: 0.0048706
	speed: 0.2874s/iter; left time: 10001.9170s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.2848s/iter; left time: 9884.9904s
Epoch: 16 cost time: 119.83181095123291
Epoch: 16, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.331 Vali Acc: 0.972 Test Loss: 0.331 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.3505254
	speed: 0.5556s/iter; left time: 19219.1404s
	iters: 200, epoch: 17 | loss: 0.0041309
	speed: 0.2953s/iter; left time: 10185.9885s
	iters: 300, epoch: 17 | loss: 0.0000115
	speed: 0.2799s/iter; left time: 9626.3816s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.2880s/iter; left time: 9875.5529s
Epoch: 17 cost time: 118.43178582191467
Epoch: 17, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.385 Vali Acc: 0.966 Test Loss: 0.385 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.5690s/iter; left time: 19448.1507s
	iters: 200, epoch: 18 | loss: 0.7050410
	speed: 0.2849s/iter; left time: 9707.7186s
	iters: 300, epoch: 18 | loss: 0.0000077
	speed: 0.2869s/iter; left time: 9749.2504s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.2828s/iter; left time: 9581.3163s
Epoch: 18 cost time: 117.24929332733154
Epoch: 18, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.334 Vali Acc: 0.969 Test Loss: 0.334 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.5485s/iter; left time: 18519.5434s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.2842s/iter; left time: 9568.9418s
	iters: 300, epoch: 19 | loss: 0.0000003
	speed: 0.3027s/iter; left time: 10162.2643s
	iters: 400, epoch: 19 | loss: 0.0000238
	speed: 0.2847s/iter; left time: 9526.9374s
Epoch: 19 cost time: 119.44099760055542
Epoch: 19, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.310 Vali Acc: 0.971 Test Loss: 0.310 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0050013
	speed: 0.5918s/iter; left time: 19738.1229s
	iters: 200, epoch: 20 | loss: 0.0476519
	speed: 0.2964s/iter; left time: 9855.6612s
	iters: 300, epoch: 20 | loss: 0.0000010
	speed: 0.2958s/iter; left time: 9807.5590s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.2688s/iter; left time: 8885.4138s
Epoch: 20 cost time: 119.24204850196838
Epoch: 20, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.130 Vali Acc: 0.986 Test Loss: 0.130 Test Acc: 0.986
Validation loss decreased (-0.982263 --> -0.986356).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.5593s/iter; left time: 18424.6291s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.2608s/iter; left time: 8565.7164s
	iters: 300, epoch: 21 | loss: 0.0000223
	speed: 0.2903s/iter; left time: 9503.1318s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.2849s/iter; left time: 9300.9907s
Epoch: 21 cost time: 116.7496235370636
Epoch: 21, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.275 Vali Acc: 0.974 Test Loss: 0.275 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.2017595
	speed: 0.5528s/iter; left time: 17980.2275s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.2957s/iter; left time: 9588.3633s
	iters: 300, epoch: 22 | loss: 0.0560393
	speed: 0.3025s/iter; left time: 9778.2086s
	iters: 400, epoch: 22 | loss: 0.0000360
	speed: 0.3071s/iter; left time: 9897.9849s
Epoch: 22 cost time: 123.57612895965576
Epoch: 22, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.247 Vali Acc: 0.973 Test Loss: 0.247 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.5623s/iter; left time: 18057.7294s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.2863s/iter; left time: 9166.6295s
	iters: 300, epoch: 23 | loss: 0.0018845
	speed: 0.3000s/iter; left time: 9573.5497s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.2738s/iter; left time: 8711.3174s
Epoch: 23 cost time: 118.37034344673157
Epoch: 23, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.630 Vali Acc: 0.964 Test Loss: 0.630 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0232113
	speed: 0.5664s/iter; left time: 17955.8890s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.3007s/iter; left time: 9503.9295s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.2886s/iter; left time: 9090.7407s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.3057s/iter; left time: 9598.3555s
Epoch: 24 cost time: 121.34452319145203
Epoch: 24, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.271 Vali Acc: 0.974 Test Loss: 0.271 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0001653
	speed: 0.5761s/iter; left time: 18025.1897s
	iters: 200, epoch: 25 | loss: 0.0000006
	speed: 0.2872s/iter; left time: 8958.6471s
	iters: 300, epoch: 25 | loss: 0.0000003
	speed: 0.2844s/iter; left time: 8840.3738s
	iters: 400, epoch: 25 | loss: 0.0002834
	speed: 0.2841s/iter; left time: 8804.1105s
Epoch: 25 cost time: 119.51563739776611
Epoch: 25, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.289 Vali Acc: 0.972 Test Loss: 0.289 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.5577s/iter; left time: 17218.5580s
	iters: 200, epoch: 26 | loss: 0.0000065
	speed: 0.2913s/iter; left time: 8966.0156s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.2974s/iter; left time: 9121.6725s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.2908s/iter; left time: 8890.2893s
Epoch: 26 cost time: 119.9946916103363
Epoch: 26, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.316 Vali Acc: 0.972 Test Loss: 0.316 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.4390814
	speed: 0.5633s/iter; left time: 17158.6060s
	iters: 200, epoch: 27 | loss: 0.0000006
	speed: 0.2972s/iter; left time: 9024.1190s
	iters: 300, epoch: 27 | loss: 0.0009833
	speed: 0.2901s/iter; left time: 8777.8823s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.2989s/iter; left time: 9016.1664s
Epoch: 27 cost time: 121.34579968452454
Epoch: 27, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.350 Vali Acc: 0.969 Test Loss: 0.350 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0003121
	speed: 0.5697s/iter; left time: 17117.9911s
	iters: 200, epoch: 28 | loss: 0.0000016
	speed: 0.2618s/iter; left time: 7840.3383s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.2770s/iter; left time: 8269.1244s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.2712s/iter; left time: 8068.8084s
Epoch: 28 cost time: 114.58244252204895
Epoch: 28, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.332 Vali Acc: 0.975 Test Loss: 0.332 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.5554s/iter; left time: 16460.0196s
	iters: 200, epoch: 29 | loss: 0.7296579
	speed: 0.2816s/iter; left time: 8318.7702s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.2917s/iter; left time: 8587.8996s
	iters: 400, epoch: 29 | loss: 0.0000007
	speed: 0.2960s/iter; left time: 8685.0367s
Epoch: 29 cost time: 119.93626689910889
Epoch: 29, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.240 Vali Acc: 0.974 Test Loss: 0.240 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.5686s/iter; left time: 16616.6106s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.2812s/iter; left time: 8191.1192s
	iters: 300, epoch: 30 | loss: 0.0000007
	speed: 0.2834s/iter; left time: 8224.3520s
	iters: 400, epoch: 30 | loss: 0.0000916
	speed: 0.2890s/iter; left time: 8358.0958s
Epoch: 30 cost time: 116.86322736740112
Epoch: 30, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.218 Vali Acc: 0.979 Test Loss: 0.218 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df512_ma47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9863574351978172
model parameter : 3373578
model size : 22.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         38                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df512_ma38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1510652
	speed: 0.3060s/iter; left time: 12606.2153s
	iters: 200, epoch: 1 | loss: 0.0236076
	speed: 0.2913s/iter; left time: 11974.6045s
	iters: 300, epoch: 1 | loss: 0.2450321
	speed: 0.3135s/iter; left time: 12855.2385s
	iters: 400, epoch: 1 | loss: 0.2597842
	speed: 0.2841s/iter; left time: 11621.1101s
Epoch: 1 cost time: 123.65907621383667
Epoch: 1, Steps: 413 | Train Loss: 0.371 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
Validation loss decreased (inf --> -0.962254).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0106664
	speed: 0.5994s/iter; left time: 24447.1488s
	iters: 200, epoch: 2 | loss: 0.0500162
	speed: 0.2787s/iter; left time: 11338.4551s
	iters: 300, epoch: 2 | loss: 0.0044186
	speed: 0.2756s/iter; left time: 11184.3975s
	iters: 400, epoch: 2 | loss: 0.0062659
	speed: 0.2756s/iter; left time: 11157.8629s
Epoch: 2 cost time: 116.88595032691956
Epoch: 2, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.152 Vali Acc: 0.960 Test Loss: 0.152 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0033617
	speed: 0.5596s/iter; left time: 22592.6980s
	iters: 200, epoch: 3 | loss: 0.0533983
	speed: 0.2961s/iter; left time: 11925.4011s
	iters: 300, epoch: 3 | loss: 0.2492898
	speed: 0.2830s/iter; left time: 11369.1924s
	iters: 400, epoch: 3 | loss: 0.3227986
	speed: 0.2861s/iter; left time: 11466.1856s
Epoch: 3 cost time: 119.32825517654419
Epoch: 3, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.304 Vali Acc: 0.942 Test Loss: 0.304 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.6228314
	speed: 0.5621s/iter; left time: 22462.1897s
	iters: 200, epoch: 4 | loss: 0.0017203
	speed: 0.2845s/iter; left time: 11342.0742s
	iters: 300, epoch: 4 | loss: 0.1362531
	speed: 0.2858s/iter; left time: 11364.7779s
	iters: 400, epoch: 4 | loss: 0.0000421
	speed: 0.2851s/iter; left time: 11307.3254s
Epoch: 4 cost time: 118.42332029342651
Epoch: 4, Steps: 413 | Train Loss: 0.119 Vali Loss: 0.227 Vali Acc: 0.958 Test Loss: 0.227 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0184541
	speed: 0.5656s/iter; left time: 22367.2051s
	iters: 200, epoch: 5 | loss: 0.0000466
	speed: 0.2978s/iter; left time: 11746.1451s
	iters: 300, epoch: 5 | loss: 0.0018095
	speed: 0.2945s/iter; left time: 11589.4552s
	iters: 400, epoch: 5 | loss: 0.0135960
	speed: 0.2782s/iter; left time: 10917.6138s
Epoch: 5 cost time: 120.19912123680115
Epoch: 5, Steps: 413 | Train Loss: 0.119 Vali Loss: 0.182 Vali Acc: 0.973 Test Loss: 0.182 Test Acc: 0.973
Validation loss decreased (-0.962254 --> -0.972713).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000157
	speed: 0.5691s/iter; left time: 22273.0297s
	iters: 200, epoch: 6 | loss: 0.9577528
	speed: 0.2841s/iter; left time: 11089.3473s
	iters: 300, epoch: 6 | loss: 0.0017133
	speed: 0.3088s/iter; left time: 12024.7571s
	iters: 400, epoch: 6 | loss: 1.0622876
	speed: 0.2983s/iter; left time: 11585.0265s
Epoch: 6 cost time: 121.73995995521545
Epoch: 6, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.192 Vali Acc: 0.974 Test Loss: 0.192 Test Acc: 0.974
Validation loss decreased (-0.972713 --> -0.973622).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0257986
	speed: 0.5693s/iter; left time: 22046.8793s
	iters: 200, epoch: 7 | loss: 0.0004460
	speed: 0.2815s/iter; left time: 10874.0281s
	iters: 300, epoch: 7 | loss: 0.4072562
	speed: 0.2755s/iter; left time: 10612.5740s
	iters: 400, epoch: 7 | loss: 0.6402734
	speed: 0.2615s/iter; left time: 10047.9059s
Epoch: 7 cost time: 113.4026792049408
Epoch: 7, Steps: 413 | Train Loss: 0.110 Vali Loss: 0.169 Vali Acc: 0.974 Test Loss: 0.169 Test Acc: 0.974
Validation loss decreased (-0.973622 --> -0.974077).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000020
	speed: 0.5426s/iter; left time: 20788.4494s
	iters: 200, epoch: 8 | loss: 0.0001634
	speed: 0.2776s/iter; left time: 10605.9313s
	iters: 300, epoch: 8 | loss: 0.0000718
	speed: 0.2920s/iter; left time: 11126.7854s
	iters: 400, epoch: 8 | loss: 0.0000453
	speed: 0.2897s/iter; left time: 11011.8378s
Epoch: 8 cost time: 117.00999307632446
Epoch: 8, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.235 Vali Acc: 0.972 Test Loss: 0.235 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.1805581
	speed: 0.5682s/iter; left time: 21531.3058s
	iters: 200, epoch: 9 | loss: 1.3035568
	speed: 0.2844s/iter; left time: 10748.4836s
	iters: 300, epoch: 9 | loss: 0.0015496
	speed: 0.2655s/iter; left time: 10006.9584s
	iters: 400, epoch: 9 | loss: 0.0852715
	speed: 0.2629s/iter; left time: 9884.3926s
Epoch: 9 cost time: 113.3585045337677
Epoch: 9, Steps: 413 | Train Loss: 0.124 Vali Loss: 0.172 Vali Acc: 0.978 Test Loss: 0.172 Test Acc: 0.978
Validation loss decreased (-0.974077 --> -0.977715).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000466
	speed: 0.5263s/iter; left time: 19729.6821s
	iters: 200, epoch: 10 | loss: 0.0001638
	speed: 0.2811s/iter; left time: 10508.1570s
	iters: 300, epoch: 10 | loss: 0.0383562
	speed: 0.2696s/iter; left time: 10052.3781s
	iters: 400, epoch: 10 | loss: 0.0000477
	speed: 0.2813s/iter; left time: 10458.5131s
Epoch: 10 cost time: 113.78067660331726
Epoch: 10, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.653 Vali Acc: 0.934 Test Loss: 0.653 Test Acc: 0.934
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000098
	speed: 0.5658s/iter; left time: 20976.5756s
	iters: 200, epoch: 11 | loss: 0.2228046
	speed: 0.2852s/iter; left time: 10544.6976s
	iters: 300, epoch: 11 | loss: 0.0000469
	speed: 0.2912s/iter; left time: 10735.3399s
	iters: 400, epoch: 11 | loss: 0.0010214
	speed: 0.2794s/iter; left time: 10272.7999s
Epoch: 11 cost time: 117.83239603042603
Epoch: 11, Steps: 413 | Train Loss: 0.109 Vali Loss: 0.203 Vali Acc: 0.971 Test Loss: 0.203 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0001319
	speed: 0.5434s/iter; left time: 19920.1722s
	iters: 200, epoch: 12 | loss: 0.0000002
	speed: 0.2680s/iter; left time: 9797.2221s
	iters: 300, epoch: 12 | loss: 0.0002653
	speed: 0.2777s/iter; left time: 10125.3850s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.2775s/iter; left time: 10088.2521s
Epoch: 12 cost time: 114.44106650352478
Epoch: 12, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.185 Vali Acc: 0.978 Test Loss: 0.185 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0011526
	speed: 0.5572s/iter; left time: 20196.7985s
	iters: 200, epoch: 13 | loss: 0.3111540
	speed: 0.2914s/iter; left time: 10530.8612s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.3021s/iter; left time: 10887.6462s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.2876s/iter; left time: 10339.1463s
Epoch: 13 cost time: 120.52844023704529
Epoch: 13, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.253 Vali Acc: 0.967 Test Loss: 0.253 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000097
	speed: 0.5873s/iter; left time: 21044.3539s
	iters: 200, epoch: 14 | loss: 0.0000008
	speed: 0.2794s/iter; left time: 9982.0907s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.2979s/iter; left time: 10613.2200s
	iters: 400, epoch: 14 | loss: 0.0000013
	speed: 0.2936s/iter; left time: 10432.5045s
Epoch: 14 cost time: 121.6914656162262
Epoch: 14, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.230 Vali Acc: 0.976 Test Loss: 0.230 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.2957106
	speed: 0.5381s/iter; left time: 19059.2928s
	iters: 200, epoch: 15 | loss: 0.0017007
	speed: 0.2749s/iter; left time: 9710.7992s
	iters: 300, epoch: 15 | loss: 0.0000042
	speed: 0.2896s/iter; left time: 10199.0076s
	iters: 400, epoch: 15 | loss: 0.0000043
	speed: 0.2907s/iter; left time: 10208.8078s
Epoch: 15 cost time: 116.94590663909912
Epoch: 15, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.295 Vali Acc: 0.969 Test Loss: 0.295 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0777196
	speed: 0.5302s/iter; left time: 18561.3937s
	iters: 200, epoch: 16 | loss: 0.0000010
	speed: 0.2598s/iter; left time: 9068.2142s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.2714s/iter; left time: 9445.8404s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.2829s/iter; left time: 9816.5949s
Epoch: 16 cost time: 112.34086060523987
Epoch: 16, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.248 Vali Acc: 0.973 Test Loss: 0.248 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0000002
	speed: 0.5088s/iter; left time: 17599.2780s
	iters: 200, epoch: 17 | loss: 0.0000002
	speed: 0.2887s/iter; left time: 9958.2425s
	iters: 300, epoch: 17 | loss: 0.0000009
	speed: 0.2739s/iter; left time: 9418.6997s
	iters: 400, epoch: 17 | loss: 0.0003881
	speed: 0.2580s/iter; left time: 8849.1483s
Epoch: 17 cost time: 112.0330798625946
Epoch: 17, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.253 Vali Acc: 0.969 Test Loss: 0.253 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0000257
	speed: 0.5358s/iter; left time: 18312.8746s
	iters: 200, epoch: 18 | loss: 0.0002078
	speed: 0.2601s/iter; left time: 8862.9107s
	iters: 300, epoch: 18 | loss: 0.0000171
	speed: 0.2843s/iter; left time: 9660.2164s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.2791s/iter; left time: 9454.2858s
Epoch: 18 cost time: 113.31444931030273
Epoch: 18, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.270 Vali Acc: 0.975 Test Loss: 0.270 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.5307s/iter; left time: 17921.3689s
	iters: 200, epoch: 19 | loss: 0.0000001
	speed: 0.2862s/iter; left time: 9636.7513s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.2554s/iter; left time: 8571.5619s
	iters: 400, epoch: 19 | loss: 0.0039436
	speed: 0.2561s/iter; left time: 8571.7141s
Epoch: 19 cost time: 111.43485426902771
Epoch: 19, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.508 Vali Acc: 0.964 Test Loss: 0.508 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df512_ma38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9777171441564347
model parameter : 3373578
model size : 22.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         28                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df512_ma28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.1922239
	speed: 0.2884s/iter; left time: 11880.8136s
	iters: 200, epoch: 1 | loss: 0.0457629
	speed: 0.2844s/iter; left time: 11691.1785s
	iters: 300, epoch: 1 | loss: 0.0385761
	speed: 0.2837s/iter; left time: 11630.3135s
	iters: 400, epoch: 1 | loss: 0.0828112
	speed: 0.2527s/iter; left time: 10337.3986s
Epoch: 1 cost time: 114.36727476119995
Epoch: 1, Steps: 413 | Train Loss: 0.413 Vali Loss: 0.132 Vali Acc: 0.960 Test Loss: 0.132 Test Acc: 0.960
Validation loss decreased (inf --> -0.959980).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0825208
	speed: 0.5394s/iter; left time: 21999.6423s
	iters: 200, epoch: 2 | loss: 0.2867043
	speed: 0.2675s/iter; left time: 10885.8558s
	iters: 300, epoch: 2 | loss: 0.0077466
	speed: 0.2553s/iter; left time: 10363.8237s
	iters: 400, epoch: 2 | loss: 0.0177402
	speed: 0.2923s/iter; left time: 11835.0300s
Epoch: 2 cost time: 115.15246653556824
Epoch: 2, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.148 Vali Acc: 0.965 Test Loss: 0.148 Test Acc: 0.965
Validation loss decreased (-0.959980 --> -0.964528).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0021764
	speed: 0.5409s/iter; left time: 21838.0191s
	iters: 200, epoch: 3 | loss: 0.3298218
	speed: 0.2964s/iter; left time: 11936.3292s
	iters: 300, epoch: 3 | loss: 0.1283580
	speed: 0.2770s/iter; left time: 11130.4100s
	iters: 400, epoch: 3 | loss: 0.1118230
	speed: 0.2635s/iter; left time: 10559.6604s
Epoch: 3 cost time: 114.63285422325134
Epoch: 3, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.102 Vali Acc: 0.972 Test Loss: 0.102 Test Acc: 0.972
Validation loss decreased (-0.964528 --> -0.971804).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0355960
	speed: 0.5471s/iter; left time: 21862.0102s
	iters: 200, epoch: 4 | loss: 0.0000476
	speed: 0.2614s/iter; left time: 10419.2651s
	iters: 300, epoch: 4 | loss: 0.0057376
	speed: 0.2741s/iter; left time: 10897.5914s
	iters: 400, epoch: 4 | loss: 0.0012072
	speed: 0.2861s/iter; left time: 11345.3225s
Epoch: 4 cost time: 114.17681622505188
Epoch: 4, Steps: 413 | Train Loss: 0.112 Vali Loss: 0.182 Vali Acc: 0.964 Test Loss: 0.182 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0278973
	speed: 0.5092s/iter; left time: 20137.0157s
	iters: 200, epoch: 5 | loss: 0.0779090
	speed: 0.2936s/iter; left time: 11582.3492s
	iters: 300, epoch: 5 | loss: 0.0004996
	speed: 0.2754s/iter; left time: 10837.9354s
	iters: 400, epoch: 5 | loss: 0.0000048
	speed: 0.2590s/iter; left time: 10167.3630s
Epoch: 5 cost time: 112.6708517074585
Epoch: 5, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
Validation loss decreased (-0.971804 --> -0.982718).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000019
	speed: 0.5614s/iter; left time: 21970.3895s
	iters: 200, epoch: 6 | loss: 0.0017297
	speed: 0.2737s/iter; left time: 10682.9422s
	iters: 300, epoch: 6 | loss: 0.2503301
	speed: 0.2796s/iter; left time: 10885.4034s
	iters: 400, epoch: 6 | loss: 0.0531922
	speed: 0.2810s/iter; left time: 10913.1780s
Epoch: 6 cost time: 115.27948498725891
Epoch: 6, Steps: 413 | Train Loss: 0.102 Vali Loss: 0.150 Vali Acc: 0.975 Test Loss: 0.150 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.2748283
	speed: 0.5089s/iter; left time: 19705.2718s
	iters: 200, epoch: 7 | loss: 0.0000615
	speed: 0.2917s/iter; left time: 11268.2432s
	iters: 300, epoch: 7 | loss: 0.0007733
	speed: 0.2568s/iter; left time: 9892.2561s
	iters: 400, epoch: 7 | loss: 0.0008079
	speed: 0.2603s/iter; left time: 10001.7534s
Epoch: 7 cost time: 111.80449533462524
Epoch: 7, Steps: 413 | Train Loss: 0.118 Vali Loss: 0.361 Vali Acc: 0.949 Test Loss: 0.361 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.4394365
	speed: 0.5493s/iter; left time: 21042.3479s
	iters: 200, epoch: 8 | loss: 0.0000003
	speed: 0.2540s/iter; left time: 9705.8446s
	iters: 300, epoch: 8 | loss: 0.0049773
	speed: 0.2830s/iter; left time: 10785.2700s
	iters: 400, epoch: 8 | loss: 0.3181818
	speed: 0.2786s/iter; left time: 10587.9266s
Epoch: 8 cost time: 112.76672530174255
Epoch: 8, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.170 Vali Acc: 0.970 Test Loss: 0.170 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.8455912
	speed: 0.5495s/iter; left time: 20826.1239s
	iters: 200, epoch: 9 | loss: 0.0548651
	speed: 0.3021s/iter; left time: 11419.7324s
	iters: 300, epoch: 9 | loss: 0.0000572
	speed: 0.2762s/iter; left time: 10412.7115s
	iters: 400, epoch: 9 | loss: 0.0000010
	speed: 0.2856s/iter; left time: 10736.7778s
Epoch: 9 cost time: 119.46416115760803
Epoch: 9, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.231 Vali Acc: 0.972 Test Loss: 0.231 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000313
	speed: 0.5571s/iter; left time: 20881.3090s
	iters: 200, epoch: 10 | loss: 0.0451995
	speed: 0.2816s/iter; left time: 10525.9083s
	iters: 300, epoch: 10 | loss: 0.0000045
	speed: 0.3060s/iter; left time: 11407.9087s
	iters: 400, epoch: 10 | loss: 0.0101328
	speed: 0.2732s/iter; left time: 10156.8722s
Epoch: 10 cost time: 118.18591213226318
Epoch: 10, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.279 Vali Acc: 0.959 Test Loss: 0.279 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0003815
	speed: 0.5502s/iter; left time: 20397.4537s
	iters: 200, epoch: 11 | loss: 0.0148313
	speed: 0.2900s/iter; left time: 10723.2450s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.2720s/iter; left time: 10027.0824s
	iters: 400, epoch: 11 | loss: 0.0000942
	speed: 0.2955s/iter; left time: 10866.4892s
Epoch: 11 cost time: 119.14163565635681
Epoch: 11, Steps: 413 | Train Loss: 0.110 Vali Loss: 0.267 Vali Acc: 0.962 Test Loss: 0.267 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.5288s/iter; left time: 19385.7024s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.2862s/iter; left time: 10461.5163s
	iters: 300, epoch: 12 | loss: 0.0121897
	speed: 0.2848s/iter; left time: 10384.0065s
	iters: 400, epoch: 12 | loss: 0.0000001
	speed: 0.2925s/iter; left time: 10633.7702s
Epoch: 12 cost time: 117.95874691009521
Epoch: 12, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.229 Vali Acc: 0.974 Test Loss: 0.229 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0000007
	speed: 0.5245s/iter; left time: 19010.0170s
	iters: 200, epoch: 13 | loss: 0.0050108
	speed: 0.2989s/iter; left time: 10803.0888s
	iters: 300, epoch: 13 | loss: 0.0019040
	speed: 0.2750s/iter; left time: 9911.9341s
	iters: 400, epoch: 13 | loss: 0.0215054
	speed: 0.2867s/iter; left time: 10304.5205s
Epoch: 13 cost time: 117.33231282234192
Epoch: 13, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.343 Vali Acc: 0.967 Test Loss: 0.343 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0002790
	speed: 0.5493s/iter; left time: 19682.4636s
	iters: 200, epoch: 14 | loss: 0.0883651
	speed: 0.2877s/iter; left time: 10280.0167s
	iters: 300, epoch: 14 | loss: 0.0598925
	speed: 0.2861s/iter; left time: 10195.2170s
	iters: 400, epoch: 14 | loss: 0.0000030
	speed: 0.2603s/iter; left time: 9250.3273s
Epoch: 14 cost time: 113.78338408470154
Epoch: 14, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.154 Vali Acc: 0.983 Test Loss: 0.154 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0046984
	speed: 0.5591s/iter; left time: 19803.9802s
	iters: 200, epoch: 15 | loss: 0.0006664
	speed: 0.2811s/iter; left time: 9928.9406s
	iters: 300, epoch: 15 | loss: 0.0000007
	speed: 0.2874s/iter; left time: 10121.9007s
	iters: 400, epoch: 15 | loss: 0.0000001
	speed: 0.2643s/iter; left time: 9281.2817s
Epoch: 15 cost time: 115.26471400260925
Epoch: 15, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.233 Vali Acc: 0.972 Test Loss: 0.233 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df512_ma28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9827194179172352
model parameter : 3373578
model size : 22.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df512_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3652082
	speed: 0.2862s/iter; left time: 11793.6552s
	iters: 200, epoch: 1 | loss: 0.0812391
	speed: 0.2957s/iter; left time: 12154.6971s
	iters: 300, epoch: 1 | loss: 0.0653890
	speed: 0.2798s/iter; left time: 11473.5629s
	iters: 400, epoch: 1 | loss: 0.5202534
	speed: 0.2799s/iter; left time: 11446.7392s
Epoch: 1 cost time: 118.41682195663452
Epoch: 1, Steps: 413 | Train Loss: 0.473 Vali Loss: 0.117 Vali Acc: 0.963 Test Loss: 0.117 Test Acc: 0.963
Validation loss decreased (inf --> -0.962709).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0049153
	speed: 0.5265s/iter; left time: 21476.4376s
	iters: 200, epoch: 2 | loss: 0.1454975
	speed: 0.2755s/iter; left time: 11211.2068s
	iters: 300, epoch: 2 | loss: 0.0955671
	speed: 0.2835s/iter; left time: 11506.5372s
	iters: 400, epoch: 2 | loss: 0.0725457
	speed: 0.2747s/iter; left time: 11122.3677s
Epoch: 2 cost time: 112.68626499176025
Epoch: 2, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.089 Vali Acc: 0.972 Test Loss: 0.089 Test Acc: 0.972
Validation loss decreased (-0.962709 --> -0.971804).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0024106
	speed: 0.5294s/iter; left time: 21373.1309s
	iters: 200, epoch: 3 | loss: 0.0136367
	speed: 0.2668s/iter; left time: 10746.9937s
	iters: 300, epoch: 3 | loss: 0.0047140
	speed: 0.2893s/iter; left time: 11622.1659s
	iters: 400, epoch: 3 | loss: 0.7438850
	speed: 0.2798s/iter; left time: 11213.3042s
Epoch: 3 cost time: 112.96275591850281
Epoch: 3, Steps: 413 | Train Loss: 0.108 Vali Loss: 0.185 Vali Acc: 0.949 Test Loss: 0.185 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0962922
	speed: 0.5613s/iter; left time: 22429.6569s
	iters: 200, epoch: 4 | loss: 0.0208776
	speed: 0.2649s/iter; left time: 10559.7445s
	iters: 300, epoch: 4 | loss: 0.0015197
	speed: 0.2964s/iter; left time: 11786.1800s
	iters: 400, epoch: 4 | loss: 0.5817386
	speed: 0.2695s/iter; left time: 10686.9983s
Epoch: 4 cost time: 116.7964870929718
Epoch: 4, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.148 Vali Acc: 0.972 Test Loss: 0.148 Test Acc: 0.972
Validation loss decreased (-0.971804 --> -0.972259).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2008258
	speed: 0.5423s/iter; left time: 21446.8178s
	iters: 200, epoch: 5 | loss: 0.0000637
	speed: 0.2608s/iter; left time: 10286.5766s
	iters: 300, epoch: 5 | loss: 0.2684789
	speed: 0.2909s/iter; left time: 11448.3642s
	iters: 400, epoch: 5 | loss: 0.0015447
	speed: 0.2670s/iter; left time: 10478.3416s
Epoch: 5 cost time: 113.76076006889343
Epoch: 5, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.239 Vali Acc: 0.955 Test Loss: 0.239 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0107326
	speed: 0.5641s/iter; left time: 22076.6609s
	iters: 200, epoch: 6 | loss: 0.0034241
	speed: 0.2836s/iter; left time: 11072.5592s
	iters: 300, epoch: 6 | loss: 0.0123923
	speed: 0.2920s/iter; left time: 11368.8638s
	iters: 400, epoch: 6 | loss: 0.0168319
	speed: 0.2858s/iter; left time: 11097.4855s
Epoch: 6 cost time: 120.76835632324219
Epoch: 6, Steps: 413 | Train Loss: 0.110 Vali Loss: 0.370 Vali Acc: 0.950 Test Loss: 0.370 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0079946
	speed: 0.5502s/iter; left time: 21306.3884s
	iters: 200, epoch: 7 | loss: 0.1417734
	speed: 0.2815s/iter; left time: 10874.1430s
	iters: 300, epoch: 7 | loss: 0.3321509
	speed: 0.2614s/iter; left time: 10069.9215s
	iters: 400, epoch: 7 | loss: 0.2115328
	speed: 0.2643s/iter; left time: 10154.8994s
Epoch: 7 cost time: 114.66798233985901
Epoch: 7, Steps: 413 | Train Loss: 0.140 Vali Loss: 0.148 Vali Acc: 0.978 Test Loss: 0.148 Test Acc: 0.978
Validation loss decreased (-0.972259 --> -0.977716).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1770313
	speed: 0.5187s/iter; left time: 19871.7759s
	iters: 200, epoch: 8 | loss: 0.1362098
	speed: 0.2627s/iter; left time: 10039.5915s
	iters: 300, epoch: 8 | loss: 0.0274286
	speed: 0.2590s/iter; left time: 9871.4422s
	iters: 400, epoch: 8 | loss: 0.0265870
	speed: 0.2748s/iter; left time: 10445.2585s
Epoch: 8 cost time: 109.61101984977722
Epoch: 8, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.187 Vali Acc: 0.975 Test Loss: 0.187 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.5863885
	speed: 0.5397s/iter; left time: 20453.6495s
	iters: 200, epoch: 9 | loss: 0.6539565
	speed: 0.2601s/iter; left time: 9832.1960s
	iters: 300, epoch: 9 | loss: 0.0190099
	speed: 0.2878s/iter; left time: 10851.0374s
	iters: 400, epoch: 9 | loss: 0.0290665
	speed: 0.2670s/iter; left time: 10037.7350s
Epoch: 9 cost time: 114.26309490203857
Epoch: 9, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.239 Vali Acc: 0.970 Test Loss: 0.239 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0001102
	speed: 0.5446s/iter; left time: 20412.4825s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.2774s/iter; left time: 10370.3773s
	iters: 300, epoch: 10 | loss: 0.0000040
	speed: 0.2557s/iter; left time: 9532.0378s
	iters: 400, epoch: 10 | loss: 0.0000131
	speed: 0.2754s/iter; left time: 10240.1901s
Epoch: 10 cost time: 112.16566777229309
Epoch: 10, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.259 Vali Acc: 0.971 Test Loss: 0.259 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.3141608
	speed: 0.5309s/iter; left time: 19679.1428s
	iters: 200, epoch: 11 | loss: 0.0000009
	speed: 0.2732s/iter; left time: 10102.3133s
	iters: 300, epoch: 11 | loss: 0.0024038
	speed: 0.2659s/iter; left time: 9803.7127s
	iters: 400, epoch: 11 | loss: 0.0011806
	speed: 0.2767s/iter; left time: 10175.2936s
Epoch: 11 cost time: 112.71853733062744
Epoch: 11, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.254 Vali Acc: 0.974 Test Loss: 0.254 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.5517s/iter; left time: 20224.1708s
	iters: 200, epoch: 12 | loss: 0.0004158
	speed: 0.2721s/iter; left time: 9948.1778s
	iters: 300, epoch: 12 | loss: 0.1556471
	speed: 0.2825s/iter; left time: 10299.2347s
	iters: 400, epoch: 12 | loss: 0.2091995
	speed: 0.2760s/iter; left time: 10036.5996s
Epoch: 12 cost time: 115.82200598716736
Epoch: 12, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.336 Vali Acc: 0.960 Test Loss: 0.336 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000105
	speed: 0.5319s/iter; left time: 19278.0766s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.2757s/iter; left time: 9964.1218s
	iters: 300, epoch: 13 | loss: 0.0024603
	speed: 0.2547s/iter; left time: 9182.1195s
	iters: 400, epoch: 13 | loss: 0.0000035
	speed: 0.2621s/iter; left time: 9422.0537s
Epoch: 13 cost time: 109.42362141609192
Epoch: 13, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.235 Vali Acc: 0.969 Test Loss: 0.235 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0000465
	speed: 0.5126s/iter; left time: 18365.8493s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.2730s/iter; left time: 9754.9774s
	iters: 300, epoch: 14 | loss: 0.0000998
	speed: 0.2751s/iter; left time: 9802.5119s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.2801s/iter; left time: 9953.6915s
Epoch: 14 cost time: 113.28919410705566
Epoch: 14, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.269 Vali Acc: 0.960 Test Loss: 0.269 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0005596
	speed: 0.5501s/iter; left time: 19483.1593s
	iters: 200, epoch: 15 | loss: 0.0000322
	speed: 0.2670s/iter; left time: 9431.8933s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.2818s/iter; left time: 9926.2365s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.2741s/iter; left time: 9627.1910s
Epoch: 15 cost time: 114.68406867980957
Epoch: 15, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.162 Vali Acc: 0.983 Test Loss: 0.162 Test Acc: 0.983
Validation loss decreased (-0.977716 --> -0.983173).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0732573
	speed: 0.5521s/iter; left time: 19326.4186s
	iters: 200, epoch: 16 | loss: 0.0000005
	speed: 0.2714s/iter; left time: 9472.6682s
	iters: 300, epoch: 16 | loss: 0.0000168
	speed: 0.2689s/iter; left time: 9358.5735s
	iters: 400, epoch: 16 | loss: 0.0001289
	speed: 0.2669s/iter; left time: 9263.0572s
Epoch: 16 cost time: 112.34716558456421
Epoch: 16, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.241 Vali Acc: 0.979 Test Loss: 0.241 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0002898
	speed: 0.5389s/iter; left time: 18642.4548s
	iters: 200, epoch: 17 | loss: 0.0002215
	speed: 0.2890s/iter; left time: 9968.9071s
	iters: 300, epoch: 17 | loss: 0.6554524
	speed: 0.2711s/iter; left time: 9324.8247s
	iters: 400, epoch: 17 | loss: 0.0000026
	speed: 0.2863s/iter; left time: 9817.0788s
Epoch: 17 cost time: 116.08698081970215
Epoch: 17, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.274 Vali Acc: 0.972 Test Loss: 0.274 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000001
	speed: 0.5405s/iter; left time: 18475.4785s
	iters: 200, epoch: 18 | loss: 0.3396184
	speed: 0.2671s/iter; left time: 9103.0505s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.2609s/iter; left time: 8864.9896s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.2667s/iter; left time: 9036.2325s
Epoch: 18 cost time: 111.56438207626343
Epoch: 18, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.290 Vali Acc: 0.972 Test Loss: 0.290 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.5277s/iter; left time: 17817.8335s
	iters: 200, epoch: 19 | loss: 0.0101059
	speed: 0.2566s/iter; left time: 8638.8199s
	iters: 300, epoch: 19 | loss: 0.0001205
	speed: 0.2790s/iter; left time: 9366.4288s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.2733s/iter; left time: 9145.4477s
Epoch: 19 cost time: 112.47733664512634
Epoch: 19, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.308 Vali Acc: 0.970 Test Loss: 0.308 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000074
	speed: 0.5670s/iter; left time: 18911.2087s
	iters: 200, epoch: 20 | loss: 0.0662908
	speed: 0.2862s/iter; left time: 9517.2144s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.2822s/iter; left time: 9354.4307s
	iters: 400, epoch: 20 | loss: 0.0000628
	speed: 0.2654s/iter; left time: 8772.5239s
Epoch: 20 cost time: 115.88836622238159
Epoch: 20, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.229 Vali Acc: 0.975 Test Loss: 0.229 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0000001
	speed: 0.5431s/iter; left time: 17890.2672s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.2697s/iter; left time: 8857.2974s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.2753s/iter; left time: 9014.8688s
	iters: 400, epoch: 21 | loss: 0.0000023
	speed: 0.2812s/iter; left time: 9179.9047s
Epoch: 21 cost time: 114.50352144241333
Epoch: 21, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.279 Vali Acc: 0.975 Test Loss: 0.279 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0009418
	speed: 0.5467s/iter; left time: 17783.8901s
	iters: 200, epoch: 22 | loss: 0.0007703
	speed: 0.2774s/iter; left time: 8995.3003s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.2843s/iter; left time: 9190.3662s
	iters: 400, epoch: 22 | loss: 0.0000005
	speed: 0.2869s/iter; left time: 9245.4626s
Epoch: 22 cost time: 117.10196137428284
Epoch: 22, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.277 Vali Acc: 0.980 Test Loss: 0.277 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.5448s/iter; left time: 17496.3095s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.2704s/iter; left time: 8657.5455s
	iters: 300, epoch: 23 | loss: 0.8100567
	speed: 0.2821s/iter; left time: 9003.8003s
	iters: 400, epoch: 23 | loss: 0.0000001
	speed: 0.2823s/iter; left time: 8982.1738s
Epoch: 23 cost time: 115.88818144798279
Epoch: 23, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.159 Vali Acc: 0.978 Test Loss: 0.159 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.5600s/iter; left time: 17753.2924s
	iters: 200, epoch: 24 | loss: 0.1806744
	speed: 0.2821s/iter; left time: 8916.2479s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.2747s/iter; left time: 8654.8906s
	iters: 400, epoch: 24 | loss: 0.0000002
	speed: 0.2761s/iter; left time: 8669.6457s
Epoch: 24 cost time: 116.57095766067505
Epoch: 24, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.256 Vali Acc: 0.970 Test Loss: 0.256 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.5704s/iter; left time: 17847.5412s
	iters: 200, epoch: 25 | loss: 0.0335252
	speed: 0.2996s/iter; left time: 9343.1185s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.3036s/iter; left time: 9439.4382s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.2984s/iter; left time: 9246.7428s
Epoch: 25 cost time: 124.38497519493103
Epoch: 25, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.392 Vali Acc: 0.968 Test Loss: 0.392 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df512_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9831741700773079
model parameter : 3373578
model size : 22.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df512_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5420707
	speed: 0.3017s/iter; left time: 12431.9315s
	iters: 200, epoch: 1 | loss: 0.1478194
	speed: 0.2769s/iter; left time: 11381.4019s
	iters: 300, epoch: 1 | loss: 0.1097831
	speed: 0.2934s/iter; left time: 12029.3376s
	iters: 400, epoch: 1 | loss: 0.1963617
	speed: 0.2822s/iter; left time: 11541.8298s
Epoch: 1 cost time: 119.67876362800598
Epoch: 1, Steps: 413 | Train Loss: 0.586 Vali Loss: 0.155 Vali Acc: 0.952 Test Loss: 0.155 Test Acc: 0.952
Validation loss decreased (inf --> -0.951795).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1187475
	speed: 0.5575s/iter; left time: 22738.2304s
	iters: 200, epoch: 2 | loss: 0.5581684
	speed: 0.2895s/iter; left time: 11778.8511s
	iters: 300, epoch: 2 | loss: 0.0435215
	speed: 0.2850s/iter; left time: 11569.1382s
	iters: 400, epoch: 2 | loss: 0.0315315
	speed: 0.2848s/iter; left time: 11530.3494s
Epoch: 2 cost time: 119.44794011116028
Epoch: 2, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.951795 --> -0.972714).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0006032
	speed: 0.5570s/iter; left time: 22489.6796s
	iters: 200, epoch: 3 | loss: 0.0263707
	speed: 0.2860s/iter; left time: 11517.5278s
	iters: 300, epoch: 3 | loss: 0.6462575
	speed: 0.2719s/iter; left time: 10924.1958s
	iters: 400, epoch: 3 | loss: 0.0182812
	speed: 0.2935s/iter; left time: 11761.5814s
Epoch: 3 cost time: 118.06512141227722
Epoch: 3, Steps: 413 | Train Loss: 0.115 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1302557
	speed: 0.5419s/iter; left time: 21656.5825s
	iters: 200, epoch: 4 | loss: 0.0011791
	speed: 0.2992s/iter; left time: 11925.6183s
	iters: 300, epoch: 4 | loss: 0.1134191
	speed: 0.2796s/iter; left time: 11116.8933s
	iters: 400, epoch: 4 | loss: 0.0002023
	speed: 0.2958s/iter; left time: 11733.5851s
Epoch: 4 cost time: 120.44565844535828
Epoch: 4, Steps: 413 | Train Loss: 0.141 Vali Loss: 0.164 Vali Acc: 0.962 Test Loss: 0.164 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0445693
	speed: 0.5704s/iter; left time: 22558.4941s
	iters: 200, epoch: 5 | loss: 0.0111263
	speed: 0.2716s/iter; left time: 10714.2361s
	iters: 300, epoch: 5 | loss: 0.0283301
	speed: 0.2716s/iter; left time: 10685.2752s
	iters: 400, epoch: 5 | loss: 0.0000020
	speed: 0.2808s/iter; left time: 11021.4608s
Epoch: 5 cost time: 114.83161783218384
Epoch: 5, Steps: 413 | Train Loss: 0.120 Vali Loss: 0.211 Vali Acc: 0.961 Test Loss: 0.211 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0284247
	speed: 0.5067s/iter; left time: 19829.2743s
	iters: 200, epoch: 6 | loss: 0.2832546
	speed: 0.2793s/iter; left time: 10902.1418s
	iters: 300, epoch: 6 | loss: 0.0000612
	speed: 0.2778s/iter; left time: 10818.3591s
	iters: 400, epoch: 6 | loss: 0.0001770
	speed: 0.2686s/iter; left time: 10431.0984s
Epoch: 6 cost time: 113.03353190422058
Epoch: 6, Steps: 413 | Train Loss: 0.133 Vali Loss: 0.174 Vali Acc: 0.969 Test Loss: 0.174 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.4487976
	speed: 0.5423s/iter; left time: 20999.1036s
	iters: 200, epoch: 7 | loss: 0.0000378
	speed: 0.2767s/iter; left time: 10685.3734s
	iters: 300, epoch: 7 | loss: 0.0025966
	speed: 0.2795s/iter; left time: 10768.6238s
	iters: 400, epoch: 7 | loss: 0.0054469
	speed: 0.2766s/iter; left time: 10626.9947s
Epoch: 7 cost time: 114.75638484954834
Epoch: 7, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.175 Vali Acc: 0.972 Test Loss: 0.175 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0000030
	speed: 0.5518s/iter; left time: 21139.2624s
	iters: 200, epoch: 8 | loss: 0.0000015
	speed: 0.2835s/iter; left time: 10831.0040s
	iters: 300, epoch: 8 | loss: 0.0988288
	speed: 0.2745s/iter; left time: 10459.8067s
	iters: 400, epoch: 8 | loss: 0.0014048
	speed: 0.2696s/iter; left time: 10248.6830s
Epoch: 8 cost time: 115.19442892074585
Epoch: 8, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.162 Vali Acc: 0.976 Test Loss: 0.162 Test Acc: 0.976
Validation loss decreased (-0.972714 --> -0.976351).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.1209699
	speed: 0.5527s/iter; left time: 20943.7892s
	iters: 200, epoch: 9 | loss: 0.1404595
	speed: 0.2945s/iter; left time: 11130.7788s
	iters: 300, epoch: 9 | loss: 0.0000044
	speed: 0.2992s/iter; left time: 11278.5434s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.2753s/iter; left time: 10350.5805s
Epoch: 9 cost time: 118.3090124130249
Epoch: 9, Steps: 413 | Train Loss: 0.103 Vali Loss: 0.206 Vali Acc: 0.972 Test Loss: 0.206 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000001
	speed: 0.5730s/iter; left time: 21479.7378s
	iters: 200, epoch: 10 | loss: 0.0001217
	speed: 0.2920s/iter; left time: 10916.9152s
	iters: 300, epoch: 10 | loss: 0.2945027
	speed: 0.2867s/iter; left time: 10689.0798s
	iters: 400, epoch: 10 | loss: 0.2909345
	speed: 0.3076s/iter; left time: 11438.6348s
Epoch: 10 cost time: 122.47040247917175
Epoch: 10, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.206 Vali Acc: 0.974 Test Loss: 0.206 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.6183679
	speed: 0.5526s/iter; left time: 20486.3291s
	iters: 200, epoch: 11 | loss: 0.0000029
	speed: 0.2931s/iter; left time: 10836.6048s
	iters: 300, epoch: 11 | loss: 0.0012271
	speed: 0.2778s/iter; left time: 10243.9895s
	iters: 400, epoch: 11 | loss: 0.1967238
	speed: 0.2832s/iter; left time: 10413.4082s
Epoch: 11 cost time: 118.5957305431366
Epoch: 11, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.145 Vali Acc: 0.976 Test Loss: 0.145 Test Acc: 0.976
Validation loss decreased (-0.976351 --> -0.976351).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000003
	speed: 0.5755s/iter; left time: 21096.0645s
	iters: 200, epoch: 12 | loss: 0.0000195
	speed: 0.2701s/iter; left time: 9875.3331s
	iters: 300, epoch: 12 | loss: 0.0000048
	speed: 0.2860s/iter; left time: 10427.0414s
	iters: 400, epoch: 12 | loss: 0.0012129
	speed: 0.2728s/iter; left time: 9917.0370s
Epoch: 12 cost time: 116.55319356918335
Epoch: 12, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.219 Vali Acc: 0.966 Test Loss: 0.219 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0806204
	speed: 0.5563s/iter; left time: 20162.6522s
	iters: 200, epoch: 13 | loss: 0.0001600
	speed: 0.2968s/iter; left time: 10729.4660s
	iters: 300, epoch: 13 | loss: 0.0000260
	speed: 0.2775s/iter; left time: 10001.6842s
	iters: 400, epoch: 13 | loss: 0.0007496
	speed: 0.2859s/iter; left time: 10276.8376s
Epoch: 13 cost time: 119.12864518165588
Epoch: 13, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.245 Vali Acc: 0.963 Test Loss: 0.245 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000001
	speed: 0.5461s/iter; left time: 19568.4671s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.2950s/iter; left time: 10539.6341s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.2912s/iter; left time: 10376.8270s
	iters: 400, epoch: 14 | loss: 0.0000010
	speed: 0.2949s/iter; left time: 10479.3052s
Epoch: 14 cost time: 119.94263410568237
Epoch: 14, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.178 Vali Acc: 0.977 Test Loss: 0.178 Test Acc: 0.977
Validation loss decreased (-0.976351 --> -0.977261).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000010
	speed: 0.5947s/iter; left time: 21062.6478s
	iters: 200, epoch: 15 | loss: 0.0038312
	speed: 0.2896s/iter; left time: 10230.0106s
	iters: 300, epoch: 15 | loss: 0.0000376
	speed: 0.2974s/iter; left time: 10474.6338s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.2866s/iter; left time: 10065.5916s
Epoch: 15 cost time: 121.4448070526123
Epoch: 15, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.179 Vali Acc: 0.976 Test Loss: 0.179 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.5393s/iter; left time: 18878.5668s
	iters: 200, epoch: 16 | loss: 0.0000437
	speed: 0.3191s/iter; left time: 11137.0759s
	iters: 300, epoch: 16 | loss: 0.0000152
	speed: 0.2848s/iter; left time: 9914.4589s
	iters: 400, epoch: 16 | loss: 0.0000480
	speed: 0.2832s/iter; left time: 9828.4558s
Epoch: 16 cost time: 121.70902562141418
Epoch: 16, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.210 Vali Acc: 0.972 Test Loss: 0.210 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0083996
	speed: 0.5781s/iter; left time: 19997.0022s
	iters: 200, epoch: 17 | loss: 0.5644274
	speed: 0.2877s/iter; left time: 9924.2854s
	iters: 300, epoch: 17 | loss: 0.0012443
	speed: 0.3000s/iter; left time: 10319.5183s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.3010s/iter; left time: 10322.0601s
Epoch: 17 cost time: 121.308340549469
Epoch: 17, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.216 Vali Acc: 0.976 Test Loss: 0.216 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000016
	speed: 0.5397s/iter; left time: 18446.7790s
	iters: 200, epoch: 18 | loss: 0.0011549
	speed: 0.2845s/iter; left time: 9696.5213s
	iters: 300, epoch: 18 | loss: 0.0217075
	speed: 0.2693s/iter; left time: 9150.4482s
	iters: 400, epoch: 18 | loss: 0.0000181
	speed: 0.2882s/iter; left time: 9763.2125s
Epoch: 18 cost time: 116.74479460716248
Epoch: 18, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.117 Vali Acc: 0.981 Test Loss: 0.117 Test Acc: 0.981
Validation loss decreased (-0.977261 --> -0.980899).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.5463s/iter; left time: 18446.0192s
	iters: 200, epoch: 19 | loss: 0.0000103
	speed: 0.2820s/iter; left time: 9494.0403s
	iters: 300, epoch: 19 | loss: 0.0007362
	speed: 0.2942s/iter; left time: 9876.0441s
	iters: 400, epoch: 19 | loss: 0.0000002
	speed: 0.2719s/iter; left time: 9098.0499s
Epoch: 19 cost time: 116.70089387893677
Epoch: 19, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.150 Vali Acc: 0.980 Test Loss: 0.150 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.1364130
	speed: 0.5750s/iter; left time: 19179.6572s
	iters: 200, epoch: 20 | loss: 0.1463170
	speed: 0.2880s/iter; left time: 9576.7114s
	iters: 300, epoch: 20 | loss: 0.0000246
	speed: 0.2703s/iter; left time: 8963.1248s
	iters: 400, epoch: 20 | loss: 0.0364476
	speed: 0.2985s/iter; left time: 9867.1509s
Epoch: 20 cost time: 119.76158857345581
Epoch: 20, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.411 Vali Acc: 0.964 Test Loss: 0.411 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000898
	speed: 0.5502s/iter; left time: 18124.0117s
	iters: 200, epoch: 21 | loss: 0.0000052
	speed: 0.2968s/iter; left time: 9746.5807s
	iters: 300, epoch: 21 | loss: 0.0000755
	speed: 0.2679s/iter; left time: 8770.8702s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.2812s/iter; left time: 9179.3083s
Epoch: 21 cost time: 117.03890895843506
Epoch: 21, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.113 Vali Acc: 0.982 Test Loss: 0.113 Test Acc: 0.982
Validation loss decreased (-0.980899 --> -0.982264).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0000015
	speed: 0.5628s/iter; left time: 18307.6237s
	iters: 200, epoch: 22 | loss: 0.0001033
	speed: 0.3014s/iter; left time: 9773.0852s
	iters: 300, epoch: 22 | loss: 0.0000091
	speed: 0.2735s/iter; left time: 8840.7168s
	iters: 400, epoch: 22 | loss: 0.0006162
	speed: 0.2882s/iter; left time: 9289.1619s
Epoch: 22 cost time: 118.81160306930542
Epoch: 22, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.110 Vali Acc: 0.984 Test Loss: 0.110 Test Acc: 0.984
Validation loss decreased (-0.982264 --> -0.984083).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000079
	speed: 0.5651s/iter; left time: 18146.6448s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.2892s/iter; left time: 9259.2385s
	iters: 300, epoch: 23 | loss: 0.0000036
	speed: 0.2728s/iter; left time: 8705.7706s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.2865s/iter; left time: 9115.1128s
Epoch: 23 cost time: 118.4111750125885
Epoch: 23, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.224 Vali Acc: 0.979 Test Loss: 0.224 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0003620
	speed: 0.5551s/iter; left time: 17598.6607s
	iters: 200, epoch: 24 | loss: 0.0048123
	speed: 0.3060s/iter; left time: 9671.4413s
	iters: 300, epoch: 24 | loss: 0.0000001
	speed: 0.2885s/iter; left time: 9088.4462s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.2945s/iter; left time: 9247.2345s
Epoch: 24 cost time: 120.78214597702026
Epoch: 24, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.108 Vali Acc: 0.981 Test Loss: 0.108 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.5726s/iter; left time: 17915.0232s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.3036s/iter; left time: 9469.3575s
	iters: 300, epoch: 25 | loss: 0.0000001
	speed: 0.2668s/iter; left time: 8296.0201s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.2882s/iter; left time: 8931.1524s
Epoch: 25 cost time: 118.64130973815918
Epoch: 25, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.267 Vali Acc: 0.973 Test Loss: 0.267 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0060305
	speed: 0.5621s/iter; left time: 17356.6918s
	iters: 200, epoch: 26 | loss: 0.0000505
	speed: 0.2831s/iter; left time: 8711.2407s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.2588s/iter; left time: 7938.4391s
	iters: 400, epoch: 26 | loss: 0.0000098
	speed: 0.2705s/iter; left time: 8269.3838s
Epoch: 26 cost time: 113.80590343475342
Epoch: 26, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.183 Vali Acc: 0.978 Test Loss: 0.183 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.6562101
	speed: 0.5582s/iter; left time: 17005.2764s
	iters: 200, epoch: 27 | loss: 0.0000001
	speed: 0.2799s/iter; left time: 8498.0800s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.2880s/iter; left time: 8716.2736s
	iters: 400, epoch: 27 | loss: 0.0001115
	speed: 0.2895s/iter; left time: 8732.2024s
Epoch: 27 cost time: 118.02000617980957
Epoch: 27, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.107 Vali Acc: 0.988 Test Loss: 0.107 Test Acc: 0.988
Validation loss decreased (-0.984083 --> -0.987721).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0000039
	speed: 0.5615s/iter; left time: 16873.2773s
	iters: 200, epoch: 28 | loss: 0.0000409
	speed: 0.2860s/iter; left time: 8565.9615s
	iters: 300, epoch: 28 | loss: 0.0000070
	speed: 0.2847s/iter; left time: 8499.5179s
	iters: 400, epoch: 28 | loss: 0.0001075
	speed: 0.2802s/iter; left time: 8335.6049s
Epoch: 28 cost time: 117.356525182724
Epoch: 28, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.113 Vali Acc: 0.984 Test Loss: 0.113 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0000013
	speed: 0.5720s/iter; left time: 16953.3151s
	iters: 200, epoch: 29 | loss: 0.0295402
	speed: 0.2856s/iter; left time: 8434.6818s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.2840s/iter; left time: 8359.6640s
	iters: 400, epoch: 29 | loss: 0.0000012
	speed: 0.2853s/iter; left time: 8370.9364s
Epoch: 29 cost time: 118.53580379486084
Epoch: 29, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.166 Vali Acc: 0.980 Test Loss: 0.166 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0000048
	speed: 0.5764s/iter; left time: 16843.9832s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.2674s/iter; left time: 7788.9802s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.3032s/iter; left time: 8799.8157s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.2791s/iter; left time: 8071.5264s
Epoch: 30 cost time: 117.68776869773865
Epoch: 30, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.117 Vali Acc: 0.984 Test Loss: 0.117 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.0262126
	speed: 0.5613s/iter; left time: 16171.5055s
	iters: 200, epoch: 31 | loss: 0.0001879
	speed: 0.2884s/iter; left time: 8278.8251s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.2903s/iter; left time: 8305.3334s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.2877s/iter; left time: 8202.0828s
Epoch: 31 cost time: 120.83255171775818
Epoch: 31, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.086 Vali Acc: 0.990 Test Loss: 0.086 Test Acc: 0.990
Validation loss decreased (-0.987721 --> -0.989540).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.0000002
	speed: 0.5710s/iter; left time: 16214.5253s
	iters: 200, epoch: 32 | loss: 0.0000601
	speed: 0.2870s/iter; left time: 8122.5678s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.2782s/iter; left time: 7844.6262s
	iters: 400, epoch: 32 | loss: 0.0000001
	speed: 0.2829s/iter; left time: 7947.8138s
Epoch: 32 cost time: 115.77642512321472
Epoch: 32, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.111 Vali Acc: 0.986 Test Loss: 0.111 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.0000027
	speed: 0.5410s/iter; left time: 15139.9880s
	iters: 200, epoch: 33 | loss: 0.0000010
	speed: 0.2768s/iter; left time: 7719.0464s
	iters: 300, epoch: 33 | loss: 0.0000068
	speed: 0.2879s/iter; left time: 7999.1238s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.2693s/iter; left time: 7454.2715s
Epoch: 33 cost time: 116.24829936027527
Epoch: 33, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.156 Vali Acc: 0.984 Test Loss: 0.156 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 0.0000001
	speed: 0.5562s/iter; left time: 15334.6345s
	iters: 200, epoch: 34 | loss: 0.0143522
	speed: 0.3006s/iter; left time: 8259.4211s
	iters: 300, epoch: 34 | loss: 0.0000515
	speed: 0.2800s/iter; left time: 7665.4382s
	iters: 400, epoch: 34 | loss: 0.0000001
	speed: 0.3017s/iter; left time: 8227.0857s
Epoch: 34 cost time: 120.28779435157776
Epoch: 34, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.313 Vali Acc: 0.965 Test Loss: 0.313 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 0.0016475
	speed: 0.5832s/iter; left time: 15838.6471s
	iters: 200, epoch: 35 | loss: 0.0000509
	speed: 0.2888s/iter; left time: 7815.5826s
	iters: 300, epoch: 35 | loss: 0.0000071
	speed: 0.2897s/iter; left time: 7811.1764s
	iters: 400, epoch: 35 | loss: 0.0001603
	speed: 0.2786s/iter; left time: 7484.2212s
Epoch: 35 cost time: 120.31187105178833
Epoch: 35, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.117 Vali Acc: 0.982 Test Loss: 0.117 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 0.0000008
	speed: 0.5528s/iter; left time: 14784.3503s
	iters: 200, epoch: 36 | loss: 0.0000101
	speed: 0.2802s/iter; left time: 7466.4548s
	iters: 300, epoch: 36 | loss: 0.0000051
	speed: 0.2858s/iter; left time: 7586.7516s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.2943s/iter; left time: 7783.3212s
Epoch: 36 cost time: 117.92593359947205
Epoch: 36, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.156 Vali Acc: 0.980 Test Loss: 0.156 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 37 | loss: 0.0000275
	speed: 0.5612s/iter; left time: 14779.1101s
	iters: 200, epoch: 37 | loss: 0.0708659
	speed: 0.2795s/iter; left time: 7331.4270s
	iters: 300, epoch: 37 | loss: 0.0003418
	speed: 0.2960s/iter; left time: 7734.0614s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.2812s/iter; left time: 7319.2971s
Epoch: 37 cost time: 119.87626028060913
Epoch: 37, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.094 Vali Acc: 0.986 Test Loss: 0.094 Test Acc: 0.986
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.5378s/iter; left time: 13939.2692s
	iters: 200, epoch: 38 | loss: 0.0000062
	speed: 0.2884s/iter; left time: 7446.4550s
	iters: 300, epoch: 38 | loss: 0.0000000
	speed: 0.2810s/iter; left time: 7228.1406s
	iters: 400, epoch: 38 | loss: 0.0359036
	speed: 0.2864s/iter; left time: 7337.4906s
Epoch: 38 cost time: 116.73234701156616
Epoch: 38, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.074 Vali Acc: 0.985 Test Loss: 0.074 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 39 | loss: 0.0000037
	speed: 0.5468s/iter; left time: 13947.3168s
	iters: 200, epoch: 39 | loss: 0.0000004
	speed: 0.2943s/iter; left time: 7477.0065s
	iters: 300, epoch: 39 | loss: 0.0000000
	speed: 0.2907s/iter; left time: 7356.1775s
	iters: 400, epoch: 39 | loss: 0.0000022
	speed: 0.2880s/iter; left time: 7260.1534s
Epoch: 39 cost time: 119.38391637802124
Epoch: 39, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.986 Test Loss: 0.088 Test Acc: 0.986
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 40 | loss: 0.0000005
	speed: 0.5531s/iter; left time: 13880.2319s
	iters: 200, epoch: 40 | loss: 0.0000002
	speed: 0.2946s/iter; left time: 7363.1514s
	iters: 300, epoch: 40 | loss: 0.0000000
	speed: 0.2910s/iter; left time: 7243.5917s
	iters: 400, epoch: 40 | loss: 0.0000000
	speed: 0.2869s/iter; left time: 7114.0577s
Epoch: 40 cost time: 119.81552195549011
Epoch: 40, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.987 Test Loss: 0.073 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 41 | loss: 0.0000000
	speed: 0.5467s/iter; left time: 13492.1677s
	iters: 200, epoch: 41 | loss: 0.0000000
	speed: 0.2869s/iter; left time: 7052.5550s
	iters: 300, epoch: 41 | loss: 0.0000095
	speed: 0.2959s/iter; left time: 7244.3442s
	iters: 400, epoch: 41 | loss: 0.0000001
	speed: 0.2741s/iter; left time: 6681.8300s
Epoch: 41 cost time: 117.69394135475159
Epoch: 41, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.987 Test Loss: 0.073 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df512_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9895407003183265
model parameter : 3373578
model size : 22.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5648072
	speed: 0.3064s/iter; left time: 12625.7392s
	iters: 200, epoch: 1 | loss: 0.1061462
	speed: 0.2768s/iter; left time: 11375.0636s
	iters: 300, epoch: 1 | loss: 0.0635955
	speed: 0.2897s/iter; left time: 11877.4505s
	iters: 400, epoch: 1 | loss: 0.0776921
	speed: 0.2732s/iter; left time: 11176.1276s
Epoch: 1 cost time: 118.33614683151245
Epoch: 1, Steps: 413 | Train Loss: 0.603 Vali Loss: 0.180 Vali Acc: 0.948 Test Loss: 0.180 Test Acc: 0.948
Validation loss decreased (inf --> -0.948156).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0406084
	speed: 0.5667s/iter; left time: 23114.3737s
	iters: 200, epoch: 2 | loss: 0.7456852
	speed: 0.2894s/iter; left time: 11775.2609s
	iters: 300, epoch: 2 | loss: 0.2723128
	speed: 0.2881s/iter; left time: 11692.4165s
	iters: 400, epoch: 2 | loss: 0.0009390
	speed: 0.2886s/iter; left time: 11686.7221s
Epoch: 2 cost time: 119.82762908935547
Epoch: 2, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
Validation loss decreased (-0.948156 --> -0.969530).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0476706
	speed: 0.5727s/iter; left time: 23124.3583s
	iters: 200, epoch: 3 | loss: 0.0009956
	speed: 0.2808s/iter; left time: 11310.2540s
	iters: 300, epoch: 3 | loss: 0.0327757
	speed: 0.2930s/iter; left time: 11771.7607s
	iters: 400, epoch: 3 | loss: 0.3347390
	speed: 0.2836s/iter; left time: 11366.0422s
Epoch: 3 cost time: 118.81655502319336
Epoch: 3, Steps: 413 | Train Loss: 0.113 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
Validation loss decreased (-0.969530 --> -0.969985).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0105103
	speed: 0.5582s/iter; left time: 22308.0164s
	iters: 200, epoch: 4 | loss: 0.0004972
	speed: 0.2787s/iter; left time: 11108.5913s
	iters: 300, epoch: 4 | loss: 0.0029430
	speed: 0.2760s/iter; left time: 10975.9917s
	iters: 400, epoch: 4 | loss: 0.1642565
	speed: 0.2901s/iter; left time: 11505.1737s
Epoch: 4 cost time: 117.28359818458557
Epoch: 4, Steps: 413 | Train Loss: 0.121 Vali Loss: 0.272 Vali Acc: 0.965 Test Loss: 0.272 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0932199
	speed: 0.5565s/iter; left time: 22009.5138s
	iters: 200, epoch: 5 | loss: 0.1199623
	speed: 0.3059s/iter; left time: 12066.1247s
	iters: 300, epoch: 5 | loss: 0.8519134
	speed: 0.2979s/iter; left time: 11722.1817s
	iters: 400, epoch: 5 | loss: 0.0000006
	speed: 0.2854s/iter; left time: 11201.9099s
Epoch: 5 cost time: 121.30113625526428
Epoch: 5, Steps: 413 | Train Loss: 0.142 Vali Loss: 0.217 Vali Acc: 0.957 Test Loss: 0.217 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0870100
	speed: 0.5627s/iter; left time: 22022.2680s
	iters: 200, epoch: 6 | loss: 0.4889253
	speed: 0.2912s/iter; left time: 11366.2725s
	iters: 300, epoch: 6 | loss: 0.0001160
	speed: 0.2968s/iter; left time: 11555.7627s
	iters: 400, epoch: 6 | loss: 0.0056050
	speed: 0.2623s/iter; left time: 10187.2333s
Epoch: 6 cost time: 115.78279209136963
Epoch: 6, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.157 Vali Acc: 0.975 Test Loss: 0.157 Test Acc: 0.975
Validation loss decreased (-0.969985 --> -0.974532).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0497780
	speed: 0.5706s/iter; left time: 22096.1663s
	iters: 200, epoch: 7 | loss: 0.0621876
	speed: 0.2796s/iter; left time: 10800.2536s
	iters: 300, epoch: 7 | loss: 0.0000023
	speed: 0.3045s/iter; left time: 11729.4331s
	iters: 400, epoch: 7 | loss: 0.8906751
	speed: 0.2933s/iter; left time: 11268.1466s
Epoch: 7 cost time: 120.53392887115479
Epoch: 7, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.417 Vali Acc: 0.958 Test Loss: 0.417 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0002495
	speed: 0.5575s/iter; left time: 21359.1372s
	iters: 200, epoch: 8 | loss: 0.0032911
	speed: 0.2772s/iter; left time: 10593.5762s
	iters: 300, epoch: 8 | loss: 0.0002697
	speed: 0.2845s/iter; left time: 10840.8764s
	iters: 400, epoch: 8 | loss: 0.7595557
	speed: 0.2908s/iter; left time: 11054.0343s
Epoch: 8 cost time: 118.02176117897034
Epoch: 8, Steps: 413 | Train Loss: 0.114 Vali Loss: 0.232 Vali Acc: 0.964 Test Loss: 0.232 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0018951
	speed: 0.5643s/iter; left time: 21385.5913s
	iters: 200, epoch: 9 | loss: 0.0004300
	speed: 0.2765s/iter; left time: 10450.4806s
	iters: 300, epoch: 9 | loss: 0.0000009
	speed: 0.2675s/iter; left time: 10084.7489s
	iters: 400, epoch: 9 | loss: 0.0000036
	speed: 0.3014s/iter; left time: 11331.5603s
Epoch: 9 cost time: 118.43221306800842
Epoch: 9, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.160 Vali Acc: 0.970 Test Loss: 0.160 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000008
	speed: 0.5428s/iter; left time: 20345.8576s
	iters: 200, epoch: 10 | loss: 0.0153910
	speed: 0.2932s/iter; left time: 10961.0445s
	iters: 300, epoch: 10 | loss: 0.0000004
	speed: 0.2847s/iter; left time: 10614.1979s
	iters: 400, epoch: 10 | loss: 0.0227619
	speed: 0.2906s/iter; left time: 10804.7656s
Epoch: 10 cost time: 118.20174717903137
Epoch: 10, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.211 Vali Acc: 0.971 Test Loss: 0.211 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0099956
	speed: 0.5610s/iter; left time: 20796.4149s
	iters: 200, epoch: 11 | loss: 0.0000089
	speed: 0.2706s/iter; left time: 10005.0689s
	iters: 300, epoch: 11 | loss: 0.0000078
	speed: 0.2886s/iter; left time: 10639.6329s
	iters: 400, epoch: 11 | loss: 0.0015971
	speed: 0.2736s/iter; left time: 10060.9410s
Epoch: 11 cost time: 116.2973062992096
Epoch: 11, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.399 Vali Acc: 0.958 Test Loss: 0.399 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000786
	speed: 0.5555s/iter; left time: 20363.6861s
	iters: 200, epoch: 12 | loss: 0.0001584
	speed: 0.3036s/iter; left time: 11097.2591s
	iters: 300, epoch: 12 | loss: 0.0003063
	speed: 0.2864s/iter; left time: 10439.8370s
	iters: 400, epoch: 12 | loss: 0.0050153
	speed: 0.3042s/iter; left time: 11059.6403s
Epoch: 12 cost time: 123.55072689056396
Epoch: 12, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.177 Vali Acc: 0.978 Test Loss: 0.177 Test Acc: 0.978
Validation loss decreased (-0.974532 --> -0.977715).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000505
	speed: 0.5632s/iter; left time: 20411.4724s
	iters: 200, epoch: 13 | loss: 0.0000131
	speed: 0.2825s/iter; left time: 10211.1359s
	iters: 300, epoch: 13 | loss: 0.0241889
	speed: 0.2955s/iter; left time: 10650.3273s
	iters: 400, epoch: 13 | loss: 0.0018761
	speed: 0.2693s/iter; left time: 9679.0573s
Epoch: 13 cost time: 116.33041000366211
Epoch: 13, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.222 Vali Acc: 0.970 Test Loss: 0.222 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0186825
	speed: 0.5513s/iter; left time: 19755.1364s
	iters: 200, epoch: 14 | loss: 0.0000012
	speed: 0.2894s/iter; left time: 10341.7203s
	iters: 300, epoch: 14 | loss: 0.0397398
	speed: 0.2870s/iter; left time: 10225.3702s
	iters: 400, epoch: 14 | loss: 0.0000005
	speed: 0.2834s/iter; left time: 10070.6364s
Epoch: 14 cost time: 117.38617444038391
Epoch: 14, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.319 Vali Acc: 0.960 Test Loss: 0.319 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000254
	speed: 0.5734s/iter; left time: 20310.1697s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.2908s/iter; left time: 10269.9658s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.2864s/iter; left time: 10086.8688s
	iters: 400, epoch: 15 | loss: 0.0000235
	speed: 0.2979s/iter; left time: 10460.6358s
Epoch: 15 cost time: 121.05757260322571
Epoch: 15, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.207 Vali Acc: 0.978 Test Loss: 0.207 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.978170).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0309644
	speed: 0.5574s/iter; left time: 19512.3273s
	iters: 200, epoch: 16 | loss: 0.0003996
	speed: 0.2855s/iter; left time: 9965.7553s
	iters: 300, epoch: 16 | loss: 0.0000050
	speed: 0.2980s/iter; left time: 10373.4349s
	iters: 400, epoch: 16 | loss: 0.0000111
	speed: 0.2661s/iter; left time: 9236.8115s
Epoch: 16 cost time: 117.0907256603241
Epoch: 16, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.207 Vali Acc: 0.977 Test Loss: 0.207 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000026
	speed: 0.5775s/iter; left time: 19978.2077s
	iters: 200, epoch: 17 | loss: 0.0000003
	speed: 0.2780s/iter; left time: 9587.3915s
	iters: 300, epoch: 17 | loss: 0.0629449
	speed: 0.2957s/iter; left time: 10170.7396s
	iters: 400, epoch: 17 | loss: 0.0000014
	speed: 0.2935s/iter; left time: 10065.3721s
Epoch: 17 cost time: 120.65519094467163
Epoch: 17, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.158 Vali Acc: 0.977 Test Loss: 0.158 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000001
	speed: 0.5744s/iter; left time: 19631.9061s
	iters: 200, epoch: 18 | loss: 0.0015116
	speed: 0.2877s/iter; left time: 9804.1499s
	iters: 300, epoch: 18 | loss: 0.0000001
	speed: 0.2742s/iter; left time: 9315.7915s
	iters: 400, epoch: 18 | loss: 0.0000013
	speed: 0.2807s/iter; left time: 9510.6894s
Epoch: 18 cost time: 117.69728827476501
Epoch: 18, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.118 Vali Acc: 0.982 Test Loss: 0.118 Test Acc: 0.982
Validation loss decreased (-0.978170 --> -0.981809).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000220
	speed: 0.5485s/iter; left time: 18519.7078s
	iters: 200, epoch: 19 | loss: 0.0000003
	speed: 0.2912s/iter; left time: 9802.9196s
	iters: 300, epoch: 19 | loss: 0.0000227
	speed: 0.2995s/iter; left time: 10052.7592s
	iters: 400, epoch: 19 | loss: 0.0000001
	speed: 0.2789s/iter; left time: 9333.7213s
Epoch: 19 cost time: 118.07189226150513
Epoch: 19, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.285 Vali Acc: 0.965 Test Loss: 0.285 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.5769s/iter; left time: 19241.9303s
	iters: 200, epoch: 20 | loss: 0.0043168
	speed: 0.2824s/iter; left time: 9391.9163s
	iters: 300, epoch: 20 | loss: 0.0000028
	speed: 0.2915s/iter; left time: 9665.0928s
	iters: 400, epoch: 20 | loss: 0.0000759
	speed: 0.2927s/iter; left time: 9674.6714s
Epoch: 20 cost time: 120.85037565231323
Epoch: 20, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.142 Vali Acc: 0.982 Test Loss: 0.142 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000185
	speed: 0.5256s/iter; left time: 17312.4899s
	iters: 200, epoch: 21 | loss: 0.0998472
	speed: 0.2904s/iter; left time: 9538.0419s
	iters: 300, epoch: 21 | loss: 0.0000267
	speed: 0.2655s/iter; left time: 8692.1367s
	iters: 400, epoch: 21 | loss: 0.0000001
	speed: 0.2808s/iter; left time: 9165.8033s
Epoch: 21 cost time: 115.26323580741882
Epoch: 21, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.131 Vali Acc: 0.982 Test Loss: 0.131 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.8030463
	speed: 0.5479s/iter; left time: 17822.1575s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.2817s/iter; left time: 9135.1223s
	iters: 300, epoch: 22 | loss: 0.0000001
	speed: 0.3078s/iter; left time: 9950.9511s
	iters: 400, epoch: 22 | loss: 0.0213969
	speed: 0.2741s/iter; left time: 8832.7061s
Epoch: 22 cost time: 117.9137773513794
Epoch: 22, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.139 Vali Acc: 0.977 Test Loss: 0.139 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0000006
	speed: 0.5618s/iter; left time: 18042.6441s
	iters: 200, epoch: 23 | loss: 0.0000153
	speed: 0.2734s/iter; left time: 8752.9370s
	iters: 300, epoch: 23 | loss: 0.0000150
	speed: 0.2759s/iter; left time: 8804.7020s
	iters: 400, epoch: 23 | loss: 0.0000001
	speed: 0.2878s/iter; left time: 9155.9043s
Epoch: 23 cost time: 117.04885578155518
Epoch: 23, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.207 Vali Acc: 0.977 Test Loss: 0.207 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0000056
	speed: 0.5252s/iter; left time: 16650.3722s
	iters: 200, epoch: 24 | loss: 0.0030612
	speed: 0.2996s/iter; left time: 9468.3565s
	iters: 300, epoch: 24 | loss: 0.0150215
	speed: 0.2680s/iter; left time: 8442.6499s
	iters: 400, epoch: 24 | loss: 0.0000662
	speed: 0.2787s/iter; left time: 8751.0880s
Epoch: 24 cost time: 115.1463086605072
Epoch: 24, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.190 Vali Acc: 0.976 Test Loss: 0.190 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.5731s/iter; left time: 17932.3746s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.2793s/iter; left time: 8710.2278s
	iters: 300, epoch: 25 | loss: 0.0000022
	speed: 0.2969s/iter; left time: 9230.0802s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.2937s/iter; left time: 9102.0598s
Epoch: 25 cost time: 120.11535811424255
Epoch: 25, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.242 Vali Acc: 0.975 Test Loss: 0.242 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.5543s/iter; left time: 17115.3178s
	iters: 200, epoch: 26 | loss: 0.0000001
	speed: 0.2876s/iter; left time: 8851.0267s
	iters: 300, epoch: 26 | loss: 0.0000001
	speed: 0.2856s/iter; left time: 8761.5984s
	iters: 400, epoch: 26 | loss: 0.0000001
	speed: 0.2566s/iter; left time: 7846.2314s
Epoch: 26 cost time: 116.32998299598694
Epoch: 26, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.209 Vali Acc: 0.978 Test Loss: 0.209 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0325951
	speed: 0.5552s/iter; left time: 16914.0062s
	iters: 200, epoch: 27 | loss: 0.0000010
	speed: 0.2711s/iter; left time: 8230.3230s
	iters: 300, epoch: 27 | loss: 0.0090729
	speed: 0.2919s/iter; left time: 8834.7110s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.2825s/iter; left time: 8521.0059s
Epoch: 27 cost time: 116.88474488258362
Epoch: 27, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.132 Vali Acc: 0.982 Test Loss: 0.132 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0000133
	speed: 0.5594s/iter; left time: 16808.6422s
	iters: 200, epoch: 28 | loss: 0.0000010
	speed: 0.2886s/iter; left time: 8643.4450s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.2956s/iter; left time: 8822.6731s
	iters: 400, epoch: 28 | loss: 0.0000422
	speed: 0.2608s/iter; left time: 7757.4835s
Epoch: 28 cost time: 115.81232810020447
Epoch: 28, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.107 Vali Acc: 0.986 Test Loss: 0.107 Test Acc: 0.986
Validation loss decreased (-0.981809 --> -0.985902).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0000014
	speed: 0.5446s/iter; left time: 16139.9282s
	iters: 200, epoch: 29 | loss: 0.0000640
	speed: 0.2446s/iter; left time: 7226.0174s
	iters: 300, epoch: 29 | loss: 0.0000034
	speed: 0.2966s/iter; left time: 8731.6384s
	iters: 400, epoch: 29 | loss: 0.0000203
	speed: 0.2673s/iter; left time: 7841.9755s
Epoch: 29 cost time: 111.21117448806763
Epoch: 29, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.148 Vali Acc: 0.980 Test Loss: 0.148 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0000003
	speed: 0.5344s/iter; left time: 15617.4399s
	iters: 200, epoch: 30 | loss: 0.0000002
	speed: 0.2897s/iter; left time: 8436.1626s
	iters: 300, epoch: 30 | loss: 0.0000004
	speed: 0.2945s/iter; left time: 8548.1898s
	iters: 400, epoch: 30 | loss: 0.3025619
	speed: 0.2874s/iter; left time: 8312.4155s
Epoch: 30 cost time: 118.64709162712097
Epoch: 30, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.175 Vali Acc: 0.979 Test Loss: 0.175 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.0468990
	speed: 0.5512s/iter; left time: 15879.5475s
	iters: 200, epoch: 31 | loss: 0.0000001
	speed: 0.2627s/iter; left time: 7542.6591s
	iters: 300, epoch: 31 | loss: 0.0000005
	speed: 0.2946s/iter; left time: 8428.1299s
	iters: 400, epoch: 31 | loss: 0.0531543
	speed: 0.2761s/iter; left time: 7873.1185s
Epoch: 31 cost time: 116.64533853530884
Epoch: 31, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.260 Vali Acc: 0.970 Test Loss: 0.260 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.0000104
	speed: 0.5324s/iter; left time: 15119.2542s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.2645s/iter; left time: 7484.9686s
	iters: 300, epoch: 32 | loss: 0.0000014
	speed: 0.2755s/iter; left time: 7769.6183s
	iters: 400, epoch: 32 | loss: 0.0000125
	speed: 0.2560s/iter; left time: 7193.1763s
Epoch: 32 cost time: 111.89401650428772
Epoch: 32, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.154 Vali Acc: 0.980 Test Loss: 0.154 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.5618s/iter; left time: 15722.2202s
	iters: 200, epoch: 33 | loss: 0.0000028
	speed: 0.2724s/iter; left time: 7594.8634s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.2822s/iter; left time: 7840.6642s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.3009s/iter; left time: 8329.2469s
Epoch: 33 cost time: 118.79263925552368
Epoch: 33, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.227 Vali Acc: 0.975 Test Loss: 0.227 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.0000001
	speed: 0.5579s/iter; left time: 15381.6082s
	iters: 200, epoch: 34 | loss: 0.0000015
	speed: 0.2775s/iter; left time: 7622.8988s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.2809s/iter; left time: 7688.2295s
	iters: 400, epoch: 34 | loss: 0.0021739
	speed: 0.2834s/iter; left time: 7727.6422s
Epoch: 34 cost time: 117.2717719078064
Epoch: 34, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.984 Test Loss: 0.095 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 0.0145461
	speed: 0.5498s/iter; left time: 14931.0129s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.2649s/iter; left time: 7168.6490s
	iters: 300, epoch: 35 | loss: 0.0000012
	speed: 0.2991s/iter; left time: 8064.2818s
	iters: 400, epoch: 35 | loss: 0.0000002
	speed: 0.2896s/iter; left time: 7778.7344s
Epoch: 35 cost time: 118.79511308670044
Epoch: 35, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.185 Vali Acc: 0.976 Test Loss: 0.185 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 0.0000002
	speed: 0.5540s/iter; left time: 14818.2539s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.2898s/iter; left time: 7721.5361s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.2871s/iter; left time: 7620.7568s
	iters: 400, epoch: 36 | loss: 0.0000001
	speed: 0.2807s/iter; left time: 7424.0626s
Epoch: 36 cost time: 118.94134306907654
Epoch: 36, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.119 Vali Acc: 0.985 Test Loss: 0.119 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 0.0000029
	speed: 0.5579s/iter; left time: 14691.2385s
	iters: 200, epoch: 37 | loss: 0.0000058
	speed: 0.2748s/iter; left time: 7207.6878s
	iters: 300, epoch: 37 | loss: 0.0000000
	speed: 0.2726s/iter; left time: 7122.6530s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.2932s/iter; left time: 7633.8494s
Epoch: 37 cost time: 117.79125428199768
Epoch: 37, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.163 Vali Acc: 0.975 Test Loss: 0.163 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 38 | loss: 0.0936951
	speed: 0.5588s/iter; left time: 14483.1954s
	iters: 200, epoch: 38 | loss: 0.0000003
	speed: 0.2873s/iter; left time: 7419.3391s
	iters: 300, epoch: 38 | loss: 0.0000000
	speed: 0.2835s/iter; left time: 7292.6022s
	iters: 400, epoch: 38 | loss: 0.0000001
	speed: 0.2851s/iter; left time: 7304.3964s
Epoch: 38 cost time: 119.82659149169922
Epoch: 38, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.092 Vali Acc: 0.985 Test Loss: 0.092 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9859026830377444
model parameter : 3373578
model size : 22.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5089074
	speed: 0.3032s/iter; left time: 12490.6052s
	iters: 200, epoch: 1 | loss: 0.0847182
	speed: 0.2883s/iter; left time: 11848.4411s
	iters: 300, epoch: 1 | loss: 0.1268749
	speed: 0.2930s/iter; left time: 12012.9537s
	iters: 400, epoch: 1 | loss: 0.2608855
	speed: 0.2696s/iter; left time: 11026.6787s
Epoch: 1 cost time: 119.36044812202454
Epoch: 1, Steps: 413 | Train Loss: 0.593 Vali Loss: 0.151 Vali Acc: 0.951 Test Loss: 0.151 Test Acc: 0.951
Validation loss decreased (inf --> -0.951340).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1651789
	speed: 0.5686s/iter; left time: 23193.0126s
	iters: 200, epoch: 2 | loss: 0.1334468
	speed: 0.2911s/iter; left time: 11842.7741s
	iters: 300, epoch: 2 | loss: 0.2853076
	speed: 0.2993s/iter; left time: 12148.5576s
	iters: 400, epoch: 2 | loss: 0.0530277
	speed: 0.2964s/iter; left time: 11999.4392s
Epoch: 2 cost time: 121.97247862815857
Epoch: 2, Steps: 413 | Train Loss: 0.126 Vali Loss: 0.156 Vali Acc: 0.957 Test Loss: 0.156 Test Acc: 0.957
Validation loss decreased (-0.951340 --> -0.957252).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0005072
	speed: 0.5996s/iter; left time: 24208.4792s
	iters: 200, epoch: 3 | loss: 0.0086390
	speed: 0.3102s/iter; left time: 12494.5621s
	iters: 300, epoch: 3 | loss: 0.2765526
	speed: 0.2901s/iter; left time: 11653.8661s
	iters: 400, epoch: 3 | loss: 0.7183484
	speed: 0.2649s/iter; left time: 10614.5407s
Epoch: 3 cost time: 119.4418134689331
Epoch: 3, Steps: 413 | Train Loss: 0.130 Vali Loss: 0.190 Vali Acc: 0.956 Test Loss: 0.190 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1837701
	speed: 0.5444s/iter; left time: 21757.2440s
	iters: 200, epoch: 4 | loss: 0.0034508
	speed: 0.2712s/iter; left time: 10810.2430s
	iters: 300, epoch: 4 | loss: 0.0233995
	speed: 0.2850s/iter; left time: 11333.3317s
	iters: 400, epoch: 4 | loss: 0.0003066
	speed: 0.2682s/iter; left time: 10637.3191s
Epoch: 4 cost time: 114.81200385093689
Epoch: 4, Steps: 413 | Train Loss: 0.137 Vali Loss: 0.256 Vali Acc: 0.947 Test Loss: 0.256 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0013444
	speed: 0.5642s/iter; left time: 22314.0564s
	iters: 200, epoch: 5 | loss: 0.0117325
	speed: 0.2863s/iter; left time: 11293.7251s
	iters: 300, epoch: 5 | loss: 0.5968083
	speed: 0.2796s/iter; left time: 11001.8884s
	iters: 400, epoch: 5 | loss: 0.0001698
	speed: 0.2911s/iter; left time: 11426.9720s
Epoch: 5 cost time: 118.40532732009888
Epoch: 5, Steps: 413 | Train Loss: 0.144 Vali Loss: 0.235 Vali Acc: 0.955 Test Loss: 0.235 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.1119270
	speed: 0.5341s/iter; left time: 20903.2366s
	iters: 200, epoch: 6 | loss: 0.0996603
	speed: 0.2664s/iter; left time: 10400.0965s
	iters: 300, epoch: 6 | loss: 0.0000266
	speed: 0.2872s/iter; left time: 11181.0276s
	iters: 400, epoch: 6 | loss: 0.8713340
	speed: 0.2787s/iter; left time: 10823.6212s
Epoch: 6 cost time: 115.69607377052307
Epoch: 6, Steps: 413 | Train Loss: 0.128 Vali Loss: 0.229 Vali Acc: 0.963 Test Loss: 0.229 Test Acc: 0.963
Validation loss decreased (-0.957252 --> -0.963163).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.5851834
	speed: 0.5579s/iter; left time: 21604.1547s
	iters: 200, epoch: 7 | loss: 0.0000331
	speed: 0.2871s/iter; left time: 11090.3119s
	iters: 300, epoch: 7 | loss: 0.0002195
	speed: 0.2863s/iter; left time: 11030.2670s
	iters: 400, epoch: 7 | loss: 0.5947118
	speed: 0.2878s/iter; left time: 11057.2297s
Epoch: 7 cost time: 118.2299690246582
Epoch: 7, Steps: 413 | Train Loss: 0.150 Vali Loss: 0.241 Vali Acc: 0.962 Test Loss: 0.241 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000006
	speed: 0.5550s/iter; left time: 21260.4371s
	iters: 200, epoch: 8 | loss: 0.0000242
	speed: 0.2815s/iter; left time: 10756.8607s
	iters: 300, epoch: 8 | loss: 0.0011289
	speed: 0.2813s/iter; left time: 10718.6128s
	iters: 400, epoch: 8 | loss: 0.0250957
	speed: 0.2853s/iter; left time: 10842.9712s
Epoch: 8 cost time: 117.45122957229614
Epoch: 8, Steps: 413 | Train Loss: 0.123 Vali Loss: 0.315 Vali Acc: 0.958 Test Loss: 0.315 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0001426
	speed: 0.5799s/iter; left time: 21974.6807s
	iters: 200, epoch: 9 | loss: 0.0004272
	speed: 0.3022s/iter; left time: 11421.6843s
	iters: 300, epoch: 9 | loss: 0.0001543
	speed: 0.2882s/iter; left time: 10863.8813s
	iters: 400, epoch: 9 | loss: 0.0005432
	speed: 0.2889s/iter; left time: 10862.5917s
Epoch: 9 cost time: 122.02061414718628
Epoch: 9, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.177 Vali Acc: 0.976 Test Loss: 0.177 Test Acc: 0.976
Validation loss decreased (-0.963163 --> -0.975896).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000060
	speed: 0.5736s/iter; left time: 21501.4988s
	iters: 200, epoch: 10 | loss: 0.0000014
	speed: 0.2917s/iter; left time: 10904.0296s
	iters: 300, epoch: 10 | loss: 0.0104920
	speed: 0.2942s/iter; left time: 10969.5513s
	iters: 400, epoch: 10 | loss: 0.2651395
	speed: 0.2810s/iter; left time: 10449.9978s
Epoch: 10 cost time: 120.37773776054382
Epoch: 10, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.388 Vali Acc: 0.943 Test Loss: 0.388 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0032929
	speed: 0.5592s/iter; left time: 20730.2593s
	iters: 200, epoch: 11 | loss: 0.0000049
	speed: 0.2892s/iter; left time: 10692.3204s
	iters: 300, epoch: 11 | loss: 0.8930279
	speed: 0.2958s/iter; left time: 10907.6926s
	iters: 400, epoch: 11 | loss: 0.0211890
	speed: 0.3082s/iter; left time: 11331.2784s
Epoch: 11 cost time: 121.89464616775513
Epoch: 11, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.184 Vali Acc: 0.966 Test Loss: 0.184 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0002930
	speed: 0.5612s/iter; left time: 20573.4799s
	iters: 200, epoch: 12 | loss: 0.0000010
	speed: 0.2984s/iter; left time: 10910.2783s
	iters: 300, epoch: 12 | loss: 0.0297955
	speed: 0.2924s/iter; left time: 10659.2280s
	iters: 400, epoch: 12 | loss: 0.6169556
	speed: 0.2990s/iter; left time: 10869.9330s
Epoch: 12 cost time: 121.4474630355835
Epoch: 12, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.163 Vali Acc: 0.976 Test Loss: 0.163 Test Acc: 0.976
Validation loss decreased (-0.975896 --> -0.976351).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000037
	speed: 0.5755s/iter; left time: 20858.1281s
	iters: 200, epoch: 13 | loss: 0.0001439
	speed: 0.2769s/iter; left time: 10008.5303s
	iters: 300, epoch: 13 | loss: 1.0081143
	speed: 0.3020s/iter; left time: 10884.1184s
	iters: 400, epoch: 13 | loss: 0.0000002
	speed: 0.2902s/iter; left time: 10431.8967s
Epoch: 13 cost time: 120.61420583724976
Epoch: 13, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.173 Vali Acc: 0.967 Test Loss: 0.173 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000073
	speed: 0.5516s/iter; left time: 19764.3220s
	iters: 200, epoch: 14 | loss: 0.0157331
	speed: 0.2937s/iter; left time: 10495.1071s
	iters: 300, epoch: 14 | loss: 0.0142084
	speed: 0.2950s/iter; left time: 10513.0846s
	iters: 400, epoch: 14 | loss: 0.0000537
	speed: 0.3035s/iter; left time: 10782.2297s
Epoch: 14 cost time: 121.33839344978333
Epoch: 14, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.320 Vali Acc: 0.960 Test Loss: 0.320 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000825
	speed: 0.5784s/iter; left time: 20486.5573s
	iters: 200, epoch: 15 | loss: 0.0000039
	speed: 0.2807s/iter; left time: 9913.9276s
	iters: 300, epoch: 15 | loss: 0.0000020
	speed: 0.2934s/iter; left time: 10333.8190s
	iters: 400, epoch: 15 | loss: 0.0047854
	speed: 0.2696s/iter; left time: 9466.7277s
Epoch: 15 cost time: 118.84218907356262
Epoch: 15, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.526 Vali Acc: 0.939 Test Loss: 0.526 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000001
	speed: 0.5772s/iter; left time: 20204.4617s
	iters: 200, epoch: 16 | loss: 0.0000264
	speed: 0.2903s/iter; left time: 10131.4790s
	iters: 300, epoch: 16 | loss: 0.0000083
	speed: 0.3027s/iter; left time: 10537.0182s
	iters: 400, epoch: 16 | loss: 0.0000328
	speed: 0.3063s/iter; left time: 10631.8974s
Epoch: 16 cost time: 122.66844415664673
Epoch: 16, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.142 Vali Acc: 0.978 Test Loss: 0.142 Test Acc: 0.978
Validation loss decreased (-0.976351 --> -0.977716).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.1894790
	speed: 0.5716s/iter; left time: 19772.2671s
	iters: 200, epoch: 17 | loss: 0.0000001
	speed: 0.2968s/iter; left time: 10237.1006s
	iters: 300, epoch: 17 | loss: 0.0000002
	speed: 0.2894s/iter; left time: 9954.4312s
	iters: 400, epoch: 17 | loss: 0.0005281
	speed: 0.2845s/iter; left time: 9757.0523s
Epoch: 17 cost time: 119.67726421356201
Epoch: 17, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.133 Vali Acc: 0.976 Test Loss: 0.133 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.8174385
	speed: 0.5681s/iter; left time: 19418.1113s
	iters: 200, epoch: 18 | loss: 0.0000071
	speed: 0.2948s/iter; left time: 10046.7023s
	iters: 300, epoch: 18 | loss: 0.0000001
	speed: 0.2895s/iter; left time: 9837.6170s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.2953s/iter; left time: 10003.7792s
Epoch: 18 cost time: 120.32516121864319
Epoch: 18, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.200 Vali Acc: 0.974 Test Loss: 0.200 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0001443
	speed: 0.5874s/iter; left time: 19834.4178s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.2910s/iter; left time: 9796.4425s
	iters: 300, epoch: 19 | loss: 0.0000005
	speed: 0.2887s/iter; left time: 9691.7480s
	iters: 400, epoch: 19 | loss: 0.0000081
	speed: 0.2887s/iter; left time: 9661.4865s
Epoch: 19 cost time: 120.99356865882874
Epoch: 19, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0003229
	speed: 0.5584s/iter; left time: 18624.9369s
	iters: 200, epoch: 20 | loss: 0.0004885
	speed: 0.2881s/iter; left time: 9580.7147s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.2803s/iter; left time: 9293.4081s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.2880s/iter; left time: 9520.9927s
Epoch: 20 cost time: 118.81896233558655
Epoch: 20, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.214 Vali Acc: 0.975 Test Loss: 0.214 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0120120
	speed: 0.5452s/iter; left time: 17959.1039s
	iters: 200, epoch: 21 | loss: 0.0000011
	speed: 0.2925s/iter; left time: 9605.0334s
	iters: 300, epoch: 21 | loss: 0.0001465
	speed: 0.2881s/iter; left time: 9431.3465s
	iters: 400, epoch: 21 | loss: 0.1043826
	speed: 0.2778s/iter; left time: 9068.6495s
Epoch: 21 cost time: 117.69187998771667
Epoch: 21, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.339 Vali Acc: 0.959 Test Loss: 0.339 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.6309136
	speed: 0.5604s/iter; left time: 18227.3518s
	iters: 200, epoch: 22 | loss: 0.0002409
	speed: 0.2722s/iter; left time: 8827.9156s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.2721s/iter; left time: 8795.1478s
	iters: 400, epoch: 22 | loss: 0.0000108
	speed: 0.2775s/iter; left time: 8944.1423s
Epoch: 22 cost time: 114.35634922981262
Epoch: 22, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.354 Vali Acc: 0.961 Test Loss: 0.354 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0000142
	speed: 0.5326s/iter; left time: 17103.0945s
	iters: 200, epoch: 23 | loss: 0.0001629
	speed: 0.2794s/iter; left time: 8946.0825s
	iters: 300, epoch: 23 | loss: 0.0000502
	speed: 0.2802s/iter; left time: 8943.2489s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.2819s/iter; left time: 8969.6408s
Epoch: 23 cost time: 115.89492726325989
Epoch: 23, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.252 Vali Acc: 0.963 Test Loss: 0.252 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0000119
	speed: 0.5779s/iter; left time: 18321.3954s
	iters: 200, epoch: 24 | loss: 0.0000001
	speed: 0.2885s/iter; left time: 9116.7860s
	iters: 300, epoch: 24 | loss: 0.0000001
	speed: 0.2960s/iter; left time: 9324.0990s
	iters: 400, epoch: 24 | loss: 0.0000012
	speed: 0.2674s/iter; left time: 8396.1370s
Epoch: 24 cost time: 119.08685398101807
Epoch: 24, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.749 Vali Acc: 0.942 Test Loss: 0.749 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0108810
	speed: 0.5725s/iter; left time: 17911.9921s
	iters: 200, epoch: 25 | loss: 0.0000002
	speed: 0.2743s/iter; left time: 8555.8078s
	iters: 300, epoch: 25 | loss: 0.0033076
	speed: 0.2819s/iter; left time: 8764.6653s
	iters: 400, epoch: 25 | loss: 0.0000407
	speed: 0.2773s/iter; left time: 8592.6296s
Epoch: 25 cost time: 117.24531555175781
Epoch: 25, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.227 Vali Acc: 0.966 Test Loss: 0.227 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.5579s/iter; left time: 17226.7616s
	iters: 200, epoch: 26 | loss: 0.0000005
	speed: 0.2816s/iter; left time: 8666.7057s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.3056s/iter; left time: 9373.6764s
	iters: 400, epoch: 26 | loss: 0.0000009
	speed: 0.2846s/iter; left time: 8701.1363s
Epoch: 26 cost time: 119.73680281639099
Epoch: 26, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.244 Vali Acc: 0.970 Test Loss: 0.244 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9777171441564347
model parameter : 3373578
model size : 22.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5088750
	speed: 0.2804s/iter; left time: 11553.6027s
	iters: 200, epoch: 1 | loss: 0.1415331
	speed: 0.2679s/iter; left time: 11008.9681s
	iters: 300, epoch: 1 | loss: 0.0659523
	speed: 0.2831s/iter; left time: 11608.9172s
	iters: 400, epoch: 1 | loss: 0.2727032
	speed: 0.2673s/iter; left time: 10933.7721s
Epoch: 1 cost time: 113.49217200279236
Epoch: 1, Steps: 413 | Train Loss: 0.591 Vali Loss: 0.163 Vali Acc: 0.950 Test Loss: 0.163 Test Acc: 0.950
Validation loss decreased (inf --> -0.950430).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1857792
	speed: 0.5302s/iter; left time: 21627.4594s
	iters: 200, epoch: 2 | loss: 0.0908498
	speed: 0.2909s/iter; left time: 11834.1328s
	iters: 300, epoch: 2 | loss: 0.0129463
	speed: 0.2775s/iter; left time: 11263.2153s
	iters: 400, epoch: 2 | loss: 0.0013003
	speed: 0.2924s/iter; left time: 11839.1403s
Epoch: 2 cost time: 118.68787884712219
Epoch: 2, Steps: 413 | Train Loss: 0.115 Vali Loss: 0.159 Vali Acc: 0.960 Test Loss: 0.159 Test Acc: 0.960
Validation loss decreased (-0.950430 --> -0.959980).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0009067
	speed: 0.5320s/iter; left time: 21478.2474s
	iters: 200, epoch: 3 | loss: 0.1528068
	speed: 0.2810s/iter; left time: 11318.4480s
	iters: 300, epoch: 3 | loss: 0.7568188
	speed: 0.2919s/iter; left time: 11725.7299s
	iters: 400, epoch: 3 | loss: 0.5208577
	speed: 0.2721s/iter; left time: 10904.6894s
Epoch: 3 cost time: 113.49467062950134
Epoch: 3, Steps: 413 | Train Loss: 0.127 Vali Loss: 0.134 Vali Acc: 0.972 Test Loss: 0.134 Test Acc: 0.972
Validation loss decreased (-0.959980 --> -0.972259).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0052567
	speed: 0.5446s/iter; left time: 21765.2123s
	iters: 200, epoch: 4 | loss: 0.0152142
	speed: 0.2766s/iter; left time: 11023.9463s
	iters: 300, epoch: 4 | loss: 0.0015865
	speed: 0.2750s/iter; left time: 10934.4343s
	iters: 400, epoch: 4 | loss: 0.0006021
	speed: 0.2879s/iter; left time: 11419.8330s
Epoch: 4 cost time: 116.8153338432312
Epoch: 4, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.173 Vali Acc: 0.956 Test Loss: 0.173 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.4189877
	speed: 0.5443s/iter; left time: 21527.9748s
	iters: 200, epoch: 5 | loss: 0.0014579
	speed: 0.2706s/iter; left time: 10674.1791s
	iters: 300, epoch: 5 | loss: 0.6920360
	speed: 0.2759s/iter; left time: 10855.8538s
	iters: 400, epoch: 5 | loss: 0.0000162
	speed: 0.2509s/iter; left time: 9845.6955s
Epoch: 5 cost time: 111.74017214775085
Epoch: 5, Steps: 413 | Train Loss: 0.135 Vali Loss: 0.264 Vali Acc: 0.953 Test Loss: 0.264 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000024
	speed: 0.5370s/iter; left time: 21014.9619s
	iters: 200, epoch: 6 | loss: 0.1743651
	speed: 0.2592s/iter; left time: 10116.3589s
	iters: 300, epoch: 6 | loss: 0.0000457
	speed: 0.2832s/iter; left time: 11026.5777s
	iters: 400, epoch: 6 | loss: 0.0072841
	speed: 0.2941s/iter; left time: 11420.3291s
Epoch: 6 cost time: 116.27105522155762
Epoch: 6, Steps: 413 | Train Loss: 0.125 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
Validation loss decreased (-0.972259 --> -0.974987).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0027344
	speed: 0.5544s/iter; left time: 21469.7840s
	iters: 200, epoch: 7 | loss: 0.0033805
	speed: 0.2969s/iter; left time: 11468.5602s
	iters: 300, epoch: 7 | loss: 0.0001265
	speed: 0.2859s/iter; left time: 11015.3575s
	iters: 400, epoch: 7 | loss: 0.0128783
	speed: 0.2708s/iter; left time: 10405.0860s
Epoch: 7 cost time: 118.13375782966614
Epoch: 7, Steps: 413 | Train Loss: 0.123 Vali Loss: 0.310 Vali Acc: 0.950 Test Loss: 0.310 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0002162
	speed: 0.5416s/iter; left time: 20747.1853s
	iters: 200, epoch: 8 | loss: 0.0010489
	speed: 0.2503s/iter; left time: 9562.6807s
	iters: 300, epoch: 8 | loss: 0.4307281
	speed: 0.2849s/iter; left time: 10855.9617s
	iters: 400, epoch: 8 | loss: 0.0038569
	speed: 0.2730s/iter; left time: 10376.4015s
Epoch: 8 cost time: 111.85913324356079
Epoch: 8, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.243 Vali Acc: 0.956 Test Loss: 0.243 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.6173024
	speed: 0.5218s/iter; left time: 19774.3144s
	iters: 200, epoch: 9 | loss: 0.0013079
	speed: 0.2631s/iter; left time: 9944.6711s
	iters: 300, epoch: 9 | loss: 0.0000010
	speed: 0.2747s/iter; left time: 10357.0506s
	iters: 400, epoch: 9 | loss: 0.0006361
	speed: 0.2858s/iter; left time: 10746.8311s
Epoch: 9 cost time: 113.83350825309753
Epoch: 9, Steps: 413 | Train Loss: 0.112 Vali Loss: 0.197 Vali Acc: 0.973 Test Loss: 0.197 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000060
	speed: 0.5271s/iter; left time: 19757.1338s
	iters: 200, epoch: 10 | loss: 0.0000918
	speed: 0.2757s/iter; left time: 10305.4362s
	iters: 300, epoch: 10 | loss: 0.0051471
	speed: 0.2856s/iter; left time: 10647.0615s
	iters: 400, epoch: 10 | loss: 0.0000015
	speed: 0.2722s/iter; left time: 10121.3291s
Epoch: 10 cost time: 111.98765635490417
Epoch: 10, Steps: 413 | Train Loss: 0.136 Vali Loss: 0.332 Vali Acc: 0.961 Test Loss: 0.332 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.5898741
	speed: 0.5367s/iter; left time: 19895.2188s
	iters: 200, epoch: 11 | loss: 0.0000060
	speed: 0.2763s/iter; left time: 10216.5741s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.2459s/iter; left time: 9065.9480s
	iters: 400, epoch: 11 | loss: 0.5277905
	speed: 0.2880s/iter; left time: 10590.7979s
Epoch: 11 cost time: 113.91114544868469
Epoch: 11, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.326 Vali Acc: 0.955 Test Loss: 0.326 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000810
	speed: 0.5186s/iter; left time: 19009.0251s
	iters: 200, epoch: 12 | loss: 0.0000066
	speed: 0.2821s/iter; left time: 10312.4278s
	iters: 300, epoch: 12 | loss: 0.0000293
	speed: 0.2807s/iter; left time: 10232.4156s
	iters: 400, epoch: 12 | loss: 0.7185397
	speed: 0.2572s/iter; left time: 9349.9474s
Epoch: 12 cost time: 112.13087749481201
Epoch: 12, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.201 Vali Acc: 0.972 Test Loss: 0.201 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0008334
	speed: 0.5571s/iter; left time: 20190.7334s
	iters: 200, epoch: 13 | loss: 0.0000017
	speed: 0.2647s/iter; left time: 9566.7951s
	iters: 300, epoch: 13 | loss: 0.0000090
	speed: 0.2621s/iter; left time: 9446.2887s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.2806s/iter; left time: 10085.5047s
Epoch: 13 cost time: 114.9260585308075
Epoch: 13, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.159 Vali Acc: 0.977 Test Loss: 0.159 Test Acc: 0.977
Validation loss decreased (-0.974987 --> -0.976806).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0006250
	speed: 0.5015s/iter; left time: 17969.4303s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.2760s/iter; left time: 9860.5732s
	iters: 300, epoch: 14 | loss: 0.2674091
	speed: 0.2857s/iter; left time: 10181.4743s
	iters: 400, epoch: 14 | loss: 0.0000002
	speed: 0.2738s/iter; left time: 9730.2397s
Epoch: 14 cost time: 113.36855149269104
Epoch: 14, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.089 Vali Acc: 0.984 Test Loss: 0.089 Test Acc: 0.984
Validation loss decreased (-0.976806 --> -0.983628).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0058914
	speed: 0.5745s/iter; left time: 20349.2399s
	iters: 200, epoch: 15 | loss: 0.0000003
	speed: 0.2749s/iter; left time: 9709.6195s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.2932s/iter; left time: 10325.9607s
	iters: 400, epoch: 15 | loss: 0.0000555
	speed: 0.2837s/iter; left time: 9962.7778s
Epoch: 15 cost time: 118.6113293170929
Epoch: 15, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.159 Vali Acc: 0.975 Test Loss: 0.159 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000421
	speed: 0.5217s/iter; left time: 18261.6607s
	iters: 200, epoch: 16 | loss: 0.1965077
	speed: 0.2999s/iter; left time: 10469.2606s
	iters: 300, epoch: 16 | loss: 0.0000001
	speed: 0.2829s/iter; left time: 9844.9946s
	iters: 400, epoch: 16 | loss: 0.0864344
	speed: 0.2541s/iter; left time: 8820.0146s
Epoch: 16 cost time: 114.55501818656921
Epoch: 16, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.192 Vali Acc: 0.971 Test Loss: 0.192 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0001734
	speed: 0.5377s/iter; left time: 18602.3180s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.2595s/iter; left time: 8951.8022s
	iters: 300, epoch: 17 | loss: 0.0000383
	speed: 0.2803s/iter; left time: 9640.5782s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.2734s/iter; left time: 9376.9470s
Epoch: 17 cost time: 111.76558566093445
Epoch: 17, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.263 Vali Acc: 0.970 Test Loss: 0.263 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0002140
	speed: 0.5532s/iter; left time: 18908.2612s
	iters: 200, epoch: 18 | loss: 0.0582271
	speed: 0.2940s/iter; left time: 10020.4676s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.2812s/iter; left time: 9554.7976s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.2746s/iter; left time: 9304.0983s
Epoch: 18 cost time: 118.05163931846619
Epoch: 18, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.341 Vali Acc: 0.963 Test Loss: 0.341 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.7448646
	speed: 0.5777s/iter; left time: 19508.4889s
	iters: 200, epoch: 19 | loss: 0.0000056
	speed: 0.2758s/iter; left time: 9286.8223s
	iters: 300, epoch: 19 | loss: 0.0000691
	speed: 0.2916s/iter; left time: 9788.7825s
	iters: 400, epoch: 19 | loss: 0.0002920
	speed: 0.2496s/iter; left time: 8352.1688s
Epoch: 19 cost time: 115.12443208694458
Epoch: 19, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.094 Vali Acc: 0.982 Test Loss: 0.094 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.5280s/iter; left time: 17609.9595s
	iters: 200, epoch: 20 | loss: 0.0407827
	speed: 0.2439s/iter; left time: 8112.2763s
	iters: 300, epoch: 20 | loss: 0.1186129
	speed: 0.2826s/iter; left time: 9370.6561s
	iters: 400, epoch: 20 | loss: 1.3216715
	speed: 0.2627s/iter; left time: 8682.2312s
Epoch: 20 cost time: 110.4060468673706
Epoch: 20, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.273 Vali Acc: 0.970 Test Loss: 0.273 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0001747
	speed: 0.5418s/iter; left time: 17847.0351s
	iters: 200, epoch: 21 | loss: 0.2569991
	speed: 0.2715s/iter; left time: 8915.6950s
	iters: 300, epoch: 21 | loss: 0.0000128
	speed: 0.2665s/iter; left time: 8724.9864s
	iters: 400, epoch: 21 | loss: 0.5620463
	speed: 0.2880s/iter; left time: 9401.9234s
Epoch: 21 cost time: 115.53801560401917
Epoch: 21, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.331 Vali Acc: 0.964 Test Loss: 0.331 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0012982
	speed: 0.5315s/iter; left time: 17287.7409s
	iters: 200, epoch: 22 | loss: 0.0000002
	speed: 0.2765s/iter; left time: 8966.0762s
	iters: 300, epoch: 22 | loss: 0.0000639
	speed: 0.2551s/iter; left time: 8248.1348s
	iters: 400, epoch: 22 | loss: 0.2447873
	speed: 0.2809s/iter; left time: 9051.3992s
Epoch: 22 cost time: 113.23696494102478
Epoch: 22, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.488 Vali Acc: 0.954 Test Loss: 0.488 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0000004
	speed: 0.5051s/iter; left time: 16220.9453s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.2727s/iter; left time: 8731.2557s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.2555s/iter; left time: 8154.1027s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.2814s/iter; left time: 8953.1690s
Epoch: 23 cost time: 111.77285504341125
Epoch: 23, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.095 Vali Acc: 0.982 Test Loss: 0.095 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0226211
	speed: 0.5199s/iter; left time: 16482.5330s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.3011s/iter; left time: 9516.7796s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.2793s/iter; left time: 8799.1152s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.2677s/iter; left time: 8407.6311s
Epoch: 24 cost time: 114.67151236534119
Epoch: 24, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.171 Vali Acc: 0.973 Test Loss: 0.171 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9836289222373806
model parameter : 3373578
model size : 22.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.3031325
	speed: 0.3033s/iter; left time: 12495.6252s
	iters: 200, epoch: 1 | loss: 2.3027594
	speed: 0.2784s/iter; left time: 11441.8646s
	iters: 300, epoch: 1 | loss: 2.3023281
	speed: 0.2531s/iter; left time: 10378.4206s
	iters: 400, epoch: 1 | loss: 2.3037314
	speed: 0.2884s/iter; left time: 11794.5780s
Epoch: 1 cost time: 116.47295665740967
Epoch: 1, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (inf --> -0.100022).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3029189
	speed: 0.5346s/iter; left time: 21805.4851s
	iters: 200, epoch: 2 | loss: 2.3036036
	speed: 0.2929s/iter; left time: 11916.0880s
	iters: 300, epoch: 2 | loss: 2.3022206
	speed: 0.2594s/iter; left time: 10526.9182s
	iters: 400, epoch: 2 | loss: 2.3030372
	speed: 0.2919s/iter; left time: 11820.3044s
Epoch: 2 cost time: 115.75179362297058
Epoch: 2, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3019662
	speed: 0.5460s/iter; left time: 22043.6346s
	iters: 200, epoch: 3 | loss: 2.3019874
	speed: 0.2929s/iter; left time: 11795.5241s
	iters: 300, epoch: 3 | loss: 2.3034461
	speed: 0.2726s/iter; left time: 10951.1983s
	iters: 400, epoch: 3 | loss: 2.3032832
	speed: 0.2913s/iter; left time: 11672.9032s
Epoch: 3 cost time: 117.37550902366638
Epoch: 3, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.3030457
	speed: 0.5450s/iter; left time: 21779.1079s
	iters: 200, epoch: 4 | loss: 2.3006463
	speed: 0.3032s/iter; left time: 12085.4421s
	iters: 300, epoch: 4 | loss: 2.3056245
	speed: 0.2772s/iter; left time: 11022.4700s
	iters: 400, epoch: 4 | loss: 2.3036382
	speed: 0.2841s/iter; left time: 11268.3324s
Epoch: 4 cost time: 118.11184906959534
Epoch: 4, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.3050086
	speed: 0.5571s/iter; left time: 22032.3958s
	iters: 200, epoch: 5 | loss: 2.3034074
	speed: 0.3008s/iter; left time: 11865.4366s
	iters: 300, epoch: 5 | loss: 2.3024848
	speed: 0.2899s/iter; left time: 11406.6010s
	iters: 400, epoch: 5 | loss: 2.3035486
	speed: 0.2843s/iter; left time: 11158.7232s
Epoch: 5 cost time: 119.56338238716125
Epoch: 5, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.3044412
	speed: 0.5519s/iter; left time: 21599.3552s
	iters: 200, epoch: 6 | loss: 2.3056934
	speed: 0.2821s/iter; left time: 11013.5774s
	iters: 300, epoch: 6 | loss: 2.3042202
	speed: 0.2734s/iter; left time: 10645.4163s
	iters: 400, epoch: 6 | loss: 2.3039169
	speed: 0.2782s/iter; left time: 10804.1869s
Epoch: 6 cost time: 115.01355957984924
Epoch: 6, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.3023574
	speed: 0.5516s/iter; left time: 21358.8807s
	iters: 200, epoch: 7 | loss: 2.3021915
	speed: 0.2941s/iter; left time: 11360.0244s
	iters: 300, epoch: 7 | loss: 2.3035419
	speed: 0.2965s/iter; left time: 11421.2399s
	iters: 400, epoch: 7 | loss: 2.3025258
	speed: 0.2769s/iter; left time: 10639.2018s
Epoch: 7 cost time: 118.716139793396
Epoch: 7, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.3025658
	speed: 0.5668s/iter; left time: 21715.5856s
	iters: 200, epoch: 8 | loss: 2.3059022
	speed: 0.2790s/iter; left time: 10660.4241s
	iters: 300, epoch: 8 | loss: 2.3017526
	speed: 0.2888s/iter; left time: 11004.3913s
	iters: 400, epoch: 8 | loss: 2.3037553
	speed: 0.2664s/iter; left time: 10124.5239s
Epoch: 8 cost time: 115.81437969207764
Epoch: 8, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.3013539
	speed: 0.5563s/iter; left time: 21083.6391s
	iters: 200, epoch: 9 | loss: 2.3014643
	speed: 0.2706s/iter; left time: 10229.2092s
	iters: 300, epoch: 9 | loss: 2.3013115
	speed: 0.3020s/iter; left time: 11383.4443s
	iters: 400, epoch: 9 | loss: 2.3037422
	speed: 0.2639s/iter; left time: 9922.6725s
Epoch: 9 cost time: 115.6060094833374
Epoch: 9, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.2993159
	speed: 0.5639s/iter; left time: 21137.3063s
	iters: 200, epoch: 10 | loss: 2.3051636
	speed: 0.2829s/iter; left time: 10577.2669s
	iters: 300, epoch: 10 | loss: 2.3006203
	speed: 0.2833s/iter; left time: 10563.1447s
	iters: 400, epoch: 10 | loss: 2.3034086
	speed: 0.2963s/iter; left time: 11016.1639s
Epoch: 10 cost time: 118.57439422607422
Epoch: 10, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.3010137
	speed: 0.5558s/iter; left time: 20603.3685s
	iters: 200, epoch: 11 | loss: 2.3033440
	speed: 0.2895s/iter; left time: 10703.6167s
	iters: 300, epoch: 11 | loss: 2.3042893
	speed: 0.2935s/iter; left time: 10823.4208s
	iters: 400, epoch: 11 | loss: 2.3050034
	speed: 0.2849s/iter; left time: 10477.0409s
Epoch: 11 cost time: 120.16709399223328
Epoch: 11, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 2.3004415
	speed: 0.5517s/iter; left time: 20222.8102s
	iters: 200, epoch: 12 | loss: 2.3026640
	speed: 0.2954s/iter; left time: 10800.2507s
	iters: 300, epoch: 12 | loss: 2.3055558
	speed: 0.2802s/iter; left time: 10217.2317s
	iters: 400, epoch: 12 | loss: 2.3022859
	speed: 0.3017s/iter; left time: 10968.0845s
Epoch: 12 cost time: 118.70235109329224
Epoch: 12, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 2.3039079
	speed: 0.5430s/iter; left time: 19680.6024s
	iters: 200, epoch: 13 | loss: 2.3066046
	speed: 0.2748s/iter; left time: 9931.9383s
	iters: 300, epoch: 13 | loss: 2.3044512
	speed: 0.2828s/iter; left time: 10194.0518s
	iters: 400, epoch: 13 | loss: 2.3044395
	speed: 0.2741s/iter; left time: 9852.4158s
Epoch: 13 cost time: 116.54191708564758
Epoch: 13, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 2.3031344
	speed: 0.5419s/iter; left time: 19418.3916s
	iters: 200, epoch: 14 | loss: 2.3010030
	speed: 0.2728s/iter; left time: 9749.3510s
	iters: 300, epoch: 14 | loss: 2.3048050
	speed: 0.2843s/iter; left time: 10131.7437s
	iters: 400, epoch: 14 | loss: 2.3030794
	speed: 0.2834s/iter; left time: 10071.4066s
Epoch: 14 cost time: 115.17880964279175
Epoch: 14, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 2.3046176
	speed: 0.5408s/iter; left time: 19154.9879s
	iters: 200, epoch: 15 | loss: 2.3020370
	speed: 0.2824s/iter; left time: 9972.7331s
	iters: 300, epoch: 15 | loss: 2.3033431
	speed: 0.2794s/iter; left time: 9838.7566s
	iters: 400, epoch: 15 | loss: 2.3023899
	speed: 0.2888s/iter; left time: 10143.3191s
Epoch: 15 cost time: 116.08859968185425
Epoch: 15, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 2.3020234
	speed: 0.5486s/iter; left time: 19202.7429s
	iters: 200, epoch: 16 | loss: 2.3009541
	speed: 0.2687s/iter; left time: 9378.2397s
	iters: 300, epoch: 16 | loss: 2.3036506
	speed: 0.2940s/iter; left time: 10233.2685s
	iters: 400, epoch: 16 | loss: 2.3028476
	speed: 0.2743s/iter; left time: 9521.5361s
Epoch: 16 cost time: 116.76386427879333
Epoch: 16, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 2.3004844
	speed: 0.5592s/iter; left time: 19342.9289s
	iters: 200, epoch: 17 | loss: 2.3030570
	speed: 0.2977s/iter; left time: 10269.4336s
	iters: 300, epoch: 17 | loss: 2.3025475
	speed: 0.2744s/iter; left time: 9438.1415s
	iters: 400, epoch: 17 | loss: 2.3045659
	speed: 0.3043s/iter; left time: 10435.2272s
Epoch: 17 cost time: 118.93877673149109
Epoch: 17, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 2.3006115
	speed: 0.5455s/iter; left time: 18645.9216s
	iters: 200, epoch: 18 | loss: 2.3047068
	speed: 0.2753s/iter; left time: 9381.0857s
	iters: 300, epoch: 18 | loss: 2.2999551
	speed: 0.2892s/iter; left time: 9826.9784s
	iters: 400, epoch: 18 | loss: 2.3027136
	speed: 0.2670s/iter; left time: 9046.8284s
Epoch: 18 cost time: 115.43198609352112
Epoch: 18, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 2.3051319
	speed: 0.5426s/iter; left time: 18320.7213s
	iters: 200, epoch: 19 | loss: 2.2999423
	speed: 0.2839s/iter; left time: 9558.3228s
	iters: 300, epoch: 19 | loss: 2.3027830
	speed: 0.2795s/iter; left time: 9381.8648s
	iters: 400, epoch: 19 | loss: 2.3035915
	speed: 0.2909s/iter; left time: 9735.0822s
Epoch: 19 cost time: 117.48086190223694
Epoch: 19, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.10004547521600728
model parameter : 3373578
model size : 22.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         47                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df256_ma47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5918452
	speed: 0.3094s/iter; left time: 12748.9363s
	iters: 200, epoch: 1 | loss: 0.0575969
	speed: 0.2883s/iter; left time: 11849.9319s
	iters: 300, epoch: 1 | loss: 0.0276737
	speed: 0.2962s/iter; left time: 12144.2806s
	iters: 400, epoch: 1 | loss: 0.2057610
	speed: 0.2620s/iter; left time: 10715.0062s
Epoch: 1 cost time: 119.91681933403015
Epoch: 1, Steps: 413 | Train Loss: 0.363 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
Validation loss decreased (inf --> -0.976807).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0019493
	speed: 0.5607s/iter; left time: 22868.3732s
	iters: 200, epoch: 2 | loss: 0.1755757
	speed: 0.2880s/iter; left time: 11720.0320s
	iters: 300, epoch: 2 | loss: 0.0718723
	speed: 0.2582s/iter; left time: 10480.7140s
	iters: 400, epoch: 2 | loss: 0.0001623
	speed: 0.2821s/iter; left time: 11420.8267s
Epoch: 2 cost time: 114.7836799621582
Epoch: 2, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.157 Vali Acc: 0.964 Test Loss: 0.157 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0007464
	speed: 0.5194s/iter; left time: 20970.6854s
	iters: 200, epoch: 3 | loss: 0.0001905
	speed: 0.2649s/iter; left time: 10669.0547s
	iters: 300, epoch: 3 | loss: 0.0103822
	speed: 0.2820s/iter; left time: 11330.9109s
	iters: 400, epoch: 3 | loss: 0.0822443
	speed: 0.2791s/iter; left time: 11186.1159s
Epoch: 3 cost time: 114.01542735099792
Epoch: 3, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.158 Vali Acc: 0.966 Test Loss: 0.158 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.1630905
	speed: 0.5454s/iter; left time: 21793.4430s
	iters: 200, epoch: 4 | loss: 0.0000688
	speed: 0.2793s/iter; left time: 11134.7752s
	iters: 300, epoch: 4 | loss: 0.1352667
	speed: 0.2929s/iter; left time: 11645.0258s
	iters: 400, epoch: 4 | loss: 0.1008859
	speed: 0.2868s/iter; left time: 11373.7831s
Epoch: 4 cost time: 118.50234246253967
Epoch: 4, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.151 Vali Acc: 0.967 Test Loss: 0.151 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.3016567
	speed: 0.5368s/iter; left time: 21228.0218s
	iters: 200, epoch: 5 | loss: 0.4582709
	speed: 0.2655s/iter; left time: 10475.5620s
	iters: 300, epoch: 5 | loss: 0.4551814
	speed: 0.2740s/iter; left time: 10781.2611s
	iters: 400, epoch: 5 | loss: 0.0633475
	speed: 0.2741s/iter; left time: 10758.6687s
Epoch: 5 cost time: 113.95287489891052
Epoch: 5, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.185 Vali Acc: 0.971 Test Loss: 0.185 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0002815
	speed: 0.5311s/iter; left time: 20785.3758s
	iters: 200, epoch: 6 | loss: 0.0165634
	speed: 0.2906s/iter; left time: 11344.0296s
	iters: 300, epoch: 6 | loss: 0.0038198
	speed: 0.2815s/iter; left time: 10960.0387s
	iters: 400, epoch: 6 | loss: 0.0014149
	speed: 0.2883s/iter; left time: 11196.8021s
Epoch: 6 cost time: 117.65263772010803
Epoch: 6, Steps: 413 | Train Loss: 0.109 Vali Loss: 0.258 Vali Acc: 0.965 Test Loss: 0.258 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0000491
	speed: 0.5865s/iter; left time: 22712.5725s
	iters: 200, epoch: 7 | loss: 0.0507705
	speed: 0.2954s/iter; left time: 11407.4638s
	iters: 300, epoch: 7 | loss: 0.0000001
	speed: 0.3020s/iter; left time: 11632.1696s
	iters: 400, epoch: 7 | loss: 0.0005278
	speed: 0.2764s/iter; left time: 10620.0909s
Epoch: 7 cost time: 121.52378463745117
Epoch: 7, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.195 Vali Acc: 0.970 Test Loss: 0.195 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.0000011
	speed: 0.5238s/iter; left time: 20065.1808s
	iters: 200, epoch: 8 | loss: 0.0004750
	speed: 0.2832s/iter; left time: 10819.5840s
	iters: 300, epoch: 8 | loss: 0.0000279
	speed: 0.2849s/iter; left time: 10859.1317s
	iters: 400, epoch: 8 | loss: 0.0000060
	speed: 0.2905s/iter; left time: 11041.2270s
Epoch: 8 cost time: 117.0264687538147
Epoch: 8, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.099 Vali Acc: 0.981 Test Loss: 0.099 Test Acc: 0.981
Validation loss decreased (-0.976807 --> -0.980899).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000039
	speed: 0.5395s/iter; left time: 20445.8993s
	iters: 200, epoch: 9 | loss: 0.0002104
	speed: 0.3018s/iter; left time: 11408.6739s
	iters: 300, epoch: 9 | loss: 0.0000219
	speed: 0.2812s/iter; left time: 10599.2255s
	iters: 400, epoch: 9 | loss: 0.0000000
	speed: 0.3037s/iter; left time: 11417.4012s
Epoch: 9 cost time: 121.12637090682983
Epoch: 9, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.195 Vali Acc: 0.970 Test Loss: 0.195 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0041724
	speed: 0.5702s/iter; left time: 21372.8298s
	iters: 200, epoch: 10 | loss: 0.0006938
	speed: 0.2939s/iter; left time: 10987.0264s
	iters: 300, epoch: 10 | loss: 0.1161374
	speed: 0.2966s/iter; left time: 11057.8609s
	iters: 400, epoch: 10 | loss: 0.0000009
	speed: 0.2734s/iter; left time: 10165.8288s
Epoch: 10 cost time: 119.819988489151
Epoch: 10, Steps: 413 | Train Loss: 0.102 Vali Loss: 0.222 Vali Acc: 0.972 Test Loss: 0.222 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.5369s/iter; left time: 19902.5976s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.2725s/iter; left time: 10075.6293s
	iters: 300, epoch: 11 | loss: 0.0225685
	speed: 0.2746s/iter; left time: 10123.5874s
	iters: 400, epoch: 11 | loss: 0.0000022
	speed: 0.2859s/iter; left time: 10512.7776s
Epoch: 11 cost time: 116.02788257598877
Epoch: 11, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.184 Vali Acc: 0.976 Test Loss: 0.184 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000013
	speed: 0.5739s/iter; left time: 21036.7230s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.2946s/iter; left time: 10768.5725s
	iters: 300, epoch: 12 | loss: 0.0234828
	speed: 0.2796s/iter; left time: 10192.3078s
	iters: 400, epoch: 12 | loss: 0.0000011
	speed: 0.2869s/iter; left time: 10429.9348s
Epoch: 12 cost time: 119.38191509246826
Epoch: 12, Steps: 413 | Train Loss: 0.109 Vali Loss: 0.707 Vali Acc: 0.936 Test Loss: 0.707 Test Acc: 0.936
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0023791
	speed: 0.5361s/iter; left time: 19429.5494s
	iters: 200, epoch: 13 | loss: 0.0008817
	speed: 0.2689s/iter; left time: 9719.9099s
	iters: 300, epoch: 13 | loss: 0.0298386
	speed: 0.2681s/iter; left time: 9662.6056s
	iters: 400, epoch: 13 | loss: 0.0262079
	speed: 0.2786s/iter; left time: 10012.7685s
Epoch: 13 cost time: 112.62711334228516
Epoch: 13, Steps: 413 | Train Loss: 0.110 Vali Loss: 0.196 Vali Acc: 0.974 Test Loss: 0.196 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.5211s/iter; left time: 18670.9219s
	iters: 200, epoch: 14 | loss: 0.0006676
	speed: 0.2910s/iter; left time: 10397.5465s
	iters: 300, epoch: 14 | loss: 0.0000060
	speed: 0.2942s/iter; left time: 10483.6060s
	iters: 400, epoch: 14 | loss: 0.0000003
	speed: 0.3016s/iter; left time: 10715.7172s
Epoch: 14 cost time: 119.65133047103882
Epoch: 14, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.238 Vali Acc: 0.975 Test Loss: 0.238 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.6564855
	speed: 0.5640s/iter; left time: 19976.1449s
	iters: 200, epoch: 15 | loss: 0.0003977
	speed: 0.2690s/iter; left time: 9501.8795s
	iters: 300, epoch: 15 | loss: 0.0007750
	speed: 0.2927s/iter; left time: 10307.2164s
	iters: 400, epoch: 15 | loss: 0.0000001
	speed: 0.2715s/iter; left time: 9535.0957s
Epoch: 15 cost time: 114.94700646400452
Epoch: 15, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.237 Vali Acc: 0.977 Test Loss: 0.237 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0001744
	speed: 0.5533s/iter; left time: 19368.7144s
	iters: 200, epoch: 16 | loss: 0.0000002
	speed: 0.2795s/iter; left time: 9756.8632s
	iters: 300, epoch: 16 | loss: 0.0000053
	speed: 0.2668s/iter; left time: 9286.3075s
	iters: 400, epoch: 16 | loss: 0.0000131
	speed: 0.2908s/iter; left time: 10091.9918s
Epoch: 16 cost time: 117.30403518676758
Epoch: 16, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.276 Vali Acc: 0.972 Test Loss: 0.276 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0001367
	speed: 0.5365s/iter; left time: 18560.3283s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.3073s/iter; left time: 10599.6066s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.2781s/iter; left time: 9563.1838s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.2767s/iter; left time: 9488.4355s
Epoch: 17 cost time: 117.58325219154358
Epoch: 17, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.173 Vali Acc: 0.982 Test Loss: 0.173 Test Acc: 0.982
Validation loss decreased (-0.980899 --> -0.982263).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.5603s/iter; left time: 19150.2218s
	iters: 200, epoch: 18 | loss: 0.0001681
	speed: 0.2708s/iter; left time: 9230.5641s
	iters: 300, epoch: 18 | loss: 0.0003316
	speed: 0.2862s/iter; left time: 9725.6792s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.2814s/iter; left time: 9533.2682s
Epoch: 18 cost time: 115.86747097969055
Epoch: 18, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.455 Vali Acc: 0.960 Test Loss: 0.455 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.5381s/iter; left time: 18171.2681s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.2878s/iter; left time: 9689.0115s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.2803s/iter; left time: 9407.2995s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.2962s/iter; left time: 9912.2641s
Epoch: 19 cost time: 119.48025941848755
Epoch: 19, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.282 Vali Acc: 0.975 Test Loss: 0.282 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.5587s/iter; left time: 18636.3594s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.2984s/iter; left time: 9921.3515s
	iters: 300, epoch: 20 | loss: 0.0024221
	speed: 0.2819s/iter; left time: 9345.9057s
	iters: 400, epoch: 20 | loss: 0.0000016
	speed: 0.2804s/iter; left time: 9268.6299s
Epoch: 20 cost time: 119.07017302513123
Epoch: 20, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.365 Vali Acc: 0.965 Test Loss: 0.365 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0002048
	speed: 0.5393s/iter; left time: 17764.5748s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.2719s/iter; left time: 8930.9629s
	iters: 300, epoch: 21 | loss: 0.1345023
	speed: 0.2916s/iter; left time: 9545.8242s
	iters: 400, epoch: 21 | loss: 0.0000268
	speed: 0.2802s/iter; left time: 9146.3670s
Epoch: 21 cost time: 115.94828510284424
Epoch: 21, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.123 Vali Acc: 0.985 Test Loss: 0.123 Test Acc: 0.985
Validation loss decreased (-0.982263 --> -0.984537).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0000218
	speed: 0.5626s/iter; left time: 18300.2776s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.2901s/iter; left time: 9406.3306s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.2861s/iter; left time: 9250.5670s
	iters: 400, epoch: 22 | loss: 0.0000006
	speed: 0.2959s/iter; left time: 9537.6238s
Epoch: 22 cost time: 120.54418969154358
Epoch: 22, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.221 Vali Acc: 0.975 Test Loss: 0.221 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0004468
	speed: 0.5226s/iter; left time: 16782.3300s
	iters: 200, epoch: 23 | loss: 0.2274361
	speed: 0.2941s/iter; left time: 9415.3431s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.2769s/iter; left time: 8836.3309s
	iters: 400, epoch: 23 | loss: 0.0000145
	speed: 0.2716s/iter; left time: 8642.4938s
Epoch: 23 cost time: 114.6073796749115
Epoch: 23, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.182 Vali Acc: 0.985 Test Loss: 0.182 Test Acc: 0.985
Validation loss decreased (-0.984537 --> -0.984991).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000095
	speed: 0.5662s/iter; left time: 17948.6166s
	iters: 200, epoch: 24 | loss: 0.0001900
	speed: 0.2649s/iter; left time: 8372.2476s
	iters: 300, epoch: 24 | loss: 0.0000001
	speed: 0.2959s/iter; left time: 9322.0799s
	iters: 400, epoch: 24 | loss: 0.0000163
	speed: 0.2971s/iter; left time: 9328.8584s
Epoch: 24 cost time: 118.68232727050781
Epoch: 24, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.219 Vali Acc: 0.975 Test Loss: 0.219 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0000663
	speed: 0.5505s/iter; left time: 17223.8166s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.2815s/iter; left time: 8780.7868s
	iters: 300, epoch: 25 | loss: 0.0012420
	speed: 0.2642s/iter; left time: 8213.6169s
	iters: 400, epoch: 25 | loss: 0.0003616
	speed: 0.2865s/iter; left time: 8879.6583s
Epoch: 25 cost time: 115.41864085197449
Epoch: 25, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.353 Vali Acc: 0.969 Test Loss: 0.353 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0002019
	speed: 0.5386s/iter; left time: 16629.9181s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.2897s/iter; left time: 8916.7549s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.2866s/iter; left time: 8790.7282s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.2909s/iter; left time: 8894.0462s
Epoch: 26 cost time: 118.02209496498108
Epoch: 26, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.238 Vali Acc: 0.978 Test Loss: 0.238 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.5911256
	speed: 0.5706s/iter; left time: 17381.4382s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.2831s/iter; left time: 8596.9252s
	iters: 300, epoch: 27 | loss: 0.0000253
	speed: 0.2883s/iter; left time: 8723.5339s
	iters: 400, epoch: 27 | loss: 0.0000003
	speed: 0.2930s/iter; left time: 8839.0571s
Epoch: 27 cost time: 119.7778549194336
Epoch: 27, Steps: 413 | Train Loss: 0.109 Vali Loss: 0.559 Vali Acc: 0.966 Test Loss: 0.559 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.5243s/iter; left time: 15753.9290s
	iters: 200, epoch: 28 | loss: 0.0000001
	speed: 0.3003s/iter; left time: 8992.6186s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.2899s/iter; left time: 8654.5616s
	iters: 400, epoch: 28 | loss: 0.0969270
	speed: 0.2841s/iter; left time: 8451.0742s
Epoch: 28 cost time: 119.17620587348938
Epoch: 28, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.204 Vali Acc: 0.977 Test Loss: 0.204 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.5556s/iter; left time: 16467.4698s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.2972s/iter; left time: 8778.7617s
	iters: 300, epoch: 29 | loss: 0.0000048
	speed: 0.2982s/iter; left time: 8779.4850s
	iters: 400, epoch: 29 | loss: 0.0000208
	speed: 0.2857s/iter; left time: 8382.8096s
Epoch: 29 cost time: 119.50426483154297
Epoch: 29, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.264 Vali Acc: 0.975 Test Loss: 0.264 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0000004
	speed: 0.5784s/iter; left time: 16902.4007s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.2680s/iter; left time: 7805.7523s
	iters: 300, epoch: 30 | loss: 0.0000015
	speed: 0.2910s/iter; left time: 8446.1521s
	iters: 400, epoch: 30 | loss: 0.0000450
	speed: 0.2901s/iter; left time: 8391.1555s
Epoch: 30 cost time: 118.91928839683533
Epoch: 30, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.323 Vali Acc: 0.970 Test Loss: 0.323 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.5522s/iter; left time: 15908.5592s
	iters: 200, epoch: 31 | loss: 0.0047166
	speed: 0.2953s/iter; left time: 8479.2107s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.2888s/iter; left time: 8261.4422s
	iters: 400, epoch: 31 | loss: 1.9475230
	speed: 0.2880s/iter; left time: 8209.9219s
Epoch: 31 cost time: 119.56036448478699
Epoch: 31, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.242 Vali Acc: 0.976 Test Loss: 0.242 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.5652s/iter; left time: 16051.5047s
	iters: 200, epoch: 32 | loss: 0.0000003
	speed: 0.2901s/iter; left time: 8209.2768s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.2948s/iter; left time: 8314.1461s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.2977s/iter; left time: 8366.0953s
Epoch: 32 cost time: 122.06938791275024
Epoch: 32, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.206 Vali Acc: 0.975 Test Loss: 0.206 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0003929
	speed: 0.5553s/iter; left time: 15540.3855s
	iters: 200, epoch: 33 | loss: 0.0000001
	speed: 0.2715s/iter; left time: 7571.9851s
	iters: 300, epoch: 33 | loss: 0.0000002
	speed: 0.2985s/iter; left time: 8292.7747s
	iters: 400, epoch: 33 | loss: 0.0000627
	speed: 0.2792s/iter; left time: 7729.0832s
Epoch: 33 cost time: 118.70964407920837
Epoch: 33, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.292 Vali Acc: 0.978 Test Loss: 0.292 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df256_ma47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.984993178717599
model parameter : 2980362
model size : 21.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         38                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df256_ma38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7104484
	speed: 0.3033s/iter; left time: 12495.7567s
	iters: 200, epoch: 1 | loss: 0.0854242
	speed: 0.2975s/iter; left time: 12225.6930s
	iters: 300, epoch: 1 | loss: 0.0630630
	speed: 0.2933s/iter; left time: 12027.0025s
	iters: 400, epoch: 1 | loss: 0.0314684
	speed: 0.2777s/iter; left time: 11356.6667s
Epoch: 1 cost time: 121.16664505004883
Epoch: 1, Steps: 413 | Train Loss: 0.380 Vali Loss: 0.103 Vali Acc: 0.969 Test Loss: 0.103 Test Acc: 0.969
Validation loss decreased (inf --> -0.969076).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0008126
	speed: 0.5569s/iter; left time: 22714.6085s
	iters: 200, epoch: 2 | loss: 0.1150210
	speed: 0.2897s/iter; left time: 11788.2725s
	iters: 300, epoch: 2 | loss: 0.0254985
	speed: 0.2781s/iter; left time: 11288.1592s
	iters: 400, epoch: 2 | loss: 0.0002946
	speed: 0.2489s/iter; left time: 10076.2038s
Epoch: 2 cost time: 112.81070709228516
Epoch: 2, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.114 Vali Acc: 0.972 Test Loss: 0.114 Test Acc: 0.972
Validation loss decreased (-0.969076 --> -0.972259).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0253876
	speed: 0.5457s/iter; left time: 22032.6170s
	iters: 200, epoch: 3 | loss: 0.0005239
	speed: 0.2800s/iter; left time: 11278.0968s
	iters: 300, epoch: 3 | loss: 0.0027807
	speed: 0.2842s/iter; left time: 11419.2112s
	iters: 400, epoch: 3 | loss: 0.0100001
	speed: 0.2863s/iter; left time: 11472.1869s
Epoch: 3 cost time: 116.27928686141968
Epoch: 3, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.163 Vali Acc: 0.963 Test Loss: 0.163 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1322832
	speed: 0.5843s/iter; left time: 23349.7843s
	iters: 200, epoch: 4 | loss: 0.0158946
	speed: 0.2999s/iter; left time: 11954.0362s
	iters: 300, epoch: 4 | loss: 0.5260133
	speed: 0.3005s/iter; left time: 11947.0590s
	iters: 400, epoch: 4 | loss: 0.2409439
	speed: 0.2743s/iter; left time: 10880.8569s
Epoch: 4 cost time: 121.8318452835083
Epoch: 4, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.179 Vali Acc: 0.969 Test Loss: 0.179 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0894418
	speed: 0.5405s/iter; left time: 21374.9754s
	iters: 200, epoch: 5 | loss: 0.0227883
	speed: 0.2687s/iter; left time: 10598.8617s
	iters: 300, epoch: 5 | loss: 0.0203579
	speed: 0.2810s/iter; left time: 11059.0330s
	iters: 400, epoch: 5 | loss: 0.0014471
	speed: 0.2903s/iter; left time: 11393.7689s
Epoch: 5 cost time: 117.19069027900696
Epoch: 5, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.167 Vali Acc: 0.975 Test Loss: 0.167 Test Acc: 0.975
Validation loss decreased (-0.972259 --> -0.974532).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000126
	speed: 0.5566s/iter; left time: 21783.5994s
	iters: 200, epoch: 6 | loss: 0.0027671
	speed: 0.2849s/iter; left time: 11122.1356s
	iters: 300, epoch: 6 | loss: 0.2932329
	speed: 0.2863s/iter; left time: 11147.9129s
	iters: 400, epoch: 6 | loss: 0.0000037
	speed: 0.2841s/iter; left time: 11033.9119s
Epoch: 6 cost time: 118.12583589553833
Epoch: 6, Steps: 413 | Train Loss: 0.114 Vali Loss: 0.277 Vali Acc: 0.955 Test Loss: 0.277 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0003741
	speed: 0.5408s/iter; left time: 20940.3856s
	iters: 200, epoch: 7 | loss: 0.0000011
	speed: 0.2732s/iter; left time: 10551.3728s
	iters: 300, epoch: 7 | loss: 0.0032501
	speed: 0.2659s/iter; left time: 10244.3875s
	iters: 400, epoch: 7 | loss: 0.0050131
	speed: 0.2854s/iter; left time: 10967.2896s
Epoch: 7 cost time: 114.55865144729614
Epoch: 7, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.163 Vali Acc: 0.972 Test Loss: 0.163 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000001
	speed: 0.5462s/iter; left time: 20923.0872s
	iters: 200, epoch: 8 | loss: 0.0000008
	speed: 0.2846s/iter; left time: 10876.2955s
	iters: 300, epoch: 8 | loss: 0.0000061
	speed: 0.2751s/iter; left time: 10482.9109s
	iters: 400, epoch: 8 | loss: 0.4321051
	speed: 0.2834s/iter; left time: 10772.1951s
Epoch: 8 cost time: 116.87768721580505
Epoch: 8, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.205 Vali Acc: 0.973 Test Loss: 0.205 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000049
	speed: 0.5436s/iter; left time: 20602.2676s
	iters: 200, epoch: 9 | loss: 0.0030714
	speed: 0.2792s/iter; left time: 10552.5230s
	iters: 300, epoch: 9 | loss: 0.0872512
	speed: 0.2693s/iter; left time: 10152.6393s
	iters: 400, epoch: 9 | loss: 0.0101228
	speed: 0.2726s/iter; left time: 10250.5836s
Epoch: 9 cost time: 112.85947704315186
Epoch: 9, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.229 Vali Acc: 0.972 Test Loss: 0.229 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000005
	speed: 0.5414s/iter; left time: 20294.2416s
	iters: 200, epoch: 10 | loss: 1.3669310
	speed: 0.2829s/iter; left time: 10574.8995s
	iters: 300, epoch: 10 | loss: 0.0000102
	speed: 0.2722s/iter; left time: 10149.9401s
	iters: 400, epoch: 10 | loss: 0.0000070
	speed: 0.2668s/iter; left time: 9921.1395s
Epoch: 10 cost time: 112.9120044708252
Epoch: 10, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.335 Vali Acc: 0.961 Test Loss: 0.335 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000002
	speed: 0.5555s/iter; left time: 20591.6426s
	iters: 200, epoch: 11 | loss: 0.0261906
	speed: 0.2712s/iter; left time: 10027.4949s
	iters: 300, epoch: 11 | loss: 0.0000010
	speed: 0.2866s/iter; left time: 10565.7218s
	iters: 400, epoch: 11 | loss: 0.0000022
	speed: 0.2666s/iter; left time: 9804.2756s
Epoch: 11 cost time: 114.90615820884705
Epoch: 11, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.183 Vali Acc: 0.979 Test Loss: 0.183 Test Acc: 0.979
Validation loss decreased (-0.974532 --> -0.978625).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0689237
	speed: 0.5496s/iter; left time: 20145.4903s
	iters: 200, epoch: 12 | loss: 0.0000023
	speed: 0.2661s/iter; left time: 9727.1040s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.2790s/iter; left time: 10173.5007s
	iters: 400, epoch: 12 | loss: 0.0913692
	speed: 0.2669s/iter; left time: 9702.1448s
Epoch: 12 cost time: 113.05899214744568
Epoch: 12, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.289 Vali Acc: 0.962 Test Loss: 0.289 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.5534s/iter; left time: 20058.2476s
	iters: 200, epoch: 13 | loss: 0.0000001
	speed: 0.2725s/iter; left time: 9849.5934s
	iters: 300, epoch: 13 | loss: 0.0000001
	speed: 0.2744s/iter; left time: 9892.0846s
	iters: 400, epoch: 13 | loss: 0.0627832
	speed: 0.2816s/iter; left time: 10120.9527s
Epoch: 13 cost time: 116.10740494728088
Epoch: 13, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.263 Vali Acc: 0.971 Test Loss: 0.263 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000021
	speed: 0.5353s/iter; left time: 19181.9141s
	iters: 200, epoch: 14 | loss: 0.0144880
	speed: 0.2784s/iter; left time: 9949.0073s
	iters: 300, epoch: 14 | loss: 0.1470368
	speed: 0.2779s/iter; left time: 9900.8373s
	iters: 400, epoch: 14 | loss: 0.0002418
	speed: 0.2771s/iter; left time: 9847.2317s
Epoch: 14 cost time: 114.7616240978241
Epoch: 14, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.339 Vali Acc: 0.960 Test Loss: 0.339 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000062
	speed: 0.5560s/iter; left time: 19693.6519s
	iters: 200, epoch: 15 | loss: 0.6865814
	speed: 0.2830s/iter; left time: 9994.7593s
	iters: 300, epoch: 15 | loss: 0.1224671
	speed: 0.2834s/iter; left time: 9980.6952s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.2795s/iter; left time: 9817.1149s
Epoch: 15 cost time: 117.29980254173279
Epoch: 15, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.289 Vali Acc: 0.967 Test Loss: 0.289 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000001
	speed: 0.5575s/iter; left time: 19514.2836s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.2834s/iter; left time: 9893.7313s
	iters: 300, epoch: 16 | loss: 0.0040935
	speed: 0.2815s/iter; left time: 9798.7327s
	iters: 400, epoch: 16 | loss: 0.3587236
	speed: 0.2880s/iter; left time: 9996.7563s
Epoch: 16 cost time: 117.12812614440918
Epoch: 16, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.245 Vali Acc: 0.974 Test Loss: 0.245 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.5700718
	speed: 0.5662s/iter; left time: 19586.7186s
	iters: 200, epoch: 17 | loss: 0.1106917
	speed: 0.2762s/iter; left time: 9527.3231s
	iters: 300, epoch: 17 | loss: 0.0008665
	speed: 0.2947s/iter; left time: 10135.1255s
	iters: 400, epoch: 17 | loss: 0.0001575
	speed: 0.2745s/iter; left time: 9413.0717s
Epoch: 17 cost time: 117.42866778373718
Epoch: 17, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.203 Vali Acc: 0.975 Test Loss: 0.203 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.1848000
	speed: 0.5397s/iter; left time: 18446.7501s
	iters: 200, epoch: 18 | loss: 0.0000002
	speed: 0.2794s/iter; left time: 9522.7350s
	iters: 300, epoch: 18 | loss: 0.0172610
	speed: 0.2831s/iter; left time: 9618.8484s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.2846s/iter; left time: 9642.2719s
Epoch: 18 cost time: 116.06135439872742
Epoch: 18, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.501 Vali Acc: 0.964 Test Loss: 0.501 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000001
	speed: 0.5648s/iter; left time: 19071.8769s
	iters: 200, epoch: 19 | loss: 0.0004184
	speed: 0.2848s/iter; left time: 9587.9916s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.2746s/iter; left time: 9217.0881s
	iters: 400, epoch: 19 | loss: 0.0009309
	speed: 0.2833s/iter; left time: 9479.6277s
Epoch: 19 cost time: 116.52724409103394
Epoch: 19, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.394 Vali Acc: 0.970 Test Loss: 0.394 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.5200653
	speed: 0.5391s/iter; left time: 17982.6438s
	iters: 200, epoch: 20 | loss: 0.0001319
	speed: 0.2682s/iter; left time: 8919.5348s
	iters: 300, epoch: 20 | loss: 0.0001901
	speed: 0.2796s/iter; left time: 9271.4760s
	iters: 400, epoch: 20 | loss: 0.3258631
	speed: 0.2665s/iter; left time: 8809.5596s
Epoch: 20 cost time: 112.83010935783386
Epoch: 20, Steps: 413 | Train Loss: 0.114 Vali Loss: 0.200 Vali Acc: 0.982 Test Loss: 0.200 Test Acc: 0.982
Validation loss decreased (-0.978625 --> -0.982263).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.5699s/iter; left time: 18774.2791s
	iters: 200, epoch: 21 | loss: 0.0000178
	speed: 0.2901s/iter; left time: 9528.1787s
	iters: 300, epoch: 21 | loss: 0.0004496
	speed: 0.2825s/iter; left time: 9250.3465s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.2826s/iter; left time: 9223.9139s
Epoch: 21 cost time: 118.57338261604309
Epoch: 21, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.205 Vali Acc: 0.975 Test Loss: 0.205 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0030877
	speed: 0.5451s/iter; left time: 17729.5774s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.2787s/iter; left time: 9037.5395s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.2662s/iter; left time: 8604.3694s
	iters: 400, epoch: 22 | loss: 0.6872180
	speed: 0.2888s/iter; left time: 9308.7398s
Epoch: 22 cost time: 114.46222257614136
Epoch: 22, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.375 Vali Acc: 0.966 Test Loss: 0.375 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000023
	speed: 0.5571s/iter; left time: 17892.7767s
	iters: 200, epoch: 23 | loss: 0.0000036
	speed: 0.2751s/iter; left time: 8805.7325s
	iters: 300, epoch: 23 | loss: 0.4643068
	speed: 0.2903s/iter; left time: 9263.5996s
	iters: 400, epoch: 23 | loss: 0.0224159
	speed: 0.2696s/iter; left time: 8575.9653s
Epoch: 23 cost time: 116.2478277683258
Epoch: 23, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.344 Vali Acc: 0.970 Test Loss: 0.344 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0221483
	speed: 0.5391s/iter; left time: 17090.7002s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.2749s/iter; left time: 8688.8232s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.2730s/iter; left time: 8599.2424s
	iters: 400, epoch: 24 | loss: 0.0485946
	speed: 0.2831s/iter; left time: 8889.3387s
Epoch: 24 cost time: 114.20017695426941
Epoch: 24, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.318 Vali Acc: 0.971 Test Loss: 0.318 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.5439s/iter; left time: 17017.7138s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.2773s/iter; left time: 8649.3803s
	iters: 300, epoch: 25 | loss: 0.5635377
	speed: 0.2722s/iter; left time: 8461.6695s
	iters: 400, epoch: 25 | loss: 0.0000001
	speed: 0.2756s/iter; left time: 8541.6913s
Epoch: 25 cost time: 114.52668619155884
Epoch: 25, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.138 Vali Acc: 0.983 Test Loss: 0.138 Test Acc: 0.983
Validation loss decreased (-0.982263 --> -0.983173).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.5384s/iter; left time: 16622.4759s
	iters: 200, epoch: 26 | loss: 0.0000143
	speed: 0.2704s/iter; left time: 8321.3967s
	iters: 300, epoch: 26 | loss: 0.0002899
	speed: 0.2689s/iter; left time: 8249.6853s
	iters: 400, epoch: 26 | loss: 1.1513077
	speed: 0.2786s/iter; left time: 8519.3503s
Epoch: 26 cost time: 114.18348789215088
Epoch: 26, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.193 Vali Acc: 0.977 Test Loss: 0.193 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.2162133
	speed: 0.5565s/iter; left time: 16953.5077s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.2789s/iter; left time: 8467.1681s
	iters: 300, epoch: 27 | loss: 0.0000063
	speed: 0.2789s/iter; left time: 8441.0758s
	iters: 400, epoch: 27 | loss: 0.0000027
	speed: 0.2774s/iter; left time: 8365.7622s
Epoch: 27 cost time: 115.57015824317932
Epoch: 27, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.175 Vali Acc: 0.980 Test Loss: 0.175 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.5801s/iter; left time: 17431.5995s
	iters: 200, epoch: 28 | loss: 0.0013874
	speed: 0.2833s/iter; left time: 8485.4349s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.2884s/iter; left time: 8610.1243s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.2770s/iter; left time: 8241.4312s
Epoch: 28 cost time: 118.55507969856262
Epoch: 28, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.489 Vali Acc: 0.971 Test Loss: 0.489 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.5517s/iter; left time: 16350.3515s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.2677s/iter; left time: 7907.8616s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.2732s/iter; left time: 8041.9409s
	iters: 400, epoch: 29 | loss: 0.7444277
	speed: 0.2794s/iter; left time: 8196.9644s
Epoch: 29 cost time: 114.51199173927307
Epoch: 29, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.360 Vali Acc: 0.964 Test Loss: 0.360 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.0000006
	speed: 0.5430s/iter; left time: 15867.6953s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.2756s/iter; left time: 8026.1176s
	iters: 300, epoch: 30 | loss: 0.0000963
	speed: 0.2670s/iter; left time: 7748.5475s
	iters: 400, epoch: 30 | loss: 0.0002968
	speed: 0.2787s/iter; left time: 8060.3843s
Epoch: 30 cost time: 114.30143761634827
Epoch: 30, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.469 Vali Acc: 0.960 Test Loss: 0.469 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.0000002
	speed: 0.5270s/iter; left time: 15183.9144s
	iters: 200, epoch: 31 | loss: 0.0000936
	speed: 0.2665s/iter; left time: 7650.1368s
	iters: 300, epoch: 31 | loss: 1.7736583
	speed: 0.2592s/iter; left time: 7416.8156s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.2730s/iter; left time: 7783.0195s
Epoch: 31 cost time: 111.79190921783447
Epoch: 31, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.319 Vali Acc: 0.978 Test Loss: 0.319 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.0224023
	speed: 0.5447s/iter; left time: 15467.2072s
	iters: 200, epoch: 32 | loss: 0.0000044
	speed: 0.2881s/iter; left time: 8152.9784s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.2826s/iter; left time: 7968.3739s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.2788s/iter; left time: 7834.7351s
Epoch: 32 cost time: 116.64465475082397
Epoch: 32, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.353 Vali Acc: 0.973 Test Loss: 0.353 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.0000281
	speed: 0.5585s/iter; left time: 15629.4682s
	iters: 200, epoch: 33 | loss: 0.0000002
	speed: 0.2703s/iter; left time: 7536.4864s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.2776s/iter; left time: 7711.9803s
	iters: 400, epoch: 33 | loss: 0.4222985
	speed: 0.2753s/iter; left time: 7620.9594s
Epoch: 33 cost time: 114.38856244087219
Epoch: 33, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.262 Vali Acc: 0.974 Test Loss: 0.262 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.0987156
	speed: 0.5469s/iter; left time: 15078.1322s
	iters: 200, epoch: 34 | loss: 2.9195108
	speed: 0.2727s/iter; left time: 7491.2673s
	iters: 300, epoch: 34 | loss: 0.0013806
	speed: 0.2904s/iter; left time: 7949.8100s
	iters: 400, epoch: 34 | loss: 0.0000002
	speed: 0.2775s/iter; left time: 7567.5414s
Epoch: 34 cost time: 115.95717096328735
Epoch: 34, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.359 Vali Acc: 0.977 Test Loss: 0.359 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.5548s/iter; left time: 15067.7688s
	iters: 200, epoch: 35 | loss: 0.0050303
	speed: 0.2744s/iter; left time: 7423.7441s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.2777s/iter; left time: 7487.6146s
	iters: 400, epoch: 35 | loss: 0.0000000
	speed: 0.2824s/iter; left time: 7585.5412s
Epoch: 35 cost time: 116.30895400047302
Epoch: 35, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.205 Vali Acc: 0.979 Test Loss: 0.205 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df256_ma38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9831741700773079
model parameter : 2980362
model size : 21.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         28                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df256_ma28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7880601
	speed: 0.2950s/iter; left time: 12152.3683s
	iters: 200, epoch: 1 | loss: 0.0672285
	speed: 0.2994s/iter; left time: 12306.8385s
	iters: 300, epoch: 1 | loss: 0.0434998
	speed: 0.2677s/iter; left time: 10976.2699s
	iters: 400, epoch: 1 | loss: 0.0609505
	speed: 0.2718s/iter; left time: 11116.2850s
Epoch: 1 cost time: 117.22260761260986
Epoch: 1, Steps: 413 | Train Loss: 0.418 Vali Loss: 0.065 Vali Acc: 0.979 Test Loss: 0.065 Test Acc: 0.979
Validation loss decreased (inf --> -0.978626).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0018544
	speed: 0.5864s/iter; left time: 23917.9655s
	iters: 200, epoch: 2 | loss: 0.0028775
	speed: 0.2827s/iter; left time: 11501.7571s
	iters: 300, epoch: 2 | loss: 0.0409988
	speed: 0.2895s/iter; left time: 11748.4786s
	iters: 400, epoch: 2 | loss: 0.0001489
	speed: 0.2699s/iter; left time: 10926.6174s
Epoch: 2 cost time: 117.02207016944885
Epoch: 2, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.145 Vali Acc: 0.965 Test Loss: 0.145 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0247237
	speed: 0.5272s/iter; left time: 21284.6646s
	iters: 200, epoch: 3 | loss: 0.0414127
	speed: 0.2691s/iter; left time: 10839.3605s
	iters: 300, epoch: 3 | loss: 0.0892049
	speed: 0.2473s/iter; left time: 9934.0724s
	iters: 400, epoch: 3 | loss: 0.0082930
	speed: 0.2610s/iter; left time: 10461.0791s
Epoch: 3 cost time: 109.62245345115662
Epoch: 3, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.244 Vali Acc: 0.949 Test Loss: 0.244 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0527750
	speed: 0.5390s/iter; left time: 21540.3407s
	iters: 200, epoch: 4 | loss: 0.1470624
	speed: 0.2795s/iter; left time: 11141.7187s
	iters: 300, epoch: 4 | loss: 0.0000776
	speed: 0.2900s/iter; left time: 11530.9584s
	iters: 400, epoch: 4 | loss: 0.0000093
	speed: 0.2776s/iter; left time: 11011.3058s
Epoch: 4 cost time: 115.68848538398743
Epoch: 4, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.181 Vali Acc: 0.969 Test Loss: 0.181 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0003652
	speed: 0.5448s/iter; left time: 21547.8319s
	iters: 200, epoch: 5 | loss: 0.0000730
	speed: 0.2634s/iter; left time: 10391.9861s
	iters: 300, epoch: 5 | loss: 0.0000018
	speed: 0.2560s/iter; left time: 10074.2043s
	iters: 400, epoch: 5 | loss: 0.0000877
	speed: 0.2769s/iter; left time: 10867.2899s
Epoch: 5 cost time: 111.65537238121033
Epoch: 5, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.188 Vali Acc: 0.967 Test Loss: 0.188 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0001353
	speed: 0.5305s/iter; left time: 20761.6557s
	iters: 200, epoch: 6 | loss: 1.0065852
	speed: 0.2927s/iter; left time: 11426.4139s
	iters: 300, epoch: 6 | loss: 0.0228359
	speed: 0.2924s/iter; left time: 11383.3274s
	iters: 400, epoch: 6 | loss: 0.4491087
	speed: 0.2953s/iter; left time: 11468.2273s
Epoch: 6 cost time: 119.54734015464783
Epoch: 6, Steps: 413 | Train Loss: 0.125 Vali Loss: 0.397 Vali Acc: 0.940 Test Loss: 0.397 Test Acc: 0.940
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.7155282
	speed: 0.5612s/iter; left time: 21731.5268s
	iters: 200, epoch: 7 | loss: 0.0382636
	speed: 0.2824s/iter; left time: 10905.6154s
	iters: 300, epoch: 7 | loss: 0.0001332
	speed: 0.2801s/iter; left time: 10788.9151s
	iters: 400, epoch: 7 | loss: 0.0082941
	speed: 0.2706s/iter; left time: 10398.3305s
Epoch: 7 cost time: 115.33761501312256
Epoch: 7, Steps: 413 | Train Loss: 0.113 Vali Loss: 0.209 Vali Acc: 0.975 Test Loss: 0.209 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.3224292
	speed: 0.5557s/iter; left time: 21290.6026s
	iters: 200, epoch: 8 | loss: 0.1209564
	speed: 0.2927s/iter; left time: 11185.8338s
	iters: 300, epoch: 8 | loss: 0.0034733
	speed: 0.2877s/iter; left time: 10964.7202s
	iters: 400, epoch: 8 | loss: 0.5295687
	speed: 0.2987s/iter; left time: 11352.5764s
Epoch: 8 cost time: 120.40837240219116
Epoch: 8, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.304 Vali Acc: 0.968 Test Loss: 0.304 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.5576s/iter; left time: 21130.6736s
	iters: 200, epoch: 9 | loss: 0.0499555
	speed: 0.2932s/iter; left time: 11083.1764s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.2908s/iter; left time: 10962.1003s
	iters: 400, epoch: 9 | loss: 0.1453147
	speed: 0.2817s/iter; left time: 10592.8309s
Epoch: 9 cost time: 119.68149542808533
Epoch: 9, Steps: 413 | Train Loss: 0.113 Vali Loss: 0.194 Vali Acc: 0.971 Test Loss: 0.194 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.0224478
	speed: 0.5653s/iter; left time: 21189.2815s
	iters: 200, epoch: 10 | loss: 0.0008290
	speed: 0.2989s/iter; left time: 11175.6968s
	iters: 300, epoch: 10 | loss: 0.0622780
	speed: 0.2774s/iter; left time: 10341.4495s
	iters: 400, epoch: 10 | loss: 0.0000430
	speed: 0.2648s/iter; left time: 9847.5646s
Epoch: 10 cost time: 116.67370700836182
Epoch: 10, Steps: 413 | Train Loss: 0.124 Vali Loss: 0.201 Vali Acc: 0.970 Test Loss: 0.201 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.5444s/iter; left time: 20183.0237s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.2772s/iter; left time: 10246.5944s
	iters: 300, epoch: 11 | loss: 0.0000005
	speed: 0.2837s/iter; left time: 10460.0215s
	iters: 400, epoch: 11 | loss: 0.1450427
	speed: 0.2834s/iter; left time: 10421.1427s
Epoch: 11 cost time: 116.79803729057312
Epoch: 11, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.241 Vali Acc: 0.971 Test Loss: 0.241 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df256_ma28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9786266484765803
model parameter : 2980362
model size : 21.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df256_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8999249
	speed: 0.3047s/iter; left time: 12552.6354s
	iters: 200, epoch: 1 | loss: 0.0985263
	speed: 0.2416s/iter; left time: 9930.2908s
	iters: 300, epoch: 1 | loss: 0.0165319
	speed: 0.2640s/iter; left time: 10824.9713s
	iters: 400, epoch: 1 | loss: 0.1458086
	speed: 0.2716s/iter; left time: 11108.5969s
Epoch: 1 cost time: 111.93478631973267
Epoch: 1, Steps: 413 | Train Loss: 0.480 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
Validation loss decreased (inf --> -0.973169).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0016826
	speed: 0.5292s/iter; left time: 21587.0125s
	iters: 200, epoch: 2 | loss: 0.0412667
	speed: 0.3047s/iter; left time: 12395.6450s
	iters: 300, epoch: 2 | loss: 0.1218118
	speed: 0.2875s/iter; left time: 11667.8543s
	iters: 400, epoch: 2 | loss: 0.0248042
	speed: 0.2794s/iter; left time: 11311.1347s
Epoch: 2 cost time: 119.03273510932922
Epoch: 2, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.147 Vali Acc: 0.966 Test Loss: 0.147 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0689385
	speed: 0.5570s/iter; left time: 22488.0211s
	iters: 200, epoch: 3 | loss: 0.0003235
	speed: 0.2662s/iter; left time: 10720.0870s
	iters: 300, epoch: 3 | loss: 0.0667103
	speed: 0.2991s/iter; left time: 12017.3686s
	iters: 400, epoch: 3 | loss: 0.0136723
	speed: 0.2687s/iter; left time: 10768.9996s
Epoch: 3 cost time: 114.93526577949524
Epoch: 3, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.230 Vali Acc: 0.954 Test Loss: 0.230 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0048993
	speed: 0.5622s/iter; left time: 22468.1563s
	iters: 200, epoch: 4 | loss: 0.1379032
	speed: 0.2721s/iter; left time: 10846.5349s
	iters: 300, epoch: 4 | loss: 0.0657040
	speed: 0.2791s/iter; left time: 11099.0733s
	iters: 400, epoch: 4 | loss: 0.0056586
	speed: 0.2821s/iter; left time: 11189.4864s
Epoch: 4 cost time: 116.99371337890625
Epoch: 4, Steps: 413 | Train Loss: 0.122 Vali Loss: 0.194 Vali Acc: 0.956 Test Loss: 0.194 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0980870
	speed: 0.5205s/iter; left time: 20583.4125s
	iters: 200, epoch: 5 | loss: 0.0010149
	speed: 0.2988s/iter; left time: 11787.6127s
	iters: 300, epoch: 5 | loss: 0.0000151
	speed: 0.2764s/iter; left time: 10875.2081s
	iters: 400, epoch: 5 | loss: 0.0067576
	speed: 0.2573s/iter; left time: 10099.4990s
Epoch: 5 cost time: 113.14587140083313
Epoch: 5, Steps: 413 | Train Loss: 0.124 Vali Loss: 0.170 Vali Acc: 0.968 Test Loss: 0.170 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.7685028
	speed: 0.5595s/iter; left time: 21897.5006s
	iters: 200, epoch: 6 | loss: 0.0000068
	speed: 0.2625s/iter; left time: 10245.2891s
	iters: 300, epoch: 6 | loss: 0.0000730
	speed: 0.2662s/iter; left time: 10363.4812s
	iters: 400, epoch: 6 | loss: 0.0006313
	speed: 0.2624s/iter; left time: 10188.9878s
Epoch: 6 cost time: 111.44917273521423
Epoch: 6, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.320 Vali Acc: 0.954 Test Loss: 0.320 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0827242
	speed: 0.5560s/iter; left time: 21531.8220s
	iters: 200, epoch: 7 | loss: 0.0019185
	speed: 0.2992s/iter; left time: 11555.3654s
	iters: 300, epoch: 7 | loss: 0.0010518
	speed: 0.2719s/iter; left time: 10474.0889s
	iters: 400, epoch: 7 | loss: 1.1956780
	speed: 0.2901s/iter; left time: 11148.2327s
Epoch: 7 cost time: 119.08700752258301
Epoch: 7, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.248 Vali Acc: 0.965 Test Loss: 0.248 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.0000082
	speed: 0.5403s/iter; left time: 20697.3077s
	iters: 200, epoch: 8 | loss: 0.0000000
	speed: 0.2590s/iter; left time: 9898.1914s
	iters: 300, epoch: 8 | loss: 0.0000945
	speed: 0.2763s/iter; left time: 10531.2514s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.2674s/iter; left time: 10165.3624s
Epoch: 8 cost time: 111.92037558555603
Epoch: 8, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.303 Vali Acc: 0.958 Test Loss: 0.303 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.5606s/iter; left time: 21244.3950s
	iters: 200, epoch: 9 | loss: 0.0000199
	speed: 0.2869s/iter; left time: 10845.5312s
	iters: 300, epoch: 9 | loss: 0.0000017
	speed: 0.2838s/iter; left time: 10699.3746s
	iters: 400, epoch: 9 | loss: 0.2663189
	speed: 0.2891s/iter; left time: 10870.3442s
Epoch: 9 cost time: 120.28935122489929
Epoch: 9, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.503 Vali Acc: 0.945 Test Loss: 0.503 Test Acc: 0.945
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.0001049
	speed: 0.5554s/iter; left time: 20818.9775s
	iters: 200, epoch: 10 | loss: 0.0023215
	speed: 0.2673s/iter; left time: 9993.1108s
	iters: 300, epoch: 10 | loss: 0.0549315
	speed: 0.2746s/iter; left time: 10239.6832s
	iters: 400, epoch: 10 | loss: 0.0000006
	speed: 0.2806s/iter; left time: 10434.2648s
Epoch: 10 cost time: 115.17566347122192
Epoch: 10, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.276 Vali Acc: 0.960 Test Loss: 0.276 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.5591s/iter; left time: 20726.8049s
	iters: 200, epoch: 11 | loss: 0.0200317
	speed: 0.2769s/iter; left time: 10237.3480s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.2949s/iter; left time: 10873.7214s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.2867s/iter; left time: 10543.7318s
Epoch: 11 cost time: 119.86634087562561
Epoch: 11, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.541 Vali Acc: 0.945 Test Loss: 0.541 Test Acc: 0.945
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df256_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9731696225557072
model parameter : 2980362
model size : 21.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df256_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0943986
	speed: 0.2804s/iter; left time: 11551.6931s
	iters: 200, epoch: 1 | loss: 0.1274955
	speed: 0.2750s/iter; left time: 11302.4730s
	iters: 300, epoch: 1 | loss: 0.0834583
	speed: 0.2796s/iter; left time: 11462.2713s
	iters: 400, epoch: 1 | loss: 0.0768993
	speed: 0.2617s/iter; left time: 10703.3545s
Epoch: 1 cost time: 113.3603847026825
Epoch: 1, Steps: 413 | Train Loss: 0.590 Vali Loss: 0.094 Vali Acc: 0.971 Test Loss: 0.094 Test Acc: 0.971
Validation loss decreased (inf --> -0.971350).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0024969
	speed: 0.5357s/iter; left time: 21849.3552s
	iters: 200, epoch: 2 | loss: 0.0159474
	speed: 0.2722s/iter; left time: 11075.8246s
	iters: 300, epoch: 2 | loss: 0.4786365
	speed: 0.2739s/iter; left time: 11117.7793s
	iters: 400, epoch: 2 | loss: 0.0003943
	speed: 0.2601s/iter; left time: 10532.6079s
Epoch: 2 cost time: 111.08477878570557
Epoch: 2, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0050914
	speed: 0.5388s/iter; left time: 21752.5047s
	iters: 200, epoch: 3 | loss: 0.0000926
	speed: 0.2766s/iter; left time: 11139.7505s
	iters: 300, epoch: 3 | loss: 0.0001677
	speed: 0.2824s/iter; left time: 11344.9791s
	iters: 400, epoch: 3 | loss: 0.0229745
	speed: 0.2628s/iter; left time: 10531.2088s
Epoch: 3 cost time: 113.54220676422119
Epoch: 3, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.203 Vali Acc: 0.955 Test Loss: 0.203 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0003007
	speed: 0.5419s/iter; left time: 21654.4239s
	iters: 200, epoch: 4 | loss: 0.2413786
	speed: 0.2627s/iter; left time: 10470.2015s
	iters: 300, epoch: 4 | loss: 0.0113601
	speed: 0.2858s/iter; left time: 11362.1974s
	iters: 400, epoch: 4 | loss: 0.0246421
	speed: 0.2590s/iter; left time: 10272.1636s
Epoch: 4 cost time: 112.49681687355042
Epoch: 4, Steps: 413 | Train Loss: 0.114 Vali Loss: 0.174 Vali Acc: 0.964 Test Loss: 0.174 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0018244
	speed: 0.5276s/iter; left time: 20865.4370s
	iters: 200, epoch: 5 | loss: 0.4267748
	speed: 0.2752s/iter; left time: 10856.9665s
	iters: 300, epoch: 5 | loss: 0.1587082
	speed: 0.2840s/iter; left time: 11174.9628s
	iters: 400, epoch: 5 | loss: 0.0049437
	speed: 0.2714s/iter; left time: 10652.0752s
Epoch: 5 cost time: 115.04100704193115
Epoch: 5, Steps: 413 | Train Loss: 0.123 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
Validation loss decreased (-0.971350 --> -0.974987).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0008350
	speed: 0.5503s/iter; left time: 21536.8328s
	iters: 200, epoch: 6 | loss: 0.0000004
	speed: 0.2666s/iter; left time: 10406.7257s
	iters: 300, epoch: 6 | loss: 0.6375153
	speed: 0.2869s/iter; left time: 11170.5712s
	iters: 400, epoch: 6 | loss: 0.1157682
	speed: 0.2776s/iter; left time: 10779.8292s
Epoch: 6 cost time: 114.78063559532166
Epoch: 6, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.247 Vali Acc: 0.962 Test Loss: 0.247 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.7340722
	speed: 0.5289s/iter; left time: 20478.7688s
	iters: 200, epoch: 7 | loss: 0.0006237
	speed: 0.2728s/iter; left time: 10535.8169s
	iters: 300, epoch: 7 | loss: 0.1988118
	speed: 0.2825s/iter; left time: 10883.4954s
	iters: 400, epoch: 7 | loss: 0.6276863
	speed: 0.2766s/iter; left time: 10627.5230s
Epoch: 7 cost time: 115.09103846549988
Epoch: 7, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.437 Vali Acc: 0.951 Test Loss: 0.437 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000001
	speed: 0.5442s/iter; left time: 20849.1992s
	iters: 200, epoch: 8 | loss: 0.0074463
	speed: 0.2646s/iter; left time: 10110.4391s
	iters: 300, epoch: 8 | loss: 0.0000648
	speed: 0.2567s/iter; left time: 9784.7416s
	iters: 400, epoch: 8 | loss: 0.0000009
	speed: 0.2798s/iter; left time: 10636.6297s
Epoch: 8 cost time: 112.48229169845581
Epoch: 8, Steps: 413 | Train Loss: 0.128 Vali Loss: 0.143 Vali Acc: 0.974 Test Loss: 0.143 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.5314s/iter; left time: 20137.1007s
	iters: 200, epoch: 9 | loss: 0.0000475
	speed: 0.2716s/iter; left time: 10267.2904s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.2675s/iter; left time: 10085.4134s
	iters: 400, epoch: 9 | loss: 0.0793174
	speed: 0.2757s/iter; left time: 10366.6262s
Epoch: 9 cost time: 112.6480700969696
Epoch: 9, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.149 Vali Acc: 0.973 Test Loss: 0.149 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000209
	speed: 0.5040s/iter; left time: 18893.0220s
	iters: 200, epoch: 10 | loss: 0.1445632
	speed: 0.2711s/iter; left time: 10136.6574s
	iters: 300, epoch: 10 | loss: 0.0000238
	speed: 0.2761s/iter; left time: 10294.2075s
	iters: 400, epoch: 10 | loss: 0.0094752
	speed: 0.2882s/iter; left time: 10716.3613s
Epoch: 10 cost time: 114.48676776885986
Epoch: 10, Steps: 413 | Train Loss: 0.103 Vali Loss: 0.362 Vali Acc: 0.954 Test Loss: 0.362 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0002755
	speed: 0.5875s/iter; left time: 21778.5196s
	iters: 200, epoch: 11 | loss: 0.0000113
	speed: 0.2944s/iter; left time: 10884.0713s
	iters: 300, epoch: 11 | loss: 0.0000403
	speed: 0.2795s/iter; left time: 10307.1825s
	iters: 400, epoch: 11 | loss: 0.0000008
	speed: 0.2892s/iter; left time: 10632.3978s
Epoch: 11 cost time: 120.91830921173096
Epoch: 11, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.222 Vali Acc: 0.965 Test Loss: 0.222 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0125483
	speed: 0.5337s/iter; left time: 19563.1230s
	iters: 200, epoch: 12 | loss: 0.0000000
	speed: 0.2799s/iter; left time: 10232.4161s
	iters: 300, epoch: 12 | loss: 0.0002010
	speed: 0.2776s/iter; left time: 10122.3460s
	iters: 400, epoch: 12 | loss: 0.0003051
	speed: 0.2746s/iter; left time: 9982.4373s
Epoch: 12 cost time: 114.75773024559021
Epoch: 12, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.367 Vali Acc: 0.962 Test Loss: 0.367 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0026748
	speed: 0.5408s/iter; left time: 19602.1042s
	iters: 200, epoch: 13 | loss: 0.0057660
	speed: 0.2844s/iter; left time: 10279.4255s
	iters: 300, epoch: 13 | loss: 0.0017532
	speed: 0.2726s/iter; left time: 9826.7120s
	iters: 400, epoch: 13 | loss: 0.1074049
	speed: 0.2829s/iter; left time: 10168.2514s
Epoch: 13 cost time: 115.16125392913818
Epoch: 13, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.187 Vali Acc: 0.974 Test Loss: 0.187 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.5447s/iter; left time: 19516.9140s
	iters: 200, epoch: 14 | loss: 0.0021997
	speed: 0.2617s/iter; left time: 9349.7638s
	iters: 300, epoch: 14 | loss: 0.0318312
	speed: 0.2825s/iter; left time: 10064.3889s
	iters: 400, epoch: 14 | loss: 0.0014602
	speed: 0.2818s/iter; left time: 10012.2118s
Epoch: 14 cost time: 114.67612028121948
Epoch: 14, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.210 Vali Acc: 0.971 Test Loss: 0.210 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0064364
	speed: 0.5591s/iter; left time: 19803.6300s
	iters: 200, epoch: 15 | loss: 0.0000009
	speed: 0.2866s/iter; left time: 10122.7323s
	iters: 300, epoch: 15 | loss: 0.0000040
	speed: 0.2764s/iter; left time: 9736.2686s
	iters: 400, epoch: 15 | loss: 0.0032163
	speed: 0.2806s/iter; left time: 9853.1241s
Epoch: 15 cost time: 116.10708618164062
Epoch: 15, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.239 Vali Acc: 0.970 Test Loss: 0.239 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df256_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9749886311959982
model parameter : 2980362
model size : 21.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1229488
	speed: 0.2995s/iter; left time: 12337.6967s
	iters: 200, epoch: 1 | loss: 0.1319498
	speed: 0.2731s/iter; left time: 11226.4232s
	iters: 300, epoch: 1 | loss: 0.1290264
	speed: 0.2749s/iter; left time: 11271.3732s
	iters: 400, epoch: 1 | loss: 0.0543813
	speed: 0.2764s/iter; left time: 11305.3776s
Epoch: 1 cost time: 116.33017158508301
Epoch: 1, Steps: 413 | Train Loss: 0.619 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
Validation loss decreased (inf --> -0.970440).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0036972
	speed: 0.5541s/iter; left time: 22599.5976s
	iters: 200, epoch: 2 | loss: 0.2135785
	speed: 0.2845s/iter; left time: 11575.2616s
	iters: 300, epoch: 2 | loss: 0.0117740
	speed: 0.2900s/iter; left time: 11769.2568s
	iters: 400, epoch: 2 | loss: 0.0622853
	speed: 0.2857s/iter; left time: 11568.1300s
Epoch: 2 cost time: 119.05449151992798
Epoch: 2, Steps: 413 | Train Loss: 0.109 Vali Loss: 0.132 Vali Acc: 0.966 Test Loss: 0.132 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0002519
	speed: 0.5382s/iter; left time: 21730.0287s
	iters: 200, epoch: 3 | loss: 0.0001583
	speed: 0.2702s/iter; left time: 10881.3567s
	iters: 300, epoch: 3 | loss: 0.1393505
	speed: 0.2826s/iter; left time: 11353.1720s
	iters: 400, epoch: 3 | loss: 0.2767199
	speed: 0.2736s/iter; left time: 10964.2748s
Epoch: 3 cost time: 114.55797719955444
Epoch: 3, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.194 Vali Acc: 0.960 Test Loss: 0.194 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.5185313
	speed: 0.5593s/iter; left time: 22348.7521s
	iters: 200, epoch: 4 | loss: 0.0124036
	speed: 0.2747s/iter; left time: 10949.5614s
	iters: 300, epoch: 4 | loss: 0.0007467
	speed: 0.2872s/iter; left time: 11418.1984s
	iters: 400, epoch: 4 | loss: 0.0098457
	speed: 0.2931s/iter; left time: 11624.1935s
Epoch: 4 cost time: 118.41554141044617
Epoch: 4, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.149 Vali Acc: 0.970 Test Loss: 0.149 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0005524
	speed: 0.5692s/iter; left time: 22511.0636s
	iters: 200, epoch: 5 | loss: 0.0006383
	speed: 0.3055s/iter; left time: 12052.7724s
	iters: 300, epoch: 5 | loss: 1.0595630
	speed: 0.2842s/iter; left time: 11181.2424s
	iters: 400, epoch: 5 | loss: 0.0000043
	speed: 0.2629s/iter; left time: 10317.2361s
Epoch: 5 cost time: 118.02403807640076
Epoch: 5, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.205 Vali Acc: 0.965 Test Loss: 0.205 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.4706937
	speed: 0.5289s/iter; left time: 20699.2562s
	iters: 200, epoch: 6 | loss: 0.0000582
	speed: 0.2844s/iter; left time: 11103.2938s
	iters: 300, epoch: 6 | loss: 0.0243598
	speed: 0.2805s/iter; left time: 10922.3217s
	iters: 400, epoch: 6 | loss: 0.0018640
	speed: 0.2794s/iter; left time: 10850.7463s
Epoch: 6 cost time: 116.80377578735352
Epoch: 6, Steps: 413 | Train Loss: 0.142 Vali Loss: 0.172 Vali Acc: 0.969 Test Loss: 0.172 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.3301868
	speed: 0.5581s/iter; left time: 21612.1099s
	iters: 200, epoch: 7 | loss: 0.0000021
	speed: 0.2848s/iter; left time: 10999.6986s
	iters: 300, epoch: 7 | loss: 0.0001289
	speed: 0.2826s/iter; left time: 10886.9081s
	iters: 400, epoch: 7 | loss: 0.6734294
	speed: 0.2896s/iter; left time: 11125.8147s
Epoch: 7 cost time: 117.76527953147888
Epoch: 7, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.217 Vali Acc: 0.966 Test Loss: 0.217 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.0041726
	speed: 0.5296s/iter; left time: 20287.6907s
	iters: 200, epoch: 8 | loss: 0.0000003
	speed: 0.2771s/iter; left time: 10588.4385s
	iters: 300, epoch: 8 | loss: 0.0957767
	speed: 0.2687s/iter; left time: 10240.4029s
	iters: 400, epoch: 8 | loss: 0.0120700
	speed: 0.2778s/iter; left time: 10559.3479s
Epoch: 8 cost time: 113.32308793067932
Epoch: 8, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.165 Vali Acc: 0.974 Test Loss: 0.165 Test Acc: 0.974
Validation loss decreased (-0.970440 --> -0.974077).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000004
	speed: 0.5692s/iter; left time: 21571.9897s
	iters: 200, epoch: 9 | loss: 0.0001584
	speed: 0.2869s/iter; left time: 10842.7039s
	iters: 300, epoch: 9 | loss: 0.0009410
	speed: 0.2711s/iter; left time: 10220.9567s
	iters: 400, epoch: 9 | loss: 0.0000084
	speed: 0.2609s/iter; left time: 9810.4481s
Epoch: 9 cost time: 114.52710723876953
Epoch: 9, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.311 Vali Acc: 0.957 Test Loss: 0.311 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000022
	speed: 0.5361s/iter; left time: 20093.7750s
	iters: 200, epoch: 10 | loss: 0.3418063
	speed: 0.2779s/iter; left time: 10389.6260s
	iters: 300, epoch: 10 | loss: 1.2180979
	speed: 0.2742s/iter; left time: 10224.6467s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.2744s/iter; left time: 10204.1518s
Epoch: 10 cost time: 114.14613771438599
Epoch: 10, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.256 Vali Acc: 0.960 Test Loss: 0.256 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0022130
	speed: 0.5328s/iter; left time: 19749.5772s
	iters: 200, epoch: 11 | loss: 0.0000001
	speed: 0.2717s/iter; left time: 10043.8366s
	iters: 300, epoch: 11 | loss: 0.0000066
	speed: 0.2741s/iter; left time: 10105.7151s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.2728s/iter; left time: 10032.2424s
Epoch: 11 cost time: 112.55034494400024
Epoch: 11, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.321 Vali Acc: 0.961 Test Loss: 0.321 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000312
	speed: 0.5424s/iter; left time: 19883.1580s
	iters: 200, epoch: 12 | loss: 0.0000002
	speed: 0.2754s/iter; left time: 10066.9599s
	iters: 300, epoch: 12 | loss: 0.0001407
	speed: 0.2649s/iter; left time: 9656.7067s
	iters: 400, epoch: 12 | loss: 0.2830668
	speed: 0.2605s/iter; left time: 9469.5282s
Epoch: 12 cost time: 111.33036160469055
Epoch: 12, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.283 Vali Acc: 0.962 Test Loss: 0.283 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000362
	speed: 0.5258s/iter; left time: 19057.4814s
	iters: 200, epoch: 13 | loss: 0.0000061
	speed: 0.2688s/iter; left time: 9715.1090s
	iters: 300, epoch: 13 | loss: 0.0000140
	speed: 0.2719s/iter; left time: 9799.8387s
	iters: 400, epoch: 13 | loss: 1.3971626
	speed: 0.2805s/iter; left time: 10082.7773s
Epoch: 13 cost time: 113.62985467910767
Epoch: 13, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.181 Vali Acc: 0.972 Test Loss: 0.181 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0000002
	speed: 0.5411s/iter; left time: 19386.9202s
	iters: 200, epoch: 14 | loss: 0.6117702
	speed: 0.2744s/iter; left time: 9805.2007s
	iters: 300, epoch: 14 | loss: 0.0000001
	speed: 0.2685s/iter; left time: 9566.6120s
	iters: 400, epoch: 14 | loss: 0.0000312
	speed: 0.2669s/iter; left time: 9483.6373s
Epoch: 14 cost time: 112.59509944915771
Epoch: 14, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.461 Vali Acc: 0.945 Test Loss: 0.461 Test Acc: 0.945
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0405886
	speed: 0.5269s/iter; left time: 18661.7566s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.2649s/iter; left time: 9355.2799s
	iters: 300, epoch: 15 | loss: 0.1409459
	speed: 0.2603s/iter; left time: 9168.9213s
	iters: 400, epoch: 15 | loss: 0.0000336
	speed: 0.2738s/iter; left time: 9614.4166s
Epoch: 15 cost time: 110.58581066131592
Epoch: 15, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.182 Vali Acc: 0.977 Test Loss: 0.182 Test Acc: 0.977
Validation loss decreased (-0.974077 --> -0.976806).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0001003
	speed: 0.5306s/iter; left time: 18573.9191s
	iters: 200, epoch: 16 | loss: 1.7564570
	speed: 0.2793s/iter; left time: 9748.9265s
	iters: 300, epoch: 16 | loss: 0.0032776
	speed: 0.2753s/iter; left time: 9582.9593s
	iters: 400, epoch: 16 | loss: 0.0000340
	speed: 0.2751s/iter; left time: 9546.8185s
Epoch: 16 cost time: 113.42526197433472
Epoch: 16, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.237 Vali Acc: 0.969 Test Loss: 0.237 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0053735
	speed: 0.5311s/iter; left time: 18372.1997s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.2755s/iter; left time: 9502.6101s
	iters: 300, epoch: 17 | loss: 0.0613884
	speed: 0.2617s/iter; left time: 9001.2087s
	iters: 400, epoch: 17 | loss: 0.0061320
	speed: 0.2676s/iter; left time: 9175.8325s
Epoch: 17 cost time: 110.6722662448883
Epoch: 17, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.198 Vali Acc: 0.971 Test Loss: 0.198 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.1815797
	speed: 0.5491s/iter; left time: 18767.6939s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.2846s/iter; left time: 9698.2465s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.2928s/iter; left time: 9949.8417s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.2757s/iter; left time: 9342.0531s
Epoch: 18 cost time: 117.27596402168274
Epoch: 18, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.219 Vali Acc: 0.968 Test Loss: 0.219 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.6319392
	speed: 0.5520s/iter; left time: 18640.2204s
	iters: 200, epoch: 19 | loss: 0.0027929
	speed: 0.2845s/iter; left time: 9578.0270s
	iters: 300, epoch: 19 | loss: 0.0000010
	speed: 0.2881s/iter; left time: 9670.8181s
	iters: 400, epoch: 19 | loss: 0.0049701
	speed: 0.2756s/iter; left time: 9224.5552s
Epoch: 19 cost time: 117.45911455154419
Epoch: 19, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.247 Vali Acc: 0.973 Test Loss: 0.247 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.1817538
	speed: 0.5623s/iter; left time: 18755.6394s
	iters: 200, epoch: 20 | loss: 1.5283452
	speed: 0.2801s/iter; left time: 9315.1838s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.2897s/iter; left time: 9603.2980s
	iters: 400, epoch: 20 | loss: 0.0000001
	speed: 0.2725s/iter; left time: 9008.0459s
Epoch: 20 cost time: 116.78120565414429
Epoch: 20, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.184 Vali Acc: 0.973 Test Loss: 0.184 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0000010
	speed: 0.5466s/iter; left time: 18005.8455s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.2716s/iter; left time: 8919.5510s
	iters: 300, epoch: 21 | loss: 0.0000502
	speed: 0.2589s/iter; left time: 8475.5527s
	iters: 400, epoch: 21 | loss: 0.0001452
	speed: 0.2797s/iter; left time: 9131.0377s
Epoch: 21 cost time: 113.35911417007446
Epoch: 21, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.243 Vali Acc: 0.972 Test Loss: 0.243 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0000011
	speed: 0.5483s/iter; left time: 17835.6341s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.2894s/iter; left time: 9385.3383s
	iters: 300, epoch: 22 | loss: 0.0017752
	speed: 0.2869s/iter; left time: 9273.4127s
	iters: 400, epoch: 22 | loss: 0.3617535
	speed: 0.2775s/iter; left time: 8943.9390s
Epoch: 22 cost time: 117.6525092124939
Epoch: 22, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.333 Vali Acc: 0.969 Test Loss: 0.333 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0000001
	speed: 0.5743s/iter; left time: 18444.8316s
	iters: 200, epoch: 23 | loss: 0.0000014
	speed: 0.2831s/iter; left time: 9061.8652s
	iters: 300, epoch: 23 | loss: 0.0008018
	speed: 0.2820s/iter; left time: 8999.1111s
	iters: 400, epoch: 23 | loss: 0.0000023
	speed: 0.2620s/iter; left time: 8334.6152s
Epoch: 23 cost time: 115.73490238189697
Epoch: 23, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.196 Vali Acc: 0.977 Test Loss: 0.196 Test Acc: 0.977
Validation loss decreased (-0.976806 --> -0.977260).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000039
	speed: 0.5285s/iter; left time: 16754.5841s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.2828s/iter; left time: 8937.6801s
	iters: 300, epoch: 24 | loss: 0.0000028
	speed: 0.2827s/iter; left time: 8904.9613s
	iters: 400, epoch: 24 | loss: 0.0000036
	speed: 0.2864s/iter; left time: 8992.4446s
Epoch: 24 cost time: 118.01632070541382
Epoch: 24, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.181 Vali Acc: 0.975 Test Loss: 0.181 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0014286
	speed: 0.5478s/iter; left time: 17141.4457s
	iters: 200, epoch: 25 | loss: 0.0000328
	speed: 0.2964s/iter; left time: 9244.6075s
	iters: 300, epoch: 25 | loss: 0.4002685
	speed: 0.2818s/iter; left time: 8762.3887s
	iters: 400, epoch: 25 | loss: 0.2649450
	speed: 0.2927s/iter; left time: 9071.3433s
Epoch: 25 cost time: 120.02946472167969
Epoch: 25, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.334 Vali Acc: 0.969 Test Loss: 0.334 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0020925
	speed: 0.5641s/iter; left time: 17417.6114s
	iters: 200, epoch: 26 | loss: 0.0000039
	speed: 0.2678s/iter; left time: 8242.1351s
	iters: 300, epoch: 26 | loss: 0.0000017
	speed: 0.2779s/iter; left time: 8523.7073s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.2644s/iter; left time: 8084.7749s
Epoch: 26 cost time: 112.88857293128967
Epoch: 26, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.104 Vali Acc: 0.982 Test Loss: 0.104 Test Acc: 0.982
Validation loss decreased (-0.977260 --> -0.981809).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0058720
	speed: 0.5407s/iter; left time: 16470.3050s
	iters: 200, epoch: 27 | loss: 0.0057039
	speed: 0.2779s/iter; left time: 8438.8676s
	iters: 300, epoch: 27 | loss: 0.0000001
	speed: 0.2692s/iter; left time: 8147.3304s
	iters: 400, epoch: 27 | loss: 0.0001679
	speed: 0.2953s/iter; left time: 8905.8289s
Epoch: 27 cost time: 116.55094766616821
Epoch: 27, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.220 Vali Acc: 0.969 Test Loss: 0.220 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0000863
	speed: 0.5371s/iter; left time: 16141.1844s
	iters: 200, epoch: 28 | loss: 0.0056623
	speed: 0.2948s/iter; left time: 8827.9277s
	iters: 300, epoch: 28 | loss: 0.0001330
	speed: 0.2785s/iter; left time: 8314.3473s
	iters: 400, epoch: 28 | loss: 0.0000584
	speed: 0.2713s/iter; left time: 8072.5443s
Epoch: 28 cost time: 115.7915267944336
Epoch: 28, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.250 Vali Acc: 0.965 Test Loss: 0.250 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.5300s/iter; left time: 15707.8260s
	iters: 200, epoch: 29 | loss: 0.0000001
	speed: 0.2564s/iter; left time: 7572.8582s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.2804s/iter; left time: 8253.9813s
	iters: 400, epoch: 29 | loss: 0.0000052
	speed: 0.2793s/iter; left time: 8195.1817s
Epoch: 29 cost time: 111.12885999679565
Epoch: 29, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.261 Vali Acc: 0.972 Test Loss: 0.261 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.5379s/iter; left time: 15720.1547s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.2863s/iter; left time: 8338.2541s
	iters: 300, epoch: 30 | loss: 0.0018330
	speed: 0.2688s/iter; left time: 7800.8645s
	iters: 400, epoch: 30 | loss: 0.0000319
	speed: 0.2702s/iter; left time: 7814.8304s
Epoch: 30 cost time: 114.83745694160461
Epoch: 30, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.210 Vali Acc: 0.965 Test Loss: 0.210 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0000009
	speed: 0.4990s/iter; left time: 14376.8625s
	iters: 200, epoch: 31 | loss: 0.0030079
	speed: 0.2708s/iter; left time: 7774.6049s
	iters: 300, epoch: 31 | loss: 0.0000980
	speed: 0.2800s/iter; left time: 8010.1517s
	iters: 400, epoch: 31 | loss: 0.0002037
	speed: 0.2737s/iter; left time: 7804.2159s
Epoch: 31 cost time: 111.50116872787476
Epoch: 31, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.182 Vali Acc: 0.974 Test Loss: 0.182 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.5589s/iter; left time: 15872.2213s
	iters: 200, epoch: 32 | loss: 0.0000519
	speed: 0.2834s/iter; left time: 8020.0251s
	iters: 300, epoch: 32 | loss: 0.0000080
	speed: 0.2783s/iter; left time: 7848.3981s
	iters: 400, epoch: 32 | loss: 0.0000028
	speed: 0.2839s/iter; left time: 7977.4397s
Epoch: 32 cost time: 116.7628607749939
Epoch: 32, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.981809 --> -0.983173).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.5043s/iter; left time: 14111.6662s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.2833s/iter; left time: 7901.0724s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.2587s/iter; left time: 7186.8160s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.2623s/iter; left time: 7260.8041s
Epoch: 33 cost time: 109.98324847221375
Epoch: 33, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.162 Vali Acc: 0.979 Test Loss: 0.162 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 0.0001636
	speed: 0.5288s/iter; left time: 14581.0594s
	iters: 200, epoch: 34 | loss: 0.0423479
	speed: 0.2457s/iter; left time: 6750.9810s
	iters: 300, epoch: 34 | loss: 0.0003337
	speed: 0.2759s/iter; left time: 7553.1757s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.2767s/iter; left time: 7545.4760s
Epoch: 34 cost time: 108.91610288619995
Epoch: 34, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.133 Vali Acc: 0.981 Test Loss: 0.133 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 0.0000921
	speed: 0.5201s/iter; left time: 14124.2691s
	iters: 200, epoch: 35 | loss: 1.4485447
	speed: 0.2825s/iter; left time: 7643.2248s
	iters: 300, epoch: 35 | loss: 0.0069367
	speed: 0.2695s/iter; left time: 7265.1782s
	iters: 400, epoch: 35 | loss: 0.0000123
	speed: 0.2801s/iter; left time: 7521.8732s
Epoch: 35 cost time: 115.27845215797424
Epoch: 35, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.096 Vali Acc: 0.982 Test Loss: 0.096 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 36 | loss: 0.0000098
	speed: 0.5311s/iter; left time: 14205.6637s
	iters: 200, epoch: 36 | loss: 0.0000342
	speed: 0.2764s/iter; left time: 7364.9293s
	iters: 300, epoch: 36 | loss: 0.0000004
	speed: 0.2713s/iter; left time: 7201.5110s
	iters: 400, epoch: 36 | loss: 0.0348563
	speed: 0.2591s/iter; left time: 6851.1879s
Epoch: 36 cost time: 111.27728390693665
Epoch: 36, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.197 Vali Acc: 0.971 Test Loss: 0.197 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 37 | loss: 0.0002071
	speed: 0.5520s/iter; left time: 14536.3498s
	iters: 200, epoch: 37 | loss: 0.0000378
	speed: 0.2638s/iter; left time: 6921.1155s
	iters: 300, epoch: 37 | loss: 0.0000002
	speed: 0.2820s/iter; left time: 7370.7859s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.2843s/iter; left time: 7400.2994s
Epoch: 37 cost time: 115.42861080169678
Epoch: 37, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.091 Vali Acc: 0.981 Test Loss: 0.091 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 38 | loss: 0.0023401
	speed: 0.5118s/iter; left time: 13265.6788s
	iters: 200, epoch: 38 | loss: 0.0000002
	speed: 0.2490s/iter; left time: 6428.7833s
	iters: 300, epoch: 38 | loss: 0.0000020
	speed: 0.2800s/iter; left time: 7202.6330s
	iters: 400, epoch: 38 | loss: 0.0000047
	speed: 0.2482s/iter; left time: 6358.8660s
Epoch: 38 cost time: 107.532883644104
Epoch: 38, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.128 Vali Acc: 0.981 Test Loss: 0.128 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 39 | loss: 0.0000001
	speed: 0.5267s/iter; left time: 13435.5977s
	iters: 200, epoch: 39 | loss: 0.0000300
	speed: 0.2604s/iter; left time: 6616.0594s
	iters: 300, epoch: 39 | loss: 0.0000735
	speed: 0.2964s/iter; left time: 7500.1801s
	iters: 400, epoch: 39 | loss: 0.0000010
	speed: 0.2766s/iter; left time: 6971.0452s
Epoch: 39 cost time: 114.88581156730652
Epoch: 39, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.147 Vali Acc: 0.981 Test Loss: 0.147 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 40 | loss: 0.0000104
	speed: 0.5487s/iter; left time: 13770.0620s
	iters: 200, epoch: 40 | loss: 0.0000000
	speed: 0.2659s/iter; left time: 6644.9263s
	iters: 300, epoch: 40 | loss: 0.0000008
	speed: 0.2839s/iter; left time: 7066.2748s
	iters: 400, epoch: 40 | loss: 0.0002217
	speed: 0.2805s/iter; left time: 6953.9058s
Epoch: 40 cost time: 115.35290813446045
Epoch: 40, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.141 Vali Acc: 0.985 Test Loss: 0.141 Test Acc: 0.985
Validation loss decreased (-0.983173 --> -0.984537).  Saving model ...
	iters: 100, epoch: 41 | loss: 0.0000037
	speed: 0.5527s/iter; left time: 13640.7380s
	iters: 200, epoch: 41 | loss: 0.0001347
	speed: 0.2736s/iter; left time: 6725.9132s
	iters: 300, epoch: 41 | loss: 0.0000098
	speed: 0.2867s/iter; left time: 7017.9710s
	iters: 400, epoch: 41 | loss: 0.0000001
	speed: 0.2703s/iter; left time: 6589.4261s
Epoch: 41 cost time: 115.12834644317627
Epoch: 41, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.145 Vali Acc: 0.978 Test Loss: 0.145 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 42 | loss: 0.0000286
	speed: 0.5477s/iter; left time: 13290.7474s
	iters: 200, epoch: 42 | loss: 0.0000000
	speed: 0.2789s/iter; left time: 6741.1276s
	iters: 300, epoch: 42 | loss: 0.0000001
	speed: 0.2878s/iter; left time: 6926.5448s
	iters: 400, epoch: 42 | loss: 0.0000100
	speed: 0.2745s/iter; left time: 6579.0262s
Epoch: 42 cost time: 116.29561877250671
Epoch: 42, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.141 Vali Acc: 0.975 Test Loss: 0.141 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 43 | loss: 0.0000003
	speed: 0.5307s/iter; left time: 12659.8643s
	iters: 200, epoch: 43 | loss: 0.0000014
	speed: 0.2890s/iter; left time: 6864.8860s
	iters: 300, epoch: 43 | loss: 0.0000136
	speed: 0.2943s/iter; left time: 6962.4004s
	iters: 400, epoch: 43 | loss: 0.0000870
	speed: 0.2790s/iter; left time: 6572.4946s
Epoch: 43 cost time: 117.52179479598999
Epoch: 43, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.141 Vali Acc: 0.975 Test Loss: 0.141 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 44 | loss: 0.0000980
	speed: 0.5516s/iter; left time: 12929.5681s
	iters: 200, epoch: 44 | loss: 0.0000044
	speed: 0.2835s/iter; left time: 6617.3317s
	iters: 300, epoch: 44 | loss: 0.0000054
	speed: 0.2789s/iter; left time: 6481.3737s
	iters: 400, epoch: 44 | loss: 0.0000041
	speed: 0.2714s/iter; left time: 6281.1524s
Epoch: 44 cost time: 115.46816778182983
Epoch: 44, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.113 Vali Acc: 0.979 Test Loss: 0.113 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 45 | loss: 0.0001393
	speed: 0.5671s/iter; left time: 13059.4018s
	iters: 200, epoch: 45 | loss: 0.0001823
	speed: 0.2813s/iter; left time: 6449.0499s
	iters: 300, epoch: 45 | loss: 0.0000513
	speed: 0.2885s/iter; left time: 6586.4437s
	iters: 400, epoch: 45 | loss: 0.0000011
	speed: 0.2809s/iter; left time: 6385.2465s
Epoch: 45 cost time: 117.72909426689148
Epoch: 45, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.059 Vali Acc: 0.986 Test Loss: 0.059 Test Acc: 0.986
Validation loss decreased (-0.984537 --> -0.985902).  Saving model ...
	iters: 100, epoch: 46 | loss: 0.0000000
	speed: 0.5419s/iter; left time: 12255.6033s
	iters: 200, epoch: 46 | loss: 0.0002775
	speed: 0.2803s/iter; left time: 6311.3407s
	iters: 300, epoch: 46 | loss: 0.0000000
	speed: 0.2827s/iter; left time: 6336.8565s
	iters: 400, epoch: 46 | loss: 0.0000095
	speed: 0.2872s/iter; left time: 6409.8063s
Epoch: 46 cost time: 116.3048403263092
Epoch: 46, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 47 | loss: 0.0005016
	speed: 0.5874s/iter; left time: 13041.4052s
	iters: 200, epoch: 47 | loss: 0.0000037
	speed: 0.2746s/iter; left time: 6070.4124s
	iters: 300, epoch: 47 | loss: 0.0008488
	speed: 0.2814s/iter; left time: 6192.3027s
	iters: 400, epoch: 47 | loss: 0.0000000
	speed: 0.2878s/iter; left time: 6304.7519s
Epoch: 47 cost time: 117.81857919692993
Epoch: 47, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.128 Vali Acc: 0.974 Test Loss: 0.128 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 48 | loss: 0.0000082
	speed: 0.5536s/iter; left time: 12063.7584s
	iters: 200, epoch: 48 | loss: 0.0000223
	speed: 0.2841s/iter; left time: 6161.9876s
	iters: 300, epoch: 48 | loss: 0.0010782
	speed: 0.2859s/iter; left time: 6173.0746s
	iters: 400, epoch: 48 | loss: 0.0000012
	speed: 0.2912s/iter; left time: 6256.9217s
Epoch: 48 cost time: 118.01192712783813
Epoch: 48, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 49 | loss: 0.0000010
	speed: 0.5622s/iter; left time: 12018.0403s
	iters: 200, epoch: 49 | loss: 0.0000004
	speed: 0.2809s/iter; left time: 5976.9746s
	iters: 300, epoch: 49 | loss: 0.0000000
	speed: 0.2739s/iter; left time: 5800.8286s
	iters: 400, epoch: 49 | loss: 0.0002212
	speed: 0.2783s/iter; left time: 5864.6961s
Epoch: 49 cost time: 115.08385610580444
Epoch: 49, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.984 Test Loss: 0.089 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 50 | loss: 0.0000001
	speed: 0.5723s/iter; left time: 11996.7521s
	iters: 200, epoch: 50 | loss: 0.0000014
	speed: 0.2891s/iter; left time: 6031.0358s
	iters: 300, epoch: 50 | loss: 0.0000007
	speed: 0.2735s/iter; left time: 5679.4566s
	iters: 400, epoch: 50 | loss: 0.0003725
	speed: 0.2739s/iter; left time: 5660.5222s
Epoch: 50 cost time: 116.89825224876404
Epoch: 50, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.982 Test Loss: 0.090 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 51 | loss: 0.0148243
	speed: 0.5612s/iter; left time: 11533.2762s
	iters: 200, epoch: 51 | loss: 0.0000006
	speed: 0.2928s/iter; left time: 5988.4745s
	iters: 300, epoch: 51 | loss: 0.0010077
	speed: 0.2868s/iter; left time: 5837.4596s
	iters: 400, epoch: 51 | loss: 0.0025262
	speed: 0.2889s/iter; left time: 5851.0033s
Epoch: 51 cost time: 119.16015195846558
Epoch: 51, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 52 | loss: 0.0000009
	speed: 0.5416s/iter; left time: 10906.7158s
	iters: 200, epoch: 52 | loss: 0.0000070
	speed: 0.2906s/iter; left time: 5823.8587s
	iters: 300, epoch: 52 | loss: 0.0000000
	speed: 0.2815s/iter; left time: 5611.8456s
	iters: 400, epoch: 52 | loss: 0.0000020
	speed: 0.2741s/iter; left time: 5437.0265s
Epoch: 52 cost time: 116.83171129226685
Epoch: 52, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 53 | loss: 0.0000649
	speed: 0.5738s/iter; left time: 11318.9681s
	iters: 200, epoch: 53 | loss: 0.0000001
	speed: 0.2855s/iter; left time: 5603.5565s
	iters: 300, epoch: 53 | loss: 0.2860701
	speed: 0.2954s/iter; left time: 5768.3728s
	iters: 400, epoch: 53 | loss: 0.0000002
	speed: 0.2719s/iter; left time: 5281.2246s
Epoch: 53 cost time: 118.50358247756958
Epoch: 53, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.156 Vali Acc: 0.972 Test Loss: 0.156 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 54 | loss: 0.0000004
	speed: 0.5427s/iter; left time: 10480.5112s
	iters: 200, epoch: 54 | loss: 0.0205487
	speed: 0.2832s/iter; left time: 5441.4970s
	iters: 300, epoch: 54 | loss: 0.0000000
	speed: 0.2842s/iter; left time: 5431.0554s
	iters: 400, epoch: 54 | loss: 0.0000000
	speed: 0.2865s/iter; left time: 5447.3115s
Epoch: 54 cost time: 116.11122059822083
Epoch: 54, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.116 Vali Acc: 0.979 Test Loss: 0.116 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 55 | loss: 0.0008138
	speed: 0.5527s/iter; left time: 10444.6641s
	iters: 200, epoch: 55 | loss: 0.0035002
	speed: 0.2772s/iter; left time: 5210.8674s
	iters: 300, epoch: 55 | loss: 0.0000004
	speed: 0.2882s/iter; left time: 5388.4323s
	iters: 400, epoch: 55 | loss: 0.0104584
	speed: 0.2686s/iter; left time: 4996.3233s
Epoch: 55 cost time: 115.6015772819519
Epoch: 55, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.214 Vali Acc: 0.971 Test Loss: 0.214 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9859026830377444
model parameter : 2980362
model size : 21.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1333553
	speed: 0.3033s/iter; left time: 12496.9508s
	iters: 200, epoch: 1 | loss: 0.0874285
	speed: 0.2859s/iter; left time: 11750.7735s
	iters: 300, epoch: 1 | loss: 0.0736304
	speed: 0.3041s/iter; left time: 12466.6963s
	iters: 400, epoch: 1 | loss: 0.1017783
	speed: 0.2615s/iter; left time: 10694.9528s
Epoch: 1 cost time: 118.96766567230225
Epoch: 1, Steps: 413 | Train Loss: 0.608 Vali Loss: 0.108 Vali Acc: 0.966 Test Loss: 0.108 Test Acc: 0.966
Validation loss decreased (inf --> -0.965893).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0019893
	speed: 0.5514s/iter; left time: 22490.8111s
	iters: 200, epoch: 2 | loss: 0.1812141
	speed: 0.2743s/iter; left time: 11158.7554s
	iters: 300, epoch: 2 | loss: 0.3479478
	speed: 0.2804s/iter; left time: 11382.7423s
	iters: 400, epoch: 2 | loss: 0.0005827
	speed: 0.3038s/iter; left time: 12300.9904s
Epoch: 2 cost time: 118.92825818061829
Epoch: 2, Steps: 413 | Train Loss: 0.125 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1404126
	speed: 0.5395s/iter; left time: 21781.2902s
	iters: 200, epoch: 3 | loss: 0.0064457
	speed: 0.2726s/iter; left time: 10978.2180s
	iters: 300, epoch: 3 | loss: 0.0000552
	speed: 0.2981s/iter; left time: 11977.5137s
	iters: 400, epoch: 3 | loss: 0.0287704
	speed: 0.2770s/iter; left time: 11102.5926s
Epoch: 3 cost time: 117.80863738059998
Epoch: 3, Steps: 413 | Train Loss: 0.110 Vali Loss: 0.250 Vali Acc: 0.947 Test Loss: 0.250 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.1033613
	speed: 0.5525s/iter; left time: 22079.5548s
	iters: 200, epoch: 4 | loss: 0.0890387
	speed: 0.2891s/iter; left time: 11522.2970s
	iters: 300, epoch: 4 | loss: 0.0002450
	speed: 0.2674s/iter; left time: 10631.3579s
	iters: 400, epoch: 4 | loss: 0.0006432
	speed: 0.2954s/iter; left time: 11717.1947s
Epoch: 4 cost time: 116.99223518371582
Epoch: 4, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.137 Vali Acc: 0.969 Test Loss: 0.137 Test Acc: 0.969
Validation loss decreased (-0.965893 --> -0.969075).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0038268
	speed: 0.5610s/iter; left time: 22186.2086s
	iters: 200, epoch: 5 | loss: 0.0370672
	speed: 0.2858s/iter; left time: 11274.3458s
	iters: 300, epoch: 5 | loss: 0.0664234
	speed: 0.2935s/iter; left time: 11550.4364s
	iters: 400, epoch: 5 | loss: 0.7228311
	speed: 0.2630s/iter; left time: 10323.1641s
Epoch: 5 cost time: 118.47037410736084
Epoch: 5, Steps: 413 | Train Loss: 0.122 Vali Loss: 0.238 Vali Acc: 0.962 Test Loss: 0.238 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0049421
	speed: 0.5437s/iter; left time: 21277.1589s
	iters: 200, epoch: 6 | loss: 0.1917264
	speed: 0.3045s/iter; left time: 11885.5652s
	iters: 300, epoch: 6 | loss: 0.0004511
	speed: 0.2825s/iter; left time: 10999.6862s
	iters: 400, epoch: 6 | loss: 0.0027607
	speed: 0.3048s/iter; left time: 11836.4411s
Epoch: 6 cost time: 119.28542423248291
Epoch: 6, Steps: 413 | Train Loss: 0.103 Vali Loss: 0.166 Vali Acc: 0.969 Test Loss: 0.166 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.6708575
	speed: 0.5658s/iter; left time: 21910.8491s
	iters: 200, epoch: 7 | loss: 0.0006540
	speed: 0.2977s/iter; left time: 11496.7076s
	iters: 300, epoch: 7 | loss: 0.0000013
	speed: 0.3015s/iter; left time: 11612.9432s
	iters: 400, epoch: 7 | loss: 0.0003939
	speed: 0.2756s/iter; left time: 10588.9290s
Epoch: 7 cost time: 121.84551477432251
Epoch: 7, Steps: 413 | Train Loss: 0.124 Vali Loss: 0.247 Vali Acc: 0.960 Test Loss: 0.247 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000034
	speed: 0.5147s/iter; left time: 19719.2447s
	iters: 200, epoch: 8 | loss: 0.0000093
	speed: 0.2829s/iter; left time: 10810.1427s
	iters: 300, epoch: 8 | loss: 0.0018963
	speed: 0.2561s/iter; left time: 9761.3517s
	iters: 400, epoch: 8 | loss: 0.0166088
	speed: 0.2847s/iter; left time: 10820.0506s
Epoch: 8 cost time: 111.20203042030334
Epoch: 8, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.273 Vali Acc: 0.962 Test Loss: 0.273 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.5564s/iter; left time: 21086.2439s
	iters: 200, epoch: 9 | loss: 0.0000007
	speed: 0.2903s/iter; left time: 10973.3232s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.3067s/iter; left time: 11562.7228s
	iters: 400, epoch: 9 | loss: 0.1099297
	speed: 0.2840s/iter; left time: 10678.8926s
Epoch: 9 cost time: 122.30218839645386
Epoch: 9, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.392 Vali Acc: 0.950 Test Loss: 0.392 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0522629
	speed: 0.5661s/iter; left time: 21218.5842s
	iters: 200, epoch: 10 | loss: 0.0000079
	speed: 0.2915s/iter; left time: 10896.8390s
	iters: 300, epoch: 10 | loss: 0.0000064
	speed: 0.2714s/iter; left time: 10117.1049s
	iters: 400, epoch: 10 | loss: 0.0036020
	speed: 0.2812s/iter; left time: 10454.7101s
Epoch: 10 cost time: 117.68184685707092
Epoch: 10, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.358 Vali Acc: 0.948 Test Loss: 0.358 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000006
	speed: 0.5436s/iter; left time: 20153.5315s
	iters: 200, epoch: 11 | loss: 0.0000226
	speed: 0.2797s/iter; left time: 10342.6092s
	iters: 300, epoch: 11 | loss: 0.0009079
	speed: 0.2825s/iter; left time: 10414.8759s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.2713s/iter; left time: 9975.5972s
Epoch: 11 cost time: 114.97655916213989
Epoch: 11, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.328 Vali Acc: 0.959 Test Loss: 0.328 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0000006
	speed: 0.5480s/iter; left time: 20088.6015s
	iters: 200, epoch: 12 | loss: 0.0017403
	speed: 0.2825s/iter; left time: 10328.0231s
	iters: 300, epoch: 12 | loss: 0.3423163
	speed: 0.2958s/iter; left time: 10782.7701s
	iters: 400, epoch: 12 | loss: 0.2070109
	speed: 0.2928s/iter; left time: 10646.8921s
Epoch: 12 cost time: 118.93972730636597
Epoch: 12, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.348 Vali Acc: 0.954 Test Loss: 0.348 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0000076
	speed: 0.5570s/iter; left time: 20187.0652s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.2925s/iter; left time: 10573.9673s
	iters: 300, epoch: 13 | loss: 0.0000012
	speed: 0.2808s/iter; left time: 10120.8524s
	iters: 400, epoch: 13 | loss: 0.0668798
	speed: 0.2802s/iter; left time: 10070.2094s
Epoch: 13 cost time: 118.09451794624329
Epoch: 13, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.221 Vali Acc: 0.969 Test Loss: 0.221 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000004
	speed: 0.5482s/iter; left time: 19641.8952s
	iters: 200, epoch: 14 | loss: 0.0029117
	speed: 0.2897s/iter; left time: 10350.9843s
	iters: 300, epoch: 14 | loss: 0.0000005
	speed: 0.2925s/iter; left time: 10423.1451s
	iters: 400, epoch: 14 | loss: 0.2698840
	speed: 0.2915s/iter; left time: 10358.2596s
Epoch: 14 cost time: 120.28487634658813
Epoch: 14, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.248 Vali Acc: 0.968 Test Loss: 0.248 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9690768531150523
model parameter : 2980362
model size : 21.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1210045
	speed: 0.2874s/iter; left time: 11839.3292s
	iters: 200, epoch: 1 | loss: 0.0931629
	speed: 0.2935s/iter; left time: 12064.0968s
	iters: 300, epoch: 1 | loss: 0.0484304
	speed: 0.2820s/iter; left time: 11563.9229s
	iters: 400, epoch: 1 | loss: 0.0601738
	speed: 0.2714s/iter; left time: 11102.1110s
Epoch: 1 cost time: 117.5848548412323
Epoch: 1, Steps: 413 | Train Loss: 0.603 Vali Loss: 0.079 Vali Acc: 0.974 Test Loss: 0.079 Test Acc: 0.974
Validation loss decreased (inf --> -0.973624).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0107323
	speed: 0.5634s/iter; left time: 22978.9384s
	iters: 200, epoch: 2 | loss: 0.2466882
	speed: 0.2842s/iter; left time: 11563.3027s
	iters: 300, epoch: 2 | loss: 0.3448869
	speed: 0.2877s/iter; left time: 11678.1301s
	iters: 400, epoch: 2 | loss: 0.0017942
	speed: 0.2859s/iter; left time: 11575.5655s
Epoch: 2 cost time: 119.57316899299622
Epoch: 2, Steps: 413 | Train Loss: 0.109 Vali Loss: 0.136 Vali Acc: 0.966 Test Loss: 0.136 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0095701
	speed: 0.5703s/iter; left time: 23024.6687s
	iters: 200, epoch: 3 | loss: 0.0004583
	speed: 0.2930s/iter; left time: 11801.9508s
	iters: 300, epoch: 3 | loss: 0.0129832
	speed: 0.2906s/iter; left time: 11673.6075s
	iters: 400, epoch: 3 | loss: 0.0013424
	speed: 0.2804s/iter; left time: 11237.1648s
Epoch: 3 cost time: 120.32292437553406
Epoch: 3, Steps: 413 | Train Loss: 0.102 Vali Loss: 0.277 Vali Acc: 0.941 Test Loss: 0.277 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0003258
	speed: 0.5775s/iter; left time: 23077.2080s
	iters: 200, epoch: 4 | loss: 0.0126592
	speed: 0.2933s/iter; left time: 11692.6884s
	iters: 300, epoch: 4 | loss: 0.0013167
	speed: 0.2970s/iter; left time: 11808.0471s
	iters: 400, epoch: 4 | loss: 0.0517251
	speed: 0.2822s/iter; left time: 11190.7109s
Epoch: 4 cost time: 120.98722720146179
Epoch: 4, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0026620
	speed: 0.5604s/iter; left time: 22163.5028s
	iters: 200, epoch: 5 | loss: 0.0203528
	speed: 0.2870s/iter; left time: 11319.9913s
	iters: 300, epoch: 5 | loss: 0.0000072
	speed: 0.2986s/iter; left time: 11750.1184s
	iters: 400, epoch: 5 | loss: 0.0035625
	speed: 0.3028s/iter; left time: 11883.7829s
Epoch: 5 cost time: 121.74260687828064
Epoch: 5, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.216 Vali Acc: 0.967 Test Loss: 0.216 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.1941009
	speed: 0.5595s/iter; left time: 21895.1514s
	iters: 200, epoch: 6 | loss: 1.1936259
	speed: 0.2852s/iter; left time: 11134.5713s
	iters: 300, epoch: 6 | loss: 0.0437101
	speed: 0.2808s/iter; left time: 10934.7717s
	iters: 400, epoch: 6 | loss: 0.0000317
	speed: 0.2931s/iter; left time: 11384.1725s
Epoch: 6 cost time: 118.84431862831116
Epoch: 6, Steps: 413 | Train Loss: 0.112 Vali Loss: 0.261 Vali Acc: 0.959 Test Loss: 0.261 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.2196922
	speed: 0.5631s/iter; left time: 21805.1003s
	iters: 200, epoch: 7 | loss: 0.0001110
	speed: 0.2953s/iter; left time: 11406.7437s
	iters: 300, epoch: 7 | loss: 0.0000200
	speed: 0.2928s/iter; left time: 11281.1345s
	iters: 400, epoch: 7 | loss: 0.0056959
	speed: 0.2971s/iter; left time: 11415.5976s
Epoch: 7 cost time: 121.53273892402649
Epoch: 7, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.242 Vali Acc: 0.967 Test Loss: 0.242 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.0000001
	speed: 0.5635s/iter; left time: 21586.2071s
	iters: 200, epoch: 8 | loss: 0.0136883
	speed: 0.2758s/iter; left time: 10540.1430s
	iters: 300, epoch: 8 | loss: 0.0000036
	speed: 0.2748s/iter; left time: 10472.9250s
	iters: 400, epoch: 8 | loss: 0.1793834
	speed: 0.2911s/iter; left time: 11063.9693s
Epoch: 8 cost time: 117.87889814376831
Epoch: 8, Steps: 413 | Train Loss: 0.120 Vali Loss: 0.241 Vali Acc: 0.962 Test Loss: 0.241 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.0000044
	speed: 0.5648s/iter; left time: 21405.5609s
	iters: 200, epoch: 9 | loss: 0.6572566
	speed: 0.2906s/iter; left time: 10983.8615s
	iters: 300, epoch: 9 | loss: 0.0000104
	speed: 0.2959s/iter; left time: 11155.7425s
	iters: 400, epoch: 9 | loss: 0.5482791
	speed: 0.2932s/iter; left time: 11024.4715s
Epoch: 9 cost time: 121.08419704437256
Epoch: 9, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.258 Vali Acc: 0.965 Test Loss: 0.258 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.0167605
	speed: 0.5584s/iter; left time: 20932.7336s
	iters: 200, epoch: 10 | loss: 0.0060874
	speed: 0.2971s/iter; left time: 11106.4530s
	iters: 300, epoch: 10 | loss: 0.0585387
	speed: 0.2944s/iter; left time: 10975.3962s
	iters: 400, epoch: 10 | loss: 0.0012104
	speed: 0.2792s/iter; left time: 10381.9836s
Epoch: 10 cost time: 119.74024987220764
Epoch: 10, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.148 Vali Acc: 0.978 Test Loss: 0.148 Test Acc: 0.978
Validation loss decreased (-0.973624 --> -0.977716).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000030
	speed: 0.5600s/iter; left time: 20759.6978s
	iters: 200, epoch: 11 | loss: 0.0000042
	speed: 0.2932s/iter; left time: 10839.1826s
	iters: 300, epoch: 11 | loss: 0.6013189
	speed: 0.3003s/iter; left time: 11072.1121s
	iters: 400, epoch: 11 | loss: 0.0000016
	speed: 0.3078s/iter; left time: 11317.1336s
Epoch: 11 cost time: 124.2610878944397
Epoch: 11, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.200 Vali Acc: 0.970 Test Loss: 0.200 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.7202122
	speed: 0.5627s/iter; left time: 20626.5857s
	iters: 200, epoch: 12 | loss: 0.0000045
	speed: 0.2971s/iter; left time: 10861.2720s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.2842s/iter; left time: 10362.6192s
	iters: 400, epoch: 12 | loss: 0.0000090
	speed: 0.2840s/iter; left time: 10326.6406s
Epoch: 12 cost time: 120.43150329589844
Epoch: 12, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.387 Vali Acc: 0.956 Test Loss: 0.387 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000002
	speed: 0.5649s/iter; left time: 20474.7112s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.2596s/iter; left time: 9383.4145s
	iters: 300, epoch: 13 | loss: 0.0000003
	speed: 0.2756s/iter; left time: 9933.2307s
	iters: 400, epoch: 13 | loss: 0.0252278
	speed: 0.2788s/iter; left time: 10022.6751s
Epoch: 13 cost time: 113.41591143608093
Epoch: 13, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.188 Vali Acc: 0.973 Test Loss: 0.188 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.5289s/iter; left time: 18951.7500s
	iters: 200, epoch: 14 | loss: 0.0000052
	speed: 0.2923s/iter; left time: 10444.2661s
	iters: 300, epoch: 14 | loss: 0.4134744
	speed: 0.2798s/iter; left time: 9970.6660s
	iters: 400, epoch: 14 | loss: 0.0043895
	speed: 0.2840s/iter; left time: 10092.0053s
Epoch: 14 cost time: 117.32868957519531
Epoch: 14, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.432 Vali Acc: 0.948 Test Loss: 0.432 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0141539
	speed: 0.5636s/iter; left time: 19960.6631s
	iters: 200, epoch: 15 | loss: 0.0000009
	speed: 0.2710s/iter; left time: 9570.7749s
	iters: 300, epoch: 15 | loss: 0.0010473
	speed: 0.2898s/iter; left time: 10207.1315s
	iters: 400, epoch: 15 | loss: 0.0000043
	speed: 0.2592s/iter; left time: 9102.5831s
Epoch: 15 cost time: 113.175710439682
Epoch: 15, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.252 Vali Acc: 0.962 Test Loss: 0.252 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.5918245
	speed: 0.4958s/iter; left time: 17354.4151s
	iters: 200, epoch: 16 | loss: 0.0372592
	speed: 0.2993s/iter; left time: 10447.4892s
	iters: 300, epoch: 16 | loss: 0.0000032
	speed: 0.2903s/iter; left time: 10104.6587s
	iters: 400, epoch: 16 | loss: 0.0000015
	speed: 0.2987s/iter; left time: 10365.8308s
Epoch: 16 cost time: 120.85520529747009
Epoch: 16, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.203 Vali Acc: 0.976 Test Loss: 0.203 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000062
	speed: 0.5418s/iter; left time: 18744.0770s
	iters: 200, epoch: 17 | loss: 0.0000060
	speed: 0.2808s/iter; left time: 9685.4974s
	iters: 300, epoch: 17 | loss: 0.0001297
	speed: 0.2885s/iter; left time: 9921.3777s
	iters: 400, epoch: 17 | loss: 0.0003146
	speed: 0.2611s/iter; left time: 8954.4159s
Epoch: 17 cost time: 113.6904821395874
Epoch: 17, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.266 Vali Acc: 0.963 Test Loss: 0.266 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0012866
	speed: 0.5338s/iter; left time: 18243.6788s
	iters: 200, epoch: 18 | loss: 0.0000100
	speed: 0.2900s/iter; left time: 9883.4053s
	iters: 300, epoch: 18 | loss: 0.0000007
	speed: 0.2932s/iter; left time: 9962.2186s
	iters: 400, epoch: 18 | loss: 0.0000003
	speed: 0.2967s/iter; left time: 10053.1664s
Epoch: 18 cost time: 122.4880223274231
Epoch: 18, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.261 Vali Acc: 0.960 Test Loss: 0.261 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0001219
	speed: 0.5215s/iter; left time: 17610.7293s
	iters: 200, epoch: 19 | loss: 0.1140711
	speed: 0.2969s/iter; left time: 9995.3445s
	iters: 300, epoch: 19 | loss: 0.0033340
	speed: 0.2800s/iter; left time: 9399.9797s
	iters: 400, epoch: 19 | loss: 0.0005536
	speed: 0.2647s/iter; left time: 8857.8969s
Epoch: 19 cost time: 113.90265917778015
Epoch: 19, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.228 Vali Acc: 0.971 Test Loss: 0.228 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0789865
	speed: 0.5656s/iter; left time: 18865.0827s
	iters: 200, epoch: 20 | loss: 0.0012784
	speed: 0.2903s/iter; left time: 9652.3900s
	iters: 300, epoch: 20 | loss: 0.0000023
	speed: 0.2927s/iter; left time: 9703.0867s
	iters: 400, epoch: 20 | loss: 0.0000414
	speed: 0.2789s/iter; left time: 9218.2677s
Epoch: 20 cost time: 119.70692682266235
Epoch: 20, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.215 Vali Acc: 0.970 Test Loss: 0.215 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9777171441564347
model parameter : 2980362
model size : 21.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.3027482
	speed: 0.3141s/iter; left time: 12942.7503s
	iters: 200, epoch: 1 | loss: 2.3017280
	speed: 0.2810s/iter; left time: 11549.1337s
	iters: 300, epoch: 1 | loss: 2.3037648
	speed: 0.2801s/iter; left time: 11484.6456s
	iters: 400, epoch: 1 | loss: 2.3044147
	speed: 0.3070s/iter; left time: 12555.6684s
Epoch: 1 cost time: 122.29002666473389
Epoch: 1, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (inf --> -0.100022).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3032219
	speed: 0.5338s/iter; left time: 21772.6835s
	iters: 200, epoch: 2 | loss: 2.3026371
	speed: 0.2878s/iter; left time: 11711.8617s
	iters: 300, epoch: 2 | loss: 2.3025918
	speed: 0.2665s/iter; left time: 10817.5127s
	iters: 400, epoch: 2 | loss: 2.3044794
	speed: 0.2706s/iter; left time: 10957.5341s
Epoch: 2 cost time: 113.09260177612305
Epoch: 2, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3050458
	speed: 0.5579s/iter; left time: 22525.0489s
	iters: 200, epoch: 3 | loss: 2.3038857
	speed: 0.2947s/iter; left time: 11867.3835s
	iters: 300, epoch: 3 | loss: 2.3048511
	speed: 0.3023s/iter; left time: 12146.8629s
	iters: 400, epoch: 3 | loss: 2.3046017
	speed: 0.2933s/iter; left time: 11754.0859s
Epoch: 3 cost time: 121.41645073890686
Epoch: 3, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.3038490
	speed: 0.5078s/iter; left time: 20293.3132s
	iters: 200, epoch: 4 | loss: 2.3029363
	speed: 0.2755s/iter; left time: 10981.5663s
	iters: 300, epoch: 4 | loss: 2.3008809
	speed: 0.2738s/iter; left time: 10887.9047s
	iters: 400, epoch: 4 | loss: 2.3029556
	speed: 0.2707s/iter; left time: 10737.4287s
Epoch: 4 cost time: 111.18483448028564
Epoch: 4, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.3021443
	speed: 0.5723s/iter; left time: 22632.9851s
	iters: 200, epoch: 5 | loss: 2.3014586
	speed: 0.2991s/iter; left time: 11799.8433s
	iters: 300, epoch: 5 | loss: 2.3022780
	speed: 0.2957s/iter; left time: 11636.2831s
	iters: 400, epoch: 5 | loss: 2.3022540
	speed: 0.2657s/iter; left time: 10429.6539s
Epoch: 5 cost time: 119.04778909683228
Epoch: 5, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 2.3025608
	speed: 0.5560s/iter; left time: 21759.9097s
	iters: 200, epoch: 6 | loss: 2.3051085
	speed: 0.2848s/iter; left time: 11115.8341s
	iters: 300, epoch: 6 | loss: 2.3002138
	speed: 0.3101s/iter; left time: 12075.9524s
	iters: 400, epoch: 6 | loss: 2.3036559
	speed: 0.2681s/iter; left time: 10413.4446s
Epoch: 6 cost time: 118.99011087417603
Epoch: 6, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 2.3040547
	speed: 0.5527s/iter; left time: 21402.1339s
	iters: 200, epoch: 7 | loss: 2.3030043
	speed: 0.2759s/iter; left time: 10656.2327s
	iters: 300, epoch: 7 | loss: 2.3009245
	speed: 0.2939s/iter; left time: 11322.9339s
	iters: 400, epoch: 7 | loss: 2.3024323
	speed: 0.2930s/iter; left time: 11259.0478s
Epoch: 7 cost time: 118.98811483383179
Epoch: 7, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 2.3047247
	speed: 0.5731s/iter; left time: 21954.3531s
	iters: 200, epoch: 8 | loss: 2.2999229
	speed: 0.2822s/iter; left time: 10783.4810s
	iters: 300, epoch: 8 | loss: 2.3017330
	speed: 0.2912s/iter; left time: 11097.5993s
	iters: 400, epoch: 8 | loss: 2.3037438
	speed: 0.2824s/iter; left time: 10732.4857s
Epoch: 8 cost time: 119.13500142097473
Epoch: 8, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 2.3041158
	speed: 0.5670s/iter; left time: 21486.9646s
	iters: 200, epoch: 9 | loss: 2.3020144
	speed: 0.2798s/iter; left time: 10577.1670s
	iters: 300, epoch: 9 | loss: 2.3054662
	speed: 0.2922s/iter; left time: 11014.7330s
	iters: 400, epoch: 9 | loss: 2.3038595
	speed: 0.2742s/iter; left time: 10310.7447s
Epoch: 9 cost time: 116.90104842185974
Epoch: 9, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 2.3020358
	speed: 0.5686s/iter; left time: 21314.3342s
	iters: 200, epoch: 10 | loss: 2.3033631
	speed: 0.2863s/iter; left time: 10702.8428s
	iters: 300, epoch: 10 | loss: 2.3021960
	speed: 0.2959s/iter; left time: 11031.1707s
	iters: 400, epoch: 10 | loss: 2.3028448
	speed: 0.2922s/iter; left time: 10863.5765s
Epoch: 10 cost time: 121.27888822555542
Epoch: 10, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 2.3014753
	speed: 0.5623s/iter; left time: 20845.8754s
	iters: 200, epoch: 11 | loss: 2.3029616
	speed: 0.2784s/iter; left time: 10290.9668s
	iters: 300, epoch: 11 | loss: 2.3027613
	speed: 0.2921s/iter; left time: 10770.3496s
	iters: 400, epoch: 11 | loss: 2.3026381
	speed: 0.2844s/iter; left time: 10456.1003s
Epoch: 11 cost time: 118.38515949249268
Epoch: 11, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 2.3020146
	speed: 0.5694s/iter; left time: 20874.8367s
	iters: 200, epoch: 12 | loss: 2.3039849
	speed: 0.2814s/iter; left time: 10285.7520s
	iters: 300, epoch: 12 | loss: 2.3011315
	speed: 0.2984s/iter; left time: 10879.3023s
	iters: 400, epoch: 12 | loss: 2.3023098
	speed: 0.2976s/iter; left time: 10821.4556s
Epoch: 12 cost time: 121.54812574386597
Epoch: 12, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.10004547521600728
model parameter : 2980362
model size : 21.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         47                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df128_ma47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7240379
	speed: 0.3060s/iter; left time: 12607.7174s
	iters: 200, epoch: 1 | loss: 0.2597805
	speed: 0.2870s/iter; left time: 11793.9434s
	iters: 300, epoch: 1 | loss: 0.0514294
	speed: 0.2845s/iter; left time: 11664.2083s
	iters: 400, epoch: 1 | loss: 0.0680632
	speed: 0.2973s/iter; left time: 12158.9048s
Epoch: 1 cost time: 121.5555510520935
Epoch: 1, Steps: 413 | Train Loss: 0.365 Vali Loss: 0.082 Vali Acc: 0.975 Test Loss: 0.082 Test Acc: 0.975
Validation loss decreased (inf --> -0.974988).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0037828
	speed: 0.5872s/iter; left time: 23949.6325s
	iters: 200, epoch: 2 | loss: 0.0202264
	speed: 0.2949s/iter; left time: 11999.0813s
	iters: 300, epoch: 2 | loss: 0.0094381
	speed: 0.2921s/iter; left time: 11855.7642s
	iters: 400, epoch: 2 | loss: 0.0014919
	speed: 0.2982s/iter; left time: 12074.3773s
Epoch: 2 cost time: 122.73534512519836
Epoch: 2, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.073 Vali Acc: 0.975 Test Loss: 0.073 Test Acc: 0.975
Validation loss decreased (-0.974988 --> -0.974988).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0063393
	speed: 0.5877s/iter; left time: 23727.8912s
	iters: 200, epoch: 3 | loss: 0.0039869
	speed: 0.2842s/iter; left time: 11444.2825s
	iters: 300, epoch: 3 | loss: 0.0000883
	speed: 0.2837s/iter; left time: 11397.6920s
	iters: 400, epoch: 3 | loss: 0.0349780
	speed: 0.2760s/iter; left time: 11062.1976s
Epoch: 3 cost time: 117.18646955490112
Epoch: 3, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.161 Vali Acc: 0.962 Test Loss: 0.161 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1242060
	speed: 0.5539s/iter; left time: 22133.2233s
	iters: 200, epoch: 4 | loss: 0.0260877
	speed: 0.2937s/iter; left time: 11707.0237s
	iters: 300, epoch: 4 | loss: 0.3084935
	speed: 0.2961s/iter; left time: 11774.2990s
	iters: 400, epoch: 4 | loss: 0.0000629
	speed: 0.2919s/iter; left time: 11576.1391s
Epoch: 4 cost time: 119.96160936355591
Epoch: 4, Steps: 413 | Train Loss: 0.102 Vali Loss: 0.198 Vali Acc: 0.960 Test Loss: 0.198 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0230951
	speed: 0.5714s/iter; left time: 22599.1460s
	iters: 200, epoch: 5 | loss: 0.6155226
	speed: 0.2819s/iter; left time: 11121.6035s
	iters: 300, epoch: 5 | loss: 0.0003886
	speed: 0.2972s/iter; left time: 11692.6222s
	iters: 400, epoch: 5 | loss: 0.0000044
	speed: 0.2877s/iter; left time: 11293.1360s
Epoch: 5 cost time: 119.453768491745
Epoch: 5, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.146 Vali Acc: 0.973 Test Loss: 0.146 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0000100
	speed: 0.5706s/iter; left time: 22329.3446s
	iters: 200, epoch: 6 | loss: 0.0020726
	speed: 0.2976s/iter; left time: 11618.7245s
	iters: 300, epoch: 6 | loss: 0.0000175
	speed: 0.2860s/iter; left time: 11137.2088s
	iters: 400, epoch: 6 | loss: 0.0000892
	speed: 0.2748s/iter; left time: 10673.2732s
Epoch: 6 cost time: 119.4418113231659
Epoch: 6, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.163 Vali Acc: 0.969 Test Loss: 0.163 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.5374692
	speed: 0.5657s/iter; left time: 21904.3254s
	iters: 200, epoch: 7 | loss: 0.0000001
	speed: 0.2723s/iter; left time: 10515.5154s
	iters: 300, epoch: 7 | loss: 0.0000025
	speed: 0.2756s/iter; left time: 10617.0749s
	iters: 400, epoch: 7 | loss: 0.1894471
	speed: 0.2785s/iter; left time: 10701.9531s
Epoch: 7 cost time: 114.76971673965454
Epoch: 7, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.201 Vali Acc: 0.969 Test Loss: 0.201 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0391628
	speed: 0.5431s/iter; left time: 20805.6988s
	iters: 200, epoch: 8 | loss: 0.0010073
	speed: 0.2672s/iter; left time: 10209.6912s
	iters: 300, epoch: 8 | loss: 0.0000135
	speed: 0.2810s/iter; left time: 10708.4704s
	iters: 400, epoch: 8 | loss: 0.0000187
	speed: 0.2624s/iter; left time: 9973.4712s
Epoch: 8 cost time: 112.72027897834778
Epoch: 8, Steps: 413 | Train Loss: 0.118 Vali Loss: 0.192 Vali Acc: 0.972 Test Loss: 0.192 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0000006
	speed: 0.5499s/iter; left time: 20840.4832s
	iters: 200, epoch: 9 | loss: 0.0021335
	speed: 0.2856s/iter; left time: 10793.9771s
	iters: 300, epoch: 9 | loss: 0.0000003
	speed: 0.2782s/iter; left time: 10489.1110s
	iters: 400, epoch: 9 | loss: 0.0015379
	speed: 0.2757s/iter; left time: 10364.1753s
Epoch: 9 cost time: 115.80595421791077
Epoch: 9, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.267 Vali Acc: 0.957 Test Loss: 0.267 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0000171
	speed: 0.5510s/iter; left time: 20655.0573s
	iters: 200, epoch: 10 | loss: 0.0101768
	speed: 0.3042s/iter; left time: 11371.3341s
	iters: 300, epoch: 10 | loss: 0.0019155
	speed: 0.2992s/iter; left time: 11155.6381s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.2973s/iter; left time: 11055.1013s
Epoch: 10 cost time: 122.23184466362
Epoch: 10, Steps: 413 | Train Loss: 0.102 Vali Loss: 0.277 Vali Acc: 0.963 Test Loss: 0.277 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0000112
	speed: 0.5657s/iter; left time: 20969.5192s
	iters: 200, epoch: 11 | loss: 0.0021828
	speed: 0.2767s/iter; left time: 10229.9338s
	iters: 300, epoch: 11 | loss: 0.0000001
	speed: 0.2863s/iter; left time: 10556.8487s
	iters: 400, epoch: 11 | loss: 0.0000016
	speed: 0.2779s/iter; left time: 10216.9947s
Epoch: 11 cost time: 117.44467258453369
Epoch: 11, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.253 Vali Acc: 0.970 Test Loss: 0.253 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0075519
	speed: 0.5761s/iter; left time: 21117.5921s
	iters: 200, epoch: 12 | loss: 0.0444256
	speed: 0.3014s/iter; left time: 11020.0971s
	iters: 300, epoch: 12 | loss: 0.0158530
	speed: 0.2827s/iter; left time: 10305.8866s
	iters: 400, epoch: 12 | loss: 0.0000024
	speed: 0.2889s/iter; left time: 10502.5247s
Epoch: 12 cost time: 121.43606305122375
Epoch: 12, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.323 Vali Acc: 0.965 Test Loss: 0.323 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df128_ma47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9749886311959982
model parameter : 2783754
model size : 20.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         38                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df128_ma38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4648910
	speed: 0.2891s/iter; left time: 11911.9756s
	iters: 200, epoch: 1 | loss: 0.3772084
	speed: 0.2843s/iter; left time: 11687.0208s
	iters: 300, epoch: 1 | loss: 0.0529124
	speed: 0.2891s/iter; left time: 11854.9140s
	iters: 400, epoch: 1 | loss: 0.0676175
	speed: 0.3053s/iter; left time: 12486.2834s
Epoch: 1 cost time: 121.09760546684265
Epoch: 1, Steps: 413 | Train Loss: 0.390 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
Validation loss decreased (inf --> -0.970895).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0038561
	speed: 0.5863s/iter; left time: 23914.2924s
	iters: 200, epoch: 2 | loss: 0.0446307
	speed: 0.2864s/iter; left time: 11651.1701s
	iters: 300, epoch: 2 | loss: 0.0008770
	speed: 0.2844s/iter; left time: 11541.3535s
	iters: 400, epoch: 2 | loss: 0.3215816
	speed: 0.2867s/iter; left time: 11608.2878s
Epoch: 2 cost time: 119.70831871032715
Epoch: 2, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.058 Vali Acc: 0.985 Test Loss: 0.058 Test Acc: 0.985
Validation loss decreased (-0.970895 --> -0.985447).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0012792
	speed: 0.5621s/iter; left time: 22693.9135s
	iters: 200, epoch: 3 | loss: 0.0021993
	speed: 0.3169s/iter; left time: 12762.2291s
	iters: 300, epoch: 3 | loss: 0.0003594
	speed: 0.2956s/iter; left time: 11875.9140s
	iters: 400, epoch: 3 | loss: 0.0010546
	speed: 0.2876s/iter; left time: 11526.2098s
Epoch: 3 cost time: 123.41695547103882
Epoch: 3, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0006985
	speed: 0.5655s/iter; left time: 22597.8172s
	iters: 200, epoch: 4 | loss: 0.1681459
	speed: 0.2975s/iter; left time: 11858.8323s
	iters: 300, epoch: 4 | loss: 0.0181671
	speed: 0.3000s/iter; left time: 11928.6339s
	iters: 400, epoch: 4 | loss: 0.0013828
	speed: 0.3048s/iter; left time: 12088.9946s
Epoch: 4 cost time: 123.88745975494385
Epoch: 4, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.182 Vali Acc: 0.965 Test Loss: 0.182 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0004709
	speed: 0.5678s/iter; left time: 22457.6766s
	iters: 200, epoch: 5 | loss: 0.0590368
	speed: 0.2801s/iter; left time: 11050.2476s
	iters: 300, epoch: 5 | loss: 0.0018072
	speed: 0.3013s/iter; left time: 11855.6462s
	iters: 400, epoch: 5 | loss: 0.0015415
	speed: 0.2866s/iter; left time: 11249.0955s
Epoch: 5 cost time: 119.6448073387146
Epoch: 5, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0461263
	speed: 0.5822s/iter; left time: 22784.8820s
	iters: 200, epoch: 6 | loss: 0.3306929
	speed: 0.3090s/iter; left time: 12063.9911s
	iters: 300, epoch: 6 | loss: 0.0420463
	speed: 0.3063s/iter; left time: 11927.8128s
	iters: 400, epoch: 6 | loss: 0.1401820
	speed: 0.3023s/iter; left time: 11738.2083s
Epoch: 6 cost time: 126.02143883705139
Epoch: 6, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.135 Vali Acc: 0.979 Test Loss: 0.135 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0632975
	speed: 0.5702s/iter; left time: 22081.4215s
	iters: 200, epoch: 7 | loss: 0.0000106
	speed: 0.2869s/iter; left time: 11082.8119s
	iters: 300, epoch: 7 | loss: 0.0005445
	speed: 0.3043s/iter; left time: 11720.8962s
	iters: 400, epoch: 7 | loss: 0.3599389
	speed: 0.2994s/iter; left time: 11502.1057s
Epoch: 7 cost time: 123.4917824268341
Epoch: 7, Steps: 413 | Train Loss: 0.115 Vali Loss: 0.292 Vali Acc: 0.970 Test Loss: 0.292 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.8276596
	speed: 0.5824s/iter; left time: 22312.6281s
	iters: 200, epoch: 8 | loss: 0.0175430
	speed: 0.2979s/iter; left time: 11383.2947s
	iters: 300, epoch: 8 | loss: 0.0018924
	speed: 0.3034s/iter; left time: 11562.0079s
	iters: 400, epoch: 8 | loss: 0.2458331
	speed: 0.2997s/iter; left time: 11392.3664s
Epoch: 8 cost time: 124.42606019973755
Epoch: 8, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.198 Vali Acc: 0.970 Test Loss: 0.198 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0000001
	speed: 0.5976s/iter; left time: 22645.9435s
	iters: 200, epoch: 9 | loss: 0.0000279
	speed: 0.3101s/iter; left time: 11720.4362s
	iters: 300, epoch: 9 | loss: 0.0000143
	speed: 0.3123s/iter; left time: 11773.1221s
	iters: 400, epoch: 9 | loss: 0.0108483
	speed: 0.2861s/iter; left time: 10757.4766s
Epoch: 9 cost time: 126.25140285491943
Epoch: 9, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.207 Vali Acc: 0.972 Test Loss: 0.207 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0000009
	speed: 0.5676s/iter; left time: 21277.4534s
	iters: 200, epoch: 10 | loss: 0.0372958
	speed: 0.3052s/iter; left time: 11410.9845s
	iters: 300, epoch: 10 | loss: 0.0000131
	speed: 0.3133s/iter; left time: 11682.8160s
	iters: 400, epoch: 10 | loss: 0.0000000
	speed: 0.3032s/iter; left time: 11273.3819s
Epoch: 10 cost time: 125.99812388420105
Epoch: 10, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.223 Vali Acc: 0.973 Test Loss: 0.223 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.5716s/iter; left time: 21191.3065s
	iters: 200, epoch: 11 | loss: 0.0000000
	speed: 0.2845s/iter; left time: 10518.0646s
	iters: 300, epoch: 11 | loss: 0.0001665
	speed: 0.3009s/iter; left time: 11094.9352s
	iters: 400, epoch: 11 | loss: 0.0008092
	speed: 0.3139s/iter; left time: 11540.6359s
Epoch: 11 cost time: 124.06928849220276
Epoch: 11, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.185 Vali Acc: 0.977 Test Loss: 0.185 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0000813
	speed: 0.5626s/iter; left time: 20624.0116s
	iters: 200, epoch: 12 | loss: 0.0000006
	speed: 0.3065s/iter; left time: 11204.8922s
	iters: 300, epoch: 12 | loss: 0.2741621
	speed: 0.2972s/iter; left time: 10835.4002s
	iters: 400, epoch: 12 | loss: 0.0000174
	speed: 0.2888s/iter; left time: 10499.9912s
Epoch: 12 cost time: 121.02908754348755
Epoch: 12, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.383 Vali Acc: 0.975 Test Loss: 0.383 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df128_ma38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9854479308776717
model parameter : 2783754
model size : 20.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         28                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df128_ma28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6921654
	speed: 0.3148s/iter; left time: 12971.9471s
	iters: 200, epoch: 1 | loss: 0.3854527
	speed: 0.2968s/iter; left time: 12198.7551s
	iters: 300, epoch: 1 | loss: 0.0295375
	speed: 0.2922s/iter; left time: 11978.8103s
	iters: 400, epoch: 1 | loss: 0.0209018
	speed: 0.2807s/iter; left time: 11481.3898s
Epoch: 1 cost time: 122.52394342422485
Epoch: 1, Steps: 413 | Train Loss: 0.429 Vali Loss: 0.114 Vali Acc: 0.964 Test Loss: 0.114 Test Acc: 0.964
Validation loss decreased (inf --> -0.963619).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0104922
	speed: 0.5479s/iter; left time: 22347.2983s
	iters: 200, epoch: 2 | loss: 0.0110780
	speed: 0.2936s/iter; left time: 11944.9435s
	iters: 300, epoch: 2 | loss: 0.0081396
	speed: 0.3006s/iter; left time: 12201.2468s
	iters: 400, epoch: 2 | loss: 0.0016328
	speed: 0.3061s/iter; left time: 12392.7097s
Epoch: 2 cost time: 122.89426374435425
Epoch: 2, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
Validation loss decreased (-0.963619 --> -0.977716).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0416919
	speed: 0.5752s/iter; left time: 23225.1583s
	iters: 200, epoch: 3 | loss: 0.0001848
	speed: 0.2794s/iter; left time: 11252.2716s
	iters: 300, epoch: 3 | loss: 0.0002844
	speed: 0.2847s/iter; left time: 11438.6697s
	iters: 400, epoch: 3 | loss: 0.0385594
	speed: 0.3038s/iter; left time: 12173.9955s
Epoch: 3 cost time: 120.33926510810852
Epoch: 3, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0024626
	speed: 0.5648s/iter; left time: 22570.1685s
	iters: 200, epoch: 4 | loss: 0.0013378
	speed: 0.3072s/iter; left time: 12244.7839s
	iters: 300, epoch: 4 | loss: 0.0500268
	speed: 0.2972s/iter; left time: 11818.9829s
	iters: 400, epoch: 4 | loss: 0.0080628
	speed: 0.3007s/iter; left time: 11925.4475s
Epoch: 4 cost time: 124.04069590568542
Epoch: 4, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.225 Vali Acc: 0.958 Test Loss: 0.225 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0012249
	speed: 0.5551s/iter; left time: 21952.7801s
	iters: 200, epoch: 5 | loss: 0.0028730
	speed: 0.2987s/iter; left time: 11781.8863s
	iters: 300, epoch: 5 | loss: 0.0005547
	speed: 0.3047s/iter; left time: 11990.5143s
	iters: 400, epoch: 5 | loss: 0.0000055
	speed: 0.2725s/iter; left time: 10696.2532s
Epoch: 5 cost time: 120.07932710647583
Epoch: 5, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.225 Vali Acc: 0.962 Test Loss: 0.225 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0016423
	speed: 0.5455s/iter; left time: 21348.6141s
	iters: 200, epoch: 6 | loss: 0.0376292
	speed: 0.2657s/iter; left time: 10370.7142s
	iters: 300, epoch: 6 | loss: 0.9392344
	speed: 0.2804s/iter; left time: 10917.7944s
	iters: 400, epoch: 6 | loss: 0.6958154
	speed: 0.2927s/iter; left time: 11365.7341s
Epoch: 6 cost time: 116.11252522468567
Epoch: 6, Steps: 413 | Train Loss: 0.103 Vali Loss: 0.116 Vali Acc: 0.981 Test Loss: 0.116 Test Acc: 0.981
Validation loss decreased (-0.977716 --> -0.980899).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0907218
	speed: 0.5588s/iter; left time: 21638.0959s
	iters: 200, epoch: 7 | loss: 0.0000012
	speed: 0.2823s/iter; left time: 10904.3328s
	iters: 300, epoch: 7 | loss: 0.0719867
	speed: 0.2724s/iter; left time: 10495.5434s
	iters: 400, epoch: 7 | loss: 0.0225333
	speed: 0.2820s/iter; left time: 10836.2200s
Epoch: 7 cost time: 116.23898363113403
Epoch: 7, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.219 Vali Acc: 0.971 Test Loss: 0.219 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0048170
	speed: 0.5545s/iter; left time: 21243.1805s
	iters: 200, epoch: 8 | loss: 0.0860813
	speed: 0.2665s/iter; left time: 10181.4101s
	iters: 300, epoch: 8 | loss: 0.0000048
	speed: 0.2763s/iter; left time: 10528.8178s
	iters: 400, epoch: 8 | loss: 0.2062434
	speed: 0.2811s/iter; left time: 10685.7281s
Epoch: 8 cost time: 114.03489017486572
Epoch: 8, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.251 Vali Acc: 0.971 Test Loss: 0.251 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000226
	speed: 0.5635s/iter; left time: 21356.1985s
	iters: 200, epoch: 9 | loss: 0.0762021
	speed: 0.2806s/iter; left time: 10605.0664s
	iters: 300, epoch: 9 | loss: 0.0000001
	speed: 0.2677s/iter; left time: 10092.5455s
	iters: 400, epoch: 9 | loss: 1.1333069
	speed: 0.2799s/iter; left time: 10524.0200s
Epoch: 9 cost time: 115.81917834281921
Epoch: 9, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.235 Vali Acc: 0.970 Test Loss: 0.235 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.5614s/iter; left time: 21044.7776s
	iters: 200, epoch: 10 | loss: 0.0052281
	speed: 0.2702s/iter; left time: 10100.6235s
	iters: 300, epoch: 10 | loss: 0.0001198
	speed: 0.2768s/iter; left time: 10320.2017s
	iters: 400, epoch: 10 | loss: 0.0000413
	speed: 0.2707s/iter; left time: 10067.5637s
Epoch: 10 cost time: 113.14897274971008
Epoch: 10, Steps: 413 | Train Loss: 0.102 Vali Loss: 0.226 Vali Acc: 0.970 Test Loss: 0.226 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000017
	speed: 0.5680s/iter; left time: 21055.6552s
	iters: 200, epoch: 11 | loss: 0.0000003
	speed: 0.2908s/iter; left time: 10749.5274s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.2760s/iter; left time: 10175.4885s
	iters: 400, epoch: 11 | loss: 0.0000040
	speed: 0.2842s/iter; left time: 10448.7124s
Epoch: 11 cost time: 117.99742269515991
Epoch: 11, Steps: 413 | Train Loss: 0.109 Vali Loss: 0.438 Vali Acc: 0.958 Test Loss: 0.438 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000002
	speed: 0.5651s/iter; left time: 20714.8514s
	iters: 200, epoch: 12 | loss: 0.0526628
	speed: 0.2771s/iter; left time: 10130.3173s
	iters: 300, epoch: 12 | loss: 0.5903531
	speed: 0.2750s/iter; left time: 10025.0816s
	iters: 400, epoch: 12 | loss: 1.5773165
	speed: 0.2709s/iter; left time: 9851.1978s
Epoch: 12 cost time: 115.29237532615662
Epoch: 12, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.464 Vali Acc: 0.950 Test Loss: 0.464 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.5805s/iter; left time: 21041.5816s
	iters: 200, epoch: 13 | loss: 0.0049050
	speed: 0.2902s/iter; left time: 10487.7442s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.2848s/iter; left time: 10266.3156s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.2858s/iter; left time: 10273.5139s
Epoch: 13 cost time: 121.04853963851929
Epoch: 13, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.160 Vali Acc: 0.976 Test Loss: 0.160 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000007
	speed: 0.5723s/iter; left time: 20507.9018s
	iters: 200, epoch: 14 | loss: 0.0023855
	speed: 0.2676s/iter; left time: 9562.6987s
	iters: 300, epoch: 14 | loss: 0.0002028
	speed: 0.2614s/iter; left time: 9314.4490s
	iters: 400, epoch: 14 | loss: 0.8562458
	speed: 0.2573s/iter; left time: 9143.8294s
Epoch: 14 cost time: 111.49249649047852
Epoch: 14, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.127 Vali Acc: 0.985 Test Loss: 0.127 Test Acc: 0.985
Validation loss decreased (-0.980899 --> -0.985447).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000016
	speed: 0.5433s/iter; left time: 19241.9688s
	iters: 200, epoch: 15 | loss: 0.0000063
	speed: 0.2789s/iter; left time: 9850.9038s
	iters: 300, epoch: 15 | loss: 0.0000001
	speed: 0.2785s/iter; left time: 9807.8347s
	iters: 400, epoch: 15 | loss: 0.0129013
	speed: 0.2857s/iter; left time: 10035.1107s
Epoch: 15 cost time: 118.41834211349487
Epoch: 15, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.260 Vali Acc: 0.970 Test Loss: 0.260 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.5600s/iter; left time: 19604.3483s
	iters: 200, epoch: 16 | loss: 0.0000343
	speed: 0.3003s/iter; left time: 10483.7868s
	iters: 300, epoch: 16 | loss: 0.1032542
	speed: 0.2580s/iter; left time: 8978.7275s
	iters: 400, epoch: 16 | loss: 0.0010901
	speed: 0.2698s/iter; left time: 9365.4139s
Epoch: 16 cost time: 115.35384893417358
Epoch: 16, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.276 Vali Acc: 0.972 Test Loss: 0.276 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0407293
	speed: 0.5682s/iter; left time: 19657.1297s
	iters: 200, epoch: 17 | loss: 0.0008281
	speed: 0.2721s/iter; left time: 9384.6312s
	iters: 300, epoch: 17 | loss: 0.0010456
	speed: 0.2946s/iter; left time: 10130.5865s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.2608s/iter; left time: 8944.6374s
Epoch: 17 cost time: 116.12556624412537
Epoch: 17, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.345 Vali Acc: 0.963 Test Loss: 0.345 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0001392
	speed: 0.5705s/iter; left time: 19500.7738s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.3015s/iter; left time: 10275.0168s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.2903s/iter; left time: 9863.5100s
	iters: 400, epoch: 18 | loss: 0.0000061
	speed: 0.3114s/iter; left time: 10549.8561s
Epoch: 18 cost time: 125.509028673172
Epoch: 18, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.360 Vali Acc: 0.970 Test Loss: 0.360 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000135
	speed: 0.5405s/iter; left time: 18252.6161s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.2872s/iter; left time: 9667.7521s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.2799s/iter; left time: 9396.2323s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.2552s/iter; left time: 8539.6577s
Epoch: 19 cost time: 112.38448452949524
Epoch: 19, Steps: 413 | Train Loss: 0.114 Vali Loss: 0.319 Vali Acc: 0.965 Test Loss: 0.319 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0005508
	speed: 0.5471s/iter; left time: 18249.3032s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.2913s/iter; left time: 9688.1880s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.3034s/iter; left time: 10058.0197s
	iters: 400, epoch: 20 | loss: 0.0000362
	speed: 0.2876s/iter; left time: 9506.4027s
Epoch: 20 cost time: 121.97735452651978
Epoch: 20, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.223 Vali Acc: 0.975 Test Loss: 0.223 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.5348s/iter; left time: 17617.7834s
	iters: 200, epoch: 21 | loss: 0.0005818
	speed: 0.2899s/iter; left time: 9521.7671s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.2797s/iter; left time: 9157.1652s
	iters: 400, epoch: 21 | loss: 0.0000039
	speed: 0.2856s/iter; left time: 9322.9100s
Epoch: 21 cost time: 116.8422954082489
Epoch: 21, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.404 Vali Acc: 0.965 Test Loss: 0.404 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0000004
	speed: 0.5844s/iter; left time: 19009.0228s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.2902s/iter; left time: 9411.0454s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.2974s/iter; left time: 9614.1386s
	iters: 400, epoch: 22 | loss: 0.0000013
	speed: 0.2904s/iter; left time: 9358.3233s
Epoch: 22 cost time: 121.51053237915039
Epoch: 22, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.245 Vali Acc: 0.975 Test Loss: 0.245 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.6719587
	speed: 0.5509s/iter; left time: 17690.6716s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.2907s/iter; left time: 9305.2626s
	iters: 300, epoch: 23 | loss: 0.0003114
	speed: 0.3026s/iter; left time: 9655.8993s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.3135s/iter; left time: 9973.8411s
Epoch: 23 cost time: 123.409658908844
Epoch: 23, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.446 Vali Acc: 0.963 Test Loss: 0.446 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0000013
	speed: 0.5362s/iter; left time: 16999.5611s
	iters: 200, epoch: 24 | loss: 0.0000001
	speed: 0.2837s/iter; left time: 8966.8394s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.2934s/iter; left time: 9242.0560s
	iters: 400, epoch: 24 | loss: 0.0000008
	speed: 0.2908s/iter; left time: 9133.0258s
Epoch: 24 cost time: 119.11100053787231
Epoch: 24, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.149 Vali Acc: 0.985 Test Loss: 0.149 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df128_ma28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9854479308776717
model parameter : 2783754
model size : 20.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df128_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1405486
	speed: 0.2852s/iter; left time: 11750.7581s
	iters: 200, epoch: 1 | loss: 0.4036761
	speed: 0.2796s/iter; left time: 11492.9202s
	iters: 300, epoch: 1 | loss: 0.1659530
	speed: 0.2736s/iter; left time: 11219.6040s
	iters: 400, epoch: 1 | loss: 0.0482227
	speed: 0.2929s/iter; left time: 11981.5548s
Epoch: 1 cost time: 117.2792387008667
Epoch: 1, Steps: 413 | Train Loss: 0.494 Vali Loss: 0.100 Vali Acc: 0.967 Test Loss: 0.100 Test Acc: 0.967
Validation loss decreased (inf --> -0.967257).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0540654
	speed: 0.5644s/iter; left time: 23020.0883s
	iters: 200, epoch: 2 | loss: 0.0446823
	speed: 0.2711s/iter; left time: 11030.2475s
	iters: 300, epoch: 2 | loss: 0.0042566
	speed: 0.2673s/iter; left time: 10848.9580s
	iters: 400, epoch: 2 | loss: 0.0019298
	speed: 0.2918s/iter; left time: 11812.7891s
Epoch: 2 cost time: 114.64723706245422
Epoch: 2, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
Validation loss decreased (-0.967257 --> -0.975442).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0025351
	speed: 0.5704s/iter; left time: 23031.8838s
	iters: 200, epoch: 3 | loss: 0.0024529
	speed: 0.2768s/iter; left time: 11147.6529s
	iters: 300, epoch: 3 | loss: 0.0002146
	speed: 0.2760s/iter; left time: 11089.0638s
	iters: 400, epoch: 3 | loss: 0.1450875
	speed: 0.2744s/iter; left time: 10997.0507s
Epoch: 3 cost time: 114.635737657547
Epoch: 3, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0016826
	speed: 0.5890s/iter; left time: 23537.3466s
	iters: 200, epoch: 4 | loss: 0.0011459
	speed: 0.2653s/iter; left time: 10574.1886s
	iters: 300, epoch: 4 | loss: 0.0201871
	speed: 0.2781s/iter; left time: 11057.9696s
	iters: 400, epoch: 4 | loss: 0.0005617
	speed: 0.2802s/iter; left time: 11112.3237s
Epoch: 4 cost time: 115.76487064361572
Epoch: 4, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.151 Vali Acc: 0.966 Test Loss: 0.151 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0007522
	speed: 0.5871s/iter; left time: 23218.5970s
	iters: 200, epoch: 5 | loss: 0.0027217
	speed: 0.2784s/iter; left time: 10981.7295s
	iters: 300, epoch: 5 | loss: 0.0006747
	speed: 0.2795s/iter; left time: 10996.3923s
	iters: 400, epoch: 5 | loss: 0.0035232
	speed: 0.2814s/iter; left time: 11045.9315s
Epoch: 5 cost time: 117.53133797645569
Epoch: 5, Steps: 413 | Train Loss: 0.113 Vali Loss: 0.299 Vali Acc: 0.956 Test Loss: 0.299 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0000447
	speed: 0.5720s/iter; left time: 22385.2330s
	iters: 200, epoch: 6 | loss: 0.2655737
	speed: 0.2783s/iter; left time: 10862.4685s
	iters: 300, epoch: 6 | loss: 0.1123098
	speed: 0.2739s/iter; left time: 10662.8257s
	iters: 400, epoch: 6 | loss: 0.0018048
	speed: 0.2868s/iter; left time: 11137.5735s
Epoch: 6 cost time: 116.81384825706482
Epoch: 6, Steps: 413 | Train Loss: 0.098 Vali Loss: 0.156 Vali Acc: 0.974 Test Loss: 0.156 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0026555
	speed: 0.5808s/iter; left time: 22490.1527s
	iters: 200, epoch: 7 | loss: 0.0000001
	speed: 0.2856s/iter; left time: 11030.5606s
	iters: 300, epoch: 7 | loss: 0.0122668
	speed: 0.2785s/iter; left time: 10729.0800s
	iters: 400, epoch: 7 | loss: 0.0030608
	speed: 0.2905s/iter; left time: 11160.7936s
Epoch: 7 cost time: 119.70088791847229
Epoch: 7, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.368 Vali Acc: 0.956 Test Loss: 0.368 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.6381392
	speed: 0.5886s/iter; left time: 22550.3917s
	iters: 200, epoch: 8 | loss: 0.0000680
	speed: 0.3090s/iter; left time: 11806.6514s
	iters: 300, epoch: 8 | loss: 0.1672048
	speed: 0.2873s/iter; left time: 10949.3187s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.3047s/iter; left time: 11579.9318s
Epoch: 8 cost time: 124.90855240821838
Epoch: 8, Steps: 413 | Train Loss: 0.103 Vali Loss: 0.155 Vali Acc: 0.980 Test Loss: 0.155 Test Acc: 0.980
Validation loss decreased (-0.975442 --> -0.979535).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0171133
	speed: 0.5870s/iter; left time: 22245.7531s
	iters: 200, epoch: 9 | loss: 0.0125703
	speed: 0.3098s/iter; left time: 11709.6360s
	iters: 300, epoch: 9 | loss: 0.0000024
	speed: 0.2817s/iter; left time: 10619.9037s
	iters: 400, epoch: 9 | loss: 0.0000525
	speed: 0.3053s/iter; left time: 11479.0954s
Epoch: 9 cost time: 123.58275389671326
Epoch: 9, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.196 Vali Acc: 0.971 Test Loss: 0.196 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0002592
	speed: 0.5566s/iter; left time: 20862.6259s
	iters: 200, epoch: 10 | loss: 0.6351029
	speed: 0.3052s/iter; left time: 11407.9037s
	iters: 300, epoch: 10 | loss: 0.0000011
	speed: 0.2956s/iter; left time: 11021.8249s
	iters: 400, epoch: 10 | loss: 0.6650417
	speed: 0.3007s/iter; left time: 11182.5761s
Epoch: 10 cost time: 123.27404236793518
Epoch: 10, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.261 Vali Acc: 0.965 Test Loss: 0.261 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.4208243
	speed: 0.5862s/iter; left time: 21729.4426s
	iters: 200, epoch: 11 | loss: 0.0352572
	speed: 0.3115s/iter; left time: 11516.9101s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.2714s/iter; left time: 10007.4162s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.2793s/iter; left time: 10270.1698s
Epoch: 11 cost time: 121.11199259757996
Epoch: 11, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.245 Vali Acc: 0.970 Test Loss: 0.245 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.4805938
	speed: 0.5245s/iter; left time: 19228.0075s
	iters: 200, epoch: 12 | loss: 0.0000008
	speed: 0.2767s/iter; left time: 10116.4241s
	iters: 300, epoch: 12 | loss: 0.0000314
	speed: 0.2695s/iter; left time: 9826.3199s
	iters: 400, epoch: 12 | loss: 0.0000237
	speed: 0.2778s/iter; left time: 10099.1479s
Epoch: 12 cost time: 113.54003167152405
Epoch: 12, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.425 Vali Acc: 0.958 Test Loss: 0.425 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000035
	speed: 0.5374s/iter; left time: 19478.2119s
	iters: 200, epoch: 13 | loss: 0.0000017
	speed: 0.2853s/iter; left time: 10312.7500s
	iters: 300, epoch: 13 | loss: 0.0000031
	speed: 0.2567s/iter; left time: 9252.6723s
	iters: 400, epoch: 13 | loss: 0.0002638
	speed: 0.2782s/iter; left time: 9999.2502s
Epoch: 13 cost time: 113.10264778137207
Epoch: 13, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.320 Vali Acc: 0.959 Test Loss: 0.320 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.5459s/iter; left time: 19562.1045s
	iters: 200, epoch: 14 | loss: 0.0761096
	speed: 0.2803s/iter; left time: 10017.0951s
	iters: 300, epoch: 14 | loss: 0.5934520
	speed: 0.2748s/iter; left time: 9793.2835s
	iters: 400, epoch: 14 | loss: 0.0000002
	speed: 0.2728s/iter; left time: 9693.9664s
Epoch: 14 cost time: 114.1045618057251
Epoch: 14, Steps: 413 | Train Loss: 0.123 Vali Loss: 0.423 Vali Acc: 0.963 Test Loss: 0.423 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.5303s/iter; left time: 18781.4546s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.2760s/iter; left time: 9746.8956s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.2833s/iter; left time: 9975.8274s
	iters: 400, epoch: 15 | loss: 0.0000352
	speed: 0.2605s/iter; left time: 9149.4350s
Epoch: 15 cost time: 112.24911832809448
Epoch: 15, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.201 Vali Acc: 0.979 Test Loss: 0.201 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.5667s/iter; left time: 19839.1248s
	iters: 200, epoch: 16 | loss: 0.0019879
	speed: 0.2837s/iter; left time: 9902.1640s
	iters: 300, epoch: 16 | loss: 0.0000251
	speed: 0.2843s/iter; left time: 9896.0086s
	iters: 400, epoch: 16 | loss: 0.0000036
	speed: 0.2795s/iter; left time: 9701.0412s
Epoch: 16 cost time: 118.42953586578369
Epoch: 16, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.359 Vali Acc: 0.964 Test Loss: 0.359 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0000732
	speed: 0.5364s/iter; left time: 18557.2942s
	iters: 200, epoch: 17 | loss: 0.0039229
	speed: 0.2798s/iter; left time: 9651.8287s
	iters: 300, epoch: 17 | loss: 0.0002042
	speed: 0.2883s/iter; left time: 9915.0181s
	iters: 400, epoch: 17 | loss: 0.7857918
	speed: 0.2965s/iter; left time: 10168.7718s
Epoch: 17 cost time: 117.43791723251343
Epoch: 17, Steps: 413 | Train Loss: 0.102 Vali Loss: 0.300 Vali Acc: 0.971 Test Loss: 0.300 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0055307
	speed: 0.5607s/iter; left time: 19164.1247s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.2859s/iter; left time: 9743.1722s
	iters: 300, epoch: 18 | loss: 0.0000006
	speed: 0.3098s/iter; left time: 10527.7923s
	iters: 400, epoch: 18 | loss: 0.0329166
	speed: 0.2861s/iter; left time: 9692.5897s
Epoch: 18 cost time: 121.49123644828796
Epoch: 18, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.218 Vali Acc: 0.975 Test Loss: 0.218 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df128_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9795361527967258
model parameter : 2783754
model size : 20.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df128_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.9880320
	speed: 0.2816s/iter; left time: 11603.7215s
	iters: 200, epoch: 1 | loss: 0.4271790
	speed: 0.2765s/iter; left time: 11363.7152s
	iters: 300, epoch: 1 | loss: 0.1889677
	speed: 0.2673s/iter; left time: 10960.7254s
	iters: 400, epoch: 1 | loss: 0.0901778
	speed: 0.2765s/iter; left time: 11310.0105s
Epoch: 1 cost time: 113.94701910018921
Epoch: 1, Steps: 413 | Train Loss: 0.592 Vali Loss: 0.137 Vali Acc: 0.953 Test Loss: 0.137 Test Acc: 0.953
Validation loss decreased (inf --> -0.953159).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1242032
	speed: 0.5436s/iter; left time: 22170.4659s
	iters: 200, epoch: 2 | loss: 0.0576123
	speed: 0.2758s/iter; left time: 11220.3962s
	iters: 300, epoch: 2 | loss: 0.0166518
	speed: 0.2945s/iter; left time: 11953.0927s
	iters: 400, epoch: 2 | loss: 0.0011364
	speed: 0.2882s/iter; left time: 11668.1855s
Epoch: 2 cost time: 118.2958915233612
Epoch: 2, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
Validation loss decreased (-0.953159 --> -0.962254).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0077288
	speed: 0.5665s/iter; left time: 22870.7973s
	iters: 200, epoch: 3 | loss: 0.0071777
	speed: 0.2989s/iter; left time: 12037.4090s
	iters: 300, epoch: 3 | loss: 0.1018184
	speed: 0.2921s/iter; left time: 11733.9491s
	iters: 400, epoch: 3 | loss: 0.0366309
	speed: 0.2876s/iter; left time: 11526.8477s
Epoch: 3 cost time: 120.42271995544434
Epoch: 3, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.158 Vali Acc: 0.970 Test Loss: 0.158 Test Acc: 0.970
Validation loss decreased (-0.962254 --> -0.969530).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0004500
	speed: 0.5567s/iter; left time: 22245.0637s
	iters: 200, epoch: 4 | loss: 0.6216348
	speed: 0.2889s/iter; left time: 11515.6309s
	iters: 300, epoch: 4 | loss: 0.6031774
	speed: 0.2793s/iter; left time: 11106.6208s
	iters: 400, epoch: 4 | loss: 0.0004954
	speed: 0.2818s/iter; left time: 11176.7311s
Epoch: 4 cost time: 116.83264708518982
Epoch: 4, Steps: 413 | Train Loss: 0.123 Vali Loss: 0.185 Vali Acc: 0.956 Test Loss: 0.185 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000979
	speed: 0.5623s/iter; left time: 22239.0864s
	iters: 200, epoch: 5 | loss: 0.1932645
	speed: 0.2805s/iter; left time: 11067.3405s
	iters: 300, epoch: 5 | loss: 0.0000004
	speed: 0.2844s/iter; left time: 11191.6972s
	iters: 400, epoch: 5 | loss: 0.0000315
	speed: 0.2761s/iter; left time: 10838.4138s
Epoch: 5 cost time: 116.88427090644836
Epoch: 5, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.358 Vali Acc: 0.948 Test Loss: 0.358 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0004237
	speed: 0.5355s/iter; left time: 20957.1803s
	iters: 200, epoch: 6 | loss: 0.0000261
	speed: 0.2848s/iter; left time: 11118.7395s
	iters: 300, epoch: 6 | loss: 0.9580048
	speed: 0.2893s/iter; left time: 11265.3400s
	iters: 400, epoch: 6 | loss: 0.6894252
	speed: 0.2803s/iter; left time: 10887.0738s
Epoch: 6 cost time: 117.07106328010559
Epoch: 6, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.286 Vali Acc: 0.952 Test Loss: 0.286 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.4501703
	speed: 0.5594s/iter; left time: 21661.0109s
	iters: 200, epoch: 7 | loss: 0.0000020
	speed: 0.2817s/iter; left time: 10880.2551s
	iters: 300, epoch: 7 | loss: 0.0177736
	speed: 0.2839s/iter; left time: 10936.5828s
	iters: 400, epoch: 7 | loss: 0.0000123
	speed: 0.2867s/iter; left time: 11017.1535s
Epoch: 7 cost time: 117.80777311325073
Epoch: 7, Steps: 413 | Train Loss: 0.124 Vali Loss: 0.313 Vali Acc: 0.946 Test Loss: 0.313 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0008402
	speed: 0.5421s/iter; left time: 20766.5335s
	iters: 200, epoch: 8 | loss: 0.0034005
	speed: 0.2758s/iter; left time: 10536.9772s
	iters: 300, epoch: 8 | loss: 0.0002399
	speed: 0.2710s/iter; left time: 10329.3222s
	iters: 400, epoch: 8 | loss: 0.0007312
	speed: 0.2717s/iter; left time: 10326.1376s
Epoch: 8 cost time: 113.22409296035767
Epoch: 8, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.274 Vali Acc: 0.965 Test Loss: 0.274 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000065
	speed: 0.5355s/iter; left time: 20293.9863s
	iters: 200, epoch: 9 | loss: 0.0000005
	speed: 0.2805s/iter; left time: 10603.6295s
	iters: 300, epoch: 9 | loss: 0.0000121
	speed: 0.2719s/iter; left time: 10248.8579s
	iters: 400, epoch: 9 | loss: 0.0012054
	speed: 0.2822s/iter; left time: 10610.6891s
Epoch: 9 cost time: 114.67850828170776
Epoch: 9, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.307 Vali Acc: 0.959 Test Loss: 0.307 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0000001
	speed: 0.5441s/iter; left time: 20394.8508s
	iters: 200, epoch: 10 | loss: 0.0017364
	speed: 0.2778s/iter; left time: 10386.1329s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.2765s/iter; left time: 10308.9019s
	iters: 400, epoch: 10 | loss: 0.3855950
	speed: 0.2684s/iter; left time: 9981.4220s
Epoch: 10 cost time: 113.95429229736328
Epoch: 10, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.428 Vali Acc: 0.956 Test Loss: 0.428 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0461731
	speed: 0.5517s/iter; left time: 20450.5832s
	iters: 200, epoch: 11 | loss: 0.0005006
	speed: 0.2728s/iter; left time: 10085.2684s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.2846s/iter; left time: 10493.9313s
	iters: 400, epoch: 11 | loss: 0.0037806
	speed: 0.2779s/iter; left time: 10218.0020s
Epoch: 11 cost time: 115.45334029197693
Epoch: 11, Steps: 413 | Train Loss: 0.115 Vali Loss: 0.282 Vali Acc: 0.968 Test Loss: 0.282 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0003185
	speed: 0.5579s/iter; left time: 20450.8612s
	iters: 200, epoch: 12 | loss: 0.1299923
	speed: 0.2941s/iter; left time: 10749.9514s
	iters: 300, epoch: 12 | loss: 0.5668268
	speed: 0.2887s/iter; left time: 10524.4644s
	iters: 400, epoch: 12 | loss: 0.0001253
	speed: 0.3033s/iter; left time: 11027.0618s
Epoch: 12 cost time: 121.78149318695068
Epoch: 12, Steps: 413 | Train Loss: 0.103 Vali Loss: 0.435 Vali Acc: 0.953 Test Loss: 0.435 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.4967813
	speed: 0.5606s/iter; left time: 20317.2487s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.2993s/iter; left time: 10819.7182s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.2798s/iter; left time: 10085.5472s
	iters: 400, epoch: 13 | loss: 0.0046468
	speed: 0.2684s/iter; left time: 9645.8927s
Epoch: 13 cost time: 117.66988801956177
Epoch: 13, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.247 Vali Acc: 0.975 Test Loss: 0.247 Test Acc: 0.975
Validation loss decreased (-0.969530 --> -0.974986).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.5524s/iter; left time: 19792.5123s
	iters: 200, epoch: 14 | loss: 0.4389128
	speed: 0.2847s/iter; left time: 10172.9287s
	iters: 300, epoch: 14 | loss: 0.0000015
	speed: 0.2856s/iter; left time: 10175.9344s
	iters: 400, epoch: 14 | loss: 0.0009432
	speed: 0.2889s/iter; left time: 10263.4779s
Epoch: 14 cost time: 118.01931285858154
Epoch: 14, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.138 Vali Acc: 0.977 Test Loss: 0.138 Test Acc: 0.977
Validation loss decreased (-0.974986 --> -0.977261).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0003744
	speed: 0.5310s/iter; left time: 18806.0036s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.2610s/iter; left time: 9217.5503s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.2698s/iter; left time: 9503.0755s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.2774s/iter; left time: 9743.5947s
Epoch: 15 cost time: 111.63635993003845
Epoch: 15, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.271 Vali Acc: 0.967 Test Loss: 0.271 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000002
	speed: 0.5308s/iter; left time: 18580.0402s
	iters: 200, epoch: 16 | loss: 0.1959072
	speed: 0.2742s/iter; left time: 9571.5927s
	iters: 300, epoch: 16 | loss: 0.1817132
	speed: 0.2688s/iter; left time: 9357.0696s
	iters: 400, epoch: 16 | loss: 0.0083174
	speed: 0.2805s/iter; left time: 9734.0894s
Epoch: 16 cost time: 114.24807739257812
Epoch: 16, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.189 Vali Acc: 0.979 Test Loss: 0.189 Test Acc: 0.979
Validation loss decreased (-0.977261 --> -0.979080).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000003
	speed: 0.5509s/iter; left time: 19057.6027s
	iters: 200, epoch: 17 | loss: 0.5377663
	speed: 0.2915s/iter; left time: 10054.0856s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.3015s/iter; left time: 10371.0357s
	iters: 400, epoch: 17 | loss: 0.0000005
	speed: 0.2646s/iter; left time: 9074.2849s
Epoch: 17 cost time: 117.00196862220764
Epoch: 17, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.322 Vali Acc: 0.970 Test Loss: 0.322 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000421
	speed: 0.5653s/iter; left time: 19320.9502s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.2587s/iter; left time: 8815.9877s
	iters: 300, epoch: 18 | loss: 0.0000031
	speed: 0.2691s/iter; left time: 9145.4140s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.2898s/iter; left time: 9819.2678s
Epoch: 18 cost time: 115.00872468948364
Epoch: 18, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.180 Vali Acc: 0.982 Test Loss: 0.180 Test Acc: 0.982
Validation loss decreased (-0.979080 --> -0.982263).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000367
	speed: 0.5606s/iter; left time: 18930.0170s
	iters: 200, epoch: 19 | loss: 0.0000029
	speed: 0.2637s/iter; left time: 8878.1998s
	iters: 300, epoch: 19 | loss: 0.0001658
	speed: 0.2675s/iter; left time: 8978.2948s
	iters: 400, epoch: 19 | loss: 0.0000002
	speed: 0.2733s/iter; left time: 9145.5072s
Epoch: 19 cost time: 112.95389008522034
Epoch: 19, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.181 Vali Acc: 0.972 Test Loss: 0.181 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.4057115
	speed: 0.5222s/iter; left time: 17418.2779s
	iters: 200, epoch: 20 | loss: 0.0046238
	speed: 0.2663s/iter; left time: 8856.7101s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.2782s/iter; left time: 9224.4646s
	iters: 400, epoch: 20 | loss: 0.0000009
	speed: 0.2677s/iter; left time: 8847.9745s
Epoch: 20 cost time: 111.67332077026367
Epoch: 20, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.180 Vali Acc: 0.974 Test Loss: 0.180 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0008038
	speed: 0.5435s/iter; left time: 17904.1602s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.2654s/iter; left time: 8716.1746s
	iters: 300, epoch: 21 | loss: 0.0011045
	speed: 0.2699s/iter; left time: 8837.7626s
	iters: 400, epoch: 21 | loss: 0.0000014
	speed: 0.2784s/iter; left time: 9087.4762s
Epoch: 21 cost time: 113.40407347679138
Epoch: 21, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.134 Vali Acc: 0.982 Test Loss: 0.134 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0000123
	speed: 0.5241s/iter; left time: 17048.4526s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.2798s/iter; left time: 9074.5785s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.2709s/iter; left time: 8756.3512s
	iters: 400, epoch: 22 | loss: 0.0000012
	speed: 0.2522s/iter; left time: 8126.4283s
Epoch: 22 cost time: 110.50247097015381
Epoch: 22, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.120 Vali Acc: 0.982 Test Loss: 0.120 Test Acc: 0.982
Validation loss decreased (-0.982263 --> -0.982263).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000004
	speed: 0.5371s/iter; left time: 17250.5438s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.2639s/iter; left time: 8447.5131s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.2864s/iter; left time: 9140.7777s
	iters: 400, epoch: 23 | loss: 0.0002065
	speed: 0.2991s/iter; left time: 9514.9189s
Epoch: 23 cost time: 117.34901309013367
Epoch: 23, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.261 Vali Acc: 0.971 Test Loss: 0.261 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.5453s/iter; left time: 17286.0440s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.2954s/iter; left time: 9333.7328s
	iters: 300, epoch: 24 | loss: 0.3852689
	speed: 0.2702s/iter; left time: 8512.0348s
	iters: 400, epoch: 24 | loss: 0.0000021
	speed: 0.2864s/iter; left time: 8993.4548s
Epoch: 24 cost time: 117.136878490448
Epoch: 24, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.437 Vali Acc: 0.965 Test Loss: 0.437 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0000027
	speed: 0.5579s/iter; left time: 17457.1206s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.2626s/iter; left time: 8190.9648s
	iters: 300, epoch: 25 | loss: 0.0000002
	speed: 0.2935s/iter; left time: 9123.5400s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.2845s/iter; left time: 8816.2712s
Epoch: 25 cost time: 115.95729231834412
Epoch: 25, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.210 Vali Acc: 0.975 Test Loss: 0.210 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0000001
	speed: 0.5704s/iter; left time: 17612.7119s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.2893s/iter; left time: 8904.8464s
	iters: 300, epoch: 26 | loss: 0.0000144
	speed: 0.2707s/iter; left time: 8304.6406s
	iters: 400, epoch: 26 | loss: 0.1778784
	speed: 0.2773s/iter; left time: 8478.0158s
Epoch: 26 cost time: 118.00008273124695
Epoch: 26, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.232 Vali Acc: 0.977 Test Loss: 0.232 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0309483
	speed: 0.5323s/iter; left time: 16216.2498s
	iters: 200, epoch: 27 | loss: 0.0000001
	speed: 0.2838s/iter; left time: 8615.8701s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.2854s/iter; left time: 8635.5829s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.2759s/iter; left time: 8322.2576s
Epoch: 27 cost time: 115.84674334526062
Epoch: 27, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.203 Vali Acc: 0.978 Test Loss: 0.203 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0017947
	speed: 0.5470s/iter; left time: 16438.7660s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.2755s/iter; left time: 8250.8307s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.2907s/iter; left time: 8676.3856s
	iters: 400, epoch: 28 | loss: 0.0000007
	speed: 0.2833s/iter; left time: 8428.5209s
Epoch: 28 cost time: 116.52585244178772
Epoch: 28, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.358 Vali Acc: 0.957 Test Loss: 0.358 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0014086
	speed: 0.5415s/iter; left time: 16048.4267s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.2790s/iter; left time: 8239.5684s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.2624s/iter; left time: 7723.7008s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.3023s/iter; left time: 8867.4177s
Epoch: 29 cost time: 117.27051210403442
Epoch: 29, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.131 Vali Acc: 0.981 Test Loss: 0.131 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0000041
	speed: 0.5779s/iter; left time: 16889.4158s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.2870s/iter; left time: 8357.1968s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.2828s/iter; left time: 8208.3146s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.2752s/iter; left time: 7959.7601s
Epoch: 30 cost time: 117.71239519119263
Epoch: 30, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.275 Vali Acc: 0.979 Test Loss: 0.275 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0401519
	speed: 0.5626s/iter; left time: 16210.4520s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.2670s/iter; left time: 7664.9879s
	iters: 300, epoch: 31 | loss: 0.1191884
	speed: 0.2700s/iter; left time: 7724.9796s
	iters: 400, epoch: 31 | loss: 0.0000137
	speed: 0.2798s/iter; left time: 7976.5439s
Epoch: 31 cost time: 115.38965511322021
Epoch: 31, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.108 Vali Acc: 0.987 Test Loss: 0.108 Test Acc: 0.987
Validation loss decreased (-0.982263 --> -0.986811).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.5538s/iter; left time: 15728.0637s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.2711s/iter; left time: 7672.8255s
	iters: 300, epoch: 32 | loss: 0.0036958
	speed: 0.2573s/iter; left time: 7255.9265s
	iters: 400, epoch: 32 | loss: 0.0000030
	speed: 0.2747s/iter; left time: 7719.4576s
Epoch: 32 cost time: 114.22477269172668
Epoch: 32, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.235 Vali Acc: 0.973 Test Loss: 0.235 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.0773894
	speed: 0.5223s/iter; left time: 14617.0131s
	iters: 200, epoch: 33 | loss: 1.3128495
	speed: 0.2749s/iter; left time: 7664.7975s
	iters: 300, epoch: 33 | loss: 0.1802722
	speed: 0.2790s/iter; left time: 7751.4804s
	iters: 400, epoch: 33 | loss: 0.0000013
	speed: 0.2514s/iter; left time: 6959.3257s
Epoch: 33 cost time: 109.9698588848114
Epoch: 33, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.267 Vali Acc: 0.971 Test Loss: 0.267 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 0.0000001
	speed: 0.5313s/iter; left time: 14649.1513s
	iters: 200, epoch: 34 | loss: 0.0003016
	speed: 0.2584s/iter; left time: 7098.3958s
	iters: 300, epoch: 34 | loss: 0.2577836
	speed: 0.2565s/iter; left time: 7021.5041s
	iters: 400, epoch: 34 | loss: 0.0000016
	speed: 0.2655s/iter; left time: 7241.4001s
Epoch: 34 cost time: 110.45779418945312
Epoch: 34, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.144 Vali Acc: 0.982 Test Loss: 0.144 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 0.0000251
	speed: 0.5123s/iter; left time: 13913.3933s
	iters: 200, epoch: 35 | loss: 0.0000008
	speed: 0.2835s/iter; left time: 7670.8725s
	iters: 300, epoch: 35 | loss: 0.0242040
	speed: 0.2769s/iter; left time: 7463.7358s
	iters: 400, epoch: 35 | loss: 0.0000002
	speed: 0.2670s/iter; left time: 7170.7164s
Epoch: 35 cost time: 111.76676988601685
Epoch: 35, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.151 Vali Acc: 0.977 Test Loss: 0.151 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 0.0034890
	speed: 0.5531s/iter; left time: 14794.4851s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.2570s/iter; left time: 6848.5418s
	iters: 300, epoch: 36 | loss: 0.0000029
	speed: 0.2628s/iter; left time: 6976.6713s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.2793s/iter; left time: 7386.1877s
Epoch: 36 cost time: 112.04441595077515
Epoch: 36, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.131 Vali Acc: 0.980 Test Loss: 0.131 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 37 | loss: 0.0004151
	speed: 0.4805s/iter; left time: 12652.1270s
	iters: 200, epoch: 37 | loss: 0.0000000
	speed: 0.2857s/iter; left time: 7495.3105s
	iters: 300, epoch: 37 | loss: 0.0002613
	speed: 0.2683s/iter; left time: 7011.5145s
	iters: 400, epoch: 37 | loss: 0.0000391
	speed: 0.2623s/iter; left time: 6829.5435s
Epoch: 37 cost time: 110.87528920173645
Epoch: 37, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.304 Vali Acc: 0.972 Test Loss: 0.304 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.5646s/iter; left time: 14633.2476s
	iters: 200, epoch: 38 | loss: 0.1204611
	speed: 0.2683s/iter; left time: 6927.0613s
	iters: 300, epoch: 38 | loss: 0.0000290
	speed: 0.2676s/iter; left time: 6881.4243s
	iters: 400, epoch: 38 | loss: 0.0000000
	speed: 0.2658s/iter; left time: 6810.4824s
Epoch: 38 cost time: 112.86342334747314
Epoch: 38, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.142 Vali Acc: 0.980 Test Loss: 0.142 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 39 | loss: 0.0000000
	speed: 0.5045s/iter; left time: 12868.7005s
	iters: 200, epoch: 39 | loss: 0.0000008
	speed: 0.2750s/iter; left time: 6987.9105s
	iters: 300, epoch: 39 | loss: 0.0000001
	speed: 0.2640s/iter; left time: 6680.1450s
	iters: 400, epoch: 39 | loss: 0.2526252
	speed: 0.2588s/iter; left time: 6523.1698s
Epoch: 39 cost time: 109.15164065361023
Epoch: 39, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.119 Vali Acc: 0.983 Test Loss: 0.119 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 40 | loss: 0.0000008
	speed: 0.5392s/iter; left time: 13531.8679s
	iters: 200, epoch: 40 | loss: 0.0000079
	speed: 0.2741s/iter; left time: 6849.8093s
	iters: 300, epoch: 40 | loss: 0.0000000
	speed: 0.2819s/iter; left time: 7017.4952s
	iters: 400, epoch: 40 | loss: 0.0234687
	speed: 0.2714s/iter; left time: 6728.6450s
Epoch: 40 cost time: 113.85082721710205
Epoch: 40, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.071 Vali Acc: 0.989 Test Loss: 0.071 Test Acc: 0.989
Validation loss decreased (-0.986811 --> -0.989085).  Saving model ...
	iters: 100, epoch: 41 | loss: 0.0003340
	speed: 0.5258s/iter; left time: 12976.3230s
	iters: 200, epoch: 41 | loss: 0.0000001
	speed: 0.2514s/iter; left time: 6179.5761s
	iters: 300, epoch: 41 | loss: 0.0000004
	speed: 0.2685s/iter; left time: 6572.4849s
	iters: 400, epoch: 41 | loss: 0.0000009
	speed: 0.2474s/iter; left time: 6032.2770s
Epoch: 41 cost time: 105.05089497566223
Epoch: 41, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.171 Vali Acc: 0.971 Test Loss: 0.171 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 42 | loss: 0.0000010
	speed: 0.5245s/iter; left time: 12728.6014s
	iters: 200, epoch: 42 | loss: 0.0000001
	speed: 0.2687s/iter; left time: 6493.6928s
	iters: 300, epoch: 42 | loss: 0.0000005
	speed: 0.2855s/iter; left time: 6871.7349s
	iters: 400, epoch: 42 | loss: 0.0005069
	speed: 0.2651s/iter; left time: 6353.3130s
Epoch: 42 cost time: 111.84744310379028
Epoch: 42, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.152 Vali Acc: 0.976 Test Loss: 0.152 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 43 | loss: 0.0000088
	speed: 0.5343s/iter; left time: 12745.0970s
	iters: 200, epoch: 43 | loss: 0.0006075
	speed: 0.2522s/iter; left time: 5991.0880s
	iters: 300, epoch: 43 | loss: 0.0000001
	speed: 0.2712s/iter; left time: 6415.4845s
	iters: 400, epoch: 43 | loss: 0.0002141
	speed: 0.2662s/iter; left time: 6270.7831s
Epoch: 43 cost time: 109.81232619285583
Epoch: 43, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.118 Vali Acc: 0.981 Test Loss: 0.118 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 44 | loss: 0.0000000
	speed: 0.5430s/iter; left time: 12728.3515s
	iters: 200, epoch: 44 | loss: 0.0000000
	speed: 0.2789s/iter; left time: 6510.5739s
	iters: 300, epoch: 44 | loss: 0.0035120
	speed: 0.2740s/iter; left time: 6368.9797s
	iters: 400, epoch: 44 | loss: 0.0000022
	speed: 0.2801s/iter; left time: 6482.1851s
Epoch: 44 cost time: 116.01173830032349
Epoch: 44, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.985 Test Loss: 0.095 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 45 | loss: 0.0000000
	speed: 0.5338s/iter; left time: 12291.7858s
	iters: 200, epoch: 45 | loss: 0.0000042
	speed: 0.2570s/iter; left time: 5893.1938s
	iters: 300, epoch: 45 | loss: 0.0000000
	speed: 0.2690s/iter; left time: 6140.4955s
	iters: 400, epoch: 45 | loss: 0.0000000
	speed: 0.2683s/iter; left time: 6099.1888s
Epoch: 45 cost time: 111.14378261566162
Epoch: 45, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.984 Test Loss: 0.094 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 46 | loss: 0.0000004
	speed: 0.5349s/iter; left time: 12097.4287s
	iters: 200, epoch: 46 | loss: 0.0000156
	speed: 0.2792s/iter; left time: 6286.0795s
	iters: 300, epoch: 46 | loss: 0.0000002
	speed: 0.2743s/iter; left time: 6149.3347s
	iters: 400, epoch: 46 | loss: 0.0667361
	speed: 0.2822s/iter; left time: 6297.5057s
Epoch: 46 cost time: 115.93821382522583
Epoch: 46, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.136 Vali Acc: 0.978 Test Loss: 0.136 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 47 | loss: 0.0000007
	speed: 0.5475s/iter; left time: 12156.6033s
	iters: 200, epoch: 47 | loss: 0.0000001
	speed: 0.2651s/iter; left time: 5858.8465s
	iters: 300, epoch: 47 | loss: 0.0125866
	speed: 0.2849s/iter; left time: 6267.6336s
	iters: 400, epoch: 47 | loss: 0.0000000
	speed: 0.2824s/iter; left time: 6185.9620s
Epoch: 47 cost time: 115.92467665672302
Epoch: 47, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.233 Vali Acc: 0.964 Test Loss: 0.233 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 48 | loss: 0.0000145
	speed: 0.5523s/iter; left time: 12035.1885s
	iters: 200, epoch: 48 | loss: 0.0005164
	speed: 0.2819s/iter; left time: 6115.2466s
	iters: 300, epoch: 48 | loss: 0.0000203
	speed: 0.2658s/iter; left time: 5738.8221s
	iters: 400, epoch: 48 | loss: 0.0140887
	speed: 0.2874s/iter; left time: 6176.3832s
Epoch: 48 cost time: 116.34989023208618
Epoch: 48, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.096 Vali Acc: 0.984 Test Loss: 0.096 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 49 | loss: 0.0000000
	speed: 0.5194s/iter; left time: 11102.9836s
	iters: 200, epoch: 49 | loss: 0.0000043
	speed: 0.2516s/iter; left time: 5353.4322s
	iters: 300, epoch: 49 | loss: 0.5281132
	speed: 0.2381s/iter; left time: 5041.9713s
	iters: 400, epoch: 49 | loss: 0.0002831
	speed: 0.2967s/iter; left time: 6253.8296s
Epoch: 49 cost time: 110.89066863059998
Epoch: 49, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 50 | loss: 0.0000005
	speed: 0.5296s/iter; left time: 11102.4420s
	iters: 200, epoch: 50 | loss: 0.0000000
	speed: 0.2902s/iter; left time: 6054.0066s
	iters: 300, epoch: 50 | loss: 0.0000001
	speed: 0.2551s/iter; left time: 5297.6943s
	iters: 400, epoch: 50 | loss: 0.0000000
	speed: 0.2944s/iter; left time: 6083.6913s
Epoch: 50 cost time: 115.27294969558716
Epoch: 50, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.985 Test Loss: 0.089 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df128_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9890859481582538
model parameter : 2783754
model size : 20.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0356306
	speed: 0.2936s/iter; left time: 12096.2593s
	iters: 200, epoch: 1 | loss: 0.3361285
	speed: 0.2433s/iter; left time: 10001.2685s
	iters: 300, epoch: 1 | loss: 0.1984730
	speed: 0.2643s/iter; left time: 10837.9172s
	iters: 400, epoch: 1 | loss: 0.0623024
	speed: 0.2815s/iter; left time: 11515.1660s
Epoch: 1 cost time: 111.97056269645691
Epoch: 1, Steps: 413 | Train Loss: 0.614 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
Validation loss decreased (inf --> -0.968166).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0944964
	speed: 0.5440s/iter; left time: 22188.6692s
	iters: 200, epoch: 2 | loss: 0.0050112
	speed: 0.2912s/iter; left time: 11848.0434s
	iters: 300, epoch: 2 | loss: 0.0127652
	speed: 0.2778s/iter; left time: 11274.0965s
	iters: 400, epoch: 2 | loss: 0.0057345
	speed: 0.2914s/iter; left time: 11796.8319s
Epoch: 2 cost time: 118.87562799453735
Epoch: 2, Steps: 413 | Train Loss: 0.096 Vali Loss: 0.088 Vali Acc: 0.972 Test Loss: 0.088 Test Acc: 0.972
Validation loss decreased (-0.968166 --> -0.972259).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0049736
	speed: 0.5090s/iter; left time: 20552.7278s
	iters: 200, epoch: 3 | loss: 0.0011397
	speed: 0.2710s/iter; left time: 10915.3202s
	iters: 300, epoch: 3 | loss: 0.1707945
	speed: 0.2845s/iter; left time: 11430.9782s
	iters: 400, epoch: 3 | loss: 0.1097424
	speed: 0.2910s/iter; left time: 11661.7097s
Epoch: 3 cost time: 115.59651470184326
Epoch: 3, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.178 Vali Acc: 0.962 Test Loss: 0.178 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0042084
	speed: 0.5317s/iter; left time: 21247.1748s
	iters: 200, epoch: 4 | loss: 0.0142681
	speed: 0.3055s/iter; left time: 12179.6124s
	iters: 300, epoch: 4 | loss: 0.3343421
	speed: 0.2836s/iter; left time: 11276.4127s
	iters: 400, epoch: 4 | loss: 0.0000923
	speed: 0.2898s/iter; left time: 11494.7453s
Epoch: 4 cost time: 119.8178608417511
Epoch: 4, Steps: 413 | Train Loss: 0.104 Vali Loss: 0.168 Vali Acc: 0.970 Test Loss: 0.168 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0002087
	speed: 0.5326s/iter; left time: 21064.8225s
	iters: 200, epoch: 5 | loss: 0.0002264
	speed: 0.2770s/iter; left time: 10926.1814s
	iters: 300, epoch: 5 | loss: 0.0004168
	speed: 0.2875s/iter; left time: 11313.0827s
	iters: 400, epoch: 5 | loss: 0.0010529
	speed: 0.2779s/iter; left time: 10907.8899s
Epoch: 5 cost time: 115.15906238555908
Epoch: 5, Steps: 413 | Train Loss: 0.109 Vali Loss: 0.199 Vali Acc: 0.963 Test Loss: 0.199 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0002892
	speed: 0.5504s/iter; left time: 21540.4437s
	iters: 200, epoch: 6 | loss: 0.0179949
	speed: 0.2768s/iter; left time: 10804.4496s
	iters: 300, epoch: 6 | loss: 0.1134943
	speed: 0.2730s/iter; left time: 10630.0657s
	iters: 400, epoch: 6 | loss: 0.0072061
	speed: 0.2844s/iter; left time: 11044.8774s
Epoch: 6 cost time: 116.33568716049194
Epoch: 6, Steps: 413 | Train Loss: 0.113 Vali Loss: 0.189 Vali Acc: 0.975 Test Loss: 0.189 Test Acc: 0.975
Validation loss decreased (-0.972259 --> -0.975441).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.0591251
	speed: 0.5537s/iter; left time: 21439.8304s
	iters: 200, epoch: 7 | loss: 0.0000000
	speed: 0.2888s/iter; left time: 11154.9533s
	iters: 300, epoch: 7 | loss: 0.0000005
	speed: 0.2833s/iter; left time: 10915.0129s
	iters: 400, epoch: 7 | loss: 0.0064245
	speed: 0.2700s/iter; left time: 10375.3283s
Epoch: 7 cost time: 116.81066513061523
Epoch: 7, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.361 Vali Acc: 0.959 Test Loss: 0.361 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1526714
	speed: 0.5416s/iter; left time: 20746.8584s
	iters: 200, epoch: 8 | loss: 0.0000897
	speed: 0.2774s/iter; left time: 10599.1026s
	iters: 300, epoch: 8 | loss: 0.0007611
	speed: 0.2730s/iter; left time: 10402.4277s
	iters: 400, epoch: 8 | loss: 0.0331535
	speed: 0.2816s/iter; left time: 10704.7727s
Epoch: 8 cost time: 115.70721578598022
Epoch: 8, Steps: 413 | Train Loss: 0.118 Vali Loss: 0.170 Vali Acc: 0.970 Test Loss: 0.170 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.1478467
	speed: 0.5510s/iter; left time: 20883.0270s
	iters: 200, epoch: 9 | loss: 0.0000727
	speed: 0.2899s/iter; left time: 10955.5338s
	iters: 300, epoch: 9 | loss: 0.0001346
	speed: 0.2915s/iter; left time: 10987.8120s
	iters: 400, epoch: 9 | loss: 0.1345679
	speed: 0.2874s/iter; left time: 10803.8047s
Epoch: 9 cost time: 118.23170447349548
Epoch: 9, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.233 Vali Acc: 0.970 Test Loss: 0.233 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000305
	speed: 0.5193s/iter; left time: 19466.3457s
	iters: 200, epoch: 10 | loss: 0.0338259
	speed: 0.2649s/iter; left time: 9904.1144s
	iters: 300, epoch: 10 | loss: 0.0002922
	speed: 0.2943s/iter; left time: 10974.1951s
	iters: 400, epoch: 10 | loss: 0.0000016
	speed: 0.2382s/iter; left time: 8855.9976s
Epoch: 10 cost time: 110.88837695121765
Epoch: 10, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.319 Vali Acc: 0.953 Test Loss: 0.319 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0001702
	speed: 0.5084s/iter; left time: 18846.2710s
	iters: 200, epoch: 11 | loss: 0.0004333
	speed: 0.2934s/iter; left time: 10845.9215s
	iters: 300, epoch: 11 | loss: 0.0000007
	speed: 0.2640s/iter; left time: 9733.1741s
	iters: 400, epoch: 11 | loss: 0.0000000
	speed: 0.2921s/iter; left time: 10741.5992s
Epoch: 11 cost time: 113.50104999542236
Epoch: 11, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.190 Vali Acc: 0.970 Test Loss: 0.190 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0035604
	speed: 0.5161s/iter; left time: 18919.6747s
	iters: 200, epoch: 12 | loss: 0.0820273
	speed: 0.2377s/iter; left time: 8690.1994s
	iters: 300, epoch: 12 | loss: 0.0000027
	speed: 0.2944s/iter; left time: 10734.5537s
	iters: 400, epoch: 12 | loss: 0.0005946
	speed: 0.2816s/iter; left time: 10239.2199s
Epoch: 12 cost time: 114.10648822784424
Epoch: 12, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.169 Vali Acc: 0.974 Test Loss: 0.169 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000005
	speed: 0.5852s/iter; left time: 21209.7064s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.3169s/iter; left time: 11455.8378s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.3108s/iter; left time: 11201.3218s
	iters: 400, epoch: 13 | loss: 0.4657173
	speed: 0.3300s/iter; left time: 11863.1898s
Epoch: 13 cost time: 130.71418023109436
Epoch: 13, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.433 Vali Acc: 0.956 Test Loss: 0.433 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.2059577
	speed: 0.6015s/iter; left time: 21551.6921s
	iters: 200, epoch: 14 | loss: 0.0002427
	speed: 0.3240s/iter; left time: 11577.0726s
	iters: 300, epoch: 14 | loss: 0.0069498
	speed: 0.3096s/iter; left time: 11030.3233s
	iters: 400, epoch: 14 | loss: 0.0000058
	speed: 0.3142s/iter; left time: 11165.4545s
Epoch: 14 cost time: 127.69965744018555
Epoch: 14, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.153 Vali Acc: 0.980 Test Loss: 0.153 Test Acc: 0.980
Validation loss decreased (-0.975441 --> -0.979989).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000192
	speed: 0.6646s/iter; left time: 23540.6106s
	iters: 200, epoch: 15 | loss: 0.0000551
	speed: 0.3263s/iter; left time: 11523.7995s
	iters: 300, epoch: 15 | loss: 0.0000001
	speed: 0.3157s/iter; left time: 11119.1871s
	iters: 400, epoch: 15 | loss: 0.0000483
	speed: 0.2840s/iter; left time: 9972.7891s
Epoch: 15 cost time: 131.54585313796997
Epoch: 15, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.194 Vali Acc: 0.971 Test Loss: 0.194 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.6240s/iter; left time: 21842.6845s
	iters: 200, epoch: 16 | loss: 0.0016613
	speed: 0.3136s/iter; left time: 10946.1357s
	iters: 300, epoch: 16 | loss: 0.0008182
	speed: 0.3277s/iter; left time: 11405.0637s
	iters: 400, epoch: 16 | loss: 0.0095739
	speed: 0.3321s/iter; left time: 11526.8375s
Epoch: 16 cost time: 134.6129925251007
Epoch: 16, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.242 Vali Acc: 0.969 Test Loss: 0.242 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000013
	speed: 0.6726s/iter; left time: 23267.9158s
	iters: 200, epoch: 17 | loss: 0.0000004
	speed: 0.3533s/iter; left time: 12185.7533s
	iters: 300, epoch: 17 | loss: 0.0019913
	speed: 0.3647s/iter; left time: 12541.8647s
	iters: 400, epoch: 17 | loss: 0.0001143
	speed: 0.3665s/iter; left time: 12569.7369s
Epoch: 17 cost time: 149.41000509262085
Epoch: 17, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.089 Vali Acc: 0.985 Test Loss: 0.089 Test Acc: 0.985
Validation loss decreased (-0.979989 --> -0.985447).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000011
	speed: 0.7449s/iter; left time: 25461.7207s
	iters: 200, epoch: 18 | loss: 0.0001633
	speed: 0.3282s/iter; left time: 11183.5243s
	iters: 300, epoch: 18 | loss: 0.0001830
	speed: 0.3194s/iter; left time: 10853.8041s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.3281s/iter; left time: 11115.7049s
Epoch: 18 cost time: 138.39814400672913
Epoch: 18, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000021
	speed: 0.6794s/iter; left time: 22940.1476s
	iters: 200, epoch: 19 | loss: 0.0063007
	speed: 0.3253s/iter; left time: 10952.7639s
	iters: 300, epoch: 19 | loss: 0.0003124
	speed: 0.3352s/iter; left time: 11250.5532s
	iters: 400, epoch: 19 | loss: 0.3216163
	speed: 0.3233s/iter; left time: 10819.5481s
Epoch: 19 cost time: 137.44574403762817
Epoch: 19, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.293 Vali Acc: 0.965 Test Loss: 0.293 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000011
	speed: 0.6617s/iter; left time: 22071.6678s
	iters: 200, epoch: 20 | loss: 0.0001655
	speed: 0.3438s/iter; left time: 11432.8686s
	iters: 300, epoch: 20 | loss: 0.0025393
	speed: 0.3233s/iter; left time: 10717.1412s
	iters: 400, epoch: 20 | loss: 0.0000020
	speed: 0.3513s/iter; left time: 11611.5764s
Epoch: 20 cost time: 138.6530363559723
Epoch: 20, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.292 Vali Acc: 0.966 Test Loss: 0.292 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.6638s/iter; left time: 21866.0243s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.3305s/iter; left time: 10855.3113s
	iters: 300, epoch: 21 | loss: 0.0000581
	speed: 0.3369s/iter; left time: 11030.3815s
	iters: 400, epoch: 21 | loss: 0.3647587
	speed: 0.3256s/iter; left time: 10628.2765s
Epoch: 21 cost time: 138.29329895973206
Epoch: 21, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.288 Vali Acc: 0.973 Test Loss: 0.288 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.6657s/iter; left time: 21653.1542s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.3539s/iter; left time: 11477.5185s
	iters: 300, epoch: 22 | loss: 0.2368777
	speed: 0.3323s/iter; left time: 10743.4621s
	iters: 400, epoch: 22 | loss: 0.0000096
	speed: 0.3387s/iter; left time: 10916.7451s
Epoch: 22 cost time: 139.28102207183838
Epoch: 22, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.122 Vali Acc: 0.982 Test Loss: 0.122 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0009153
	speed: 0.6721s/iter; left time: 21584.4061s
	iters: 200, epoch: 23 | loss: 0.0347938
	speed: 0.3324s/iter; left time: 10640.5379s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.3605s/iter; left time: 11505.5819s
	iters: 400, epoch: 23 | loss: 0.0000002
	speed: 0.3322s/iter; left time: 10569.0890s
Epoch: 23 cost time: 142.00505590438843
Epoch: 23, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.316 Vali Acc: 0.976 Test Loss: 0.316 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.4284501
	speed: 0.7001s/iter; left time: 22193.2706s
	iters: 200, epoch: 24 | loss: 0.0000159
	speed: 0.3426s/iter; left time: 10827.3664s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.3200s/iter; left time: 10080.8180s
	iters: 400, epoch: 24 | loss: 0.0708504
	speed: 0.3270s/iter; left time: 10269.3769s
Epoch: 24 cost time: 137.02423572540283
Epoch: 24, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.188 Vali Acc: 0.981 Test Loss: 0.188 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.6770s/iter; left time: 21181.8729s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.3425s/iter; left time: 10680.7094s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.3604s/iter; left time: 11205.2404s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.3479s/iter; left time: 10780.2883s
Epoch: 25 cost time: 144.69716024398804
Epoch: 25, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.192 Vali Acc: 0.973 Test Loss: 0.192 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0000054
	speed: 0.7403s/iter; left time: 22858.3098s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.3601s/iter; left time: 11081.2662s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.3741s/iter; left time: 11475.6727s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.3790s/iter; left time: 11587.3025s
Epoch: 26 cost time: 154.2960720062256
Epoch: 26, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.346 Vali Acc: 0.973 Test Loss: 0.346 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.7213s/iter; left time: 21971.5424s
	iters: 200, epoch: 27 | loss: 0.0000004
	speed: 0.3695s/iter; left time: 11219.2624s
	iters: 300, epoch: 27 | loss: 0.0000004
	speed: 0.3560s/iter; left time: 10772.1610s
	iters: 400, epoch: 27 | loss: 0.0000003
	speed: 0.3563s/iter; left time: 10748.4108s
Epoch: 27 cost time: 149.9836184978485
Epoch: 27, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.163 Vali Acc: 0.980 Test Loss: 0.163 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9854479308776717
model parameter : 2783754
model size : 20.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0118451
	speed: 0.3454s/iter; left time: 14229.3385s
	iters: 200, epoch: 1 | loss: 0.5204479
	speed: 0.3648s/iter; left time: 14994.0255s
	iters: 300, epoch: 1 | loss: 0.1405350
	speed: 0.3369s/iter; left time: 13812.0193s
	iters: 400, epoch: 1 | loss: 0.0566275
	speed: 0.3485s/iter; left time: 14252.8501s
Epoch: 1 cost time: 144.58163261413574
Epoch: 1, Steps: 413 | Train Loss: 0.603 Vali Loss: 0.137 Vali Acc: 0.955 Test Loss: 0.137 Test Acc: 0.955
Validation loss decreased (inf --> -0.954978).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0180021
	speed: 0.6700s/iter; left time: 27328.4966s
	iters: 200, epoch: 2 | loss: 0.0102246
	speed: 0.3260s/iter; left time: 13263.8300s
	iters: 300, epoch: 2 | loss: 0.0023578
	speed: 0.3404s/iter; left time: 13817.3085s
	iters: 400, epoch: 2 | loss: 0.0155710
	speed: 0.3455s/iter; left time: 13987.7619s
Epoch: 2 cost time: 138.4328851699829
Epoch: 2, Steps: 413 | Train Loss: 0.110 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
Validation loss decreased (-0.954978 --> -0.967711).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0016455
	speed: 0.6755s/iter; left time: 27274.4754s
	iters: 200, epoch: 3 | loss: 0.0074385
	speed: 0.3410s/iter; left time: 13734.0522s
	iters: 300, epoch: 3 | loss: 0.0002549
	speed: 0.3400s/iter; left time: 13657.5756s
	iters: 400, epoch: 3 | loss: 0.0007356
	speed: 0.3346s/iter; left time: 13408.1345s
Epoch: 3 cost time: 139.281005859375
Epoch: 3, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
Validation loss decreased (-0.967711 --> -0.970895).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0001068
	speed: 0.6888s/iter; left time: 27524.1279s
	iters: 200, epoch: 4 | loss: 0.0981048
	speed: 0.3272s/iter; left time: 13043.6565s
	iters: 300, epoch: 4 | loss: 0.0070086
	speed: 0.3142s/iter; left time: 12493.3257s
	iters: 400, epoch: 4 | loss: 0.0001207
	speed: 0.3178s/iter; left time: 12604.0207s
Epoch: 4 cost time: 134.85789513587952
Epoch: 4, Steps: 413 | Train Loss: 0.105 Vali Loss: 0.194 Vali Acc: 0.960 Test Loss: 0.194 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000598
	speed: 0.6488s/iter; left time: 25659.8471s
	iters: 200, epoch: 5 | loss: 0.4039811
	speed: 0.3042s/iter; left time: 11999.7686s
	iters: 300, epoch: 5 | loss: 0.0004673
	speed: 0.3192s/iter; left time: 12559.0521s
	iters: 400, epoch: 5 | loss: 0.0000074
	speed: 0.3364s/iter; left time: 13204.4677s
Epoch: 5 cost time: 132.3260498046875
Epoch: 5, Steps: 413 | Train Loss: 0.103 Vali Loss: 0.273 Vali Acc: 0.958 Test Loss: 0.273 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0321321
	speed: 0.6468s/iter; left time: 25311.8372s
	iters: 200, epoch: 6 | loss: 0.0130465
	speed: 0.3240s/iter; left time: 12648.2287s
	iters: 300, epoch: 6 | loss: 0.3904058
	speed: 0.3415s/iter; left time: 13294.7275s
	iters: 400, epoch: 6 | loss: 0.2538957
	speed: 0.3202s/iter; left time: 12436.4214s
Epoch: 6 cost time: 135.45107221603394
Epoch: 6, Steps: 413 | Train Loss: 0.125 Vali Loss: 0.253 Vali Acc: 0.971 Test Loss: 0.253 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0226222
	speed: 0.6950s/iter; left time: 26912.9272s
	iters: 200, epoch: 7 | loss: 0.0000001
	speed: 0.3264s/iter; left time: 12606.1080s
	iters: 300, epoch: 7 | loss: 0.0045208
	speed: 0.3322s/iter; left time: 12798.5832s
	iters: 400, epoch: 7 | loss: 0.3636077
	speed: 0.3491s/iter; left time: 13412.4135s
Epoch: 7 cost time: 141.53371024131775
Epoch: 7, Steps: 413 | Train Loss: 0.101 Vali Loss: 0.280 Vali Acc: 0.954 Test Loss: 0.280 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0000034
	speed: 0.7076s/iter; left time: 27109.3539s
	iters: 200, epoch: 8 | loss: 0.8715248
	speed: 0.3520s/iter; left time: 13448.5201s
	iters: 300, epoch: 8 | loss: 0.0212761
	speed: 0.3667s/iter; left time: 13974.4236s
	iters: 400, epoch: 8 | loss: 0.0008569
	speed: 0.3433s/iter; left time: 13047.1297s
Epoch: 8 cost time: 145.38083338737488
Epoch: 8, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.216 Vali Acc: 0.964 Test Loss: 0.216 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0158432
	speed: 0.7042s/iter; left time: 26688.3039s
	iters: 200, epoch: 9 | loss: 0.0011103
	speed: 0.3484s/iter; left time: 13168.2374s
	iters: 300, epoch: 9 | loss: 0.0000018
	speed: 0.3450s/iter; left time: 13003.8443s
	iters: 400, epoch: 9 | loss: 0.1381085
	speed: 0.3640s/iter; left time: 13686.7503s
Epoch: 9 cost time: 146.5152382850647
Epoch: 9, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.266 Vali Acc: 0.959 Test Loss: 0.266 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.1128337
	speed: 0.7323s/iter; left time: 27451.1132s
	iters: 200, epoch: 10 | loss: 0.0022441
	speed: 0.3416s/iter; left time: 12771.8356s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.3572s/iter; left time: 13319.6264s
	iters: 400, epoch: 10 | loss: 0.8454247
	speed: 0.3381s/iter; left time: 12571.7471s
Epoch: 10 cost time: 144.455472946167
Epoch: 10, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.296 Vali Acc: 0.966 Test Loss: 0.296 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0000091
	speed: 0.6819s/iter; left time: 25278.9529s
	iters: 200, epoch: 11 | loss: 0.0001371
	speed: 0.3542s/iter; left time: 13093.9780s
	iters: 300, epoch: 11 | loss: 0.0000005
	speed: 0.3342s/iter; left time: 12323.6498s
	iters: 400, epoch: 11 | loss: 0.0477841
	speed: 0.3413s/iter; left time: 12550.4556s
Epoch: 11 cost time: 142.86248230934143
Epoch: 11, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.238 Vali Acc: 0.967 Test Loss: 0.238 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000004
	speed: 0.7401s/iter; left time: 27132.3283s
	iters: 200, epoch: 12 | loss: 0.0000076
	speed: 0.3649s/iter; left time: 13340.2033s
	iters: 300, epoch: 12 | loss: 0.0055689
	speed: 0.3800s/iter; left time: 13854.5523s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.4018s/iter; left time: 14609.5953s
Epoch: 12 cost time: 157.3946497440338
Epoch: 12, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.294 Vali Acc: 0.966 Test Loss: 0.294 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0000002
	speed: 0.7333s/iter; left time: 26577.0152s
	iters: 200, epoch: 13 | loss: 0.0222930
	speed: 0.3654s/iter; left time: 13207.6844s
	iters: 300, epoch: 13 | loss: 0.0000000
	speed: 0.3689s/iter; left time: 13298.7065s
	iters: 400, epoch: 13 | loss: 0.0000001
	speed: 0.3568s/iter; left time: 12824.0640s
Epoch: 13 cost time: 151.64694046974182
Epoch: 13, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.331 Vali Acc: 0.967 Test Loss: 0.331 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9708958617553434
model parameter : 2783754
model size : 20.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0029571
	speed: 0.3921s/iter; left time: 16154.1810s
	iters: 200, epoch: 1 | loss: 0.5849661
	speed: 0.3667s/iter; left time: 15072.2800s
	iters: 300, epoch: 1 | loss: 0.1019998
	speed: 0.3818s/iter; left time: 15654.0528s
	iters: 400, epoch: 1 | loss: 0.0538944
	speed: 0.3758s/iter; left time: 15370.7512s
Epoch: 1 cost time: 156.60172247886658
Epoch: 1, Steps: 413 | Train Loss: 0.599 Vali Loss: 0.098 Vali Acc: 0.969 Test Loss: 0.098 Test Acc: 0.969
Validation loss decreased (inf --> -0.968621).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0159254
	speed: 0.7263s/iter; left time: 29623.6561s
	iters: 200, epoch: 2 | loss: 0.0693474
	speed: 0.3604s/iter; left time: 14664.5223s
	iters: 300, epoch: 2 | loss: 0.0460864
	speed: 0.3496s/iter; left time: 14187.8855s
	iters: 400, epoch: 2 | loss: 0.0021744
	speed: 0.3487s/iter; left time: 14118.4287s
Epoch: 2 cost time: 147.23931336402893
Epoch: 2, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.091 Vali Acc: 0.974 Test Loss: 0.091 Test Acc: 0.974
Validation loss decreased (-0.968621 --> -0.973623).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0118447
	speed: 0.7468s/iter; left time: 30150.7144s
	iters: 200, epoch: 3 | loss: 0.1397386
	speed: 0.3533s/iter; left time: 14229.2975s
	iters: 300, epoch: 3 | loss: 0.0000150
	speed: 0.3704s/iter; left time: 14879.1274s
	iters: 400, epoch: 3 | loss: 0.2119382
	speed: 0.3835s/iter; left time: 15370.1445s
Epoch: 3 cost time: 153.66596102714539
Epoch: 3, Steps: 413 | Train Loss: 0.119 Vali Loss: 0.195 Vali Acc: 0.953 Test Loss: 0.195 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0003263
	speed: 0.7567s/iter; left time: 30237.8806s
	iters: 200, epoch: 4 | loss: 0.0022386
	speed: 0.3878s/iter; left time: 15459.5420s
	iters: 300, epoch: 4 | loss: 0.0172972
	speed: 0.3707s/iter; left time: 14739.1914s
	iters: 400, epoch: 4 | loss: 0.0000358
	speed: 0.3633s/iter; left time: 14408.3696s
Epoch: 4 cost time: 153.71751356124878
Epoch: 4, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
Validation loss decreased (-0.973623 --> -0.980900).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0002254
	speed: 0.7489s/iter; left time: 29616.7604s
	iters: 200, epoch: 5 | loss: 0.0011501
	speed: 0.3493s/iter; left time: 13781.3685s
	iters: 300, epoch: 5 | loss: 0.1428658
	speed: 0.3708s/iter; left time: 14589.0247s
	iters: 400, epoch: 5 | loss: 0.0001059
	speed: 0.3735s/iter; left time: 14660.9842s
Epoch: 5 cost time: 151.88803434371948
Epoch: 5, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.228 Vali Acc: 0.958 Test Loss: 0.228 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0009481
	speed: 0.7392s/iter; left time: 28930.5209s
	iters: 200, epoch: 6 | loss: 0.0283836
	speed: 0.4025s/iter; left time: 15712.2972s
	iters: 300, epoch: 6 | loss: 0.2878633
	speed: 0.3840s/iter; left time: 14951.0966s
	iters: 400, epoch: 6 | loss: 1.8112780
	speed: 0.3794s/iter; left time: 14734.2828s
Epoch: 6 cost time: 157.53193712234497
Epoch: 6, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.175 Vali Acc: 0.965 Test Loss: 0.175 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0014129
	speed: 0.7715s/iter; left time: 29873.1414s
	iters: 200, epoch: 7 | loss: 0.0000001
	speed: 0.3887s/iter; left time: 15012.1666s
	iters: 300, epoch: 7 | loss: 0.0946078
	speed: 0.3716s/iter; left time: 14316.0556s
	iters: 400, epoch: 7 | loss: 0.0407254
	speed: 0.4046s/iter; left time: 15545.5663s
Epoch: 7 cost time: 159.98285913467407
Epoch: 7, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.228 Vali Acc: 0.964 Test Loss: 0.228 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0008299
	speed: 0.7675s/iter; left time: 29402.9922s
	iters: 200, epoch: 8 | loss: 0.3777709
	speed: 0.3851s/iter; left time: 14713.9328s
	iters: 300, epoch: 8 | loss: 0.0000128
	speed: 0.3812s/iter; left time: 14525.7684s
	iters: 400, epoch: 8 | loss: 0.0000000
	speed: 0.3765s/iter; left time: 14312.2405s
Epoch: 8 cost time: 158.28434324264526
Epoch: 8, Steps: 413 | Train Loss: 0.111 Vali Loss: 0.173 Vali Acc: 0.973 Test Loss: 0.173 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.7993s/iter; left time: 30291.3027s
	iters: 200, epoch: 9 | loss: 0.4803778
	speed: 0.4010s/iter; left time: 15157.2555s
	iters: 300, epoch: 9 | loss: 0.0029750
	speed: 0.3865s/iter; left time: 14568.2122s
	iters: 400, epoch: 9 | loss: 0.8179714
	speed: 0.4019s/iter; left time: 15110.2074s
Epoch: 9 cost time: 164.34983801841736
Epoch: 9, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.232 Vali Acc: 0.970 Test Loss: 0.232 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0000165
	speed: 0.7664s/iter; left time: 28726.7810s
	iters: 200, epoch: 10 | loss: 0.1032726
	speed: 0.3763s/iter; left time: 14069.2858s
	iters: 300, epoch: 10 | loss: 0.0000001
	speed: 0.3672s/iter; left time: 13690.3025s
	iters: 400, epoch: 10 | loss: 0.0454909
	speed: 0.3963s/iter; left time: 14737.1502s
Epoch: 10 cost time: 158.01050662994385
Epoch: 10, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.366 Vali Acc: 0.959 Test Loss: 0.366 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0003093
	speed: 0.7904s/iter; left time: 29300.2597s
	iters: 200, epoch: 11 | loss: 0.0003913
	speed: 0.3875s/iter; left time: 14326.1565s
	iters: 300, epoch: 11 | loss: 0.0000009
	speed: 0.3945s/iter; left time: 14546.3668s
	iters: 400, epoch: 11 | loss: 0.0000002
	speed: 0.3785s/iter; left time: 13918.8829s
Epoch: 11 cost time: 159.78853368759155
Epoch: 11, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.304 Vali Acc: 0.969 Test Loss: 0.304 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.3511697
	speed: 0.7418s/iter; left time: 27191.5521s
	iters: 200, epoch: 12 | loss: 0.0050889
	speed: 0.3524s/iter; left time: 12883.4710s
	iters: 300, epoch: 12 | loss: 0.0000001
	speed: 0.3674s/iter; left time: 13394.6098s
	iters: 400, epoch: 12 | loss: 0.0000012
	speed: 0.3648s/iter; left time: 13263.3749s
Epoch: 12 cost time: 150.16936492919922
Epoch: 12, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.271 Vali Acc: 0.968 Test Loss: 0.271 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0007011
	speed: 0.7341s/iter; left time: 26605.9281s
	iters: 200, epoch: 13 | loss: 0.0000272
	speed: 0.3706s/iter; left time: 13396.1371s
	iters: 300, epoch: 13 | loss: 0.1503098
	speed: 0.3626s/iter; left time: 13070.2997s
	iters: 400, epoch: 13 | loss: 0.0000002
	speed: 0.3702s/iter; left time: 13307.6619s
Epoch: 13 cost time: 152.41623306274414
Epoch: 13, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.186 Vali Acc: 0.976 Test Loss: 0.186 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000012
	speed: 0.7649s/iter; left time: 27408.3778s
	iters: 200, epoch: 14 | loss: 0.0000002
	speed: 0.3552s/iter; left time: 12693.7920s
	iters: 300, epoch: 14 | loss: 0.0000001
	speed: 0.3633s/iter; left time: 12946.1976s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.3505s/iter; left time: 12452.1994s
Epoch: 14 cost time: 149.9616277217865
Epoch: 14, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.158 Vali Acc: 0.978 Test Loss: 0.158 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9809004092769441
model parameter : 2783754
model size : 20.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.3014615
	speed: 0.3789s/iter; left time: 15609.1074s
	iters: 200, epoch: 1 | loss: 2.3023267
	speed: 0.3526s/iter; left time: 14490.8411s
	iters: 300, epoch: 1 | loss: 2.3017106
	speed: 0.3872s/iter; left time: 15875.4320s
	iters: 400, epoch: 1 | loss: 2.3017511
	speed: 0.4169s/iter; left time: 17051.2116s
Epoch: 1 cost time: 159.48235082626343
Epoch: 1, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (inf --> -0.099568).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3060684
	speed: 0.7627s/iter; left time: 31107.1818s
	iters: 200, epoch: 2 | loss: 2.3017154
	speed: 0.4094s/iter; left time: 16658.4937s
	iters: 300, epoch: 2 | loss: 2.3037503
	speed: 0.3937s/iter; left time: 15978.8495s
	iters: 400, epoch: 2 | loss: 2.3032417
	speed: 0.3915s/iter; left time: 15851.6975s
Epoch: 2 cost time: 161.62618136405945
Epoch: 2, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.099568 --> -0.100022).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3031683
	speed: 0.8016s/iter; left time: 32363.7378s
	iters: 200, epoch: 3 | loss: 2.3033926
	speed: 0.3622s/iter; left time: 14585.7814s
	iters: 300, epoch: 3 | loss: 2.3044183
	speed: 0.3891s/iter; left time: 15631.6143s
	iters: 400, epoch: 3 | loss: 2.3036380
	speed: 0.3846s/iter; left time: 15411.4055s
Epoch: 3 cost time: 158.8227059841156
Epoch: 3, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.3038971
	speed: 0.7716s/iter; left time: 30836.2714s
	iters: 200, epoch: 4 | loss: 2.3007960
	speed: 0.3929s/iter; left time: 15662.5354s
	iters: 300, epoch: 4 | loss: 2.3016369
	speed: 0.3916s/iter; left time: 15569.3240s
	iters: 400, epoch: 4 | loss: 2.3016076
	speed: 0.3703s/iter; left time: 14686.3350s
Epoch: 4 cost time: 160.03569221496582
Epoch: 4, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.3058324
	speed: 0.7931s/iter; left time: 31366.7839s
	iters: 200, epoch: 5 | loss: 2.3032696
	speed: 0.3715s/iter; left time: 14654.7029s
	iters: 300, epoch: 5 | loss: 2.3032131
	speed: 0.3953s/iter; left time: 15555.4291s
	iters: 400, epoch: 5 | loss: 2.3028786
	speed: 0.3928s/iter; left time: 15416.1223s
Epoch: 5 cost time: 160.8970091342926
Epoch: 5, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 2.3038354
	speed: 0.7615s/iter; left time: 29801.1362s
	iters: 200, epoch: 6 | loss: 2.3066192
	speed: 0.3830s/iter; left time: 14951.5017s
	iters: 300, epoch: 6 | loss: 2.3037238
	speed: 0.3872s/iter; left time: 15076.1919s
	iters: 400, epoch: 6 | loss: 2.3025026
	speed: 0.3973s/iter; left time: 15431.1673s
Epoch: 6 cost time: 161.2315754890442
Epoch: 6, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 2.3057320
	speed: 0.8273s/iter; left time: 32036.2387s
	iters: 200, epoch: 7 | loss: 2.3016317
	speed: 0.3878s/iter; left time: 14979.7710s
	iters: 300, epoch: 7 | loss: 2.3021874
	speed: 0.4254s/iter; left time: 16388.3453s
	iters: 400, epoch: 7 | loss: 2.3031588
	speed: 0.4057s/iter; left time: 15588.8427s
Epoch: 7 cost time: 168.04131412506104
Epoch: 7, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 2.3046167
	speed: 0.7648s/iter; left time: 29299.9104s
	iters: 200, epoch: 8 | loss: 2.3020775
	speed: 0.4054s/iter; left time: 15491.1583s
	iters: 300, epoch: 8 | loss: 2.2994480
	speed: 0.3877s/iter; left time: 14775.1638s
	iters: 400, epoch: 8 | loss: 2.3027990
	speed: 0.4040s/iter; left time: 15355.0695s
Epoch: 8 cost time: 165.07523608207703
Epoch: 8, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 2.3035793
	speed: 0.8540s/iter; left time: 32363.2738s
	iters: 200, epoch: 9 | loss: 2.3045652
	speed: 0.3886s/iter; left time: 14687.8461s
	iters: 300, epoch: 9 | loss: 2.3002720
	speed: 0.4314s/iter; left time: 16263.7807s
	iters: 400, epoch: 9 | loss: 2.3022592
	speed: 0.4137s/iter; left time: 15555.5922s
Epoch: 9 cost time: 171.47654819488525
Epoch: 9, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 2.3034086
	speed: 0.8041s/iter; left time: 30140.6985s
	iters: 200, epoch: 10 | loss: 2.3006663
	speed: 0.4032s/iter; left time: 15072.9748s
	iters: 300, epoch: 10 | loss: 2.3018231
	speed: 0.3806s/iter; left time: 14189.2269s
	iters: 400, epoch: 10 | loss: 2.3032911
	speed: 0.3824s/iter; left time: 14218.8835s
Epoch: 10 cost time: 163.20810413360596
Epoch: 10, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 2.3045516
	speed: 0.7556s/iter; left time: 28009.9166s
	iters: 200, epoch: 11 | loss: 2.3025982
	speed: 0.3829s/iter; left time: 14157.6722s
	iters: 300, epoch: 11 | loss: 2.3026280
	speed: 0.4149s/iter; left time: 15299.5135s
	iters: 400, epoch: 11 | loss: 2.3028185
	speed: 0.4115s/iter; left time: 15130.2877s
Epoch: 11 cost time: 163.35878610610962
Epoch: 11, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 2.3018899
	speed: 0.8032s/iter; left time: 29444.5994s
	iters: 200, epoch: 12 | loss: 2.3032877
	speed: 0.3980s/iter; left time: 14550.2424s
	iters: 300, epoch: 12 | loss: 2.3040805
	speed: 0.3813s/iter; left time: 13902.6395s
	iters: 400, epoch: 12 | loss: 2.3027525
	speed: 0.3951s/iter; left time: 14366.1526s
Epoch: 12 cost time: 164.94380617141724
Epoch: 12, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm256_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.10004547521600728
model parameter : 2783754
model size : 20.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         47                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2870832
	speed: 0.4017s/iter; left time: 16550.4032s
	iters: 200, epoch: 1 | loss: 0.3261966
	speed: 0.3749s/iter; left time: 15408.4707s
	iters: 300, epoch: 1 | loss: 0.0331491
	speed: 0.3698s/iter; left time: 15163.1266s
	iters: 400, epoch: 1 | loss: 0.1530183
	speed: 0.3921s/iter; left time: 16038.9561s
Epoch: 1 cost time: 159.49785923957825
Epoch: 1, Steps: 413 | Train Loss: 0.425 Vali Loss: 0.066 Vali Acc: 0.979 Test Loss: 0.066 Test Acc: 0.979
Validation loss decreased (inf --> -0.978626).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0058060
	speed: 0.7697s/iter; left time: 31393.9535s
	iters: 200, epoch: 2 | loss: 0.0831294
	speed: 0.3648s/iter; left time: 14843.5100s
	iters: 300, epoch: 2 | loss: 0.0154822
	speed: 0.3884s/iter; left time: 15762.7174s
	iters: 400, epoch: 2 | loss: 0.0462868
	speed: 0.3860s/iter; left time: 15628.8208s
Epoch: 2 cost time: 156.97399520874023
Epoch: 2, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.078 Vali Acc: 0.974 Test Loss: 0.078 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0024724
	speed: 0.8042s/iter; left time: 32468.6768s
	iters: 200, epoch: 3 | loss: 0.0062722
	speed: 0.4333s/iter; left time: 17449.8261s
	iters: 300, epoch: 3 | loss: 0.0036903
	speed: 0.4059s/iter; left time: 16305.6879s
	iters: 400, epoch: 3 | loss: 0.0030652
	speed: 0.3907s/iter; left time: 15655.3904s
Epoch: 3 cost time: 170.9280071258545
Epoch: 3, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.109 Vali Acc: 0.967 Test Loss: 0.109 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0532447
	speed: 0.8262s/iter; left time: 33015.6412s
	iters: 200, epoch: 4 | loss: 0.1869305
	speed: 0.4125s/iter; left time: 16443.8840s
	iters: 300, epoch: 4 | loss: 0.0001872
	speed: 0.4118s/iter; left time: 16373.7842s
	iters: 400, epoch: 4 | loss: 0.0284414
	speed: 0.4058s/iter; left time: 16095.7124s
Epoch: 4 cost time: 169.2042920589447
Epoch: 4, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.147 Vali Acc: 0.965 Test Loss: 0.147 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.1836999
	speed: 0.8212s/iter; left time: 32479.0971s
	iters: 200, epoch: 5 | loss: 0.0006150
	speed: 0.3951s/iter; left time: 15587.6068s
	iters: 300, epoch: 5 | loss: 0.0029029
	speed: 0.3916s/iter; left time: 15409.2993s
	iters: 400, epoch: 5 | loss: 0.1277506
	speed: 0.3749s/iter; left time: 14714.5296s
Epoch: 5 cost time: 162.0035183429718
Epoch: 5, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0002248
	speed: 0.7841s/iter; left time: 30687.0705s
	iters: 200, epoch: 6 | loss: 0.2711977
	speed: 0.3789s/iter; left time: 14792.3073s
	iters: 300, epoch: 6 | loss: 0.0003090
	speed: 0.4124s/iter; left time: 16056.6257s
	iters: 400, epoch: 6 | loss: 0.0001371
	speed: 0.3733s/iter; left time: 14499.3452s
Epoch: 6 cost time: 161.99534034729004
Epoch: 6, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.1642599
	speed: 0.8094s/iter; left time: 31341.0610s
	iters: 200, epoch: 7 | loss: 0.0002193
	speed: 0.3978s/iter; left time: 15363.0306s
	iters: 300, epoch: 7 | loss: 0.0000261
	speed: 0.4140s/iter; left time: 15946.9046s
	iters: 400, epoch: 7 | loss: 0.0006118
	speed: 0.3721s/iter; left time: 14296.2451s
Epoch: 7 cost time: 163.66357898712158
Epoch: 7, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.079 Vali Acc: 0.982 Test Loss: 0.079 Test Acc: 0.982
Validation loss decreased (-0.978626 --> -0.982264).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000329
	speed: 0.8206s/iter; left time: 31438.1699s
	iters: 200, epoch: 8 | loss: 0.0000483
	speed: 0.3708s/iter; left time: 14169.3439s
	iters: 300, epoch: 8 | loss: 0.3409344
	speed: 0.3817s/iter; left time: 14547.0694s
	iters: 400, epoch: 8 | loss: 0.0014390
	speed: 0.3693s/iter; left time: 14036.5658s
Epoch: 8 cost time: 158.98096323013306
Epoch: 8, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.113 Vali Acc: 0.979 Test Loss: 0.113 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0004415
	speed: 0.7777s/iter; left time: 29472.8784s
	iters: 200, epoch: 9 | loss: 0.0000778
	speed: 0.3718s/iter; left time: 14052.9640s
	iters: 300, epoch: 9 | loss: 0.0076179
	speed: 0.3736s/iter; left time: 14083.2859s
	iters: 400, epoch: 9 | loss: 0.0005626
	speed: 0.3653s/iter; left time: 13734.3009s
Epoch: 9 cost time: 155.22786569595337
Epoch: 9, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.072 Vali Acc: 0.984 Test Loss: 0.072 Test Acc: 0.984
Validation loss decreased (-0.982264 --> -0.984083).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0001045
	speed: 0.7468s/iter; left time: 27994.9084s
	iters: 200, epoch: 10 | loss: 0.0000032
	speed: 0.3770s/iter; left time: 14093.2307s
	iters: 300, epoch: 10 | loss: 0.0000077
	speed: 0.3681s/iter; left time: 13722.4072s
	iters: 400, epoch: 10 | loss: 0.0001316
	speed: 0.3900s/iter; left time: 14502.2354s
Epoch: 10 cost time: 157.64650583267212
Epoch: 10, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.124 Vali Acc: 0.974 Test Loss: 0.124 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0001218
	speed: 0.7556s/iter; left time: 28009.3892s
	iters: 200, epoch: 11 | loss: 0.0000082
	speed: 0.3705s/iter; left time: 13697.6760s
	iters: 300, epoch: 11 | loss: 0.0000468
	speed: 0.3554s/iter; left time: 13102.5269s
	iters: 400, epoch: 11 | loss: 0.3184766
	speed: 0.3606s/iter; left time: 13261.4499s
Epoch: 11 cost time: 151.7063660621643
Epoch: 11, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.149 Vali Acc: 0.972 Test Loss: 0.149 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0007199
	speed: 0.7180s/iter; left time: 26319.7126s
	iters: 200, epoch: 12 | loss: 0.0001558
	speed: 0.3929s/iter; left time: 14362.3738s
	iters: 300, epoch: 12 | loss: 0.0000002
	speed: 0.3631s/iter; left time: 13239.6042s
	iters: 400, epoch: 12 | loss: 0.0000017
	speed: 0.3796s/iter; left time: 13800.1509s
Epoch: 12 cost time: 154.78110671043396
Epoch: 12, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.125 Vali Acc: 0.978 Test Loss: 0.125 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0025576
	speed: 0.7337s/iter; left time: 26593.3445s
	iters: 200, epoch: 13 | loss: 0.3077146
	speed: 0.3581s/iter; left time: 12944.2703s
	iters: 300, epoch: 13 | loss: 0.0000004
	speed: 0.3532s/iter; left time: 12732.8115s
	iters: 400, epoch: 13 | loss: 0.0666441
	speed: 0.3363s/iter; left time: 12088.5628s
Epoch: 13 cost time: 145.425372838974
Epoch: 13, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.099 Vali Acc: 0.986 Test Loss: 0.099 Test Acc: 0.986
Validation loss decreased (-0.984083 --> -0.985902).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000365
	speed: 0.7456s/iter; left time: 26716.1353s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.3886s/iter; left time: 13886.6888s
	iters: 300, epoch: 14 | loss: 0.0000025
	speed: 0.3825s/iter; left time: 13629.2444s
	iters: 400, epoch: 14 | loss: 0.0027713
	speed: 0.3747s/iter; left time: 13312.1281s
Epoch: 14 cost time: 158.45150780677795
Epoch: 14, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.102 Vali Acc: 0.981 Test Loss: 0.102 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.7958s/iter; left time: 28188.1176s
	iters: 200, epoch: 15 | loss: 0.1354373
	speed: 0.3937s/iter; left time: 13904.4291s
	iters: 300, epoch: 15 | loss: 0.0000027
	speed: 0.3926s/iter; left time: 13826.6485s
	iters: 400, epoch: 15 | loss: 0.0000008
	speed: 0.3651s/iter; left time: 12822.4943s
Epoch: 15 cost time: 159.6949393749237
Epoch: 15, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.144 Vali Acc: 0.978 Test Loss: 0.144 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0034120
	speed: 0.7394s/iter; left time: 25884.4713s
	iters: 200, epoch: 16 | loss: 0.0000128
	speed: 0.3802s/iter; left time: 13270.3875s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.3967s/iter; left time: 13808.8400s
	iters: 400, epoch: 16 | loss: 0.0008646
	speed: 0.3830s/iter; left time: 13290.6756s
Epoch: 16 cost time: 157.20078134536743
Epoch: 16, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.183 Vali Acc: 0.975 Test Loss: 0.183 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0000078
	speed: 0.7962s/iter; left time: 27542.0928s
	iters: 200, epoch: 17 | loss: 0.0112729
	speed: 0.3986s/iter; left time: 13750.5854s
	iters: 300, epoch: 17 | loss: 0.3420489
	speed: 0.4018s/iter; left time: 13820.7395s
	iters: 400, epoch: 17 | loss: 0.0000935
	speed: 0.3718s/iter; left time: 12750.3752s
Epoch: 17 cost time: 162.64664602279663
Epoch: 17, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.214 Vali Acc: 0.970 Test Loss: 0.214 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000322
	speed: 0.7819s/iter; left time: 26726.0988s
	iters: 200, epoch: 18 | loss: 0.0000270
	speed: 0.3861s/iter; left time: 13159.7275s
	iters: 300, epoch: 18 | loss: 0.0258063
	speed: 0.4017s/iter; left time: 13650.1596s
	iters: 400, epoch: 18 | loss: 0.1053069
	speed: 0.3570s/iter; left time: 12094.1316s
Epoch: 18 cost time: 158.54050850868225
Epoch: 18, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.196 Vali Acc: 0.974 Test Loss: 0.196 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0000006
	speed: 0.7710s/iter; left time: 26033.9170s
	iters: 200, epoch: 19 | loss: 0.0002167
	speed: 0.3747s/iter; left time: 12614.6530s
	iters: 300, epoch: 19 | loss: 0.0000001
	speed: 0.3851s/iter; left time: 12927.7323s
	iters: 400, epoch: 19 | loss: 0.0000016
	speed: 0.3946s/iter; left time: 13206.0575s
Epoch: 19 cost time: 159.03481197357178
Epoch: 19, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.108 Vali Acc: 0.981 Test Loss: 0.108 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.7736s/iter; left time: 25801.5373s
	iters: 200, epoch: 20 | loss: 0.0034453
	speed: 0.3955s/iter; left time: 13151.1339s
	iters: 300, epoch: 20 | loss: 0.0000097
	speed: 0.4014s/iter; left time: 13308.9360s
	iters: 400, epoch: 20 | loss: 0.0000012
	speed: 0.3634s/iter; left time: 12011.6020s
Epoch: 20 cost time: 160.12485456466675
Epoch: 20, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.181 Vali Acc: 0.979 Test Loss: 0.181 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.7611s/iter; left time: 25070.8484s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.3866s/iter; left time: 12695.1716s
	iters: 300, epoch: 21 | loss: 0.0083458
	speed: 0.3757s/iter; left time: 12302.4024s
	iters: 400, epoch: 21 | loss: 0.0549451
	speed: 0.3912s/iter; left time: 12768.1393s
Epoch: 21 cost time: 156.88521027565002
Epoch: 21, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.270 Vali Acc: 0.970 Test Loss: 0.270 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0000002
	speed: 0.7716s/iter; left time: 25098.9734s
	iters: 200, epoch: 22 | loss: 0.0000037
	speed: 0.3727s/iter; left time: 12087.1745s
	iters: 300, epoch: 22 | loss: 0.0055685
	speed: 0.4049s/iter; left time: 13090.8059s
	iters: 400, epoch: 22 | loss: 0.0251298
	speed: 0.3686s/iter; left time: 11879.2759s
Epoch: 22 cost time: 160.2101492881775
Epoch: 22, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.175 Vali Acc: 0.978 Test Loss: 0.175 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0010918
	speed: 0.7759s/iter; left time: 24918.4380s
	iters: 200, epoch: 23 | loss: 0.0000003
	speed: 0.3978s/iter; left time: 12734.0299s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.3591s/iter; left time: 11460.1834s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.3872s/iter; left time: 12317.8942s
Epoch: 23 cost time: 157.77040266990662
Epoch: 23, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.202 Vali Acc: 0.972 Test Loss: 0.202 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9859026830377444
model parameter : 2284810
model size : 13.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         38                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3213997
	speed: 0.3795s/iter; left time: 15634.8567s
	iters: 200, epoch: 1 | loss: 0.3132137
	speed: 0.3663s/iter; left time: 15055.1219s
	iters: 300, epoch: 1 | loss: 0.0365057
	speed: 0.4018s/iter; left time: 16473.2163s
	iters: 400, epoch: 1 | loss: 0.1498296
	speed: 0.3898s/iter; left time: 15943.5546s
Epoch: 1 cost time: 159.0249044895172
Epoch: 1, Steps: 413 | Train Loss: 0.455 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (inf --> -0.983174).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0148174
	speed: 0.7832s/iter; left time: 31945.6230s
	iters: 200, epoch: 2 | loss: 0.0140550
	speed: 0.3977s/iter; left time: 16181.2521s
	iters: 300, epoch: 2 | loss: 0.0793009
	speed: 0.3877s/iter; left time: 15736.1130s
	iters: 400, epoch: 2 | loss: 0.0356571
	speed: 0.4130s/iter; left time: 16719.5730s
Epoch: 2 cost time: 162.76782059669495
Epoch: 2, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.084 Vali Acc: 0.975 Test Loss: 0.084 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.2723088
	speed: 0.7852s/iter; left time: 31700.4910s
	iters: 200, epoch: 3 | loss: 0.0251874
	speed: 0.3925s/iter; left time: 15808.3561s
	iters: 300, epoch: 3 | loss: 0.0063920
	speed: 0.3960s/iter; left time: 15909.9523s
	iters: 400, epoch: 3 | loss: 0.0644110
	speed: 0.3913s/iter; left time: 15680.7194s
Epoch: 3 cost time: 164.1165931224823
Epoch: 3, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.080 Vali Acc: 0.975 Test Loss: 0.080 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0181109
	speed: 0.8159s/iter; left time: 32603.6951s
	iters: 200, epoch: 4 | loss: 0.0146393
	speed: 0.3995s/iter; left time: 15924.0687s
	iters: 300, epoch: 4 | loss: 0.0000612
	speed: 0.3796s/iter; left time: 15094.0174s
	iters: 400, epoch: 4 | loss: 0.0013658
	speed: 0.4088s/iter; left time: 16213.8120s
Epoch: 4 cost time: 164.79993867874146
Epoch: 4, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.2970925
	speed: 0.7888s/iter; left time: 31197.7901s
	iters: 200, epoch: 5 | loss: 0.0003761
	speed: 0.3758s/iter; left time: 14823.1752s
	iters: 300, epoch: 5 | loss: 0.0005584
	speed: 0.3947s/iter; left time: 15530.0104s
	iters: 400, epoch: 5 | loss: 0.0675088
	speed: 0.3896s/iter; left time: 15290.9813s
Epoch: 5 cost time: 160.28591179847717
Epoch: 5, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0021701
	speed: 0.8116s/iter; left time: 31762.8097s
	iters: 200, epoch: 6 | loss: 0.0009145
	speed: 0.3760s/iter; left time: 14677.1767s
	iters: 300, epoch: 6 | loss: 0.0003314
	speed: 0.4211s/iter; left time: 16394.0053s
	iters: 400, epoch: 6 | loss: 0.0059986
	speed: 0.3912s/iter; left time: 15193.2652s
Epoch: 6 cost time: 164.69679403305054
Epoch: 6, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.1784829
	speed: 0.7796s/iter; left time: 30188.9457s
	iters: 200, epoch: 7 | loss: 0.0013239
	speed: 0.4174s/iter; left time: 16120.8907s
	iters: 300, epoch: 7 | loss: 0.0017250
	speed: 0.3863s/iter; left time: 14879.5752s
	iters: 400, epoch: 7 | loss: 0.0001219
	speed: 0.4021s/iter; left time: 15449.3809s
Epoch: 7 cost time: 163.3039677143097
Epoch: 7, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.127 Vali Acc: 0.969 Test Loss: 0.127 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.0000424
	speed: 0.8183s/iter; left time: 31350.7796s
	iters: 200, epoch: 8 | loss: 0.0002018
	speed: 0.3977s/iter; left time: 15196.7004s
	iters: 300, epoch: 8 | loss: 0.1172840
	speed: 0.4013s/iter; left time: 15291.8762s
	iters: 400, epoch: 8 | loss: 0.0001372
	speed: 0.4133s/iter; left time: 15707.8480s
Epoch: 8 cost time: 167.60888004302979
Epoch: 8, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.0145220
	speed: 0.7379s/iter; left time: 27964.0542s
	iters: 200, epoch: 9 | loss: 0.0000059
	speed: 0.3722s/iter; left time: 14068.4039s
	iters: 300, epoch: 9 | loss: 0.0002578
	speed: 0.3703s/iter; left time: 13959.2718s
	iters: 400, epoch: 9 | loss: 0.0019802
	speed: 0.3699s/iter; left time: 13906.8655s
Epoch: 9 cost time: 153.04949593544006
Epoch: 9, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.0056992
	speed: 0.7550s/iter; left time: 28298.6599s
	iters: 200, epoch: 10 | loss: 0.0004448
	speed: 0.3776s/iter; left time: 14115.2689s
	iters: 300, epoch: 10 | loss: 0.0000734
	speed: 0.3715s/iter; left time: 13850.9612s
	iters: 400, epoch: 10 | loss: 0.0000021
	speed: 0.3844s/iter; left time: 14295.1836s
Epoch: 10 cost time: 156.04821944236755
Epoch: 10, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.129 Vali Acc: 0.976 Test Loss: 0.129 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.2746186
	speed: 0.7703s/iter; left time: 28554.4315s
	iters: 200, epoch: 11 | loss: 0.0000124
	speed: 0.3979s/iter; left time: 14711.4695s
	iters: 300, epoch: 11 | loss: 0.0000065
	speed: 0.3626s/iter; left time: 13370.9810s
	iters: 400, epoch: 11 | loss: 0.0000025
	speed: 0.3723s/iter; left time: 13688.3046s
Epoch: 11 cost time: 157.5862579345703
Epoch: 11, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.096 Vali Acc: 0.981 Test Loss: 0.096 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9831741700773079
model parameter : 2284810
model size : 13.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         28                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3957236
	speed: 0.3618s/iter; left time: 14904.9261s
	iters: 200, epoch: 1 | loss: 0.4061208
	speed: 0.3525s/iter; left time: 14489.8948s
	iters: 300, epoch: 1 | loss: 0.0291372
	speed: 0.3629s/iter; left time: 14877.8348s
	iters: 400, epoch: 1 | loss: 0.1134178
	speed: 0.3692s/iter; left time: 15102.3123s
Epoch: 1 cost time: 149.7677938938141
Epoch: 1, Steps: 413 | Train Loss: 0.506 Vali Loss: 0.067 Vali Acc: 0.981 Test Loss: 0.067 Test Acc: 0.981
Validation loss decreased (inf --> -0.981354).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0229522
	speed: 0.7400s/iter; left time: 30182.8363s
	iters: 200, epoch: 2 | loss: 0.1033987
	speed: 0.3578s/iter; left time: 14558.1236s
	iters: 300, epoch: 2 | loss: 0.1393743
	speed: 0.3651s/iter; left time: 14817.5580s
	iters: 400, epoch: 2 | loss: 0.0840497
	speed: 0.3549s/iter; left time: 14367.5270s
Epoch: 2 cost time: 149.63281750679016
Epoch: 2, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.062 Vali Acc: 0.979 Test Loss: 0.062 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0432686
	speed: 0.6960s/iter; left time: 28099.4645s
	iters: 200, epoch: 3 | loss: 0.0013771
	speed: 0.3509s/iter; left time: 14133.3785s
	iters: 300, epoch: 3 | loss: 0.0257557
	speed: 0.3424s/iter; left time: 13757.8700s
	iters: 400, epoch: 3 | loss: 0.0181226
	speed: 0.3345s/iter; left time: 13406.1033s
Epoch: 3 cost time: 141.92926669120789
Epoch: 3, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.093 Vali Acc: 0.969 Test Loss: 0.093 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.2633063
	speed: 0.6908s/iter; left time: 27605.3505s
	iters: 200, epoch: 4 | loss: 0.0010826
	speed: 0.3409s/iter; left time: 13590.0270s
	iters: 300, epoch: 4 | loss: 0.0003133
	speed: 0.3393s/iter; left time: 13489.2660s
	iters: 400, epoch: 4 | loss: 0.0022842
	speed: 0.3309s/iter; left time: 13125.5064s
Epoch: 4 cost time: 141.2451913356781
Epoch: 4, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.126 Vali Acc: 0.964 Test Loss: 0.126 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.5143527
	speed: 0.6787s/iter; left time: 26839.9927s
	iters: 200, epoch: 5 | loss: 0.0045823
	speed: 0.3454s/iter; left time: 13626.8598s
	iters: 300, epoch: 5 | loss: 0.0021624
	speed: 0.3383s/iter; left time: 13312.1153s
	iters: 400, epoch: 5 | loss: 0.0103918
	speed: 0.3373s/iter; left time: 13237.8952s
Epoch: 5 cost time: 140.668781042099
Epoch: 5, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.060 Vali Acc: 0.982 Test Loss: 0.060 Test Acc: 0.982
Validation loss decreased (-0.981354 --> -0.981809).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0830889
	speed: 0.6897s/iter; left time: 26992.4693s
	iters: 200, epoch: 6 | loss: 0.0787382
	speed: 0.3537s/iter; left time: 13806.4645s
	iters: 300, epoch: 6 | loss: 0.0452494
	speed: 0.3429s/iter; left time: 13351.4529s
	iters: 400, epoch: 6 | loss: 0.0042499
	speed: 0.3493s/iter; left time: 13563.5719s
Epoch: 6 cost time: 143.0961949825287
Epoch: 6, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0008209
	speed: 0.7251s/iter; left time: 28079.3056s
	iters: 200, epoch: 7 | loss: 0.0002852
	speed: 0.3619s/iter; left time: 13977.7514s
	iters: 300, epoch: 7 | loss: 0.0040389
	speed: 0.3553s/iter; left time: 13689.0812s
	iters: 400, epoch: 7 | loss: 0.0291954
	speed: 0.3484s/iter; left time: 13386.6067s
Epoch: 7 cost time: 147.58242964744568
Epoch: 7, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0002348
	speed: 0.7192s/iter; left time: 27551.7906s
	iters: 200, epoch: 8 | loss: 0.0001597
	speed: 0.3543s/iter; left time: 13539.4890s
	iters: 300, epoch: 8 | loss: 0.6543984
	speed: 0.3607s/iter; left time: 13746.8942s
	iters: 400, epoch: 8 | loss: 0.0000723
	speed: 0.3587s/iter; left time: 13635.1081s
Epoch: 8 cost time: 147.56075644493103
Epoch: 8, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.981809 --> -0.982719).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0023347
	speed: 0.7283s/iter; left time: 27600.9510s
	iters: 200, epoch: 9 | loss: 0.0000223
	speed: 0.3766s/iter; left time: 14234.7288s
	iters: 300, epoch: 9 | loss: 0.0001165
	speed: 0.3456s/iter; left time: 13028.5349s
	iters: 400, epoch: 9 | loss: 0.0008566
	speed: 0.3528s/iter; left time: 13265.7565s
Epoch: 9 cost time: 149.20880150794983
Epoch: 9, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.114 Vali Acc: 0.978 Test Loss: 0.114 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0101463
	speed: 0.7731s/iter; left time: 28979.8768s
	iters: 200, epoch: 10 | loss: 0.0000527
	speed: 0.4040s/iter; left time: 15103.1102s
	iters: 300, epoch: 10 | loss: 0.0001536
	speed: 0.3880s/iter; left time: 14466.9518s
	iters: 400, epoch: 10 | loss: 0.0671660
	speed: 0.3708s/iter; left time: 13786.0659s
Epoch: 10 cost time: 161.15159630775452
Epoch: 10, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.203 Vali Acc: 0.965 Test Loss: 0.203 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0002454
	speed: 0.7589s/iter; left time: 28134.9175s
	iters: 200, epoch: 11 | loss: 0.0002958
	speed: 0.3783s/iter; left time: 13985.6861s
	iters: 300, epoch: 11 | loss: 0.0003716
	speed: 0.3752s/iter; left time: 13833.0311s
	iters: 400, epoch: 11 | loss: 0.0000697
	speed: 0.3706s/iter; left time: 13629.1390s
Epoch: 11 cost time: 155.34163427352905
Epoch: 11, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000004
	speed: 0.7813s/iter; left time: 28640.0374s
	iters: 200, epoch: 12 | loss: 0.0001329
	speed: 0.3822s/iter; left time: 13971.3687s
	iters: 300, epoch: 12 | loss: 0.0000226
	speed: 0.3905s/iter; left time: 14237.5705s
	iters: 400, epoch: 12 | loss: 0.0000003
	speed: 0.3924s/iter; left time: 14267.5213s
Epoch: 12 cost time: 161.48966908454895
Epoch: 12, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.160 Vali Acc: 0.968 Test Loss: 0.160 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0001204
	speed: 0.7735s/iter; left time: 28034.8138s
	iters: 200, epoch: 13 | loss: 0.7161046
	speed: 0.3680s/iter; left time: 13302.8382s
	iters: 300, epoch: 13 | loss: 0.0000149
	speed: 0.3752s/iter; left time: 13524.5799s
	iters: 400, epoch: 13 | loss: 0.0003871
	speed: 0.3689s/iter; left time: 13260.0627s
Epoch: 13 cost time: 154.70272016525269
Epoch: 13, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0036906
	speed: 0.7398s/iter; left time: 26510.0044s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.3706s/iter; left time: 13242.6479s
	iters: 300, epoch: 14 | loss: 0.0026986
	speed: 0.3730s/iter; left time: 13291.3194s
	iters: 400, epoch: 14 | loss: 0.0080203
	speed: 0.3864s/iter; left time: 13729.7410s
Epoch: 14 cost time: 155.516455411911
Epoch: 14, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.099 Vali Acc: 0.984 Test Loss: 0.099 Test Acc: 0.984
Validation loss decreased (-0.982719 --> -0.983628).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000004
	speed: 0.8128s/iter; left time: 28787.4162s
	iters: 200, epoch: 15 | loss: 0.0000013
	speed: 0.3845s/iter; left time: 13580.8305s
	iters: 300, epoch: 15 | loss: 0.0060474
	speed: 0.3936s/iter; left time: 13860.6473s
	iters: 400, epoch: 15 | loss: 0.0000025
	speed: 0.3724s/iter; left time: 13078.1288s
Epoch: 15 cost time: 160.99589347839355
Epoch: 15, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.151 Vali Acc: 0.978 Test Loss: 0.151 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0154915
	speed: 0.8046s/iter; left time: 28164.5757s
	iters: 200, epoch: 16 | loss: 0.0000031
	speed: 0.3948s/iter; left time: 13782.2133s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.4050s/iter; left time: 14096.9857s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.4193s/iter; left time: 14552.6189s
Epoch: 16 cost time: 167.9071536064148
Epoch: 16, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.192 Vali Acc: 0.975 Test Loss: 0.192 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.1502891
	speed: 0.8058s/iter; left time: 27875.1778s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.4056s/iter; left time: 13988.9854s
	iters: 300, epoch: 17 | loss: 0.0000347
	speed: 0.3998s/iter; left time: 13750.9677s
	iters: 400, epoch: 17 | loss: 0.0000038
	speed: 0.3634s/iter; left time: 12461.3337s
Epoch: 17 cost time: 162.3833522796631
Epoch: 17, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.166 Vali Acc: 0.978 Test Loss: 0.166 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0004328
	speed: 0.7687s/iter; left time: 26274.7632s
	iters: 200, epoch: 18 | loss: 0.0000020
	speed: 0.3723s/iter; left time: 12687.5344s
	iters: 300, epoch: 18 | loss: 0.0000112
	speed: 0.3656s/iter; left time: 12424.3394s
	iters: 400, epoch: 18 | loss: 0.0000123
	speed: 0.3953s/iter; left time: 13393.8305s
Epoch: 18 cost time: 156.78975105285645
Epoch: 18, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.129 Vali Acc: 0.980 Test Loss: 0.129 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0023536
	speed: 0.7671s/iter; left time: 25902.9204s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.3983s/iter; left time: 13410.6283s
	iters: 300, epoch: 19 | loss: 0.0000001
	speed: 0.3940s/iter; left time: 13226.3256s
	iters: 400, epoch: 19 | loss: 0.0009132
	speed: 0.3953s/iter; left time: 13229.0140s
Epoch: 19 cost time: 162.3120617866516
Epoch: 19, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.239 Vali Acc: 0.967 Test Loss: 0.239 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.6538088
	speed: 0.7779s/iter; left time: 25944.8094s
	iters: 200, epoch: 20 | loss: 0.5004269
	speed: 0.3780s/iter; left time: 12569.1383s
	iters: 300, epoch: 20 | loss: 0.0004947
	speed: 0.3783s/iter; left time: 12543.1384s
	iters: 400, epoch: 20 | loss: 0.2395823
	speed: 0.3878s/iter; left time: 12817.3463s
Epoch: 20 cost time: 159.17695665359497
Epoch: 20, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.101 Vali Acc: 0.985 Test Loss: 0.101 Test Acc: 0.985
Validation loss decreased (-0.983628 --> -0.984537).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.7851s/iter; left time: 25861.8978s
	iters: 200, epoch: 21 | loss: 0.0000006
	speed: 0.3950s/iter; left time: 12972.5858s
	iters: 300, epoch: 21 | loss: 0.0021618
	speed: 0.4272s/iter; left time: 13987.9435s
	iters: 400, epoch: 21 | loss: 0.0401922
	speed: 0.3938s/iter; left time: 12853.0312s
Epoch: 21 cost time: 168.92500138282776
Epoch: 21, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.201 Vali Acc: 0.975 Test Loss: 0.201 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0117425
	speed: 0.8238s/iter; left time: 26795.5032s
	iters: 200, epoch: 22 | loss: 0.0000045
	speed: 0.3761s/iter; left time: 12195.6147s
	iters: 300, epoch: 22 | loss: 0.0003486
	speed: 0.3762s/iter; left time: 12161.9989s
	iters: 400, epoch: 22 | loss: 0.0000003
	speed: 0.3781s/iter; left time: 12185.7095s
Epoch: 22 cost time: 159.5572693347931
Epoch: 22, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.181 Vali Acc: 0.975 Test Loss: 0.181 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0006103
	speed: 0.8006s/iter; left time: 25712.3814s
	iters: 200, epoch: 23 | loss: 0.0000694
	speed: 0.3885s/iter; left time: 12436.6869s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.4053s/iter; left time: 12933.6551s
	iters: 400, epoch: 23 | loss: 0.0000166
	speed: 0.3974s/iter; left time: 12642.0561s
Epoch: 23 cost time: 163.99965167045593
Epoch: 23, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.223 Vali Acc: 0.974 Test Loss: 0.223 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0220128
	speed: 0.7780s/iter; left time: 24663.0714s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.4173s/iter; left time: 13188.3071s
	iters: 300, epoch: 24 | loss: 0.0006125
	speed: 0.4003s/iter; left time: 12609.0025s
	iters: 400, epoch: 24 | loss: 0.0000795
	speed: 0.3774s/iter; left time: 11850.8875s
Epoch: 24 cost time: 163.96504712104797
Epoch: 24, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.090 Vali Acc: 0.986 Test Loss: 0.090 Test Acc: 0.986
Validation loss decreased (-0.984537 --> -0.986357).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0003232
	speed: 0.7840s/iter; left time: 24531.3125s
	iters: 200, epoch: 25 | loss: 0.0000977
	speed: 0.3781s/iter; left time: 11792.8659s
	iters: 300, epoch: 25 | loss: 0.0000184
	speed: 0.3829s/iter; left time: 11903.3953s
	iters: 400, epoch: 25 | loss: 0.0000001
	speed: 0.3832s/iter; left time: 11874.7662s
Epoch: 25 cost time: 157.85336065292358
Epoch: 25, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0000117
	speed: 0.7830s/iter; left time: 24176.5841s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.3863s/iter; left time: 11887.6405s
	iters: 300, epoch: 26 | loss: 0.0004789
	speed: 0.3632s/iter; left time: 11140.9194s
	iters: 400, epoch: 26 | loss: 0.0000001
	speed: 0.3630s/iter; left time: 11098.0492s
Epoch: 26 cost time: 154.63771796226501
Epoch: 26, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.110 Vali Acc: 0.983 Test Loss: 0.110 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.7249s/iter; left time: 22081.4343s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.3689s/iter; left time: 11199.5583s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.3447s/iter; left time: 10432.8924s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.3477s/iter; left time: 10488.3251s
Epoch: 27 cost time: 147.1048469543457
Epoch: 27, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.093 Vali Acc: 0.985 Test Loss: 0.093 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0000060
	speed: 0.7056s/iter; left time: 21202.9932s
	iters: 200, epoch: 28 | loss: 0.0000005
	speed: 0.3616s/iter; left time: 10831.3058s
	iters: 300, epoch: 28 | loss: 0.0000257
	speed: 0.3624s/iter; left time: 10818.7187s
	iters: 400, epoch: 28 | loss: 0.0000063
	speed: 0.3494s/iter; left time: 10394.1022s
Epoch: 28 cost time: 148.29046249389648
Epoch: 28, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.155 Vali Acc: 0.977 Test Loss: 0.155 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0000045
	speed: 0.7116s/iter; left time: 21088.4354s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.3614s/iter; left time: 10673.9214s
	iters: 300, epoch: 29 | loss: 0.0039269
	speed: 0.3545s/iter; left time: 10436.6532s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.3585s/iter; left time: 10518.5170s
Epoch: 29 cost time: 147.57807731628418
Epoch: 29, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.103 Vali Acc: 0.985 Test Loss: 0.103 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.7047s/iter; left time: 20594.1739s
	iters: 200, epoch: 30 | loss: 0.0146028
	speed: 0.3528s/iter; left time: 10276.0204s
	iters: 300, epoch: 30 | loss: 0.0000335
	speed: 0.3693s/iter; left time: 10719.2637s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.3557s/iter; left time: 10287.3601s
Epoch: 30 cost time: 148.13660097122192
Epoch: 30, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.132 Vali Acc: 0.982 Test Loss: 0.132 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.0000050
	speed: 0.7111s/iter; left time: 20487.9339s
	iters: 200, epoch: 31 | loss: 0.0000299
	speed: 0.3579s/iter; left time: 10276.6408s
	iters: 300, epoch: 31 | loss: 0.0004421
	speed: 0.3489s/iter; left time: 9983.4825s
	iters: 400, epoch: 31 | loss: 0.2709788
	speed: 0.3553s/iter; left time: 10130.7807s
Epoch: 31 cost time: 146.5556001663208
Epoch: 31, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.181 Vali Acc: 0.976 Test Loss: 0.181 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.3749356
	speed: 0.6917s/iter; left time: 19641.9166s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.3430s/iter; left time: 9705.2451s
	iters: 300, epoch: 32 | loss: 0.0000012
	speed: 0.3534s/iter; left time: 9964.6461s
	iters: 400, epoch: 32 | loss: 0.0001283
	speed: 0.3347s/iter; left time: 9405.1427s
Epoch: 32 cost time: 143.41086554527283
Epoch: 32, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.247 Vali Acc: 0.975 Test Loss: 0.247 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.7518s/iter; left time: 21038.2804s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.3851s/iter; left time: 10739.1630s
	iters: 300, epoch: 33 | loss: 0.0004788
	speed: 0.3622s/iter; left time: 10063.4517s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.3650s/iter; left time: 10105.2266s
Epoch: 33 cost time: 153.39340925216675
Epoch: 33, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.111 Vali Acc: 0.985 Test Loss: 0.111 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.9112166
	speed: 0.6946s/iter; left time: 19150.4266s
	iters: 200, epoch: 34 | loss: 0.0000002
	speed: 0.3389s/iter; left time: 9310.3805s
	iters: 300, epoch: 34 | loss: 0.0006296
	speed: 0.3362s/iter; left time: 9202.2078s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.3334s/iter; left time: 9093.4351s
Epoch: 34 cost time: 139.87495684623718
Epoch: 34, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.107 Vali Acc: 0.985 Test Loss: 0.107 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9863574351978172
model parameter : 2284810
model size : 13.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7550582
	speed: 0.3464s/iter; left time: 14270.7083s
	iters: 200, epoch: 1 | loss: 0.4515960
	speed: 0.3493s/iter; left time: 14355.6325s
	iters: 300, epoch: 1 | loss: 0.0307839
	speed: 0.3508s/iter; left time: 14382.7768s
	iters: 400, epoch: 1 | loss: 0.1374872
	speed: 0.3486s/iter; left time: 14256.5969s
Epoch: 1 cost time: 144.51169204711914
Epoch: 1, Steps: 413 | Train Loss: 0.581 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
Validation loss decreased (inf --> -0.976352).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0092243
	speed: 0.7171s/iter; left time: 29250.5469s
	iters: 200, epoch: 2 | loss: 0.1377799
	speed: 0.3454s/iter; left time: 14054.5747s
	iters: 300, epoch: 2 | loss: 0.0174662
	speed: 0.3387s/iter; left time: 13746.9373s
	iters: 400, epoch: 2 | loss: 0.0845361
	speed: 0.3364s/iter; left time: 13620.8548s
Epoch: 2 cost time: 141.78150939941406
Epoch: 2, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.116 Vali Acc: 0.963 Test Loss: 0.116 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0275839
	speed: 0.6715s/iter; left time: 27113.5211s
	iters: 200, epoch: 3 | loss: 0.0021920
	speed: 0.3415s/iter; left time: 13754.9991s
	iters: 300, epoch: 3 | loss: 0.0618859
	speed: 0.3546s/iter; left time: 14246.6046s
	iters: 400, epoch: 3 | loss: 0.0407979
	speed: 0.3551s/iter; left time: 14231.2358s
Epoch: 3 cost time: 144.06243300437927
Epoch: 3, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.124 Vali Acc: 0.964 Test Loss: 0.124 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0040044
	speed: 0.6845s/iter; left time: 27353.8981s
	iters: 200, epoch: 4 | loss: 0.0500976
	speed: 0.3421s/iter; left time: 13637.4567s
	iters: 300, epoch: 4 | loss: 0.0307295
	speed: 0.3181s/iter; left time: 12647.6345s
	iters: 400, epoch: 4 | loss: 0.1083644
	speed: 0.3225s/iter; left time: 12792.1884s
Epoch: 4 cost time: 136.9450466632843
Epoch: 4, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.144 Vali Acc: 0.960 Test Loss: 0.144 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.2633800
	speed: 0.6418s/iter; left time: 25384.2589s
	iters: 200, epoch: 5 | loss: 0.0218117
	speed: 0.3225s/iter; left time: 12723.4143s
	iters: 300, epoch: 5 | loss: 0.0047997
	speed: 0.3220s/iter; left time: 12671.5000s
	iters: 400, epoch: 5 | loss: 0.0044734
	speed: 0.3139s/iter; left time: 12319.3485s
Epoch: 5 cost time: 133.13638257980347
Epoch: 5, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.2248351
	speed: 0.6335s/iter; left time: 24791.9098s
	iters: 200, epoch: 6 | loss: 0.0003913
	speed: 0.3196s/iter; left time: 12475.4890s
	iters: 300, epoch: 6 | loss: 0.0085820
	speed: 0.3182s/iter; left time: 12388.5029s
	iters: 400, epoch: 6 | loss: 0.0000489
	speed: 0.3153s/iter; left time: 12246.5613s
Epoch: 6 cost time: 130.64676117897034
Epoch: 6, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.085 Vali Acc: 0.979 Test Loss: 0.085 Test Acc: 0.979
Validation loss decreased (-0.976352 --> -0.979081).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0001263
	speed: 0.6428s/iter; left time: 24891.2094s
	iters: 200, epoch: 7 | loss: 0.0041723
	speed: 0.3304s/iter; left time: 12760.9721s
	iters: 300, epoch: 7 | loss: 0.0581552
	speed: 0.3029s/iter; left time: 11668.5437s
	iters: 400, epoch: 7 | loss: 0.0000010
	speed: 0.3149s/iter; left time: 12099.6265s
Epoch: 7 cost time: 132.16593408584595
Epoch: 7, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.142 Vali Acc: 0.968 Test Loss: 0.142 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000009
	speed: 0.6301s/iter; left time: 24140.6577s
	iters: 200, epoch: 8 | loss: 0.0000207
	speed: 0.3192s/iter; left time: 12194.8836s
	iters: 300, epoch: 8 | loss: 0.0007400
	speed: 0.3278s/iter; left time: 12493.7380s
	iters: 400, epoch: 8 | loss: 0.0001236
	speed: 0.3228s/iter; left time: 12268.2888s
Epoch: 8 cost time: 132.11572217941284
Epoch: 8, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.132 Vali Acc: 0.974 Test Loss: 0.132 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0970467
	speed: 0.6633s/iter; left time: 25138.6424s
	iters: 200, epoch: 9 | loss: 0.0000251
	speed: 0.3256s/iter; left time: 12308.5757s
	iters: 300, epoch: 9 | loss: 0.0002203
	speed: 0.3430s/iter; left time: 12928.6519s
	iters: 400, epoch: 9 | loss: 0.0000174
	speed: 0.3307s/iter; left time: 12435.1043s
Epoch: 9 cost time: 137.76783108711243
Epoch: 9, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.186 Vali Acc: 0.970 Test Loss: 0.186 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.1164288
	speed: 0.6529s/iter; left time: 24475.0872s
	iters: 200, epoch: 10 | loss: 0.0000028
	speed: 0.3078s/iter; left time: 11507.5979s
	iters: 300, epoch: 10 | loss: 0.0003337
	speed: 0.3045s/iter; left time: 11352.6742s
	iters: 400, epoch: 10 | loss: 0.0000003
	speed: 0.3077s/iter; left time: 11441.4809s
Epoch: 10 cost time: 128.52920937538147
Epoch: 10, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.172 Vali Acc: 0.975 Test Loss: 0.172 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000552
	speed: 0.6266s/iter; left time: 23227.7652s
	iters: 200, epoch: 11 | loss: 0.0000711
	speed: 0.3026s/iter; left time: 11188.8035s
	iters: 300, epoch: 11 | loss: 0.0000025
	speed: 0.3237s/iter; left time: 11934.2540s
	iters: 400, epoch: 11 | loss: 0.0003437
	speed: 0.3186s/iter; left time: 11713.6143s
Epoch: 11 cost time: 130.59864020347595
Epoch: 11, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
Validation loss decreased (-0.979081 --> -0.983173).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000066
	speed: 0.6701s/iter; left time: 24565.3743s
	iters: 200, epoch: 12 | loss: 0.0698233
	speed: 0.3291s/iter; left time: 12032.7948s
	iters: 300, epoch: 12 | loss: 0.0003395
	speed: 0.3252s/iter; left time: 11854.4809s
	iters: 400, epoch: 12 | loss: 0.0000222
	speed: 0.3235s/iter; left time: 11760.1906s
Epoch: 12 cost time: 136.31110620498657
Epoch: 12, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.116 Vali Acc: 0.978 Test Loss: 0.116 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0090898
	speed: 0.6672s/iter; left time: 24180.8756s
	iters: 200, epoch: 13 | loss: 0.0001823
	speed: 0.3319s/iter; left time: 11995.6099s
	iters: 300, epoch: 13 | loss: 0.0003977
	speed: 0.3327s/iter; left time: 11993.3552s
	iters: 400, epoch: 13 | loss: 0.0000033
	speed: 0.3291s/iter; left time: 11830.6820s
Epoch: 13 cost time: 137.800137758255
Epoch: 13, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.126 Vali Acc: 0.978 Test Loss: 0.126 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000229
	speed: 0.6783s/iter; left time: 24305.7617s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.3409s/iter; left time: 12182.0098s
	iters: 300, epoch: 14 | loss: 0.3373544
	speed: 0.3383s/iter; left time: 12055.8311s
	iters: 400, epoch: 14 | loss: 0.0001128
	speed: 0.3330s/iter; left time: 11833.8406s
Epoch: 14 cost time: 139.63413524627686
Epoch: 14, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.263 Vali Acc: 0.965 Test Loss: 0.263 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.6732s/iter; left time: 23845.7915s
	iters: 200, epoch: 15 | loss: 0.0001669
	speed: 0.3167s/iter; left time: 11185.6666s
	iters: 300, epoch: 15 | loss: 0.0068885
	speed: 0.3181s/iter; left time: 11203.7358s
	iters: 400, epoch: 15 | loss: 0.0015164
	speed: 0.3353s/iter; left time: 11776.9171s
Epoch: 15 cost time: 134.4078803062439
Epoch: 15, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.133 Vali Acc: 0.976 Test Loss: 0.133 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000002
	speed: 0.6468s/iter; left time: 22642.2858s
	iters: 200, epoch: 16 | loss: 0.0000011
	speed: 0.3281s/iter; left time: 11453.2623s
	iters: 300, epoch: 16 | loss: 0.0000040
	speed: 0.3396s/iter; left time: 11819.1965s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.3468s/iter; left time: 12037.6779s
Epoch: 16 cost time: 138.43339610099792
Epoch: 16, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.159 Vali Acc: 0.979 Test Loss: 0.159 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000027
	speed: 0.7081s/iter; left time: 24496.5687s
	iters: 200, epoch: 17 | loss: 0.0000034
	speed: 0.3370s/iter; left time: 11624.2760s
	iters: 300, epoch: 17 | loss: 0.0979876
	speed: 0.3502s/iter; left time: 12044.1426s
	iters: 400, epoch: 17 | loss: 0.5770680
	speed: 0.3339s/iter; left time: 11451.7047s
Epoch: 17 cost time: 141.36400866508484
Epoch: 17, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.093 Vali Acc: 0.984 Test Loss: 0.093 Test Acc: 0.984
Validation loss decreased (-0.983173 --> -0.984083).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000003
	speed: 0.6590s/iter; left time: 22525.3292s
	iters: 200, epoch: 18 | loss: 0.0195767
	speed: 0.3346s/iter; left time: 11404.4752s
	iters: 300, epoch: 18 | loss: 0.0002393
	speed: 0.3374s/iter; left time: 11466.1272s
	iters: 400, epoch: 18 | loss: 0.0000007
	speed: 0.3245s/iter; left time: 10994.6873s
Epoch: 18 cost time: 136.96749234199524
Epoch: 18, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.179 Vali Acc: 0.974 Test Loss: 0.179 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0009986
	speed: 0.6563s/iter; left time: 22160.1092s
	iters: 200, epoch: 19 | loss: 0.0000067
	speed: 0.3306s/iter; left time: 11130.2306s
	iters: 300, epoch: 19 | loss: 0.0000007
	speed: 0.3219s/iter; left time: 10806.1765s
	iters: 400, epoch: 19 | loss: 0.0006282
	speed: 0.3235s/iter; left time: 10828.2428s
Epoch: 19 cost time: 134.5289204120636
Epoch: 19, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.198 Vali Acc: 0.970 Test Loss: 0.198 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.3774311
	speed: 0.6423s/iter; left time: 21422.0555s
	iters: 200, epoch: 20 | loss: 0.1010750
	speed: 0.3215s/iter; left time: 10691.6357s
	iters: 300, epoch: 20 | loss: 0.0000001
	speed: 0.3282s/iter; left time: 10881.1402s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.3267s/iter; left time: 10799.2150s
Epoch: 20 cost time: 134.57933020591736
Epoch: 20, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.226 Vali Acc: 0.969 Test Loss: 0.226 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000077
	speed: 0.6605s/iter; left time: 21756.8156s
	iters: 200, epoch: 21 | loss: 0.0000037
	speed: 0.3287s/iter; left time: 10794.5329s
	iters: 300, epoch: 21 | loss: 0.0000014
	speed: 0.3308s/iter; left time: 10830.5940s
	iters: 400, epoch: 21 | loss: 0.0000003
	speed: 0.3332s/iter; left time: 10876.1070s
Epoch: 21 cost time: 136.9476444721222
Epoch: 21, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.188 Vali Acc: 0.975 Test Loss: 0.188 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0085204
	speed: 0.6789s/iter; left time: 22082.9614s
	iters: 200, epoch: 22 | loss: 0.0000032
	speed: 0.3253s/iter; left time: 10550.4462s
	iters: 300, epoch: 22 | loss: 0.0000621
	speed: 0.3237s/iter; left time: 10463.2025s
	iters: 400, epoch: 22 | loss: 0.0001466
	speed: 0.3185s/iter; left time: 10265.1197s
Epoch: 22 cost time: 134.63332796096802
Epoch: 22, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.226 Vali Acc: 0.977 Test Loss: 0.226 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0011653
	speed: 0.6324s/iter; left time: 20308.5708s
	iters: 200, epoch: 23 | loss: 0.0003461
	speed: 0.3111s/iter; left time: 9958.5819s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.3160s/iter; left time: 10086.7205s
	iters: 400, epoch: 23 | loss: 0.0000128
	speed: 0.3051s/iter; left time: 9707.9298s
Epoch: 23 cost time: 129.46958231925964
Epoch: 23, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.270 Vali Acc: 0.975 Test Loss: 0.270 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0169527
	speed: 0.6250s/iter; left time: 19812.5825s
	iters: 200, epoch: 24 | loss: 0.0000060
	speed: 0.3244s/iter; left time: 10252.4572s
	iters: 300, epoch: 24 | loss: 0.0260798
	speed: 0.3184s/iter; left time: 10030.1083s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.3215s/iter; left time: 10096.7961s
Epoch: 24 cost time: 132.0207314491272
Epoch: 24, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.191 Vali Acc: 0.980 Test Loss: 0.191 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.4834915
	speed: 0.6461s/iter; left time: 20216.4370s
	iters: 200, epoch: 25 | loss: 0.0001119
	speed: 0.3060s/iter; left time: 9544.1153s
	iters: 300, epoch: 25 | loss: 0.0000039
	speed: 0.3106s/iter; left time: 9657.3614s
	iters: 400, epoch: 25 | loss: 0.0000004
	speed: 0.3169s/iter; left time: 9819.8432s
Epoch: 25 cost time: 129.54396414756775
Epoch: 25, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.156 Vali Acc: 0.982 Test Loss: 0.156 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.6576s/iter; left time: 20303.2239s
	iters: 200, epoch: 26 | loss: 0.0485307
	speed: 0.3373s/iter; left time: 10380.0643s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.3251s/iter; left time: 9972.5625s
	iters: 400, epoch: 26 | loss: 0.0000043
	speed: 0.3052s/iter; left time: 9332.0763s
Epoch: 26 cost time: 134.3737301826477
Epoch: 26, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.319 Vali Acc: 0.968 Test Loss: 0.319 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0000020
	speed: 0.6352s/iter; left time: 19350.4431s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.3049s/iter; left time: 9257.0347s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.3152s/iter; left time: 9539.1819s
	iters: 400, epoch: 27 | loss: 0.0049585
	speed: 0.3091s/iter; left time: 9323.3383s
Epoch: 27 cost time: 128.49809956550598
Epoch: 27, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.131 Vali Acc: 0.983 Test Loss: 0.131 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9840836743974534
model parameter : 2284810
model size : 13.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.4283957
	speed: 0.3468s/iter; left time: 14288.0802s
	iters: 200, epoch: 1 | loss: 0.4071846
	speed: 0.3290s/iter; left time: 13520.8666s
	iters: 300, epoch: 1 | loss: 0.0772563
	speed: 0.3284s/iter; left time: 13465.7256s
	iters: 400, epoch: 1 | loss: 0.4442870
	speed: 0.3194s/iter; left time: 13063.1375s
Epoch: 1 cost time: 136.85369348526
Epoch: 1, Steps: 413 | Train Loss: 0.735 Vali Loss: 0.075 Vali Acc: 0.982 Test Loss: 0.075 Test Acc: 0.982
Validation loss decreased (inf --> -0.981809).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0608990
	speed: 0.6563s/iter; left time: 26770.8821s
	iters: 200, epoch: 2 | loss: 0.1365369
	speed: 0.3339s/iter; left time: 13586.4330s
	iters: 300, epoch: 2 | loss: 0.1819403
	speed: 0.3287s/iter; left time: 13342.8024s
	iters: 400, epoch: 2 | loss: 0.1180766
	speed: 0.3488s/iter; left time: 14120.5362s
Epoch: 2 cost time: 140.59724378585815
Epoch: 2, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.078 Vali Acc: 0.975 Test Loss: 0.078 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0251354
	speed: 0.6779s/iter; left time: 27369.3690s
	iters: 200, epoch: 3 | loss: 0.0016707
	speed: 0.3230s/iter; left time: 13009.8364s
	iters: 300, epoch: 3 | loss: 0.0810946
	speed: 0.3319s/iter; left time: 13335.1955s
	iters: 400, epoch: 3 | loss: 0.0124113
	speed: 0.3406s/iter; left time: 13651.0966s
Epoch: 3 cost time: 137.86877059936523
Epoch: 3, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0137378
	speed: 0.7404s/iter; left time: 29587.7525s
	iters: 200, epoch: 4 | loss: 0.0086581
	speed: 0.3770s/iter; left time: 15028.0230s
	iters: 300, epoch: 4 | loss: 0.0006046
	speed: 0.3706s/iter; left time: 14737.4968s
	iters: 400, epoch: 4 | loss: 0.0003141
	speed: 0.3727s/iter; left time: 14781.7262s
Epoch: 4 cost time: 155.60327744483948
Epoch: 4, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.090 Vali Acc: 0.971 Test Loss: 0.090 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0052851
	speed: 0.6930s/iter; left time: 27406.2167s
	iters: 200, epoch: 5 | loss: 0.0015555
	speed: 0.3606s/iter; left time: 14225.9615s
	iters: 300, epoch: 5 | loss: 0.0179975
	speed: 0.3509s/iter; left time: 13807.2100s
	iters: 400, epoch: 5 | loss: 0.0247859
	speed: 0.3556s/iter; left time: 13957.6738s
Epoch: 5 cost time: 146.42080187797546
Epoch: 5, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.6259875
	speed: 0.7322s/iter; left time: 28655.8334s
	iters: 200, epoch: 6 | loss: 0.2097455
	speed: 0.3663s/iter; left time: 14300.6633s
	iters: 300, epoch: 6 | loss: 0.0715700
	speed: 0.3643s/iter; left time: 14185.6161s
	iters: 400, epoch: 6 | loss: 0.0001428
	speed: 0.3652s/iter; left time: 14181.2274s
Epoch: 6 cost time: 152.38100266456604
Epoch: 6, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.183 Vali Acc: 0.955 Test Loss: 0.183 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0005493
	speed: 0.7373s/iter; left time: 28552.3962s
	iters: 200, epoch: 7 | loss: 0.0118594
	speed: 0.3517s/iter; left time: 13582.1332s
	iters: 300, epoch: 7 | loss: 0.6172105
	speed: 0.3662s/iter; left time: 14105.9473s
	iters: 400, epoch: 7 | loss: 0.0080896
	speed: 0.3786s/iter; left time: 14546.7302s
Epoch: 7 cost time: 151.8948130607605
Epoch: 7, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.159 Vali Acc: 0.968 Test Loss: 0.159 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.0009640
	speed: 0.7456s/iter; left time: 28564.4034s
	iters: 200, epoch: 8 | loss: 0.0414889
	speed: 0.3767s/iter; left time: 14394.4243s
	iters: 300, epoch: 8 | loss: 0.0269428
	speed: 0.3848s/iter; left time: 14665.6469s
	iters: 400, epoch: 8 | loss: 0.0002802
	speed: 0.4061s/iter; left time: 15434.7846s
Epoch: 8 cost time: 158.5131392478943
Epoch: 8, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.0552972
	speed: 0.7524s/iter; left time: 28513.2337s
	iters: 200, epoch: 9 | loss: 0.0000415
	speed: 0.3793s/iter; left time: 14337.1184s
	iters: 300, epoch: 9 | loss: 0.0001058
	speed: 0.3671s/iter; left time: 13839.2003s
	iters: 400, epoch: 9 | loss: 0.0001970
	speed: 0.3540s/iter; left time: 13309.8484s
Epoch: 9 cost time: 152.59349584579468
Epoch: 9, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.202 Vali Acc: 0.970 Test Loss: 0.202 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.0000128
	speed: 0.7011s/iter; left time: 26281.7448s
	iters: 200, epoch: 10 | loss: 0.0000036
	speed: 0.3648s/iter; left time: 13636.2918s
	iters: 300, epoch: 10 | loss: 0.0494146
	speed: 0.3660s/iter; left time: 13645.9771s
	iters: 400, epoch: 10 | loss: 0.0001172
	speed: 0.3730s/iter; left time: 13870.0373s
Epoch: 10 cost time: 150.7476737499237
Epoch: 10, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.288 Vali Acc: 0.960 Test Loss: 0.288 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.0227375
	speed: 0.7198s/iter; left time: 26681.9387s
	iters: 200, epoch: 11 | loss: 0.0051660
	speed: 0.3705s/iter; left time: 13699.3342s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.3568s/iter; left time: 13154.5618s
	iters: 400, epoch: 11 | loss: 0.0000579
	speed: 0.3518s/iter; left time: 12937.6844s
Epoch: 11 cost time: 149.87000679969788
Epoch: 11, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.112 Vali Acc: 0.978 Test Loss: 0.112 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9818099135970896
model parameter : 2284810
model size : 13.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.4306916
	speed: 0.3658s/iter; left time: 15069.5318s
	iters: 200, epoch: 1 | loss: 0.2837660
	speed: 0.3354s/iter; left time: 13785.8790s
	iters: 300, epoch: 1 | loss: 0.0620257
	speed: 0.3660s/iter; left time: 15004.6191s
	iters: 400, epoch: 1 | loss: 0.6929959
	speed: 0.3705s/iter; left time: 15154.9639s
Epoch: 1 cost time: 148.186457157135
Epoch: 1, Steps: 413 | Train Loss: 0.792 Vali Loss: 0.091 Vali Acc: 0.972 Test Loss: 0.091 Test Acc: 0.972
Validation loss decreased (inf --> -0.971804).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0819606
	speed: 0.7303s/iter; left time: 29786.6781s
	iters: 200, epoch: 2 | loss: 0.0371197
	speed: 0.3566s/iter; left time: 14508.4015s
	iters: 300, epoch: 2 | loss: 0.0745348
	speed: 0.3396s/iter; left time: 13783.2532s
	iters: 400, epoch: 2 | loss: 0.0540273
	speed: 0.3445s/iter; left time: 13948.1475s
Epoch: 2 cost time: 145.61282324790955
Epoch: 2, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.971804 --> -0.977262).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0634705
	speed: 0.6938s/iter; left time: 28011.9694s
	iters: 200, epoch: 3 | loss: 0.0736929
	speed: 0.3345s/iter; left time: 13470.1917s
	iters: 300, epoch: 3 | loss: 0.0244409
	speed: 0.3364s/iter; left time: 13516.6880s
	iters: 400, epoch: 3 | loss: 0.0270428
	speed: 0.3499s/iter; left time: 14022.6822s
Epoch: 3 cost time: 141.73865342140198
Epoch: 3, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0460151
	speed: 0.6922s/iter; left time: 27660.9703s
	iters: 200, epoch: 4 | loss: 0.1144044
	speed: 0.3603s/iter; left time: 14360.9578s
	iters: 300, epoch: 4 | loss: 0.0053532
	speed: 0.3507s/iter; left time: 13945.5212s
	iters: 400, epoch: 4 | loss: 0.0001416
	speed: 0.3581s/iter; left time: 14204.8696s
Epoch: 4 cost time: 146.84257197380066
Epoch: 4, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.078 Vali Acc: 0.975 Test Loss: 0.078 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.2706235
	speed: 0.7085s/iter; left time: 28019.4755s
	iters: 200, epoch: 5 | loss: 0.0021195
	speed: 0.3486s/iter; left time: 13750.0103s
	iters: 300, epoch: 5 | loss: 0.0433855
	speed: 0.3484s/iter; left time: 13708.8551s
	iters: 400, epoch: 5 | loss: 0.0014050
	speed: 0.3507s/iter; left time: 13764.9858s
Epoch: 5 cost time: 145.97495198249817
Epoch: 5, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0161210
	speed: 0.7292s/iter; left time: 28536.0638s
	iters: 200, epoch: 6 | loss: 0.0016882
	speed: 0.3326s/iter; left time: 12984.5042s
	iters: 300, epoch: 6 | loss: 0.0002626
	speed: 0.3572s/iter; left time: 13909.7421s
	iters: 400, epoch: 6 | loss: 0.0228152
	speed: 0.3766s/iter; left time: 14625.5312s
Epoch: 6 cost time: 148.72366333007812
Epoch: 6, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
Validation loss decreased (-0.977262 --> -0.980445).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2558035
	speed: 0.7368s/iter; left time: 28530.1754s
	iters: 200, epoch: 7 | loss: 0.0000675
	speed: 0.3547s/iter; left time: 13699.9336s
	iters: 300, epoch: 7 | loss: 0.1775247
	speed: 0.3284s/iter; left time: 12650.8254s
	iters: 400, epoch: 7 | loss: 0.0006947
	speed: 0.3325s/iter; left time: 12776.7644s
Epoch: 7 cost time: 144.16028571128845
Epoch: 7, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000635
	speed: 0.6485s/iter; left time: 24845.6410s
	iters: 200, epoch: 8 | loss: 0.0009851
	speed: 0.3239s/iter; left time: 12377.7092s
	iters: 300, epoch: 8 | loss: 0.0825470
	speed: 0.3213s/iter; left time: 12243.7492s
	iters: 400, epoch: 8 | loss: 0.0007014
	speed: 0.3222s/iter; left time: 12248.4432s
Epoch: 8 cost time: 133.34265518188477
Epoch: 8, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0015479
	speed: 0.6352s/iter; left time: 24073.2912s
	iters: 200, epoch: 9 | loss: 0.0005203
	speed: 0.3246s/iter; left time: 12268.2083s
	iters: 300, epoch: 9 | loss: 0.2357157
	speed: 0.3307s/iter; left time: 12464.7838s
	iters: 400, epoch: 9 | loss: 0.0152990
	speed: 0.3410s/iter; left time: 12822.3274s
Epoch: 9 cost time: 135.98799967765808
Epoch: 9, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000001
	speed: 0.6611s/iter; left time: 24780.0320s
	iters: 200, epoch: 10 | loss: 0.0000267
	speed: 0.3379s/iter; left time: 12631.4102s
	iters: 300, epoch: 10 | loss: 0.0031614
	speed: 0.3226s/iter; left time: 12029.2663s
	iters: 400, epoch: 10 | loss: 0.0000030
	speed: 0.3242s/iter; left time: 12053.2668s
Epoch: 10 cost time: 135.84661889076233
Epoch: 10, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.211 Vali Acc: 0.965 Test Loss: 0.211 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0028930
	speed: 0.6372s/iter; left time: 23623.3992s
	iters: 200, epoch: 11 | loss: 0.0315675
	speed: 0.3205s/iter; left time: 11847.8197s
	iters: 300, epoch: 11 | loss: 0.0001735
	speed: 0.3179s/iter; left time: 11720.0834s
	iters: 400, epoch: 11 | loss: 0.0034296
	speed: 0.3141s/iter; left time: 11551.2663s
Epoch: 11 cost time: 132.3274941444397
Epoch: 11, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.176 Vali Acc: 0.969 Test Loss: 0.176 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000389
	speed: 0.6576s/iter; left time: 24105.0135s
	iters: 200, epoch: 12 | loss: 0.0000168
	speed: 0.3413s/iter; left time: 12475.5841s
	iters: 300, epoch: 12 | loss: 0.0000003
	speed: 0.3423s/iter; left time: 12479.0950s
	iters: 400, epoch: 12 | loss: 0.0000769
	speed: 0.3501s/iter; left time: 12728.3304s
Epoch: 12 cost time: 140.73228192329407
Epoch: 12, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.150 Vali Acc: 0.972 Test Loss: 0.150 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0208197
	speed: 0.6618s/iter; left time: 23985.3689s
	iters: 200, epoch: 13 | loss: 0.0000593
	speed: 0.3243s/iter; left time: 11722.1986s
	iters: 300, epoch: 13 | loss: 0.0000771
	speed: 0.3325s/iter; left time: 11985.1856s
	iters: 400, epoch: 13 | loss: 0.0016699
	speed: 0.3178s/iter; left time: 11424.7366s
Epoch: 13 cost time: 134.94166445732117
Epoch: 13, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.336 Vali Acc: 0.961 Test Loss: 0.336 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000155
	speed: 0.6689s/iter; left time: 23967.9491s
	iters: 200, epoch: 14 | loss: 0.0000065
	speed: 0.3173s/iter; left time: 11338.3675s
	iters: 300, epoch: 14 | loss: 0.0128965
	speed: 0.3200s/iter; left time: 11402.3994s
	iters: 400, epoch: 14 | loss: 0.8260770
	speed: 0.3427s/iter; left time: 12175.0688s
Epoch: 14 cost time: 136.2139551639557
Epoch: 14, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.132 Vali Acc: 0.977 Test Loss: 0.132 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.6740s/iter; left time: 23872.8440s
	iters: 200, epoch: 15 | loss: 0.0002700
	speed: 0.3460s/iter; left time: 12220.3636s
	iters: 300, epoch: 15 | loss: 0.0004169
	speed: 0.3399s/iter; left time: 11971.1008s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.3260s/iter; left time: 11447.8255s
Epoch: 15 cost time: 139.06803798675537
Epoch: 15, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.127 Vali Acc: 0.972 Test Loss: 0.127 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0001277
	speed: 0.6410s/iter; left time: 22437.7185s
	iters: 200, epoch: 16 | loss: 0.0179426
	speed: 0.3317s/iter; left time: 11579.7905s
	iters: 300, epoch: 16 | loss: 0.0001139
	speed: 0.3139s/iter; left time: 10926.5305s
	iters: 400, epoch: 16 | loss: 0.0000009
	speed: 0.3272s/iter; left time: 11357.2343s
Epoch: 16 cost time: 134.2984549999237
Epoch: 16, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.120 Vali Acc: 0.976 Test Loss: 0.120 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9804456571168713
model parameter : 2284810
model size : 13.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.5587164
	speed: 0.3531s/iter; left time: 14549.1522s
	iters: 200, epoch: 1 | loss: 0.2737618
	speed: 0.3372s/iter; left time: 13857.5432s
	iters: 300, epoch: 1 | loss: 0.0565365
	speed: 0.3453s/iter; left time: 14159.2134s
	iters: 400, epoch: 1 | loss: 0.7256508
	speed: 0.3264s/iter; left time: 13350.0964s
Epoch: 1 cost time: 140.97260785102844
Epoch: 1, Steps: 413 | Train Loss: 0.773 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
Validation loss decreased (inf --> -0.965438).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0646767
	speed: 0.6897s/iter; left time: 28131.9364s
	iters: 200, epoch: 2 | loss: 0.1650109
	speed: 0.3533s/iter; left time: 14375.3964s
	iters: 300, epoch: 2 | loss: 0.1001865
	speed: 0.3311s/iter; left time: 13438.0824s
	iters: 400, epoch: 2 | loss: 0.1326005
	speed: 0.3307s/iter; left time: 13389.0516s
Epoch: 2 cost time: 139.5578954219818
Epoch: 2, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.158 Vali Acc: 0.961 Test Loss: 0.158 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1054872
	speed: 0.6474s/iter; left time: 26139.1953s
	iters: 200, epoch: 3 | loss: 0.0211629
	speed: 0.3186s/iter; left time: 12832.0165s
	iters: 300, epoch: 3 | loss: 0.0069292
	speed: 0.3264s/iter; left time: 13113.6386s
	iters: 400, epoch: 3 | loss: 0.0094126
	speed: 0.3336s/iter; left time: 13369.2448s
Epoch: 3 cost time: 135.15446662902832
Epoch: 3, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.081 Vali Acc: 0.979 Test Loss: 0.081 Test Acc: 0.979
Validation loss decreased (-0.965438 --> -0.978626).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0906864
	speed: 0.6624s/iter; left time: 26471.6421s
	iters: 200, epoch: 4 | loss: 0.0624543
	speed: 0.3389s/iter; left time: 13511.0963s
	iters: 300, epoch: 4 | loss: 0.0016364
	speed: 0.3399s/iter; left time: 13514.3430s
	iters: 400, epoch: 4 | loss: 0.0084120
	speed: 0.3571s/iter; left time: 14161.6244s
Epoch: 4 cost time: 142.24678111076355
Epoch: 4, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.217 Vali Acc: 0.941 Test Loss: 0.217 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.5298107
	speed: 0.6721s/iter; left time: 26579.9626s
	iters: 200, epoch: 5 | loss: 0.0022704
	speed: 0.3449s/iter; left time: 13605.4467s
	iters: 300, epoch: 5 | loss: 0.0134110
	speed: 0.3352s/iter; left time: 13188.9680s
	iters: 400, epoch: 5 | loss: 0.0023144
	speed: 0.3244s/iter; left time: 12731.6298s
Epoch: 5 cost time: 137.9399573802948
Epoch: 5, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.096 Vali Acc: 0.974 Test Loss: 0.096 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0270684
	speed: 0.6720s/iter; left time: 26298.2867s
	iters: 200, epoch: 6 | loss: 0.0000716
	speed: 0.3405s/iter; left time: 13291.1584s
	iters: 300, epoch: 6 | loss: 0.1695137
	speed: 0.3220s/iter; left time: 12538.0614s
	iters: 400, epoch: 6 | loss: 0.0023327
	speed: 0.3315s/iter; left time: 12876.0589s
Epoch: 6 cost time: 137.7071213722229
Epoch: 6, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.1326112
	speed: 0.6906s/iter; left time: 26740.2243s
	iters: 200, epoch: 7 | loss: 0.0014047
	speed: 0.3498s/iter; left time: 13510.9059s
	iters: 300, epoch: 7 | loss: 0.0227040
	speed: 0.3430s/iter; left time: 13212.8025s
	iters: 400, epoch: 7 | loss: 0.0000363
	speed: 0.3406s/iter; left time: 13086.1229s
Epoch: 7 cost time: 142.83933281898499
Epoch: 7, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.139 Vali Acc: 0.966 Test Loss: 0.139 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0000296
	speed: 0.6849s/iter; left time: 26240.3053s
	iters: 200, epoch: 8 | loss: 0.0371610
	speed: 0.3628s/iter; left time: 13861.0051s
	iters: 300, epoch: 8 | loss: 0.0538904
	speed: 0.3632s/iter; left time: 13843.3333s
	iters: 400, epoch: 8 | loss: 0.0505469
	speed: 0.3355s/iter; left time: 12752.6624s
Epoch: 8 cost time: 146.20407509803772
Epoch: 8, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.138 Vali Acc: 0.971 Test Loss: 0.138 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.1470582
	speed: 0.7080s/iter; left time: 26830.6173s
	iters: 200, epoch: 9 | loss: 0.0079332
	speed: 0.3362s/iter; left time: 12708.4207s
	iters: 300, epoch: 9 | loss: 0.0695861
	speed: 0.3347s/iter; left time: 12616.5366s
	iters: 400, epoch: 9 | loss: 0.0013140
	speed: 0.3515s/iter; left time: 13214.9517s
Epoch: 9 cost time: 141.88397240638733
Epoch: 9, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0000044
	speed: 0.7111s/iter; left time: 26653.1930s
	iters: 200, epoch: 10 | loss: 0.0000044
	speed: 0.3354s/iter; left time: 12536.8877s
	iters: 300, epoch: 10 | loss: 0.0057616
	speed: 0.3305s/iter; left time: 12322.2667s
	iters: 400, epoch: 10 | loss: 0.0965381
	speed: 0.3335s/iter; left time: 12401.2022s
Epoch: 10 cost time: 140.1836657524109
Epoch: 10, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.199 Vali Acc: 0.965 Test Loss: 0.199 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.6633397
	speed: 0.6645s/iter; left time: 24634.8216s
	iters: 200, epoch: 11 | loss: 0.0006524
	speed: 0.3247s/iter; left time: 12004.6448s
	iters: 300, epoch: 11 | loss: 0.0002337
	speed: 0.3263s/iter; left time: 12030.3775s
	iters: 400, epoch: 11 | loss: 0.0000121
	speed: 0.3361s/iter; left time: 12356.9932s
Epoch: 11 cost time: 137.12026357650757
Epoch: 11, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0001172
	speed: 0.6917s/iter; left time: 25357.9622s
	iters: 200, epoch: 12 | loss: 0.0001096
	speed: 0.3473s/iter; left time: 12697.0440s
	iters: 300, epoch: 12 | loss: 0.0000005
	speed: 0.3414s/iter; left time: 12446.0405s
	iters: 400, epoch: 12 | loss: 0.0001135
	speed: 0.3501s/iter; left time: 12730.1393s
Epoch: 12 cost time: 142.93037581443787
Epoch: 12, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0000880
	speed: 0.6926s/iter; left time: 25104.1089s
	iters: 200, epoch: 13 | loss: 0.0006309
	speed: 0.3421s/iter; left time: 12364.7985s
	iters: 300, epoch: 13 | loss: 0.0778612
	speed: 0.3431s/iter; left time: 12366.9819s
	iters: 400, epoch: 13 | loss: 0.0000010
	speed: 0.3448s/iter; left time: 12394.1828s
Epoch: 13 cost time: 143.04854536056519
Epoch: 13, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.071 Vali Acc: 0.984 Test Loss: 0.071 Test Acc: 0.984
Validation loss decreased (-0.978626 --> -0.983628).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0002327
	speed: 0.7032s/iter; left time: 25196.2768s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.3672s/iter; left time: 13122.0105s
	iters: 300, epoch: 14 | loss: 0.0014616
	speed: 0.3769s/iter; left time: 13430.5375s
	iters: 400, epoch: 14 | loss: 0.0515747
	speed: 0.3632s/iter; left time: 12906.0151s
Epoch: 14 cost time: 150.13484263420105
Epoch: 14, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000001
	speed: 0.7151s/iter; left time: 25328.1363s
	iters: 200, epoch: 15 | loss: 0.0299539
	speed: 0.3424s/iter; left time: 12092.3718s
	iters: 300, epoch: 15 | loss: 0.0147914
	speed: 0.3381s/iter; left time: 11905.8934s
	iters: 400, epoch: 15 | loss: 0.0000246
	speed: 0.3415s/iter; left time: 11993.6427s
Epoch: 15 cost time: 142.4691321849823
Epoch: 15, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.130 Vali Acc: 0.971 Test Loss: 0.130 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0104693
	speed: 0.7096s/iter; left time: 24841.6562s
	iters: 200, epoch: 16 | loss: 0.2941276
	speed: 0.3485s/iter; left time: 12164.7275s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.3683s/iter; left time: 12817.9663s
	iters: 400, epoch: 16 | loss: 0.0011064
	speed: 0.3434s/iter; left time: 11916.6119s
Epoch: 16 cost time: 146.4460072517395
Epoch: 16, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.127 Vali Acc: 0.976 Test Loss: 0.127 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0000166
	speed: 0.7190s/iter; left time: 24870.7072s
	iters: 200, epoch: 17 | loss: 0.0000029
	speed: 0.3332s/iter; left time: 11493.9641s
	iters: 300, epoch: 17 | loss: 0.0748074
	speed: 0.3459s/iter; left time: 11898.0260s
	iters: 400, epoch: 17 | loss: 0.0208433
	speed: 0.3647s/iter; left time: 12506.8729s
Epoch: 17 cost time: 145.0695984363556
Epoch: 17, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.133 Vali Acc: 0.972 Test Loss: 0.133 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000003
	speed: 0.6863s/iter; left time: 23456.2154s
	iters: 200, epoch: 18 | loss: 0.0000063
	speed: 0.3386s/iter; left time: 11538.1515s
	iters: 300, epoch: 18 | loss: 0.0000099
	speed: 0.3496s/iter; left time: 11880.5470s
	iters: 400, epoch: 18 | loss: 0.0016219
	speed: 0.3377s/iter; left time: 11441.0135s
Epoch: 18 cost time: 141.891459941864
Epoch: 18, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.192 Vali Acc: 0.967 Test Loss: 0.192 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0041319
	speed: 0.6937s/iter; left time: 23423.6374s
	iters: 200, epoch: 19 | loss: 0.0000014
	speed: 0.3569s/iter; left time: 12016.1974s
	iters: 300, epoch: 19 | loss: 0.0000513
	speed: 0.3557s/iter; left time: 11940.8438s
	iters: 400, epoch: 19 | loss: 0.0000190
	speed: 0.3572s/iter; left time: 11955.3761s
Epoch: 19 cost time: 146.2258427143097
Epoch: 19, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.235 Vali Acc: 0.957 Test Loss: 0.235 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0000015
	speed: 0.7115s/iter; left time: 23730.1666s
	iters: 200, epoch: 20 | loss: 0.0001636
	speed: 0.3385s/iter; left time: 11255.6884s
	iters: 300, epoch: 20 | loss: 0.0000008
	speed: 0.3249s/iter; left time: 10772.0095s
	iters: 400, epoch: 20 | loss: 0.0000001
	speed: 0.3256s/iter; left time: 10762.7175s
Epoch: 20 cost time: 138.80449771881104
Epoch: 20, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0620176
	speed: 0.6755s/iter; left time: 22252.7460s
	iters: 200, epoch: 21 | loss: 0.0000002
	speed: 0.3361s/iter; left time: 11038.2704s
	iters: 300, epoch: 21 | loss: 0.0003709
	speed: 0.3376s/iter; left time: 11054.0869s
	iters: 400, epoch: 21 | loss: 0.0000010
	speed: 0.3368s/iter; left time: 10993.8315s
Epoch: 21 cost time: 139.95234894752502
Epoch: 21, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0004021
	speed: 0.7051s/iter; left time: 22935.3501s
	iters: 200, epoch: 22 | loss: 0.0000663
	speed: 0.3425s/iter; left time: 11105.9609s
	iters: 300, epoch: 22 | loss: 0.0000001
	speed: 0.3583s/iter; left time: 11583.1940s
	iters: 400, epoch: 22 | loss: 0.0000001
	speed: 0.3561s/iter; left time: 11475.6433s
Epoch: 22 cost time: 144.9789445400238
Epoch: 22, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0009908
	speed: 0.6824s/iter; left time: 21915.3441s
	iters: 200, epoch: 23 | loss: 0.0244679
	speed: 0.3246s/iter; left time: 10392.0902s
	iters: 300, epoch: 23 | loss: 0.0000033
	speed: 0.3312s/iter; left time: 10570.0655s
	iters: 400, epoch: 23 | loss: 0.0000803
	speed: 0.3373s/iter; left time: 10731.1986s
Epoch: 23 cost time: 137.46768498420715
Epoch: 23, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.112 Vali Acc: 0.979 Test Loss: 0.112 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9836289222373806
model parameter : 2284810
model size : 13.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.5546317
	speed: 0.3465s/iter; left time: 14274.9376s
	iters: 200, epoch: 1 | loss: 0.3100545
	speed: 0.3438s/iter; left time: 14129.0422s
	iters: 300, epoch: 1 | loss: 0.0457379
	speed: 0.3332s/iter; left time: 13660.3299s
	iters: 400, epoch: 1 | loss: 0.4032821
	speed: 0.3349s/iter; left time: 13699.1304s
Epoch: 1 cost time: 140.50800681114197
Epoch: 1, Steps: 413 | Train Loss: 0.766 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (inf --> -0.972714).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0851856
	speed: 0.6750s/iter; left time: 27533.8812s
	iters: 200, epoch: 2 | loss: 0.1005718
	speed: 0.3299s/iter; left time: 13424.6501s
	iters: 300, epoch: 2 | loss: 0.1506923
	speed: 0.3312s/iter; left time: 13442.4453s
	iters: 400, epoch: 2 | loss: 0.3557889
	speed: 0.3378s/iter; left time: 13678.3024s
Epoch: 2 cost time: 138.30464911460876
Epoch: 2, Steps: 413 | Train Loss: 0.100 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1611514
	speed: 0.6572s/iter; left time: 26536.4330s
	iters: 200, epoch: 3 | loss: 0.0064100
	speed: 0.3178s/iter; left time: 12798.0382s
	iters: 300, epoch: 3 | loss: 0.0317030
	speed: 0.3238s/iter; left time: 13010.1891s
	iters: 400, epoch: 3 | loss: 0.0508016
	speed: 0.3287s/iter; left time: 13174.3551s
Epoch: 3 cost time: 134.34382224082947
Epoch: 3, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.094 Vali Acc: 0.974 Test Loss: 0.094 Test Acc: 0.974
Validation loss decreased (-0.972714 --> -0.974078).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0011866
	speed: 0.6816s/iter; left time: 27237.6903s
	iters: 200, epoch: 4 | loss: 0.1432120
	speed: 0.3512s/iter; left time: 13997.6362s
	iters: 300, epoch: 4 | loss: 0.0002880
	speed: 0.3339s/iter; left time: 13277.0199s
	iters: 400, epoch: 4 | loss: 0.0014021
	speed: 0.3347s/iter; left time: 13273.2572s
Epoch: 4 cost time: 141.5052831172943
Epoch: 4, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0890447
	speed: 0.6696s/iter; left time: 26481.4841s
	iters: 200, epoch: 5 | loss: 0.0094214
	speed: 0.3493s/iter; left time: 13778.1248s
	iters: 300, epoch: 5 | loss: 0.1162048
	speed: 0.3399s/iter; left time: 13374.7537s
	iters: 400, epoch: 5 | loss: 0.0153388
	speed: 0.3297s/iter; left time: 12938.9222s
Epoch: 5 cost time: 140.36973118782043
Epoch: 5, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0937602
	speed: 0.6429s/iter; left time: 25161.6745s
	iters: 200, epoch: 6 | loss: 0.0008712
	speed: 0.3260s/iter; left time: 12727.2564s
	iters: 300, epoch: 6 | loss: 0.1778116
	speed: 0.3283s/iter; left time: 12782.9495s
	iters: 400, epoch: 6 | loss: 0.0454470
	speed: 0.3408s/iter; left time: 13235.4676s
Epoch: 6 cost time: 136.4885938167572
Epoch: 6, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.304 Vali Acc: 0.941 Test Loss: 0.304 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0004342
	speed: 0.6831s/iter; left time: 26453.1710s
	iters: 200, epoch: 7 | loss: 0.0000558
	speed: 0.3348s/iter; left time: 12929.2759s
	iters: 300, epoch: 7 | loss: 0.0021175
	speed: 0.3261s/iter; left time: 12563.6466s
	iters: 400, epoch: 7 | loss: 0.0015376
	speed: 0.3222s/iter; left time: 12378.7812s
Epoch: 7 cost time: 137.5867576599121
Epoch: 7, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.168 Vali Acc: 0.962 Test Loss: 0.168 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0000640
	speed: 0.6937s/iter; left time: 26574.7377s
	iters: 200, epoch: 8 | loss: 0.0089241
	speed: 0.3562s/iter; left time: 13608.9264s
	iters: 300, epoch: 8 | loss: 0.0061196
	speed: 0.3367s/iter; left time: 12833.3657s
	iters: 400, epoch: 8 | loss: 0.0024152
	speed: 0.3475s/iter; left time: 13207.6329s
Epoch: 8 cost time: 144.25336408615112
Epoch: 8, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.249 Vali Acc: 0.950 Test Loss: 0.249 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0052312
	speed: 0.7094s/iter; left time: 26884.5761s
	iters: 200, epoch: 9 | loss: 0.0002220
	speed: 0.3433s/iter; left time: 12977.5784s
	iters: 300, epoch: 9 | loss: 0.0000372
	speed: 0.3312s/iter; left time: 12484.5614s
	iters: 400, epoch: 9 | loss: 0.0009586
	speed: 0.3225s/iter; left time: 12125.0807s
Epoch: 9 cost time: 139.63665461540222
Epoch: 9, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.188 Vali Acc: 0.962 Test Loss: 0.188 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0001085
	speed: 0.6520s/iter; left time: 24439.2890s
	iters: 200, epoch: 10 | loss: 0.0000186
	speed: 0.3194s/iter; left time: 11940.8376s
	iters: 300, epoch: 10 | loss: 0.0007523
	speed: 0.3312s/iter; left time: 12348.5234s
	iters: 400, epoch: 10 | loss: 0.0057648
	speed: 0.3127s/iter; left time: 11628.6562s
Epoch: 10 cost time: 133.49854850769043
Epoch: 10, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.261 Vali Acc: 0.961 Test Loss: 0.261 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0000730
	speed: 0.6505s/iter; left time: 24115.4692s
	iters: 200, epoch: 11 | loss: 0.0000034
	speed: 0.3380s/iter; left time: 12497.8216s
	iters: 300, epoch: 11 | loss: 0.0001734
	speed: 0.3306s/iter; left time: 12189.9627s
	iters: 400, epoch: 11 | loss: 0.0000336
	speed: 0.3241s/iter; left time: 11915.8629s
Epoch: 11 cost time: 136.46235156059265
Epoch: 11, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0025828
	speed: 0.6507s/iter; left time: 23854.3404s
	iters: 200, epoch: 12 | loss: 0.0000827
	speed: 0.3321s/iter; left time: 12140.7520s
	iters: 300, epoch: 12 | loss: 0.0000010
	speed: 0.3272s/iter; left time: 11928.2097s
	iters: 400, epoch: 12 | loss: 0.0013268
	speed: 0.3190s/iter; left time: 11597.6997s
Epoch: 12 cost time: 134.90679907798767
Epoch: 12, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.278 Vali Acc: 0.965 Test Loss: 0.278 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0001060
	speed: 0.6421s/iter; left time: 23272.1027s
	iters: 200, epoch: 13 | loss: 0.9786913
	speed: 0.3222s/iter; left time: 11646.2407s
	iters: 300, epoch: 13 | loss: 0.0006951
	speed: 0.3170s/iter; left time: 11426.4884s
	iters: 400, epoch: 13 | loss: 0.0036868
	speed: 0.3298s/iter; left time: 11853.4520s
Epoch: 13 cost time: 133.40159368515015
Epoch: 13, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.166 Vali Acc: 0.976 Test Loss: 0.166 Test Acc: 0.976
Validation loss decreased (-0.974078 --> -0.975896).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.1011045
	speed: 0.6275s/iter; left time: 22485.9068s
	iters: 200, epoch: 14 | loss: 0.0000002
	speed: 0.3218s/iter; left time: 11499.8532s
	iters: 300, epoch: 14 | loss: 0.0282860
	speed: 0.3202s/iter; left time: 11407.7769s
	iters: 400, epoch: 14 | loss: 0.0000010
	speed: 0.3169s/iter; left time: 11259.2245s
Epoch: 14 cost time: 132.4920015335083
Epoch: 14, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000002
	speed: 0.6412s/iter; left time: 22709.0912s
	iters: 200, epoch: 15 | loss: 0.0060436
	speed: 0.3208s/iter; left time: 11329.7583s
	iters: 300, epoch: 15 | loss: 0.0000824
	speed: 0.3107s/iter; left time: 10941.1826s
	iters: 400, epoch: 15 | loss: 0.0002084
	speed: 0.3197s/iter; left time: 11229.0882s
Epoch: 15 cost time: 131.56849431991577
Epoch: 15, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.188 Vali Acc: 0.965 Test Loss: 0.188 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000153
	speed: 0.6320s/iter; left time: 22123.0254s
	iters: 200, epoch: 16 | loss: 0.0020841
	speed: 0.3190s/iter; left time: 11134.2577s
	iters: 300, epoch: 16 | loss: 0.0000078
	speed: 0.3264s/iter; left time: 11361.1986s
	iters: 400, epoch: 16 | loss: 0.0000093
	speed: 0.3356s/iter; left time: 11647.3874s
Epoch: 16 cost time: 135.97950148582458
Epoch: 16, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.146 Vali Acc: 0.979 Test Loss: 0.146 Test Acc: 0.979
Validation loss decreased (-0.975896 --> -0.978625).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000029
	speed: 0.6694s/iter; left time: 23155.8269s
	iters: 200, epoch: 17 | loss: 0.0013428
	speed: 0.3124s/iter; left time: 10776.0634s
	iters: 300, epoch: 17 | loss: 0.0000171
	speed: 0.3239s/iter; left time: 11139.6559s
	iters: 400, epoch: 17 | loss: 0.0002136
	speed: 0.3305s/iter; left time: 11332.7536s
Epoch: 17 cost time: 134.18025922775269
Epoch: 17, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.094 Vali Acc: 0.985 Test Loss: 0.094 Test Acc: 0.985
Validation loss decreased (-0.978625 --> -0.985447).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000017
	speed: 0.6664s/iter; left time: 22776.2734s
	iters: 200, epoch: 18 | loss: 0.0295879
	speed: 0.3228s/iter; left time: 11000.9249s
	iters: 300, epoch: 18 | loss: 0.0212683
	speed: 0.3343s/iter; left time: 11361.1057s
	iters: 400, epoch: 18 | loss: 0.2701341
	speed: 0.3210s/iter; left time: 10874.7966s
Epoch: 18 cost time: 135.93919110298157
Epoch: 18, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.164 Vali Acc: 0.975 Test Loss: 0.164 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0545139
	speed: 0.6320s/iter; left time: 21342.4028s
	iters: 200, epoch: 19 | loss: 0.0001686
	speed: 0.3094s/iter; left time: 10417.4170s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.3137s/iter; left time: 10530.9221s
	iters: 400, epoch: 19 | loss: 0.0000111
	speed: 0.3090s/iter; left time: 10340.9251s
Epoch: 19 cost time: 129.13185691833496
Epoch: 19, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.123 Vali Acc: 0.981 Test Loss: 0.123 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0001058
	speed: 0.6048s/iter; left time: 20173.4591s
	iters: 200, epoch: 20 | loss: 0.0000001
	speed: 0.2938s/iter; left time: 9769.0312s
	iters: 300, epoch: 20 | loss: 0.0000511
	speed: 0.2922s/iter; left time: 9686.4553s
	iters: 400, epoch: 20 | loss: 0.0016473
	speed: 0.2901s/iter; left time: 9589.6185s
Epoch: 20 cost time: 121.24344778060913
Epoch: 20, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.147 Vali Acc: 0.971 Test Loss: 0.147 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000585
	speed: 0.6486s/iter; left time: 21367.0405s
	iters: 200, epoch: 21 | loss: 0.0000016
	speed: 0.3312s/iter; left time: 10876.5209s
	iters: 300, epoch: 21 | loss: 0.0003062
	speed: 0.3340s/iter; left time: 10934.6022s
	iters: 400, epoch: 21 | loss: 0.0000065
	speed: 0.3546s/iter; left time: 11575.5622s
Epoch: 21 cost time: 140.67981004714966
Epoch: 21, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.167 Vali Acc: 0.975 Test Loss: 0.167 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0001603
	speed: 0.6683s/iter; left time: 21739.8375s
	iters: 200, epoch: 22 | loss: 0.0103548
	speed: 0.3474s/iter; left time: 11263.9228s
	iters: 300, epoch: 22 | loss: 0.0001787
	speed: 0.3192s/iter; left time: 10319.4452s
	iters: 400, epoch: 22 | loss: 0.2349947
	speed: 0.3342s/iter; left time: 10771.8069s
Epoch: 22 cost time: 137.49310541152954
Epoch: 22, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.212 Vali Acc: 0.970 Test Loss: 0.212 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0000015
	speed: 0.6315s/iter; left time: 20281.5021s
	iters: 200, epoch: 23 | loss: 0.0000018
	speed: 0.3224s/iter; left time: 10322.3055s
	iters: 300, epoch: 23 | loss: 0.0000039
	speed: 0.3338s/iter; left time: 10652.1844s
	iters: 400, epoch: 23 | loss: 0.0000005
	speed: 0.3351s/iter; left time: 10660.4351s
Epoch: 23 cost time: 136.20523953437805
Epoch: 23, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.108 Vali Acc: 0.981 Test Loss: 0.108 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0000031
	speed: 0.6514s/iter; left time: 20649.1039s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.3336s/iter; left time: 10542.1746s
	iters: 300, epoch: 24 | loss: 0.0042931
	speed: 0.3267s/iter; left time: 10290.3059s
	iters: 400, epoch: 24 | loss: 0.0000004
	speed: 0.3132s/iter; left time: 9836.4260s
Epoch: 24 cost time: 134.19115591049194
Epoch: 24, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.136 Vali Acc: 0.975 Test Loss: 0.136 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0000097
	speed: 0.6363s/iter; left time: 19909.7126s
	iters: 200, epoch: 25 | loss: 0.3100922
	speed: 0.3208s/iter; left time: 10004.7276s
	iters: 300, epoch: 25 | loss: 0.0000079
	speed: 0.3145s/iter; left time: 9777.6184s
	iters: 400, epoch: 25 | loss: 0.0063538
	speed: 0.3166s/iter; left time: 9811.9504s
Epoch: 25 cost time: 131.72292590141296
Epoch: 25, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.268 Vali Acc: 0.967 Test Loss: 0.268 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0000002
	speed: 0.6437s/iter; left time: 19873.6958s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.3321s/iter; left time: 10221.0105s
	iters: 300, epoch: 26 | loss: 0.0000022
	speed: 0.3237s/iter; left time: 9928.5675s
	iters: 400, epoch: 26 | loss: 0.0000003
	speed: 0.3311s/iter; left time: 10124.7008s
Epoch: 26 cost time: 136.19432997703552
Epoch: 26, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.160 Vali Acc: 0.976 Test Loss: 0.160 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.6553s/iter; left time: 19962.5924s
	iters: 200, epoch: 27 | loss: 0.0000018
	speed: 0.3411s/iter; left time: 10358.0633s
	iters: 300, epoch: 27 | loss: 0.0025344
	speed: 0.3410s/iter; left time: 10319.6592s
	iters: 400, epoch: 27 | loss: 0.0000004
	speed: 0.3404s/iter; left time: 10266.7789s
Epoch: 27 cost time: 138.68785691261292
Epoch: 27, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.153 Vali Acc: 0.977 Test Loss: 0.153 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9854479308776717
model parameter : 2284810
model size : 13.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.3020568
	speed: 0.3474s/iter; left time: 14314.7520s
	iters: 200, epoch: 1 | loss: 2.3019111
	speed: 0.3240s/iter; left time: 13317.3591s
	iters: 300, epoch: 1 | loss: 2.3047132
	speed: 0.3230s/iter; left time: 13243.3490s
	iters: 400, epoch: 1 | loss: 2.3037102
	speed: 0.3214s/iter; left time: 13144.5043s
Epoch: 1 cost time: 135.8917772769928
Epoch: 1, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (inf --> -0.100022).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3026199
	speed: 0.6218s/iter; left time: 25360.5578s
	iters: 200, epoch: 2 | loss: 2.3008196
	speed: 0.3223s/iter; left time: 13113.0829s
	iters: 300, epoch: 2 | loss: 2.3024282
	speed: 0.3210s/iter; left time: 13030.5945s
	iters: 400, epoch: 2 | loss: 2.3027315
	speed: 0.3243s/iter; left time: 13129.0003s
Epoch: 2 cost time: 132.98124432563782
Epoch: 2, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3024559
	speed: 0.6340s/iter; left time: 25596.5520s
	iters: 200, epoch: 3 | loss: 2.3017180
	speed: 0.3132s/iter; left time: 12615.6837s
	iters: 300, epoch: 3 | loss: 2.3006999
	speed: 0.3310s/iter; left time: 13299.6830s
	iters: 400, epoch: 3 | loss: 2.3028882
	speed: 0.3228s/iter; left time: 12935.7435s
Epoch: 3 cost time: 133.39544796943665
Epoch: 3, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3030629
	speed: 0.6492s/iter; left time: 25945.1607s
	iters: 200, epoch: 4 | loss: 2.3021073
	speed: 0.3343s/iter; left time: 13324.9545s
	iters: 300, epoch: 4 | loss: 2.3028061
	speed: 0.3157s/iter; left time: 12553.3391s
	iters: 400, epoch: 4 | loss: 2.3029857
	speed: 0.3438s/iter; left time: 13635.9120s
Epoch: 4 cost time: 137.7913899421692
Epoch: 4, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.3030396
	speed: 0.6306s/iter; left time: 24941.0123s
	iters: 200, epoch: 5 | loss: 2.3025811
	speed: 0.3179s/iter; left time: 12538.9297s
	iters: 300, epoch: 5 | loss: 2.3035476
	speed: 0.3153s/iter; left time: 12406.7854s
	iters: 400, epoch: 5 | loss: 2.3017669
	speed: 0.3234s/iter; left time: 12694.3277s
Epoch: 5 cost time: 132.09578394889832
Epoch: 5, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.3032966
	speed: 0.6186s/iter; left time: 24207.6889s
	iters: 200, epoch: 6 | loss: 2.3033974
	speed: 0.3196s/iter; left time: 12475.3773s
	iters: 300, epoch: 6 | loss: 2.3013611
	speed: 0.3236s/iter; left time: 12599.4535s
	iters: 400, epoch: 6 | loss: 2.3036036
	speed: 0.3177s/iter; left time: 12337.2162s
Epoch: 6 cost time: 132.08204746246338
Epoch: 6, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 2.3043153
	speed: 0.6161s/iter; left time: 23857.4400s
	iters: 200, epoch: 7 | loss: 2.3095026
	speed: 0.3142s/iter; left time: 12136.8065s
	iters: 300, epoch: 7 | loss: 2.3023090
	speed: 0.3162s/iter; left time: 12180.0991s
	iters: 400, epoch: 7 | loss: 2.3042784
	speed: 0.3176s/iter; left time: 12204.3882s
Epoch: 7 cost time: 130.28978538513184
Epoch: 7, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 2.2989154
	speed: 0.6135s/iter; left time: 23504.0319s
	iters: 200, epoch: 8 | loss: 2.3069153
	speed: 0.3232s/iter; left time: 12350.7097s
	iters: 300, epoch: 8 | loss: 2.3017788
	speed: 0.3127s/iter; left time: 11916.2260s
	iters: 400, epoch: 8 | loss: 2.3034530
	speed: 0.3287s/iter; left time: 12493.8780s
Epoch: 8 cost time: 132.82715129852295
Epoch: 8, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 2.3041463
	speed: 0.6330s/iter; left time: 23989.6646s
	iters: 200, epoch: 9 | loss: 2.2999530
	speed: 0.3285s/iter; left time: 12418.1266s
	iters: 300, epoch: 9 | loss: 2.3018150
	speed: 0.3195s/iter; left time: 12043.8241s
	iters: 400, epoch: 9 | loss: 2.3026013
	speed: 0.3204s/iter; left time: 12044.5421s
Epoch: 9 cost time: 134.29994916915894
Epoch: 9, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 2.3044577
	speed: 0.6371s/iter; left time: 23881.4700s
	iters: 200, epoch: 10 | loss: 2.2983632
	speed: 0.3185s/iter; left time: 11906.0847s
	iters: 300, epoch: 10 | loss: 2.3023291
	speed: 0.3222s/iter; left time: 12013.6748s
	iters: 400, epoch: 10 | loss: 2.3055964
	speed: 0.3546s/iter; left time: 13184.5376s
Epoch: 10 cost time: 136.16441130638123
Epoch: 10, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.2995365
	speed: 0.6709s/iter; left time: 24870.3375s
	iters: 200, epoch: 11 | loss: 2.3004720
	speed: 0.3277s/iter; left time: 12115.4266s
	iters: 300, epoch: 11 | loss: 2.3030789
	speed: 0.3257s/iter; left time: 12010.5731s
	iters: 400, epoch: 11 | loss: 2.3023098
	speed: 0.3192s/iter; left time: 11738.2465s
Epoch: 11 cost time: 135.66713547706604
Epoch: 11, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 2.3035634
	speed: 0.6305s/iter; left time: 23113.9964s
	iters: 200, epoch: 12 | loss: 2.3011763
	speed: 0.3316s/iter; left time: 12121.7548s
	iters: 300, epoch: 12 | loss: 2.3038089
	speed: 0.3280s/iter; left time: 11958.0917s
	iters: 400, epoch: 12 | loss: 2.3028312
	speed: 0.3360s/iter; left time: 12215.2778s
Epoch: 12 cost time: 136.23099827766418
Epoch: 12, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 2.3033254
	speed: 0.6234s/iter; left time: 22594.1516s
	iters: 200, epoch: 13 | loss: 2.3025777
	speed: 0.3185s/iter; left time: 11512.0516s
	iters: 300, epoch: 13 | loss: 2.3041956
	speed: 0.3228s/iter; left time: 11633.5905s
	iters: 400, epoch: 13 | loss: 2.3029861
	speed: 0.3108s/iter; left time: 11171.1502s
Epoch: 13 cost time: 131.0663356781006
Epoch: 13, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 2.3024490
	speed: 0.6159s/iter; left time: 22069.2118s
	iters: 200, epoch: 14 | loss: 2.3014829
	speed: 0.3276s/iter; left time: 11706.5683s
	iters: 300, epoch: 14 | loss: 2.2980833
	speed: 0.3257s/iter; left time: 11605.8252s
	iters: 400, epoch: 14 | loss: 2.3023281
	speed: 0.3091s/iter; left time: 10982.3938s
Epoch: 14 cost time: 131.6774206161499
Epoch: 14, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 2.3027530
	speed: 0.6460s/iter; left time: 22880.1920s
	iters: 200, epoch: 15 | loss: 2.3018343
	speed: 0.3076s/iter; left time: 10865.7810s
	iters: 300, epoch: 15 | loss: 2.3015280
	speed: 0.3184s/iter; left time: 11213.5388s
	iters: 400, epoch: 15 | loss: 2.3027968
	speed: 0.3178s/iter; left time: 11159.6605s
Epoch: 15 cost time: 131.68071866035461
Epoch: 15, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 2.3079016
	speed: 0.6301s/iter; left time: 22056.2770s
	iters: 200, epoch: 16 | loss: 2.3028395
	speed: 0.3150s/iter; left time: 10994.1010s
	iters: 300, epoch: 16 | loss: 2.3019850
	speed: 0.3161s/iter; left time: 11000.8881s
	iters: 400, epoch: 16 | loss: 2.3021731
	speed: 0.3106s/iter; left time: 10780.2718s
Epoch: 16 cost time: 130.4773383140564
Epoch: 16, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 2.2993064
	speed: 0.6068s/iter; left time: 20991.8595s
	iters: 200, epoch: 17 | loss: 2.3047638
	speed: 0.3178s/iter; left time: 10961.1650s
	iters: 300, epoch: 17 | loss: 2.3080103
	speed: 0.3097s/iter; left time: 10649.8926s
	iters: 400, epoch: 17 | loss: 2.3021352
	speed: 0.3152s/iter; left time: 10809.6009s
Epoch: 17 cost time: 129.29077529907227
Epoch: 17, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 2.3062115
	speed: 0.6428s/iter; left time: 21971.6650s
	iters: 200, epoch: 18 | loss: 2.3019645
	speed: 0.3200s/iter; left time: 10904.2853s
	iters: 300, epoch: 18 | loss: 2.3021822
	speed: 0.2994s/iter; left time: 10172.4329s
	iters: 400, epoch: 18 | loss: 2.3032796
	speed: 0.3011s/iter; left time: 10202.3110s
Epoch: 18 cost time: 129.51475858688354
Epoch: 18, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 2.3027136
	speed: 0.5789s/iter; left time: 19549.2885s
	iters: 200, epoch: 19 | loss: 2.2998655
	speed: 0.3043s/iter; left time: 10244.8699s
	iters: 300, epoch: 19 | loss: 2.3024876
	speed: 0.3045s/iter; left time: 10219.8002s
	iters: 400, epoch: 19 | loss: 2.3022280
	speed: 0.3051s/iter; left time: 10211.0263s
Epoch: 19 cost time: 125.04994893074036
Epoch: 19, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 2.3057652
	speed: 0.6065s/iter; left time: 20228.2321s
	iters: 200, epoch: 20 | loss: 2.3027890
	speed: 0.2979s/iter; left time: 9905.4555s
	iters: 300, epoch: 20 | loss: 2.3045135
	speed: 0.3030s/iter; left time: 10045.2813s
	iters: 400, epoch: 20 | loss: 2.3030484
	speed: 0.2947s/iter; left time: 9740.9992s
Epoch: 20 cost time: 124.35456919670105
Epoch: 20, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.10004547521600728
model parameter : 2284810
model size : 13.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         47                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4083440
	speed: 0.3097s/iter; left time: 12760.5438s
	iters: 200, epoch: 1 | loss: 0.0859591
	speed: 0.2932s/iter; left time: 12051.1012s
	iters: 300, epoch: 1 | loss: 0.0732196
	speed: 0.2855s/iter; left time: 11707.2590s
	iters: 400, epoch: 1 | loss: 0.0351221
	speed: 0.2888s/iter; left time: 11810.2418s
Epoch: 1 cost time: 121.52493453025818
Epoch: 1, Steps: 413 | Train Loss: 0.442 Vali Loss: 0.064 Vali Acc: 0.981 Test Loss: 0.064 Test Acc: 0.981
Validation loss decreased (inf --> -0.980900).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0352443
	speed: 0.5930s/iter; left time: 24185.4962s
	iters: 200, epoch: 2 | loss: 0.1655792
	speed: 0.2987s/iter; left time: 12152.3228s
	iters: 300, epoch: 2 | loss: 0.0492751
	speed: 0.2958s/iter; left time: 12004.5041s
	iters: 400, epoch: 2 | loss: 0.0324078
	speed: 0.3110s/iter; left time: 12591.5168s
Epoch: 2 cost time: 124.7322256565094
Epoch: 2, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.100 Vali Acc: 0.966 Test Loss: 0.100 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0548652
	speed: 0.6575s/iter; left time: 26546.9525s
	iters: 200, epoch: 3 | loss: 0.0050985
	speed: 0.3436s/iter; left time: 13836.8069s
	iters: 300, epoch: 3 | loss: 0.0019646
	speed: 0.3176s/iter; left time: 12760.4295s
	iters: 400, epoch: 3 | loss: 0.0080224
	speed: 0.2907s/iter; left time: 11649.5706s
Epoch: 3 cost time: 132.61981463432312
Epoch: 3, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.078 Vali Acc: 0.975 Test Loss: 0.078 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0049762
	speed: 0.5796s/iter; left time: 23162.0806s
	iters: 200, epoch: 4 | loss: 0.0354833
	speed: 0.3003s/iter; left time: 11968.5914s
	iters: 300, epoch: 4 | loss: 0.0016730
	speed: 0.3147s/iter; left time: 12512.9640s
	iters: 400, epoch: 4 | loss: 0.0202029
	speed: 0.3033s/iter; left time: 12028.0856s
Epoch: 4 cost time: 125.45356845855713
Epoch: 4, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.097 Vali Acc: 0.971 Test Loss: 0.097 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0009830
	speed: 0.6007s/iter; left time: 23755.5288s
	iters: 200, epoch: 5 | loss: 0.0409246
	speed: 0.2962s/iter; left time: 11685.4443s
	iters: 300, epoch: 5 | loss: 0.0008026
	speed: 0.2979s/iter; left time: 11720.8390s
	iters: 400, epoch: 5 | loss: 0.0005956
	speed: 0.2981s/iter; left time: 11699.4068s
Epoch: 5 cost time: 123.99234819412231
Epoch: 5, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.310 Vali Acc: 0.945 Test Loss: 0.310 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.3315341
	speed: 0.5949s/iter; left time: 23280.2505s
	iters: 200, epoch: 6 | loss: 0.0003445
	speed: 0.3061s/iter; left time: 11950.8661s
	iters: 300, epoch: 6 | loss: 0.0046689
	speed: 0.3035s/iter; left time: 11815.9250s
	iters: 400, epoch: 6 | loss: 0.0126958
	speed: 0.3072s/iter; left time: 11928.8470s
Epoch: 6 cost time: 125.54303216934204
Epoch: 6, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.151 Vali Acc: 0.966 Test Loss: 0.151 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0721100
	speed: 0.6002s/iter; left time: 23240.0940s
	iters: 200, epoch: 7 | loss: 0.0004977
	speed: 0.3071s/iter; left time: 11862.8633s
	iters: 300, epoch: 7 | loss: 0.0006136
	speed: 0.3047s/iter; left time: 11738.3332s
	iters: 400, epoch: 7 | loss: 0.0000518
	speed: 0.3000s/iter; left time: 11527.1179s
Epoch: 7 cost time: 125.45899415016174
Epoch: 7, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.136 Vali Acc: 0.971 Test Loss: 0.136 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.0000486
	speed: 0.5913s/iter; left time: 22653.4089s
	iters: 200, epoch: 8 | loss: 0.0836981
	speed: 0.2932s/iter; left time: 11202.4248s
	iters: 300, epoch: 8 | loss: 0.0127944
	speed: 0.2884s/iter; left time: 10989.3834s
	iters: 400, epoch: 8 | loss: 0.0000579
	speed: 0.2880s/iter; left time: 10947.4316s
Epoch: 8 cost time: 119.58814024925232
Epoch: 8, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.0000011
	speed: 0.5620s/iter; left time: 21299.0799s
	iters: 200, epoch: 9 | loss: 0.0000100
	speed: 0.2931s/iter; left time: 11077.5673s
	iters: 300, epoch: 9 | loss: 0.0091454
	speed: 0.2994s/iter; left time: 11285.8383s
	iters: 400, epoch: 9 | loss: 0.0000586
	speed: 0.2991s/iter; left time: 11245.0532s
Epoch: 9 cost time: 122.22072434425354
Epoch: 9, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.285 Vali Acc: 0.957 Test Loss: 0.285 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.0000003
	speed: 0.6163s/iter; left time: 23101.7578s
	iters: 200, epoch: 10 | loss: 0.0000129
	speed: 0.3048s/iter; left time: 11393.2276s
	iters: 300, epoch: 10 | loss: 0.0006634
	speed: 0.3058s/iter; left time: 11400.4212s
	iters: 400, epoch: 10 | loss: 0.0000837
	speed: 0.3021s/iter; left time: 11231.7348s
Epoch: 10 cost time: 126.44717955589294
Epoch: 10, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.197 Vali Acc: 0.968 Test Loss: 0.197 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.0025654
	speed: 0.5866s/iter; left time: 21746.3833s
	iters: 200, epoch: 11 | loss: 0.0000002
	speed: 0.2962s/iter; left time: 10949.5380s
	iters: 300, epoch: 11 | loss: 0.0000102
	speed: 0.2968s/iter; left time: 10942.5593s
	iters: 400, epoch: 11 | loss: 0.0001907
	speed: 0.2857s/iter; left time: 10503.9215s
Epoch: 11 cost time: 121.22882986068726
Epoch: 11, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.278 Vali Acc: 0.957 Test Loss: 0.278 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9809004092769441
model parameter : 1498378
model size : 10.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         38                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6109775
	speed: 0.3181s/iter; left time: 13105.2030s
	iters: 200, epoch: 1 | loss: 0.0888879
	speed: 0.2983s/iter; left time: 12260.1149s
	iters: 300, epoch: 1 | loss: 0.0832498
	speed: 0.3220s/iter; left time: 13202.8974s
	iters: 400, epoch: 1 | loss: 0.0485899
	speed: 0.3178s/iter; left time: 12999.5067s
Epoch: 1 cost time: 130.0988428592682
Epoch: 1, Steps: 413 | Train Loss: 0.471 Vali Loss: 0.076 Vali Acc: 0.975 Test Loss: 0.076 Test Acc: 0.975
Validation loss decreased (inf --> -0.974988).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0687855
	speed: 0.6192s/iter; left time: 25254.0827s
	iters: 200, epoch: 2 | loss: 0.0660589
	speed: 0.2976s/iter; left time: 12107.4977s
	iters: 300, epoch: 2 | loss: 0.1943434
	speed: 0.2968s/iter; left time: 12048.0663s
	iters: 400, epoch: 2 | loss: 0.0065685
	speed: 0.2971s/iter; left time: 12027.7469s
Epoch: 2 cost time: 124.74816513061523
Epoch: 2, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.064 Vali Acc: 0.974 Test Loss: 0.064 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0144626
	speed: 0.5783s/iter; left time: 23347.2207s
	iters: 200, epoch: 3 | loss: 0.0434492
	speed: 0.2819s/iter; left time: 11351.9931s
	iters: 300, epoch: 3 | loss: 0.0107056
	speed: 0.2841s/iter; left time: 11414.4496s
	iters: 400, epoch: 3 | loss: 0.0054951
	speed: 0.2910s/iter; left time: 11662.4904s
Epoch: 3 cost time: 118.71638250350952
Epoch: 3, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
Validation loss decreased (-0.974988 --> -0.976352).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0085959
	speed: 0.5747s/iter; left time: 22967.8948s
	iters: 200, epoch: 4 | loss: 0.0821714
	speed: 0.2930s/iter; left time: 11679.5580s
	iters: 300, epoch: 4 | loss: 0.0113570
	speed: 0.3118s/iter; left time: 12396.5718s
	iters: 400, epoch: 4 | loss: 0.0004364
	speed: 0.2978s/iter; left time: 11809.8037s
Epoch: 4 cost time: 123.37537908554077
Epoch: 4, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.976352 --> -0.979535).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0082528
	speed: 0.5798s/iter; left time: 22931.6756s
	iters: 200, epoch: 5 | loss: 0.0018453
	speed: 0.2842s/iter; left time: 11212.6276s
	iters: 300, epoch: 5 | loss: 0.0013991
	speed: 0.2897s/iter; left time: 11400.4680s
	iters: 400, epoch: 5 | loss: 0.0000071
	speed: 0.2903s/iter; left time: 11395.2177s
Epoch: 5 cost time: 119.89090895652771
Epoch: 5, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0104699
	speed: 0.6104s/iter; left time: 23888.6104s
	iters: 200, epoch: 6 | loss: 0.0000257
	speed: 0.3099s/iter; left time: 12097.4737s
	iters: 300, epoch: 6 | loss: 0.0601834
	speed: 0.3107s/iter; left time: 12095.7707s
	iters: 400, epoch: 6 | loss: 0.0223410
	speed: 0.3106s/iter; left time: 12061.9338s
Epoch: 6 cost time: 128.31249594688416
Epoch: 6, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.142 Vali Acc: 0.974 Test Loss: 0.142 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0574681
	speed: 0.5997s/iter; left time: 23220.4541s
	iters: 200, epoch: 7 | loss: 0.0060931
	speed: 0.2866s/iter; left time: 11068.6765s
	iters: 300, epoch: 7 | loss: 0.0000028
	speed: 0.2851s/iter; left time: 10983.5703s
	iters: 400, epoch: 7 | loss: 0.0002210
	speed: 0.2943s/iter; left time: 11308.8237s
Epoch: 7 cost time: 120.27035903930664
Epoch: 7, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0005448
	speed: 0.5772s/iter; left time: 22112.8110s
	iters: 200, epoch: 8 | loss: 0.0001626
	speed: 0.2822s/iter; left time: 10783.0986s
	iters: 300, epoch: 8 | loss: 0.0011233
	speed: 0.2935s/iter; left time: 11185.4950s
	iters: 400, epoch: 8 | loss: 0.0000783
	speed: 0.2876s/iter; left time: 10932.1181s
Epoch: 8 cost time: 119.19468593597412
Epoch: 8, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.153 Vali Acc: 0.971 Test Loss: 0.153 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000051
	speed: 0.5787s/iter; left time: 21932.4718s
	iters: 200, epoch: 9 | loss: 0.0000318
	speed: 0.3057s/iter; left time: 11556.0779s
	iters: 300, epoch: 9 | loss: 0.0000357
	speed: 0.3051s/iter; left time: 11499.7364s
	iters: 400, epoch: 9 | loss: 0.0000411
	speed: 0.3092s/iter; left time: 11624.1886s
Epoch: 9 cost time: 125.11383581161499
Epoch: 9, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0000026
	speed: 0.6170s/iter; left time: 23127.1039s
	iters: 200, epoch: 10 | loss: 0.0001488
	speed: 0.2976s/iter; left time: 11126.3345s
	iters: 300, epoch: 10 | loss: 0.0000015
	speed: 0.2984s/iter; left time: 11124.2165s
	iters: 400, epoch: 10 | loss: 0.0000324
	speed: 0.2881s/iter; left time: 10713.7252s
Epoch: 10 cost time: 123.54800486564636
Epoch: 10, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.172 Vali Acc: 0.974 Test Loss: 0.172 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000708
	speed: 0.5763s/iter; left time: 21363.7289s
	iters: 200, epoch: 11 | loss: 0.0006263
	speed: 0.2903s/iter; left time: 10732.3975s
	iters: 300, epoch: 11 | loss: 0.0111927
	speed: 0.2918s/iter; left time: 10758.6558s
	iters: 400, epoch: 11 | loss: 0.0028552
	speed: 0.2955s/iter; left time: 10864.9438s
Epoch: 11 cost time: 121.10532784461975
Epoch: 11, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.173 Vali Acc: 0.975 Test Loss: 0.173 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0000008
	speed: 0.5951s/iter; left time: 21815.5913s
	iters: 200, epoch: 12 | loss: 0.0008435
	speed: 0.3014s/iter; left time: 11017.3962s
	iters: 300, epoch: 12 | loss: 0.0053184
	speed: 0.3010s/iter; left time: 10974.5903s
	iters: 400, epoch: 12 | loss: 0.0001212
	speed: 0.2965s/iter; left time: 10778.3840s
Epoch: 12 cost time: 124.67230176925659
Epoch: 12, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.152 Vali Acc: 0.978 Test Loss: 0.152 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0005698
	speed: 0.6077s/iter; left time: 22027.3292s
	iters: 200, epoch: 13 | loss: 0.0000000
	speed: 0.3040s/iter; left time: 10988.1958s
	iters: 300, epoch: 13 | loss: 0.0262733
	speed: 0.3071s/iter; left time: 11069.6529s
	iters: 400, epoch: 13 | loss: 0.0849265
	speed: 0.3117s/iter; left time: 11203.1240s
Epoch: 13 cost time: 126.62091374397278
Epoch: 13, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.246 Vali Acc: 0.968 Test Loss: 0.246 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000033
	speed: 0.6169s/iter; left time: 22103.0050s
	iters: 200, epoch: 14 | loss: 0.0000933
	speed: 0.3137s/iter; left time: 11208.5612s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.2948s/iter; left time: 10502.9698s
	iters: 400, epoch: 14 | loss: 0.0000857
	speed: 0.2955s/iter; left time: 10500.5579s
Epoch: 14 cost time: 126.09967803955078
Epoch: 14, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.173 Vali Acc: 0.975 Test Loss: 0.173 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9795361527967258
model parameter : 1498378
model size : 10.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         28                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8245556
	speed: 0.3099s/iter; left time: 12768.7606s
	iters: 200, epoch: 1 | loss: 0.1327995
	speed: 0.3006s/iter; left time: 12354.4508s
	iters: 300, epoch: 1 | loss: 0.1438973
	speed: 0.3076s/iter; left time: 12612.2660s
	iters: 400, epoch: 1 | loss: 0.0616027
	speed: 0.3102s/iter; left time: 12686.5533s
Epoch: 1 cost time: 127.10181450843811
Epoch: 1, Steps: 413 | Train Loss: 0.518 Vali Loss: 0.080 Vali Acc: 0.975 Test Loss: 0.080 Test Acc: 0.975
Validation loss decreased (inf --> -0.974988).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0726116
	speed: 0.6208s/iter; left time: 25319.3822s
	iters: 200, epoch: 2 | loss: 0.2022080
	speed: 0.3133s/iter; left time: 12747.9150s
	iters: 300, epoch: 2 | loss: 0.0206648
	speed: 0.3179s/iter; left time: 12902.1187s
	iters: 400, epoch: 2 | loss: 0.0195182
	speed: 0.3141s/iter; left time: 12716.5202s
Epoch: 2 cost time: 130.31702613830566
Epoch: 2, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.127 Vali Acc: 0.958 Test Loss: 0.127 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1391266
	speed: 0.6177s/iter; left time: 24938.6973s
	iters: 200, epoch: 3 | loss: 0.0114816
	speed: 0.2997s/iter; left time: 12071.0113s
	iters: 300, epoch: 3 | loss: 0.0032619
	speed: 0.2973s/iter; left time: 11945.3191s
	iters: 400, epoch: 3 | loss: 0.0004297
	speed: 0.2931s/iter; left time: 11746.6879s
Epoch: 3 cost time: 124.33858633041382
Epoch: 3, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.080 Vali Acc: 0.975 Test Loss: 0.080 Test Acc: 0.975
Validation loss decreased (-0.974988 --> -0.975443).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0147538
	speed: 0.5808s/iter; left time: 23210.5634s
	iters: 200, epoch: 4 | loss: 0.2942104
	speed: 0.3095s/iter; left time: 12337.8696s
	iters: 300, epoch: 4 | loss: 0.0033193
	speed: 0.3120s/iter; left time: 12405.3993s
	iters: 400, epoch: 4 | loss: 0.0578099
	speed: 0.3202s/iter; left time: 12700.7163s
Epoch: 4 cost time: 128.6320436000824
Epoch: 4, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0470601
	speed: 0.6579s/iter; left time: 26019.3913s
	iters: 200, epoch: 5 | loss: 0.0007774
	speed: 0.3107s/iter; left time: 12255.6854s
	iters: 300, epoch: 5 | loss: 0.0010010
	speed: 0.2996s/iter; left time: 11790.4936s
	iters: 400, epoch: 5 | loss: 0.0179193
	speed: 0.2869s/iter; left time: 11259.2580s
Epoch: 5 cost time: 126.92802548408508
Epoch: 5, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.146 Vali Acc: 0.965 Test Loss: 0.146 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.3543833
	speed: 0.5704s/iter; left time: 22321.6780s
	iters: 200, epoch: 6 | loss: 0.0002619
	speed: 0.2956s/iter; left time: 11537.1589s
	iters: 300, epoch: 6 | loss: 0.8069615
	speed: 0.2984s/iter; left time: 11617.2434s
	iters: 400, epoch: 6 | loss: 0.0239367
	speed: 0.2987s/iter; left time: 11598.7172s
Epoch: 6 cost time: 122.60121059417725
Epoch: 6, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
Validation loss decreased (-0.975443 --> -0.975897).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0997990
	speed: 0.6063s/iter; left time: 23478.4918s
	iters: 200, epoch: 7 | loss: 0.0009691
	speed: 0.3064s/iter; left time: 11835.6107s
	iters: 300, epoch: 7 | loss: 0.0001086
	speed: 0.3183s/iter; left time: 12260.2457s
	iters: 400, epoch: 7 | loss: 0.0031439
	speed: 0.3162s/iter; left time: 12150.2025s
Epoch: 7 cost time: 129.63282108306885
Epoch: 7, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
Validation loss decreased (-0.975897 --> -0.977716).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2219096
	speed: 0.6153s/iter; left time: 23571.3339s
	iters: 200, epoch: 8 | loss: 0.0004195
	speed: 0.3061s/iter; left time: 11697.5231s
	iters: 300, epoch: 8 | loss: 0.5547080
	speed: 0.3059s/iter; left time: 11659.2130s
	iters: 400, epoch: 8 | loss: 0.0015495
	speed: 0.2924s/iter; left time: 11112.5165s
Epoch: 8 cost time: 124.80802798271179
Epoch: 8, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.261 Vali Acc: 0.951 Test Loss: 0.261 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0108079
	speed: 0.6037s/iter; left time: 22878.8463s
	iters: 200, epoch: 9 | loss: 0.0328822
	speed: 0.3366s/iter; left time: 12720.7615s
	iters: 300, epoch: 9 | loss: 0.0000449
	speed: 0.3377s/iter; left time: 12730.6093s
	iters: 400, epoch: 9 | loss: 0.0003433
	speed: 0.3054s/iter; left time: 11482.7511s
Epoch: 9 cost time: 133.52502942085266
Epoch: 9, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.167 Vali Acc: 0.960 Test Loss: 0.167 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000220
	speed: 0.6060s/iter; left time: 22714.6756s
	iters: 200, epoch: 10 | loss: 0.0000605
	speed: 0.3092s/iter; left time: 11560.2104s
	iters: 300, epoch: 10 | loss: 0.0022552
	speed: 0.3022s/iter; left time: 11268.9980s
	iters: 400, epoch: 10 | loss: 0.0001296
	speed: 0.3048s/iter; left time: 11333.1562s
Epoch: 10 cost time: 127.1759295463562
Epoch: 10, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.058 Vali Acc: 0.983 Test Loss: 0.058 Test Acc: 0.983
Validation loss decreased (-0.977716 --> -0.982719).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0001539
	speed: 0.6623s/iter; left time: 24552.4601s
	iters: 200, epoch: 11 | loss: 0.0041517
	speed: 0.3319s/iter; left time: 12268.9712s
	iters: 300, epoch: 11 | loss: 0.0000019
	speed: 0.3270s/iter; left time: 12055.3547s
	iters: 400, epoch: 11 | loss: 0.0054264
	speed: 0.3209s/iter; left time: 11801.0757s
Epoch: 11 cost time: 136.15753531455994
Epoch: 11, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.152 Vali Acc: 0.977 Test Loss: 0.152 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000271
	speed: 0.6433s/iter; left time: 23581.1642s
	iters: 200, epoch: 12 | loss: 0.0017805
	speed: 0.3339s/iter; left time: 12207.7319s
	iters: 300, epoch: 12 | loss: 0.0000004
	speed: 0.3455s/iter; left time: 12598.0267s
	iters: 400, epoch: 12 | loss: 0.0000021
	speed: 0.3115s/iter; left time: 11324.3399s
Epoch: 12 cost time: 136.17955327033997
Epoch: 12, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000029
	speed: 0.6118s/iter; left time: 22175.4540s
	iters: 200, epoch: 13 | loss: 0.0000678
	speed: 0.3051s/iter; left time: 11026.3105s
	iters: 300, epoch: 13 | loss: 0.0001290
	speed: 0.3125s/iter; left time: 11265.3333s
	iters: 400, epoch: 13 | loss: 0.1960732
	speed: 0.3183s/iter; left time: 11441.0370s
Epoch: 13 cost time: 128.8682200908661
Epoch: 13, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.240 Vali Acc: 0.970 Test Loss: 0.240 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000062
	speed: 0.6086s/iter; left time: 21807.0358s
	iters: 200, epoch: 14 | loss: 0.0000061
	speed: 0.3163s/iter; left time: 11301.1580s
	iters: 300, epoch: 14 | loss: 0.0000006
	speed: 0.3157s/iter; left time: 11248.7185s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.3191s/iter; left time: 11338.9778s
Epoch: 14 cost time: 130.12867188453674
Epoch: 14, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.194 Vali Acc: 0.972 Test Loss: 0.194 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000438
	speed: 0.6091s/iter; left time: 21573.4318s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.3023s/iter; left time: 10676.7883s
	iters: 300, epoch: 15 | loss: 0.0257420
	speed: 0.3176s/iter; left time: 11184.4976s
	iters: 400, epoch: 15 | loss: 0.0000722
	speed: 0.3108s/iter; left time: 10915.1011s
Epoch: 15 cost time: 128.820454120636
Epoch: 15, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.261 Vali Acc: 0.965 Test Loss: 0.261 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000002
	speed: 0.6193s/iter; left time: 21679.4941s
	iters: 200, epoch: 16 | loss: 0.0118097
	speed: 0.3136s/iter; left time: 10947.1771s
	iters: 300, epoch: 16 | loss: 0.0001083
	speed: 0.3118s/iter; left time: 10851.1326s
	iters: 400, epoch: 16 | loss: 0.0000004
	speed: 0.3062s/iter; left time: 10628.2015s
Epoch: 16 cost time: 128.7593696117401
Epoch: 16, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.199 Vali Acc: 0.972 Test Loss: 0.199 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000035
	speed: 0.5827s/iter; left time: 20158.2266s
	iters: 200, epoch: 17 | loss: 0.0000891
	speed: 0.2927s/iter; left time: 10094.6644s
	iters: 300, epoch: 17 | loss: 0.0002205
	speed: 0.2869s/iter; left time: 9868.8127s
	iters: 400, epoch: 17 | loss: 0.0008746
	speed: 0.2862s/iter; left time: 9813.3759s
Epoch: 17 cost time: 120.41926646232605
Epoch: 17, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.202 Vali Acc: 0.964 Test Loss: 0.202 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0880002
	speed: 0.5435s/iter; left time: 18577.5044s
	iters: 200, epoch: 18 | loss: 0.1520810
	speed: 0.2804s/iter; left time: 9557.3993s
	iters: 300, epoch: 18 | loss: 0.0000622
	speed: 0.2853s/iter; left time: 9695.6455s
	iters: 400, epoch: 18 | loss: 0.0000261
	speed: 0.2860s/iter; left time: 9689.1395s
Epoch: 18 cost time: 117.35558366775513
Epoch: 18, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.123 Vali Acc: 0.983 Test Loss: 0.123 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0000761
	speed: 0.6064s/iter; left time: 20475.5470s
	iters: 200, epoch: 19 | loss: 0.0179829
	speed: 0.3149s/iter; left time: 10601.3138s
	iters: 300, epoch: 19 | loss: 0.0005219
	speed: 0.3066s/iter; left time: 10292.0251s
	iters: 400, epoch: 19 | loss: 0.0000037
	speed: 0.2964s/iter; left time: 9919.4778s
Epoch: 19 cost time: 126.146817445755
Epoch: 19, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.142 Vali Acc: 0.978 Test Loss: 0.142 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0010966
	speed: 0.5955s/iter; left time: 19863.0295s
	iters: 200, epoch: 20 | loss: 0.0001713
	speed: 0.2898s/iter; left time: 9636.8259s
	iters: 300, epoch: 20 | loss: 0.0000005
	speed: 0.2899s/iter; left time: 9609.9329s
	iters: 400, epoch: 20 | loss: 0.0000015
	speed: 0.2898s/iter; left time: 9579.1056s
Epoch: 20 cost time: 120.70740485191345
Epoch: 20, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.063 Vali Acc: 0.990 Test Loss: 0.063 Test Acc: 0.990
Validation loss decreased (-0.982719 --> -0.989540).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0031899
	speed: 0.5548s/iter; left time: 18276.3623s
	iters: 200, epoch: 21 | loss: 0.0007636
	speed: 0.2786s/iter; left time: 9149.1104s
	iters: 300, epoch: 21 | loss: 0.0410826
	speed: 0.2869s/iter; left time: 9392.2009s
	iters: 400, epoch: 21 | loss: 0.0000337
	speed: 0.2966s/iter; left time: 9680.9722s
Epoch: 21 cost time: 117.92176294326782
Epoch: 21, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.185 Vali Acc: 0.975 Test Loss: 0.185 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.5838s/iter; left time: 18990.6324s
	iters: 200, epoch: 22 | loss: 0.0004418
	speed: 0.3084s/iter; left time: 10000.0143s
	iters: 300, epoch: 22 | loss: 0.0164014
	speed: 0.3094s/iter; left time: 10001.8203s
	iters: 400, epoch: 22 | loss: 0.0002126
	speed: 0.2999s/iter; left time: 9665.4501s
Epoch: 22 cost time: 125.73239064216614
Epoch: 22, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.262 Vali Acc: 0.967 Test Loss: 0.262 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0001587
	speed: 0.6180s/iter; left time: 19846.6009s
	iters: 200, epoch: 23 | loss: 0.0000474
	speed: 0.3044s/iter; left time: 9746.6341s
	iters: 300, epoch: 23 | loss: 0.0000002
	speed: 0.2990s/iter; left time: 9543.5362s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.3103s/iter; left time: 9871.3886s
Epoch: 23 cost time: 127.87631130218506
Epoch: 23, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.158 Vali Acc: 0.979 Test Loss: 0.158 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0894087
	speed: 0.5888s/iter; left time: 18665.6166s
	iters: 200, epoch: 24 | loss: 0.0000185
	speed: 0.3045s/iter; left time: 9622.1094s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.2898s/iter; left time: 9129.5349s
	iters: 400, epoch: 24 | loss: 0.0056942
	speed: 0.2896s/iter; left time: 9093.6894s
Epoch: 24 cost time: 123.2890236377716
Epoch: 24, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.222 Vali Acc: 0.976 Test Loss: 0.222 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0192430
	speed: 0.5928s/iter; left time: 18548.7519s
	iters: 200, epoch: 25 | loss: 0.0000044
	speed: 0.3002s/iter; left time: 9363.9105s
	iters: 300, epoch: 25 | loss: 0.0000185
	speed: 0.2923s/iter; left time: 9086.0698s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.3009s/iter; left time: 9325.6569s
Epoch: 25 cost time: 122.92985820770264
Epoch: 25, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.171 Vali Acc: 0.983 Test Loss: 0.171 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0000003
	speed: 0.5632s/iter; left time: 17388.2945s
	iters: 200, epoch: 26 | loss: 0.1502699
	speed: 0.2825s/iter; left time: 8694.1899s
	iters: 300, epoch: 26 | loss: 0.0000025
	speed: 0.2728s/iter; left time: 8369.5891s
	iters: 400, epoch: 26 | loss: 0.0000069
	speed: 0.2718s/iter; left time: 8309.6887s
Epoch: 26 cost time: 114.85983943939209
Epoch: 26, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.173 Vali Acc: 0.976 Test Loss: 0.173 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0001644
	speed: 0.5431s/iter; left time: 16545.1870s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.2747s/iter; left time: 8341.1015s
	iters: 300, epoch: 27 | loss: 0.0000069
	speed: 0.2796s/iter; left time: 8461.8170s
	iters: 400, epoch: 27 | loss: 0.0000010
	speed: 0.2811s/iter; left time: 8477.3260s
Epoch: 27 cost time: 115.83796501159668
Epoch: 27, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.153 Vali Acc: 0.976 Test Loss: 0.153 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0000147
	speed: 0.5340s/iter; left time: 16046.4412s
	iters: 200, epoch: 28 | loss: 0.0000023
	speed: 0.2714s/iter; left time: 8127.4747s
	iters: 300, epoch: 28 | loss: 0.0000008
	speed: 0.2731s/iter; left time: 8153.4020s
	iters: 400, epoch: 28 | loss: 0.0000002
	speed: 0.2683s/iter; left time: 7981.8208s
Epoch: 28 cost time: 112.39666032791138
Epoch: 28, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.272 Vali Acc: 0.973 Test Loss: 0.272 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0000285
	speed: 0.5469s/iter; left time: 16209.9178s
	iters: 200, epoch: 29 | loss: 0.0000004
	speed: 0.3027s/iter; left time: 8941.5550s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.2982s/iter; left time: 8776.9756s
	iters: 400, epoch: 29 | loss: 0.0015478
	speed: 0.2976s/iter; left time: 8731.2004s
Epoch: 29 cost time: 122.0921573638916
Epoch: 29, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.5574s/iter; left time: 16290.7725s
	iters: 200, epoch: 30 | loss: 0.0000159
	speed: 0.2643s/iter; left time: 7696.2947s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.2672s/iter; left time: 7755.0040s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.2752s/iter; left time: 7960.4979s
Epoch: 30 cost time: 111.71105623245239
Epoch: 30, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.144 Vali Acc: 0.983 Test Loss: 0.144 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9895407003183265
model parameter : 1498378
model size : 10.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0055199
	speed: 0.3089s/iter; left time: 12728.0931s
	iters: 200, epoch: 1 | loss: 0.1768800
	speed: 0.3122s/iter; left time: 12831.9495s
	iters: 300, epoch: 1 | loss: 0.1332472
	speed: 0.3006s/iter; left time: 12324.3478s
	iters: 400, epoch: 1 | loss: 0.0510427
	speed: 0.2976s/iter; left time: 12171.6120s
Epoch: 1 cost time: 125.8659884929657
Epoch: 1, Steps: 413 | Train Loss: 0.594 Vali Loss: 0.105 Vali Acc: 0.969 Test Loss: 0.105 Test Acc: 0.969
Validation loss decreased (inf --> -0.968621).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0300994
	speed: 0.6143s/iter; left time: 25057.1049s
	iters: 200, epoch: 2 | loss: 0.0960988
	speed: 0.3184s/iter; left time: 12955.2324s
	iters: 300, epoch: 2 | loss: 0.0059920
	speed: 0.3078s/iter; left time: 12492.1616s
	iters: 400, epoch: 2 | loss: 0.0151492
	speed: 0.3166s/iter; left time: 12819.7152s
Epoch: 2 cost time: 129.54175686836243
Epoch: 2, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
Validation loss decreased (-0.968621 --> -0.982719).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0092818
	speed: 0.5753s/iter; left time: 23227.2165s
	iters: 200, epoch: 3 | loss: 0.0171746
	speed: 0.2908s/iter; left time: 11710.5884s
	iters: 300, epoch: 3 | loss: 0.0005819
	speed: 0.2673s/iter; left time: 10738.4945s
	iters: 400, epoch: 3 | loss: 0.0015790
	speed: 0.2832s/iter; left time: 11348.5683s
Epoch: 3 cost time: 117.7119574546814
Epoch: 3, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.057 Vali Acc: 0.979 Test Loss: 0.057 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0194600
	speed: 0.5771s/iter; left time: 23062.8387s
	iters: 200, epoch: 4 | loss: 0.0076945
	speed: 0.2839s/iter; left time: 11318.7140s
	iters: 300, epoch: 4 | loss: 0.0090683
	speed: 0.2786s/iter; left time: 11078.0016s
	iters: 400, epoch: 4 | loss: 0.2844578
	speed: 0.2853s/iter; left time: 11314.6487s
Epoch: 4 cost time: 117.98860359191895
Epoch: 4, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.109 Vali Acc: 0.967 Test Loss: 0.109 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0007889
	speed: 0.5574s/iter; left time: 22046.2610s
	iters: 200, epoch: 5 | loss: 0.0333294
	speed: 0.2937s/iter; left time: 11586.9769s
	iters: 300, epoch: 5 | loss: 0.0020979
	speed: 0.2932s/iter; left time: 11538.2218s
	iters: 400, epoch: 5 | loss: 0.0227096
	speed: 0.2972s/iter; left time: 11664.7818s
Epoch: 5 cost time: 120.28688597679138
Epoch: 5, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.088 Vali Acc: 0.975 Test Loss: 0.088 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0018903
	speed: 0.5716s/iter; left time: 22369.1810s
	iters: 200, epoch: 6 | loss: 0.0022362
	speed: 0.2804s/iter; left time: 10944.4690s
	iters: 300, epoch: 6 | loss: 0.2662028
	speed: 0.2762s/iter; left time: 10754.0273s
	iters: 400, epoch: 6 | loss: 0.0928739
	speed: 0.2799s/iter; left time: 10871.8544s
Epoch: 6 cost time: 116.25147318840027
Epoch: 6, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.139 Vali Acc: 0.966 Test Loss: 0.139 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.2937438
	speed: 0.5661s/iter; left time: 21922.6269s
	iters: 200, epoch: 7 | loss: 0.0000957
	speed: 0.2803s/iter; left time: 10825.6144s
	iters: 300, epoch: 7 | loss: 0.5941919
	speed: 0.2756s/iter; left time: 10616.2881s
	iters: 400, epoch: 7 | loss: 0.0001689
	speed: 0.2836s/iter; left time: 10896.8630s
Epoch: 7 cost time: 116.7450339794159
Epoch: 7, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0002808
	speed: 0.5709s/iter; left time: 21869.8921s
	iters: 200, epoch: 8 | loss: 0.0028971
	speed: 0.2907s/iter; left time: 11107.4544s
	iters: 300, epoch: 8 | loss: 0.0004309
	speed: 0.2961s/iter; left time: 11284.1412s
	iters: 400, epoch: 8 | loss: 0.0046461
	speed: 0.2934s/iter; left time: 11153.7773s
Epoch: 8 cost time: 121.07343006134033
Epoch: 8, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.191 Vali Acc: 0.963 Test Loss: 0.191 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0000047
	speed: 0.5751s/iter; left time: 21793.4519s
	iters: 200, epoch: 9 | loss: 0.0000025
	speed: 0.2838s/iter; left time: 10728.3955s
	iters: 300, epoch: 9 | loss: 0.0000056
	speed: 0.2876s/iter; left time: 10841.2284s
	iters: 400, epoch: 9 | loss: 0.3323885
	speed: 0.2718s/iter; left time: 10219.8844s
Epoch: 9 cost time: 116.65440583229065
Epoch: 9, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0000061
	speed: 0.5475s/iter; left time: 20522.3648s
	iters: 200, epoch: 10 | loss: 0.0000044
	speed: 0.2847s/iter; left time: 10643.3037s
	iters: 300, epoch: 10 | loss: 0.0001959
	speed: 0.2863s/iter; left time: 10674.5988s
	iters: 400, epoch: 10 | loss: 0.0000019
	speed: 0.2805s/iter; left time: 10429.3608s
Epoch: 10 cost time: 116.18772339820862
Epoch: 10, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0011819
	speed: 0.5849s/iter; left time: 21684.2218s
	iters: 200, epoch: 11 | loss: 0.0000273
	speed: 0.3202s/iter; left time: 11839.8758s
	iters: 300, epoch: 11 | loss: 0.0000000
	speed: 0.3212s/iter; left time: 11844.4547s
	iters: 400, epoch: 11 | loss: 0.0519883
	speed: 0.3252s/iter; left time: 11956.6590s
Epoch: 11 cost time: 131.36337399482727
Epoch: 11, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.208 Vali Acc: 0.969 Test Loss: 0.208 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0070291
	speed: 0.5876s/iter; left time: 21538.6440s
	iters: 200, epoch: 12 | loss: 0.0094358
	speed: 0.2881s/iter; left time: 10533.5872s
	iters: 300, epoch: 12 | loss: 0.0000058
	speed: 0.2999s/iter; left time: 10934.1288s
	iters: 400, epoch: 12 | loss: 0.0011898
	speed: 0.2856s/iter; left time: 10383.2753s
Epoch: 12 cost time: 120.30915951728821
Epoch: 12, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.081 Vali Acc: 0.984 Test Loss: 0.081 Test Acc: 0.984
Validation loss decreased (-0.982719 --> -0.983628).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000013
	speed: 0.6011s/iter; left time: 21785.6624s
	iters: 200, epoch: 13 | loss: 0.0000001
	speed: 0.3165s/iter; left time: 11439.8707s
	iters: 300, epoch: 13 | loss: 0.0000130
	speed: 0.3086s/iter; left time: 11124.6262s
	iters: 400, epoch: 13 | loss: 0.0000066
	speed: 0.3192s/iter; left time: 11472.2837s
Epoch: 13 cost time: 130.34268069267273
Epoch: 13, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.255 Vali Acc: 0.964 Test Loss: 0.255 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0050001
	speed: 0.6128s/iter; left time: 21958.9346s
	iters: 200, epoch: 14 | loss: 0.0000246
	speed: 0.3016s/iter; left time: 10777.8371s
	iters: 300, epoch: 14 | loss: 0.0003334
	speed: 0.2948s/iter; left time: 10505.2655s
	iters: 400, epoch: 14 | loss: 0.0000850
	speed: 0.3045s/iter; left time: 10818.7449s
Epoch: 14 cost time: 125.22396922111511
Epoch: 14, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.115 Vali Acc: 0.978 Test Loss: 0.115 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000034
	speed: 0.5818s/iter; left time: 20606.7384s
	iters: 200, epoch: 15 | loss: 0.0000004
	speed: 0.3113s/iter; left time: 10995.0611s
	iters: 300, epoch: 15 | loss: 0.0673444
	speed: 0.3078s/iter; left time: 10839.4313s
	iters: 400, epoch: 15 | loss: 0.0000040
	speed: 0.3054s/iter; left time: 10724.8485s
Epoch: 15 cost time: 127.10129141807556
Epoch: 15, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.130 Vali Acc: 0.971 Test Loss: 0.130 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0003180
	speed: 0.6033s/iter; left time: 21120.8493s
	iters: 200, epoch: 16 | loss: 0.0001371
	speed: 0.2909s/iter; left time: 10152.4654s
	iters: 300, epoch: 16 | loss: 0.4590542
	speed: 0.2767s/iter; left time: 9632.4758s
	iters: 400, epoch: 16 | loss: 0.0074330
	speed: 0.2848s/iter; left time: 9884.9314s
Epoch: 16 cost time: 119.84667086601257
Epoch: 16, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.154 Vali Acc: 0.975 Test Loss: 0.154 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0005447
	speed: 0.5658s/iter; left time: 19572.4214s
	iters: 200, epoch: 17 | loss: 0.0000310
	speed: 0.2855s/iter; left time: 9846.1613s
	iters: 300, epoch: 17 | loss: 0.0000001
	speed: 0.2894s/iter; left time: 9955.0142s
	iters: 400, epoch: 17 | loss: 0.0000445
	speed: 0.2829s/iter; left time: 9701.1080s
Epoch: 17 cost time: 118.38218641281128
Epoch: 17, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000226
	speed: 0.5679s/iter; left time: 19412.3621s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.3049s/iter; left time: 10390.8995s
	iters: 300, epoch: 18 | loss: 0.0002945
	speed: 0.3027s/iter; left time: 10286.1639s
	iters: 400, epoch: 18 | loss: 0.0001985
	speed: 0.3057s/iter; left time: 10358.3039s
Epoch: 18 cost time: 125.0204062461853
Epoch: 18, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.327 Vali Acc: 0.960 Test Loss: 0.327 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.5852s/iter; left time: 19761.5199s
	iters: 200, epoch: 19 | loss: 0.0001705
	speed: 0.2763s/iter; left time: 9302.0394s
	iters: 300, epoch: 19 | loss: 0.0000116
	speed: 0.2769s/iter; left time: 9294.4200s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.2766s/iter; left time: 9255.9250s
Epoch: 19 cost time: 115.31808876991272
Epoch: 19, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.122 Vali Acc: 0.984 Test Loss: 0.122 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0228973
	speed: 0.5664s/iter; left time: 18891.5833s
	iters: 200, epoch: 20 | loss: 0.0156015
	speed: 0.2886s/iter; left time: 9597.5415s
	iters: 300, epoch: 20 | loss: 0.1391642
	speed: 0.2963s/iter; left time: 9824.5250s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.3007s/iter; left time: 9938.3373s
Epoch: 20 cost time: 121.43530225753784
Epoch: 20, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.064 Vali Acc: 0.985 Test Loss: 0.064 Test Acc: 0.985
Validation loss decreased (-0.983628 --> -0.984993).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000018
	speed: 0.6065s/iter; left time: 19978.0065s
	iters: 200, epoch: 21 | loss: 0.0001897
	speed: 0.2924s/iter; left time: 9604.1075s
	iters: 300, epoch: 21 | loss: 0.0562781
	speed: 0.2890s/iter; left time: 9461.8032s
	iters: 400, epoch: 21 | loss: 0.0008789
	speed: 0.2959s/iter; left time: 9657.9706s
Epoch: 21 cost time: 122.44769287109375
Epoch: 21, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.206 Vali Acc: 0.973 Test Loss: 0.206 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000002
	speed: 0.5813s/iter; left time: 18910.1527s
	iters: 200, epoch: 22 | loss: 0.1733182
	speed: 0.3006s/iter; left time: 9746.8958s
	iters: 300, epoch: 22 | loss: 0.0000004
	speed: 0.2946s/iter; left time: 9524.2560s
	iters: 400, epoch: 22 | loss: 0.0000048
	speed: 0.3022s/iter; left time: 9738.3601s
Epoch: 22 cost time: 123.92516565322876
Epoch: 22, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.171 Vali Acc: 0.975 Test Loss: 0.171 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0045002
	speed: 0.6433s/iter; left time: 20659.6105s
	iters: 200, epoch: 23 | loss: 0.0000003
	speed: 0.3069s/iter; left time: 9825.5785s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.3163s/iter; left time: 10095.2773s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.2927s/iter; left time: 9310.6767s
Epoch: 23 cost time: 128.64982533454895
Epoch: 23, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.166 Vali Acc: 0.974 Test Loss: 0.166 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0000018
	speed: 0.5910s/iter; left time: 18735.2703s
	iters: 200, epoch: 24 | loss: 0.0000011
	speed: 0.3001s/iter; left time: 9483.3320s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.3012s/iter; left time: 9488.5535s
	iters: 400, epoch: 24 | loss: 0.0000002
	speed: 0.2975s/iter; left time: 9342.8241s
Epoch: 24 cost time: 123.5761170387268
Epoch: 24, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.227 Vali Acc: 0.974 Test Loss: 0.227 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000007
	speed: 0.5877s/iter; left time: 18389.6560s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.3000s/iter; left time: 9357.5261s
	iters: 300, epoch: 25 | loss: 0.0000044
	speed: 0.3100s/iter; left time: 9636.7473s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.3152s/iter; left time: 9768.9087s
Epoch: 25 cost time: 127.14245057106018
Epoch: 25, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.6104s/iter; left time: 18847.4155s
	iters: 200, epoch: 26 | loss: 0.0000039
	speed: 0.3032s/iter; left time: 9330.3192s
	iters: 300, epoch: 26 | loss: 0.0234920
	speed: 0.2994s/iter; left time: 9185.3059s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.2948s/iter; left time: 9013.2691s
Epoch: 26 cost time: 125.42112016677856
Epoch: 26, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.183 Vali Acc: 0.976 Test Loss: 0.183 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0033447
	speed: 0.5923s/iter; left time: 18041.9195s
	iters: 200, epoch: 27 | loss: 0.0000219
	speed: 0.3068s/iter; left time: 9315.4131s
	iters: 300, epoch: 27 | loss: 0.0673241
	speed: 0.3068s/iter; left time: 9286.0610s
	iters: 400, epoch: 27 | loss: 0.0000017
	speed: 0.3166s/iter; left time: 9550.8486s
Epoch: 27 cost time: 126.90784740447998
Epoch: 27, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.211 Vali Acc: 0.976 Test Loss: 0.211 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0006006
	speed: 0.6158s/iter; left time: 18504.3481s
	iters: 200, epoch: 28 | loss: 0.0007353
	speed: 0.3153s/iter; left time: 9442.4825s
	iters: 300, epoch: 28 | loss: 0.0000001
	speed: 0.3130s/iter; left time: 9343.0674s
	iters: 400, epoch: 28 | loss: 0.0000830
	speed: 0.2977s/iter; left time: 8857.0230s
Epoch: 28 cost time: 128.60384702682495
Epoch: 28, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.103 Vali Acc: 0.982 Test Loss: 0.103 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0000010
	speed: 0.5849s/iter; left time: 17334.5808s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.2928s/iter; left time: 8648.6507s
	iters: 300, epoch: 29 | loss: 0.1426186
	speed: 0.3011s/iter; left time: 8864.7832s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.2995s/iter; left time: 8786.4556s
Epoch: 29 cost time: 123.2512035369873
Epoch: 29, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.205 Vali Acc: 0.980 Test Loss: 0.205 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.6438s/iter; left time: 18814.3963s
	iters: 200, epoch: 30 | loss: 0.0000001
	speed: 0.3213s/iter; left time: 9356.8437s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.3033s/iter; left time: 8802.3603s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.3140s/iter; left time: 9082.7159s
Epoch: 30 cost time: 130.8889536857605
Epoch: 30, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.097 Vali Acc: 0.984 Test Loss: 0.097 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.984993178717599
model parameter : 1498378
model size : 10.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.5681453
	speed: 0.2960s/iter; left time: 12195.9479s
	iters: 200, epoch: 1 | loss: 0.2999854
	speed: 0.2836s/iter; left time: 11656.4857s
	iters: 300, epoch: 1 | loss: 0.1946085
	speed: 0.2893s/iter; left time: 11862.9866s
	iters: 400, epoch: 1 | loss: 0.0991393
	speed: 0.2900s/iter; left time: 11862.0073s
Epoch: 1 cost time: 120.18229150772095
Epoch: 1, Steps: 413 | Train Loss: 0.751 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
Validation loss decreased (inf --> -0.968166).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2259856
	speed: 0.5805s/iter; left time: 23676.1979s
	iters: 200, epoch: 2 | loss: 0.1148762
	speed: 0.2974s/iter; left time: 12102.0770s
	iters: 300, epoch: 2 | loss: 0.0106959
	speed: 0.3082s/iter; left time: 12511.2347s
	iters: 400, epoch: 2 | loss: 0.0309484
	speed: 0.2970s/iter; left time: 12026.2246s
Epoch: 2 cost time: 123.32601356506348
Epoch: 2, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0116238
	speed: 0.5942s/iter; left time: 23989.0393s
	iters: 200, epoch: 3 | loss: 0.1096338
	speed: 0.3008s/iter; left time: 12113.9671s
	iters: 300, epoch: 3 | loss: 0.0012262
	speed: 0.2957s/iter; left time: 11879.0694s
	iters: 400, epoch: 3 | loss: 0.0341021
	speed: 0.3050s/iter; left time: 12224.3239s
Epoch: 3 cost time: 124.84080076217651
Epoch: 3, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.109 Vali Acc: 0.967 Test Loss: 0.109 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0364945
	speed: 0.6108s/iter; left time: 24407.7346s
	iters: 200, epoch: 4 | loss: 0.0075800
	speed: 0.3258s/iter; left time: 12985.7351s
	iters: 300, epoch: 4 | loss: 0.0896305
	speed: 0.3144s/iter; left time: 12502.4044s
	iters: 400, epoch: 4 | loss: 0.0031707
	speed: 0.3168s/iter; left time: 12563.2437s
Epoch: 4 cost time: 131.079984664917
Epoch: 4, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.115 Vali Acc: 0.969 Test Loss: 0.115 Test Acc: 0.969
Validation loss decreased (-0.968166 --> -0.969076).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0073451
	speed: 0.6055s/iter; left time: 23948.0818s
	iters: 200, epoch: 5 | loss: 0.1862483
	speed: 0.3014s/iter; left time: 11890.6056s
	iters: 300, epoch: 5 | loss: 0.0001721
	speed: 0.3106s/iter; left time: 12222.1446s
	iters: 400, epoch: 5 | loss: 0.0049035
	speed: 0.2974s/iter; left time: 11673.8991s
Epoch: 5 cost time: 125.56370401382446
Epoch: 5, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.2062083
	speed: 0.5934s/iter; left time: 23224.7132s
	iters: 200, epoch: 6 | loss: 0.0004638
	speed: 0.3146s/iter; left time: 12279.6710s
	iters: 300, epoch: 6 | loss: 0.2011328
	speed: 0.3230s/iter; left time: 12576.3565s
	iters: 400, epoch: 6 | loss: 0.0027534
	speed: 0.3288s/iter; left time: 12768.7831s
Epoch: 6 cost time: 131.78481316566467
Epoch: 6, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.969076 --> -0.976807).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0379656
	speed: 0.6197s/iter; left time: 23997.6569s
	iters: 200, epoch: 7 | loss: 0.0015150
	speed: 0.3014s/iter; left time: 11639.8158s
	iters: 300, epoch: 7 | loss: 0.0000261
	speed: 0.3094s/iter; left time: 11919.2482s
	iters: 400, epoch: 7 | loss: 0.0000799
	speed: 0.2992s/iter; left time: 11497.3599s
Epoch: 7 cost time: 126.09198904037476
Epoch: 7, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.132 Vali Acc: 0.968 Test Loss: 0.132 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0063731
	speed: 0.6021s/iter; left time: 23064.5578s
	iters: 200, epoch: 8 | loss: 0.0021751
	speed: 0.3248s/iter; left time: 12410.5963s
	iters: 300, epoch: 8 | loss: 0.1859058
	speed: 0.3103s/iter; left time: 11826.2532s
	iters: 400, epoch: 8 | loss: 0.4456350
	speed: 0.3221s/iter; left time: 12243.4198s
Epoch: 8 cost time: 130.67051148414612
Epoch: 8, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.137 Vali Acc: 0.971 Test Loss: 0.137 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0001278
	speed: 0.6297s/iter; left time: 23863.2268s
	iters: 200, epoch: 9 | loss: 0.0018195
	speed: 0.3225s/iter; left time: 12188.2813s
	iters: 300, epoch: 9 | loss: 0.0000142
	speed: 0.3074s/iter; left time: 11586.2394s
	iters: 400, epoch: 9 | loss: 0.0005729
	speed: 0.3058s/iter; left time: 11495.3465s
Epoch: 9 cost time: 129.72286367416382
Epoch: 9, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000103
	speed: 0.6011s/iter; left time: 22529.9413s
	iters: 200, epoch: 10 | loss: 0.1915989
	speed: 0.3049s/iter; left time: 11397.6564s
	iters: 300, epoch: 10 | loss: 0.0004862
	speed: 0.3164s/iter; left time: 11795.5921s
	iters: 400, epoch: 10 | loss: 0.0003380
	speed: 0.3216s/iter; left time: 11959.7889s
Epoch: 10 cost time: 129.5600712299347
Epoch: 10, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.119 Vali Acc: 0.981 Test Loss: 0.119 Test Acc: 0.981
Validation loss decreased (-0.976807 --> -0.980899).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0001367
	speed: 0.6127s/iter; left time: 22713.4695s
	iters: 200, epoch: 11 | loss: 0.0000062
	speed: 0.3182s/iter; left time: 11765.2501s
	iters: 300, epoch: 11 | loss: 0.0000024
	speed: 0.3015s/iter; left time: 11116.8519s
	iters: 400, epoch: 11 | loss: 0.0093664
	speed: 0.2921s/iter; left time: 10742.4528s
Epoch: 11 cost time: 127.17037796974182
Epoch: 11, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.142 Vali Acc: 0.972 Test Loss: 0.142 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0033594
	speed: 0.5935s/iter; left time: 21755.0109s
	iters: 200, epoch: 12 | loss: 0.0487549
	speed: 0.2892s/iter; left time: 10571.9619s
	iters: 300, epoch: 12 | loss: 0.0004640
	speed: 0.2857s/iter; left time: 10416.4648s
	iters: 400, epoch: 12 | loss: 0.0001241
	speed: 0.2876s/iter; left time: 10456.2369s
Epoch: 12 cost time: 119.59916520118713
Epoch: 12, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0009186
	speed: 0.5823s/iter; left time: 21104.1343s
	iters: 200, epoch: 13 | loss: 0.0000655
	speed: 0.2854s/iter; left time: 10315.2533s
	iters: 300, epoch: 13 | loss: 0.0006311
	speed: 0.2890s/iter; left time: 10418.2551s
	iters: 400, epoch: 13 | loss: 0.0000218
	speed: 0.2967s/iter; left time: 10663.6495s
Epoch: 13 cost time: 120.78691101074219
Epoch: 13, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.103 Vali Acc: 0.979 Test Loss: 0.103 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0007408
	speed: 0.6121s/iter; left time: 21934.1009s
	iters: 200, epoch: 14 | loss: 0.0000063
	speed: 0.3042s/iter; left time: 10871.2839s
	iters: 300, epoch: 14 | loss: 0.0000072
	speed: 0.2969s/iter; left time: 10578.0037s
	iters: 400, epoch: 14 | loss: 0.0865356
	speed: 0.2862s/iter; left time: 10170.7768s
Epoch: 14 cost time: 123.61707901954651
Epoch: 14, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.148 Vali Acc: 0.976 Test Loss: 0.148 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000008
	speed: 0.6058s/iter; left time: 21455.8514s
	iters: 200, epoch: 15 | loss: 0.0000000
	speed: 0.3019s/iter; left time: 10661.9018s
	iters: 300, epoch: 15 | loss: 0.0888864
	speed: 0.2897s/iter; left time: 10201.4613s
	iters: 400, epoch: 15 | loss: 0.0000000
	speed: 0.2971s/iter; left time: 10433.8272s
Epoch: 15 cost time: 124.97687435150146
Epoch: 15, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.156 Vali Acc: 0.974 Test Loss: 0.156 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0015509
	speed: 0.5985s/iter; left time: 20950.3548s
	iters: 200, epoch: 16 | loss: 0.0001449
	speed: 0.3036s/iter; left time: 10599.1154s
	iters: 300, epoch: 16 | loss: 0.0001636
	speed: 0.3023s/iter; left time: 10521.2189s
	iters: 400, epoch: 16 | loss: 0.0000004
	speed: 0.2919s/iter; left time: 10131.3004s
Epoch: 16 cost time: 123.16141200065613
Epoch: 16, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.149 Vali Acc: 0.972 Test Loss: 0.149 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000756
	speed: 0.5693s/iter; left time: 19695.2786s
	iters: 200, epoch: 17 | loss: 0.0000012
	speed: 0.2823s/iter; left time: 9738.7793s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.2795s/iter; left time: 9612.5654s
	iters: 400, epoch: 17 | loss: 0.0013248
	speed: 0.2949s/iter; left time: 10111.7269s
Epoch: 17 cost time: 118.23449873924255
Epoch: 17, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0019388
	speed: 0.6156s/iter; left time: 21041.6167s
	iters: 200, epoch: 18 | loss: 0.0000003
	speed: 0.3153s/iter; left time: 10746.4978s
	iters: 300, epoch: 18 | loss: 0.0000036
	speed: 0.2908s/iter; left time: 9881.8486s
	iters: 400, epoch: 18 | loss: 0.0000741
	speed: 0.2798s/iter; left time: 9478.6103s
Epoch: 18 cost time: 124.26883959770203
Epoch: 18, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.145 Vali Acc: 0.974 Test Loss: 0.145 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0002275
	speed: 0.5927s/iter; left time: 20013.7552s
	iters: 200, epoch: 19 | loss: 0.0195806
	speed: 0.2885s/iter; left time: 9712.7632s
	iters: 300, epoch: 19 | loss: 0.0132569
	speed: 0.2786s/iter; left time: 9352.3657s
	iters: 400, epoch: 19 | loss: 0.0000127
	speed: 0.2824s/iter; left time: 9450.5751s
Epoch: 19 cost time: 119.68661499023438
Epoch: 19, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.980899 --> -0.983173).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000951
	speed: 0.5712s/iter; left time: 19051.2398s
	iters: 200, epoch: 20 | loss: 0.0000003
	speed: 0.2956s/iter; left time: 9829.9152s
	iters: 300, epoch: 20 | loss: 0.3419185
	speed: 0.2872s/iter; left time: 9523.0890s
	iters: 400, epoch: 20 | loss: 0.0000137
	speed: 0.2879s/iter; left time: 9516.5238s
Epoch: 20 cost time: 121.18552541732788
Epoch: 20, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.160 Vali Acc: 0.977 Test Loss: 0.160 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000015
	speed: 0.5615s/iter; left time: 18497.4727s
	iters: 200, epoch: 21 | loss: 0.0024786
	speed: 0.2988s/iter; left time: 9813.2543s
	iters: 300, epoch: 21 | loss: 0.0001141
	speed: 0.2740s/iter; left time: 8971.0572s
	iters: 400, epoch: 21 | loss: 0.0001634
	speed: 0.2752s/iter; left time: 8982.6409s
Epoch: 21 cost time: 116.89410400390625
Epoch: 21, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.185 Vali Acc: 0.975 Test Loss: 0.185 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0003012
	speed: 0.5477s/iter; left time: 17815.9210s
	iters: 200, epoch: 22 | loss: 0.0001223
	speed: 0.2832s/iter; left time: 9183.0761s
	iters: 300, epoch: 22 | loss: 0.0000129
	speed: 0.2831s/iter; left time: 9150.6962s
	iters: 400, epoch: 22 | loss: 0.0009652
	speed: 0.3031s/iter; left time: 9769.3741s
Epoch: 22 cost time: 118.83892607688904
Epoch: 22, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.146 Vali Acc: 0.980 Test Loss: 0.146 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0746664
	speed: 0.5779s/iter; left time: 18558.2185s
	iters: 200, epoch: 23 | loss: 0.0000001
	speed: 0.2760s/iter; left time: 8837.6043s
	iters: 300, epoch: 23 | loss: 0.0000005
	speed: 0.2746s/iter; left time: 8763.6155s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.2726s/iter; left time: 8673.5503s
Epoch: 23 cost time: 115.3411602973938
Epoch: 23, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.122 Vali Acc: 0.974 Test Loss: 0.122 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.3988498
	speed: 0.5517s/iter; left time: 17489.9054s
	iters: 200, epoch: 24 | loss: 0.2496836
	speed: 0.2750s/iter; left time: 8691.3050s
	iters: 300, epoch: 24 | loss: 0.0000069
	speed: 0.2871s/iter; left time: 9043.5580s
	iters: 400, epoch: 24 | loss: 0.0000002
	speed: 0.3034s/iter; left time: 9525.9893s
Epoch: 24 cost time: 117.83448672294617
Epoch: 24, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.280 Vali Acc: 0.959 Test Loss: 0.280 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.1007639
	speed: 0.5787s/iter; left time: 18108.4657s
	iters: 200, epoch: 25 | loss: 0.0000017
	speed: 0.2824s/iter; left time: 8808.0820s
	iters: 300, epoch: 25 | loss: 0.0004095
	speed: 0.2691s/iter; left time: 8365.7289s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.2666s/iter; left time: 8260.5438s
Epoch: 25 cost time: 114.30225133895874
Epoch: 25, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.260 Vali Acc: 0.967 Test Loss: 0.260 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0000018
	speed: 0.5219s/iter; left time: 16114.9309s
	iters: 200, epoch: 26 | loss: 0.0000455
	speed: 0.2746s/iter; left time: 8451.6419s
	iters: 300, epoch: 26 | loss: 0.0425342
	speed: 0.2816s/iter; left time: 8638.3590s
	iters: 400, epoch: 26 | loss: 0.0000279
	speed: 0.2972s/iter; left time: 9088.2742s
Epoch: 26 cost time: 116.50708985328674
Epoch: 26, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.077 Vali Acc: 0.986 Test Loss: 0.077 Test Acc: 0.986
Validation loss decreased (-0.983173 --> -0.985902).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0000016
	speed: 0.5986s/iter; left time: 18235.7893s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.2753s/iter; left time: 8360.2429s
	iters: 300, epoch: 27 | loss: 0.0153173
	speed: 0.2718s/iter; left time: 8226.8742s
	iters: 400, epoch: 27 | loss: 0.0004140
	speed: 0.2720s/iter; left time: 8204.8529s
Epoch: 27 cost time: 115.06943678855896
Epoch: 27, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.205 Vali Acc: 0.973 Test Loss: 0.205 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0000001
	speed: 0.5485s/iter; left time: 16483.3867s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.2768s/iter; left time: 8291.4470s
	iters: 300, epoch: 28 | loss: 0.0000001
	speed: 0.2868s/iter; left time: 8561.2675s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.2855s/iter; left time: 8492.6120s
Epoch: 28 cost time: 117.07567071914673
Epoch: 28, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.167 Vali Acc: 0.977 Test Loss: 0.167 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0000012
	speed: 0.5807s/iter; left time: 17210.2195s
	iters: 200, epoch: 29 | loss: 0.0000001
	speed: 0.2850s/iter; left time: 8418.1676s
	iters: 300, epoch: 29 | loss: 0.1900253
	speed: 0.2837s/iter; left time: 8351.8461s
	iters: 400, epoch: 29 | loss: 0.0253281
	speed: 0.2878s/iter; left time: 8443.1892s
Epoch: 29 cost time: 119.10573363304138
Epoch: 29, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.137 Vali Acc: 0.978 Test Loss: 0.137 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0000007
	speed: 0.5439s/iter; left time: 15894.0512s
	iters: 200, epoch: 30 | loss: 0.0024364
	speed: 0.2846s/iter; left time: 8289.2013s
	iters: 300, epoch: 30 | loss: 0.1091660
	speed: 0.3040s/iter; left time: 8824.4371s
	iters: 400, epoch: 30 | loss: 0.0001885
	speed: 0.3019s/iter; left time: 8731.0187s
Epoch: 30 cost time: 120.0747320652008
Epoch: 30, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.5475s/iter; left time: 15775.2773s
	iters: 200, epoch: 31 | loss: 0.0003049
	speed: 0.2749s/iter; left time: 7893.6766s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.2685s/iter; left time: 7681.8729s
	iters: 400, epoch: 31 | loss: 0.0000093
	speed: 0.2674s/iter; left time: 7622.8341s
Epoch: 31 cost time: 113.06099486351013
Epoch: 31, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.113 Vali Acc: 0.981 Test Loss: 0.113 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0000016
	speed: 0.5827s/iter; left time: 16547.2001s
	iters: 200, epoch: 32 | loss: 0.0037082
	speed: 0.3032s/iter; left time: 8580.6409s
	iters: 300, epoch: 32 | loss: 0.0003511
	speed: 0.2924s/iter; left time: 8243.6870s
	iters: 400, epoch: 32 | loss: 0.0000004
	speed: 0.2715s/iter; left time: 7627.6487s
Epoch: 32 cost time: 120.87385654449463
Epoch: 32, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.139 Vali Acc: 0.974 Test Loss: 0.139 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0000145
	speed: 0.5763s/iter; left time: 16128.2587s
	iters: 200, epoch: 33 | loss: 0.0906870
	speed: 0.2771s/iter; left time: 7726.1042s
	iters: 300, epoch: 33 | loss: 0.0000007
	speed: 0.2744s/iter; left time: 7623.4121s
	iters: 400, epoch: 33 | loss: 0.0000002
	speed: 0.2734s/iter; left time: 7569.5287s
Epoch: 33 cost time: 115.14994430541992
Epoch: 33, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.086 Vali Acc: 0.985 Test Loss: 0.086 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.5560s/iter; left time: 15329.1781s
	iters: 200, epoch: 34 | loss: 0.0000001
	speed: 0.2902s/iter; left time: 7972.2809s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.2975s/iter; left time: 8142.2098s
	iters: 400, epoch: 34 | loss: 0.0000002
	speed: 0.2829s/iter; left time: 7716.2449s
Epoch: 34 cost time: 119.6743803024292
Epoch: 34, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.084 Vali Acc: 0.985 Test Loss: 0.084 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.0406885
	speed: 0.5498s/iter; left time: 14932.3837s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.2721s/iter; left time: 7362.7460s
	iters: 300, epoch: 35 | loss: 0.0000001
	speed: 0.2682s/iter; left time: 7231.5321s
	iters: 400, epoch: 35 | loss: 0.5287682
	speed: 0.2642s/iter; left time: 7097.1419s
Epoch: 35 cost time: 111.40051126480103
Epoch: 35, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.246 Vali Acc: 0.970 Test Loss: 0.246 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.0000004
	speed: 0.5358s/iter; left time: 14330.4669s
	iters: 200, epoch: 36 | loss: 0.0005209
	speed: 0.2941s/iter; left time: 7837.5542s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.2960s/iter; left time: 7857.8542s
	iters: 400, epoch: 36 | loss: 0.0000058
	speed: 0.3031s/iter; left time: 8014.5289s
Epoch: 36 cost time: 120.92573738098145
Epoch: 36, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.112 Vali Acc: 0.979 Test Loss: 0.112 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9859026830377444
model parameter : 1498378
model size : 10.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.6714144
	speed: 0.3126s/iter; left time: 12878.4963s
	iters: 200, epoch: 1 | loss: 0.2806790
	speed: 0.2938s/iter; left time: 12074.7405s
	iters: 300, epoch: 1 | loss: 0.1600592
	speed: 0.2986s/iter; left time: 12241.8189s
	iters: 400, epoch: 1 | loss: 0.1826307
	speed: 0.2909s/iter; left time: 11899.0459s
Epoch: 1 cost time: 123.98611664772034
Epoch: 1, Steps: 413 | Train Loss: 0.775 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
Validation loss decreased (inf --> -0.971350).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0858821
	speed: 0.5921s/iter; left time: 24151.4285s
	iters: 200, epoch: 2 | loss: 0.0758481
	speed: 0.3128s/iter; left time: 12728.6420s
	iters: 300, epoch: 2 | loss: 0.0040192
	speed: 0.2989s/iter; left time: 12133.7349s
	iters: 400, epoch: 2 | loss: 0.1057971
	speed: 0.3017s/iter; left time: 12216.4857s
Epoch: 2 cost time: 126.99429821968079
Epoch: 2, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1295751
	speed: 0.5868s/iter; left time: 23690.0359s
	iters: 200, epoch: 3 | loss: 0.1433518
	speed: 0.3049s/iter; left time: 12279.6300s
	iters: 300, epoch: 3 | loss: 0.0035902
	speed: 0.2939s/iter; left time: 11808.0186s
	iters: 400, epoch: 3 | loss: 0.0402019
	speed: 0.2968s/iter; left time: 11893.1832s
Epoch: 3 cost time: 123.32946634292603
Epoch: 3, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.108 Vali Acc: 0.966 Test Loss: 0.108 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0043307
	speed: 0.6175s/iter; left time: 24674.6039s
	iters: 200, epoch: 4 | loss: 0.5338194
	speed: 0.3121s/iter; left time: 12441.8740s
	iters: 300, epoch: 4 | loss: 0.0025780
	speed: 0.2978s/iter; left time: 11840.5433s
	iters: 400, epoch: 4 | loss: 0.1028972
	speed: 0.2962s/iter; left time: 11747.3481s
Epoch: 4 cost time: 126.86320114135742
Epoch: 4, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.144 Vali Acc: 0.961 Test Loss: 0.144 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0241206
	speed: 0.5774s/iter; left time: 22836.9100s
	iters: 200, epoch: 5 | loss: 0.1139684
	speed: 0.3130s/iter; left time: 12348.2907s
	iters: 300, epoch: 5 | loss: 0.0019769
	speed: 0.3156s/iter; left time: 12418.5600s
	iters: 400, epoch: 5 | loss: 0.0115009
	speed: 0.3223s/iter; left time: 12650.2554s
Epoch: 5 cost time: 128.62783122062683
Epoch: 5, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.091 Vali Acc: 0.972 Test Loss: 0.091 Test Acc: 0.972
Validation loss decreased (-0.971350 --> -0.972259).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0188413
	speed: 0.5948s/iter; left time: 23276.7596s
	iters: 200, epoch: 6 | loss: 0.0057090
	speed: 0.2852s/iter; left time: 11132.0845s
	iters: 300, epoch: 6 | loss: 0.0936874
	speed: 0.2872s/iter; left time: 11182.9159s
	iters: 400, epoch: 6 | loss: 0.0010045
	speed: 0.2998s/iter; left time: 11642.6676s
Epoch: 6 cost time: 120.87878918647766
Epoch: 6, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.3283347
	speed: 0.5789s/iter; left time: 22418.6171s
	iters: 200, epoch: 7 | loss: 0.0000231
	speed: 0.3108s/iter; left time: 12005.4901s
	iters: 300, epoch: 7 | loss: 0.0018133
	speed: 0.3061s/iter; left time: 11791.9715s
	iters: 400, epoch: 7 | loss: 0.0010295
	speed: 0.3030s/iter; left time: 11643.4478s
Epoch: 7 cost time: 125.59586524963379
Epoch: 7, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.141 Vali Acc: 0.961 Test Loss: 0.141 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0001021
	speed: 0.5781s/iter; left time: 22147.4684s
	iters: 200, epoch: 8 | loss: 0.0014477
	speed: 0.2897s/iter; left time: 11070.3118s
	iters: 300, epoch: 8 | loss: 0.0003824
	speed: 0.2904s/iter; left time: 11069.0137s
	iters: 400, epoch: 8 | loss: 0.0011667
	speed: 0.2875s/iter; left time: 10928.1092s
Epoch: 8 cost time: 121.84110903739929
Epoch: 8, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.229 Vali Acc: 0.961 Test Loss: 0.229 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000107
	speed: 0.5855s/iter; left time: 22189.2557s
	iters: 200, epoch: 9 | loss: 0.0006410
	speed: 0.3299s/iter; left time: 12467.6235s
	iters: 300, epoch: 9 | loss: 0.0008224
	speed: 0.3120s/iter; left time: 11762.4963s
	iters: 400, epoch: 9 | loss: 0.0008656
	speed: 0.3024s/iter; left time: 11367.7816s
Epoch: 9 cost time: 129.54149413108826
Epoch: 9, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.153 Vali Acc: 0.973 Test Loss: 0.153 Test Acc: 0.973
Validation loss decreased (-0.972259 --> -0.972713).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000020
	speed: 0.5513s/iter; left time: 20665.8088s
	iters: 200, epoch: 10 | loss: 0.0004449
	speed: 0.2831s/iter; left time: 10584.6928s
	iters: 300, epoch: 10 | loss: 0.0019628
	speed: 0.3088s/iter; left time: 11514.2306s
	iters: 400, epoch: 10 | loss: 0.0024098
	speed: 0.2970s/iter; left time: 11045.4649s
Epoch: 10 cost time: 121.19923615455627
Epoch: 10, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.127 Vali Acc: 0.971 Test Loss: 0.127 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000109
	speed: 0.5862s/iter; left time: 21731.9493s
	iters: 200, epoch: 11 | loss: 0.0003535
	speed: 0.3163s/iter; left time: 11694.2404s
	iters: 300, epoch: 11 | loss: 0.0000261
	speed: 0.3034s/iter; left time: 11186.9440s
	iters: 400, epoch: 11 | loss: 0.0002743
	speed: 0.3079s/iter; left time: 11320.8898s
Epoch: 11 cost time: 127.45480561256409
Epoch: 11, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.149 Vali Acc: 0.971 Test Loss: 0.149 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000126
	speed: 0.5690s/iter; left time: 20857.5625s
	iters: 200, epoch: 12 | loss: 0.0841044
	speed: 0.2916s/iter; left time: 10659.4275s
	iters: 300, epoch: 12 | loss: 0.0002411
	speed: 0.2991s/iter; left time: 10903.8751s
	iters: 400, epoch: 12 | loss: 0.0077821
	speed: 0.3057s/iter; left time: 11114.1198s
Epoch: 12 cost time: 123.06867694854736
Epoch: 12, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.972713 --> -0.979535).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0037079
	speed: 0.5938s/iter; left time: 21522.5994s
	iters: 200, epoch: 13 | loss: 0.0000034
	speed: 0.3111s/iter; left time: 11245.4019s
	iters: 300, epoch: 13 | loss: 0.0002508
	speed: 0.2916s/iter; left time: 10512.2180s
	iters: 400, epoch: 13 | loss: 0.0062160
	speed: 0.2840s/iter; left time: 10209.9381s
Epoch: 13 cost time: 123.11764597892761
Epoch: 13, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.183 Vali Acc: 0.966 Test Loss: 0.183 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000015
	speed: 0.5757s/iter; left time: 20626.7622s
	iters: 200, epoch: 14 | loss: 0.0000001
	speed: 0.2993s/iter; left time: 10696.0527s
	iters: 300, epoch: 14 | loss: 0.0000001
	speed: 0.3115s/iter; left time: 11099.0676s
	iters: 400, epoch: 14 | loss: 0.0000001
	speed: 0.3001s/iter; left time: 10662.0647s
Epoch: 14 cost time: 124.65507531166077
Epoch: 14, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.979535 --> -0.979990).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000026
	speed: 0.5495s/iter; left time: 19462.4492s
	iters: 200, epoch: 15 | loss: 0.0033248
	speed: 0.2773s/iter; left time: 9792.5674s
	iters: 300, epoch: 15 | loss: 0.0003138
	speed: 0.3020s/iter; left time: 10636.6860s
	iters: 400, epoch: 15 | loss: 0.0001333
	speed: 0.2997s/iter; left time: 10526.8475s
Epoch: 15 cost time: 120.77727007865906
Epoch: 15, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.121 Vali Acc: 0.972 Test Loss: 0.121 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0002092
	speed: 0.6170s/iter; left time: 21599.7503s
	iters: 200, epoch: 16 | loss: 0.0000051
	speed: 0.3073s/iter; left time: 10727.3318s
	iters: 300, epoch: 16 | loss: 0.1034687
	speed: 0.3026s/iter; left time: 10533.1131s
	iters: 400, epoch: 16 | loss: 0.0000007
	speed: 0.2865s/iter; left time: 9943.1156s
Epoch: 16 cost time: 126.17741584777832
Epoch: 16, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0130151
	speed: 0.5801s/iter; left time: 20066.6275s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.2888s/iter; left time: 9961.1273s
	iters: 300, epoch: 17 | loss: 0.0000032
	speed: 0.2813s/iter; left time: 9676.3159s
	iters: 400, epoch: 17 | loss: 0.0000025
	speed: 0.2966s/iter; left time: 10169.8868s
Epoch: 17 cost time: 120.70355415344238
Epoch: 17, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.125 Vali Acc: 0.979 Test Loss: 0.125 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0638157
	speed: 0.6003s/iter; left time: 20517.1130s
	iters: 200, epoch: 18 | loss: 0.4779778
	speed: 0.2846s/iter; left time: 9700.3956s
	iters: 300, epoch: 18 | loss: 0.0337781
	speed: 0.2751s/iter; left time: 9346.7691s
	iters: 400, epoch: 18 | loss: 0.0000031
	speed: 0.2687s/iter; left time: 9104.1060s
Epoch: 18 cost time: 116.58815097808838
Epoch: 18, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.157 Vali Acc: 0.974 Test Loss: 0.157 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.5114256
	speed: 0.5400s/iter; left time: 18234.0547s
	iters: 200, epoch: 19 | loss: 0.0000528
	speed: 0.2734s/iter; left time: 9204.2881s
	iters: 300, epoch: 19 | loss: 0.0070864
	speed: 0.2851s/iter; left time: 9570.8804s
	iters: 400, epoch: 19 | loss: 0.0000003
	speed: 0.2976s/iter; left time: 9959.9921s
Epoch: 19 cost time: 117.02161169052124
Epoch: 19, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.235 Vali Acc: 0.961 Test Loss: 0.235 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000001
	speed: 0.5809s/iter; left time: 19375.5695s
	iters: 200, epoch: 20 | loss: 0.0000033
	speed: 0.2849s/iter; left time: 9472.9021s
	iters: 300, epoch: 20 | loss: 0.0005224
	speed: 0.2771s/iter; left time: 9186.7984s
	iters: 400, epoch: 20 | loss: 0.0000001
	speed: 0.2763s/iter; left time: 9131.6746s
Epoch: 20 cost time: 117.02375674247742
Epoch: 20, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.115 Vali Acc: 0.978 Test Loss: 0.115 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0003993
	speed: 0.5420s/iter; left time: 17855.4767s
	iters: 200, epoch: 21 | loss: 0.0000024
	speed: 0.2770s/iter; left time: 9096.0889s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.2775s/iter; left time: 9085.0648s
	iters: 400, epoch: 21 | loss: 0.0423135
	speed: 0.2721s/iter; left time: 8882.4048s
Epoch: 21 cost time: 113.83978080749512
Epoch: 21, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.141 Vali Acc: 0.980 Test Loss: 0.141 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0000006
	speed: 0.5507s/iter; left time: 17913.7336s
	iters: 200, epoch: 22 | loss: 0.0537038
	speed: 0.3014s/iter; left time: 9775.1897s
	iters: 300, epoch: 22 | loss: 0.0000007
	speed: 0.3041s/iter; left time: 9830.9564s
	iters: 400, epoch: 22 | loss: 0.0000001
	speed: 0.2917s/iter; left time: 9401.1082s
Epoch: 22 cost time: 123.21416091918945
Epoch: 22, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.141 Vali Acc: 0.974 Test Loss: 0.141 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0000016
	speed: 0.5819s/iter; left time: 18689.0810s
	iters: 200, epoch: 23 | loss: 0.0000319
	speed: 0.2927s/iter; left time: 9372.3044s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.2902s/iter; left time: 9262.4811s
	iters: 400, epoch: 23 | loss: 0.0000003
	speed: 0.2864s/iter; left time: 9110.4285s
Epoch: 23 cost time: 120.66162633895874
Epoch: 23, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.185 Vali Acc: 0.970 Test Loss: 0.185 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0000013
	speed: 0.5637s/iter; left time: 17870.8290s
	iters: 200, epoch: 24 | loss: 0.0003960
	speed: 0.2899s/iter; left time: 9160.7151s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.2889s/iter; left time: 9100.0821s
	iters: 400, epoch: 24 | loss: 0.0000013
	speed: 0.2807s/iter; left time: 8815.1404s
Epoch: 24 cost time: 118.9623510837555
Epoch: 24, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9799909049567985
model parameter : 1498378
model size : 10.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.5815969
	speed: 0.3007s/iter; left time: 12390.5549s
	iters: 200, epoch: 1 | loss: 0.3830382
	speed: 0.2906s/iter; left time: 11944.2066s
	iters: 300, epoch: 1 | loss: 0.1299167
	speed: 0.2767s/iter; left time: 11344.9037s
	iters: 400, epoch: 1 | loss: 0.0943666
	speed: 0.2780s/iter; left time: 11369.1767s
Epoch: 1 cost time: 118.31277418136597
Epoch: 1, Steps: 413 | Train Loss: 0.773 Vali Loss: 0.111 Vali Acc: 0.963 Test Loss: 0.111 Test Acc: 0.963
Validation loss decreased (inf --> -0.962709).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0640752
	speed: 0.5786s/iter; left time: 23600.1445s
	iters: 200, epoch: 2 | loss: 0.2271253
	speed: 0.2991s/iter; left time: 12171.3880s
	iters: 300, epoch: 2 | loss: 0.0074275
	speed: 0.2974s/iter; left time: 12069.5114s
	iters: 400, epoch: 2 | loss: 0.0755920
	speed: 0.2810s/iter; left time: 11378.4334s
Epoch: 2 cost time: 121.04414439201355
Epoch: 2, Steps: 413 | Train Loss: 0.107 Vali Loss: 0.074 Vali Acc: 0.974 Test Loss: 0.074 Test Acc: 0.974
Validation loss decreased (-0.962709 --> -0.974078).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0051883
	speed: 0.5505s/iter; left time: 22225.0019s
	iters: 200, epoch: 3 | loss: 0.1666260
	speed: 0.2717s/iter; left time: 10944.6378s
	iters: 300, epoch: 3 | loss: 0.0128590
	speed: 0.2756s/iter; left time: 11071.3573s
	iters: 400, epoch: 3 | loss: 0.0120487
	speed: 0.2861s/iter; left time: 11463.7404s
Epoch: 3 cost time: 115.50726771354675
Epoch: 3, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.087 Vali Acc: 0.975 Test Loss: 0.087 Test Acc: 0.975
Validation loss decreased (-0.974078 --> -0.974988).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0014166
	speed: 0.5724s/iter; left time: 22875.7355s
	iters: 200, epoch: 4 | loss: 0.3523221
	speed: 0.2789s/iter; left time: 11117.5081s
	iters: 300, epoch: 4 | loss: 0.0100357
	speed: 0.2797s/iter; left time: 11121.0976s
	iters: 400, epoch: 4 | loss: 0.0020844
	speed: 0.2772s/iter; left time: 10994.0351s
Epoch: 4 cost time: 116.08561635017395
Epoch: 4, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.146 Vali Acc: 0.960 Test Loss: 0.146 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0019119
	speed: 0.5596s/iter; left time: 22132.5159s
	iters: 200, epoch: 5 | loss: 0.1595733
	speed: 0.2793s/iter; left time: 11016.2737s
	iters: 300, epoch: 5 | loss: 0.0096850
	speed: 0.2800s/iter; left time: 11019.6600s
	iters: 400, epoch: 5 | loss: 0.0011011
	speed: 0.2840s/iter; left time: 11147.2109s
Epoch: 5 cost time: 116.88335347175598
Epoch: 5, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.171 Vali Acc: 0.952 Test Loss: 0.171 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0007873
	speed: 0.5815s/iter; left time: 22759.2550s
	iters: 200, epoch: 6 | loss: 0.0000870
	speed: 0.2894s/iter; left time: 11298.2460s
	iters: 300, epoch: 6 | loss: 0.0015002
	speed: 0.2831s/iter; left time: 11023.6747s
	iters: 400, epoch: 6 | loss: 0.1015799
	speed: 0.2726s/iter; left time: 10587.8433s
Epoch: 6 cost time: 117.85281944274902
Epoch: 6, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0004775
	speed: 0.5370s/iter; left time: 20796.0651s
	iters: 200, epoch: 7 | loss: 0.0014311
	speed: 0.2883s/iter; left time: 11136.2548s
	iters: 300, epoch: 7 | loss: 0.0000254
	speed: 0.2958s/iter; left time: 11396.9928s
	iters: 400, epoch: 7 | loss: 0.0069951
	speed: 0.2895s/iter; left time: 11125.2028s
Epoch: 7 cost time: 118.56346821784973
Epoch: 7, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.210 Vali Acc: 0.947 Test Loss: 0.210 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0001297
	speed: 0.5427s/iter; left time: 20791.8373s
	iters: 200, epoch: 8 | loss: 0.0298442
	speed: 0.2665s/iter; left time: 10183.0829s
	iters: 300, epoch: 8 | loss: 0.1561706
	speed: 0.2700s/iter; left time: 10291.2344s
	iters: 400, epoch: 8 | loss: 0.0102104
	speed: 0.2744s/iter; left time: 10431.1782s
Epoch: 8 cost time: 111.84812641143799
Epoch: 8, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.199 Vali Acc: 0.965 Test Loss: 0.199 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0012732
	speed: 0.5683s/iter; left time: 21535.0393s
	iters: 200, epoch: 9 | loss: 0.2060001
	speed: 0.2868s/iter; left time: 10840.2657s
	iters: 300, epoch: 9 | loss: 0.0201706
	speed: 0.2741s/iter; left time: 10331.0829s
	iters: 400, epoch: 9 | loss: 0.0001691
	speed: 0.2726s/iter; left time: 10250.8017s
Epoch: 9 cost time: 116.64743566513062
Epoch: 9, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0000166
	speed: 0.5303s/iter; left time: 19878.3598s
	iters: 200, epoch: 10 | loss: 0.0350176
	speed: 0.2756s/iter; left time: 10302.5753s
	iters: 300, epoch: 10 | loss: 0.0923989
	speed: 0.2855s/iter; left time: 10644.6803s
	iters: 400, epoch: 10 | loss: 0.0000465
	speed: 0.2944s/iter; left time: 10948.6032s
Epoch: 10 cost time: 116.29045844078064
Epoch: 10, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.157 Vali Acc: 0.965 Test Loss: 0.157 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0003396
	speed: 0.5464s/iter; left time: 20254.8760s
	iters: 200, epoch: 11 | loss: 0.0000299
	speed: 0.2767s/iter; left time: 10231.5414s
	iters: 300, epoch: 11 | loss: 0.0057649
	speed: 0.2761s/iter; left time: 10181.0655s
	iters: 400, epoch: 11 | loss: 0.0053738
	speed: 0.2832s/iter; left time: 10411.9733s
Epoch: 11 cost time: 114.1125259399414
Epoch: 11, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.186 Vali Acc: 0.966 Test Loss: 0.186 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000002
	speed: 0.5593s/iter; left time: 20501.8854s
	iters: 200, epoch: 12 | loss: 0.0489838
	speed: 0.2847s/iter; left time: 10409.1689s
	iters: 300, epoch: 12 | loss: 0.0013089
	speed: 0.2857s/iter; left time: 10415.7029s
	iters: 400, epoch: 12 | loss: 0.0000012
	speed: 0.2723s/iter; left time: 9898.7571s
Epoch: 12 cost time: 117.39593291282654
Epoch: 12, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.974988 --> -0.979990).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0127362
	speed: 0.5415s/iter; left time: 19624.9482s
	iters: 200, epoch: 13 | loss: 0.0000196
	speed: 0.2680s/iter; left time: 9686.6176s
	iters: 300, epoch: 13 | loss: 0.0001197
	speed: 0.2700s/iter; left time: 9730.6619s
	iters: 400, epoch: 13 | loss: 0.9835740
	speed: 0.2899s/iter; left time: 10419.7013s
Epoch: 13 cost time: 114.4728455543518
Epoch: 13, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.133 Vali Acc: 0.974 Test Loss: 0.133 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0013957
	speed: 0.5857s/iter; left time: 20986.9280s
	iters: 200, epoch: 14 | loss: 0.0000086
	speed: 0.2837s/iter; left time: 10138.3331s
	iters: 300, epoch: 14 | loss: 0.0000127
	speed: 0.2724s/iter; left time: 9706.7267s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.2693s/iter; left time: 9568.3323s
Epoch: 14 cost time: 114.59821510314941
Epoch: 14, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.194 Vali Acc: 0.970 Test Loss: 0.194 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0004188
	speed: 0.5421s/iter; left time: 19200.6409s
	iters: 200, epoch: 15 | loss: 0.0000006
	speed: 0.2984s/iter; left time: 10540.0778s
	iters: 300, epoch: 15 | loss: 0.0010419
	speed: 0.2943s/iter; left time: 10364.2770s
	iters: 400, epoch: 15 | loss: 0.0000017
	speed: 0.2733s/iter; left time: 9598.9911s
Epoch: 15 cost time: 118.37359285354614
Epoch: 15, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.211 Vali Acc: 0.969 Test Loss: 0.211 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0006341
	speed: 0.5705s/iter; left time: 19970.9434s
	iters: 200, epoch: 16 | loss: 0.0000003
	speed: 0.3072s/iter; left time: 10722.7377s
	iters: 300, epoch: 16 | loss: 0.0298260
	speed: 0.2959s/iter; left time: 10297.3695s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.3066s/iter; left time: 10641.6949s
Epoch: 16 cost time: 124.94400238990784
Epoch: 16, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.281 Vali Acc: 0.961 Test Loss: 0.281 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0030266
	speed: 0.5898s/iter; left time: 20403.0948s
	iters: 200, epoch: 17 | loss: 0.0000074
	speed: 0.2903s/iter; left time: 10012.3068s
	iters: 300, epoch: 17 | loss: 0.0000789
	speed: 0.2936s/iter; left time: 10097.8631s
	iters: 400, epoch: 17 | loss: 0.0509953
	speed: 0.2952s/iter; left time: 10123.1460s
Epoch: 17 cost time: 121.5717990398407
Epoch: 17, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.200 Vali Acc: 0.967 Test Loss: 0.200 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000116
	speed: 0.5448s/iter; left time: 18620.2068s
	iters: 200, epoch: 18 | loss: 0.0000463
	speed: 0.3049s/iter; left time: 10389.4955s
	iters: 300, epoch: 18 | loss: 0.2338780
	speed: 0.2961s/iter; left time: 10060.6912s
	iters: 400, epoch: 18 | loss: 0.0000002
	speed: 0.2850s/iter; left time: 9656.9461s
Epoch: 18 cost time: 120.64797186851501
Epoch: 18, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979990 --> -0.979990).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000379
	speed: 0.5435s/iter; left time: 18353.3729s
	iters: 200, epoch: 19 | loss: 0.0000162
	speed: 0.2662s/iter; left time: 8963.1837s
	iters: 300, epoch: 19 | loss: 0.2026514
	speed: 0.2748s/iter; left time: 9222.8389s
	iters: 400, epoch: 19 | loss: 0.0002245
	speed: 0.2732s/iter; left time: 9144.7354s
Epoch: 19 cost time: 112.10209155082703
Epoch: 19, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.193 Vali Acc: 0.968 Test Loss: 0.193 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0001065
	speed: 0.5851s/iter; left time: 19515.5584s
	iters: 200, epoch: 20 | loss: 0.5871283
	speed: 0.3067s/iter; left time: 10199.4799s
	iters: 300, epoch: 20 | loss: 0.0046538
	speed: 0.2904s/iter; left time: 9627.2022s
	iters: 400, epoch: 20 | loss: 0.1112451
	speed: 0.2869s/iter; left time: 9482.7459s
Epoch: 20 cost time: 123.20368528366089
Epoch: 20, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.147 Vali Acc: 0.975 Test Loss: 0.147 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000002
	speed: 0.5858s/iter; left time: 19297.9551s
	iters: 200, epoch: 21 | loss: 0.0005502
	speed: 0.2887s/iter; left time: 9482.6643s
	iters: 300, epoch: 21 | loss: 0.0090020
	speed: 0.2843s/iter; left time: 9307.5788s
	iters: 400, epoch: 21 | loss: 0.0003658
	speed: 0.2884s/iter; left time: 9413.0497s
Epoch: 21 cost time: 120.26105403900146
Epoch: 21, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.156 Vali Acc: 0.974 Test Loss: 0.156 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0002555
	speed: 0.5797s/iter; left time: 18856.0226s
	iters: 200, epoch: 22 | loss: 0.0000001
	speed: 0.2961s/iter; left time: 9602.4935s
	iters: 300, epoch: 22 | loss: 0.0003297
	speed: 0.2996s/iter; left time: 9685.6415s
	iters: 400, epoch: 22 | loss: 0.1154344
	speed: 0.2953s/iter; left time: 9516.0654s
Epoch: 22 cost time: 123.03684425354004
Epoch: 22, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.155 Vali Acc: 0.975 Test Loss: 0.155 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.1349598
	speed: 0.5644s/iter; left time: 18125.7662s
	iters: 200, epoch: 23 | loss: 0.0000106
	speed: 0.2902s/iter; left time: 9290.1995s
	iters: 300, epoch: 23 | loss: 0.0000005
	speed: 0.3029s/iter; left time: 9667.8677s
	iters: 400, epoch: 23 | loss: 0.0000239
	speed: 0.3011s/iter; left time: 9580.5673s
Epoch: 23 cost time: 122.55606842041016
Epoch: 23, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.148 Vali Acc: 0.979 Test Loss: 0.148 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0000186
	speed: 0.5577s/iter; left time: 17679.6929s
	iters: 200, epoch: 24 | loss: 0.0024770
	speed: 0.2953s/iter; left time: 9331.0749s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.2817s/iter; left time: 8875.3854s
	iters: 400, epoch: 24 | loss: 0.0007145
	speed: 0.2976s/iter; left time: 9345.2161s
Epoch: 24 cost time: 119.83067536354065
Epoch: 24, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.139 Vali Acc: 0.975 Test Loss: 0.139 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0002162
	speed: 0.6116s/iter; left time: 19135.6660s
	iters: 200, epoch: 25 | loss: 0.0674989
	speed: 0.3029s/iter; left time: 9447.8441s
	iters: 300, epoch: 25 | loss: 0.0000467
	speed: 0.2860s/iter; left time: 8892.4885s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.2825s/iter; left time: 8753.2429s
Epoch: 25 cost time: 122.95100545883179
Epoch: 25, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.169 Vali Acc: 0.971 Test Loss: 0.169 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0000025
	speed: 0.5542s/iter; left time: 17112.7564s
	iters: 200, epoch: 26 | loss: 0.0052599
	speed: 0.2978s/iter; left time: 9166.3834s
	iters: 300, epoch: 26 | loss: 0.0006636
	speed: 0.2889s/iter; left time: 8860.9302s
	iters: 400, epoch: 26 | loss: 0.0000182
	speed: 0.3177s/iter; left time: 9715.0294s
Epoch: 26 cost time: 123.43043518066406
Epoch: 26, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.172 Vali Acc: 0.976 Test Loss: 0.172 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0022095
	speed: 0.5921s/iter; left time: 18038.2738s
	iters: 200, epoch: 27 | loss: 0.0000077
	speed: 0.2971s/iter; left time: 9022.3465s
	iters: 300, epoch: 27 | loss: 0.0000016
	speed: 0.2807s/iter; left time: 8493.5002s
	iters: 400, epoch: 27 | loss: 0.0000045
	speed: 0.2854s/iter; left time: 8609.4777s
Epoch: 27 cost time: 120.22823309898376
Epoch: 27, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.161 Vali Acc: 0.974 Test Loss: 0.161 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.5856s/iter; left time: 17598.1060s
	iters: 200, epoch: 28 | loss: 0.0000002
	speed: 0.3021s/iter; left time: 9047.1477s
	iters: 300, epoch: 28 | loss: 0.0446485
	speed: 0.2931s/iter; left time: 8750.0596s
	iters: 400, epoch: 28 | loss: 0.0000080
	speed: 0.2868s/iter; left time: 8531.4412s
Epoch: 28 cost time: 122.0896372795105
Epoch: 28, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.148 Vali Acc: 0.980 Test Loss: 0.148 Test Acc: 0.980
Validation loss decreased (-0.979990 --> -0.980444).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.5759s/iter; left time: 17069.3951s
	iters: 200, epoch: 29 | loss: 0.0000027
	speed: 0.3070s/iter; left time: 9066.8856s
	iters: 300, epoch: 29 | loss: 0.0000007
	speed: 0.3132s/iter; left time: 9220.9321s
	iters: 400, epoch: 29 | loss: 0.0000073
	speed: 0.2956s/iter; left time: 8671.0262s
Epoch: 29 cost time: 124.45803236961365
Epoch: 29, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.256 Vali Acc: 0.969 Test Loss: 0.256 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0000471
	speed: 0.5588s/iter; left time: 16329.1881s
	iters: 200, epoch: 30 | loss: 0.0001127
	speed: 0.2874s/iter; left time: 8371.3194s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.2851s/iter; left time: 8273.3988s
	iters: 400, epoch: 30 | loss: 0.0007352
	speed: 0.2816s/iter; left time: 8146.1705s
Epoch: 30 cost time: 118.34768581390381
Epoch: 30, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.185 Vali Acc: 0.971 Test Loss: 0.185 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.0000062
	speed: 0.5936s/iter; left time: 17100.8238s
	iters: 200, epoch: 31 | loss: 0.0000138
	speed: 0.3039s/iter; left time: 8726.6152s
	iters: 300, epoch: 31 | loss: 0.0000006
	speed: 0.2867s/iter; left time: 8203.7565s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.2971s/iter; left time: 8470.6327s
Epoch: 31 cost time: 123.68418550491333
Epoch: 31, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.195 Vali Acc: 0.972 Test Loss: 0.195 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.0000023
	speed: 0.5490s/iter; left time: 15591.3410s
	iters: 200, epoch: 32 | loss: 0.0000044
	speed: 0.2821s/iter; left time: 7982.4814s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.3004s/iter; left time: 8470.1102s
	iters: 400, epoch: 32 | loss: 0.0000001
	speed: 0.2978s/iter; left time: 8368.7811s
Epoch: 32 cost time: 119.93693208694458
Epoch: 32, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.317 Vali Acc: 0.962 Test Loss: 0.317 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.5537074
	speed: 0.5862s/iter; left time: 16406.0682s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.2830s/iter; left time: 7892.1358s
	iters: 300, epoch: 33 | loss: 0.0000519
	speed: 0.2905s/iter; left time: 8071.7642s
	iters: 400, epoch: 33 | loss: 0.0064094
	speed: 0.3012s/iter; left time: 8337.7807s
Epoch: 33 cost time: 121.37623763084412
Epoch: 33, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.220 Vali Acc: 0.972 Test Loss: 0.220 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.0000006
	speed: 0.5804s/iter; left time: 16001.6356s
	iters: 200, epoch: 34 | loss: 0.0000011
	speed: 0.2978s/iter; left time: 8181.1379s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.3052s/iter; left time: 8353.4492s
	iters: 400, epoch: 34 | loss: 0.0000001
	speed: 0.2853s/iter; left time: 7780.0886s
Epoch: 34 cost time: 122.05823373794556
Epoch: 34, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.338 Vali Acc: 0.947 Test Loss: 0.338 Test Acc: 0.947
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 0.0002286
	speed: 0.5689s/iter; left time: 15451.7429s
	iters: 200, epoch: 35 | loss: 0.0000002
	speed: 0.2944s/iter; left time: 7967.0739s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.2901s/iter; left time: 7819.9244s
	iters: 400, epoch: 35 | loss: 0.0005815
	speed: 0.2779s/iter; left time: 7463.0565s
Epoch: 35 cost time: 119.43182158470154
Epoch: 35, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.152 Vali Acc: 0.977 Test Loss: 0.152 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.6049s/iter; left time: 16178.0854s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.3119s/iter; left time: 8309.9738s
	iters: 300, epoch: 36 | loss: 0.0000026
	speed: 0.3045s/iter; left time: 8083.2007s
	iters: 400, epoch: 36 | loss: 0.0000008
	speed: 0.3014s/iter; left time: 7972.0009s
Epoch: 36 cost time: 127.91722536087036
Epoch: 36, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.138 Vali Acc: 0.975 Test Loss: 0.138 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 0.0000023
	speed: 0.5617s/iter; left time: 14792.3694s
	iters: 200, epoch: 37 | loss: 0.0000044
	speed: 0.2787s/iter; left time: 7311.6709s
	iters: 300, epoch: 37 | loss: 0.1986882
	speed: 0.3058s/iter; left time: 7991.2154s
	iters: 400, epoch: 37 | loss: 0.0000008
	speed: 0.3116s/iter; left time: 8111.4197s
Epoch: 37 cost time: 121.98517727851868
Epoch: 37, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 38 | loss: 0.0000015
	speed: 0.5553s/iter; left time: 14394.3376s
	iters: 200, epoch: 38 | loss: 0.0000003
	speed: 0.2898s/iter; left time: 7482.4682s
	iters: 300, epoch: 38 | loss: 0.0000000
	speed: 0.3027s/iter; left time: 7784.5342s
	iters: 400, epoch: 38 | loss: 0.0000032
	speed: 0.2969s/iter; left time: 7607.1116s
Epoch: 38 cost time: 121.57962226867676
Epoch: 38, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9804456571168713
model parameter : 1498378
model size : 10.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.5483879
	speed: 0.3434s/iter; left time: 14149.0928s
	iters: 200, epoch: 1 | loss: 0.3311787
	speed: 0.2963s/iter; left time: 12177.0832s
	iters: 300, epoch: 1 | loss: 0.1680527
	speed: 0.3019s/iter; left time: 12378.4449s
	iters: 400, epoch: 1 | loss: 0.0917803
	speed: 0.3050s/iter; left time: 12473.5364s
Epoch: 1 cost time: 128.6944043636322
Epoch: 1, Steps: 413 | Train Loss: 0.761 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
Validation loss decreased (inf --> -0.968166).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0545062
	speed: 0.5763s/iter; left time: 23504.2274s
	iters: 200, epoch: 2 | loss: 0.2230425
	speed: 0.3051s/iter; left time: 12412.1165s
	iters: 300, epoch: 2 | loss: 0.0051569
	speed: 0.3084s/iter; left time: 12517.0207s
	iters: 400, epoch: 2 | loss: 0.0637928
	speed: 0.3233s/iter; left time: 13088.7237s
Epoch: 2 cost time: 128.17165637016296
Epoch: 2, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
Validation loss decreased (-0.968166 --> -0.980445).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2232316
	speed: 0.6205s/iter; left time: 25053.9935s
	iters: 200, epoch: 3 | loss: 0.0368667
	speed: 0.3362s/iter; left time: 13540.2777s
	iters: 300, epoch: 3 | loss: 0.0040298
	speed: 0.3232s/iter; left time: 12986.0012s
	iters: 400, epoch: 3 | loss: 0.0803941
	speed: 0.3367s/iter; left time: 13494.5565s
Epoch: 3 cost time: 136.3842272758484
Epoch: 3, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0031751
	speed: 0.6497s/iter; left time: 25964.2887s
	iters: 200, epoch: 4 | loss: 0.3266470
	speed: 0.3219s/iter; left time: 12829.7698s
	iters: 300, epoch: 4 | loss: 0.0001414
	speed: 0.3389s/iter; left time: 13476.1080s
	iters: 400, epoch: 4 | loss: 0.0425054
	speed: 0.3235s/iter; left time: 12831.6735s
Epoch: 4 cost time: 136.4033079147339
Epoch: 4, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.129 Vali Acc: 0.964 Test Loss: 0.129 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0384488
	speed: 0.6432s/iter; left time: 25439.0750s
	iters: 200, epoch: 5 | loss: 0.2507811
	speed: 0.3317s/iter; left time: 13085.7057s
	iters: 300, epoch: 5 | loss: 0.0018968
	speed: 0.3230s/iter; left time: 12709.5358s
	iters: 400, epoch: 5 | loss: 0.0042496
	speed: 0.3375s/iter; left time: 13248.3768s
Epoch: 5 cost time: 137.38657903671265
Epoch: 5, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0034182
	speed: 0.6331s/iter; left time: 24777.7677s
	iters: 200, epoch: 6 | loss: 0.0000808
	speed: 0.3059s/iter; left time: 11943.0026s
	iters: 300, epoch: 6 | loss: 0.1370289
	speed: 0.3146s/iter; left time: 12249.9027s
	iters: 400, epoch: 6 | loss: 0.0056785
	speed: 0.3140s/iter; left time: 12195.6767s
Epoch: 6 cost time: 129.4874074459076
Epoch: 6, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.127 Vali Acc: 0.969 Test Loss: 0.127 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0805410
	speed: 0.6031s/iter; left time: 23353.6133s
	iters: 200, epoch: 7 | loss: 0.0177007
	speed: 0.3206s/iter; left time: 12381.1478s
	iters: 300, epoch: 7 | loss: 0.0010182
	speed: 0.3323s/iter; left time: 12799.8253s
	iters: 400, epoch: 7 | loss: 0.0028186
	speed: 0.3506s/iter; left time: 13472.5528s
Epoch: 7 cost time: 136.19442534446716
Epoch: 7, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.152 Vali Acc: 0.969 Test Loss: 0.152 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.5699136
	speed: 0.6382s/iter; left time: 24448.3596s
	iters: 200, epoch: 8 | loss: 0.0041747
	speed: 0.3031s/iter; left time: 11582.0276s
	iters: 300, epoch: 8 | loss: 0.0012004
	speed: 0.2906s/iter; left time: 11075.4152s
	iters: 400, epoch: 8 | loss: 0.0005460
	speed: 0.2961s/iter; left time: 11254.7623s
Epoch: 8 cost time: 123.94351148605347
Epoch: 8, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0000045
	speed: 0.5838s/iter; left time: 22123.7702s
	iters: 200, epoch: 9 | loss: 0.0000310
	speed: 0.2935s/iter; left time: 11092.7455s
	iters: 300, epoch: 9 | loss: 0.0084560
	speed: 0.2965s/iter; left time: 11178.1742s
	iters: 400, epoch: 9 | loss: 0.0013367
	speed: 0.3116s/iter; left time: 11714.2685s
Epoch: 9 cost time: 125.01102757453918
Epoch: 9, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.186 Vali Acc: 0.959 Test Loss: 0.186 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0000008
	speed: 0.6699s/iter; left time: 25109.6012s
	iters: 200, epoch: 10 | loss: 0.0000209
	speed: 0.3202s/iter; left time: 11968.7651s
	iters: 300, epoch: 10 | loss: 0.1645773
	speed: 0.3110s/iter; left time: 11596.2152s
	iters: 400, epoch: 10 | loss: 0.0000267
	speed: 0.3057s/iter; left time: 11365.6554s
Epoch: 10 cost time: 131.4226405620575
Epoch: 10, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0000248
	speed: 0.5926s/iter; left time: 21969.0984s
	iters: 200, epoch: 11 | loss: 0.0000613
	speed: 0.3023s/iter; left time: 11177.2615s
	iters: 300, epoch: 11 | loss: 0.0015870
	speed: 0.3028s/iter; left time: 11165.7438s
	iters: 400, epoch: 11 | loss: 0.0000328
	speed: 0.2962s/iter; left time: 10889.9713s
Epoch: 11 cost time: 124.46241617202759
Epoch: 11, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.255 Vali Acc: 0.960 Test Loss: 0.255 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0000016
	speed: 0.6432s/iter; left time: 23578.3982s
	iters: 200, epoch: 12 | loss: 0.0000024
	speed: 0.3495s/iter; left time: 12778.0556s
	iters: 300, epoch: 12 | loss: 0.0000051
	speed: 0.3146s/iter; left time: 11470.2329s
	iters: 400, epoch: 12 | loss: 0.0000009
	speed: 0.3110s/iter; left time: 11306.0092s
Epoch: 12 cost time: 135.9039125442505
Epoch: 12, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.095 Vali Acc: 0.981 Test Loss: 0.095 Test Acc: 0.981
Validation loss decreased (-0.980445 --> -0.980899).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000009
	speed: 0.6120s/iter; left time: 22183.0170s
	iters: 200, epoch: 13 | loss: 0.0000005
	speed: 0.3027s/iter; left time: 10941.5067s
	iters: 300, epoch: 13 | loss: 0.0000026
	speed: 0.3075s/iter; left time: 11084.4574s
	iters: 400, epoch: 13 | loss: 0.0309142
	speed: 0.3350s/iter; left time: 12041.7623s
Epoch: 13 cost time: 130.15444493293762
Epoch: 13, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.183 Vali Acc: 0.969 Test Loss: 0.183 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0059769
	speed: 0.6631s/iter; left time: 23758.8965s
	iters: 200, epoch: 14 | loss: 0.0000041
	speed: 0.3110s/iter; left time: 11111.4300s
	iters: 300, epoch: 14 | loss: 0.0014931
	speed: 0.3120s/iter; left time: 11116.3343s
	iters: 400, epoch: 14 | loss: 0.0000013
	speed: 0.3191s/iter; left time: 11337.4103s
Epoch: 14 cost time: 132.38368725776672
Epoch: 14, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.283 Vali Acc: 0.960 Test Loss: 0.283 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0958021
	speed: 0.6067s/iter; left time: 21490.0633s
	iters: 200, epoch: 15 | loss: 0.0000036
	speed: 0.3001s/iter; left time: 10598.4209s
	iters: 300, epoch: 15 | loss: 0.0003128
	speed: 0.3003s/iter; left time: 10575.0394s
	iters: 400, epoch: 15 | loss: 0.0000001
	speed: 0.2958s/iter; left time: 10387.9017s
Epoch: 15 cost time: 124.0363187789917
Epoch: 15, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.172 Vali Acc: 0.967 Test Loss: 0.172 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0107992
	speed: 0.6049s/iter; left time: 21173.5542s
	iters: 200, epoch: 16 | loss: 0.0003607
	speed: 0.3027s/iter; left time: 10565.8041s
	iters: 300, epoch: 16 | loss: 0.0000075
	speed: 0.3219s/iter; left time: 11204.7135s
	iters: 400, epoch: 16 | loss: 0.0000548
	speed: 0.3069s/iter; left time: 10650.9742s
Epoch: 16 cost time: 128.7253177165985
Epoch: 16, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.143 Vali Acc: 0.975 Test Loss: 0.143 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000115
	speed: 0.6071s/iter; left time: 21002.7240s
	iters: 200, epoch: 17 | loss: 0.0001290
	speed: 0.3003s/iter; left time: 10358.2335s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.2990s/iter; left time: 10284.2682s
	iters: 400, epoch: 17 | loss: 0.0000729
	speed: 0.3155s/iter; left time: 10819.6957s
Epoch: 17 cost time: 127.0854823589325
Epoch: 17, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.212 Vali Acc: 0.968 Test Loss: 0.212 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000941
	speed: 0.6069s/iter; left time: 20743.3078s
	iters: 200, epoch: 18 | loss: 0.2679391
	speed: 0.3447s/iter; left time: 11747.0225s
	iters: 300, epoch: 18 | loss: 0.0001491
	speed: 0.3262s/iter; left time: 11084.0708s
	iters: 400, epoch: 18 | loss: 0.0000983
	speed: 0.3207s/iter; left time: 10866.4161s
Epoch: 18 cost time: 133.8567397594452
Epoch: 18, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.157 Vali Acc: 0.975 Test Loss: 0.157 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000030
	speed: 0.6043s/iter; left time: 20404.9305s
	iters: 200, epoch: 19 | loss: 0.0002186
	speed: 0.2988s/iter; left time: 10061.3626s
	iters: 300, epoch: 19 | loss: 0.3650635
	speed: 0.3037s/iter; left time: 10192.6252s
	iters: 400, epoch: 19 | loss: 0.0004610
	speed: 0.3228s/iter; left time: 10803.3128s
Epoch: 19 cost time: 127.9523663520813
Epoch: 19, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.201 Vali Acc: 0.972 Test Loss: 0.201 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0008370
	speed: 0.6466s/iter; left time: 21568.2954s
	iters: 200, epoch: 20 | loss: 0.0000172
	speed: 0.3497s/iter; left time: 11630.2040s
	iters: 300, epoch: 20 | loss: 0.0001207
	speed: 0.3262s/iter; left time: 10813.6510s
	iters: 400, epoch: 20 | loss: 0.0042511
	speed: 0.3154s/iter; left time: 10423.8772s
Epoch: 20 cost time: 136.4064393043518
Epoch: 20, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.254 Vali Acc: 0.969 Test Loss: 0.254 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0021284
	speed: 0.6442s/iter; left time: 21219.9708s
	iters: 200, epoch: 21 | loss: 0.0004020
	speed: 0.3132s/iter; left time: 10286.8622s
	iters: 300, epoch: 21 | loss: 0.0000031
	speed: 0.2965s/iter; left time: 9706.3746s
	iters: 400, epoch: 21 | loss: 0.0000103
	speed: 0.2947s/iter; left time: 9619.7532s
Epoch: 21 cost time: 127.37066006660461
Epoch: 21, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.140 Vali Acc: 0.978 Test Loss: 0.140 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000003
	speed: 0.5902s/iter; left time: 19197.1503s
	iters: 200, epoch: 22 | loss: 0.0000011
	speed: 0.3203s/iter; left time: 10387.9620s
	iters: 300, epoch: 22 | loss: 0.1716695
	speed: 0.3459s/iter; left time: 11182.3476s
	iters: 400, epoch: 22 | loss: 0.0000943
	speed: 0.3461s/iter; left time: 11153.6745s
Epoch: 22 cost time: 135.51566123962402
Epoch: 22, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.158 Vali Acc: 0.976 Test Loss: 0.158 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9809004092769441
model parameter : 1498378
model size : 10.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.3028057
	speed: 0.3071s/iter; left time: 12654.1667s
	iters: 200, epoch: 1 | loss: 2.3017800
	speed: 0.2876s/iter; left time: 11818.6298s
	iters: 300, epoch: 1 | loss: 2.3032026
	speed: 0.3008s/iter; left time: 12331.9210s
	iters: 400, epoch: 1 | loss: 2.3001983
	speed: 0.3031s/iter; left time: 12398.0006s
Epoch: 1 cost time: 124.29410982131958
Epoch: 1, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (inf --> -0.100022).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3029783
	speed: 0.6453s/iter; left time: 26320.6633s
	iters: 200, epoch: 2 | loss: 2.3039031
	speed: 0.3379s/iter; left time: 13750.2797s
	iters: 300, epoch: 2 | loss: 2.3018591
	speed: 0.3297s/iter; left time: 13381.1958s
	iters: 400, epoch: 2 | loss: 2.3028476
	speed: 0.3163s/iter; left time: 12804.6472s
Epoch: 2 cost time: 136.00351238250732
Epoch: 2, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.3029583
	speed: 0.6136s/iter; left time: 24773.2550s
	iters: 200, epoch: 3 | loss: 2.3038869
	speed: 0.3059s/iter; left time: 12320.6921s
	iters: 300, epoch: 3 | loss: 2.3038120
	speed: 0.3072s/iter; left time: 12341.0968s
	iters: 400, epoch: 3 | loss: 2.3042898
	speed: 0.3051s/iter; left time: 12228.3725s
Epoch: 3 cost time: 128.02259230613708
Epoch: 3, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 2.3029449
	speed: 0.6147s/iter; left time: 24562.6791s
	iters: 200, epoch: 4 | loss: 2.3035469
	speed: 0.3281s/iter; left time: 13079.8416s
	iters: 300, epoch: 4 | loss: 2.3024573
	speed: 0.3204s/iter; left time: 12740.9913s
	iters: 400, epoch: 4 | loss: 2.3020709
	speed: 0.3187s/iter; left time: 12639.4381s
Epoch: 4 cost time: 132.5808982849121
Epoch: 4, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 2.3014028
	speed: 0.6266s/iter; left time: 24780.1665s
	iters: 200, epoch: 5 | loss: 2.3032167
	speed: 0.3040s/iter; left time: 11992.8068s
	iters: 300, epoch: 5 | loss: 2.3031845
	speed: 0.2805s/iter; left time: 11037.1155s
	iters: 400, epoch: 5 | loss: 2.3020706
	speed: 0.2830s/iter; left time: 11107.6088s
Epoch: 5 cost time: 122.55009913444519
Epoch: 5, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 2.3025427
	speed: 0.6273s/iter; left time: 24548.3674s
	iters: 200, epoch: 6 | loss: 2.3044128
	speed: 0.3143s/iter; left time: 12267.8609s
	iters: 300, epoch: 6 | loss: 2.3000107
	speed: 0.3177s/iter; left time: 12371.4314s
	iters: 400, epoch: 6 | loss: 2.3028400
	speed: 0.2925s/iter; left time: 11360.9180s
Epoch: 6 cost time: 128.68524765968323
Epoch: 6, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 2.3004675
	speed: 0.5853s/iter; left time: 22664.3075s
	iters: 200, epoch: 7 | loss: 2.3010972
	speed: 0.3104s/iter; left time: 11987.7299s
	iters: 300, epoch: 7 | loss: 2.3052142
	speed: 0.3081s/iter; left time: 11867.3555s
	iters: 400, epoch: 7 | loss: 2.3015034
	speed: 0.3242s/iter; left time: 12456.1749s
Epoch: 7 cost time: 129.07797074317932
Epoch: 7, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 2.3015089
	speed: 0.6658s/iter; left time: 25507.4371s
	iters: 200, epoch: 8 | loss: 2.3026769
	speed: 0.3116s/iter; left time: 11907.0155s
	iters: 300, epoch: 8 | loss: 2.3042800
	speed: 0.3018s/iter; left time: 11499.8595s
	iters: 400, epoch: 8 | loss: 2.3014975
	speed: 0.3109s/iter; left time: 11817.6776s
Epoch: 8 cost time: 130.27549076080322
Epoch: 8, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 2.3020496
	speed: 0.6291s/iter; left time: 23842.5124s
	iters: 200, epoch: 9 | loss: 2.3045537
	speed: 0.2966s/iter; left time: 11209.0997s
	iters: 300, epoch: 9 | loss: 2.3023062
	speed: 0.3230s/iter; left time: 12175.8233s
	iters: 400, epoch: 9 | loss: 2.3038793
	speed: 0.3342s/iter; left time: 12566.6417s
Epoch: 9 cost time: 131.9819791316986
Epoch: 9, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.3075693
	speed: 0.6545s/iter; left time: 24531.4064s
	iters: 200, epoch: 10 | loss: 2.3011775
	speed: 0.3207s/iter; left time: 11987.9530s
	iters: 300, epoch: 10 | loss: 2.3037953
	speed: 0.3076s/iter; left time: 11467.1407s
	iters: 400, epoch: 10 | loss: 2.3024590
	speed: 0.2957s/iter; left time: 10996.4696s
Epoch: 10 cost time: 128.3083255290985
Epoch: 10, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 2.3041737
	speed: 0.5769s/iter; left time: 21385.8152s
	iters: 200, epoch: 11 | loss: 2.3064897
	speed: 0.3127s/iter; left time: 11560.9741s
	iters: 300, epoch: 11 | loss: 2.3025739
	speed: 0.3040s/iter; left time: 11210.2643s
	iters: 400, epoch: 11 | loss: 2.3019056
	speed: 0.3189s/iter; left time: 11726.6478s
Epoch: 11 cost time: 128.41513967514038
Epoch: 11, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 2.3009977
	speed: 0.6285s/iter; left time: 23038.1219s
	iters: 200, epoch: 12 | loss: 2.2999079
	speed: 0.3046s/iter; left time: 11134.7236s
	iters: 300, epoch: 12 | loss: 2.3076625
	speed: 0.3078s/iter; left time: 11222.5936s
	iters: 400, epoch: 12 | loss: 2.3044982
	speed: 0.3116s/iter; left time: 11330.7271s
Epoch: 12 cost time: 127.84254789352417
Epoch: 12, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 2.3010230
	speed: 0.6334s/iter; left time: 22957.7330s
	iters: 200, epoch: 13 | loss: 2.3080466
	speed: 0.3230s/iter; left time: 11673.4494s
	iters: 300, epoch: 13 | loss: 2.3020611
	speed: 0.3251s/iter; left time: 11718.0993s
	iters: 400, epoch: 13 | loss: 2.3022051
	speed: 0.3017s/iter; left time: 10842.9312s
Epoch: 13 cost time: 133.16250896453857
Epoch: 13, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 2.3062189
	speed: 0.6301s/iter; left time: 22576.3236s
	iters: 200, epoch: 14 | loss: 2.3043325
	speed: 0.2898s/iter; left time: 10355.9008s
	iters: 300, epoch: 14 | loss: 2.3015735
	speed: 0.3028s/iter; left time: 10789.9766s
	iters: 400, epoch: 14 | loss: 2.3047814
	speed: 0.3049s/iter; left time: 10835.4826s
Epoch: 14 cost time: 125.28837895393372
Epoch: 14, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 2.3015227
	speed: 0.6110s/iter; left time: 21641.1104s
	iters: 200, epoch: 15 | loss: 2.2998304
	speed: 0.3135s/iter; left time: 11071.1741s
	iters: 300, epoch: 15 | loss: 2.3028018
	speed: 0.3001s/iter; left time: 10569.3165s
	iters: 400, epoch: 15 | loss: 2.3030581
	speed: 0.3025s/iter; left time: 10625.0159s
Epoch: 15 cost time: 127.4686062335968
Epoch: 15, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 2.3070323
	speed: 0.6030s/iter; left time: 21108.8689s
	iters: 200, epoch: 16 | loss: 2.3053088
	speed: 0.2955s/iter; left time: 10314.2192s
	iters: 300, epoch: 16 | loss: 2.3030014
	speed: 0.2955s/iter; left time: 10286.5343s
	iters: 400, epoch: 16 | loss: 2.3048432
	speed: 0.2911s/iter; left time: 10104.0517s
Epoch: 16 cost time: 122.79890179634094
Epoch: 16, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 2.3063285
	speed: 0.5839s/iter; left time: 20200.4527s
	iters: 200, epoch: 17 | loss: 2.3050029
	speed: 0.2810s/iter; left time: 9693.4115s
	iters: 300, epoch: 17 | loss: 2.3060241
	speed: 0.2970s/iter; left time: 10214.8060s
	iters: 400, epoch: 17 | loss: 2.3013210
	speed: 0.3033s/iter; left time: 10401.8998s
Epoch: 17 cost time: 121.93237781524658
Epoch: 17, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 2.3075516
	speed: 0.5995s/iter; left time: 20490.7757s
	iters: 200, epoch: 18 | loss: 2.3009291
	speed: 0.3101s/iter; left time: 10567.9280s
	iters: 300, epoch: 18 | loss: 2.3035407
	speed: 0.2949s/iter; left time: 10019.6760s
	iters: 400, epoch: 18 | loss: 2.3010950
	speed: 0.2945s/iter; left time: 9978.1129s
Epoch: 18 cost time: 125.09995126724243
Epoch: 18, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 2.3037026
	speed: 0.5850s/iter; left time: 19752.3429s
	iters: 200, epoch: 19 | loss: 2.3044405
	speed: 0.3016s/iter; left time: 10154.9542s
	iters: 300, epoch: 19 | loss: 2.3031604
	speed: 0.2850s/iter; left time: 9565.5491s
	iters: 400, epoch: 19 | loss: 2.3037124
	speed: 0.2975s/iter; left time: 9956.3987s
Epoch: 19 cost time: 121.75853872299194
Epoch: 19, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.10004547521600728
model parameter : 1498378
model size : 10.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         47                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df512_ma47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2285265
	speed: 0.3407s/iter; left time: 14035.5735s
	iters: 200, epoch: 1 | loss: 0.0929375
	speed: 0.3176s/iter; left time: 13052.0972s
	iters: 300, epoch: 1 | loss: 0.2470074
	speed: 0.3242s/iter; left time: 13292.2262s
	iters: 400, epoch: 1 | loss: 0.1043720
	speed: 0.3174s/iter; left time: 12983.6285s
Epoch: 1 cost time: 134.0251488685608
Epoch: 1, Steps: 413 | Train Loss: 0.457 Vali Loss: 0.058 Vali Acc: 0.979 Test Loss: 0.058 Test Acc: 0.979
Validation loss decreased (inf --> -0.978626).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0127571
	speed: 0.6340s/iter; left time: 25859.3127s
	iters: 200, epoch: 2 | loss: 0.0450374
	speed: 0.3010s/iter; left time: 12245.9129s
	iters: 300, epoch: 2 | loss: 0.1092820
	speed: 0.3131s/iter; left time: 12708.7251s
	iters: 400, epoch: 2 | loss: 0.0020311
	speed: 0.3126s/iter; left time: 12656.9690s
Epoch: 2 cost time: 129.74611616134644
Epoch: 2, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.047 Vali Acc: 0.985 Test Loss: 0.047 Test Acc: 0.985
Validation loss decreased (-0.978626 --> -0.984538).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0018116
	speed: 0.6181s/iter; left time: 24955.0493s
	iters: 200, epoch: 3 | loss: 0.0246903
	speed: 0.3159s/iter; left time: 12720.9178s
	iters: 300, epoch: 3 | loss: 0.0009078
	speed: 0.3007s/iter; left time: 12079.5030s
	iters: 400, epoch: 3 | loss: 0.0049045
	speed: 0.2961s/iter; left time: 11866.0152s
Epoch: 3 cost time: 127.63164782524109
Epoch: 3, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0011140
	speed: 0.6050s/iter; left time: 24176.4918s
	iters: 200, epoch: 4 | loss: 0.3346545
	speed: 0.3124s/iter; left time: 12451.0159s
	iters: 300, epoch: 4 | loss: 0.1014525
	speed: 0.3077s/iter; left time: 12236.3155s
	iters: 400, epoch: 4 | loss: 0.0022122
	speed: 0.3087s/iter; left time: 12242.7088s
Epoch: 4 cost time: 128.118581533432
Epoch: 4, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.153 Vali Acc: 0.966 Test Loss: 0.153 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0007169
	speed: 0.6264s/iter; left time: 24772.1596s
	iters: 200, epoch: 5 | loss: 0.0574817
	speed: 0.3127s/iter; left time: 12335.5927s
	iters: 300, epoch: 5 | loss: 0.0011903
	speed: 0.3123s/iter; left time: 12290.3609s
	iters: 400, epoch: 5 | loss: 0.2248912
	speed: 0.3165s/iter; left time: 12423.6967s
Epoch: 5 cost time: 129.93227767944336
Epoch: 5, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0005721
	speed: 0.6081s/iter; left time: 23798.4446s
	iters: 200, epoch: 6 | loss: 0.0239631
	speed: 0.3058s/iter; left time: 11939.0809s
	iters: 300, epoch: 6 | loss: 0.0007216
	speed: 0.3026s/iter; left time: 11781.7465s
	iters: 400, epoch: 6 | loss: 0.0000960
	speed: 0.2998s/iter; left time: 11641.1544s
Epoch: 6 cost time: 125.7148232460022
Epoch: 6, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.127 Vali Acc: 0.969 Test Loss: 0.127 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0025876
	speed: 0.6181s/iter; left time: 23933.2267s
	iters: 200, epoch: 7 | loss: 0.0006567
	speed: 0.3149s/iter; left time: 12160.5643s
	iters: 300, epoch: 7 | loss: 0.0287320
	speed: 0.3038s/iter; left time: 11701.7850s
	iters: 400, epoch: 7 | loss: 0.0031038
	speed: 0.3225s/iter; left time: 12393.2175s
Epoch: 7 cost time: 130.38570165634155
Epoch: 7, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.297 Vali Acc: 0.948 Test Loss: 0.297 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0004111
	speed: 0.6235s/iter; left time: 23884.4961s
	iters: 200, epoch: 8 | loss: 0.0001065
	speed: 0.3147s/iter; left time: 12025.6492s
	iters: 300, epoch: 8 | loss: 0.0000404
	speed: 0.3143s/iter; left time: 11977.0312s
	iters: 400, epoch: 8 | loss: 0.1059604
	speed: 0.3210s/iter; left time: 12201.3711s
Epoch: 8 cost time: 131.0482861995697
Epoch: 8, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.165 Vali Acc: 0.975 Test Loss: 0.165 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0012015
	speed: 0.6175s/iter; left time: 23399.6694s
	iters: 200, epoch: 9 | loss: 0.0054724
	speed: 0.3061s/iter; left time: 11570.8600s
	iters: 300, epoch: 9 | loss: 0.0017134
	speed: 0.3128s/iter; left time: 11791.2937s
	iters: 400, epoch: 9 | loss: 0.0012531
	speed: 0.3285s/iter; left time: 12350.5025s
Epoch: 9 cost time: 130.69046711921692
Epoch: 9, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0001005
	speed: 0.6550s/iter; left time: 24552.1719s
	iters: 200, epoch: 10 | loss: 0.0004923
	speed: 0.3294s/iter; left time: 12313.7462s
	iters: 300, epoch: 10 | loss: 0.0009369
	speed: 0.3302s/iter; left time: 12309.8398s
	iters: 400, epoch: 10 | loss: 0.0003930
	speed: 0.3241s/iter; left time: 12050.4135s
Epoch: 10 cost time: 136.79435753822327
Epoch: 10, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.158 Vali Acc: 0.973 Test Loss: 0.158 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0000002
	speed: 0.6315s/iter; left time: 23411.8833s
	iters: 200, epoch: 11 | loss: 0.0025035
	speed: 0.3157s/iter; left time: 11671.8110s
	iters: 300, epoch: 11 | loss: 0.2143596
	speed: 0.3103s/iter; left time: 11440.2137s
	iters: 400, epoch: 11 | loss: 0.0000260
	speed: 0.3319s/iter; left time: 12205.3445s
Epoch: 11 cost time: 133.00353240966797
Epoch: 11, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.178 Vali Acc: 0.967 Test Loss: 0.178 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0012351
	speed: 0.6953s/iter; left time: 25489.7711s
	iters: 200, epoch: 12 | loss: 0.0000062
	speed: 0.3624s/iter; left time: 13250.1192s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.3326s/iter; left time: 12125.0340s
	iters: 400, epoch: 12 | loss: 0.0069150
	speed: 0.3340s/iter; left time: 12142.9524s
Epoch: 12 cost time: 144.44649696350098
Epoch: 12, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.143 Vali Acc: 0.980 Test Loss: 0.143 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df512_ma47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9845384265575261
model parameter : 1105162
model size : 9.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         38                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df512_ma38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2882315
	speed: 0.3306s/iter; left time: 13622.7993s
	iters: 200, epoch: 1 | loss: 0.1145248
	speed: 0.3220s/iter; left time: 13233.1102s
	iters: 300, epoch: 1 | loss: 0.2784033
	speed: 0.3193s/iter; left time: 13089.9755s
	iters: 400, epoch: 1 | loss: 0.2054634
	speed: 0.3160s/iter; left time: 12924.7335s
Epoch: 1 cost time: 132.71616005897522
Epoch: 1, Steps: 413 | Train Loss: 0.488 Vali Loss: 0.072 Vali Acc: 0.975 Test Loss: 0.072 Test Acc: 0.975
Validation loss decreased (inf --> -0.975443).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0103586
	speed: 0.6322s/iter; left time: 25785.9010s
	iters: 200, epoch: 2 | loss: 0.0734316
	speed: 0.3364s/iter; left time: 13688.5006s
	iters: 300, epoch: 2 | loss: 0.0577844
	speed: 0.3327s/iter; left time: 13504.2672s
	iters: 400, epoch: 2 | loss: 0.0071685
	speed: 0.3329s/iter; left time: 13476.8766s
Epoch: 2 cost time: 138.54868507385254
Epoch: 2, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
Validation loss decreased (-0.975443 --> -0.975897).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0050013
	speed: 0.6744s/iter; left time: 27230.5323s
	iters: 200, epoch: 3 | loss: 0.0025454
	speed: 0.3390s/iter; left time: 13653.4496s
	iters: 300, epoch: 3 | loss: 0.0013833
	speed: 0.3494s/iter; left time: 14036.3196s
	iters: 400, epoch: 3 | loss: 0.0357958
	speed: 0.3443s/iter; left time: 13796.3686s
Epoch: 3 cost time: 142.17135453224182
Epoch: 3, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.069 Vali Acc: 0.974 Test Loss: 0.069 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0024646
	speed: 0.6926s/iter; left time: 27676.6628s
	iters: 200, epoch: 4 | loss: 0.0200476
	speed: 0.3427s/iter; left time: 13659.3216s
	iters: 300, epoch: 4 | loss: 0.0054381
	speed: 0.3405s/iter; left time: 13537.6464s
	iters: 400, epoch: 4 | loss: 0.0140240
	speed: 0.3438s/iter; left time: 13634.8168s
Epoch: 4 cost time: 143.22289991378784
Epoch: 4, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.065 Vali Acc: 0.982 Test Loss: 0.065 Test Acc: 0.982
Validation loss decreased (-0.975897 --> -0.981809).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0158812
	speed: 0.6997s/iter; left time: 27673.7477s
	iters: 200, epoch: 5 | loss: 0.0133455
	speed: 0.3615s/iter; left time: 14259.2148s
	iters: 300, epoch: 5 | loss: 0.0003049
	speed: 0.3348s/iter; left time: 13175.1390s
	iters: 400, epoch: 5 | loss: 0.0025450
	speed: 0.3311s/iter; left time: 12994.1208s
Epoch: 5 cost time: 142.48706793785095
Epoch: 5, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0096147
	speed: 0.6637s/iter; left time: 25974.6275s
	iters: 200, epoch: 6 | loss: 0.0084367
	speed: 0.3356s/iter; left time: 13101.6401s
	iters: 300, epoch: 6 | loss: 0.1160584
	speed: 0.3352s/iter; left time: 13052.8903s
	iters: 400, epoch: 6 | loss: 0.0002224
	speed: 0.3321s/iter; left time: 12896.6058s
Epoch: 6 cost time: 138.84715819358826
Epoch: 6, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0470549
	speed: 0.6970s/iter; left time: 26991.6563s
	iters: 200, epoch: 7 | loss: 0.0004547
	speed: 0.3484s/iter; left time: 13457.8752s
	iters: 300, epoch: 7 | loss: 0.0090232
	speed: 0.3436s/iter; left time: 13235.8780s
	iters: 400, epoch: 7 | loss: 0.0007794
	speed: 0.3430s/iter; left time: 13177.9104s
Epoch: 7 cost time: 143.6879494190216
Epoch: 7, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0002435
	speed: 0.6501s/iter; left time: 24903.9932s
	iters: 200, epoch: 8 | loss: 0.3871685
	speed: 0.3177s/iter; left time: 12137.5487s
	iters: 300, epoch: 8 | loss: 0.0000066
	speed: 0.3214s/iter; left time: 12250.0833s
	iters: 400, epoch: 8 | loss: 0.0004487
	speed: 0.3364s/iter; left time: 12786.1619s
Epoch: 8 cost time: 133.8067843914032
Epoch: 8, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.168 Vali Acc: 0.967 Test Loss: 0.168 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000752
	speed: 0.6649s/iter; left time: 25196.6759s
	iters: 200, epoch: 9 | loss: 0.0049809
	speed: 0.3278s/iter; left time: 12390.2599s
	iters: 300, epoch: 9 | loss: 0.0037027
	speed: 0.3314s/iter; left time: 12494.3600s
	iters: 400, epoch: 9 | loss: 0.0026037
	speed: 0.3348s/iter; left time: 12588.1932s
Epoch: 9 cost time: 136.64334392547607
Epoch: 9, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.101 Vali Acc: 0.982 Test Loss: 0.101 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0002401
	speed: 0.6651s/iter; left time: 24928.7802s
	iters: 200, epoch: 10 | loss: 0.0002662
	speed: 0.3473s/iter; left time: 12984.0721s
	iters: 300, epoch: 10 | loss: 0.0000524
	speed: 0.3593s/iter; left time: 13397.8485s
	iters: 400, epoch: 10 | loss: 0.0000027
	speed: 0.3642s/iter; left time: 13543.8443s
Epoch: 10 cost time: 145.3641664981842
Epoch: 10, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.154 Vali Acc: 0.975 Test Loss: 0.154 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000038
	speed: 0.7043s/iter; left time: 26107.3389s
	iters: 200, epoch: 11 | loss: 0.0001238
	speed: 0.3464s/iter; left time: 12806.4507s
	iters: 300, epoch: 11 | loss: 0.1690191
	speed: 0.3235s/iter; left time: 11927.5752s
	iters: 400, epoch: 11 | loss: 0.0000188
	speed: 0.3170s/iter; left time: 11657.6211s
Epoch: 11 cost time: 139.34488034248352
Epoch: 11, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.159 Vali Acc: 0.976 Test Loss: 0.159 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0001627
	speed: 0.6645s/iter; left time: 24360.8312s
	iters: 200, epoch: 12 | loss: 0.0000272
	speed: 0.3449s/iter; left time: 12609.1214s
	iters: 300, epoch: 12 | loss: 0.0000148
	speed: 0.3524s/iter; left time: 12846.2235s
	iters: 400, epoch: 12 | loss: 0.0005475
	speed: 0.3424s/iter; left time: 12450.7849s
Epoch: 12 cost time: 142.55245900154114
Epoch: 12, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.398 Vali Acc: 0.955 Test Loss: 0.398 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.3176305
	speed: 0.6788s/iter; left time: 24602.1418s
	iters: 200, epoch: 13 | loss: 0.0000679
	speed: 0.3330s/iter; left time: 12037.0582s
	iters: 300, epoch: 13 | loss: 0.9967358
	speed: 0.3134s/iter; left time: 11297.4505s
	iters: 400, epoch: 13 | loss: 0.0000218
	speed: 0.3296s/iter; left time: 11846.9131s
Epoch: 13 cost time: 135.5712172985077
Epoch: 13, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.165 Vali Acc: 0.974 Test Loss: 0.165 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000005
	speed: 0.6791s/iter; left time: 24331.9866s
	iters: 200, epoch: 14 | loss: 0.0366484
	speed: 0.3301s/iter; left time: 11794.6741s
	iters: 300, epoch: 14 | loss: 0.0038696
	speed: 0.3292s/iter; left time: 11729.1737s
	iters: 400, epoch: 14 | loss: 0.3548864
	speed: 0.3330s/iter; left time: 11833.4219s
Epoch: 14 cost time: 137.36317992210388
Epoch: 14, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.200 Vali Acc: 0.969 Test Loss: 0.200 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df512_ma38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9818099135970896
model parameter : 1105162
model size : 9.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         28                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df512_ma28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.3746290
	speed: 0.3487s/iter; left time: 14368.7130s
	iters: 200, epoch: 1 | loss: 0.1749040
	speed: 0.3455s/iter; left time: 14200.8627s
	iters: 300, epoch: 1 | loss: 0.4801797
	speed: 0.3405s/iter; left time: 13958.8266s
	iters: 400, epoch: 1 | loss: 0.0988213
	speed: 0.3385s/iter; left time: 13844.6584s
Epoch: 1 cost time: 142.17774176597595
Epoch: 1, Steps: 413 | Train Loss: 0.536 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
Validation loss decreased (inf --> -0.969985).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0162313
	speed: 0.7022s/iter; left time: 28643.0685s
	iters: 200, epoch: 2 | loss: 0.0381027
	speed: 0.3680s/iter; left time: 14973.0872s
	iters: 300, epoch: 2 | loss: 0.0794111
	speed: 0.3370s/iter; left time: 13677.0798s
	iters: 400, epoch: 2 | loss: 0.0111712
	speed: 0.3442s/iter; left time: 13936.6369s
Epoch: 2 cost time: 145.379469871521
Epoch: 2, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.061 Vali Acc: 0.982 Test Loss: 0.061 Test Acc: 0.982
Validation loss decreased (-0.969985 --> -0.982264).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0144232
	speed: 0.6875s/iter; left time: 27759.4972s
	iters: 200, epoch: 3 | loss: 0.0062875
	speed: 0.3330s/iter; left time: 13410.0015s
	iters: 300, epoch: 3 | loss: 0.0030618
	speed: 0.3561s/iter; left time: 14306.0896s
	iters: 400, epoch: 3 | loss: 0.0302662
	speed: 0.3628s/iter; left time: 14537.4422s
Epoch: 3 cost time: 145.11090803146362
Epoch: 3, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.075 Vali Acc: 0.975 Test Loss: 0.075 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0127871
	speed: 0.7141s/iter; left time: 28536.2650s
	iters: 200, epoch: 4 | loss: 0.1556591
	speed: 0.3476s/iter; left time: 13855.8250s
	iters: 300, epoch: 4 | loss: 0.4926089
	speed: 0.3295s/iter; left time: 13102.8977s
	iters: 400, epoch: 4 | loss: 0.0018917
	speed: 0.3364s/iter; left time: 13340.5039s
Epoch: 4 cost time: 141.56175637245178
Epoch: 4, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.058 Vali Acc: 0.981 Test Loss: 0.058 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0017528
	speed: 0.6401s/iter; left time: 25316.1938s
	iters: 200, epoch: 5 | loss: 0.1404174
	speed: 0.3441s/iter; left time: 13575.9584s
	iters: 300, epoch: 5 | loss: 0.0060596
	speed: 0.3363s/iter; left time: 13234.0035s
	iters: 400, epoch: 5 | loss: 0.1393222
	speed: 0.3321s/iter; left time: 13033.2408s
Epoch: 5 cost time: 138.39477610588074
Epoch: 5, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0064157
	speed: 0.6880s/iter; left time: 26926.0905s
	iters: 200, epoch: 6 | loss: 0.0004751
	speed: 0.3522s/iter; left time: 13748.4033s
	iters: 300, epoch: 6 | loss: 0.0024184
	speed: 0.3345s/iter; left time: 13023.8547s
	iters: 400, epoch: 6 | loss: 0.0000158
	speed: 0.3373s/iter; left time: 13097.7559s
Epoch: 6 cost time: 141.67214250564575
Epoch: 6, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.120 Vali Acc: 0.976 Test Loss: 0.120 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.3452888
	speed: 0.6541s/iter; left time: 25329.4289s
	iters: 200, epoch: 7 | loss: 0.0000958
	speed: 0.3192s/iter; left time: 12328.4505s
	iters: 300, epoch: 7 | loss: 0.1070313
	speed: 0.3110s/iter; left time: 11981.0515s
	iters: 400, epoch: 7 | loss: 0.0004689
	speed: 0.3222s/iter; left time: 12381.0583s
Epoch: 7 cost time: 132.72013664245605
Epoch: 7, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.142 Vali Acc: 0.974 Test Loss: 0.142 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0000004
	speed: 0.6427s/iter; left time: 24622.7711s
	iters: 200, epoch: 8 | loss: 0.0029887
	speed: 0.3192s/iter; left time: 12196.3189s
	iters: 300, epoch: 8 | loss: 0.0000611
	speed: 0.3576s/iter; left time: 13628.3140s
	iters: 400, epoch: 8 | loss: 0.5486519
	speed: 0.3502s/iter; left time: 13310.6791s
Epoch: 8 cost time: 141.67294120788574
Epoch: 8, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.982264 --> -0.983174).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0084664
	speed: 0.7123s/iter; left time: 26992.3549s
	iters: 200, epoch: 9 | loss: 0.0010267
	speed: 0.3584s/iter; left time: 13547.0390s
	iters: 300, epoch: 9 | loss: 0.0125911
	speed: 0.3209s/iter; left time: 12097.2186s
	iters: 400, epoch: 9 | loss: 0.0001079
	speed: 0.3246s/iter; left time: 12204.2273s
Epoch: 9 cost time: 140.2710666656494
Epoch: 9, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000231
	speed: 0.6469s/iter; left time: 24246.6172s
	iters: 200, epoch: 10 | loss: 0.0198795
	speed: 0.3155s/iter; left time: 11793.0860s
	iters: 300, epoch: 10 | loss: 0.0000233
	speed: 0.3223s/iter; left time: 12015.0284s
	iters: 400, epoch: 10 | loss: 0.0000840
	speed: 0.3245s/iter; left time: 12065.7554s
Epoch: 10 cost time: 133.7561388015747
Epoch: 10, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.135 Vali Acc: 0.979 Test Loss: 0.135 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000318
	speed: 0.6555s/iter; left time: 24298.2596s
	iters: 200, epoch: 11 | loss: 0.0001924
	speed: 0.3585s/iter; left time: 13253.6871s
	iters: 300, epoch: 11 | loss: 0.3961386
	speed: 0.3457s/iter; left time: 12744.9503s
	iters: 400, epoch: 11 | loss: 0.0000892
	speed: 0.3259s/iter; left time: 11983.1787s
Epoch: 11 cost time: 140.46656703948975
Epoch: 11, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.130 Vali Acc: 0.976 Test Loss: 0.130 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000257
	speed: 0.6592s/iter; left time: 24166.5585s
	iters: 200, epoch: 12 | loss: 0.0016436
	speed: 0.3195s/iter; left time: 11680.5973s
	iters: 300, epoch: 12 | loss: 0.0016332
	speed: 0.3174s/iter; left time: 11570.9101s
	iters: 400, epoch: 12 | loss: 0.0216536
	speed: 0.3200s/iter; left time: 11634.0949s
Epoch: 12 cost time: 132.7862696647644
Epoch: 12, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.152 Vali Acc: 0.975 Test Loss: 0.152 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0004607
	speed: 0.6593s/iter; left time: 23895.3659s
	iters: 200, epoch: 13 | loss: 0.0000011
	speed: 0.3170s/iter; left time: 11457.4545s
	iters: 300, epoch: 13 | loss: 0.0002146
	speed: 0.3213s/iter; left time: 11581.5088s
	iters: 400, epoch: 13 | loss: 0.0000226
	speed: 0.3177s/iter; left time: 11420.7012s
Epoch: 13 cost time: 132.7626974582672
Epoch: 13, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.6467908
	speed: 0.6490s/iter; left time: 23255.7488s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.3241s/iter; left time: 11581.5055s
	iters: 300, epoch: 14 | loss: 0.0003191
	speed: 0.3262s/iter; left time: 11623.6643s
	iters: 400, epoch: 14 | loss: 0.0000012
	speed: 0.3217s/iter; left time: 11429.4468s
Epoch: 14 cost time: 134.87787771224976
Epoch: 14, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.126 Vali Acc: 0.981 Test Loss: 0.126 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000058
	speed: 0.6449s/iter; left time: 22842.7024s
	iters: 200, epoch: 15 | loss: 0.0002397
	speed: 0.3132s/iter; left time: 11061.7796s
	iters: 300, epoch: 15 | loss: 0.0000006
	speed: 0.3255s/iter; left time: 11464.0062s
	iters: 400, epoch: 15 | loss: 0.0000005
	speed: 0.3270s/iter; left time: 11484.4752s
Epoch: 15 cost time: 133.16774654388428
Epoch: 15, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.153 Vali Acc: 0.976 Test Loss: 0.153 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0001782
	speed: 0.6383s/iter; left time: 22344.5148s
	iters: 200, epoch: 16 | loss: 0.0000061
	speed: 0.3225s/iter; left time: 11258.1939s
	iters: 300, epoch: 16 | loss: 0.0000007
	speed: 0.3304s/iter; left time: 11499.1822s
	iters: 400, epoch: 16 | loss: 0.0000388
	speed: 0.3216s/iter; left time: 11160.2212s
Epoch: 16 cost time: 134.43147134780884
Epoch: 16, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.113 Vali Acc: 0.979 Test Loss: 0.113 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0000377
	speed: 0.6541s/iter; left time: 22627.4618s
	iters: 200, epoch: 17 | loss: 0.0011955
	speed: 0.3251s/iter; left time: 11214.6056s
	iters: 300, epoch: 17 | loss: 0.0000123
	speed: 0.3306s/iter; left time: 11370.7058s
	iters: 400, epoch: 17 | loss: 0.0000180
	speed: 0.3251s/iter; left time: 11149.9305s
Epoch: 17 cost time: 135.24486660957336
Epoch: 17, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.160 Vali Acc: 0.978 Test Loss: 0.160 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.4380013
	speed: 0.6638s/iter; left time: 22689.5697s
	iters: 200, epoch: 18 | loss: 0.0000023
	speed: 0.3262s/iter; left time: 11115.2742s
	iters: 300, epoch: 18 | loss: 0.0000546
	speed: 0.3272s/iter; left time: 11117.0365s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.3176s/iter; left time: 10760.4647s
Epoch: 18 cost time: 134.57029342651367
Epoch: 18, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.177 Vali Acc: 0.979 Test Loss: 0.177 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df512_ma28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9831741700773079
model parameter : 1105162
model size : 9.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df512_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7336042
	speed: 0.3718s/iter; left time: 15317.0221s
	iters: 200, epoch: 1 | loss: 0.2667690
	speed: 0.3496s/iter; left time: 14369.9988s
	iters: 300, epoch: 1 | loss: 0.3479852
	speed: 0.3479s/iter; left time: 14264.0842s
	iters: 400, epoch: 1 | loss: 0.0775281
	speed: 0.3436s/iter; left time: 14052.7721s
Epoch: 1 cost time: 145.91217064857483
Epoch: 1, Steps: 413 | Train Loss: 0.616 Vali Loss: 0.107 Vali Acc: 0.961 Test Loss: 0.107 Test Acc: 0.961
Validation loss decreased (inf --> -0.960890).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0685392
	speed: 0.6839s/iter; left time: 27896.8210s
	iters: 200, epoch: 2 | loss: 0.0650720
	speed: 0.3311s/iter; left time: 13472.7299s
	iters: 300, epoch: 2 | loss: 0.4633227
	speed: 0.3368s/iter; left time: 13671.8709s
	iters: 400, epoch: 2 | loss: 0.0049079
	speed: 0.3476s/iter; left time: 14074.7434s
Epoch: 2 cost time: 140.60564589500427
Epoch: 2, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.960890 --> -0.976807).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0014809
	speed: 0.6412s/iter; left time: 25890.2874s
	iters: 200, epoch: 3 | loss: 0.3931093
	speed: 0.3024s/iter; left time: 12178.2739s
	iters: 300, epoch: 3 | loss: 0.0015190
	speed: 0.3080s/iter; left time: 12372.9876s
	iters: 400, epoch: 3 | loss: 0.0007990
	speed: 0.3142s/iter; left time: 12590.1466s
Epoch: 3 cost time: 128.52143454551697
Epoch: 3, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.068 Vali Acc: 0.978 Test Loss: 0.068 Test Acc: 0.978
Validation loss decreased (-0.976807 --> -0.977716).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0060198
	speed: 0.6208s/iter; left time: 24809.7399s
	iters: 200, epoch: 4 | loss: 0.2328599
	speed: 0.3193s/iter; left time: 12729.0703s
	iters: 300, epoch: 4 | loss: 0.0144924
	speed: 0.3297s/iter; left time: 13108.7688s
	iters: 400, epoch: 4 | loss: 0.0340735
	speed: 0.3317s/iter; left time: 13155.8629s
Epoch: 4 cost time: 134.59952235221863
Epoch: 4, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.067 Vali Acc: 0.978 Test Loss: 0.067 Test Acc: 0.978
Validation loss decreased (-0.977716 --> -0.977716).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1160978
	speed: 0.6359s/iter; left time: 25147.5598s
	iters: 200, epoch: 5 | loss: 0.0076836
	speed: 0.3145s/iter; left time: 12406.0517s
	iters: 300, epoch: 5 | loss: 0.0044134
	speed: 0.3249s/iter; left time: 12782.6536s
	iters: 400, epoch: 5 | loss: 0.0001933
	speed: 0.3224s/iter; left time: 12652.2476s
Epoch: 5 cost time: 132.12406849861145
Epoch: 5, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.156 Vali Acc: 0.963 Test Loss: 0.156 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0190589
	speed: 0.6183s/iter; left time: 24198.5496s
	iters: 200, epoch: 6 | loss: 0.0537410
	speed: 0.3064s/iter; left time: 11961.2239s
	iters: 300, epoch: 6 | loss: 0.0160977
	speed: 0.3233s/iter; left time: 12587.3135s
	iters: 400, epoch: 6 | loss: 0.0020521
	speed: 0.3268s/iter; left time: 12692.8099s
Epoch: 6 cost time: 131.76089715957642
Epoch: 6, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0028021
	speed: 0.6844s/iter; left time: 26503.8254s
	iters: 200, epoch: 7 | loss: 0.0002308
	speed: 0.3442s/iter; left time: 13292.9525s
	iters: 300, epoch: 7 | loss: 0.0044697
	speed: 0.3401s/iter; left time: 13100.8843s
	iters: 400, epoch: 7 | loss: 0.0007012
	speed: 0.3282s/iter; left time: 12609.3098s
Epoch: 7 cost time: 139.9210865497589
Epoch: 7, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.160 Vali Acc: 0.966 Test Loss: 0.160 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000082
	speed: 0.6443s/iter; left time: 24683.2223s
	iters: 200, epoch: 8 | loss: 0.0000151
	speed: 0.3195s/iter; left time: 12207.0608s
	iters: 300, epoch: 8 | loss: 0.0000044
	speed: 0.3289s/iter; left time: 12533.9444s
	iters: 400, epoch: 8 | loss: 0.0037738
	speed: 0.3372s/iter; left time: 12815.8880s
Epoch: 8 cost time: 135.36173343658447
Epoch: 8, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0750473
	speed: 0.6815s/iter; left time: 25827.4676s
	iters: 200, epoch: 9 | loss: 0.0017612
	speed: 0.3385s/iter; left time: 12794.9490s
	iters: 300, epoch: 9 | loss: 0.0569313
	speed: 0.3412s/iter; left time: 12861.3499s
	iters: 400, epoch: 9 | loss: 0.0153939
	speed: 0.3250s/iter; left time: 12220.3923s
Epoch: 9 cost time: 138.7195212841034
Epoch: 9, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.157 Vali Acc: 0.967 Test Loss: 0.157 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0006469
	speed: 0.6401s/iter; left time: 23994.7211s
	iters: 200, epoch: 10 | loss: 0.0000303
	speed: 0.3175s/iter; left time: 11867.7207s
	iters: 300, epoch: 10 | loss: 0.0005235
	speed: 0.3182s/iter; left time: 11862.2357s
	iters: 400, epoch: 10 | loss: 0.0006728
	speed: 0.3200s/iter; left time: 11899.3043s
Epoch: 10 cost time: 132.06685495376587
Epoch: 10, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.162 Vali Acc: 0.969 Test Loss: 0.162 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000054
	speed: 0.6693s/iter; left time: 24812.6796s
	iters: 200, epoch: 11 | loss: 0.0001627
	speed: 0.3294s/iter; left time: 12179.0819s
	iters: 300, epoch: 11 | loss: 0.0000061
	speed: 0.3309s/iter; left time: 12201.6905s
	iters: 400, epoch: 11 | loss: 0.0961732
	speed: 0.3295s/iter; left time: 12114.5160s
Epoch: 11 cost time: 137.35577535629272
Epoch: 11, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
Validation loss decreased (-0.977716 --> -0.981354).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000062
	speed: 0.6727s/iter; left time: 24658.3084s
	iters: 200, epoch: 12 | loss: 0.0002592
	speed: 0.3310s/iter; left time: 12099.5337s
	iters: 300, epoch: 12 | loss: 0.0000013
	speed: 0.3411s/iter; left time: 12435.5729s
	iters: 400, epoch: 12 | loss: 0.0000534
	speed: 0.3302s/iter; left time: 12004.2397s
Epoch: 12 cost time: 138.69224977493286
Epoch: 12, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.158 Vali Acc: 0.972 Test Loss: 0.158 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.1595329
	speed: 0.6649s/iter; left time: 24099.4386s
	iters: 200, epoch: 13 | loss: 0.0017798
	speed: 0.3370s/iter; left time: 12182.1171s
	iters: 300, epoch: 13 | loss: 0.0000113
	speed: 0.3367s/iter; left time: 12135.4668s
	iters: 400, epoch: 13 | loss: 0.0000116
	speed: 0.3390s/iter; left time: 12184.8881s
Epoch: 13 cost time: 139.99436855316162
Epoch: 13, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.145 Vali Acc: 0.984 Test Loss: 0.145 Test Acc: 0.984
Validation loss decreased (-0.981354 --> -0.984082).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.2124325
	speed: 0.6596s/iter; left time: 23636.5367s
	iters: 200, epoch: 14 | loss: 0.0352379
	speed: 0.3514s/iter; left time: 12555.2497s
	iters: 300, epoch: 14 | loss: 0.0000002
	speed: 0.3336s/iter; left time: 11887.8908s
	iters: 400, epoch: 14 | loss: 0.0000227
	speed: 0.3469s/iter; left time: 12327.1978s
Epoch: 14 cost time: 140.41408133506775
Epoch: 14, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.179 Vali Acc: 0.975 Test Loss: 0.179 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000026
	speed: 0.6997s/iter; left time: 24781.0162s
	iters: 200, epoch: 15 | loss: 0.0000024
	speed: 0.3636s/iter; left time: 12840.8058s
	iters: 300, epoch: 15 | loss: 0.0000167
	speed: 0.3478s/iter; left time: 12247.5787s
	iters: 400, epoch: 15 | loss: 0.0000459
	speed: 0.3552s/iter; left time: 12475.5716s
Epoch: 15 cost time: 147.52208852767944
Epoch: 15, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.112 Vali Acc: 0.979 Test Loss: 0.112 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000068
	speed: 0.7172s/iter; left time: 25104.5928s
	iters: 200, epoch: 16 | loss: 0.0019044
	speed: 0.3444s/iter; left time: 12021.6902s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.3308s/iter; left time: 11515.2398s
	iters: 400, epoch: 16 | loss: 0.0000135
	speed: 0.3405s/iter; left time: 11817.0548s
Epoch: 16 cost time: 141.15231132507324
Epoch: 16, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.131 Vali Acc: 0.978 Test Loss: 0.131 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0000009
	speed: 0.7774s/iter; left time: 26893.1420s
	iters: 200, epoch: 17 | loss: 0.0000010
	speed: 0.4069s/iter; left time: 14034.8303s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.4069s/iter; left time: 13995.6350s
	iters: 400, epoch: 17 | loss: 0.0000106
	speed: 0.4416s/iter; left time: 15143.7892s
Epoch: 17 cost time: 172.27761030197144
Epoch: 17, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.121 Vali Acc: 0.983 Test Loss: 0.121 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000001
	speed: 0.8753s/iter; left time: 29918.4679s
	iters: 200, epoch: 18 | loss: 0.0005552
	speed: 0.4284s/iter; left time: 14599.9834s
	iters: 300, epoch: 18 | loss: 0.0266613
	speed: 0.4370s/iter; left time: 14848.9644s
	iters: 400, epoch: 18 | loss: 0.0013481
	speed: 0.4327s/iter; left time: 14660.9138s
Epoch: 18 cost time: 178.0225670337677
Epoch: 18, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.168 Vali Acc: 0.971 Test Loss: 0.168 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0002612
	speed: 0.9151s/iter; left time: 30900.7579s
	iters: 200, epoch: 19 | loss: 0.0000255
	speed: 0.4721s/iter; left time: 15893.1156s
	iters: 300, epoch: 19 | loss: 0.0007947
	speed: 0.5077s/iter; left time: 17041.1626s
	iters: 400, epoch: 19 | loss: 0.0000132
	speed: 0.5514s/iter; left time: 18452.5888s
Epoch: 19 cost time: 206.53566098213196
Epoch: 19, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.130 Vali Acc: 0.982 Test Loss: 0.130 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0000091
	speed: 1.1108s/iter; left time: 37048.3409s
	iters: 200, epoch: 20 | loss: 0.0000005
	speed: 0.5351s/iter; left time: 17793.0582s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.5138s/iter; left time: 17035.5729s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.5270s/iter; left time: 17420.2734s
Epoch: 20 cost time: 219.8297803401947
Epoch: 20, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.173 Vali Acc: 0.975 Test Loss: 0.173 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0000013
	speed: 1.0886s/iter; left time: 35859.6711s
	iters: 200, epoch: 21 | loss: 0.0016912
	speed: 0.5100s/iter; left time: 16748.8669s
	iters: 300, epoch: 21 | loss: 0.0000003
	speed: 0.5394s/iter; left time: 17661.2991s
	iters: 400, epoch: 21 | loss: 0.0044148
	speed: 0.5065s/iter; left time: 16533.3437s
Epoch: 21 cost time: 216.42416954040527
Epoch: 21, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0000003
	speed: 1.0038s/iter; left time: 32650.1867s
	iters: 200, epoch: 22 | loss: 0.0645292
	speed: 0.5167s/iter; left time: 16756.0339s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.4890s/iter; left time: 15807.8422s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.5038s/iter; left time: 16235.2075s
Epoch: 22 cost time: 207.75946187973022
Epoch: 22, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.169 Vali Acc: 0.973 Test Loss: 0.169 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0009531
	speed: 1.0865s/iter; left time: 34892.4985s
	iters: 200, epoch: 23 | loss: 0.0000126
	speed: 0.4991s/iter; left time: 15977.3667s
	iters: 300, epoch: 23 | loss: 0.0004351
	speed: 0.4851s/iter; left time: 15481.3695s
	iters: 400, epoch: 23 | loss: 0.0000001
	speed: 0.5361s/iter; left time: 17056.0426s
Epoch: 23 cost time: 211.01484894752502
Epoch: 23, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.285 Vali Acc: 0.969 Test Loss: 0.285 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df512_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9840836743974534
model parameter : 1105162
model size : 9.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df512_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.5046699
	speed: 0.5568s/iter; left time: 22942.3442s
	iters: 200, epoch: 1 | loss: 0.2469269
	speed: 0.5123s/iter; left time: 21055.0829s
	iters: 300, epoch: 1 | loss: 0.4814368
	speed: 0.4844s/iter; left time: 19862.3376s
	iters: 400, epoch: 1 | loss: 0.0819963
	speed: 0.4936s/iter; left time: 20189.7781s
Epoch: 1 cost time: 211.57913827896118
Epoch: 1, Steps: 413 | Train Loss: 0.754 Vali Loss: 0.106 Vali Acc: 0.963 Test Loss: 0.106 Test Acc: 0.963
Validation loss decreased (inf --> -0.963164).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0153665
	speed: 1.0552s/iter; left time: 43040.4889s
	iters: 200, epoch: 2 | loss: 0.1077380
	speed: 0.5263s/iter; left time: 21412.1122s
	iters: 300, epoch: 2 | loss: 0.4590436
	speed: 0.5149s/iter; left time: 20896.9196s
	iters: 400, epoch: 2 | loss: 0.0429507
	speed: 0.5032s/iter; left time: 20373.5903s
Epoch: 2 cost time: 213.88928604125977
Epoch: 2, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.097 Vali Acc: 0.972 Test Loss: 0.097 Test Acc: 0.972
Validation loss decreased (-0.963164 --> -0.972259).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0277129
	speed: 1.1013s/iter; left time: 44466.1330s
	iters: 200, epoch: 3 | loss: 0.0830752
	speed: 0.5334s/iter; left time: 21481.5940s
	iters: 300, epoch: 3 | loss: 0.0056537
	speed: 0.5355s/iter; left time: 21512.9433s
	iters: 400, epoch: 3 | loss: 0.0152845
	speed: 0.5412s/iter; left time: 21687.4786s
Epoch: 3 cost time: 225.03244543075562
Epoch: 3, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.077 Vali Acc: 0.974 Test Loss: 0.077 Test Acc: 0.974
Validation loss decreased (-0.972259 --> -0.974078).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0088363
	speed: 1.1014s/iter; left time: 44012.8476s
	iters: 200, epoch: 4 | loss: 0.2431601
	speed: 0.5078s/iter; left time: 20240.7429s
	iters: 300, epoch: 4 | loss: 0.0886635
	speed: 0.5339s/iter; left time: 21227.6163s
	iters: 400, epoch: 4 | loss: 0.0065266
	speed: 0.5410s/iter; left time: 21457.2451s
Epoch: 4 cost time: 218.3764579296112
Epoch: 4, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
Validation loss decreased (-0.974078 --> -0.976352).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0031340
	speed: 1.2223s/iter; left time: 48340.4532s
	iters: 200, epoch: 5 | loss: 0.0024491
	speed: 0.5836s/iter; left time: 23023.4746s
	iters: 300, epoch: 5 | loss: 0.0024203
	speed: 0.6031s/iter; left time: 23730.4176s
	iters: 400, epoch: 5 | loss: 0.0011151
	speed: 0.5612s/iter; left time: 22026.2392s
Epoch: 5 cost time: 242.30150985717773
Epoch: 5, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.071 Vali Acc: 0.975 Test Loss: 0.071 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0028760
	speed: 1.2068s/iter; left time: 47229.9057s
	iters: 200, epoch: 6 | loss: 0.0000468
	speed: 0.5613s/iter; left time: 21911.1370s
	iters: 300, epoch: 6 | loss: 0.0003409
	speed: 0.5377s/iter; left time: 20937.7114s
	iters: 400, epoch: 6 | loss: 0.0042071
	speed: 0.5672s/iter; left time: 22027.9690s
Epoch: 6 cost time: 231.47318816184998
Epoch: 6, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.206 Vali Acc: 0.956 Test Loss: 0.206 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0009490
	speed: 1.1816s/iter; left time: 45754.1321s
	iters: 200, epoch: 7 | loss: 0.0000824
	speed: 0.5443s/iter; left time: 21021.2287s
	iters: 300, epoch: 7 | loss: 0.0003753
	speed: 0.5393s/iter; left time: 20776.1557s
	iters: 400, epoch: 7 | loss: 0.0003281
	speed: 0.5520s/iter; left time: 21210.6201s
Epoch: 7 cost time: 227.80204105377197
Epoch: 7, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.194 Vali Acc: 0.955 Test Loss: 0.194 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0004697
	speed: 1.1693s/iter; left time: 44793.9858s
	iters: 200, epoch: 8 | loss: 0.0004738
	speed: 0.5715s/iter; left time: 21837.1344s
	iters: 300, epoch: 8 | loss: 0.0010188
	speed: 0.5586s/iter; left time: 21288.3266s
	iters: 400, epoch: 8 | loss: 0.0950449
	speed: 0.5448s/iter; left time: 20706.6038s
Epoch: 8 cost time: 231.76518630981445
Epoch: 8, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.099 Vali Acc: 0.979 Test Loss: 0.099 Test Acc: 0.979
Validation loss decreased (-0.976352 --> -0.979080).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000237
	speed: 1.1881s/iter; left time: 45024.2151s
	iters: 200, epoch: 9 | loss: 0.0025032
	speed: 0.5934s/iter; left time: 22429.8030s
	iters: 300, epoch: 9 | loss: 0.1598566
	speed: 0.5689s/iter; left time: 21446.8496s
	iters: 400, epoch: 9 | loss: 0.0000070
	speed: 0.5985s/iter; left time: 22501.9324s
Epoch: 9 cost time: 241.94856238365173
Epoch: 9, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979080 --> -0.980445).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000588
	speed: 1.1923s/iter; left time: 44691.9464s
	iters: 200, epoch: 10 | loss: 0.0001904
	speed: 0.5645s/iter; left time: 21103.1725s
	iters: 300, epoch: 10 | loss: 0.0002217
	speed: 0.5678s/iter; left time: 21168.4040s
	iters: 400, epoch: 10 | loss: 0.0004537
	speed: 0.5889s/iter; left time: 21897.1831s
Epoch: 10 cost time: 238.2190454006195
Epoch: 10, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.120 Vali Acc: 0.976 Test Loss: 0.120 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000001
	speed: 1.1936s/iter; left time: 44248.8832s
	iters: 200, epoch: 11 | loss: 0.0042242
	speed: 0.5494s/iter; left time: 20312.8654s
	iters: 300, epoch: 11 | loss: 0.0000137
	speed: 0.6113s/iter; left time: 22538.2380s
	iters: 400, epoch: 11 | loss: 0.0000002
	speed: 0.6233s/iter; left time: 22921.1692s
Epoch: 11 cost time: 242.41392397880554
Epoch: 11, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.143 Vali Acc: 0.968 Test Loss: 0.143 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000009
	speed: 1.2133s/iter; left time: 44477.2276s
	iters: 200, epoch: 12 | loss: 0.0001713
	speed: 0.5538s/iter; left time: 20245.2120s
	iters: 300, epoch: 12 | loss: 0.0000003
	speed: 0.5548s/iter; left time: 20225.3013s
	iters: 400, epoch: 12 | loss: 0.0000021
	speed: 0.5672s/iter; left time: 20623.7828s
Epoch: 12 cost time: 234.89256286621094
Epoch: 12, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000141
	speed: 1.2666s/iter; left time: 45907.1264s
	iters: 200, epoch: 13 | loss: 0.0000020
	speed: 0.5978s/iter; left time: 21607.9120s
	iters: 300, epoch: 13 | loss: 0.0000002
	speed: 0.5914s/iter; left time: 21317.1338s
	iters: 400, epoch: 13 | loss: 0.2444441
	speed: 0.6093s/iter; left time: 21902.9215s
Epoch: 13 cost time: 247.87054896354675
Epoch: 13, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.139 Vali Acc: 0.975 Test Loss: 0.139 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000009
	speed: 1.2529s/iter; left time: 44894.4255s
	iters: 200, epoch: 14 | loss: 0.0000122
	speed: 0.5809s/iter; left time: 20757.5470s
	iters: 300, epoch: 14 | loss: 0.4436776
	speed: 0.5965s/iter; left time: 21254.7748s
	iters: 400, epoch: 14 | loss: 0.0003479
	speed: 0.6044s/iter; left time: 21474.3722s
Epoch: 14 cost time: 248.32249975204468
Epoch: 14, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.164 Vali Acc: 0.970 Test Loss: 0.164 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0040346
	speed: 1.3107s/iter; left time: 46425.0847s
	iters: 200, epoch: 15 | loss: 0.0072948
	speed: 0.6609s/iter; left time: 23342.7217s
	iters: 300, epoch: 15 | loss: 0.0000010
	speed: 0.6285s/iter; left time: 22133.4027s
	iters: 400, epoch: 15 | loss: 0.0037243
	speed: 0.5576s/iter; left time: 19581.2121s
Epoch: 15 cost time: 256.1911289691925
Epoch: 15, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.185 Vali Acc: 0.966 Test Loss: 0.185 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0000092
	speed: 1.2423s/iter; left time: 43487.1932s
	iters: 200, epoch: 16 | loss: 0.0000001
	speed: 0.5961s/iter; left time: 20808.5740s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.5924s/iter; left time: 20618.2509s
	iters: 400, epoch: 16 | loss: 0.0001341
	speed: 0.6105s/iter; left time: 21188.6681s
Epoch: 16 cost time: 248.75235509872437
Epoch: 16, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0000010
	speed: 1.2527s/iter; left time: 43335.6955s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.5971s/iter; left time: 20594.3960s
	iters: 300, epoch: 17 | loss: 0.1434707
	speed: 0.6072s/iter; left time: 20884.7665s
	iters: 400, epoch: 17 | loss: 0.0025950
	speed: 0.6076s/iter; left time: 20836.3460s
Epoch: 17 cost time: 248.4935257434845
Epoch: 17, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.131 Vali Acc: 0.978 Test Loss: 0.131 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0000189
	speed: 1.2310s/iter; left time: 42076.9853s
	iters: 200, epoch: 18 | loss: 0.0001620
	speed: 0.5716s/iter; left time: 19480.9785s
	iters: 300, epoch: 18 | loss: 0.0000249
	speed: 0.6275s/iter; left time: 21321.8370s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.6154s/iter; left time: 20848.5853s
Epoch: 18 cost time: 248.56343483924866
Epoch: 18, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.129 Vali Acc: 0.979 Test Loss: 0.129 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000073
	speed: 1.3110s/iter; left time: 44267.7750s
	iters: 200, epoch: 19 | loss: 0.0200015
	speed: 0.5481s/iter; left time: 18453.3510s
	iters: 300, epoch: 19 | loss: 0.0012123
	speed: 0.5958s/iter; left time: 19999.4389s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.6148s/iter; left time: 20575.8066s
Epoch: 19 cost time: 247.0287380218506
Epoch: 19, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df512_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9804456571168713
model parameter : 1105162
model size : 9.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.5942498
	speed: 0.6181s/iter; left time: 25465.4867s
	iters: 200, epoch: 1 | loss: 0.2262262
	speed: 0.5558s/iter; left time: 22842.2110s
	iters: 300, epoch: 1 | loss: 0.5266638
	speed: 0.5441s/iter; left time: 22306.9595s
	iters: 400, epoch: 1 | loss: 0.0497550
	speed: 0.6376s/iter; left time: 26079.7291s
Epoch: 1 cost time: 243.91283345222473
Epoch: 1, Steps: 413 | Train Loss: 0.798 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
Validation loss decreased (inf --> -0.964983).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0097487
	speed: 1.2993s/iter; left time: 52995.9664s
	iters: 200, epoch: 2 | loss: 0.1367857
	speed: 0.5858s/iter; left time: 23834.1996s
	iters: 300, epoch: 2 | loss: 0.1767216
	speed: 0.6217s/iter; left time: 25231.7034s
	iters: 400, epoch: 2 | loss: 0.0111776
	speed: 0.5828s/iter; left time: 23598.2339s
Epoch: 2 cost time: 249.77155923843384
Epoch: 2, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.108 Vali Acc: 0.962 Test Loss: 0.108 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0038549
	speed: 1.1797s/iter; left time: 47630.5064s
	iters: 200, epoch: 3 | loss: 0.0094363
	speed: 0.5755s/iter; left time: 23180.2035s
	iters: 300, epoch: 3 | loss: 0.0366199
	speed: 0.5703s/iter; left time: 22911.1045s
	iters: 400, epoch: 3 | loss: 0.0292275
	speed: 0.6339s/iter; left time: 25402.2349s
Epoch: 3 cost time: 242.52205729484558
Epoch: 3, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
Validation loss decreased (-0.964983 --> -0.970440).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0034687
	speed: 1.2092s/iter; left time: 48322.0767s
	iters: 200, epoch: 4 | loss: 0.0297745
	speed: 0.5840s/iter; left time: 23277.8561s
	iters: 300, epoch: 4 | loss: 0.1962652
	speed: 0.5593s/iter; left time: 22238.5346s
	iters: 400, epoch: 4 | loss: 0.1852051
	speed: 0.5869s/iter; left time: 23278.0327s
Epoch: 4 cost time: 239.27728652954102
Epoch: 4, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0093647
	speed: 1.2747s/iter; left time: 50413.1422s
	iters: 200, epoch: 5 | loss: 0.0078689
	speed: 0.5975s/iter; left time: 23570.8201s
	iters: 300, epoch: 5 | loss: 0.0558186
	speed: 0.5756s/iter; left time: 22651.0163s
	iters: 400, epoch: 5 | loss: 0.0240870
	speed: 0.5679s/iter; left time: 22289.3574s
Epoch: 5 cost time: 243.3537049293518
Epoch: 5, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0007049
	speed: 1.1846s/iter; left time: 46360.2915s
	iters: 200, epoch: 6 | loss: 0.2013532
	speed: 0.6084s/iter; left time: 23750.0398s
	iters: 300, epoch: 6 | loss: 0.0031876
	speed: 0.5977s/iter; left time: 23270.3576s
	iters: 400, epoch: 6 | loss: 0.0007365
	speed: 0.6239s/iter; left time: 24228.2426s
Epoch: 6 cost time: 248.24257850646973
Epoch: 6, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.152 Vali Acc: 0.967 Test Loss: 0.152 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0100362
	speed: 1.3279s/iter; left time: 51421.6955s
	iters: 200, epoch: 7 | loss: 0.0000113
	speed: 0.6328s/iter; left time: 24442.0726s
	iters: 300, epoch: 7 | loss: 0.0210444
	speed: 0.5653s/iter; left time: 21778.3308s
	iters: 400, epoch: 7 | loss: 0.0035271
	speed: 0.5634s/iter; left time: 21648.9630s
Epoch: 7 cost time: 246.38963866233826
Epoch: 7, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.180 Vali Acc: 0.965 Test Loss: 0.180 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0027033
	speed: 1.1891s/iter; left time: 45554.4246s
	iters: 200, epoch: 8 | loss: 0.0001018
	speed: 0.5881s/iter; left time: 22469.9405s
	iters: 300, epoch: 8 | loss: 0.0101633
	speed: 0.5885s/iter; left time: 22426.5535s
	iters: 400, epoch: 8 | loss: 0.0112590
	speed: 0.5599s/iter; left time: 21282.2669s
Epoch: 8 cost time: 242.34575819969177
Epoch: 8, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0016938
	speed: 1.2731s/iter; left time: 48244.9791s
	iters: 200, epoch: 9 | loss: 0.2789141
	speed: 0.5729s/iter; left time: 21654.6309s
	iters: 300, epoch: 9 | loss: 0.0268272
	speed: 0.6026s/iter; left time: 22717.4162s
	iters: 400, epoch: 9 | loss: 0.1746885
	speed: 0.5918s/iter; left time: 22248.2130s
Epoch: 9 cost time: 248.38541960716248
Epoch: 9, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.160 Vali Acc: 0.968 Test Loss: 0.160 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.2348969
	speed: 1.1995s/iter; left time: 44960.3993s
	iters: 200, epoch: 10 | loss: 0.0001084
	speed: 0.5897s/iter; left time: 22044.2353s
	iters: 300, epoch: 10 | loss: 0.0004959
	speed: 0.6255s/iter; left time: 23319.9627s
	iters: 400, epoch: 10 | loss: 0.0002613
	speed: 0.6222s/iter; left time: 23137.1751s
Epoch: 10 cost time: 249.89770531654358
Epoch: 10, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.210 Vali Acc: 0.965 Test Loss: 0.210 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0051315
	speed: 1.2618s/iter; left time: 46774.8705s
	iters: 200, epoch: 11 | loss: 0.0000484
	speed: 0.5606s/iter; left time: 20725.1223s
	iters: 300, epoch: 11 | loss: 0.2812702
	speed: 0.5583s/iter; left time: 20583.4403s
	iters: 400, epoch: 11 | loss: 0.0000010
	speed: 0.5797s/iter; left time: 21317.1104s
Epoch: 11 cost time: 235.68976712226868
Epoch: 11, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
Validation loss decreased (-0.970440 --> -0.974533).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000027
	speed: 1.1898s/iter; left time: 43614.1832s
	iters: 200, epoch: 12 | loss: 0.0000153
	speed: 0.5827s/iter; left time: 21303.8332s
	iters: 300, epoch: 12 | loss: 0.0001972
	speed: 0.6087s/iter; left time: 22190.9690s
	iters: 400, epoch: 12 | loss: 0.0000003
	speed: 0.6462s/iter; left time: 23495.5153s
Epoch: 12 cost time: 250.405047416687
Epoch: 12, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.220 Vali Acc: 0.968 Test Loss: 0.220 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000002
	speed: 1.2453s/iter; left time: 45134.3899s
	iters: 200, epoch: 13 | loss: 0.0022730
	speed: 0.5969s/iter; left time: 21573.2784s
	iters: 300, epoch: 13 | loss: 0.1943516
	speed: 0.5442s/iter; left time: 19614.0141s
	iters: 400, epoch: 13 | loss: 0.0032432
	speed: 0.5585s/iter; left time: 20076.5636s
Epoch: 13 cost time: 234.9514274597168
Epoch: 13, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.242 Vali Acc: 0.966 Test Loss: 0.242 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000003
	speed: 1.1014s/iter; left time: 39463.6473s
	iters: 200, epoch: 14 | loss: 0.0808940
	speed: 0.5111s/iter; left time: 18261.4137s
	iters: 300, epoch: 14 | loss: 0.0000509
	speed: 0.5652s/iter; left time: 20137.9879s
	iters: 400, epoch: 14 | loss: 0.0000228
	speed: 0.6233s/iter; left time: 22148.5471s
Epoch: 14 cost time: 231.85199356079102
Epoch: 14, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.154 Vali Acc: 0.972 Test Loss: 0.154 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000001
	speed: 1.1150s/iter; left time: 39492.8600s
	iters: 200, epoch: 15 | loss: 0.0000666
	speed: 0.5980s/iter; left time: 21120.7991s
	iters: 300, epoch: 15 | loss: 0.0000020
	speed: 0.5705s/iter; left time: 20092.3339s
	iters: 400, epoch: 15 | loss: 0.0002542
	speed: 0.5555s/iter; left time: 19508.8020s
Epoch: 15 cost time: 234.05423879623413
Epoch: 15, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.279 Vali Acc: 0.962 Test Loss: 0.279 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000023
	speed: 1.1389s/iter; left time: 39867.5144s
	iters: 200, epoch: 16 | loss: 0.0000048
	speed: 0.5302s/iter; left time: 18505.5261s
	iters: 300, epoch: 16 | loss: 0.0000131
	speed: 0.5159s/iter; left time: 17955.7483s
	iters: 400, epoch: 16 | loss: 0.0046551
	speed: 0.5477s/iter; left time: 19007.7080s
Epoch: 16 cost time: 221.63373827934265
Epoch: 16, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.129 Vali Acc: 0.981 Test Loss: 0.129 Test Acc: 0.981
Validation loss decreased (-0.974533 --> -0.980899).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 1.1503s/iter; left time: 39790.8035s
	iters: 200, epoch: 17 | loss: 0.0005948
	speed: 0.5741s/iter; left time: 19802.6143s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.5905s/iter; left time: 20309.3368s
	iters: 400, epoch: 17 | loss: 0.0000001
	speed: 0.5825s/iter; left time: 19976.7889s
Epoch: 17 cost time: 238.00427174568176
Epoch: 17, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.137 Vali Acc: 0.975 Test Loss: 0.137 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000001
	speed: 1.1428s/iter; left time: 39062.4736s
	iters: 200, epoch: 18 | loss: 0.0007337
	speed: 0.5424s/iter; left time: 18484.4549s
	iters: 300, epoch: 18 | loss: 0.0000001
	speed: 0.5612s/iter; left time: 19068.4584s
	iters: 400, epoch: 18 | loss: 0.0001598
	speed: 0.5484s/iter; left time: 18579.3608s
Epoch: 18 cost time: 231.0089030265808
Epoch: 18, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0001292
	speed: 1.2146s/iter; left time: 41013.3996s
	iters: 200, epoch: 19 | loss: 0.0000003
	speed: 0.5906s/iter; left time: 19884.7229s
	iters: 300, epoch: 19 | loss: 0.8447732
	speed: 0.5983s/iter; left time: 20082.9747s
	iters: 400, epoch: 19 | loss: 0.0001268
	speed: 0.6176s/iter; left time: 20670.7488s
Epoch: 19 cost time: 247.95230174064636
Epoch: 19, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.150 Vali Acc: 0.980 Test Loss: 0.150 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000024
	speed: 1.1892s/iter; left time: 39663.9564s
	iters: 200, epoch: 20 | loss: 0.0000001
	speed: 0.5649s/iter; left time: 18784.7808s
	iters: 300, epoch: 20 | loss: 0.0000002
	speed: 0.5563s/iter; left time: 18443.1755s
	iters: 400, epoch: 20 | loss: 0.0013904
	speed: 0.5544s/iter; left time: 18324.7415s
Epoch: 20 cost time: 231.8594253063202
Epoch: 20, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.143 Vali Acc: 0.975 Test Loss: 0.143 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0001160
	speed: 1.1783s/iter; left time: 38815.4556s
	iters: 200, epoch: 21 | loss: 0.0001168
	speed: 0.5840s/iter; left time: 19178.5470s
	iters: 300, epoch: 21 | loss: 0.0000037
	speed: 0.6201s/iter; left time: 20301.3356s
	iters: 400, epoch: 21 | loss: 0.0834554
	speed: 0.5999s/iter; left time: 19580.0322s
Epoch: 21 cost time: 246.24283146858215
Epoch: 21, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.324 Vali Acc: 0.950 Test Loss: 0.324 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0000006
	speed: 1.2153s/iter; left time: 39530.9750s
	iters: 200, epoch: 22 | loss: 0.0000063
	speed: 0.5811s/iter; left time: 18845.5225s
	iters: 300, epoch: 22 | loss: 0.0097314
	speed: 0.5489s/iter; left time: 17743.6923s
	iters: 400, epoch: 22 | loss: 0.0000040
	speed: 0.6001s/iter; left time: 19338.6005s
Epoch: 22 cost time: 238.98973941802979
Epoch: 22, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.215 Vali Acc: 0.972 Test Loss: 0.215 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 1.2161s/iter; left time: 39053.7930s
	iters: 200, epoch: 23 | loss: 0.0107343
	speed: 0.6230s/iter; left time: 19945.6519s
	iters: 300, epoch: 23 | loss: 0.0207334
	speed: 0.6204s/iter; left time: 19798.7683s
	iters: 400, epoch: 23 | loss: 0.0000721
	speed: 0.6429s/iter; left time: 20454.6675s
Epoch: 23 cost time: 256.6002495288849
Epoch: 23, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.151 Vali Acc: 0.976 Test Loss: 0.151 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0000011
	speed: 1.2235s/iter; left time: 38788.5370s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.5666s/iter; left time: 17907.1945s
	iters: 300, epoch: 24 | loss: 0.0000007
	speed: 0.6062s/iter; left time: 19096.7143s
	iters: 400, epoch: 24 | loss: 0.0064749
	speed: 0.6170s/iter; left time: 19375.6191s
Epoch: 24 cost time: 246.3302173614502
Epoch: 24, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.114 Vali Acc: 0.983 Test Loss: 0.114 Test Acc: 0.983
Validation loss decreased (-0.980899 --> -0.982718).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0004772
	speed: 1.2734s/iter; left time: 39842.7651s
	iters: 200, epoch: 25 | loss: 0.0000001
	speed: 0.6225s/iter; left time: 19416.2789s
	iters: 300, epoch: 25 | loss: 0.0000012
	speed: 0.6783s/iter; left time: 21086.4151s
	iters: 400, epoch: 25 | loss: 0.0000651
	speed: 0.6698s/iter; left time: 20755.5950s
Epoch: 25 cost time: 265.5842180252075
Epoch: 25, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.167 Vali Acc: 0.978 Test Loss: 0.167 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0000013
	speed: 1.3345s/iter; left time: 41204.3884s
	iters: 200, epoch: 26 | loss: 0.0000001
	speed: 0.6272s/iter; left time: 19302.6922s
	iters: 300, epoch: 26 | loss: 0.0000006
	speed: 0.5970s/iter; left time: 18313.1556s
	iters: 400, epoch: 26 | loss: 0.0000003
	speed: 0.6400s/iter; left time: 19569.0445s
Epoch: 26 cost time: 260.6733627319336
Epoch: 26, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.109 Vali Acc: 0.982 Test Loss: 0.109 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0001095
	speed: 1.3087s/iter; left time: 39866.3679s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.6007s/iter; left time: 18238.6914s
	iters: 300, epoch: 27 | loss: 0.0265962
	speed: 0.5790s/iter; left time: 17522.7518s
	iters: 400, epoch: 27 | loss: 0.0000006
	speed: 0.6140s/iter; left time: 18520.3184s
Epoch: 27 cost time: 249.91804814338684
Epoch: 27, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.1260010
	speed: 1.2393s/iter; left time: 37240.2966s
	iters: 200, epoch: 28 | loss: 0.0212067
	speed: 0.5804s/iter; left time: 17382.9717s
	iters: 300, epoch: 28 | loss: 0.0000171
	speed: 0.6121s/iter; left time: 18271.4033s
	iters: 400, epoch: 28 | loss: 0.0005627
	speed: 0.5568s/iter; left time: 16564.9118s
Epoch: 28 cost time: 241.19148588180542
Epoch: 28, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.131 Vali Acc: 0.977 Test Loss: 0.131 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0000002
	speed: 1.2544s/iter; left time: 37177.1168s
	iters: 200, epoch: 29 | loss: 0.0000009
	speed: 0.6012s/iter; left time: 17758.7300s
	iters: 300, epoch: 29 | loss: 0.0013431
	speed: 0.5752s/iter; left time: 16932.7983s
	iters: 400, epoch: 29 | loss: 0.0000018
	speed: 0.6285s/iter; left time: 18438.2237s
Epoch: 29 cost time: 249.77930760383606
Epoch: 29, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.158 Vali Acc: 0.977 Test Loss: 0.158 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0000006
	speed: 1.2638s/iter; left time: 36932.2334s
	iters: 200, epoch: 30 | loss: 0.0000001
	speed: 0.5893s/iter; left time: 17161.9355s
	iters: 300, epoch: 30 | loss: 0.0000014
	speed: 0.6173s/iter; left time: 17916.4029s
	iters: 400, epoch: 30 | loss: 0.0004547
	speed: 0.6301s/iter; left time: 18224.0547s
Epoch: 30 cost time: 252.76965928077698
Epoch: 30, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.139 Vali Acc: 0.978 Test Loss: 0.139 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.0005993
	speed: 1.3078s/iter; left time: 37679.9980s
	iters: 200, epoch: 31 | loss: 0.0000002
	speed: 0.6030s/iter; left time: 17311.3830s
	iters: 300, epoch: 31 | loss: 0.0000014
	speed: 0.6003s/iter; left time: 17174.8426s
	iters: 400, epoch: 31 | loss: 0.0000482
	speed: 0.6187s/iter; left time: 17638.5108s
Epoch: 31 cost time: 249.1749403476715
Epoch: 31, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.224 Vali Acc: 0.966 Test Loss: 0.224 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.0000766
	speed: 1.3677s/iter; left time: 38838.9193s
	iters: 200, epoch: 32 | loss: 0.0005543
	speed: 0.6696s/iter; left time: 18948.8953s
	iters: 300, epoch: 32 | loss: 0.0000542
	speed: 0.6275s/iter; left time: 17693.4866s
	iters: 400, epoch: 32 | loss: 0.0000081
	speed: 0.6490s/iter; left time: 18236.5734s
Epoch: 32 cost time: 270.89883279800415
Epoch: 32, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.156 Vali Acc: 0.973 Test Loss: 0.156 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0000142
	speed: 1.1662s/iter; left time: 32635.2792s
	iters: 200, epoch: 33 | loss: 0.0431479
	speed: 0.5581s/iter; left time: 15562.3366s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.6006s/iter; left time: 16687.3691s
	iters: 400, epoch: 33 | loss: 0.0032548
	speed: 0.6160s/iter; left time: 17054.3146s
Epoch: 33 cost time: 240.51416206359863
Epoch: 33, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.189 Vali Acc: 0.974 Test Loss: 0.189 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.0000003
	speed: 1.3646s/iter; left time: 37624.7908s
	iters: 200, epoch: 34 | loss: 0.0053993
	speed: 0.6227s/iter; left time: 17105.7225s
	iters: 300, epoch: 34 | loss: 0.0002845
	speed: 0.6246s/iter; left time: 17095.1987s
	iters: 400, epoch: 34 | loss: 0.0000014
	speed: 0.6076s/iter; left time: 16569.4940s
Epoch: 34 cost time: 259.3704240322113
Epoch: 34, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.230 Vali Acc: 0.974 Test Loss: 0.230 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9827194179172352
model parameter : 1105162
model size : 9.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.4861662
	speed: 0.6311s/iter; left time: 26003.0171s
	iters: 200, epoch: 1 | loss: 0.2739065
	speed: 0.5725s/iter; left time: 23531.8334s
	iters: 300, epoch: 1 | loss: 0.4411999
	speed: 0.5959s/iter; left time: 24431.6231s
	iters: 400, epoch: 1 | loss: 0.0769942
	speed: 0.6190s/iter; left time: 25318.1033s
Epoch: 1 cost time: 250.8133897781372
Epoch: 1, Steps: 413 | Train Loss: 0.796 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
Validation loss decreased (inf --> -0.968166).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0729180
	speed: 1.3018s/iter; left time: 53095.8786s
	iters: 200, epoch: 2 | loss: 0.1092641
	speed: 0.6149s/iter; left time: 25018.6975s
	iters: 300, epoch: 2 | loss: 0.3395116
	speed: 0.6016s/iter; left time: 24416.4260s
	iters: 400, epoch: 2 | loss: 0.0126352
	speed: 0.5727s/iter; left time: 23187.2146s
Epoch: 2 cost time: 247.13473391532898
Epoch: 2, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0083807
	speed: 1.3791s/iter; left time: 55680.8974s
	iters: 200, epoch: 3 | loss: 0.1831095
	speed: 0.6365s/iter; left time: 25634.4671s
	iters: 300, epoch: 3 | loss: 0.0001325
	speed: 0.6248s/iter; left time: 25100.8526s
	iters: 400, epoch: 3 | loss: 0.0627362
	speed: 0.6397s/iter; left time: 25636.7685s
Epoch: 3 cost time: 269.0071976184845
Epoch: 3, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.968166 --> -0.972714).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0131760
	speed: 1.2944s/iter; left time: 51728.1345s
	iters: 200, epoch: 4 | loss: 1.2801584
	speed: 0.5508s/iter; left time: 21956.6417s
	iters: 300, epoch: 4 | loss: 0.4927196
	speed: 0.6041s/iter; left time: 24018.2832s
	iters: 400, epoch: 4 | loss: 0.0203723
	speed: 0.5832s/iter; left time: 23130.3860s
Epoch: 4 cost time: 240.71783566474915
Epoch: 4, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.061 Vali Acc: 0.980 Test Loss: 0.061 Test Acc: 0.980
Validation loss decreased (-0.972714 --> -0.979990).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0036341
	speed: 1.3028s/iter; left time: 51525.0640s
	iters: 200, epoch: 5 | loss: 0.0011167
	speed: 0.6472s/iter; left time: 25532.3215s
	iters: 300, epoch: 5 | loss: 0.0596723
	speed: 0.5927s/iter; left time: 23320.4069s
	iters: 400, epoch: 5 | loss: 0.0004582
	speed: 0.6196s/iter; left time: 24320.3225s
Epoch: 5 cost time: 257.6337158679962
Epoch: 5, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979990 --> -0.980445).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0029745
	speed: 1.3193s/iter; left time: 51630.4068s
	iters: 200, epoch: 6 | loss: 0.0035363
	speed: 0.6367s/iter; left time: 24854.0195s
	iters: 300, epoch: 6 | loss: 0.0002449
	speed: 0.6361s/iter; left time: 24768.2198s
	iters: 400, epoch: 6 | loss: 0.0532993
	speed: 0.6421s/iter; left time: 24936.1987s
Epoch: 6 cost time: 263.1037685871124
Epoch: 6, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.172 Vali Acc: 0.964 Test Loss: 0.172 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0002924
	speed: 1.2644s/iter; left time: 48962.1573s
	iters: 200, epoch: 7 | loss: 0.0009530
	speed: 0.6205s/iter; left time: 23967.4238s
	iters: 300, epoch: 7 | loss: 0.0025485
	speed: 0.6520s/iter; left time: 25116.4612s
	iters: 400, epoch: 7 | loss: 0.0068790
	speed: 0.6407s/iter; left time: 24616.1130s
Epoch: 7 cost time: 259.63751196861267
Epoch: 7, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.231 Vali Acc: 0.956 Test Loss: 0.231 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000143
	speed: 1.3956s/iter; left time: 53463.9500s
	iters: 200, epoch: 8 | loss: 0.0009935
	speed: 0.6440s/iter; left time: 24605.7284s
	iters: 300, epoch: 8 | loss: 0.0000589
	speed: 0.6106s/iter; left time: 23270.1698s
	iters: 400, epoch: 8 | loss: 0.0428021
	speed: 0.6097s/iter; left time: 23174.6305s
Epoch: 8 cost time: 263.21269512176514
Epoch: 8, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.121 Vali Acc: 0.971 Test Loss: 0.121 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0037498
	speed: 1.2947s/iter; left time: 49066.8344s
	iters: 200, epoch: 9 | loss: 0.0001327
	speed: 0.6807s/iter; left time: 25729.8914s
	iters: 300, epoch: 9 | loss: 0.0105866
	speed: 0.6342s/iter; left time: 23908.2544s
	iters: 400, epoch: 9 | loss: 0.0042718
	speed: 0.6878s/iter; left time: 25857.7255s
Epoch: 9 cost time: 275.7928001880646
Epoch: 9, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.134 Vali Acc: 0.972 Test Loss: 0.134 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0065293
	speed: 1.3624s/iter; left time: 51069.6656s
	iters: 200, epoch: 10 | loss: 0.3712740
	speed: 0.6088s/iter; left time: 22760.9585s
	iters: 300, epoch: 10 | loss: 0.0001002
	speed: 0.6733s/iter; left time: 25103.8327s
	iters: 400, epoch: 10 | loss: 0.0013726
	speed: 0.6894s/iter; left time: 25634.6709s
Epoch: 10 cost time: 270.3232510089874
Epoch: 10, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.150 Vali Acc: 0.975 Test Loss: 0.150 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000151
	speed: 1.4178s/iter; left time: 52558.8727s
	iters: 200, epoch: 11 | loss: 0.0000031
	speed: 0.6678s/iter; left time: 24687.8709s
	iters: 300, epoch: 11 | loss: 0.0004321
	speed: 0.6020s/iter; left time: 22197.2007s
	iters: 400, epoch: 11 | loss: 0.0000513
	speed: 0.6048s/iter; left time: 22240.4277s
Epoch: 11 cost time: 263.64739322662354
Epoch: 11, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.178 Vali Acc: 0.965 Test Loss: 0.178 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000003
	speed: 1.4352s/iter; left time: 52612.9158s
	iters: 200, epoch: 12 | loss: 0.0022063
	speed: 0.7217s/iter; left time: 26382.4421s
	iters: 300, epoch: 12 | loss: 0.0000931
	speed: 0.6369s/iter; left time: 23221.2775s
	iters: 400, epoch: 12 | loss: 0.0000340
	speed: 0.6146s/iter; left time: 22344.7994s
Epoch: 12 cost time: 277.09570837020874
Epoch: 12, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.183 Vali Acc: 0.966 Test Loss: 0.183 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0006131
	speed: 1.4408s/iter; left time: 52220.6866s
	iters: 200, epoch: 13 | loss: 0.0002997
	speed: 0.6831s/iter; left time: 24690.7602s
	iters: 300, epoch: 13 | loss: 0.0553691
	speed: 0.6495s/iter; left time: 23411.5294s
	iters: 400, epoch: 13 | loss: 0.0348775
	speed: 0.6648s/iter; left time: 23895.5389s
Epoch: 13 cost time: 279.18755197525024
Epoch: 13, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.122 Vali Acc: 0.978 Test Loss: 0.122 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0000001
	speed: 1.2713s/iter; left time: 45553.8189s
	iters: 200, epoch: 14 | loss: 0.0000351
	speed: 0.5597s/iter; left time: 19998.9884s
	iters: 300, epoch: 14 | loss: 0.0098735
	speed: 0.6008s/iter; left time: 21408.3033s
	iters: 400, epoch: 14 | loss: 0.0000000
	speed: 0.6327s/iter; left time: 22480.3203s
Epoch: 14 cost time: 246.07972025871277
Epoch: 14, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0000018
	speed: 1.3257s/iter; left time: 46955.9685s
	iters: 200, epoch: 15 | loss: 0.0278934
	speed: 0.6175s/iter; left time: 21808.3197s
	iters: 300, epoch: 15 | loss: 0.0000006
	speed: 0.5887s/iter; left time: 20732.6518s
	iters: 400, epoch: 15 | loss: 0.0358953
	speed: 0.6119s/iter; left time: 21488.2939s
Epoch: 15 cost time: 255.10210871696472
Epoch: 15, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.134 Vali Acc: 0.975 Test Loss: 0.134 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9804456571168713
model parameter : 1105162
model size : 9.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.4960619
	speed: 0.6483s/iter; left time: 26709.8030s
	iters: 200, epoch: 1 | loss: 0.3030743
	speed: 0.6409s/iter; left time: 26342.0394s
	iters: 300, epoch: 1 | loss: 0.3774585
	speed: 0.5779s/iter; left time: 23696.3388s
	iters: 400, epoch: 1 | loss: 0.0571158
	speed: 0.5972s/iter; left time: 24425.4599s
Epoch: 1 cost time: 254.67455124855042
Epoch: 1, Steps: 413 | Train Loss: 0.782 Vali Loss: 0.096 Vali Acc: 0.967 Test Loss: 0.096 Test Acc: 0.967
Validation loss decreased (inf --> -0.966802).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0755159
	speed: 1.2619s/iter; left time: 51470.6136s
	iters: 200, epoch: 2 | loss: 0.0784888
	speed: 0.6098s/iter; left time: 24809.7236s
	iters: 300, epoch: 2 | loss: 0.5978872
	speed: 0.6057s/iter; left time: 24584.0623s
	iters: 400, epoch: 2 | loss: 0.0082979
	speed: 0.5777s/iter; left time: 23389.7847s
Epoch: 2 cost time: 247.58025455474854
Epoch: 2, Steps: 413 | Train Loss: 0.099 Vali Loss: 0.109 Vali Acc: 0.963 Test Loss: 0.109 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0049729
	speed: 1.1282s/iter; left time: 45552.6043s
	iters: 200, epoch: 3 | loss: 0.0248651
	speed: 0.5459s/iter; left time: 21985.3123s
	iters: 300, epoch: 3 | loss: 0.0038877
	speed: 0.5831s/iter; left time: 23425.3506s
	iters: 400, epoch: 3 | loss: 0.0092232
	speed: 0.6737s/iter; left time: 26998.9552s
Epoch: 3 cost time: 241.61803483963013
Epoch: 3, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
Validation loss decreased (-0.966802 --> -0.974533).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0009497
	speed: 1.3042s/iter; left time: 52116.9114s
	iters: 200, epoch: 4 | loss: 0.3190753
	speed: 0.5745s/iter; left time: 22902.1994s
	iters: 300, epoch: 4 | loss: 0.4041583
	speed: 0.5439s/iter; left time: 21625.1989s
	iters: 400, epoch: 4 | loss: 0.0028565
	speed: 0.5486s/iter; left time: 21760.2103s
Epoch: 4 cost time: 237.09663486480713
Epoch: 4, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0013151
	speed: 1.2241s/iter; left time: 48411.7271s
	iters: 200, epoch: 5 | loss: 0.0037960
	speed: 0.5736s/iter; left time: 22628.9115s
	iters: 300, epoch: 5 | loss: 0.0357990
	speed: 0.5630s/iter; left time: 22155.0980s
	iters: 400, epoch: 5 | loss: 0.0102996
	speed: 0.5676s/iter; left time: 22276.4962s
Epoch: 5 cost time: 238.29651641845703
Epoch: 5, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.105 Vali Acc: 0.969 Test Loss: 0.105 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0003863
	speed: 1.1714s/iter; left time: 45844.3500s
	iters: 200, epoch: 6 | loss: 0.8714779
	speed: 0.5799s/iter; left time: 22636.0631s
	iters: 300, epoch: 6 | loss: 0.0002668
	speed: 0.5845s/iter; left time: 22759.7785s
	iters: 400, epoch: 6 | loss: 0.0005020
	speed: 0.5352s/iter; left time: 20785.9210s
Epoch: 6 cost time: 235.61828088760376
Epoch: 6, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.152 Vali Acc: 0.959 Test Loss: 0.152 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0025216
	speed: 1.2163s/iter; left time: 47100.5670s
	iters: 200, epoch: 7 | loss: 0.0002954
	speed: 0.5810s/iter; left time: 22440.7239s
	iters: 300, epoch: 7 | loss: 0.0560243
	speed: 0.5484s/iter; left time: 21126.1148s
	iters: 400, epoch: 7 | loss: 0.2242134
	speed: 0.5916s/iter; left time: 22729.9718s
Epoch: 7 cost time: 240.9578173160553
Epoch: 7, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.146 Vali Acc: 0.967 Test Loss: 0.146 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0852783
	speed: 1.3005s/iter; left time: 49822.3503s
	iters: 200, epoch: 8 | loss: 0.0005548
	speed: 0.6293s/iter; left time: 24044.0522s
	iters: 300, epoch: 8 | loss: 0.0018642
	speed: 0.6165s/iter; left time: 23494.9384s
	iters: 400, epoch: 8 | loss: 0.0015753
	speed: 0.6322s/iter; left time: 24028.2496s
Epoch: 8 cost time: 259.9391396045685
Epoch: 8, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0002111
	speed: 1.3357s/iter; left time: 50619.4240s
	iters: 200, epoch: 9 | loss: 0.0036116
	speed: 0.6682s/iter; left time: 25256.6505s
	iters: 300, epoch: 9 | loss: 0.0115574
	speed: 0.7082s/iter; left time: 26698.2825s
	iters: 400, epoch: 9 | loss: 0.0318527
	speed: 0.7115s/iter; left time: 26751.9763s
Epoch: 9 cost time: 283.3715181350708
Epoch: 9, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.974533 --> -0.977261).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000182
	speed: 1.3383s/iter; left time: 50165.3350s
	iters: 200, epoch: 10 | loss: 0.0009832
	speed: 0.6721s/iter; left time: 25127.5093s
	iters: 300, epoch: 10 | loss: 0.0002676
	speed: 0.6030s/iter; left time: 22481.5438s
	iters: 400, epoch: 10 | loss: 0.0001972
	speed: 0.6776s/iter; left time: 25195.2399s
Epoch: 10 cost time: 270.6181893348694
Epoch: 10, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.192 Vali Acc: 0.966 Test Loss: 0.192 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000119
	speed: 1.3624s/iter; left time: 50507.2867s
	iters: 200, epoch: 11 | loss: 0.0000182
	speed: 0.6270s/iter; left time: 23179.8306s
	iters: 300, epoch: 11 | loss: 0.0000793
	speed: 0.6346s/iter; left time: 23397.7647s
	iters: 400, epoch: 11 | loss: 0.0494099
	speed: 0.6295s/iter; left time: 23146.2285s
Epoch: 11 cost time: 263.15114641189575
Epoch: 11, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.1375408
	speed: 1.2661s/iter; left time: 46412.3630s
	iters: 200, epoch: 12 | loss: 0.0006250
	speed: 0.6528s/iter; left time: 23864.1631s
	iters: 300, epoch: 12 | loss: 0.0090850
	speed: 0.6056s/iter; left time: 22079.7621s
	iters: 400, epoch: 12 | loss: 0.0007865
	speed: 0.6143s/iter; left time: 22333.1002s
Epoch: 12 cost time: 258.67000937461853
Epoch: 12, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
Validation loss decreased (-0.977261 --> -0.977716).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000594
	speed: 1.2454s/iter; left time: 45139.9194s
	iters: 200, epoch: 13 | loss: 0.0038373
	speed: 0.6426s/iter; left time: 23226.6563s
	iters: 300, epoch: 13 | loss: 0.0008937
	speed: 0.6950s/iter; left time: 25050.2257s
	iters: 400, epoch: 13 | loss: 0.0001465
	speed: 0.6429s/iter; left time: 23109.1039s
Epoch: 13 cost time: 263.939959526062
Epoch: 13, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.243 Vali Acc: 0.969 Test Loss: 0.243 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000334
	speed: 1.2656s/iter; left time: 45347.4906s
	iters: 200, epoch: 14 | loss: 0.0000843
	speed: 0.6815s/iter; left time: 24351.3074s
	iters: 300, epoch: 14 | loss: 0.0323357
	speed: 0.6302s/iter; left time: 22454.4798s
	iters: 400, epoch: 14 | loss: 0.2637781
	speed: 0.6318s/iter; left time: 22449.6911s
Epoch: 14 cost time: 261.66147923469543
Epoch: 14, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.165 Vali Acc: 0.967 Test Loss: 0.165 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000046
	speed: 1.2992s/iter; left time: 46015.4798s
	iters: 200, epoch: 15 | loss: 0.0000599
	speed: 0.6837s/iter; left time: 24147.7966s
	iters: 300, epoch: 15 | loss: 0.0000886
	speed: 0.6289s/iter; left time: 22150.1656s
	iters: 400, epoch: 15 | loss: 0.0088325
	speed: 0.5972s/iter; left time: 20971.7670s
Epoch: 15 cost time: 263.669636964798
Epoch: 15, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.174 Vali Acc: 0.970 Test Loss: 0.174 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000180
	speed: 1.2661s/iter; left time: 44320.4298s
	iters: 200, epoch: 16 | loss: 0.0000119
	speed: 0.6100s/iter; left time: 21292.8317s
	iters: 300, epoch: 16 | loss: 0.0000002
	speed: 0.6393s/iter; left time: 22250.0902s
	iters: 400, epoch: 16 | loss: 0.0000353
	speed: 0.6134s/iter; left time: 21288.4749s
Epoch: 16 cost time: 256.0714213848114
Epoch: 16, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.196 Vali Acc: 0.974 Test Loss: 0.196 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0017213
	speed: 1.3030s/iter; left time: 45073.6967s
	iters: 200, epoch: 17 | loss: 0.0070030
	speed: 0.6443s/iter; left time: 22223.3930s
	iters: 300, epoch: 17 | loss: 0.0063919
	speed: 0.6517s/iter; left time: 22414.7586s
	iters: 400, epoch: 17 | loss: 0.0000051
	speed: 0.6207s/iter; left time: 21286.7245s
Epoch: 17 cost time: 264.0210609436035
Epoch: 17, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.167 Vali Acc: 0.973 Test Loss: 0.167 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000545
	speed: 1.3159s/iter; left time: 44979.0295s
	iters: 200, epoch: 18 | loss: 0.0325485
	speed: 0.5978s/iter; left time: 20374.1966s
	iters: 300, epoch: 18 | loss: 0.0000199
	speed: 0.6295s/iter; left time: 21390.8513s
	iters: 400, epoch: 18 | loss: 0.0001393
	speed: 0.6591s/iter; left time: 22331.0933s
Epoch: 18 cost time: 262.9141709804535
Epoch: 18, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0001374
	speed: 1.2114s/iter; left time: 40904.6363s
	iters: 200, epoch: 19 | loss: 0.0000005
	speed: 0.6001s/iter; left time: 20204.6844s
	iters: 300, epoch: 19 | loss: 0.0100047
	speed: 0.6513s/iter; left time: 21862.9687s
	iters: 400, epoch: 19 | loss: 0.0000014
	speed: 0.6833s/iter; left time: 22868.2298s
Epoch: 19 cost time: 257.42663860321045
Epoch: 19, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.146 Vali Acc: 0.975 Test Loss: 0.146 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000017
	speed: 1.5244s/iter; left time: 50845.3124s
	iters: 200, epoch: 20 | loss: 0.0012731
	speed: 0.6852s/iter; left time: 22785.7689s
	iters: 300, epoch: 20 | loss: 0.0235219
	speed: 0.7303s/iter; left time: 24212.1081s
	iters: 400, epoch: 20 | loss: 0.1209695
	speed: 0.7029s/iter; left time: 23234.7895s
Epoch: 20 cost time: 295.4513876438141
Epoch: 20, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.200 Vali Acc: 0.976 Test Loss: 0.200 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000567
	speed: 1.5080s/iter; left time: 49674.3627s
	iters: 200, epoch: 21 | loss: 0.0150188
	speed: 0.7171s/iter; left time: 23549.7610s
	iters: 300, epoch: 21 | loss: 0.0045130
	speed: 0.7459s/iter; left time: 24422.7579s
	iters: 400, epoch: 21 | loss: 0.0000854
	speed: 0.7585s/iter; left time: 24757.8327s
Epoch: 21 cost time: 306.1202461719513
Epoch: 21, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.154 Vali Acc: 0.978 Test Loss: 0.154 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0023277
	speed: 1.4901s/iter; left time: 48468.9653s
	iters: 200, epoch: 22 | loss: 0.0006520
	speed: 0.6475s/iter; left time: 20997.3640s
	iters: 300, epoch: 22 | loss: 0.0000078
	speed: 0.6649s/iter; left time: 21496.2393s
	iters: 400, epoch: 22 | loss: 0.0052792
	speed: 0.7487s/iter; left time: 24127.5345s
Epoch: 22 cost time: 286.3025109767914
Epoch: 22, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.169 Vali Acc: 0.968 Test Loss: 0.169 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9777171441564347
model parameter : 1105162
model size : 9.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.3025942
	speed: 0.6447s/iter; left time: 26562.6702s
	iters: 200, epoch: 1 | loss: 2.3016102
	speed: 0.6392s/iter; left time: 26269.8155s
	iters: 300, epoch: 1 | loss: 2.3016927
	speed: 0.6739s/iter; left time: 27629.2646s
	iters: 400, epoch: 1 | loss: 2.3021359
	speed: 0.5907s/iter; left time: 24158.8258s
Epoch: 1 cost time: 263.6060001850128
Epoch: 1, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (inf --> -0.100022).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3016129
	speed: 1.2403s/iter; left time: 50590.7103s
	iters: 200, epoch: 2 | loss: 2.3004112
	speed: 0.6977s/iter; left time: 28386.0345s
	iters: 300, epoch: 2 | loss: 2.3026369
	speed: 0.7189s/iter; left time: 29177.5882s
	iters: 400, epoch: 2 | loss: 2.3053813
	speed: 0.6697s/iter; left time: 27114.0008s
Epoch: 2 cost time: 278.5838963985443
Epoch: 2, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.3023927
	speed: 1.2928s/iter; left time: 52198.6477s
	iters: 200, epoch: 3 | loss: 2.3017552
	speed: 0.6113s/iter; left time: 24619.6133s
	iters: 300, epoch: 3 | loss: 2.3024776
	speed: 0.6008s/iter; left time: 24138.3711s
	iters: 400, epoch: 3 | loss: 2.3035352
	speed: 0.6201s/iter; left time: 24851.2818s
Epoch: 3 cost time: 257.6183087825775
Epoch: 3, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 2.3043516
	speed: 1.4203s/iter; left time: 56758.2205s
	iters: 200, epoch: 4 | loss: 2.3027952
	speed: 0.6697s/iter; left time: 26696.7300s
	iters: 300, epoch: 4 | loss: 2.3029282
	speed: 0.6613s/iter; left time: 26293.3575s
	iters: 400, epoch: 4 | loss: 2.3028514
	speed: 0.6908s/iter; left time: 27397.9330s
Epoch: 4 cost time: 279.96959924697876
Epoch: 4, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 2.3076277
	speed: 1.3223s/iter; left time: 52294.2527s
	iters: 200, epoch: 5 | loss: 2.3003752
	speed: 0.5848s/iter; left time: 23068.2507s
	iters: 300, epoch: 5 | loss: 2.3033388
	speed: 0.5993s/iter; left time: 23583.3048s
	iters: 400, epoch: 5 | loss: 2.3043735
	speed: 0.6322s/iter; left time: 24813.0418s
Epoch: 5 cost time: 255.22853302955627
Epoch: 5, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 2.3007977
	speed: 1.3259s/iter; left time: 51888.6949s
	iters: 200, epoch: 6 | loss: 2.3031619
	speed: 0.7412s/iter; left time: 28934.8063s
	iters: 300, epoch: 6 | loss: 2.3026628
	speed: 0.6777s/iter; left time: 26388.7268s
	iters: 400, epoch: 6 | loss: 2.3036489
	speed: 0.6314s/iter; left time: 24521.3928s
Epoch: 6 cost time: 275.68865156173706
Epoch: 6, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 2.3025763
	speed: 1.2637s/iter; left time: 48933.7263s
	iters: 200, epoch: 7 | loss: 2.3021622
	speed: 0.6090s/iter; left time: 23522.6296s
	iters: 300, epoch: 7 | loss: 2.3043404
	speed: 0.6436s/iter; left time: 24794.0685s
	iters: 400, epoch: 7 | loss: 2.3031931
	speed: 0.7301s/iter; left time: 28051.4727s
Epoch: 7 cost time: 266.91065979003906
Epoch: 7, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 2.3026829
	speed: 1.3004s/iter; left time: 49817.5783s
	iters: 200, epoch: 8 | loss: 2.3074136
	speed: 0.6309s/iter; left time: 24104.9890s
	iters: 300, epoch: 8 | loss: 2.3017747
	speed: 0.6256s/iter; left time: 23841.0011s
	iters: 400, epoch: 8 | loss: 2.3044214
	speed: 0.5964s/iter; left time: 22669.4344s
Epoch: 8 cost time: 255.03861689567566
Epoch: 8, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 2.3030148
	speed: 1.2875s/iter; left time: 48790.6270s
	iters: 200, epoch: 9 | loss: 2.3042643
	speed: 0.6644s/iter; left time: 25113.7446s
	iters: 300, epoch: 9 | loss: 2.3022380
	speed: 0.6584s/iter; left time: 24819.7560s
	iters: 400, epoch: 9 | loss: 2.3034074
	speed: 0.6178s/iter; left time: 23226.7319s
Epoch: 9 cost time: 268.04625725746155
Epoch: 9, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 2.3002577
	speed: 1.3188s/iter; left time: 49432.2290s
	iters: 200, epoch: 10 | loss: 2.3029461
	speed: 0.5969s/iter; left time: 22315.0220s
	iters: 300, epoch: 10 | loss: 2.3059602
	speed: 0.5894s/iter; left time: 21976.4581s
	iters: 400, epoch: 10 | loss: 2.3046427
	speed: 0.5204s/iter; left time: 19351.3212s
Epoch: 10 cost time: 243.623943567276
Epoch: 10, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 2.3031826
	speed: 1.1644s/iter; left time: 43165.1656s
	iters: 200, epoch: 11 | loss: 2.3063390
	speed: 0.5919s/iter; left time: 21884.4871s
	iters: 300, epoch: 11 | loss: 2.3020906
	speed: 0.6182s/iter; left time: 22795.2278s
	iters: 400, epoch: 11 | loss: 2.3047566
	speed: 0.6230s/iter; left time: 22909.5922s
Epoch: 11 cost time: 248.19288182258606
Epoch: 11, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.10004547521600728
model parameter : 1105162
model size : 9.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         47                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df256_ma47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.2955114
	speed: 0.7842s/iter; left time: 32309.7964s
	iters: 200, epoch: 1 | loss: 0.1256481
	speed: 0.7169s/iter; left time: 29466.9723s
	iters: 300, epoch: 1 | loss: 0.3288344
	speed: 0.7384s/iter; left time: 30275.1957s
	iters: 400, epoch: 1 | loss: 0.0313811
	speed: 0.6809s/iter; left time: 27848.0137s
Epoch: 1 cost time: 301.7013223171234
Epoch: 1, Steps: 413 | Train Loss: 0.482 Vali Loss: 0.066 Vali Acc: 0.981 Test Loss: 0.066 Test Acc: 0.981
Validation loss decreased (inf --> -0.980900).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0798258
	speed: 1.5090s/iter; left time: 61548.9741s
	iters: 200, epoch: 2 | loss: 0.0818450
	speed: 0.7446s/iter; left time: 30297.0238s
	iters: 300, epoch: 2 | loss: 0.0108429
	speed: 0.6371s/iter; left time: 25860.2533s
	iters: 400, epoch: 2 | loss: 0.0039944
	speed: 0.6546s/iter; left time: 26503.3282s
Epoch: 2 cost time: 289.2146635055542
Epoch: 2, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.079 Vali Acc: 0.975 Test Loss: 0.079 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0001348
	speed: 1.3851s/iter; left time: 55923.5343s
	iters: 200, epoch: 3 | loss: 0.0090526
	speed: 0.6849s/iter; left time: 27585.7734s
	iters: 300, epoch: 3 | loss: 0.0040757
	speed: 0.6515s/iter; left time: 26172.5228s
	iters: 400, epoch: 3 | loss: 0.0041547
	speed: 0.6843s/iter; left time: 27422.9293s
Epoch: 3 cost time: 278.63113045692444
Epoch: 3, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
Validation loss decreased (-0.980900 --> -0.981354).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0043745
	speed: 1.3892s/iter; left time: 55515.2272s
	iters: 200, epoch: 4 | loss: 0.0166349
	speed: 0.6265s/iter; left time: 24972.3480s
	iters: 300, epoch: 4 | loss: 0.0011143
	speed: 0.6188s/iter; left time: 24605.5163s
	iters: 400, epoch: 4 | loss: 0.0022707
	speed: 0.7377s/iter; left time: 29259.5123s
Epoch: 4 cost time: 274.3759391307831
Epoch: 4, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.109 Vali Acc: 0.972 Test Loss: 0.109 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0004021
	speed: 1.5564s/iter; left time: 61552.5874s
	iters: 200, epoch: 5 | loss: 0.0215638
	speed: 0.7661s/iter; left time: 30221.7487s
	iters: 300, epoch: 5 | loss: 0.0082507
	speed: 0.7041s/iter; left time: 27707.4889s
	iters: 400, epoch: 5 | loss: 0.0003153
	speed: 0.6501s/iter; left time: 25516.5989s
Epoch: 5 cost time: 295.1060173511505
Epoch: 5, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.113 Vali Acc: 0.972 Test Loss: 0.113 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0098727
	speed: 1.4330s/iter; left time: 56080.3626s
	iters: 200, epoch: 6 | loss: 0.0019612
	speed: 0.7748s/iter; left time: 30246.2932s
	iters: 300, epoch: 6 | loss: 0.0013933
	speed: 0.6769s/iter; left time: 26356.8569s
	iters: 400, epoch: 6 | loss: 0.0020407
	speed: 0.7467s/iter; left time: 28999.0366s
Epoch: 6 cost time: 303.21904397010803
Epoch: 6, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000202
	speed: 1.4741s/iter; left time: 57083.0714s
	iters: 200, epoch: 7 | loss: 0.0000028
	speed: 0.7147s/iter; left time: 27603.7123s
	iters: 300, epoch: 7 | loss: 0.0002598
	speed: 0.7253s/iter; left time: 27941.7258s
	iters: 400, epoch: 7 | loss: 0.0002885
	speed: 0.7604s/iter; left time: 29218.0352s
Epoch: 7 cost time: 300.1813428401947
Epoch: 7, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.175 Vali Acc: 0.966 Test Loss: 0.175 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0255422
	speed: 1.4448s/iter; left time: 55351.1942s
	iters: 200, epoch: 8 | loss: 0.0000960
	speed: 0.7391s/iter; left time: 28241.5974s
	iters: 300, epoch: 8 | loss: 0.0016269
	speed: 0.7415s/iter; left time: 28258.5169s
	iters: 400, epoch: 8 | loss: 0.0046663
	speed: 0.7101s/iter; left time: 26990.7734s
Epoch: 8 cost time: 301.67282819747925
Epoch: 8, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000020
	speed: 1.5941s/iter; left time: 60411.4709s
	iters: 200, epoch: 9 | loss: 0.0000566
	speed: 0.7508s/iter; left time: 28376.6469s
	iters: 300, epoch: 9 | loss: 0.0014305
	speed: 0.7303s/iter; left time: 27531.2616s
	iters: 400, epoch: 9 | loss: 0.0000074
	speed: 0.7705s/iter; left time: 28966.9251s
Epoch: 9 cost time: 312.4321813583374
Epoch: 9, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.166 Vali Acc: 0.962 Test Loss: 0.166 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0008129
	speed: 1.4887s/iter; left time: 55802.7510s
	iters: 200, epoch: 10 | loss: 0.0032366
	speed: 0.7352s/iter; left time: 27485.4999s
	iters: 300, epoch: 10 | loss: 0.0846282
	speed: 0.7514s/iter; left time: 28014.9180s
	iters: 400, epoch: 10 | loss: 0.0611574
	speed: 0.7513s/iter; left time: 27936.1022s
Epoch: 10 cost time: 306.533949136734
Epoch: 10, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.210 Vali Acc: 0.965 Test Loss: 0.210 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0385691
	speed: 1.5105s/iter; left time: 55997.3830s
	iters: 200, epoch: 11 | loss: 0.0000008
	speed: 0.6957s/iter; left time: 25719.2770s
	iters: 300, epoch: 11 | loss: 0.0109038
	speed: 0.6953s/iter; left time: 25635.3168s
	iters: 400, epoch: 11 | loss: 0.0000004
	speed: 0.7949s/iter; left time: 29228.2049s
Epoch: 11 cost time: 298.5802438259125
Epoch: 11, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.111 Vali Acc: 0.983 Test Loss: 0.111 Test Acc: 0.983
Validation loss decreased (-0.981354 --> -0.982718).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000023
	speed: 1.4676s/iter; left time: 53800.7155s
	iters: 200, epoch: 12 | loss: 0.0000205
	speed: 0.6848s/iter; left time: 25034.5315s
	iters: 300, epoch: 12 | loss: 0.0000038
	speed: 0.6903s/iter; left time: 25167.7143s
	iters: 400, epoch: 12 | loss: 0.0011021
	speed: 0.6932s/iter; left time: 25204.5883s
Epoch: 12 cost time: 285.5110454559326
Epoch: 12, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.153 Vali Acc: 0.972 Test Loss: 0.153 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0005112
	speed: 1.3690s/iter; left time: 49617.6551s
	iters: 200, epoch: 13 | loss: 0.2980937
	speed: 0.7564s/iter; left time: 27340.6827s
	iters: 300, epoch: 13 | loss: 0.0001523
	speed: 0.6900s/iter; left time: 24872.0477s
	iters: 400, epoch: 13 | loss: 0.0042277
	speed: 0.7430s/iter; left time: 26706.7838s
Epoch: 13 cost time: 294.065532207489
Epoch: 13, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.177 Vali Acc: 0.974 Test Loss: 0.177 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 1.4198s/iter; left time: 50874.4164s
	iters: 200, epoch: 14 | loss: 0.0000074
	speed: 0.7530s/iter; left time: 26904.8913s
	iters: 300, epoch: 14 | loss: 0.0000039
	speed: 0.6763s/iter; left time: 24096.9175s
	iters: 400, epoch: 14 | loss: 0.0100986
	speed: 0.6842s/iter; left time: 24310.5428s
Epoch: 14 cost time: 290.80298042297363
Epoch: 14, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.218 Vali Acc: 0.962 Test Loss: 0.218 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.3991210
	speed: 1.5539s/iter; left time: 55039.2034s
	iters: 200, epoch: 15 | loss: 0.1623332
	speed: 0.7280s/iter; left time: 25711.7729s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.7313s/iter; left time: 25755.3558s
	iters: 400, epoch: 15 | loss: 0.0000196
	speed: 0.7091s/iter; left time: 24901.8634s
Epoch: 15 cost time: 303.13251876831055
Epoch: 15, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.128 Vali Acc: 0.975 Test Loss: 0.128 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000029
	speed: 1.5233s/iter; left time: 53324.7228s
	iters: 200, epoch: 16 | loss: 0.0000015
	speed: 0.6876s/iter; left time: 24000.2008s
	iters: 300, epoch: 16 | loss: 0.0000114
	speed: 0.6706s/iter; left time: 23342.3034s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.7192s/iter; left time: 24960.3691s
Epoch: 16 cost time: 291.71059823036194
Epoch: 16, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.165 Vali Acc: 0.980 Test Loss: 0.165 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000001
	speed: 1.5473s/iter; left time: 53524.3849s
	iters: 200, epoch: 17 | loss: 0.0000003
	speed: 0.7480s/iter; left time: 25802.2609s
	iters: 300, epoch: 17 | loss: 0.0000001
	speed: 0.7582s/iter; left time: 26077.6033s
	iters: 400, epoch: 17 | loss: 0.0031879
	speed: 0.7509s/iter; left time: 25752.0586s
Epoch: 17 cost time: 307.93562364578247
Epoch: 17, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.158 Vali Acc: 0.980 Test Loss: 0.158 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000055
	speed: 1.5826s/iter; left time: 54092.8119s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.6939s/iter; left time: 23647.1727s
	iters: 300, epoch: 18 | loss: 0.0001427
	speed: 0.6893s/iter; left time: 23423.1849s
	iters: 400, epoch: 18 | loss: 0.0001263
	speed: 0.7018s/iter; left time: 23776.7965s
Epoch: 18 cost time: 296.1136393547058
Epoch: 18, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.272 Vali Acc: 0.968 Test Loss: 0.272 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0001416
	speed: 1.5985s/iter; left time: 53975.9618s
	iters: 200, epoch: 19 | loss: 0.4224680
	speed: 0.7566s/iter; left time: 25472.2803s
	iters: 300, epoch: 19 | loss: 0.1677919
	speed: 0.6951s/iter; left time: 23332.9152s
	iters: 400, epoch: 19 | loss: 0.0001635
	speed: 0.6475s/iter; left time: 21668.4214s
Epoch: 19 cost time: 299.68851613998413
Epoch: 19, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.192 Vali Acc: 0.971 Test Loss: 0.192 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000004
	speed: 1.4671s/iter; left time: 48932.7177s
	iters: 200, epoch: 20 | loss: 0.0000291
	speed: 0.7670s/iter; left time: 25505.5698s
	iters: 300, epoch: 20 | loss: 0.0000088
	speed: 0.7388s/iter; left time: 24494.7502s
	iters: 400, epoch: 20 | loss: 0.0000617
	speed: 0.7417s/iter; left time: 24516.7392s
Epoch: 20 cost time: 306.2592430114746
Epoch: 20, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.097 Vali Acc: 0.984 Test Loss: 0.097 Test Acc: 0.984
Validation loss decreased (-0.982718 --> -0.983628).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0001270
	speed: 1.4734s/iter; left time: 48535.7232s
	iters: 200, epoch: 21 | loss: 0.0000106
	speed: 0.7034s/iter; left time: 23100.1212s
	iters: 300, epoch: 21 | loss: 0.8329033
	speed: 0.7201s/iter; left time: 23576.3072s
	iters: 400, epoch: 21 | loss: 0.0000069
	speed: 0.7258s/iter; left time: 23690.9412s
Epoch: 21 cost time: 295.7035665512085
Epoch: 21, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.201 Vali Acc: 0.975 Test Loss: 0.201 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 1.4722s/iter; left time: 47887.0149s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.7832s/iter; left time: 25397.9365s
	iters: 300, epoch: 22 | loss: 0.0000014
	speed: 0.8214s/iter; left time: 26554.0766s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.7585s/iter; left time: 24444.2755s
Epoch: 22 cost time: 317.12166357040405
Epoch: 22, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.164 Vali Acc: 0.977 Test Loss: 0.164 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000063
	speed: 1.5406s/iter; left time: 49477.6398s
	iters: 200, epoch: 23 | loss: 0.0006755
	speed: 0.6687s/iter; left time: 21409.1107s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.6538s/iter; left time: 20865.0503s
	iters: 400, epoch: 23 | loss: 0.0000004
	speed: 0.7135s/iter; left time: 22699.4355s
Epoch: 23 cost time: 286.8586230278015
Epoch: 23, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.199 Vali Acc: 0.976 Test Loss: 0.199 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0000034
	speed: 1.5898s/iter; left time: 50398.3941s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.8255s/iter; left time: 26085.9061s
	iters: 300, epoch: 24 | loss: 0.0000003
	speed: 0.7163s/iter; left time: 22564.1576s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.6710s/iter; left time: 21069.2326s
Epoch: 24 cost time: 311.20281314849854
Epoch: 24, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.146 Vali Acc: 0.980 Test Loss: 0.146 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 1.6183s/iter; left time: 50636.4832s
	iters: 200, epoch: 25 | loss: 0.0000096
	speed: 0.6818s/iter; left time: 21263.9752s
	iters: 300, epoch: 25 | loss: 0.0000001
	speed: 0.6493s/iter; left time: 20186.9110s
	iters: 400, epoch: 25 | loss: 0.0000000
	speed: 0.7415s/iter; left time: 22977.7857s
Epoch: 25 cost time: 291.6160237789154
Epoch: 25, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.207 Vali Acc: 0.973 Test Loss: 0.207 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0000257
	speed: 1.4853s/iter; left time: 45859.4081s
	iters: 200, epoch: 26 | loss: 0.0000001
	speed: 0.7197s/iter; left time: 22149.5582s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.6654s/iter; left time: 20410.2970s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.6433s/iter; left time: 19670.7323s
Epoch: 26 cost time: 282.37375831604004
Epoch: 26, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.135 Vali Acc: 0.981 Test Loss: 0.135 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0000008
	speed: 1.3509s/iter; left time: 41151.3780s
	iters: 200, epoch: 27 | loss: 0.0616786
	speed: 0.6829s/iter; left time: 20735.8578s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.6749s/iter; left time: 20424.0581s
	iters: 400, epoch: 27 | loss: 0.0001897
	speed: 0.7135s/iter; left time: 21522.5221s
Epoch: 27 cost time: 283.4799003601074
Epoch: 27, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.288 Vali Acc: 0.972 Test Loss: 0.288 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 1.4393s/iter; left time: 43250.4582s
	iters: 200, epoch: 28 | loss: 0.0000021
	speed: 0.7546s/iter; left time: 22601.7668s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.7043s/iter; left time: 21024.4933s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.6778s/iter; left time: 20165.5410s
Epoch: 28 cost time: 297.7167999744415
Epoch: 28, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.191 Vali Acc: 0.975 Test Loss: 0.191 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0000003
	speed: 1.3139s/iter; left time: 38940.5432s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.6580s/iter; left time: 19434.8768s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.6972s/iter; left time: 20522.8787s
	iters: 400, epoch: 29 | loss: 0.0000013
	speed: 0.7039s/iter; left time: 20651.2603s
Epoch: 29 cost time: 279.0733106136322
Epoch: 29, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.134 Vali Acc: 0.980 Test Loss: 0.134 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.3665271
	speed: 1.4391s/iter; left time: 42056.7848s
	iters: 200, epoch: 30 | loss: 0.0000001
	speed: 0.6584s/iter; left time: 19174.4128s
	iters: 300, epoch: 30 | loss: 0.0000012
	speed: 0.6586s/iter; left time: 19115.8246s
	iters: 400, epoch: 30 | loss: 0.0173950
	speed: 0.6551s/iter; left time: 18947.5952s
Epoch: 30 cost time: 274.64542865753174
Epoch: 30, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df256_ma47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9836289222373806
model parameter : 908554
model size : 8.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         38                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df256_ma38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4148545
	speed: 0.6908s/iter; left time: 28460.7081s
	iters: 200, epoch: 1 | loss: 0.1941098
	speed: 0.6563s/iter; left time: 26974.4594s
	iters: 300, epoch: 1 | loss: 0.2436051
	speed: 0.6807s/iter; left time: 27908.2291s
	iters: 400, epoch: 1 | loss: 0.0383734
	speed: 0.6739s/iter; left time: 27564.6919s
Epoch: 1 cost time: 278.2928538322449
Epoch: 1, Steps: 413 | Train Loss: 0.512 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
Validation loss decreased (inf --> -0.977716).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0197970
	speed: 1.2228s/iter; left time: 49875.7096s
	iters: 200, epoch: 2 | loss: 0.0504798
	speed: 0.6097s/iter; left time: 24806.1120s
	iters: 300, epoch: 2 | loss: 0.0053718
	speed: 0.5850s/iter; left time: 23742.4420s
	iters: 400, epoch: 2 | loss: 0.0279091
	speed: 0.5374s/iter; left time: 21756.9996s
Epoch: 2 cost time: 242.67405009269714
Epoch: 2, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.095 Vali Acc: 0.969 Test Loss: 0.095 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0054501
	speed: 1.3499s/iter; left time: 54501.0373s
	iters: 200, epoch: 3 | loss: 0.0150152
	speed: 0.5850s/iter; left time: 23562.6012s
	iters: 300, epoch: 3 | loss: 0.0326101
	speed: 0.5973s/iter; left time: 23995.7768s
	iters: 400, epoch: 3 | loss: 0.0109769
	speed: 0.6171s/iter; left time: 24729.1239s
Epoch: 3 cost time: 255.16944909095764
Epoch: 3, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0038574
	speed: 1.2898s/iter; left time: 51544.0216s
	iters: 200, epoch: 4 | loss: 0.0072547
	speed: 0.6342s/iter; left time: 25280.1485s
	iters: 300, epoch: 4 | loss: 0.0019436
	speed: 0.6731s/iter; left time: 26762.4402s
	iters: 400, epoch: 4 | loss: 0.0007257
	speed: 0.6637s/iter; left time: 26323.4016s
Epoch: 4 cost time: 266.30859899520874
Epoch: 4, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0030356
	speed: 1.3817s/iter; left time: 54643.6918s
	iters: 200, epoch: 5 | loss: 0.3533765
	speed: 0.7186s/iter; left time: 28349.2835s
	iters: 300, epoch: 5 | loss: 0.0008665
	speed: 0.6645s/iter; left time: 26146.1976s
	iters: 400, epoch: 5 | loss: 0.0030494
	speed: 0.7428s/iter; left time: 29155.7800s
Epoch: 5 cost time: 290.7700526714325
Epoch: 5, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0001668
	speed: 1.4640s/iter; left time: 57296.1761s
	iters: 200, epoch: 6 | loss: 0.0258836
	speed: 0.6475s/iter; left time: 25275.0186s
	iters: 300, epoch: 6 | loss: 0.0002394
	speed: 0.6943s/iter; left time: 27034.3517s
	iters: 400, epoch: 6 | loss: 0.1738075
	speed: 0.7800s/iter; left time: 30292.5368s
Epoch: 6 cost time: 289.9608976840973
Epoch: 6, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.2499797
	speed: 1.5897s/iter; left time: 61558.8257s
	iters: 200, epoch: 7 | loss: 0.0498041
	speed: 0.7038s/iter; left time: 27182.8655s
	iters: 300, epoch: 7 | loss: 0.0013169
	speed: 0.6850s/iter; left time: 26389.4883s
	iters: 400, epoch: 7 | loss: 0.0000527
	speed: 0.7403s/iter; left time: 28444.3901s
Epoch: 7 cost time: 300.3772540092468
Epoch: 7, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.107 Vali Acc: 0.982 Test Loss: 0.107 Test Acc: 0.982
Validation loss decreased (-0.977716 --> -0.982264).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0045890
	speed: 1.5531s/iter; left time: 59499.7176s
	iters: 200, epoch: 8 | loss: 0.0000352
	speed: 0.6944s/iter; left time: 26533.2953s
	iters: 300, epoch: 8 | loss: 0.0003467
	speed: 0.6802s/iter; left time: 25923.3841s
	iters: 400, epoch: 8 | loss: 0.0050683
	speed: 0.7309s/iter; left time: 27782.4557s
Epoch: 8 cost time: 301.35666847229004
Epoch: 8, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.142 Vali Acc: 0.978 Test Loss: 0.142 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0004044
	speed: 1.4567s/iter; left time: 55205.3735s
	iters: 200, epoch: 9 | loss: 0.0007382
	speed: 0.7134s/iter; left time: 26963.1895s
	iters: 300, epoch: 9 | loss: 0.0002330
	speed: 0.6838s/iter; left time: 25777.5228s
	iters: 400, epoch: 9 | loss: 0.0007590
	speed: 0.6270s/iter; left time: 23571.7362s
Epoch: 9 cost time: 275.51361107826233
Epoch: 9, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.2163257
	speed: 1.4290s/iter; left time: 53563.1574s
	iters: 200, epoch: 10 | loss: 0.0052155
	speed: 0.7154s/iter; left time: 26742.9059s
	iters: 300, epoch: 10 | loss: 0.0026426
	speed: 0.6856s/iter; left time: 25561.1113s
	iters: 400, epoch: 10 | loss: 1.2340906
	speed: 0.6777s/iter; left time: 25201.0629s
Epoch: 10 cost time: 293.2415728569031
Epoch: 10, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.141 Vali Acc: 0.975 Test Loss: 0.141 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000008
	speed: 1.4211s/iter; left time: 52680.9687s
	iters: 200, epoch: 11 | loss: 0.0197256
	speed: 0.7473s/iter; left time: 27629.8312s
	iters: 300, epoch: 11 | loss: 0.0000244
	speed: 0.6752s/iter; left time: 24896.8006s
	iters: 400, epoch: 11 | loss: 0.0000551
	speed: 0.6599s/iter; left time: 24264.9306s
Epoch: 11 cost time: 286.61498832702637
Epoch: 11, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.132 Vali Acc: 0.978 Test Loss: 0.132 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0004569
	speed: 1.4461s/iter; left time: 53011.7391s
	iters: 200, epoch: 12 | loss: 0.0000277
	speed: 0.6972s/iter; left time: 25488.3265s
	iters: 300, epoch: 12 | loss: 0.0000978
	speed: 0.7142s/iter; left time: 26039.5905s
	iters: 400, epoch: 12 | loss: 0.0002286
	speed: 0.7172s/iter; left time: 26075.2735s
Epoch: 12 cost time: 294.0391595363617
Epoch: 12, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.982264 --> -0.982719).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000163
	speed: 1.2772s/iter; left time: 46293.3110s
	iters: 200, epoch: 13 | loss: 0.0041220
	speed: 0.7174s/iter; left time: 25931.7521s
	iters: 300, epoch: 13 | loss: 0.0000015
	speed: 0.7044s/iter; left time: 25391.8145s
	iters: 400, epoch: 13 | loss: 0.0000002
	speed: 0.6684s/iter; left time: 24026.9068s
Epoch: 13 cost time: 279.7619421482086
Epoch: 13, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.118 Vali Acc: 0.978 Test Loss: 0.118 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000286
	speed: 1.3903s/iter; left time: 49818.0542s
	iters: 200, epoch: 14 | loss: 0.0000049
	speed: 0.6806s/iter; left time: 24318.1289s
	iters: 300, epoch: 14 | loss: 0.0000011
	speed: 0.7800s/iter; left time: 27794.6563s
	iters: 400, epoch: 14 | loss: 0.6375852
	speed: 0.6980s/iter; left time: 24800.8269s
Epoch: 14 cost time: 292.0332086086273
Epoch: 14, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.204 Vali Acc: 0.965 Test Loss: 0.204 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000489
	speed: 1.3852s/iter; left time: 49063.3919s
	iters: 200, epoch: 15 | loss: 0.0000065
	speed: 0.6336s/iter; left time: 22379.0215s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.5624s/iter; left time: 19805.8011s
	iters: 400, epoch: 15 | loss: 0.0000021
	speed: 0.6435s/iter; left time: 22599.7255s
Epoch: 15 cost time: 262.13051652908325
Epoch: 15, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.084 Vali Acc: 0.985 Test Loss: 0.084 Test Acc: 0.985
Validation loss decreased (-0.982719 --> -0.985447).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000153
	speed: 1.4399s/iter; left time: 50404.9515s
	iters: 200, epoch: 16 | loss: 0.0000136
	speed: 0.6259s/iter; left time: 21847.5166s
	iters: 300, epoch: 16 | loss: 0.0009730
	speed: 0.6854s/iter; left time: 23854.7841s
	iters: 400, epoch: 16 | loss: 0.0000085
	speed: 0.6211s/iter; left time: 21554.7404s
Epoch: 16 cost time: 270.86124753952026
Epoch: 16, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000066
	speed: 1.4663s/iter; left time: 50725.2552s
	iters: 200, epoch: 17 | loss: 0.0000004
	speed: 0.6640s/iter; left time: 22902.2552s
	iters: 300, epoch: 17 | loss: 0.0000086
	speed: 0.6298s/iter; left time: 21661.8071s
	iters: 400, epoch: 17 | loss: 0.0000007
	speed: 0.6349s/iter; left time: 21773.0512s
Epoch: 17 cost time: 273.8556351661682
Epoch: 17, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.133 Vali Acc: 0.978 Test Loss: 0.133 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000064
	speed: 1.4564s/iter; left time: 49778.6598s
	iters: 200, epoch: 18 | loss: 0.1854692
	speed: 0.6558s/iter; left time: 22350.3942s
	iters: 300, epoch: 18 | loss: 0.0000000
	speed: 0.6805s/iter; left time: 23124.4244s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.6477s/iter; left time: 21945.3270s
Epoch: 18 cost time: 279.0500910282135
Epoch: 18, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.160 Vali Acc: 0.980 Test Loss: 0.160 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000002
	speed: 1.3819s/iter; left time: 46661.3948s
	iters: 200, epoch: 19 | loss: 0.0000004
	speed: 0.6476s/iter; left time: 21804.3118s
	iters: 300, epoch: 19 | loss: 0.2803625
	speed: 0.6340s/iter; left time: 21281.8675s
	iters: 400, epoch: 19 | loss: 0.0000189
	speed: 0.5910s/iter; left time: 19778.2958s
Epoch: 19 cost time: 269.14880895614624
Epoch: 19, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.146 Vali Acc: 0.978 Test Loss: 0.146 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000007
	speed: 1.3883s/iter; left time: 46306.0845s
	iters: 200, epoch: 20 | loss: 0.2991104
	speed: 0.6721s/iter; left time: 22349.2505s
	iters: 300, epoch: 20 | loss: 0.0000614
	speed: 0.6033s/iter; left time: 20002.6673s
	iters: 400, epoch: 20 | loss: 0.1357469
	speed: 0.6046s/iter; left time: 19985.8843s
Epoch: 20 cost time: 265.5162971019745
Epoch: 20, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0000068
	speed: 1.4121s/iter; left time: 46515.6973s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.6303s/iter; left time: 20699.8285s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.6030s/iter; left time: 19741.3474s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.5781s/iter; left time: 18868.9797s
Epoch: 21 cost time: 256.37572145462036
Epoch: 21, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.112 Vali Acc: 0.985 Test Loss: 0.112 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0000049
	speed: 1.4470s/iter; left time: 47067.1328s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.6297s/iter; left time: 20420.2028s
	iters: 300, epoch: 22 | loss: 0.0000160
	speed: 0.6164s/iter; left time: 19928.3516s
	iters: 400, epoch: 22 | loss: 0.0000001
	speed: 0.6358s/iter; left time: 20491.0936s
Epoch: 22 cost time: 272.93881583213806
Epoch: 22, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.097 Vali Acc: 0.985 Test Loss: 0.097 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0005155
	speed: 1.3880s/iter; left time: 44576.3736s
	iters: 200, epoch: 23 | loss: 0.0000645
	speed: 0.6468s/iter; left time: 20708.6289s
	iters: 300, epoch: 23 | loss: 0.6694859
	speed: 0.6300s/iter; left time: 20105.5164s
	iters: 400, epoch: 23 | loss: 0.0000018
	speed: 0.6602s/iter; left time: 21003.5915s
Epoch: 23 cost time: 270.3282058238983
Epoch: 23, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.147 Vali Acc: 0.979 Test Loss: 0.147 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0001783
	speed: 1.4064s/iter; left time: 44585.2115s
	iters: 200, epoch: 24 | loss: 0.0000000
	speed: 0.7645s/iter; left time: 24159.3547s
	iters: 300, epoch: 24 | loss: 0.0000001
	speed: 0.6614s/iter; left time: 20834.8088s
	iters: 400, epoch: 24 | loss: 0.0000093
	speed: 0.6444s/iter; left time: 20236.4959s
Epoch: 24 cost time: 287.94385862350464
Epoch: 24, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.113 Vali Acc: 0.986 Test Loss: 0.113 Test Acc: 0.986
Validation loss decreased (-0.985447 --> -0.985902).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0000007
	speed: 1.3492s/iter; left time: 42216.3347s
	iters: 200, epoch: 25 | loss: 0.0000005
	speed: 0.6982s/iter; left time: 21777.4258s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.6477s/iter; left time: 20137.7077s
	iters: 400, epoch: 25 | loss: 0.0002372
	speed: 0.6012s/iter; left time: 18630.8037s
Epoch: 25 cost time: 266.72730255126953
Epoch: 25, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.186 Vali Acc: 0.978 Test Loss: 0.186 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 1.3993s/iter; left time: 43205.6152s
	iters: 200, epoch: 26 | loss: 0.0000007
	speed: 0.6519s/iter; left time: 20061.4467s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.5991s/iter; left time: 18377.4866s
	iters: 400, epoch: 26 | loss: 0.0000012
	speed: 0.6278s/iter; left time: 19196.2338s
Epoch: 26 cost time: 266.96674513816833
Epoch: 26, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.117 Vali Acc: 0.983 Test Loss: 0.117 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0000001
	speed: 1.5212s/iter; left time: 46340.6926s
	iters: 200, epoch: 27 | loss: 0.0000001
	speed: 0.6595s/iter; left time: 20025.3332s
	iters: 300, epoch: 27 | loss: 0.0000003
	speed: 0.6552s/iter; left time: 19827.2129s
	iters: 400, epoch: 27 | loss: 0.0041037
	speed: 0.5856s/iter; left time: 17662.8765s
Epoch: 27 cost time: 273.7108085155487
Epoch: 27, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.167 Vali Acc: 0.979 Test Loss: 0.167 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 1.4596s/iter; left time: 43861.6952s
	iters: 200, epoch: 28 | loss: 0.0000010
	speed: 0.6493s/iter; left time: 19445.4365s
	iters: 300, epoch: 28 | loss: 0.0461884
	speed: 0.6419s/iter; left time: 19160.0411s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.6892s/iter; left time: 20504.2361s
Epoch: 28 cost time: 280.18191170692444
Epoch: 28, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.390 Vali Acc: 0.960 Test Loss: 0.390 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 1.3842s/iter; left time: 41023.1380s
	iters: 200, epoch: 29 | loss: 0.0000017
	speed: 0.6140s/iter; left time: 18136.4562s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.6412s/iter; left time: 18874.0559s
	iters: 400, epoch: 29 | loss: 0.0000049
	speed: 0.7094s/iter; left time: 20812.4495s
Epoch: 29 cost time: 270.6252603530884
Epoch: 29, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.119 Vali Acc: 0.985 Test Loss: 0.119 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 1.2966s/iter; left time: 37892.2647s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.6461s/iter; left time: 18817.1568s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.6031s/iter; left time: 17503.4286s
	iters: 400, epoch: 30 | loss: 0.0000013
	speed: 0.7257s/iter; left time: 20990.6096s
Epoch: 30 cost time: 270.4996111392975
Epoch: 30, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.159 Vali Acc: 0.975 Test Loss: 0.159 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.0000031
	speed: 1.3614s/iter; left time: 39222.8955s
	iters: 200, epoch: 31 | loss: 0.0000196
	speed: 0.7001s/iter; left time: 20101.1223s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.6462s/iter; left time: 18489.8075s
	iters: 400, epoch: 31 | loss: 0.0000076
	speed: 0.6955s/iter; left time: 19828.0886s
Epoch: 31 cost time: 278.9984447956085
Epoch: 31, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.205 Vali Acc: 0.974 Test Loss: 0.205 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.1528078
	speed: 1.3006s/iter; left time: 36935.5897s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.6520s/iter; left time: 18451.1927s
	iters: 300, epoch: 32 | loss: 0.2820060
	speed: 0.7080s/iter; left time: 19962.8925s
	iters: 400, epoch: 32 | loss: 0.0000007
	speed: 0.7075s/iter; left time: 19879.4488s
Epoch: 32 cost time: 279.7024130821228
Epoch: 32, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.154 Vali Acc: 0.982 Test Loss: 0.154 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0000003
	speed: 1.3085s/iter; left time: 36617.0039s
	iters: 200, epoch: 33 | loss: 0.0000001
	speed: 0.6560s/iter; left time: 18292.6386s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.6642s/iter; left time: 18456.0847s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.6215s/iter; left time: 17206.6898s
Epoch: 33 cost time: 265.4654710292816
Epoch: 33, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.265 Vali Acc: 0.973 Test Loss: 0.265 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 1.3242s/iter; left time: 36511.9445s
	iters: 200, epoch: 34 | loss: 0.0002221
	speed: 0.6783s/iter; left time: 18635.6273s
	iters: 300, epoch: 34 | loss: 0.2001623
	speed: 0.7209s/iter; left time: 19731.9637s
	iters: 400, epoch: 34 | loss: 0.0000004
	speed: 0.6732s/iter; left time: 18358.1867s
Epoch: 34 cost time: 283.3519775867462
Epoch: 34, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.141 Vali Acc: 0.984 Test Loss: 0.141 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df256_ma38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9859026830377444
model parameter : 908554
model size : 8.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         28                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df256_ma28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5344837
	speed: 0.6591s/iter; left time: 27153.6583s
	iters: 200, epoch: 1 | loss: 0.2874452
	speed: 0.6016s/iter; left time: 24724.4679s
	iters: 300, epoch: 1 | loss: 0.1738990
	speed: 0.5828s/iter; left time: 23893.5463s
	iters: 400, epoch: 1 | loss: 0.0214551
	speed: 0.5970s/iter; left time: 24418.0890s
Epoch: 1 cost time: 252.95227432250977
Epoch: 1, Steps: 413 | Train Loss: 0.561 Vali Loss: 0.074 Vali Acc: 0.979 Test Loss: 0.074 Test Acc: 0.979
Validation loss decreased (inf --> -0.978626).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0656374
	speed: 1.2879s/iter; left time: 52530.0924s
	iters: 200, epoch: 2 | loss: 0.0630136
	speed: 0.5916s/iter; left time: 24072.5340s
	iters: 300, epoch: 2 | loss: 0.0090457
	speed: 0.6241s/iter; left time: 25332.3794s
	iters: 400, epoch: 2 | loss: 0.0219828
	speed: 0.6893s/iter; left time: 27908.1714s
Epoch: 2 cost time: 263.48044872283936
Epoch: 2, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.060 Vali Acc: 0.979 Test Loss: 0.060 Test Acc: 0.979
Validation loss decreased (-0.978626 --> -0.978626).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0003509
	speed: 1.2518s/iter; left time: 50542.1206s
	iters: 200, epoch: 3 | loss: 0.0229238
	speed: 0.5793s/iter; left time: 23329.7497s
	iters: 300, epoch: 3 | loss: 0.0009373
	speed: 0.5963s/iter; left time: 23954.7992s
	iters: 400, epoch: 3 | loss: 0.1187946
	speed: 0.6046s/iter; left time: 24230.5517s
Epoch: 3 cost time: 245.41920828819275
Epoch: 3, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.043 Vali Acc: 0.985 Test Loss: 0.043 Test Acc: 0.985
Validation loss decreased (-0.978626 --> -0.985448).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0029338
	speed: 1.1093s/iter; left time: 44328.8609s
	iters: 200, epoch: 4 | loss: 0.0021895
	speed: 0.5706s/iter; left time: 22744.6909s
	iters: 300, epoch: 4 | loss: 0.0010715
	speed: 0.5882s/iter; left time: 23388.0228s
	iters: 400, epoch: 4 | loss: 0.0044602
	speed: 0.6079s/iter; left time: 24109.2901s
Epoch: 4 cost time: 239.62793111801147
Epoch: 4, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0018527
	speed: 1.1985s/iter; left time: 47400.6948s
	iters: 200, epoch: 5 | loss: 0.0003898
	speed: 0.5404s/iter; left time: 21319.3377s
	iters: 300, epoch: 5 | loss: 0.0054687
	speed: 0.5809s/iter; left time: 22856.5537s
	iters: 400, epoch: 5 | loss: 0.0083038
	speed: 0.6178s/iter; left time: 24247.7979s
Epoch: 5 cost time: 238.91414976119995
Epoch: 5, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.6954095
	speed: 1.1978s/iter; left time: 46878.7362s
	iters: 200, epoch: 6 | loss: 0.0002802
	speed: 0.5646s/iter; left time: 22038.2526s
	iters: 300, epoch: 6 | loss: 0.0076858
	speed: 0.5719s/iter; left time: 22266.5758s
	iters: 400, epoch: 6 | loss: 0.4139564
	speed: 0.5613s/iter; left time: 21798.8078s
Epoch: 6 cost time: 238.73716974258423
Epoch: 6, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0131000
	speed: 1.1563s/iter; left time: 44777.2173s
	iters: 200, epoch: 7 | loss: 0.0000493
	speed: 0.5915s/iter; left time: 22847.2555s
	iters: 300, epoch: 7 | loss: 0.0011215
	speed: 0.6048s/iter; left time: 23297.7152s
	iters: 400, epoch: 7 | loss: 0.0003472
	speed: 0.5904s/iter; left time: 22685.5629s
Epoch: 7 cost time: 243.6565752029419
Epoch: 7, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0382936
	speed: 1.0845s/iter; left time: 41546.5775s
	iters: 200, epoch: 8 | loss: 0.0000522
	speed: 0.5448s/iter; left time: 20816.5171s
	iters: 300, epoch: 8 | loss: 0.0080610
	speed: 0.5662s/iter; left time: 21576.5181s
	iters: 400, epoch: 8 | loss: 0.0001852
	speed: 0.5653s/iter; left time: 21488.1739s
Epoch: 8 cost time: 226.22956562042236
Epoch: 8, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0007338
	speed: 1.2577s/iter; left time: 47661.2319s
	iters: 200, epoch: 9 | loss: 0.0004405
	speed: 0.5803s/iter; left time: 21934.1355s
	iters: 300, epoch: 9 | loss: 0.0152029
	speed: 0.6150s/iter; left time: 23181.8860s
	iters: 400, epoch: 9 | loss: 0.0030605
	speed: 0.6004s/iter; left time: 22574.8052s
Epoch: 9 cost time: 251.70368766784668
Epoch: 9, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.051 Vali Acc: 0.983 Test Loss: 0.051 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0000014
	speed: 1.2253s/iter; left time: 45930.7315s
	iters: 200, epoch: 10 | loss: 0.0000001
	speed: 0.5734s/iter; left time: 21435.6800s
	iters: 300, epoch: 10 | loss: 0.0000237
	speed: 0.5863s/iter; left time: 21859.2752s
	iters: 400, epoch: 10 | loss: 0.2571299
	speed: 0.5874s/iter; left time: 21842.0359s
Epoch: 10 cost time: 246.1602442264557
Epoch: 10, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0000106
	speed: 1.2204s/iter; left time: 45241.3421s
	iters: 200, epoch: 11 | loss: 0.0022555
	speed: 0.6273s/iter; left time: 23190.5123s
	iters: 300, epoch: 11 | loss: 0.1195332
	speed: 0.5702s/iter; left time: 21024.7516s
	iters: 400, epoch: 11 | loss: 0.0001952
	speed: 0.5854s/iter; left time: 21524.0582s
Epoch: 11 cost time: 245.45719242095947
Epoch: 11, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.134 Vali Acc: 0.975 Test Loss: 0.134 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0004959
	speed: 1.2387s/iter; left time: 45409.3417s
	iters: 200, epoch: 12 | loss: 0.0000224
	speed: 0.6284s/iter; left time: 22971.7965s
	iters: 300, epoch: 12 | loss: 0.0000027
	speed: 0.5931s/iter; left time: 21622.2786s
	iters: 400, epoch: 12 | loss: 0.0000009
	speed: 0.5767s/iter; left time: 20969.3473s
Epoch: 12 cost time: 249.78515648841858
Epoch: 12, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.109 Vali Acc: 0.982 Test Loss: 0.109 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0000201
	speed: 1.3727s/iter; left time: 49751.9851s
	iters: 200, epoch: 13 | loss: 0.0640464
	speed: 0.6658s/iter; left time: 24063.6253s
	iters: 300, epoch: 13 | loss: 0.0031035
	speed: 0.6492s/iter; left time: 23401.9607s
	iters: 400, epoch: 13 | loss: 0.0000121
	speed: 0.6251s/iter; left time: 22470.0885s
Epoch: 13 cost time: 273.03245401382446
Epoch: 13, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df256_ma28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9854479308776717
model parameter : 908554
model size : 8.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df256_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8437409
	speed: 0.6578s/iter; left time: 27103.0157s
	iters: 200, epoch: 1 | loss: 0.4172265
	speed: 0.5930s/iter; left time: 24374.4500s
	iters: 300, epoch: 1 | loss: 0.1078248
	speed: 0.6071s/iter; left time: 24889.6659s
	iters: 400, epoch: 1 | loss: 0.0177726
	speed: 0.7086s/iter; left time: 28980.9569s
Epoch: 1 cost time: 267.6673378944397
Epoch: 1, Steps: 413 | Train Loss: 0.639 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
Validation loss decreased (inf --> -0.977716).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0745994
	speed: 1.4716s/iter; left time: 60024.4504s
	iters: 200, epoch: 2 | loss: 0.0858464
	speed: 0.6652s/iter; left time: 27067.4815s
	iters: 300, epoch: 2 | loss: 0.0248619
	speed: 0.6475s/iter; left time: 26279.0098s
	iters: 400, epoch: 2 | loss: 0.1315097
	speed: 0.8020s/iter; left time: 32473.1939s
Epoch: 2 cost time: 293.7812285423279
Epoch: 2, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.067 Vali Acc: 0.977 Test Loss: 0.067 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0002557
	speed: 1.4355s/iter; left time: 57956.4944s
	iters: 200, epoch: 3 | loss: 0.0123956
	speed: 0.6780s/iter; left time: 27304.9325s
	iters: 300, epoch: 3 | loss: 0.0553577
	speed: 0.7010s/iter; left time: 28162.6502s
	iters: 400, epoch: 3 | loss: 0.0026381
	speed: 0.7787s/iter; left time: 31207.7595s
Epoch: 3 cost time: 293.4609549045563
Epoch: 3, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.052 Vali Acc: 0.981 Test Loss: 0.052 Test Acc: 0.981
Validation loss decreased (-0.977716 --> -0.980900).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0008840
	speed: 1.4230s/iter; left time: 56866.7830s
	iters: 200, epoch: 4 | loss: 0.0008007
	speed: 0.6580s/iter; left time: 26227.3310s
	iters: 300, epoch: 4 | loss: 0.0000923
	speed: 0.7632s/iter; left time: 30347.0473s
	iters: 400, epoch: 4 | loss: 0.0044085
	speed: 0.7243s/iter; left time: 28727.0099s
Epoch: 4 cost time: 295.0108780860901
Epoch: 4, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.060 Vali Acc: 0.977 Test Loss: 0.060 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0031001
	speed: 1.3831s/iter; left time: 54699.0296s
	iters: 200, epoch: 5 | loss: 0.0121272
	speed: 0.6486s/iter; left time: 25588.1537s
	iters: 300, epoch: 5 | loss: 0.0007722
	speed: 0.7016s/iter; left time: 27607.6842s
	iters: 400, epoch: 5 | loss: 0.0065089
	speed: 0.6711s/iter; left time: 26339.4794s
Epoch: 5 cost time: 277.00955271720886
Epoch: 5, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0004463
	speed: 1.4147s/iter; left time: 55364.5372s
	iters: 200, epoch: 6 | loss: 0.0195821
	speed: 0.6855s/iter; left time: 26760.6339s
	iters: 300, epoch: 6 | loss: 0.0511457
	speed: 0.7433s/iter; left time: 28942.7694s
	iters: 400, epoch: 6 | loss: 0.3556606
	speed: 0.7244s/iter; left time: 28134.6104s
Epoch: 6 cost time: 295.5796809196472
Epoch: 6, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.104 Vali Acc: 0.972 Test Loss: 0.104 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000506
	speed: 1.3571s/iter; left time: 52549.7774s
	iters: 200, epoch: 7 | loss: 0.0054791
	speed: 0.6540s/iter; left time: 25257.5584s
	iters: 300, epoch: 7 | loss: 0.0001993
	speed: 0.5909s/iter; left time: 22764.4281s
	iters: 400, epoch: 7 | loss: 0.0006426
	speed: 0.5713s/iter; left time: 21949.4858s
Epoch: 7 cost time: 257.2024953365326
Epoch: 7, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0117882
	speed: 1.3589s/iter; left time: 52058.8262s
	iters: 200, epoch: 8 | loss: 0.0001257
	speed: 0.6527s/iter; left time: 24940.0248s
	iters: 300, epoch: 8 | loss: 0.0005276
	speed: 0.6638s/iter; left time: 25297.0887s
	iters: 400, epoch: 8 | loss: 0.0000624
	speed: 0.6703s/iter; left time: 25477.4341s
Epoch: 8 cost time: 274.15918493270874
Epoch: 8, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.095 Vali Acc: 0.979 Test Loss: 0.095 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000866
	speed: 1.3097s/iter; left time: 49632.5121s
	iters: 200, epoch: 9 | loss: 0.0003277
	speed: 0.6663s/iter; left time: 25184.0192s
	iters: 300, epoch: 9 | loss: 0.0254137
	speed: 0.6676s/iter; left time: 25168.2914s
	iters: 400, epoch: 9 | loss: 0.0000576
	speed: 0.6243s/iter; left time: 23470.8790s
Epoch: 9 cost time: 266.1758232116699
Epoch: 9, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0000004
	speed: 1.2867s/iter; left time: 48230.7549s
	iters: 200, epoch: 10 | loss: 0.0009642
	speed: 0.6096s/iter; left time: 22788.7367s
	iters: 300, epoch: 10 | loss: 0.0000535
	speed: 0.6361s/iter; left time: 23716.2492s
	iters: 400, epoch: 10 | loss: 0.0088722
	speed: 0.6605s/iter; left time: 24560.1538s
Epoch: 10 cost time: 263.7597041130066
Epoch: 10, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.141 Vali Acc: 0.968 Test Loss: 0.141 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0000007
	speed: 1.2315s/iter; left time: 45652.1481s
	iters: 200, epoch: 11 | loss: 0.0001583
	speed: 0.6762s/iter; left time: 24999.4245s
	iters: 300, epoch: 11 | loss: 0.0000509
	speed: 0.6773s/iter; left time: 24972.4713s
	iters: 400, epoch: 11 | loss: 0.0005488
	speed: 0.6641s/iter; left time: 24418.2451s
Epoch: 11 cost time: 268.8920319080353
Epoch: 11, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.144 Vali Acc: 0.969 Test Loss: 0.144 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.1064041
	speed: 1.2914s/iter; left time: 47340.4486s
	iters: 200, epoch: 12 | loss: 0.0426875
	speed: 0.6921s/iter; left time: 25303.5021s
	iters: 300, epoch: 12 | loss: 0.0002956
	speed: 0.6078s/iter; left time: 22160.5427s
	iters: 400, epoch: 12 | loss: 0.0048734
	speed: 0.6463s/iter; left time: 23498.6245s
Epoch: 12 cost time: 267.65387988090515
Epoch: 12, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.216 Vali Acc: 0.966 Test Loss: 0.216 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0013701
	speed: 1.3045s/iter; left time: 47283.4058s
	iters: 200, epoch: 13 | loss: 0.0000910
	speed: 0.6450s/iter; left time: 23314.4920s
	iters: 300, epoch: 13 | loss: 0.0000116
	speed: 0.6615s/iter; left time: 23844.9000s
	iters: 400, epoch: 13 | loss: 0.0895801
	speed: 0.6472s/iter; left time: 23263.4950s
Epoch: 13 cost time: 271.37475657463074
Epoch: 13, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.265 Vali Acc: 0.959 Test Loss: 0.265 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df256_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9809004092769441
model parameter : 908554
model size : 8.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df256_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.3611319
	speed: 0.7277s/iter; left time: 29982.0435s
	iters: 200, epoch: 1 | loss: 0.2773736
	speed: 0.6675s/iter; left time: 27433.0304s
	iters: 300, epoch: 1 | loss: 0.2684341
	speed: 0.6489s/iter; left time: 26604.0819s
	iters: 400, epoch: 1 | loss: 0.0242058
	speed: 0.6823s/iter; left time: 27907.1988s
Epoch: 1 cost time: 281.28665113449097
Epoch: 1, Steps: 413 | Train Loss: 0.776 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
Validation loss decreased (inf --> -0.970440).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0876340
	speed: 1.2892s/iter; left time: 52582.4626s
	iters: 200, epoch: 2 | loss: 0.1933084
	speed: 0.6689s/iter; left time: 27216.3847s
	iters: 300, epoch: 2 | loss: 0.0071676
	speed: 0.6191s/iter; left time: 25129.4865s
	iters: 400, epoch: 2 | loss: 0.0497534
	speed: 0.6827s/iter; left time: 27640.2932s
Epoch: 2 cost time: 267.736456155777
Epoch: 2, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.075 Vali Acc: 0.974 Test Loss: 0.075 Test Acc: 0.974
Validation loss decreased (-0.970440 --> -0.974078).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0028240
	speed: 1.2723s/iter; left time: 51370.5999s
	iters: 200, epoch: 3 | loss: 0.0707958
	speed: 0.6402s/iter; left time: 25783.9476s
	iters: 300, epoch: 3 | loss: 0.0044084
	speed: 0.6360s/iter; left time: 25552.0872s
	iters: 400, epoch: 3 | loss: 0.1701017
	speed: 0.6089s/iter; left time: 24401.2977s
Epoch: 3 cost time: 260.12999629974365
Epoch: 3, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0004199
	speed: 1.3804s/iter; left time: 55164.2655s
	iters: 200, epoch: 4 | loss: 0.0036180
	speed: 0.6271s/iter; left time: 24997.0820s
	iters: 300, epoch: 4 | loss: 0.0047375
	speed: 0.6208s/iter; left time: 24683.1572s
	iters: 400, epoch: 4 | loss: 0.0044685
	speed: 0.6495s/iter; left time: 25761.3058s
Epoch: 4 cost time: 266.7401490211487
Epoch: 4, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0028337
	speed: 1.3080s/iter; left time: 51730.5053s
	iters: 200, epoch: 5 | loss: 0.0181734
	speed: 0.6803s/iter; left time: 26838.9404s
	iters: 300, epoch: 5 | loss: 0.0651625
	speed: 0.6467s/iter; left time: 25448.1867s
	iters: 400, epoch: 5 | loss: 0.0011043
	speed: 0.6011s/iter; left time: 23591.6294s
Epoch: 5 cost time: 262.8555133342743
Epoch: 5, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.125 Vali Acc: 0.972 Test Loss: 0.125 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0008070
	speed: 1.3172s/iter; left time: 51550.1454s
	iters: 200, epoch: 6 | loss: 0.0369576
	speed: 0.6805s/iter; left time: 26563.0490s
	iters: 300, epoch: 6 | loss: 0.1070478
	speed: 0.6167s/iter; left time: 24010.2823s
	iters: 400, epoch: 6 | loss: 0.0044833
	speed: 0.6247s/iter; left time: 24261.6008s
Epoch: 6 cost time: 273.14323377609253
Epoch: 6, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.319 Vali Acc: 0.942 Test Loss: 0.319 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0006099
	speed: 1.4441s/iter; left time: 55919.7301s
	iters: 200, epoch: 7 | loss: 0.0001921
	speed: 0.6741s/iter; left time: 26036.1571s
	iters: 300, epoch: 7 | loss: 0.0000592
	speed: 0.7258s/iter; left time: 27961.1371s
	iters: 400, epoch: 7 | loss: 0.0004139
	speed: 0.7133s/iter; left time: 27408.0957s
Epoch: 7 cost time: 289.4295916557312
Epoch: 7, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.125 Vali Acc: 0.969 Test Loss: 0.125 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0071718
	speed: 1.3128s/iter; left time: 50291.9522s
	iters: 200, epoch: 8 | loss: 0.0000088
	speed: 0.6464s/iter; left time: 24697.9601s
	iters: 300, epoch: 8 | loss: 0.0019938
	speed: 0.6122s/iter; left time: 23329.2922s
	iters: 400, epoch: 8 | loss: 0.2123558
	speed: 0.6259s/iter; left time: 23791.3988s
Epoch: 8 cost time: 261.556343793869
Epoch: 8, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.190 Vali Acc: 0.963 Test Loss: 0.190 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0000011
	speed: 1.3484s/iter; left time: 51099.1116s
	iters: 200, epoch: 9 | loss: 0.0001229
	speed: 0.6178s/iter; left time: 23352.5840s
	iters: 300, epoch: 9 | loss: 0.3796322
	speed: 0.6444s/iter; left time: 24292.3816s
	iters: 400, epoch: 9 | loss: 0.0000364
	speed: 0.6939s/iter; left time: 26089.1149s
Epoch: 9 cost time: 268.3320662975311
Epoch: 9, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0000406
	speed: 1.3976s/iter; left time: 52386.9411s
	iters: 200, epoch: 10 | loss: 0.0000063
	speed: 0.7319s/iter; left time: 27362.8773s
	iters: 300, epoch: 10 | loss: 0.0968321
	speed: 0.7253s/iter; left time: 27042.1860s
	iters: 400, epoch: 10 | loss: 0.0000133
	speed: 0.6958s/iter; left time: 25873.9120s
Epoch: 10 cost time: 294.51515913009644
Epoch: 10, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
Validation loss decreased (-0.974078 --> -0.975442).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000094
	speed: 1.4096s/iter; left time: 52254.0044s
	iters: 200, epoch: 11 | loss: 0.0000026
	speed: 0.6908s/iter; left time: 25540.7574s
	iters: 300, epoch: 11 | loss: 0.0557936
	speed: 0.6273s/iter; left time: 23129.7749s
	iters: 400, epoch: 11 | loss: 0.0131699
	speed: 0.6530s/iter; left time: 24013.0385s
Epoch: 11 cost time: 276.6412546634674
Epoch: 11, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.177 Vali Acc: 0.969 Test Loss: 0.177 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000085
	speed: 1.3490s/iter; left time: 49450.2956s
	iters: 200, epoch: 12 | loss: 0.0019901
	speed: 0.6902s/iter; left time: 25233.9488s
	iters: 300, epoch: 12 | loss: 0.0097005
	speed: 0.7578s/iter; left time: 27629.5015s
	iters: 400, epoch: 12 | loss: 0.0031200
	speed: 0.7551s/iter; left time: 27452.5252s
Epoch: 12 cost time: 297.8434896469116
Epoch: 12, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.167 Vali Acc: 0.971 Test Loss: 0.167 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.8640283
	speed: 1.3598s/iter; left time: 49287.5192s
	iters: 200, epoch: 13 | loss: 0.1459017
	speed: 0.6540s/iter; left time: 23639.1357s
	iters: 300, epoch: 13 | loss: 0.0000125
	speed: 0.6703s/iter; left time: 24161.6096s
	iters: 400, epoch: 13 | loss: 0.0152111
	speed: 0.6511s/iter; left time: 23403.8050s
Epoch: 13 cost time: 276.1981430053711
Epoch: 13, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0007407
	speed: 1.2568s/iter; left time: 45034.6184s
	iters: 200, epoch: 14 | loss: 0.0003081
	speed: 0.6489s/iter; left time: 23188.1526s
	iters: 300, epoch: 14 | loss: 0.0000035
	speed: 0.6874s/iter; left time: 24492.0272s
	iters: 400, epoch: 14 | loss: 0.0005838
	speed: 0.6485s/iter; left time: 23043.2115s
Epoch: 14 cost time: 267.06713795661926
Epoch: 14, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.216 Vali Acc: 0.971 Test Loss: 0.216 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.1724892
	speed: 1.3956s/iter; left time: 49430.6701s
	iters: 200, epoch: 15 | loss: 0.0000007
	speed: 0.6580s/iter; left time: 23238.5760s
	iters: 300, epoch: 15 | loss: 0.0002326
	speed: 0.6940s/iter; left time: 24443.5672s
	iters: 400, epoch: 15 | loss: 0.0046037
	speed: 0.7064s/iter; left time: 24808.7973s
Epoch: 15 cost time: 283.11770820617676
Epoch: 15, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.172 Vali Acc: 0.973 Test Loss: 0.172 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000076
	speed: 1.3759s/iter; left time: 48164.4599s
	iters: 200, epoch: 16 | loss: 0.0015787
	speed: 0.6841s/iter; left time: 23878.9712s
	iters: 300, epoch: 16 | loss: 0.2431959
	speed: 0.6750s/iter; left time: 23493.0177s
	iters: 400, epoch: 16 | loss: 0.0000002
	speed: 0.6655s/iter; left time: 23096.6055s
Epoch: 16 cost time: 281.7925055027008
Epoch: 16, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.239 Vali Acc: 0.969 Test Loss: 0.239 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0001755
	speed: 1.3053s/iter; left time: 45154.8019s
	iters: 200, epoch: 17 | loss: 0.0000033
	speed: 0.6539s/iter; left time: 22556.5434s
	iters: 300, epoch: 17 | loss: 0.0000014
	speed: 0.6296s/iter; left time: 21653.8783s
	iters: 400, epoch: 17 | loss: 0.0001541
	speed: 0.6517s/iter; left time: 22348.4407s
Epoch: 17 cost time: 267.44893503189087
Epoch: 17, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.161 Vali Acc: 0.979 Test Loss: 0.161 Test Acc: 0.979
Validation loss decreased (-0.975442 --> -0.978625).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.0241826
	speed: 1.4411s/iter; left time: 49258.4463s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.6832s/iter; left time: 23282.7119s
	iters: 300, epoch: 18 | loss: 0.0000002
	speed: 0.6847s/iter; left time: 23265.1470s
	iters: 400, epoch: 18 | loss: 0.0000023
	speed: 0.6759s/iter; left time: 22898.0195s
Epoch: 18 cost time: 285.33602356910706
Epoch: 18, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.139 Vali Acc: 0.978 Test Loss: 0.139 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.6868181
	speed: 1.4056s/iter; left time: 47462.6707s
	iters: 200, epoch: 19 | loss: 0.0000033
	speed: 0.6509s/iter; left time: 21914.0035s
	iters: 300, epoch: 19 | loss: 0.0633820
	speed: 0.6181s/iter; left time: 20748.9321s
	iters: 400, epoch: 19 | loss: 0.0000377
	speed: 0.6819s/iter; left time: 22821.2977s
Epoch: 19 cost time: 273.67447996139526
Epoch: 19, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.072 Vali Acc: 0.988 Test Loss: 0.072 Test Acc: 0.988
Validation loss decreased (-0.978625 --> -0.987721).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000038
	speed: 1.4087s/iter; left time: 46984.2207s
	iters: 200, epoch: 20 | loss: 0.0253684
	speed: 0.7123s/iter; left time: 23686.9359s
	iters: 300, epoch: 20 | loss: 0.0000081
	speed: 0.7209s/iter; left time: 23900.3162s
	iters: 400, epoch: 20 | loss: 0.0000069
	speed: 0.7479s/iter; left time: 24722.2807s
Epoch: 20 cost time: 302.56537556648254
Epoch: 20, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.135 Vali Acc: 0.976 Test Loss: 0.135 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000180
	speed: 1.3985s/iter; left time: 46069.2117s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.6910s/iter; left time: 22694.3563s
	iters: 300, epoch: 21 | loss: 0.0000044
	speed: 0.6896s/iter; left time: 22576.6602s
	iters: 400, epoch: 21 | loss: 0.0000757
	speed: 0.7419s/iter; left time: 24216.5486s
Epoch: 21 cost time: 291.4204761981964
Epoch: 21, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.234 Vali Acc: 0.969 Test Loss: 0.234 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000012
	speed: 1.4205s/iter; left time: 46205.8367s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.6931s/iter; left time: 22477.1593s
	iters: 300, epoch: 22 | loss: 0.0002070
	speed: 0.7163s/iter; left time: 23155.3560s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.6776s/iter; left time: 21837.8034s
Epoch: 22 cost time: 286.6344289779663
Epoch: 22, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.098 Vali Acc: 0.984 Test Loss: 0.098 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0000010
	speed: 1.3434s/iter; left time: 43141.7314s
	iters: 200, epoch: 23 | loss: 0.3938685
	speed: 0.6153s/iter; left time: 19697.7300s
	iters: 300, epoch: 23 | loss: 0.0000001
	speed: 0.6950s/iter; left time: 22182.0846s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.7318s/iter; left time: 23283.6792s
Epoch: 23 cost time: 280.0347378253937
Epoch: 23, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0000011
	speed: 1.4116s/iter; left time: 44749.8696s
	iters: 200, epoch: 24 | loss: 0.0000006
	speed: 0.6870s/iter; left time: 21711.9148s
	iters: 300, epoch: 24 | loss: 0.0000006
	speed: 0.6854s/iter; left time: 21590.2489s
	iters: 400, epoch: 24 | loss: 0.0000233
	speed: 0.7146s/iter; left time: 22439.5567s
Epoch: 24 cost time: 289.93007922172546
Epoch: 24, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.163 Vali Acc: 0.980 Test Loss: 0.163 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0000002
	speed: 1.4142s/iter; left time: 44249.4181s
	iters: 200, epoch: 25 | loss: 0.0011920
	speed: 0.7179s/iter; left time: 22390.1161s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.6786s/iter; left time: 21096.0963s
	iters: 400, epoch: 25 | loss: 0.0000007
	speed: 0.6717s/iter; left time: 20815.3336s
Epoch: 25 cost time: 285.21879744529724
Epoch: 25, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0000218
	speed: 1.4173s/iter; left time: 43759.3554s
	iters: 200, epoch: 26 | loss: 0.0053785
	speed: 0.6466s/iter; left time: 19899.7445s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.7218s/iter; left time: 22141.8071s
	iters: 400, epoch: 26 | loss: 0.0000105
	speed: 0.7002s/iter; left time: 21410.1960s
Epoch: 26 cost time: 282.87376141548157
Epoch: 26, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.168 Vali Acc: 0.970 Test Loss: 0.168 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 1.3195s/iter; left time: 40196.1272s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.6953s/iter; left time: 21110.2869s
	iters: 300, epoch: 27 | loss: 0.0000003
	speed: 0.7008s/iter; left time: 21208.5732s
	iters: 400, epoch: 27 | loss: 0.0000010
	speed: 0.6422s/iter; left time: 19369.9526s
Epoch: 27 cost time: 279.7560520172119
Epoch: 27, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.208 Vali Acc: 0.971 Test Loss: 0.208 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0000870
	speed: 1.3774s/iter; left time: 41391.8377s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.7192s/iter; left time: 21539.2067s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.6837s/iter; left time: 20407.0222s
	iters: 400, epoch: 28 | loss: 0.0000331
	speed: 0.7171s/iter; left time: 21334.9881s
Epoch: 28 cost time: 291.67441868782043
Epoch: 28, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.197 Vali Acc: 0.973 Test Loss: 0.197 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0000013
	speed: 1.3862s/iter; left time: 41081.9464s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.6969s/iter; left time: 20585.7907s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.6643s/iter; left time: 19554.6153s
	iters: 400, epoch: 29 | loss: 0.0002358
	speed: 0.6758s/iter; left time: 19825.8002s
Epoch: 29 cost time: 280.4726150035858
Epoch: 29, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.196 Vali Acc: 0.975 Test Loss: 0.196 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df256_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9877216916780355
model parameter : 908554
model size : 8.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.6302909
	speed: 0.7382s/iter; left time: 30414.8473s
	iters: 200, epoch: 1 | loss: 0.5045834
	speed: 0.7319s/iter; left time: 30079.8436s
	iters: 300, epoch: 1 | loss: 0.3326006
	speed: 0.7002s/iter; left time: 28710.2838s
	iters: 400, epoch: 1 | loss: 0.0390056
	speed: 0.7086s/iter; left time: 28981.7352s
Epoch: 1 cost time: 299.8831031322479
Epoch: 1, Steps: 413 | Train Loss: 0.813 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
Validation loss decreased (inf --> -0.969531).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1299109
	speed: 1.4504s/iter; left time: 59158.3746s
	iters: 200, epoch: 2 | loss: 0.3074076
	speed: 0.7052s/iter; left time: 28692.3389s
	iters: 300, epoch: 2 | loss: 0.0100364
	speed: 0.6788s/iter; left time: 27549.8663s
	iters: 400, epoch: 2 | loss: 0.2775822
	speed: 0.7138s/iter; left time: 28902.2133s
Epoch: 2 cost time: 288.61844277381897
Epoch: 2, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.100 Vali Acc: 0.962 Test Loss: 0.100 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0010069
	speed: 1.4651s/iter; left time: 59155.3374s
	iters: 200, epoch: 3 | loss: 0.0345647
	speed: 0.7513s/iter; left time: 30258.0279s
	iters: 300, epoch: 3 | loss: 0.0024879
	speed: 0.7198s/iter; left time: 28918.5964s
	iters: 400, epoch: 3 | loss: 0.0011134
	speed: 0.7412s/iter; left time: 29704.6745s
Epoch: 3 cost time: 302.38049244880676
Epoch: 3, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.070 Vali Acc: 0.978 Test Loss: 0.070 Test Acc: 0.978
Validation loss decreased (-0.969531 --> -0.977716).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0011348
	speed: 1.4204s/iter; left time: 56763.2577s
	iters: 200, epoch: 4 | loss: 0.0273749
	speed: 0.7642s/iter; left time: 30461.8792s
	iters: 300, epoch: 4 | loss: 0.0011746
	speed: 0.7434s/iter; left time: 29560.0441s
	iters: 400, epoch: 4 | loss: 0.0071426
	speed: 0.6928s/iter; left time: 27476.6123s
Epoch: 4 cost time: 300.55840015411377
Epoch: 4, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
Validation loss decreased (-0.977716 --> -0.978171).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0178354
	speed: 1.6471s/iter; left time: 65141.7131s
	iters: 200, epoch: 5 | loss: 0.0002041
	speed: 0.7858s/iter; left time: 31000.9885s
	iters: 300, epoch: 5 | loss: 0.0017598
	speed: 0.7928s/iter; left time: 31196.3146s
	iters: 400, epoch: 5 | loss: 0.1070209
	speed: 0.7294s/iter; left time: 28629.8968s
Epoch: 5 cost time: 324.63497948646545
Epoch: 5, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.129 Vali Acc: 0.966 Test Loss: 0.129 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.5458549
	speed: 1.5374s/iter; left time: 60167.4389s
	iters: 200, epoch: 6 | loss: 0.0003687
	speed: 0.7351s/iter; left time: 28696.2369s
	iters: 300, epoch: 6 | loss: 0.0002905
	speed: 0.7954s/iter; left time: 30968.8219s
	iters: 400, epoch: 6 | loss: 0.0006035
	speed: 0.8499s/iter; left time: 33006.6794s
Epoch: 6 cost time: 326.94278168678284
Epoch: 6, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.159 Vali Acc: 0.960 Test Loss: 0.159 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0002627
	speed: 1.6355s/iter; left time: 63331.7471s
	iters: 200, epoch: 7 | loss: 0.0000132
	speed: 0.8235s/iter; left time: 31806.1686s
	iters: 300, epoch: 7 | loss: 0.0005293
	speed: 0.7233s/iter; left time: 27863.8860s
	iters: 400, epoch: 7 | loss: 0.0050297
	speed: 0.7116s/iter; left time: 27340.5077s
Epoch: 7 cost time: 318.1720507144928
Epoch: 7, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0022914
	speed: 1.4244s/iter; left time: 54570.6376s
	iters: 200, epoch: 8 | loss: 0.0000024
	speed: 0.6416s/iter; left time: 24516.4785s
	iters: 300, epoch: 8 | loss: 0.0035712
	speed: 0.6123s/iter; left time: 23333.9552s
	iters: 400, epoch: 8 | loss: 0.0143260
	speed: 0.6844s/iter; left time: 26014.0501s
Epoch: 8 cost time: 273.37400579452515
Epoch: 8, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.136 Vali Acc: 0.969 Test Loss: 0.136 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000651
	speed: 1.5301s/iter; left time: 57987.7277s
	iters: 200, epoch: 9 | loss: 0.0106407
	speed: 0.7482s/iter; left time: 28279.9733s
	iters: 300, epoch: 9 | loss: 0.0149261
	speed: 0.8143s/iter; left time: 30697.2152s
	iters: 400, epoch: 9 | loss: 0.0000361
	speed: 0.7265s/iter; left time: 27312.6131s
Epoch: 9 cost time: 312.7783274650574
Epoch: 9, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0055280
	speed: 1.3021s/iter; left time: 48807.9246s
	iters: 200, epoch: 10 | loss: 0.0000019
	speed: 0.6135s/iter; left time: 22935.1626s
	iters: 300, epoch: 10 | loss: 0.0008013
	speed: 0.5712s/iter; left time: 21296.3394s
	iters: 400, epoch: 10 | loss: 0.0054837
	speed: 0.5989s/iter; left time: 22268.2471s
Epoch: 10 cost time: 246.97277855873108
Epoch: 10, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.225 Vali Acc: 0.960 Test Loss: 0.225 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000033
	speed: 1.3241s/iter; left time: 49086.8582s
	iters: 200, epoch: 11 | loss: 0.0026217
	speed: 0.6454s/iter; left time: 23862.4667s
	iters: 300, epoch: 11 | loss: 0.0006456
	speed: 0.6587s/iter; left time: 24285.7071s
	iters: 400, epoch: 11 | loss: 0.0000444
	speed: 0.6888s/iter; left time: 25327.0355s
Epoch: 11 cost time: 278.975225687027
Epoch: 11, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.284 Vali Acc: 0.958 Test Loss: 0.284 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0273903
	speed: 1.4386s/iter; left time: 52735.9780s
	iters: 200, epoch: 12 | loss: 0.0000221
	speed: 0.6594s/iter; left time: 24105.8223s
	iters: 300, epoch: 12 | loss: 0.0000013
	speed: 0.6996s/iter; left time: 25507.4505s
	iters: 400, epoch: 12 | loss: 0.0000124
	speed: 0.7290s/iter; left time: 26505.8494s
Epoch: 12 cost time: 286.86707615852356
Epoch: 12, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
Validation loss decreased (-0.978171 --> -0.981354).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000058
	speed: 1.3240s/iter; left time: 47989.1223s
	iters: 200, epoch: 13 | loss: 0.5642572
	speed: 0.6592s/iter; left time: 23827.9083s
	iters: 300, epoch: 13 | loss: 0.0000119
	speed: 0.6880s/iter; left time: 24800.1151s
	iters: 400, epoch: 13 | loss: 0.0800855
	speed: 0.6820s/iter; left time: 24512.9823s
Epoch: 13 cost time: 277.65367102622986
Epoch: 13, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0018265
	speed: 1.4425s/iter; left time: 51687.3055s
	iters: 200, epoch: 14 | loss: 0.0000001
	speed: 0.7117s/iter; left time: 25429.6633s
	iters: 300, epoch: 14 | loss: 0.0000227
	speed: 0.4781s/iter; left time: 17035.1060s
	iters: 400, epoch: 14 | loss: 0.0049483
	speed: 0.2717s/iter; left time: 9654.6327s
Epoch: 14 cost time: 225.44517040252686
Epoch: 14, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.194 Vali Acc: 0.970 Test Loss: 0.194 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.1749289
	speed: 0.5013s/iter; left time: 17755.2265s
	iters: 200, epoch: 15 | loss: 0.0000001
	speed: 0.2697s/iter; left time: 9525.2886s
	iters: 300, epoch: 15 | loss: 0.0000172
	speed: 0.2782s/iter; left time: 9798.8580s
	iters: 400, epoch: 15 | loss: 0.0001539
	speed: 0.2705s/iter; left time: 9500.2823s
Epoch: 15 cost time: 111.44267988204956
Epoch: 15, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.209 Vali Acc: 0.963 Test Loss: 0.209 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.5093s/iter; left time: 17826.9417s
	iters: 200, epoch: 16 | loss: 0.0000072
	speed: 0.2817s/iter; left time: 9832.3381s
	iters: 300, epoch: 16 | loss: 0.0000011
	speed: 0.2727s/iter; left time: 9490.9687s
	iters: 400, epoch: 16 | loss: 0.0000001
	speed: 0.2789s/iter; left time: 9679.2313s
Epoch: 16 cost time: 112.71282076835632
Epoch: 16, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.5490s/iter; left time: 18991.6267s
	iters: 200, epoch: 17 | loss: 0.0000326
	speed: 0.2779s/iter; left time: 9584.6243s
	iters: 300, epoch: 17 | loss: 0.0007043
	speed: 0.2706s/iter; left time: 9306.6220s
	iters: 400, epoch: 17 | loss: 0.0000014
	speed: 0.2609s/iter; left time: 8948.3690s
Epoch: 17 cost time: 113.83787775039673
Epoch: 17, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.215 Vali Acc: 0.968 Test Loss: 0.215 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000002
	speed: 0.5446s/iter; left time: 18613.0916s
	iters: 200, epoch: 18 | loss: 0.0000140
	speed: 0.2811s/iter; left time: 9579.4348s
	iters: 300, epoch: 18 | loss: 0.0001348
	speed: 0.3227s/iter; left time: 10965.7574s
	iters: 400, epoch: 18 | loss: 0.0000025
	speed: 0.3197s/iter; left time: 10830.7358s
Epoch: 18 cost time: 124.43878126144409
Epoch: 18, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.202 Vali Acc: 0.969 Test Loss: 0.202 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000039
	speed: 0.6790s/iter; left time: 22929.1137s
	iters: 200, epoch: 19 | loss: 0.0028648
	speed: 0.3443s/iter; left time: 11592.3925s
	iters: 300, epoch: 19 | loss: 0.0001675
	speed: 0.3635s/iter; left time: 12202.3409s
	iters: 400, epoch: 19 | loss: 0.0000001
	speed: 0.3591s/iter; left time: 12018.2930s
Epoch: 19 cost time: 146.55020236968994
Epoch: 19, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000188
	speed: 0.7541s/iter; left time: 25152.1446s
	iters: 200, epoch: 20 | loss: 0.0000007
	speed: 0.3532s/iter; left time: 11743.9215s
	iters: 300, epoch: 20 | loss: 0.0000000
	speed: 0.3543s/iter; left time: 11747.4298s
	iters: 400, epoch: 20 | loss: 0.0000010
	speed: 0.3568s/iter; left time: 11792.4931s
Epoch: 20 cost time: 147.02439498901367
Epoch: 20, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.265 Vali Acc: 0.962 Test Loss: 0.265 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0116783
	speed: 0.7605s/iter; left time: 25052.8349s
	iters: 200, epoch: 21 | loss: 0.0044662
	speed: 0.3425s/iter; left time: 11246.6712s
	iters: 300, epoch: 21 | loss: 0.0035546
	speed: 0.3405s/iter; left time: 11148.1183s
	iters: 400, epoch: 21 | loss: 0.0000003
	speed: 0.3327s/iter; left time: 10858.4559s
Epoch: 21 cost time: 142.09091758728027
Epoch: 21, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.150 Vali Acc: 0.979 Test Loss: 0.150 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0001142
	speed: 0.7204s/iter; left time: 23433.1033s
	iters: 200, epoch: 22 | loss: 0.0000306
	speed: 0.3561s/iter; left time: 11547.9412s
	iters: 300, epoch: 22 | loss: 0.0000011
	speed: 0.3497s/iter; left time: 11304.3641s
	iters: 400, epoch: 22 | loss: 0.0000807
	speed: 0.3540s/iter; left time: 11408.7175s
Epoch: 22 cost time: 145.48772883415222
Epoch: 22, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.312 Vali Acc: 0.958 Test Loss: 0.312 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9813551614370168
model parameter : 908554
model size : 8.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.5979894
	speed: 0.3679s/iter; left time: 15155.9240s
	iters: 200, epoch: 1 | loss: 0.3337224
	speed: 0.3394s/iter; left time: 13947.7789s
	iters: 300, epoch: 1 | loss: 0.2688445
	speed: 0.3404s/iter; left time: 13956.1026s
	iters: 400, epoch: 1 | loss: 0.0480131
	speed: 0.3137s/iter; left time: 12832.1519s
Epoch: 1 cost time: 140.6753695011139
Epoch: 1, Steps: 413 | Train Loss: 0.799 Vali Loss: 0.098 Vali Acc: 0.972 Test Loss: 0.098 Test Acc: 0.972
Validation loss decreased (inf --> -0.972259).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0545851
	speed: 0.6843s/iter; left time: 27909.5832s
	iters: 200, epoch: 2 | loss: 0.3085415
	speed: 0.3239s/iter; left time: 13177.3009s
	iters: 300, epoch: 2 | loss: 0.0021789
	speed: 0.3222s/iter; left time: 13077.9186s
	iters: 400, epoch: 2 | loss: 0.1694580
	speed: 0.3463s/iter; left time: 14019.1226s
Epoch: 2 cost time: 136.37732648849487
Epoch: 2, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.075 Vali Acc: 0.970 Test Loss: 0.075 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0036762
	speed: 0.7335s/iter; left time: 29614.0621s
	iters: 200, epoch: 3 | loss: 0.0188255
	speed: 0.3430s/iter; left time: 13815.4790s
	iters: 300, epoch: 3 | loss: 0.0136146
	speed: 0.3413s/iter; left time: 13711.8923s
	iters: 400, epoch: 3 | loss: 0.0013482
	speed: 0.3367s/iter; left time: 13492.3151s
Epoch: 3 cost time: 142.3448405265808
Epoch: 3, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.080 Vali Acc: 0.970 Test Loss: 0.080 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0007443
	speed: 0.7251s/iter; left time: 28975.0817s
	iters: 200, epoch: 4 | loss: 0.0032186
	speed: 0.3486s/iter; left time: 13895.9401s
	iters: 300, epoch: 4 | loss: 0.0007733
	speed: 0.3373s/iter; left time: 13412.2143s
	iters: 400, epoch: 4 | loss: 0.0081611
	speed: 0.3334s/iter; left time: 13224.4371s
Epoch: 4 cost time: 141.13129687309265
Epoch: 4, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.168 Vali Acc: 0.965 Test Loss: 0.168 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0137613
	speed: 0.7110s/iter; left time: 28118.1962s
	iters: 200, epoch: 5 | loss: 0.0106588
	speed: 0.3383s/iter; left time: 13346.0635s
	iters: 300, epoch: 5 | loss: 0.2266528
	speed: 0.3318s/iter; left time: 13054.2709s
	iters: 400, epoch: 5 | loss: 0.0128710
	speed: 0.3394s/iter; left time: 13322.1212s
Epoch: 5 cost time: 140.46795201301575
Epoch: 5, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.116 Vali Acc: 0.971 Test Loss: 0.116 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0444521
	speed: 0.7191s/iter; left time: 28141.9132s
	iters: 200, epoch: 6 | loss: 0.0022952
	speed: 0.3397s/iter; left time: 13259.3653s
	iters: 300, epoch: 6 | loss: 0.0011964
	speed: 0.3395s/iter; left time: 13219.9107s
	iters: 400, epoch: 6 | loss: 0.3476378
	speed: 0.3472s/iter; left time: 13483.4670s
Epoch: 6 cost time: 141.31854128837585
Epoch: 6, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.160 Vali Acc: 0.966 Test Loss: 0.160 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0015652
	speed: 0.7166s/iter; left time: 27750.6932s
	iters: 200, epoch: 7 | loss: 0.0000081
	speed: 0.3341s/iter; left time: 12903.3771s
	iters: 300, epoch: 7 | loss: 0.0001133
	speed: 0.3263s/iter; left time: 12569.8881s
	iters: 400, epoch: 7 | loss: 0.0281152
	speed: 0.3313s/iter; left time: 12729.0278s
Epoch: 7 cost time: 138.63867712020874
Epoch: 7, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.156 Vali Acc: 0.964 Test Loss: 0.156 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 0.1858246
	speed: 0.7480s/iter; left time: 28657.3771s
	iters: 200, epoch: 8 | loss: 0.0000136
	speed: 0.3616s/iter; left time: 13817.8121s
	iters: 300, epoch: 8 | loss: 0.0113237
	speed: 0.3733s/iter; left time: 14226.0284s
	iters: 400, epoch: 8 | loss: 0.0085981
	speed: 0.3767s/iter; left time: 14316.9085s
Epoch: 8 cost time: 150.61483097076416
Epoch: 8, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 0.0000008
	speed: 0.7947s/iter; left time: 30115.1549s
	iters: 200, epoch: 9 | loss: 0.0000000
	speed: 0.3865s/iter; left time: 14609.1359s
	iters: 300, epoch: 9 | loss: 0.0212936
	speed: 0.3551s/iter; left time: 13385.6875s
	iters: 400, epoch: 9 | loss: 0.0000048
	speed: 0.3470s/iter; left time: 13047.0034s
Epoch: 9 cost time: 152.5877983570099
Epoch: 9, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.191 Vali Acc: 0.960 Test Loss: 0.191 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 0.1885080
	speed: 0.7789s/iter; left time: 29194.6643s
	iters: 200, epoch: 10 | loss: 0.0000065
	speed: 0.3388s/iter; left time: 12665.1725s
	iters: 300, epoch: 10 | loss: 0.0000137
	speed: 0.3363s/iter; left time: 12537.0000s
	iters: 400, epoch: 10 | loss: 0.0008745
	speed: 0.3545s/iter; left time: 13181.4399s
Epoch: 10 cost time: 144.629004240036
Epoch: 10, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.140 Vali Acc: 0.966 Test Loss: 0.140 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 0.0000503
	speed: 0.7528s/iter; left time: 27905.3548s
	iters: 200, epoch: 11 | loss: 0.0006022
	speed: 0.3428s/iter; left time: 12673.6278s
	iters: 300, epoch: 11 | loss: 0.0000097
	speed: 0.3529s/iter; left time: 13013.1641s
	iters: 400, epoch: 11 | loss: 0.0000170
	speed: 0.3828s/iter; left time: 14076.9044s
Epoch: 11 cost time: 148.74478673934937
Epoch: 11, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.224 Vali Acc: 0.967 Test Loss: 0.224 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9722601182355616
model parameter : 908554
model size : 8.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.6091232
	speed: 0.3761s/iter; left time: 15495.1967s
	iters: 200, epoch: 1 | loss: 0.3378673
	speed: 0.3630s/iter; left time: 14921.1316s
	iters: 300, epoch: 1 | loss: 0.3691305
	speed: 0.3648s/iter; left time: 14957.3386s
	iters: 400, epoch: 1 | loss: 0.1042674
	speed: 0.3642s/iter; left time: 14897.2430s
Epoch: 1 cost time: 151.7662410736084
Epoch: 1, Steps: 413 | Train Loss: 0.793 Vali Loss: 0.096 Vali Acc: 0.971 Test Loss: 0.096 Test Acc: 0.971
Validation loss decreased (inf --> -0.970895).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0790495
	speed: 0.7392s/iter; left time: 30151.5934s
	iters: 200, epoch: 2 | loss: 0.3910913
	speed: 0.3746s/iter; left time: 15243.7353s
	iters: 300, epoch: 2 | loss: 0.0037444
	speed: 0.3743s/iter; left time: 15194.0106s
	iters: 400, epoch: 2 | loss: 0.2493026
	speed: 0.3476s/iter; left time: 14073.6615s
Epoch: 2 cost time: 149.36705589294434
Epoch: 2, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.095 Vali Acc: 0.963 Test Loss: 0.095 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0037483
	speed: 0.7279s/iter; left time: 29387.1473s
	iters: 200, epoch: 3 | loss: 0.1517016
	speed: 0.3858s/iter; left time: 15537.1589s
	iters: 300, epoch: 3 | loss: 0.0118353
	speed: 0.3864s/iter; left time: 15523.7689s
	iters: 400, epoch: 3 | loss: 0.0009130
	speed: 0.4002s/iter; left time: 16036.6923s
Epoch: 3 cost time: 158.26420903205872
Epoch: 3, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.970895 --> -0.972714).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0003344
	speed: 0.8618s/iter; left time: 34439.5172s
	iters: 200, epoch: 4 | loss: 0.0065009
	speed: 0.4081s/iter; left time: 16267.9254s
	iters: 300, epoch: 4 | loss: 0.0001062
	speed: 0.4078s/iter; left time: 16216.1102s
	iters: 400, epoch: 4 | loss: 0.0230195
	speed: 0.4329s/iter; left time: 17169.2554s
Epoch: 4 cost time: 171.15159583091736
Epoch: 4, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.111 Vali Acc: 0.972 Test Loss: 0.111 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0234801
	speed: 0.8613s/iter; left time: 34064.3609s
	iters: 200, epoch: 5 | loss: 0.3925945
	speed: 0.3799s/iter; left time: 14986.5769s
	iters: 300, epoch: 5 | loss: 0.0082126
	speed: 0.3906s/iter; left time: 15370.8165s
	iters: 400, epoch: 5 | loss: 0.0018902
	speed: 0.4080s/iter; left time: 16014.9973s
Epoch: 5 cost time: 161.80827522277832
Epoch: 5, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.190 Vali Acc: 0.955 Test Loss: 0.190 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0187104
	speed: 0.8054s/iter; left time: 31518.7024s
	iters: 200, epoch: 6 | loss: 0.2045224
	speed: 0.4049s/iter; left time: 15804.1490s
	iters: 300, epoch: 6 | loss: 0.0039609
	speed: 0.4306s/iter; left time: 16765.5196s
	iters: 400, epoch: 6 | loss: 0.0021854
	speed: 0.4187s/iter; left time: 16260.1753s
Epoch: 6 cost time: 169.37968015670776
Epoch: 6, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.128 Vali Acc: 0.960 Test Loss: 0.128 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.1895045
	speed: 0.8705s/iter; left time: 33706.6213s
	iters: 200, epoch: 7 | loss: 0.0010751
	speed: 0.4443s/iter; left time: 17158.8615s
	iters: 300, epoch: 7 | loss: 0.0000528
	speed: 0.4155s/iter; left time: 16006.6500s
	iters: 400, epoch: 7 | loss: 0.0160005
	speed: 0.3935s/iter; left time: 15119.1958s
Epoch: 7 cost time: 174.11623573303223
Epoch: 7, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.196 Vali Acc: 0.964 Test Loss: 0.196 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0047822
	speed: 0.8604s/iter; left time: 32962.7014s
	iters: 200, epoch: 8 | loss: 0.0000035
	speed: 0.3858s/iter; left time: 14741.0315s
	iters: 300, epoch: 8 | loss: 0.0002905
	speed: 0.3790s/iter; left time: 14444.8027s
	iters: 400, epoch: 8 | loss: 0.1923038
	speed: 0.3931s/iter; left time: 14943.0398s
Epoch: 8 cost time: 160.68686413764954
Epoch: 8, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000029
	speed: 0.8737s/iter; left time: 33111.4817s
	iters: 200, epoch: 9 | loss: 0.0000492
	speed: 0.4161s/iter; left time: 15726.7665s
	iters: 300, epoch: 9 | loss: 0.2351978
	speed: 0.3900s/iter; left time: 14702.9305s
	iters: 400, epoch: 9 | loss: 0.0000207
	speed: 0.3765s/iter; left time: 14155.4121s
Epoch: 9 cost time: 164.83655047416687
Epoch: 9, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.972714 --> -0.980445).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000045
	speed: 0.8774s/iter; left time: 32889.1644s
	iters: 200, epoch: 10 | loss: 0.0000148
	speed: 0.4020s/iter; left time: 15027.9808s
	iters: 300, epoch: 10 | loss: 0.0292742
	speed: 0.3991s/iter; left time: 14881.6103s
	iters: 400, epoch: 10 | loss: 0.0000001
	speed: 0.4379s/iter; left time: 16284.5142s
Epoch: 10 cost time: 173.0369098186493
Epoch: 10, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.282 Vali Acc: 0.948 Test Loss: 0.282 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000308
	speed: 0.8660s/iter; left time: 32103.1379s
	iters: 200, epoch: 11 | loss: 0.0000020
	speed: 0.3912s/iter; left time: 14464.5006s
	iters: 300, epoch: 11 | loss: 0.0007816
	speed: 0.3957s/iter; left time: 14590.5902s
	iters: 400, epoch: 11 | loss: 0.0156955
	speed: 0.4085s/iter; left time: 15019.4637s
Epoch: 11 cost time: 164.4745922088623
Epoch: 11, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.980445 --> -0.980445).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000914
	speed: 0.8398s/iter; left time: 30786.2206s
	iters: 200, epoch: 12 | loss: 0.0000074
	speed: 0.3724s/iter; left time: 13613.3899s
	iters: 300, epoch: 12 | loss: 0.1877158
	speed: 0.3813s/iter; left time: 13900.8476s
	iters: 400, epoch: 12 | loss: 0.0000123
	speed: 0.4038s/iter; left time: 14682.7509s
Epoch: 12 cost time: 161.08002924919128
Epoch: 12, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.089 Vali Acc: 0.981 Test Loss: 0.089 Test Acc: 0.981
Validation loss decreased (-0.980445 --> -0.980900).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.8192s/iter; left time: 29691.4523s
	iters: 200, epoch: 13 | loss: 0.0002540
	speed: 0.3715s/iter; left time: 13427.7752s
	iters: 300, epoch: 13 | loss: 0.0000059
	speed: 0.3881s/iter; left time: 13990.4327s
	iters: 400, epoch: 13 | loss: 0.0002257
	speed: 0.4164s/iter; left time: 14968.4458s
Epoch: 13 cost time: 162.49981832504272
Epoch: 13, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.222 Vali Acc: 0.955 Test Loss: 0.222 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000001
	speed: 0.8899s/iter; left time: 31886.0210s
	iters: 200, epoch: 14 | loss: 0.0001845
	speed: 0.3957s/iter; left time: 14139.7974s
	iters: 300, epoch: 14 | loss: 0.0006116
	speed: 0.4047s/iter; left time: 14420.8572s
	iters: 400, epoch: 14 | loss: 0.0012046
	speed: 0.4108s/iter; left time: 14597.2356s
Epoch: 14 cost time: 168.831045627594
Epoch: 14, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.197 Vali Acc: 0.976 Test Loss: 0.197 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000993
	speed: 0.8596s/iter; left time: 30445.3567s
	iters: 200, epoch: 15 | loss: 0.0000507
	speed: 0.4068s/iter; left time: 14366.5611s
	iters: 300, epoch: 15 | loss: 0.0000003
	speed: 0.4314s/iter; left time: 15193.1322s
	iters: 400, epoch: 15 | loss: 0.0000007
	speed: 0.4242s/iter; left time: 14898.8927s
Epoch: 15 cost time: 171.0500419139862
Epoch: 15, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.192 Vali Acc: 0.974 Test Loss: 0.192 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0023347
	speed: 0.8557s/iter; left time: 29955.8177s
	iters: 200, epoch: 16 | loss: 0.0000047
	speed: 0.4004s/iter; left time: 13974.8528s
	iters: 300, epoch: 16 | loss: 0.0000011
	speed: 0.4060s/iter; left time: 14131.9998s
	iters: 400, epoch: 16 | loss: 0.0000782
	speed: 0.3964s/iter; left time: 13756.4513s
Epoch: 16 cost time: 166.2108292579651
Epoch: 16, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.8431s/iter; left time: 29163.8378s
	iters: 200, epoch: 17 | loss: 0.0000001
	speed: 0.4128s/iter; left time: 14237.8501s
	iters: 300, epoch: 17 | loss: 0.0004615
	speed: 0.4250s/iter; left time: 14617.2639s
	iters: 400, epoch: 17 | loss: 0.0002888
	speed: 0.4069s/iter; left time: 13953.0653s
Epoch: 17 cost time: 170.5054953098297
Epoch: 17, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.098 Vali Acc: 0.979 Test Loss: 0.098 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000874
	speed: 0.9425s/iter; left time: 32214.8233s
	iters: 200, epoch: 18 | loss: 0.0003969
	speed: 0.4122s/iter; left time: 14049.2365s
	iters: 300, epoch: 18 | loss: 0.0001187
	speed: 0.3929s/iter; left time: 13351.2885s
	iters: 400, epoch: 18 | loss: 0.0000086
	speed: 0.3937s/iter; left time: 13339.7655s
Epoch: 18 cost time: 170.05697417259216
Epoch: 18, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.185 Vali Acc: 0.971 Test Loss: 0.185 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000098
	speed: 0.8258s/iter; left time: 27885.9873s
	iters: 200, epoch: 19 | loss: 0.0000038
	speed: 0.3965s/iter; left time: 13350.5029s
	iters: 300, epoch: 19 | loss: 0.0002720
	speed: 0.4118s/iter; left time: 13821.7608s
	iters: 400, epoch: 19 | loss: 0.0000053
	speed: 0.4531s/iter; left time: 15163.9160s
Epoch: 19 cost time: 169.65640258789062
Epoch: 19, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.179 Vali Acc: 0.975 Test Loss: 0.179 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000054
	speed: 0.8732s/iter; left time: 29123.6348s
	iters: 200, epoch: 20 | loss: 0.0000002
	speed: 0.3962s/iter; left time: 13176.3719s
	iters: 300, epoch: 20 | loss: 0.0015733
	speed: 0.4442s/iter; left time: 14725.6159s
	iters: 400, epoch: 20 | loss: 0.0011710
	speed: 0.4182s/iter; left time: 13822.3790s
Epoch: 20 cost time: 172.3767204284668
Epoch: 20, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.139 Vali Acc: 0.975 Test Loss: 0.139 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000001
	speed: 0.8181s/iter; left time: 26950.6403s
	iters: 200, epoch: 21 | loss: 0.0000389
	speed: 0.4113s/iter; left time: 13506.9213s
	iters: 300, epoch: 21 | loss: 0.7287926
	speed: 0.3965s/iter; left time: 12981.4537s
	iters: 400, epoch: 21 | loss: 0.0000007
	speed: 0.4016s/iter; left time: 13108.8246s
Epoch: 21 cost time: 164.82051634788513
Epoch: 21, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.152 Vali Acc: 0.974 Test Loss: 0.152 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0012328
	speed: 0.8948s/iter; left time: 29105.2129s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.4475s/iter; left time: 14512.1130s
	iters: 300, epoch: 22 | loss: 0.0000191
	speed: 0.4403s/iter; left time: 14233.2570s
	iters: 400, epoch: 22 | loss: 0.0003068
	speed: 0.4016s/iter; left time: 12942.1346s
Epoch: 22 cost time: 180.43134212493896
Epoch: 22, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.145 Vali Acc: 0.977 Test Loss: 0.145 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9809004092769441
model parameter : 908554
model size : 8.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.3034391
	speed: 0.4215s/iter; left time: 17365.7565s
	iters: 200, epoch: 1 | loss: 2.3012826
	speed: 0.3841s/iter; left time: 15787.2543s
	iters: 300, epoch: 1 | loss: 2.3053384
	speed: 0.3843s/iter; left time: 15757.0637s
	iters: 400, epoch: 1 | loss: 2.3032720
	speed: 0.4007s/iter; left time: 16387.2942s
Epoch: 1 cost time: 164.76355028152466
Epoch: 1, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (inf --> -0.100022).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3020678
	speed: 0.8675s/iter; left time: 35381.5535s
	iters: 200, epoch: 2 | loss: 2.3005252
	speed: 0.3829s/iter; left time: 15580.3558s
	iters: 300, epoch: 2 | loss: 2.3043034
	speed: 0.4325s/iter; left time: 17553.2391s
	iters: 400, epoch: 2 | loss: 2.3039255
	speed: 0.4338s/iter; left time: 17563.5025s
Epoch: 2 cost time: 170.70901322364807
Epoch: 2, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3036206
	speed: 0.8318s/iter; left time: 33582.8566s
	iters: 200, epoch: 3 | loss: 2.3037574
	speed: 0.3983s/iter; left time: 16040.0362s
	iters: 300, epoch: 3 | loss: 2.3037875
	speed: 0.3903s/iter; left time: 15679.7140s
	iters: 400, epoch: 3 | loss: 2.3029132
	speed: 0.3867s/iter; left time: 15498.4511s
Epoch: 3 cost time: 160.89999842643738
Epoch: 3, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3038368
	speed: 0.8595s/iter; left time: 34347.5719s
	iters: 200, epoch: 4 | loss: 2.3021245
	speed: 0.4508s/iter; left time: 17968.8140s
	iters: 300, epoch: 4 | loss: 2.3038139
	speed: 0.4363s/iter; left time: 17348.2317s
	iters: 400, epoch: 4 | loss: 2.3024862
	speed: 0.3993s/iter; left time: 15838.7238s
Epoch: 4 cost time: 176.36975359916687
Epoch: 4, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.3059175
	speed: 0.9120s/iter; left time: 36066.8018s
	iters: 200, epoch: 5 | loss: 2.3008876
	speed: 0.3902s/iter; left time: 15391.1778s
	iters: 300, epoch: 5 | loss: 2.3021297
	speed: 0.3888s/iter; left time: 15300.1742s
	iters: 400, epoch: 5 | loss: 2.3055151
	speed: 0.4083s/iter; left time: 16025.7941s
Epoch: 5 cost time: 168.28771662712097
Epoch: 5, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.3022771
	speed: 0.8367s/iter; left time: 32745.3422s
	iters: 200, epoch: 6 | loss: 2.2978609
	speed: 0.3766s/iter; left time: 14699.9655s
	iters: 300, epoch: 6 | loss: 2.3024359
	speed: 0.4299s/iter; left time: 16737.2018s
	iters: 400, epoch: 6 | loss: 2.3031950
	speed: 0.4448s/iter; left time: 17273.0703s
Epoch: 6 cost time: 169.7770802974701
Epoch: 6, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 2.3042123
	speed: 0.8613s/iter; left time: 33353.7801s
	iters: 200, epoch: 7 | loss: 2.3047276
	speed: 0.4200s/iter; left time: 16219.9269s
	iters: 300, epoch: 7 | loss: 2.2998631
	speed: 0.3881s/iter; left time: 14951.1685s
	iters: 400, epoch: 7 | loss: 2.3024673
	speed: 0.3916s/iter; left time: 15046.8108s
Epoch: 7 cost time: 163.69523119926453
Epoch: 7, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 2.3052833
	speed: 0.8015s/iter; left time: 30705.7148s
	iters: 200, epoch: 8 | loss: 2.3012199
	speed: 0.4049s/iter; left time: 15469.7076s
	iters: 300, epoch: 8 | loss: 2.3032231
	speed: 0.4096s/iter; left time: 15608.6556s
	iters: 400, epoch: 8 | loss: 2.3044615
	speed: 0.3970s/iter; left time: 15091.6144s
Epoch: 8 cost time: 164.58080959320068
Epoch: 8, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 2.3031037
	speed: 0.8820s/iter; left time: 33424.4849s
	iters: 200, epoch: 9 | loss: 2.3036990
	speed: 0.4458s/iter; left time: 16848.1111s
	iters: 300, epoch: 9 | loss: 2.3029211
	speed: 0.4023s/iter; left time: 15165.9504s
	iters: 400, epoch: 9 | loss: 2.3038614
	speed: 0.4055s/iter; left time: 15244.5107s
Epoch: 9 cost time: 175.53926491737366
Epoch: 9, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 2.3005161
	speed: 0.8393s/iter; left time: 31461.7953s
	iters: 200, epoch: 10 | loss: 2.3076916
	speed: 0.3843s/iter; left time: 14365.1783s
	iters: 300, epoch: 10 | loss: 2.2990332
	speed: 0.3782s/iter; left time: 14102.1263s
	iters: 400, epoch: 10 | loss: 2.3020427
	speed: 0.4066s/iter; left time: 15120.6772s
Epoch: 10 cost time: 161.20894694328308
Epoch: 10, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 2.3050570
	speed: 0.9304s/iter; left time: 34490.3511s
	iters: 200, epoch: 11 | loss: 2.3015661
	speed: 0.4198s/iter; left time: 15521.2232s
	iters: 300, epoch: 11 | loss: 2.3008804
	speed: 0.4370s/iter; left time: 16114.2010s
	iters: 400, epoch: 11 | loss: 2.3017094
	speed: 0.4656s/iter; left time: 17119.3205s
Epoch: 11 cost time: 183.99495911598206
Epoch: 11, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 2.3042221
	speed: 0.8292s/iter; left time: 30396.5760s
	iters: 200, epoch: 12 | loss: 2.3027506
	speed: 0.4236s/iter; left time: 15486.4088s
	iters: 300, epoch: 12 | loss: 2.3094826
	speed: 0.4102s/iter; left time: 14955.9713s
	iters: 400, epoch: 12 | loss: 2.3020008
	speed: 0.3818s/iter; left time: 13881.1567s
Epoch: 12 cost time: 166.27599239349365
Epoch: 12, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 2.3018854
	speed: 0.8787s/iter; left time: 31847.7066s
	iters: 200, epoch: 13 | loss: 2.3005662
	speed: 0.4645s/iter; left time: 16789.0362s
	iters: 300, epoch: 13 | loss: 2.3024139
	speed: 0.4350s/iter; left time: 15679.7778s
	iters: 400, epoch: 13 | loss: 2.3036761
	speed: 0.4440s/iter; left time: 15961.1542s
Epoch: 13 cost time: 185.25294423103333
Epoch: 13, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 2.3025706
	speed: 0.8561s/iter; left time: 30676.1282s
	iters: 200, epoch: 14 | loss: 2.3021541
	speed: 0.4235s/iter; left time: 15132.1086s
	iters: 300, epoch: 14 | loss: 2.3037052
	speed: 0.3975s/iter; left time: 14164.0355s
	iters: 400, epoch: 14 | loss: 2.3038681
	speed: 0.4327s/iter; left time: 15373.8307s
Epoch: 14 cost time: 172.7472484111786
Epoch: 14, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.10004547521600728
model parameter : 908554
model size : 8.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         47                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df128_ma47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5987972
	speed: 0.4734s/iter; left time: 19503.8367s
	iters: 200, epoch: 1 | loss: 0.0654942
	speed: 0.4946s/iter; left time: 20329.0023s
	iters: 300, epoch: 1 | loss: 0.0696974
	speed: 0.4661s/iter; left time: 19112.4423s
	iters: 400, epoch: 1 | loss: 0.1451039
	speed: 0.4143s/iter; left time: 16946.5682s
Epoch: 1 cost time: 190.70983386039734
Epoch: 1, Steps: 413 | Train Loss: 0.486 Vali Loss: 0.068 Vali Acc: 0.982 Test Loss: 0.068 Test Acc: 0.982
Validation loss decreased (inf --> -0.982264).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0629701
	speed: 0.8987s/iter; left time: 36656.9085s
	iters: 200, epoch: 2 | loss: 0.0121478
	speed: 0.4187s/iter; left time: 17035.1205s
	iters: 300, epoch: 2 | loss: 0.0281955
	speed: 0.3785s/iter; left time: 15363.9770s
	iters: 400, epoch: 2 | loss: 0.0040264
	speed: 0.3943s/iter; left time: 15963.5638s
Epoch: 2 cost time: 166.5007197856903
Epoch: 2, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.085 Vali Acc: 0.964 Test Loss: 0.085 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0033823
	speed: 0.8843s/iter; left time: 35702.2074s
	iters: 200, epoch: 3 | loss: 0.0219828
	speed: 0.4293s/iter; left time: 17291.2554s
	iters: 300, epoch: 3 | loss: 0.0078782
	speed: 0.4091s/iter; left time: 16436.7554s
	iters: 400, epoch: 3 | loss: 0.0006138
	speed: 0.4287s/iter; left time: 17179.1131s
Epoch: 3 cost time: 175.65434288978577
Epoch: 3, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.057 Vali Acc: 0.982 Test Loss: 0.057 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0008593
	speed: 0.9218s/iter; left time: 36837.0621s
	iters: 200, epoch: 4 | loss: 0.0040655
	speed: 0.4199s/iter; left time: 16739.3970s
	iters: 300, epoch: 4 | loss: 0.0015294
	speed: 0.4238s/iter; left time: 16849.2521s
	iters: 400, epoch: 4 | loss: 0.0179272
	speed: 0.4294s/iter; left time: 17032.3873s
Epoch: 4 cost time: 176.63540983200073
Epoch: 4, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.101 Vali Acc: 0.972 Test Loss: 0.101 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0007037
	speed: 0.8563s/iter; left time: 33866.0185s
	iters: 200, epoch: 5 | loss: 0.0009734
	speed: 0.4185s/iter; left time: 16507.9939s
	iters: 300, epoch: 5 | loss: 0.0107706
	speed: 0.4396s/iter; left time: 17297.6734s
	iters: 400, epoch: 5 | loss: 0.0026994
	speed: 0.4444s/iter; left time: 17443.4467s
Epoch: 5 cost time: 174.7278344631195
Epoch: 5, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 0.0000852
	speed: 0.9025s/iter; left time: 35319.6071s
	iters: 200, epoch: 6 | loss: 0.0001076
	speed: 0.4362s/iter; left time: 17027.9051s
	iters: 300, epoch: 6 | loss: 0.0000458
	speed: 0.3971s/iter; left time: 15461.0386s
	iters: 400, epoch: 6 | loss: 0.0094884
	speed: 0.4116s/iter; left time: 15986.2465s
Epoch: 6 cost time: 175.30323767662048
Epoch: 6, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 0.0000760
	speed: 0.9448s/iter; left time: 36584.2191s
	iters: 200, epoch: 7 | loss: 0.0003765
	speed: 0.4262s/iter; left time: 16459.5828s
	iters: 300, epoch: 7 | loss: 0.0018775
	speed: 0.4118s/iter; left time: 15863.1243s
	iters: 400, epoch: 7 | loss: 0.0310437
	speed: 0.4593s/iter; left time: 17647.0839s
Epoch: 7 cost time: 182.0824327468872
Epoch: 7, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.982264 --> -0.982719).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0086080
	speed: 0.9186s/iter; left time: 35189.7407s
	iters: 200, epoch: 8 | loss: 0.0523688
	speed: 0.4421s/iter; left time: 16891.9674s
	iters: 300, epoch: 8 | loss: 0.0001273
	speed: 0.4385s/iter; left time: 16712.9287s
	iters: 400, epoch: 8 | loss: 0.0000184
	speed: 0.4269s/iter; left time: 16226.7347s
Epoch: 8 cost time: 176.80902457237244
Epoch: 8, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000126
	speed: 0.9209s/iter; left time: 34899.4728s
	iters: 200, epoch: 9 | loss: 0.0000051
	speed: 0.4758s/iter; left time: 17983.1381s
	iters: 300, epoch: 9 | loss: 0.0000000
	speed: 0.4368s/iter; left time: 16467.7992s
	iters: 400, epoch: 9 | loss: 0.0000015
	speed: 0.4404s/iter; left time: 16556.3534s
Epoch: 9 cost time: 188.40516638755798
Epoch: 9, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000447
	speed: 0.9002s/iter; left time: 33741.9403s
	iters: 200, epoch: 10 | loss: 0.0000006
	speed: 0.4151s/iter; left time: 15518.6392s
	iters: 300, epoch: 10 | loss: 0.0134632
	speed: 0.4364s/iter; left time: 16269.1879s
	iters: 400, epoch: 10 | loss: 0.0002533
	speed: 0.4838s/iter; left time: 17990.4539s
Epoch: 10 cost time: 183.39053750038147
Epoch: 10, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.161 Vali Acc: 0.970 Test Loss: 0.161 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000408
	speed: 0.9750s/iter; left time: 36143.3333s
	iters: 200, epoch: 11 | loss: 0.0000176
	speed: 0.4573s/iter; left time: 16905.2259s
	iters: 300, epoch: 11 | loss: 0.0002686
	speed: 0.4812s/iter; left time: 17742.9233s
	iters: 400, epoch: 11 | loss: 0.0000015
	speed: 0.4558s/iter; left time: 16758.6286s
Epoch: 11 cost time: 191.9390218257904
Epoch: 11, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.348 Vali Acc: 0.960 Test Loss: 0.348 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.4732969
	speed: 0.9035s/iter; left time: 33118.9793s
	iters: 200, epoch: 12 | loss: 0.0008559
	speed: 0.4525s/iter; left time: 16542.8897s
	iters: 300, epoch: 12 | loss: 0.0046237
	speed: 0.4406s/iter; left time: 16064.5934s
	iters: 400, epoch: 12 | loss: 0.0000027
	speed: 0.4552s/iter; left time: 16549.1246s
Epoch: 12 cost time: 186.67718648910522
Epoch: 12, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000352
	speed: 0.9871s/iter; left time: 35778.6167s
	iters: 200, epoch: 13 | loss: 0.3105530
	speed: 0.4793s/iter; left time: 17324.2992s
	iters: 300, epoch: 13 | loss: 0.0000014
	speed: 0.4649s/iter; left time: 16757.5431s
	iters: 400, epoch: 13 | loss: 0.0089478
	speed: 0.4462s/iter; left time: 16037.7037s
Epoch: 13 cost time: 188.73836135864258
Epoch: 13, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0000077
	speed: 0.8568s/iter; left time: 30701.8588s
	iters: 200, epoch: 14 | loss: 0.0042660
	speed: 0.4448s/iter; left time: 15892.8068s
	iters: 300, epoch: 14 | loss: 0.0000129
	speed: 0.4528s/iter; left time: 16133.5980s
	iters: 400, epoch: 14 | loss: 0.0000011
	speed: 0.4117s/iter; left time: 14628.3050s
Epoch: 14 cost time: 180.09848070144653
Epoch: 14, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0001900
	speed: 0.9544s/iter; left time: 33805.3197s
	iters: 200, epoch: 15 | loss: 0.0000119
	speed: 0.4361s/iter; left time: 15400.8900s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.4237s/iter; left time: 14922.2496s
	iters: 400, epoch: 15 | loss: 0.0006873
	speed: 0.4403s/iter; left time: 15464.0452s
Epoch: 15 cost time: 181.87805438041687
Epoch: 15, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.186 Vali Acc: 0.974 Test Loss: 0.186 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0177164
	speed: 0.9421s/iter; left time: 32977.9511s
	iters: 200, epoch: 16 | loss: 0.0001746
	speed: 0.4468s/iter; left time: 15594.2968s
	iters: 300, epoch: 16 | loss: 0.0000983
	speed: 0.4267s/iter; left time: 14850.6554s
	iters: 400, epoch: 16 | loss: 0.0000363
	speed: 0.3956s/iter; left time: 13731.4162s
Epoch: 16 cost time: 174.55957508087158
Epoch: 16, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.097 Vali Acc: 0.986 Test Loss: 0.097 Test Acc: 0.986
Validation loss decreased (-0.982719 --> -0.985902).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.8736s/iter; left time: 30221.6043s
	iters: 200, epoch: 17 | loss: 0.0000708
	speed: 0.4385s/iter; left time: 15126.2061s
	iters: 300, epoch: 17 | loss: 0.0000003
	speed: 0.4462s/iter; left time: 15345.1395s
	iters: 400, epoch: 17 | loss: 0.0000004
	speed: 0.4253s/iter; left time: 14584.4199s
Epoch: 17 cost time: 179.0346438884735
Epoch: 17, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.068 Vali Acc: 0.988 Test Loss: 0.068 Test Acc: 0.988
Validation loss decreased (-0.985902 --> -0.987721).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000041
	speed: 1.0162s/iter; left time: 34733.8322s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.4134s/iter; left time: 14089.2207s
	iters: 300, epoch: 18 | loss: 0.0000062
	speed: 0.3968s/iter; left time: 13484.1036s
	iters: 400, epoch: 18 | loss: 0.0021711
	speed: 0.4276s/iter; left time: 14488.2633s
Epoch: 18 cost time: 180.91616225242615
Epoch: 18, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.230 Vali Acc: 0.967 Test Loss: 0.230 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000003
	speed: 0.8391s/iter; left time: 28335.3707s
	iters: 200, epoch: 19 | loss: 0.2159229
	speed: 0.3970s/iter; left time: 13366.8245s
	iters: 300, epoch: 19 | loss: 0.0000460
	speed: 0.4544s/iter; left time: 15251.4313s
	iters: 400, epoch: 19 | loss: 0.0001062
	speed: 0.4651s/iter; left time: 15564.5879s
Epoch: 19 cost time: 176.50692677497864
Epoch: 19, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.141 Vali Acc: 0.977 Test Loss: 0.141 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0001593
	speed: 0.9276s/iter; left time: 30938.2249s
	iters: 200, epoch: 20 | loss: 0.0000001
	speed: 0.4310s/iter; left time: 14332.2337s
	iters: 300, epoch: 20 | loss: 0.0000119
	speed: 0.4345s/iter; left time: 14404.6308s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.3897s/iter; left time: 12882.2678s
Epoch: 20 cost time: 175.52917337417603
Epoch: 20, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.095 Vali Acc: 0.984 Test Loss: 0.095 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000002
	speed: 0.8807s/iter; left time: 29012.6450s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.4621s/iter; left time: 15176.0007s
	iters: 300, epoch: 21 | loss: 0.0000002
	speed: 0.4355s/iter; left time: 14257.6564s
	iters: 400, epoch: 21 | loss: 0.0001430
	speed: 0.4572s/iter; left time: 14922.3797s
Epoch: 21 cost time: 185.10170793533325
Epoch: 21, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.120 Vali Acc: 0.982 Test Loss: 0.120 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0000002
	speed: 0.9440s/iter; left time: 30704.8473s
	iters: 200, epoch: 22 | loss: 0.0005076
	speed: 0.4039s/iter; left time: 13097.6642s
	iters: 300, epoch: 22 | loss: 0.0000018
	speed: 0.4354s/iter; left time: 14074.0939s
	iters: 400, epoch: 22 | loss: 0.0000009
	speed: 0.4671s/iter; left time: 15054.7743s
Epoch: 22 cost time: 179.89770436286926
Epoch: 22, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.065 Vali Acc: 0.988 Test Loss: 0.065 Test Acc: 0.988
Validation loss decreased (-0.987721 --> -0.988176).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000055
	speed: 0.9769s/iter; left time: 31373.6392s
	iters: 200, epoch: 23 | loss: 0.0000001
	speed: 0.4807s/iter; left time: 15389.0869s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.4996s/iter; left time: 15943.9226s
	iters: 400, epoch: 23 | loss: 0.0000011
	speed: 0.4388s/iter; left time: 13961.3983s
Epoch: 23 cost time: 192.60910439491272
Epoch: 23, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.249 Vali Acc: 0.972 Test Loss: 0.249 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0063849
	speed: 0.9445s/iter; left time: 29941.0016s
	iters: 200, epoch: 24 | loss: 0.0000002
	speed: 0.4850s/iter; left time: 15327.6991s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.4884s/iter; left time: 15384.9727s
	iters: 400, epoch: 24 | loss: 0.0000609
	speed: 0.4890s/iter; left time: 15354.1754s
Epoch: 24 cost time: 198.73524856567383
Epoch: 24, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.138 Vali Acc: 0.981 Test Loss: 0.138 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 1.0075s/iter; left time: 31524.3654s
	iters: 200, epoch: 25 | loss: 0.0003450
	speed: 0.4680s/iter; left time: 14595.1962s
	iters: 300, epoch: 25 | loss: 0.0000407
	speed: 0.4443s/iter; left time: 13812.1624s
	iters: 400, epoch: 25 | loss: 0.0000030
	speed: 0.4238s/iter; left time: 13133.4588s
Epoch: 25 cost time: 185.0375816822052
Epoch: 25, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.168 Vali Acc: 0.974 Test Loss: 0.168 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0000005
	speed: 1.0217s/iter; left time: 31545.4647s
	iters: 200, epoch: 26 | loss: 0.0000246
	speed: 0.4794s/iter; left time: 14755.4381s
	iters: 300, epoch: 26 | loss: 0.0045008
	speed: 0.4868s/iter; left time: 14934.5015s
	iters: 400, epoch: 26 | loss: 0.0000001
	speed: 0.4692s/iter; left time: 14345.2939s
Epoch: 26 cost time: 200.3835265636444
Epoch: 26, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.085 Vali Acc: 0.985 Test Loss: 0.085 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.1019749
	speed: 0.9967s/iter; left time: 30361.3331s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.5033s/iter; left time: 15282.0198s
	iters: 300, epoch: 27 | loss: 0.0000003
	speed: 0.4943s/iter; left time: 14958.4070s
	iters: 400, epoch: 27 | loss: 0.0000181
	speed: 0.4732s/iter; left time: 14272.2279s
Epoch: 27 cost time: 201.50289249420166
Epoch: 27, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.117 Vali Acc: 0.981 Test Loss: 0.117 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 1.0087s/iter; left time: 30310.8087s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.4768s/iter; left time: 14280.0144s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.5075s/iter; left time: 15150.2436s
	iters: 400, epoch: 28 | loss: 0.0246415
	speed: 0.5307s/iter; left time: 15787.9449s
Epoch: 28 cost time: 208.77211546897888
Epoch: 28, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.188 Vali Acc: 0.975 Test Loss: 0.188 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0202692
	speed: 1.1353s/iter; left time: 33648.1714s
	iters: 200, epoch: 29 | loss: 0.0007655
	speed: 0.4796s/iter; left time: 14166.6092s
	iters: 300, epoch: 29 | loss: 0.0000580
	speed: 0.4591s/iter; left time: 13514.5888s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.4454s/iter; left time: 13066.6866s
Epoch: 29 cost time: 203.03367638587952
Epoch: 29, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.227 Vali Acc: 0.976 Test Loss: 0.227 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 1.1690s/iter; left time: 34163.8162s
	iters: 200, epoch: 30 | loss: 0.0061796
	speed: 0.4829s/iter; left time: 14064.6342s
	iters: 300, epoch: 30 | loss: 0.0000455
	speed: 0.5391s/iter; left time: 15646.1652s
	iters: 400, epoch: 30 | loss: 0.0000049
	speed: 0.5173s/iter; left time: 14962.4267s
Epoch: 30 cost time: 220.12394881248474
Epoch: 30, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.211 Vali Acc: 0.979 Test Loss: 0.211 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 1.0997s/iter; left time: 31683.4516s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.5610s/iter; left time: 16105.7635s
	iters: 300, epoch: 31 | loss: 0.0000018
	speed: 0.5721s/iter; left time: 16368.4475s
	iters: 400, epoch: 31 | loss: 0.2201539
	speed: 0.5576s/iter; left time: 15898.7209s
Epoch: 31 cost time: 227.9180657863617
Epoch: 31, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.215 Vali Acc: 0.976 Test Loss: 0.215 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0000170
	speed: 1.2038s/iter; left time: 34185.4522s
	iters: 200, epoch: 32 | loss: 0.0000011
	speed: 0.5475s/iter; left time: 15494.0004s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.4909s/iter; left time: 13842.5243s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.4854s/iter; left time: 13637.9285s
Epoch: 32 cost time: 220.17380666732788
Epoch: 32, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.214 Vali Acc: 0.973 Test Loss: 0.214 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df128_ma47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9881764438381082
model parameter : 810250
model size : 8.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         38                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df128_ma38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7027817
	speed: 0.6125s/iter; left time: 25233.6767s
	iters: 200, epoch: 1 | loss: 0.0816086
	speed: 0.5502s/iter; left time: 22615.8081s
	iters: 300, epoch: 1 | loss: 0.0623167
	speed: 0.5789s/iter; left time: 23736.8954s
	iters: 400, epoch: 1 | loss: 0.1807015
	speed: 0.5796s/iter; left time: 23704.8720s
Epoch: 1 cost time: 240.10641407966614
Epoch: 1, Steps: 413 | Train Loss: 0.518 Vali Loss: 0.074 Vali Acc: 0.979 Test Loss: 0.074 Test Acc: 0.979
Validation loss decreased (inf --> -0.979081).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0565615
	speed: 1.1226s/iter; left time: 45788.4989s
	iters: 200, epoch: 2 | loss: 0.0125538
	speed: 0.5313s/iter; left time: 21617.6523s
	iters: 300, epoch: 2 | loss: 0.0236560
	speed: 0.5326s/iter; left time: 21617.6601s
	iters: 400, epoch: 2 | loss: 0.0287836
	speed: 0.5456s/iter; left time: 22092.1373s
Epoch: 2 cost time: 221.49804973602295
Epoch: 2, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.081 Vali Acc: 0.971 Test Loss: 0.081 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0069846
	speed: 1.1151s/iter; left time: 45021.0085s
	iters: 200, epoch: 3 | loss: 0.0194503
	speed: 0.5682s/iter; left time: 22882.2460s
	iters: 300, epoch: 3 | loss: 0.0866718
	speed: 0.5990s/iter; left time: 24065.4472s
	iters: 400, epoch: 3 | loss: 0.0059115
	speed: 0.5515s/iter; left time: 22100.9683s
Epoch: 3 cost time: 235.73493003845215
Epoch: 3, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.048 Vali Acc: 0.982 Test Loss: 0.048 Test Acc: 0.982
Validation loss decreased (-0.979081 --> -0.981809).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0022510
	speed: 1.1697s/iter; left time: 46742.1887s
	iters: 200, epoch: 4 | loss: 0.0005258
	speed: 0.5390s/iter; left time: 21487.1847s
	iters: 300, epoch: 4 | loss: 0.0014554
	speed: 0.5275s/iter; left time: 20976.0840s
	iters: 400, epoch: 4 | loss: 0.0117008
	speed: 0.5154s/iter; left time: 20441.3617s
Epoch: 4 cost time: 224.6271071434021
Epoch: 4, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.056 Vali Acc: 0.985 Test Loss: 0.056 Test Acc: 0.985
Validation loss decreased (-0.981809 --> -0.985447).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0057711
	speed: 1.2728s/iter; left time: 50337.0555s
	iters: 200, epoch: 5 | loss: 0.0004564
	speed: 0.5218s/iter; left time: 20584.0008s
	iters: 300, epoch: 5 | loss: 0.0012508
	speed: 0.5464s/iter; left time: 21500.1322s
	iters: 400, epoch: 5 | loss: 0.0086559
	speed: 0.5624s/iter; left time: 22073.0333s
Epoch: 5 cost time: 231.36315178871155
Epoch: 5, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0183198
	speed: 1.1457s/iter; left time: 44836.3253s
	iters: 200, epoch: 6 | loss: 0.0062504
	speed: 0.5793s/iter; left time: 22612.9875s
	iters: 300, epoch: 6 | loss: 0.0036510
	speed: 0.5939s/iter; left time: 23125.2062s
	iters: 400, epoch: 6 | loss: 0.0000653
	speed: 0.5471s/iter; left time: 21245.7762s
Epoch: 6 cost time: 235.27173805236816
Epoch: 6, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.082 Vali Acc: 0.975 Test Loss: 0.082 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0003109
	speed: 1.1590s/iter; left time: 44880.4688s
	iters: 200, epoch: 7 | loss: 0.0085930
	speed: 0.5845s/iter; left time: 22573.3842s
	iters: 300, epoch: 7 | loss: 0.0000631
	speed: 0.5740s/iter; left time: 22113.8719s
	iters: 400, epoch: 7 | loss: 0.0855131
	speed: 0.6239s/iter; left time: 23973.3621s
Epoch: 7 cost time: 244.11946535110474
Epoch: 7, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.092 Vali Acc: 0.982 Test Loss: 0.092 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0016259
	speed: 1.1829s/iter; left time: 45315.9250s
	iters: 200, epoch: 8 | loss: 0.0000175
	speed: 0.5976s/iter; left time: 22833.8639s
	iters: 300, epoch: 8 | loss: 0.0001761
	speed: 0.6014s/iter; left time: 22921.0044s
	iters: 400, epoch: 8 | loss: 0.0000030
	speed: 0.5406s/iter; left time: 20546.8906s
Epoch: 8 cost time: 238.0325574874878
Epoch: 8, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000004
	speed: 1.2745s/iter; left time: 48298.0723s
	iters: 200, epoch: 9 | loss: 0.0000336
	speed: 0.5772s/iter; left time: 21815.9792s
	iters: 300, epoch: 9 | loss: 0.0000001
	speed: 0.5959s/iter; left time: 22463.7662s
	iters: 400, epoch: 9 | loss: 0.0111123
	speed: 0.5373s/iter; left time: 20199.0919s
Epoch: 9 cost time: 241.8612449169159
Epoch: 9, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.117 Vali Acc: 0.974 Test Loss: 0.117 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0000276
	speed: 1.2148s/iter; left time: 45537.0912s
	iters: 200, epoch: 10 | loss: 0.0000063
	speed: 0.5780s/iter; left time: 21608.8114s
	iters: 300, epoch: 10 | loss: 0.0000673
	speed: 0.5600s/iter; left time: 20879.8705s
	iters: 400, epoch: 10 | loss: 0.0003989
	speed: 0.5867s/iter; left time: 21815.4356s
Epoch: 10 cost time: 239.8313136100769
Epoch: 10, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.074 Vali Acc: 0.984 Test Loss: 0.074 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 1.3601s/iter; left time: 50421.2384s
	iters: 200, epoch: 11 | loss: 0.0005798
	speed: 0.5599s/iter; left time: 20701.3406s
	iters: 300, epoch: 11 | loss: 0.0001090
	speed: 0.5721s/iter; left time: 21094.9909s
	iters: 400, epoch: 11 | loss: 0.0000006
	speed: 0.6077s/iter; left time: 22346.3107s
Epoch: 11 cost time: 249.33014178276062
Epoch: 11, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.165 Vali Acc: 0.977 Test Loss: 0.165 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0711689
	speed: 1.2684s/iter; left time: 46495.7020s
	iters: 200, epoch: 12 | loss: 0.1045041
	speed: 0.5990s/iter; left time: 21896.5637s
	iters: 300, epoch: 12 | loss: 0.0073488
	speed: 0.6737s/iter; left time: 24562.2423s
	iters: 400, epoch: 12 | loss: 0.0000135
	speed: 0.6058s/iter; left time: 22025.2477s
Epoch: 12 cost time: 256.60492634773254
Epoch: 12, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.193 Vali Acc: 0.967 Test Loss: 0.193 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0000050
	speed: 1.1986s/iter; left time: 43444.6248s
	iters: 200, epoch: 13 | loss: 0.0016531
	speed: 0.5382s/iter; left time: 19453.8113s
	iters: 300, epoch: 13 | loss: 0.5502860
	speed: 0.6481s/iter; left time: 23360.3257s
	iters: 400, epoch: 13 | loss: 0.0000181
	speed: 0.6033s/iter; left time: 21684.0121s
Epoch: 13 cost time: 244.81840109825134
Epoch: 13, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.086 Vali Acc: 0.982 Test Loss: 0.086 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0051677
	speed: 1.3177s/iter; left time: 47216.6913s
	iters: 200, epoch: 14 | loss: 0.0000044
	speed: 0.6052s/iter; left time: 21624.2601s
	iters: 300, epoch: 14 | loss: 0.0002094
	speed: 0.5728s/iter; left time: 20411.2893s
	iters: 400, epoch: 14 | loss: 0.0015763
	speed: 0.5725s/iter; left time: 20340.4464s
Epoch: 14 cost time: 248.0788540840149
Epoch: 14, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df128_ma38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9854479308776717
model parameter : 810250
model size : 8.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         28                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df128_ma28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8685753
	speed: 0.6632s/iter; left time: 27325.4023s
	iters: 200, epoch: 1 | loss: 0.1383609
	speed: 0.5897s/iter; left time: 24237.3768s
	iters: 300, epoch: 1 | loss: 0.0764311
	speed: 0.6140s/iter; left time: 25174.1284s
	iters: 400, epoch: 1 | loss: 0.2381977
	speed: 0.6081s/iter; left time: 24872.1310s
Epoch: 1 cost time: 256.7265205383301
Epoch: 1, Steps: 413 | Train Loss: 0.568 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (inf --> -0.972714).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0561101
	speed: 1.2537s/iter; left time: 51136.1889s
	iters: 200, epoch: 2 | loss: 0.0159902
	speed: 0.6108s/iter; left time: 24853.7202s
	iters: 300, epoch: 2 | loss: 0.0362291
	speed: 0.5807s/iter; left time: 23568.3822s
	iters: 400, epoch: 2 | loss: 0.0035278
	speed: 0.6017s/iter; left time: 24360.8832s
Epoch: 2 cost time: 246.17823243141174
Epoch: 2, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.098 Vali Acc: 0.963 Test Loss: 0.098 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0022969
	speed: 1.3009s/iter; left time: 52525.5563s
	iters: 200, epoch: 3 | loss: 0.0020453
	speed: 0.5650s/iter; left time: 22754.6282s
	iters: 300, epoch: 3 | loss: 0.0114659
	speed: 0.5536s/iter; left time: 22239.9676s
	iters: 400, epoch: 3 | loss: 0.0027565
	speed: 0.6329s/iter; left time: 25361.8203s
Epoch: 3 cost time: 246.73344659805298
Epoch: 3, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.042 Vali Acc: 0.984 Test Loss: 0.042 Test Acc: 0.984
Validation loss decreased (-0.972714 --> -0.984083).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0006064
	speed: 1.4152s/iter; left time: 56554.0106s
	iters: 200, epoch: 4 | loss: 0.0007305
	speed: 0.6703s/iter; left time: 26720.6052s
	iters: 300, epoch: 4 | loss: 0.1704337
	speed: 0.6007s/iter; left time: 23884.2233s
	iters: 400, epoch: 4 | loss: 0.0021773
	speed: 0.6456s/iter; left time: 25606.3542s
Epoch: 4 cost time: 269.87252163887024
Epoch: 4, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0005918
	speed: 1.2431s/iter; left time: 49163.8113s
	iters: 200, epoch: 5 | loss: 0.0849744
	speed: 0.6086s/iter; left time: 24009.2175s
	iters: 300, epoch: 5 | loss: 0.0106129
	speed: 0.6124s/iter; left time: 24097.6805s
	iters: 400, epoch: 5 | loss: 0.0013802
	speed: 0.6048s/iter; left time: 23738.8386s
Epoch: 5 cost time: 251.10237431526184
Epoch: 5, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0021584
	speed: 1.2415s/iter; left time: 48585.4161s
	iters: 200, epoch: 6 | loss: 0.0005304
	speed: 0.6065s/iter; left time: 23673.6074s
	iters: 300, epoch: 6 | loss: 0.0045859
	speed: 0.6095s/iter; left time: 23731.7388s
	iters: 400, epoch: 6 | loss: 0.0013380
	speed: 0.5674s/iter; left time: 22034.0467s
Epoch: 6 cost time: 243.84275126457214
Epoch: 6, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0808839
	speed: 1.2457s/iter; left time: 48236.8748s
	iters: 200, epoch: 7 | loss: 0.0001979
	speed: 0.5955s/iter; left time: 22998.1940s
	iters: 300, epoch: 7 | loss: 0.0000360
	speed: 0.5603s/iter; left time: 21586.1936s
	iters: 400, epoch: 7 | loss: 0.0018640
	speed: 0.6067s/iter; left time: 23311.0032s
Epoch: 7 cost time: 243.17899775505066
Epoch: 7, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.142 Vali Acc: 0.972 Test Loss: 0.142 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0002319
	speed: 1.2161s/iter; left time: 46586.8977s
	iters: 200, epoch: 8 | loss: 0.0039930
	speed: 0.5552s/iter; left time: 21214.2280s
	iters: 300, epoch: 8 | loss: 0.0000513
	speed: 0.5558s/iter; left time: 21180.5503s
	iters: 400, epoch: 8 | loss: 0.0006118
	speed: 0.5852s/iter; left time: 22242.7836s
Epoch: 8 cost time: 235.3844654560089
Epoch: 8, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000757
	speed: 1.2715s/iter; left time: 48184.9868s
	iters: 200, epoch: 9 | loss: 0.0001092
	speed: 0.6368s/iter; left time: 24068.2882s
	iters: 300, epoch: 9 | loss: 0.0000217
	speed: 0.6036s/iter; left time: 22752.7778s
	iters: 400, epoch: 9 | loss: 0.0002331
	speed: 0.5781s/iter; left time: 21734.1678s
Epoch: 9 cost time: 249.14645433425903
Epoch: 9, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0000110
	speed: 1.2325s/iter; left time: 46199.3922s
	iters: 200, epoch: 10 | loss: 0.0002833
	speed: 0.6157s/iter; left time: 23018.4511s
	iters: 300, epoch: 10 | loss: 0.0004785
	speed: 0.5962s/iter; left time: 22229.4226s
	iters: 400, epoch: 10 | loss: 0.0006812
	speed: 0.6646s/iter; left time: 24712.7636s
Epoch: 10 cost time: 255.97503185272217
Epoch: 10, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.163 Vali Acc: 0.972 Test Loss: 0.163 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0000178
	speed: 1.2832s/iter; left time: 47569.3840s
	iters: 200, epoch: 11 | loss: 0.0001085
	speed: 0.6088s/iter; left time: 22509.7538s
	iters: 300, epoch: 11 | loss: 0.0000001
	speed: 0.6192s/iter; left time: 22831.5396s
	iters: 400, epoch: 11 | loss: 0.3802043
	speed: 0.5664s/iter; left time: 20828.9123s
Epoch: 11 cost time: 246.84921145439148
Epoch: 11, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.157 Vali Acc: 0.971 Test Loss: 0.157 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000012
	speed: 1.2194s/iter; left time: 44701.9378s
	iters: 200, epoch: 12 | loss: 0.0000187
	speed: 0.5897s/iter; left time: 21556.7205s
	iters: 300, epoch: 12 | loss: 0.0000012
	speed: 0.5293s/iter; left time: 19296.5578s
	iters: 400, epoch: 12 | loss: 0.0000573
	speed: 0.6013s/iter; left time: 21861.2702s
Epoch: 12 cost time: 240.47943711280823
Epoch: 12, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.070 Vali Acc: 0.986 Test Loss: 0.070 Test Acc: 0.986
Validation loss decreased (-0.984083 --> -0.985902).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000021
	speed: 1.3816s/iter; left time: 50075.9311s
	iters: 200, epoch: 13 | loss: 0.0726850
	speed: 0.5736s/iter; left time: 20732.5361s
	iters: 300, epoch: 13 | loss: 0.0000010
	speed: 0.6138s/iter; left time: 22124.2814s
	iters: 400, epoch: 13 | loss: 0.0000652
	speed: 0.6267s/iter; left time: 22526.7341s
Epoch: 13 cost time: 256.6562204360962
Epoch: 13, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000034
	speed: 1.2379s/iter; left time: 44354.9394s
	iters: 200, epoch: 14 | loss: 0.0866154
	speed: 0.6302s/iter; left time: 22518.6157s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.6553s/iter; left time: 23349.3630s
	iters: 400, epoch: 14 | loss: 0.0507416
	speed: 0.5996s/iter; left time: 21304.7778s
Epoch: 14 cost time: 255.76703524589539
Epoch: 14, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.086 Vali Acc: 0.986 Test Loss: 0.086 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000451
	speed: 1.1699s/iter; left time: 41438.0485s
	iters: 200, epoch: 15 | loss: 0.0000003
	speed: 0.5961s/iter; left time: 21053.7871s
	iters: 300, epoch: 15 | loss: 0.0000002
	speed: 0.6887s/iter; left time: 24254.3157s
	iters: 400, epoch: 15 | loss: 0.0000219
	speed: 0.6163s/iter; left time: 21643.5008s
Epoch: 15 cost time: 255.8893358707428
Epoch: 15, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.087 Vali Acc: 0.985 Test Loss: 0.087 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000498
	speed: 1.3171s/iter; left time: 46107.8265s
	iters: 200, epoch: 16 | loss: 0.2174031
	speed: 0.5785s/iter; left time: 20193.8423s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.5309s/iter; left time: 18479.6109s
	iters: 400, epoch: 16 | loss: 0.2378040
	speed: 0.5494s/iter; left time: 19067.7539s
Epoch: 16 cost time: 238.45564723014832
Epoch: 16, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.207 Vali Acc: 0.970 Test Loss: 0.207 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000032
	speed: 1.3489s/iter; left time: 46662.1679s
	iters: 200, epoch: 17 | loss: 0.0000004
	speed: 0.6463s/iter; left time: 22294.2525s
	iters: 300, epoch: 17 | loss: 0.0000130
	speed: 0.6014s/iter; left time: 20683.0490s
	iters: 400, epoch: 17 | loss: 0.0000171
	speed: 0.6471s/iter; left time: 22192.6910s
Epoch: 17 cost time: 266.81915068626404
Epoch: 17, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.185 Vali Acc: 0.975 Test Loss: 0.185 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0001643
	speed: 1.2499s/iter; left time: 42720.6539s
	iters: 200, epoch: 18 | loss: 0.0000001
	speed: 0.5839s/iter; left time: 19898.7412s
	iters: 300, epoch: 18 | loss: 0.0000033
	speed: 0.6017s/iter; left time: 20447.4219s
	iters: 400, epoch: 18 | loss: 0.0000001
	speed: 0.5946s/iter; left time: 20145.4529s
Epoch: 18 cost time: 244.91605377197266
Epoch: 18, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.104 Vali Acc: 0.982 Test Loss: 0.104 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.1596034
	speed: 1.2995s/iter; left time: 43879.9517s
	iters: 200, epoch: 19 | loss: 0.0000061
	speed: 0.5827s/iter; left time: 19619.0486s
	iters: 300, epoch: 19 | loss: 0.2857284
	speed: 0.5811s/iter; left time: 19507.0985s
	iters: 400, epoch: 19 | loss: 0.0000114
	speed: 0.5734s/iter; left time: 19188.6976s
Epoch: 19 cost time: 249.56730151176453
Epoch: 19, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.287 Vali Acc: 0.960 Test Loss: 0.287 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0003844
	speed: 1.5178s/iter; left time: 50623.8272s
	iters: 200, epoch: 20 | loss: 0.0007551
	speed: 0.5940s/iter; left time: 19753.3352s
	iters: 300, epoch: 20 | loss: 0.0083989
	speed: 0.6207s/iter; left time: 20577.9530s
	iters: 400, epoch: 20 | loss: 0.0033249
	speed: 0.6460s/iter; left time: 21354.5130s
Epoch: 20 cost time: 269.5279104709625
Epoch: 20, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.256 Vali Acc: 0.972 Test Loss: 0.256 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000004
	speed: 1.2431s/iter; left time: 40949.9609s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.6572s/iter; left time: 21581.8428s
	iters: 300, epoch: 21 | loss: 0.0000018
	speed: 0.6913s/iter; left time: 22634.7945s
	iters: 400, epoch: 21 | loss: 0.0036476
	speed: 0.6393s/iter; left time: 20868.1800s
Epoch: 21 cost time: 263.71959710121155
Epoch: 21, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000001
	speed: 1.3069s/iter; left time: 42512.2076s
	iters: 200, epoch: 22 | loss: 0.0002827
	speed: 0.6410s/iter; left time: 20786.4356s
	iters: 300, epoch: 22 | loss: 0.0000032
	speed: 0.6324s/iter; left time: 20445.3544s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.6622s/iter; left time: 21340.5097s
Epoch: 22 cost time: 265.3244607448578
Epoch: 22, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.183 Vali Acc: 0.979 Test Loss: 0.183 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df128_ma28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9859026830377444
model parameter : 810250
model size : 8.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df128_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0705439
	speed: 0.6342s/iter; left time: 26130.8260s
	iters: 200, epoch: 1 | loss: 0.1274170
	speed: 0.6401s/iter; left time: 26309.2760s
	iters: 300, epoch: 1 | loss: 0.0691144
	speed: 0.6618s/iter; left time: 27135.2546s
	iters: 400, epoch: 1 | loss: 0.1074725
	speed: 0.6168s/iter; left time: 25229.2024s
Epoch: 1 cost time: 263.61408019065857
Epoch: 1, Steps: 413 | Train Loss: 0.648 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
Validation loss decreased (inf --> -0.965438).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0659079
	speed: 1.3096s/iter; left time: 53414.1491s
	iters: 200, epoch: 2 | loss: 0.0089441
	speed: 0.6017s/iter; left time: 24482.3748s
	iters: 300, epoch: 2 | loss: 0.0307866
	speed: 0.5723s/iter; left time: 23230.3146s
	iters: 400, epoch: 2 | loss: 0.0239493
	speed: 0.6610s/iter; left time: 26761.6020s
Epoch: 2 cost time: 254.5828447341919
Epoch: 2, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.109 Vali Acc: 0.960 Test Loss: 0.109 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0034298
	speed: 1.3756s/iter; left time: 55541.6293s
	iters: 200, epoch: 3 | loss: 0.0847278
	speed: 0.6156s/iter; left time: 24795.1199s
	iters: 300, epoch: 3 | loss: 0.0061359
	speed: 0.6490s/iter; left time: 26074.2221s
	iters: 400, epoch: 3 | loss: 0.0239283
	speed: 0.6234s/iter; left time: 24983.7426s
Epoch: 3 cost time: 262.05776810646057
Epoch: 3, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.061 Vali Acc: 0.979 Test Loss: 0.061 Test Acc: 0.979
Validation loss decreased (-0.965438 --> -0.978626).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0102947
	speed: 1.3057s/iter; left time: 52177.6728s
	iters: 200, epoch: 4 | loss: 0.0031860
	speed: 0.6440s/iter; left time: 25671.1631s
	iters: 300, epoch: 4 | loss: 0.0101661
	speed: 0.5668s/iter; left time: 22538.1891s
	iters: 400, epoch: 4 | loss: 0.1074254
	speed: 0.5862s/iter; left time: 23247.8951s
Epoch: 4 cost time: 255.839595079422
Epoch: 4, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0002024
	speed: 1.3365s/iter; left time: 52855.5283s
	iters: 200, epoch: 5 | loss: 0.0003834
	speed: 0.6180s/iter; left time: 24380.7903s
	iters: 300, epoch: 5 | loss: 0.0183381
	speed: 0.6990s/iter; left time: 27506.2688s
	iters: 400, epoch: 5 | loss: 0.0002805
	speed: 0.6147s/iter; left time: 24128.0045s
Epoch: 5 cost time: 267.3166151046753
Epoch: 5, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.154 Vali Acc: 0.969 Test Loss: 0.154 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0062095
	speed: 1.3280s/iter; left time: 51971.0780s
	iters: 200, epoch: 6 | loss: 0.0180342
	speed: 0.6605s/iter; left time: 25784.4318s
	iters: 300, epoch: 6 | loss: 0.0013426
	speed: 0.6532s/iter; left time: 25433.0897s
	iters: 400, epoch: 6 | loss: 0.0017249
	speed: 0.6707s/iter; left time: 26048.5551s
Epoch: 6 cost time: 273.4714665412903
Epoch: 6, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.154 Vali Acc: 0.968 Test Loss: 0.154 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0027688
	speed: 1.2636s/iter; left time: 48932.0346s
	iters: 200, epoch: 7 | loss: 0.0012564
	speed: 0.6362s/iter; left time: 24572.5875s
	iters: 300, epoch: 7 | loss: 0.0004642
	speed: 0.6504s/iter; left time: 25056.9197s
	iters: 400, epoch: 7 | loss: 0.0001315
	speed: 0.6806s/iter; left time: 26152.1253s
Epoch: 7 cost time: 265.91677594184875
Epoch: 7, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.151 Vali Acc: 0.969 Test Loss: 0.151 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0019516
	speed: 1.3217s/iter; left time: 50633.6750s
	iters: 200, epoch: 8 | loss: 0.0146423
	speed: 0.5833s/iter; left time: 22286.5984s
	iters: 300, epoch: 8 | loss: 0.0092203
	speed: 0.6246s/iter; left time: 23802.6782s
	iters: 400, epoch: 8 | loss: 0.0000046
	speed: 0.6729s/iter; left time: 25577.7857s
Epoch: 8 cost time: 259.2367742061615
Epoch: 8, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0006078
	speed: 1.2989s/iter; left time: 49222.7765s
	iters: 200, epoch: 9 | loss: 0.0000069
	speed: 0.7019s/iter; left time: 26529.5980s
	iters: 300, epoch: 9 | loss: 0.0001209
	speed: 0.6365s/iter; left time: 23993.0102s
	iters: 400, epoch: 9 | loss: 0.0001151
	speed: 0.6023s/iter; left time: 22645.2755s
Epoch: 9 cost time: 264.63241243362427
Epoch: 9, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0024164
	speed: 1.4169s/iter; left time: 53111.8525s
	iters: 200, epoch: 10 | loss: 0.0000010
	speed: 0.6292s/iter; left time: 23523.3444s
	iters: 300, epoch: 10 | loss: 0.0020219
	speed: 0.6165s/iter; left time: 22985.6511s
	iters: 400, epoch: 10 | loss: 0.0132021
	speed: 0.6102s/iter; left time: 22687.9645s
Epoch: 10 cost time: 264.22549080848694
Epoch: 10, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.162 Vali Acc: 0.972 Test Loss: 0.162 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0000011
	speed: 1.4184s/iter; left time: 52579.6872s
	iters: 200, epoch: 11 | loss: 0.0021894
	speed: 0.6527s/iter; left time: 24130.0309s
	iters: 300, epoch: 11 | loss: 0.0004370
	speed: 0.6219s/iter; left time: 22928.2533s
	iters: 400, epoch: 11 | loss: 0.0000020
	speed: 0.5918s/iter; left time: 21762.8760s
Epoch: 11 cost time: 265.3358874320984
Epoch: 11, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.079 Vali Acc: 0.982 Test Loss: 0.079 Test Acc: 0.982
Validation loss decreased (-0.978626 --> -0.981809).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000169
	speed: 1.4046s/iter; left time: 51491.2612s
	iters: 200, epoch: 12 | loss: 0.0054107
	speed: 0.6530s/iter; left time: 23873.3521s
	iters: 300, epoch: 12 | loss: 0.0000002
	speed: 0.6316s/iter; left time: 23027.4866s
	iters: 400, epoch: 12 | loss: 0.0004017
	speed: 0.6567s/iter; left time: 23876.3065s
Epoch: 12 cost time: 273.3519492149353
Epoch: 12, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.067 Vali Acc: 0.985 Test Loss: 0.067 Test Acc: 0.985
Validation loss decreased (-0.981809 --> -0.984993).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.6187705
	speed: 1.3665s/iter; left time: 49530.4913s
	iters: 200, epoch: 13 | loss: 0.0023564
	speed: 0.6308s/iter; left time: 22800.4919s
	iters: 300, epoch: 13 | loss: 0.0000443
	speed: 0.6795s/iter; left time: 24491.7044s
	iters: 400, epoch: 13 | loss: 0.0185331
	speed: 0.6603s/iter; left time: 23735.7752s
Epoch: 13 cost time: 268.4501612186432
Epoch: 13, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.153 Vali Acc: 0.974 Test Loss: 0.153 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0026533
	speed: 1.3779s/iter; left time: 49373.5332s
	iters: 200, epoch: 14 | loss: 0.0000191
	speed: 0.6882s/iter; left time: 24590.2557s
	iters: 300, epoch: 14 | loss: 0.0000000
	speed: 0.6335s/iter; left time: 22573.3217s
	iters: 400, epoch: 14 | loss: 0.0009634
	speed: 0.6238s/iter; left time: 22164.9618s
Epoch: 14 cost time: 271.0941004753113
Epoch: 14, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.117 Vali Acc: 0.979 Test Loss: 0.117 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0151909
	speed: 1.3159s/iter; left time: 46608.3015s
	iters: 200, epoch: 15 | loss: 0.0000011
	speed: 0.7039s/iter; left time: 24859.9076s
	iters: 300, epoch: 15 | loss: 0.0000664
	speed: 0.6499s/iter; left time: 22887.7188s
	iters: 400, epoch: 15 | loss: 0.0003497
	speed: 0.6223s/iter; left time: 21856.1082s
Epoch: 15 cost time: 275.19731736183167
Epoch: 15, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.168 Vali Acc: 0.971 Test Loss: 0.168 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000049
	speed: 1.4016s/iter; left time: 49062.8841s
	iters: 200, epoch: 16 | loss: 0.0000302
	speed: 0.7557s/iter; left time: 26380.1237s
	iters: 300, epoch: 16 | loss: 0.0000263
	speed: 0.7005s/iter; left time: 24382.8069s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.6107s/iter; left time: 21194.4882s
Epoch: 16 cost time: 284.3384234905243
Epoch: 16, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.114 Vali Acc: 0.978 Test Loss: 0.114 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000256
	speed: 1.3512s/iter; left time: 46742.9033s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.6023s/iter; left time: 20775.9696s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.6136s/iter; left time: 21103.1210s
	iters: 400, epoch: 17 | loss: 0.0000002
	speed: 0.6270s/iter; left time: 21500.0818s
Epoch: 17 cost time: 258.37526965141296
Epoch: 17, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.104 Vali Acc: 0.982 Test Loss: 0.104 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 1.2614s/iter; left time: 43113.5085s
	iters: 200, epoch: 18 | loss: 0.0000034
	speed: 0.5587s/iter; left time: 19040.2052s
	iters: 300, epoch: 18 | loss: 0.0000006
	speed: 0.5815s/iter; left time: 19761.0655s
	iters: 400, epoch: 18 | loss: 0.0000035
	speed: 0.5192s/iter; left time: 17589.0185s
Epoch: 18 cost time: 235.1402769088745
Epoch: 18, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.241 Vali Acc: 0.966 Test Loss: 0.241 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0927346
	speed: 1.1728s/iter; left time: 39601.9932s
	iters: 200, epoch: 19 | loss: 0.0159743
	speed: 0.6157s/iter; left time: 20728.9470s
	iters: 300, epoch: 19 | loss: 0.0049948
	speed: 0.6048s/iter; left time: 20299.9596s
	iters: 400, epoch: 19 | loss: 0.0007099
	speed: 0.6574s/iter; left time: 22001.6859s
Epoch: 19 cost time: 248.80267691612244
Epoch: 19, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.158 Vali Acc: 0.975 Test Loss: 0.158 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000881
	speed: 1.3207s/iter; left time: 44051.0512s
	iters: 200, epoch: 20 | loss: 0.0004367
	speed: 0.6736s/iter; left time: 22400.6386s
	iters: 300, epoch: 20 | loss: 0.0000006
	speed: 0.6453s/iter; left time: 21395.4504s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.6331s/iter; left time: 20926.6705s
Epoch: 20 cost time: 267.9630837440491
Epoch: 20, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.162 Vali Acc: 0.977 Test Loss: 0.162 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000001
	speed: 1.3679s/iter; left time: 45060.6624s
	iters: 200, epoch: 21 | loss: 0.0000012
	speed: 0.6411s/iter; left time: 21055.9159s
	iters: 300, epoch: 21 | loss: 0.0001788
	speed: 0.6955s/iter; left time: 22772.8659s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.5930s/iter; left time: 19355.2123s
Epoch: 21 cost time: 269.83452439308167
Epoch: 21, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.194 Vali Acc: 0.974 Test Loss: 0.194 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000217
	speed: 1.3071s/iter; left time: 42517.5869s
	iters: 200, epoch: 22 | loss: 0.0000263
	speed: 0.6731s/iter; left time: 21827.3237s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.6688s/iter; left time: 21620.7841s
	iters: 400, epoch: 22 | loss: 0.0000060
	speed: 0.6760s/iter; left time: 21784.7122s
Epoch: 22 cost time: 271.8300495147705
Epoch: 22, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.177 Vali Acc: 0.972 Test Loss: 0.177 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df128_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.984993178717599
model parameter : 810250
model size : 8.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df128_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.4852839
	speed: 0.6260s/iter; left time: 25791.9482s
	iters: 200, epoch: 1 | loss: 0.2223718
	speed: 0.5631s/iter; left time: 23145.4720s
	iters: 300, epoch: 1 | loss: 0.1082914
	speed: 0.6159s/iter; left time: 25251.8211s
	iters: 400, epoch: 1 | loss: 0.2328138
	speed: 0.6196s/iter; left time: 25342.2305s
Epoch: 1 cost time: 250.95927381515503
Epoch: 1, Steps: 413 | Train Loss: 0.784 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
Validation loss decreased (inf --> -0.964528).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1638972
	speed: 1.2132s/iter; left time: 49482.3872s
	iters: 200, epoch: 2 | loss: 0.0191091
	speed: 0.5496s/iter; left time: 22361.5230s
	iters: 300, epoch: 2 | loss: 0.0094832
	speed: 0.5406s/iter; left time: 21941.0708s
	iters: 400, epoch: 2 | loss: 0.0108953
	speed: 0.5943s/iter; left time: 24063.0703s
Epoch: 2 cost time: 235.77793383598328
Epoch: 2, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
Validation loss decreased (-0.964528 --> -0.970895).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0066521
	speed: 1.2293s/iter; left time: 49634.6222s
	iters: 200, epoch: 3 | loss: 0.0992932
	speed: 0.5515s/iter; left time: 22212.1249s
	iters: 300, epoch: 3 | loss: 0.0200777
	speed: 0.5677s/iter; left time: 22806.0025s
	iters: 400, epoch: 3 | loss: 0.0007276
	speed: 0.6170s/iter; left time: 24724.9539s
Epoch: 3 cost time: 239.53334045410156
Epoch: 3, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
Validation loss decreased (-0.970895 --> -0.975897).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0183383
	speed: 1.2739s/iter; left time: 50907.9495s
	iters: 200, epoch: 4 | loss: 0.0033631
	speed: 0.5800s/iter; left time: 23118.4291s
	iters: 300, epoch: 4 | loss: 0.0082279
	speed: 0.5599s/iter; left time: 22261.0402s
	iters: 400, epoch: 4 | loss: 0.0938220
	speed: 0.5657s/iter; left time: 22436.8993s
Epoch: 4 cost time: 241.00699520111084
Epoch: 4, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.089 Vali Acc: 0.974 Test Loss: 0.089 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0002105
	speed: 1.2099s/iter; left time: 47849.4075s
	iters: 200, epoch: 5 | loss: 0.0010367
	speed: 0.5694s/iter; left time: 22462.5574s
	iters: 300, epoch: 5 | loss: 0.0047292
	speed: 0.5779s/iter; left time: 22738.7534s
	iters: 400, epoch: 5 | loss: 0.0046540
	speed: 0.5517s/iter; left time: 21654.8684s
Epoch: 5 cost time: 237.75256156921387
Epoch: 5, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0004548
	speed: 1.2602s/iter; left time: 49317.6706s
	iters: 200, epoch: 6 | loss: 0.0000242
	speed: 0.5569s/iter; left time: 21737.6095s
	iters: 300, epoch: 6 | loss: 0.0108019
	speed: 0.5752s/iter; left time: 22395.9124s
	iters: 400, epoch: 6 | loss: 0.0036880
	speed: 0.5566s/iter; left time: 21615.9560s
Epoch: 6 cost time: 239.7003457546234
Epoch: 6, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.152 Vali Acc: 0.963 Test Loss: 0.152 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000194
	speed: 1.3444s/iter; left time: 52060.6085s
	iters: 200, epoch: 7 | loss: 0.0051322
	speed: 0.5703s/iter; left time: 22027.6620s
	iters: 300, epoch: 7 | loss: 0.0362268
	speed: 0.5066s/iter; left time: 19517.0708s
	iters: 400, epoch: 7 | loss: 0.0000856
	speed: 0.5398s/iter; left time: 20741.6529s
Epoch: 7 cost time: 235.9799566268921
Epoch: 7, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.149 Vali Acc: 0.965 Test Loss: 0.149 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0543606
	speed: 1.1618s/iter; left time: 44510.0737s
	iters: 200, epoch: 8 | loss: 0.0064585
	speed: 0.6138s/iter; left time: 23452.2006s
	iters: 300, epoch: 8 | loss: 0.0000253
	speed: 0.5752s/iter; left time: 21919.4973s
	iters: 400, epoch: 8 | loss: 0.0010367
	speed: 0.5391s/iter; left time: 20490.0112s
Epoch: 8 cost time: 238.63078117370605
Epoch: 8, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.161 Vali Acc: 0.965 Test Loss: 0.161 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000042
	speed: 1.2145s/iter; left time: 46026.4625s
	iters: 200, epoch: 9 | loss: 0.1450214
	speed: 0.5504s/iter; left time: 20803.2353s
	iters: 300, epoch: 9 | loss: 0.0000238
	speed: 0.5997s/iter; left time: 22605.2976s
	iters: 400, epoch: 9 | loss: 0.0000208
	speed: 0.5821s/iter; left time: 21885.2271s
Epoch: 9 cost time: 242.3532989025116
Epoch: 9, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.126 Vali Acc: 0.974 Test Loss: 0.126 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0001223
	speed: 1.2032s/iter; left time: 45102.4075s
	iters: 200, epoch: 10 | loss: 0.0000009
	speed: 0.5676s/iter; left time: 21219.6012s
	iters: 300, epoch: 10 | loss: 0.2491746
	speed: 0.5733s/iter; left time: 21376.6258s
	iters: 400, epoch: 10 | loss: 0.0079165
	speed: 0.6081s/iter; left time: 22611.4696s
Epoch: 10 cost time: 243.3768448829651
Epoch: 10, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.078 Vali Acc: 0.979 Test Loss: 0.078 Test Acc: 0.979
Validation loss decreased (-0.975897 --> -0.978626).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 1.1701s/iter; left time: 43376.5785s
	iters: 200, epoch: 11 | loss: 0.0003635
	speed: 0.5051s/iter; left time: 18675.1827s
	iters: 300, epoch: 11 | loss: 0.0000008
	speed: 0.6041s/iter; left time: 22272.7399s
	iters: 400, epoch: 11 | loss: 0.0455480
	speed: 0.5824s/iter; left time: 21413.9557s
Epoch: 11 cost time: 231.82305264472961
Epoch: 11, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.283 Vali Acc: 0.967 Test Loss: 0.283 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000542
	speed: 1.2136s/iter; left time: 44489.7404s
	iters: 200, epoch: 12 | loss: 0.0193057
	speed: 0.5290s/iter; left time: 19338.6020s
	iters: 300, epoch: 12 | loss: 0.0000513
	speed: 0.5561s/iter; left time: 20273.5715s
	iters: 400, epoch: 12 | loss: 0.0014729
	speed: 0.6029s/iter; left time: 21921.6231s
Epoch: 12 cost time: 234.4726402759552
Epoch: 12, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.205 Vali Acc: 0.967 Test Loss: 0.205 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.1034730
	speed: 1.1000s/iter; left time: 39870.4072s
	iters: 200, epoch: 13 | loss: 0.0000889
	speed: 0.5517s/iter; left time: 19941.1808s
	iters: 300, epoch: 13 | loss: 0.0000683
	speed: 0.5874s/iter; left time: 21171.6657s
	iters: 400, epoch: 13 | loss: 0.0001846
	speed: 0.6384s/iter; left time: 22948.7016s
Epoch: 13 cost time: 238.1318461894989
Epoch: 13, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.169 Vali Acc: 0.970 Test Loss: 0.169 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0003210
	speed: 1.3663s/iter; left time: 48958.6253s
	iters: 200, epoch: 14 | loss: 0.0223365
	speed: 0.6236s/iter; left time: 22281.1116s
	iters: 300, epoch: 14 | loss: 0.0119479
	speed: 0.5952s/iter; left time: 21206.8312s
	iters: 400, epoch: 14 | loss: 0.0002696
	speed: 0.6082s/iter; left time: 21612.0213s
Epoch: 14 cost time: 258.1754722595215
Epoch: 14, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.135 Vali Acc: 0.977 Test Loss: 0.135 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0138425
	speed: 1.2046s/iter; left time: 42666.6309s
	iters: 200, epoch: 15 | loss: 0.1714272
	speed: 0.5885s/iter; left time: 20786.0820s
	iters: 300, epoch: 15 | loss: 0.0000100
	speed: 0.5820s/iter; left time: 20496.5780s
	iters: 400, epoch: 15 | loss: 0.0000008
	speed: 0.5872s/iter; left time: 20620.2819s
Epoch: 15 cost time: 239.63401675224304
Epoch: 15, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.180 Vali Acc: 0.969 Test Loss: 0.180 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000009
	speed: 1.2068s/iter; left time: 42245.3299s
	iters: 200, epoch: 16 | loss: 0.0000019
	speed: 0.5738s/iter; left time: 20028.0232s
	iters: 300, epoch: 16 | loss: 0.0004078
	speed: 0.5673s/iter; left time: 19746.0275s
	iters: 400, epoch: 16 | loss: 0.0000204
	speed: 0.6011s/iter; left time: 20861.9111s
Epoch: 16 cost time: 242.8210527896881
Epoch: 16, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.129 Vali Acc: 0.979 Test Loss: 0.129 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000899
	speed: 1.2290s/iter; left time: 42515.6540s
	iters: 200, epoch: 17 | loss: 0.1195721
	speed: 0.5706s/iter; left time: 19680.9139s
	iters: 300, epoch: 17 | loss: 0.0034732
	speed: 0.5435s/iter; left time: 18692.5781s
	iters: 400, epoch: 17 | loss: 0.0000021
	speed: 0.5709s/iter; left time: 19578.7071s
Epoch: 17 cost time: 235.5669128894806
Epoch: 17, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.200 Vali Acc: 0.969 Test Loss: 0.200 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 1.1982s/iter; left time: 40954.6856s
	iters: 200, epoch: 18 | loss: 0.0039970
	speed: 0.5798s/iter; left time: 19759.3192s
	iters: 300, epoch: 18 | loss: 0.0240935
	speed: 0.5735s/iter; left time: 19488.4697s
	iters: 400, epoch: 18 | loss: 0.0000668
	speed: 0.6204s/iter; left time: 21017.8244s
Epoch: 18 cost time: 248.65223717689514
Epoch: 18, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.249 Vali Acc: 0.967 Test Loss: 0.249 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0008441
	speed: 1.3374s/iter; left time: 45160.2361s
	iters: 200, epoch: 19 | loss: 0.0012676
	speed: 0.6949s/iter; left time: 23393.7894s
	iters: 300, epoch: 19 | loss: 0.0008331
	speed: 0.6841s/iter; left time: 22962.7022s
	iters: 400, epoch: 19 | loss: 0.0030000
	speed: 0.6720s/iter; left time: 22488.7267s
Epoch: 19 cost time: 278.3633089065552
Epoch: 19, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.181 Vali Acc: 0.972 Test Loss: 0.181 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0002588
	speed: 1.3977s/iter; left time: 46619.2595s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.6940s/iter; left time: 23079.0820s
	iters: 300, epoch: 20 | loss: 0.0000237
	speed: 0.6950s/iter; left time: 23043.4244s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.6303s/iter; left time: 20833.9352s
Epoch: 20 cost time: 277.95780205726624
Epoch: 20, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.108 Vali Acc: 0.982 Test Loss: 0.108 Test Acc: 0.982
Validation loss decreased (-0.978626 --> -0.982264).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0012411
	speed: 1.2647s/iter; left time: 41660.2986s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.6640s/iter; left time: 21806.3221s
	iters: 300, epoch: 21 | loss: 0.0000846
	speed: 0.7067s/iter; left time: 23138.7540s
	iters: 400, epoch: 21 | loss: 0.0000830
	speed: 0.6510s/iter; left time: 21249.4877s
Epoch: 21 cost time: 269.6445071697235
Epoch: 21, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.214 Vali Acc: 0.975 Test Loss: 0.214 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000017
	speed: 1.3030s/iter; left time: 42383.1118s
	iters: 200, epoch: 22 | loss: 0.0003587
	speed: 0.6544s/iter; left time: 21222.4984s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.6902s/iter; left time: 22312.7435s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.6612s/iter; left time: 21307.5888s
Epoch: 22 cost time: 273.27564668655396
Epoch: 22, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.205 Vali Acc: 0.972 Test Loss: 0.205 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000001
	speed: 1.3155s/iter; left time: 42247.8371s
	iters: 200, epoch: 23 | loss: 0.0000021
	speed: 0.6821s/iter; left time: 21835.9633s
	iters: 300, epoch: 23 | loss: 0.0000033
	speed: 0.6354s/iter; left time: 20279.0555s
	iters: 400, epoch: 23 | loss: 0.0000473
	speed: 0.6292s/iter; left time: 20017.8387s
Epoch: 23 cost time: 272.0066647529602
Epoch: 23, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.292 Vali Acc: 0.956 Test Loss: 0.292 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0000116
	speed: 1.4476s/iter; left time: 45890.8332s
	iters: 200, epoch: 24 | loss: 0.0000145
	speed: 0.7395s/iter; left time: 23370.9020s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.6971s/iter; left time: 21961.5508s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.6633s/iter; left time: 20827.9955s
Epoch: 24 cost time: 289.7535288333893
Epoch: 24, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.087 Vali Acc: 0.986 Test Loss: 0.087 Test Acc: 0.986
Validation loss decreased (-0.982264 --> -0.985902).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0000036
	speed: 1.4789s/iter; left time: 46272.3609s
	iters: 200, epoch: 25 | loss: 0.3452330
	speed: 0.6941s/iter; left time: 21646.8262s
	iters: 300, epoch: 25 | loss: 0.0007100
	speed: 0.7437s/iter; left time: 23121.4219s
	iters: 400, epoch: 25 | loss: 0.0000168
	speed: 0.7344s/iter; left time: 22757.4129s
Epoch: 25 cost time: 303.08948612213135
Epoch: 25, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.139 Vali Acc: 0.977 Test Loss: 0.139 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0013255
	speed: 1.4688s/iter; left time: 45351.4170s
	iters: 200, epoch: 26 | loss: 0.0007461
	speed: 0.6592s/iter; left time: 20286.6054s
	iters: 300, epoch: 26 | loss: 0.0004036
	speed: 0.7205s/iter; left time: 22101.3106s
	iters: 400, epoch: 26 | loss: 0.0599605
	speed: 0.7638s/iter; left time: 23353.1562s
Epoch: 26 cost time: 295.61230850219727
Epoch: 26, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.200 Vali Acc: 0.969 Test Loss: 0.200 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.8341639
	speed: 1.3676s/iter; left time: 41660.4638s
	iters: 200, epoch: 27 | loss: 0.0000025
	speed: 0.6886s/iter; left time: 20906.6529s
	iters: 300, epoch: 27 | loss: 0.0015341
	speed: 0.6628s/iter; left time: 20057.3023s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.6292s/iter; left time: 18979.5648s
Epoch: 27 cost time: 270.1759068965912
Epoch: 27, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.101 Vali Acc: 0.979 Test Loss: 0.101 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0000044
	speed: 1.3368s/iter; left time: 40169.5551s
	iters: 200, epoch: 28 | loss: 0.0000004
	speed: 0.6295s/iter; left time: 18854.5343s
	iters: 300, epoch: 28 | loss: 0.0006940
	speed: 0.6342s/iter; left time: 18931.3977s
	iters: 400, epoch: 28 | loss: 0.0000006
	speed: 0.6473s/iter; left time: 19255.9755s
Epoch: 28 cost time: 264.0373487472534
Epoch: 28, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0000027
	speed: 1.2600s/iter; left time: 37343.6740s
	iters: 200, epoch: 29 | loss: 0.0000135
	speed: 0.6107s/iter; left time: 18037.6887s
	iters: 300, epoch: 29 | loss: 0.0000001
	speed: 0.6314s/iter; left time: 18587.0672s
	iters: 400, epoch: 29 | loss: 0.0000013
	speed: 0.6283s/iter; left time: 18431.0252s
Epoch: 29 cost time: 253.1853530406952
Epoch: 29, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.099 Vali Acc: 0.985 Test Loss: 0.099 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0000012
	speed: 1.3102s/iter; left time: 38289.5985s
	iters: 200, epoch: 30 | loss: 0.0000022
	speed: 0.6459s/iter; left time: 18809.9698s
	iters: 300, epoch: 30 | loss: 0.0000014
	speed: 0.7085s/iter; left time: 20562.8083s
	iters: 400, epoch: 30 | loss: 0.0067640
	speed: 0.6105s/iter; left time: 17658.6482s
Epoch: 30 cost time: 269.60313272476196
Epoch: 30, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.143 Vali Acc: 0.982 Test Loss: 0.143 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 1.3846s/iter; left time: 39892.8103s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.7136s/iter; left time: 20488.2281s
	iters: 300, epoch: 31 | loss: 0.2213374
	speed: 0.5868s/iter; left time: 16790.0746s
	iters: 400, epoch: 31 | loss: 0.0012776
	speed: 0.6575s/iter; left time: 18746.8417s
Epoch: 31 cost time: 275.8410313129425
Epoch: 31, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.114 Vali Acc: 0.981 Test Loss: 0.114 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 1.3435s/iter; left time: 38153.6709s
	iters: 200, epoch: 32 | loss: 0.0000007
	speed: 0.6775s/iter; left time: 19171.8451s
	iters: 300, epoch: 32 | loss: 0.0000013
	speed: 0.6780s/iter; left time: 19119.0035s
	iters: 400, epoch: 32 | loss: 0.3631047
	speed: 0.6121s/iter; left time: 17198.7907s
Epoch: 32 cost time: 268.4921956062317
Epoch: 32, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.323 Vali Acc: 0.962 Test Loss: 0.323 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 1.2741s/iter; left time: 35656.8270s
	iters: 200, epoch: 33 | loss: 0.0000025
	speed: 0.6724s/iter; left time: 18748.9750s
	iters: 300, epoch: 33 | loss: 0.0000004
	speed: 0.6573s/iter; left time: 18262.1090s
	iters: 400, epoch: 33 | loss: 0.0000001
	speed: 0.6367s/iter; left time: 17627.2936s
Epoch: 33 cost time: 270.2974350452423
Epoch: 33, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.127 Vali Acc: 0.980 Test Loss: 0.127 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.0000004
	speed: 1.3516s/iter; left time: 37267.5025s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.5972s/iter; left time: 16405.3848s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.6611s/iter; left time: 18094.4803s
	iters: 400, epoch: 34 | loss: 0.0000770
	speed: 0.6612s/iter; left time: 18031.3623s
Epoch: 34 cost time: 264.04737854003906
Epoch: 34, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.104 Vali Acc: 0.984 Test Loss: 0.104 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df128_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9859026830377444
model parameter : 810250
model size : 8.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.6747988
	speed: 0.6419s/iter; left time: 26446.9287s
	iters: 200, epoch: 1 | loss: 0.1956503
	speed: 0.6524s/iter; left time: 26815.4934s
	iters: 300, epoch: 1 | loss: 0.1419532
	speed: 0.6021s/iter; left time: 24686.9764s
	iters: 400, epoch: 1 | loss: 0.1647335
	speed: 0.5776s/iter; left time: 23623.9934s
Epoch: 1 cost time: 255.1610643863678
Epoch: 1, Steps: 413 | Train Loss: 0.815 Vali Loss: 0.106 Vali Acc: 0.972 Test Loss: 0.106 Test Acc: 0.972
Validation loss decreased (inf --> -0.972259).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1062068
	speed: 1.1709s/iter; left time: 47757.4103s
	iters: 200, epoch: 2 | loss: 0.0202365
	speed: 0.5544s/iter; left time: 22556.2192s
	iters: 300, epoch: 2 | loss: 0.0559057
	speed: 0.5323s/iter; left time: 21605.7291s
	iters: 400, epoch: 2 | loss: 0.0054276
	speed: 0.5367s/iter; left time: 21731.6277s
Epoch: 2 cost time: 228.10924196243286
Epoch: 2, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0075345
	speed: 1.1648s/iter; left time: 47028.9336s
	iters: 200, epoch: 3 | loss: 0.0246610
	speed: 0.5638s/iter; left time: 22705.3440s
	iters: 300, epoch: 3 | loss: 0.0089825
	speed: 0.5340s/iter; left time: 21455.0450s
	iters: 400, epoch: 3 | loss: 0.0131741
	speed: 0.5563s/iter; left time: 22291.7949s
Epoch: 3 cost time: 230.74032711982727
Epoch: 3, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.972259 --> -0.976807).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0037795
	speed: 1.1583s/iter; left time: 46289.4754s
	iters: 200, epoch: 4 | loss: 0.0004663
	speed: 0.5929s/iter; left time: 23633.8249s
	iters: 300, epoch: 4 | loss: 0.0183999
	speed: 0.5649s/iter; left time: 22461.7345s
	iters: 400, epoch: 4 | loss: 0.0101223
	speed: 0.5279s/iter; left time: 20939.1158s
Epoch: 4 cost time: 233.25171446800232
Epoch: 4, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.102 Vali Acc: 0.969 Test Loss: 0.102 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000571
	speed: 1.1592s/iter; left time: 45846.8477s
	iters: 200, epoch: 5 | loss: 0.0009528
	speed: 0.6117s/iter; left time: 24130.4409s
	iters: 300, epoch: 5 | loss: 0.3335359
	speed: 0.5581s/iter; left time: 21960.6153s
	iters: 400, epoch: 5 | loss: 0.0051953
	speed: 0.5353s/iter; left time: 21008.3843s
Epoch: 5 cost time: 235.97469210624695
Epoch: 5, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.085 Vali Acc: 0.975 Test Loss: 0.085 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000772
	speed: 1.2126s/iter; left time: 47457.4854s
	iters: 200, epoch: 6 | loss: 0.0860419
	speed: 0.5997s/iter; left time: 23408.9022s
	iters: 300, epoch: 6 | loss: 0.0013333
	speed: 0.6281s/iter; left time: 24456.1658s
	iters: 400, epoch: 6 | loss: 0.0131760
	speed: 0.6453s/iter; left time: 25062.2415s
Epoch: 6 cost time: 258.33274388313293
Epoch: 6, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0026909
	speed: 1.1854s/iter; left time: 45901.9162s
	iters: 200, epoch: 7 | loss: 0.0002147
	speed: 0.6410s/iter; left time: 24757.5484s
	iters: 300, epoch: 7 | loss: 0.0082245
	speed: 0.5937s/iter; left time: 22871.3722s
	iters: 400, epoch: 7 | loss: 0.0098186
	speed: 0.5413s/iter; left time: 20798.4339s
Epoch: 7 cost time: 241.11896347999573
Epoch: 7, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.184 Vali Acc: 0.963 Test Loss: 0.184 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0008356
	speed: 1.1380s/iter; left time: 43594.9058s
	iters: 200, epoch: 8 | loss: 0.1088138
	speed: 0.5489s/iter; left time: 20973.2151s
	iters: 300, epoch: 8 | loss: 0.0000038
	speed: 0.5620s/iter; left time: 21417.4498s
	iters: 400, epoch: 8 | loss: 0.0000002
	speed: 0.5397s/iter; left time: 20513.4763s
Epoch: 8 cost time: 231.22050666809082
Epoch: 8, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
Validation loss decreased (-0.976807 --> -0.978171).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0020663
	speed: 1.1899s/iter; left time: 45092.9006s
	iters: 200, epoch: 9 | loss: 0.4088495
	speed: 0.5973s/iter; left time: 22574.3115s
	iters: 300, epoch: 9 | loss: 0.0138239
	speed: 0.6209s/iter; left time: 23406.6543s
	iters: 400, epoch: 9 | loss: 0.0068901
	speed: 0.6331s/iter; left time: 23802.8691s
Epoch: 9 cost time: 249.98833441734314
Epoch: 9, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.211 Vali Acc: 0.965 Test Loss: 0.211 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000005
	speed: 1.2007s/iter; left time: 45007.2012s
	iters: 200, epoch: 10 | loss: 0.0000087
	speed: 0.5956s/iter; left time: 22266.1061s
	iters: 300, epoch: 10 | loss: 0.2955855
	speed: 0.5634s/iter; left time: 21006.3200s
	iters: 400, epoch: 10 | loss: 0.0000729
	speed: 0.5542s/iter; left time: 20606.7857s
Epoch: 10 cost time: 235.88703680038452
Epoch: 10, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000001
	speed: 1.1412s/iter; left time: 42304.3147s
	iters: 200, epoch: 11 | loss: 0.0000350
	speed: 0.6392s/iter; left time: 23631.7622s
	iters: 300, epoch: 11 | loss: 0.0000001
	speed: 0.6471s/iter; left time: 23857.6216s
	iters: 400, epoch: 11 | loss: 0.0010963
	speed: 0.5980s/iter; left time: 21989.3444s
Epoch: 11 cost time: 254.1428701877594
Epoch: 11, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.180 Vali Acc: 0.971 Test Loss: 0.180 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.1315617
	speed: 1.1948s/iter; left time: 43798.3754s
	iters: 200, epoch: 12 | loss: 0.1367234
	speed: 0.5501s/iter; left time: 20109.3796s
	iters: 300, epoch: 12 | loss: 0.0021593
	speed: 0.5341s/iter; left time: 19470.7593s
	iters: 400, epoch: 12 | loss: 0.0001232
	speed: 0.5661s/iter; left time: 20581.9477s
Epoch: 12 cost time: 232.13266563415527
Epoch: 12, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.978171 --> -0.980445).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0002431
	speed: 1.1478s/iter; left time: 41603.3715s
	iters: 200, epoch: 13 | loss: 0.0000008
	speed: 0.5507s/iter; left time: 19903.2447s
	iters: 300, epoch: 13 | loss: 0.0000150
	speed: 0.5500s/iter; left time: 19826.5043s
	iters: 400, epoch: 13 | loss: 0.0001081
	speed: 0.5917s/iter; left time: 21268.0720s
Epoch: 13 cost time: 232.34935402870178
Epoch: 13, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.142 Vali Acc: 0.975 Test Loss: 0.142 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0135804
	speed: 1.2560s/iter; left time: 45005.0143s
	iters: 200, epoch: 14 | loss: 0.0017216
	speed: 0.7410s/iter; left time: 26475.8024s
	iters: 300, epoch: 14 | loss: 0.0003707
	speed: 0.5565s/iter; left time: 19829.3401s
	iters: 400, epoch: 14 | loss: 0.0292088
	speed: 0.5740s/iter; left time: 20396.0233s
Epoch: 14 cost time: 261.7220666408539
Epoch: 14, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.133 Vali Acc: 0.979 Test Loss: 0.133 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0185132
	speed: 1.1500s/iter; left time: 40730.8182s
	iters: 200, epoch: 15 | loss: 0.0019843
	speed: 0.5456s/iter; left time: 19270.5934s
	iters: 300, epoch: 15 | loss: 0.0000001
	speed: 0.6113s/iter; left time: 21529.4031s
	iters: 400, epoch: 15 | loss: 0.0000039
	speed: 0.5410s/iter; left time: 19000.4358s
Epoch: 15 cost time: 233.3044502735138
Epoch: 15, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.151 Vali Acc: 0.975 Test Loss: 0.151 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0819715
	speed: 1.1833s/iter; left time: 41423.3437s
	iters: 200, epoch: 16 | loss: 0.0000063
	speed: 0.5840s/iter; left time: 20386.7439s
	iters: 300, epoch: 16 | loss: 0.0322451
	speed: 0.6129s/iter; left time: 21332.6631s
	iters: 400, epoch: 16 | loss: 0.0000027
	speed: 0.5533s/iter; left time: 19202.0404s
Epoch: 16 cost time: 244.2699489593506
Epoch: 16, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.182 Vali Acc: 0.973 Test Loss: 0.182 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000004
	speed: 1.1671s/iter; left time: 40372.1377s
	iters: 200, epoch: 17 | loss: 0.0000098
	speed: 0.5853s/iter; left time: 20190.2445s
	iters: 300, epoch: 17 | loss: 0.0000049
	speed: 0.5572s/iter; left time: 19163.6584s
	iters: 400, epoch: 17 | loss: 0.0000719
	speed: 0.6247s/iter; left time: 21422.5491s
Epoch: 17 cost time: 246.08154845237732
Epoch: 17, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.145 Vali Acc: 0.977 Test Loss: 0.145 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0012073
	speed: 1.2801s/iter; left time: 43753.3172s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.6325s/iter; left time: 21556.8021s
	iters: 300, epoch: 18 | loss: 0.0008041
	speed: 0.6028s/iter; left time: 20482.6700s
	iters: 400, epoch: 18 | loss: 0.0666037
	speed: 0.5527s/iter; left time: 18725.3615s
Epoch: 18 cost time: 247.1242892742157
Epoch: 18, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.363 Vali Acc: 0.961 Test Loss: 0.363 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0001368
	speed: 1.0953s/iter; left time: 36985.6682s
	iters: 200, epoch: 19 | loss: 0.0000001
	speed: 0.5808s/iter; left time: 19553.2473s
	iters: 300, epoch: 19 | loss: 0.0002126
	speed: 0.6134s/iter; left time: 20588.4898s
	iters: 400, epoch: 19 | loss: 0.0000585
	speed: 0.6130s/iter; left time: 20514.1672s
Epoch: 19 cost time: 245.13121938705444
Epoch: 19, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.243 Vali Acc: 0.972 Test Loss: 0.243 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0002352
	speed: 1.3766s/iter; left time: 45914.4402s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.6556s/iter; left time: 21801.0669s
	iters: 300, epoch: 20 | loss: 0.0000595
	speed: 0.6666s/iter; left time: 22099.9268s
	iters: 400, epoch: 20 | loss: 0.0000641
	speed: 0.6743s/iter; left time: 22289.0136s
Epoch: 20 cost time: 277.2957773208618
Epoch: 20, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.252 Vali Acc: 0.965 Test Loss: 0.252 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000034
	speed: 1.3693s/iter; left time: 45105.6124s
	iters: 200, epoch: 21 | loss: 0.0010551
	speed: 0.5905s/iter; left time: 19393.2492s
	iters: 300, epoch: 21 | loss: 0.0000007
	speed: 0.6101s/iter; left time: 19974.6107s
	iters: 400, epoch: 21 | loss: 0.0000014
	speed: 0.6623s/iter; left time: 21616.6666s
Epoch: 21 cost time: 263.69210624694824
Epoch: 21, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.176 Vali Acc: 0.976 Test Loss: 0.176 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000003
	speed: 1.3814s/iter; left time: 44934.6305s
	iters: 200, epoch: 22 | loss: 0.0851484
	speed: 0.6512s/iter; left time: 21117.8750s
	iters: 300, epoch: 22 | loss: 0.0302841
	speed: 0.6664s/iter; left time: 21544.7834s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.6555s/iter; left time: 21124.9458s
Epoch: 22 cost time: 273.5578989982605
Epoch: 22, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.289 Vali Acc: 0.963 Test Loss: 0.289 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9804456571168713
model parameter : 810250
model size : 8.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.4465318
	speed: 0.5472s/iter; left time: 22544.8307s
	iters: 200, epoch: 1 | loss: 0.1889134
	speed: 0.5187s/iter; left time: 21319.2384s
	iters: 300, epoch: 1 | loss: 0.1718632
	speed: 0.5471s/iter; left time: 22432.2229s
	iters: 400, epoch: 1 | loss: 0.2182508
	speed: 0.5378s/iter; left time: 21995.0658s
Epoch: 1 cost time: 222.16719031333923
Epoch: 1, Steps: 413 | Train Loss: 0.811 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
Validation loss decreased (inf --> -0.969531).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0675043
	speed: 1.0339s/iter; left time: 42169.4133s
	iters: 200, epoch: 2 | loss: 0.0229595
	speed: 0.5702s/iter; left time: 23199.5267s
	iters: 300, epoch: 2 | loss: 0.0549429
	speed: 0.5687s/iter; left time: 23082.1673s
	iters: 400, epoch: 2 | loss: 0.0029567
	speed: 0.5248s/iter; left time: 21249.4390s
Epoch: 2 cost time: 222.32541847229004
Epoch: 2, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.969531 --> -0.977262).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0077976
	speed: 1.1840s/iter; left time: 47802.3235s
	iters: 200, epoch: 3 | loss: 0.2813358
	speed: 0.5438s/iter; left time: 21900.0328s
	iters: 300, epoch: 3 | loss: 0.0628252
	speed: 0.5231s/iter; left time: 21017.0691s
	iters: 400, epoch: 3 | loss: 0.0095609
	speed: 0.5293s/iter; left time: 21211.8169s
Epoch: 3 cost time: 228.32748937606812
Epoch: 3, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.083 Vali Acc: 0.972 Test Loss: 0.083 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1301736
	speed: 1.1469s/iter; left time: 45832.2591s
	iters: 200, epoch: 4 | loss: 0.0007167
	speed: 0.5455s/iter; left time: 21744.7916s
	iters: 300, epoch: 4 | loss: 0.0417446
	speed: 0.5486s/iter; left time: 21813.3285s
	iters: 400, epoch: 4 | loss: 0.0029733
	speed: 0.5803s/iter; left time: 23014.9892s
Epoch: 4 cost time: 234.26860857009888
Epoch: 4, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.078 Vali Acc: 0.975 Test Loss: 0.078 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0029549
	speed: 1.1341s/iter; left time: 44852.6909s
	iters: 200, epoch: 5 | loss: 0.0030340
	speed: 0.5759s/iter; left time: 22720.1658s
	iters: 300, epoch: 5 | loss: 0.0009818
	speed: 0.5505s/iter; left time: 21660.6392s
	iters: 400, epoch: 5 | loss: 0.0035897
	speed: 0.5558s/iter; left time: 21813.8827s
Epoch: 5 cost time: 231.95298886299133
Epoch: 5, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0004194
	speed: 1.2645s/iter; left time: 49489.3115s
	iters: 200, epoch: 6 | loss: 0.0041986
	speed: 0.6919s/iter; left time: 27007.3886s
	iters: 300, epoch: 6 | loss: 0.0260007
	speed: 0.6243s/iter; left time: 24306.0497s
	iters: 400, epoch: 6 | loss: 0.0005178
	speed: 0.6241s/iter; left time: 24235.6608s
Epoch: 6 cost time: 268.0967080593109
Epoch: 6, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.077 Vali Acc: 0.975 Test Loss: 0.077 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0886892
	speed: 1.2841s/iter; left time: 49722.8019s
	iters: 200, epoch: 7 | loss: 0.0024753
	speed: 0.6304s/iter; left time: 24346.9087s
	iters: 300, epoch: 7 | loss: 0.0001967
	speed: 0.5537s/iter; left time: 21330.4035s
	iters: 400, epoch: 7 | loss: 0.0075072
	speed: 0.6393s/iter; left time: 24564.4989s
Epoch: 7 cost time: 256.17049407958984
Epoch: 7, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.154 Vali Acc: 0.970 Test Loss: 0.154 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0046966
	speed: 1.2546s/iter; left time: 48065.4281s
	iters: 200, epoch: 8 | loss: 0.0003607
	speed: 0.5938s/iter; left time: 22689.2612s
	iters: 300, epoch: 8 | loss: 0.0110314
	speed: 0.6033s/iter; left time: 22991.1805s
	iters: 400, epoch: 8 | loss: 0.0043110
	speed: 0.5819s/iter; left time: 22117.3065s
Epoch: 8 cost time: 248.05754041671753
Epoch: 8, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.136 Vali Acc: 0.967 Test Loss: 0.136 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0001163
	speed: 1.2606s/iter; left time: 47773.1779s
	iters: 200, epoch: 9 | loss: 0.0002641
	speed: 0.6912s/iter; left time: 26124.3747s
	iters: 300, epoch: 9 | loss: 0.0000671
	speed: 0.6757s/iter; left time: 25473.2841s
	iters: 400, epoch: 9 | loss: 0.0000550
	speed: 0.6656s/iter; left time: 25023.8105s
Epoch: 9 cost time: 273.2427034378052
Epoch: 9, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.098 Vali Acc: 0.981 Test Loss: 0.098 Test Acc: 0.981
Validation loss decreased (-0.977262 --> -0.980899).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000059
	speed: 1.1991s/iter; left time: 44947.2193s
	iters: 200, epoch: 10 | loss: 0.0002399
	speed: 0.6036s/iter; left time: 22565.0096s
	iters: 300, epoch: 10 | loss: 0.1014223
	speed: 0.6017s/iter; left time: 22433.4871s
	iters: 400, epoch: 10 | loss: 0.0085603
	speed: 0.6170s/iter; left time: 22943.6739s
Epoch: 10 cost time: 250.77687191963196
Epoch: 10, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.176 Vali Acc: 0.970 Test Loss: 0.176 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0001205
	speed: 1.3246s/iter; left time: 49104.7513s
	iters: 200, epoch: 11 | loss: 0.0000087
	speed: 0.6094s/iter; left time: 22530.2856s
	iters: 300, epoch: 11 | loss: 0.0000235
	speed: 0.6014s/iter; left time: 22175.5648s
	iters: 400, epoch: 11 | loss: 0.0085442
	speed: 0.6352s/iter; left time: 23356.4455s
Epoch: 11 cost time: 259.5523111820221
Epoch: 11, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.245 Vali Acc: 0.965 Test Loss: 0.245 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0031026
	speed: 1.3046s/iter; left time: 47823.6124s
	iters: 200, epoch: 12 | loss: 0.0811376
	speed: 0.5611s/iter; left time: 20511.2723s
	iters: 300, epoch: 12 | loss: 0.0000077
	speed: 0.5661s/iter; left time: 20639.8410s
	iters: 400, epoch: 12 | loss: 0.0000142
	speed: 0.5901s/iter; left time: 21456.3269s
Epoch: 12 cost time: 241.5126814842224
Epoch: 12, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.127 Vali Acc: 0.976 Test Loss: 0.127 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0307730
	speed: 1.1974s/iter; left time: 43400.0103s
	iters: 200, epoch: 13 | loss: 0.0191731
	speed: 0.6056s/iter; left time: 21890.4037s
	iters: 300, epoch: 13 | loss: 0.0000398
	speed: 0.6236s/iter; left time: 22478.1349s
	iters: 400, epoch: 13 | loss: 0.0000635
	speed: 0.5840s/iter; left time: 20993.1900s
Epoch: 13 cost time: 246.08558702468872
Epoch: 13, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.161 Vali Acc: 0.972 Test Loss: 0.161 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0009520
	speed: 1.1458s/iter; left time: 41056.4113s
	iters: 200, epoch: 14 | loss: 0.0121396
	speed: 0.5634s/iter; left time: 20131.0384s
	iters: 300, epoch: 14 | loss: 0.0327615
	speed: 0.5899s/iter; left time: 21019.4084s
	iters: 400, epoch: 14 | loss: 0.3309506
	speed: 0.6153s/iter; left time: 21863.8386s
Epoch: 14 cost time: 242.6904022693634
Epoch: 14, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.180 Vali Acc: 0.973 Test Loss: 0.180 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0032272
	speed: 1.2191s/iter; left time: 43178.1362s
	iters: 200, epoch: 15 | loss: 0.0075224
	speed: 0.5534s/iter; left time: 19546.3094s
	iters: 300, epoch: 15 | loss: 0.0000021
	speed: 0.6022s/iter; left time: 21207.6916s
	iters: 400, epoch: 15 | loss: 0.0000003
	speed: 0.6517s/iter; left time: 22885.8862s
Epoch: 15 cost time: 244.886212348938
Epoch: 15, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.147 Vali Acc: 0.974 Test Loss: 0.147 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0000016
	speed: 1.1250s/iter; left time: 39382.4112s
	iters: 200, epoch: 16 | loss: 0.0075667
	speed: 0.5843s/iter; left time: 20394.8117s
	iters: 300, epoch: 16 | loss: 0.0000003
	speed: 0.6113s/iter; left time: 21275.8531s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.6363s/iter; left time: 22082.4118s
Epoch: 16 cost time: 247.68747067451477
Epoch: 16, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.205 Vali Acc: 0.975 Test Loss: 0.205 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0000017
	speed: 1.1700s/iter; left time: 40475.4638s
	iters: 200, epoch: 17 | loss: 0.0000011
	speed: 0.5866s/iter; left time: 20233.2784s
	iters: 300, epoch: 17 | loss: 0.0054297
	speed: 0.5738s/iter; left time: 19733.8416s
	iters: 400, epoch: 17 | loss: 0.0002413
	speed: 0.5546s/iter; left time: 19020.4428s
Epoch: 17 cost time: 237.80307483673096
Epoch: 17, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0000013
	speed: 1.1940s/iter; left time: 40809.7064s
	iters: 200, epoch: 18 | loss: 0.0000002
	speed: 0.5511s/iter; left time: 18780.4564s
	iters: 300, epoch: 18 | loss: 0.0009794
	speed: 0.6085s/iter; left time: 20675.3325s
	iters: 400, epoch: 18 | loss: 0.0000255
	speed: 0.5788s/iter; left time: 19610.6147s
Epoch: 18 cost time: 239.93483209609985
Epoch: 18, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000085
	speed: 1.1610s/iter; left time: 39204.8537s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.5411s/iter; left time: 18217.8342s
	iters: 300, epoch: 19 | loss: 0.0000132
	speed: 0.5718s/iter; left time: 19194.7220s
	iters: 400, epoch: 19 | loss: 0.0000003
	speed: 0.5571s/iter; left time: 18644.3412s
Epoch: 19 cost time: 231.12678337097168
Epoch: 19, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.200 Vali Acc: 0.972 Test Loss: 0.200 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9809004092769441
model parameter : 810250
model size : 8.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.4693481
	speed: 0.5692s/iter; left time: 23451.3133s
	iters: 200, epoch: 1 | loss: 0.1415817
	speed: 0.4945s/iter; left time: 20323.9711s
	iters: 300, epoch: 1 | loss: 0.1561535
	speed: 0.5327s/iter; left time: 21840.4900s
	iters: 400, epoch: 1 | loss: 0.4123801
	speed: 0.5032s/iter; left time: 20580.2140s
Epoch: 1 cost time: 216.544424533844
Epoch: 1, Steps: 413 | Train Loss: 0.789 Vali Loss: 0.095 Vali Acc: 0.972 Test Loss: 0.095 Test Acc: 0.972
Validation loss decreased (inf --> -0.972259).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0853309
	speed: 0.9532s/iter; left time: 38880.6426s
	iters: 200, epoch: 2 | loss: 0.0375375
	speed: 0.5553s/iter; left time: 22593.6342s
	iters: 300, epoch: 2 | loss: 0.1117549
	speed: 0.5648s/iter; left time: 22926.0379s
	iters: 400, epoch: 2 | loss: 0.1576922
	speed: 0.5800s/iter; left time: 23481.5195s
Epoch: 2 cost time: 223.1881468296051
Epoch: 2, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0022333
	speed: 1.1089s/iter; left time: 44770.8709s
	iters: 200, epoch: 3 | loss: 0.2870411
	speed: 0.5107s/iter; left time: 20566.8228s
	iters: 300, epoch: 3 | loss: 0.0216727
	speed: 0.5199s/iter; left time: 20887.8413s
	iters: 400, epoch: 3 | loss: 0.0357761
	speed: 0.5592s/iter; left time: 22411.1303s
Epoch: 3 cost time: 220.90994668006897
Epoch: 3, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.052 Vali Acc: 0.980 Test Loss: 0.052 Test Acc: 0.980
Validation loss decreased (-0.972259 --> -0.980445).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0265064
	speed: 1.1480s/iter; left time: 45876.4448s
	iters: 200, epoch: 4 | loss: 0.0034851
	speed: 0.5507s/iter; left time: 21952.4947s
	iters: 300, epoch: 4 | loss: 0.0146136
	speed: 0.5418s/iter; left time: 21543.8076s
	iters: 400, epoch: 4 | loss: 0.0088207
	speed: 0.4984s/iter; left time: 19769.0629s
Epoch: 4 cost time: 222.68270611763
Epoch: 4, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0002073
	speed: 1.0268s/iter; left time: 40610.1323s
	iters: 200, epoch: 5 | loss: 0.0031893
	speed: 0.4672s/iter; left time: 18431.9637s
	iters: 300, epoch: 5 | loss: 0.0002524
	speed: 0.5035s/iter; left time: 19812.9844s
	iters: 400, epoch: 5 | loss: 0.1962629
	speed: 0.5309s/iter; left time: 20838.5581s
Epoch: 5 cost time: 204.7719955444336
Epoch: 5, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.079 Vali Acc: 0.979 Test Loss: 0.079 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0050303
	speed: 1.1394s/iter; left time: 44591.5075s
	iters: 200, epoch: 6 | loss: 0.0150236
	speed: 0.5844s/iter; left time: 22812.8919s
	iters: 300, epoch: 6 | loss: 0.0722266
	speed: 0.5246s/iter; left time: 20425.7404s
	iters: 400, epoch: 6 | loss: 0.0008024
	speed: 0.4825s/iter; left time: 18739.1035s
Epoch: 6 cost time: 222.96979999542236
Epoch: 6, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0004739
	speed: 1.0177s/iter; left time: 39410.0230s
	iters: 200, epoch: 7 | loss: 0.0726226
	speed: 0.5089s/iter; left time: 19656.0799s
	iters: 300, epoch: 7 | loss: 0.0082241
	speed: 0.5310s/iter; left time: 20454.3820s
	iters: 400, epoch: 7 | loss: 0.0450379
	speed: 0.5633s/iter; left time: 21645.0619s
Epoch: 7 cost time: 217.81830477714539
Epoch: 7, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0116258
	speed: 1.0869s/iter; left time: 41640.1831s
	iters: 200, epoch: 8 | loss: 0.0003373
	speed: 0.4868s/iter; left time: 18602.3336s
	iters: 300, epoch: 8 | loss: 0.2963862
	speed: 0.4752s/iter; left time: 18111.1924s
	iters: 400, epoch: 8 | loss: 0.0008129
	speed: 0.5111s/iter; left time: 19428.0729s
Epoch: 8 cost time: 206.91763138771057
Epoch: 8, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000473
	speed: 1.0063s/iter; left time: 38135.3545s
	iters: 200, epoch: 9 | loss: 0.0018892
	speed: 0.5003s/iter; left time: 18910.9802s
	iters: 300, epoch: 9 | loss: 0.0000002
	speed: 0.5342s/iter; left time: 20139.2311s
	iters: 400, epoch: 9 | loss: 0.0006467
	speed: 0.5203s/iter; left time: 19562.2167s
Epoch: 9 cost time: 210.93217706680298
Epoch: 9, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0000055
	speed: 1.0621s/iter; left time: 39810.1792s
	iters: 200, epoch: 10 | loss: 0.0023599
	speed: 0.5157s/iter; left time: 19277.8458s
	iters: 300, epoch: 10 | loss: 0.0017731
	speed: 0.5060s/iter; left time: 18864.2968s
	iters: 400, epoch: 10 | loss: 0.0231322
	speed: 0.5417s/iter; left time: 20142.8453s
Epoch: 10 cost time: 214.73223543167114
Epoch: 10, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.209 Vali Acc: 0.963 Test Loss: 0.209 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0000006
	speed: 1.0334s/iter; left time: 38307.7854s
	iters: 200, epoch: 11 | loss: 0.0000081
	speed: 0.5116s/iter; left time: 18915.4164s
	iters: 300, epoch: 11 | loss: 0.0000008
	speed: 0.5799s/iter; left time: 21380.8303s
	iters: 400, epoch: 11 | loss: 0.7553878
	speed: 0.5922s/iter; left time: 21775.4830s
Epoch: 11 cost time: 227.03031969070435
Epoch: 11, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.192 Vali Acc: 0.966 Test Loss: 0.192 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0082774
	speed: 1.1382s/iter; left time: 41722.9793s
	iters: 200, epoch: 12 | loss: 0.0548546
	speed: 0.5570s/iter; left time: 20364.6121s
	iters: 300, epoch: 12 | loss: 0.0000004
	speed: 0.5383s/iter; left time: 19624.4911s
	iters: 400, epoch: 12 | loss: 0.0000261
	speed: 0.5341s/iter; left time: 19419.9019s
Epoch: 12 cost time: 229.72481417655945
Epoch: 12, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 1.2353s/iter; left time: 44773.2590s
	iters: 200, epoch: 13 | loss: 0.0000305
	speed: 0.5714s/iter; left time: 20654.2791s
	iters: 300, epoch: 13 | loss: 0.0016045
	speed: 0.6287s/iter; left time: 22660.6904s
	iters: 400, epoch: 13 | loss: 0.0000123
	speed: 0.5488s/iter; left time: 19726.4565s
Epoch: 13 cost time: 242.2715117931366
Epoch: 13, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.110 Vali Acc: 0.974 Test Loss: 0.110 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9804456571168713
model parameter : 810250
model size : 8.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.3024499
	speed: 0.5620s/iter; left time: 23155.8685s
	iters: 200, epoch: 1 | loss: 2.3014820
	speed: 0.5770s/iter; left time: 23715.7308s
	iters: 300, epoch: 1 | loss: 2.3042378
	speed: 0.5344s/iter; left time: 21911.5356s
	iters: 400, epoch: 1 | loss: 2.3022301
	speed: 0.5995s/iter; left time: 24518.1427s
Epoch: 1 cost time: 237.19879007339478
Epoch: 1, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (inf --> -0.100022).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3009844
	speed: 1.1178s/iter; left time: 45593.3999s
	iters: 200, epoch: 2 | loss: 2.3034418
	speed: 0.5496s/iter; left time: 22363.4740s
	iters: 300, epoch: 2 | loss: 2.3035007
	speed: 0.5561s/iter; left time: 22571.6652s
	iters: 400, epoch: 2 | loss: 2.3028133
	speed: 0.5243s/iter; left time: 21226.9580s
Epoch: 2 cost time: 221.08334302902222
Epoch: 2, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.3022590
	speed: 1.1555s/iter; left time: 46652.5535s
	iters: 200, epoch: 3 | loss: 2.3037519
	speed: 0.6551s/iter; left time: 26385.4199s
	iters: 300, epoch: 3 | loss: 2.3009636
	speed: 0.6354s/iter; left time: 25527.7411s
	iters: 400, epoch: 3 | loss: 2.3024735
	speed: 0.6438s/iter; left time: 25799.7379s
Epoch: 3 cost time: 265.29576349258423
Epoch: 3, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 2.3040843
	speed: 1.1453s/iter; left time: 45768.7469s
	iters: 200, epoch: 4 | loss: 2.3056948
	speed: 0.5949s/iter; left time: 23712.6596s
	iters: 300, epoch: 4 | loss: 2.3010445
	speed: 0.5746s/iter; left time: 22848.0169s
	iters: 400, epoch: 4 | loss: 2.3041432
	speed: 0.5522s/iter; left time: 21901.5055s
Epoch: 4 cost time: 234.34333395957947
Epoch: 4, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 2.3016803
	speed: 1.2046s/iter; left time: 47641.7732s
	iters: 200, epoch: 5 | loss: 2.3074498
	speed: 0.5627s/iter; left time: 22199.4261s
	iters: 300, epoch: 5 | loss: 2.3041048
	speed: 0.5450s/iter; left time: 21445.3453s
	iters: 400, epoch: 5 | loss: 2.3016274
	speed: 0.5537s/iter; left time: 21731.9165s
Epoch: 5 cost time: 235.87301588058472
Epoch: 5, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 2.3003845
	speed: 1.1176s/iter; left time: 43739.8763s
	iters: 200, epoch: 6 | loss: 2.3013875
	speed: 0.6332s/iter; left time: 24716.1723s
	iters: 300, epoch: 6 | loss: 2.3012042
	speed: 0.6062s/iter; left time: 23601.2233s
	iters: 400, epoch: 6 | loss: 2.3032210
	speed: 0.5795s/iter; left time: 22503.6719s
Epoch: 6 cost time: 244.0241184234619
Epoch: 6, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 2.3009040
	speed: 1.1229s/iter; left time: 43480.6271s
	iters: 200, epoch: 7 | loss: 2.3009093
	speed: 0.5649s/iter; left time: 21818.6041s
	iters: 300, epoch: 7 | loss: 2.3032522
	speed: 0.5247s/iter; left time: 20212.8859s
	iters: 400, epoch: 7 | loss: 2.3025353
	speed: 0.5727s/iter; left time: 22006.6810s
Epoch: 7 cost time: 228.4358561038971
Epoch: 7, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 2.3035970
	speed: 1.1955s/iter; left time: 45800.7747s
	iters: 200, epoch: 8 | loss: 2.3046951
	speed: 0.5297s/iter; left time: 20240.6753s
	iters: 300, epoch: 8 | loss: 2.3024275
	speed: 0.5592s/iter; left time: 21309.3161s
	iters: 400, epoch: 8 | loss: 2.3022459
	speed: 0.5892s/iter; left time: 22393.9192s
Epoch: 8 cost time: 233.02517175674438
Epoch: 8, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 9 | loss: 2.3051558
	speed: 1.1589s/iter; left time: 43920.1319s
	iters: 200, epoch: 9 | loss: 2.3024921
	speed: 0.5542s/iter; left time: 20947.4846s
	iters: 300, epoch: 9 | loss: 2.3011065
	speed: 0.5186s/iter; left time: 19550.6968s
	iters: 400, epoch: 9 | loss: 2.3036251
	speed: 0.5786s/iter; left time: 21754.1101s
Epoch: 9 cost time: 232.08610272407532
Epoch: 9, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 10 | loss: 2.3050072
	speed: 1.1892s/iter; left time: 44577.3255s
	iters: 200, epoch: 10 | loss: 2.3032374
	speed: 0.5716s/iter; left time: 21367.2962s
	iters: 300, epoch: 10 | loss: 2.3020029
	speed: 0.5771s/iter; left time: 21516.6780s
	iters: 400, epoch: 10 | loss: 2.3029120
	speed: 0.5935s/iter; left time: 22067.7055s
Epoch: 10 cost time: 238.47810554504395
Epoch: 10, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 11 | loss: 2.3038547
	speed: 1.1079s/iter; left time: 41070.0597s
	iters: 200, epoch: 11 | loss: 2.3029904
	speed: 0.5683s/iter; left time: 21011.4933s
	iters: 300, epoch: 11 | loss: 2.3012576
	speed: 0.5542s/iter; left time: 20432.3607s
	iters: 400, epoch: 11 | loss: 2.3027318
	speed: 0.5303s/iter; left time: 19500.8536s
Epoch: 11 cost time: 227.83563661575317
Epoch: 11, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm128_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.10004547521600728
model parameter : 810250
model size : 8.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         47                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.5457042
	speed: 0.6054s/iter; left time: 24943.1137s
	iters: 200, epoch: 1 | loss: 0.7794195
	speed: 0.5205s/iter; left time: 21393.7607s
	iters: 300, epoch: 1 | loss: 0.1178021
	speed: 0.5692s/iter; left time: 23339.3709s
	iters: 400, epoch: 1 | loss: 0.0268969
	speed: 0.5939s/iter; left time: 24289.9778s
Epoch: 1 cost time: 236.36693286895752
Epoch: 1, Steps: 413 | Train Loss: 0.565 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
Validation loss decreased (inf --> -0.974533).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0235340
	speed: 1.1807s/iter; left time: 48158.7247s
	iters: 200, epoch: 2 | loss: 0.0461696
	speed: 0.5363s/iter; left time: 21821.8301s
	iters: 300, epoch: 2 | loss: 0.0160568
	speed: 0.5043s/iter; left time: 20469.0125s
	iters: 400, epoch: 2 | loss: 0.0293732
	speed: 0.5346s/iter; left time: 21644.7972s
Epoch: 2 cost time: 225.302734375
Epoch: 2, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
Validation loss decreased (-0.974533 --> -0.977262).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0045503
	speed: 1.1601s/iter; left time: 46840.3332s
	iters: 200, epoch: 3 | loss: 0.0103549
	speed: 0.5526s/iter; left time: 22255.1969s
	iters: 300, epoch: 3 | loss: 0.2381596
	speed: 0.5437s/iter; left time: 21844.6359s
	iters: 400, epoch: 3 | loss: 0.0028911
	speed: 0.5015s/iter; left time: 20097.2498s
Epoch: 3 cost time: 223.27138471603394
Epoch: 3, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.977262 --> -0.982719).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0017637
	speed: 1.1675s/iter; left time: 46655.5019s
	iters: 200, epoch: 4 | loss: 0.1065666
	speed: 0.5456s/iter; left time: 21747.2247s
	iters: 300, epoch: 4 | loss: 0.0808482
	speed: 0.5143s/iter; left time: 20450.8142s
	iters: 400, epoch: 4 | loss: 0.0028717
	speed: 0.5669s/iter; left time: 22485.2863s
Epoch: 4 cost time: 230.88873529434204
Epoch: 4, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0088299
	speed: 1.0612s/iter; left time: 41968.3091s
	iters: 200, epoch: 5 | loss: 0.0165340
	speed: 0.5789s/iter; left time: 22838.7841s
	iters: 300, epoch: 5 | loss: 0.2270623
	speed: 0.5823s/iter; left time: 22914.1948s
	iters: 400, epoch: 5 | loss: 0.0256467
	speed: 0.5531s/iter; left time: 21709.4964s
Epoch: 5 cost time: 229.30661177635193
Epoch: 5, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0035063
	speed: 1.1943s/iter; left time: 46739.9923s
	iters: 200, epoch: 6 | loss: 0.0029911
	speed: 0.5630s/iter; left time: 21975.4086s
	iters: 300, epoch: 6 | loss: 0.0053900
	speed: 0.5903s/iter; left time: 22983.6006s
	iters: 400, epoch: 6 | loss: 0.0003829
	speed: 0.5666s/iter; left time: 22006.2009s
Epoch: 6 cost time: 240.21545505523682
Epoch: 6, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.059 Vali Acc: 0.980 Test Loss: 0.059 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0001468
	speed: 1.1056s/iter; left time: 42812.3613s
	iters: 200, epoch: 7 | loss: 0.0008073
	speed: 0.5514s/iter; left time: 21298.5579s
	iters: 300, epoch: 7 | loss: 0.0319849
	speed: 0.5139s/iter; left time: 19796.2977s
	iters: 400, epoch: 7 | loss: 0.0080114
	speed: 0.5451s/iter; left time: 20944.4586s
Epoch: 7 cost time: 224.44701743125916
Epoch: 7, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.059 Vali Acc: 0.985 Test Loss: 0.059 Test Acc: 0.985
Validation loss decreased (-0.982719 --> -0.984993).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0005204
	speed: 1.1728s/iter; left time: 44931.0710s
	iters: 200, epoch: 8 | loss: 0.0004848
	speed: 0.5706s/iter; left time: 21804.5038s
	iters: 300, epoch: 8 | loss: 0.0122380
	speed: 0.5598s/iter; left time: 21335.8674s
	iters: 400, epoch: 8 | loss: 0.0008151
	speed: 0.5304s/iter; left time: 20160.7627s
Epoch: 8 cost time: 232.43785405158997
Epoch: 8, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.061 Vali Acc: 0.984 Test Loss: 0.061 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0058545
	speed: 1.1380s/iter; left time: 43126.5566s
	iters: 200, epoch: 9 | loss: 0.0004065
	speed: 0.5317s/iter; left time: 20096.5999s
	iters: 300, epoch: 9 | loss: 0.0059635
	speed: 0.5248s/iter; left time: 19782.8420s
	iters: 400, epoch: 9 | loss: 0.0031014
	speed: 0.5421s/iter; left time: 20382.7585s
Epoch: 9 cost time: 224.23013377189636
Epoch: 9, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.107 Vali Acc: 0.972 Test Loss: 0.107 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0011724
	speed: 1.1024s/iter; left time: 41321.1028s
	iters: 200, epoch: 10 | loss: 0.0001950
	speed: 0.6271s/iter; left time: 23444.1577s
	iters: 300, epoch: 10 | loss: 0.0016945
	speed: 0.6225s/iter; left time: 23209.5236s
	iters: 400, epoch: 10 | loss: 0.0045794
	speed: 0.5179s/iter; left time: 19258.1986s
Epoch: 10 cost time: 238.7429986000061
Epoch: 10, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.130 Vali Acc: 0.974 Test Loss: 0.130 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0707568
	speed: 1.1267s/iter; left time: 41768.9560s
	iters: 200, epoch: 11 | loss: 0.0000085
	speed: 0.5238s/iter; left time: 19367.0789s
	iters: 300, epoch: 11 | loss: 0.0407225
	speed: 0.5323s/iter; left time: 19626.8722s
	iters: 400, epoch: 11 | loss: 0.0007484
	speed: 0.5407s/iter; left time: 19882.6860s
Epoch: 11 cost time: 222.22715663909912
Epoch: 11, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0280372
	speed: 1.0469s/iter; left time: 38375.7643s
	iters: 200, epoch: 12 | loss: 0.0000779
	speed: 0.5585s/iter; left time: 20418.9384s
	iters: 300, epoch: 12 | loss: 0.0000321
	speed: 0.5237s/iter; left time: 19092.7170s
	iters: 400, epoch: 12 | loss: 0.0028142
	speed: 0.5268s/iter; left time: 19151.7727s
Epoch: 12 cost time: 221.97987842559814
Epoch: 12, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.072 Vali Acc: 0.985 Test Loss: 0.072 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000423
	speed: 1.0758s/iter; left time: 38993.0382s
	iters: 200, epoch: 13 | loss: 0.0000030
	speed: 0.5709s/iter; left time: 20636.4259s
	iters: 300, epoch: 13 | loss: 0.0002904
	speed: 0.5243s/iter; left time: 18898.7230s
	iters: 400, epoch: 13 | loss: 0.0000003
	speed: 0.4850s/iter; left time: 17432.3051s
Epoch: 13 cost time: 214.99060535430908
Epoch: 13, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.053 Vali Acc: 0.986 Test Loss: 0.053 Test Acc: 0.986
Validation loss decreased (-0.984993 --> -0.985902).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0024718
	speed: 1.0271s/iter; left time: 36803.3554s
	iters: 200, epoch: 14 | loss: 0.0000584
	speed: 0.5083s/iter; left time: 18163.8487s
	iters: 300, epoch: 14 | loss: 0.0000008
	speed: 0.5243s/iter; left time: 18680.1273s
	iters: 400, epoch: 14 | loss: 0.0000728
	speed: 0.5033s/iter; left time: 17884.4348s
Epoch: 14 cost time: 213.95009851455688
Epoch: 14, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000706
	speed: 1.0212s/iter; left time: 36169.1639s
	iters: 200, epoch: 15 | loss: 0.0053449
	speed: 0.5437s/iter; left time: 19201.5022s
	iters: 300, epoch: 15 | loss: 0.0005384
	speed: 0.5664s/iter; left time: 19949.1699s
	iters: 400, epoch: 15 | loss: 0.0000828
	speed: 0.5706s/iter; left time: 20038.2205s
Epoch: 15 cost time: 225.79988193511963
Epoch: 15, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.063 Vali Acc: 0.985 Test Loss: 0.063 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000179
	speed: 1.1142s/iter; left time: 39001.9870s
	iters: 200, epoch: 16 | loss: 0.0000197
	speed: 0.5075s/iter; left time: 17715.1368s
	iters: 300, epoch: 16 | loss: 0.0006892
	speed: 0.5636s/iter; left time: 19615.1052s
	iters: 400, epoch: 16 | loss: 0.0000024
	speed: 0.5633s/iter; left time: 19548.7537s
Epoch: 16 cost time: 225.86783123016357
Epoch: 16, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.074 Vali Acc: 0.985 Test Loss: 0.074 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0000113
	speed: 1.0477s/iter; left time: 36243.9218s
	iters: 200, epoch: 17 | loss: 0.0000096
	speed: 0.5289s/iter; left time: 18243.7507s
	iters: 300, epoch: 17 | loss: 0.0002153
	speed: 0.5184s/iter; left time: 17828.3500s
	iters: 400, epoch: 17 | loss: 0.0001377
	speed: 0.5196s/iter; left time: 17817.9119s
Epoch: 17 cost time: 216.8611035346985
Epoch: 17, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.087 Vali Acc: 0.982 Test Loss: 0.087 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0034340
	speed: 1.0927s/iter; left time: 37348.1481s
	iters: 200, epoch: 18 | loss: 0.0002968
	speed: 0.4933s/iter; left time: 16813.0955s
	iters: 300, epoch: 18 | loss: 0.0001465
	speed: 0.4825s/iter; left time: 16396.0010s
	iters: 400, epoch: 18 | loss: 0.0415442
	speed: 0.5002s/iter; left time: 16947.6132s
Epoch: 18 cost time: 209.16591334342957
Epoch: 18, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.147 Vali Acc: 0.976 Test Loss: 0.147 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0000079
	speed: 1.0603s/iter; left time: 35803.8201s
	iters: 200, epoch: 19 | loss: 0.0802287
	speed: 0.5327s/iter; left time: 17933.1153s
	iters: 300, epoch: 19 | loss: 0.0000255
	speed: 0.5084s/iter; left time: 17065.1523s
	iters: 400, epoch: 19 | loss: 0.0010965
	speed: 0.5564s/iter; left time: 18620.7122s
Epoch: 19 cost time: 220.1639289855957
Epoch: 19, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0001247
	speed: 1.0798s/iter; left time: 36016.8104s
	iters: 200, epoch: 20 | loss: 0.0000923
	speed: 0.5537s/iter; left time: 18412.0846s
	iters: 300, epoch: 20 | loss: 0.0002851
	speed: 0.5600s/iter; left time: 18567.5856s
	iters: 400, epoch: 20 | loss: 0.4186568
	speed: 0.5290s/iter; left time: 17484.7725s
Epoch: 20 cost time: 222.6363115310669
Epoch: 20, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0000448
	speed: 1.0616s/iter; left time: 34968.7477s
	iters: 200, epoch: 21 | loss: 0.0011308
	speed: 0.5320s/iter; left time: 17471.1012s
	iters: 300, epoch: 21 | loss: 0.0000010
	speed: 0.4941s/iter; left time: 16177.0491s
	iters: 400, epoch: 21 | loss: 0.0000242
	speed: 0.5003s/iter; left time: 16329.6086s
Epoch: 21 cost time: 212.1133770942688
Epoch: 21, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.151 Vali Acc: 0.973 Test Loss: 0.151 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0000016
	speed: 1.0594s/iter; left time: 34458.5729s
	iters: 200, epoch: 22 | loss: 0.0000028
	speed: 0.4998s/iter; left time: 16206.5591s
	iters: 300, epoch: 22 | loss: 0.0000728
	speed: 0.5294s/iter; left time: 17115.4272s
	iters: 400, epoch: 22 | loss: 0.0008788
	speed: 0.5584s/iter; left time: 17995.0590s
Epoch: 22 cost time: 219.25359916687012
Epoch: 22, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.083 Vali Acc: 0.982 Test Loss: 0.083 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0880990
	speed: 1.0869s/iter; left time: 34906.4144s
	iters: 200, epoch: 23 | loss: 0.0508721
	speed: 0.4891s/iter; left time: 15658.3377s
	iters: 300, epoch: 23 | loss: 0.0000177
	speed: 0.4528s/iter; left time: 14451.0795s
	iters: 400, epoch: 23 | loss: 0.0000006
	speed: 0.5255s/iter; left time: 16718.1375s
Epoch: 23 cost time: 207.04659295082092
Epoch: 23, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.058 Vali Acc: 0.990 Test Loss: 0.058 Test Acc: 0.990
Validation loss decreased (-0.985902 --> -0.989995).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0016065
	speed: 1.0858s/iter; left time: 34420.9644s
	iters: 200, epoch: 24 | loss: 0.0152815
	speed: 0.4881s/iter; left time: 15425.2627s
	iters: 300, epoch: 24 | loss: 0.0000385
	speed: 0.4758s/iter; left time: 14988.5697s
	iters: 400, epoch: 24 | loss: 0.0000160
	speed: 0.4807s/iter; left time: 15094.8285s
Epoch: 24 cost time: 207.15742921829224
Epoch: 24, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.984 Test Loss: 0.105 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0000071
	speed: 1.1094s/iter; left time: 34711.7123s
	iters: 200, epoch: 25 | loss: 0.0001617
	speed: 0.4846s/iter; left time: 15115.3799s
	iters: 300, epoch: 25 | loss: 0.0001165
	speed: 0.4863s/iter; left time: 15118.6673s
	iters: 400, epoch: 25 | loss: 0.0023544
	speed: 0.4650s/iter; left time: 14411.3659s
Epoch: 25 cost time: 206.08538818359375
Epoch: 25, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.061 Vali Acc: 0.987 Test Loss: 0.061 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0000014
	speed: 1.0800s/iter; left time: 33344.6296s
	iters: 200, epoch: 26 | loss: 0.0004098
	speed: 0.5565s/iter; left time: 17125.5556s
	iters: 300, epoch: 26 | loss: 0.0000322
	speed: 0.4811s/iter; left time: 14758.5928s
	iters: 400, epoch: 26 | loss: 0.0000050
	speed: 0.4995s/iter; left time: 15271.5831s
Epoch: 26 cost time: 215.2624707221985
Epoch: 26, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.082 Vali Acc: 0.988 Test Loss: 0.082 Test Acc: 0.988
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0078563
	speed: 1.0593s/iter; left time: 32269.9718s
	iters: 200, epoch: 27 | loss: 0.0088885
	speed: 0.5256s/iter; left time: 15957.5259s
	iters: 300, epoch: 27 | loss: 0.0005284
	speed: 0.5148s/iter; left time: 15580.1771s
	iters: 400, epoch: 27 | loss: 0.0000001
	speed: 0.4645s/iter; left time: 14010.5660s
Epoch: 27 cost time: 208.76691603660583
Epoch: 27, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.149 Vali Acc: 0.982 Test Loss: 0.149 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0002338
	speed: 0.9720s/iter; left time: 29207.3656s
	iters: 200, epoch: 28 | loss: 0.0000568
	speed: 0.5439s/iter; left time: 16289.5400s
	iters: 300, epoch: 28 | loss: 0.0000934
	speed: 0.5023s/iter; left time: 14992.4279s
	iters: 400, epoch: 28 | loss: 0.0004412
	speed: 0.5672s/iter; left time: 16875.2889s
Epoch: 28 cost time: 218.6696720123291
Epoch: 28, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.082 Vali Acc: 0.985 Test Loss: 0.082 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0000037
	speed: 0.9888s/iter; left time: 29305.8647s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.5246s/iter; left time: 15496.1327s
	iters: 300, epoch: 29 | loss: 0.0000024
	speed: 0.5463s/iter; left time: 16081.9276s
	iters: 400, epoch: 29 | loss: 0.0000057
	speed: 0.5930s/iter; left time: 17397.3504s
Epoch: 29 cost time: 222.16674327850342
Epoch: 29, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.202 Vali Acc: 0.980 Test Loss: 0.202 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0000609
	speed: 1.0448s/iter; left time: 30532.3705s
	iters: 200, epoch: 30 | loss: 0.0000011
	speed: 0.5133s/iter; left time: 14949.4388s
	iters: 300, epoch: 30 | loss: 0.0000452
	speed: 0.4986s/iter; left time: 14472.7434s
	iters: 400, epoch: 30 | loss: 0.0012924
	speed: 0.5137s/iter; left time: 14858.0263s
Epoch: 30 cost time: 210.6636142730713
Epoch: 30, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.071 Vali Acc: 0.985 Test Loss: 0.071 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0000001
	speed: 1.0172s/iter; left time: 29307.4860s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.4960s/iter; left time: 14239.3539s
	iters: 300, epoch: 31 | loss: 0.0072868
	speed: 0.5011s/iter; left time: 14337.9161s
	iters: 400, epoch: 31 | loss: 0.0003509
	speed: 0.5374s/iter; left time: 15322.5387s
Epoch: 31 cost time: 208.78502655029297
Epoch: 31, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.113 Vali Acc: 0.982 Test Loss: 0.113 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 1.1275s/iter; left time: 32019.5057s
	iters: 200, epoch: 32 | loss: 0.0000316
	speed: 0.4541s/iter; left time: 12849.3928s
	iters: 300, epoch: 32 | loss: 0.0000009
	speed: 0.4673s/iter; left time: 13177.5389s
	iters: 400, epoch: 32 | loss: 0.0000008
	speed: 0.5027s/iter; left time: 14125.1703s
Epoch: 32 cost time: 203.62778449058533
Epoch: 32, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.129 Vali Acc: 0.984 Test Loss: 0.129 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0000007
	speed: 1.0758s/iter; left time: 30105.8456s
	iters: 200, epoch: 33 | loss: 0.0000002
	speed: 0.5081s/iter; left time: 14168.9002s
	iters: 300, epoch: 33 | loss: 0.0000014
	speed: 0.4532s/iter; left time: 12591.2906s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.5086s/iter; left time: 14079.5056s
Epoch: 33 cost time: 210.1102306842804
Epoch: 33, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.093 Vali Acc: 0.988 Test Loss: 0.093 Test Acc: 0.988
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9899954524783993
model parameter : 997002
model size : 6.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         38                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.6136512
	speed: 0.5439s/iter; left time: 22409.1819s
	iters: 200, epoch: 1 | loss: 0.9659477
	speed: 0.4963s/iter; left time: 20397.3308s
	iters: 300, epoch: 1 | loss: 0.1758367
	speed: 0.4522s/iter; left time: 18541.1058s
	iters: 400, epoch: 1 | loss: 0.0534332
	speed: 0.4483s/iter; left time: 18337.7308s
Epoch: 1 cost time: 199.73898553848267
Epoch: 1, Steps: 413 | Train Loss: 0.611 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
Validation loss decreased (inf --> -0.973623).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0104942
	speed: 0.9030s/iter; left time: 36830.2828s
	iters: 200, epoch: 2 | loss: 0.0270523
	speed: 0.4680s/iter; left time: 19043.0810s
	iters: 300, epoch: 2 | loss: 0.0195639
	speed: 0.4829s/iter; left time: 19598.2843s
	iters: 400, epoch: 2 | loss: 0.0131852
	speed: 0.4391s/iter; left time: 17777.8365s
Epoch: 2 cost time: 190.1699094772339
Epoch: 2, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
Validation loss decreased (-0.973623 --> -0.976807).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0040781
	speed: 0.9644s/iter; left time: 38936.0986s
	iters: 200, epoch: 3 | loss: 0.0073241
	speed: 0.4758s/iter; left time: 19163.9282s
	iters: 300, epoch: 3 | loss: 0.1133019
	speed: 0.5071s/iter; left time: 20371.6502s
	iters: 400, epoch: 3 | loss: 0.0039088
	speed: 0.4887s/iter; left time: 19585.9502s
Epoch: 3 cost time: 200.8203067779541
Epoch: 3, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.052 Vali Acc: 0.983 Test Loss: 0.052 Test Acc: 0.983
Validation loss decreased (-0.976807 --> -0.982719).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0045906
	speed: 0.9744s/iter; left time: 38939.1569s
	iters: 200, epoch: 4 | loss: 0.0534301
	speed: 0.4549s/iter; left time: 18134.3844s
	iters: 300, epoch: 4 | loss: 0.0143271
	speed: 0.4345s/iter; left time: 17276.0763s
	iters: 400, epoch: 4 | loss: 0.0160189
	speed: 0.4700s/iter; left time: 18642.0433s
Epoch: 4 cost time: 191.83745503425598
Epoch: 4, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.095 Vali Acc: 0.966 Test Loss: 0.095 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0203612
	speed: 1.0285s/iter; left time: 40678.0587s
	iters: 200, epoch: 5 | loss: 0.0003851
	speed: 0.4852s/iter; left time: 19140.7809s
	iters: 300, epoch: 5 | loss: 0.0122195
	speed: 0.4324s/iter; left time: 17015.2502s
	iters: 400, epoch: 5 | loss: 0.0038619
	speed: 0.4603s/iter; left time: 18067.5842s
Epoch: 5 cost time: 199.37988471984863
Epoch: 5, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.041 Vali Acc: 0.984 Test Loss: 0.041 Test Acc: 0.984
Validation loss decreased (-0.982719 --> -0.983629).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0021518
	speed: 1.1446s/iter; left time: 44796.0647s
	iters: 200, epoch: 6 | loss: 0.0032535
	speed: 0.5121s/iter; left time: 19990.4146s
	iters: 300, epoch: 6 | loss: 0.0424407
	speed: 0.5227s/iter; left time: 20351.8400s
	iters: 400, epoch: 6 | loss: 0.0071343
	speed: 0.5437s/iter; left time: 21116.5169s
Epoch: 6 cost time: 221.76426124572754
Epoch: 6, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.048 Vali Acc: 0.985 Test Loss: 0.048 Test Acc: 0.985
Validation loss decreased (-0.983629 --> -0.984993).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0078971
	speed: 1.0597s/iter; left time: 41035.6653s
	iters: 200, epoch: 7 | loss: 0.0001163
	speed: 0.4744s/iter; left time: 18322.3088s
	iters: 300, epoch: 7 | loss: 0.0001524
	speed: 0.5168s/iter; left time: 19909.0655s
	iters: 400, epoch: 7 | loss: 0.0007887
	speed: 0.5637s/iter; left time: 21659.1221s
Epoch: 7 cost time: 214.10403180122375
Epoch: 7, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0294210
	speed: 1.0877s/iter; left time: 41670.4224s
	iters: 200, epoch: 8 | loss: 0.0022831
	speed: 0.4756s/iter; left time: 18171.0418s
	iters: 300, epoch: 8 | loss: 0.0020147
	speed: 0.5540s/iter; left time: 21113.6387s
	iters: 400, epoch: 8 | loss: 0.0282401
	speed: 0.5138s/iter; left time: 19530.3285s
Epoch: 8 cost time: 211.37046885490417
Epoch: 8, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.056 Vali Acc: 0.985 Test Loss: 0.056 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.1170949
	speed: 1.0536s/iter; left time: 39926.4502s
	iters: 200, epoch: 9 | loss: 0.0000685
	speed: 0.4699s/iter; left time: 17762.4080s
	iters: 300, epoch: 9 | loss: 0.2227242
	speed: 0.5183s/iter; left time: 19537.0170s
	iters: 400, epoch: 9 | loss: 0.0004572
	speed: 0.4966s/iter; left time: 18671.0772s
Epoch: 9 cost time: 202.6480028629303
Epoch: 9, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.081 Vali Acc: 0.979 Test Loss: 0.081 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0007204
	speed: 0.9800s/iter; left time: 36735.8963s
	iters: 200, epoch: 10 | loss: 0.0000789
	speed: 0.4521s/iter; left time: 16901.3783s
	iters: 300, epoch: 10 | loss: 0.0000017
	speed: 0.5078s/iter; left time: 18934.3493s
	iters: 400, epoch: 10 | loss: 0.0002371
	speed: 0.5159s/iter; left time: 19181.4328s
Epoch: 10 cost time: 203.29257321357727
Epoch: 10, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.060 Vali Acc: 0.984 Test Loss: 0.060 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000166
	speed: 0.8938s/iter; left time: 33133.1775s
	iters: 200, epoch: 11 | loss: 0.0000105
	speed: 0.3945s/iter; left time: 14586.8223s
	iters: 300, epoch: 11 | loss: 0.0006517
	speed: 0.4225s/iter; left time: 15576.6928s
	iters: 400, epoch: 11 | loss: 0.0002486
	speed: 0.4271s/iter; left time: 15706.5070s
Epoch: 11 cost time: 172.81949520111084
Epoch: 11, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.048 Vali Acc: 0.989 Test Loss: 0.048 Test Acc: 0.989
Validation loss decreased (-0.984993 --> -0.989085).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0212327
	speed: 0.9092s/iter; left time: 33329.3134s
	iters: 200, epoch: 12 | loss: 0.0050088
	speed: 0.4646s/iter; left time: 16983.3877s
	iters: 300, epoch: 12 | loss: 0.0030354
	speed: 0.4350s/iter; left time: 15858.5929s
	iters: 400, epoch: 12 | loss: 0.0971746
	speed: 0.4030s/iter; left time: 14653.1223s
Epoch: 12 cost time: 181.83287572860718
Epoch: 12, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.043 Vali Acc: 0.990 Test Loss: 0.043 Test Acc: 0.990
Validation loss decreased (-0.989085 --> -0.989540).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0061870
	speed: 0.8215s/iter; left time: 29773.5447s
	iters: 200, epoch: 13 | loss: 0.0021472
	speed: 0.4155s/iter; left time: 15018.9604s
	iters: 300, epoch: 13 | loss: 0.0001417
	speed: 0.4116s/iter; left time: 14837.1796s
	iters: 400, epoch: 13 | loss: 0.0036948
	speed: 0.4236s/iter; left time: 15227.1027s
Epoch: 13 cost time: 173.89975547790527
Epoch: 13, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.083 Vali Acc: 0.979 Test Loss: 0.083 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0001492
	speed: 0.6574s/iter; left time: 23556.7452s
	iters: 200, epoch: 14 | loss: 0.0004066
	speed: 0.2777s/iter; left time: 9923.2484s
	iters: 300, epoch: 14 | loss: 0.0000004
	speed: 0.2441s/iter; left time: 8697.2452s
	iters: 400, epoch: 14 | loss: 0.0781006
	speed: 0.2293s/iter; left time: 8145.9534s
Epoch: 14 cost time: 105.01821398735046
Epoch: 14, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0025901
	speed: 0.4447s/iter; left time: 15752.0646s
	iters: 200, epoch: 15 | loss: 0.0977922
	speed: 0.2216s/iter; left time: 7825.0560s
	iters: 300, epoch: 15 | loss: 0.0001140
	speed: 0.2464s/iter; left time: 8677.0786s
	iters: 400, epoch: 15 | loss: 0.0001760
	speed: 0.2511s/iter; left time: 8819.5666s
Epoch: 15 cost time: 98.0880537033081
Epoch: 15, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.055 Vali Acc: 0.989 Test Loss: 0.055 Test Acc: 0.989
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0002245
	speed: 0.5118s/iter; left time: 17914.8502s
	iters: 200, epoch: 16 | loss: 0.0018225
	speed: 0.2724s/iter; left time: 9509.3905s
	iters: 300, epoch: 16 | loss: 0.1880965
	speed: 0.2402s/iter; left time: 8359.7987s
	iters: 400, epoch: 16 | loss: 0.0000620
	speed: 0.2269s/iter; left time: 7876.2845s
Epoch: 16 cost time: 104.15239977836609
Epoch: 16, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.094 Vali Acc: 0.982 Test Loss: 0.094 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.2425779
	speed: 0.4213s/iter; left time: 14572.9129s
	iters: 200, epoch: 17 | loss: 0.0000069
	speed: 0.2219s/iter; left time: 7655.0850s
	iters: 300, epoch: 17 | loss: 0.0000832
	speed: 0.2285s/iter; left time: 7860.1473s
	iters: 400, epoch: 17 | loss: 0.0005371
	speed: 0.2327s/iter; left time: 7979.7980s
Epoch: 17 cost time: 93.46786141395569
Epoch: 17, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.102 Vali Acc: 0.979 Test Loss: 0.102 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0011370
	speed: 0.4719s/iter; left time: 16128.8165s
	iters: 200, epoch: 18 | loss: 0.0000030
	speed: 0.2559s/iter; left time: 8719.4103s
	iters: 300, epoch: 18 | loss: 0.0020095
	speed: 0.2568s/iter; left time: 8725.0360s
	iters: 400, epoch: 18 | loss: 0.0000455
	speed: 0.2511s/iter; left time: 8508.6983s
Epoch: 18 cost time: 104.31728720664978
Epoch: 18, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000003
	speed: 0.4487s/iter; left time: 15151.1301s
	iters: 200, epoch: 19 | loss: 0.0000050
	speed: 0.2181s/iter; left time: 7342.6841s
	iters: 300, epoch: 19 | loss: 0.0026974
	speed: 0.2272s/iter; left time: 7626.6701s
	iters: 400, epoch: 19 | loss: 0.0001137
	speed: 0.2343s/iter; left time: 7839.6534s
Epoch: 19 cost time: 94.15811681747437
Epoch: 19, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.985 Test Loss: 0.066 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0005215
	speed: 0.4417s/iter; left time: 14730.9748s
	iters: 200, epoch: 20 | loss: 0.0000173
	speed: 0.2397s/iter; left time: 7970.8560s
	iters: 300, epoch: 20 | loss: 0.0000200
	speed: 0.2632s/iter; left time: 8725.9592s
	iters: 400, epoch: 20 | loss: 0.0000012
	speed: 0.2580s/iter; left time: 8527.1892s
Epoch: 20 cost time: 102.32137894630432
Epoch: 20, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.066 Vali Acc: 0.988 Test Loss: 0.066 Test Acc: 0.988
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000005
	speed: 0.4836s/iter; left time: 15929.8497s
	iters: 200, epoch: 21 | loss: 0.0000068
	speed: 0.2219s/iter; left time: 7288.4122s
	iters: 300, epoch: 21 | loss: 0.0000001
	speed: 0.2294s/iter; left time: 7510.0254s
	iters: 400, epoch: 21 | loss: 0.0004650
	speed: 0.2325s/iter; left time: 7587.7245s
Epoch: 21 cost time: 96.93330836296082
Epoch: 21, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.068 Vali Acc: 0.986 Test Loss: 0.068 Test Acc: 0.986
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000106
	speed: 0.4461s/iter; left time: 14510.6197s
	iters: 200, epoch: 22 | loss: 0.0000001
	speed: 0.2305s/iter; left time: 7475.7722s
	iters: 300, epoch: 22 | loss: 0.0000263
	speed: 0.2254s/iter; left time: 7286.6985s
	iters: 400, epoch: 22 | loss: 0.0053586
	speed: 0.2492s/iter; left time: 8032.3179s
Epoch: 22 cost time: 96.96516513824463
Epoch: 22, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9895407003183265
model parameter : 997002
model size : 6.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         28                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.9506083
	speed: 0.2715s/iter; left time: 11186.8574s
	iters: 200, epoch: 1 | loss: 1.2456471
	speed: 0.2409s/iter; left time: 9900.2336s
	iters: 300, epoch: 1 | loss: 0.2788543
	speed: 0.2384s/iter; left time: 9774.5446s
	iters: 400, epoch: 1 | loss: 0.1199978
	speed: 0.2060s/iter; left time: 8426.8070s
Epoch: 1 cost time: 98.47850012779236
Epoch: 1, Steps: 413 | Train Loss: 0.680 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
Validation loss decreased (inf --> -0.974533).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0107044
	speed: 0.4412s/iter; left time: 17993.8266s
	iters: 200, epoch: 2 | loss: 0.0379773
	speed: 0.2324s/iter; left time: 9455.1220s
	iters: 300, epoch: 2 | loss: 0.0611344
	speed: 0.2338s/iter; left time: 9487.4578s
	iters: 400, epoch: 2 | loss: 0.0148583
	speed: 0.2301s/iter; left time: 9315.6382s
Epoch: 2 cost time: 96.35695099830627
Epoch: 2, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.086 Vali Acc: 0.968 Test Loss: 0.086 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0053090
	speed: 0.5155s/iter; left time: 20813.0569s
	iters: 200, epoch: 3 | loss: 0.0258347
	speed: 0.2651s/iter; left time: 10675.3658s
	iters: 300, epoch: 3 | loss: 0.1943661
	speed: 0.2562s/iter; left time: 10292.4682s
	iters: 400, epoch: 3 | loss: 0.0062197
	speed: 0.2633s/iter; left time: 10552.3592s
Epoch: 3 cost time: 109.1905426979065
Epoch: 3, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
Validation loss decreased (-0.974533 --> -0.978171).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0339410
	speed: 0.4488s/iter; left time: 17936.2486s
	iters: 200, epoch: 4 | loss: 0.0159631
	speed: 0.2284s/iter; left time: 9104.9840s
	iters: 300, epoch: 4 | loss: 0.1202726
	speed: 0.2363s/iter; left time: 9393.9126s
	iters: 400, epoch: 4 | loss: 0.0028316
	speed: 0.2526s/iter; left time: 10016.8658s
Epoch: 4 cost time: 97.90505027770996
Epoch: 4, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0011832
	speed: 0.4646s/iter; left time: 18373.2804s
	iters: 200, epoch: 5 | loss: 0.0270642
	speed: 0.2759s/iter; left time: 10882.8437s
	iters: 300, epoch: 5 | loss: 0.0012961
	speed: 0.2598s/iter; left time: 10222.0724s
	iters: 400, epoch: 5 | loss: 0.0501778
	speed: 0.2554s/iter; left time: 10025.9547s
Epoch: 5 cost time: 106.83786511421204
Epoch: 5, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0012166
	speed: 0.4754s/iter; left time: 18605.8119s
	iters: 200, epoch: 6 | loss: 0.0108936
	speed: 0.2327s/iter; left time: 9083.8479s
	iters: 300, epoch: 6 | loss: 0.0055526
	speed: 0.2188s/iter; left time: 8517.9499s
	iters: 400, epoch: 6 | loss: 0.0020672
	speed: 0.2340s/iter; left time: 9089.3115s
Epoch: 6 cost time: 96.75812101364136
Epoch: 6, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.107 Vali Acc: 0.969 Test Loss: 0.107 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0075266
	speed: 0.4414s/iter; left time: 17093.8634s
	iters: 200, epoch: 7 | loss: 0.0022214
	speed: 0.2542s/iter; left time: 9816.0606s
	iters: 300, epoch: 7 | loss: 0.0032284
	speed: 0.2534s/iter; left time: 9759.8028s
	iters: 400, epoch: 7 | loss: 0.0957047
	speed: 0.2571s/iter; left time: 9880.0756s
Epoch: 7 cost time: 103.83618187904358
Epoch: 7, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0135278
	speed: 0.4834s/iter; left time: 18520.5248s
	iters: 200, epoch: 8 | loss: 0.0021182
	speed: 0.2496s/iter; left time: 9537.6209s
	iters: 300, epoch: 8 | loss: 0.0676831
	speed: 0.2434s/iter; left time: 9274.1864s
	iters: 400, epoch: 8 | loss: 0.0517844
	speed: 0.2260s/iter; left time: 8590.1266s
Epoch: 8 cost time: 99.8094494342804
Epoch: 8, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
Validation loss decreased (-0.978171 --> -0.981354).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0003413
	speed: 0.4377s/iter; left time: 16586.3587s
	iters: 200, epoch: 9 | loss: 0.0003971
	speed: 0.2289s/iter; left time: 8652.8077s
	iters: 300, epoch: 9 | loss: 0.0122672
	speed: 0.2301s/iter; left time: 8673.9441s
	iters: 400, epoch: 9 | loss: 0.0579924
	speed: 0.2356s/iter; left time: 8858.7775s
Epoch: 9 cost time: 95.31812834739685
Epoch: 9, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.102 Vali Acc: 0.972 Test Loss: 0.102 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0085283
	speed: 0.4807s/iter; left time: 18020.0710s
	iters: 200, epoch: 10 | loss: 0.1575803
	speed: 0.2610s/iter; left time: 9758.0924s
	iters: 300, epoch: 10 | loss: 0.0001204
	speed: 0.2413s/iter; left time: 8996.9259s
	iters: 400, epoch: 10 | loss: 0.0371569
	speed: 0.2119s/iter; left time: 7879.1448s
Epoch: 10 cost time: 101.00062227249146
Epoch: 10, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.057 Vali Acc: 0.985 Test Loss: 0.057 Test Acc: 0.985
Validation loss decreased (-0.981354 --> -0.985447).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0006525
	speed: 0.4503s/iter; left time: 16691.5591s
	iters: 200, epoch: 11 | loss: 0.0000008
	speed: 0.2319s/iter; left time: 8574.0878s
	iters: 300, epoch: 11 | loss: 0.0093327
	speed: 0.2326s/iter; left time: 8577.9251s
	iters: 400, epoch: 11 | loss: 0.0006729
	speed: 0.2290s/iter; left time: 8421.7709s
Epoch: 11 cost time: 95.67823839187622
Epoch: 11, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0270087
	speed: 0.4595s/iter; left time: 16843.3230s
	iters: 200, epoch: 12 | loss: 0.0000678
	speed: 0.2653s/iter; left time: 9698.9422s
	iters: 300, epoch: 12 | loss: 0.0001966
	speed: 0.2690s/iter; left time: 9808.9150s
	iters: 400, epoch: 12 | loss: 0.0007228
	speed: 0.2611s/iter; left time: 9493.8370s
Epoch: 12 cost time: 107.41270852088928
Epoch: 12, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000140
	speed: 0.4798s/iter; left time: 17390.2529s
	iters: 200, epoch: 13 | loss: 0.0000148
	speed: 0.2257s/iter; left time: 8157.2885s
	iters: 300, epoch: 13 | loss: 0.0029739
	speed: 0.2261s/iter; left time: 8149.4025s
	iters: 400, epoch: 13 | loss: 0.0000038
	speed: 0.2141s/iter; left time: 7696.9168s
Epoch: 13 cost time: 94.31961226463318
Epoch: 13, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.085 Vali Acc: 0.982 Test Loss: 0.085 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0001266
	speed: 0.4245s/iter; left time: 15209.5242s
	iters: 200, epoch: 14 | loss: 0.0231916
	speed: 0.2296s/iter; left time: 8204.1228s
	iters: 300, epoch: 14 | loss: 0.0000041
	speed: 0.2497s/iter; left time: 8897.5360s
	iters: 400, epoch: 14 | loss: 0.0000296
	speed: 0.2779s/iter; left time: 9872.5773s
Epoch: 14 cost time: 100.39500689506531
Epoch: 14, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.2277384
	speed: 0.4951s/iter; left time: 17535.5646s
	iters: 200, epoch: 15 | loss: 0.0000412
	speed: 0.2516s/iter; left time: 8885.2997s
	iters: 300, epoch: 15 | loss: 0.0455881
	speed: 0.2346s/iter; left time: 8261.5536s
	iters: 400, epoch: 15 | loss: 0.0060195
	speed: 0.2196s/iter; left time: 7713.1771s
Epoch: 15 cost time: 98.0623095035553
Epoch: 15, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.073 Vali Acc: 0.982 Test Loss: 0.073 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0008335
	speed: 0.4485s/iter; left time: 15701.7948s
	iters: 200, epoch: 16 | loss: 0.0000329
	speed: 0.1984s/iter; left time: 6925.2833s
	iters: 300, epoch: 16 | loss: 0.2157051
	speed: 0.2111s/iter; left time: 7347.8236s
	iters: 400, epoch: 16 | loss: 0.0002445
	speed: 0.2443s/iter; left time: 8477.6643s
Epoch: 16 cost time: 91.97231578826904
Epoch: 16, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000773
	speed: 0.4835s/iter; left time: 16725.0675s
	iters: 200, epoch: 17 | loss: 0.0002544
	speed: 0.2426s/iter; left time: 8366.6057s
	iters: 300, epoch: 17 | loss: 0.0027713
	speed: 0.2543s/iter; left time: 8745.6549s
	iters: 400, epoch: 17 | loss: 0.0000033
	speed: 0.2425s/iter; left time: 8315.6968s
Epoch: 17 cost time: 102.86129641532898
Epoch: 17, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.046 Vali Acc: 0.990 Test Loss: 0.046 Test Acc: 0.990
Validation loss decreased (-0.985447 --> -0.989540).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000305
	speed: 0.4899s/iter; left time: 16745.5266s
	iters: 200, epoch: 18 | loss: 0.0000452
	speed: 0.2308s/iter; left time: 7864.9580s
	iters: 300, epoch: 18 | loss: 0.0014543
	speed: 0.2422s/iter; left time: 8230.4185s
	iters: 400, epoch: 18 | loss: 0.0000471
	speed: 0.2245s/iter; left time: 7606.0985s
Epoch: 18 cost time: 98.3828444480896
Epoch: 18, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.071 Vali Acc: 0.984 Test Loss: 0.071 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000018
	speed: 0.4865s/iter; left time: 16429.3121s
	iters: 200, epoch: 19 | loss: 0.0000206
	speed: 0.2633s/iter; left time: 8864.7645s
	iters: 300, epoch: 19 | loss: 0.0011962
	speed: 0.2600s/iter; left time: 8726.2268s
	iters: 400, epoch: 19 | loss: 0.0002579
	speed: 0.2535s/iter; left time: 8485.5168s
Epoch: 19 cost time: 106.53326201438904
Epoch: 19, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000002
	speed: 0.4954s/iter; left time: 16523.6127s
	iters: 200, epoch: 20 | loss: 0.0344316
	speed: 0.2554s/iter; left time: 8493.5602s
	iters: 300, epoch: 20 | loss: 0.0084872
	speed: 0.2299s/iter; left time: 7622.3097s
	iters: 400, epoch: 20 | loss: 0.0261969
	speed: 0.2467s/iter; left time: 8155.2384s
Epoch: 20 cost time: 102.49831628799438
Epoch: 20, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.058 Vali Acc: 0.984 Test Loss: 0.058 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000024
	speed: 0.5114s/iter; left time: 16844.4307s
	iters: 200, epoch: 21 | loss: 0.0000020
	speed: 0.2691s/iter; left time: 8836.7225s
	iters: 300, epoch: 21 | loss: 0.0001213
	speed: 0.2615s/iter; left time: 8563.0901s
	iters: 400, epoch: 21 | loss: 0.0000029
	speed: 0.2705s/iter; left time: 8828.2223s
Epoch: 21 cost time: 109.97064757347107
Epoch: 21, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.085 Vali Acc: 0.986 Test Loss: 0.085 Test Acc: 0.986
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0009578
	speed: 0.5422s/iter; left time: 17635.1632s
	iters: 200, epoch: 22 | loss: 0.0000001
	speed: 0.2615s/iter; left time: 8479.2287s
	iters: 300, epoch: 22 | loss: 0.0029645
	speed: 0.2573s/iter; left time: 8318.3862s
	iters: 400, epoch: 22 | loss: 0.0000392
	speed: 0.2575s/iter; left time: 8297.8997s
Epoch: 22 cost time: 108.03146576881409
Epoch: 22, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.101 Vali Acc: 0.981 Test Loss: 0.101 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0000472
	speed: 0.5391s/iter; left time: 17313.3883s
	iters: 200, epoch: 23 | loss: 0.0007206
	speed: 0.2703s/iter; left time: 8654.2324s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.2649s/iter; left time: 8453.6025s
	iters: 400, epoch: 23 | loss: 0.0000008
	speed: 0.2642s/iter; left time: 8405.0276s
Epoch: 23 cost time: 111.0302357673645
Epoch: 23, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.086 Vali Acc: 0.982 Test Loss: 0.086 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0000714
	speed: 0.5832s/iter; left time: 18487.2505s
	iters: 200, epoch: 24 | loss: 0.0014001
	speed: 0.2555s/iter; left time: 8075.2639s
	iters: 300, epoch: 24 | loss: 0.0000159
	speed: 0.2570s/iter; left time: 8094.7972s
	iters: 400, epoch: 24 | loss: 0.0000031
	speed: 0.2605s/iter; left time: 8178.7357s
Epoch: 24 cost time: 108.63604688644409
Epoch: 24, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.059 Vali Acc: 0.986 Test Loss: 0.059 Test Acc: 0.986
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0678527
	speed: 0.5714s/iter; left time: 17878.8914s
	iters: 200, epoch: 25 | loss: 0.0000059
	speed: 0.2571s/iter; left time: 8017.7808s
	iters: 300, epoch: 25 | loss: 0.0001259
	speed: 0.2581s/iter; left time: 8022.8010s
	iters: 400, epoch: 25 | loss: 0.0000035
	speed: 0.2369s/iter; left time: 7341.7622s
Epoch: 25 cost time: 106.20481824874878
Epoch: 25, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.148 Vali Acc: 0.974 Test Loss: 0.148 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0010269
	speed: 0.5389s/iter; left time: 16640.3814s
	iters: 200, epoch: 26 | loss: 0.0002017
	speed: 0.2682s/iter; left time: 8253.0803s
	iters: 300, epoch: 26 | loss: 0.0000226
	speed: 0.2625s/iter; left time: 8053.2550s
	iters: 400, epoch: 26 | loss: 0.0000173
	speed: 0.2781s/iter; left time: 8502.0792s
Epoch: 26 cost time: 112.27127861976624
Epoch: 26, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.145 Vali Acc: 0.975 Test Loss: 0.145 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0206408
	speed: 0.5622s/iter; left time: 17127.0837s
	iters: 200, epoch: 27 | loss: 0.0567595
	speed: 0.2708s/iter; left time: 8221.6197s
	iters: 300, epoch: 27 | loss: 0.0155138
	speed: 0.2604s/iter; left time: 7879.6982s
	iters: 400, epoch: 27 | loss: 0.0001882
	speed: 0.2601s/iter; left time: 7846.8768s
Epoch: 27 cost time: 109.62235856056213
Epoch: 27, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.095 Vali Acc: 0.985 Test Loss: 0.095 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9895407003183265
model parameter : 997002
model size : 6.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1910552
	speed: 0.2558s/iter; left time: 10540.2323s
	iters: 200, epoch: 1 | loss: 1.4128824
	speed: 0.2750s/iter; left time: 11302.8219s
	iters: 300, epoch: 1 | loss: 0.2698315
	speed: 0.2835s/iter; left time: 11623.3684s
	iters: 400, epoch: 1 | loss: 0.0693335
	speed: 0.2955s/iter; left time: 12085.7678s
Epoch: 1 cost time: 115.62157869338989
Epoch: 1, Steps: 413 | Train Loss: 0.782 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
Validation loss decreased (inf --> -0.964528).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0404355
	speed: 0.5826s/iter; left time: 23761.0729s
	iters: 200, epoch: 2 | loss: 0.1362748
	speed: 0.2426s/iter; left time: 9871.0857s
	iters: 300, epoch: 2 | loss: 0.0319443
	speed: 0.2522s/iter; left time: 10236.7399s
	iters: 400, epoch: 2 | loss: 0.0473278
	speed: 0.2464s/iter; left time: 9977.4757s
Epoch: 2 cost time: 105.09856796264648
Epoch: 2, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.072 Vali Acc: 0.976 Test Loss: 0.072 Test Acc: 0.976
Validation loss decreased (-0.964528 --> -0.976352).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0123965
	speed: 0.5537s/iter; left time: 22357.4060s
	iters: 200, epoch: 3 | loss: 0.0147562
	speed: 0.2798s/iter; left time: 11269.8247s
	iters: 300, epoch: 3 | loss: 0.2566936
	speed: 0.2666s/iter; left time: 10709.4278s
	iters: 400, epoch: 3 | loss: 0.0432690
	speed: 0.2614s/iter; left time: 10475.3887s
Epoch: 3 cost time: 112.6118049621582
Epoch: 3, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.064 Vali Acc: 0.978 Test Loss: 0.064 Test Acc: 0.978
Validation loss decreased (-0.976352 --> -0.978171).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0065529
	speed: 0.4985s/iter; left time: 19921.8193s
	iters: 200, epoch: 4 | loss: 0.0361873
	speed: 0.2603s/iter; left time: 10376.9787s
	iters: 300, epoch: 4 | loss: 0.0042653
	speed: 0.2554s/iter; left time: 10155.5282s
	iters: 400, epoch: 4 | loss: 0.0822272
	speed: 0.2617s/iter; left time: 10381.4678s
Epoch: 4 cost time: 107.45802068710327
Epoch: 4, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
Validation loss decreased (-0.978171 --> -0.979990).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0023587
	speed: 0.5543s/iter; left time: 21921.8497s
	iters: 200, epoch: 5 | loss: 0.0004629
	speed: 0.2568s/iter; left time: 10128.6207s
	iters: 300, epoch: 5 | loss: 0.0085654
	speed: 0.2504s/iter; left time: 9854.5939s
	iters: 400, epoch: 5 | loss: 0.0560468
	speed: 0.2714s/iter; left time: 10653.1259s
Epoch: 5 cost time: 108.44522285461426
Epoch: 5, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
Validation loss decreased (-0.979990 --> -0.980900).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0001299
	speed: 0.5371s/iter; left time: 21020.0967s
	iters: 200, epoch: 6 | loss: 0.0025247
	speed: 0.2520s/iter; left time: 9835.3421s
	iters: 300, epoch: 6 | loss: 0.1227499
	speed: 0.2598s/iter; left time: 10117.1190s
	iters: 400, epoch: 6 | loss: 0.0075447
	speed: 0.2537s/iter; left time: 9851.8214s
Epoch: 6 cost time: 106.08264446258545
Epoch: 6, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.101 Vali Acc: 0.972 Test Loss: 0.101 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0031686
	speed: 0.5436s/iter; left time: 21049.8344s
	iters: 200, epoch: 7 | loss: 0.0004148
	speed: 0.2885s/iter; left time: 11141.5392s
	iters: 300, epoch: 7 | loss: 0.0410501
	speed: 0.2562s/iter; left time: 9870.9246s
	iters: 400, epoch: 7 | loss: 0.1732842
	speed: 0.2600s/iter; left time: 9988.3379s
Epoch: 7 cost time: 112.88143253326416
Epoch: 7, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0005020
	speed: 0.5361s/iter; left time: 20539.2169s
	iters: 200, epoch: 8 | loss: 0.0007857
	speed: 0.2516s/iter; left time: 9613.3463s
	iters: 300, epoch: 8 | loss: 0.0906766
	speed: 0.2471s/iter; left time: 9415.7188s
	iters: 400, epoch: 8 | loss: 0.0024992
	speed: 0.2499s/iter; left time: 9499.6957s
Epoch: 8 cost time: 103.99265241622925
Epoch: 8, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0619478
	speed: 0.5118s/iter; left time: 19395.8633s
	iters: 200, epoch: 9 | loss: 0.0084441
	speed: 0.2834s/iter; left time: 10713.0967s
	iters: 300, epoch: 9 | loss: 0.0372886
	speed: 0.2736s/iter; left time: 10314.3882s
	iters: 400, epoch: 9 | loss: 0.0005084
	speed: 0.2549s/iter; left time: 9583.5181s
Epoch: 9 cost time: 111.04077744483948
Epoch: 9, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0097324
	speed: 0.5295s/iter; left time: 19847.7076s
	iters: 200, epoch: 10 | loss: 0.0000101
	speed: 0.2501s/iter; left time: 9349.9604s
	iters: 300, epoch: 10 | loss: 0.0001652
	speed: 0.2648s/iter; left time: 9871.3822s
	iters: 400, epoch: 10 | loss: 0.0035966
	speed: 0.2646s/iter; left time: 9839.1863s
Epoch: 10 cost time: 107.67063498497009
Epoch: 10, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000192
	speed: 0.5460s/iter; left time: 20241.7679s
	iters: 200, epoch: 11 | loss: 0.0000010
	speed: 0.2614s/iter; left time: 9663.7360s
	iters: 300, epoch: 11 | loss: 0.0005328
	speed: 0.2528s/iter; left time: 9322.1994s
	iters: 400, epoch: 11 | loss: 0.0002240
	speed: 0.2519s/iter; left time: 9263.5414s
Epoch: 11 cost time: 107.2572991847992
Epoch: 11, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.155 Vali Acc: 0.968 Test Loss: 0.155 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000023
	speed: 0.5243s/iter; left time: 19219.2483s
	iters: 200, epoch: 12 | loss: 0.0000002
	speed: 0.2606s/iter; left time: 9527.6911s
	iters: 300, epoch: 12 | loss: 0.0000742
	speed: 0.2452s/iter; left time: 8939.8032s
	iters: 400, epoch: 12 | loss: 0.0000367
	speed: 0.2431s/iter; left time: 8838.2894s
Epoch: 12 cost time: 103.95535397529602
Epoch: 12, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0000164
	speed: 0.5627s/iter; left time: 20394.7083s
	iters: 200, epoch: 13 | loss: 0.0001009
	speed: 0.2729s/iter; left time: 9862.8744s
	iters: 300, epoch: 13 | loss: 0.0550525
	speed: 0.2612s/iter; left time: 9415.2537s
	iters: 400, epoch: 13 | loss: 0.0017714
	speed: 0.2587s/iter; left time: 9297.4875s
Epoch: 13 cost time: 110.5407383441925
Epoch: 13, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.234 Vali Acc: 0.956 Test Loss: 0.234 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0007077
	speed: 0.4824s/iter; left time: 17285.2739s
	iters: 200, epoch: 14 | loss: 0.0053735
	speed: 0.2498s/iter; left time: 8924.4912s
	iters: 300, epoch: 14 | loss: 0.0000003
	speed: 0.2609s/iter; left time: 9296.1676s
	iters: 400, epoch: 14 | loss: 0.0000008
	speed: 0.2818s/iter; left time: 10013.8468s
Epoch: 14 cost time: 107.66214513778687
Epoch: 14, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0018673
	speed: 0.5693s/iter; left time: 20163.9901s
	iters: 200, epoch: 15 | loss: 0.0083318
	speed: 0.2601s/iter; left time: 9186.7287s
	iters: 300, epoch: 15 | loss: 0.0008474
	speed: 0.2517s/iter; left time: 8865.8224s
	iters: 400, epoch: 15 | loss: 0.0039197
	speed: 0.2566s/iter; left time: 9012.9305s
Epoch: 15 cost time: 107.8525800704956
Epoch: 15, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9809004092769441
model parameter : 997002
model size : 6.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.7503880
	speed: 0.2847s/iter; left time: 11730.1047s
	iters: 200, epoch: 1 | loss: 1.3888665
	speed: 0.2560s/iter; left time: 10522.3277s
	iters: 300, epoch: 1 | loss: 0.2731116
	speed: 0.2617s/iter; left time: 10731.8784s
	iters: 400, epoch: 1 | loss: 0.1235612
	speed: 0.2616s/iter; left time: 10699.6817s
Epoch: 1 cost time: 110.227614402771
Epoch: 1, Steps: 413 | Train Loss: 0.982 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
Validation loss decreased (inf --> -0.951340).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1184238
	speed: 0.5709s/iter; left time: 23285.4173s
	iters: 200, epoch: 2 | loss: 0.2863046
	speed: 0.2627s/iter; left time: 10687.8810s
	iters: 300, epoch: 2 | loss: 0.0300742
	speed: 0.2565s/iter; left time: 10410.4957s
	iters: 400, epoch: 2 | loss: 0.2005017
	speed: 0.2634s/iter; left time: 10665.2883s
Epoch: 2 cost time: 107.90299415588379
Epoch: 2, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.101 Vali Acc: 0.969 Test Loss: 0.101 Test Acc: 0.969
Validation loss decreased (-0.951340 --> -0.968621).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0071399
	speed: 0.5542s/iter; left time: 22374.8909s
	iters: 200, epoch: 3 | loss: 0.0141433
	speed: 0.2439s/iter; left time: 9821.1442s
	iters: 300, epoch: 3 | loss: 0.4548996
	speed: 0.2665s/iter; left time: 10705.5338s
	iters: 400, epoch: 3 | loss: 0.0318095
	speed: 0.2482s/iter; left time: 9948.0972s
Epoch: 3 cost time: 105.15996670722961
Epoch: 3, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.086 Vali Acc: 0.971 Test Loss: 0.086 Test Acc: 0.971
Validation loss decreased (-0.968621 --> -0.970895).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0028706
	speed: 0.5872s/iter; left time: 23464.5388s
	iters: 200, epoch: 4 | loss: 0.0228002
	speed: 0.2484s/iter; left time: 9902.9258s
	iters: 300, epoch: 4 | loss: 0.0009711
	speed: 0.2488s/iter; left time: 9893.2286s
	iters: 400, epoch: 4 | loss: 0.0046448
	speed: 0.2608s/iter; left time: 10343.6092s
Epoch: 4 cost time: 106.43610668182373
Epoch: 4, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.069 Vali Acc: 0.979 Test Loss: 0.069 Test Acc: 0.979
Validation loss decreased (-0.970895 --> -0.978626).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0027717
	speed: 0.5317s/iter; left time: 21027.9643s
	iters: 200, epoch: 5 | loss: 0.0008769
	speed: 0.2608s/iter; left time: 10287.1667s
	iters: 300, epoch: 5 | loss: 0.0339855
	speed: 0.2633s/iter; left time: 10358.8337s
	iters: 400, epoch: 5 | loss: 0.0328080
	speed: 0.2625s/iter; left time: 10303.7543s
Epoch: 5 cost time: 108.7519998550415
Epoch: 5, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.076 Vali Acc: 0.974 Test Loss: 0.076 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0016158
	speed: 0.5421s/iter; left time: 21214.2405s
	iters: 200, epoch: 6 | loss: 0.0000632
	speed: 0.2673s/iter; left time: 10435.3824s
	iters: 300, epoch: 6 | loss: 0.0013627
	speed: 0.2674s/iter; left time: 10411.2761s
	iters: 400, epoch: 6 | loss: 0.0025988
	speed: 0.2590s/iter; left time: 10056.6829s
Epoch: 6 cost time: 110.98193407058716
Epoch: 6, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0007896
	speed: 0.5531s/iter; left time: 21417.6886s
	iters: 200, epoch: 7 | loss: 0.0025357
	speed: 0.2726s/iter; left time: 10527.3231s
	iters: 300, epoch: 7 | loss: 0.0159427
	speed: 0.2703s/iter; left time: 10411.6662s
	iters: 400, epoch: 7 | loss: 0.0015567
	speed: 0.2578s/iter; left time: 9906.7689s
Epoch: 7 cost time: 110.02485370635986
Epoch: 7, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.105 Vali Acc: 0.972 Test Loss: 0.105 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0002851
	speed: 0.5503s/iter; left time: 21081.8442s
	iters: 200, epoch: 8 | loss: 0.0030249
	speed: 0.2627s/iter; left time: 10036.8350s
	iters: 300, epoch: 8 | loss: 0.1999831
	speed: 0.2720s/iter; left time: 10365.4847s
	iters: 400, epoch: 8 | loss: 0.0028709
	speed: 0.2620s/iter; left time: 9959.2917s
Epoch: 8 cost time: 109.38932037353516
Epoch: 8, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.058 Vali Acc: 0.981 Test Loss: 0.058 Test Acc: 0.981
Validation loss decreased (-0.978626 --> -0.980900).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0508562
	speed: 0.5089s/iter; left time: 19285.3963s
	iters: 200, epoch: 9 | loss: 0.0054734
	speed: 0.2565s/iter; left time: 9693.8461s
	iters: 300, epoch: 9 | loss: 0.0005728
	speed: 0.2593s/iter; left time: 9775.7126s
	iters: 400, epoch: 9 | loss: 0.0048917
	speed: 0.2520s/iter; left time: 9475.5207s
Epoch: 9 cost time: 105.84241199493408
Epoch: 9, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
Validation loss decreased (-0.980900 --> -0.981354).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0019219
	speed: 0.5514s/iter; left time: 20669.2226s
	iters: 200, epoch: 10 | loss: 0.0002613
	speed: 0.2731s/iter; left time: 10208.8507s
	iters: 300, epoch: 10 | loss: 0.0075455
	speed: 0.2770s/iter; left time: 10327.2805s
	iters: 400, epoch: 10 | loss: 0.0001872
	speed: 0.2654s/iter; left time: 9868.4061s
Epoch: 10 cost time: 113.59360313415527
Epoch: 10, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.092 Vali Acc: 0.979 Test Loss: 0.092 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0001040
	speed: 0.5634s/iter; left time: 20886.8323s
	iters: 200, epoch: 11 | loss: 0.0000016
	speed: 0.2850s/iter; left time: 10537.6021s
	iters: 300, epoch: 11 | loss: 0.0003015
	speed: 0.2528s/iter; left time: 9320.0659s
	iters: 400, epoch: 11 | loss: 0.0007449
	speed: 0.2455s/iter; left time: 9025.6832s
Epoch: 11 cost time: 110.61494040489197
Epoch: 11, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0047263
	speed: 0.5279s/iter; left time: 19350.4510s
	iters: 200, epoch: 12 | loss: 0.0253867
	speed: 0.2598s/iter; left time: 9498.7701s
	iters: 300, epoch: 12 | loss: 0.0001988
	speed: 0.2544s/iter; left time: 9275.7146s
	iters: 400, epoch: 12 | loss: 0.0032127
	speed: 0.2577s/iter; left time: 9368.8500s
Epoch: 12 cost time: 106.7428388595581
Epoch: 12, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.1838545
	speed: 0.5305s/iter; left time: 19227.4333s
	iters: 200, epoch: 13 | loss: 0.0000838
	speed: 0.2592s/iter; left time: 9369.3176s
	iters: 300, epoch: 13 | loss: 0.0000281
	speed: 0.2573s/iter; left time: 9276.1733s
	iters: 400, epoch: 13 | loss: 0.0004495
	speed: 0.2383s/iter; left time: 8564.2276s
Epoch: 13 cost time: 106.39932060241699
Epoch: 13, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.091 Vali Acc: 0.981 Test Loss: 0.091 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0005129
	speed: 0.5424s/iter; left time: 19433.6431s
	iters: 200, epoch: 14 | loss: 0.0001268
	speed: 0.2740s/iter; left time: 9788.9874s
	iters: 300, epoch: 14 | loss: 0.0000018
	speed: 0.2688s/iter; left time: 9577.6609s
	iters: 400, epoch: 14 | loss: 0.0000777
	speed: 0.2640s/iter; left time: 9380.9331s
Epoch: 14 cost time: 110.54547452926636
Epoch: 14, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.092 Vali Acc: 0.979 Test Loss: 0.092 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000364
	speed: 0.5381s/iter; left time: 19058.8502s
	iters: 200, epoch: 15 | loss: 0.0271123
	speed: 0.2616s/iter; left time: 9240.5425s
	iters: 300, epoch: 15 | loss: 0.0015049
	speed: 0.2658s/iter; left time: 9361.8861s
	iters: 400, epoch: 15 | loss: 0.0001370
	speed: 0.2522s/iter; left time: 8856.9015s
Epoch: 15 cost time: 108.82221579551697
Epoch: 15, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.077 Vali Acc: 0.979 Test Loss: 0.077 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0000442
	speed: 0.4990s/iter; left time: 17466.6920s
	iters: 200, epoch: 16 | loss: 0.0049769
	speed: 0.2613s/iter; left time: 9119.2632s
	iters: 300, epoch: 16 | loss: 0.0008747
	speed: 0.2542s/iter; left time: 8848.3179s
	iters: 400, epoch: 16 | loss: 0.0000012
	speed: 0.2581s/iter; left time: 8956.2568s
Epoch: 16 cost time: 106.69585847854614
Epoch: 16, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0001680
	speed: 0.5574s/iter; left time: 19283.6234s
	iters: 200, epoch: 17 | loss: 0.0015875
	speed: 0.2625s/iter; left time: 9053.1613s
	iters: 300, epoch: 17 | loss: 0.0002601
	speed: 0.2504s/iter; left time: 8613.5499s
	iters: 400, epoch: 17 | loss: 0.0000130
	speed: 0.2437s/iter; left time: 8357.1676s
Epoch: 17 cost time: 107.17647337913513
Epoch: 17, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0000142
	speed: 0.5124s/iter; left time: 17513.4405s
	iters: 200, epoch: 18 | loss: 0.0000261
	speed: 0.2552s/iter; left time: 8695.6572s
	iters: 300, epoch: 18 | loss: 0.6535079
	speed: 0.2642s/iter; left time: 8978.0784s
	iters: 400, epoch: 18 | loss: 0.0406936
	speed: 0.3010s/iter; left time: 10198.2989s
Epoch: 18 cost time: 112.07285690307617
Epoch: 18, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.151 Vali Acc: 0.972 Test Loss: 0.151 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000335
	speed: 0.6108s/iter; left time: 20626.0719s
	iters: 200, epoch: 19 | loss: 0.0000004
	speed: 0.2547s/iter; left time: 8575.1228s
	iters: 300, epoch: 19 | loss: 0.0000002
	speed: 0.2464s/iter; left time: 8269.4134s
	iters: 400, epoch: 19 | loss: 0.0000294
	speed: 0.2373s/iter; left time: 7940.7954s
Epoch: 19 cost time: 107.05214810371399
Epoch: 19, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.058 Vali Acc: 0.986 Test Loss: 0.058 Test Acc: 0.986
Validation loss decreased (-0.981354 --> -0.985902).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000003
	speed: 0.5102s/iter; left time: 17018.7413s
	iters: 200, epoch: 20 | loss: 0.0000300
	speed: 0.2706s/iter; left time: 8997.5132s
	iters: 300, epoch: 20 | loss: 0.0000054
	speed: 0.2732s/iter; left time: 9059.2700s
	iters: 400, epoch: 20 | loss: 0.0000170
	speed: 0.2558s/iter; left time: 8455.1270s
Epoch: 20 cost time: 108.49365854263306
Epoch: 20, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.139 Vali Acc: 0.973 Test Loss: 0.139 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0367643
	speed: 0.4986s/iter; left time: 16425.3984s
	iters: 200, epoch: 21 | loss: 0.0001118
	speed: 0.2549s/iter; left time: 8370.8985s
	iters: 300, epoch: 21 | loss: 0.0000017
	speed: 0.2529s/iter; left time: 8281.2031s
	iters: 400, epoch: 21 | loss: 0.0000002
	speed: 0.2590s/iter; left time: 8454.9936s
Epoch: 21 cost time: 105.78916311264038
Epoch: 21, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.072 Vali Acc: 0.984 Test Loss: 0.072 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0001987
	speed: 0.5353s/iter; left time: 17413.5328s
	iters: 200, epoch: 22 | loss: 0.0000011
	speed: 0.2478s/iter; left time: 8037.2032s
	iters: 300, epoch: 22 | loss: 0.0000141
	speed: 0.2555s/iter; left time: 8258.3479s
	iters: 400, epoch: 22 | loss: 0.2452966
	speed: 0.2472s/iter; left time: 7967.8224s
Epoch: 22 cost time: 105.10685634613037
Epoch: 22, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.064 Vali Acc: 0.985 Test Loss: 0.064 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0000201
	speed: 0.5622s/iter; left time: 18054.9361s
	iters: 200, epoch: 23 | loss: 0.0000074
	speed: 0.2675s/iter; left time: 8564.0311s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.2568s/iter; left time: 8194.8294s
	iters: 400, epoch: 23 | loss: 0.0062589
	speed: 0.2508s/iter; left time: 7977.6332s
Epoch: 23 cost time: 109.02128529548645
Epoch: 23, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.181 Vali Acc: 0.970 Test Loss: 0.181 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0031318
	speed: 0.5200s/iter; left time: 16485.6389s
	iters: 200, epoch: 24 | loss: 0.0008472
	speed: 0.2621s/iter; left time: 8283.1361s
	iters: 300, epoch: 24 | loss: 0.0000259
	speed: 0.2583s/iter; left time: 8136.5919s
	iters: 400, epoch: 24 | loss: 0.0000106
	speed: 0.2499s/iter; left time: 7845.9615s
Epoch: 24 cost time: 107.80934691429138
Epoch: 24, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.071 Vali Acc: 0.987 Test Loss: 0.071 Test Acc: 0.987
Validation loss decreased (-0.985902 --> -0.987266).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0299704
	speed: 0.5351s/iter; left time: 16742.5334s
	iters: 200, epoch: 25 | loss: 0.0000102
	speed: 0.2421s/iter; left time: 7550.3307s
	iters: 300, epoch: 25 | loss: 0.0000803
	speed: 0.2358s/iter; left time: 7330.7009s
	iters: 400, epoch: 25 | loss: 0.0000583
	speed: 0.2491s/iter; left time: 7720.5630s
Epoch: 25 cost time: 101.31493186950684
Epoch: 25, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0000058
	speed: 0.5414s/iter; left time: 16715.2227s
	iters: 200, epoch: 26 | loss: 0.2229036
	speed: 0.2677s/iter; left time: 8238.9794s
	iters: 300, epoch: 26 | loss: 0.0000600
	speed: 0.2557s/iter; left time: 7842.7312s
	iters: 400, epoch: 26 | loss: 0.2075143
	speed: 0.2583s/iter; left time: 7897.2021s
Epoch: 26 cost time: 109.27052307128906
Epoch: 26, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.118 Vali Acc: 0.978 Test Loss: 0.118 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0000119
	speed: 0.5108s/iter; left time: 15560.2926s
	iters: 200, epoch: 27 | loss: 0.0000275
	speed: 0.2372s/iter; left time: 7201.9161s
	iters: 300, epoch: 27 | loss: 0.0000065
	speed: 0.2573s/iter; left time: 7786.2356s
	iters: 400, epoch: 27 | loss: 0.0000002
	speed: 0.2971s/iter; left time: 8960.9630s
Epoch: 27 cost time: 108.08858370780945
Epoch: 27, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.078 Vali Acc: 0.982 Test Loss: 0.078 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0000033
	speed: 0.5549s/iter; left time: 16673.2680s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.2638s/iter; left time: 7900.1015s
	iters: 300, epoch: 28 | loss: 0.0124052
	speed: 0.2561s/iter; left time: 7645.4235s
	iters: 400, epoch: 28 | loss: 0.0000002
	speed: 0.2662s/iter; left time: 7919.3143s
Epoch: 28 cost time: 110.15586543083191
Epoch: 28, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0000013
	speed: 0.5010s/iter; left time: 14849.2778s
	iters: 200, epoch: 29 | loss: 0.0000310
	speed: 0.2612s/iter; left time: 7716.0943s
	iters: 300, epoch: 29 | loss: 0.0000097
	speed: 0.2648s/iter; left time: 7795.0073s
	iters: 400, epoch: 29 | loss: 0.4535142
	speed: 0.2556s/iter; left time: 7499.1597s
Epoch: 29 cost time: 106.87562561035156
Epoch: 29, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.166 Vali Acc: 0.971 Test Loss: 0.166 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.2267132
	speed: 0.4915s/iter; left time: 14362.4079s
	iters: 200, epoch: 30 | loss: 0.0006756
	speed: 0.2540s/iter; left time: 7398.2135s
	iters: 300, epoch: 30 | loss: 0.0011023
	speed: 0.2602s/iter; left time: 7552.5480s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.2543s/iter; left time: 7354.7697s
Epoch: 30 cost time: 104.93797063827515
Epoch: 30, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.086 Vali Acc: 0.985 Test Loss: 0.086 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.5146s/iter; left time: 14824.7440s
	iters: 200, epoch: 31 | loss: 0.0000068
	speed: 0.2693s/iter; left time: 7731.7821s
	iters: 300, epoch: 31 | loss: 0.0000008
	speed: 0.2545s/iter; left time: 7281.7212s
	iters: 400, epoch: 31 | loss: 0.0045126
	speed: 0.2555s/iter; left time: 7283.9064s
Epoch: 31 cost time: 106.59568214416504
Epoch: 31, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.107 Vali Acc: 0.981 Test Loss: 0.107 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.4794s/iter; left time: 13614.9324s
	iters: 200, epoch: 32 | loss: 0.0000001
	speed: 0.2537s/iter; left time: 7179.0722s
	iters: 300, epoch: 32 | loss: 0.0000008
	speed: 0.2686s/iter; left time: 7575.1649s
	iters: 400, epoch: 32 | loss: 0.0000035
	speed: 0.2653s/iter; left time: 7453.3054s
Epoch: 32 cost time: 106.91570782661438
Epoch: 32, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.174 Vali Acc: 0.972 Test Loss: 0.174 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0000045
	speed: 0.5136s/iter; left time: 14372.4878s
	iters: 200, epoch: 33 | loss: 0.0000005
	speed: 0.2483s/iter; left time: 6923.3487s
	iters: 300, epoch: 33 | loss: 0.2657591
	speed: 0.2492s/iter; left time: 6924.2200s
	iters: 400, epoch: 33 | loss: 0.0001389
	speed: 0.2390s/iter; left time: 6616.5435s
Epoch: 33 cost time: 103.38171672821045
Epoch: 33, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.086 Vali Acc: 0.984 Test Loss: 0.086 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.0019669
	speed: 0.4715s/iter; left time: 12999.1206s
	iters: 200, epoch: 34 | loss: 0.0000001
	speed: 0.2418s/iter; left time: 6642.3623s
	iters: 300, epoch: 34 | loss: 0.0000075
	speed: 0.2483s/iter; left time: 6797.3676s
	iters: 400, epoch: 34 | loss: 0.0000000
	speed: 0.2352s/iter; left time: 6415.6460s
Epoch: 34 cost time: 99.81890106201172
Epoch: 34, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9872669395179627
model parameter : 997002
model size : 6.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.0732269
	speed: 0.2991s/iter; left time: 12324.1347s
	iters: 200, epoch: 1 | loss: 1.2048138
	speed: 0.2817s/iter; left time: 11577.9744s
	iters: 300, epoch: 1 | loss: 0.2327654
	speed: 0.2672s/iter; left time: 10954.2617s
	iters: 400, epoch: 1 | loss: 0.0971931
	speed: 0.2633s/iter; left time: 10769.3504s
Epoch: 1 cost time: 115.15818738937378
Epoch: 1, Steps: 413 | Train Loss: 1.056 Vali Loss: 0.166 Vali Acc: 0.948 Test Loss: 0.166 Test Acc: 0.948
Validation loss decreased (inf --> -0.947702).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0498436
	speed: 0.5268s/iter; left time: 21487.1662s
	iters: 200, epoch: 2 | loss: 0.2373313
	speed: 0.2923s/iter; left time: 11891.6558s
	iters: 300, epoch: 2 | loss: 0.0451724
	speed: 0.2842s/iter; left time: 11533.3190s
	iters: 400, epoch: 2 | loss: 0.1526071
	speed: 0.2600s/iter; left time: 10528.6235s
Epoch: 2 cost time: 115.0521719455719
Epoch: 2, Steps: 413 | Train Loss: 0.118 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
Validation loss decreased (-0.947702 --> -0.969985).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0105994
	speed: 0.5182s/iter; left time: 20921.5187s
	iters: 200, epoch: 3 | loss: 0.0211792
	speed: 0.2617s/iter; left time: 10541.4888s
	iters: 300, epoch: 3 | loss: 0.2591461
	speed: 0.2707s/iter; left time: 10874.8925s
	iters: 400, epoch: 3 | loss: 0.0116209
	speed: 0.2668s/iter; left time: 10691.5475s
Epoch: 3 cost time: 109.91808438301086
Epoch: 3, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.085 Vali Acc: 0.974 Test Loss: 0.085 Test Acc: 0.974
Validation loss decreased (-0.969985 --> -0.974078).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0098344
	speed: 0.5278s/iter; left time: 21090.6721s
	iters: 200, epoch: 4 | loss: 0.0042806
	speed: 0.2733s/iter; left time: 10895.3020s
	iters: 300, epoch: 4 | loss: 0.0016281
	speed: 0.2886s/iter; left time: 11474.1623s
	iters: 400, epoch: 4 | loss: 0.0103428
	speed: 0.2906s/iter; left time: 11524.2178s
Epoch: 4 cost time: 117.21956610679626
Epoch: 4, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.066 Vali Acc: 0.976 Test Loss: 0.066 Test Acc: 0.976
Validation loss decreased (-0.974078 --> -0.975897).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0020597
	speed: 0.4967s/iter; left time: 19644.4515s
	iters: 200, epoch: 5 | loss: 0.0023182
	speed: 0.2686s/iter; left time: 10596.4239s
	iters: 300, epoch: 5 | loss: 0.0180709
	speed: 0.2526s/iter; left time: 9938.8851s
	iters: 400, epoch: 5 | loss: 0.0046890
	speed: 0.2651s/iter; left time: 10403.6704s
Epoch: 5 cost time: 106.67355847358704
Epoch: 5, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.975897 --> -0.976807).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0019962
	speed: 0.5582s/iter; left time: 21844.3357s
	iters: 200, epoch: 6 | loss: 0.0002567
	speed: 0.2846s/iter; left time: 11111.3854s
	iters: 300, epoch: 6 | loss: 0.0018465
	speed: 0.2710s/iter; left time: 10549.7628s
	iters: 400, epoch: 6 | loss: 0.0007772
	speed: 0.2416s/iter; left time: 9381.3790s
Epoch: 6 cost time: 111.60497641563416
Epoch: 6, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0001305
	speed: 0.5023s/iter; left time: 19450.1295s
	iters: 200, epoch: 7 | loss: 0.0077705
	speed: 0.2676s/iter; left time: 10337.2210s
	iters: 300, epoch: 7 | loss: 0.0107863
	speed: 0.2345s/iter; left time: 9035.2590s
	iters: 400, epoch: 7 | loss: 0.0021480
	speed: 0.2623s/iter; left time: 10078.7291s
Epoch: 7 cost time: 106.43847393989563
Epoch: 7, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.106 Vali Acc: 0.967 Test Loss: 0.106 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0002991
	speed: 0.5311s/iter; left time: 20347.2976s
	iters: 200, epoch: 8 | loss: 0.0002127
	speed: 0.2971s/iter; left time: 11350.6230s
	iters: 300, epoch: 8 | loss: 0.0052552
	speed: 0.2803s/iter; left time: 10683.7108s
	iters: 400, epoch: 8 | loss: 0.0004166
	speed: 0.2789s/iter; left time: 10601.5061s
Epoch: 8 cost time: 117.70396161079407
Epoch: 8, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0010545
	speed: 0.5273s/iter; left time: 19981.8635s
	iters: 200, epoch: 9 | loss: 0.0023623
	speed: 0.2864s/iter; left time: 10824.0970s
	iters: 300, epoch: 9 | loss: 0.0303927
	speed: 0.2771s/iter; left time: 10446.9920s
	iters: 400, epoch: 9 | loss: 0.0001341
	speed: 0.2676s/iter; left time: 10061.1310s
Epoch: 9 cost time: 113.33825612068176
Epoch: 9, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0253134
	speed: 0.4759s/iter; left time: 17836.8393s
	iters: 200, epoch: 10 | loss: 0.0000318
	speed: 0.2711s/iter; left time: 10136.0336s
	iters: 300, epoch: 10 | loss: 0.0000525
	speed: 0.2766s/iter; left time: 10312.4306s
	iters: 400, epoch: 10 | loss: 0.0071568
	speed: 0.2655s/iter; left time: 9873.8090s
Epoch: 10 cost time: 109.34769606590271
Epoch: 10, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0001059
	speed: 0.5721s/iter; left time: 21209.0695s
	iters: 200, epoch: 11 | loss: 0.0000111
	speed: 0.2507s/iter; left time: 9269.1362s
	iters: 300, epoch: 11 | loss: 0.0241105
	speed: 0.2697s/iter; left time: 9945.5180s
	iters: 400, epoch: 11 | loss: 0.0013696
	speed: 0.2666s/iter; left time: 9802.7066s
Epoch: 11 cost time: 110.40487360954285
Epoch: 11, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.074 Vali Acc: 0.982 Test Loss: 0.074 Test Acc: 0.982
Validation loss decreased (-0.976807 --> -0.981809).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0004035
	speed: 0.5206s/iter; left time: 19083.7147s
	iters: 200, epoch: 12 | loss: 0.0000472
	speed: 0.2422s/iter; left time: 8853.8309s
	iters: 300, epoch: 12 | loss: 0.0003777
	speed: 0.2772s/iter; left time: 10104.5314s
	iters: 400, epoch: 12 | loss: 0.0000205
	speed: 0.2675s/iter; left time: 9723.9504s
Epoch: 12 cost time: 108.36090087890625
Epoch: 12, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0005250
	speed: 0.5934s/iter; left time: 21506.7722s
	iters: 200, epoch: 13 | loss: 0.0000030
	speed: 0.2606s/iter; left time: 9419.5340s
	iters: 300, epoch: 13 | loss: 0.0000026
	speed: 0.2615s/iter; left time: 9424.5519s
	iters: 400, epoch: 13 | loss: 0.0000139
	speed: 0.2778s/iter; left time: 9983.7872s
Epoch: 13 cost time: 113.3131103515625
Epoch: 13, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.088 Vali Acc: 0.972 Test Loss: 0.088 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0018734
	speed: 0.5405s/iter; left time: 19367.0087s
	iters: 200, epoch: 14 | loss: 0.0009611
	speed: 0.2621s/iter; left time: 9364.5859s
	iters: 300, epoch: 14 | loss: 0.0001469
	speed: 0.2792s/iter; left time: 9948.2082s
	iters: 400, epoch: 14 | loss: 0.0000107
	speed: 0.2765s/iter; left time: 9823.8133s
Epoch: 14 cost time: 112.29526400566101
Epoch: 14, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0007315
	speed: 0.5425s/iter; left time: 19214.7328s
	iters: 200, epoch: 15 | loss: 0.0001014
	speed: 0.2680s/iter; left time: 9466.4040s
	iters: 300, epoch: 15 | loss: 0.0005862
	speed: 0.2847s/iter; left time: 10027.1746s
	iters: 400, epoch: 15 | loss: 0.0141592
	speed: 0.2669s/iter; left time: 9372.7398s
Epoch: 15 cost time: 113.34772753715515
Epoch: 15, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0008953
	speed: 0.4744s/iter; left time: 16605.7511s
	iters: 200, epoch: 16 | loss: 0.0003463
	speed: 0.2568s/iter; left time: 8965.5457s
	iters: 300, epoch: 16 | loss: 0.5388538
	speed: 0.2566s/iter; left time: 8931.2503s
	iters: 400, epoch: 16 | loss: 0.0005005
	speed: 0.2612s/iter; left time: 9064.2683s
Epoch: 16 cost time: 105.85037231445312
Epoch: 16, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.189 Vali Acc: 0.965 Test Loss: 0.189 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0453198
	speed: 0.5850s/iter; left time: 20237.4185s
	iters: 200, epoch: 17 | loss: 0.1670848
	speed: 0.2759s/iter; left time: 9517.6256s
	iters: 300, epoch: 17 | loss: 0.2132613
	speed: 0.3065s/iter; left time: 10541.9963s
	iters: 400, epoch: 17 | loss: 0.0011261
	speed: 0.2960s/iter; left time: 10151.4205s
Epoch: 17 cost time: 120.91140174865723
Epoch: 17, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.146 Vali Acc: 0.972 Test Loss: 0.146 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0006325
	speed: 0.5152s/iter; left time: 17609.2725s
	iters: 200, epoch: 18 | loss: 0.3851174
	speed: 0.2682s/iter; left time: 9141.2010s
	iters: 300, epoch: 18 | loss: 0.0001550
	speed: 0.2567s/iter; left time: 8722.9683s
	iters: 400, epoch: 18 | loss: 0.0000015
	speed: 0.2662s/iter; left time: 9017.2372s
Epoch: 18 cost time: 110.53601098060608
Epoch: 18, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.119 Vali Acc: 0.983 Test Loss: 0.119 Test Acc: 0.983
Validation loss decreased (-0.981809 --> -0.982718).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000046
	speed: 0.5776s/iter; left time: 19502.4588s
	iters: 200, epoch: 19 | loss: 0.0002273
	speed: 0.3069s/iter; left time: 10331.6207s
	iters: 300, epoch: 19 | loss: 0.0000506
	speed: 0.2922s/iter; left time: 9808.7953s
	iters: 400, epoch: 19 | loss: 0.0010574
	speed: 0.2737s/iter; left time: 9160.0419s
Epoch: 19 cost time: 119.81166243553162
Epoch: 19, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000226
	speed: 0.4706s/iter; left time: 15696.9880s
	iters: 200, epoch: 20 | loss: 0.0012324
	speed: 0.2703s/iter; left time: 8987.8873s
	iters: 300, epoch: 20 | loss: 0.0000609
	speed: 0.2623s/iter; left time: 8697.7611s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.2840s/iter; left time: 9386.9564s
Epoch: 20 cost time: 110.16042065620422
Epoch: 20, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.142 Vali Acc: 0.973 Test Loss: 0.142 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0069176
	speed: 0.5511s/iter; left time: 18153.6969s
	iters: 200, epoch: 21 | loss: 0.0000019
	speed: 0.2735s/iter; left time: 8982.4642s
	iters: 300, epoch: 21 | loss: 0.0000014
	speed: 0.2638s/iter; left time: 8638.0415s
	iters: 400, epoch: 21 | loss: 0.3739717
	speed: 0.2455s/iter; left time: 8011.9452s
Epoch: 21 cost time: 109.49839425086975
Epoch: 21, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.142 Vali Acc: 0.972 Test Loss: 0.142 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0000729
	speed: 0.5757s/iter; left time: 18725.4627s
	iters: 200, epoch: 22 | loss: 0.0000004
	speed: 0.2925s/iter; left time: 9484.1286s
	iters: 300, epoch: 22 | loss: 0.0001747
	speed: 0.2803s/iter; left time: 9061.3670s
	iters: 400, epoch: 22 | loss: 0.0000063
	speed: 0.2807s/iter; left time: 9045.7481s
Epoch: 22 cost time: 119.27772927284241
Epoch: 22, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0000598
	speed: 0.5622s/iter; left time: 18055.6458s
	iters: 200, epoch: 23 | loss: 0.0116182
	speed: 0.2699s/iter; left time: 8641.9147s
	iters: 300, epoch: 23 | loss: 0.0007154
	speed: 0.2702s/iter; left time: 8624.1395s
	iters: 400, epoch: 23 | loss: 0.0000552
	speed: 0.2581s/iter; left time: 8209.9337s
Epoch: 23 cost time: 111.6790931224823
Epoch: 23, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.148 Vali Acc: 0.971 Test Loss: 0.148 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0001287
	speed: 0.5177s/iter; left time: 16413.5720s
	iters: 200, epoch: 24 | loss: 0.0000442
	speed: 0.2850s/iter; left time: 9005.8941s
	iters: 300, epoch: 24 | loss: 0.0900873
	speed: 0.2767s/iter; left time: 8716.3556s
	iters: 400, epoch: 24 | loss: 0.0000255
	speed: 0.2690s/iter; left time: 8446.5512s
Epoch: 24 cost time: 114.37983965873718
Epoch: 24, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0001086
	speed: 0.5220s/iter; left time: 16333.1148s
	iters: 200, epoch: 25 | loss: 0.0000089
	speed: 0.2734s/iter; left time: 8526.1817s
	iters: 300, epoch: 25 | loss: 0.0000523
	speed: 0.2590s/iter; left time: 8051.3649s
	iters: 400, epoch: 25 | loss: 0.0000010
	speed: 0.2470s/iter; left time: 7654.8644s
Epoch: 25 cost time: 107.09332489967346
Epoch: 25, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.168 Vali Acc: 0.975 Test Loss: 0.168 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0000047
	speed: 0.5317s/iter; left time: 16417.1678s
	iters: 200, epoch: 26 | loss: 0.0778071
	speed: 0.2847s/iter; left time: 8762.0582s
	iters: 300, epoch: 26 | loss: 0.0000080
	speed: 0.2830s/iter; left time: 8682.7803s
	iters: 400, epoch: 26 | loss: 0.0003968
	speed: 0.2752s/iter; left time: 8414.5150s
Epoch: 26 cost time: 115.3402407169342
Epoch: 26, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0000001
	speed: 0.5327s/iter; left time: 16226.1857s
	iters: 200, epoch: 27 | loss: 0.0000501
	speed: 0.2642s/iter; left time: 8023.0934s
	iters: 300, epoch: 27 | loss: 0.0000137
	speed: 0.2814s/iter; left time: 8514.5969s
	iters: 400, epoch: 27 | loss: 0.4095760
	speed: 0.2885s/iter; left time: 8700.7256s
Epoch: 27 cost time: 112.99957752227783
Epoch: 27, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.152 Vali Acc: 0.976 Test Loss: 0.152 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.5387s/iter; left time: 16189.0445s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.2556s/iter; left time: 7655.7093s
	iters: 300, epoch: 28 | loss: 0.0000012
	speed: 0.2540s/iter; left time: 7580.5715s
	iters: 400, epoch: 28 | loss: 0.0000553
	speed: 0.2536s/iter; left time: 7545.6272s
Epoch: 28 cost time: 107.19216847419739
Epoch: 28, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.971 Test Loss: 0.185 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9827194179172352
model parameter : 997002
model size : 6.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.1347122
	speed: 0.2453s/iter; left time: 10106.0656s
	iters: 200, epoch: 1 | loss: 1.2861434
	speed: 0.2524s/iter; left time: 10372.9147s
	iters: 300, epoch: 1 | loss: 0.2291826
	speed: 0.2604s/iter; left time: 10674.7773s
	iters: 400, epoch: 1 | loss: 0.1323148
	speed: 0.2817s/iter; left time: 11520.2657s
Epoch: 1 cost time: 107.76556015014648
Epoch: 1, Steps: 413 | Train Loss: 1.075 Vali Loss: 0.161 Vali Acc: 0.955 Test Loss: 0.161 Test Acc: 0.955
Validation loss decreased (inf --> -0.954523).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0721777
	speed: 0.5490s/iter; left time: 22391.5370s
	iters: 200, epoch: 2 | loss: 0.1503531
	speed: 0.2685s/iter; left time: 10926.0419s
	iters: 300, epoch: 2 | loss: 0.0243355
	speed: 0.2493s/iter; left time: 10118.0974s
	iters: 400, epoch: 2 | loss: 0.2080406
	speed: 0.2544s/iter; left time: 10299.8967s
Epoch: 2 cost time: 108.66992259025574
Epoch: 2, Steps: 413 | Train Loss: 0.144 Vali Loss: 0.094 Vali Acc: 0.969 Test Loss: 0.094 Test Acc: 0.969
Validation loss decreased (-0.954523 --> -0.968621).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0222308
	speed: 0.5088s/iter; left time: 20541.8470s
	iters: 200, epoch: 3 | loss: 0.0106348
	speed: 0.2578s/iter; left time: 10382.2126s
	iters: 300, epoch: 3 | loss: 0.3558766
	speed: 0.2407s/iter; left time: 9671.3557s
	iters: 400, epoch: 3 | loss: 0.0379976
	speed: 0.2434s/iter; left time: 9756.1538s
Epoch: 3 cost time: 103.19044852256775
Epoch: 3, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0389777
	speed: 0.5163s/iter; left time: 20634.0646s
	iters: 200, epoch: 4 | loss: 0.0217050
	speed: 0.2579s/iter; left time: 10279.8187s
	iters: 300, epoch: 4 | loss: 0.0131000
	speed: 0.2703s/iter; left time: 10747.8743s
	iters: 400, epoch: 4 | loss: 0.0057918
	speed: 0.2673s/iter; left time: 10602.7403s
Epoch: 4 cost time: 109.88538146018982
Epoch: 4, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.093 Vali Acc: 0.965 Test Loss: 0.093 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0056100
	speed: 0.5091s/iter; left time: 20133.0687s
	iters: 200, epoch: 5 | loss: 0.0035952
	speed: 0.2687s/iter; left time: 10600.6782s
	iters: 300, epoch: 5 | loss: 0.0589416
	speed: 0.2519s/iter; left time: 9911.9230s
	iters: 400, epoch: 5 | loss: 0.0129727
	speed: 0.2681s/iter; left time: 10523.0264s
Epoch: 5 cost time: 108.16333985328674
Epoch: 5, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.111 Vali Acc: 0.971 Test Loss: 0.111 Test Acc: 0.971
Validation loss decreased (-0.968621 --> -0.970895).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0022441
	speed: 0.4995s/iter; left time: 19548.9535s
	iters: 200, epoch: 6 | loss: 0.0064498
	speed: 0.2309s/iter; left time: 9011.7499s
	iters: 300, epoch: 6 | loss: 0.0110123
	speed: 0.2428s/iter; left time: 9454.3102s
	iters: 400, epoch: 6 | loss: 0.0015402
	speed: 0.2557s/iter; left time: 9930.8239s
Epoch: 6 cost time: 98.89015460014343
Epoch: 6, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0003342
	speed: 0.5085s/iter; left time: 19690.7300s
	iters: 200, epoch: 7 | loss: 0.0192263
	speed: 0.2532s/iter; left time: 9780.5348s
	iters: 300, epoch: 7 | loss: 0.0002242
	speed: 0.2657s/iter; left time: 10236.1686s
	iters: 400, epoch: 7 | loss: 0.0728746
	speed: 0.2706s/iter; left time: 10398.7060s
Epoch: 7 cost time: 110.64882230758667
Epoch: 7, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.107 Vali Acc: 0.972 Test Loss: 0.107 Test Acc: 0.972
Validation loss decreased (-0.970895 --> -0.971804).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0004023
	speed: 0.5277s/iter; left time: 20215.2793s
	iters: 200, epoch: 8 | loss: 0.0008375
	speed: 0.2494s/iter; left time: 9528.7313s
	iters: 300, epoch: 8 | loss: 0.2422277
	speed: 0.2511s/iter; left time: 9567.5326s
	iters: 400, epoch: 8 | loss: 0.0427789
	speed: 0.2527s/iter; left time: 9606.2333s
Epoch: 8 cost time: 104.687584400177
Epoch: 8, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.164 Vali Acc: 0.965 Test Loss: 0.164 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0275104
	speed: 0.5103s/iter; left time: 19340.0321s
	iters: 200, epoch: 9 | loss: 0.0042588
	speed: 0.2666s/iter; left time: 10075.3227s
	iters: 300, epoch: 9 | loss: 0.0794149
	speed: 0.2519s/iter; left time: 9497.0108s
	iters: 400, epoch: 9 | loss: 0.0008516
	speed: 0.2510s/iter; left time: 9438.0039s
Epoch: 9 cost time: 107.20404005050659
Epoch: 9, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
Validation loss decreased (-0.971804 --> -0.975442).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.1989630
	speed: 0.5094s/iter; left time: 19093.3914s
	iters: 200, epoch: 10 | loss: 0.0001386
	speed: 0.2377s/iter; left time: 8886.5353s
	iters: 300, epoch: 10 | loss: 0.0018171
	speed: 0.2420s/iter; left time: 9023.3254s
	iters: 400, epoch: 10 | loss: 0.0008560
	speed: 0.2495s/iter; left time: 9277.4182s
Epoch: 10 cost time: 101.29016709327698
Epoch: 10, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.121 Vali Acc: 0.966 Test Loss: 0.121 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000436
	speed: 0.4670s/iter; left time: 17311.6241s
	iters: 200, epoch: 11 | loss: 0.0000037
	speed: 0.2435s/iter; left time: 9003.9390s
	iters: 300, epoch: 11 | loss: 0.0000693
	speed: 0.2514s/iter; left time: 9269.2938s
	iters: 400, epoch: 11 | loss: 0.0058963
	speed: 0.2748s/iter; left time: 10103.3135s
Epoch: 11 cost time: 104.68555283546448
Epoch: 11, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.975442 --> -0.979990).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0005546
	speed: 0.5327s/iter; left time: 19526.5974s
	iters: 200, epoch: 12 | loss: 0.0003907
	speed: 0.2400s/iter; left time: 8772.1153s
	iters: 300, epoch: 12 | loss: 0.0001346
	speed: 0.2376s/iter; left time: 8662.5247s
	iters: 400, epoch: 12 | loss: 0.0030394
	speed: 0.2334s/iter; left time: 8485.0679s
Epoch: 12 cost time: 100.33782410621643
Epoch: 12, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.134 Vali Acc: 0.966 Test Loss: 0.134 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0001066
	speed: 0.4632s/iter; left time: 16789.6122s
	iters: 200, epoch: 13 | loss: 0.0003293
	speed: 0.2480s/iter; left time: 8962.8165s
	iters: 300, epoch: 13 | loss: 0.0000444
	speed: 0.2433s/iter; left time: 8770.1721s
	iters: 400, epoch: 13 | loss: 0.0000016
	speed: 0.2466s/iter; left time: 8863.5073s
Epoch: 13 cost time: 100.97149896621704
Epoch: 13, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.163 Vali Acc: 0.968 Test Loss: 0.163 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000998
	speed: 0.4815s/iter; left time: 17254.6814s
	iters: 200, epoch: 14 | loss: 0.0000053
	speed: 0.2774s/iter; left time: 9913.2807s
	iters: 300, epoch: 14 | loss: 0.0000021
	speed: 0.2788s/iter; left time: 9934.0237s
	iters: 400, epoch: 14 | loss: 0.0359921
	speed: 0.2395s/iter; left time: 8511.2455s
Epoch: 14 cost time: 108.58641648292542
Epoch: 14, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0086376
	speed: 0.5001s/iter; left time: 17714.4247s
	iters: 200, epoch: 15 | loss: 0.0005726
	speed: 0.2360s/iter; left time: 8335.9470s
	iters: 300, epoch: 15 | loss: 0.0000308
	speed: 0.2567s/iter; left time: 9039.8871s
	iters: 400, epoch: 15 | loss: 0.1974133
	speed: 0.2442s/iter; left time: 8576.8725s
Epoch: 15 cost time: 101.15988993644714
Epoch: 15, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.137 Vali Acc: 0.974 Test Loss: 0.137 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000508
	speed: 0.4823s/iter; left time: 16883.6030s
	iters: 200, epoch: 16 | loss: 0.0000522
	speed: 0.2587s/iter; left time: 9029.3860s
	iters: 300, epoch: 16 | loss: 0.2391911
	speed: 0.2480s/iter; left time: 8631.9033s
	iters: 400, epoch: 16 | loss: 0.0002030
	speed: 0.2503s/iter; left time: 8685.6486s
Epoch: 16 cost time: 104.8112142086029
Epoch: 16, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.215 Vali Acc: 0.965 Test Loss: 0.215 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0002351
	speed: 0.4884s/iter; left time: 16894.0955s
	iters: 200, epoch: 17 | loss: 0.0007368
	speed: 0.2400s/iter; left time: 8277.3881s
	iters: 300, epoch: 17 | loss: 0.0042820
	speed: 0.2522s/iter; left time: 8675.3014s
	iters: 400, epoch: 17 | loss: 0.0007126
	speed: 0.2513s/iter; left time: 8617.4079s
Epoch: 17 cost time: 102.52051496505737
Epoch: 17, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.125 Vali Acc: 0.979 Test Loss: 0.125 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0002151
	speed: 0.5005s/iter; left time: 17107.5928s
	iters: 200, epoch: 18 | loss: 0.0000111
	speed: 0.2540s/iter; left time: 8655.5986s
	iters: 300, epoch: 18 | loss: 0.1136482
	speed: 0.2434s/iter; left time: 8269.0856s
	iters: 400, epoch: 18 | loss: 0.0164614
	speed: 0.2722s/iter; left time: 9223.6010s
Epoch: 18 cost time: 106.18489646911621
Epoch: 18, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.157 Vali Acc: 0.970 Test Loss: 0.157 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0005766
	speed: 0.5163s/iter; left time: 17432.5673s
	iters: 200, epoch: 19 | loss: 0.0000076
	speed: 0.2376s/iter; left time: 7999.5725s
	iters: 300, epoch: 19 | loss: 0.0000202
	speed: 0.2405s/iter; left time: 8074.1140s
	iters: 400, epoch: 19 | loss: 0.0000027
	speed: 0.2243s/iter; left time: 7505.1384s
Epoch: 19 cost time: 97.35956954956055
Epoch: 19, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0040649
	speed: 0.4487s/iter; left time: 14965.4359s
	iters: 200, epoch: 20 | loss: 0.2396045
	speed: 0.2698s/iter; left time: 8971.3807s
	iters: 300, epoch: 20 | loss: 0.0007659
	speed: 0.2858s/iter; left time: 9476.5380s
	iters: 400, epoch: 20 | loss: 0.0004600
	speed: 0.2491s/iter; left time: 8235.2216s
Epoch: 20 cost time: 107.20468544960022
Epoch: 20, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0000395
	speed: 0.4864s/iter; left time: 16023.4475s
	iters: 200, epoch: 21 | loss: 0.0048407
	speed: 0.2360s/iter; left time: 7750.5696s
	iters: 300, epoch: 21 | loss: 0.0000051
	speed: 0.2524s/iter; left time: 8264.0309s
	iters: 400, epoch: 21 | loss: 0.0000003
	speed: 0.2447s/iter; left time: 7986.8849s
Epoch: 21 cost time: 102.08363366127014
Epoch: 21, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.131 Vali Acc: 0.974 Test Loss: 0.131 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9799909049567985
model parameter : 997002
model size : 6.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.9713275
	speed: 0.2847s/iter; left time: 11730.3564s
	iters: 200, epoch: 1 | loss: 1.2767739
	speed: 0.2553s/iter; left time: 10493.1619s
	iters: 300, epoch: 1 | loss: 0.3643868
	speed: 0.2437s/iter; left time: 9990.2462s
	iters: 400, epoch: 1 | loss: 0.1158253
	speed: 0.2345s/iter; left time: 9589.7915s
Epoch: 1 cost time: 105.16982865333557
Epoch: 1, Steps: 413 | Train Loss: 1.036 Vali Loss: 0.128 Vali Acc: 0.963 Test Loss: 0.128 Test Acc: 0.963
Validation loss decreased (inf --> -0.963164).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0400903
	speed: 0.5302s/iter; left time: 21625.8789s
	iters: 200, epoch: 2 | loss: 0.1330592
	speed: 0.2914s/iter; left time: 11858.5168s
	iters: 300, epoch: 2 | loss: 0.0286257
	speed: 0.2770s/iter; left time: 11244.3250s
	iters: 400, epoch: 2 | loss: 0.1699554
	speed: 0.2605s/iter; left time: 10547.1835s
Epoch: 2 cost time: 113.99387097358704
Epoch: 2, Steps: 413 | Train Loss: 0.123 Vali Loss: 0.105 Vali Acc: 0.966 Test Loss: 0.105 Test Acc: 0.966
Validation loss decreased (-0.963164 --> -0.965893).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0139343
	speed: 0.5350s/iter; left time: 21599.4796s
	iters: 200, epoch: 3 | loss: 0.0121999
	speed: 0.2476s/iter; left time: 9972.4697s
	iters: 300, epoch: 3 | loss: 0.3071943
	speed: 0.2393s/iter; left time: 9615.3028s
	iters: 400, epoch: 3 | loss: 0.0084384
	speed: 0.2357s/iter; left time: 9446.2918s
Epoch: 3 cost time: 101.95459389686584
Epoch: 3, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.090 Vali Acc: 0.966 Test Loss: 0.090 Test Acc: 0.966
Validation loss decreased (-0.965893 --> -0.965893).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0057728
	speed: 0.4842s/iter; left time: 19351.2699s
	iters: 200, epoch: 4 | loss: 0.0114945
	speed: 0.2417s/iter; left time: 9635.1287s
	iters: 300, epoch: 4 | loss: 0.0015686
	speed: 0.2430s/iter; left time: 9662.2571s
	iters: 400, epoch: 4 | loss: 0.0116508
	speed: 0.2606s/iter; left time: 10335.1504s
Epoch: 4 cost time: 101.79827642440796
Epoch: 4, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.069 Vali Acc: 0.976 Test Loss: 0.069 Test Acc: 0.976
Validation loss decreased (-0.965893 --> -0.975897).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0029770
	speed: 0.5124s/iter; left time: 20265.8214s
	iters: 200, epoch: 5 | loss: 0.0059592
	speed: 0.2517s/iter; left time: 9929.3283s
	iters: 300, epoch: 5 | loss: 0.0279995
	speed: 0.2766s/iter; left time: 10884.1185s
	iters: 400, epoch: 5 | loss: 0.1903186
	speed: 0.2614s/iter; left time: 10257.9344s
Epoch: 5 cost time: 108.5025703907013
Epoch: 5, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.078 Vali Acc: 0.974 Test Loss: 0.078 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0007723
	speed: 0.4858s/iter; left time: 19012.9501s
	iters: 200, epoch: 6 | loss: 0.0016143
	speed: 0.2243s/iter; left time: 8753.9459s
	iters: 300, epoch: 6 | loss: 0.0771174
	speed: 0.2363s/iter; left time: 9199.2786s
	iters: 400, epoch: 6 | loss: 0.0138070
	speed: 0.2345s/iter; left time: 9105.3955s
Epoch: 6 cost time: 96.9474105834961
Epoch: 6, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.089 Vali Acc: 0.972 Test Loss: 0.089 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0018025
	speed: 0.4659s/iter; left time: 18041.9334s
	iters: 200, epoch: 7 | loss: 0.0093821
	speed: 0.2486s/iter; left time: 9602.2476s
	iters: 300, epoch: 7 | loss: 0.0041012
	speed: 0.2514s/iter; left time: 9682.8974s
	iters: 400, epoch: 7 | loss: 0.0059110
	speed: 0.2688s/iter; left time: 10326.6418s
Epoch: 7 cost time: 105.44016671180725
Epoch: 7, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.105 Vali Acc: 0.967 Test Loss: 0.105 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0002162
	speed: 0.5425s/iter; left time: 20783.4460s
	iters: 200, epoch: 8 | loss: 0.0108964
	speed: 0.2516s/iter; left time: 9614.9360s
	iters: 300, epoch: 8 | loss: 0.0003725
	speed: 0.2504s/iter; left time: 9541.5391s
	iters: 400, epoch: 8 | loss: 0.0008744
	speed: 0.2513s/iter; left time: 9552.2049s
Epoch: 8 cost time: 104.43731427192688
Epoch: 8, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.975897 --> -0.977262).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0005786
	speed: 0.4880s/iter; left time: 18494.0472s
	iters: 200, epoch: 9 | loss: 0.0246072
	speed: 0.2431s/iter; left time: 9189.7270s
	iters: 300, epoch: 9 | loss: 0.1064590
	speed: 0.2446s/iter; left time: 9219.5159s
	iters: 400, epoch: 9 | loss: 0.0007294
	speed: 0.2559s/iter; left time: 9620.8458s
Epoch: 9 cost time: 102.47262620925903
Epoch: 9, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.123 Vali Acc: 0.966 Test Loss: 0.123 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.1223377
	speed: 0.4883s/iter; left time: 18303.6564s
	iters: 200, epoch: 10 | loss: 0.0000246
	speed: 0.2528s/iter; left time: 9452.4740s
	iters: 300, epoch: 10 | loss: 0.0000412
	speed: 0.2489s/iter; left time: 9281.3983s
	iters: 400, epoch: 10 | loss: 0.0004387
	speed: 0.2568s/iter; left time: 9547.7606s
Epoch: 10 cost time: 105.9062397480011
Epoch: 10, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.059 Vali Acc: 0.981 Test Loss: 0.059 Test Acc: 0.981
Validation loss decreased (-0.977262 --> -0.981355).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0002786
	speed: 0.5306s/iter; left time: 19671.1466s
	iters: 200, epoch: 11 | loss: 0.0000326
	speed: 0.2529s/iter; left time: 9351.0455s
	iters: 300, epoch: 11 | loss: 0.0001096
	speed: 0.2445s/iter; left time: 9015.2013s
	iters: 400, epoch: 11 | loss: 0.0157706
	speed: 0.2474s/iter; left time: 9096.2705s
Epoch: 11 cost time: 103.7244827747345
Epoch: 11, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0003218
	speed: 0.5191s/iter; left time: 19028.5029s
	iters: 200, epoch: 12 | loss: 0.0000437
	speed: 0.2504s/iter; left time: 9153.2567s
	iters: 300, epoch: 12 | loss: 0.0081258
	speed: 0.2342s/iter; left time: 8540.0314s
	iters: 400, epoch: 12 | loss: 0.1458001
	speed: 0.2414s/iter; left time: 8776.5820s
Epoch: 12 cost time: 101.61625242233276
Epoch: 12, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000456
	speed: 0.4847s/iter; left time: 17566.8375s
	iters: 200, epoch: 13 | loss: 0.0001259
	speed: 0.2367s/iter; left time: 8555.3225s
	iters: 300, epoch: 13 | loss: 0.0000173
	speed: 0.2386s/iter; left time: 8601.0815s
	iters: 400, epoch: 13 | loss: 0.0019429
	speed: 0.2765s/iter; left time: 9938.6426s
Epoch: 13 cost time: 104.48536324501038
Epoch: 13, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.082 Vali Acc: 0.979 Test Loss: 0.082 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000096
	speed: 0.4944s/iter; left time: 17716.2899s
	iters: 200, epoch: 14 | loss: 0.0016340
	speed: 0.2431s/iter; left time: 8687.0768s
	iters: 300, epoch: 14 | loss: 0.0000156
	speed: 0.2425s/iter; left time: 8642.2411s
	iters: 400, epoch: 14 | loss: 0.0000459
	speed: 0.2492s/iter; left time: 8855.9306s
Epoch: 14 cost time: 100.27027463912964
Epoch: 14, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.111 Vali Acc: 0.972 Test Loss: 0.111 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0058980
	speed: 0.5071s/iter; left time: 17959.9222s
	iters: 200, epoch: 15 | loss: 0.0141446
	speed: 0.2534s/iter; left time: 8949.3980s
	iters: 300, epoch: 15 | loss: 0.0033034
	speed: 0.2433s/iter; left time: 8567.0642s
	iters: 400, epoch: 15 | loss: 0.0000859
	speed: 0.2558s/iter; left time: 8982.3057s
Epoch: 15 cost time: 104.55595421791077
Epoch: 15, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0202378
	speed: 0.4969s/iter; left time: 17394.5702s
	iters: 200, epoch: 16 | loss: 0.0005894
	speed: 0.2536s/iter; left time: 8850.7172s
	iters: 300, epoch: 16 | loss: 0.0048648
	speed: 0.2331s/iter; left time: 8111.7868s
	iters: 400, epoch: 16 | loss: 0.0260533
	speed: 0.2530s/iter; left time: 8778.9339s
Epoch: 16 cost time: 102.39531445503235
Epoch: 16, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.241 Vali Acc: 0.958 Test Loss: 0.241 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0032355
	speed: 0.5003s/iter; left time: 17308.4403s
	iters: 200, epoch: 17 | loss: 0.0000773
	speed: 0.2461s/iter; left time: 8487.3094s
	iters: 300, epoch: 17 | loss: 0.0034168
	speed: 0.2633s/iter; left time: 9055.2355s
	iters: 400, epoch: 17 | loss: 0.0010627
	speed: 0.2601s/iter; left time: 8918.0617s
Epoch: 17 cost time: 106.20107126235962
Epoch: 17, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0830884
	speed: 0.5043s/iter; left time: 17237.6498s
	iters: 200, epoch: 18 | loss: 0.0017320
	speed: 0.2659s/iter; left time: 9062.3952s
	iters: 300, epoch: 18 | loss: 0.0232992
	speed: 0.2676s/iter; left time: 9093.6203s
	iters: 400, epoch: 18 | loss: 0.0000148
	speed: 0.2535s/iter; left time: 8587.9460s
Epoch: 18 cost time: 108.65875554084778
Epoch: 18, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.077 Vali Acc: 0.982 Test Loss: 0.077 Test Acc: 0.982
Validation loss decreased (-0.981355 --> -0.982264).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0004681
	speed: 0.4846s/iter; left time: 16365.0886s
	iters: 200, epoch: 19 | loss: 0.0005049
	speed: 0.2352s/iter; left time: 7920.0820s
	iters: 300, epoch: 19 | loss: 0.0000214
	speed: 0.2498s/iter; left time: 8384.1339s
	iters: 400, epoch: 19 | loss: 0.0222595
	speed: 0.2564s/iter; left time: 8579.5205s
Epoch: 19 cost time: 101.25795984268188
Epoch: 19, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.128 Vali Acc: 0.971 Test Loss: 0.128 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0028432
	speed: 0.5008s/iter; left time: 16703.2526s
	iters: 200, epoch: 20 | loss: 0.0000086
	speed: 0.2554s/iter; left time: 8494.5186s
	iters: 300, epoch: 20 | loss: 0.0000049
	speed: 0.2472s/iter; left time: 8196.9773s
	iters: 400, epoch: 20 | loss: 0.0003270
	speed: 0.2566s/iter; left time: 8481.5373s
Epoch: 20 cost time: 104.9770188331604
Epoch: 20, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.150 Vali Acc: 0.973 Test Loss: 0.150 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000032
	speed: 0.4414s/iter; left time: 14541.6680s
	iters: 200, epoch: 21 | loss: 0.0000597
	speed: 0.2385s/iter; left time: 7833.2186s
	iters: 300, epoch: 21 | loss: 0.0000030
	speed: 0.2450s/iter; left time: 8020.6374s
	iters: 400, epoch: 21 | loss: 0.0000036
	speed: 0.2469s/iter; left time: 8060.2769s
Epoch: 21 cost time: 99.48340702056885
Epoch: 21, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.094 Vali Acc: 0.979 Test Loss: 0.094 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0001046
	speed: 0.4999s/iter; left time: 16261.2599s
	iters: 200, epoch: 22 | loss: 0.0000121
	speed: 0.2556s/iter; left time: 8288.7325s
	iters: 300, epoch: 22 | loss: 0.0001965
	speed: 0.2603s/iter; left time: 8416.5364s
	iters: 400, epoch: 22 | loss: 0.0002958
	speed: 0.2819s/iter; left time: 9085.3291s
Epoch: 22 cost time: 108.35812163352966
Epoch: 22, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.191 Vali Acc: 0.973 Test Loss: 0.191 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0016894
	speed: 0.5324s/iter; left time: 17097.6965s
	iters: 200, epoch: 23 | loss: 0.0017792
	speed: 0.2213s/iter; left time: 7084.0001s
	iters: 300, epoch: 23 | loss: 0.0000001
	speed: 0.2192s/iter; left time: 6996.7826s
	iters: 400, epoch: 23 | loss: 0.0000085
	speed: 0.2255s/iter; left time: 7172.9519s
Epoch: 23 cost time: 95.0382936000824
Epoch: 23, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.113 Vali Acc: 0.972 Test Loss: 0.113 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0000681
	speed: 0.4558s/iter; left time: 14449.8770s
	iters: 200, epoch: 24 | loss: 0.0011280
	speed: 0.2445s/iter; left time: 7728.0632s
	iters: 300, epoch: 24 | loss: 0.0000013
	speed: 0.2433s/iter; left time: 7665.6830s
	iters: 400, epoch: 24 | loss: 0.0000021
	speed: 0.2582s/iter; left time: 8106.9473s
Epoch: 24 cost time: 100.5403823852539
Epoch: 24, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.188 Vali Acc: 0.973 Test Loss: 0.188 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0035409
	speed: 0.5001s/iter; left time: 15646.6226s
	iters: 200, epoch: 25 | loss: 0.0000113
	speed: 0.2472s/iter; left time: 7710.0301s
	iters: 300, epoch: 25 | loss: 0.2119043
	speed: 0.2449s/iter; left time: 7613.6443s
	iters: 400, epoch: 25 | loss: 0.0000001
	speed: 0.2453s/iter; left time: 7601.7614s
Epoch: 25 cost time: 102.30896854400635
Epoch: 25, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.162 Vali Acc: 0.968 Test Loss: 0.162 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0000037
	speed: 0.4787s/iter; left time: 14781.3320s
	iters: 200, epoch: 26 | loss: 0.0961833
	speed: 0.2259s/iter; left time: 6952.4474s
	iters: 300, epoch: 26 | loss: 0.0001183
	speed: 0.2423s/iter; left time: 7432.4946s
	iters: 400, epoch: 26 | loss: 0.0003023
	speed: 0.2727s/iter; left time: 8337.2204s
Epoch: 26 cost time: 101.60202884674072
Epoch: 26, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.146 Vali Acc: 0.978 Test Loss: 0.146 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0471661
	speed: 0.5222s/iter; left time: 15908.2296s
	iters: 200, epoch: 27 | loss: 0.0025972
	speed: 0.2543s/iter; left time: 7720.9029s
	iters: 300, epoch: 27 | loss: 0.0000005
	speed: 0.2433s/iter; left time: 7363.8217s
	iters: 400, epoch: 27 | loss: 0.0000690
	speed: 0.2369s/iter; left time: 7146.5776s
Epoch: 27 cost time: 103.69343781471252
Epoch: 27, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.168 Vali Acc: 0.974 Test Loss: 0.168 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0000003
	speed: 0.4954s/iter; left time: 14887.4283s
	iters: 200, epoch: 28 | loss: 0.0000010
	speed: 0.2505s/iter; left time: 7501.6104s
	iters: 300, epoch: 28 | loss: 0.0001267
	speed: 0.2486s/iter; left time: 7421.3113s
	iters: 400, epoch: 28 | loss: 0.0069732
	speed: 0.2765s/iter; left time: 8226.2813s
Epoch: 28 cost time: 106.04693627357483
Epoch: 28, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.147 Vali Acc: 0.975 Test Loss: 0.147 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9822646657571623
model parameter : 997002
model size : 6.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.3033652
	speed: 0.2934s/iter; left time: 12087.2039s
	iters: 200, epoch: 1 | loss: 2.3014951
	speed: 0.2717s/iter; left time: 11168.9090s
	iters: 300, epoch: 1 | loss: 2.3010418
	speed: 0.2725s/iter; left time: 11173.9860s
	iters: 400, epoch: 1 | loss: 2.3018787
	speed: 0.2572s/iter; left time: 10518.7049s
Epoch: 1 cost time: 113.29518151283264
Epoch: 1, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (inf --> -0.100022).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3009214
	speed: 0.5515s/iter; left time: 22494.7702s
	iters: 200, epoch: 2 | loss: 2.3017602
	speed: 0.2766s/iter; left time: 11254.0022s
	iters: 300, epoch: 2 | loss: 2.3012428
	speed: 0.2759s/iter; left time: 11200.1186s
	iters: 400, epoch: 2 | loss: 2.3030226
	speed: 0.2705s/iter; left time: 10951.8349s
Epoch: 2 cost time: 112.86029243469238
Epoch: 2, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.3000426
	speed: 0.5475s/iter; left time: 22103.3531s
	iters: 200, epoch: 3 | loss: 2.2990801
	speed: 0.2858s/iter; left time: 11510.0679s
	iters: 300, epoch: 3 | loss: 2.3016922
	speed: 0.2650s/iter; left time: 10644.5489s
	iters: 400, epoch: 3 | loss: 2.3019519
	speed: 0.2591s/iter; left time: 10384.0936s
Epoch: 3 cost time: 111.17910766601562
Epoch: 3, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 2.3012168
	speed: 0.4734s/iter; left time: 18918.8239s
	iters: 200, epoch: 4 | loss: 2.3005631
	speed: 0.2603s/iter; left time: 10375.7497s
	iters: 300, epoch: 4 | loss: 2.3037684
	speed: 0.3093s/iter; left time: 12298.4249s
	iters: 400, epoch: 4 | loss: 2.3028769
	speed: 0.3034s/iter; left time: 12031.7551s
Epoch: 4 cost time: 115.55198216438293
Epoch: 4, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 2.3017662
	speed: 0.6160s/iter; left time: 24360.7052s
	iters: 200, epoch: 5 | loss: 2.3028302
	speed: 0.2947s/iter; left time: 11626.5132s
	iters: 300, epoch: 5 | loss: 2.3011892
	speed: 0.2729s/iter; left time: 10738.7196s
	iters: 400, epoch: 5 | loss: 2.3036380
	speed: 0.2727s/iter; left time: 10702.7790s
Epoch: 5 cost time: 117.66188931465149
Epoch: 5, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 2.3025634
	speed: 0.5828s/iter; left time: 22809.3101s
	iters: 200, epoch: 6 | loss: 2.3038764
	speed: 0.2825s/iter; left time: 11027.8372s
	iters: 300, epoch: 6 | loss: 2.3033853
	speed: 0.2861s/iter; left time: 11138.0660s
	iters: 400, epoch: 6 | loss: 2.3029981
	speed: 0.2935s/iter; left time: 11397.4149s
Epoch: 6 cost time: 117.96851778030396
Epoch: 6, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 2.3011808
	speed: 0.6048s/iter; left time: 23419.1334s
	iters: 200, epoch: 7 | loss: 2.3002214
	speed: 0.2931s/iter; left time: 11318.7043s
	iters: 300, epoch: 7 | loss: 2.3015916
	speed: 0.2886s/iter; left time: 11117.3615s
	iters: 400, epoch: 7 | loss: 2.3028133
	speed: 0.2762s/iter; left time: 10613.7490s
Epoch: 7 cost time: 119.68762540817261
Epoch: 7, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 8 | loss: 2.2985351
	speed: 0.5890s/iter; left time: 22563.9635s
	iters: 200, epoch: 8 | loss: 2.3033669
	speed: 0.2850s/iter; left time: 10888.6883s
	iters: 300, epoch: 8 | loss: 2.2989171
	speed: 0.2896s/iter; left time: 11038.0323s
	iters: 400, epoch: 8 | loss: 2.3049059
	speed: 0.2900s/iter; left time: 11023.0205s
Epoch: 8 cost time: 119.03582429885864
Epoch: 8, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.3022838
	speed: 0.6188s/iter; left time: 23449.1798s
	iters: 200, epoch: 9 | loss: 2.3019211
	speed: 0.2799s/iter; left time: 10579.9522s
	iters: 300, epoch: 9 | loss: 2.3068151
	speed: 0.2662s/iter; left time: 10034.9410s
	iters: 400, epoch: 9 | loss: 2.3025389
	speed: 0.2784s/iter; left time: 10467.5952s
Epoch: 9 cost time: 115.76092100143433
Epoch: 9, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.3035252
	speed: 0.5820s/iter; left time: 21815.5891s
	iters: 200, epoch: 10 | loss: 2.3026862
	speed: 0.2762s/iter; left time: 10326.4416s
	iters: 300, epoch: 10 | loss: 2.3056898
	speed: 0.2786s/iter; left time: 10386.6412s
	iters: 400, epoch: 10 | loss: 2.3040423
	speed: 0.2813s/iter; left time: 10460.2779s
Epoch: 10 cost time: 115.86204648017883
Epoch: 10, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.3020251
	speed: 0.5585s/iter; left time: 20705.5735s
	iters: 200, epoch: 11 | loss: 2.3005812
	speed: 0.2741s/iter; left time: 10133.4755s
	iters: 300, epoch: 11 | loss: 2.3049123
	speed: 0.2741s/iter; left time: 10106.5101s
	iters: 400, epoch: 11 | loss: 2.3018517
	speed: 0.2812s/iter; left time: 10338.9747s
Epoch: 11 cost time: 114.06942176818848
Epoch: 11, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 2.3019652
	speed: 0.5994s/iter; left time: 21974.2253s
	iters: 200, epoch: 12 | loss: 2.3053312
	speed: 0.2853s/iter; left time: 10431.5591s
	iters: 300, epoch: 12 | loss: 2.3036263
	speed: 0.2879s/iter; left time: 10496.4375s
	iters: 400, epoch: 12 | loss: 2.3034103
	speed: 0.2834s/iter; left time: 10304.8646s
Epoch: 12 cost time: 118.41714072227478
Epoch: 12, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 2.3032527
	speed: 0.5775s/iter; left time: 20932.0214s
	iters: 200, epoch: 13 | loss: 2.2975197
	speed: 0.2646s/iter; left time: 9563.7079s
	iters: 300, epoch: 13 | loss: 2.3044515
	speed: 0.2731s/iter; left time: 9843.2246s
	iters: 400, epoch: 13 | loss: 2.3027890
	speed: 0.2849s/iter; left time: 10239.3465s
Epoch: 13 cost time: 113.92416214942932
Epoch: 13, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 2.3006687
	speed: 0.5868s/iter; left time: 21025.1830s
	iters: 200, epoch: 14 | loss: 2.3058839
	speed: 0.2901s/iter; left time: 10365.3075s
	iters: 300, epoch: 14 | loss: 2.3023717
	speed: 0.2854s/iter; left time: 10169.3745s
	iters: 400, epoch: 14 | loss: 2.3023684
	speed: 0.2813s/iter; left time: 9994.6406s
Epoch: 14 cost time: 117.79732465744019
Epoch: 14, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 2.3053148
	speed: 0.5834s/iter; left time: 20664.4452s
	iters: 200, epoch: 15 | loss: 2.3017120
	speed: 0.2659s/iter; left time: 9390.3485s
	iters: 300, epoch: 15 | loss: 2.3034286
	speed: 0.2715s/iter; left time: 9561.7287s
	iters: 400, epoch: 15 | loss: 2.3045936
	speed: 0.2831s/iter; left time: 9941.5124s
Epoch: 15 cost time: 114.03854823112488
Epoch: 15, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 2.3012178
	speed: 0.5873s/iter; left time: 20557.7176s
	iters: 200, epoch: 16 | loss: 2.3050826
	speed: 0.2877s/iter; left time: 10043.1529s
	iters: 300, epoch: 16 | loss: 2.2994807
	speed: 0.2902s/iter; left time: 10101.4857s
	iters: 400, epoch: 16 | loss: 2.3011427
	speed: 0.2807s/iter; left time: 9740.5348s
Epoch: 16 cost time: 118.20720410346985
Epoch: 16, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 2.3022978
	speed: 0.5626s/iter; left time: 19462.7515s
	iters: 200, epoch: 17 | loss: 2.3047447
	speed: 0.2624s/iter; left time: 9051.4166s
	iters: 300, epoch: 17 | loss: 2.3049946
	speed: 0.2693s/iter; left time: 9260.6876s
	iters: 400, epoch: 17 | loss: 2.3054044
	speed: 0.2845s/iter; left time: 9756.7147s
Epoch: 17 cost time: 112.9322612285614
Epoch: 17, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 2.3000453
	speed: 0.5747s/iter; left time: 19644.8269s
	iters: 200, epoch: 18 | loss: 2.3016725
	speed: 0.2923s/iter; left time: 9962.7687s
	iters: 300, epoch: 18 | loss: 2.3055983
	speed: 0.2943s/iter; left time: 10001.2632s
	iters: 400, epoch: 18 | loss: 2.3047385
	speed: 0.2863s/iter; left time: 9698.5189s
Epoch: 18 cost time: 119.36775970458984
Epoch: 18, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.10004547521600728
model parameter : 997002
model size : 6.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         47                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.9412875
	speed: 0.3191s/iter; left time: 13148.1807s
	iters: 200, epoch: 1 | loss: 0.3964297
	speed: 0.2856s/iter; left time: 11738.7653s
	iters: 300, epoch: 1 | loss: 0.3405612
	speed: 0.3017s/iter; left time: 12368.8366s
	iters: 400, epoch: 1 | loss: 0.1856836
	speed: 0.2981s/iter; left time: 12190.7858s
Epoch: 1 cost time: 124.99388909339905
Epoch: 1, Steps: 413 | Train Loss: 0.598 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
Validation loss decreased (inf --> -0.975897).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0395070
	speed: 0.5815s/iter; left time: 23720.1824s
	iters: 200, epoch: 2 | loss: 0.1250013
	speed: 0.2500s/iter; left time: 10172.0939s
	iters: 300, epoch: 2 | loss: 0.5642256
	speed: 0.2880s/iter; left time: 11688.6062s
	iters: 400, epoch: 2 | loss: 0.0087866
	speed: 0.3150s/iter; left time: 12754.0708s
Epoch: 2 cost time: 117.33899998664856
Epoch: 2, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.049 Vali Acc: 0.985 Test Loss: 0.049 Test Acc: 0.985
Validation loss decreased (-0.975897 --> -0.984538).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0052729
	speed: 0.6000s/iter; left time: 24224.9443s
	iters: 200, epoch: 3 | loss: 0.0103507
	speed: 0.3025s/iter; left time: 12182.3622s
	iters: 300, epoch: 3 | loss: 0.0668455
	speed: 0.2959s/iter; left time: 11887.3197s
	iters: 400, epoch: 3 | loss: 0.0228587
	speed: 0.2973s/iter; left time: 11914.6259s
Epoch: 3 cost time: 124.66945004463196
Epoch: 3, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.051 Vali Acc: 0.981 Test Loss: 0.051 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0040655
	speed: 0.6165s/iter; left time: 24636.2940s
	iters: 200, epoch: 4 | loss: 0.0070257
	speed: 0.3008s/iter; left time: 11991.9611s
	iters: 300, epoch: 4 | loss: 0.0636010
	speed: 0.3026s/iter; left time: 12033.4167s
	iters: 400, epoch: 4 | loss: 0.0124200
	speed: 0.3041s/iter; left time: 12061.2108s
Epoch: 4 cost time: 126.01591849327087
Epoch: 4, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.060 Vali Acc: 0.980 Test Loss: 0.060 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0672542
	speed: 0.6296s/iter; left time: 24898.6577s
	iters: 200, epoch: 5 | loss: 0.0222134
	speed: 0.3116s/iter; left time: 12292.7802s
	iters: 300, epoch: 5 | loss: 0.0004753
	speed: 0.3001s/iter; left time: 11808.7891s
	iters: 400, epoch: 5 | loss: 0.0496992
	speed: 0.3111s/iter; left time: 12208.9573s
Epoch: 5 cost time: 127.72159314155579
Epoch: 5, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0012099
	speed: 0.5938s/iter; left time: 23238.1240s
	iters: 200, epoch: 6 | loss: 0.0228308
	speed: 0.2978s/iter; left time: 11626.6940s
	iters: 300, epoch: 6 | loss: 0.0010749
	speed: 0.2792s/iter; left time: 10871.5280s
	iters: 400, epoch: 6 | loss: 0.0003386
	speed: 0.2883s/iter; left time: 11198.0349s
Epoch: 6 cost time: 119.83981609344482
Epoch: 6, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0309665
	speed: 0.6218s/iter; left time: 24079.0631s
	iters: 200, epoch: 7 | loss: 0.0041596
	speed: 0.2928s/iter; left time: 11306.9451s
	iters: 300, epoch: 7 | loss: 0.0748760
	speed: 0.3275s/iter; left time: 12617.4531s
	iters: 400, epoch: 7 | loss: 0.0001843
	speed: 0.3034s/iter; left time: 11659.1188s
Epoch: 7 cost time: 126.16176199913025
Epoch: 7, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0005416
	speed: 0.6068s/iter; left time: 23247.6048s
	iters: 200, epoch: 8 | loss: 0.0049292
	speed: 0.2812s/iter; left time: 10745.9096s
	iters: 300, epoch: 8 | loss: 0.1374205
	speed: 0.2883s/iter; left time: 10986.2210s
	iters: 400, epoch: 8 | loss: 0.0000180
	speed: 0.2981s/iter; left time: 11332.5793s
Epoch: 8 cost time: 122.85666346549988
Epoch: 8, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.063 Vali Acc: 0.985 Test Loss: 0.063 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0011920
	speed: 0.6089s/iter; left time: 23074.8520s
	iters: 200, epoch: 9 | loss: 0.0148991
	speed: 0.2925s/iter; left time: 11055.3403s
	iters: 300, epoch: 9 | loss: 0.0038159
	speed: 0.2739s/iter; left time: 10326.5303s
	iters: 400, epoch: 9 | loss: 0.0004394
	speed: 0.3134s/iter; left time: 11781.5925s
Epoch: 9 cost time: 121.33659219741821
Epoch: 9, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0118763
	speed: 0.6126s/iter; left time: 22962.0137s
	iters: 200, epoch: 10 | loss: 0.0073689
	speed: 0.2910s/iter; left time: 10879.8486s
	iters: 300, epoch: 10 | loss: 0.0031024
	speed: 0.3225s/iter; left time: 12023.5710s
	iters: 400, epoch: 10 | loss: 0.0016234
	speed: 0.3003s/iter; left time: 11165.5611s
Epoch: 10 cost time: 126.0872232913971
Epoch: 10, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.085 Vali Acc: 0.979 Test Loss: 0.085 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0154226
	speed: 0.6093s/iter; left time: 22586.7954s
	iters: 200, epoch: 11 | loss: 0.0000089
	speed: 0.3052s/iter; left time: 11284.9028s
	iters: 300, epoch: 11 | loss: 0.0003043
	speed: 0.3053s/iter; left time: 11256.5289s
	iters: 400, epoch: 11 | loss: 0.0035250
	speed: 0.3067s/iter; left time: 11279.2759s
Epoch: 11 cost time: 126.49288249015808
Epoch: 11, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.133 Vali Acc: 0.966 Test Loss: 0.133 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0000342
	speed: 0.6380s/iter; left time: 23386.2135s
	iters: 200, epoch: 12 | loss: 0.0340494
	speed: 0.3175s/iter; left time: 11606.3996s
	iters: 300, epoch: 12 | loss: 0.0004643
	speed: 0.3101s/iter; left time: 11304.6420s
	iters: 400, epoch: 12 | loss: 0.0149913
	speed: 0.3094s/iter; left time: 11250.7171s
Epoch: 12 cost time: 130.17539978027344
Epoch: 12, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9845384265575261
model parameter : 603786
model size : 4.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         38                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0372893
	speed: 0.3109s/iter; left time: 12810.4256s
	iters: 200, epoch: 1 | loss: 0.5402808
	speed: 0.2991s/iter; left time: 12293.6110s
	iters: 300, epoch: 1 | loss: 0.3628802
	speed: 0.2979s/iter; left time: 12215.9957s
	iters: 400, epoch: 1 | loss: 0.2118082
	speed: 0.2973s/iter; left time: 12161.1879s
Epoch: 1 cost time: 125.16704869270325
Epoch: 1, Steps: 413 | Train Loss: 0.638 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
Validation loss decreased (inf --> -0.978171).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1037562
	speed: 0.6426s/iter; left time: 26208.4615s
	iters: 200, epoch: 2 | loss: 0.1051147
	speed: 0.3203s/iter; left time: 13031.8031s
	iters: 300, epoch: 2 | loss: 0.5691532
	speed: 0.3194s/iter; left time: 12965.6902s
	iters: 400, epoch: 2 | loss: 0.0097345
	speed: 0.2985s/iter; left time: 12084.2129s
Epoch: 2 cost time: 129.3477325439453
Epoch: 2, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.064 Vali Acc: 0.978 Test Loss: 0.064 Test Acc: 0.978
Validation loss decreased (-0.978171 --> -0.978171).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0129111
	speed: 0.6502s/iter; left time: 26250.5480s
	iters: 200, epoch: 3 | loss: 0.0291649
	speed: 0.3287s/iter; left time: 13236.4215s
	iters: 300, epoch: 3 | loss: 0.1030313
	speed: 0.3066s/iter; left time: 12318.6855s
	iters: 400, epoch: 3 | loss: 0.0270534
	speed: 0.3134s/iter; left time: 12559.9208s
Epoch: 3 cost time: 130.54829239845276
Epoch: 3, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.040 Vali Acc: 0.986 Test Loss: 0.040 Test Acc: 0.986
Validation loss decreased (-0.978171 --> -0.985902).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0167109
	speed: 0.6163s/iter; left time: 24627.6123s
	iters: 200, epoch: 4 | loss: 0.1234270
	speed: 0.3244s/iter; left time: 12930.9461s
	iters: 300, epoch: 4 | loss: 0.0464175
	speed: 0.3195s/iter; left time: 12704.8198s
	iters: 400, epoch: 4 | loss: 0.0187923
	speed: 0.3096s/iter; left time: 12280.1721s
Epoch: 4 cost time: 131.0871946811676
Epoch: 4, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.047 Vali Acc: 0.983 Test Loss: 0.047 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0480897
	speed: 0.6569s/iter; left time: 25977.8355s
	iters: 200, epoch: 5 | loss: 0.0296932
	speed: 0.3189s/iter; left time: 12581.2783s
	iters: 300, epoch: 5 | loss: 0.0022655
	speed: 0.3061s/iter; left time: 12042.9472s
	iters: 400, epoch: 5 | loss: 0.0030121
	speed: 0.3084s/iter; left time: 12105.6336s
Epoch: 5 cost time: 130.6545946598053
Epoch: 5, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.060 Vali Acc: 0.980 Test Loss: 0.060 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0039992
	speed: 0.6292s/iter; left time: 24625.5847s
	iters: 200, epoch: 6 | loss: 0.0162678
	speed: 0.3018s/iter; left time: 11780.2877s
	iters: 300, epoch: 6 | loss: 0.0031271
	speed: 0.3124s/iter; left time: 12163.4129s
	iters: 400, epoch: 6 | loss: 0.0006974
	speed: 0.3183s/iter; left time: 12359.8759s
Epoch: 6 cost time: 128.62656664848328
Epoch: 6, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0058099
	speed: 0.6373s/iter; left time: 24677.1800s
	iters: 200, epoch: 7 | loss: 0.0002484
	speed: 0.3259s/iter; left time: 12587.0275s
	iters: 300, epoch: 7 | loss: 0.0008409
	speed: 0.3174s/iter; left time: 12225.8562s
	iters: 400, epoch: 7 | loss: 0.0004470
	speed: 0.2978s/iter; left time: 11442.0900s
Epoch: 7 cost time: 130.19877457618713
Epoch: 7, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0002183
	speed: 0.6332s/iter; left time: 24258.3159s
	iters: 200, epoch: 8 | loss: 0.2273202
	speed: 0.3187s/iter; left time: 12175.6478s
	iters: 300, epoch: 8 | loss: 0.0051911
	speed: 0.3065s/iter; left time: 11681.7823s
	iters: 400, epoch: 8 | loss: 0.0003658
	speed: 0.3149s/iter; left time: 11968.8579s
Epoch: 8 cost time: 130.1509518623352
Epoch: 8, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.073 Vali Acc: 0.982 Test Loss: 0.073 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0015033
	speed: 0.6356s/iter; left time: 24087.7646s
	iters: 200, epoch: 9 | loss: 0.0001662
	speed: 0.3123s/iter; left time: 11803.5744s
	iters: 300, epoch: 9 | loss: 0.0135933
	speed: 0.3025s/iter; left time: 11402.4434s
	iters: 400, epoch: 9 | loss: 0.0038350
	speed: 0.3248s/iter; left time: 12210.3898s
Epoch: 9 cost time: 130.40880727767944
Epoch: 9, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0001003
	speed: 0.6671s/iter; left time: 25004.9249s
	iters: 200, epoch: 10 | loss: 0.0003855
	speed: 0.3203s/iter; left time: 11974.2847s
	iters: 300, epoch: 10 | loss: 0.0168553
	speed: 0.3101s/iter; left time: 11560.4167s
	iters: 400, epoch: 10 | loss: 0.0009369
	speed: 0.3112s/iter; left time: 11570.1073s
Epoch: 10 cost time: 130.55557584762573
Epoch: 10, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.078 Vali Acc: 0.985 Test Loss: 0.078 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0001242
	speed: 0.6253s/iter; left time: 23179.2787s
	iters: 200, epoch: 11 | loss: 0.0025445
	speed: 0.2939s/iter; left time: 10864.3716s
	iters: 300, epoch: 11 | loss: 0.0000251
	speed: 0.3015s/iter; left time: 11116.2307s
	iters: 400, epoch: 11 | loss: 0.0000125
	speed: 0.3014s/iter; left time: 11084.3264s
Epoch: 11 cost time: 124.5997486114502
Epoch: 11, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.164 Vali Acc: 0.965 Test Loss: 0.164 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0013112
	speed: 0.6251s/iter; left time: 22915.2560s
	iters: 200, epoch: 12 | loss: 0.0065083
	speed: 0.3061s/iter; left time: 11189.8295s
	iters: 300, epoch: 12 | loss: 0.0000025
	speed: 0.3164s/iter; left time: 11534.3588s
	iters: 400, epoch: 12 | loss: 0.1001438
	speed: 0.3207s/iter; left time: 11659.7711s
Epoch: 12 cost time: 130.47032928466797
Epoch: 12, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0008150
	speed: 0.6373s/iter; left time: 23098.6208s
	iters: 200, epoch: 13 | loss: 0.0014188
	speed: 0.3028s/iter; left time: 10944.9391s
	iters: 300, epoch: 13 | loss: 0.0060833
	speed: 0.3017s/iter; left time: 10876.3535s
	iters: 400, epoch: 13 | loss: 0.0000022
	speed: 0.3063s/iter; left time: 11010.9457s
Epoch: 13 cost time: 125.63796663284302
Epoch: 13, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.076 Vali Acc: 0.982 Test Loss: 0.076 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9859026830377444
model parameter : 603786
model size : 4.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         28                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1740314
	speed: 0.3122s/iter; left time: 12864.5393s
	iters: 200, epoch: 1 | loss: 0.6068125
	speed: 0.2975s/iter; left time: 12228.3552s
	iters: 300, epoch: 1 | loss: 0.3037019
	speed: 0.3070s/iter; left time: 12587.8985s
	iters: 400, epoch: 1 | loss: 0.3658677
	speed: 0.3146s/iter; left time: 12868.9430s
Epoch: 1 cost time: 127.12232613563538
Epoch: 1, Steps: 413 | Train Loss: 0.719 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
Validation loss decreased (inf --> -0.973623).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1320254
	speed: 0.6151s/iter; left time: 25090.3039s
	iters: 200, epoch: 2 | loss: 0.0766319
	speed: 0.2907s/iter; left time: 11827.2830s
	iters: 300, epoch: 2 | loss: 0.6276722
	speed: 0.3163s/iter; left time: 12838.6680s
	iters: 400, epoch: 2 | loss: 0.0199809
	speed: 0.3156s/iter; left time: 12777.5229s
Epoch: 2 cost time: 127.62892889976501
Epoch: 2, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.063 Vali Acc: 0.978 Test Loss: 0.063 Test Acc: 0.978
Validation loss decreased (-0.973623 --> -0.977717).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0105941
	speed: 0.6276s/iter; left time: 25338.0337s
	iters: 200, epoch: 3 | loss: 0.0096643
	speed: 0.3189s/iter; left time: 12842.1413s
	iters: 300, epoch: 3 | loss: 0.0968719
	speed: 0.3103s/iter; left time: 12465.5003s
	iters: 400, epoch: 3 | loss: 0.0159176
	speed: 0.2964s/iter; left time: 11879.0624s
Epoch: 3 cost time: 126.7993803024292
Epoch: 3, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.047 Vali Acc: 0.984 Test Loss: 0.047 Test Acc: 0.984
Validation loss decreased (-0.977717 --> -0.984083).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0280248
	speed: 0.6179s/iter; left time: 24693.1977s
	iters: 200, epoch: 4 | loss: 0.0889810
	speed: 0.3155s/iter; left time: 12578.4210s
	iters: 300, epoch: 4 | loss: 0.0070132
	speed: 0.3054s/iter; left time: 12144.2616s
	iters: 400, epoch: 4 | loss: 0.0013496
	speed: 0.3106s/iter; left time: 12318.4138s
Epoch: 4 cost time: 128.0892562866211
Epoch: 4, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.054 Vali Acc: 0.985 Test Loss: 0.054 Test Acc: 0.985
Validation loss decreased (-0.984083 --> -0.984993).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0087431
	speed: 0.6222s/iter; left time: 24608.5152s
	iters: 200, epoch: 5 | loss: 0.0129709
	speed: 0.2935s/iter; left time: 11579.4983s
	iters: 300, epoch: 5 | loss: 0.0036364
	speed: 0.2909s/iter; left time: 11447.5588s
	iters: 400, epoch: 5 | loss: 0.0218987
	speed: 0.3109s/iter; left time: 12201.9111s
Epoch: 5 cost time: 123.9771831035614
Epoch: 5, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.065 Vali Acc: 0.978 Test Loss: 0.065 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0017617
	speed: 0.6387s/iter; left time: 24994.9349s
	iters: 200, epoch: 6 | loss: 0.1333629
	speed: 0.3223s/iter; left time: 12580.1528s
	iters: 300, epoch: 6 | loss: 0.0188466
	speed: 0.3108s/iter; left time: 12101.2390s
	iters: 400, epoch: 6 | loss: 0.0000224
	speed: 0.3057s/iter; left time: 11872.0789s
Epoch: 6 cost time: 128.87758135795593
Epoch: 6, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.054 Vali Acc: 0.984 Test Loss: 0.054 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0002979
	speed: 0.6146s/iter; left time: 23798.7365s
	iters: 200, epoch: 7 | loss: 0.0008081
	speed: 0.3036s/iter; left time: 11727.2613s
	iters: 300, epoch: 7 | loss: 0.0011579
	speed: 0.3002s/iter; left time: 11562.9855s
	iters: 400, epoch: 7 | loss: 0.0305962
	speed: 0.3015s/iter; left time: 11584.8751s
Epoch: 7 cost time: 125.43093276023865
Epoch: 7, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.090 Vali Acc: 0.974 Test Loss: 0.090 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0030838
	speed: 0.6383s/iter; left time: 24452.0554s
	iters: 200, epoch: 8 | loss: 0.0004957
	speed: 0.3056s/iter; left time: 11677.5821s
	iters: 300, epoch: 8 | loss: 0.0068939
	speed: 0.3067s/iter; left time: 11690.0796s
	iters: 400, epoch: 8 | loss: 0.0009835
	speed: 0.2956s/iter; left time: 11233.8927s
Epoch: 8 cost time: 126.16893076896667
Epoch: 8, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0529322
	speed: 0.6320s/iter; left time: 23950.4680s
	iters: 200, epoch: 9 | loss: 0.0009022
	speed: 0.3171s/iter; left time: 11987.2388s
	iters: 300, epoch: 9 | loss: 0.0031447
	speed: 0.3105s/iter; left time: 11705.8490s
	iters: 400, epoch: 9 | loss: 0.0014846
	speed: 0.3151s/iter; left time: 11846.2052s
Epoch: 9 cost time: 129.33713364601135
Epoch: 9, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.056 Vali Acc: 0.981 Test Loss: 0.056 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0001512
	speed: 0.6429s/iter; left time: 24098.4028s
	iters: 200, epoch: 10 | loss: 0.0003430
	speed: 0.3218s/iter; left time: 12032.0122s
	iters: 300, epoch: 10 | loss: 0.0028939
	speed: 0.3084s/iter; left time: 11499.5492s
	iters: 400, epoch: 10 | loss: 0.0173186
	speed: 0.3072s/iter; left time: 11423.1070s
Epoch: 10 cost time: 131.5674889087677
Epoch: 10, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0001700
	speed: 0.6524s/iter; left time: 24185.6252s
	iters: 200, epoch: 11 | loss: 0.0000919
	speed: 0.3030s/iter; left time: 11201.8929s
	iters: 300, epoch: 11 | loss: 0.0000483
	speed: 0.2976s/iter; left time: 10972.4304s
	iters: 400, epoch: 11 | loss: 0.0000161
	speed: 0.3051s/iter; left time: 11218.5337s
Epoch: 11 cost time: 126.86933279037476
Epoch: 11, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.053 Vali Acc: 0.984 Test Loss: 0.053 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0000527
	speed: 0.6012s/iter; left time: 22039.0328s
	iters: 200, epoch: 12 | loss: 0.0023580
	speed: 0.2967s/iter; left time: 10846.2615s
	iters: 300, epoch: 12 | loss: 0.0017697
	speed: 0.3194s/iter; left time: 11645.5684s
	iters: 400, epoch: 12 | loss: 0.0000627
	speed: 0.3158s/iter; left time: 11482.6916s
Epoch: 12 cost time: 128.11380624771118
Epoch: 12, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0005459
	speed: 0.6461s/iter; left time: 23418.9063s
	iters: 200, epoch: 13 | loss: 0.0000162
	speed: 0.3205s/iter; left time: 11583.2968s
	iters: 300, epoch: 13 | loss: 0.0000043
	speed: 0.3173s/iter; left time: 11438.4235s
	iters: 400, epoch: 13 | loss: 0.0000183
	speed: 0.3079s/iter; left time: 11068.8507s
Epoch: 13 cost time: 129.66924858093262
Epoch: 13, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0009590
	speed: 0.6218s/iter; left time: 22279.9414s
	iters: 200, epoch: 14 | loss: 0.0000115
	speed: 0.2940s/iter; left time: 10505.7966s
	iters: 300, epoch: 14 | loss: 0.0000010
	speed: 0.2965s/iter; left time: 10566.1651s
	iters: 400, epoch: 14 | loss: 0.0108944
	speed: 0.3105s/iter; left time: 11032.4047s
Epoch: 14 cost time: 125.28131985664368
Epoch: 14, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.079 Vali Acc: 0.979 Test Loss: 0.079 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.984993178717599
model parameter : 603786
model size : 4.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.4053113
	speed: 0.3473s/iter; left time: 14309.9084s
	iters: 200, epoch: 1 | loss: 0.7076862
	speed: 0.3234s/iter; left time: 13293.2414s
	iters: 300, epoch: 1 | loss: 0.4369719
	speed: 0.3147s/iter; left time: 12901.7180s
	iters: 400, epoch: 1 | loss: 0.5480877
	speed: 0.2976s/iter; left time: 12171.0143s
Epoch: 1 cost time: 132.53355836868286
Epoch: 1, Steps: 413 | Train Loss: 0.818 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
Validation loss decreased (inf --> -0.970440).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0926043
	speed: 0.6583s/iter; left time: 26852.0847s
	iters: 200, epoch: 2 | loss: 0.1121727
	speed: 0.3324s/iter; left time: 13523.5646s
	iters: 300, epoch: 2 | loss: 0.5920202
	speed: 0.3217s/iter; left time: 13058.2887s
	iters: 400, epoch: 2 | loss: 0.0138816
	speed: 0.3265s/iter; left time: 13219.6322s
Epoch: 2 cost time: 134.18791007995605
Epoch: 2, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.090 Vali Acc: 0.969 Test Loss: 0.090 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0128546
	speed: 0.6409s/iter; left time: 25878.0084s
	iters: 200, epoch: 3 | loss: 0.0123877
	speed: 0.3100s/iter; left time: 12487.0207s
	iters: 300, epoch: 3 | loss: 0.0472402
	speed: 0.3071s/iter; left time: 12337.0096s
	iters: 400, epoch: 3 | loss: 0.0835567
	speed: 0.3119s/iter; left time: 12497.8646s
Epoch: 3 cost time: 127.53751730918884
Epoch: 3, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.081 Vali Acc: 0.970 Test Loss: 0.081 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0462157
	speed: 0.6319s/iter; left time: 25252.6400s
	iters: 200, epoch: 4 | loss: 0.0250424
	speed: 0.3143s/iter; left time: 12529.6436s
	iters: 300, epoch: 4 | loss: 0.0289236
	speed: 0.3077s/iter; left time: 12235.9056s
	iters: 400, epoch: 4 | loss: 0.0059221
	speed: 0.3156s/iter; left time: 12516.0186s
Epoch: 4 cost time: 128.79225611686707
Epoch: 4, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.056 Vali Acc: 0.975 Test Loss: 0.056 Test Acc: 0.975
Validation loss decreased (-0.970440 --> -0.974533).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0056935
	speed: 0.6436s/iter; left time: 25454.0983s
	iters: 200, epoch: 5 | loss: 0.0036094
	speed: 0.3140s/iter; left time: 12385.5320s
	iters: 300, epoch: 5 | loss: 0.0135790
	speed: 0.3234s/iter; left time: 12727.1208s
	iters: 400, epoch: 5 | loss: 0.0100911
	speed: 0.3134s/iter; left time: 12300.8093s
Epoch: 5 cost time: 131.22124862670898
Epoch: 5, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0021072
	speed: 0.6110s/iter; left time: 23913.4531s
	iters: 200, epoch: 6 | loss: 0.0026528
	speed: 0.3156s/iter; left time: 12319.0396s
	iters: 300, epoch: 6 | loss: 0.0078558
	speed: 0.3031s/iter; left time: 11801.0893s
	iters: 400, epoch: 6 | loss: 0.0001932
	speed: 0.3037s/iter; left time: 11796.2055s
Epoch: 6 cost time: 125.66791820526123
Epoch: 6, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0001332
	speed: 0.6394s/iter; left time: 24760.3756s
	iters: 200, epoch: 7 | loss: 0.0104001
	speed: 0.3107s/iter; left time: 12000.2708s
	iters: 300, epoch: 7 | loss: 0.0004687
	speed: 0.3149s/iter; left time: 12130.4966s
	iters: 400, epoch: 7 | loss: 0.0034653
	speed: 0.3196s/iter; left time: 12281.8227s
Epoch: 7 cost time: 130.59433221817017
Epoch: 7, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0029783
	speed: 0.6262s/iter; left time: 23988.3275s
	iters: 200, epoch: 8 | loss: 0.0029230
	speed: 0.3217s/iter; left time: 12291.8900s
	iters: 300, epoch: 8 | loss: 0.0010499
	speed: 0.3070s/iter; left time: 11701.3308s
	iters: 400, epoch: 8 | loss: 0.0029062
	speed: 0.3031s/iter; left time: 11522.7204s
Epoch: 8 cost time: 128.40016841888428
Epoch: 8, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
Validation loss decreased (-0.974533 --> -0.977716).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0010473
	speed: 0.6452s/iter; left time: 24452.4110s
	iters: 200, epoch: 9 | loss: 0.0009150
	speed: 0.3055s/iter; left time: 11545.8185s
	iters: 300, epoch: 9 | loss: 0.0003121
	speed: 0.3012s/iter; left time: 11355.9812s
	iters: 400, epoch: 9 | loss: 0.0391523
	speed: 0.3170s/iter; left time: 11917.3218s
Epoch: 9 cost time: 128.04437923431396
Epoch: 9, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.052 Vali Acc: 0.983 Test Loss: 0.052 Test Acc: 0.983
Validation loss decreased (-0.977716 --> -0.982719).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000641
	speed: 0.6873s/iter; left time: 25764.1100s
	iters: 200, epoch: 10 | loss: 0.0001503
	speed: 0.3406s/iter; left time: 12733.6955s
	iters: 300, epoch: 10 | loss: 0.0578327
	speed: 0.3154s/iter; left time: 11759.8707s
	iters: 400, epoch: 10 | loss: 0.0000344
	speed: 0.3177s/iter; left time: 11814.0893s
Epoch: 10 cost time: 136.1515793800354
Epoch: 10, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.036 Vali Acc: 0.987 Test Loss: 0.036 Test Acc: 0.987
Validation loss decreased (-0.982719 --> -0.987267).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0003494
	speed: 0.6576s/iter; left time: 24378.7012s
	iters: 200, epoch: 11 | loss: 0.0077602
	speed: 0.3247s/iter; left time: 12005.2990s
	iters: 300, epoch: 11 | loss: 0.0004963
	speed: 0.3386s/iter; left time: 12486.0024s
	iters: 400, epoch: 11 | loss: 0.0000231
	speed: 0.3386s/iter; left time: 12451.1881s
Epoch: 11 cost time: 137.07702231407166
Epoch: 11, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0001674
	speed: 0.6773s/iter; left time: 24829.0624s
	iters: 200, epoch: 12 | loss: 0.0095052
	speed: 0.3284s/iter; left time: 12005.2203s
	iters: 300, epoch: 12 | loss: 0.0001317
	speed: 0.3369s/iter; left time: 12284.3160s
	iters: 400, epoch: 12 | loss: 0.2803695
	speed: 0.3309s/iter; left time: 12031.9960s
Epoch: 12 cost time: 138.23641395568848
Epoch: 12, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.183 Vali Acc: 0.957 Test Loss: 0.183 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0108746
	speed: 0.6662s/iter; left time: 24147.4255s
	iters: 200, epoch: 13 | loss: 0.0004524
	speed: 0.3295s/iter; left time: 11909.8672s
	iters: 300, epoch: 13 | loss: 0.0017966
	speed: 0.3310s/iter; left time: 11929.7119s
	iters: 400, epoch: 13 | loss: 0.0002202
	speed: 0.3148s/iter; left time: 11315.7057s
Epoch: 13 cost time: 135.27429676055908
Epoch: 13, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000056
	speed: 0.6874s/iter; left time: 24630.9202s
	iters: 200, epoch: 14 | loss: 0.0000065
	speed: 0.3299s/iter; left time: 11789.5122s
	iters: 300, epoch: 14 | loss: 0.0000715
	speed: 0.3315s/iter; left time: 11811.8766s
	iters: 400, epoch: 14 | loss: 0.0009284
	speed: 0.3242s/iter; left time: 11520.5122s
Epoch: 14 cost time: 137.77478408813477
Epoch: 14, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0002218
	speed: 0.6398s/iter; left time: 22659.5031s
	iters: 200, epoch: 15 | loss: 0.0000462
	speed: 0.3297s/iter; left time: 11643.8890s
	iters: 300, epoch: 15 | loss: 0.0000045
	speed: 0.3228s/iter; left time: 11368.2627s
	iters: 400, epoch: 15 | loss: 0.0000610
	speed: 0.3344s/iter; left time: 11742.4581s
Epoch: 15 cost time: 133.8952043056488
Epoch: 15, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0008555
	speed: 0.6539s/iter; left time: 22889.4160s
	iters: 200, epoch: 16 | loss: 0.0952589
	speed: 0.3265s/iter; left time: 11396.2073s
	iters: 300, epoch: 16 | loss: 0.0000817
	speed: 0.3192s/iter; left time: 11111.7866s
	iters: 400, epoch: 16 | loss: 0.0000005
	speed: 0.3279s/iter; left time: 11379.0895s
Epoch: 16 cost time: 134.68197870254517
Epoch: 16, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000125
	speed: 0.6629s/iter; left time: 22933.1312s
	iters: 200, epoch: 17 | loss: 0.0000070
	speed: 0.3413s/iter; left time: 11772.9364s
	iters: 300, epoch: 17 | loss: 0.0013711
	speed: 0.3174s/iter; left time: 10914.9614s
	iters: 400, epoch: 17 | loss: 0.0060984
	speed: 0.3136s/iter; left time: 10755.7218s
Epoch: 17 cost time: 132.67056608200073
Epoch: 17, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.073 Vali Acc: 0.984 Test Loss: 0.073 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000057
	speed: 0.6606s/iter; left time: 22579.2487s
	iters: 200, epoch: 18 | loss: 0.0000743
	speed: 0.3239s/iter; left time: 11037.2279s
	iters: 300, epoch: 18 | loss: 0.0001915
	speed: 0.3391s/iter; left time: 11520.9266s
	iters: 400, epoch: 18 | loss: 0.0000221
	speed: 0.3263s/iter; left time: 11054.6049s
Epoch: 18 cost time: 134.8472273349762
Epoch: 18, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0001127
	speed: 0.6591s/iter; left time: 22256.9398s
	iters: 200, epoch: 19 | loss: 0.0000006
	speed: 0.3155s/iter; left time: 10622.6939s
	iters: 300, epoch: 19 | loss: 0.0000140
	speed: 0.3208s/iter; left time: 10768.2896s
	iters: 400, epoch: 19 | loss: 0.0000671
	speed: 0.3263s/iter; left time: 10918.7719s
Epoch: 19 cost time: 133.39608335494995
Epoch: 19, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.107 Vali Acc: 0.979 Test Loss: 0.107 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0000125
	speed: 0.6800s/iter; left time: 22681.7585s
	iters: 200, epoch: 20 | loss: 1.0770347
	speed: 0.3071s/iter; left time: 10213.7037s
	iters: 300, epoch: 20 | loss: 0.0133894
	speed: 0.3223s/iter; left time: 10685.4731s
	iters: 400, epoch: 20 | loss: 0.0000313
	speed: 0.3395s/iter; left time: 11223.4088s
Epoch: 20 cost time: 135.22486519813538
Epoch: 20, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9872669395179627
model parameter : 603786
model size : 4.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.9985656
	speed: 0.3240s/iter; left time: 13348.8071s
	iters: 200, epoch: 1 | loss: 0.9033336
	speed: 0.3128s/iter; left time: 12856.6797s
	iters: 300, epoch: 1 | loss: 0.6233308
	speed: 0.3046s/iter; left time: 12488.6807s
	iters: 400, epoch: 1 | loss: 0.4410540
	speed: 0.3100s/iter; left time: 12679.8202s
Epoch: 1 cost time: 129.43864917755127
Epoch: 1, Steps: 413 | Train Loss: 0.998 Vali Loss: 0.129 Vali Acc: 0.960 Test Loss: 0.129 Test Acc: 0.960
Validation loss decreased (inf --> -0.959526).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1117506
	speed: 0.6386s/iter; left time: 26049.1692s
	iters: 200, epoch: 2 | loss: 0.1248682
	speed: 0.3044s/iter; left time: 12383.7256s
	iters: 300, epoch: 2 | loss: 0.6216295
	speed: 0.2951s/iter; left time: 11975.7170s
	iters: 400, epoch: 2 | loss: 0.1748084
	speed: 0.3069s/iter; left time: 12427.1752s
Epoch: 2 cost time: 126.38145184516907
Epoch: 2, Steps: 413 | Train Loss: 0.111 Vali Loss: 0.118 Vali Acc: 0.960 Test Loss: 0.118 Test Acc: 0.960
Validation loss decreased (-0.959526 --> -0.959526).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0134497
	speed: 0.6320s/iter; left time: 25517.3377s
	iters: 200, epoch: 3 | loss: 0.0156411
	speed: 0.3018s/iter; left time: 12156.8998s
	iters: 300, epoch: 3 | loss: 0.0135261
	speed: 0.3152s/iter; left time: 12665.1407s
	iters: 400, epoch: 3 | loss: 0.0143527
	speed: 0.3206s/iter; left time: 12846.7802s
Epoch: 3 cost time: 128.44272994995117
Epoch: 3, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.063 Vali Acc: 0.977 Test Loss: 0.063 Test Acc: 0.977
Validation loss decreased (-0.959526 --> -0.977262).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1232592
	speed: 0.6390s/iter; left time: 25533.8699s
	iters: 200, epoch: 4 | loss: 0.0115997
	speed: 0.3082s/iter; left time: 12285.9771s
	iters: 300, epoch: 4 | loss: 0.0699735
	speed: 0.3082s/iter; left time: 12256.1166s
	iters: 400, epoch: 4 | loss: 0.0102525
	speed: 0.2988s/iter; left time: 11850.4135s
Epoch: 4 cost time: 126.75933957099915
Epoch: 4, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0464002
	speed: 0.6287s/iter; left time: 24863.6915s
	iters: 200, epoch: 5 | loss: 0.0180875
	speed: 0.3131s/iter; left time: 12351.7530s
	iters: 300, epoch: 5 | loss: 0.0573757
	speed: 0.3180s/iter; left time: 12514.4190s
	iters: 400, epoch: 5 | loss: 0.0012340
	speed: 0.3278s/iter; left time: 12864.5155s
Epoch: 5 cost time: 131.37553930282593
Epoch: 5, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.114 Vali Acc: 0.966 Test Loss: 0.114 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0459907
	speed: 0.6079s/iter; left time: 23791.0983s
	iters: 200, epoch: 6 | loss: 0.0024498
	speed: 0.3116s/iter; left time: 12163.7052s
	iters: 300, epoch: 6 | loss: 0.0099609
	speed: 0.2912s/iter; left time: 11338.1195s
	iters: 400, epoch: 6 | loss: 0.0000132
	speed: 0.2922s/iter; left time: 11349.0640s
Epoch: 6 cost time: 123.33048391342163
Epoch: 6, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.068 Vali Acc: 0.975 Test Loss: 0.068 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000567
	speed: 0.6017s/iter; left time: 23298.0677s
	iters: 200, epoch: 7 | loss: 0.0004703
	speed: 0.3050s/iter; left time: 11781.3429s
	iters: 300, epoch: 7 | loss: 0.0013194
	speed: 0.2967s/iter; left time: 11431.6617s
	iters: 400, epoch: 7 | loss: 0.0157800
	speed: 0.3181s/iter; left time: 12222.1374s
Epoch: 7 cost time: 126.8909502029419
Epoch: 7, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0013792
	speed: 0.6304s/iter; left time: 24152.0468s
	iters: 200, epoch: 8 | loss: 0.0019568
	speed: 0.3081s/iter; left time: 11772.8155s
	iters: 300, epoch: 8 | loss: 0.0219915
	speed: 0.3148s/iter; left time: 11998.3213s
	iters: 400, epoch: 8 | loss: 0.0006622
	speed: 0.3001s/iter; left time: 11408.1941s
Epoch: 8 cost time: 126.74379897117615
Epoch: 8, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.120 Vali Acc: 0.964 Test Loss: 0.120 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0012014
	speed: 0.6335s/iter; left time: 24007.7466s
	iters: 200, epoch: 9 | loss: 0.0027431
	speed: 0.3124s/iter; left time: 11806.0267s
	iters: 300, epoch: 9 | loss: 0.0081694
	speed: 0.3188s/iter; left time: 12016.4392s
	iters: 400, epoch: 9 | loss: 0.0561444
	speed: 0.3427s/iter; left time: 12885.8438s
Epoch: 9 cost time: 132.4463758468628
Epoch: 9, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0002486
	speed: 0.6435s/iter; left time: 24122.3657s
	iters: 200, epoch: 10 | loss: 0.0000176
	speed: 0.2863s/iter; left time: 10702.1597s
	iters: 300, epoch: 10 | loss: 0.0014584
	speed: 0.2712s/iter; left time: 10112.5714s
	iters: 400, epoch: 10 | loss: 0.0305084
	speed: 0.2668s/iter; left time: 9921.3732s
Epoch: 10 cost time: 117.74347567558289
Epoch: 10, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.071 Vali Acc: 0.982 Test Loss: 0.071 Test Acc: 0.982
Validation loss decreased (-0.977262 --> -0.982264).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0001892
	speed: 0.5544s/iter; left time: 20553.0777s
	iters: 200, epoch: 11 | loss: 0.0000778
	speed: 0.2582s/iter; left time: 9546.9400s
	iters: 300, epoch: 11 | loss: 0.0004947
	speed: 0.2648s/iter; left time: 9763.8847s
	iters: 400, epoch: 11 | loss: 0.0005055
	speed: 0.2601s/iter; left time: 9562.9031s
Epoch: 11 cost time: 108.91575622558594
Epoch: 11, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0097319
	speed: 0.5714s/iter; left time: 20945.2021s
	iters: 200, epoch: 12 | loss: 0.0123551
	speed: 0.2807s/iter; left time: 10261.1823s
	iters: 300, epoch: 12 | loss: 0.0000793
	speed: 0.2611s/iter; left time: 9520.7250s
	iters: 400, epoch: 12 | loss: 0.0009763
	speed: 0.2747s/iter; left time: 9986.1084s
Epoch: 12 cost time: 113.61230444908142
Epoch: 12, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.056 Vali Acc: 0.983 Test Loss: 0.056 Test Acc: 0.983
Validation loss decreased (-0.982264 --> -0.983174).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0176984
	speed: 0.5684s/iter; left time: 20600.3007s
	iters: 200, epoch: 13 | loss: 0.0000154
	speed: 0.2719s/iter; left time: 9827.6516s
	iters: 300, epoch: 13 | loss: 0.0000993
	speed: 0.2652s/iter; left time: 9558.8732s
	iters: 400, epoch: 13 | loss: 0.0000654
	speed: 0.2722s/iter; left time: 9785.4757s
Epoch: 13 cost time: 112.05793762207031
Epoch: 13, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0005502
	speed: 0.6207s/iter; left time: 22242.7069s
	iters: 200, epoch: 14 | loss: 0.0112004
	speed: 0.3029s/iter; left time: 10823.6878s
	iters: 300, epoch: 14 | loss: 0.3251614
	speed: 0.3050s/iter; left time: 10868.2034s
	iters: 400, epoch: 14 | loss: 0.0028149
	speed: 0.2963s/iter; left time: 10528.0986s
Epoch: 14 cost time: 126.55607318878174
Epoch: 14, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000044
	speed: 0.6241s/iter; left time: 22104.1614s
	iters: 200, epoch: 15 | loss: 0.0266156
	speed: 0.3238s/iter; left time: 11435.0119s
	iters: 300, epoch: 15 | loss: 0.0000202
	speed: 0.3171s/iter; left time: 11166.2674s
	iters: 400, epoch: 15 | loss: 0.2066377
	speed: 0.3167s/iter; left time: 11122.8207s
Epoch: 15 cost time: 132.51094770431519
Epoch: 15, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.121 Vali Acc: 0.972 Test Loss: 0.121 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000464
	speed: 0.6578s/iter; left time: 23026.2404s
	iters: 200, epoch: 16 | loss: 0.0001639
	speed: 0.3173s/iter; left time: 11076.7466s
	iters: 300, epoch: 16 | loss: 0.0000509
	speed: 0.3201s/iter; left time: 11140.4388s
	iters: 400, epoch: 16 | loss: 0.0000509
	speed: 0.3147s/iter; left time: 10921.5204s
Epoch: 16 cost time: 130.72987008094788
Epoch: 16, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000101
	speed: 0.6304s/iter; left time: 21807.7799s
	iters: 200, epoch: 17 | loss: 0.0000027
	speed: 0.3147s/iter; left time: 10854.8954s
	iters: 300, epoch: 17 | loss: 0.0139079
	speed: 0.3209s/iter; left time: 11036.8738s
	iters: 400, epoch: 17 | loss: 0.0000046
	speed: 0.3146s/iter; left time: 10786.8675s
Epoch: 17 cost time: 131.85684418678284
Epoch: 17, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.121 Vali Acc: 0.978 Test Loss: 0.121 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000047
	speed: 0.6711s/iter; left time: 22938.9791s
	iters: 200, epoch: 18 | loss: 0.0002621
	speed: 0.3247s/iter; left time: 11066.2906s
	iters: 300, epoch: 18 | loss: 0.0012405
	speed: 0.2984s/iter; left time: 10138.7346s
	iters: 400, epoch: 18 | loss: 0.0000036
	speed: 0.3123s/iter; left time: 10582.0894s
Epoch: 18 cost time: 130.27175188064575
Epoch: 18, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000397
	speed: 0.6551s/iter; left time: 22120.4468s
	iters: 200, epoch: 19 | loss: 0.0000001
	speed: 0.3204s/iter; left time: 10785.8599s
	iters: 300, epoch: 19 | loss: 0.0000001
	speed: 0.3166s/iter; left time: 10628.9272s
	iters: 400, epoch: 19 | loss: 0.0000070
	speed: 0.3082s/iter; left time: 10313.1040s
Epoch: 19 cost time: 132.6203224658966
Epoch: 19, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.137 Vali Acc: 0.979 Test Loss: 0.137 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000107
	speed: 0.5944s/iter; left time: 19824.0481s
	iters: 200, epoch: 20 | loss: 0.0052852
	speed: 0.2945s/iter; left time: 9794.1048s
	iters: 300, epoch: 20 | loss: 0.0562338
	speed: 0.3074s/iter; left time: 10193.0880s
	iters: 400, epoch: 20 | loss: 0.0008110
	speed: 0.3249s/iter; left time: 10737.9863s
Epoch: 20 cost time: 125.24520134925842
Epoch: 20, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.111 Vali Acc: 0.978 Test Loss: 0.111 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0005491
	speed: 0.6332s/iter; left time: 20859.2776s
	iters: 200, epoch: 21 | loss: 0.0002208
	speed: 0.3012s/iter; left time: 9892.6513s
	iters: 300, epoch: 21 | loss: 0.0000972
	speed: 0.3142s/iter; left time: 10287.1076s
	iters: 400, epoch: 21 | loss: 0.0001629
	speed: 0.3055s/iter; left time: 9970.2794s
Epoch: 21 cost time: 126.90524578094482
Epoch: 21, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0003443
	speed: 0.6386s/iter; left time: 20773.0624s
	iters: 200, epoch: 22 | loss: 0.0000050
	speed: 0.3145s/iter; left time: 10197.6955s
	iters: 300, epoch: 22 | loss: 0.0000001
	speed: 0.3129s/iter; left time: 10114.1029s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.3088s/iter; left time: 9951.6569s
Epoch: 22 cost time: 129.0035879611969
Epoch: 22, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.117 Vali Acc: 0.978 Test Loss: 0.117 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9831741700773079
model parameter : 603786
model size : 4.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.1433268
	speed: 0.3224s/iter; left time: 13283.8886s
	iters: 200, epoch: 1 | loss: 0.9242515
	speed: 0.3054s/iter; left time: 12550.6088s
	iters: 300, epoch: 1 | loss: 0.6065361
	speed: 0.3165s/iter; left time: 12976.7444s
	iters: 400, epoch: 1 | loss: 0.3555501
	speed: 0.2702s/iter; left time: 11053.2109s
Epoch: 1 cost time: 125.36604237556458
Epoch: 1, Steps: 413 | Train Loss: 1.058 Vali Loss: 0.137 Vali Acc: 0.960 Test Loss: 0.137 Test Acc: 0.960
Validation loss decreased (inf --> -0.959980).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1675001
	speed: 0.5566s/iter; left time: 22701.9889s
	iters: 200, epoch: 2 | loss: 0.2560922
	speed: 0.2931s/iter; left time: 11925.3792s
	iters: 300, epoch: 2 | loss: 0.7033846
	speed: 0.2826s/iter; left time: 11470.7372s
	iters: 400, epoch: 2 | loss: 0.0966706
	speed: 0.3051s/iter; left time: 12352.1170s
Epoch: 2 cost time: 120.77525591850281
Epoch: 2, Steps: 413 | Train Loss: 0.118 Vali Loss: 0.101 Vali Acc: 0.964 Test Loss: 0.101 Test Acc: 0.964
Validation loss decreased (-0.959980 --> -0.964074).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0152007
	speed: 0.6258s/iter; left time: 25265.4583s
	iters: 200, epoch: 3 | loss: 0.0550397
	speed: 0.3128s/iter; left time: 12597.1739s
	iters: 300, epoch: 3 | loss: 0.0529695
	speed: 0.3028s/iter; left time: 12165.7514s
	iters: 400, epoch: 3 | loss: 0.0258967
	speed: 0.3005s/iter; left time: 12043.8707s
Epoch: 3 cost time: 126.98716902732849
Epoch: 3, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.069 Vali Acc: 0.973 Test Loss: 0.069 Test Acc: 0.973
Validation loss decreased (-0.964074 --> -0.973169).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2381958
	speed: 0.5619s/iter; left time: 22455.6732s
	iters: 200, epoch: 4 | loss: 0.0382327
	speed: 0.2799s/iter; left time: 11159.0519s
	iters: 300, epoch: 4 | loss: 0.1831901
	speed: 0.2829s/iter; left time: 11247.1297s
	iters: 400, epoch: 4 | loss: 0.0351652
	speed: 0.2962s/iter; left time: 11749.6626s
Epoch: 4 cost time: 117.99552536010742
Epoch: 4, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.062 Vali Acc: 0.975 Test Loss: 0.062 Test Acc: 0.975
Validation loss decreased (-0.973169 --> -0.974988).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0008308
	speed: 0.5744s/iter; left time: 22716.5023s
	iters: 200, epoch: 5 | loss: 0.0679404
	speed: 0.2683s/iter; left time: 10585.2154s
	iters: 300, epoch: 5 | loss: 0.0498066
	speed: 0.2966s/iter; left time: 11672.7241s
	iters: 400, epoch: 5 | loss: 0.0280898
	speed: 0.2987s/iter; left time: 11725.2970s
Epoch: 5 cost time: 118.75112199783325
Epoch: 5, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.132 Vali Acc: 0.955 Test Loss: 0.132 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0394830
	speed: 0.6264s/iter; left time: 24513.0030s
	iters: 200, epoch: 6 | loss: 0.0034141
	speed: 0.3186s/iter; left time: 12436.1178s
	iters: 300, epoch: 6 | loss: 0.0035144
	speed: 0.3295s/iter; left time: 12831.0377s
	iters: 400, epoch: 6 | loss: 0.0000343
	speed: 0.3225s/iter; left time: 12523.8128s
Epoch: 6 cost time: 133.01829385757446
Epoch: 6, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0003897
	speed: 0.6452s/iter; left time: 24985.8213s
	iters: 200, epoch: 7 | loss: 0.0017247
	speed: 0.2942s/iter; left time: 11361.8049s
	iters: 300, epoch: 7 | loss: 0.0035604
	speed: 0.3153s/iter; left time: 12146.8779s
	iters: 400, epoch: 7 | loss: 0.0010225
	speed: 0.3009s/iter; left time: 11561.2364s
Epoch: 7 cost time: 127.8348536491394
Epoch: 7, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.143 Vali Acc: 0.963 Test Loss: 0.143 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0015430
	speed: 0.5633s/iter; left time: 21581.0664s
	iters: 200, epoch: 8 | loss: 0.0015311
	speed: 0.2863s/iter; left time: 10937.6565s
	iters: 300, epoch: 8 | loss: 0.0078009
	speed: 0.2884s/iter; left time: 10989.1728s
	iters: 400, epoch: 8 | loss: 0.0000702
	speed: 0.2867s/iter; left time: 10895.6244s
Epoch: 8 cost time: 119.32150673866272
Epoch: 8, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.107 Vali Acc: 0.969 Test Loss: 0.107 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.1983747
	speed: 0.5522s/iter; left time: 20927.9748s
	iters: 200, epoch: 9 | loss: 0.0005186
	speed: 0.2834s/iter; left time: 10710.3410s
	iters: 300, epoch: 9 | loss: 0.0121467
	speed: 0.3039s/iter; left time: 11456.2524s
	iters: 400, epoch: 9 | loss: 0.0012022
	speed: 0.3072s/iter; left time: 11549.1169s
Epoch: 9 cost time: 120.62199878692627
Epoch: 9, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.123 Vali Acc: 0.969 Test Loss: 0.123 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0003198
	speed: 0.6028s/iter; left time: 22594.2048s
	iters: 200, epoch: 10 | loss: 0.0058241
	speed: 0.3114s/iter; left time: 11641.2579s
	iters: 300, epoch: 10 | loss: 0.0111285
	speed: 0.3044s/iter; left time: 11347.5409s
	iters: 400, epoch: 10 | loss: 0.0010623
	speed: 0.3079s/iter; left time: 11449.8726s
Epoch: 10 cost time: 127.11730933189392
Epoch: 10, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.097 Vali Acc: 0.971 Test Loss: 0.097 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000541
	speed: 0.6350s/iter; left time: 23539.6398s
	iters: 200, epoch: 11 | loss: 0.0000959
	speed: 0.3080s/iter; left time: 11388.3223s
	iters: 300, epoch: 11 | loss: 0.0000557
	speed: 0.2990s/iter; left time: 11023.0893s
	iters: 400, epoch: 11 | loss: 0.0000404
	speed: 0.2928s/iter; left time: 10767.8587s
Epoch: 11 cost time: 126.08215236663818
Epoch: 11, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.150 Vali Acc: 0.967 Test Loss: 0.150 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0001788
	speed: 0.6164s/iter; left time: 22597.7061s
	iters: 200, epoch: 12 | loss: 0.0002824
	speed: 0.3051s/iter; left time: 11152.4271s
	iters: 300, epoch: 12 | loss: 0.0011293
	speed: 0.3091s/iter; left time: 11268.7684s
	iters: 400, epoch: 12 | loss: 0.3560678
	speed: 0.3074s/iter; left time: 11175.0106s
Epoch: 12 cost time: 127.07064414024353
Epoch: 12, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0000379
	speed: 0.6605s/iter; left time: 23940.2528s
	iters: 200, epoch: 13 | loss: 0.0009731
	speed: 0.3168s/iter; left time: 11452.1722s
	iters: 300, epoch: 13 | loss: 0.0098301
	speed: 0.3084s/iter; left time: 11115.0589s
	iters: 400, epoch: 13 | loss: 0.0000378
	speed: 0.3110s/iter; left time: 11179.4740s
Epoch: 13 cost time: 130.38695883750916
Epoch: 13, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000119
	speed: 0.5949s/iter; left time: 21316.9241s
	iters: 200, epoch: 14 | loss: 0.0000025
	speed: 0.2976s/iter; left time: 10634.0401s
	iters: 300, epoch: 14 | loss: 0.0000036
	speed: 0.3030s/iter; left time: 10798.0088s
	iters: 400, epoch: 14 | loss: 0.0003117
	speed: 0.3043s/iter; left time: 10811.2035s
Epoch: 14 cost time: 125.0397801399231
Epoch: 14, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.130 Vali Acc: 0.972 Test Loss: 0.130 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9749886311959982
model parameter : 603786
model size : 4.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.1337967
	speed: 0.3320s/iter; left time: 13680.0684s
	iters: 200, epoch: 1 | loss: 0.6801255
	speed: 0.3019s/iter; left time: 12407.1444s
	iters: 300, epoch: 1 | loss: 0.7781633
	speed: 0.3024s/iter; left time: 12398.0279s
	iters: 400, epoch: 1 | loss: 0.3647823
	speed: 0.2934s/iter; left time: 11999.4608s
Epoch: 1 cost time: 126.64453196525574
Epoch: 1, Steps: 413 | Train Loss: 1.077 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
Validation loss decreased (inf --> -0.964983).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1968624
	speed: 0.5465s/iter; left time: 22290.1190s
	iters: 200, epoch: 2 | loss: 0.4149635
	speed: 0.2826s/iter; left time: 11497.7262s
	iters: 300, epoch: 2 | loss: 0.6571804
	speed: 0.2971s/iter; left time: 12060.3007s
	iters: 400, epoch: 2 | loss: 0.2160657
	speed: 0.2816s/iter; left time: 11400.5698s
Epoch: 2 cost time: 117.2386417388916
Epoch: 2, Steps: 413 | Train Loss: 0.135 Vali Loss: 0.109 Vali Acc: 0.960 Test Loss: 0.109 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0247290
	speed: 0.6691s/iter; left time: 27013.2696s
	iters: 200, epoch: 3 | loss: 0.0418788
	speed: 0.2888s/iter; left time: 11629.9416s
	iters: 300, epoch: 3 | loss: 0.0064372
	speed: 0.2840s/iter; left time: 11411.4703s
	iters: 400, epoch: 3 | loss: 0.0095702
	speed: 0.2738s/iter; left time: 10971.0641s
Epoch: 3 cost time: 120.52981615066528
Epoch: 3, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
Validation loss decreased (-0.964983 --> -0.969531).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0245580
	speed: 0.5602s/iter; left time: 22386.9701s
	iters: 200, epoch: 4 | loss: 0.0844482
	speed: 0.2754s/iter; left time: 10979.7136s
	iters: 300, epoch: 4 | loss: 0.0358113
	speed: 0.2717s/iter; left time: 10803.5939s
	iters: 400, epoch: 4 | loss: 0.0033288
	speed: 0.2654s/iter; left time: 10526.7231s
Epoch: 4 cost time: 113.66825461387634
Epoch: 4, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.057 Vali Acc: 0.982 Test Loss: 0.057 Test Acc: 0.982
Validation loss decreased (-0.969531 --> -0.982264).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0129602
	speed: 0.5879s/iter; left time: 23252.8256s
	iters: 200, epoch: 5 | loss: 0.0126027
	speed: 0.3154s/iter; left time: 12441.3093s
	iters: 300, epoch: 5 | loss: 0.0906867
	speed: 0.3174s/iter; left time: 12489.2815s
	iters: 400, epoch: 5 | loss: 0.0468442
	speed: 0.2864s/iter; left time: 11241.7925s
Epoch: 5 cost time: 125.5849609375
Epoch: 5, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.089 Vali Acc: 0.969 Test Loss: 0.089 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0027283
	speed: 0.6003s/iter; left time: 23492.7355s
	iters: 200, epoch: 6 | loss: 0.0010625
	speed: 0.3071s/iter; left time: 11986.5048s
	iters: 300, epoch: 6 | loss: 0.0152884
	speed: 0.3022s/iter; left time: 11767.2813s
	iters: 400, epoch: 6 | loss: 0.0024469
	speed: 0.3038s/iter; left time: 11798.6694s
Epoch: 6 cost time: 126.8576877117157
Epoch: 6, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0062128
	speed: 0.6117s/iter; left time: 23686.4032s
	iters: 200, epoch: 7 | loss: 0.0134206
	speed: 0.3228s/iter; left time: 12465.6393s
	iters: 300, epoch: 7 | loss: 0.0015608
	speed: 0.3089s/iter; left time: 11899.0100s
	iters: 400, epoch: 7 | loss: 0.0002667
	speed: 0.3158s/iter; left time: 12132.8477s
Epoch: 7 cost time: 130.0933060646057
Epoch: 7, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.091 Vali Acc: 0.971 Test Loss: 0.091 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0658188
	speed: 0.6268s/iter; left time: 24012.0872s
	iters: 200, epoch: 8 | loss: 0.0004106
	speed: 0.2976s/iter; left time: 11370.2828s
	iters: 300, epoch: 8 | loss: 0.0005998
	speed: 0.2943s/iter; left time: 11214.9866s
	iters: 400, epoch: 8 | loss: 0.0007271
	speed: 0.2859s/iter; left time: 10867.8373s
Epoch: 8 cost time: 123.35211610794067
Epoch: 8, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0652441
	speed: 0.6018s/iter; left time: 22805.1274s
	iters: 200, epoch: 9 | loss: 0.0030572
	speed: 0.2982s/iter; left time: 11272.2496s
	iters: 300, epoch: 9 | loss: 0.0012408
	speed: 0.3007s/iter; left time: 11336.7928s
	iters: 400, epoch: 9 | loss: 0.0255623
	speed: 0.3050s/iter; left time: 11466.7308s
Epoch: 9 cost time: 124.48909139633179
Epoch: 9, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0012402
	speed: 0.6103s/iter; left time: 22876.7999s
	iters: 200, epoch: 10 | loss: 0.0000328
	speed: 0.3003s/iter; left time: 11227.9129s
	iters: 300, epoch: 10 | loss: 0.0261313
	speed: 0.2929s/iter; left time: 10921.7058s
	iters: 400, epoch: 10 | loss: 0.0304258
	speed: 0.2899s/iter; left time: 10780.8607s
Epoch: 10 cost time: 122.32092237472534
Epoch: 10, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.134 Vali Acc: 0.960 Test Loss: 0.134 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000165
	speed: 0.6029s/iter; left time: 22349.7833s
	iters: 200, epoch: 11 | loss: 0.0014427
	speed: 0.2971s/iter; left time: 10983.4143s
	iters: 300, epoch: 11 | loss: 0.0001334
	speed: 0.3017s/iter; left time: 11125.3413s
	iters: 400, epoch: 11 | loss: 0.0000483
	speed: 0.2976s/iter; left time: 10943.5867s
Epoch: 11 cost time: 123.41069221496582
Epoch: 11, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.056 Vali Acc: 0.982 Test Loss: 0.056 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0035217
	speed: 0.6223s/iter; left time: 22811.3165s
	iters: 200, epoch: 12 | loss: 0.0329846
	speed: 0.2872s/iter; left time: 10499.3374s
	iters: 300, epoch: 12 | loss: 0.0000020
	speed: 0.2798s/iter; left time: 10200.7293s
	iters: 400, epoch: 12 | loss: 0.0079119
	speed: 0.2838s/iter; left time: 10317.9769s
Epoch: 12 cost time: 119.39228081703186
Epoch: 12, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.129 Vali Acc: 0.966 Test Loss: 0.129 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0089465
	speed: 0.5595s/iter; left time: 20277.4472s
	iters: 200, epoch: 13 | loss: 0.1394921
	speed: 0.2854s/iter; left time: 10315.3742s
	iters: 300, epoch: 13 | loss: 0.0185301
	speed: 0.2858s/iter; left time: 10301.8102s
	iters: 400, epoch: 13 | loss: 0.0005345
	speed: 0.2929s/iter; left time: 10527.5296s
Epoch: 13 cost time: 118.2111496925354
Epoch: 13, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.063 Vali Acc: 0.982 Test Loss: 0.063 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000014
	speed: 0.5958s/iter; left time: 21347.2674s
	iters: 200, epoch: 14 | loss: 0.0000343
	speed: 0.2985s/iter; left time: 10666.8543s
	iters: 300, epoch: 14 | loss: 0.0000193
	speed: 0.2952s/iter; left time: 10517.5077s
	iters: 400, epoch: 14 | loss: 0.2085457
	speed: 0.2845s/iter; left time: 10108.1469s
Epoch: 14 cost time: 121.38916349411011
Epoch: 14, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.063 Vali Acc: 0.980 Test Loss: 0.063 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9822646657571623
model parameter : 603786
model size : 4.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.0829158
	speed: 0.3037s/iter; left time: 12513.2178s
	iters: 200, epoch: 1 | loss: 0.6969569
	speed: 0.2762s/iter; left time: 11353.1371s
	iters: 300, epoch: 1 | loss: 0.7104132
	speed: 0.2863s/iter; left time: 11737.9799s
	iters: 400, epoch: 1 | loss: 0.2479694
	speed: 0.2943s/iter; left time: 12037.5226s
Epoch: 1 cost time: 120.4722843170166
Epoch: 1, Steps: 413 | Train Loss: 1.053 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
Validation loss decreased (inf --> -0.966802).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1873276
	speed: 0.5981s/iter; left time: 24393.7749s
	iters: 200, epoch: 2 | loss: 0.1718692
	speed: 0.3062s/iter; left time: 12459.5875s
	iters: 300, epoch: 2 | loss: 0.6999565
	speed: 0.3036s/iter; left time: 12320.9130s
	iters: 400, epoch: 2 | loss: 0.1238030
	speed: 0.2962s/iter; left time: 11992.4510s
Epoch: 2 cost time: 124.61969900131226
Epoch: 2, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.103 Vali Acc: 0.966 Test Loss: 0.103 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0165087
	speed: 0.5968s/iter; left time: 24096.6047s
	iters: 200, epoch: 3 | loss: 0.0357027
	speed: 0.2972s/iter; left time: 11968.7618s
	iters: 300, epoch: 3 | loss: 0.0196777
	speed: 0.2957s/iter; left time: 11879.8160s
	iters: 400, epoch: 3 | loss: 0.0259651
	speed: 0.2962s/iter; left time: 11871.2315s
Epoch: 3 cost time: 123.76551508903503
Epoch: 3, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.078 Vali Acc: 0.975 Test Loss: 0.078 Test Acc: 0.975
Validation loss decreased (-0.966802 --> -0.975443).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2356156
	speed: 0.6162s/iter; left time: 24624.1684s
	iters: 200, epoch: 4 | loss: 0.0230197
	speed: 0.3010s/iter; left time: 11999.9815s
	iters: 300, epoch: 4 | loss: 0.1461358
	speed: 0.3074s/iter; left time: 12221.9925s
	iters: 400, epoch: 4 | loss: 0.0420654
	speed: 0.3031s/iter; left time: 12020.8869s
Epoch: 4 cost time: 126.4903199672699
Epoch: 4, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.975443 --> -0.979990).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0026105
	speed: 0.5964s/iter; left time: 23585.8040s
	iters: 200, epoch: 5 | loss: 0.0344922
	speed: 0.3162s/iter; left time: 12473.9320s
	iters: 300, epoch: 5 | loss: 0.0610521
	speed: 0.2888s/iter; left time: 11365.3632s
	iters: 400, epoch: 5 | loss: 0.0017046
	speed: 0.3142s/iter; left time: 12333.3259s
Epoch: 5 cost time: 126.76253986358643
Epoch: 5, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.096 Vali Acc: 0.965 Test Loss: 0.096 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0055728
	speed: 0.6060s/iter; left time: 23715.7273s
	iters: 200, epoch: 6 | loss: 0.0005898
	speed: 0.2957s/iter; left time: 11542.2104s
	iters: 300, epoch: 6 | loss: 0.2305526
	speed: 0.2951s/iter; left time: 11490.3653s
	iters: 400, epoch: 6 | loss: 0.0004475
	speed: 0.3054s/iter; left time: 11861.0338s
Epoch: 6 cost time: 123.29263877868652
Epoch: 6, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.119 Vali Acc: 0.972 Test Loss: 0.119 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0001095
	speed: 0.6117s/iter; left time: 23687.0403s
	iters: 200, epoch: 7 | loss: 0.0247781
	speed: 0.3051s/iter; left time: 11784.9658s
	iters: 300, epoch: 7 | loss: 0.0015489
	speed: 0.3067s/iter; left time: 11813.3617s
	iters: 400, epoch: 7 | loss: 0.0026225
	speed: 0.3026s/iter; left time: 11626.1422s
Epoch: 7 cost time: 126.41290426254272
Epoch: 7, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.088 Vali Acc: 0.974 Test Loss: 0.088 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0010379
	speed: 0.5971s/iter; left time: 22874.7731s
	iters: 200, epoch: 8 | loss: 0.0059475
	speed: 0.2987s/iter; left time: 11412.5741s
	iters: 300, epoch: 8 | loss: 0.0045187
	speed: 0.2948s/iter; left time: 11235.3159s
	iters: 400, epoch: 8 | loss: 0.0004053
	speed: 0.2902s/iter; left time: 11029.1308s
Epoch: 8 cost time: 121.7880871295929
Epoch: 8, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0136834
	speed: 0.5837s/iter; left time: 22119.9932s
	iters: 200, epoch: 9 | loss: 0.0664302
	speed: 0.2971s/iter; left time: 11228.4471s
	iters: 300, epoch: 9 | loss: 0.0025551
	speed: 0.3122s/iter; left time: 11767.1466s
	iters: 400, epoch: 9 | loss: 0.0655170
	speed: 0.3047s/iter; left time: 11454.0388s
Epoch: 9 cost time: 125.80348658561707
Epoch: 9, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0001721
	speed: 0.6129s/iter; left time: 22974.8814s
	iters: 200, epoch: 10 | loss: 0.0000725
	speed: 0.3011s/iter; left time: 11255.3588s
	iters: 300, epoch: 10 | loss: 0.0151852
	speed: 0.2902s/iter; left time: 10818.8162s
	iters: 400, epoch: 10 | loss: 0.0100001
	speed: 0.2854s/iter; left time: 10610.5528s
Epoch: 10 cost time: 122.49447107315063
Epoch: 10, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.127 Vali Acc: 0.964 Test Loss: 0.127 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0002219
	speed: 0.6224s/iter; left time: 23072.6181s
	iters: 200, epoch: 11 | loss: 0.0001901
	speed: 0.3130s/iter; left time: 11570.2335s
	iters: 300, epoch: 11 | loss: 0.0002098
	speed: 0.3020s/iter; left time: 11134.0515s
	iters: 400, epoch: 11 | loss: 0.0001283
	speed: 0.2970s/iter; left time: 10920.5288s
Epoch: 11 cost time: 126.46161079406738
Epoch: 11, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0000590
	speed: 0.5903s/iter; left time: 21639.6752s
	iters: 200, epoch: 12 | loss: 0.0076683
	speed: 0.2945s/iter; left time: 10765.1889s
	iters: 300, epoch: 12 | loss: 0.0043351
	speed: 0.3007s/iter; left time: 10963.4673s
	iters: 400, epoch: 12 | loss: 0.0413271
	speed: 0.3051s/iter; left time: 11093.6169s
Epoch: 12 cost time: 124.78361892700195
Epoch: 12, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.186 Vali Acc: 0.960 Test Loss: 0.186 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0388982
	speed: 0.6281s/iter; left time: 22766.2638s
	iters: 200, epoch: 13 | loss: 0.0018936
	speed: 0.2982s/iter; left time: 10777.4127s
	iters: 300, epoch: 13 | loss: 0.0015423
	speed: 0.3200s/iter; left time: 11534.8489s
	iters: 400, epoch: 13 | loss: 0.0012282
	speed: 0.2941s/iter; left time: 10570.3683s
Epoch: 13 cost time: 126.54216814041138
Epoch: 13, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000142
	speed: 0.5961s/iter; left time: 21358.5316s
	iters: 200, epoch: 14 | loss: 0.0000291
	speed: 0.2976s/iter; left time: 10634.5829s
	iters: 300, epoch: 14 | loss: 0.0000032
	speed: 0.3086s/iter; left time: 10995.2914s
	iters: 400, epoch: 14 | loss: 0.0113133
	speed: 0.3051s/iter; left time: 10840.2484s
Epoch: 14 cost time: 125.6401698589325
Epoch: 14, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.134 Vali Acc: 0.976 Test Loss: 0.134 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9799909049567985
model parameter : 603786
model size : 4.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.3002417
	speed: 0.3036s/iter; left time: 12506.7469s
	iters: 200, epoch: 1 | loss: 2.3023872
	speed: 0.2804s/iter; left time: 11523.1121s
	iters: 300, epoch: 1 | loss: 2.3041914
	speed: 0.2752s/iter; left time: 11282.4871s
	iters: 400, epoch: 1 | loss: 2.3029959
	speed: 0.2765s/iter; left time: 11308.9159s
Epoch: 1 cost time: 117.5822024345398
Epoch: 1, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (inf --> -0.100022).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3013952
	speed: 0.5773s/iter; left time: 23547.4579s
	iters: 200, epoch: 2 | loss: 2.3053575
	speed: 0.2957s/iter; left time: 12033.3681s
	iters: 300, epoch: 2 | loss: 2.3031831
	speed: 0.2933s/iter; left time: 11904.9124s
	iters: 400, epoch: 2 | loss: 2.3039844
	speed: 0.2846s/iter; left time: 11521.9032s
Epoch: 2 cost time: 120.09194707870483
Epoch: 2, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.3022170
	speed: 0.5697s/iter; left time: 23003.5160s
	iters: 200, epoch: 3 | loss: 2.3038080
	speed: 0.3085s/iter; left time: 12426.6062s
	iters: 300, epoch: 3 | loss: 2.3035178
	speed: 0.3038s/iter; left time: 12205.0104s
	iters: 400, epoch: 3 | loss: 2.3018720
	speed: 0.2972s/iter; left time: 11911.6971s
Epoch: 3 cost time: 123.96312141418457
Epoch: 3, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 2.3004920
	speed: 0.6090s/iter; left time: 24336.4867s
	iters: 200, epoch: 4 | loss: 2.3034248
	speed: 0.3083s/iter; left time: 12291.0560s
	iters: 300, epoch: 4 | loss: 2.3025706
	speed: 0.2922s/iter; left time: 11617.7401s
	iters: 400, epoch: 4 | loss: 2.3028984
	speed: 0.3059s/iter; left time: 12133.6685s
Epoch: 4 cost time: 125.29933738708496
Epoch: 4, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 2.3035371
	speed: 0.6042s/iter; left time: 23895.2704s
	iters: 200, epoch: 5 | loss: 2.3045709
	speed: 0.2935s/iter; left time: 11578.2296s
	iters: 300, epoch: 5 | loss: 2.3014116
	speed: 0.2839s/iter; left time: 11169.9237s
	iters: 400, epoch: 5 | loss: 2.3032441
	speed: 0.2913s/iter; left time: 11434.2863s
Epoch: 5 cost time: 120.39198541641235
Epoch: 5, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.3025277
	speed: 0.5948s/iter; left time: 23278.0042s
	iters: 200, epoch: 6 | loss: 2.3035011
	speed: 0.3094s/iter; left time: 12076.9049s
	iters: 300, epoch: 6 | loss: 2.3022537
	speed: 0.3058s/iter; left time: 11906.1783s
	iters: 400, epoch: 6 | loss: 2.3035207
	speed: 0.3153s/iter; left time: 12246.0452s
Epoch: 6 cost time: 126.98666071891785
Epoch: 6, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.3037691
	speed: 0.5921s/iter; left time: 22927.2783s
	iters: 200, epoch: 7 | loss: 2.3019345
	speed: 0.2927s/iter; left time: 11306.2418s
	iters: 300, epoch: 7 | loss: 2.3035429
	speed: 0.3124s/iter; left time: 12034.7648s
	iters: 400, epoch: 7 | loss: 2.3019598
	speed: 0.2997s/iter; left time: 11514.8816s
Epoch: 7 cost time: 123.67223119735718
Epoch: 7, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.3031893
	speed: 0.5886s/iter; left time: 22551.0224s
	iters: 200, epoch: 8 | loss: 2.3027174
	speed: 0.2810s/iter; left time: 10738.0731s
	iters: 300, epoch: 8 | loss: 2.3034928
	speed: 0.2986s/iter; left time: 11380.1478s
	iters: 400, epoch: 8 | loss: 2.3044660
	speed: 0.2830s/iter; left time: 10755.6342s
Epoch: 8 cost time: 117.89098930358887
Epoch: 8, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.2995427
	speed: 0.5975s/iter; left time: 22642.4018s
	iters: 200, epoch: 9 | loss: 2.3033891
	speed: 0.2949s/iter; left time: 11145.5272s
	iters: 300, epoch: 9 | loss: 2.3023577
	speed: 0.2979s/iter; left time: 11228.7402s
	iters: 400, epoch: 9 | loss: 2.3042636
	speed: 0.2817s/iter; left time: 10589.7064s
Epoch: 9 cost time: 121.83618092536926
Epoch: 9, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.3026989
	speed: 0.5566s/iter; left time: 20861.8578s
	iters: 200, epoch: 10 | loss: 2.3099923
	speed: 0.2716s/iter; left time: 10152.5283s
	iters: 300, epoch: 10 | loss: 2.3022339
	speed: 0.2904s/iter; left time: 10828.6274s
	iters: 400, epoch: 10 | loss: 2.3018780
	speed: 0.2890s/iter; left time: 10747.6234s
Epoch: 10 cost time: 117.03777074813843
Epoch: 10, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 2.3015885
	speed: 0.6209s/iter; left time: 23017.7339s
	iters: 200, epoch: 11 | loss: 2.3019919
	speed: 0.2969s/iter; left time: 10975.7612s
	iters: 300, epoch: 11 | loss: 2.3039460
	speed: 0.2973s/iter; left time: 10963.2781s
	iters: 400, epoch: 11 | loss: 2.3033845
	speed: 0.2739s/iter; left time: 10071.7240s
Epoch: 11 cost time: 121.54581212997437
Epoch: 11, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 2.3053477
	speed: 0.5754s/iter; left time: 21091.8803s
	iters: 200, epoch: 12 | loss: 2.3036916
	speed: 0.2842s/iter; left time: 10390.9263s
	iters: 300, epoch: 12 | loss: 2.3018432
	speed: 0.2876s/iter; left time: 10484.5437s
	iters: 400, epoch: 12 | loss: 2.3036146
	speed: 0.3068s/iter; left time: 11153.0758s
Epoch: 12 cost time: 121.04731869697571
Epoch: 12, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 2.3050539
	speed: 0.6142s/iter; left time: 22262.7228s
	iters: 200, epoch: 13 | loss: 2.3020496
	speed: 0.2829s/iter; left time: 10223.9626s
	iters: 300, epoch: 13 | loss: 2.3036001
	speed: 0.2812s/iter; left time: 10136.3526s
	iters: 400, epoch: 13 | loss: 2.3024969
	speed: 0.2961s/iter; left time: 10641.7750s
Epoch: 13 cost time: 121.21169066429138
Epoch: 13, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.3031080
	speed: 0.5786s/iter; left time: 20733.3456s
	iters: 200, epoch: 14 | loss: 2.2984772
	speed: 0.2852s/iter; left time: 10191.8510s
	iters: 300, epoch: 14 | loss: 2.3056550
	speed: 0.2857s/iter; left time: 10181.3559s
	iters: 400, epoch: 14 | loss: 2.3026474
	speed: 0.2975s/iter; left time: 10569.8436s
Epoch: 14 cost time: 119.87455558776855
Epoch: 14, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.3034508
	speed: 0.6469s/iter; left time: 22911.1864s
	iters: 200, epoch: 15 | loss: 2.3033278
	speed: 0.3344s/iter; left time: 11809.9931s
	iters: 300, epoch: 15 | loss: 2.3008108
	speed: 0.3476s/iter; left time: 12241.5036s
	iters: 400, epoch: 15 | loss: 2.3025453
	speed: 0.3131s/iter; left time: 10996.9966s
Epoch: 15 cost time: 136.12696266174316
Epoch: 15, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 2.3016374
	speed: 0.6158s/iter; left time: 21554.9914s
	iters: 200, epoch: 16 | loss: 2.3011689
	speed: 0.3144s/iter; left time: 10974.4996s
	iters: 300, epoch: 16 | loss: 2.3019536
	speed: 0.3155s/iter; left time: 10980.8880s
	iters: 400, epoch: 16 | loss: 2.3035433
	speed: 0.3063s/iter; left time: 10631.3041s
Epoch: 16 cost time: 128.37220644950867
Epoch: 16, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 2.3029063
	speed: 0.6805s/iter; left time: 23540.6552s
	iters: 200, epoch: 17 | loss: 2.3017020
	speed: 0.3419s/iter; left time: 11793.3978s
	iters: 300, epoch: 17 | loss: 2.3008509
	speed: 0.3219s/iter; left time: 11069.6903s
	iters: 400, epoch: 17 | loss: 2.3043838
	speed: 0.3174s/iter; left time: 10884.1565s
Epoch: 17 cost time: 136.46389985084534
Epoch: 17, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 2.3069420
	speed: 0.6342s/iter; left time: 21675.5657s
	iters: 200, epoch: 18 | loss: 2.3026597
	speed: 0.3081s/iter; left time: 10498.8408s
	iters: 300, epoch: 18 | loss: 2.3035228
	speed: 0.3077s/iter; left time: 10455.0215s
	iters: 400, epoch: 18 | loss: 2.3053198
	speed: 0.3129s/iter; left time: 10600.4065s
Epoch: 18 cost time: 128.01782083511353
Epoch: 18, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 2.3022871
	speed: 0.6582s/iter; left time: 22224.4141s
	iters: 200, epoch: 19 | loss: 2.2966692
	speed: 0.3283s/iter; left time: 11053.3855s
	iters: 300, epoch: 19 | loss: 2.2998979
	speed: 0.3190s/iter; left time: 10708.4451s
	iters: 400, epoch: 19 | loss: 2.3024330
	speed: 0.3001s/iter; left time: 10043.0127s
Epoch: 19 cost time: 131.54641771316528
Epoch: 19, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 2.3028562
	speed: 0.6268s/iter; left time: 20904.9365s
	iters: 200, epoch: 20 | loss: 2.3027074
	speed: 0.3080s/iter; left time: 10242.4019s
	iters: 300, epoch: 20 | loss: 2.3048849
	speed: 0.3242s/iter; left time: 10749.3354s
	iters: 400, epoch: 20 | loss: 2.3019371
	speed: 0.3254s/iter; left time: 10754.5267s
Epoch: 20 cost time: 130.6282398700714
Epoch: 20, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 2.3023560
	speed: 0.6531s/iter; left time: 21512.4235s
	iters: 200, epoch: 21 | loss: 2.3075798
	speed: 0.3131s/iter; left time: 10283.4424s
	iters: 300, epoch: 21 | loss: 2.3021181
	speed: 0.3299s/iter; left time: 10802.1118s
	iters: 400, epoch: 21 | loss: 2.3031132
	speed: 0.3201s/iter; left time: 10449.5012s
Epoch: 21 cost time: 132.8623399734497
Epoch: 21, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 2.2996280
	speed: 0.6395s/iter; left time: 20800.8927s
	iters: 200, epoch: 22 | loss: 2.2985942
	speed: 0.3071s/iter; left time: 9957.7846s
	iters: 300, epoch: 22 | loss: 2.3043156
	speed: 0.3129s/iter; left time: 10116.4622s
	iters: 400, epoch: 22 | loss: 2.3040361
	speed: 0.3019s/iter; left time: 9730.0576s
Epoch: 22 cost time: 127.56424069404602
Epoch: 22, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 2.3016691
	speed: 0.6286s/iter; left time: 20187.8178s
	iters: 200, epoch: 23 | loss: 2.3023322
	speed: 0.3002s/iter; left time: 9611.1970s
	iters: 300, epoch: 23 | loss: 2.3012183
	speed: 0.3077s/iter; left time: 9818.9360s
	iters: 400, epoch: 23 | loss: 2.3028872
	speed: 0.3133s/iter; left time: 9967.4467s
Epoch: 23 cost time: 126.84558129310608
Epoch: 23, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.10004547521600728
model parameter : 603786
model size : 4.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         47                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df512_ma47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0301318
	speed: 0.3302s/iter; left time: 13604.8802s
	iters: 200, epoch: 1 | loss: 0.1207823
	speed: 0.3114s/iter; left time: 12799.8225s
	iters: 300, epoch: 1 | loss: 0.3972673
	speed: 0.3020s/iter; left time: 12381.3897s
	iters: 400, epoch: 1 | loss: 0.1486913
	speed: 0.2927s/iter; left time: 11970.9907s
Epoch: 1 cost time: 127.88649702072144
Epoch: 1, Steps: 413 | Train Loss: 0.626 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
Validation loss decreased (inf --> -0.974078).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0184042
	speed: 0.6118s/iter; left time: 24955.1971s
	iters: 200, epoch: 2 | loss: 0.0190672
	speed: 0.3025s/iter; left time: 12306.2062s
	iters: 300, epoch: 2 | loss: 0.1201084
	speed: 0.3151s/iter; left time: 12787.6699s
	iters: 400, epoch: 2 | loss: 0.0095762
	speed: 0.3247s/iter; left time: 13145.1926s
Epoch: 2 cost time: 128.15797448158264
Epoch: 2, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.051 Vali Acc: 0.982 Test Loss: 0.051 Test Acc: 0.982
Validation loss decreased (-0.974078 --> -0.982264).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0217609
	speed: 0.6708s/iter; left time: 27082.5205s
	iters: 200, epoch: 3 | loss: 0.0323711
	speed: 0.2956s/iter; left time: 11905.7968s
	iters: 300, epoch: 3 | loss: 0.0083427
	speed: 0.2899s/iter; left time: 11645.8847s
	iters: 400, epoch: 3 | loss: 0.0113423
	speed: 0.2975s/iter; left time: 11924.1537s
Epoch: 3 cost time: 124.63601088523865
Epoch: 3, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.050 Vali Acc: 0.987 Test Loss: 0.050 Test Acc: 0.987
Validation loss decreased (-0.982264 --> -0.986812).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0158357
	speed: 0.6387s/iter; left time: 25524.2482s
	iters: 200, epoch: 4 | loss: 0.0447082
	speed: 0.3192s/iter; left time: 12725.7718s
	iters: 300, epoch: 4 | loss: 0.0296937
	speed: 0.3306s/iter; left time: 13144.5719s
	iters: 400, epoch: 4 | loss: 0.0175664
	speed: 0.3078s/iter; left time: 12207.9462s
Epoch: 4 cost time: 131.1565968990326
Epoch: 4, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.030 Vali Acc: 0.989 Test Loss: 0.030 Test Acc: 0.989
Validation loss decreased (-0.986812 --> -0.989086).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0044213
	speed: 0.6475s/iter; left time: 25609.2332s
	iters: 200, epoch: 5 | loss: 0.0025775
	speed: 0.3105s/iter; left time: 12249.1851s
	iters: 300, epoch: 5 | loss: 0.0180550
	speed: 0.3082s/iter; left time: 12125.6685s
	iters: 400, epoch: 5 | loss: 0.0005397
	speed: 0.3023s/iter; left time: 11866.9000s
Epoch: 5 cost time: 127.57731485366821
Epoch: 5, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.042 Vali Acc: 0.986 Test Loss: 0.042 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0010272
	speed: 0.6324s/iter; left time: 24747.9692s
	iters: 200, epoch: 6 | loss: 0.1663701
	speed: 0.3131s/iter; left time: 12222.8475s
	iters: 300, epoch: 6 | loss: 0.0895837
	speed: 0.3102s/iter; left time: 12078.8944s
	iters: 400, epoch: 6 | loss: 0.3200247
	speed: 0.3206s/iter; left time: 12449.1733s
Epoch: 6 cost time: 129.8620765209198
Epoch: 6, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0019500
	speed: 0.6189s/iter; left time: 23964.1335s
	iters: 200, epoch: 7 | loss: 0.0081768
	speed: 0.2983s/iter; left time: 11521.3547s
	iters: 300, epoch: 7 | loss: 0.1040329
	speed: 0.2999s/iter; left time: 11554.5180s
	iters: 400, epoch: 7 | loss: 0.0228390
	speed: 0.3111s/iter; left time: 11953.8563s
Epoch: 7 cost time: 125.36905527114868
Epoch: 7, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0047943
	speed: 0.6573s/iter; left time: 25182.1264s
	iters: 200, epoch: 8 | loss: 0.0004778
	speed: 0.3078s/iter; left time: 11762.6249s
	iters: 300, epoch: 8 | loss: 0.0005207
	speed: 0.2987s/iter; left time: 11384.3668s
	iters: 400, epoch: 8 | loss: 0.0427655
	speed: 0.2958s/iter; left time: 11244.5614s
Epoch: 8 cost time: 125.60778713226318
Epoch: 8, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.047 Vali Acc: 0.986 Test Loss: 0.047 Test Acc: 0.986
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0036387
	speed: 0.6334s/iter; left time: 24004.6940s
	iters: 200, epoch: 9 | loss: 0.0196190
	speed: 0.3212s/iter; left time: 12142.0083s
	iters: 300, epoch: 9 | loss: 0.0708913
	speed: 0.3219s/iter; left time: 12135.5666s
	iters: 400, epoch: 9 | loss: 0.0079518
	speed: 0.3143s/iter; left time: 11818.2428s
Epoch: 9 cost time: 130.23895239830017
Epoch: 9, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0023407
	speed: 0.6187s/iter; left time: 23189.9816s
	iters: 200, epoch: 10 | loss: 0.0013526
	speed: 0.3133s/iter; left time: 11713.1796s
	iters: 300, epoch: 10 | loss: 0.0018336
	speed: 0.3064s/iter; left time: 11425.1925s
	iters: 400, epoch: 10 | loss: 0.0003084
	speed: 0.2985s/iter; left time: 11098.5876s
Epoch: 10 cost time: 126.30712962150574
Epoch: 10, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000134
	speed: 0.6562s/iter; left time: 24325.4226s
	iters: 200, epoch: 11 | loss: 0.0000346
	speed: 0.3015s/iter; left time: 11148.0734s
	iters: 300, epoch: 11 | loss: 0.0121071
	speed: 0.3026s/iter; left time: 11158.3166s
	iters: 400, epoch: 11 | loss: 0.0001210
	speed: 0.3126s/iter; left time: 11494.2024s
Epoch: 11 cost time: 127.21972441673279
Epoch: 11, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.088 Vali Acc: 0.975 Test Loss: 0.088 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0004633
	speed: 0.6566s/iter; left time: 24070.6368s
	iters: 200, epoch: 12 | loss: 0.0001185
	speed: 0.3165s/iter; left time: 11570.1454s
	iters: 300, epoch: 12 | loss: 0.0000091
	speed: 0.3216s/iter; left time: 11726.1938s
	iters: 400, epoch: 12 | loss: 0.0000106
	speed: 0.3313s/iter; left time: 12045.3199s
Epoch: 12 cost time: 133.48099398612976
Epoch: 12, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0000137
	speed: 0.6725s/iter; left time: 24375.4633s
	iters: 200, epoch: 13 | loss: 0.0008327
	speed: 0.3163s/iter; left time: 11431.0195s
	iters: 300, epoch: 13 | loss: 0.0001420
	speed: 0.2950s/iter; left time: 10634.5537s
	iters: 400, epoch: 13 | loss: 0.0622420
	speed: 0.2776s/iter; left time: 9978.4502s
Epoch: 13 cost time: 125.62976551055908
Epoch: 13, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.067 Vali Acc: 0.985 Test Loss: 0.067 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000216
	speed: 0.6388s/iter; left time: 22890.1729s
	iters: 200, epoch: 14 | loss: 0.2554663
	speed: 0.3206s/iter; left time: 11454.6929s
	iters: 300, epoch: 14 | loss: 0.0001073
	speed: 0.3203s/iter; left time: 11413.0670s
	iters: 400, epoch: 14 | loss: 0.0000015
	speed: 0.3054s/iter; left time: 10850.1379s
Epoch: 14 cost time: 130.48092222213745
Epoch: 14, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.063 Vali Acc: 0.982 Test Loss: 0.063 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df512_ma47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9890859481582538
model parameter : 407178
model size : 4.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         38                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df512_ma38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0983117
	speed: 0.3216s/iter; left time: 13250.5100s
	iters: 200, epoch: 1 | loss: 0.1611587
	speed: 0.3031s/iter; left time: 12459.0032s
	iters: 300, epoch: 1 | loss: 0.4064384
	speed: 0.3007s/iter; left time: 12329.2995s
	iters: 400, epoch: 1 | loss: 0.1794479
	speed: 0.3043s/iter; left time: 12444.6756s
Epoch: 1 cost time: 127.32731556892395
Epoch: 1, Steps: 413 | Train Loss: 0.662 Vali Loss: 0.097 Vali Acc: 0.972 Test Loss: 0.097 Test Acc: 0.972
Validation loss decreased (inf --> -0.972259).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0204096
	speed: 0.6487s/iter; left time: 26457.1498s
	iters: 200, epoch: 2 | loss: 0.0293339
	speed: 0.3115s/iter; left time: 12674.0880s
	iters: 300, epoch: 2 | loss: 0.1023837
	speed: 0.3279s/iter; left time: 13310.0536s
	iters: 400, epoch: 2 | loss: 0.0080538
	speed: 0.2935s/iter; left time: 11883.5643s
Epoch: 2 cost time: 129.04326128959656
Epoch: 2, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.057 Vali Acc: 0.983 Test Loss: 0.057 Test Acc: 0.983
Validation loss decreased (-0.972259 --> -0.983174).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0463797
	speed: 0.6243s/iter; left time: 25205.0434s
	iters: 200, epoch: 3 | loss: 0.0137004
	speed: 0.3114s/iter; left time: 12542.1926s
	iters: 300, epoch: 3 | loss: 0.0082869
	speed: 0.3164s/iter; left time: 12711.3181s
	iters: 400, epoch: 3 | loss: 0.0567407
	speed: 0.3061s/iter; left time: 12267.1329s
Epoch: 3 cost time: 127.28038287162781
Epoch: 3, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.049 Vali Acc: 0.983 Test Loss: 0.049 Test Acc: 0.983
Validation loss decreased (-0.983174 --> -0.983174).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0559104
	speed: 0.6358s/iter; left time: 25405.8513s
	iters: 200, epoch: 4 | loss: 0.0141930
	speed: 0.3061s/iter; left time: 12202.6821s
	iters: 300, epoch: 4 | loss: 0.0013679
	speed: 0.3013s/iter; left time: 11978.8755s
	iters: 400, epoch: 4 | loss: 0.0016800
	speed: 0.3051s/iter; left time: 12102.2373s
Epoch: 4 cost time: 127.32171487808228
Epoch: 4, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.041 Vali Acc: 0.984 Test Loss: 0.041 Test Acc: 0.984
Validation loss decreased (-0.983174 --> -0.984083).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0080208
	speed: 0.6438s/iter; left time: 25460.9877s
	iters: 200, epoch: 5 | loss: 0.0041118
	speed: 0.3159s/iter; left time: 12460.4128s
	iters: 300, epoch: 5 | loss: 0.0201205
	speed: 0.3260s/iter; left time: 12827.8849s
	iters: 400, epoch: 5 | loss: 0.0016640
	speed: 0.3124s/iter; left time: 12263.1251s
Epoch: 5 cost time: 131.15357065200806
Epoch: 5, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.040 Vali Acc: 0.984 Test Loss: 0.040 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.1952418
	speed: 0.6405s/iter; left time: 25066.5815s
	iters: 200, epoch: 6 | loss: 0.0087327
	speed: 0.3095s/iter; left time: 12083.2665s
	iters: 300, epoch: 6 | loss: 0.3329813
	speed: 0.3072s/iter; left time: 11959.5230s
	iters: 400, epoch: 6 | loss: 0.0013559
	speed: 0.3158s/iter; left time: 12262.7438s
Epoch: 6 cost time: 129.56895923614502
Epoch: 6, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0055062
	speed: 0.6393s/iter; left time: 24755.3795s
	iters: 200, epoch: 7 | loss: 0.0015451
	speed: 0.3301s/iter; left time: 12749.6162s
	iters: 300, epoch: 7 | loss: 0.0061615
	speed: 0.3240s/iter; left time: 12480.6780s
	iters: 400, epoch: 7 | loss: 0.0054694
	speed: 0.3101s/iter; left time: 11913.4059s
Epoch: 7 cost time: 132.32224893569946
Epoch: 7, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.031 Vali Acc: 0.988 Test Loss: 0.031 Test Acc: 0.988
Validation loss decreased (-0.984083 --> -0.988176).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000371
	speed: 0.6340s/iter; left time: 24289.9540s
	iters: 200, epoch: 8 | loss: 0.0006460
	speed: 0.3066s/iter; left time: 11715.9317s
	iters: 300, epoch: 8 | loss: 0.0001492
	speed: 0.3116s/iter; left time: 11873.9603s
	iters: 400, epoch: 8 | loss: 0.0033701
	speed: 0.3262s/iter; left time: 12397.3454s
Epoch: 8 cost time: 129.4696249961853
Epoch: 8, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.025 Vali Acc: 0.992 Test Loss: 0.025 Test Acc: 0.992
Validation loss decreased (-0.988176 --> -0.992269).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000162
	speed: 0.6851s/iter; left time: 25963.0610s
	iters: 200, epoch: 9 | loss: 0.0005085
	speed: 0.3248s/iter; left time: 12276.5508s
	iters: 300, epoch: 9 | loss: 0.0002938
	speed: 0.3363s/iter; left time: 12676.7137s
	iters: 400, epoch: 9 | loss: 0.0024132
	speed: 0.3327s/iter; left time: 12509.6192s
Epoch: 9 cost time: 137.89179849624634
Epoch: 9, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0307127
	speed: 0.7052s/iter; left time: 26434.6879s
	iters: 200, epoch: 10 | loss: 0.0061619
	speed: 0.3328s/iter; left time: 12439.5895s
	iters: 300, epoch: 10 | loss: 0.0214310
	speed: 0.3433s/iter; left time: 12799.3510s
	iters: 400, epoch: 10 | loss: 0.0026519
	speed: 0.3353s/iter; left time: 12466.2424s
Epoch: 10 cost time: 140.46453857421875
Epoch: 10, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.081 Vali Acc: 0.975 Test Loss: 0.081 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0003681
	speed: 0.7451s/iter; left time: 27622.7832s
	iters: 200, epoch: 11 | loss: 0.0001891
	speed: 0.3528s/iter; left time: 13043.4254s
	iters: 300, epoch: 11 | loss: 0.0008588
	speed: 0.3673s/iter; left time: 13541.8806s
	iters: 400, epoch: 11 | loss: 0.0095244
	speed: 0.3637s/iter; left time: 13375.1104s
Epoch: 11 cost time: 149.12402081489563
Epoch: 11, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.043 Vali Acc: 0.989 Test Loss: 0.043 Test Acc: 0.989
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0001889
	speed: 0.7104s/iter; left time: 26040.4464s
	iters: 200, epoch: 12 | loss: 0.0003934
	speed: 0.3419s/iter; left time: 12497.4116s
	iters: 300, epoch: 12 | loss: 0.0000027
	speed: 0.3683s/iter; left time: 13426.8146s
	iters: 400, epoch: 12 | loss: 0.0082322
	speed: 0.3444s/iter; left time: 12522.0411s
Epoch: 12 cost time: 145.51681518554688
Epoch: 12, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.037 Vali Acc: 0.988 Test Loss: 0.037 Test Acc: 0.988
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000016
	speed: 0.7004s/iter; left time: 25384.7635s
	iters: 200, epoch: 13 | loss: 0.2030123
	speed: 0.3479s/iter; left time: 12575.5630s
	iters: 300, epoch: 13 | loss: 0.0006004
	speed: 0.3327s/iter; left time: 11990.6993s
	iters: 400, epoch: 13 | loss: 0.0001999
	speed: 0.3364s/iter; left time: 12091.5563s
Epoch: 13 cost time: 139.9747884273529
Epoch: 13, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.036 Vali Acc: 0.989 Test Loss: 0.036 Test Acc: 0.989
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0024603
	speed: 0.7545s/iter; left time: 27035.4123s
	iters: 200, epoch: 14 | loss: 0.0145494
	speed: 0.3494s/iter; left time: 12485.7182s
	iters: 300, epoch: 14 | loss: 0.0000528
	speed: 0.3348s/iter; left time: 11930.2635s
	iters: 400, epoch: 14 | loss: 0.0000031
	speed: 0.3275s/iter; left time: 11638.0172s
Epoch: 14 cost time: 142.92643904685974
Epoch: 14, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.112 Vali Acc: 0.978 Test Loss: 0.112 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000171
	speed: 0.6802s/iter; left time: 24091.0990s
	iters: 200, epoch: 15 | loss: 0.0005350
	speed: 0.3314s/iter; left time: 11705.9132s
	iters: 300, epoch: 15 | loss: 0.0905811
	speed: 0.3353s/iter; left time: 11809.5621s
	iters: 400, epoch: 15 | loss: 0.0000326
	speed: 0.3313s/iter; left time: 11634.0176s
Epoch: 15 cost time: 137.01231861114502
Epoch: 15, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0000105
	speed: 0.6847s/iter; left time: 23967.9927s
	iters: 200, epoch: 16 | loss: 0.0000748
	speed: 0.3578s/iter; left time: 12487.8790s
	iters: 300, epoch: 16 | loss: 0.0000003
	speed: 0.3624s/iter; left time: 12613.0493s
	iters: 400, epoch: 16 | loss: 0.0000095
	speed: 0.3733s/iter; left time: 12957.3401s
Epoch: 16 cost time: 147.9336175918579
Epoch: 16, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0000003
	speed: 0.7071s/iter; left time: 24460.6931s
	iters: 200, epoch: 17 | loss: 0.0000112
	speed: 0.3363s/iter; left time: 11600.6476s
	iters: 300, epoch: 17 | loss: 0.0032753
	speed: 0.3468s/iter; left time: 11927.8804s
	iters: 400, epoch: 17 | loss: 0.0054076
	speed: 0.3345s/iter; left time: 11470.4481s
Epoch: 17 cost time: 139.22033882141113
Epoch: 17, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0005488
	speed: 0.6756s/iter; left time: 23091.8949s
	iters: 200, epoch: 18 | loss: 0.0014740
	speed: 0.3269s/iter; left time: 11139.7615s
	iters: 300, epoch: 18 | loss: 0.0004251
	speed: 0.3322s/iter; left time: 11286.6783s
	iters: 400, epoch: 18 | loss: 0.0004140
	speed: 0.3518s/iter; left time: 11919.4970s
Epoch: 18 cost time: 139.3931269645691
Epoch: 18, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.064 Vali Acc: 0.986 Test Loss: 0.064 Test Acc: 0.986
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df512_ma38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.992269213278763
model parameter : 407178
model size : 4.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         28                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df512_ma28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.2487276
	speed: 0.3949s/iter; left time: 16270.9214s
	iters: 200, epoch: 1 | loss: 0.2129656
	speed: 0.3343s/iter; left time: 13739.3857s
	iters: 300, epoch: 1 | loss: 0.4386624
	speed: 0.3398s/iter; left time: 13930.9306s
	iters: 400, epoch: 1 | loss: 0.2073224
	speed: 0.3726s/iter; left time: 15239.6553s
Epoch: 1 cost time: 148.79290509223938
Epoch: 1, Steps: 413 | Train Loss: 0.730 Vali Loss: 0.113 Vali Acc: 0.971 Test Loss: 0.113 Test Acc: 0.971
Validation loss decreased (inf --> -0.970895).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0218935
	speed: 0.7150s/iter; left time: 29162.8657s
	iters: 200, epoch: 2 | loss: 0.0161604
	speed: 0.3314s/iter; left time: 13484.1813s
	iters: 300, epoch: 2 | loss: 0.0731579
	speed: 0.3351s/iter; left time: 13601.5193s
	iters: 400, epoch: 2 | loss: 0.0149012
	speed: 0.3450s/iter; left time: 13969.0737s
Epoch: 2 cost time: 140.9977786540985
Epoch: 2, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.061 Vali Acc: 0.980 Test Loss: 0.061 Test Acc: 0.980
Validation loss decreased (-0.970895 --> -0.980445).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0630025
	speed: 0.7405s/iter; left time: 29899.6460s
	iters: 200, epoch: 3 | loss: 0.0665988
	speed: 0.3667s/iter; left time: 14770.4385s
	iters: 300, epoch: 3 | loss: 0.0304051
	speed: 0.3630s/iter; left time: 14584.8473s
	iters: 400, epoch: 3 | loss: 0.0149568
	speed: 0.3484s/iter; left time: 13963.3756s
Epoch: 3 cost time: 149.49021458625793
Epoch: 3, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.061 Vali Acc: 0.978 Test Loss: 0.061 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0050807
	speed: 0.7202s/iter; left time: 28781.1754s
	iters: 200, epoch: 4 | loss: 0.0107945
	speed: 0.3522s/iter; left time: 14041.0107s
	iters: 300, epoch: 4 | loss: 0.0018906
	speed: 0.3345s/iter; left time: 13299.3675s
	iters: 400, epoch: 4 | loss: 0.0026824
	speed: 0.3284s/iter; left time: 13026.3372s
Epoch: 4 cost time: 141.833265542984
Epoch: 4, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.031 Vali Acc: 0.988 Test Loss: 0.031 Test Acc: 0.988
Validation loss decreased (-0.980445 --> -0.988176).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0027210
	speed: 0.6979s/iter; left time: 27599.7530s
	iters: 200, epoch: 5 | loss: 0.0443362
	speed: 0.3522s/iter; left time: 13893.3723s
	iters: 300, epoch: 5 | loss: 0.0686846
	speed: 0.3527s/iter; left time: 13876.5307s
	iters: 400, epoch: 5 | loss: 0.0063987
	speed: 0.3694s/iter; left time: 14497.7207s
Epoch: 5 cost time: 146.06939578056335
Epoch: 5, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0205302
	speed: 0.7196s/iter; left time: 28163.3397s
	iters: 200, epoch: 6 | loss: 0.0033507
	speed: 0.3528s/iter; left time: 13771.6532s
	iters: 300, epoch: 6 | loss: 0.0009264
	speed: 0.3640s/iter; left time: 14174.1210s
	iters: 400, epoch: 6 | loss: 0.0036351
	speed: 0.3627s/iter; left time: 14087.4510s
Epoch: 6 cost time: 147.8862748146057
Epoch: 6, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.041 Vali Acc: 0.986 Test Loss: 0.041 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0006444
	speed: 0.7136s/iter; left time: 27632.5390s
	iters: 200, epoch: 7 | loss: 0.0092672
	speed: 0.3349s/iter; left time: 12936.6200s
	iters: 300, epoch: 7 | loss: 0.0898506
	speed: 0.3527s/iter; left time: 13587.6178s
	iters: 400, epoch: 7 | loss: 0.0078597
	speed: 0.3421s/iter; left time: 13144.2194s
Epoch: 7 cost time: 141.8631467819214
Epoch: 7, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0094203
	speed: 0.7476s/iter; left time: 28642.0233s
	iters: 200, epoch: 8 | loss: 0.0041277
	speed: 0.3577s/iter; left time: 13668.3725s
	iters: 300, epoch: 8 | loss: 0.0011918
	speed: 0.3368s/iter; left time: 12836.0318s
	iters: 400, epoch: 8 | loss: 0.0347552
	speed: 0.3443s/iter; left time: 13086.5282s
Epoch: 8 cost time: 144.75298953056335
Epoch: 8, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.101 Vali Acc: 0.974 Test Loss: 0.101 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0005299
	speed: 0.5925s/iter; left time: 22454.7420s
	iters: 200, epoch: 9 | loss: 0.0603679
	speed: 0.2725s/iter; left time: 10298.8894s
	iters: 300, epoch: 9 | loss: 0.0000522
	speed: 0.2896s/iter; left time: 10916.5243s
	iters: 400, epoch: 9 | loss: 0.0002235
	speed: 0.2988s/iter; left time: 11233.2094s
Epoch: 9 cost time: 120.38576126098633
Epoch: 9, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.059 Vali Acc: 0.981 Test Loss: 0.059 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0082213
	speed: 0.6092s/iter; left time: 22833.4520s
	iters: 200, epoch: 10 | loss: 0.0016857
	speed: 0.2868s/iter; left time: 10723.5738s
	iters: 300, epoch: 10 | loss: 0.0052497
	speed: 0.2859s/iter; left time: 10660.5693s
	iters: 400, epoch: 10 | loss: 0.0000637
	speed: 0.2865s/iter; left time: 10652.9895s
Epoch: 10 cost time: 119.5653121471405
Epoch: 10, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.038 Vali Acc: 0.987 Test Loss: 0.038 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0011073
	speed: 0.6071s/iter; left time: 22504.7916s
	iters: 200, epoch: 11 | loss: 0.0001080
	speed: 0.2948s/iter; left time: 10899.6814s
	iters: 300, epoch: 11 | loss: 0.0000858
	speed: 0.3003s/iter; left time: 11074.1757s
	iters: 400, epoch: 11 | loss: 0.0032168
	speed: 0.3072s/iter; left time: 11296.4663s
Epoch: 11 cost time: 124.89738655090332
Epoch: 11, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.074 Vali Acc: 0.985 Test Loss: 0.074 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0000272
	speed: 0.5819s/iter; left time: 21330.9914s
	iters: 200, epoch: 12 | loss: 0.0000853
	speed: 0.2986s/iter; left time: 10914.9414s
	iters: 300, epoch: 12 | loss: 0.0002132
	speed: 0.3139s/iter; left time: 11442.3678s
	iters: 400, epoch: 12 | loss: 0.0003633
	speed: 0.3114s/iter; left time: 11322.3193s
Epoch: 12 cost time: 125.99450302124023
Epoch: 12, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.139 Vali Acc: 0.969 Test Loss: 0.139 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0002633
	speed: 0.5892s/iter; left time: 21354.8092s
	iters: 200, epoch: 13 | loss: 0.0025222
	speed: 0.2801s/iter; left time: 10124.3950s
	iters: 300, epoch: 13 | loss: 0.0531110
	speed: 0.2866s/iter; left time: 10331.4807s
	iters: 400, epoch: 13 | loss: 0.0012209
	speed: 0.3013s/iter; left time: 10828.7747s
Epoch: 13 cost time: 118.69114184379578
Epoch: 13, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.087 Vali Acc: 0.975 Test Loss: 0.087 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0001383
	speed: 0.6379s/iter; left time: 22856.2028s
	iters: 200, epoch: 14 | loss: 0.0029228
	speed: 0.3063s/iter; left time: 10944.2957s
	iters: 300, epoch: 14 | loss: 0.0000040
	speed: 0.2923s/iter; left time: 10415.6039s
	iters: 400, epoch: 14 | loss: 0.0000143
	speed: 0.2939s/iter; left time: 10441.2377s
Epoch: 14 cost time: 124.66671395301819
Epoch: 14, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df512_ma28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9881764438381082
model parameter : 407178
model size : 4.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df512_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.4857123
	speed: 0.3316s/iter; left time: 13662.5465s
	iters: 200, epoch: 1 | loss: 0.2949959
	speed: 0.3158s/iter; left time: 12979.2492s
	iters: 300, epoch: 1 | loss: 0.5835246
	speed: 0.2998s/iter; left time: 12292.1901s
	iters: 400, epoch: 1 | loss: 0.1896254
	speed: 0.3174s/iter; left time: 12983.7235s
Epoch: 1 cost time: 131.1756362915039
Epoch: 1, Steps: 413 | Train Loss: 0.827 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
Validation loss decreased (inf --> -0.959071).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1022544
	speed: 0.6447s/iter; left time: 26297.8101s
	iters: 200, epoch: 2 | loss: 0.0686480
	speed: 0.3605s/iter; left time: 14666.2286s
	iters: 300, epoch: 2 | loss: 0.1852700
	speed: 0.3488s/iter; left time: 14158.8386s
	iters: 400, epoch: 2 | loss: 0.0134179
	speed: 0.3430s/iter; left time: 13888.9685s
Epoch: 2 cost time: 139.54374074935913
Epoch: 2, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.072 Vali Acc: 0.975 Test Loss: 0.072 Test Acc: 0.975
Validation loss decreased (-0.959071 --> -0.975443).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0213994
	speed: 0.7293s/iter; left time: 29443.9824s
	iters: 200, epoch: 3 | loss: 0.0792991
	speed: 0.3177s/iter; left time: 12795.0836s
	iters: 300, epoch: 3 | loss: 0.0674231
	speed: 0.3212s/iter; left time: 12905.3096s
	iters: 400, epoch: 3 | loss: 0.0155803
	speed: 0.3334s/iter; left time: 13361.6005s
Epoch: 3 cost time: 135.66370010375977
Epoch: 3, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.057 Vali Acc: 0.980 Test Loss: 0.057 Test Acc: 0.980
Validation loss decreased (-0.975443 --> -0.979536).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0138715
	speed: 0.7295s/iter; left time: 29153.3953s
	iters: 200, epoch: 4 | loss: 0.0076042
	speed: 0.3293s/iter; left time: 13125.2666s
	iters: 300, epoch: 4 | loss: 0.0013123
	speed: 0.3345s/iter; left time: 13302.3111s
	iters: 400, epoch: 4 | loss: 0.0427756
	speed: 0.3155s/iter; left time: 12514.0638s
Epoch: 4 cost time: 137.59229850769043
Epoch: 4, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.045 Vali Acc: 0.983 Test Loss: 0.045 Test Acc: 0.983
Validation loss decreased (-0.979536 --> -0.982719).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0035581
	speed: 0.6949s/iter; left time: 27482.4648s
	iters: 200, epoch: 5 | loss: 0.0032776
	speed: 0.3294s/iter; left time: 12993.5052s
	iters: 300, epoch: 5 | loss: 0.0227707
	speed: 0.3305s/iter; left time: 13003.8447s
	iters: 400, epoch: 5 | loss: 0.0008951
	speed: 0.3419s/iter; left time: 13420.5507s
Epoch: 5 cost time: 137.50908851623535
Epoch: 5, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.073 Vali Acc: 0.971 Test Loss: 0.073 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0020745
	speed: 0.7130s/iter; left time: 27902.5889s
	iters: 200, epoch: 6 | loss: 0.1874700
	speed: 0.3336s/iter; left time: 13023.8896s
	iters: 300, epoch: 6 | loss: 0.0027395
	speed: 0.3292s/iter; left time: 12817.2289s
	iters: 400, epoch: 6 | loss: 0.0229378
	speed: 0.3077s/iter; left time: 11949.6640s
Epoch: 6 cost time: 135.57731461524963
Epoch: 6, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.062 Vali Acc: 0.974 Test Loss: 0.062 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0124707
	speed: 0.6729s/iter; left time: 26055.0608s
	iters: 200, epoch: 7 | loss: 0.0210203
	speed: 0.3091s/iter; left time: 11940.0449s
	iters: 300, epoch: 7 | loss: 0.1090728
	speed: 0.3017s/iter; left time: 11621.4794s
	iters: 400, epoch: 7 | loss: 0.0017423
	speed: 0.2991s/iter; left time: 11493.4819s
Epoch: 7 cost time: 126.02169299125671
Epoch: 7, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.086 Vali Acc: 0.972 Test Loss: 0.086 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0664565
	speed: 0.6771s/iter; left time: 25938.7661s
	iters: 200, epoch: 8 | loss: 0.0002542
	speed: 0.3121s/iter; left time: 11926.3128s
	iters: 300, epoch: 8 | loss: 0.0004607
	speed: 0.3083s/iter; left time: 11748.8859s
	iters: 400, epoch: 8 | loss: 0.3514119
	speed: 0.3103s/iter; left time: 11794.6590s
Epoch: 8 cost time: 128.72089958190918
Epoch: 8, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.3308093
	speed: 0.6397s/iter; left time: 24242.3453s
	iters: 200, epoch: 9 | loss: 0.0042047
	speed: 0.2961s/iter; left time: 11190.7812s
	iters: 300, epoch: 9 | loss: 0.0006437
	speed: 0.3095s/iter; left time: 11668.5681s
	iters: 400, epoch: 9 | loss: 0.0011093
	speed: 0.3009s/iter; left time: 11311.9098s
Epoch: 9 cost time: 126.23845601081848
Epoch: 9, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.146 Vali Acc: 0.969 Test Loss: 0.146 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0015893
	speed: 0.6549s/iter; left time: 24548.1372s
	iters: 200, epoch: 10 | loss: 0.0129521
	speed: 0.3030s/iter; left time: 11326.1340s
	iters: 300, epoch: 10 | loss: 0.0001754
	speed: 0.3154s/iter; left time: 11759.8508s
	iters: 400, epoch: 10 | loss: 0.0003590
	speed: 0.3037s/iter; left time: 11291.7908s
Epoch: 10 cost time: 128.02105689048767
Epoch: 10, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0300735
	speed: 0.6568s/iter; left time: 24348.7368s
	iters: 200, epoch: 11 | loss: 0.0114320
	speed: 0.3157s/iter; left time: 11670.5653s
	iters: 300, epoch: 11 | loss: 0.0000162
	speed: 0.3179s/iter; left time: 11721.6808s
	iters: 400, epoch: 11 | loss: 0.0048135
	speed: 0.3183s/iter; left time: 11702.8344s
Epoch: 11 cost time: 130.05401968955994
Epoch: 11, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.045 Vali Acc: 0.985 Test Loss: 0.045 Test Acc: 0.985
Validation loss decreased (-0.982719 --> -0.985447).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000143
	speed: 0.6385s/iter; left time: 23406.4204s
	iters: 200, epoch: 12 | loss: 0.0000209
	speed: 0.3089s/iter; left time: 11292.2821s
	iters: 300, epoch: 12 | loss: 0.0002376
	speed: 0.3147s/iter; left time: 11475.0138s
	iters: 400, epoch: 12 | loss: 0.1735145
	speed: 0.3090s/iter; left time: 11233.5609s
Epoch: 12 cost time: 128.42835545539856
Epoch: 12, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.064 Vali Acc: 0.981 Test Loss: 0.064 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0009197
	speed: 0.6435s/iter; left time: 23324.2638s
	iters: 200, epoch: 13 | loss: 0.0011356
	speed: 0.3137s/iter; left time: 11339.9358s
	iters: 300, epoch: 13 | loss: 0.0002509
	speed: 0.3088s/iter; left time: 11132.0781s
	iters: 400, epoch: 13 | loss: 0.0000784
	speed: 0.3053s/iter; left time: 10972.8018s
Epoch: 13 cost time: 127.08045053482056
Epoch: 13, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000734
	speed: 0.6256s/iter; left time: 22416.7003s
	iters: 200, epoch: 14 | loss: 0.0007507
	speed: 0.3030s/iter; left time: 10826.1204s
	iters: 300, epoch: 14 | loss: 0.0000270
	speed: 0.3083s/iter; left time: 10983.7343s
	iters: 400, epoch: 14 | loss: 0.0005460
	speed: 0.3226s/iter; left time: 11461.4149s
Epoch: 14 cost time: 127.98893618583679
Epoch: 14, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.062 Vali Acc: 0.984 Test Loss: 0.062 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000099
	speed: 0.6665s/iter; left time: 23606.9957s
	iters: 200, epoch: 15 | loss: 0.0013064
	speed: 0.3022s/iter; left time: 10673.9354s
	iters: 300, epoch: 15 | loss: 0.0541786
	speed: 0.2914s/iter; left time: 10261.5036s
	iters: 400, epoch: 15 | loss: 0.0007764
	speed: 0.2948s/iter; left time: 10352.1416s
Epoch: 15 cost time: 124.62669467926025
Epoch: 15, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.062 Vali Acc: 0.985 Test Loss: 0.062 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000658
	speed: 0.6564s/iter; left time: 22977.0993s
	iters: 200, epoch: 16 | loss: 0.0000124
	speed: 0.3166s/iter; left time: 11052.1443s
	iters: 300, epoch: 16 | loss: 0.0000018
	speed: 0.3138s/iter; left time: 10921.8499s
	iters: 400, epoch: 16 | loss: 0.0011005
	speed: 0.3155s/iter; left time: 10950.1148s
Epoch: 16 cost time: 130.23027157783508
Epoch: 16, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000005
	speed: 0.6500s/iter; left time: 22483.9113s
	iters: 200, epoch: 17 | loss: 0.0000892
	speed: 0.3122s/iter; left time: 10769.4867s
	iters: 300, epoch: 17 | loss: 0.0000184
	speed: 0.3134s/iter; left time: 10778.2046s
	iters: 400, epoch: 17 | loss: 0.0375465
	speed: 0.3045s/iter; left time: 10441.3596s
Epoch: 17 cost time: 129.10078978538513
Epoch: 17, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.060 Vali Acc: 0.987 Test Loss: 0.060 Test Acc: 0.987
Validation loss decreased (-0.985447 --> -0.986812).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0046211
	speed: 0.6453s/iter; left time: 22056.9100s
	iters: 200, epoch: 18 | loss: 0.0016646
	speed: 0.3090s/iter; left time: 10530.3070s
	iters: 300, epoch: 18 | loss: 0.0089470
	speed: 0.3176s/iter; left time: 10792.8987s
	iters: 400, epoch: 18 | loss: 0.0000024
	speed: 0.3046s/iter; left time: 10319.7445s
Epoch: 18 cost time: 128.03598594665527
Epoch: 18, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.051 Vali Acc: 0.989 Test Loss: 0.051 Test Acc: 0.989
Validation loss decreased (-0.986812 --> -0.988631).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0003124
	speed: 0.6410s/iter; left time: 21644.0675s
	iters: 200, epoch: 19 | loss: 0.0008714
	speed: 0.2960s/iter; left time: 9964.0865s
	iters: 300, epoch: 19 | loss: 0.0000191
	speed: 0.3067s/iter; left time: 10295.6480s
	iters: 400, epoch: 19 | loss: 0.0000171
	speed: 0.3101s/iter; left time: 10378.9985s
Epoch: 19 cost time: 126.38409423828125
Epoch: 19, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.101 Vali Acc: 0.981 Test Loss: 0.101 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.6918631
	speed: 0.6585s/iter; left time: 21962.0471s
	iters: 200, epoch: 20 | loss: 0.0001361
	speed: 0.3130s/iter; left time: 10409.6251s
	iters: 300, epoch: 20 | loss: 0.0000002
	speed: 0.3095s/iter; left time: 10261.2082s
	iters: 400, epoch: 20 | loss: 0.0000037
	speed: 0.2917s/iter; left time: 9642.0278s
Epoch: 20 cost time: 127.09018635749817
Epoch: 20, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.074 Vali Acc: 0.985 Test Loss: 0.074 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000001
	speed: 0.6212s/iter; left time: 20463.9259s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.3148s/iter; left time: 10339.7242s
	iters: 300, epoch: 21 | loss: 0.0000002
	speed: 0.3159s/iter; left time: 10343.7829s
	iters: 400, epoch: 21 | loss: 0.0000050
	speed: 0.3113s/iter; left time: 10161.5651s
Epoch: 21 cost time: 128.17057394981384
Epoch: 21, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.036 Vali Acc: 0.989 Test Loss: 0.036 Test Acc: 0.989
Validation loss decreased (-0.988631 --> -0.989086).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0000029
	speed: 0.6488s/iter; left time: 21102.6916s
	iters: 200, epoch: 22 | loss: 0.0000001
	speed: 0.3106s/iter; left time: 10072.5221s
	iters: 300, epoch: 22 | loss: 0.0001693
	speed: 0.3187s/iter; left time: 10302.5989s
	iters: 400, epoch: 22 | loss: 0.0000415
	speed: 0.3075s/iter; left time: 9910.8476s
Epoch: 22 cost time: 129.5860984325409
Epoch: 22, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.064 Vali Acc: 0.985 Test Loss: 0.064 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0021292
	speed: 0.6458s/iter; left time: 20739.7881s
	iters: 200, epoch: 23 | loss: 0.0000158
	speed: 0.3094s/iter; left time: 9906.4703s
	iters: 300, epoch: 23 | loss: 0.0000098
	speed: 0.3179s/iter; left time: 10145.8092s
	iters: 400, epoch: 23 | loss: 0.0001326
	speed: 0.3160s/iter; left time: 10052.6327s
Epoch: 23 cost time: 129.7363440990448
Epoch: 23, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0250528
	speed: 0.6544s/iter; left time: 20745.7903s
	iters: 200, epoch: 24 | loss: 0.0000100
	speed: 0.3022s/iter; left time: 9549.9631s
	iters: 300, epoch: 24 | loss: 0.0000741
	speed: 0.2928s/iter; left time: 9222.4057s
	iters: 400, epoch: 24 | loss: 0.0000021
	speed: 0.3101s/iter; left time: 9738.1734s
Epoch: 24 cost time: 126.03409552574158
Epoch: 24, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0002695
	speed: 0.6620s/iter; left time: 20712.9952s
	iters: 200, epoch: 25 | loss: 0.0000005
	speed: 0.3063s/iter; left time: 9551.7597s
	iters: 300, epoch: 25 | loss: 0.0037709
	speed: 0.2914s/iter; left time: 9060.0764s
	iters: 400, epoch: 25 | loss: 0.2644562
	speed: 0.2995s/iter; left time: 9280.2017s
Epoch: 25 cost time: 125.57784628868103
Epoch: 25, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.102 Vali Acc: 0.979 Test Loss: 0.102 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0000158
	speed: 0.6423s/iter; left time: 19830.5305s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.3186s/iter; left time: 9804.0561s
	iters: 300, epoch: 26 | loss: 0.0000141
	speed: 0.3201s/iter; left time: 9819.1549s
	iters: 400, epoch: 26 | loss: 0.0002996
	speed: 0.3104s/iter; left time: 9489.6272s
Epoch: 26 cost time: 130.58482956886292
Epoch: 26, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.071 Vali Acc: 0.986 Test Loss: 0.071 Test Acc: 0.986
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0008721
	speed: 0.6439s/iter; left time: 19614.3165s
	iters: 200, epoch: 27 | loss: 0.0000005
	speed: 0.3077s/iter; left time: 9341.2854s
	iters: 300, epoch: 27 | loss: 0.0007459
	speed: 0.3053s/iter; left time: 9237.7954s
	iters: 400, epoch: 27 | loss: 0.0000878
	speed: 0.3045s/iter; left time: 9183.2345s
Epoch: 27 cost time: 126.15148544311523
Epoch: 27, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.065 Vali Acc: 0.985 Test Loss: 0.065 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0004584
	speed: 0.6686s/iter; left time: 20090.7837s
	iters: 200, epoch: 28 | loss: 0.0001078
	speed: 0.3123s/iter; left time: 9353.4606s
	iters: 300, epoch: 28 | loss: 0.0000440
	speed: 0.3050s/iter; left time: 9102.9583s
	iters: 400, epoch: 28 | loss: 0.0000750
	speed: 0.2996s/iter; left time: 8913.8872s
Epoch: 28 cost time: 129.16269707679749
Epoch: 28, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.079 Vali Acc: 0.985 Test Loss: 0.079 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0000007
	speed: 0.6584s/iter; left time: 19512.9084s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.3101s/iter; left time: 9160.0233s
	iters: 300, epoch: 29 | loss: 0.0000146
	speed: 0.3080s/iter; left time: 9065.1810s
	iters: 400, epoch: 29 | loss: 0.0000001
	speed: 0.3024s/iter; left time: 8870.2920s
Epoch: 29 cost time: 127.72174572944641
Epoch: 29, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.118 Vali Acc: 0.982 Test Loss: 0.118 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.6367s/iter; left time: 18608.3457s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.3007s/iter; left time: 8758.8927s
	iters: 300, epoch: 30 | loss: 0.0001238
	speed: 0.3047s/iter; left time: 8844.2073s
	iters: 400, epoch: 30 | loss: 0.0001191
	speed: 0.3225s/iter; left time: 9326.7572s
Epoch: 30 cost time: 127.7340817451477
Epoch: 30, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.074 Vali Acc: 0.987 Test Loss: 0.074 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0000015
	speed: 0.6686s/iter; left time: 19264.0934s
	iters: 200, epoch: 31 | loss: 0.0001268
	speed: 0.3160s/iter; left time: 9072.8945s
	iters: 300, epoch: 31 | loss: 0.0074258
	speed: 0.2988s/iter; left time: 8547.7993s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.3066s/iter; left time: 8741.0582s
Epoch: 31 cost time: 128.59881949424744
Epoch: 31, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.088 Vali Acc: 0.987 Test Loss: 0.088 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df512_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9890859481582538
model parameter : 407178
model size : 4.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df512_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.9748486
	speed: 0.3199s/iter; left time: 13179.2644s
	iters: 200, epoch: 1 | loss: 0.5464771
	speed: 0.3016s/iter; left time: 12395.4655s
	iters: 300, epoch: 1 | loss: 0.7863485
	speed: 0.2987s/iter; left time: 12248.7488s
	iters: 400, epoch: 1 | loss: 0.2230161
	speed: 0.2937s/iter; left time: 12010.8785s
Epoch: 1 cost time: 125.57903599739075
Epoch: 1, Steps: 413 | Train Loss: 1.026 Vali Loss: 0.190 Vali Acc: 0.952 Test Loss: 0.190 Test Acc: 0.952
Validation loss decreased (inf --> -0.951794).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0558723
	speed: 0.6163s/iter; left time: 25137.7046s
	iters: 200, epoch: 2 | loss: 0.0702337
	speed: 0.2966s/iter; left time: 12067.1347s
	iters: 300, epoch: 2 | loss: 0.2460755
	speed: 0.3050s/iter; left time: 12378.9754s
	iters: 400, epoch: 2 | loss: 0.0460061
	speed: 0.3106s/iter; left time: 12574.0788s
Epoch: 2 cost time: 125.51023697853088
Epoch: 2, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
Validation loss decreased (-0.951794 --> -0.975897).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0222984
	speed: 0.6594s/iter; left time: 26622.8170s
	iters: 200, epoch: 3 | loss: 0.0640191
	speed: 0.2979s/iter; left time: 11999.3920s
	iters: 300, epoch: 3 | loss: 0.0102615
	speed: 0.2848s/iter; left time: 11439.8770s
	iters: 400, epoch: 3 | loss: 0.0135223
	speed: 0.2950s/iter; left time: 11823.3050s
Epoch: 3 cost time: 123.74658346176147
Epoch: 3, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.079 Vali Acc: 0.972 Test Loss: 0.079 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0529843
	speed: 0.6305s/iter; left time: 25194.2265s
	iters: 200, epoch: 4 | loss: 0.0146641
	speed: 0.2994s/iter; left time: 11934.0093s
	iters: 300, epoch: 4 | loss: 0.0778065
	speed: 0.2965s/iter; left time: 11789.7153s
	iters: 400, epoch: 4 | loss: 0.0014491
	speed: 0.3027s/iter; left time: 12003.8752s
Epoch: 4 cost time: 123.88828897476196
Epoch: 4, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.056 Vali Acc: 0.981 Test Loss: 0.056 Test Acc: 0.981
Validation loss decreased (-0.975897 --> -0.980900).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0019760
	speed: 0.6513s/iter; left time: 25756.8578s
	iters: 200, epoch: 5 | loss: 0.0012292
	speed: 0.3315s/iter; left time: 13075.6510s
	iters: 300, epoch: 5 | loss: 0.0123555
	speed: 0.3191s/iter; left time: 12557.1384s
	iters: 400, epoch: 5 | loss: 0.0026400
	speed: 0.3022s/iter; left time: 11860.8284s
Epoch: 5 cost time: 131.33407592773438
Epoch: 5, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.090 Vali Acc: 0.966 Test Loss: 0.090 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0053205
	speed: 0.6369s/iter; left time: 24927.3248s
	iters: 200, epoch: 6 | loss: 0.0626515
	speed: 0.3043s/iter; left time: 11879.6162s
	iters: 300, epoch: 6 | loss: 0.0055913
	speed: 0.2973s/iter; left time: 11577.0972s
	iters: 400, epoch: 6 | loss: 0.0175873
	speed: 0.3331s/iter; left time: 12937.8800s
Epoch: 6 cost time: 128.44424676895142
Epoch: 6, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.050 Vali Acc: 0.982 Test Loss: 0.050 Test Acc: 0.982
Validation loss decreased (-0.980900 --> -0.982264).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0041794
	speed: 0.6787s/iter; left time: 26282.7397s
	iters: 200, epoch: 7 | loss: 0.0791388
	speed: 0.3194s/iter; left time: 12336.5165s
	iters: 300, epoch: 7 | loss: 0.3966215
	speed: 0.3322s/iter; left time: 12798.0944s
	iters: 400, epoch: 7 | loss: 0.0499890
	speed: 0.3185s/iter; left time: 12238.5967s
Epoch: 7 cost time: 133.5687415599823
Epoch: 7, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0425790
	speed: 0.6653s/iter; left time: 25489.0011s
	iters: 200, epoch: 8 | loss: 0.0013969
	speed: 0.3037s/iter; left time: 11602.8100s
	iters: 300, epoch: 8 | loss: 0.0001076
	speed: 0.3189s/iter; left time: 12153.6446s
	iters: 400, epoch: 8 | loss: 0.0129932
	speed: 0.3303s/iter; left time: 12556.0612s
Epoch: 8 cost time: 131.59171724319458
Epoch: 8, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.063 Vali Acc: 0.979 Test Loss: 0.063 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0001443
	speed: 0.6521s/iter; left time: 24712.7403s
	iters: 200, epoch: 9 | loss: 0.0027569
	speed: 0.3236s/iter; left time: 12230.5829s
	iters: 300, epoch: 9 | loss: 0.0953156
	speed: 0.3428s/iter; left time: 12922.3864s
	iters: 400, epoch: 9 | loss: 0.2062864
	speed: 0.3473s/iter; left time: 13057.9334s
Epoch: 9 cost time: 136.9125485420227
Epoch: 9, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0002123
	speed: 0.6496s/iter; left time: 24351.0224s
	iters: 200, epoch: 10 | loss: 0.0387409
	speed: 0.2930s/iter; left time: 10953.3491s
	iters: 300, epoch: 10 | loss: 0.0031176
	speed: 0.3051s/iter; left time: 11374.9794s
	iters: 400, epoch: 10 | loss: 0.0003720
	speed: 0.3161s/iter; left time: 11754.8156s
Epoch: 10 cost time: 126.81170153617859
Epoch: 10, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000988
	speed: 0.6727s/iter; left time: 24937.9860s
	iters: 200, epoch: 11 | loss: 0.0008063
	speed: 0.3298s/iter; left time: 12193.2843s
	iters: 300, epoch: 11 | loss: 0.0002576
	speed: 0.3136s/iter; left time: 11563.1266s
	iters: 400, epoch: 11 | loss: 0.0026261
	speed: 0.3127s/iter; left time: 11498.9391s
Epoch: 11 cost time: 132.10900402069092
Epoch: 11, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.126 Vali Acc: 0.971 Test Loss: 0.126 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000199
	speed: 0.6734s/iter; left time: 24686.4656s
	iters: 200, epoch: 12 | loss: 0.0035504
	speed: 0.3276s/iter; left time: 11977.2004s
	iters: 300, epoch: 12 | loss: 0.0000039
	speed: 0.3211s/iter; left time: 11705.7950s
	iters: 400, epoch: 12 | loss: 0.0005436
	speed: 0.3184s/iter; left time: 11575.9560s
Epoch: 12 cost time: 132.87719297409058
Epoch: 12, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.982264 --> -0.982719).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0909001
	speed: 0.6904s/iter; left time: 25022.2111s
	iters: 200, epoch: 13 | loss: 0.0027060
	speed: 0.3188s/iter; left time: 11524.4440s
	iters: 300, epoch: 13 | loss: 0.0000084
	speed: 0.3176s/iter; left time: 11448.6438s
	iters: 400, epoch: 13 | loss: 0.0018190
	speed: 0.3089s/iter; left time: 11102.2831s
Epoch: 13 cost time: 131.49505186080933
Epoch: 13, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.092 Vali Acc: 0.979 Test Loss: 0.092 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000412
	speed: 0.6956s/iter; left time: 24924.6359s
	iters: 200, epoch: 14 | loss: 0.0000690
	speed: 0.3373s/iter; left time: 12051.2440s
	iters: 300, epoch: 14 | loss: 0.0000009
	speed: 0.3251s/iter; left time: 11582.5628s
	iters: 400, epoch: 14 | loss: 0.0188598
	speed: 0.3139s/iter; left time: 11154.2718s
Epoch: 14 cost time: 135.92307567596436
Epoch: 14, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.068 Vali Acc: 0.985 Test Loss: 0.068 Test Acc: 0.985
Validation loss decreased (-0.982719 --> -0.985447).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000341
	speed: 0.6624s/iter; left time: 23461.9092s
	iters: 200, epoch: 15 | loss: 0.0006813
	speed: 0.3074s/iter; left time: 10855.4015s
	iters: 300, epoch: 15 | loss: 0.0143547
	speed: 0.3185s/iter; left time: 11216.8814s
	iters: 400, epoch: 15 | loss: 0.0010335
	speed: 0.3191s/iter; left time: 11206.6462s
Epoch: 15 cost time: 131.7557680606842
Epoch: 15, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.062 Vali Acc: 0.985 Test Loss: 0.062 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000241
	speed: 0.6639s/iter; left time: 23240.7212s
	iters: 200, epoch: 16 | loss: 0.0000811
	speed: 0.3295s/iter; left time: 11500.7168s
	iters: 300, epoch: 16 | loss: 0.0026799
	speed: 0.3313s/iter; left time: 11531.6296s
	iters: 400, epoch: 16 | loss: 0.0001642
	speed: 0.3169s/iter; left time: 10998.1836s
Epoch: 16 cost time: 133.8505084514618
Epoch: 16, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0303338
	speed: 0.6614s/iter; left time: 22879.7248s
	iters: 200, epoch: 17 | loss: 0.0007185
	speed: 0.3184s/iter; left time: 10981.0128s
	iters: 300, epoch: 17 | loss: 0.0000193
	speed: 0.3335s/iter; left time: 11471.1597s
	iters: 400, epoch: 17 | loss: 0.0000634
	speed: 0.3319s/iter; left time: 11380.3395s
Epoch: 17 cost time: 134.4999496936798
Epoch: 17, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.133 Vali Acc: 0.979 Test Loss: 0.133 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.1460590
	speed: 0.6995s/iter; left time: 23910.5495s
	iters: 200, epoch: 18 | loss: 0.0000354
	speed: 0.3145s/iter; left time: 10717.0824s
	iters: 300, epoch: 18 | loss: 0.0042949
	speed: 0.3164s/iter; left time: 10751.8067s
	iters: 400, epoch: 18 | loss: 0.0010064
	speed: 0.3291s/iter; left time: 11148.3257s
Epoch: 18 cost time: 133.75838541984558
Epoch: 18, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0014680
	speed: 0.6882s/iter; left time: 23237.8686s
	iters: 200, epoch: 19 | loss: 0.0004837
	speed: 0.3263s/iter; left time: 10986.1428s
	iters: 300, epoch: 19 | loss: 0.0000021
	speed: 0.3273s/iter; left time: 10986.3514s
	iters: 400, epoch: 19 | loss: 0.0002429
	speed: 0.3179s/iter; left time: 10639.5273s
Epoch: 19 cost time: 135.21781873703003
Epoch: 19, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000166
	speed: 0.6860s/iter; left time: 22879.9197s
	iters: 200, epoch: 20 | loss: 0.0089137
	speed: 0.3252s/iter; left time: 10813.3059s
	iters: 300, epoch: 20 | loss: 0.0000666
	speed: 0.3277s/iter; left time: 10865.7539s
	iters: 400, epoch: 20 | loss: 0.0001030
	speed: 0.3337s/iter; left time: 11028.5386s
Epoch: 20 cost time: 136.48788690567017
Epoch: 20, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0006072
	speed: 0.6708s/iter; left time: 22097.6233s
	iters: 200, epoch: 21 | loss: 0.0000001
	speed: 0.3170s/iter; left time: 10411.6670s
	iters: 300, epoch: 21 | loss: 0.0000002
	speed: 0.2904s/iter; left time: 9509.1870s
	iters: 400, epoch: 21 | loss: 0.0057922
	speed: 0.2930s/iter; left time: 9563.4963s
Epoch: 21 cost time: 126.57182669639587
Epoch: 21, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.064 Vali Acc: 0.985 Test Loss: 0.064 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0000200
	speed: 0.6101s/iter; left time: 19846.5183s
	iters: 200, epoch: 22 | loss: 0.0000286
	speed: 0.3180s/iter; left time: 10313.5022s
	iters: 300, epoch: 22 | loss: 0.0000001
	speed: 0.3096s/iter; left time: 10007.9723s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.3051s/iter; left time: 9833.6798s
Epoch: 22 cost time: 127.68852138519287
Epoch: 22, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.058 Vali Acc: 0.986 Test Loss: 0.058 Test Acc: 0.986
Validation loss decreased (-0.985447 --> -0.985902).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000001
	speed: 0.6420s/iter; left time: 20616.2414s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.3080s/iter; left time: 9861.0013s
	iters: 300, epoch: 23 | loss: 0.0003997
	speed: 0.3062s/iter; left time: 9772.7231s
	iters: 400, epoch: 23 | loss: 0.0596591
	speed: 0.3096s/iter; left time: 9848.9168s
Epoch: 23 cost time: 126.80269503593445
Epoch: 23, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.152 Vali Acc: 0.972 Test Loss: 0.152 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0083288
	speed: 0.6291s/iter; left time: 19944.1643s
	iters: 200, epoch: 24 | loss: 0.0001664
	speed: 0.2992s/iter; left time: 9456.6985s
	iters: 300, epoch: 24 | loss: 0.0000824
	speed: 0.3197s/iter; left time: 10071.0499s
	iters: 400, epoch: 24 | loss: 0.0020789
	speed: 0.3144s/iter; left time: 9873.4072s
Epoch: 24 cost time: 128.17599368095398
Epoch: 24, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0000154
	speed: 0.6442s/iter; left time: 20155.0349s
	iters: 200, epoch: 25 | loss: 0.0001289
	speed: 0.3019s/iter; left time: 9415.0917s
	iters: 300, epoch: 25 | loss: 0.0000242
	speed: 0.3024s/iter; left time: 9401.7712s
	iters: 400, epoch: 25 | loss: 0.0000011
	speed: 0.3240s/iter; left time: 10039.9769s
Epoch: 25 cost time: 128.3208258152008
Epoch: 25, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0000021
	speed: 0.7019s/iter; left time: 21671.9522s
	iters: 200, epoch: 26 | loss: 0.0000008
	speed: 0.3199s/iter; left time: 9844.2010s
	iters: 300, epoch: 26 | loss: 0.0000036
	speed: 0.3081s/iter; left time: 9452.3705s
	iters: 400, epoch: 26 | loss: 0.0000055
	speed: 0.3092s/iter; left time: 9453.4626s
Epoch: 26 cost time: 131.73352360725403
Epoch: 26, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.133 Vali Acc: 0.978 Test Loss: 0.133 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.3180757
	speed: 0.6813s/iter; left time: 20755.8350s
	iters: 200, epoch: 27 | loss: 0.0000001
	speed: 0.3215s/iter; left time: 9760.6037s
	iters: 300, epoch: 27 | loss: 0.0176960
	speed: 0.3132s/iter; left time: 9477.1023s
	iters: 400, epoch: 27 | loss: 0.0000001
	speed: 0.3284s/iter; left time: 9906.6263s
Epoch: 27 cost time: 132.64960861206055
Epoch: 27, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0000628
	speed: 0.6828s/iter; left time: 20518.8049s
	iters: 200, epoch: 28 | loss: 0.0012773
	speed: 0.3187s/iter; left time: 9546.3575s
	iters: 300, epoch: 28 | loss: 0.0000001
	speed: 0.3212s/iter; left time: 9588.0688s
	iters: 400, epoch: 28 | loss: 0.0001014
	speed: 0.3295s/iter; left time: 9802.1765s
Epoch: 28 cost time: 134.5324785709381
Epoch: 28, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0000002
	speed: 0.6596s/iter; left time: 19548.1181s
	iters: 200, epoch: 29 | loss: 0.0047817
	speed: 0.3271s/iter; left time: 9662.4578s
	iters: 300, epoch: 29 | loss: 0.0000153
	speed: 0.3499s/iter; left time: 10299.7798s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.3299s/iter; left time: 9677.0982s
Epoch: 29 cost time: 137.6483919620514
Epoch: 29, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.127 Vali Acc: 0.976 Test Loss: 0.127 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.1436139
	speed: 0.6763s/iter; left time: 19763.7556s
	iters: 200, epoch: 30 | loss: 0.0101791
	speed: 0.3251s/iter; left time: 9468.4663s
	iters: 300, epoch: 30 | loss: 0.0000147
	speed: 0.3362s/iter; left time: 9758.0275s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.3154s/iter; left time: 9122.8609s
Epoch: 30 cost time: 135.25383400917053
Epoch: 30, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.156 Vali Acc: 0.975 Test Loss: 0.156 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.6759s/iter; left time: 19473.2646s
	iters: 200, epoch: 31 | loss: 0.0000141
	speed: 0.3322s/iter; left time: 9537.1943s
	iters: 300, epoch: 31 | loss: 0.0014963
	speed: 0.3381s/iter; left time: 9672.2501s
	iters: 400, epoch: 31 | loss: 0.0000010
	speed: 0.3245s/iter; left time: 9252.8089s
Epoch: 31 cost time: 136.76190042495728
Epoch: 31, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.090 Vali Acc: 0.982 Test Loss: 0.090 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0000018
	speed: 0.6895s/iter; left time: 19579.2207s
	iters: 200, epoch: 32 | loss: 0.0001000
	speed: 0.3216s/iter; left time: 9099.9607s
	iters: 300, epoch: 32 | loss: 0.0000153
	speed: 0.3335s/iter; left time: 9404.3267s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.3266s/iter; left time: 9176.8781s
Epoch: 32 cost time: 135.45522451400757
Epoch: 32, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.066 Vali Acc: 0.986 Test Loss: 0.066 Test Acc: 0.986
Validation loss decreased (-0.985902 --> -0.986357).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.0014749
	speed: 0.6504s/iter; left time: 18201.4886s
	iters: 200, epoch: 33 | loss: 0.0000002
	speed: 0.2975s/iter; left time: 8296.2996s
	iters: 300, epoch: 33 | loss: 0.0000013
	speed: 0.3015s/iter; left time: 8376.4610s
	iters: 400, epoch: 33 | loss: 0.0015499
	speed: 0.3016s/iter; left time: 8350.7967s
Epoch: 33 cost time: 125.37031579017639
Epoch: 33, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.067 Vali Acc: 0.985 Test Loss: 0.067 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 0.0000001
	speed: 0.6567s/iter; left time: 18106.1617s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.3093s/iter; left time: 8497.0560s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.3126s/iter; left time: 8556.9157s
	iters: 400, epoch: 34 | loss: 0.0000004
	speed: 0.3138s/iter; left time: 8559.0410s
Epoch: 34 cost time: 130.1064648628235
Epoch: 34, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.987 Test Loss: 0.076 Test Acc: 0.987
Validation loss decreased (-0.986357 --> -0.986811).  Saving model ...
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.6737s/iter; left time: 18297.4774s
	iters: 200, epoch: 35 | loss: 0.0853088
	speed: 0.3067s/iter; left time: 8299.9464s
	iters: 300, epoch: 35 | loss: 0.2001721
	speed: 0.2995s/iter; left time: 8075.3768s
	iters: 400, epoch: 35 | loss: 0.0000004
	speed: 0.3058s/iter; left time: 8212.3365s
Epoch: 35 cost time: 127.40623688697815
Epoch: 35, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.165 Vali Acc: 0.977 Test Loss: 0.165 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 0.0001017
	speed: 0.6643s/iter; left time: 17767.9998s
	iters: 200, epoch: 36 | loss: 0.0033396
	speed: 0.3369s/iter; left time: 8977.4763s
	iters: 300, epoch: 36 | loss: 0.0000000
	speed: 0.3394s/iter; left time: 9010.8898s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.3394s/iter; left time: 8976.7806s
Epoch: 36 cost time: 139.3983714580536
Epoch: 36, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.114 Vali Acc: 0.978 Test Loss: 0.114 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.6911s/iter; left time: 18198.1257s
	iters: 200, epoch: 37 | loss: 0.0000041
	speed: 0.3266s/iter; left time: 8567.8442s
	iters: 300, epoch: 37 | loss: 0.0000003
	speed: 0.3319s/iter; left time: 8674.6833s
	iters: 400, epoch: 37 | loss: 0.0005997
	speed: 0.3256s/iter; left time: 8477.5906s
Epoch: 37 cost time: 135.42876386642456
Epoch: 37, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.172 Vali Acc: 0.975 Test Loss: 0.172 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 0.0000002
	speed: 0.6610s/iter; left time: 17132.8479s
	iters: 200, epoch: 38 | loss: 0.0000000
	speed: 0.3278s/iter; left time: 8464.9910s
	iters: 300, epoch: 38 | loss: 0.0000000
	speed: 0.3367s/iter; left time: 8659.1636s
	iters: 400, epoch: 38 | loss: 0.0000001
	speed: 0.3270s/iter; left time: 8376.9676s
Epoch: 38 cost time: 136.44309282302856
Epoch: 38, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 39 | loss: 0.0000001
	speed: 0.6940s/iter; left time: 17700.9540s
	iters: 200, epoch: 39 | loss: 0.0189007
	speed: 0.3130s/iter; left time: 7951.6885s
	iters: 300, epoch: 39 | loss: 0.0007787
	speed: 0.3393s/iter; left time: 8587.4360s
	iters: 400, epoch: 39 | loss: 0.0257486
	speed: 0.3346s/iter; left time: 8433.1540s
Epoch: 39 cost time: 136.41293048858643
Epoch: 39, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.196 Vali Acc: 0.972 Test Loss: 0.196 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 40 | loss: 0.0003719
	speed: 0.6797s/iter; left time: 17055.4735s
	iters: 200, epoch: 40 | loss: 0.0000045
	speed: 0.3111s/iter; left time: 7775.5946s
	iters: 300, epoch: 40 | loss: 0.0000017
	speed: 0.3151s/iter; left time: 7845.0978s
	iters: 400, epoch: 40 | loss: 0.0001199
	speed: 0.3345s/iter; left time: 8292.5238s
Epoch: 40 cost time: 133.87310552597046
Epoch: 40, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.177 Vali Acc: 0.970 Test Loss: 0.177 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 41 | loss: 0.0002521
	speed: 0.7106s/iter; left time: 17539.1735s
	iters: 200, epoch: 41 | loss: 0.0000004
	speed: 0.3273s/iter; left time: 8046.0347s
	iters: 300, epoch: 41 | loss: 0.0000009
	speed: 0.3401s/iter; left time: 8324.9880s
	iters: 400, epoch: 41 | loss: 0.0000029
	speed: 0.3284s/iter; left time: 8006.6164s
Epoch: 41 cost time: 138.49880290031433
Epoch: 41, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.090 Vali Acc: 0.985 Test Loss: 0.090 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 42 | loss: 0.0000002
	speed: 0.6943s/iter; left time: 16848.1731s
	iters: 200, epoch: 42 | loss: 0.0000002
	speed: 0.3242s/iter; left time: 7835.8016s
	iters: 300, epoch: 42 | loss: 0.0000099
	speed: 0.3257s/iter; left time: 7839.8292s
	iters: 400, epoch: 42 | loss: 0.0060476
	speed: 0.3357s/iter; left time: 8046.1348s
Epoch: 42 cost time: 136.27145624160767
Epoch: 42, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.045 Vali Acc: 0.990 Test Loss: 0.045 Test Acc: 0.990
Validation loss decreased (-0.986811 --> -0.989995).  Saving model ...
	iters: 100, epoch: 43 | loss: 0.0017969
	speed: 0.6883s/iter; left time: 16420.2566s
	iters: 200, epoch: 43 | loss: 0.0000000
	speed: 0.3226s/iter; left time: 7664.2968s
	iters: 300, epoch: 43 | loss: 0.0000000
	speed: 0.3266s/iter; left time: 7725.2018s
	iters: 400, epoch: 43 | loss: 0.0000117
	speed: 0.3037s/iter; left time: 7152.6769s
Epoch: 43 cost time: 133.8023645877838
Epoch: 43, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.072 Vali Acc: 0.986 Test Loss: 0.072 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 44 | loss: 0.0000000
	speed: 0.6835s/iter; left time: 16022.0638s
	iters: 200, epoch: 44 | loss: 0.0000647
	speed: 0.3478s/iter; left time: 8118.8095s
	iters: 300, epoch: 44 | loss: 0.0051389
	speed: 0.3177s/iter; left time: 7383.7020s
	iters: 400, epoch: 44 | loss: 0.0007549
	speed: 0.3129s/iter; left time: 7241.5410s
Epoch: 44 cost time: 135.60408306121826
Epoch: 44, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.046 Vali Acc: 0.990 Test Loss: 0.046 Test Acc: 0.990
Validation loss decreased (-0.989995 --> -0.990450).  Saving model ...
	iters: 100, epoch: 45 | loss: 0.0000015
	speed: 0.6909s/iter; left time: 15910.3475s
	iters: 200, epoch: 45 | loss: 0.0000000
	speed: 0.3328s/iter; left time: 7630.4523s
	iters: 300, epoch: 45 | loss: 0.0000008
	speed: 0.3451s/iter; left time: 7879.3403s
	iters: 400, epoch: 45 | loss: 0.0000115
	speed: 0.3276s/iter; left time: 7445.3001s
Epoch: 45 cost time: 138.80851793289185
Epoch: 45, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.143 Vali Acc: 0.977 Test Loss: 0.143 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 46 | loss: 0.0000017
	speed: 0.7332s/iter; left time: 16582.0095s
	iters: 200, epoch: 46 | loss: 0.0000041
	speed: 0.3602s/iter; left time: 8109.1916s
	iters: 300, epoch: 46 | loss: 0.0000402
	speed: 0.3525s/iter; left time: 7900.6994s
	iters: 400, epoch: 46 | loss: 0.0000001
	speed: 0.3376s/iter; left time: 7534.5252s
Epoch: 46 cost time: 145.99414539337158
Epoch: 46, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 47 | loss: 0.0012308
	speed: 0.7537s/iter; left time: 16735.3315s
	iters: 200, epoch: 47 | loss: 0.0000000
	speed: 0.3309s/iter; left time: 7314.0536s
	iters: 300, epoch: 47 | loss: 0.0001175
	speed: 0.3487s/iter; left time: 7671.6018s
	iters: 400, epoch: 47 | loss: 0.0607906
	speed: 0.3384s/iter; left time: 7411.7940s
Epoch: 47 cost time: 144.205974817276
Epoch: 47, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.984 Test Loss: 0.080 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 48 | loss: 0.0000003
	speed: 0.7467s/iter; left time: 16269.6071s
	iters: 200, epoch: 48 | loss: 0.0000186
	speed: 0.3567s/iter; left time: 7737.2848s
	iters: 300, epoch: 48 | loss: 0.0015356
	speed: 0.3645s/iter; left time: 7870.3906s
	iters: 400, epoch: 48 | loss: 0.0000058
	speed: 0.3545s/iter; left time: 7618.0675s
Epoch: 48 cost time: 149.08442068099976
Epoch: 48, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.110 Vali Acc: 0.984 Test Loss: 0.110 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 49 | loss: 0.0000248
	speed: 0.7570s/iter; left time: 16182.0899s
	iters: 200, epoch: 49 | loss: 0.0000000
	speed: 0.3975s/iter; left time: 8458.4579s
	iters: 300, epoch: 49 | loss: 0.0000000
	speed: 0.3365s/iter; left time: 7126.8422s
	iters: 400, epoch: 49 | loss: 0.0000092
	speed: 0.3277s/iter; left time: 6906.4151s
Epoch: 49 cost time: 148.34708547592163
Epoch: 49, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.087 Vali Acc: 0.984 Test Loss: 0.087 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 50 | loss: 0.1180551
	speed: 0.7120s/iter; left time: 14926.6894s
	iters: 200, epoch: 50 | loss: 0.0000000
	speed: 0.3511s/iter; left time: 7324.9481s
	iters: 300, epoch: 50 | loss: 0.0000044
	speed: 0.3367s/iter; left time: 6990.5418s
	iters: 400, epoch: 50 | loss: 0.0000152
	speed: 0.3476s/iter; left time: 7182.9199s
Epoch: 50 cost time: 145.294664144516
Epoch: 50, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.085 Vali Acc: 0.984 Test Loss: 0.085 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 51 | loss: 0.0000000
	speed: 0.7083s/iter; left time: 14555.3347s
	iters: 200, epoch: 51 | loss: 0.0000050
	speed: 0.3518s/iter; left time: 7195.6321s
	iters: 300, epoch: 51 | loss: 0.0000000
	speed: 0.3388s/iter; left time: 6895.6552s
	iters: 400, epoch: 51 | loss: 0.0026509
	speed: 0.3654s/iter; left time: 7399.1822s
Epoch: 51 cost time: 145.10135555267334
Epoch: 51, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.111 Vali Acc: 0.984 Test Loss: 0.111 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 52 | loss: 0.0000175
	speed: 0.7384s/iter; left time: 14869.0682s
	iters: 200, epoch: 52 | loss: 0.0000000
	speed: 0.3591s/iter; left time: 7196.0073s
	iters: 300, epoch: 52 | loss: 0.0000000
	speed: 0.3567s/iter; left time: 7112.1413s
	iters: 400, epoch: 52 | loss: 0.0000000
	speed: 0.3428s/iter; left time: 6801.1550s
Epoch: 52 cost time: 146.48589372634888
Epoch: 52, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 53 | loss: 0.0000057
	speed: 0.7413s/iter; left time: 14622.6856s
	iters: 200, epoch: 53 | loss: 0.0000000
	speed: 0.3343s/iter; left time: 6561.4269s
	iters: 300, epoch: 53 | loss: 0.0000000
	speed: 0.3330s/iter; left time: 6501.4886s
	iters: 400, epoch: 53 | loss: 0.0000032
	speed: 0.3325s/iter; left time: 6458.2584s
Epoch: 53 cost time: 139.48381090164185
Epoch: 53, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.070 Vali Acc: 0.986 Test Loss: 0.070 Test Acc: 0.986
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 54 | loss: 0.0000000
	speed: 0.7262s/iter; left time: 14024.2269s
	iters: 200, epoch: 54 | loss: 0.0000215
	speed: 0.3447s/iter; left time: 6622.5533s
	iters: 300, epoch: 54 | loss: 0.0000000
	speed: 0.3557s/iter; left time: 6799.0247s
	iters: 400, epoch: 54 | loss: 0.0000000
	speed: 0.3412s/iter; left time: 6487.6009s
Epoch: 54 cost time: 144.63516998291016
Epoch: 54, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.140 Vali Acc: 0.979 Test Loss: 0.140 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df512_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.990450204638472
model parameter : 407178
model size : 4.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.0688663
	speed: 0.3851s/iter; left time: 15865.8590s
	iters: 200, epoch: 1 | loss: 0.5133578
	speed: 0.3692s/iter; left time: 15173.4974s
	iters: 300, epoch: 1 | loss: 0.7166482
	speed: 0.3914s/iter; left time: 16048.4215s
	iters: 400, epoch: 1 | loss: 0.1716594
	speed: 0.3693s/iter; left time: 15106.5404s
Epoch: 1 cost time: 156.63517689704895
Epoch: 1, Steps: 413 | Train Loss: 1.080 Vali Loss: 0.168 Vali Acc: 0.950 Test Loss: 0.168 Test Acc: 0.950
Validation loss decreased (inf --> -0.950430).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0345731
	speed: 0.7256s/iter; left time: 29596.9179s
	iters: 200, epoch: 2 | loss: 0.0549489
	speed: 0.3545s/iter; left time: 14425.2302s
	iters: 300, epoch: 2 | loss: 0.3046247
	speed: 0.3900s/iter; left time: 15828.9866s
	iters: 400, epoch: 2 | loss: 0.0354161
	speed: 0.3797s/iter; left time: 15374.3066s
Epoch: 2 cost time: 152.59943985939026
Epoch: 2, Steps: 413 | Train Loss: 0.120 Vali Loss: 0.082 Vali Acc: 0.970 Test Loss: 0.082 Test Acc: 0.970
Validation loss decreased (-0.950430 --> -0.970440).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0173211
	speed: 0.7740s/iter; left time: 31251.1742s
	iters: 200, epoch: 3 | loss: 0.0576562
	speed: 0.3784s/iter; left time: 15238.9451s
	iters: 300, epoch: 3 | loss: 0.0104642
	speed: 0.3799s/iter; left time: 15263.7614s
	iters: 400, epoch: 3 | loss: 0.0436996
	speed: 0.3812s/iter; left time: 15274.9092s
Epoch: 3 cost time: 156.11346554756165
Epoch: 3, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.065 Vali Acc: 0.978 Test Loss: 0.065 Test Acc: 0.978
Validation loss decreased (-0.970440 --> -0.978171).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0102255
	speed: 0.7711s/iter; left time: 30815.4871s
	iters: 200, epoch: 4 | loss: 0.2898839
	speed: 0.3822s/iter; left time: 15233.2860s
	iters: 300, epoch: 4 | loss: 0.0085823
	speed: 0.3737s/iter; left time: 14860.3123s
	iters: 400, epoch: 4 | loss: 0.0352211
	speed: 0.3621s/iter; left time: 14361.2934s
Epoch: 4 cost time: 155.20730352401733
Epoch: 4, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.047 Vali Acc: 0.982 Test Loss: 0.047 Test Acc: 0.982
Validation loss decreased (-0.978171 --> -0.981809).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0135821
	speed: 0.8216s/iter; left time: 32491.6077s
	iters: 200, epoch: 5 | loss: 0.0024252
	speed: 0.4172s/iter; left time: 16458.8860s
	iters: 300, epoch: 5 | loss: 0.0389635
	speed: 0.3760s/iter; left time: 14796.6929s
	iters: 400, epoch: 5 | loss: 0.0188207
	speed: 0.3635s/iter; left time: 14265.7265s
Epoch: 5 cost time: 161.67854046821594
Epoch: 5, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0129229
	speed: 0.7808s/iter; left time: 30557.3804s
	iters: 200, epoch: 6 | loss: 0.1732292
	speed: 0.3814s/iter; left time: 14887.8766s
	iters: 300, epoch: 6 | loss: 0.0023640
	speed: 0.3532s/iter; left time: 13750.7527s
	iters: 400, epoch: 6 | loss: 0.0502973
	speed: 0.3625s/iter; left time: 14079.4238s
Epoch: 6 cost time: 151.96596670150757
Epoch: 6, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.083 Vali Acc: 0.971 Test Loss: 0.083 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0042743
	speed: 0.7585s/iter; left time: 29371.0132s
	iters: 200, epoch: 7 | loss: 0.0010406
	speed: 0.3901s/iter; left time: 15068.5885s
	iters: 300, epoch: 7 | loss: 0.0002599
	speed: 0.3883s/iter; left time: 14957.7665s
	iters: 400, epoch: 7 | loss: 0.0077527
	speed: 0.3845s/iter; left time: 14772.5961s
Epoch: 7 cost time: 159.69850826263428
Epoch: 7, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.057 Vali Acc: 0.980 Test Loss: 0.057 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0001247
	speed: 0.8242s/iter; left time: 31575.4626s
	iters: 200, epoch: 8 | loss: 0.0003394
	speed: 0.3650s/iter; left time: 13946.6644s
	iters: 300, epoch: 8 | loss: 0.0015693
	speed: 0.3553s/iter; left time: 13540.1660s
	iters: 400, epoch: 8 | loss: 0.0125741
	speed: 0.3527s/iter; left time: 13404.3644s
Epoch: 8 cost time: 153.615802526474
Epoch: 8, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0003010
	speed: 0.7277s/iter; left time: 27577.1630s
	iters: 200, epoch: 9 | loss: 0.0005198
	speed: 0.3535s/iter; left time: 13359.4341s
	iters: 300, epoch: 9 | loss: 0.0103204
	speed: 0.3636s/iter; left time: 13706.7225s
	iters: 400, epoch: 9 | loss: 0.0004289
	speed: 0.3561s/iter; left time: 13389.7008s
Epoch: 9 cost time: 148.20498895645142
Epoch: 9, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0004991
	speed: 0.7635s/iter; left time: 28617.5851s
	iters: 200, epoch: 10 | loss: 0.0478474
	speed: 0.3622s/iter; left time: 13540.8568s
	iters: 300, epoch: 10 | loss: 0.0000527
	speed: 0.3667s/iter; left time: 13671.0449s
	iters: 400, epoch: 10 | loss: 0.0016363
	speed: 0.3427s/iter; left time: 12743.9619s
Epoch: 10 cost time: 150.50288343429565
Epoch: 10, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.092 Vali Acc: 0.972 Test Loss: 0.092 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0163556
	speed: 0.7038s/iter; left time: 26090.3821s
	iters: 200, epoch: 11 | loss: 0.0000403
	speed: 0.3416s/iter; left time: 12628.0364s
	iters: 300, epoch: 11 | loss: 0.0000055
	speed: 0.3603s/iter; left time: 13284.7721s
	iters: 400, epoch: 11 | loss: 0.1195038
	speed: 0.3402s/iter; left time: 12511.1959s
Epoch: 11 cost time: 143.8894488811493
Epoch: 11, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.126 Vali Acc: 0.974 Test Loss: 0.126 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0000108
	speed: 0.7271s/iter; left time: 26654.8223s
	iters: 200, epoch: 12 | loss: 0.0915069
	speed: 0.3607s/iter; left time: 13186.8238s
	iters: 300, epoch: 12 | loss: 0.0000996
	speed: 0.3742s/iter; left time: 13641.1466s
	iters: 400, epoch: 12 | loss: 0.0000007
	speed: 0.3655s/iter; left time: 13287.7530s
Epoch: 12 cost time: 149.9622344970703
Epoch: 12, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.073 Vali Acc: 0.979 Test Loss: 0.073 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0168950
	speed: 0.7289s/iter; left time: 26417.4176s
	iters: 200, epoch: 13 | loss: 0.1498263
	speed: 0.3552s/iter; left time: 12837.6571s
	iters: 300, epoch: 13 | loss: 0.0140258
	speed: 0.3548s/iter; left time: 12787.7245s
	iters: 400, epoch: 13 | loss: 0.0000374
	speed: 0.3526s/iter; left time: 12674.1934s
Epoch: 13 cost time: 146.05208897590637
Epoch: 13, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.252 Vali Acc: 0.958 Test Loss: 0.252 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000223
	speed: 0.7238s/iter; left time: 25935.5289s
	iters: 200, epoch: 14 | loss: 0.1370070
	speed: 0.3616s/iter; left time: 12921.6966s
	iters: 300, epoch: 14 | loss: 0.0000048
	speed: 0.3627s/iter; left time: 12924.1353s
	iters: 400, epoch: 14 | loss: 0.0481838
	speed: 0.3869s/iter; left time: 13748.5017s
Epoch: 14 cost time: 152.12819004058838
Epoch: 14, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.132 Vali Acc: 0.969 Test Loss: 0.132 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9818099135970896
model parameter : 407178
model size : 4.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.1073887
	speed: 0.4148s/iter; left time: 17090.4934s
	iters: 200, epoch: 1 | loss: 0.5948730
	speed: 0.3819s/iter; left time: 15697.3572s
	iters: 300, epoch: 1 | loss: 0.9545587
	speed: 0.3548s/iter; left time: 14546.6168s
	iters: 400, epoch: 1 | loss: 0.1598827
	speed: 0.3610s/iter; left time: 14763.8329s
Epoch: 1 cost time: 155.67057299613953
Epoch: 1, Steps: 413 | Train Loss: 1.104 Vali Loss: 0.176 Vali Acc: 0.950 Test Loss: 0.176 Test Acc: 0.950
Validation loss decreased (inf --> -0.949521).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0438706
	speed: 0.7286s/iter; left time: 29716.8468s
	iters: 200, epoch: 2 | loss: 0.0404819
	speed: 0.3570s/iter; left time: 14526.6032s
	iters: 300, epoch: 2 | loss: 0.3487462
	speed: 0.3667s/iter; left time: 14885.4522s
	iters: 400, epoch: 2 | loss: 0.0309230
	speed: 0.3818s/iter; left time: 15457.8239s
Epoch: 2 cost time: 152.48085927963257
Epoch: 2, Steps: 413 | Train Loss: 0.136 Vali Loss: 0.072 Vali Acc: 0.976 Test Loss: 0.072 Test Acc: 0.976
Validation loss decreased (-0.949521 --> -0.975897).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0606868
	speed: 0.7582s/iter; left time: 30611.9741s
	iters: 200, epoch: 3 | loss: 0.0875394
	speed: 0.3522s/iter; left time: 14185.4297s
	iters: 300, epoch: 3 | loss: 0.0857563
	speed: 0.3768s/iter; left time: 15139.6127s
	iters: 400, epoch: 3 | loss: 0.0276454
	speed: 0.3847s/iter; left time: 15418.0252s
Epoch: 3 cost time: 153.46902132034302
Epoch: 3, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0367881
	speed: 0.7586s/iter; left time: 30316.6792s
	iters: 200, epoch: 4 | loss: 0.0600899
	speed: 0.3933s/iter; left time: 15679.1081s
	iters: 300, epoch: 4 | loss: 0.0541878
	speed: 0.3775s/iter; left time: 15008.3218s
	iters: 400, epoch: 4 | loss: 0.0036585
	speed: 0.3565s/iter; left time: 14138.0666s
Epoch: 4 cost time: 155.0731749534607
Epoch: 4, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.065 Vali Acc: 0.976 Test Loss: 0.065 Test Acc: 0.976
Validation loss decreased (-0.975897 --> -0.976352).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0203732
	speed: 0.7614s/iter; left time: 30111.7703s
	iters: 200, epoch: 5 | loss: 0.0060842
	speed: 0.3894s/iter; left time: 15359.7298s
	iters: 300, epoch: 5 | loss: 0.0018865
	speed: 0.3577s/iter; left time: 14076.8900s
	iters: 400, epoch: 5 | loss: 0.0006320
	speed: 0.3604s/iter; left time: 14145.2715s
Epoch: 5 cost time: 154.158518075943
Epoch: 5, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0140304
	speed: 0.7773s/iter; left time: 30419.4104s
	iters: 200, epoch: 6 | loss: 0.3142249
	speed: 0.3499s/iter; left time: 13658.1673s
	iters: 300, epoch: 6 | loss: 0.0703257
	speed: 0.3561s/iter; left time: 13864.9888s
	iters: 400, epoch: 6 | loss: 0.1039198
	speed: 0.3715s/iter; left time: 14427.4222s
Epoch: 6 cost time: 149.90998148918152
Epoch: 6, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.077 Vali Acc: 0.974 Test Loss: 0.077 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0183180
	speed: 0.7898s/iter; left time: 30581.9785s
	iters: 200, epoch: 7 | loss: 0.1008074
	speed: 0.3621s/iter; left time: 13984.6562s
	iters: 300, epoch: 7 | loss: 0.1321796
	speed: 0.3517s/iter; left time: 13547.0892s
	iters: 400, epoch: 7 | loss: 0.0993591
	speed: 0.3687s/iter; left time: 14166.0499s
Epoch: 7 cost time: 152.70211338996887
Epoch: 7, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.2124247
	speed: 0.7140s/iter; left time: 27354.9857s
	iters: 200, epoch: 8 | loss: 0.0086326
	speed: 0.3632s/iter; left time: 13876.5610s
	iters: 300, epoch: 8 | loss: 0.0007747
	speed: 0.3579s/iter; left time: 13639.6895s
	iters: 400, epoch: 8 | loss: 0.0137359
	speed: 0.3799s/iter; left time: 14438.2715s
Epoch: 8 cost time: 148.91109442710876
Epoch: 8, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0013973
	speed: 0.7557s/iter; left time: 28636.8770s
	iters: 200, epoch: 9 | loss: 0.0691484
	speed: 0.3610s/iter; left time: 13645.1805s
	iters: 300, epoch: 9 | loss: 0.0044101
	speed: 0.3742s/iter; left time: 14104.7530s
	iters: 400, epoch: 9 | loss: 0.1369538
	speed: 0.3670s/iter; left time: 13798.0866s
Epoch: 9 cost time: 151.31993436813354
Epoch: 9, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0002277
	speed: 0.7592s/iter; left time: 28456.4320s
	iters: 200, epoch: 10 | loss: 0.0332014
	speed: 0.3480s/iter; left time: 13008.3755s
	iters: 300, epoch: 10 | loss: 0.0001370
	speed: 0.3624s/iter; left time: 13512.6671s
	iters: 400, epoch: 10 | loss: 0.0012847
	speed: 0.3652s/iter; left time: 13578.7310s
Epoch: 10 cost time: 148.75367212295532
Epoch: 10, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.165 Vali Acc: 0.970 Test Loss: 0.165 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0006650
	speed: 0.7219s/iter; left time: 26762.1832s
	iters: 200, epoch: 11 | loss: 0.3120999
	speed: 0.3592s/iter; left time: 13280.6971s
	iters: 300, epoch: 11 | loss: 0.0174956
	speed: 0.3848s/iter; left time: 14187.6757s
	iters: 400, epoch: 11 | loss: 0.0353565
	speed: 0.3871s/iter; left time: 14234.0866s
Epoch: 11 cost time: 153.00963759422302
Epoch: 11, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0010830
	speed: 0.7504s/iter; left time: 27506.9723s
	iters: 200, epoch: 12 | loss: 0.1188721
	speed: 0.3646s/iter; left time: 13330.3117s
	iters: 300, epoch: 12 | loss: 0.0002407
	speed: 0.3727s/iter; left time: 13588.1335s
	iters: 400, epoch: 12 | loss: 0.2316393
	speed: 0.3705s/iter; left time: 13469.9999s
Epoch: 12 cost time: 152.63223838806152
Epoch: 12, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.176 Vali Acc: 0.971 Test Loss: 0.176 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0004811
	speed: 0.7544s/iter; left time: 27344.2870s
	iters: 200, epoch: 13 | loss: 0.0152319
	speed: 0.3914s/iter; left time: 14148.2027s
	iters: 300, epoch: 13 | loss: 0.0001424
	speed: 0.3762s/iter; left time: 13559.5772s
	iters: 400, epoch: 13 | loss: 0.0003239
	speed: 0.3767s/iter; left time: 13538.7096s
Epoch: 13 cost time: 155.71081447601318
Epoch: 13, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.150 Vali Acc: 0.970 Test Loss: 0.150 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000081
	speed: 0.7293s/iter; left time: 26130.5283s
	iters: 200, epoch: 14 | loss: 0.0536535
	speed: 0.3510s/iter; left time: 12541.1893s
	iters: 300, epoch: 14 | loss: 0.0000700
	speed: 0.3461s/iter; left time: 12332.1918s
	iters: 400, epoch: 14 | loss: 0.0000053
	speed: 0.3607s/iter; left time: 12815.6871s
Epoch: 14 cost time: 146.67898106575012
Epoch: 14, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.138 Vali Acc: 0.967 Test Loss: 0.138 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9763528876762164
model parameter : 407178
model size : 4.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.1013975
	speed: 0.3737s/iter; left time: 15396.0419s
	iters: 200, epoch: 1 | loss: 0.5686620
	speed: 0.3686s/iter; left time: 15150.9219s
	iters: 300, epoch: 1 | loss: 0.8098301
	speed: 0.3802s/iter; left time: 15587.3050s
	iters: 400, epoch: 1 | loss: 0.2513367
	speed: 0.3773s/iter; left time: 15432.9069s
Epoch: 1 cost time: 155.169935464859
Epoch: 1, Steps: 413 | Train Loss: 1.085 Vali Loss: 0.143 Vali Acc: 0.964 Test Loss: 0.143 Test Acc: 0.964
Validation loss decreased (inf --> -0.963618).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0394872
	speed: 0.7456s/iter; left time: 30411.5131s
	iters: 200, epoch: 2 | loss: 0.0590492
	speed: 0.3759s/iter; left time: 15293.2687s
	iters: 300, epoch: 2 | loss: 0.1840862
	speed: 0.3618s/iter; left time: 14686.0253s
	iters: 400, epoch: 2 | loss: 0.0161023
	speed: 0.3385s/iter; left time: 13703.7649s
Epoch: 2 cost time: 148.34717321395874
Epoch: 2, Steps: 413 | Train Loss: 0.122 Vali Loss: 0.073 Vali Acc: 0.974 Test Loss: 0.073 Test Acc: 0.974
Validation loss decreased (-0.963618 --> -0.974078).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0201256
	speed: 0.7431s/iter; left time: 30001.9837s
	iters: 200, epoch: 3 | loss: 0.1002511
	speed: 0.3778s/iter; left time: 15216.7143s
	iters: 300, epoch: 3 | loss: 0.1760996
	speed: 0.3651s/iter; left time: 14667.3336s
	iters: 400, epoch: 3 | loss: 0.0352847
	speed: 0.3538s/iter; left time: 14177.3570s
Epoch: 3 cost time: 152.64511847496033
Epoch: 3, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.093 Vali Acc: 0.969 Test Loss: 0.093 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0085633
	speed: 0.7399s/iter; left time: 29568.6491s
	iters: 200, epoch: 4 | loss: 0.1095134
	speed: 0.3433s/iter; left time: 13685.0729s
	iters: 300, epoch: 4 | loss: 0.0178145
	speed: 0.3537s/iter; left time: 14065.4911s
	iters: 400, epoch: 4 | loss: 0.0116347
	speed: 0.3767s/iter; left time: 14941.6921s
Epoch: 4 cost time: 148.9048957824707
Epoch: 4, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.073 Vali Acc: 0.973 Test Loss: 0.073 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0118663
	speed: 0.7861s/iter; left time: 31090.3560s
	iters: 200, epoch: 5 | loss: 0.0011054
	speed: 0.3377s/iter; left time: 13323.7062s
	iters: 300, epoch: 5 | loss: 0.0042720
	speed: 0.3572s/iter; left time: 14057.4232s
	iters: 400, epoch: 5 | loss: 0.0282119
	speed: 0.3765s/iter; left time: 14777.5468s
Epoch: 5 cost time: 150.0588436126709
Epoch: 5, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.057 Vali Acc: 0.979 Test Loss: 0.057 Test Acc: 0.979
Validation loss decreased (-0.974078 --> -0.978626).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0364649
	speed: 0.7636s/iter; left time: 29884.6151s
	iters: 200, epoch: 6 | loss: 0.5193968
	speed: 0.3879s/iter; left time: 15142.0181s
	iters: 300, epoch: 6 | loss: 0.0007390
	speed: 0.3914s/iter; left time: 15240.1335s
	iters: 400, epoch: 6 | loss: 0.2048198
	speed: 0.3582s/iter; left time: 13909.2770s
Epoch: 6 cost time: 155.437273979187
Epoch: 6, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.091 Vali Acc: 0.967 Test Loss: 0.091 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0049375
	speed: 0.7215s/iter; left time: 27938.3261s
	iters: 200, epoch: 7 | loss: 0.0885612
	speed: 0.3661s/iter; left time: 14140.0825s
	iters: 300, epoch: 7 | loss: 0.0033152
	speed: 0.3771s/iter; left time: 14527.3345s
	iters: 400, epoch: 7 | loss: 0.0073839
	speed: 0.3482s/iter; left time: 13379.9284s
Epoch: 7 cost time: 150.91439628601074
Epoch: 7, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0016941
	speed: 0.7660s/iter; left time: 29344.2829s
	iters: 200, epoch: 8 | loss: 0.0005897
	speed: 0.3882s/iter; left time: 14831.5850s
	iters: 300, epoch: 8 | loss: 0.0450721
	speed: 0.3861s/iter; left time: 14713.7925s
	iters: 400, epoch: 8 | loss: 0.0082320
	speed: 0.3878s/iter; left time: 14741.2989s
Epoch: 8 cost time: 160.13433480262756
Epoch: 8, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.152 Vali Acc: 0.962 Test Loss: 0.152 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0099477
	speed: 0.7584s/iter; left time: 28740.8236s
	iters: 200, epoch: 9 | loss: 0.0182373
	speed: 0.3488s/iter; left time: 13182.3624s
	iters: 300, epoch: 9 | loss: 0.0010081
	speed: 0.3522s/iter; left time: 13275.7103s
	iters: 400, epoch: 9 | loss: 0.0036290
	speed: 0.3526s/iter; left time: 13255.9897s
Epoch: 9 cost time: 148.7571988105774
Epoch: 9, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.183 Vali Acc: 0.959 Test Loss: 0.183 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0010019
	speed: 0.7887s/iter; left time: 29563.2404s
	iters: 200, epoch: 10 | loss: 0.3218448
	speed: 0.3913s/iter; left time: 14628.2631s
	iters: 300, epoch: 10 | loss: 0.0003595
	speed: 0.3956s/iter; left time: 14749.1857s
	iters: 400, epoch: 10 | loss: 0.0679779
	speed: 0.3805s/iter; left time: 14148.3282s
Epoch: 10 cost time: 161.338529586792
Epoch: 10, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0001490
	speed: 0.7524s/iter; left time: 27890.4464s
	iters: 200, epoch: 11 | loss: 0.0017487
	speed: 0.3509s/iter; left time: 12972.4448s
	iters: 300, epoch: 11 | loss: 0.0001585
	speed: 0.3637s/iter; left time: 13409.8866s
	iters: 400, epoch: 11 | loss: 0.0242935
	speed: 0.3681s/iter; left time: 13536.1892s
Epoch: 11 cost time: 149.91597270965576
Epoch: 11, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0005989
	speed: 0.7517s/iter; left time: 27556.1550s
	iters: 200, epoch: 12 | loss: 0.0001200
	speed: 0.3526s/iter; left time: 12890.7753s
	iters: 300, epoch: 12 | loss: 0.0000054
	speed: 0.3515s/iter; left time: 12814.0372s
	iters: 400, epoch: 12 | loss: 0.0384543
	speed: 0.3725s/iter; left time: 13544.5042s
Epoch: 12 cost time: 149.16296911239624
Epoch: 12, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0006448
	speed: 0.7134s/iter; left time: 25855.7525s
	iters: 200, epoch: 13 | loss: 0.0427604
	speed: 0.3453s/iter; left time: 12479.3468s
	iters: 300, epoch: 13 | loss: 0.0000482
	speed: 0.3562s/iter; left time: 12839.5142s
	iters: 400, epoch: 13 | loss: 0.0004335
	speed: 0.3641s/iter; left time: 13087.2538s
Epoch: 13 cost time: 146.00409817695618
Epoch: 13, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.131 Vali Acc: 0.978 Test Loss: 0.131 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0000030
	speed: 0.7659s/iter; left time: 27445.4617s
	iters: 200, epoch: 14 | loss: 0.0000474
	speed: 0.4080s/iter; left time: 14579.5306s
	iters: 300, epoch: 14 | loss: 0.0005630
	speed: 0.3968s/iter; left time: 14139.9415s
	iters: 400, epoch: 14 | loss: 0.0000138
	speed: 0.3539s/iter; left time: 12575.2891s
Epoch: 14 cost time: 158.71363878250122
Epoch: 14, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.194 Vali Acc: 0.965 Test Loss: 0.194 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0004398
	speed: 0.7129s/iter; left time: 25250.1175s
	iters: 200, epoch: 15 | loss: 0.0001629
	speed: 0.3651s/iter; left time: 12893.5700s
	iters: 300, epoch: 15 | loss: 0.0000097
	speed: 0.3596s/iter; left time: 12664.5070s
	iters: 400, epoch: 15 | loss: 0.0002634
	speed: 0.3768s/iter; left time: 13232.8631s
Epoch: 15 cost time: 150.40411901474
Epoch: 15, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.173 Vali Acc: 0.970 Test Loss: 0.173 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9786266484765803
model parameter : 407178
model size : 4.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.3008738
	speed: 0.4098s/iter; left time: 16884.7970s
	iters: 200, epoch: 1 | loss: 2.3035369
	speed: 0.3785s/iter; left time: 15558.2821s
	iters: 300, epoch: 1 | loss: 2.3030050
	speed: 0.3651s/iter; left time: 14970.4611s
	iters: 400, epoch: 1 | loss: 2.3051775
	speed: 0.3495s/iter; left time: 14296.5387s
Epoch: 1 cost time: 155.08619332313538
Epoch: 1, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (inf --> -0.099568).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3062463
	speed: 0.7471s/iter; left time: 30474.4027s
	iters: 200, epoch: 2 | loss: 2.3006177
	speed: 0.3450s/iter; left time: 14037.4148s
	iters: 300, epoch: 2 | loss: 2.2991631
	speed: 0.3515s/iter; left time: 14266.6340s
	iters: 400, epoch: 2 | loss: 2.3048439
	speed: 0.3637s/iter; left time: 14725.9776s
Epoch: 2 cost time: 146.97736024856567
Epoch: 2, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.099568 --> -0.100022).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3005800
	speed: 0.7709s/iter; left time: 31125.4557s
	iters: 200, epoch: 3 | loss: 2.3024414
	speed: 0.3620s/iter; left time: 14580.1868s
	iters: 300, epoch: 3 | loss: 2.3013942
	speed: 0.3450s/iter; left time: 13860.4667s
	iters: 400, epoch: 3 | loss: 2.3038454
	speed: 0.3694s/iter; left time: 14804.7126s
Epoch: 3 cost time: 151.8620150089264
Epoch: 3, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3040633
	speed: 0.7805s/iter; left time: 31192.0083s
	iters: 200, epoch: 4 | loss: 2.3014796
	speed: 0.3661s/iter; left time: 14593.3289s
	iters: 300, epoch: 4 | loss: 2.3023205
	speed: 0.3442s/iter; left time: 13684.9318s
	iters: 400, epoch: 4 | loss: 2.3039346
	speed: 0.3914s/iter; left time: 15524.1179s
Epoch: 4 cost time: 153.9998116493225
Epoch: 4, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.3035085
	speed: 0.7662s/iter; left time: 30303.2041s
	iters: 200, epoch: 5 | loss: 2.3016744
	speed: 0.3622s/iter; left time: 14288.5980s
	iters: 300, epoch: 5 | loss: 2.3002598
	speed: 0.3586s/iter; left time: 14111.7514s
	iters: 400, epoch: 5 | loss: 2.3029480
	speed: 0.3746s/iter; left time: 14704.3770s
Epoch: 5 cost time: 151.95869660377502
Epoch: 5, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.3049641
	speed: 0.7966s/iter; left time: 31176.8725s
	iters: 200, epoch: 6 | loss: 2.3040538
	speed: 0.3793s/iter; left time: 14805.4347s
	iters: 300, epoch: 6 | loss: 2.3018348
	speed: 0.3888s/iter; left time: 15140.0275s
	iters: 400, epoch: 6 | loss: 2.3030093
	speed: 0.3755s/iter; left time: 14584.6930s
Epoch: 6 cost time: 160.37232398986816
Epoch: 6, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 2.3019996
	speed: 0.7248s/iter; left time: 28066.4169s
	iters: 200, epoch: 7 | loss: 2.3042426
	speed: 0.3487s/iter; left time: 13468.6935s
	iters: 300, epoch: 7 | loss: 2.3044755
	speed: 0.3775s/iter; left time: 14541.7610s
	iters: 400, epoch: 7 | loss: 2.3035622
	speed: 0.3638s/iter; left time: 13978.9380s
Epoch: 7 cost time: 148.52350115776062
Epoch: 7, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 2.3047669
	speed: 0.7800s/iter; left time: 29880.4196s
	iters: 200, epoch: 8 | loss: 2.3008392
	speed: 0.3589s/iter; left time: 13715.2782s
	iters: 300, epoch: 8 | loss: 2.3082912
	speed: 0.3759s/iter; left time: 14326.9124s
	iters: 400, epoch: 8 | loss: 2.3054776
	speed: 0.4055s/iter; left time: 15411.7013s
Epoch: 8 cost time: 157.54607343673706
Epoch: 8, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 2.3008883
	speed: 0.7447s/iter; left time: 28220.7645s
	iters: 200, epoch: 9 | loss: 2.3031805
	speed: 0.3647s/iter; left time: 13783.8714s
	iters: 300, epoch: 9 | loss: 2.3040237
	speed: 0.3584s/iter; left time: 13510.2533s
	iters: 400, epoch: 9 | loss: 2.3033674
	speed: 0.3622s/iter; left time: 13619.1762s
Epoch: 9 cost time: 149.62643575668335
Epoch: 9, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 2.3026104
	speed: 0.8006s/iter; left time: 30009.4964s
	iters: 200, epoch: 10 | loss: 2.3029130
	speed: 0.3833s/iter; left time: 14330.6102s
	iters: 300, epoch: 10 | loss: 2.3016400
	speed: 0.4200s/iter; left time: 15659.2057s
	iters: 400, epoch: 10 | loss: 2.3041086
	speed: 0.3718s/iter; left time: 13826.7197s
Epoch: 10 cost time: 161.05800199508667
Epoch: 10, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 2.3011916
	speed: 0.7464s/iter; left time: 27668.2414s
	iters: 200, epoch: 11 | loss: 2.3031301
	speed: 0.3667s/iter; left time: 13557.8304s
	iters: 300, epoch: 11 | loss: 2.3018582
	speed: 0.3775s/iter; left time: 13920.0225s
	iters: 400, epoch: 11 | loss: 2.3049872
	speed: 0.3792s/iter; left time: 13941.7633s
Epoch: 11 cost time: 154.4425928592682
Epoch: 11, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 2.3022935
	speed: 0.7471s/iter; left time: 27386.3155s
	iters: 200, epoch: 12 | loss: 2.3029358
	speed: 0.3566s/iter; left time: 13038.1156s
	iters: 300, epoch: 12 | loss: 2.3043370
	speed: 0.3584s/iter; left time: 13066.9088s
	iters: 400, epoch: 12 | loss: 2.3031526
	speed: 0.3601s/iter; left time: 13090.7001s
Epoch: 12 cost time: 149.04582834243774
Epoch: 12, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 2.3024728
	speed: 0.7487s/iter; left time: 27137.6364s
	iters: 200, epoch: 13 | loss: 2.3034430
	speed: 0.3525s/iter; left time: 12742.7736s
	iters: 300, epoch: 13 | loss: 2.3048062
	speed: 0.3498s/iter; left time: 12609.8436s
	iters: 400, epoch: 13 | loss: 2.3028347
	speed: 0.3544s/iter; left time: 12740.1424s
Epoch: 13 cost time: 146.91226983070374
Epoch: 13, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.10004547521600728
model parameter : 407178
model size : 4.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         47                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df256_ma47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.9476160
	speed: 0.4073s/iter; left time: 16783.1287s
	iters: 200, epoch: 1 | loss: 0.4976511
	speed: 0.3451s/iter; left time: 14185.2517s
	iters: 300, epoch: 1 | loss: 0.2213001
	speed: 0.3475s/iter; left time: 14247.8462s
	iters: 400, epoch: 1 | loss: 0.0832175
	speed: 0.3429s/iter; left time: 14025.6066s
Epoch: 1 cost time: 149.30553102493286
Epoch: 1, Steps: 413 | Train Loss: 0.656 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
Validation loss decreased (inf --> -0.975897).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2214310
	speed: 0.7818s/iter; left time: 31887.8090s
	iters: 200, epoch: 2 | loss: 0.0179114
	speed: 0.3467s/iter; left time: 14108.1976s
	iters: 300, epoch: 2 | loss: 0.0638139
	speed: 0.3438s/iter; left time: 13953.0118s
	iters: 400, epoch: 2 | loss: 0.3424573
	speed: 0.3406s/iter; left time: 13788.6201s
Epoch: 2 cost time: 145.66413950920105
Epoch: 2, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.056 Vali Acc: 0.983 Test Loss: 0.056 Test Acc: 0.983
Validation loss decreased (-0.975897 --> -0.983174).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0112909
	speed: 0.7358s/iter; left time: 29707.3377s
	iters: 200, epoch: 3 | loss: 0.0251857
	speed: 0.3890s/iter; left time: 15666.1238s
	iters: 300, epoch: 3 | loss: 0.0796166
	speed: 0.3367s/iter; left time: 13525.2450s
	iters: 400, epoch: 3 | loss: 0.0087259
	speed: 0.3545s/iter; left time: 14207.6239s
Epoch: 3 cost time: 148.48694491386414
Epoch: 3, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.064 Vali Acc: 0.978 Test Loss: 0.064 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0011799
	speed: 0.7429s/iter; left time: 29687.2444s
	iters: 200, epoch: 4 | loss: 0.0011435
	speed: 0.3735s/iter; left time: 14888.5530s
	iters: 300, epoch: 4 | loss: 0.0032308
	speed: 0.3588s/iter; left time: 14264.9356s
	iters: 400, epoch: 4 | loss: 0.0107396
	speed: 0.3557s/iter; left time: 14106.4710s
Epoch: 4 cost time: 149.89781308174133
Epoch: 4, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.055 Vali Acc: 0.980 Test Loss: 0.055 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0304003
	speed: 0.7258s/iter; left time: 28706.5527s
	iters: 200, epoch: 5 | loss: 0.0040219
	speed: 0.3434s/iter; left time: 13545.4051s
	iters: 300, epoch: 5 | loss: 0.0005678
	speed: 0.3434s/iter; left time: 13512.4642s
	iters: 400, epoch: 5 | loss: 0.0055043
	speed: 0.3547s/iter; left time: 13921.8886s
Epoch: 5 cost time: 144.40198922157288
Epoch: 5, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.048 Vali Acc: 0.982 Test Loss: 0.048 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0024329
	speed: 0.7515s/iter; left time: 29410.2629s
	iters: 200, epoch: 6 | loss: 0.0011099
	speed: 0.3768s/iter; left time: 14707.2651s
	iters: 300, epoch: 6 | loss: 0.0111484
	speed: 0.3442s/iter; left time: 13400.8221s
	iters: 400, epoch: 6 | loss: 0.1505327
	speed: 0.3380s/iter; left time: 13127.2526s
Epoch: 6 cost time: 148.50752449035645
Epoch: 6, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0181825
	speed: 0.7212s/iter; left time: 27928.3607s
	iters: 200, epoch: 7 | loss: 0.0020277
	speed: 0.3477s/iter; left time: 13429.5737s
	iters: 300, epoch: 7 | loss: 0.0027918
	speed: 0.3640s/iter; left time: 14021.9027s
	iters: 400, epoch: 7 | loss: 0.0643492
	speed: 0.3485s/iter; left time: 13392.0246s
Epoch: 7 cost time: 146.92126369476318
Epoch: 7, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0017720
	speed: 0.7916s/iter; left time: 30325.3958s
	iters: 200, epoch: 8 | loss: 0.0001432
	speed: 0.3683s/iter; left time: 14073.3706s
	iters: 300, epoch: 8 | loss: 0.0001317
	speed: 0.3691s/iter; left time: 14066.5324s
	iters: 400, epoch: 8 | loss: 0.1789786
	speed: 0.3353s/iter; left time: 12742.9515s
Epoch: 8 cost time: 151.23505187034607
Epoch: 8, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.084 Vali Acc: 0.974 Test Loss: 0.084 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0013481
	speed: 0.7310s/iter; left time: 27701.9103s
	iters: 200, epoch: 9 | loss: 0.0152582
	speed: 0.3932s/iter; left time: 14862.9867s
	iters: 300, epoch: 9 | loss: 0.0005373
	speed: 0.3652s/iter; left time: 13768.3928s
	iters: 400, epoch: 9 | loss: 0.2448866
	speed: 0.3647s/iter; left time: 13710.9502s
Epoch: 9 cost time: 153.75417733192444
Epoch: 9, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.090 Vali Acc: 0.979 Test Loss: 0.090 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0002707
	speed: 0.7223s/iter; left time: 27075.0606s
	iters: 200, epoch: 10 | loss: 0.0022605
	speed: 0.3551s/iter; left time: 13273.4082s
	iters: 300, epoch: 10 | loss: 0.0003282
	speed: 0.3652s/iter; left time: 13615.5569s
	iters: 400, epoch: 10 | loss: 0.0217948
	speed: 0.3680s/iter; left time: 13685.3158s
Epoch: 10 cost time: 149.319194316864
Epoch: 10, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0000117
	speed: 0.7576s/iter; left time: 28085.3510s
	iters: 200, epoch: 11 | loss: 0.0064647
	speed: 0.3800s/iter; left time: 14047.4005s
	iters: 300, epoch: 11 | loss: 0.0000028
	speed: 0.3509s/iter; left time: 12939.4392s
	iters: 400, epoch: 11 | loss: 0.0000255
	speed: 0.3533s/iter; left time: 12990.6692s
Epoch: 11 cost time: 151.07838606834412
Epoch: 11, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.083 Vali Acc: 0.984 Test Loss: 0.083 Test Acc: 0.984
Validation loss decreased (-0.983174 --> -0.984083).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000353
	speed: 0.7964s/iter; left time: 29195.6251s
	iters: 200, epoch: 12 | loss: 0.0001418
	speed: 0.3839s/iter; left time: 14035.2136s
	iters: 300, epoch: 12 | loss: 0.0000129
	speed: 0.3919s/iter; left time: 14288.8719s
	iters: 400, epoch: 12 | loss: 0.0599174
	speed: 0.4077s/iter; left time: 14821.5613s
Epoch: 12 cost time: 163.61801290512085
Epoch: 12, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0199336
	speed: 0.8194s/iter; left time: 29699.0843s
	iters: 200, epoch: 13 | loss: 0.0000074
	speed: 0.3622s/iter; left time: 13092.9006s
	iters: 300, epoch: 13 | loss: 0.0715006
	speed: 0.3517s/iter; left time: 12678.0162s
	iters: 400, epoch: 13 | loss: 0.0025509
	speed: 0.3850s/iter; left time: 13839.8140s
Epoch: 13 cost time: 153.1529974937439
Epoch: 13, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.121 Vali Acc: 0.974 Test Loss: 0.121 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0467449
	speed: 0.7853s/iter; left time: 28137.1485s
	iters: 200, epoch: 14 | loss: 0.0000100
	speed: 0.3917s/iter; left time: 13994.8640s
	iters: 300, epoch: 14 | loss: 0.2523997
	speed: 0.3942s/iter; left time: 14046.7638s
	iters: 400, epoch: 14 | loss: 0.0002561
	speed: 0.3774s/iter; left time: 13408.1675s
Epoch: 14 cost time: 159.73124885559082
Epoch: 14, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0011732
	speed: 0.7574s/iter; left time: 26827.3298s
	iters: 200, epoch: 15 | loss: 0.0049248
	speed: 0.3912s/iter; left time: 13818.3412s
	iters: 300, epoch: 15 | loss: 0.0000198
	speed: 0.3879s/iter; left time: 13660.7243s
	iters: 400, epoch: 15 | loss: 0.0004249
	speed: 0.3823s/iter; left time: 13425.7244s
Epoch: 15 cost time: 159.03833508491516
Epoch: 15, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000051
	speed: 0.7611s/iter; left time: 26642.3150s
	iters: 200, epoch: 16 | loss: 0.0000687
	speed: 0.3804s/iter; left time: 13279.7069s
	iters: 300, epoch: 16 | loss: 0.0000120
	speed: 0.3821s/iter; left time: 13298.5479s
	iters: 400, epoch: 16 | loss: 0.0000008
	speed: 0.3710s/iter; left time: 12875.7933s
Epoch: 16 cost time: 157.0926158428192
Epoch: 16, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.085 Vali Acc: 0.987 Test Loss: 0.085 Test Acc: 0.987
Validation loss decreased (-0.984083 --> -0.986811).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0002154
	speed: 0.8165s/iter; left time: 28246.6702s
	iters: 200, epoch: 17 | loss: 0.0000008
	speed: 0.3977s/iter; left time: 13718.9795s
	iters: 300, epoch: 17 | loss: 0.0009531
	speed: 0.3929s/iter; left time: 13512.2940s
	iters: 400, epoch: 17 | loss: 0.0001418
	speed: 0.3639s/iter; left time: 12480.0510s
Epoch: 17 cost time: 161.23403191566467
Epoch: 17, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000010
	speed: 0.7717s/iter; left time: 26377.1422s
	iters: 200, epoch: 18 | loss: 0.0000018
	speed: 0.3704s/iter; left time: 12621.7203s
	iters: 300, epoch: 18 | loss: 0.0177512
	speed: 0.4043s/iter; left time: 13737.2630s
	iters: 400, epoch: 18 | loss: 0.0013071
	speed: 0.3888s/iter; left time: 13171.5813s
Epoch: 18 cost time: 159.06400728225708
Epoch: 18, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.220 Vali Acc: 0.968 Test Loss: 0.220 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000081
	speed: 0.8095s/iter; left time: 27332.7935s
	iters: 200, epoch: 19 | loss: 0.0006843
	speed: 0.3708s/iter; left time: 12482.6729s
	iters: 300, epoch: 19 | loss: 0.1364397
	speed: 0.3647s/iter; left time: 12241.1858s
	iters: 400, epoch: 19 | loss: 0.0027420
	speed: 0.3694s/iter; left time: 12362.1424s
Epoch: 19 cost time: 153.74496984481812
Epoch: 19, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.122 Vali Acc: 0.979 Test Loss: 0.122 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0005246
	speed: 0.7733s/iter; left time: 25793.7926s
	iters: 200, epoch: 20 | loss: 0.0004933
	speed: 0.3615s/iter; left time: 12019.8886s
	iters: 300, epoch: 20 | loss: 0.0000112
	speed: 0.3467s/iter; left time: 11495.8322s
	iters: 400, epoch: 20 | loss: 0.0000030
	speed: 0.3755s/iter; left time: 12411.5990s
Epoch: 20 cost time: 152.38546109199524
Epoch: 20, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.092 Vali Acc: 0.982 Test Loss: 0.092 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000001
	speed: 0.7957s/iter; left time: 26212.3778s
	iters: 200, epoch: 21 | loss: 0.0000024
	speed: 0.3902s/iter; left time: 12815.1909s
	iters: 300, epoch: 21 | loss: 0.0750043
	speed: 0.3934s/iter; left time: 12880.1216s
	iters: 400, epoch: 21 | loss: 0.0000008
	speed: 0.3771s/iter; left time: 12308.9400s
Epoch: 21 cost time: 159.14673447608948
Epoch: 21, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.146 Vali Acc: 0.979 Test Loss: 0.146 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0000445
	speed: 0.7737s/iter; left time: 25167.4263s
	iters: 200, epoch: 22 | loss: 0.0000002
	speed: 0.3794s/iter; left time: 12303.9519s
	iters: 300, epoch: 22 | loss: 0.0000190
	speed: 0.4033s/iter; left time: 13037.9132s
	iters: 400, epoch: 22 | loss: 0.0005901
	speed: 0.4055s/iter; left time: 13070.0225s
Epoch: 22 cost time: 162.049222946167
Epoch: 22, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.122 Vali Acc: 0.978 Test Loss: 0.122 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0000387
	speed: 0.7369s/iter; left time: 23664.2252s
	iters: 200, epoch: 23 | loss: 0.0000889
	speed: 0.3625s/iter; left time: 11603.9718s
	iters: 300, epoch: 23 | loss: 0.0974470
	speed: 0.3834s/iter; left time: 12237.0029s
	iters: 400, epoch: 23 | loss: 0.0000219
	speed: 0.3965s/iter; left time: 12614.7850s
Epoch: 23 cost time: 155.42980694770813
Epoch: 23, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0000230
	speed: 0.7775s/iter; left time: 24647.6304s
	iters: 200, epoch: 24 | loss: 0.0000013
	speed: 0.3707s/iter; left time: 11714.7628s
	iters: 300, epoch: 24 | loss: 0.0000338
	speed: 0.3877s/iter; left time: 12212.9840s
	iters: 400, epoch: 24 | loss: 0.0000002
	speed: 0.3728s/iter; left time: 11705.6285s
Epoch: 24 cost time: 157.7292764186859
Epoch: 24, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.049 Vali Acc: 0.989 Test Loss: 0.049 Test Acc: 0.989
Validation loss decreased (-0.986811 --> -0.989085).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0000017
	speed: 0.7674s/iter; left time: 24011.0613s
	iters: 200, epoch: 25 | loss: 0.0000513
	speed: 0.3786s/iter; left time: 11809.5713s
	iters: 300, epoch: 25 | loss: 0.0000445
	speed: 0.3872s/iter; left time: 12037.6451s
	iters: 400, epoch: 25 | loss: 0.0000330
	speed: 0.3542s/iter; left time: 10976.9519s
Epoch: 25 cost time: 153.91023540496826
Epoch: 25, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.051 Vali Acc: 0.990 Test Loss: 0.051 Test Acc: 0.990
Validation loss decreased (-0.989085 --> -0.989995).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0056214
	speed: 0.7348s/iter; left time: 22689.2141s
	iters: 200, epoch: 26 | loss: 0.0000024
	speed: 0.3625s/iter; left time: 11154.7872s
	iters: 300, epoch: 26 | loss: 0.0000084
	speed: 0.3702s/iter; left time: 11357.5384s
	iters: 400, epoch: 26 | loss: 0.0000006
	speed: 0.3670s/iter; left time: 11219.9902s
Epoch: 26 cost time: 150.31795048713684
Epoch: 26, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.053 Vali Acc: 0.989 Test Loss: 0.053 Test Acc: 0.989
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0000002
	speed: 0.7235s/iter; left time: 22038.5541s
	iters: 200, epoch: 27 | loss: 0.0000002
	speed: 0.3473s/iter; left time: 10545.2893s
	iters: 300, epoch: 27 | loss: 0.0001385
	speed: 0.3683s/iter; left time: 11147.2126s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.3667s/iter; left time: 11059.5316s
Epoch: 27 cost time: 148.19817471504211
Epoch: 27, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.050 Vali Acc: 0.986 Test Loss: 0.050 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.0279360
	speed: 0.7566s/iter; left time: 22735.1817s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.4046s/iter; left time: 12118.4999s
	iters: 300, epoch: 28 | loss: 0.0030217
	speed: 0.4127s/iter; left time: 12318.6543s
	iters: 400, epoch: 28 | loss: 0.0002664
	speed: 0.4374s/iter; left time: 13013.3190s
Epoch: 28 cost time: 168.98724842071533
Epoch: 28, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.152 Vali Acc: 0.975 Test Loss: 0.152 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0000640
	speed: 0.7901s/iter; left time: 23414.9184s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.3690s/iter; left time: 10899.1483s
	iters: 300, epoch: 29 | loss: 0.0000010
	speed: 0.3416s/iter; left time: 10054.6320s
	iters: 400, epoch: 29 | loss: 0.0106502
	speed: 0.3359s/iter; left time: 9853.8667s
Epoch: 29 cost time: 148.73833656311035
Epoch: 29, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.0000003
	speed: 0.7507s/iter; left time: 21939.4123s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.3530s/iter; left time: 10280.9678s
	iters: 300, epoch: 30 | loss: 0.0000013
	speed: 0.3828s/iter; left time: 11111.7746s
	iters: 400, epoch: 30 | loss: 0.0004118
	speed: 0.3666s/iter; left time: 10604.1207s
Epoch: 30 cost time: 152.1534299850464
Epoch: 30, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.124 Vali Acc: 0.978 Test Loss: 0.124 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.0000023
	speed: 0.7234s/iter; left time: 20842.8294s
	iters: 200, epoch: 31 | loss: 0.0000129
	speed: 0.3584s/iter; left time: 10290.8628s
	iters: 300, epoch: 31 | loss: 0.0000179
	speed: 0.3733s/iter; left time: 10680.9347s
	iters: 400, epoch: 31 | loss: 0.0000071
	speed: 0.3662s/iter; left time: 10440.0676s
Epoch: 31 cost time: 149.19384026527405
Epoch: 31, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.985 Test Loss: 0.088 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.0000016
	speed: 0.7463s/iter; left time: 21194.4098s
	iters: 200, epoch: 32 | loss: 0.0000521
	speed: 0.3522s/iter; left time: 9967.5655s
	iters: 300, epoch: 32 | loss: 0.0000007
	speed: 0.3557s/iter; left time: 10029.7352s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.3564s/iter; left time: 10013.1352s
Epoch: 32 cost time: 148.28234219551086
Epoch: 32, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.071 Vali Acc: 0.984 Test Loss: 0.071 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.0000398
	speed: 0.7377s/iter; left time: 20643.2757s
	iters: 200, epoch: 33 | loss: 0.0000022
	speed: 0.3956s/iter; left time: 11031.6461s
	iters: 300, epoch: 33 | loss: 0.0000029
	speed: 0.3929s/iter; left time: 10916.2309s
	iters: 400, epoch: 33 | loss: 0.0000002
	speed: 0.3597s/iter; left time: 9957.4131s
Epoch: 33 cost time: 155.8896882534027
Epoch: 33, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.088 Vali Acc: 0.982 Test Loss: 0.088 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.0105096
	speed: 0.7444s/iter; left time: 20524.3621s
	iters: 200, epoch: 34 | loss: 0.0018413
	speed: 0.3696s/iter; left time: 10153.1841s
	iters: 300, epoch: 34 | loss: 0.0000124
	speed: 0.3840s/iter; left time: 10509.9433s
	iters: 400, epoch: 34 | loss: 0.0000837
	speed: 0.3475s/iter; left time: 9476.9217s
Epoch: 34 cost time: 151.10491633415222
Epoch: 34, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.093 Vali Acc: 0.986 Test Loss: 0.093 Test Acc: 0.986
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.0000025
	speed: 0.7179s/iter; left time: 19498.6897s
	iters: 200, epoch: 35 | loss: 0.0000172
	speed: 0.3653s/iter; left time: 9885.8979s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.3705s/iter; left time: 9987.6872s
	iters: 400, epoch: 35 | loss: 0.0000017
	speed: 0.3357s/iter; left time: 9015.4538s
Epoch: 35 cost time: 147.31975412368774
Epoch: 35, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df256_ma47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9899954524783993
model parameter : 308874
model size : 3.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         38                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df256_ma38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.9978017
	speed: 0.4221s/iter; left time: 17392.2074s
	iters: 200, epoch: 1 | loss: 0.5807167
	speed: 0.3763s/iter; left time: 15465.6583s
	iters: 300, epoch: 1 | loss: 0.1205089
	speed: 0.3620s/iter; left time: 14840.3949s
	iters: 400, epoch: 1 | loss: 0.1059212
	speed: 0.3645s/iter; left time: 14907.2469s
Epoch: 1 cost time: 157.52143096923828
Epoch: 1, Steps: 413 | Train Loss: 0.689 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
Validation loss decreased (inf --> -0.975442).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2793294
	speed: 0.7519s/iter; left time: 30669.0085s
	iters: 200, epoch: 2 | loss: 0.0449265
	speed: 0.3976s/iter; left time: 16177.5017s
	iters: 300, epoch: 2 | loss: 0.0171150
	speed: 0.3973s/iter; left time: 16126.6194s
	iters: 400, epoch: 2 | loss: 0.2519043
	speed: 0.3983s/iter; left time: 16128.1946s
Epoch: 2 cost time: 160.47907423973083
Epoch: 2, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.058 Vali Acc: 0.979 Test Loss: 0.058 Test Acc: 0.979
Validation loss decreased (-0.975442 --> -0.979081).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0095865
	speed: 0.7627s/iter; left time: 30792.4381s
	iters: 200, epoch: 3 | loss: 0.0554032
	speed: 0.3515s/iter; left time: 14157.2026s
	iters: 300, epoch: 3 | loss: 0.0217715
	speed: 0.3445s/iter; left time: 13839.0056s
	iters: 400, epoch: 3 | loss: 0.0083512
	speed: 0.3764s/iter; left time: 15084.5200s
Epoch: 3 cost time: 149.64956521987915
Epoch: 3, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.058 Vali Acc: 0.981 Test Loss: 0.058 Test Acc: 0.981
Validation loss decreased (-0.979081 --> -0.980900).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0062367
	speed: 0.7736s/iter; left time: 30914.7413s
	iters: 200, epoch: 4 | loss: 0.0056822
	speed: 0.3741s/iter; left time: 14913.7590s
	iters: 300, epoch: 4 | loss: 0.0022083
	speed: 0.3503s/iter; left time: 13930.0256s
	iters: 400, epoch: 4 | loss: 0.0241137
	speed: 0.3583s/iter; left time: 14210.9326s
Epoch: 4 cost time: 150.43933272361755
Epoch: 4, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0260345
	speed: 0.7760s/iter; left time: 30690.2563s
	iters: 200, epoch: 5 | loss: 0.0046625
	speed: 0.3634s/iter; left time: 14336.1393s
	iters: 300, epoch: 5 | loss: 0.0027354
	speed: 0.3905s/iter; left time: 15364.8522s
	iters: 400, epoch: 5 | loss: 0.0052916
	speed: 0.3785s/iter; left time: 14855.9462s
Epoch: 5 cost time: 157.22354221343994
Epoch: 5, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.062 Vali Acc: 0.979 Test Loss: 0.062 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0011243
	speed: 0.7459s/iter; left time: 29193.3746s
	iters: 200, epoch: 6 | loss: 0.0001639
	speed: 0.3606s/iter; left time: 14076.8595s
	iters: 300, epoch: 6 | loss: 0.0118527
	speed: 0.3729s/iter; left time: 14518.0421s
	iters: 400, epoch: 6 | loss: 0.0147668
	speed: 0.3669s/iter; left time: 14249.4070s
Epoch: 6 cost time: 150.28638172149658
Epoch: 6, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0007831
	speed: 0.7405s/iter; left time: 28672.8416s
	iters: 200, epoch: 7 | loss: 0.0421319
	speed: 0.4121s/iter; left time: 15915.3570s
	iters: 300, epoch: 7 | loss: 0.0003951
	speed: 0.3846s/iter; left time: 14815.9618s
	iters: 400, epoch: 7 | loss: 0.0007029
	speed: 0.3674s/iter; left time: 14115.6000s
Epoch: 7 cost time: 159.3656666278839
Epoch: 7, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.108 Vali Acc: 0.972 Test Loss: 0.108 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0041203
	speed: 0.7462s/iter; left time: 28587.4558s
	iters: 200, epoch: 8 | loss: 0.0283835
	speed: 0.3703s/iter; left time: 14150.9229s
	iters: 300, epoch: 8 | loss: 0.0317904
	speed: 0.3863s/iter; left time: 14720.1393s
	iters: 400, epoch: 8 | loss: 0.1284009
	speed: 0.3536s/iter; left time: 13440.9742s
Epoch: 8 cost time: 153.84344339370728
Epoch: 8, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0001903
	speed: 0.7156s/iter; left time: 27120.7684s
	iters: 200, epoch: 9 | loss: 0.0000304
	speed: 0.3434s/iter; left time: 12981.3036s
	iters: 300, epoch: 9 | loss: 0.0024898
	speed: 0.3699s/iter; left time: 13945.6433s
	iters: 400, epoch: 9 | loss: 0.0000546
	speed: 0.4029s/iter; left time: 15147.2458s
Epoch: 9 cost time: 151.75114226341248
Epoch: 9, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0005560
	speed: 0.7649s/iter; left time: 28671.3561s
	iters: 200, epoch: 10 | loss: 0.0005654
	speed: 0.3742s/iter; left time: 13988.0434s
	iters: 300, epoch: 10 | loss: 0.0000790
	speed: 0.3744s/iter; left time: 13957.3432s
	iters: 400, epoch: 10 | loss: 0.0000410
	speed: 0.3665s/iter; left time: 13627.7145s
Epoch: 10 cost time: 153.31213545799255
Epoch: 10, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.057 Vali Acc: 0.985 Test Loss: 0.057 Test Acc: 0.985
Validation loss decreased (-0.980900 --> -0.984538).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000049
	speed: 0.7776s/iter; left time: 28827.2309s
	iters: 200, epoch: 11 | loss: 0.0014460
	speed: 0.3887s/iter; left time: 14369.2117s
	iters: 300, epoch: 11 | loss: 0.0390916
	speed: 0.3599s/iter; left time: 13269.7515s
	iters: 400, epoch: 11 | loss: 0.0408040
	speed: 0.3557s/iter; left time: 13079.6126s
Epoch: 11 cost time: 154.88551330566406
Epoch: 11, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.083 Vali Acc: 0.984 Test Loss: 0.083 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000771
	speed: 0.7753s/iter; left time: 28421.4178s
	iters: 200, epoch: 12 | loss: 0.0000528
	speed: 0.3864s/iter; left time: 14125.2599s
	iters: 300, epoch: 12 | loss: 0.0000158
	speed: 0.3750s/iter; left time: 13673.0072s
	iters: 400, epoch: 12 | loss: 0.0142995
	speed: 0.3684s/iter; left time: 13393.9019s
Epoch: 12 cost time: 156.976655960083
Epoch: 12, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000021
	speed: 0.7713s/iter; left time: 27954.5815s
	iters: 200, epoch: 13 | loss: 0.0012044
	speed: 0.3496s/iter; left time: 12635.5355s
	iters: 300, epoch: 13 | loss: 0.0007384
	speed: 0.3432s/iter; left time: 12369.9263s
	iters: 400, epoch: 13 | loss: 0.0007122
	speed: 0.3787s/iter; left time: 13612.6938s
Epoch: 13 cost time: 150.84145593643188
Epoch: 13, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.063 Vali Acc: 0.982 Test Loss: 0.063 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000450
	speed: 0.8462s/iter; left time: 30322.4821s
	iters: 200, epoch: 14 | loss: 0.0016288
	speed: 0.3687s/iter; left time: 13172.9506s
	iters: 300, epoch: 14 | loss: 0.0075055
	speed: 0.3684s/iter; left time: 13125.7695s
	iters: 400, epoch: 14 | loss: 0.0000060
	speed: 0.3991s/iter; left time: 14181.7856s
Epoch: 14 cost time: 159.18526935577393
Epoch: 14, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.061 Vali Acc: 0.985 Test Loss: 0.061 Test Acc: 0.985
Validation loss decreased (-0.984538 --> -0.984993).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0002705
	speed: 0.7752s/iter; left time: 27455.5957s
	iters: 200, epoch: 15 | loss: 0.0002327
	speed: 0.3529s/iter; left time: 12463.6728s
	iters: 300, epoch: 15 | loss: 0.0117458
	speed: 0.3730s/iter; left time: 13136.8587s
	iters: 400, epoch: 15 | loss: 0.0000365
	speed: 0.3744s/iter; left time: 13149.5380s
Epoch: 15 cost time: 152.04515647888184
Epoch: 15, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000008
	speed: 0.7861s/iter; left time: 27519.4497s
	iters: 200, epoch: 16 | loss: 0.2578055
	speed: 0.3681s/iter; left time: 12848.5482s
	iters: 300, epoch: 16 | loss: 0.0008356
	speed: 0.3634s/iter; left time: 12648.6466s
	iters: 400, epoch: 16 | loss: 0.0000005
	speed: 0.3689s/iter; left time: 12801.9735s
Epoch: 16 cost time: 153.5914330482483
Epoch: 16, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.248 Vali Acc: 0.961 Test Loss: 0.248 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0730657
	speed: 0.7663s/iter; left time: 26509.9677s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.3816s/iter; left time: 13163.5713s
	iters: 300, epoch: 17 | loss: 0.0014996
	speed: 0.3588s/iter; left time: 12339.5893s
	iters: 400, epoch: 17 | loss: 0.0000004
	speed: 0.3756s/iter; left time: 12880.2810s
Epoch: 17 cost time: 152.42452836036682
Epoch: 17, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.067 Vali Acc: 0.982 Test Loss: 0.067 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000010
	speed: 0.7606s/iter; left time: 25997.3399s
	iters: 200, epoch: 18 | loss: 0.0000004
	speed: 0.3982s/iter; left time: 13570.3670s
	iters: 300, epoch: 18 | loss: 0.0006634
	speed: 0.3767s/iter; left time: 12801.6243s
	iters: 400, epoch: 18 | loss: 0.0000995
	speed: 0.3800s/iter; left time: 12874.6023s
Epoch: 18 cost time: 158.16281938552856
Epoch: 18, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.092 Vali Acc: 0.979 Test Loss: 0.092 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0002461
	speed: 0.7863s/iter; left time: 26550.5466s
	iters: 200, epoch: 19 | loss: 0.0003498
	speed: 0.3623s/iter; left time: 12196.0872s
	iters: 300, epoch: 19 | loss: 0.0527841
	speed: 0.3630s/iter; left time: 12183.7776s
	iters: 400, epoch: 19 | loss: 0.0012906
	speed: 0.3675s/iter; left time: 12298.4537s
Epoch: 19 cost time: 152.97785472869873
Epoch: 19, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.076 Vali Acc: 0.985 Test Loss: 0.076 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0009591
	speed: 0.7842s/iter; left time: 26157.5268s
	iters: 200, epoch: 20 | loss: 0.0001355
	speed: 0.3634s/iter; left time: 12083.6349s
	iters: 300, epoch: 20 | loss: 0.0000363
	speed: 0.3634s/iter; left time: 12049.4523s
	iters: 400, epoch: 20 | loss: 0.0000266
	speed: 0.3952s/iter; left time: 13062.9351s
Epoch: 20 cost time: 154.91615891456604
Epoch: 20, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.981 Test Loss: 0.101 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0044847
	speed: 0.7889s/iter; left time: 25986.0999s
	iters: 200, epoch: 21 | loss: 0.0053552
	speed: 0.3691s/iter; left time: 12121.7032s
	iters: 300, epoch: 21 | loss: 0.0000035
	speed: 0.3432s/iter; left time: 11238.0423s
	iters: 400, epoch: 21 | loss: 0.0000032
	speed: 0.3797s/iter; left time: 12392.4855s
Epoch: 21 cost time: 151.87600827217102
Epoch: 21, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.079 Vali Acc: 0.985 Test Loss: 0.079 Test Acc: 0.985
Validation loss decreased (-0.984993 --> -0.985447).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0004494
	speed: 0.7909s/iter; left time: 25725.6186s
	iters: 200, epoch: 22 | loss: 0.0000004
	speed: 0.3533s/iter; left time: 11457.8311s
	iters: 300, epoch: 22 | loss: 0.0000069
	speed: 0.3490s/iter; left time: 11281.9097s
	iters: 400, epoch: 22 | loss: 0.0323555
	speed: 0.3856s/iter; left time: 12428.7004s
Epoch: 22 cost time: 151.43047881126404
Epoch: 22, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.082 Vali Acc: 0.985 Test Loss: 0.082 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0088755
	speed: 0.8417s/iter; left time: 27030.7435s
	iters: 200, epoch: 23 | loss: 0.0017077
	speed: 0.3540s/iter; left time: 11334.3537s
	iters: 300, epoch: 23 | loss: 0.0046572
	speed: 0.3721s/iter; left time: 11874.0067s
	iters: 400, epoch: 23 | loss: 0.0000036
	speed: 0.3579s/iter; left time: 11385.3572s
Epoch: 23 cost time: 153.90105366706848
Epoch: 23, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.078 Vali Acc: 0.985 Test Loss: 0.078 Test Acc: 0.985
Validation loss decreased (-0.985447 --> -0.985447).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0113279
	speed: 0.8062s/iter; left time: 25559.4046s
	iters: 200, epoch: 24 | loss: 0.0000537
	speed: 0.3803s/iter; left time: 12018.4766s
	iters: 300, epoch: 24 | loss: 0.0000275
	speed: 0.3743s/iter; left time: 11791.2461s
	iters: 400, epoch: 24 | loss: 0.0000021
	speed: 0.3664s/iter; left time: 11506.5633s
Epoch: 24 cost time: 155.85579133033752
Epoch: 24, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.043 Vali Acc: 0.989 Test Loss: 0.043 Test Acc: 0.989
Validation loss decreased (-0.985447 --> -0.988631).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0000087
	speed: 0.7889s/iter; left time: 24685.1217s
	iters: 200, epoch: 25 | loss: 0.0001348
	speed: 0.3963s/iter; left time: 12359.6363s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.3793s/iter; left time: 11791.0371s
	iters: 400, epoch: 25 | loss: 0.0000018
	speed: 0.3671s/iter; left time: 11374.7888s
Epoch: 25 cost time: 157.6802637577057
Epoch: 25, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0000023
	speed: 0.7659s/iter; left time: 23647.6382s
	iters: 200, epoch: 26 | loss: 0.0000128
	speed: 0.4066s/iter; left time: 12512.2715s
	iters: 300, epoch: 26 | loss: 0.0000010
	speed: 0.3882s/iter; left time: 11908.6089s
	iters: 400, epoch: 26 | loss: 0.1086336
	speed: 0.3604s/iter; left time: 11020.2405s
Epoch: 26 cost time: 157.28609800338745
Epoch: 26, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0000001
	speed: 0.7675s/iter; left time: 23379.5648s
	iters: 200, epoch: 27 | loss: 0.0000220
	speed: 0.4258s/iter; left time: 12929.0416s
	iters: 300, epoch: 27 | loss: 0.0099386
	speed: 0.3968s/iter; left time: 12006.8997s
	iters: 400, epoch: 27 | loss: 0.0000015
	speed: 0.3670s/iter; left time: 11069.7065s
Epoch: 27 cost time: 163.25762271881104
Epoch: 27, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.063 Vali Acc: 0.988 Test Loss: 0.063 Test Acc: 0.988
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0000001
	speed: 0.8062s/iter; left time: 24225.7496s
	iters: 200, epoch: 28 | loss: 0.0000441
	speed: 0.3940s/iter; left time: 11800.4823s
	iters: 300, epoch: 28 | loss: 0.0000033
	speed: 0.3697s/iter; left time: 11036.3345s
	iters: 400, epoch: 28 | loss: 0.0000058
	speed: 0.3684s/iter; left time: 10961.1441s
Epoch: 28 cost time: 158.10014247894287
Epoch: 28, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.036 Vali Acc: 0.991 Test Loss: 0.036 Test Acc: 0.991
Validation loss decreased (-0.988631 --> -0.990905).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0001098
	speed: 0.7992s/iter; left time: 23684.5747s
	iters: 200, epoch: 29 | loss: 0.0000024
	speed: 0.3979s/iter; left time: 11752.0031s
	iters: 300, epoch: 29 | loss: 0.0000005
	speed: 0.4003s/iter; left time: 11783.2814s
	iters: 400, epoch: 29 | loss: 0.0006748
	speed: 0.3994s/iter; left time: 11716.1085s
Epoch: 29 cost time: 164.22051405906677
Epoch: 29, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.050 Vali Acc: 0.991 Test Loss: 0.050 Test Acc: 0.991
Validation loss decreased (-0.990905 --> -0.991359).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0000223
	speed: 0.7813s/iter; left time: 22831.4195s
	iters: 200, epoch: 30 | loss: 0.0000000
	speed: 0.4068s/iter; left time: 11848.0228s
	iters: 300, epoch: 30 | loss: 0.0000001
	speed: 0.3989s/iter; left time: 11578.0522s
	iters: 400, epoch: 30 | loss: 0.0000004
	speed: 0.3772s/iter; left time: 10910.6499s
Epoch: 30 cost time: 160.20844793319702
Epoch: 30, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.089 Vali Acc: 0.984 Test Loss: 0.089 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0000034
	speed: 0.7205s/iter; left time: 20758.0870s
	iters: 200, epoch: 31 | loss: 0.0000501
	speed: 0.3816s/iter; left time: 10955.5157s
	iters: 300, epoch: 31 | loss: 0.0000006
	speed: 0.3850s/iter; left time: 11016.6508s
	iters: 400, epoch: 31 | loss: 0.0071548
	speed: 0.3653s/iter; left time: 10414.0951s
Epoch: 31 cost time: 152.79863667488098
Epoch: 31, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.103 Vali Acc: 0.981 Test Loss: 0.103 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0000005
	speed: 0.7915s/iter; left time: 22475.6321s
	iters: 200, epoch: 32 | loss: 0.0000040
	speed: 0.3888s/iter; left time: 11003.3178s
	iters: 300, epoch: 32 | loss: 0.0003741
	speed: 0.3792s/iter; left time: 10692.3960s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.3522s/iter; left time: 9896.8273s
Epoch: 32 cost time: 154.52445578575134
Epoch: 32, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.078 Vali Acc: 0.987 Test Loss: 0.078 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.0000044
	speed: 0.7856s/iter; left time: 21985.5570s
	iters: 200, epoch: 33 | loss: 0.0000006
	speed: 0.4289s/iter; left time: 11958.5898s
	iters: 300, epoch: 33 | loss: 0.0000471
	speed: 0.3553s/iter; left time: 9871.7623s
	iters: 400, epoch: 33 | loss: 0.0000009
	speed: 0.3586s/iter; left time: 9927.1764s
Epoch: 33 cost time: 159.54526805877686
Epoch: 33, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.171 Vali Acc: 0.977 Test Loss: 0.171 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.0003257
	speed: 0.7656s/iter; left time: 21110.2385s
	iters: 200, epoch: 34 | loss: 0.0000003
	speed: 0.3839s/iter; left time: 10545.8836s
	iters: 300, epoch: 34 | loss: 0.0020963
	speed: 0.3875s/iter; left time: 10606.7187s
	iters: 400, epoch: 34 | loss: 0.0000189
	speed: 0.4263s/iter; left time: 11625.7597s
Epoch: 34 cost time: 162.29907083511353
Epoch: 34, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.085 Vali Acc: 0.984 Test Loss: 0.085 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.0000003
	speed: 0.7749s/iter; left time: 21044.6998s
	iters: 200, epoch: 35 | loss: 0.0000112
	speed: 0.3556s/iter; left time: 9623.3229s
	iters: 300, epoch: 35 | loss: 0.0011222
	speed: 0.3805s/iter; left time: 10257.6504s
	iters: 400, epoch: 35 | loss: 0.0000008
	speed: 0.3876s/iter; left time: 10410.5612s
Epoch: 35 cost time: 154.15183401107788
Epoch: 35, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.116 Vali Acc: 0.985 Test Loss: 0.116 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.7456s/iter; left time: 19942.8996s
	iters: 200, epoch: 36 | loss: 0.0000013
	speed: 0.3460s/iter; left time: 9219.4511s
	iters: 300, epoch: 36 | loss: 0.0002267
	speed: 0.3514s/iter; left time: 9327.3717s
	iters: 400, epoch: 36 | loss: 0.0000005
	speed: 0.3801s/iter; left time: 10052.0250s
Epoch: 36 cost time: 149.10302233695984
Epoch: 36, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.986 Test Loss: 0.088 Test Acc: 0.986
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 0.0000013
	speed: 0.7929s/iter; left time: 20879.4051s
	iters: 200, epoch: 37 | loss: 0.0001356
	speed: 0.3778s/iter; left time: 9912.0929s
	iters: 300, epoch: 37 | loss: 0.0000000
	speed: 0.3755s/iter; left time: 9812.0497s
	iters: 400, epoch: 37 | loss: 0.0000448
	speed: 0.3623s/iter; left time: 9430.9197s
Epoch: 37 cost time: 154.471271276474
Epoch: 37, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.062 Vali Acc: 0.990 Test Loss: 0.062 Test Acc: 0.990
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 0.0000040
	speed: 0.8062s/iter; left time: 20896.2766s
	iters: 200, epoch: 38 | loss: 0.0000029
	speed: 0.4074s/iter; left time: 10519.2068s
	iters: 300, epoch: 38 | loss: 0.0000045
	speed: 0.3732s/iter; left time: 9597.4907s
	iters: 400, epoch: 38 | loss: 0.0000005
	speed: 0.3493s/iter; left time: 8948.8403s
Epoch: 38 cost time: 159.04369974136353
Epoch: 38, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.128 Vali Acc: 0.985 Test Loss: 0.128 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 0.0002506
	speed: 0.7575s/iter; left time: 19320.4233s
	iters: 200, epoch: 39 | loss: 0.0000061
	speed: 0.4245s/iter; left time: 10785.5811s
	iters: 300, epoch: 39 | loss: 0.0000000
	speed: 0.3815s/iter; left time: 9653.3994s
	iters: 400, epoch: 39 | loss: 0.0000066
	speed: 0.3740s/iter; left time: 9426.9852s
Epoch: 39 cost time: 159.93924236297607
Epoch: 39, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.130 Vali Acc: 0.985 Test Loss: 0.130 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df256_ma38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9913597089586176
model parameter : 308874
model size : 3.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         28                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df256_ma28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1307545
	speed: 0.4045s/iter; left time: 16665.4741s
	iters: 200, epoch: 1 | loss: 0.6727334
	speed: 0.3802s/iter; left time: 15627.5511s
	iters: 300, epoch: 1 | loss: 0.1641551
	speed: 0.4218s/iter; left time: 17293.5186s
	iters: 400, epoch: 1 | loss: 0.1519696
	speed: 0.4044s/iter; left time: 16541.7159s
Epoch: 1 cost time: 166.35807538032532
Epoch: 1, Steps: 413 | Train Loss: 0.760 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
Validation loss decreased (inf --> -0.970895).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3144588
	speed: 0.7621s/iter; left time: 31084.2557s
	iters: 200, epoch: 2 | loss: 0.0312974
	speed: 0.4181s/iter; left time: 17011.7125s
	iters: 300, epoch: 2 | loss: 0.0201511
	speed: 0.4172s/iter; left time: 16932.9312s
	iters: 400, epoch: 2 | loss: 0.2837142
	speed: 0.4018s/iter; left time: 16266.1408s
Epoch: 2 cost time: 166.10597467422485
Epoch: 2, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.056 Vali Acc: 0.982 Test Loss: 0.056 Test Acc: 0.982
Validation loss decreased (-0.970895 --> -0.981809).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0253889
	speed: 0.8396s/iter; left time: 33899.7941s
	iters: 200, epoch: 3 | loss: 0.0811923
	speed: 0.4114s/iter; left time: 16567.9881s
	iters: 300, epoch: 3 | loss: 0.0284687
	speed: 0.3843s/iter; left time: 15438.7267s
	iters: 400, epoch: 3 | loss: 0.0513200
	speed: 0.3871s/iter; left time: 15511.8979s
Epoch: 3 cost time: 164.6673777103424
Epoch: 3, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.057 Vali Acc: 0.979 Test Loss: 0.057 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0058613
	speed: 0.8165s/iter; left time: 32629.3762s
	iters: 200, epoch: 4 | loss: 0.0057851
	speed: 0.3856s/iter; left time: 15370.5345s
	iters: 300, epoch: 4 | loss: 0.0168956
	speed: 0.3961s/iter; left time: 15749.8917s
	iters: 400, epoch: 4 | loss: 0.0766112
	speed: 0.4096s/iter; left time: 16246.9175s
Epoch: 4 cost time: 165.2643961906433
Epoch: 4, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.056 Vali Acc: 0.978 Test Loss: 0.056 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0202971
	speed: 0.7837s/iter; left time: 30993.2655s
	iters: 200, epoch: 5 | loss: 0.0045282
	speed: 0.4250s/iter; left time: 16765.5649s
	iters: 300, epoch: 5 | loss: 0.0297204
	speed: 0.4399s/iter; left time: 17308.9901s
	iters: 400, epoch: 5 | loss: 0.0019612
	speed: 0.3926s/iter; left time: 15410.8661s
Epoch: 5 cost time: 169.8607532978058
Epoch: 5, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.038 Vali Acc: 0.988 Test Loss: 0.038 Test Acc: 0.988
Validation loss decreased (-0.981809 --> -0.987721).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0030064
	speed: 0.7667s/iter; left time: 30004.0250s
	iters: 200, epoch: 6 | loss: 0.0011545
	speed: 0.4027s/iter; left time: 15718.0904s
	iters: 300, epoch: 6 | loss: 0.0562232
	speed: 0.4245s/iter; left time: 16528.7614s
	iters: 400, epoch: 6 | loss: 0.0385909
	speed: 0.3886s/iter; left time: 15090.2890s
Epoch: 6 cost time: 165.23536801338196
Epoch: 6, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.138 Vali Acc: 0.972 Test Loss: 0.138 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0078164
	speed: 0.7791s/iter; left time: 30170.7937s
	iters: 200, epoch: 7 | loss: 0.0017063
	speed: 0.4060s/iter; left time: 15680.7695s
	iters: 300, epoch: 7 | loss: 0.0000289
	speed: 0.4344s/iter; left time: 16735.3896s
	iters: 400, epoch: 7 | loss: 0.0107833
	speed: 0.4132s/iter; left time: 15877.3558s
Epoch: 7 cost time: 169.7099723815918
Epoch: 7, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.081 Vali Acc: 0.974 Test Loss: 0.081 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0102828
	speed: 0.7922s/iter; left time: 30348.1739s
	iters: 200, epoch: 8 | loss: 0.0044758
	speed: 0.3772s/iter; left time: 14413.3816s
	iters: 300, epoch: 8 | loss: 0.0004198
	speed: 0.3755s/iter; left time: 14310.4946s
	iters: 400, epoch: 8 | loss: 0.0038488
	speed: 0.3973s/iter; left time: 15099.9034s
Epoch: 8 cost time: 158.97494220733643
Epoch: 8, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.133 Vali Acc: 0.963 Test Loss: 0.133 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0001120
	speed: 0.8282s/iter; left time: 31386.4647s
	iters: 200, epoch: 9 | loss: 0.0003649
	speed: 0.3812s/iter; left time: 14408.4480s
	iters: 300, epoch: 9 | loss: 0.0065239
	speed: 0.3965s/iter; left time: 14948.1759s
	iters: 400, epoch: 9 | loss: 0.0007549
	speed: 0.4537s/iter; left time: 17057.4388s
Epoch: 9 cost time: 168.93179559707642
Epoch: 9, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.070 Vali Acc: 0.978 Test Loss: 0.070 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000753
	speed: 0.8394s/iter; left time: 31463.3174s
	iters: 200, epoch: 10 | loss: 0.0176399
	speed: 0.3718s/iter; left time: 13900.9582s
	iters: 300, epoch: 10 | loss: 0.0006445
	speed: 0.3886s/iter; left time: 14489.7616s
	iters: 400, epoch: 10 | loss: 0.0017523
	speed: 0.4242s/iter; left time: 15774.2279s
Epoch: 10 cost time: 164.37014818191528
Epoch: 10, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.125 Vali Acc: 0.969 Test Loss: 0.125 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0012722
	speed: 0.8317s/iter; left time: 30830.8556s
	iters: 200, epoch: 11 | loss: 0.0504095
	speed: 0.3863s/iter; left time: 14283.7342s
	iters: 300, epoch: 11 | loss: 0.0001098
	speed: 0.4325s/iter; left time: 15945.0680s
	iters: 400, epoch: 11 | loss: 0.0010379
	speed: 0.4138s/iter; left time: 15214.2056s
Epoch: 11 cost time: 168.06799626350403
Epoch: 11, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.137 Vali Acc: 0.974 Test Loss: 0.137 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000118
	speed: 0.8645s/iter; left time: 31690.1789s
	iters: 200, epoch: 12 | loss: 0.0125753
	speed: 0.4127s/iter; left time: 15086.9298s
	iters: 300, epoch: 12 | loss: 0.0000866
	speed: 0.3825s/iter; left time: 13943.5681s
	iters: 400, epoch: 12 | loss: 0.0000635
	speed: 0.3836s/iter; left time: 13946.8505s
Epoch: 12 cost time: 165.86415886878967
Epoch: 12, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.166 Vali Acc: 0.967 Test Loss: 0.166 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0204008
	speed: 0.7808s/iter; left time: 28301.1383s
	iters: 200, epoch: 13 | loss: 0.0000161
	speed: 0.3771s/iter; left time: 13630.8410s
	iters: 300, epoch: 13 | loss: 0.0000122
	speed: 0.3991s/iter; left time: 14384.3200s
	iters: 400, epoch: 13 | loss: 0.0002266
	speed: 0.4373s/iter; left time: 15718.7906s
Epoch: 13 cost time: 165.8574516773224
Epoch: 13, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0958953
	speed: 0.8326s/iter; left time: 29833.1613s
	iters: 200, epoch: 14 | loss: 0.0002095
	speed: 0.4085s/iter; left time: 14596.2022s
	iters: 300, epoch: 14 | loss: 0.0137243
	speed: 0.4027s/iter; left time: 14350.1678s
	iters: 400, epoch: 14 | loss: 0.0042846
	speed: 0.3827s/iter; left time: 13597.4660s
Epoch: 14 cost time: 164.69058299064636
Epoch: 14, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.164 Vali Acc: 0.970 Test Loss: 0.164 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0136566
	speed: 0.8026s/iter; left time: 28426.0013s
	iters: 200, epoch: 15 | loss: 0.0130304
	speed: 0.3987s/iter; left time: 14080.0371s
	iters: 300, epoch: 15 | loss: 0.0003122
	speed: 0.3855s/iter; left time: 13578.1147s
	iters: 400, epoch: 15 | loss: 0.0093015
	speed: 0.3872s/iter; left time: 13598.6231s
Epoch: 15 cost time: 164.15512681007385
Epoch: 15, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.114 Vali Acc: 0.978 Test Loss: 0.114 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df256_ma28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9877216916780355
model parameter : 308874
model size : 3.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df256_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.4529709
	speed: 0.4025s/iter; left time: 16581.6533s
	iters: 200, epoch: 1 | loss: 0.5730496
	speed: 0.3700s/iter; left time: 15208.5134s
	iters: 300, epoch: 1 | loss: 0.2277439
	speed: 0.3749s/iter; left time: 15372.9701s
	iters: 400, epoch: 1 | loss: 0.2838156
	speed: 0.3847s/iter; left time: 15733.7576s
Epoch: 1 cost time: 159.17930436134338
Epoch: 1, Steps: 413 | Train Loss: 0.854 Vali Loss: 0.134 Vali Acc: 0.959 Test Loss: 0.134 Test Acc: 0.959
Validation loss decreased (inf --> -0.959071).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2614084
	speed: 0.7735s/iter; left time: 31548.9202s
	iters: 200, epoch: 2 | loss: 0.1905207
	speed: 0.3713s/iter; left time: 15108.9125s
	iters: 300, epoch: 2 | loss: 0.0450001
	speed: 0.3794s/iter; left time: 15400.3107s
	iters: 400, epoch: 2 | loss: 0.3607642
	speed: 0.3785s/iter; left time: 15323.2802s
Epoch: 2 cost time: 155.36280989646912
Epoch: 2, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.064 Vali Acc: 0.979 Test Loss: 0.064 Test Acc: 0.979
Validation loss decreased (-0.959071 --> -0.979081).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0050960
	speed: 0.8054s/iter; left time: 32519.2535s
	iters: 200, epoch: 3 | loss: 0.1400907
	speed: 0.3697s/iter; left time: 14890.0253s
	iters: 300, epoch: 3 | loss: 0.0368570
	speed: 0.3762s/iter; left time: 15114.2179s
	iters: 400, epoch: 3 | loss: 0.0602536
	speed: 0.3691s/iter; left time: 14790.8974s
Epoch: 3 cost time: 156.94103813171387
Epoch: 3, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.064 Vali Acc: 0.975 Test Loss: 0.064 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0049199
	speed: 0.7694s/iter; left time: 30745.1078s
	iters: 200, epoch: 4 | loss: 0.0063428
	speed: 0.3680s/iter; left time: 14670.2797s
	iters: 300, epoch: 4 | loss: 0.0087412
	speed: 0.4025s/iter; left time: 16005.4465s
	iters: 400, epoch: 4 | loss: 0.0450997
	speed: 0.3983s/iter; left time: 15799.3199s
Epoch: 4 cost time: 159.6090316772461
Epoch: 4, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.054 Vali Acc: 0.978 Test Loss: 0.054 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0598543
	speed: 0.7316s/iter; left time: 28932.1476s
	iters: 200, epoch: 5 | loss: 0.0122542
	speed: 0.3794s/iter; left time: 14965.2273s
	iters: 300, epoch: 5 | loss: 0.0119787
	speed: 0.4061s/iter; left time: 15979.5830s
	iters: 400, epoch: 5 | loss: 0.0021812
	speed: 0.3943s/iter; left time: 15477.6003s
Epoch: 5 cost time: 158.2869575023651
Epoch: 5, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.048 Vali Acc: 0.980 Test Loss: 0.048 Test Acc: 0.980
Validation loss decreased (-0.979081 --> -0.980445).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0111885
	speed: 0.7582s/iter; left time: 29672.3200s
	iters: 200, epoch: 6 | loss: 0.0013891
	speed: 0.4036s/iter; left time: 15756.4491s
	iters: 300, epoch: 6 | loss: 0.0201485
	speed: 0.4188s/iter; left time: 16307.7380s
	iters: 400, epoch: 6 | loss: 0.0069804
	speed: 0.3910s/iter; left time: 15186.4592s
Epoch: 6 cost time: 163.16120791435242
Epoch: 6, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.039 Vali Acc: 0.988 Test Loss: 0.039 Test Acc: 0.988
Validation loss decreased (-0.980445 --> -0.988176).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0068821
	speed: 0.7809s/iter; left time: 30237.6023s
	iters: 200, epoch: 7 | loss: 0.0027465
	speed: 0.3790s/iter; left time: 14639.6013s
	iters: 300, epoch: 7 | loss: 0.0002611
	speed: 0.3685s/iter; left time: 14194.1851s
	iters: 400, epoch: 7 | loss: 0.0421295
	speed: 0.3418s/iter; left time: 13132.3068s
Epoch: 7 cost time: 153.52151584625244
Epoch: 7, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0001033
	speed: 0.7978s/iter; left time: 30562.9096s
	iters: 200, epoch: 8 | loss: 0.0019821
	speed: 0.3871s/iter; left time: 14792.5378s
	iters: 300, epoch: 8 | loss: 0.0033547
	speed: 0.3744s/iter; left time: 14269.1165s
	iters: 400, epoch: 8 | loss: 0.0155007
	speed: 0.3797s/iter; left time: 14433.8567s
Epoch: 8 cost time: 158.8445086479187
Epoch: 8, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.062 Vali Acc: 0.980 Test Loss: 0.062 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0009966
	speed: 0.8025s/iter; left time: 30412.0920s
	iters: 200, epoch: 9 | loss: 0.0135521
	speed: 0.3697s/iter; left time: 13972.3069s
	iters: 300, epoch: 9 | loss: 0.0028243
	speed: 0.3552s/iter; left time: 13391.5689s
	iters: 400, epoch: 9 | loss: 0.0000436
	speed: 0.3761s/iter; left time: 14141.8852s
Epoch: 9 cost time: 154.9272096157074
Epoch: 9, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0029739
	speed: 0.7747s/iter; left time: 29038.2785s
	iters: 200, epoch: 10 | loss: 0.0793985
	speed: 0.3853s/iter; left time: 14402.2702s
	iters: 300, epoch: 10 | loss: 0.0044441
	speed: 0.3942s/iter; left time: 14698.7411s
	iters: 400, epoch: 10 | loss: 0.0000813
	speed: 0.4001s/iter; left time: 14876.5023s
Epoch: 10 cost time: 161.04734230041504
Epoch: 10, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0064916
	speed: 0.8387s/iter; left time: 31091.4713s
	iters: 200, epoch: 11 | loss: 0.0008589
	speed: 0.3694s/iter; left time: 13657.7186s
	iters: 300, epoch: 11 | loss: 0.0000015
	speed: 0.3598s/iter; left time: 13264.4563s
	iters: 400, epoch: 11 | loss: 0.0000774
	speed: 0.3895s/iter; left time: 14323.7158s
Epoch: 11 cost time: 158.54173040390015
Epoch: 11, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000968
	speed: 0.7813s/iter; left time: 28639.3138s
	iters: 200, epoch: 12 | loss: 0.0322035
	speed: 0.3761s/iter; left time: 13748.0299s
	iters: 300, epoch: 12 | loss: 0.0027700
	speed: 0.3905s/iter; left time: 14237.5915s
	iters: 400, epoch: 12 | loss: 0.0093900
	speed: 0.3913s/iter; left time: 14228.3772s
Epoch: 12 cost time: 157.7935824394226
Epoch: 12, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.057 Vali Acc: 0.983 Test Loss: 0.057 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000445
	speed: 0.7903s/iter; left time: 28645.8736s
	iters: 200, epoch: 13 | loss: 0.0023217
	speed: 0.3951s/iter; left time: 14280.2309s
	iters: 300, epoch: 13 | loss: 0.0004221
	speed: 0.4070s/iter; left time: 14669.7645s
	iters: 400, epoch: 13 | loss: 0.0001249
	speed: 0.4105s/iter; left time: 14754.8033s
Epoch: 13 cost time: 165.3403923511505
Epoch: 13, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.096 Vali Acc: 0.981 Test Loss: 0.096 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0110443
	speed: 0.7700s/iter; left time: 27589.9531s
	iters: 200, epoch: 14 | loss: 0.0000866
	speed: 0.3658s/iter; left time: 13070.1852s
	iters: 300, epoch: 14 | loss: 0.1995603
	speed: 0.3829s/iter; left time: 13643.7879s
	iters: 400, epoch: 14 | loss: 0.0000078
	speed: 0.3928s/iter; left time: 13956.8460s
Epoch: 14 cost time: 156.77893352508545
Epoch: 14, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0016348
	speed: 0.7755s/iter; left time: 27468.6682s
	iters: 200, epoch: 15 | loss: 0.0011566
	speed: 0.4165s/iter; left time: 14709.5399s
	iters: 300, epoch: 15 | loss: 0.0027165
	speed: 0.4060s/iter; left time: 14297.3518s
	iters: 400, epoch: 15 | loss: 0.0000356
	speed: 0.3857s/iter; left time: 13547.1073s
Epoch: 15 cost time: 164.23158407211304
Epoch: 15, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0001981
	speed: 0.7548s/iter; left time: 26420.8048s
	iters: 200, epoch: 16 | loss: 0.0000352
	speed: 0.3785s/iter; left time: 13210.8818s
	iters: 300, epoch: 16 | loss: 0.0054090
	speed: 0.3647s/iter; left time: 12694.1647s
	iters: 400, epoch: 16 | loss: 0.0006556
	speed: 0.3705s/iter; left time: 12858.6035s
Epoch: 16 cost time: 153.26333856582642
Epoch: 16, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df256_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9881764438381082
model parameter : 308874
model size : 3.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df256_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.9487051
	speed: 0.3820s/iter; left time: 15736.8871s
	iters: 200, epoch: 1 | loss: 0.6659970
	speed: 0.3666s/iter; left time: 15068.9358s
	iters: 300, epoch: 1 | loss: 0.3605686
	speed: 0.3793s/iter; left time: 15551.4651s
	iters: 400, epoch: 1 | loss: 0.2445168
	speed: 0.3944s/iter; left time: 16130.0059s
Epoch: 1 cost time: 157.47169399261475
Epoch: 1, Steps: 413 | Train Loss: 1.047 Vali Loss: 0.150 Vali Acc: 0.953 Test Loss: 0.150 Test Acc: 0.953
Validation loss decreased (inf --> -0.952704).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4955211
	speed: 0.7888s/iter; left time: 32175.0327s
	iters: 200, epoch: 2 | loss: 0.1695208
	speed: 0.3749s/iter; left time: 15253.0194s
	iters: 300, epoch: 2 | loss: 0.0392152
	speed: 0.3905s/iter; left time: 15851.5580s
	iters: 400, epoch: 2 | loss: 0.2320656
	speed: 0.3703s/iter; left time: 14991.2488s
Epoch: 2 cost time: 156.6095552444458
Epoch: 2, Steps: 413 | Train Loss: 0.108 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.952704 --> -0.976807).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0139933
	speed: 0.7646s/iter; left time: 30868.7300s
	iters: 200, epoch: 3 | loss: 0.0770319
	speed: 0.3773s/iter; left time: 15195.9458s
	iters: 300, epoch: 3 | loss: 0.0520716
	speed: 0.3806s/iter; left time: 15289.6317s
	iters: 400, epoch: 3 | loss: 0.0322118
	speed: 0.3745s/iter; left time: 15007.2134s
Epoch: 3 cost time: 156.06034135818481
Epoch: 3, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.053 Vali Acc: 0.979 Test Loss: 0.053 Test Acc: 0.979
Validation loss decreased (-0.976807 --> -0.978626).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0054293
	speed: 0.7799s/iter; left time: 31168.0249s
	iters: 200, epoch: 4 | loss: 0.0012393
	speed: 0.3683s/iter; left time: 14680.3147s
	iters: 300, epoch: 4 | loss: 0.0061335
	speed: 0.3591s/iter; left time: 14276.9167s
	iters: 400, epoch: 4 | loss: 0.1001789
	speed: 0.3760s/iter; left time: 14914.7318s
Epoch: 4 cost time: 151.94488191604614
Epoch: 4, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.060 Vali Acc: 0.980 Test Loss: 0.060 Test Acc: 0.980
Validation loss decreased (-0.978626 --> -0.980445).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0207809
	speed: 0.7425s/iter; left time: 29366.9702s
	iters: 200, epoch: 5 | loss: 0.0181282
	speed: 0.3752s/iter; left time: 14801.3361s
	iters: 300, epoch: 5 | loss: 0.0006927
	speed: 0.3736s/iter; left time: 14700.9512s
	iters: 400, epoch: 5 | loss: 0.0545341
	speed: 0.3854s/iter; left time: 15125.1475s
Epoch: 5 cost time: 154.4883575439453
Epoch: 5, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0019544
	speed: 0.7987s/iter; left time: 31258.7444s
	iters: 200, epoch: 6 | loss: 0.0008110
	speed: 0.3553s/iter; left time: 13870.7429s
	iters: 300, epoch: 6 | loss: 0.0008844
	speed: 0.3890s/iter; left time: 15145.5423s
	iters: 400, epoch: 6 | loss: 0.0131495
	speed: 0.3823s/iter; left time: 14846.0048s
Epoch: 6 cost time: 155.90203475952148
Epoch: 6, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.043 Vali Acc: 0.985 Test Loss: 0.043 Test Acc: 0.985
Validation loss decreased (-0.980445 --> -0.985448).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0239255
	speed: 0.7560s/iter; left time: 29273.5324s
	iters: 200, epoch: 7 | loss: 0.0021299
	speed: 0.3802s/iter; left time: 14684.8013s
	iters: 300, epoch: 7 | loss: 0.0000127
	speed: 0.3829s/iter; left time: 14752.1164s
	iters: 400, epoch: 7 | loss: 0.0044902
	speed: 0.3633s/iter; left time: 13960.8953s
Epoch: 7 cost time: 154.69760465621948
Epoch: 7, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.064 Vali Acc: 0.982 Test Loss: 0.064 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0001738
	speed: 0.7418s/iter; left time: 28419.4128s
	iters: 200, epoch: 8 | loss: 0.0000496
	speed: 0.3688s/iter; left time: 14091.3290s
	iters: 300, epoch: 8 | loss: 0.0082841
	speed: 0.3636s/iter; left time: 13855.8940s
	iters: 400, epoch: 8 | loss: 0.0019765
	speed: 0.3486s/iter; left time: 13248.5961s
Epoch: 8 cost time: 148.95154857635498
Epoch: 8, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0341113
	speed: 0.7314s/iter; left time: 27719.2913s
	iters: 200, epoch: 9 | loss: 0.0044193
	speed: 0.3674s/iter; left time: 13887.6781s
	iters: 300, epoch: 9 | loss: 0.0135055
	speed: 0.3663s/iter; left time: 13808.5509s
	iters: 400, epoch: 9 | loss: 0.0003063
	speed: 0.3526s/iter; left time: 13258.0496s
Epoch: 9 cost time: 150.33590936660767
Epoch: 9, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.116 Vali Acc: 0.972 Test Loss: 0.116 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0106755
	speed: 0.7615s/iter; left time: 28544.0611s
	iters: 200, epoch: 10 | loss: 0.0001970
	speed: 0.3594s/iter; left time: 13436.5923s
	iters: 300, epoch: 10 | loss: 0.0003426
	speed: 0.3405s/iter; left time: 12695.4717s
	iters: 400, epoch: 10 | loss: 0.0000487
	speed: 0.3423s/iter; left time: 12727.9333s
Epoch: 10 cost time: 146.42865753173828
Epoch: 10, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000475
	speed: 0.7323s/iter; left time: 27147.8234s
	iters: 200, epoch: 11 | loss: 0.0014217
	speed: 0.3720s/iter; left time: 13753.1939s
	iters: 300, epoch: 11 | loss: 0.0000140
	speed: 0.3550s/iter; left time: 13089.9905s
	iters: 400, epoch: 11 | loss: 0.1553324
	speed: 0.3673s/iter; left time: 13506.8990s
Epoch: 11 cost time: 152.53007888793945
Epoch: 11, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0002437
	speed: 0.7976s/iter; left time: 29238.9118s
	iters: 200, epoch: 12 | loss: 0.0415694
	speed: 0.3669s/iter; left time: 13413.6720s
	iters: 300, epoch: 12 | loss: 0.0018701
	speed: 0.3403s/iter; left time: 12406.0094s
	iters: 400, epoch: 12 | loss: 0.0002818
	speed: 0.3401s/iter; left time: 12366.8913s
Epoch: 12 cost time: 146.88214540481567
Epoch: 12, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.132 Vali Acc: 0.971 Test Loss: 0.132 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000026
	speed: 0.7698s/iter; left time: 27900.0704s
	iters: 200, epoch: 13 | loss: 0.0000141
	speed: 0.3991s/iter; left time: 14426.7673s
	iters: 300, epoch: 13 | loss: 0.4093251
	speed: 0.3643s/iter; left time: 13129.7000s
	iters: 400, epoch: 13 | loss: 0.0003416
	speed: 0.3549s/iter; left time: 12757.3497s
Epoch: 13 cost time: 155.7782883644104
Epoch: 13, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.072 Vali Acc: 0.984 Test Loss: 0.072 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0261927
	speed: 0.7848s/iter; left time: 28120.8924s
	iters: 200, epoch: 14 | loss: 0.0001998
	speed: 0.3682s/iter; left time: 13155.9128s
	iters: 300, epoch: 14 | loss: 0.0040181
	speed: 0.3717s/iter; left time: 13243.3019s
	iters: 400, epoch: 14 | loss: 0.0000003
	speed: 0.3655s/iter; left time: 12986.3525s
Epoch: 14 cost time: 154.29461240768433
Epoch: 14, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.1978150
	speed: 0.7069s/iter; left time: 25037.6371s
	iters: 200, epoch: 15 | loss: 0.0283317
	speed: 0.3606s/iter; left time: 12735.0065s
	iters: 300, epoch: 15 | loss: 0.0035385
	speed: 0.3969s/iter; left time: 13977.4637s
	iters: 400, epoch: 15 | loss: 0.0000920
	speed: 0.3927s/iter; left time: 13790.5600s
Epoch: 15 cost time: 154.90241646766663
Epoch: 15, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.133 Vali Acc: 0.968 Test Loss: 0.133 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0000389
	speed: 0.7298s/iter; left time: 25547.4485s
	iters: 200, epoch: 16 | loss: 0.0001380
	speed: 0.3498s/iter; left time: 12210.1821s
	iters: 300, epoch: 16 | loss: 0.0003833
	speed: 0.3673s/iter; left time: 12784.3517s
	iters: 400, epoch: 16 | loss: 0.0000004
	speed: 0.3690s/iter; left time: 12804.7851s
Epoch: 16 cost time: 147.38258624076843
Epoch: 16, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df256_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9854479308776717
model parameter : 308874
model size : 3.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.0876732
	speed: 0.3500s/iter; left time: 14419.9059s
	iters: 200, epoch: 1 | loss: 0.8907435
	speed: 0.3619s/iter; left time: 14876.0479s
	iters: 300, epoch: 1 | loss: 0.4415083
	speed: 0.3711s/iter; left time: 15213.5759s
	iters: 400, epoch: 1 | loss: 0.2295574
	speed: 0.3709s/iter; left time: 15170.3948s
Epoch: 1 cost time: 150.98969388008118
Epoch: 1, Steps: 413 | Train Loss: 1.102 Vali Loss: 0.141 Vali Acc: 0.958 Test Loss: 0.141 Test Acc: 0.958
Validation loss decreased (inf --> -0.957707).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3385768
	speed: 0.7495s/iter; left time: 30569.4335s
	iters: 200, epoch: 2 | loss: 0.1405720
	speed: 0.3499s/iter; left time: 14238.1744s
	iters: 300, epoch: 2 | loss: 0.0698258
	speed: 0.3725s/iter; left time: 15119.0921s
	iters: 400, epoch: 2 | loss: 0.2699780
	speed: 0.3529s/iter; left time: 14288.7586s
Epoch: 2 cost time: 148.05318021774292
Epoch: 2, Steps: 413 | Train Loss: 0.119 Vali Loss: 0.081 Vali Acc: 0.975 Test Loss: 0.081 Test Acc: 0.975
Validation loss decreased (-0.957707 --> -0.974533).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0468843
	speed: 0.7514s/iter; left time: 30337.2192s
	iters: 200, epoch: 3 | loss: 0.1496011
	speed: 0.3561s/iter; left time: 14340.7012s
	iters: 300, epoch: 3 | loss: 0.0188429
	speed: 0.3747s/iter; left time: 15053.6285s
	iters: 400, epoch: 3 | loss: 0.0246668
	speed: 0.3727s/iter; left time: 14935.5564s
Epoch: 3 cost time: 152.65191841125488
Epoch: 3, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.049 Vali Acc: 0.984 Test Loss: 0.049 Test Acc: 0.984
Validation loss decreased (-0.974533 --> -0.983628).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0074555
	speed: 0.7662s/iter; left time: 30618.0158s
	iters: 200, epoch: 4 | loss: 0.0055642
	speed: 0.3600s/iter; left time: 14349.9440s
	iters: 300, epoch: 4 | loss: 0.0083241
	speed: 0.3771s/iter; left time: 14995.4479s
	iters: 400, epoch: 4 | loss: 0.0122057
	speed: 0.3835s/iter; left time: 15211.7804s
Epoch: 4 cost time: 154.20527172088623
Epoch: 4, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.061 Vali Acc: 0.979 Test Loss: 0.061 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0565638
	speed: 0.7207s/iter; left time: 28502.1339s
	iters: 200, epoch: 5 | loss: 0.0241862
	speed: 0.3475s/iter; left time: 13709.7574s
	iters: 300, epoch: 5 | loss: 0.0035968
	speed: 0.3903s/iter; left time: 15359.8054s
	iters: 400, epoch: 5 | loss: 0.0873761
	speed: 0.3922s/iter; left time: 15395.2546s
Epoch: 5 cost time: 153.37890934944153
Epoch: 5, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.065 Vali Acc: 0.981 Test Loss: 0.065 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0083018
	speed: 0.7438s/iter; left time: 29108.5818s
	iters: 200, epoch: 6 | loss: 0.0011353
	speed: 0.3663s/iter; left time: 14298.4110s
	iters: 300, epoch: 6 | loss: 0.0583651
	speed: 0.3501s/iter; left time: 13631.9289s
	iters: 400, epoch: 6 | loss: 0.0418490
	speed: 0.3435s/iter; left time: 13339.7326s
Epoch: 6 cost time: 147.7022042274475
Epoch: 6, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.042 Vali Acc: 0.983 Test Loss: 0.042 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0204681
	speed: 0.7513s/iter; left time: 29090.6643s
	iters: 200, epoch: 7 | loss: 0.0034167
	speed: 0.3848s/iter; left time: 14863.0845s
	iters: 300, epoch: 7 | loss: 0.0000343
	speed: 0.3609s/iter; left time: 13904.3090s
	iters: 400, epoch: 7 | loss: 0.0278873
	speed: 0.3406s/iter; left time: 13085.5351s
Epoch: 7 cost time: 151.04374837875366
Epoch: 7, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.066 Vali Acc: 0.979 Test Loss: 0.066 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0772151
	speed: 0.7378s/iter; left time: 28265.0420s
	iters: 200, epoch: 8 | loss: 0.0017823
	speed: 0.3767s/iter; left time: 14392.2317s
	iters: 300, epoch: 8 | loss: 0.1724863
	speed: 0.3672s/iter; left time: 13993.3371s
	iters: 400, epoch: 8 | loss: 0.0305049
	speed: 0.3523s/iter; left time: 13390.7788s
Epoch: 8 cost time: 151.5302290916443
Epoch: 8, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.061 Vali Acc: 0.982 Test Loss: 0.061 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0001639
	speed: 0.7486s/iter; left time: 28371.5840s
	iters: 200, epoch: 9 | loss: 0.0000634
	speed: 0.3572s/iter; left time: 13499.3561s
	iters: 300, epoch: 9 | loss: 0.0110397
	speed: 0.3426s/iter; left time: 12915.1631s
	iters: 400, epoch: 9 | loss: 0.0034703
	speed: 0.3498s/iter; left time: 13152.3980s
Epoch: 9 cost time: 146.8230640888214
Epoch: 9, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.055 Vali Acc: 0.983 Test Loss: 0.055 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0101808
	speed: 0.7540s/iter; left time: 28264.3744s
	iters: 200, epoch: 10 | loss: 0.0001503
	speed: 0.3629s/iter; left time: 13566.4563s
	iters: 300, epoch: 10 | loss: 0.0003900
	speed: 0.3482s/iter; left time: 12982.7796s
	iters: 400, epoch: 10 | loss: 0.0326493
	speed: 0.3433s/iter; left time: 12764.5094s
Epoch: 10 cost time: 147.74590349197388
Epoch: 10, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0000929
	speed: 0.7028s/iter; left time: 26053.9507s
	iters: 200, epoch: 11 | loss: 0.0000456
	speed: 0.3294s/iter; left time: 12177.0759s
	iters: 300, epoch: 11 | loss: 0.0000190
	speed: 0.3546s/iter; left time: 13073.1428s
	iters: 400, epoch: 11 | loss: 0.0193393
	speed: 0.3624s/iter; left time: 13324.6401s
Epoch: 11 cost time: 143.98273062705994
Epoch: 11, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000854
	speed: 0.6760s/iter; left time: 24781.7621s
	iters: 200, epoch: 12 | loss: 0.0070884
	speed: 0.3429s/iter; left time: 12536.0336s
	iters: 300, epoch: 12 | loss: 0.0001478
	speed: 0.3437s/iter; left time: 12530.2522s
	iters: 400, epoch: 12 | loss: 0.0011379
	speed: 0.3411s/iter; left time: 12401.3322s
Epoch: 12 cost time: 140.39094853401184
Epoch: 12, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.061 Vali Acc: 0.982 Test Loss: 0.061 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0000085
	speed: 0.7361s/iter; left time: 26679.5473s
	iters: 200, epoch: 13 | loss: 0.0700852
	speed: 0.3685s/iter; left time: 13319.5744s
	iters: 300, epoch: 13 | loss: 0.0300214
	speed: 0.3479s/iter; left time: 12541.5832s
	iters: 400, epoch: 13 | loss: 0.0001242
	speed: 0.3226s/iter; left time: 11597.1153s
Epoch: 13 cost time: 145.18050742149353
Epoch: 13, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9836289222373806
model parameter : 308874
model size : 3.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.0360844
	speed: 0.3835s/iter; left time: 15801.8269s
	iters: 200, epoch: 1 | loss: 1.0111433
	speed: 0.3532s/iter; left time: 14515.1092s
	iters: 300, epoch: 1 | loss: 0.5839832
	speed: 0.3422s/iter; left time: 14029.5061s
	iters: 400, epoch: 1 | loss: 0.1467161
	speed: 0.3570s/iter; left time: 14600.8929s
Epoch: 1 cost time: 148.21164536476135
Epoch: 1, Steps: 413 | Train Loss: 1.108 Vali Loss: 0.132 Vali Acc: 0.964 Test Loss: 0.132 Test Acc: 0.964
Validation loss decreased (inf --> -0.963619).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2792984
	speed: 0.7083s/iter; left time: 28888.4430s
	iters: 200, epoch: 2 | loss: 0.2271680
	speed: 0.3386s/iter; left time: 13775.9148s
	iters: 300, epoch: 2 | loss: 0.0617108
	speed: 0.3542s/iter; left time: 14376.9308s
	iters: 400, epoch: 2 | loss: 0.2300560
	speed: 0.3621s/iter; left time: 14661.5582s
Epoch: 2 cost time: 145.41409254074097
Epoch: 2, Steps: 413 | Train Loss: 0.123 Vali Loss: 0.070 Vali Acc: 0.979 Test Loss: 0.070 Test Acc: 0.979
Validation loss decreased (-0.963619 --> -0.978626).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0657285
	speed: 0.7035s/iter; left time: 28405.5588s
	iters: 200, epoch: 3 | loss: 0.2381847
	speed: 0.3358s/iter; left time: 13523.7400s
	iters: 300, epoch: 3 | loss: 0.0505448
	speed: 0.3452s/iter; left time: 13866.5665s
	iters: 400, epoch: 3 | loss: 0.0828860
	speed: 0.3403s/iter; left time: 13636.2061s
Epoch: 3 cost time: 139.7529535293579
Epoch: 3, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.057 Vali Acc: 0.981 Test Loss: 0.057 Test Acc: 0.981
Validation loss decreased (-0.978626 --> -0.980900).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0110710
	speed: 0.7288s/iter; left time: 29123.5217s
	iters: 200, epoch: 4 | loss: 0.0067397
	speed: 0.3403s/iter; left time: 13565.7840s
	iters: 300, epoch: 4 | loss: 0.0179805
	speed: 0.3494s/iter; left time: 13894.0242s
	iters: 400, epoch: 4 | loss: 0.1387991
	speed: 0.3591s/iter; left time: 14243.6516s
Epoch: 4 cost time: 145.97117066383362
Epoch: 4, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.086 Vali Acc: 0.972 Test Loss: 0.086 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0156095
	speed: 0.7106s/iter; left time: 28102.3631s
	iters: 200, epoch: 5 | loss: 0.0182188
	speed: 0.3459s/iter; left time: 13645.0815s
	iters: 300, epoch: 5 | loss: 0.0004728
	speed: 0.3486s/iter; left time: 13716.4558s
	iters: 400, epoch: 5 | loss: 0.3257192
	speed: 0.3375s/iter; left time: 13247.3369s
Epoch: 5 cost time: 143.2183210849762
Epoch: 5, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.065 Vali Acc: 0.977 Test Loss: 0.065 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0043278
	speed: 0.6941s/iter; left time: 27164.6468s
	iters: 200, epoch: 6 | loss: 0.0005360
	speed: 0.3600s/iter; left time: 14053.4400s
	iters: 300, epoch: 6 | loss: 0.0124615
	speed: 0.3721s/iter; left time: 14489.7197s
	iters: 400, epoch: 6 | loss: 0.0016697
	speed: 0.3702s/iter; left time: 14377.8322s
Epoch: 6 cost time: 149.79183340072632
Epoch: 6, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.105 Vali Acc: 0.969 Test Loss: 0.105 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0053672
	speed: 0.7627s/iter; left time: 29534.2467s
	iters: 200, epoch: 7 | loss: 0.0015149
	speed: 0.3937s/iter; left time: 15207.1319s
	iters: 300, epoch: 7 | loss: 0.0001131
	speed: 0.3807s/iter; left time: 14665.4380s
	iters: 400, epoch: 7 | loss: 0.0125482
	speed: 0.3563s/iter; left time: 13689.0278s
Epoch: 7 cost time: 155.54385566711426
Epoch: 7, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0015872
	speed: 0.7285s/iter; left time: 27910.2423s
	iters: 200, epoch: 8 | loss: 0.0124132
	speed: 0.3655s/iter; left time: 13966.5922s
	iters: 300, epoch: 8 | loss: 0.0255013
	speed: 0.3888s/iter; left time: 14818.3548s
	iters: 400, epoch: 8 | loss: 0.0007772
	speed: 0.3788s/iter; left time: 14397.0729s
Epoch: 8 cost time: 154.16172122955322
Epoch: 8, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0130028
	speed: 0.7572s/iter; left time: 28694.6585s
	iters: 200, epoch: 9 | loss: 0.0005618
	speed: 0.3782s/iter; left time: 14293.2841s
	iters: 300, epoch: 9 | loss: 0.0046300
	speed: 0.4075s/iter; left time: 15362.6603s
	iters: 400, epoch: 9 | loss: 0.0000127
	speed: 0.3674s/iter; left time: 13813.8667s
Epoch: 9 cost time: 157.19546508789062
Epoch: 9, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.1057224
	speed: 0.7318s/iter; left time: 27429.5134s
	iters: 200, epoch: 10 | loss: 0.0291510
	speed: 0.3849s/iter; left time: 14388.3822s
	iters: 300, epoch: 10 | loss: 0.0038592
	speed: 0.3814s/iter; left time: 14220.7558s
	iters: 400, epoch: 10 | loss: 0.0236473
	speed: 0.3635s/iter; left time: 13515.5981s
Epoch: 10 cost time: 154.94301199913025
Epoch: 10, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.088 Vali Acc: 0.975 Test Loss: 0.088 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0000095
	speed: 0.7698s/iter; left time: 28536.8992s
	iters: 200, epoch: 11 | loss: 0.0000081
	speed: 0.4086s/iter; left time: 15107.2282s
	iters: 300, epoch: 11 | loss: 0.2974256
	speed: 0.3942s/iter; left time: 14533.1792s
	iters: 400, epoch: 11 | loss: 0.0017647
	speed: 0.3663s/iter; left time: 13467.4147s
Epoch: 11 cost time: 161.13788080215454
Epoch: 11, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0012615
	speed: 0.7700s/iter; left time: 28225.2466s
	iters: 200, epoch: 12 | loss: 0.0124709
	speed: 0.3961s/iter; left time: 14481.5324s
	iters: 300, epoch: 12 | loss: 0.0494337
	speed: 0.3811s/iter; left time: 13892.7527s
	iters: 400, epoch: 12 | loss: 0.0000587
	speed: 0.3634s/iter; left time: 13210.9433s
Epoch: 12 cost time: 158.28961539268494
Epoch: 12, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0000043
	speed: 0.8298s/iter; left time: 30076.5654s
	iters: 200, epoch: 13 | loss: 0.0000697
	speed: 0.3998s/iter; left time: 14450.6873s
	iters: 300, epoch: 13 | loss: 0.0005898
	speed: 0.3926s/iter; left time: 14150.3056s
	iters: 400, epoch: 13 | loss: 0.0453239
	speed: 0.3673s/iter; left time: 13203.3455s
Epoch: 13 cost time: 163.4144983291626
Epoch: 13, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9809004092769441
model parameter : 308874
model size : 3.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.9533465
	speed: 0.3856s/iter; left time: 15888.7773s
	iters: 200, epoch: 1 | loss: 0.9517950
	speed: 0.3784s/iter; left time: 15552.6451s
	iters: 300, epoch: 1 | loss: 0.5651697
	speed: 0.3736s/iter; left time: 15318.1278s
	iters: 400, epoch: 1 | loss: 0.1295459
	speed: 0.3610s/iter; left time: 14763.6931s
Epoch: 1 cost time: 155.18872356414795
Epoch: 1, Steps: 413 | Train Loss: 1.095 Vali Loss: 0.130 Vali Acc: 0.964 Test Loss: 0.130 Test Acc: 0.964
Validation loss decreased (inf --> -0.964073).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2240269
	speed: 0.8227s/iter; left time: 33558.3050s
	iters: 200, epoch: 2 | loss: 0.1436752
	speed: 0.3991s/iter; left time: 16239.1006s
	iters: 300, epoch: 2 | loss: 0.0339408
	speed: 0.3982s/iter; left time: 16163.2242s
	iters: 400, epoch: 2 | loss: 0.2002416
	speed: 0.3627s/iter; left time: 14684.0441s
Epoch: 2 cost time: 160.04058456420898
Epoch: 2, Steps: 413 | Train Loss: 0.118 Vali Loss: 0.083 Vali Acc: 0.971 Test Loss: 0.083 Test Acc: 0.971
Validation loss decreased (-0.964073 --> -0.971350).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0907678
	speed: 0.7826s/iter; left time: 31596.0661s
	iters: 200, epoch: 3 | loss: 0.0878373
	speed: 0.3919s/iter; left time: 15784.6519s
	iters: 300, epoch: 3 | loss: 0.0218511
	speed: 0.3918s/iter; left time: 15741.4173s
	iters: 400, epoch: 3 | loss: 0.0365977
	speed: 0.3839s/iter; left time: 15386.7774s
Epoch: 3 cost time: 158.43842935562134
Epoch: 3, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.058 Vali Acc: 0.978 Test Loss: 0.058 Test Acc: 0.978
Validation loss decreased (-0.971350 --> -0.978171).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0019167
	speed: 0.8352s/iter; left time: 33375.9458s
	iters: 200, epoch: 4 | loss: 0.0051382
	speed: 0.4022s/iter; left time: 16031.0319s
	iters: 300, epoch: 4 | loss: 0.0031599
	speed: 0.4208s/iter; left time: 16730.0739s
	iters: 400, epoch: 4 | loss: 0.0179513
	speed: 0.4155s/iter; left time: 16477.8155s
Epoch: 4 cost time: 170.6511743068695
Epoch: 4, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.060 Vali Acc: 0.977 Test Loss: 0.060 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0882934
	speed: 0.8314s/iter; left time: 32880.1572s
	iters: 200, epoch: 5 | loss: 0.0064726
	speed: 0.3818s/iter; left time: 15059.9465s
	iters: 300, epoch: 5 | loss: 0.0080122
	speed: 0.4099s/iter; left time: 16130.4566s
	iters: 400, epoch: 5 | loss: 0.0078225
	speed: 0.4046s/iter; left time: 15878.1964s
Epoch: 5 cost time: 161.74563193321228
Epoch: 5, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0003199
	speed: 0.7977s/iter; left time: 31218.3670s
	iters: 200, epoch: 6 | loss: 0.0001375
	speed: 0.4087s/iter; left time: 15954.8451s
	iters: 300, epoch: 6 | loss: 0.0713285
	speed: 0.4114s/iter; left time: 16017.1114s
	iters: 400, epoch: 6 | loss: 0.0042910
	speed: 0.3699s/iter; left time: 14366.7848s
Epoch: 6 cost time: 162.16519451141357
Epoch: 6, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0037881
	speed: 0.8518s/iter; left time: 32984.7872s
	iters: 200, epoch: 7 | loss: 0.0001435
	speed: 0.4387s/iter; left time: 16944.8931s
	iters: 300, epoch: 7 | loss: 0.0000479
	speed: 0.4011s/iter; left time: 15451.3282s
	iters: 400, epoch: 7 | loss: 0.0084197
	speed: 0.4077s/iter; left time: 15665.4304s
Epoch: 7 cost time: 172.63483572006226
Epoch: 7, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
Validation loss decreased (-0.978171 --> -0.981354).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0004972
	speed: 0.9149s/iter; left time: 35049.0453s
	iters: 200, epoch: 8 | loss: 0.0002342
	speed: 0.4227s/iter; left time: 16152.6249s
	iters: 300, epoch: 8 | loss: 0.0015248
	speed: 0.4134s/iter; left time: 15754.2566s
	iters: 400, epoch: 8 | loss: 0.0643311
	speed: 0.4367s/iter; left time: 16598.8698s
Epoch: 8 cost time: 178.8581612110138
Epoch: 8, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.116 Vali Acc: 0.974 Test Loss: 0.116 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0059554
	speed: 0.9478s/iter; left time: 35919.5735s
	iters: 200, epoch: 9 | loss: 0.0094377
	speed: 0.4350s/iter; left time: 16442.7016s
	iters: 300, epoch: 9 | loss: 0.0587211
	speed: 0.4230s/iter; left time: 15944.7778s
	iters: 400, epoch: 9 | loss: 0.0001136
	speed: 0.4663s/iter; left time: 17533.0177s
Epoch: 9 cost time: 183.1515610218048
Epoch: 9, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0054673
	speed: 0.8740s/iter; left time: 32761.4821s
	iters: 200, epoch: 10 | loss: 0.0012799
	speed: 0.4145s/iter; left time: 15495.4638s
	iters: 300, epoch: 10 | loss: 0.0044949
	speed: 0.4546s/iter; left time: 16950.0434s
	iters: 400, epoch: 10 | loss: 0.0371877
	speed: 0.4652s/iter; left time: 17297.5838s
Epoch: 10 cost time: 180.82752108573914
Epoch: 10, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.093 Vali Acc: 0.972 Test Loss: 0.093 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000048
	speed: 0.8609s/iter; left time: 31914.3164s
	iters: 200, epoch: 11 | loss: 0.0001156
	speed: 0.4336s/iter; left time: 16032.1325s
	iters: 300, epoch: 11 | loss: 0.0001523
	speed: 0.4344s/iter; left time: 16016.7077s
	iters: 400, epoch: 11 | loss: 0.0401028
	speed: 0.4151s/iter; left time: 15263.1797s
Epoch: 11 cost time: 175.09854221343994
Epoch: 11, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0009713
	speed: 0.8315s/iter; left time: 30481.9840s
	iters: 200, epoch: 12 | loss: 0.0244015
	speed: 0.4045s/iter; left time: 14788.9403s
	iters: 300, epoch: 12 | loss: 0.0100846
	speed: 0.3985s/iter; left time: 14527.4022s
	iters: 400, epoch: 12 | loss: 0.0000046
	speed: 0.4169s/iter; left time: 15157.3916s
Epoch: 12 cost time: 166.21477508544922
Epoch: 12, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.981354 --> -0.982719).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000869
	speed: 0.8353s/iter; left time: 30273.9418s
	iters: 200, epoch: 13 | loss: 0.0000024
	speed: 0.3691s/iter; left time: 13341.3222s
	iters: 300, epoch: 13 | loss: 0.0001112
	speed: 0.3809s/iter; left time: 13729.3503s
	iters: 400, epoch: 13 | loss: 0.0004522
	speed: 0.3824s/iter; left time: 13745.3667s
Epoch: 13 cost time: 157.72099661827087
Epoch: 13, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.131 Vali Acc: 0.976 Test Loss: 0.131 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0002652
	speed: 0.7884s/iter; left time: 28250.3396s
	iters: 200, epoch: 14 | loss: 0.0138083
	speed: 0.3738s/iter; left time: 13358.1571s
	iters: 300, epoch: 14 | loss: 0.0000250
	speed: 0.3459s/iter; left time: 12324.6613s
	iters: 400, epoch: 14 | loss: 0.0000243
	speed: 0.3810s/iter; left time: 13537.5018s
Epoch: 14 cost time: 152.28752994537354
Epoch: 14, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000807
	speed: 0.8250s/iter; left time: 29220.7804s
	iters: 200, epoch: 15 | loss: 0.0004398
	speed: 0.3582s/iter; left time: 12650.8657s
	iters: 300, epoch: 15 | loss: 0.0005684
	speed: 0.3597s/iter; left time: 12667.2326s
	iters: 400, epoch: 15 | loss: 0.2674401
	speed: 0.3550s/iter; left time: 12465.8263s
Epoch: 15 cost time: 151.08998084068298
Epoch: 15, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0034236
	speed: 0.7626s/iter; left time: 26694.0337s
	iters: 200, epoch: 16 | loss: 0.0009108
	speed: 0.3709s/iter; left time: 12946.2628s
	iters: 300, epoch: 16 | loss: 0.0304436
	speed: 0.3675s/iter; left time: 12791.7887s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.3499s/iter; left time: 12142.8497s
Epoch: 16 cost time: 151.43342232704163
Epoch: 16, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.238 Vali Acc: 0.964 Test Loss: 0.238 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000047
	speed: 0.7027s/iter; left time: 24308.0737s
	iters: 200, epoch: 17 | loss: 0.0000069
	speed: 0.3527s/iter; left time: 12163.9824s
	iters: 300, epoch: 17 | loss: 0.0000012
	speed: 0.3557s/iter; left time: 12232.7036s
	iters: 400, epoch: 17 | loss: 0.0000099
	speed: 0.3906s/iter; left time: 13394.8831s
Epoch: 17 cost time: 146.72753763198853
Epoch: 17, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000257
	speed: 0.7900s/iter; left time: 27002.7942s
	iters: 200, epoch: 18 | loss: 0.0000018
	speed: 0.3416s/iter; left time: 11641.3690s
	iters: 300, epoch: 18 | loss: 0.0000017
	speed: 0.3399s/iter; left time: 11551.3696s
	iters: 400, epoch: 18 | loss: 0.0029200
	speed: 0.3550s/iter; left time: 12025.8459s
Epoch: 18 cost time: 144.996000289917
Epoch: 18, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000092
	speed: 0.7819s/iter; left time: 26401.2951s
	iters: 200, epoch: 19 | loss: 0.0000014
	speed: 0.3620s/iter; left time: 12188.1422s
	iters: 300, epoch: 19 | loss: 0.0000043
	speed: 0.3532s/iter; left time: 11854.5281s
	iters: 400, epoch: 19 | loss: 0.0000067
	speed: 0.3516s/iter; left time: 11766.3474s
Epoch: 19 cost time: 149.17785358428955
Epoch: 19, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.149 Vali Acc: 0.973 Test Loss: 0.149 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0005400
	speed: 0.7922s/iter; left time: 26421.4984s
	iters: 200, epoch: 20 | loss: 0.0001868
	speed: 0.4260s/iter; left time: 14164.7837s
	iters: 300, epoch: 20 | loss: 0.0000034
	speed: 0.4258s/iter; left time: 14115.8169s
	iters: 400, epoch: 20 | loss: 0.0076668
	speed: 0.3908s/iter; left time: 12917.6301s
Epoch: 20 cost time: 168.71345019340515
Epoch: 20, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.129 Vali Acc: 0.972 Test Loss: 0.129 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0001481
	speed: 0.7833s/iter; left time: 25802.6015s
	iters: 200, epoch: 21 | loss: 0.0000086
	speed: 0.3944s/iter; left time: 12951.1275s
	iters: 300, epoch: 21 | loss: 0.0000141
	speed: 0.4243s/iter; left time: 13893.1700s
	iters: 400, epoch: 21 | loss: 0.0000015
	speed: 0.3955s/iter; left time: 12910.3736s
Epoch: 21 cost time: 163.2882182598114
Epoch: 21, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.190 Vali Acc: 0.968 Test Loss: 0.190 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0304606
	speed: 0.7741s/iter; left time: 25178.8433s
	iters: 200, epoch: 22 | loss: 0.0000107
	speed: 0.3765s/iter; left time: 12207.9725s
	iters: 300, epoch: 22 | loss: 0.0087290
	speed: 0.3903s/iter; left time: 12616.1732s
	iters: 400, epoch: 22 | loss: 0.0000049
	speed: 0.4394s/iter; left time: 14161.6535s
Epoch: 22 cost time: 162.62149739265442
Epoch: 22, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.164 Vali Acc: 0.969 Test Loss: 0.164 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9827194179172352
model parameter : 308874
model size : 3.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.3045199
	speed: 0.3913s/iter; left time: 16122.9071s
	iters: 200, epoch: 1 | loss: 2.3033104
	speed: 0.3471s/iter; left time: 14266.7208s
	iters: 300, epoch: 1 | loss: 2.3037393
	speed: 0.3423s/iter; left time: 14036.1542s
	iters: 400, epoch: 1 | loss: 2.3018909
	speed: 0.3624s/iter; left time: 14821.6418s
Epoch: 1 cost time: 150.00619173049927
Epoch: 1, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (inf --> -0.100022).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3039682
	speed: 0.8021s/iter; left time: 32715.4118s
	iters: 200, epoch: 2 | loss: 2.3014081
	speed: 0.3601s/iter; left time: 14652.8718s
	iters: 300, epoch: 2 | loss: 2.3036022
	speed: 0.3538s/iter; left time: 14361.0641s
	iters: 400, epoch: 2 | loss: 2.3036540
	speed: 0.3551s/iter; left time: 14376.5060s
Epoch: 2 cost time: 151.59389662742615
Epoch: 2, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3012207
	speed: 0.8019s/iter; left time: 32377.0535s
	iters: 200, epoch: 3 | loss: 2.3023250
	speed: 0.3938s/iter; left time: 15859.0241s
	iters: 300, epoch: 3 | loss: 2.3063905
	speed: 0.3648s/iter; left time: 14654.4821s
	iters: 400, epoch: 3 | loss: 2.3026774
	speed: 0.3467s/iter; left time: 13895.1922s
Epoch: 3 cost time: 154.90147638320923
Epoch: 3, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.3041451
	speed: 0.7564s/iter; left time: 30227.6297s
	iters: 200, epoch: 4 | loss: 2.3037102
	speed: 0.3729s/iter; left time: 14866.4100s
	iters: 300, epoch: 4 | loss: 2.3035178
	speed: 0.3717s/iter; left time: 14779.6680s
	iters: 400, epoch: 4 | loss: 2.3035264
	speed: 0.3713s/iter; left time: 14726.9517s
Epoch: 4 cost time: 153.25273776054382
Epoch: 4, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.3002422
	speed: 0.7882s/iter; left time: 31171.5201s
	iters: 200, epoch: 5 | loss: 2.3037050
	speed: 0.4030s/iter; left time: 15897.4694s
	iters: 300, epoch: 5 | loss: 2.3060310
	speed: 0.3886s/iter; left time: 15290.8238s
	iters: 400, epoch: 5 | loss: 2.3029990
	speed: 0.3546s/iter; left time: 13916.6455s
Epoch: 5 cost time: 161.07834577560425
Epoch: 5, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.3005643
	speed: 0.7183s/iter; left time: 28112.9263s
	iters: 200, epoch: 6 | loss: 2.3029740
	speed: 0.3775s/iter; left time: 14735.5166s
	iters: 300, epoch: 6 | loss: 2.3034019
	speed: 0.3965s/iter; left time: 15437.1865s
	iters: 400, epoch: 6 | loss: 2.3034780
	speed: 0.3721s/iter; left time: 14448.9728s
Epoch: 6 cost time: 153.24549269676208
Epoch: 6, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.3012466
	speed: 0.7451s/iter; left time: 28854.0122s
	iters: 200, epoch: 7 | loss: 2.3038149
	speed: 0.3775s/iter; left time: 14578.7344s
	iters: 300, epoch: 7 | loss: 2.3054080
	speed: 0.3860s/iter; left time: 14871.6772s
	iters: 400, epoch: 7 | loss: 2.3027034
	speed: 0.3988s/iter; left time: 15321.9095s
Epoch: 7 cost time: 157.35760307312012
Epoch: 7, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.3010180
	speed: 0.7496s/iter; left time: 28715.3207s
	iters: 200, epoch: 8 | loss: 2.3009822
	speed: 0.3711s/iter; left time: 14181.0674s
	iters: 300, epoch: 8 | loss: 2.3036761
	speed: 0.3924s/iter; left time: 14955.2514s
	iters: 400, epoch: 8 | loss: 2.3024299
	speed: 0.3813s/iter; left time: 14491.5063s
Epoch: 8 cost time: 156.41488552093506
Epoch: 8, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 2.3018098
	speed: 0.7440s/iter; left time: 28196.0047s
	iters: 200, epoch: 9 | loss: 2.3050463
	speed: 0.3506s/iter; left time: 13250.6433s
	iters: 300, epoch: 9 | loss: 2.3013771
	speed: 0.3676s/iter; left time: 13858.6987s
	iters: 400, epoch: 9 | loss: 2.3024940
	speed: 0.3589s/iter; left time: 13492.2629s
Epoch: 9 cost time: 148.8234519958496
Epoch: 9, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 2.3028913
	speed: 0.7997s/iter; left time: 29975.2750s
	iters: 200, epoch: 10 | loss: 2.3069537
	speed: 0.3665s/iter; left time: 13701.2421s
	iters: 300, epoch: 10 | loss: 2.3026240
	speed: 0.3814s/iter; left time: 14218.5078s
	iters: 400, epoch: 10 | loss: 2.3031704
	speed: 0.3714s/iter; left time: 13808.8925s
Epoch: 10 cost time: 156.39966082572937
Epoch: 10, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 2.3049910
	speed: 0.7772s/iter; left time: 28810.1550s
	iters: 200, epoch: 11 | loss: 2.3021889
	speed: 0.3851s/iter; left time: 14239.3690s
	iters: 300, epoch: 11 | loss: 2.3046229
	speed: 0.3839s/iter; left time: 14153.7803s
	iters: 400, epoch: 11 | loss: 2.3025019
	speed: 0.3805s/iter; left time: 13992.8356s
Epoch: 11 cost time: 157.0944585800171
Epoch: 11, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.3018689
	speed: 0.7172s/iter; left time: 26290.4056s
	iters: 200, epoch: 12 | loss: 2.3044028
	speed: 0.3501s/iter; left time: 12798.0475s
	iters: 300, epoch: 12 | loss: 2.3027058
	speed: 0.3696s/iter; left time: 13475.0833s
	iters: 400, epoch: 12 | loss: 2.3062661
	speed: 0.3947s/iter; left time: 14350.4660s
Epoch: 12 cost time: 152.56093668937683
Epoch: 12, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 13 | loss: 2.3026342
	speed: 0.8345s/iter; left time: 30246.0121s
	iters: 200, epoch: 13 | loss: 2.3001504
	speed: 0.3579s/iter; left time: 12936.7134s
	iters: 300, epoch: 13 | loss: 2.3072112
	speed: 0.3456s/iter; left time: 12455.5864s
	iters: 400, epoch: 13 | loss: 2.3026850
	speed: 0.3608s/iter; left time: 12970.2578s
Epoch: 13 cost time: 150.73681259155273
Epoch: 13, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.3009591
	speed: 0.7704s/iter; left time: 27603.6589s
	iters: 200, epoch: 14 | loss: 2.3026931
	speed: 0.3708s/iter; left time: 13249.1306s
	iters: 300, epoch: 14 | loss: 2.3020566
	speed: 0.3839s/iter; left time: 13677.8112s
	iters: 400, epoch: 14 | loss: 2.3033614
	speed: 0.3514s/iter; left time: 12484.4977s
Epoch: 14 cost time: 153.50384402275085
Epoch: 14, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 15 | loss: 2.3022780
	speed: 0.7966s/iter; left time: 28215.6079s
	iters: 200, epoch: 15 | loss: 2.3015397
	speed: 0.4181s/iter; left time: 14767.5445s
	iters: 300, epoch: 15 | loss: 2.3071845
	speed: 0.3785s/iter; left time: 13330.5535s
	iters: 400, epoch: 15 | loss: 2.3027599
	speed: 0.3563s/iter; left time: 12511.8430s
Epoch: 15 cost time: 161.86927390098572
Epoch: 15, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 2.2990444
	speed: 0.7440s/iter; left time: 26046.1556s
	iters: 200, epoch: 16 | loss: 2.3058805
	speed: 0.3914s/iter; left time: 13661.6820s
	iters: 300, epoch: 16 | loss: 2.3032868
	speed: 0.3884s/iter; left time: 13520.0545s
	iters: 400, epoch: 16 | loss: 2.3024421
	speed: 0.3811s/iter; left time: 13225.4559s
Epoch: 16 cost time: 156.54534029960632
Epoch: 16, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 2.3011982
	speed: 0.7163s/iter; left time: 24779.7087s
	iters: 200, epoch: 17 | loss: 2.3053489
	speed: 0.3949s/iter; left time: 13619.6381s
	iters: 300, epoch: 17 | loss: 2.3015764
	speed: 0.4219s/iter; left time: 14509.6563s
	iters: 400, epoch: 17 | loss: 2.3023217
	speed: 0.4030s/iter; left time: 13821.7472s
Epoch: 17 cost time: 161.94869828224182
Epoch: 17, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 2.3054318
	speed: 0.7778s/iter; left time: 26584.3720s
	iters: 200, epoch: 18 | loss: 2.3040855
	speed: 0.3878s/iter; left time: 13216.0153s
	iters: 300, epoch: 18 | loss: 2.3026848
	speed: 0.3914s/iter; left time: 13298.7278s
	iters: 400, epoch: 18 | loss: 2.3037939
	speed: 0.3750s/iter; left time: 12704.3060s
Epoch: 18 cost time: 157.2808198928833
Epoch: 18, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 2.3041155
	speed: 0.7485s/iter; left time: 25275.5471s
	iters: 200, epoch: 19 | loss: 2.3006539
	speed: 0.3999s/iter; left time: 13461.8688s
	iters: 300, epoch: 19 | loss: 2.3015075
	speed: 0.4202s/iter; left time: 14106.1260s
	iters: 400, epoch: 19 | loss: 2.3037713
	speed: 0.3724s/iter; left time: 12461.5273s
Epoch: 19 cost time: 161.8573694229126
Epoch: 19, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 2.3027146
	speed: 0.7906s/iter; left time: 26368.4344s
	iters: 200, epoch: 20 | loss: 2.2999613
	speed: 0.3937s/iter; left time: 13092.5488s
	iters: 300, epoch: 20 | loss: 2.3025227
	speed: 0.3899s/iter; left time: 12927.4826s
	iters: 400, epoch: 20 | loss: 2.3046379
	speed: 0.3692s/iter; left time: 12204.3286s
Epoch: 20 cost time: 159.1217725276947
Epoch: 20, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 2.3076832
	speed: 0.7652s/iter; left time: 25205.2430s
	iters: 200, epoch: 21 | loss: 2.3067701
	speed: 0.3683s/iter; left time: 12094.4293s
	iters: 300, epoch: 21 | loss: 2.2999551
	speed: 0.4104s/iter; left time: 13438.3167s
	iters: 400, epoch: 21 | loss: 2.3020270
	speed: 0.4068s/iter; left time: 13278.7888s
Epoch: 21 cost time: 160.1176209449768
Epoch: 21, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 2.3025172
	speed: 0.7655s/iter; left time: 24898.6005s
	iters: 200, epoch: 22 | loss: 2.3005867
	speed: 0.4056s/iter; left time: 13153.3984s
	iters: 300, epoch: 22 | loss: 2.3045211
	speed: 0.4082s/iter; left time: 13196.0770s
	iters: 400, epoch: 22 | loss: 2.3021209
	speed: 0.3529s/iter; left time: 11372.1298s
Epoch: 22 cost time: 160.92709946632385
Epoch: 22, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 2.3006403
	speed: 0.7895s/iter; left time: 25354.5547s
	iters: 200, epoch: 23 | loss: 2.3045554
	speed: 0.3919s/iter; left time: 12546.8313s
	iters: 300, epoch: 23 | loss: 2.3067112
	speed: 0.3775s/iter; left time: 12046.9652s
	iters: 400, epoch: 23 | loss: 2.3040776
	speed: 0.3481s/iter; left time: 11076.0567s
Epoch: 23 cost time: 155.19621109962463
Epoch: 23, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 2.3014445
	speed: 0.8155s/iter; left time: 25853.0888s
	iters: 200, epoch: 24 | loss: 2.3008790
	speed: 0.4307s/iter; left time: 13610.5649s
	iters: 300, epoch: 24 | loss: 2.3069854
	speed: 0.4180s/iter; left time: 13168.5092s
	iters: 400, epoch: 24 | loss: 2.3026614
	speed: 0.3924s/iter; left time: 12323.2346s
Epoch: 24 cost time: 170.94101881980896
Epoch: 24, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.10004547521600728
model parameter : 308874
model size : 3.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         47                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df128_ma47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.9680045
	speed: 0.4230s/iter; left time: 17426.2918s
	iters: 200, epoch: 1 | loss: 0.4300338
	speed: 0.4080s/iter; left time: 16769.0954s
	iters: 300, epoch: 1 | loss: 0.1159505
	speed: 0.4070s/iter; left time: 16687.9685s
	iters: 400, epoch: 1 | loss: 0.0807340
	speed: 0.4013s/iter; left time: 16412.2727s
Epoch: 1 cost time: 168.88884282112122
Epoch: 1, Steps: 413 | Train Loss: 0.669 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
Validation loss decreased (inf --> -0.969530).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0422557
	speed: 0.8263s/iter; left time: 33701.8464s
	iters: 200, epoch: 2 | loss: 0.0664091
	speed: 0.4257s/iter; left time: 17319.3038s
	iters: 300, epoch: 2 | loss: 0.0279405
	speed: 0.4353s/iter; left time: 17666.0322s
	iters: 400, epoch: 2 | loss: 0.0340510
	speed: 0.4327s/iter; left time: 17517.8586s
Epoch: 2 cost time: 175.59512734413147
Epoch: 2, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.062 Vali Acc: 0.979 Test Loss: 0.062 Test Acc: 0.979
Validation loss decreased (-0.969530 --> -0.979081).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0052683
	speed: 0.8229s/iter; left time: 33224.8333s
	iters: 200, epoch: 3 | loss: 0.0150625
	speed: 0.3948s/iter; left time: 15899.8825s
	iters: 300, epoch: 3 | loss: 0.0081897
	speed: 0.4258s/iter; left time: 17107.0141s
	iters: 400, epoch: 3 | loss: 0.0044537
	speed: 0.4049s/iter; left time: 16225.9039s
Epoch: 3 cost time: 167.1532175540924
Epoch: 3, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.060 Vali Acc: 0.979 Test Loss: 0.060 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0069742
	speed: 0.7853s/iter; left time: 31380.3167s
	iters: 200, epoch: 4 | loss: 0.0026567
	speed: 0.4028s/iter; left time: 16054.6260s
	iters: 300, epoch: 4 | loss: 0.0049562
	speed: 0.4649s/iter; left time: 18486.9316s
	iters: 400, epoch: 4 | loss: 0.0039836
	speed: 0.4215s/iter; left time: 16718.4400s
Epoch: 4 cost time: 171.79802942276
Epoch: 4, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0021142
	speed: 0.8192s/iter; left time: 32398.9931s
	iters: 200, epoch: 5 | loss: 0.0013580
	speed: 0.4053s/iter; left time: 15989.3978s
	iters: 300, epoch: 5 | loss: 0.0021624
	speed: 0.4001s/iter; left time: 15742.5755s
	iters: 400, epoch: 5 | loss: 0.0133462
	speed: 0.4039s/iter; left time: 15853.7299s
Epoch: 5 cost time: 167.01683354377747
Epoch: 5, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0004855
	speed: 0.7821s/iter; left time: 30608.1548s
	iters: 200, epoch: 6 | loss: 0.0005870
	speed: 0.3873s/iter; left time: 15119.8065s
	iters: 300, epoch: 6 | loss: 0.0023169
	speed: 0.4106s/iter; left time: 15989.0300s
	iters: 400, epoch: 6 | loss: 0.0005482
	speed: 0.4017s/iter; left time: 15600.3451s
Epoch: 6 cost time: 163.12386846542358
Epoch: 6, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.064 Vali Acc: 0.982 Test Loss: 0.064 Test Acc: 0.982
Validation loss decreased (-0.979081 --> -0.982264).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0075033
	speed: 0.8239s/iter; left time: 31905.4421s
	iters: 200, epoch: 7 | loss: 0.0002755
	speed: 0.3910s/iter; left time: 15101.3680s
	iters: 300, epoch: 7 | loss: 0.0025263
	speed: 0.3846s/iter; left time: 14816.1953s
	iters: 400, epoch: 7 | loss: 0.0174373
	speed: 0.4071s/iter; left time: 15642.5475s
Epoch: 7 cost time: 161.41851925849915
Epoch: 7, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1304907
	speed: 0.7854s/iter; left time: 30088.8187s
	iters: 200, epoch: 8 | loss: 0.0006374
	speed: 0.3595s/iter; left time: 13737.0060s
	iters: 300, epoch: 8 | loss: 0.0111281
	speed: 0.3628s/iter; left time: 13827.9281s
	iters: 400, epoch: 8 | loss: 0.0035124
	speed: 0.3752s/iter; left time: 14262.6987s
Epoch: 8 cost time: 152.44351887702942
Epoch: 8, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.192 Vali Acc: 0.953 Test Loss: 0.192 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0006152
	speed: 0.8679s/iter; left time: 32890.0399s
	iters: 200, epoch: 9 | loss: 0.0004768
	speed: 0.3755s/iter; left time: 14194.1403s
	iters: 300, epoch: 9 | loss: 0.0012416
	speed: 0.3878s/iter; left time: 14617.8453s
	iters: 400, epoch: 9 | loss: 0.0000081
	speed: 0.3834s/iter; left time: 14416.0944s
Epoch: 9 cost time: 159.83237504959106
Epoch: 9, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0006684
	speed: 0.8303s/iter; left time: 31123.7103s
	iters: 200, epoch: 10 | loss: 0.0001754
	speed: 0.3747s/iter; left time: 14007.5497s
	iters: 300, epoch: 10 | loss: 0.0000008
	speed: 0.3772s/iter; left time: 14064.0887s
	iters: 400, epoch: 10 | loss: 0.0000167
	speed: 0.3483s/iter; left time: 12949.8983s
Epoch: 10 cost time: 154.34667873382568
Epoch: 10, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.055 Vali Acc: 0.985 Test Loss: 0.055 Test Acc: 0.985
Validation loss decreased (-0.982264 --> -0.984993).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0001033
	speed: 0.7211s/iter; left time: 26730.5816s
	iters: 200, epoch: 11 | loss: 0.0021281
	speed: 0.3629s/iter; left time: 13416.2288s
	iters: 300, epoch: 11 | loss: 0.0003892
	speed: 0.3686s/iter; left time: 13592.2563s
	iters: 400, epoch: 11 | loss: 0.0186309
	speed: 0.3862s/iter; left time: 14202.2535s
Epoch: 11 cost time: 151.23301124572754
Epoch: 11, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.981 Test Loss: 0.091 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0003436
	speed: 0.8147s/iter; left time: 29866.5906s
	iters: 200, epoch: 12 | loss: 0.0006474
	speed: 0.3623s/iter; left time: 13246.2417s
	iters: 300, epoch: 12 | loss: 0.0002942
	speed: 0.3685s/iter; left time: 13433.7455s
	iters: 400, epoch: 12 | loss: 0.0171801
	speed: 0.3587s/iter; left time: 13040.2008s
Epoch: 12 cost time: 152.7370412349701
Epoch: 12, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.157 Vali Acc: 0.966 Test Loss: 0.157 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0005387
	speed: 0.7623s/iter; left time: 27628.9251s
	iters: 200, epoch: 13 | loss: 0.1406148
	speed: 0.3547s/iter; left time: 12821.1873s
	iters: 300, epoch: 13 | loss: 0.0000188
	speed: 0.3869s/iter; left time: 13945.6362s
	iters: 400, epoch: 13 | loss: 0.0003508
	speed: 0.3723s/iter; left time: 13383.0742s
Epoch: 13 cost time: 152.92817997932434
Epoch: 13, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000020
	speed: 0.8094s/iter; left time: 29001.0463s
	iters: 200, epoch: 14 | loss: 0.0024775
	speed: 0.3719s/iter; left time: 13290.0447s
	iters: 300, epoch: 14 | loss: 0.0000261
	speed: 0.3791s/iter; left time: 13507.7365s
	iters: 400, epoch: 14 | loss: 0.0001661
	speed: 0.3669s/iter; left time: 13034.9446s
Epoch: 14 cost time: 156.10050415992737
Epoch: 14, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0004477
	speed: 0.8068s/iter; left time: 28576.3439s
	iters: 200, epoch: 15 | loss: 0.0000109
	speed: 0.3580s/iter; left time: 12645.7516s
	iters: 300, epoch: 15 | loss: 0.0000005
	speed: 0.3594s/iter; left time: 12659.3905s
	iters: 400, epoch: 15 | loss: 0.0162650
	speed: 0.3841s/iter; left time: 13490.8041s
Epoch: 15 cost time: 152.08032035827637
Epoch: 15, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000036
	speed: 0.7959s/iter; left time: 27860.7121s
	iters: 200, epoch: 16 | loss: 0.0000135
	speed: 0.3630s/iter; left time: 12672.4405s
	iters: 300, epoch: 16 | loss: 0.0000804
	speed: 0.3642s/iter; left time: 12675.3360s
	iters: 400, epoch: 16 | loss: 0.0000430
	speed: 0.3750s/iter; left time: 13014.9695s
Epoch: 16 cost time: 152.5018184185028
Epoch: 16, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000019
	speed: 0.7923s/iter; left time: 27407.9619s
	iters: 200, epoch: 17 | loss: 0.0001557
	speed: 0.3773s/iter; left time: 13014.0408s
	iters: 300, epoch: 17 | loss: 0.0000012
	speed: 0.3623s/iter; left time: 12460.4739s
	iters: 400, epoch: 17 | loss: 0.0000001
	speed: 0.3559s/iter; left time: 12206.5607s
Epoch: 17 cost time: 151.73405575752258
Epoch: 17, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.113 Vali Acc: 0.972 Test Loss: 0.113 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000027
	speed: 0.8124s/iter; left time: 27768.3364s
	iters: 200, epoch: 18 | loss: 0.0186229
	speed: 0.3830s/iter; left time: 13052.8143s
	iters: 300, epoch: 18 | loss: 0.0020722
	speed: 0.3862s/iter; left time: 13123.5480s
	iters: 400, epoch: 18 | loss: 0.0009932
	speed: 0.3686s/iter; left time: 12487.2856s
Epoch: 18 cost time: 158.6817111968994
Epoch: 18, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.040 Vali Acc: 0.990 Test Loss: 0.040 Test Acc: 0.990
Validation loss decreased (-0.984993 --> -0.990450).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000086
	speed: 0.8253s/iter; left time: 27867.3196s
	iters: 200, epoch: 19 | loss: 0.0001701
	speed: 0.3746s/iter; left time: 12612.1872s
	iters: 300, epoch: 19 | loss: 0.0000272
	speed: 0.3567s/iter; left time: 11974.7203s
	iters: 400, epoch: 19 | loss: 0.0117086
	speed: 0.3479s/iter; left time: 11642.5799s
Epoch: 19 cost time: 152.10820198059082
Epoch: 19, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.086 Vali Acc: 0.985 Test Loss: 0.086 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000001
	speed: 0.7849s/iter; left time: 26179.9864s
	iters: 200, epoch: 20 | loss: 0.0000022
	speed: 0.3945s/iter; left time: 13118.3723s
	iters: 300, epoch: 20 | loss: 0.0000152
	speed: 0.3606s/iter; left time: 11955.7060s
	iters: 400, epoch: 20 | loss: 0.0087907
	speed: 0.3618s/iter; left time: 11958.7865s
Epoch: 20 cost time: 155.67284321784973
Epoch: 20, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.047 Vali Acc: 0.993 Test Loss: 0.047 Test Acc: 0.993
Validation loss decreased (-0.990450 --> -0.992723).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000727
	speed: 0.7831s/iter; left time: 25796.5021s
	iters: 200, epoch: 21 | loss: 0.0001596
	speed: 0.3939s/iter; left time: 12935.6095s
	iters: 300, epoch: 21 | loss: 0.0004451
	speed: 0.3899s/iter; left time: 12766.3508s
	iters: 400, epoch: 21 | loss: 0.0000487
	speed: 0.3848s/iter; left time: 12560.5827s
Epoch: 21 cost time: 160.39375185966492
Epoch: 21, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.179 Vali Acc: 0.968 Test Loss: 0.179 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000111
	speed: 0.7766s/iter; left time: 25260.1029s
	iters: 200, epoch: 22 | loss: 0.0084255
	speed: 0.3467s/iter; left time: 11242.1540s
	iters: 300, epoch: 22 | loss: 0.0001384
	speed: 0.3676s/iter; left time: 11883.2453s
	iters: 400, epoch: 22 | loss: 0.0016186
	speed: 0.3814s/iter; left time: 12290.8634s
Epoch: 22 cost time: 152.11834144592285
Epoch: 22, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.182 Vali Acc: 0.971 Test Loss: 0.182 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.4725465
	speed: 0.7972s/iter; left time: 25602.0883s
	iters: 200, epoch: 23 | loss: 0.0000184
	speed: 0.3633s/iter; left time: 11632.0121s
	iters: 300, epoch: 23 | loss: 0.0173497
	speed: 0.3678s/iter; left time: 11739.5364s
	iters: 400, epoch: 23 | loss: 0.0014965
	speed: 0.3687s/iter; left time: 11728.9922s
Epoch: 23 cost time: 154.08968138694763
Epoch: 23, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.070 Vali Acc: 0.987 Test Loss: 0.070 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0000294
	speed: 0.7897s/iter; left time: 25035.5395s
	iters: 200, epoch: 24 | loss: 0.0072530
	speed: 0.3658s/iter; left time: 11558.5459s
	iters: 300, epoch: 24 | loss: 0.0024732
	speed: 0.3458s/iter; left time: 10893.7435s
	iters: 400, epoch: 24 | loss: 0.0000338
	speed: 0.3348s/iter; left time: 10511.9789s
Epoch: 24 cost time: 145.6792721748352
Epoch: 24, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0018560
	speed: 0.7725s/iter; left time: 24171.4197s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.3861s/iter; left time: 12041.2617s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.3882s/iter; left time: 12068.0715s
	iters: 400, epoch: 25 | loss: 0.0002196
	speed: 0.3877s/iter; left time: 12015.7353s
Epoch: 25 cost time: 159.1731207370758
Epoch: 25, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.978 Test Loss: 0.118 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.7800s/iter; left time: 24083.9662s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.3548s/iter; left time: 10917.8009s
	iters: 300, epoch: 26 | loss: 0.0002130
	speed: 0.3704s/iter; left time: 11363.6533s
	iters: 400, epoch: 26 | loss: 0.0000001
	speed: 0.3652s/iter; left time: 11166.2528s
Epoch: 26 cost time: 151.5561716556549
Epoch: 26, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.153 Vali Acc: 0.980 Test Loss: 0.153 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0000001
	speed: 0.8065s/iter; left time: 24568.9068s
	iters: 200, epoch: 27 | loss: 0.0004945
	speed: 0.3693s/iter; left time: 11212.2487s
	iters: 300, epoch: 27 | loss: 0.0003768
	speed: 0.3702s/iter; left time: 11203.8876s
	iters: 400, epoch: 27 | loss: 0.2932627
	speed: 0.3759s/iter; left time: 11337.3206s
Epoch: 27 cost time: 155.71416473388672
Epoch: 27, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0001887
	speed: 0.8204s/iter; left time: 24653.3081s
	iters: 200, epoch: 28 | loss: 0.0069629
	speed: 0.3823s/iter; left time: 11451.1943s
	iters: 300, epoch: 28 | loss: 0.0000341
	speed: 0.3789s/iter; left time: 11310.7966s
	iters: 400, epoch: 28 | loss: 0.0000714
	speed: 0.3765s/iter; left time: 11201.6154s
Epoch: 28 cost time: 159.75537204742432
Epoch: 28, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.098 Vali Acc: 0.979 Test Loss: 0.098 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0000088
	speed: 0.8125s/iter; left time: 24081.0539s
	iters: 200, epoch: 29 | loss: 0.0000007
	speed: 0.3986s/iter; left time: 11772.4164s
	iters: 300, epoch: 29 | loss: 0.0001038
	speed: 0.3836s/iter; left time: 11292.5764s
	iters: 400, epoch: 29 | loss: 0.0000436
	speed: 0.3784s/iter; left time: 11101.2653s
Epoch: 29 cost time: 160.8897066116333
Epoch: 29, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.053 Vali Acc: 0.991 Test Loss: 0.053 Test Acc: 0.991
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0001988
	speed: 0.7583s/iter; left time: 22160.3979s
	iters: 200, epoch: 30 | loss: 0.0000004
	speed: 0.3830s/iter; left time: 11155.9057s
	iters: 300, epoch: 30 | loss: 0.0000798
	speed: 0.4501s/iter; left time: 13064.1868s
	iters: 400, epoch: 30 | loss: 0.0000020
	speed: 0.4327s/iter; left time: 12514.2044s
Epoch: 30 cost time: 168.68825149536133
Epoch: 30, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.092 Vali Acc: 0.985 Test Loss: 0.092 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df128_ma47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9927239654388358
model parameter : 259722
model size : 3.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         38                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df128_ma38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0606586
	speed: 0.3873s/iter; left time: 15958.9336s
	iters: 200, epoch: 1 | loss: 0.4850182
	speed: 0.3466s/iter; left time: 14245.4092s
	iters: 300, epoch: 1 | loss: 0.1323984
	speed: 0.3854s/iter; left time: 15803.3723s
	iters: 400, epoch: 1 | loss: 0.0874025
	speed: 0.3613s/iter; left time: 14776.2512s
Epoch: 1 cost time: 153.97045803070068
Epoch: 1, Steps: 413 | Train Loss: 0.705 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
Validation loss decreased (inf --> -0.966802).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0407854
	speed: 0.8404s/iter; left time: 34278.3497s
	iters: 200, epoch: 2 | loss: 0.0524481
	speed: 0.4223s/iter; left time: 17184.1032s
	iters: 300, epoch: 2 | loss: 0.0306863
	speed: 0.4383s/iter; left time: 17789.5205s
	iters: 400, epoch: 2 | loss: 0.0446078
	speed: 0.4471s/iter; left time: 18100.5804s
Epoch: 2 cost time: 178.23451352119446
Epoch: 2, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.056 Vali Acc: 0.980 Test Loss: 0.056 Test Acc: 0.980
Validation loss decreased (-0.966802 --> -0.979990).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0052201
	speed: 0.8594s/iter; left time: 34698.4933s
	iters: 200, epoch: 3 | loss: 0.0185015
	speed: 0.3973s/iter; left time: 16002.2139s
	iters: 300, epoch: 3 | loss: 0.0083662
	speed: 0.3940s/iter; left time: 15830.7426s
	iters: 400, epoch: 3 | loss: 0.0215016
	speed: 0.4107s/iter; left time: 16458.7240s
Epoch: 3 cost time: 167.43047904968262
Epoch: 3, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.053 Vali Acc: 0.984 Test Loss: 0.053 Test Acc: 0.984
Validation loss decreased (-0.979990 --> -0.984083).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0073204
	speed: 0.9019s/iter; left time: 36043.5969s
	iters: 200, epoch: 4 | loss: 0.0017390
	speed: 0.4168s/iter; left time: 16614.7461s
	iters: 300, epoch: 4 | loss: 0.0520632
	speed: 0.4330s/iter; left time: 17217.7475s
	iters: 400, epoch: 4 | loss: 0.0056760
	speed: 0.4117s/iter; left time: 16327.3742s
Epoch: 4 cost time: 174.00454950332642
Epoch: 4, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.051 Vali Acc: 0.982 Test Loss: 0.051 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0078431
	speed: 0.8759s/iter; left time: 34642.2262s
	iters: 200, epoch: 5 | loss: 0.0008569
	speed: 0.4177s/iter; left time: 16475.9338s
	iters: 300, epoch: 5 | loss: 0.0069061
	speed: 0.4340s/iter; left time: 17079.3447s
	iters: 400, epoch: 5 | loss: 0.0296307
	speed: 0.4367s/iter; left time: 17139.9673s
Epoch: 5 cost time: 177.8696165084839
Epoch: 5, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0005451
	speed: 0.8545s/iter; left time: 33442.3093s
	iters: 200, epoch: 6 | loss: 0.0004208
	speed: 0.3958s/iter; left time: 15451.9922s
	iters: 300, epoch: 6 | loss: 0.0336981
	speed: 0.3806s/iter; left time: 14817.7140s
	iters: 400, epoch: 6 | loss: 0.0110454
	speed: 0.3899s/iter; left time: 15143.0319s
Epoch: 6 cost time: 163.53850102424622
Epoch: 6, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.069 Vali Acc: 0.979 Test Loss: 0.069 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0146735
	speed: 0.8635s/iter; left time: 33435.3985s
	iters: 200, epoch: 7 | loss: 0.0006272
	speed: 0.4221s/iter; left time: 16303.8708s
	iters: 300, epoch: 7 | loss: 0.0008376
	speed: 0.4056s/iter; left time: 15626.3955s
	iters: 400, epoch: 7 | loss: 0.0162428
	speed: 0.4200s/iter; left time: 16137.4161s
Epoch: 7 cost time: 172.8172562122345
Epoch: 7, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0002071
	speed: 0.8479s/iter; left time: 32483.7673s
	iters: 200, epoch: 8 | loss: 0.0069750
	speed: 0.3894s/iter; left time: 14877.9063s
	iters: 300, epoch: 8 | loss: 0.0246615
	speed: 0.4019s/iter; left time: 15318.3127s
	iters: 400, epoch: 8 | loss: 0.0000489
	speed: 0.3804s/iter; left time: 14460.8688s
Epoch: 8 cost time: 163.25873136520386
Epoch: 8, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.056 Vali Acc: 0.982 Test Loss: 0.056 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0007048
	speed: 0.8535s/iter; left time: 32343.5469s
	iters: 200, epoch: 9 | loss: 0.0052176
	speed: 0.4320s/iter; left time: 16329.9129s
	iters: 300, epoch: 9 | loss: 0.0003531
	speed: 0.4061s/iter; left time: 15310.0150s
	iters: 400, epoch: 9 | loss: 0.0000183
	speed: 0.3912s/iter; left time: 14709.4979s
Epoch: 9 cost time: 170.8169457912445
Epoch: 9, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0000794
	speed: 0.8573s/iter; left time: 32133.5777s
	iters: 200, epoch: 10 | loss: 0.0012852
	speed: 0.4055s/iter; left time: 15160.0665s
	iters: 300, epoch: 10 | loss: 0.0023816
	speed: 0.4121s/iter; left time: 15365.1570s
	iters: 400, epoch: 10 | loss: 0.0002618
	speed: 0.3890s/iter; left time: 14463.2397s
Epoch: 10 cost time: 169.39797234535217
Epoch: 10, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.064 Vali Acc: 0.979 Test Loss: 0.064 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0049126
	speed: 0.8436s/iter; left time: 31272.9632s
	iters: 200, epoch: 11 | loss: 0.0002609
	speed: 0.4260s/iter; left time: 15751.1967s
	iters: 300, epoch: 11 | loss: 0.0033918
	speed: 0.4015s/iter; left time: 14802.4655s
	iters: 400, epoch: 11 | loss: 0.0013680
	speed: 0.4158s/iter; left time: 15289.6322s
Epoch: 11 cost time: 172.06865334510803
Epoch: 11, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000101
	speed: 0.8390s/iter; left time: 30756.3640s
	iters: 200, epoch: 12 | loss: 0.0000617
	speed: 0.4252s/iter; left time: 15545.8305s
	iters: 300, epoch: 12 | loss: 0.0212262
	speed: 0.4034s/iter; left time: 14708.0254s
	iters: 400, epoch: 12 | loss: 0.0002091
	speed: 0.4049s/iter; left time: 14720.8593s
Epoch: 12 cost time: 168.41001534461975
Epoch: 12, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0000077
	speed: 0.8536s/iter; left time: 30939.2081s
	iters: 200, epoch: 13 | loss: 0.0000671
	speed: 0.4480s/iter; left time: 16194.1322s
	iters: 300, epoch: 13 | loss: 0.0000010
	speed: 0.4296s/iter; left time: 15486.0108s
	iters: 400, epoch: 13 | loss: 0.0000842
	speed: 0.3718s/iter; left time: 13363.4138s
Epoch: 13 cost time: 171.64708805084229
Epoch: 13, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df128_ma38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9840836743974534
model parameter : 259722
model size : 3.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         28                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df128_ma28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1507353
	speed: 0.4380s/iter; left time: 18045.1484s
	iters: 200, epoch: 1 | loss: 0.4447356
	speed: 0.4163s/iter; left time: 17111.9965s
	iters: 300, epoch: 1 | loss: 0.1655596
	speed: 0.4535s/iter; left time: 18595.6120s
	iters: 400, epoch: 1 | loss: 0.1164044
	speed: 0.4133s/iter; left time: 16904.1406s
Epoch: 1 cost time: 177.16748023033142
Epoch: 1, Steps: 413 | Train Loss: 0.783 Vali Loss: 0.142 Vali Acc: 0.961 Test Loss: 0.142 Test Acc: 0.961
Validation loss decreased (inf --> -0.960890).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0518875
	speed: 0.8492s/iter; left time: 34636.0176s
	iters: 200, epoch: 2 | loss: 0.0609554
	speed: 0.4002s/iter; left time: 16282.1592s
	iters: 300, epoch: 2 | loss: 0.0495399
	speed: 0.4083s/iter; left time: 16570.1196s
	iters: 400, epoch: 2 | loss: 0.0370856
	speed: 0.3674s/iter; left time: 14876.4986s
Epoch: 2 cost time: 165.256489276886
Epoch: 2, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.061 Vali Acc: 0.982 Test Loss: 0.061 Test Acc: 0.982
Validation loss decreased (-0.960890 --> -0.981809).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0093020
	speed: 0.8098s/iter; left time: 32693.8958s
	iters: 200, epoch: 3 | loss: 0.0102490
	speed: 0.4140s/iter; left time: 16674.4425s
	iters: 300, epoch: 3 | loss: 0.0048339
	speed: 0.4325s/iter; left time: 17374.7526s
	iters: 400, epoch: 3 | loss: 0.0047703
	speed: 0.4406s/iter; left time: 17656.8221s
Epoch: 3 cost time: 173.05113792419434
Epoch: 3, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.046 Vali Acc: 0.988 Test Loss: 0.046 Test Acc: 0.988
Validation loss decreased (-0.981809 --> -0.987721).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0050315
	speed: 0.8362s/iter; left time: 33415.1153s
	iters: 200, epoch: 4 | loss: 0.0054223
	speed: 0.4036s/iter; left time: 16088.3912s
	iters: 300, epoch: 4 | loss: 0.0060108
	speed: 0.3874s/iter; left time: 15403.3509s
	iters: 400, epoch: 4 | loss: 0.0018726
	speed: 0.3832s/iter; left time: 15197.4068s
Epoch: 4 cost time: 163.453950881958
Epoch: 4, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.045 Vali Acc: 0.986 Test Loss: 0.045 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0024484
	speed: 0.8290s/iter; left time: 32787.0063s
	iters: 200, epoch: 5 | loss: 0.0022141
	speed: 0.4036s/iter; left time: 15923.5317s
	iters: 300, epoch: 5 | loss: 0.0029475
	speed: 0.3763s/iter; left time: 14806.6365s
	iters: 400, epoch: 5 | loss: 0.0026735
	speed: 0.4144s/iter; left time: 16265.3488s
Epoch: 5 cost time: 165.1418924331665
Epoch: 5, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0047042
	speed: 0.8084s/iter; left time: 31639.1441s
	iters: 200, epoch: 6 | loss: 0.0002947
	speed: 0.3709s/iter; left time: 14477.4921s
	iters: 300, epoch: 6 | loss: 0.0108233
	speed: 0.3870s/iter; left time: 15069.0253s
	iters: 400, epoch: 6 | loss: 0.0007795
	speed: 0.4004s/iter; left time: 15549.2895s
Epoch: 6 cost time: 156.9670488834381
Epoch: 6, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.061 Vali Acc: 0.980 Test Loss: 0.061 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0089550
	speed: 0.7816s/iter; left time: 30267.8176s
	iters: 200, epoch: 7 | loss: 0.0057963
	speed: 0.3796s/iter; left time: 14660.9525s
	iters: 300, epoch: 7 | loss: 0.0136287
	speed: 0.4083s/iter; left time: 15730.6656s
	iters: 400, epoch: 7 | loss: 0.0095568
	speed: 0.4078s/iter; left time: 15667.9220s
Epoch: 7 cost time: 162.56899333000183
Epoch: 7, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.060 Vali Acc: 0.980 Test Loss: 0.060 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0002284
	speed: 0.8194s/iter; left time: 31389.9378s
	iters: 200, epoch: 8 | loss: 0.0024143
	speed: 0.3897s/iter; left time: 14891.6541s
	iters: 300, epoch: 8 | loss: 0.0989285
	speed: 0.3570s/iter; left time: 13605.1288s
	iters: 400, epoch: 8 | loss: 0.0489995
	speed: 0.4185s/iter; left time: 15906.1847s
Epoch: 8 cost time: 163.09265851974487
Epoch: 8, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0004618
	speed: 0.8365s/iter; left time: 31699.7918s
	iters: 200, epoch: 9 | loss: 0.0010294
	speed: 0.3737s/iter; left time: 14123.8451s
	iters: 300, epoch: 9 | loss: 0.0001860
	speed: 0.4030s/iter; left time: 15192.3699s
	iters: 400, epoch: 9 | loss: 0.0000603
	speed: 0.4145s/iter; left time: 15582.3054s
Epoch: 9 cost time: 164.68978214263916
Epoch: 9, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0001367
	speed: 0.8220s/iter; left time: 30810.0279s
	iters: 200, epoch: 10 | loss: 0.0097471
	speed: 0.3733s/iter; left time: 13955.1129s
	iters: 300, epoch: 10 | loss: 0.0000176
	speed: 0.3523s/iter; left time: 13134.6959s
	iters: 400, epoch: 10 | loss: 0.0066518
	speed: 0.3784s/iter; left time: 14069.6714s
Epoch: 10 cost time: 155.4048855304718
Epoch: 10, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.071 Vali Acc: 0.982 Test Loss: 0.071 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0035315
	speed: 0.8036s/iter; left time: 29790.5098s
	iters: 200, epoch: 11 | loss: 0.0009150
	speed: 0.3929s/iter; left time: 14526.5046s
	iters: 300, epoch: 11 | loss: 0.0001924
	speed: 0.3803s/iter; left time: 14022.9342s
	iters: 400, epoch: 11 | loss: 0.0031431
	speed: 0.3805s/iter; left time: 13992.0359s
Epoch: 11 cost time: 161.22960710525513
Epoch: 11, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.049 Vali Acc: 0.987 Test Loss: 0.049 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0001317
	speed: 0.8353s/iter; left time: 30621.2941s
	iters: 200, epoch: 12 | loss: 0.0007460
	speed: 0.3782s/iter; left time: 13824.4720s
	iters: 300, epoch: 12 | loss: 0.0000683
	speed: 0.3736s/iter; left time: 13620.8857s
	iters: 400, epoch: 12 | loss: 0.0006069
	speed: 0.3623s/iter; left time: 13172.3442s
Epoch: 12 cost time: 158.3707628250122
Epoch: 12, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.043 Vali Acc: 0.987 Test Loss: 0.043 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0176203
	speed: 0.7972s/iter; left time: 28894.8990s
	iters: 200, epoch: 13 | loss: 0.0044512
	speed: 0.3942s/iter; left time: 14249.6300s
	iters: 300, epoch: 13 | loss: 0.0000012
	speed: 0.4030s/iter; left time: 14527.8944s
	iters: 400, epoch: 13 | loss: 0.0000059
	speed: 0.4014s/iter; left time: 14429.5681s
Epoch: 13 cost time: 164.38741874694824
Epoch: 13, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.041 Vali Acc: 0.990 Test Loss: 0.041 Test Acc: 0.990
Validation loss decreased (-0.987721 --> -0.989540).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000002
	speed: 0.8455s/iter; left time: 30296.2018s
	iters: 200, epoch: 14 | loss: 0.3964324
	speed: 0.4517s/iter; left time: 16140.5490s
	iters: 300, epoch: 14 | loss: 0.0005192
	speed: 0.4004s/iter; left time: 14267.4243s
	iters: 400, epoch: 14 | loss: 0.0001301
	speed: 0.3929s/iter; left time: 13960.4128s
Epoch: 14 cost time: 169.823801279068
Epoch: 14, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.057 Vali Acc: 0.988 Test Loss: 0.057 Test Acc: 0.988
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0002038
	speed: 0.8055s/iter; left time: 28529.6169s
	iters: 200, epoch: 15 | loss: 0.0023934
	speed: 0.4336s/iter; left time: 15313.8336s
	iters: 300, epoch: 15 | loss: 0.0000078
	speed: 0.4181s/iter; left time: 14724.6176s
	iters: 400, epoch: 15 | loss: 0.0004623
	speed: 0.4003s/iter; left time: 14057.9039s
Epoch: 15 cost time: 169.28435754776
Epoch: 15, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.075 Vali Acc: 0.985 Test Loss: 0.075 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000352
	speed: 0.8337s/iter; left time: 29183.7001s
	iters: 200, epoch: 16 | loss: 0.0000963
	speed: 0.4452s/iter; left time: 15541.3096s
	iters: 300, epoch: 16 | loss: 0.0023769
	speed: 0.4196s/iter; left time: 14603.2870s
	iters: 400, epoch: 16 | loss: 0.0000023
	speed: 0.3796s/iter; left time: 13175.7699s
Epoch: 16 cost time: 171.60682249069214
Epoch: 16, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.128 Vali Acc: 0.971 Test Loss: 0.128 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0000430
	speed: 0.8204s/iter; left time: 28380.5597s
	iters: 200, epoch: 17 | loss: 0.0053955
	speed: 0.4337s/iter; left time: 14958.8062s
	iters: 300, epoch: 17 | loss: 0.0000386
	speed: 0.4118s/iter; left time: 14163.4723s
	iters: 400, epoch: 17 | loss: 0.0000009
	speed: 0.4080s/iter; left time: 13990.7669s
Epoch: 17 cost time: 172.05098700523376
Epoch: 17, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.106 Vali Acc: 0.979 Test Loss: 0.106 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000067
	speed: 0.7944s/iter; left time: 27152.0074s
	iters: 200, epoch: 18 | loss: 0.0001177
	speed: 0.4174s/iter; left time: 14226.2486s
	iters: 300, epoch: 18 | loss: 0.0008574
	speed: 0.4109s/iter; left time: 13961.9381s
	iters: 400, epoch: 18 | loss: 0.0001418
	speed: 0.3842s/iter; left time: 13017.3207s
Epoch: 18 cost time: 165.21575617790222
Epoch: 18, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0937109
	speed: 0.8107s/iter; left time: 27374.0182s
	iters: 200, epoch: 19 | loss: 0.0010653
	speed: 0.3969s/iter; left time: 13362.7242s
	iters: 300, epoch: 19 | loss: 0.0000110
	speed: 0.4123s/iter; left time: 13840.3902s
	iters: 400, epoch: 19 | loss: 0.0001215
	speed: 0.3988s/iter; left time: 13345.7607s
Epoch: 19 cost time: 165.72842574119568
Epoch: 19, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.108 Vali Acc: 0.979 Test Loss: 0.108 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0003388
	speed: 0.8584s/iter; left time: 28631.3226s
	iters: 200, epoch: 20 | loss: 0.0000364
	speed: 0.4228s/iter; left time: 14059.7496s
	iters: 300, epoch: 20 | loss: 0.0014706
	speed: 0.4110s/iter; left time: 13626.3041s
	iters: 400, epoch: 20 | loss: 0.0003492
	speed: 0.4017s/iter; left time: 13277.5421s
Epoch: 20 cost time: 170.23845791816711
Epoch: 20, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0000014
	speed: 0.8054s/iter; left time: 26530.6684s
	iters: 200, epoch: 21 | loss: 0.0018049
	speed: 0.4164s/iter; left time: 13673.6422s
	iters: 300, epoch: 21 | loss: 0.2858412
	speed: 0.4222s/iter; left time: 13823.3575s
	iters: 400, epoch: 21 | loss: 0.0000118
	speed: 0.4196s/iter; left time: 13696.0758s
Epoch: 21 cost time: 171.99397206306458
Epoch: 21, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.077 Vali Acc: 0.985 Test Loss: 0.077 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0008074
	speed: 0.8943s/iter; left time: 29089.8742s
	iters: 200, epoch: 22 | loss: 0.0000390
	speed: 0.3921s/iter; left time: 12715.1888s
	iters: 300, epoch: 22 | loss: 0.1322655
	speed: 0.3890s/iter; left time: 12574.5240s
	iters: 400, epoch: 22 | loss: 0.0000555
	speed: 0.4383s/iter; left time: 14126.4650s
Epoch: 22 cost time: 172.15349435806274
Epoch: 22, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.077 Vali Acc: 0.985 Test Loss: 0.077 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0000017
	speed: 0.8987s/iter; left time: 28861.5223s
	iters: 200, epoch: 23 | loss: 0.0000001
	speed: 0.3695s/iter; left time: 11830.6053s
	iters: 300, epoch: 23 | loss: 0.0000563
	speed: 0.4113s/iter; left time: 13125.1571s
	iters: 400, epoch: 23 | loss: 0.0563595
	speed: 0.4297s/iter; left time: 13671.4863s
Epoch: 23 cost time: 169.69146919250488
Epoch: 23, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.137 Vali Acc: 0.981 Test Loss: 0.137 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df128_ma28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9895407003183265
model parameter : 259722
model size : 3.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df128_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.5472484
	speed: 0.3914s/iter; left time: 16126.7655s
	iters: 200, epoch: 1 | loss: 0.6190177
	speed: 0.3726s/iter; left time: 15314.7123s
	iters: 300, epoch: 1 | loss: 0.1946454
	speed: 0.3747s/iter; left time: 15362.8040s
	iters: 400, epoch: 1 | loss: 0.1487323
	speed: 0.3749s/iter; left time: 15335.0337s
Epoch: 1 cost time: 156.29317235946655
Epoch: 1, Steps: 413 | Train Loss: 0.897 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
Validation loss decreased (inf --> -0.965437).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0582486
	speed: 0.7603s/iter; left time: 31012.0063s
	iters: 200, epoch: 2 | loss: 0.0332259
	speed: 0.3551s/iter; left time: 14446.6083s
	iters: 300, epoch: 2 | loss: 0.0876230
	speed: 0.3852s/iter; left time: 15633.9606s
	iters: 400, epoch: 2 | loss: 0.0577933
	speed: 0.3917s/iter; left time: 15859.2198s
Epoch: 2 cost time: 154.60066652297974
Epoch: 2, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.057 Vali Acc: 0.982 Test Loss: 0.057 Test Acc: 0.982
Validation loss decreased (-0.965437 --> -0.981809).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0050539
	speed: 0.7870s/iter; left time: 31775.3335s
	iters: 200, epoch: 3 | loss: 0.0125484
	speed: 0.4226s/iter; left time: 17021.5297s
	iters: 300, epoch: 3 | loss: 0.0129902
	speed: 0.3985s/iter; left time: 16008.1696s
	iters: 400, epoch: 3 | loss: 0.0099284
	speed: 0.3930s/iter; left time: 15748.3376s
Epoch: 3 cost time: 165.24789595603943
Epoch: 3, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.064 Vali Acc: 0.976 Test Loss: 0.064 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0215125
	speed: 0.8071s/iter; left time: 32254.4098s
	iters: 200, epoch: 4 | loss: 0.0096493
	speed: 0.3987s/iter; left time: 15891.4930s
	iters: 300, epoch: 4 | loss: 0.0073536
	speed: 0.4033s/iter; left time: 16035.7249s
	iters: 400, epoch: 4 | loss: 0.0219613
	speed: 0.3938s/iter; left time: 15619.1362s
Epoch: 4 cost time: 164.0981481075287
Epoch: 4, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.061 Vali Acc: 0.980 Test Loss: 0.061 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0031135
	speed: 0.8089s/iter; left time: 31991.7078s
	iters: 200, epoch: 5 | loss: 0.0055948
	speed: 0.4222s/iter; left time: 16657.0195s
	iters: 300, epoch: 5 | loss: 0.0008898
	speed: 0.4225s/iter; left time: 16624.3464s
	iters: 400, epoch: 5 | loss: 0.0309652
	speed: 0.4134s/iter; left time: 16226.8251s
Epoch: 5 cost time: 169.22530913352966
Epoch: 5, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.046 Vali Acc: 0.982 Test Loss: 0.046 Test Acc: 0.982
Validation loss decreased (-0.981809 --> -0.981809).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0014872
	speed: 0.7890s/iter; left time: 30880.0591s
	iters: 200, epoch: 6 | loss: 0.0014897
	speed: 0.3712s/iter; left time: 14488.7090s
	iters: 300, epoch: 6 | loss: 0.0056749
	speed: 0.4085s/iter; left time: 15904.7630s
	iters: 400, epoch: 6 | loss: 0.0034959
	speed: 0.4193s/iter; left time: 16282.1109s
Epoch: 6 cost time: 162.68936967849731
Epoch: 6, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.029 Vali Acc: 0.989 Test Loss: 0.029 Test Acc: 0.989
Validation loss decreased (-0.981809 --> -0.988631).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0018465
	speed: 0.8071s/iter; left time: 31254.7023s
	iters: 200, epoch: 7 | loss: 0.0010686
	speed: 0.3857s/iter; left time: 14897.5857s
	iters: 300, epoch: 7 | loss: 0.0053275
	speed: 0.3938s/iter; left time: 15168.4626s
	iters: 400, epoch: 7 | loss: 0.1627925
	speed: 0.4181s/iter; left time: 16064.1945s
Epoch: 7 cost time: 162.9544632434845
Epoch: 7, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.088 Vali Acc: 0.974 Test Loss: 0.088 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0003155
	speed: 0.8457s/iter; left time: 32397.2663s
	iters: 200, epoch: 8 | loss: 0.0004827
	speed: 0.3759s/iter; left time: 14364.2900s
	iters: 300, epoch: 8 | loss: 0.0206624
	speed: 0.3700s/iter; left time: 14101.5254s
	iters: 400, epoch: 8 | loss: 0.0014630
	speed: 0.3997s/iter; left time: 15194.2318s
Epoch: 8 cost time: 159.9762556552887
Epoch: 8, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0010092
	speed: 0.8492s/iter; left time: 32183.0826s
	iters: 200, epoch: 9 | loss: 0.0006039
	speed: 0.3934s/iter; left time: 14869.0388s
	iters: 300, epoch: 9 | loss: 0.0001643
	speed: 0.3953s/iter; left time: 14902.0820s
	iters: 400, epoch: 9 | loss: 0.0550142
	speed: 0.4014s/iter; left time: 15092.7164s
Epoch: 9 cost time: 164.9370756149292
Epoch: 9, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0004958
	speed: 0.7941s/iter; left time: 29764.1952s
	iters: 200, epoch: 10 | loss: 0.1998756
	speed: 0.3965s/iter; left time: 14821.1585s
	iters: 300, epoch: 10 | loss: 0.0000129
	speed: 0.3905s/iter; left time: 14561.1788s
	iters: 400, epoch: 10 | loss: 0.0081810
	speed: 0.3886s/iter; left time: 14449.4089s
Epoch: 10 cost time: 161.97467017173767
Epoch: 10, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.085 Vali Acc: 0.979 Test Loss: 0.085 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0001164
	speed: 0.7765s/iter; left time: 28785.3366s
	iters: 200, epoch: 11 | loss: 0.0010357
	speed: 0.4260s/iter; left time: 15750.5502s
	iters: 300, epoch: 11 | loss: 0.0073650
	speed: 0.4486s/iter; left time: 16540.2462s
	iters: 400, epoch: 11 | loss: 0.0002087
	speed: 0.4268s/iter; left time: 15692.3274s
Epoch: 11 cost time: 172.3648717403412
Epoch: 11, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0042182
	speed: 0.8031s/iter; left time: 29439.1648s
	iters: 200, epoch: 12 | loss: 0.0001998
	speed: 0.4071s/iter; left time: 14881.2087s
	iters: 300, epoch: 12 | loss: 0.0002489
	speed: 0.3895s/iter; left time: 14201.5832s
	iters: 400, epoch: 12 | loss: 0.0004987
	speed: 0.4035s/iter; left time: 14669.2959s
Epoch: 12 cost time: 163.98174595832825
Epoch: 12, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.075 Vali Acc: 0.984 Test Loss: 0.075 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.1962068
	speed: 0.8217s/iter; left time: 29781.8224s
	iters: 200, epoch: 13 | loss: 0.1234129
	speed: 0.3970s/iter; left time: 14351.2659s
	iters: 300, epoch: 13 | loss: 0.0000066
	speed: 0.3792s/iter; left time: 13669.0042s
	iters: 400, epoch: 13 | loss: 0.0030224
	speed: 0.4077s/iter; left time: 14656.2476s
Epoch: 13 cost time: 161.977703332901
Epoch: 13, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.050 Vali Acc: 0.987 Test Loss: 0.050 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0007430
	speed: 0.8030s/iter; left time: 28773.6180s
	iters: 200, epoch: 14 | loss: 0.0000384
	speed: 0.3834s/iter; left time: 13698.0405s
	iters: 300, epoch: 14 | loss: 0.0242275
	speed: 0.3858s/iter; left time: 13746.3234s
	iters: 400, epoch: 14 | loss: 0.0184403
	speed: 0.3907s/iter; left time: 13882.1315s
Epoch: 14 cost time: 160.59970092773438
Epoch: 14, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.060 Vali Acc: 0.982 Test Loss: 0.060 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0001329
	speed: 0.7768s/iter; left time: 27514.2608s
	iters: 200, epoch: 15 | loss: 0.0000184
	speed: 0.3737s/iter; left time: 13199.4007s
	iters: 300, epoch: 15 | loss: 0.0002326
	speed: 0.3961s/iter; left time: 13948.5589s
	iters: 400, epoch: 15 | loss: 0.0009586
	speed: 0.3846s/iter; left time: 13505.1024s
Epoch: 15 cost time: 158.54098176956177
Epoch: 15, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0000179
	speed: 0.8024s/iter; left time: 28090.3193s
	iters: 200, epoch: 16 | loss: 0.0276482
	speed: 0.3877s/iter; left time: 13531.6728s
	iters: 300, epoch: 16 | loss: 0.0082840
	speed: 0.3690s/iter; left time: 12842.6495s
	iters: 400, epoch: 16 | loss: 0.0000008
	speed: 0.3757s/iter; left time: 13038.5925s
Epoch: 16 cost time: 156.70374846458435
Epoch: 16, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df128_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.988631195998181
model parameter : 259722
model size : 3.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df128_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.0912070
	speed: 0.3832s/iter; left time: 15790.0243s
	iters: 200, epoch: 1 | loss: 0.8785987
	speed: 0.3473s/iter; left time: 14275.5039s
	iters: 300, epoch: 1 | loss: 0.1827268
	speed: 0.3425s/iter; left time: 14041.8688s
	iters: 400, epoch: 1 | loss: 0.1657885
	speed: 0.3576s/iter; left time: 14626.5026s
Epoch: 1 cost time: 147.8781931400299
Epoch: 1, Steps: 413 | Train Loss: 1.070 Vali Loss: 0.164 Vali Acc: 0.954 Test Loss: 0.164 Test Acc: 0.954
Validation loss decreased (inf --> -0.953614).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0512122
	speed: 0.8319s/iter; left time: 33929.7924s
	iters: 200, epoch: 2 | loss: 0.0953000
	speed: 0.3630s/iter; left time: 14769.0041s
	iters: 300, epoch: 2 | loss: 0.0494329
	speed: 0.3355s/iter; left time: 13617.7482s
	iters: 400, epoch: 2 | loss: 0.0461737
	speed: 0.3377s/iter; left time: 13674.2054s
Epoch: 2 cost time: 148.48345589637756
Epoch: 2, Steps: 413 | Train Loss: 0.106 Vali Loss: 0.079 Vali Acc: 0.975 Test Loss: 0.079 Test Acc: 0.975
Validation loss decreased (-0.953614 --> -0.974988).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0038723
	speed: 0.8141s/iter; left time: 32870.7461s
	iters: 200, epoch: 3 | loss: 0.0250174
	speed: 0.3935s/iter; left time: 15846.3477s
	iters: 300, epoch: 3 | loss: 0.0113194
	speed: 0.3797s/iter; left time: 15254.7557s
	iters: 400, epoch: 3 | loss: 0.0053576
	speed: 0.3795s/iter; left time: 15206.8047s
Epoch: 3 cost time: 161.92276906967163
Epoch: 3, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.077 Vali Acc: 0.974 Test Loss: 0.077 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0298773
	speed: 0.7909s/iter; left time: 31606.2889s
	iters: 200, epoch: 4 | loss: 0.0182801
	speed: 0.4134s/iter; left time: 16478.2912s
	iters: 300, epoch: 4 | loss: 0.0006685
	speed: 0.4090s/iter; left time: 16261.1848s
	iters: 400, epoch: 4 | loss: 0.0216400
	speed: 0.3798s/iter; left time: 15064.4642s
Epoch: 4 cost time: 164.29127621650696
Epoch: 4, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.096 Vali Acc: 0.971 Test Loss: 0.096 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0131535
	speed: 0.7687s/iter; left time: 30403.2627s
	iters: 200, epoch: 5 | loss: 0.0064812
	speed: 0.4056s/iter; left time: 15998.5710s
	iters: 300, epoch: 5 | loss: 0.0021102
	speed: 0.4211s/iter; left time: 16570.5237s
	iters: 400, epoch: 5 | loss: 0.0076863
	speed: 0.3726s/iter; left time: 14623.9753s
Epoch: 5 cost time: 162.07568192481995
Epoch: 5, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.054 Vali Acc: 0.981 Test Loss: 0.054 Test Acc: 0.981
Validation loss decreased (-0.974988 --> -0.980900).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0006611
	speed: 0.8081s/iter; left time: 31627.7246s
	iters: 200, epoch: 6 | loss: 0.0018941
	speed: 0.4255s/iter; left time: 16610.8990s
	iters: 300, epoch: 6 | loss: 0.0197830
	speed: 0.4018s/iter; left time: 15642.5774s
	iters: 400, epoch: 6 | loss: 0.0009161
	speed: 0.3721s/iter; left time: 14450.7753s
Epoch: 6 cost time: 166.94269633293152
Epoch: 6, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.061 Vali Acc: 0.981 Test Loss: 0.061 Test Acc: 0.981
Validation loss decreased (-0.980900 --> -0.981355).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0007356
	speed: 0.7745s/iter; left time: 29991.1474s
	iters: 200, epoch: 7 | loss: 0.0005313
	speed: 0.3772s/iter; left time: 14566.8446s
	iters: 300, epoch: 7 | loss: 0.0179033
	speed: 0.3860s/iter; left time: 14871.1051s
	iters: 400, epoch: 7 | loss: 0.0553674
	speed: 0.3723s/iter; left time: 14306.2180s
Epoch: 7 cost time: 156.45727467536926
Epoch: 7, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.083 Vali Acc: 0.971 Test Loss: 0.083 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0025217
	speed: 0.6997s/iter; left time: 26805.1024s
	iters: 200, epoch: 8 | loss: 0.0188142
	speed: 0.3550s/iter; left time: 13564.8389s
	iters: 300, epoch: 8 | loss: 0.0011609
	speed: 0.3609s/iter; left time: 13754.1298s
	iters: 400, epoch: 8 | loss: 0.0000451
	speed: 0.3729s/iter; left time: 14173.8218s
Epoch: 8 cost time: 147.51088213920593
Epoch: 8, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0140564
	speed: 0.8151s/iter; left time: 30889.6660s
	iters: 200, epoch: 9 | loss: 0.0164260
	speed: 0.3754s/iter; left time: 14188.5978s
	iters: 300, epoch: 9 | loss: 0.0001361
	speed: 0.3987s/iter; left time: 15029.5381s
	iters: 400, epoch: 9 | loss: 0.0014698
	speed: 0.4102s/iter; left time: 15420.5547s
Epoch: 9 cost time: 163.70696330070496
Epoch: 9, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.060 Vali Acc: 0.981 Test Loss: 0.060 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0156962
	speed: 0.7324s/iter; left time: 27452.2450s
	iters: 200, epoch: 10 | loss: 0.1454118
	speed: 0.3594s/iter; left time: 13436.4460s
	iters: 300, epoch: 10 | loss: 0.0007771
	speed: 0.3667s/iter; left time: 13670.4646s
	iters: 400, epoch: 10 | loss: 0.0037760
	speed: 0.3531s/iter; left time: 13131.2891s
Epoch: 10 cost time: 148.5423882007599
Epoch: 10, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.113 Vali Acc: 0.969 Test Loss: 0.113 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0133675
	speed: 0.8037s/iter; left time: 29794.2044s
	iters: 200, epoch: 11 | loss: 0.0004046
	speed: 0.4138s/iter; left time: 15296.9001s
	iters: 300, epoch: 11 | loss: 0.0577527
	speed: 0.4114s/iter; left time: 15169.7909s
	iters: 400, epoch: 11 | loss: 0.0014605
	speed: 0.4203s/iter; left time: 15456.3756s
Epoch: 11 cost time: 170.71562004089355
Epoch: 11, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000307
	speed: 0.8051s/iter; left time: 29514.3827s
	iters: 200, epoch: 12 | loss: 0.0002569
	speed: 0.3975s/iter; left time: 14533.5731s
	iters: 300, epoch: 12 | loss: 0.0002824
	speed: 0.3805s/iter; left time: 13870.7285s
	iters: 400, epoch: 12 | loss: 0.0002374
	speed: 0.3874s/iter; left time: 14084.1955s
Epoch: 12 cost time: 160.6132469177246
Epoch: 12, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000120
	speed: 0.8082s/iter; left time: 29293.9637s
	iters: 200, epoch: 13 | loss: 0.1382714
	speed: 0.3917s/iter; left time: 14157.3676s
	iters: 300, epoch: 13 | loss: 0.0004696
	speed: 0.3912s/iter; left time: 14100.6340s
	iters: 400, epoch: 13 | loss: 0.0000741
	speed: 0.4417s/iter; left time: 15876.3085s
Epoch: 13 cost time: 166.5992112159729
Epoch: 13, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000065
	speed: 0.8557s/iter; left time: 30660.8572s
	iters: 200, epoch: 14 | loss: 0.0002174
	speed: 0.3803s/iter; left time: 13589.5935s
	iters: 300, epoch: 14 | loss: 0.0000027
	speed: 0.3585s/iter; left time: 12774.2360s
	iters: 400, epoch: 14 | loss: 0.0000239
	speed: 0.4065s/iter; left time: 14445.5094s
Epoch: 14 cost time: 160.7413740158081
Epoch: 14, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0046627
	speed: 0.8331s/iter; left time: 29506.3352s
	iters: 200, epoch: 15 | loss: 0.0056353
	speed: 0.3651s/iter; left time: 12893.5856s
	iters: 300, epoch: 15 | loss: 0.0001014
	speed: 0.3716s/iter; left time: 13087.8282s
	iters: 400, epoch: 15 | loss: 0.0064328
	speed: 0.3878s/iter; left time: 13618.1852s
Epoch: 15 cost time: 158.2533392906189
Epoch: 15, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0012688
	speed: 0.8800s/iter; left time: 30805.6173s
	iters: 200, epoch: 16 | loss: 0.0000644
	speed: 0.3734s/iter; left time: 13033.0791s
	iters: 300, epoch: 16 | loss: 0.0011920
	speed: 0.3762s/iter; left time: 13093.2441s
	iters: 400, epoch: 16 | loss: 0.0000040
	speed: 0.3809s/iter; left time: 13219.5869s
Epoch: 16 cost time: 161.7139823436737
Epoch: 16, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.133 Vali Acc: 0.972 Test Loss: 0.133 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df128_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9813551614370168
model parameter : 259722
model size : 3.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.1687784
	speed: 0.3483s/iter; left time: 14350.8749s
	iters: 200, epoch: 1 | loss: 0.8865611
	speed: 0.3558s/iter; left time: 14622.5961s
	iters: 300, epoch: 1 | loss: 0.1979599
	speed: 0.3536s/iter; left time: 14497.1657s
	iters: 400, epoch: 1 | loss: 0.1334466
	speed: 0.3532s/iter; left time: 14447.5691s
Epoch: 1 cost time: 145.71273565292358
Epoch: 1, Steps: 413 | Train Loss: 1.119 Vali Loss: 0.163 Vali Acc: 0.953 Test Loss: 0.163 Test Acc: 0.953
Validation loss decreased (inf --> -0.953159).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0582934
	speed: 0.7094s/iter; left time: 28934.2310s
	iters: 200, epoch: 2 | loss: 0.0958824
	speed: 0.3514s/iter; left time: 14296.3559s
	iters: 300, epoch: 2 | loss: 0.0611226
	speed: 0.3514s/iter; left time: 14261.2706s
	iters: 400, epoch: 2 | loss: 0.0380229
	speed: 0.3351s/iter; left time: 13566.3363s
Epoch: 2 cost time: 143.5777509212494
Epoch: 2, Steps: 413 | Train Loss: 0.125 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
Validation loss decreased (-0.953159 --> -0.972714).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0125744
	speed: 0.6956s/iter; left time: 28086.1233s
	iters: 200, epoch: 3 | loss: 0.0598602
	speed: 0.3490s/iter; left time: 14057.6932s
	iters: 300, epoch: 3 | loss: 0.0066091
	speed: 0.3631s/iter; left time: 14586.8928s
	iters: 400, epoch: 3 | loss: 0.0044271
	speed: 0.3383s/iter; left time: 13557.2522s
Epoch: 3 cost time: 143.90603947639465
Epoch: 3, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.059 Vali Acc: 0.977 Test Loss: 0.059 Test Acc: 0.977
Validation loss decreased (-0.972714 --> -0.977262).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0541178
	speed: 0.7230s/iter; left time: 28891.9903s
	iters: 200, epoch: 4 | loss: 0.0081321
	speed: 0.3798s/iter; left time: 15137.8781s
	iters: 300, epoch: 4 | loss: 0.0106436
	speed: 0.3683s/iter; left time: 14642.7301s
	iters: 400, epoch: 4 | loss: 0.0949864
	speed: 0.3362s/iter; left time: 13335.8233s
Epoch: 4 cost time: 149.1281716823578
Epoch: 4, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.103 Vali Acc: 0.967 Test Loss: 0.103 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0325175
	speed: 0.6891s/iter; left time: 27251.3669s
	iters: 200, epoch: 5 | loss: 0.0100827
	speed: 0.3689s/iter; left time: 14553.6017s
	iters: 300, epoch: 5 | loss: 0.0026758
	speed: 0.3678s/iter; left time: 14474.3389s
	iters: 400, epoch: 5 | loss: 0.0081045
	speed: 0.3332s/iter; left time: 13078.5692s
Epoch: 5 cost time: 145.45975017547607
Epoch: 5, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.977262 --> -0.979990).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0011909
	speed: 0.6995s/iter; left time: 27377.1678s
	iters: 200, epoch: 6 | loss: 0.0028699
	speed: 0.3747s/iter; left time: 14626.6764s
	iters: 300, epoch: 6 | loss: 0.0008659
	speed: 0.3788s/iter; left time: 14748.0780s
	iters: 400, epoch: 6 | loss: 0.0400516
	speed: 0.3479s/iter; left time: 13510.3879s
Epoch: 6 cost time: 148.8541750907898
Epoch: 6, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.047 Vali Acc: 0.982 Test Loss: 0.047 Test Acc: 0.982
Validation loss decreased (-0.979990 --> -0.981809).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0028096
	speed: 0.7056s/iter; left time: 27322.4489s
	iters: 200, epoch: 7 | loss: 0.0008830
	speed: 0.3517s/iter; left time: 13582.3694s
	iters: 300, epoch: 7 | loss: 0.0033177
	speed: 0.3631s/iter; left time: 13987.6903s
	iters: 400, epoch: 7 | loss: 0.0208995
	speed: 0.3347s/iter; left time: 12859.2872s
Epoch: 7 cost time: 145.08816647529602
Epoch: 7, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0005622
	speed: 0.7074s/iter; left time: 27101.7475s
	iters: 200, epoch: 8 | loss: 0.0005611
	speed: 0.3552s/iter; left time: 13572.4822s
	iters: 300, epoch: 8 | loss: 0.0105858
	speed: 0.3562s/iter; left time: 13575.3938s
	iters: 400, epoch: 8 | loss: 0.0001101
	speed: 0.3570s/iter; left time: 13569.5588s
Epoch: 8 cost time: 146.087952375412
Epoch: 8, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.050 Vali Acc: 0.982 Test Loss: 0.050 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.1005811
	speed: 0.7241s/iter; left time: 27439.7713s
	iters: 200, epoch: 9 | loss: 0.0001147
	speed: 0.3677s/iter; left time: 13896.4139s
	iters: 300, epoch: 9 | loss: 0.0066444
	speed: 0.3583s/iter; left time: 13507.0139s
	iters: 400, epoch: 9 | loss: 0.0000180
	speed: 0.3589s/iter; left time: 13493.1092s
Epoch: 9 cost time: 149.06897354125977
Epoch: 9, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0407730
	speed: 0.6799s/iter; left time: 25484.8635s
	iters: 200, epoch: 10 | loss: 0.0008395
	speed: 0.3392s/iter; left time: 12680.5857s
	iters: 300, epoch: 10 | loss: 0.0000698
	speed: 0.3503s/iter; left time: 13059.4165s
	iters: 400, epoch: 10 | loss: 0.0025413
	speed: 0.3543s/iter; left time: 13174.6522s
Epoch: 10 cost time: 143.3764955997467
Epoch: 10, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0004411
	speed: 0.6874s/iter; left time: 25482.9267s
	iters: 200, epoch: 11 | loss: 0.0026018
	speed: 0.3405s/iter; left time: 12588.7211s
	iters: 300, epoch: 11 | loss: 0.0000659
	speed: 0.3732s/iter; left time: 13760.9528s
	iters: 400, epoch: 11 | loss: 0.0018759
	speed: 0.3785s/iter; left time: 13916.1180s
Epoch: 11 cost time: 147.18615627288818
Epoch: 11, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0015341
	speed: 0.8167s/iter; left time: 29940.1039s
	iters: 200, epoch: 12 | loss: 0.0054351
	speed: 0.3911s/iter; left time: 14296.6156s
	iters: 300, epoch: 12 | loss: 0.0000218
	speed: 0.3791s/iter; left time: 13820.3151s
	iters: 400, epoch: 12 | loss: 0.2123128
	speed: 0.4286s/iter; left time: 15583.4043s
Epoch: 12 cost time: 165.4219193458557
Epoch: 12, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.135 Vali Acc: 0.971 Test Loss: 0.135 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0148662
	speed: 0.8947s/iter; left time: 32429.8403s
	iters: 200, epoch: 13 | loss: 0.5163642
	speed: 0.3907s/iter; left time: 14120.7098s
	iters: 300, epoch: 13 | loss: 0.0006416
	speed: 0.3931s/iter; left time: 14170.4550s
	iters: 400, epoch: 13 | loss: 0.0002838
	speed: 0.4211s/iter; left time: 15135.9862s
Epoch: 13 cost time: 169.0318524837494
Epoch: 13, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.081 Vali Acc: 0.982 Test Loss: 0.081 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0022642
	speed: 1.0024s/iter; left time: 35916.7414s
	iters: 200, epoch: 14 | loss: 0.0000297
	speed: 0.4134s/iter; left time: 14772.5251s
	iters: 300, epoch: 14 | loss: 0.0000418
	speed: 0.4096s/iter; left time: 14593.9981s
	iters: 400, epoch: 14 | loss: 0.0265975
	speed: 0.4141s/iter; left time: 14714.0659s
Epoch: 14 cost time: 177.98611521720886
Epoch: 14, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0000024
	speed: 0.9199s/iter; left time: 32583.0605s
	iters: 200, epoch: 15 | loss: 0.0000150
	speed: 0.4362s/iter; left time: 15407.0188s
	iters: 300, epoch: 15 | loss: 0.0006880
	speed: 0.4135s/iter; left time: 14562.3248s
	iters: 400, epoch: 15 | loss: 0.0000034
	speed: 0.3909s/iter; left time: 13728.5319s
Epoch: 15 cost time: 175.7775993347168
Epoch: 15, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0000924
	speed: 0.9267s/iter; left time: 32439.1308s
	iters: 200, epoch: 16 | loss: 0.0002755
	speed: 0.4617s/iter; left time: 16114.7429s
	iters: 300, epoch: 16 | loss: 0.0003020
	speed: 0.4353s/iter; left time: 15152.4211s
	iters: 400, epoch: 16 | loss: 0.0000125
	speed: 0.4117s/iter; left time: 14288.5949s
Epoch: 16 cost time: 182.03801345825195
Epoch: 16, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.169 Vali Acc: 0.972 Test Loss: 0.169 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9818099135970896
model parameter : 259722
model size : 3.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.1900039
	speed: 0.4197s/iter; left time: 17290.7352s
	iters: 200, epoch: 1 | loss: 0.9416177
	speed: 0.3991s/iter; left time: 16403.9125s
	iters: 300, epoch: 1 | loss: 0.2492878
	speed: 0.3758s/iter; left time: 15409.5306s
	iters: 400, epoch: 1 | loss: 0.1492602
	speed: 0.3697s/iter; left time: 15121.1280s
Epoch: 1 cost time: 161.60271286964417
Epoch: 1, Steps: 413 | Train Loss: 1.138 Vali Loss: 0.182 Vali Acc: 0.950 Test Loss: 0.182 Test Acc: 0.950
Validation loss decreased (inf --> -0.949521).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0742854
	speed: 0.7978s/iter; left time: 32541.0225s
	iters: 200, epoch: 2 | loss: 0.0555567
	speed: 0.3986s/iter; left time: 16218.7290s
	iters: 300, epoch: 2 | loss: 0.1011441
	speed: 0.3910s/iter; left time: 15870.6706s
	iters: 400, epoch: 2 | loss: 0.0216664
	speed: 0.3710s/iter; left time: 15020.3181s
Epoch: 2 cost time: 160.57283782958984
Epoch: 2, Steps: 413 | Train Loss: 0.134 Vali Loss: 0.068 Vali Acc: 0.978 Test Loss: 0.068 Test Acc: 0.978
Validation loss decreased (-0.949521 --> -0.977716).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0107148
	speed: 0.8141s/iter; left time: 32869.9279s
	iters: 200, epoch: 3 | loss: 0.0921218
	speed: 0.3685s/iter; left time: 14841.3292s
	iters: 300, epoch: 3 | loss: 0.0088722
	speed: 0.3924s/iter; left time: 15763.9628s
	iters: 400, epoch: 3 | loss: 0.0056370
	speed: 0.3815s/iter; left time: 15289.1033s
Epoch: 3 cost time: 158.12140250205994
Epoch: 3, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.071 Vali Acc: 0.974 Test Loss: 0.071 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1184621
	speed: 0.9160s/iter; left time: 36604.9297s
	iters: 200, epoch: 4 | loss: 0.0040667
	speed: 0.4216s/iter; left time: 16807.6941s
	iters: 300, epoch: 4 | loss: 0.0151512
	speed: 0.4181s/iter; left time: 16624.9895s
	iters: 400, epoch: 4 | loss: 0.1405465
	speed: 0.4346s/iter; left time: 17236.6278s
Epoch: 4 cost time: 178.83423137664795
Epoch: 4, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.071 Vali Acc: 0.975 Test Loss: 0.071 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0017296
	speed: 0.9250s/iter; left time: 36580.9422s
	iters: 200, epoch: 5 | loss: 0.0127102
	speed: 0.3308s/iter; left time: 13049.4369s
	iters: 300, epoch: 5 | loss: 0.0177485
	speed: 0.3041s/iter; left time: 11967.2474s
	iters: 400, epoch: 5 | loss: 0.0220318
	speed: 0.3101s/iter; left time: 12171.0035s
Epoch: 5 cost time: 140.78118753433228
Epoch: 5, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.085 Vali Acc: 0.971 Test Loss: 0.085 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0058204
	speed: 0.6891s/iter; left time: 26969.6377s
	iters: 200, epoch: 6 | loss: 0.0005274
	speed: 0.3288s/iter; left time: 12836.5442s
	iters: 300, epoch: 6 | loss: 0.0043909
	speed: 0.3255s/iter; left time: 12675.4488s
	iters: 400, epoch: 6 | loss: 0.0228444
	speed: 0.3404s/iter; left time: 13218.4545s
Epoch: 6 cost time: 135.8719756603241
Epoch: 6, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.072 Vali Acc: 0.975 Test Loss: 0.072 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0035563
	speed: 0.6424s/iter; left time: 24874.2815s
	iters: 200, epoch: 7 | loss: 0.0004587
	speed: 0.3161s/iter; left time: 12207.6602s
	iters: 300, epoch: 7 | loss: 0.0029964
	speed: 0.3325s/iter; left time: 12807.6395s
	iters: 400, epoch: 7 | loss: 0.0597277
	speed: 0.3382s/iter; left time: 12993.3075s
Epoch: 7 cost time: 133.35933446884155
Epoch: 7, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.053 Vali Acc: 0.980 Test Loss: 0.053 Test Acc: 0.980
Validation loss decreased (-0.977716 --> -0.979536).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0018006
	speed: 0.6595s/iter; left time: 25264.7983s
	iters: 200, epoch: 8 | loss: 0.0062539
	speed: 0.3181s/iter; left time: 12156.3894s
	iters: 300, epoch: 8 | loss: 0.0175667
	speed: 0.3335s/iter; left time: 12709.1574s
	iters: 400, epoch: 8 | loss: 0.0001091
	speed: 0.3249s/iter; left time: 12349.4851s
Epoch: 8 cost time: 131.9022536277771
Epoch: 8, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.069 Vali Acc: 0.975 Test Loss: 0.069 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0001554
	speed: 0.7188s/iter; left time: 27239.4990s
	iters: 200, epoch: 9 | loss: 0.0044730
	speed: 0.3237s/iter; left time: 12235.6181s
	iters: 300, epoch: 9 | loss: 0.0088808
	speed: 0.3120s/iter; left time: 11761.0522s
	iters: 400, epoch: 9 | loss: 0.0000168
	speed: 0.2857s/iter; left time: 10740.3523s
Epoch: 9 cost time: 130.60892033576965
Epoch: 9, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0415750
	speed: 0.6849s/iter; left time: 25672.7460s
	iters: 200, epoch: 10 | loss: 0.0061713
	speed: 0.3284s/iter; left time: 12277.6400s
	iters: 300, epoch: 10 | loss: 0.0015502
	speed: 0.3298s/iter; left time: 12294.4430s
	iters: 400, epoch: 10 | loss: 0.0122582
	speed: 0.3317s/iter; left time: 12332.3010s
Epoch: 10 cost time: 137.26150178909302
Epoch: 10, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0007645
	speed: 0.7404s/iter; left time: 27445.9199s
	iters: 200, epoch: 11 | loss: 0.0002181
	speed: 0.3272s/iter; left time: 12096.2413s
	iters: 300, epoch: 11 | loss: 0.0001161
	speed: 0.3212s/iter; left time: 11841.6657s
	iters: 400, epoch: 11 | loss: 0.0007411
	speed: 0.3221s/iter; left time: 11844.9607s
Epoch: 11 cost time: 137.4998128414154
Epoch: 11, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.148 Vali Acc: 0.967 Test Loss: 0.148 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000138
	speed: 0.6822s/iter; left time: 25009.3562s
	iters: 200, epoch: 12 | loss: 0.0136220
	speed: 0.3189s/iter; left time: 11659.7854s
	iters: 300, epoch: 12 | loss: 0.0021489
	speed: 0.3305s/iter; left time: 12048.4113s
	iters: 400, epoch: 12 | loss: 0.0000010
	speed: 0.3271s/iter; left time: 11893.3142s
Epoch: 12 cost time: 134.89675998687744
Epoch: 12, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.109 Vali Acc: 0.972 Test Loss: 0.109 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0571769
	speed: 0.6930s/iter; left time: 25116.6111s
	iters: 200, epoch: 13 | loss: 0.1648891
	speed: 0.3286s/iter; left time: 11878.8882s
	iters: 300, epoch: 13 | loss: 0.0000293
	speed: 0.3248s/iter; left time: 11706.6196s
	iters: 400, epoch: 13 | loss: 0.0003225
	speed: 0.3143s/iter; left time: 11297.4065s
Epoch: 13 cost time: 134.97541785240173
Epoch: 13, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.157 Vali Acc: 0.963 Test Loss: 0.157 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0022950
	speed: 0.6685s/iter; left time: 23953.6604s
	iters: 200, epoch: 14 | loss: 0.0070486
	speed: 0.3353s/iter; left time: 11981.3552s
	iters: 300, epoch: 14 | loss: 0.0000065
	speed: 0.3124s/iter; left time: 11133.1959s
	iters: 400, epoch: 14 | loss: 0.0125840
	speed: 0.2697s/iter; left time: 9584.1172s
Epoch: 14 cost time: 129.05533409118652
Epoch: 14, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0151925
	speed: 0.6434s/iter; left time: 22789.6617s
	iters: 200, epoch: 15 | loss: 0.0000029
	speed: 0.3421s/iter; left time: 12081.3581s
	iters: 300, epoch: 15 | loss: 0.0006088
	speed: 0.3297s/iter; left time: 11611.1083s
	iters: 400, epoch: 15 | loss: 0.0000011
	speed: 0.2989s/iter; left time: 10496.5349s
Epoch: 15 cost time: 133.01457738876343
Epoch: 15, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0000825
	speed: 0.6590s/iter; left time: 23070.0815s
	iters: 200, epoch: 16 | loss: 0.0000406
	speed: 0.3012s/iter; left time: 10512.7667s
	iters: 300, epoch: 16 | loss: 0.0052581
	speed: 0.3085s/iter; left time: 10738.3767s
	iters: 400, epoch: 16 | loss: 0.0000001
	speed: 0.3160s/iter; left time: 10968.0523s
Epoch: 16 cost time: 129.0222806930542
Epoch: 16, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
Validation loss decreased (-0.979536 --> -0.980900).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000049
	speed: 0.7027s/iter; left time: 24308.1718s
	iters: 200, epoch: 17 | loss: 0.0002374
	speed: 0.3204s/iter; left time: 11051.4288s
	iters: 300, epoch: 17 | loss: 0.0000020
	speed: 0.3137s/iter; left time: 10790.7446s
	iters: 400, epoch: 17 | loss: 0.0000008
	speed: 0.3132s/iter; left time: 10740.8145s
Epoch: 17 cost time: 133.38959097862244
Epoch: 17, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000799
	speed: 0.7145s/iter; left time: 24420.7528s
	iters: 200, epoch: 18 | loss: 0.0166537
	speed: 0.3433s/iter; left time: 11698.5219s
	iters: 300, epoch: 18 | loss: 0.0200564
	speed: 0.3363s/iter; left time: 11428.8779s
	iters: 400, epoch: 18 | loss: 0.0021098
	speed: 0.3439s/iter; left time: 11651.8534s
Epoch: 18 cost time: 142.22678446769714
Epoch: 18, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.148 Vali Acc: 0.971 Test Loss: 0.148 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0007009
	speed: 0.7343s/iter; left time: 24793.7993s
	iters: 200, epoch: 19 | loss: 0.0008739
	speed: 0.3448s/iter; left time: 11609.5864s
	iters: 300, epoch: 19 | loss: 0.0006287
	speed: 0.3471s/iter; left time: 11649.6156s
	iters: 400, epoch: 19 | loss: 0.1124563
	speed: 0.3444s/iter; left time: 11526.3486s
Epoch: 19 cost time: 142.00128030776978
Epoch: 19, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.062 Vali Acc: 0.982 Test Loss: 0.062 Test Acc: 0.982
Validation loss decreased (-0.980900 --> -0.982264).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0038925
	speed: 0.7323s/iter; left time: 24425.2910s
	iters: 200, epoch: 20 | loss: 0.0001887
	speed: 0.3739s/iter; left time: 12434.0108s
	iters: 300, epoch: 20 | loss: 0.0022250
	speed: 0.3687s/iter; left time: 12222.3645s
	iters: 400, epoch: 20 | loss: 0.0000305
	speed: 0.3627s/iter; left time: 11989.4925s
Epoch: 20 cost time: 151.09317541122437
Epoch: 20, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
Validation loss decreased (-0.982264 --> -0.982718).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000430
	speed: 0.7775s/iter; left time: 25611.0412s
	iters: 200, epoch: 21 | loss: 0.0000274
	speed: 0.3414s/iter; left time: 11210.5109s
	iters: 300, epoch: 21 | loss: 0.0065278
	speed: 0.3112s/iter; left time: 10188.2861s
	iters: 400, epoch: 21 | loss: 0.0000040
	speed: 0.3116s/iter; left time: 10171.1267s
Epoch: 21 cost time: 137.0651707649231
Epoch: 21, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000003
	speed: 0.6852s/iter; left time: 22288.9926s
	iters: 200, epoch: 22 | loss: 0.0000092
	speed: 0.3542s/iter; left time: 11485.6248s
	iters: 300, epoch: 22 | loss: 0.0000447
	speed: 0.3620s/iter; left time: 11702.7649s
	iters: 400, epoch: 22 | loss: 0.0000103
	speed: 0.3543s/iter; left time: 11418.9175s
Epoch: 22 cost time: 144.42379879951477
Epoch: 22, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000626
	speed: 0.7470s/iter; left time: 23990.3630s
	iters: 200, epoch: 23 | loss: 0.0000006
	speed: 0.3571s/iter; left time: 11434.0071s
	iters: 300, epoch: 23 | loss: 0.0009336
	speed: 0.3876s/iter; left time: 12371.5215s
	iters: 400, epoch: 23 | loss: 0.0000847
	speed: 0.3759s/iter; left time: 11959.6130s
Epoch: 23 cost time: 153.53124237060547
Epoch: 23, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.091 Vali Acc: 0.981 Test Loss: 0.091 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.1733527
	speed: 0.6739s/iter; left time: 21364.8077s
	iters: 200, epoch: 24 | loss: 0.0008594
	speed: 0.3649s/iter; left time: 11532.4405s
	iters: 300, epoch: 24 | loss: 0.0116966
	speed: 0.3641s/iter; left time: 11469.3523s
	iters: 400, epoch: 24 | loss: 0.0071626
	speed: 0.3553s/iter; left time: 11158.5232s
Epoch: 24 cost time: 145.86429166793823
Epoch: 24, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.164 Vali Acc: 0.964 Test Loss: 0.164 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0002446
	speed: 0.7339s/iter; left time: 22963.6021s
	iters: 200, epoch: 25 | loss: 0.0000707
	speed: 0.3484s/iter; left time: 10865.6730s
	iters: 300, epoch: 25 | loss: 0.1616362
	speed: 0.3567s/iter; left time: 11088.6003s
	iters: 400, epoch: 25 | loss: 0.0000001
	speed: 0.3494s/iter; left time: 10826.2282s
Epoch: 25 cost time: 144.14413738250732
Epoch: 25, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.982718 --> -0.982719).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0000209
	speed: 0.7572s/iter; left time: 23378.9123s
	iters: 200, epoch: 26 | loss: 0.0000001
	speed: 0.3316s/iter; left time: 10206.5378s
	iters: 300, epoch: 26 | loss: 0.0003036
	speed: 0.3287s/iter; left time: 10084.1371s
	iters: 400, epoch: 26 | loss: 0.0000052
	speed: 0.3365s/iter; left time: 10289.8192s
Epoch: 26 cost time: 139.205002784729
Epoch: 26, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.147 Vali Acc: 0.977 Test Loss: 0.147 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0001561
	speed: 0.8102s/iter; left time: 24680.1834s
	iters: 200, epoch: 27 | loss: 0.0000202
	speed: 0.3814s/iter; left time: 11580.7967s
	iters: 300, epoch: 27 | loss: 0.0076758
	speed: 0.3344s/iter; left time: 10120.7271s
	iters: 400, epoch: 27 | loss: 0.0000103
	speed: 0.3104s/iter; left time: 9361.2883s
Epoch: 27 cost time: 145.9924635887146
Epoch: 27, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.127 Vali Acc: 0.974 Test Loss: 0.127 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.0000064
	speed: 0.7161s/iter; left time: 21519.4405s
	iters: 200, epoch: 28 | loss: 0.0000093
	speed: 0.3812s/iter; left time: 11417.1968s
	iters: 300, epoch: 28 | loss: 0.0000005
	speed: 0.3408s/iter; left time: 10173.0638s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.3481s/iter; left time: 10357.3253s
Epoch: 28 cost time: 148.4147608280182
Epoch: 28, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.982 Test Loss: 0.097 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.7705s/iter; left time: 22835.0427s
	iters: 200, epoch: 29 | loss: 0.0093944
	speed: 0.3456s/iter; left time: 10207.6281s
	iters: 300, epoch: 29 | loss: 0.0017576
	speed: 0.3713s/iter; left time: 10930.9109s
	iters: 400, epoch: 29 | loss: 0.0000015
	speed: 0.3878s/iter; left time: 11376.4798s
Epoch: 29 cost time: 151.10600423812866
Epoch: 29, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.982719 --> -0.982719).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0000003
	speed: 0.6468s/iter; left time: 18902.3848s
	iters: 200, epoch: 30 | loss: 0.0000170
	speed: 0.3072s/iter; left time: 8947.1972s
	iters: 300, epoch: 30 | loss: 0.0000002
	speed: 0.3170s/iter; left time: 9201.3570s
	iters: 400, epoch: 30 | loss: 0.0000096
	speed: 0.3244s/iter; left time: 9381.9948s
Epoch: 30 cost time: 129.67015480995178
Epoch: 30, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0000222
	speed: 0.6600s/iter; left time: 19015.7296s
	iters: 200, epoch: 31 | loss: 0.0000210
	speed: 0.3172s/iter; left time: 9107.0037s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.3150s/iter; left time: 9011.4020s
	iters: 400, epoch: 31 | loss: 0.0000009
	speed: 0.3432s/iter; left time: 9785.5087s
Epoch: 31 cost time: 133.87984013557434
Epoch: 31, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0287744
	speed: 0.6564s/iter; left time: 18641.1225s
	iters: 200, epoch: 32 | loss: 0.0000412
	speed: 0.3116s/iter; left time: 8817.3421s
	iters: 300, epoch: 32 | loss: 0.0000236
	speed: 0.3389s/iter; left time: 9556.7561s
	iters: 400, epoch: 32 | loss: 0.0017477
	speed: 0.3314s/iter; left time: 9313.0444s
Epoch: 32 cost time: 133.44275307655334
Epoch: 32, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.185 Vali Acc: 0.975 Test Loss: 0.185 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.0000573
	speed: 0.7766s/iter; left time: 21732.8620s
	iters: 200, epoch: 33 | loss: 0.0169710
	speed: 0.3716s/iter; left time: 10363.4513s
	iters: 300, epoch: 33 | loss: 0.0000263
	speed: 0.3691s/iter; left time: 10256.7237s
	iters: 400, epoch: 33 | loss: 0.0000005
	speed: 0.3660s/iter; left time: 10131.4426s
Epoch: 33 cost time: 152.1660144329071
Epoch: 33, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.086 Vali Acc: 0.982 Test Loss: 0.086 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.7922s/iter; left time: 21841.2703s
	iters: 200, epoch: 34 | loss: 0.0000903
	speed: 0.3605s/iter; left time: 9903.0004s
	iters: 300, epoch: 34 | loss: 0.0000001
	speed: 0.3494s/iter; left time: 9564.9783s
	iters: 400, epoch: 34 | loss: 0.0000173
	speed: 0.3595s/iter; left time: 9803.3658s
Epoch: 34 cost time: 148.611670255661
Epoch: 34, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.094 Vali Acc: 0.985 Test Loss: 0.094 Test Acc: 0.985
Validation loss decreased (-0.982719 --> -0.984992).  Saving model ...
	iters: 100, epoch: 35 | loss: 0.0000266
	speed: 0.7983s/iter; left time: 21680.2016s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.3804s/iter; left time: 10292.1089s
	iters: 300, epoch: 35 | loss: 0.0000013
	speed: 0.3885s/iter; left time: 10473.4243s
	iters: 400, epoch: 35 | loss: 0.0001453
	speed: 0.3420s/iter; left time: 9185.5318s
Epoch: 35 cost time: 153.10391211509705
Epoch: 35, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 0.0092406
	speed: 0.7275s/iter; left time: 19457.0545s
	iters: 200, epoch: 36 | loss: 0.0000064
	speed: 0.3695s/iter; left time: 9845.6647s
	iters: 300, epoch: 36 | loss: 0.0000001
	speed: 0.3702s/iter; left time: 9826.1020s
	iters: 400, epoch: 36 | loss: 0.0000002
	speed: 0.3772s/iter; left time: 9974.9860s
Epoch: 36 cost time: 152.35093903541565
Epoch: 36, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.144 Vali Acc: 0.976 Test Loss: 0.144 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.7382s/iter; left time: 19438.1625s
	iters: 200, epoch: 37 | loss: 0.4841929
	speed: 0.3709s/iter; left time: 9730.5271s
	iters: 300, epoch: 37 | loss: 0.0002660
	speed: 0.3676s/iter; left time: 9607.1254s
	iters: 400, epoch: 37 | loss: 0.0000006
	speed: 0.3768s/iter; left time: 9810.3135s
Epoch: 37 cost time: 151.54063987731934
Epoch: 37, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.162 Vali Acc: 0.974 Test Loss: 0.162 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 0.0000042
	speed: 0.7685s/iter; left time: 19919.7408s
	iters: 200, epoch: 38 | loss: 0.0000147
	speed: 0.3639s/iter; left time: 9394.7311s
	iters: 300, epoch: 38 | loss: 0.0000067
	speed: 0.3807s/iter; left time: 9791.2884s
	iters: 400, epoch: 38 | loss: 0.0000119
	speed: 0.3734s/iter; left time: 9567.4720s
Epoch: 38 cost time: 153.34000277519226
Epoch: 38, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.164 Vali Acc: 0.974 Test Loss: 0.164 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 39 | loss: 0.0000001
	speed: 0.8078s/iter; left time: 20605.2094s
	iters: 200, epoch: 39 | loss: 0.0000018
	speed: 0.3577s/iter; left time: 9086.9743s
	iters: 300, epoch: 39 | loss: 0.0000030
	speed: 0.3342s/iter; left time: 8457.7570s
	iters: 400, epoch: 39 | loss: 0.0000000
	speed: 0.3662s/iter; left time: 9230.9175s
Epoch: 39 cost time: 148.74390077590942
Epoch: 39, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.131 Vali Acc: 0.974 Test Loss: 0.131 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 40 | loss: 0.0000046
	speed: 0.7878s/iter; left time: 19768.8220s
	iters: 200, epoch: 40 | loss: 0.0000162
	speed: 0.3898s/iter; left time: 9742.5685s
	iters: 300, epoch: 40 | loss: 0.0001453
	speed: 0.3495s/iter; left time: 8699.9877s
	iters: 400, epoch: 40 | loss: 0.0000000
	speed: 0.3757s/iter; left time: 9316.1082s
Epoch: 40 cost time: 155.24881315231323
Epoch: 40, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.084 Vali Acc: 0.982 Test Loss: 0.084 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 41 | loss: 0.0000003
	speed: 0.7898s/iter; left time: 19492.3540s
	iters: 200, epoch: 41 | loss: 0.0000042
	speed: 0.3621s/iter; left time: 8900.4499s
	iters: 300, epoch: 41 | loss: 0.0039669
	speed: 0.3482s/iter; left time: 8523.2508s
	iters: 400, epoch: 41 | loss: 0.0450645
	speed: 0.3612s/iter; left time: 8805.5076s
Epoch: 41 cost time: 149.3793728351593
Epoch: 41, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 42 | loss: 0.0000011
	speed: 0.7846s/iter; left time: 19040.3490s
	iters: 200, epoch: 42 | loss: 0.0000188
	speed: 0.3841s/iter; left time: 9284.0355s
	iters: 300, epoch: 42 | loss: 0.0000000
	speed: 0.3800s/iter; left time: 9144.7396s
	iters: 400, epoch: 42 | loss: 0.0002092
	speed: 0.3706s/iter; left time: 8882.4012s
Epoch: 42 cost time: 156.28154516220093
Epoch: 42, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 43 | loss: 0.0044792
	speed: 0.7978s/iter; left time: 19031.3426s
	iters: 200, epoch: 43 | loss: 0.0000002
	speed: 0.3565s/iter; left time: 8469.2290s
	iters: 300, epoch: 43 | loss: 0.0000002
	speed: 0.3517s/iter; left time: 8319.7369s
	iters: 400, epoch: 43 | loss: 0.0000020
	speed: 0.3411s/iter; left time: 8034.7085s
Epoch: 43 cost time: 146.00808262825012
Epoch: 43, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.164 Vali Acc: 0.982 Test Loss: 0.164 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 44 | loss: 0.0000001
	speed: 0.7946s/iter; left time: 18627.3922s
	iters: 200, epoch: 44 | loss: 0.0000062
	speed: 0.3694s/iter; left time: 8622.0477s
	iters: 300, epoch: 44 | loss: 0.0000925
	speed: 0.3890s/iter; left time: 9041.9208s
	iters: 400, epoch: 44 | loss: 0.0000001
	speed: 0.3521s/iter; left time: 8147.8929s
Epoch: 44 cost time: 154.02891159057617
Epoch: 44, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.984993178717599
model parameter : 259722
model size : 3.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.1242871
	speed: 0.3644s/iter; left time: 15013.8814s
	iters: 200, epoch: 1 | loss: 0.8975698
	speed: 0.3281s/iter; left time: 13483.9788s
	iters: 300, epoch: 1 | loss: 0.2296667
	speed: 0.3395s/iter; left time: 13921.5501s
	iters: 400, epoch: 1 | loss: 0.1537006
	speed: 0.3412s/iter; left time: 13956.2196s
Epoch: 1 cost time: 142.14946842193604
Epoch: 1, Steps: 413 | Train Loss: 1.116 Vali Loss: 0.162 Vali Acc: 0.948 Test Loss: 0.162 Test Acc: 0.948
Validation loss decreased (inf --> -0.947702).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1224262
	speed: 0.7994s/iter; left time: 32604.8446s
	iters: 200, epoch: 2 | loss: 0.0794504
	speed: 0.3824s/iter; left time: 15557.8853s
	iters: 300, epoch: 2 | loss: 0.0572330
	speed: 0.3862s/iter; left time: 15676.7088s
	iters: 400, epoch: 2 | loss: 0.0320752
	speed: 0.3838s/iter; left time: 15540.3137s
Epoch: 2 cost time: 157.87470364570618
Epoch: 2, Steps: 413 | Train Loss: 0.121 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
Validation loss decreased (-0.947702 --> -0.970440).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0120985
	speed: 0.8211s/iter; left time: 33151.7999s
	iters: 200, epoch: 3 | loss: 0.0332272
	speed: 0.3738s/iter; left time: 15054.1578s
	iters: 300, epoch: 3 | loss: 0.0043437
	speed: 0.3759s/iter; left time: 15102.8701s
	iters: 400, epoch: 3 | loss: 0.0030324
	speed: 0.3583s/iter; left time: 14360.5805s
Epoch: 3 cost time: 155.07196283340454
Epoch: 3, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.073 Vali Acc: 0.971 Test Loss: 0.073 Test Acc: 0.971
Validation loss decreased (-0.970440 --> -0.970895).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0363394
	speed: 0.7824s/iter; left time: 31267.7117s
	iters: 200, epoch: 4 | loss: 0.0389796
	speed: 0.3385s/iter; left time: 13491.8061s
	iters: 300, epoch: 4 | loss: 0.0029145
	speed: 0.3432s/iter; left time: 13648.0323s
	iters: 400, epoch: 4 | loss: 0.0757696
	speed: 0.3133s/iter; left time: 12426.3524s
Epoch: 4 cost time: 140.5449616909027
Epoch: 4, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.075 Vali Acc: 0.972 Test Loss: 0.075 Test Acc: 0.972
Validation loss decreased (-0.970895 --> -0.972259).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0020700
	speed: 0.6332s/iter; left time: 25042.2390s
	iters: 200, epoch: 5 | loss: 0.0012645
	speed: 0.3558s/iter; left time: 14037.3536s
	iters: 300, epoch: 5 | loss: 0.0017673
	speed: 0.3546s/iter; left time: 13954.9985s
	iters: 400, epoch: 5 | loss: 0.0078492
	speed: 0.3637s/iter; left time: 14273.6526s
Epoch: 5 cost time: 143.96101212501526
Epoch: 5, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.972259 --> -0.979990).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0193357
	speed: 0.6967s/iter; left time: 27267.6729s
	iters: 200, epoch: 6 | loss: 0.0085170
	speed: 0.3272s/iter; left time: 12772.8706s
	iters: 300, epoch: 6 | loss: 0.0186050
	speed: 0.3304s/iter; left time: 12865.9581s
	iters: 400, epoch: 6 | loss: 0.0023256
	speed: 0.3349s/iter; left time: 13006.6573s
Epoch: 6 cost time: 136.1340639591217
Epoch: 6, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.065 Vali Acc: 0.979 Test Loss: 0.065 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0034394
	speed: 0.7891s/iter; left time: 30557.9706s
	iters: 200, epoch: 7 | loss: 0.0013418
	speed: 0.3301s/iter; left time: 12748.3174s
	iters: 300, epoch: 7 | loss: 0.0008997
	speed: 0.3418s/iter; left time: 13167.2494s
	iters: 400, epoch: 7 | loss: 0.0970520
	speed: 0.3479s/iter; left time: 13366.7858s
Epoch: 7 cost time: 144.28797245025635
Epoch: 7, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.056 Vali Acc: 0.980 Test Loss: 0.056 Test Acc: 0.980
Validation loss decreased (-0.979990 --> -0.980445).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0074867
	speed: 0.7850s/iter; left time: 30072.6110s
	iters: 200, epoch: 8 | loss: 0.0002541
	speed: 0.3171s/iter; left time: 12117.9669s
	iters: 300, epoch: 8 | loss: 0.0051333
	speed: 0.3252s/iter; left time: 12393.8534s
	iters: 400, epoch: 8 | loss: 0.0001720
	speed: 0.3233s/iter; left time: 12288.4908s
Epoch: 8 cost time: 138.89695405960083
Epoch: 8, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.076 Vali Acc: 0.972 Test Loss: 0.076 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0073539
	speed: 0.7645s/iter; left time: 28973.9494s
	iters: 200, epoch: 9 | loss: 0.0003994
	speed: 0.3510s/iter; left time: 13266.6366s
	iters: 300, epoch: 9 | loss: 0.0111292
	speed: 0.3456s/iter; left time: 13026.5304s
	iters: 400, epoch: 9 | loss: 0.0000663
	speed: 0.3268s/iter; left time: 12288.1421s
Epoch: 9 cost time: 142.07627630233765
Epoch: 9, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.065 Vali Acc: 0.979 Test Loss: 0.065 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000448
	speed: 0.6844s/iter; left time: 25655.6098s
	iters: 200, epoch: 10 | loss: 0.1878522
	speed: 0.3416s/iter; left time: 12771.4484s
	iters: 300, epoch: 10 | loss: 0.0000009
	speed: 0.3401s/iter; left time: 12678.4872s
	iters: 400, epoch: 10 | loss: 0.0067641
	speed: 0.3402s/iter; left time: 12649.7689s
Epoch: 10 cost time: 140.12787175178528
Epoch: 10, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0011962
	speed: 0.7164s/iter; left time: 26556.2497s
	iters: 200, epoch: 11 | loss: 0.0004898
	speed: 0.3669s/iter; left time: 13564.7106s
	iters: 300, epoch: 11 | loss: 0.0000375
	speed: 0.3572s/iter; left time: 13171.2720s
	iters: 400, epoch: 11 | loss: 0.2379403
	speed: 0.3623s/iter; left time: 13323.2988s
Epoch: 11 cost time: 146.95995688438416
Epoch: 11, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0001684
	speed: 0.7374s/iter; left time: 27030.9511s
	iters: 200, epoch: 12 | loss: 0.0184828
	speed: 0.3201s/iter; left time: 11701.5596s
	iters: 300, epoch: 12 | loss: 0.0018052
	speed: 0.3378s/iter; left time: 12315.4249s
	iters: 400, epoch: 12 | loss: 0.0001346
	speed: 0.3432s/iter; left time: 12476.9515s
Epoch: 12 cost time: 138.39853954315186
Epoch: 12, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.192 Vali Acc: 0.963 Test Loss: 0.192 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000218
	speed: 0.7829s/iter; left time: 28377.6913s
	iters: 200, epoch: 13 | loss: 0.0000161
	speed: 0.3439s/iter; left time: 12429.3871s
	iters: 300, epoch: 13 | loss: 0.0000244
	speed: 0.3352s/iter; left time: 12081.0918s
	iters: 400, epoch: 13 | loss: 0.0005161
	speed: 0.3424s/iter; left time: 12308.9408s
Epoch: 13 cost time: 142.4575605392456
Epoch: 13, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
Validation loss decreased (-0.980445 --> -0.980900).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0003520
	speed: 0.7581s/iter; left time: 27163.4339s
	iters: 200, epoch: 14 | loss: 0.0000923
	speed: 0.3325s/iter; left time: 11882.1451s
	iters: 300, epoch: 14 | loss: 0.1000615
	speed: 0.3376s/iter; left time: 12030.2689s
	iters: 400, epoch: 14 | loss: 0.0858059
	speed: 0.3628s/iter; left time: 12889.2365s
Epoch: 14 cost time: 144.42439818382263
Epoch: 14, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.058 Vali Acc: 0.985 Test Loss: 0.058 Test Acc: 0.985
Validation loss decreased (-0.980900 --> -0.984993).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000548
	speed: 0.7588s/iter; left time: 26876.8682s
	iters: 200, epoch: 15 | loss: 0.2360805
	speed: 0.3118s/iter; left time: 11010.8630s
	iters: 300, epoch: 15 | loss: 0.0000434
	speed: 0.3156s/iter; left time: 11114.8730s
	iters: 400, epoch: 15 | loss: 0.0000097
	speed: 0.3227s/iter; left time: 11333.9002s
Epoch: 15 cost time: 134.37618255615234
Epoch: 15, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0004780
	speed: 0.7427s/iter; left time: 25999.1830s
	iters: 200, epoch: 16 | loss: 0.0000919
	speed: 0.3769s/iter; left time: 13157.3317s
	iters: 300, epoch: 16 | loss: 0.0077116
	speed: 0.3782s/iter; left time: 13164.1776s
	iters: 400, epoch: 16 | loss: 0.0000014
	speed: 0.3288s/iter; left time: 11411.8711s
Epoch: 16 cost time: 149.1133315563202
Epoch: 16, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.162 Vali Acc: 0.970 Test Loss: 0.162 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0530164
	speed: 0.7578s/iter; left time: 26213.8308s
	iters: 200, epoch: 17 | loss: 0.0362822
	speed: 0.3574s/iter; left time: 12327.6525s
	iters: 300, epoch: 17 | loss: 0.0000021
	speed: 0.3546s/iter; left time: 12196.7977s
	iters: 400, epoch: 17 | loss: 0.0000006
	speed: 0.3755s/iter; left time: 12876.4568s
Epoch: 17 cost time: 149.07866144180298
Epoch: 17, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.147 Vali Acc: 0.969 Test Loss: 0.147 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0013400
	speed: 0.8121s/iter; left time: 27758.8440s
	iters: 200, epoch: 18 | loss: 0.0000055
	speed: 0.3533s/iter; left time: 12039.3052s
	iters: 300, epoch: 18 | loss: 0.0000012
	speed: 0.3657s/iter; left time: 12426.6629s
	iters: 400, epoch: 18 | loss: 0.0436489
	speed: 0.3646s/iter; left time: 12351.2516s
Epoch: 18 cost time: 150.9319179058075
Epoch: 18, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000252
	speed: 0.8207s/iter; left time: 27714.1402s
	iters: 200, epoch: 19 | loss: 0.0000635
	speed: 0.3568s/iter; left time: 12011.7745s
	iters: 300, epoch: 19 | loss: 0.0000007
	speed: 0.3352s/iter; left time: 11253.2840s
	iters: 400, epoch: 19 | loss: 0.0001633
	speed: 0.3344s/iter; left time: 11189.8743s
Epoch: 19 cost time: 146.929461479187
Epoch: 19, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000014
	speed: 0.8089s/iter; left time: 26981.0599s
	iters: 200, epoch: 20 | loss: 0.0000198
	speed: 0.3854s/iter; left time: 12815.8938s
	iters: 300, epoch: 20 | loss: 0.0000055
	speed: 0.3733s/iter; left time: 12377.1714s
	iters: 400, epoch: 20 | loss: 0.0023651
	speed: 0.3353s/iter; left time: 11081.4791s
Epoch: 20 cost time: 151.95118951797485
Epoch: 20, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.056 Vali Acc: 0.986 Test Loss: 0.056 Test Acc: 0.986
Validation loss decreased (-0.984993 --> -0.985902).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0001172
	speed: 0.7967s/iter; left time: 26243.7676s
	iters: 200, epoch: 21 | loss: 0.0002717
	speed: 0.3535s/iter; left time: 11610.6348s
	iters: 300, epoch: 21 | loss: 0.0000033
	speed: 0.3550s/iter; left time: 11623.6125s
	iters: 400, epoch: 21 | loss: 0.0127425
	speed: 0.3668s/iter; left time: 11974.3069s
Epoch: 21 cost time: 151.53799724578857
Epoch: 21, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000005
	speed: 0.7546s/iter; left time: 24546.1515s
	iters: 200, epoch: 22 | loss: 0.0014118
	speed: 0.3420s/iter; left time: 11089.7111s
	iters: 300, epoch: 22 | loss: 0.0010283
	speed: 0.3802s/iter; left time: 12289.5003s
	iters: 400, epoch: 22 | loss: 0.0049308
	speed: 0.3733s/iter; left time: 12029.8971s
Epoch: 22 cost time: 150.88093400001526
Epoch: 22, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0004112
	speed: 0.7653s/iter; left time: 24577.8866s
	iters: 200, epoch: 23 | loss: 0.0005642
	speed: 0.3516s/iter; left time: 11255.3914s
	iters: 300, epoch: 23 | loss: 0.0260925
	speed: 0.3594s/iter; left time: 11470.3622s
	iters: 400, epoch: 23 | loss: 0.0008094
	speed: 0.3671s/iter; left time: 11680.8081s
Epoch: 23 cost time: 149.09798789024353
Epoch: 23, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.088 Vali Acc: 0.984 Test Loss: 0.088 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0107530
	speed: 0.7198s/iter; left time: 22818.8079s
	iters: 200, epoch: 24 | loss: 0.0000030
	speed: 0.3082s/iter; left time: 9739.6946s
	iters: 300, epoch: 24 | loss: 0.0043328
	speed: 0.3410s/iter; left time: 10741.9656s
	iters: 400, epoch: 24 | loss: 0.0000003
	speed: 0.3702s/iter; left time: 11626.5827s
Epoch: 24 cost time: 140.05430603027344
Epoch: 24, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.979 Test Loss: 0.093 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000033
	speed: 0.7925s/iter; left time: 24796.2328s
	iters: 200, epoch: 25 | loss: 0.0000062
	speed: 0.3652s/iter; left time: 11390.4797s
	iters: 300, epoch: 25 | loss: 0.0072807
	speed: 0.3471s/iter; left time: 10791.6114s
	iters: 400, epoch: 25 | loss: 0.3034563
	speed: 0.3436s/iter; left time: 10648.5446s
Epoch: 25 cost time: 147.88928890228271
Epoch: 25, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.196 Vali Acc: 0.966 Test Loss: 0.196 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.3867311
	speed: 0.7705s/iter; left time: 23788.8895s
	iters: 200, epoch: 26 | loss: 0.0000258
	speed: 0.3473s/iter; left time: 10688.7898s
	iters: 300, epoch: 26 | loss: 0.0009244
	speed: 0.3526s/iter; left time: 10815.2390s
	iters: 400, epoch: 26 | loss: 0.0000072
	speed: 0.3800s/iter; left time: 11617.6062s
Epoch: 26 cost time: 149.95700764656067
Epoch: 26, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0000007
	speed: 0.8059s/iter; left time: 24549.9163s
	iters: 200, epoch: 27 | loss: 0.3355677
	speed: 0.3528s/iter; left time: 10712.9088s
	iters: 300, epoch: 27 | loss: 0.0000001
	speed: 0.3555s/iter; left time: 10759.8295s
	iters: 400, epoch: 27 | loss: 0.0000019
	speed: 0.3511s/iter; left time: 10588.9176s
Epoch: 27 cost time: 146.89287328720093
Epoch: 27, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0000105
	speed: 0.7969s/iter; left time: 23947.0997s
	iters: 200, epoch: 28 | loss: 0.0000009
	speed: 0.3751s/iter; left time: 11235.3034s
	iters: 300, epoch: 28 | loss: 0.0000127
	speed: 0.3462s/iter; left time: 10334.6997s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.3476s/iter; left time: 10342.0421s
Epoch: 28 cost time: 150.17838335037231
Epoch: 28, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0000514
	speed: 0.7293s/iter; left time: 21613.1279s
	iters: 200, epoch: 29 | loss: 0.0000032
	speed: 0.3794s/iter; left time: 11205.1491s
	iters: 300, epoch: 29 | loss: 0.0004159
	speed: 0.3759s/iter; left time: 11065.0630s
	iters: 400, epoch: 29 | loss: 0.0000029
	speed: 0.3850s/iter; left time: 11293.5694s
Epoch: 29 cost time: 153.97822332382202
Epoch: 29, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.107 Vali Acc: 0.979 Test Loss: 0.107 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0000001
	speed: 0.7877s/iter; left time: 23020.8665s
	iters: 200, epoch: 30 | loss: 0.0032616
	speed: 0.3523s/iter; left time: 10261.5127s
	iters: 300, epoch: 30 | loss: 0.0000567
	speed: 0.3521s/iter; left time: 10219.8569s
	iters: 400, epoch: 30 | loss: 0.0010206
	speed: 0.3633s/iter; left time: 10508.6951s
Epoch: 30 cost time: 148.29446363449097
Epoch: 30, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.178 Vali Acc: 0.971 Test Loss: 0.178 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9859026830377444
model parameter : 259722
model size : 3.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.3029237
	speed: 0.4075s/iter; left time: 16788.4946s
	iters: 200, epoch: 1 | loss: 2.3036854
	speed: 0.3631s/iter; left time: 14924.0149s
	iters: 300, epoch: 1 | loss: 2.3020067
	speed: 0.3480s/iter; left time: 14268.8890s
	iters: 400, epoch: 1 | loss: 2.3027282
	speed: 0.3574s/iter; left time: 14617.1297s
Epoch: 1 cost time: 152.63232445716858
Epoch: 1, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (inf --> -0.100022).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3015232
	speed: 0.8144s/iter; left time: 33218.4228s
	iters: 200, epoch: 2 | loss: 2.3026307
	speed: 0.3832s/iter; left time: 15592.6225s
	iters: 300, epoch: 2 | loss: 2.3022990
	speed: 0.3740s/iter; left time: 15179.7245s
	iters: 400, epoch: 2 | loss: 2.3020384
	speed: 0.3455s/iter; left time: 13987.5733s
Epoch: 2 cost time: 154.67507123947144
Epoch: 2, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3005333
	speed: 0.7488s/iter; left time: 30231.8794s
	iters: 200, epoch: 3 | loss: 2.3038509
	speed: 0.4043s/iter; left time: 16284.9101s
	iters: 300, epoch: 3 | loss: 2.3003461
	speed: 0.3967s/iter; left time: 15938.1620s
	iters: 400, epoch: 3 | loss: 2.3027439
	speed: 0.3695s/iter; left time: 14806.3413s
Epoch: 3 cost time: 160.7396960258484
Epoch: 3, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.3005321
	speed: 0.7299s/iter; left time: 29167.8074s
	iters: 200, epoch: 4 | loss: 2.3015969
	speed: 0.3357s/iter; left time: 13382.3156s
	iters: 300, epoch: 4 | loss: 2.3031166
	speed: 0.3736s/iter; left time: 14853.8142s
	iters: 400, epoch: 4 | loss: 2.3034768
	speed: 0.3297s/iter; left time: 13075.7636s
Epoch: 4 cost time: 144.23522400856018
Epoch: 4, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.3040402
	speed: 0.7434s/iter; left time: 29400.6064s
	iters: 200, epoch: 5 | loss: 2.3051047
	speed: 0.3703s/iter; left time: 14609.4541s
	iters: 300, epoch: 5 | loss: 2.3020532
	speed: 0.3880s/iter; left time: 15265.7192s
	iters: 400, epoch: 5 | loss: 2.3033862
	speed: 0.3885s/iter; left time: 15248.0910s
Epoch: 5 cost time: 155.4907259941101
Epoch: 5, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.3032079
	speed: 0.7459s/iter; left time: 29190.2265s
	iters: 200, epoch: 6 | loss: 2.3014534
	speed: 0.3501s/iter; left time: 13667.5819s
	iters: 300, epoch: 6 | loss: 2.3046227
	speed: 0.3655s/iter; left time: 14229.5512s
	iters: 400, epoch: 6 | loss: 2.3031807
	speed: 0.3844s/iter; left time: 14927.6766s
Epoch: 6 cost time: 150.39025688171387
Epoch: 6, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 2.3009627
	speed: 0.7990s/iter; left time: 30938.4931s
	iters: 200, epoch: 7 | loss: 2.3004096
	speed: 0.3827s/iter; left time: 14780.5032s
	iters: 300, epoch: 7 | loss: 2.3056285
	speed: 0.3840s/iter; left time: 14793.9755s
	iters: 400, epoch: 7 | loss: 2.3048532
	speed: 0.3625s/iter; left time: 13927.2705s
Epoch: 7 cost time: 156.5900685787201
Epoch: 7, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 2.3028629
	speed: 0.7687s/iter; left time: 29448.7589s
	iters: 200, epoch: 8 | loss: 2.2973833
	speed: 0.4274s/iter; left time: 16331.7958s
	iters: 300, epoch: 8 | loss: 2.3034499
	speed: 0.3794s/iter; left time: 14458.9792s
	iters: 400, epoch: 8 | loss: 2.3049045
	speed: 0.3641s/iter; left time: 13838.4624s
Epoch: 8 cost time: 159.1673939228058
Epoch: 8, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 2.3034804
	speed: 0.7627s/iter; left time: 28903.6236s
	iters: 200, epoch: 9 | loss: 2.3036849
	speed: 0.3619s/iter; left time: 13677.8827s
	iters: 300, epoch: 9 | loss: 2.3001077
	speed: 0.3981s/iter; left time: 15005.9161s
	iters: 400, epoch: 9 | loss: 2.3028209
	speed: 0.3722s/iter; left time: 13994.8358s
Epoch: 9 cost time: 155.11531496047974
Epoch: 9, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 2.3053157
	speed: 0.7691s/iter; left time: 28828.0975s
	iters: 200, epoch: 10 | loss: 2.3040662
	speed: 0.3629s/iter; left time: 13566.6836s
	iters: 300, epoch: 10 | loss: 2.3036082
	speed: 0.3817s/iter; left time: 14232.3292s
	iters: 400, epoch: 10 | loss: 2.3021588
	speed: 0.4016s/iter; left time: 14934.9041s
Epoch: 10 cost time: 154.91582489013672
Epoch: 10, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 2.3005776
	speed: 0.7653s/iter; left time: 28369.3569s
	iters: 200, epoch: 11 | loss: 2.3013656
	speed: 0.3342s/iter; left time: 12357.5418s
	iters: 300, epoch: 11 | loss: 2.3057127
	speed: 0.3343s/iter; left time: 12324.7671s
	iters: 400, epoch: 11 | loss: 2.3021395
	speed: 0.3537s/iter; left time: 13005.7713s
Epoch: 11 cost time: 143.7600531578064
Epoch: 11, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 2.3036003
	speed: 0.7820s/iter; left time: 28665.8103s
	iters: 200, epoch: 12 | loss: 2.3006928
	speed: 0.3844s/iter; left time: 14052.5898s
	iters: 300, epoch: 12 | loss: 2.3040812
	speed: 0.3472s/iter; left time: 12659.4151s
	iters: 400, epoch: 12 | loss: 2.3053610
	speed: 0.3367s/iter; left time: 12240.6905s
Epoch: 12 cost time: 149.62568259239197
Epoch: 12, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 2.3020251
	speed: 0.7346s/iter; left time: 26625.4662s
	iters: 200, epoch: 13 | loss: 2.3041313
	speed: 0.3684s/iter; left time: 13317.3534s
	iters: 300, epoch: 13 | loss: 2.3023813
	speed: 0.3659s/iter; left time: 13190.4790s
	iters: 400, epoch: 13 | loss: 2.3029106
	speed: 0.3549s/iter; left time: 12757.4949s
Epoch: 13 cost time: 149.52968978881836
Epoch: 13, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 2.3040037
	speed: 0.7626s/iter; left time: 27325.4549s
	iters: 200, epoch: 14 | loss: 2.2997866
	speed: 0.3612s/iter; left time: 12905.9233s
	iters: 300, epoch: 14 | loss: 2.3052225
	speed: 0.3802s/iter; left time: 13546.7852s
	iters: 400, epoch: 14 | loss: 2.3028066
	speed: 0.3717s/iter; left time: 13206.2768s
Epoch: 14 cost time: 152.84880423545837
Epoch: 14, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm64_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.10004547521600728
model parameter : 259722
model size : 3.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         47                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8729008
	speed: 0.3779s/iter; left time: 15570.8785s
	iters: 200, epoch: 1 | loss: 0.3319421
	speed: 0.3765s/iter; left time: 15473.2417s
	iters: 300, epoch: 1 | loss: 0.4984467
	speed: 0.3254s/iter; left time: 13340.0088s
	iters: 400, epoch: 1 | loss: 0.2190996
	speed: 0.3403s/iter; left time: 13917.5942s
Epoch: 1 cost time: 146.64400029182434
Epoch: 1, Steps: 413 | Train Loss: 0.755 Vali Loss: 0.146 Vali Acc: 0.965 Test Loss: 0.146 Test Acc: 0.965
Validation loss decreased (inf --> -0.965437).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3335148
	speed: 0.7549s/iter; left time: 30790.1432s
	iters: 200, epoch: 2 | loss: 0.1050158
	speed: 0.3462s/iter; left time: 14087.5611s
	iters: 300, epoch: 2 | loss: 0.1083963
	speed: 0.3793s/iter; left time: 15394.4598s
	iters: 400, epoch: 2 | loss: 0.0973198
	speed: 0.3754s/iter; left time: 15198.9272s
Epoch: 2 cost time: 150.83649706840515
Epoch: 2, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.060 Vali Acc: 0.982 Test Loss: 0.060 Test Acc: 0.982
Validation loss decreased (-0.965437 --> -0.982264).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0060811
	speed: 0.7328s/iter; left time: 29586.1965s
	iters: 200, epoch: 3 | loss: 0.0296972
	speed: 0.3421s/iter; left time: 13778.9697s
	iters: 300, epoch: 3 | loss: 0.0730341
	speed: 0.3426s/iter; left time: 13763.9785s
	iters: 400, epoch: 3 | loss: 0.0417777
	speed: 0.3489s/iter; left time: 13983.9496s
Epoch: 3 cost time: 142.0953335762024
Epoch: 3, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.049 Vali Acc: 0.982 Test Loss: 0.049 Test Acc: 0.982
Validation loss decreased (-0.982264 --> -0.982264).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0222223
	speed: 0.6419s/iter; left time: 25653.4046s
	iters: 200, epoch: 4 | loss: 0.0043859
	speed: 0.3086s/iter; left time: 12301.4074s
	iters: 300, epoch: 4 | loss: 0.0075582
	speed: 0.3379s/iter; left time: 13434.9960s
	iters: 400, epoch: 4 | loss: 0.0204953
	speed: 0.3160s/iter; left time: 12532.8933s
Epoch: 4 cost time: 129.4596905708313
Epoch: 4, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.042 Vali Acc: 0.986 Test Loss: 0.042 Test Acc: 0.986
Validation loss decreased (-0.982264 --> -0.985902).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0349222
	speed: 0.7378s/iter; left time: 29178.5461s
	iters: 200, epoch: 5 | loss: 0.0221862
	speed: 0.3437s/iter; left time: 13556.9685s
	iters: 300, epoch: 5 | loss: 0.0056044
	speed: 0.3541s/iter; left time: 13933.1030s
	iters: 400, epoch: 5 | loss: 0.0083006
	speed: 0.3552s/iter; left time: 13943.1982s
Epoch: 5 cost time: 145.6884000301361
Epoch: 5, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.043 Vali Acc: 0.988 Test Loss: 0.043 Test Acc: 0.988
Validation loss decreased (-0.985902 --> -0.987721).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0008178
	speed: 0.7188s/iter; left time: 28129.3698s
	iters: 200, epoch: 6 | loss: 0.0017966
	speed: 0.3156s/iter; left time: 12319.6213s
	iters: 300, epoch: 6 | loss: 0.0205699
	speed: 0.2965s/iter; left time: 11546.0353s
	iters: 400, epoch: 6 | loss: 0.0008195
	speed: 0.3218s/iter; left time: 12495.7996s
Epoch: 6 cost time: 131.28272891044617
Epoch: 6, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.045 Vali Acc: 0.985 Test Loss: 0.045 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0028800
	speed: 0.7410s/iter; left time: 28694.7485s
	iters: 200, epoch: 7 | loss: 0.0009384
	speed: 0.3296s/iter; left time: 12729.0841s
	iters: 300, epoch: 7 | loss: 0.0007995
	speed: 0.3419s/iter; left time: 13170.1194s
	iters: 400, epoch: 7 | loss: 0.0067783
	speed: 0.3497s/iter; left time: 13435.7532s
Epoch: 7 cost time: 143.82398676872253
Epoch: 7, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.041 Vali Acc: 0.985 Test Loss: 0.041 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0050170
	speed: 0.7917s/iter; left time: 30328.8058s
	iters: 200, epoch: 8 | loss: 0.0003844
	speed: 0.3437s/iter; left time: 13132.8098s
	iters: 300, epoch: 8 | loss: 0.0234407
	speed: 0.3602s/iter; left time: 13728.3372s
	iters: 400, epoch: 8 | loss: 0.0000553
	speed: 0.3731s/iter; left time: 14183.3845s
Epoch: 8 cost time: 149.53689813613892
Epoch: 8, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.042 Vali Acc: 0.985 Test Loss: 0.042 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0027459
	speed: 0.7223s/iter; left time: 27374.4217s
	iters: 200, epoch: 9 | loss: 0.0159695
	speed: 0.3376s/iter; left time: 12760.3221s
	iters: 300, epoch: 9 | loss: 0.0035744
	speed: 0.3414s/iter; left time: 12869.0904s
	iters: 400, epoch: 9 | loss: 0.0051786
	speed: 0.3345s/iter; left time: 12577.4942s
Epoch: 9 cost time: 138.79219317436218
Epoch: 9, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.050 Vali Acc: 0.984 Test Loss: 0.050 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0045964
	speed: 0.7278s/iter; left time: 27279.5488s
	iters: 200, epoch: 10 | loss: 0.0008379
	speed: 0.3666s/iter; left time: 13704.9780s
	iters: 300, epoch: 10 | loss: 0.0144846
	speed: 0.3706s/iter; left time: 13816.6852s
	iters: 400, epoch: 10 | loss: 0.1017824
	speed: 0.3439s/iter; left time: 12789.4285s
Epoch: 10 cost time: 148.2477216720581
Epoch: 10, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0212529
	speed: 0.7211s/iter; left time: 26732.9129s
	iters: 200, epoch: 11 | loss: 0.0073678
	speed: 0.3306s/iter; left time: 12222.4339s
	iters: 300, epoch: 11 | loss: 0.0001149
	speed: 0.3446s/iter; left time: 12706.8171s
	iters: 400, epoch: 11 | loss: 0.0106119
	speed: 0.3220s/iter; left time: 11842.0207s
Epoch: 11 cost time: 138.30787444114685
Epoch: 11, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0001879
	speed: 0.7276s/iter; left time: 26673.5376s
	iters: 200, epoch: 12 | loss: 0.0004921
	speed: 0.3392s/iter; left time: 12400.2772s
	iters: 300, epoch: 12 | loss: 0.0000499
	speed: 0.3431s/iter; left time: 12509.7825s
	iters: 400, epoch: 12 | loss: 0.0003127
	speed: 0.3416s/iter; left time: 12420.7455s
Epoch: 12 cost time: 142.9885880947113
Epoch: 12, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.056 Vali Acc: 0.985 Test Loss: 0.056 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0003696
	speed: 0.7625s/iter; left time: 27637.0117s
	iters: 200, epoch: 13 | loss: 0.0011569
	speed: 0.3799s/iter; left time: 13733.2380s
	iters: 300, epoch: 13 | loss: 0.0006911
	speed: 0.3462s/iter; left time: 12480.5120s
	iters: 400, epoch: 13 | loss: 0.0012881
	speed: 0.3440s/iter; left time: 12366.0446s
Epoch: 13 cost time: 149.00544357299805
Epoch: 13, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.060 Vali Acc: 0.984 Test Loss: 0.060 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0045986
	speed: 0.7552s/iter; left time: 27058.7845s
	iters: 200, epoch: 14 | loss: 0.0005080
	speed: 0.3775s/iter; left time: 13487.5224s
	iters: 300, epoch: 14 | loss: 0.0002428
	speed: 0.3937s/iter; left time: 14026.8168s
	iters: 400, epoch: 14 | loss: 0.0007897
	speed: 0.3656s/iter; left time: 12990.4881s
Epoch: 14 cost time: 155.65032291412354
Epoch: 14, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0000096
	speed: 0.7503s/iter; left time: 26575.6839s
	iters: 200, epoch: 15 | loss: 0.0001375
	speed: 0.3539s/iter; left time: 12500.0990s
	iters: 300, epoch: 15 | loss: 0.0009847
	speed: 0.3437s/iter; left time: 12103.3007s
	iters: 400, epoch: 15 | loss: 0.0001717
	speed: 0.3551s/iter; left time: 12469.2308s
Epoch: 15 cost time: 145.71758913993835
Epoch: 15, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.052 Vali Acc: 0.986 Test Loss: 0.052 Test Acc: 0.986
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9877216916780355
model parameter : 462154
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         38                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.9637852
	speed: 0.3880s/iter; left time: 15986.5343s
	iters: 200, epoch: 1 | loss: 0.4230238
	speed: 0.3840s/iter; left time: 15782.3425s
	iters: 300, epoch: 1 | loss: 0.5891573
	speed: 0.3689s/iter; left time: 15126.7979s
	iters: 400, epoch: 1 | loss: 0.3347338
	speed: 0.3719s/iter; left time: 15210.7450s
Epoch: 1 cost time: 156.6233274936676
Epoch: 1, Steps: 413 | Train Loss: 0.822 Vali Loss: 0.156 Vali Acc: 0.968 Test Loss: 0.156 Test Acc: 0.968
Validation loss decreased (inf --> -0.967711).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3571116
	speed: 0.7423s/iter; left time: 30278.4279s
	iters: 200, epoch: 2 | loss: 0.1297845
	speed: 0.3458s/iter; left time: 14071.5145s
	iters: 300, epoch: 2 | loss: 0.1553278
	speed: 0.3517s/iter; left time: 14275.4690s
	iters: 400, epoch: 2 | loss: 0.0681034
	speed: 0.3626s/iter; left time: 14682.3231s
Epoch: 2 cost time: 146.09654092788696
Epoch: 2, Steps: 413 | Train Loss: 0.146 Vali Loss: 0.065 Vali Acc: 0.979 Test Loss: 0.065 Test Acc: 0.979
Validation loss decreased (-0.967711 --> -0.978626).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0074185
	speed: 0.7332s/iter; left time: 29604.1273s
	iters: 200, epoch: 3 | loss: 0.0480366
	speed: 0.3315s/iter; left time: 13350.8368s
	iters: 300, epoch: 3 | loss: 0.1295937
	speed: 0.3663s/iter; left time: 14715.1917s
	iters: 400, epoch: 3 | loss: 0.0438693
	speed: 0.3639s/iter; left time: 14583.2812s
Epoch: 3 cost time: 144.87232160568237
Epoch: 3, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.057 Vali Acc: 0.983 Test Loss: 0.057 Test Acc: 0.983
Validation loss decreased (-0.978626 --> -0.982719).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0350275
	speed: 0.7613s/iter; left time: 30421.2652s
	iters: 200, epoch: 4 | loss: 0.0151990
	speed: 0.3736s/iter; left time: 14892.2577s
	iters: 300, epoch: 4 | loss: 0.0075687
	speed: 0.3668s/iter; left time: 14584.7614s
	iters: 400, epoch: 4 | loss: 0.0393172
	speed: 0.3674s/iter; left time: 14573.2760s
Epoch: 4 cost time: 152.9551718235016
Epoch: 4, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.041 Vali Acc: 0.989 Test Loss: 0.041 Test Acc: 0.989
Validation loss decreased (-0.982719 --> -0.988631).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0191122
	speed: 0.8184s/iter; left time: 32366.2405s
	iters: 200, epoch: 5 | loss: 0.0636102
	speed: 0.3694s/iter; left time: 14572.8945s
	iters: 300, epoch: 5 | loss: 0.0086571
	speed: 0.3561s/iter; left time: 14013.1801s
	iters: 400, epoch: 5 | loss: 0.0051553
	speed: 0.3859s/iter; left time: 15146.1195s
Epoch: 5 cost time: 156.7144079208374
Epoch: 5, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.042 Vali Acc: 0.985 Test Loss: 0.042 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0018644
	speed: 0.8625s/iter; left time: 33754.5485s
	iters: 200, epoch: 6 | loss: 0.0025713
	speed: 0.3651s/iter; left time: 14252.6872s
	iters: 300, epoch: 6 | loss: 0.0447812
	speed: 0.3476s/iter; left time: 13532.9665s
	iters: 400, epoch: 6 | loss: 0.1522248
	speed: 0.3289s/iter; left time: 12774.8251s
Epoch: 6 cost time: 149.41486239433289
Epoch: 6, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.048 Vali Acc: 0.986 Test Loss: 0.048 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0019938
	speed: 0.6977s/iter; left time: 27015.8045s
	iters: 200, epoch: 7 | loss: 0.0007751
	speed: 0.3669s/iter; left time: 14170.0059s
	iters: 300, epoch: 7 | loss: 0.0260271
	speed: 0.3539s/iter; left time: 13633.0562s
	iters: 400, epoch: 7 | loss: 0.0036483
	speed: 0.3648s/iter; left time: 14018.2456s
Epoch: 7 cost time: 148.45449829101562
Epoch: 7, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.057 Vali Acc: 0.984 Test Loss: 0.057 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0441896
	speed: 0.7377s/iter; left time: 28260.8429s
	iters: 200, epoch: 8 | loss: 0.0100901
	speed: 0.3743s/iter; left time: 14303.6056s
	iters: 300, epoch: 8 | loss: 0.0070916
	speed: 0.3733s/iter; left time: 14226.3382s
	iters: 400, epoch: 8 | loss: 0.0017144
	speed: 0.3535s/iter; left time: 13435.9127s
Epoch: 8 cost time: 152.57938599586487
Epoch: 8, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.052 Vali Acc: 0.982 Test Loss: 0.052 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0066382
	speed: 0.7884s/iter; left time: 29876.5395s
	iters: 200, epoch: 9 | loss: 0.0194513
	speed: 0.3673s/iter; left time: 13881.4051s
	iters: 300, epoch: 9 | loss: 0.0007177
	speed: 0.3841s/iter; left time: 14480.5115s
	iters: 400, epoch: 9 | loss: 0.0057998
	speed: 0.3733s/iter; left time: 14035.5751s
Epoch: 9 cost time: 154.46364068984985
Epoch: 9, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0017223
	speed: 0.8003s/iter; left time: 29997.6210s
	iters: 200, epoch: 10 | loss: 0.0003050
	speed: 0.3721s/iter; left time: 13909.4717s
	iters: 300, epoch: 10 | loss: 0.0061735
	speed: 0.3500s/iter; left time: 13048.0108s
	iters: 400, epoch: 10 | loss: 0.0046948
	speed: 0.3622s/iter; left time: 13468.9848s
Epoch: 10 cost time: 151.29593586921692
Epoch: 10, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.067 Vali Acc: 0.981 Test Loss: 0.067 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0008815
	speed: 0.8177s/iter; left time: 30312.7055s
	iters: 200, epoch: 11 | loss: 0.0032006
	speed: 0.3587s/iter; left time: 13260.7489s
	iters: 300, epoch: 11 | loss: 0.0002174
	speed: 0.3374s/iter; left time: 12440.7665s
	iters: 400, epoch: 11 | loss: 0.0054834
	speed: 0.3565s/iter; left time: 13107.1302s
Epoch: 11 cost time: 151.3572337627411
Epoch: 11, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0123651
	speed: 0.7741s/iter; left time: 28376.5365s
	iters: 200, epoch: 12 | loss: 0.0008547
	speed: 0.3568s/iter; left time: 13042.7004s
	iters: 300, epoch: 12 | loss: 0.0001612
	speed: 0.3692s/iter; left time: 13459.0940s
	iters: 400, epoch: 12 | loss: 0.0000558
	speed: 0.3820s/iter; left time: 13890.4172s
Epoch: 12 cost time: 153.730211019516
Epoch: 12, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.074 Vali Acc: 0.979 Test Loss: 0.074 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0007467
	speed: 0.7342s/iter; left time: 26611.5445s
	iters: 200, epoch: 13 | loss: 0.0013155
	speed: 0.3490s/iter; left time: 12613.4161s
	iters: 300, epoch: 13 | loss: 0.0163882
	speed: 0.3651s/iter; left time: 13160.1768s
	iters: 400, epoch: 13 | loss: 0.0000293
	speed: 0.3602s/iter; left time: 12948.1716s
Epoch: 13 cost time: 146.62164735794067
Epoch: 13, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0016835
	speed: 0.7426s/iter; left time: 26610.1707s
	iters: 200, epoch: 14 | loss: 0.0002633
	speed: 0.3904s/iter; left time: 13950.6406s
	iters: 300, epoch: 14 | loss: 0.0062489
	speed: 0.3926s/iter; left time: 13989.6181s
	iters: 400, epoch: 14 | loss: 0.2556890
	speed: 0.3437s/iter; left time: 12213.0279s
Epoch: 14 cost time: 154.21109294891357
Epoch: 14, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.063 Vali Acc: 0.984 Test Loss: 0.063 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.988631195998181
model parameter : 462154
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         28                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1931915
	speed: 0.3936s/iter; left time: 16218.5870s
	iters: 200, epoch: 1 | loss: 0.6469314
	speed: 0.3414s/iter; left time: 14032.3550s
	iters: 300, epoch: 1 | loss: 0.9213794
	speed: 0.3588s/iter; left time: 14711.8558s
	iters: 400, epoch: 1 | loss: 0.3019347
	speed: 0.3540s/iter; left time: 14477.4022s
Epoch: 1 cost time: 150.34815216064453
Epoch: 1, Steps: 413 | Train Loss: 0.941 Vali Loss: 0.199 Vali Acc: 0.961 Test Loss: 0.199 Test Acc: 0.961
Validation loss decreased (inf --> -0.960889).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4156465
	speed: 0.7861s/iter; left time: 32064.4428s
	iters: 200, epoch: 2 | loss: 0.1710380
	speed: 0.3744s/iter; left time: 15233.6248s
	iters: 300, epoch: 2 | loss: 0.1907647
	speed: 0.3550s/iter; left time: 14408.9638s
	iters: 400, epoch: 2 | loss: 0.0765778
	speed: 0.3576s/iter; left time: 14479.6534s
Epoch: 2 cost time: 151.17450141906738
Epoch: 2, Steps: 413 | Train Loss: 0.170 Vali Loss: 0.084 Vali Acc: 0.975 Test Loss: 0.084 Test Acc: 0.975
Validation loss decreased (-0.960889 --> -0.974533).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0112235
	speed: 0.7825s/iter; left time: 31592.1161s
	iters: 200, epoch: 3 | loss: 0.0372419
	speed: 0.3611s/iter; left time: 14543.6462s
	iters: 300, epoch: 3 | loss: 0.0644403
	speed: 0.3558s/iter; left time: 14293.1389s
	iters: 400, epoch: 3 | loss: 0.0854501
	speed: 0.3599s/iter; left time: 14421.7236s
Epoch: 3 cost time: 151.64262175559998
Epoch: 3, Steps: 413 | Train Loss: 0.065 Vali Loss: 0.057 Vali Acc: 0.982 Test Loss: 0.057 Test Acc: 0.982
Validation loss decreased (-0.974533 --> -0.982264).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0478220
	speed: 0.8016s/iter; left time: 32033.5505s
	iters: 200, epoch: 4 | loss: 0.1014238
	speed: 0.3742s/iter; left time: 14915.6131s
	iters: 300, epoch: 4 | loss: 0.0116060
	speed: 0.3619s/iter; left time: 14388.1606s
	iters: 400, epoch: 4 | loss: 0.1147621
	speed: 0.2924s/iter; left time: 11597.3678s
Epoch: 4 cost time: 145.7998640537262
Epoch: 4, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.060 Vali Acc: 0.977 Test Loss: 0.060 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0100708
	speed: 0.5365s/iter; left time: 21217.7895s
	iters: 200, epoch: 5 | loss: 0.0453605
	speed: 0.2610s/iter; left time: 10295.8594s
	iters: 300, epoch: 5 | loss: 0.0050508
	speed: 0.2270s/iter; left time: 8933.4620s
	iters: 400, epoch: 5 | loss: 0.0097720
	speed: 0.2092s/iter; left time: 8211.6166s
Epoch: 5 cost time: 99.2718186378479
Epoch: 5, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.049 Vali Acc: 0.984 Test Loss: 0.049 Test Acc: 0.984
Validation loss decreased (-0.982264 --> -0.983628).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0021480
	speed: 2.6573s/iter; left time: 103996.0454s
	iters: 200, epoch: 6 | loss: 0.0045265
	speed: 0.2232s/iter; left time: 8713.3350s
	iters: 300, epoch: 6 | loss: 0.0032628
	speed: 0.2318s/iter; left time: 9026.5303s
	iters: 400, epoch: 6 | loss: 0.0064181
	speed: 0.2237s/iter; left time: 8686.0803s
Epoch: 6 cost time: 95.6652901172638
Epoch: 6, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.039 Vali Acc: 0.987 Test Loss: 0.039 Test Acc: 0.987
Validation loss decreased (-0.983628 --> -0.986812).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0016829
	speed: 1.0183s/iter; left time: 39430.9907s
	iters: 200, epoch: 7 | loss: 0.0011811
	speed: 0.2433s/iter; left time: 9396.7927s
	iters: 300, epoch: 7 | loss: 0.0203662
	speed: 0.2202s/iter; left time: 8484.5408s
	iters: 400, epoch: 7 | loss: 0.0027962
	speed: 0.2048s/iter; left time: 7867.7894s
Epoch: 7 cost time: 95.29636883735657
Epoch: 7, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.043 Vali Acc: 0.984 Test Loss: 0.043 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0026006
	speed: 0.4253s/iter; left time: 16291.8385s
	iters: 200, epoch: 8 | loss: 0.0075207
	speed: 0.2281s/iter; left time: 8714.2120s
	iters: 300, epoch: 8 | loss: 0.0118090
	speed: 0.2561s/iter; left time: 9761.8482s
	iters: 400, epoch: 8 | loss: 0.0026702
	speed: 0.2735s/iter; left time: 10396.8272s
Epoch: 8 cost time: 101.25529408454895
Epoch: 8, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.035 Vali Acc: 0.989 Test Loss: 0.035 Test Acc: 0.989
Validation loss decreased (-0.986812 --> -0.989086).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0006802
	speed: 1.9289s/iter; left time: 73098.7362s
	iters: 200, epoch: 9 | loss: 0.0063335
	speed: 0.2475s/iter; left time: 9355.8011s
	iters: 300, epoch: 9 | loss: 0.0113426
	speed: 0.2649s/iter; left time: 9984.6351s
	iters: 400, epoch: 9 | loss: 0.0001210
	speed: 0.2519s/iter; left time: 9469.7232s
Epoch: 9 cost time: 108.11988925933838
Epoch: 9, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.054 Vali Acc: 0.987 Test Loss: 0.054 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0035413
	speed: 0.5379s/iter; left time: 20161.6175s
	iters: 200, epoch: 10 | loss: 0.0057195
	speed: 0.2803s/iter; left time: 10477.2610s
	iters: 300, epoch: 10 | loss: 0.0057623
	speed: 0.2512s/iter; left time: 9364.3219s
	iters: 400, epoch: 10 | loss: 0.0033433
	speed: 0.2444s/iter; left time: 9088.5045s
Epoch: 10 cost time: 108.49791646003723
Epoch: 10, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.039 Vali Acc: 0.988 Test Loss: 0.039 Test Acc: 0.988
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0001957
	speed: 0.4682s/iter; left time: 17356.6895s
	iters: 200, epoch: 11 | loss: 0.0009563
	speed: 0.2725s/iter; left time: 10073.0270s
	iters: 300, epoch: 11 | loss: 0.0012154
	speed: 0.2574s/iter; left time: 9491.2169s
	iters: 400, epoch: 11 | loss: 0.0266741
	speed: 0.2213s/iter; left time: 8136.8391s
Epoch: 11 cost time: 101.66689324378967
Epoch: 11, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.050 Vali Acc: 0.986 Test Loss: 0.050 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0007021
	speed: 0.4764s/iter; left time: 17462.6101s
	iters: 200, epoch: 12 | loss: 0.0002430
	speed: 0.2721s/iter; left time: 9946.7707s
	iters: 300, epoch: 12 | loss: 0.0004342
	speed: 0.2568s/iter; left time: 9360.9878s
	iters: 400, epoch: 12 | loss: 0.0291851
	speed: 0.2395s/iter; left time: 8709.5516s
Epoch: 12 cost time: 107.35715389251709
Epoch: 12, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.062 Vali Acc: 0.986 Test Loss: 0.062 Test Acc: 0.986
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0014817
	speed: 0.4620s/iter; left time: 16743.4212s
	iters: 200, epoch: 13 | loss: 0.0125609
	speed: 0.2609s/iter; left time: 9430.5873s
	iters: 300, epoch: 13 | loss: 0.0009187
	speed: 0.1981s/iter; left time: 7139.8927s
	iters: 400, epoch: 13 | loss: 0.0019928
	speed: 0.2139s/iter; left time: 7690.2680s
Epoch: 13 cost time: 95.10652089118958
Epoch: 13, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0181853
	speed: 0.4703s/iter; left time: 16853.2101s
	iters: 200, epoch: 14 | loss: 0.0008279
	speed: 0.2226s/iter; left time: 7954.3104s
	iters: 300, epoch: 14 | loss: 0.0010650
	speed: 0.2478s/iter; left time: 8830.3414s
	iters: 400, epoch: 14 | loss: 0.0016848
	speed: 0.2366s/iter; left time: 8405.8170s
Epoch: 14 cost time: 96.1479172706604
Epoch: 14, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.056 Vali Acc: 0.984 Test Loss: 0.056 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000190
	speed: 0.5182s/iter; left time: 18355.5725s
	iters: 200, epoch: 15 | loss: 0.0049172
	speed: 0.2579s/iter; left time: 9108.4498s
	iters: 300, epoch: 15 | loss: 0.0010411
	speed: 0.2362s/iter; left time: 8317.9670s
	iters: 400, epoch: 15 | loss: 0.0000580
	speed: 0.2401s/iter; left time: 8433.0685s
Epoch: 15 cost time: 102.55613732337952
Epoch: 15, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0007433
	speed: 0.4517s/iter; left time: 15811.9755s
	iters: 200, epoch: 16 | loss: 0.0034670
	speed: 0.2610s/iter; left time: 9112.0991s
	iters: 300, epoch: 16 | loss: 0.2705985
	speed: 0.2556s/iter; left time: 8895.0589s
	iters: 400, epoch: 16 | loss: 0.0322528
	speed: 0.2111s/iter; left time: 7327.6994s
Epoch: 16 cost time: 100.29552555084229
Epoch: 16, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.077 Vali Acc: 0.984 Test Loss: 0.077 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0005180
	speed: 0.4791s/iter; left time: 16573.9958s
	iters: 200, epoch: 17 | loss: 0.0094882
	speed: 0.2046s/iter; left time: 7057.0094s
	iters: 300, epoch: 17 | loss: 0.0023730
	speed: 0.2251s/iter; left time: 7743.0049s
	iters: 400, epoch: 17 | loss: 0.0000083
	speed: 0.2016s/iter; left time: 6913.7671s
Epoch: 17 cost time: 91.73407888412476
Epoch: 17, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0000139
	speed: 0.4644s/iter; left time: 15873.7271s
	iters: 200, epoch: 18 | loss: 0.0464321
	speed: 0.2039s/iter; left time: 6950.2543s
	iters: 300, epoch: 18 | loss: 0.0000578
	speed: 0.2105s/iter; left time: 7153.0623s
	iters: 400, epoch: 18 | loss: 0.0042774
	speed: 0.2102s/iter; left time: 7120.1753s
Epoch: 18 cost time: 88.22821831703186
Epoch: 18, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.056 Vali Acc: 0.985 Test Loss: 0.056 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9890859481582538
model parameter : 462154
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.4529717
	speed: 0.2337s/iter; left time: 9626.6598s
	iters: 200, epoch: 1 | loss: 0.8952895
	speed: 0.2236s/iter; left time: 9191.0742s
	iters: 300, epoch: 1 | loss: 1.0347115
	speed: 0.2294s/iter; left time: 9406.7643s
	iters: 400, epoch: 1 | loss: 0.3735176
	speed: 0.2314s/iter; left time: 9466.5205s
Epoch: 1 cost time: 94.72765016555786
Epoch: 1, Steps: 413 | Train Loss: 1.082 Vali Loss: 0.236 Vali Acc: 0.950 Test Loss: 0.236 Test Acc: 0.950
Validation loss decreased (inf --> -0.949975).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3352783
	speed: 0.4487s/iter; left time: 18300.1327s
	iters: 200, epoch: 2 | loss: 0.1067785
	speed: 0.2689s/iter; left time: 10942.2339s
	iters: 300, epoch: 2 | loss: 0.1179513
	speed: 0.2467s/iter; left time: 10012.5546s
	iters: 400, epoch: 2 | loss: 0.0915041
	speed: 0.2537s/iter; left time: 10270.8653s
Epoch: 2 cost time: 104.63953280448914
Epoch: 2, Steps: 413 | Train Loss: 0.182 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
Validation loss decreased (-0.949975 --> -0.978171).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0146956
	speed: 3.7288s/iter; left time: 150551.1378s
	iters: 200, epoch: 3 | loss: 0.0441695
	speed: 0.2659s/iter; left time: 10709.6717s
	iters: 300, epoch: 3 | loss: 0.0964362
	speed: 0.2235s/iter; left time: 8979.3499s
	iters: 400, epoch: 3 | loss: 0.0391954
	speed: 0.2694s/iter; left time: 10796.4084s
Epoch: 3 cost time: 106.5068347454071
Epoch: 3, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.049 Vali Acc: 0.980 Test Loss: 0.049 Test Acc: 0.980
Validation loss decreased (-0.978171 --> -0.979990).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0475040
	speed: 3.7051s/iter; left time: 148063.2137s
	iters: 200, epoch: 4 | loss: 0.0131109
	speed: 0.2420s/iter; left time: 9647.6745s
	iters: 300, epoch: 4 | loss: 0.0526823
	speed: 0.2842s/iter; left time: 11302.1794s
	iters: 400, epoch: 4 | loss: 0.0718465
	speed: 0.2464s/iter; left time: 9772.0921s
Epoch: 4 cost time: 107.43941450119019
Epoch: 4, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.050 Vali Acc: 0.979 Test Loss: 0.050 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0078157
	speed: 0.4517s/iter; left time: 17865.2357s
	iters: 200, epoch: 5 | loss: 0.0228085
	speed: 0.2172s/iter; left time: 8567.8506s
	iters: 300, epoch: 5 | loss: 0.0030174
	speed: 0.2782s/iter; left time: 10948.0231s
	iters: 400, epoch: 5 | loss: 0.0507640
	speed: 0.2413s/iter; left time: 9469.0370s
Epoch: 5 cost time: 100.31179618835449
Epoch: 5, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.047 Vali Acc: 0.985 Test Loss: 0.047 Test Acc: 0.985
Validation loss decreased (-0.979990 --> -0.984538).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0015700
	speed: 8.0573s/iter; left time: 315331.1615s
	iters: 200, epoch: 6 | loss: 0.0080328
	speed: 0.3681s/iter; left time: 14368.1618s
	iters: 300, epoch: 6 | loss: 0.0178974
	speed: 0.3092s/iter; left time: 12040.2632s
	iters: 400, epoch: 6 | loss: 0.0016790
	speed: 0.2961s/iter; left time: 11500.4963s
Epoch: 6 cost time: 134.15007662773132
Epoch: 6, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.044 Vali Acc: 0.983 Test Loss: 0.044 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0025097
	speed: 0.5258s/iter; left time: 20359.5989s
	iters: 200, epoch: 7 | loss: 0.0045044
	speed: 0.3051s/iter; left time: 11782.2227s
	iters: 300, epoch: 7 | loss: 0.0209373
	speed: 0.2808s/iter; left time: 10817.3500s
	iters: 400, epoch: 7 | loss: 0.0062279
	speed: 0.2938s/iter; left time: 11288.3069s
Epoch: 7 cost time: 121.65651226043701
Epoch: 7, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.045 Vali Acc: 0.985 Test Loss: 0.045 Test Acc: 0.985
Validation loss decreased (-0.984538 --> -0.984538).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0049994
	speed: 0.6333s/iter; left time: 24260.5606s
	iters: 200, epoch: 8 | loss: 0.0028345
	speed: 0.3648s/iter; left time: 13938.5872s
	iters: 300, epoch: 8 | loss: 0.0006308
	speed: 0.3674s/iter; left time: 14002.5699s
	iters: 400, epoch: 8 | loss: 0.0025556
	speed: 0.3663s/iter; left time: 13924.5285s
Epoch: 8 cost time: 150.8532304763794
Epoch: 8, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0005945
	speed: 0.7707s/iter; left time: 29205.8736s
	iters: 200, epoch: 9 | loss: 0.0164065
	speed: 0.3661s/iter; left time: 13836.5434s
	iters: 300, epoch: 9 | loss: 0.0068468
	speed: 0.3820s/iter; left time: 14399.9492s
	iters: 400, epoch: 9 | loss: 0.0104620
	speed: 0.3846s/iter; left time: 14461.5042s
Epoch: 9 cost time: 156.78779578208923
Epoch: 9, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.064 Vali Acc: 0.981 Test Loss: 0.064 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0716783
	speed: 0.7935s/iter; left time: 29744.8558s
	iters: 200, epoch: 10 | loss: 0.0020635
	speed: 0.4071s/iter; left time: 15219.1486s
	iters: 300, epoch: 10 | loss: 0.0008377
	speed: 0.3782s/iter; left time: 14101.2156s
	iters: 400, epoch: 10 | loss: 0.0246710
	speed: 0.3648s/iter; left time: 13563.2910s
Epoch: 10 cost time: 158.1392846107483
Epoch: 10, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0006133
	speed: 0.7583s/iter; left time: 28111.3435s
	iters: 200, epoch: 11 | loss: 0.0036447
	speed: 0.3912s/iter; left time: 14464.1122s
	iters: 300, epoch: 11 | loss: 0.0011731
	speed: 0.3864s/iter; left time: 14248.2788s
	iters: 400, epoch: 11 | loss: 0.0750402
	speed: 0.4155s/iter; left time: 15278.8121s
Epoch: 11 cost time: 161.72524404525757
Epoch: 11, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000488
	speed: 0.7880s/iter; left time: 28884.7468s
	iters: 200, epoch: 12 | loss: 0.0000697
	speed: 0.3983s/iter; left time: 14561.0405s
	iters: 300, epoch: 12 | loss: 0.0000268
	speed: 0.3690s/iter; left time: 13451.2116s
	iters: 400, epoch: 12 | loss: 0.0037536
	speed: 0.3652s/iter; left time: 13278.5557s
Epoch: 12 cost time: 156.34994769096375
Epoch: 12, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.071 Vali Acc: 0.979 Test Loss: 0.071 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000236
	speed: 0.7870s/iter; left time: 28523.8345s
	iters: 200, epoch: 13 | loss: 0.0022641
	speed: 0.3800s/iter; left time: 13734.4439s
	iters: 300, epoch: 13 | loss: 0.0212250
	speed: 0.3821s/iter; left time: 13771.7208s
	iters: 400, epoch: 13 | loss: 0.0039809
	speed: 0.3932s/iter; left time: 14134.9601s
Epoch: 13 cost time: 159.6190857887268
Epoch: 13, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.066 Vali Acc: 0.984 Test Loss: 0.066 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0002913
	speed: 0.7861s/iter; left time: 28166.3031s
	iters: 200, epoch: 14 | loss: 0.0262380
	speed: 0.3854s/iter; left time: 13772.2079s
	iters: 300, epoch: 14 | loss: 0.0037927
	speed: 0.3764s/iter; left time: 13411.9581s
	iters: 400, epoch: 14 | loss: 0.0842122
	speed: 0.3842s/iter; left time: 13651.4552s
Epoch: 14 cost time: 158.47488260269165
Epoch: 14, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0001026
	speed: 0.8070s/iter; left time: 28582.9231s
	iters: 200, epoch: 15 | loss: 0.0022843
	speed: 0.3745s/iter; left time: 13226.2881s
	iters: 300, epoch: 15 | loss: 0.0002313
	speed: 0.3713s/iter; left time: 13075.8431s
	iters: 400, epoch: 15 | loss: 0.0000277
	speed: 0.3638s/iter; left time: 12775.2279s
Epoch: 15 cost time: 155.0984663963318
Epoch: 15, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0004624
	speed: 0.7561s/iter; left time: 26466.9987s
	iters: 200, epoch: 16 | loss: 0.0002111
	speed: 0.3646s/iter; left time: 12727.0858s
	iters: 300, epoch: 16 | loss: 0.0052177
	speed: 0.3591s/iter; left time: 12499.9352s
	iters: 400, epoch: 16 | loss: 0.0031770
	speed: 0.3931s/iter; left time: 13643.0337s
Epoch: 16 cost time: 153.57585978507996
Epoch: 16, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.067 Vali Acc: 0.978 Test Loss: 0.067 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0020180
	speed: 0.7805s/iter; left time: 27000.8183s
	iters: 200, epoch: 17 | loss: 0.0001867
	speed: 0.3720s/iter; left time: 12829.9258s
	iters: 300, epoch: 17 | loss: 0.0005373
	speed: 0.3658s/iter; left time: 12581.8869s
	iters: 400, epoch: 17 | loss: 0.0037507
	speed: 0.3588s/iter; left time: 12303.9292s
Epoch: 17 cost time: 152.7721927165985
Epoch: 17, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.045 Vali Acc: 0.985 Test Loss: 0.045 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9845384265575261
model parameter : 462154
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.8218427
	speed: 0.3588s/iter; left time: 14781.1208s
	iters: 200, epoch: 1 | loss: 1.4035469
	speed: 0.3321s/iter; left time: 13651.2076s
	iters: 300, epoch: 1 | loss: 0.9427371
	speed: 0.3464s/iter; left time: 14204.6069s
	iters: 400, epoch: 1 | loss: 0.4195864
	speed: 0.3504s/iter; left time: 14331.5318s
Epoch: 1 cost time: 143.66373825073242
Epoch: 1, Steps: 413 | Train Loss: 1.314 Vali Loss: 0.241 Vali Acc: 0.939 Test Loss: 0.241 Test Acc: 0.939
Validation loss decreased (inf --> -0.939061).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4439902
	speed: 0.7229s/iter; left time: 29484.0268s
	iters: 200, epoch: 2 | loss: 0.1797588
	speed: 0.3687s/iter; left time: 15001.7249s
	iters: 300, epoch: 2 | loss: 0.1286623
	speed: 0.3384s/iter; left time: 13736.2955s
	iters: 400, epoch: 2 | loss: 0.0613944
	speed: 0.3320s/iter; left time: 13441.0169s
Epoch: 2 cost time: 143.4133243560791
Epoch: 2, Steps: 413 | Train Loss: 0.211 Vali Loss: 0.113 Vali Acc: 0.966 Test Loss: 0.113 Test Acc: 0.966
Validation loss decreased (-0.939061 --> -0.965892).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0227830
	speed: 0.7019s/iter; left time: 28340.6699s
	iters: 200, epoch: 3 | loss: 0.0600072
	speed: 0.3430s/iter; left time: 13813.0170s
	iters: 300, epoch: 3 | loss: 0.1453663
	speed: 0.3423s/iter; left time: 13752.2750s
	iters: 400, epoch: 3 | loss: 0.1295778
	speed: 0.3376s/iter; left time: 13530.4139s
Epoch: 3 cost time: 139.52830600738525
Epoch: 3, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
Validation loss decreased (-0.965892 --> -0.973169).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0154521
	speed: 0.7195s/iter; left time: 28751.3977s
	iters: 200, epoch: 4 | loss: 0.0297568
	speed: 0.3381s/iter; left time: 13476.2692s
	iters: 300, epoch: 4 | loss: 0.0297803
	speed: 0.3201s/iter; left time: 12727.3772s
	iters: 400, epoch: 4 | loss: 0.0160469
	speed: 0.3189s/iter; left time: 12646.9445s
Epoch: 4 cost time: 136.3169755935669
Epoch: 4, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.078 Vali Acc: 0.975 Test Loss: 0.078 Test Acc: 0.975
Validation loss decreased (-0.973169 --> -0.975443).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0436676
	speed: 0.6923s/iter; left time: 27378.3976s
	iters: 200, epoch: 5 | loss: 0.0323014
	speed: 0.3289s/iter; left time: 12972.9096s
	iters: 300, epoch: 5 | loss: 0.0053418
	speed: 0.3558s/iter; left time: 14002.0692s
	iters: 400, epoch: 5 | loss: 0.0227205
	speed: 0.3437s/iter; left time: 13490.4567s
Epoch: 5 cost time: 140.69706559181213
Epoch: 5, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.057 Vali Acc: 0.977 Test Loss: 0.057 Test Acc: 0.977
Validation loss decreased (-0.975443 --> -0.977262).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0175278
	speed: 0.7037s/iter; left time: 27541.0342s
	iters: 200, epoch: 6 | loss: 0.0012724
	speed: 0.3388s/iter; left time: 13224.6967s
	iters: 300, epoch: 6 | loss: 0.0090147
	speed: 0.3203s/iter; left time: 12472.5485s
	iters: 400, epoch: 6 | loss: 0.0241366
	speed: 0.3355s/iter; left time: 13030.9859s
Epoch: 6 cost time: 136.82847142219543
Epoch: 6, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.066 Vali Acc: 0.981 Test Loss: 0.066 Test Acc: 0.981
Validation loss decreased (-0.977262 --> -0.980900).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0035988
	speed: 0.7000s/iter; left time: 27107.9708s
	iters: 200, epoch: 7 | loss: 0.0008226
	speed: 0.3229s/iter; left time: 12470.6900s
	iters: 300, epoch: 7 | loss: 0.0786911
	speed: 0.3118s/iter; left time: 12011.5616s
	iters: 400, epoch: 7 | loss: 0.0320627
	speed: 0.3442s/iter; left time: 13225.5559s
Epoch: 7 cost time: 135.85361695289612
Epoch: 7, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0041905
	speed: 0.7411s/iter; left time: 28393.1747s
	iters: 200, epoch: 8 | loss: 0.0075348
	speed: 0.3476s/iter; left time: 13281.1577s
	iters: 300, epoch: 8 | loss: 0.0012256
	speed: 0.3282s/iter; left time: 12506.4418s
	iters: 400, epoch: 8 | loss: 0.0023487
	speed: 0.3121s/iter; left time: 11862.7033s
Epoch: 8 cost time: 138.0438404083252
Epoch: 8, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.069 Vali Acc: 0.976 Test Loss: 0.069 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0132607
	speed: 0.6887s/iter; left time: 26100.4798s
	iters: 200, epoch: 9 | loss: 0.0868962
	speed: 0.3309s/iter; left time: 12506.2644s
	iters: 300, epoch: 9 | loss: 0.0004527
	speed: 0.3384s/iter; left time: 12755.9743s
	iters: 400, epoch: 9 | loss: 0.0007127
	speed: 0.3432s/iter; left time: 12902.2179s
Epoch: 9 cost time: 138.486097574234
Epoch: 9, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.063 Vali Acc: 0.979 Test Loss: 0.063 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.1431019
	speed: 0.6942s/iter; left time: 26023.0894s
	iters: 200, epoch: 10 | loss: 0.0005849
	speed: 0.3295s/iter; left time: 12319.0191s
	iters: 300, epoch: 10 | loss: 0.0316552
	speed: 0.3397s/iter; left time: 12665.2292s
	iters: 400, epoch: 10 | loss: 0.0007871
	speed: 0.3453s/iter; left time: 12841.3140s
Epoch: 10 cost time: 139.68636512756348
Epoch: 10, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.066 Vali Acc: 0.979 Test Loss: 0.066 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0005243
	speed: 0.6961s/iter; left time: 25804.0616s
	iters: 200, epoch: 11 | loss: 0.0063160
	speed: 0.3092s/iter; left time: 11430.1015s
	iters: 300, epoch: 11 | loss: 0.0038244
	speed: 0.3280s/iter; left time: 12095.1185s
	iters: 400, epoch: 11 | loss: 0.0279088
	speed: 0.3209s/iter; left time: 11799.3544s
Epoch: 11 cost time: 132.64890837669373
Epoch: 11, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.050 Vali Acc: 0.984 Test Loss: 0.050 Test Acc: 0.984
Validation loss decreased (-0.980900 --> -0.984083).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0220458
	speed: 0.7264s/iter; left time: 26626.8108s
	iters: 200, epoch: 12 | loss: 0.0011489
	speed: 0.3307s/iter; left time: 12090.0408s
	iters: 300, epoch: 12 | loss: 0.0002168
	speed: 0.3083s/iter; left time: 11238.9566s
	iters: 400, epoch: 12 | loss: 0.0345184
	speed: 0.3179s/iter; left time: 11557.9091s
Epoch: 12 cost time: 135.026123046875
Epoch: 12, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.081 Vali Acc: 0.972 Test Loss: 0.081 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000347
	speed: 0.6962s/iter; left time: 25232.8408s
	iters: 200, epoch: 13 | loss: 0.0034573
	speed: 0.3361s/iter; left time: 12148.9086s
	iters: 300, epoch: 13 | loss: 0.0000873
	speed: 0.3215s/iter; left time: 11587.6729s
	iters: 400, epoch: 13 | loss: 0.0055385
	speed: 0.3190s/iter; left time: 11465.7330s
Epoch: 13 cost time: 135.51351690292358
Epoch: 13, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0030729
	speed: 0.6856s/iter; left time: 24565.5304s
	iters: 200, epoch: 14 | loss: 0.0016359
	speed: 0.3279s/iter; left time: 11715.4071s
	iters: 300, epoch: 14 | loss: 0.1096384
	speed: 0.3223s/iter; left time: 11482.4471s
	iters: 400, epoch: 14 | loss: 0.0414247
	speed: 0.3118s/iter; left time: 11079.1696s
Epoch: 14 cost time: 133.93324875831604
Epoch: 14, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.060 Vali Acc: 0.981 Test Loss: 0.060 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0004705
	speed: 0.6613s/iter; left time: 23421.4569s
	iters: 200, epoch: 15 | loss: 0.0001025
	speed: 0.3154s/iter; left time: 11140.7273s
	iters: 300, epoch: 15 | loss: 0.0003398
	speed: 0.3492s/iter; left time: 12298.7050s
	iters: 400, epoch: 15 | loss: 0.0012381
	speed: 0.3336s/iter; left time: 11714.2384s
Epoch: 15 cost time: 136.37974762916565
Epoch: 15, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.051 Vali Acc: 0.985 Test Loss: 0.051 Test Acc: 0.985
Validation loss decreased (-0.984083 --> -0.985447).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0007278
	speed: 0.6913s/iter; left time: 24198.3439s
	iters: 200, epoch: 16 | loss: 0.0000217
	speed: 0.3292s/iter; left time: 11490.1226s
	iters: 300, epoch: 16 | loss: 0.0005632
	speed: 0.3174s/iter; left time: 11045.9865s
	iters: 400, epoch: 16 | loss: 0.0000771
	speed: 0.3170s/iter; left time: 11003.0804s
Epoch: 16 cost time: 133.69980478286743
Epoch: 16, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.083 Vali Acc: 0.979 Test Loss: 0.083 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0009021
	speed: 0.6555s/iter; left time: 22677.1332s
	iters: 200, epoch: 17 | loss: 0.0008041
	speed: 0.3417s/iter; left time: 11785.7030s
	iters: 300, epoch: 17 | loss: 0.0026547
	speed: 0.3433s/iter; left time: 11806.9824s
	iters: 400, epoch: 17 | loss: 0.0000278
	speed: 0.3334s/iter; left time: 11433.8194s
Epoch: 17 cost time: 137.920640707016
Epoch: 17, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0006053
	speed: 0.7126s/iter; left time: 24355.2470s
	iters: 200, epoch: 18 | loss: 0.0007125
	speed: 0.3362s/iter; left time: 11457.4348s
	iters: 300, epoch: 18 | loss: 0.0001306
	speed: 0.3432s/iter; left time: 11662.2487s
	iters: 400, epoch: 18 | loss: 0.0515968
	speed: 0.3230s/iter; left time: 10943.2473s
Epoch: 18 cost time: 139.1767659187317
Epoch: 18, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0083012
	speed: 0.6623s/iter; left time: 22364.5177s
	iters: 200, epoch: 19 | loss: 0.0000008
	speed: 0.3277s/iter; left time: 11031.4743s
	iters: 300, epoch: 19 | loss: 0.0000212
	speed: 0.3361s/iter; left time: 11280.4240s
	iters: 400, epoch: 19 | loss: 0.0034509
	speed: 0.3326s/iter; left time: 11132.3798s
Epoch: 19 cost time: 136.31128454208374
Epoch: 19, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.048 Vali Acc: 0.984 Test Loss: 0.048 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000411
	speed: 0.7184s/iter; left time: 23960.7250s
	iters: 200, epoch: 20 | loss: 0.0061548
	speed: 0.3251s/iter; left time: 10810.2309s
	iters: 300, epoch: 20 | loss: 0.0017575
	speed: 0.3445s/iter; left time: 11420.2755s
	iters: 400, epoch: 20 | loss: 0.0000313
	speed: 0.3552s/iter; left time: 11740.6664s
Epoch: 20 cost time: 142.02001786231995
Epoch: 20, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0000747
	speed: 0.7028s/iter; left time: 23152.1576s
	iters: 200, epoch: 21 | loss: 0.0684483
	speed: 0.3091s/iter; left time: 10150.0121s
	iters: 300, epoch: 21 | loss: 0.0005579
	speed: 0.3187s/iter; left time: 10435.5272s
	iters: 400, epoch: 21 | loss: 0.0000085
	speed: 0.3162s/iter; left time: 10320.8940s
Epoch: 21 cost time: 132.3062264919281
Epoch: 21, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.059 Vali Acc: 0.982 Test Loss: 0.059 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0017282
	speed: 0.7219s/iter; left time: 23483.2090s
	iters: 200, epoch: 22 | loss: 0.0000166
	speed: 0.3450s/iter; left time: 11188.2764s
	iters: 300, epoch: 22 | loss: 0.0004112
	speed: 0.3255s/iter; left time: 10523.2330s
	iters: 400, epoch: 22 | loss: 0.0000183
	speed: 0.3186s/iter; left time: 10268.5994s
Epoch: 22 cost time: 138.01279473304749
Epoch: 22, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.056 Vali Acc: 0.985 Test Loss: 0.056 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0000009
	speed: 0.7136s/iter; left time: 22917.7738s
	iters: 200, epoch: 23 | loss: 0.0001055
	speed: 0.3631s/iter; left time: 11624.8430s
	iters: 300, epoch: 23 | loss: 0.0003531
	speed: 0.3657s/iter; left time: 11672.0855s
	iters: 400, epoch: 23 | loss: 0.0003368
	speed: 0.3398s/iter; left time: 10811.9082s
Epoch: 23 cost time: 147.10325932502747
Epoch: 23, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.078 Vali Acc: 0.982 Test Loss: 0.078 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0736534
	speed: 0.7217s/iter; left time: 22878.6085s
	iters: 200, epoch: 24 | loss: 0.0006042
	speed: 0.3568s/iter; left time: 11276.9283s
	iters: 300, epoch: 24 | loss: 0.0000112
	speed: 0.3394s/iter; left time: 10692.6382s
	iters: 400, epoch: 24 | loss: 0.0000106
	speed: 0.3532s/iter; left time: 11090.8469s
Epoch: 24 cost time: 146.2478518486023
Epoch: 24, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.050 Vali Acc: 0.989 Test Loss: 0.050 Test Acc: 0.989
Validation loss decreased (-0.985447 --> -0.989085).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0006535
	speed: 0.7482s/iter; left time: 23411.0050s
	iters: 200, epoch: 25 | loss: 0.0000902
	speed: 0.3474s/iter; left time: 10836.2655s
	iters: 300, epoch: 25 | loss: 0.0001439
	speed: 0.3392s/iter; left time: 10546.6445s
	iters: 400, epoch: 25 | loss: 0.0079724
	speed: 0.3461s/iter; left time: 10725.7721s
Epoch: 25 cost time: 144.059650182724
Epoch: 25, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.071 Vali Acc: 0.982 Test Loss: 0.071 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0001866
	speed: 0.7214s/iter; left time: 22272.9052s
	iters: 200, epoch: 26 | loss: 0.0000035
	speed: 0.3534s/iter; left time: 10877.3938s
	iters: 300, epoch: 26 | loss: 0.0000006
	speed: 0.3590s/iter; left time: 11011.4645s
	iters: 400, epoch: 26 | loss: 0.0000199
	speed: 0.3357s/iter; left time: 10264.7827s
Epoch: 26 cost time: 145.18553972244263
Epoch: 26, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0000447
	speed: 0.7119s/iter; left time: 21687.0214s
	iters: 200, epoch: 27 | loss: 0.0001041
	speed: 0.3511s/iter; left time: 10659.0756s
	iters: 300, epoch: 27 | loss: 0.0044894
	speed: 0.3519s/iter; left time: 10649.1064s
	iters: 400, epoch: 27 | loss: 0.0000154
	speed: 0.3735s/iter; left time: 11266.1938s
Epoch: 27 cost time: 146.65508270263672
Epoch: 27, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0000012
	speed: 0.6947s/iter; left time: 20874.9142s
	iters: 200, epoch: 28 | loss: 0.0000316
	speed: 0.3322s/iter; left time: 9948.1009s
	iters: 300, epoch: 28 | loss: 0.0000751
	speed: 0.3405s/iter; left time: 10163.0406s
	iters: 400, epoch: 28 | loss: 0.0001016
	speed: 0.3482s/iter; left time: 10359.0208s
Epoch: 28 cost time: 139.64630651474
Epoch: 28, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0000080
	speed: 0.7227s/iter; left time: 21419.2215s
	iters: 200, epoch: 29 | loss: 0.0013831
	speed: 0.3409s/iter; left time: 10069.7224s
	iters: 300, epoch: 29 | loss: 0.0019944
	speed: 0.3570s/iter; left time: 10508.6197s
	iters: 400, epoch: 29 | loss: 0.0000003
	speed: 0.3506s/iter; left time: 10286.6494s
Epoch: 29 cost time: 144.0616409778595
Epoch: 29, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0001778
	speed: 0.6894s/iter; left time: 20145.7425s
	iters: 200, epoch: 30 | loss: 0.0000009
	speed: 0.3282s/iter; left time: 9557.2935s
	iters: 300, epoch: 30 | loss: 0.0001260
	speed: 0.3304s/iter; left time: 9590.9765s
	iters: 400, epoch: 30 | loss: 0.0000120
	speed: 0.3473s/iter; left time: 10043.8978s
Epoch: 30 cost time: 138.46956658363342
Epoch: 30, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.0001235
	speed: 0.7148s/iter; left time: 20594.3899s
	iters: 200, epoch: 31 | loss: 0.0000061
	speed: 0.3377s/iter; left time: 9696.3316s
	iters: 300, epoch: 31 | loss: 0.0000303
	speed: 0.3359s/iter; left time: 9610.6211s
	iters: 400, epoch: 31 | loss: 0.0000051
	speed: 0.3263s/iter; left time: 9302.1756s
Epoch: 31 cost time: 138.1652147769928
Epoch: 31, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.0000707
	speed: 0.6928s/iter; left time: 19674.5312s
	iters: 200, epoch: 32 | loss: 0.0000831
	speed: 0.3054s/iter; left time: 8641.2908s
	iters: 300, epoch: 32 | loss: 0.0000143
	speed: 0.3210s/iter; left time: 9052.8291s
	iters: 400, epoch: 32 | loss: 0.0000015
	speed: 0.3318s/iter; left time: 9321.8961s
Epoch: 32 cost time: 134.35712003707886
Epoch: 32, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.091 Vali Acc: 0.982 Test Loss: 0.091 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0000567
	speed: 0.6747s/iter; left time: 18881.5243s
	iters: 200, epoch: 33 | loss: 0.0000260
	speed: 0.3246s/iter; left time: 9051.7159s
	iters: 300, epoch: 33 | loss: 0.0051895
	speed: 0.3265s/iter; left time: 9072.8410s
	iters: 400, epoch: 33 | loss: 0.0001960
	speed: 0.3287s/iter; left time: 9100.9412s
Epoch: 33 cost time: 135.53116726875305
Epoch: 33, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.051 Vali Acc: 0.988 Test Loss: 0.051 Test Acc: 0.988
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.0002630
	speed: 0.6729s/iter; left time: 18554.3531s
	iters: 200, epoch: 34 | loss: 0.0000025
	speed: 0.3232s/iter; left time: 8878.4886s
	iters: 300, epoch: 34 | loss: 0.0000443
	speed: 0.3292s/iter; left time: 9011.6927s
	iters: 400, epoch: 34 | loss: 0.0003131
	speed: 0.3213s/iter; left time: 8763.6271s
Epoch: 34 cost time: 135.24834561347961
Epoch: 34, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9890859481582538
model parameter : 462154
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.9530481
	speed: 0.3228s/iter; left time: 13300.7935s
	iters: 200, epoch: 1 | loss: 1.6952704
	speed: 0.2985s/iter; left time: 12270.5154s
	iters: 300, epoch: 1 | loss: 1.2335937
	speed: 0.2912s/iter; left time: 11941.1255s
	iters: 400, epoch: 1 | loss: 0.6103486
	speed: 0.3140s/iter; left time: 12843.4373s
Epoch: 1 cost time: 127.07734322547913
Epoch: 1, Steps: 413 | Train Loss: 1.484 Vali Loss: 0.330 Vali Acc: 0.917 Test Loss: 0.330 Test Acc: 0.917
Validation loss decreased (inf --> -0.916777).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5300003
	speed: 0.6791s/iter; left time: 27699.0442s
	iters: 200, epoch: 2 | loss: 0.1838969
	speed: 0.3150s/iter; left time: 12816.4031s
	iters: 300, epoch: 2 | loss: 0.1645250
	speed: 0.3068s/iter; left time: 12452.4819s
	iters: 400, epoch: 2 | loss: 0.0937974
	speed: 0.2949s/iter; left time: 11941.3284s
Epoch: 2 cost time: 128.79085540771484
Epoch: 2, Steps: 413 | Train Loss: 0.261 Vali Loss: 0.139 Vali Acc: 0.960 Test Loss: 0.139 Test Acc: 0.960
Validation loss decreased (-0.916777 --> -0.959980).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0489320
	speed: 0.6534s/iter; left time: 26379.5830s
	iters: 200, epoch: 3 | loss: 0.0833167
	speed: 0.3104s/iter; left time: 12500.5492s
	iters: 300, epoch: 3 | loss: 0.2817323
	speed: 0.3112s/iter; left time: 12503.4568s
	iters: 400, epoch: 3 | loss: 0.2150069
	speed: 0.3147s/iter; left time: 12610.6486s
Epoch: 3 cost time: 129.4959840774536
Epoch: 3, Steps: 413 | Train Loss: 0.111 Vali Loss: 0.088 Vali Acc: 0.975 Test Loss: 0.088 Test Acc: 0.975
Validation loss decreased (-0.959980 --> -0.974988).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0367027
	speed: 0.7050s/iter; left time: 28173.8652s
	iters: 200, epoch: 4 | loss: 0.0147214
	speed: 0.3427s/iter; left time: 13661.6899s
	iters: 300, epoch: 4 | loss: 0.0985595
	speed: 0.3489s/iter; left time: 13874.5895s
	iters: 400, epoch: 4 | loss: 0.0453913
	speed: 0.3498s/iter; left time: 13874.6707s
Epoch: 4 cost time: 143.74730372428894
Epoch: 4, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.076 Vali Acc: 0.972 Test Loss: 0.076 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0203962
	speed: 0.6953s/iter; left time: 27497.3781s
	iters: 200, epoch: 5 | loss: 0.0403373
	speed: 0.3253s/iter; left time: 12832.3362s
	iters: 300, epoch: 5 | loss: 0.0059894
	speed: 0.3362s/iter; left time: 13229.8226s
	iters: 400, epoch: 5 | loss: 0.0130768
	speed: 0.3140s/iter; left time: 12325.3510s
Epoch: 5 cost time: 134.95302152633667
Epoch: 5, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
Validation loss decreased (-0.974988 --> -0.978171).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0008110
	speed: 0.6571s/iter; left time: 25715.8111s
	iters: 200, epoch: 6 | loss: 0.0093287
	speed: 0.3154s/iter; left time: 12312.5350s
	iters: 300, epoch: 6 | loss: 0.0138693
	speed: 0.3128s/iter; left time: 12178.4852s
	iters: 400, epoch: 6 | loss: 0.0021331
	speed: 0.3204s/iter; left time: 12441.5834s
Epoch: 6 cost time: 131.20677876472473
Epoch: 6, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.978171 --> -0.983173).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0131905
	speed: 0.6496s/iter; left time: 25154.1805s
	iters: 200, epoch: 7 | loss: 0.0003357
	speed: 0.3069s/iter; left time: 11852.4638s
	iters: 300, epoch: 7 | loss: 0.0147109
	speed: 0.2985s/iter; left time: 11500.2928s
	iters: 400, epoch: 7 | loss: 0.0088466
	speed: 0.3177s/iter; left time: 12206.6550s
Epoch: 7 cost time: 127.42673087120056
Epoch: 7, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.080 Vali Acc: 0.974 Test Loss: 0.080 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0217802
	speed: 0.6488s/iter; left time: 24854.8937s
	iters: 200, epoch: 8 | loss: 0.0076869
	speed: 0.3045s/iter; left time: 11636.2435s
	iters: 300, epoch: 8 | loss: 0.0663152
	speed: 0.3253s/iter; left time: 12397.8437s
	iters: 400, epoch: 8 | loss: 0.0372365
	speed: 0.3354s/iter; left time: 12747.9024s
Epoch: 8 cost time: 132.4057173728943
Epoch: 8, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.063 Vali Acc: 0.981 Test Loss: 0.063 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0001664
	speed: 0.6729s/iter; left time: 25501.9157s
	iters: 200, epoch: 9 | loss: 0.1296423
	speed: 0.3177s/iter; left time: 12009.4021s
	iters: 300, epoch: 9 | loss: 0.0012531
	speed: 0.3179s/iter; left time: 11983.9358s
	iters: 400, epoch: 9 | loss: 0.0005938
	speed: 0.3175s/iter; left time: 11935.1962s
Epoch: 9 cost time: 132.1697552204132
Epoch: 9, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.058 Vali Acc: 0.983 Test Loss: 0.058 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0139872
	speed: 0.6948s/iter; left time: 26043.1467s
	iters: 200, epoch: 10 | loss: 0.0017064
	speed: 0.3365s/iter; left time: 12578.9563s
	iters: 300, epoch: 10 | loss: 0.0016095
	speed: 0.3343s/iter; left time: 12464.4419s
	iters: 400, epoch: 10 | loss: 0.0032683
	speed: 0.3687s/iter; left time: 13709.7885s
Epoch: 10 cost time: 142.58534860610962
Epoch: 10, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.137 Vali Acc: 0.969 Test Loss: 0.137 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0029485
	speed: 0.7234s/iter; left time: 26816.3839s
	iters: 200, epoch: 11 | loss: 0.0010845
	speed: 0.3358s/iter; left time: 12415.5560s
	iters: 300, epoch: 11 | loss: 0.0004836
	speed: 0.3531s/iter; left time: 13020.7696s
	iters: 400, epoch: 11 | loss: 0.0348891
	speed: 0.3567s/iter; left time: 13114.4737s
Epoch: 11 cost time: 142.18657302856445
Epoch: 11, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0001797
	speed: 0.6797s/iter; left time: 24916.2447s
	iters: 200, epoch: 12 | loss: 0.0028892
	speed: 0.3142s/iter; left time: 11486.1781s
	iters: 300, epoch: 12 | loss: 0.0001928
	speed: 0.3340s/iter; left time: 12176.2729s
	iters: 400, epoch: 12 | loss: 0.0017131
	speed: 0.3456s/iter; left time: 12565.4637s
Epoch: 12 cost time: 136.2350151538849
Epoch: 12, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0001816
	speed: 0.7049s/iter; left time: 25550.7069s
	iters: 200, epoch: 13 | loss: 0.0022712
	speed: 0.3335s/iter; left time: 12055.6723s
	iters: 300, epoch: 13 | loss: 0.0090610
	speed: 0.3361s/iter; left time: 12114.0461s
	iters: 400, epoch: 13 | loss: 0.0003766
	speed: 0.3528s/iter; left time: 12682.4650s
Epoch: 13 cost time: 141.58646059036255
Epoch: 13, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0313606
	speed: 0.7031s/iter; left time: 25192.2470s
	iters: 200, epoch: 14 | loss: 0.0031321
	speed: 0.3375s/iter; left time: 12058.0073s
	iters: 300, epoch: 14 | loss: 0.0026974
	speed: 0.3328s/iter; left time: 11858.3270s
	iters: 400, epoch: 14 | loss: 0.0011788
	speed: 0.3471s/iter; left time: 12333.7464s
Epoch: 14 cost time: 139.894362449646
Epoch: 14, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0003453
	speed: 0.7229s/iter; left time: 25606.0513s
	iters: 200, epoch: 15 | loss: 0.0005422
	speed: 0.3685s/iter; left time: 13016.6238s
	iters: 300, epoch: 15 | loss: 0.0000552
	speed: 0.3631s/iter; left time: 12789.5198s
	iters: 400, epoch: 15 | loss: 0.0000879
	speed: 0.3345s/iter; left time: 11747.4319s
Epoch: 15 cost time: 145.71796441078186
Epoch: 15, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.103 Vali Acc: 0.972 Test Loss: 0.103 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0002914
	speed: 0.6845s/iter; left time: 23960.0121s
	iters: 200, epoch: 16 | loss: 0.0003559
	speed: 0.3427s/iter; left time: 11963.0846s
	iters: 300, epoch: 16 | loss: 0.0220381
	speed: 0.3462s/iter; left time: 12049.0787s
	iters: 400, epoch: 16 | loss: 0.0002635
	speed: 0.3377s/iter; left time: 11718.8779s
Epoch: 16 cost time: 140.18712329864502
Epoch: 16, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9831741700773079
model parameter : 462154
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.0580139
	speed: 0.3633s/iter; left time: 14970.3788s
	iters: 200, epoch: 1 | loss: 1.4918648
	speed: 0.3730s/iter; left time: 15329.7586s
	iters: 300, epoch: 1 | loss: 1.1212187
	speed: 0.3527s/iter; left time: 14462.1843s
	iters: 400, epoch: 1 | loss: 0.4919617
	speed: 0.3322s/iter; left time: 13586.8285s
Epoch: 1 cost time: 146.51998162269592
Epoch: 1, Steps: 413 | Train Loss: 1.465 Vali Loss: 0.325 Vali Acc: 0.914 Test Loss: 0.325 Test Acc: 0.914
Validation loss decreased (inf --> -0.914049).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5434843
	speed: 0.6615s/iter; left time: 26981.6430s
	iters: 200, epoch: 2 | loss: 0.1512616
	speed: 0.3590s/iter; left time: 14607.9150s
	iters: 300, epoch: 2 | loss: 0.1880754
	speed: 0.3497s/iter; left time: 14193.7705s
	iters: 400, epoch: 2 | loss: 0.1040045
	speed: 0.3345s/iter; left time: 13544.5827s
Epoch: 2 cost time: 141.11530303955078
Epoch: 2, Steps: 413 | Train Loss: 0.266 Vali Loss: 0.150 Vali Acc: 0.956 Test Loss: 0.150 Test Acc: 0.956
Validation loss decreased (-0.914049 --> -0.956342).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0359323
	speed: 0.7092s/iter; left time: 28632.5674s
	iters: 200, epoch: 3 | loss: 0.0493945
	speed: 0.3565s/iter; left time: 14356.1001s
	iters: 300, epoch: 3 | loss: 0.1872556
	speed: 0.3313s/iter; left time: 13311.8041s
	iters: 400, epoch: 3 | loss: 0.0319917
	speed: 0.3332s/iter; left time: 13353.0345s
Epoch: 3 cost time: 141.68890285491943
Epoch: 3, Steps: 413 | Train Loss: 0.133 Vali Loss: 0.098 Vali Acc: 0.967 Test Loss: 0.098 Test Acc: 0.967
Validation loss decreased (-0.956342 --> -0.967257).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0490666
	speed: 0.6831s/iter; left time: 27297.8368s
	iters: 200, epoch: 4 | loss: 0.0862385
	speed: 0.3450s/iter; left time: 13751.0372s
	iters: 300, epoch: 4 | loss: 0.2718123
	speed: 0.3385s/iter; left time: 13459.1147s
	iters: 400, epoch: 4 | loss: 0.0925511
	speed: 0.3369s/iter; left time: 13362.4638s
Epoch: 4 cost time: 140.03328132629395
Epoch: 4, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
Validation loss decreased (-0.967257 --> -0.969531).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0082188
	speed: 0.6861s/iter; left time: 27136.4421s
	iters: 200, epoch: 5 | loss: 0.1258561
	speed: 0.3383s/iter; left time: 13347.3253s
	iters: 300, epoch: 5 | loss: 0.0065360
	speed: 0.3426s/iter; left time: 13480.3646s
	iters: 400, epoch: 5 | loss: 0.0077548
	speed: 0.3255s/iter; left time: 12773.7059s
Epoch: 5 cost time: 139.36805152893066
Epoch: 5, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.102 Vali Acc: 0.964 Test Loss: 0.102 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0031216
	speed: 0.7322s/iter; left time: 28654.6056s
	iters: 200, epoch: 6 | loss: 0.0060554
	speed: 0.3294s/iter; left time: 12857.9579s
	iters: 300, epoch: 6 | loss: 0.0717853
	speed: 0.3485s/iter; left time: 13568.3564s
	iters: 400, epoch: 6 | loss: 0.0131131
	speed: 0.3611s/iter; left time: 14024.1357s
Epoch: 6 cost time: 144.14444780349731
Epoch: 6, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.969531 --> -0.972714).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0032059
	speed: 0.6855s/iter; left time: 26544.0723s
	iters: 200, epoch: 7 | loss: 0.0003841
	speed: 0.3217s/iter; left time: 12426.4952s
	iters: 300, epoch: 7 | loss: 0.0242429
	speed: 0.3597s/iter; left time: 13857.0519s
	iters: 400, epoch: 7 | loss: 0.0226035
	speed: 0.3560s/iter; left time: 13680.2663s
Epoch: 7 cost time: 141.49136352539062
Epoch: 7, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
Validation loss decreased (-0.972714 --> -0.972714).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0051689
	speed: 0.6819s/iter; left time: 26123.6208s
	iters: 200, epoch: 8 | loss: 0.0346233
	speed: 0.3157s/iter; left time: 12061.0849s
	iters: 300, epoch: 8 | loss: 0.0040581
	speed: 0.3287s/iter; left time: 12526.4053s
	iters: 400, epoch: 8 | loss: 0.0022044
	speed: 0.3468s/iter; left time: 13182.8383s
Epoch: 8 cost time: 136.94879150390625
Epoch: 8, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0458113
	speed: 0.6487s/iter; left time: 24582.9615s
	iters: 200, epoch: 9 | loss: 0.2615413
	speed: 0.3172s/iter; left time: 11990.3963s
	iters: 300, epoch: 9 | loss: 0.0010777
	speed: 0.3461s/iter; left time: 13048.5281s
	iters: 400, epoch: 9 | loss: 0.0007288
	speed: 0.3540s/iter; left time: 13309.1483s
Epoch: 9 cost time: 136.7320511341095
Epoch: 9, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0973677
	speed: 0.6621s/iter; left time: 24819.5996s
	iters: 200, epoch: 10 | loss: 0.0019635
	speed: 0.3308s/iter; left time: 12367.0911s
	iters: 300, epoch: 10 | loss: 0.0000899
	speed: 0.3002s/iter; left time: 11191.7745s
	iters: 400, epoch: 10 | loss: 0.0037843
	speed: 0.3152s/iter; left time: 11719.5962s
Epoch: 10 cost time: 130.70327305793762
Epoch: 10, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.097 Vali Acc: 0.971 Test Loss: 0.097 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0051885
	speed: 0.6479s/iter; left time: 24018.4777s
	iters: 200, epoch: 11 | loss: 0.0052273
	speed: 0.3327s/iter; left time: 12298.4273s
	iters: 300, epoch: 11 | loss: 0.0093361
	speed: 0.3337s/iter; left time: 12304.8275s
	iters: 400, epoch: 11 | loss: 0.0463739
	speed: 0.3201s/iter; left time: 11769.1097s
Epoch: 11 cost time: 134.87317299842834
Epoch: 11, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.147 Vali Acc: 0.960 Test Loss: 0.147 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0005445
	speed: 0.6367s/iter; left time: 23338.5854s
	iters: 200, epoch: 12 | loss: 0.0002255
	speed: 0.3018s/iter; left time: 11033.1300s
	iters: 300, epoch: 12 | loss: 0.0017588
	speed: 0.3022s/iter; left time: 11017.7343s
	iters: 400, epoch: 12 | loss: 0.0054366
	speed: 0.2992s/iter; left time: 10877.2160s
Epoch: 12 cost time: 124.75383710861206
Epoch: 12, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0190116
	speed: 0.6139s/iter; left time: 22251.8539s
	iters: 200, epoch: 13 | loss: 0.0007331
	speed: 0.3018s/iter; left time: 10909.9850s
	iters: 300, epoch: 13 | loss: 0.0759017
	speed: 0.2936s/iter; left time: 10584.3069s
	iters: 400, epoch: 13 | loss: 0.0004616
	speed: 0.2938s/iter; left time: 10559.7446s
Epoch: 13 cost time: 123.26011323928833
Epoch: 13, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0003088
	speed: 0.6423s/iter; left time: 23015.4339s
	iters: 200, epoch: 14 | loss: 0.0070792
	speed: 0.3014s/iter; left time: 10770.6712s
	iters: 300, epoch: 14 | loss: 0.0009740
	speed: 0.3103s/iter; left time: 11055.6555s
	iters: 400, epoch: 14 | loss: 0.0007270
	speed: 0.3208s/iter; left time: 11399.5698s
Epoch: 14 cost time: 129.53327822685242
Epoch: 14, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.120 Vali Acc: 0.964 Test Loss: 0.120 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0034451
	speed: 0.6188s/iter; left time: 21915.7500s
	iters: 200, epoch: 15 | loss: 0.0001241
	speed: 0.2896s/iter; left time: 10228.2254s
	iters: 300, epoch: 15 | loss: 0.0199396
	speed: 0.3003s/iter; left time: 10577.8053s
	iters: 400, epoch: 15 | loss: 0.0222034
	speed: 0.3135s/iter; left time: 11008.0663s
Epoch: 15 cost time: 124.28610801696777
Epoch: 15, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.128 Vali Acc: 0.971 Test Loss: 0.128 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0002735
	speed: 0.6310s/iter; left time: 22088.5832s
	iters: 200, epoch: 16 | loss: 0.0000811
	speed: 0.2975s/iter; left time: 10383.3247s
	iters: 300, epoch: 16 | loss: 0.0262803
	speed: 0.3056s/iter; left time: 10638.3225s
	iters: 400, epoch: 16 | loss: 0.0014667
	speed: 0.3122s/iter; left time: 10833.7446s
Epoch: 16 cost time: 125.45592212677002
Epoch: 16, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.080 Vali Acc: 0.975 Test Loss: 0.080 Test Acc: 0.975
Validation loss decreased (-0.972714 --> -0.974988).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0293437
	speed: 0.6446s/iter; left time: 22297.6894s
	iters: 200, epoch: 17 | loss: 0.0014237
	speed: 0.2906s/iter; left time: 10023.9213s
	iters: 300, epoch: 17 | loss: 0.0230361
	speed: 0.2946s/iter; left time: 10131.3475s
	iters: 400, epoch: 17 | loss: 0.0000885
	speed: 0.3066s/iter; left time: 10515.3884s
Epoch: 17 cost time: 123.93197560310364
Epoch: 17, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0126409
	speed: 0.6367s/iter; left time: 21762.9715s
	iters: 200, epoch: 18 | loss: 0.0506601
	speed: 0.2923s/iter; left time: 9961.9636s
	iters: 300, epoch: 18 | loss: 0.0001048
	speed: 0.3035s/iter; left time: 10314.5323s
	iters: 400, epoch: 18 | loss: 0.1865429
	speed: 0.3123s/iter; left time: 10581.1961s
Epoch: 18 cost time: 125.81144762039185
Epoch: 18, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.175 Vali Acc: 0.964 Test Loss: 0.175 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0001612
	speed: 0.6613s/iter; left time: 22330.1187s
	iters: 200, epoch: 19 | loss: 0.0000433
	speed: 0.2991s/iter; left time: 10071.1584s
	iters: 300, epoch: 19 | loss: 0.0001814
	speed: 0.2855s/iter; left time: 9583.0917s
	iters: 400, epoch: 19 | loss: 0.0000075
	speed: 0.3158s/iter; left time: 10567.6641s
Epoch: 19 cost time: 125.98907995223999
Epoch: 19, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
Validation loss decreased (-0.974988 --> -0.975897).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0242793
	speed: 0.6873s/iter; left time: 22922.8700s
	iters: 200, epoch: 20 | loss: 0.0019110
	speed: 0.3056s/iter; left time: 10163.0395s
	iters: 300, epoch: 20 | loss: 0.3463614
	speed: 0.2937s/iter; left time: 9736.6268s
	iters: 400, epoch: 20 | loss: 0.0005021
	speed: 0.3088s/iter; left time: 10208.2785s
Epoch: 20 cost time: 128.76390981674194
Epoch: 20, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
Validation loss decreased (-0.975897 --> -0.977716).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0003600
	speed: 0.6586s/iter; left time: 21693.3827s
	iters: 200, epoch: 21 | loss: 0.0002447
	speed: 0.3146s/iter; left time: 10330.1512s
	iters: 300, epoch: 21 | loss: 0.0003831
	speed: 0.3028s/iter; left time: 9913.7408s
	iters: 400, epoch: 21 | loss: 0.0000759
	speed: 0.3141s/iter; left time: 10253.8613s
Epoch: 21 cost time: 129.7044403553009
Epoch: 21, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.977716 --> -0.980445).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0021203
	speed: 0.6436s/iter; left time: 20935.8504s
	iters: 200, epoch: 22 | loss: 0.0003921
	speed: 0.3055s/iter; left time: 9907.8264s
	iters: 300, epoch: 22 | loss: 0.0003798
	speed: 0.2981s/iter; left time: 9638.1080s
	iters: 400, epoch: 22 | loss: 0.0015752
	speed: 0.2958s/iter; left time: 9531.6724s
Epoch: 22 cost time: 125.99647307395935
Epoch: 22, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.2700891
	speed: 0.6408s/iter; left time: 20580.7843s
	iters: 200, epoch: 23 | loss: 0.0001875
	speed: 0.3080s/iter; left time: 9860.4737s
	iters: 300, epoch: 23 | loss: 0.0000342
	speed: 0.3034s/iter; left time: 9683.1263s
	iters: 400, epoch: 23 | loss: 0.0001045
	speed: 0.3063s/iter; left time: 9743.6524s
Epoch: 23 cost time: 127.95568299293518
Epoch: 23, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.155 Vali Acc: 0.970 Test Loss: 0.155 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0251079
	speed: 0.6824s/iter; left time: 21632.8849s
	iters: 200, epoch: 24 | loss: 0.0008503
	speed: 0.3233s/iter; left time: 10217.2112s
	iters: 300, epoch: 24 | loss: 0.0001393
	speed: 0.2917s/iter; left time: 9188.3261s
	iters: 400, epoch: 24 | loss: 0.0015420
	speed: 0.2916s/iter; left time: 9158.1214s
Epoch: 24 cost time: 128.98333644866943
Epoch: 24, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0000362
	speed: 0.6351s/iter; left time: 19871.6707s
	iters: 200, epoch: 25 | loss: 0.5203623
	speed: 0.3294s/iter; left time: 10275.0467s
	iters: 300, epoch: 25 | loss: 0.0035810
	speed: 0.3125s/iter; left time: 9714.1750s
	iters: 400, epoch: 25 | loss: 0.0002006
	speed: 0.2979s/iter; left time: 9232.2131s
Epoch: 25 cost time: 129.53785872459412
Epoch: 25, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0001267
	speed: 0.6399s/iter; left time: 19758.9946s
	iters: 200, epoch: 26 | loss: 0.0106350
	speed: 0.3265s/iter; left time: 10047.2939s
	iters: 300, epoch: 26 | loss: 0.0082298
	speed: 0.2973s/iter; left time: 9120.0986s
	iters: 400, epoch: 26 | loss: 0.0000142
	speed: 0.3137s/iter; left time: 9592.7287s
Epoch: 26 cost time: 130.3889229297638
Epoch: 26, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.115 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0003132
	speed: 0.6398s/iter; left time: 19491.0491s
	iters: 200, epoch: 27 | loss: 0.0025706
	speed: 0.3076s/iter; left time: 9338.7248s
	iters: 300, epoch: 27 | loss: 0.0003466
	speed: 0.3093s/iter; left time: 9360.0018s
	iters: 400, epoch: 27 | loss: 0.0000036
	speed: 0.3076s/iter; left time: 9279.4670s
Epoch: 27 cost time: 128.53058218955994
Epoch: 27, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.089 Vali Acc: 0.979 Test Loss: 0.089 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0000010
	speed: 0.6691s/iter; left time: 20106.3604s
	iters: 200, epoch: 28 | loss: 0.0000298
	speed: 0.3005s/iter; left time: 8998.7792s
	iters: 300, epoch: 28 | loss: 0.0000496
	speed: 0.3088s/iter; left time: 9216.6116s
	iters: 400, epoch: 28 | loss: 0.0000101
	speed: 0.3062s/iter; left time: 9110.5964s
Epoch: 28 cost time: 128.07077813148499
Epoch: 28, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0007146
	speed: 0.6500s/iter; left time: 19265.4216s
	iters: 200, epoch: 29 | loss: 0.0007700
	speed: 0.3082s/iter; left time: 9104.3243s
	iters: 300, epoch: 29 | loss: 0.0000045
	speed: 0.2979s/iter; left time: 8769.6339s
	iters: 400, epoch: 29 | loss: 0.0000024
	speed: 0.3028s/iter; left time: 8883.5469s
Epoch: 29 cost time: 127.25739431381226
Epoch: 29, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0117484
	speed: 0.6507s/iter; left time: 19016.8215s
	iters: 200, epoch: 30 | loss: 0.0004113
	speed: 0.3214s/iter; left time: 9360.3550s
	iters: 300, epoch: 30 | loss: 0.0000493
	speed: 0.3133s/iter; left time: 9092.3658s
	iters: 400, epoch: 30 | loss: 0.0000308
	speed: 0.3185s/iter; left time: 9212.7146s
Epoch: 30 cost time: 131.19090175628662
Epoch: 30, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0000254
	speed: 0.6579s/iter; left time: 18955.4035s
	iters: 200, epoch: 31 | loss: 0.0000309
	speed: 0.3282s/iter; left time: 9423.4096s
	iters: 300, epoch: 31 | loss: 0.0000440
	speed: 0.3204s/iter; left time: 9166.8614s
	iters: 400, epoch: 31 | loss: 0.0056836
	speed: 0.3065s/iter; left time: 8738.5175s
Epoch: 31 cost time: 131.38945698738098
Epoch: 31, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9804456571168713
model parameter : 462154
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.0171797
	speed: 0.3271s/iter; left time: 13478.0001s
	iters: 200, epoch: 1 | loss: 1.5406258
	speed: 0.3100s/iter; left time: 12741.2915s
	iters: 300, epoch: 1 | loss: 1.0387379
	speed: 0.3057s/iter; left time: 12534.4545s
	iters: 400, epoch: 1 | loss: 0.3864926
	speed: 0.2919s/iter; left time: 11939.7298s
Epoch: 1 cost time: 127.6067144870758
Epoch: 1, Steps: 413 | Train Loss: 1.438 Vali Loss: 0.299 Vali Acc: 0.925 Test Loss: 0.299 Test Acc: 0.925
Validation loss decreased (inf --> -0.924508).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5510314
	speed: 0.6266s/iter; left time: 25557.1200s
	iters: 200, epoch: 2 | loss: 0.2277164
	speed: 0.3078s/iter; left time: 12523.0384s
	iters: 300, epoch: 2 | loss: 0.2157446
	speed: 0.3098s/iter; left time: 12574.0418s
	iters: 400, epoch: 2 | loss: 0.1005142
	speed: 0.2905s/iter; left time: 11761.9845s
Epoch: 2 cost time: 126.03650331497192
Epoch: 2, Steps: 413 | Train Loss: 0.267 Vali Loss: 0.136 Vali Acc: 0.960 Test Loss: 0.136 Test Acc: 0.960
Validation loss decreased (-0.924508 --> -0.959980).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0172627
	speed: 0.6122s/iter; left time: 24719.4162s
	iters: 200, epoch: 3 | loss: 0.0619421
	speed: 0.2928s/iter; left time: 11794.2706s
	iters: 300, epoch: 3 | loss: 0.1232795
	speed: 0.2943s/iter; left time: 11822.7841s
	iters: 400, epoch: 3 | loss: 0.0738760
	speed: 0.3011s/iter; left time: 12064.6556s
Epoch: 3 cost time: 123.32546043395996
Epoch: 3, Steps: 413 | Train Loss: 0.126 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
Validation loss decreased (-0.959980 --> -0.981354).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0486286
	speed: 0.6391s/iter; left time: 25539.0006s
	iters: 200, epoch: 4 | loss: 0.0525654
	speed: 0.3128s/iter; left time: 12470.3977s
	iters: 300, epoch: 4 | loss: 0.0643194
	speed: 0.2909s/iter; left time: 11568.7179s
	iters: 400, epoch: 4 | loss: 0.1194079
	speed: 0.2945s/iter; left time: 11679.3166s
Epoch: 4 cost time: 124.65289163589478
Epoch: 4, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0683707
	speed: 0.6170s/iter; left time: 24402.2957s
	iters: 200, epoch: 5 | loss: 0.1024215
	speed: 0.2915s/iter; left time: 11498.7987s
	iters: 300, epoch: 5 | loss: 0.0342453
	speed: 0.2829s/iter; left time: 11130.8884s
	iters: 400, epoch: 5 | loss: 0.0452623
	speed: 0.2944s/iter; left time: 11556.3169s
Epoch: 5 cost time: 121.27963638305664
Epoch: 5, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.062 Vali Acc: 0.977 Test Loss: 0.062 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0026023
	speed: 0.6337s/iter; left time: 24801.9641s
	iters: 200, epoch: 6 | loss: 0.0083021
	speed: 0.2962s/iter; left time: 11564.3556s
	iters: 300, epoch: 6 | loss: 0.0929637
	speed: 0.2884s/iter; left time: 11228.6870s
	iters: 400, epoch: 6 | loss: 0.0068028
	speed: 0.2945s/iter; left time: 11437.9898s
Epoch: 6 cost time: 122.04893827438354
Epoch: 6, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.063 Vali Acc: 0.982 Test Loss: 0.063 Test Acc: 0.982
Validation loss decreased (-0.981354 --> -0.982264).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0026368
	speed: 0.6488s/iter; left time: 25123.8119s
	iters: 200, epoch: 7 | loss: 0.0008395
	speed: 0.2927s/iter; left time: 11305.7103s
	iters: 300, epoch: 7 | loss: 0.0117718
	speed: 0.2852s/iter; left time: 10988.2043s
	iters: 400, epoch: 7 | loss: 0.1085070
	speed: 0.2973s/iter; left time: 11423.6232s
Epoch: 7 cost time: 122.85293841362
Epoch: 7, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.079 Vali Acc: 0.971 Test Loss: 0.079 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0103659
	speed: 0.6264s/iter; left time: 23997.3407s
	iters: 200, epoch: 8 | loss: 0.0103734
	speed: 0.2968s/iter; left time: 11341.7461s
	iters: 300, epoch: 8 | loss: 0.0008101
	speed: 0.2969s/iter; left time: 11315.3090s
	iters: 400, epoch: 8 | loss: 0.0041014
	speed: 0.3114s/iter; left time: 11838.0175s
Epoch: 8 cost time: 123.80955839157104
Epoch: 8, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0014147
	speed: 0.6377s/iter; left time: 24165.8813s
	iters: 200, epoch: 9 | loss: 0.0149847
	speed: 0.2977s/iter; left time: 11250.5906s
	iters: 300, epoch: 9 | loss: 0.0250714
	speed: 0.2999s/iter; left time: 11304.3119s
	iters: 400, epoch: 9 | loss: 0.0011321
	speed: 0.3015s/iter; left time: 11336.4665s
Epoch: 9 cost time: 124.63211250305176
Epoch: 9, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.061 Vali Acc: 0.978 Test Loss: 0.061 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0788252
	speed: 0.6163s/iter; left time: 23101.6465s
	iters: 200, epoch: 10 | loss: 0.0006234
	speed: 0.2854s/iter; left time: 10669.9934s
	iters: 300, epoch: 10 | loss: 0.0964999
	speed: 0.3036s/iter; left time: 11319.6416s
	iters: 400, epoch: 10 | loss: 0.0077009
	speed: 0.3040s/iter; left time: 11304.4714s
Epoch: 10 cost time: 122.9567666053772
Epoch: 10, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.088 Vali Acc: 0.967 Test Loss: 0.088 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0308291
	speed: 0.6227s/iter; left time: 23085.8222s
	iters: 200, epoch: 11 | loss: 0.0215563
	speed: 0.3093s/iter; left time: 11434.4580s
	iters: 300, epoch: 11 | loss: 0.0024907
	speed: 0.3322s/iter; left time: 12247.3254s
	iters: 400, epoch: 11 | loss: 0.0449979
	speed: 0.3196s/iter; left time: 11750.2328s
Epoch: 11 cost time: 130.70557689666748
Epoch: 11, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0008832
	speed: 0.6342s/iter; left time: 23249.4224s
	iters: 200, epoch: 12 | loss: 0.0005195
	speed: 0.3151s/iter; left time: 11519.1027s
	iters: 300, epoch: 12 | loss: 0.0000386
	speed: 0.3183s/iter; left time: 11604.8231s
	iters: 400, epoch: 12 | loss: 0.0013254
	speed: 0.2947s/iter; left time: 10716.5090s
Epoch: 12 cost time: 128.70464706420898
Epoch: 12, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.076 Vali Acc: 0.975 Test Loss: 0.076 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0035881
	speed: 0.6159s/iter; left time: 22321.5718s
	iters: 200, epoch: 13 | loss: 0.0006335
	speed: 0.3016s/iter; left time: 10902.5063s
	iters: 300, epoch: 13 | loss: 0.0049795
	speed: 0.3215s/iter; left time: 11589.7791s
	iters: 400, epoch: 13 | loss: 0.0024737
	speed: 0.3132s/iter; left time: 11259.3516s
Epoch: 13 cost time: 128.21497583389282
Epoch: 13, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0007349
	speed: 0.6244s/iter; left time: 22372.5701s
	iters: 200, epoch: 14 | loss: 0.0014605
	speed: 0.3116s/iter; left time: 11132.4947s
	iters: 300, epoch: 14 | loss: 0.0592280
	speed: 0.3189s/iter; left time: 11363.6791s
	iters: 400, epoch: 14 | loss: 0.2337963
	speed: 0.3186s/iter; left time: 11321.9483s
Epoch: 14 cost time: 129.44160890579224
Epoch: 14, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0009256
	speed: 0.6501s/iter; left time: 23025.3240s
	iters: 200, epoch: 15 | loss: 0.0040462
	speed: 0.3118s/iter; left time: 11013.5828s
	iters: 300, epoch: 15 | loss: 0.0329613
	speed: 0.3092s/iter; left time: 10888.6232s
	iters: 400, epoch: 15 | loss: 0.0052684
	speed: 0.3201s/iter; left time: 11242.5497s
Epoch: 15 cost time: 131.26325011253357
Epoch: 15, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.080 Vali Acc: 0.979 Test Loss: 0.080 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0009047
	speed: 0.6529s/iter; left time: 22855.6772s
	iters: 200, epoch: 16 | loss: 0.0001492
	speed: 0.3015s/iter; left time: 10523.6538s
	iters: 300, epoch: 16 | loss: 0.0012947
	speed: 0.3097s/iter; left time: 10777.9623s
	iters: 400, epoch: 16 | loss: 0.0038865
	speed: 0.3170s/iter; left time: 11001.1555s
Epoch: 16 cost time: 127.10358572006226
Epoch: 16, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9822646657571623
model parameter : 462154
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.3060732
	speed: 0.3367s/iter; left time: 13871.8819s
	iters: 200, epoch: 1 | loss: 2.3012655
	speed: 0.3273s/iter; left time: 13454.0674s
	iters: 300, epoch: 1 | loss: 2.3009722
	speed: 0.3264s/iter; left time: 13381.4692s
	iters: 400, epoch: 1 | loss: 2.2994931
	speed: 0.3099s/iter; left time: 12674.2258s
Epoch: 1 cost time: 134.68510270118713
Epoch: 1, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (inf --> -0.100022).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3033891
	speed: 0.6833s/iter; left time: 27872.1029s
	iters: 200, epoch: 2 | loss: 2.3056471
	speed: 0.3219s/iter; left time: 13098.2609s
	iters: 300, epoch: 2 | loss: 2.3015451
	speed: 0.3299s/iter; left time: 13390.6802s
	iters: 400, epoch: 2 | loss: 2.3011017
	speed: 0.3227s/iter; left time: 13064.6742s
Epoch: 2 cost time: 135.3211989402771
Epoch: 2, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3039365
	speed: 0.6465s/iter; left time: 26101.8506s
	iters: 200, epoch: 3 | loss: 2.3030882
	speed: 0.3292s/iter; left time: 13257.4390s
	iters: 300, epoch: 3 | loss: 2.3013031
	speed: 0.3398s/iter; left time: 13649.9249s
	iters: 400, epoch: 3 | loss: 2.3053372
	speed: 0.3285s/iter; left time: 13164.0444s
Epoch: 3 cost time: 135.0281548500061
Epoch: 3, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3025427
	speed: 0.6631s/iter; left time: 26500.2596s
	iters: 200, epoch: 4 | loss: 2.3029201
	speed: 0.3258s/iter; left time: 12986.5456s
	iters: 300, epoch: 4 | loss: 2.3016398
	speed: 0.3261s/iter; left time: 12967.3865s
	iters: 400, epoch: 4 | loss: 2.3034129
	speed: 0.3282s/iter; left time: 13016.0799s
Epoch: 4 cost time: 134.6038043498993
Epoch: 4, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.3038342
	speed: 0.6753s/iter; left time: 26706.6551s
	iters: 200, epoch: 5 | loss: 2.3014057
	speed: 0.3332s/iter; left time: 13143.3867s
	iters: 300, epoch: 5 | loss: 2.3017430
	speed: 0.3366s/iter; left time: 13246.1294s
	iters: 400, epoch: 5 | loss: 2.3036444
	speed: 0.3273s/iter; left time: 12848.1309s
Epoch: 5 cost time: 136.5828664302826
Epoch: 5, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.3026338
	speed: 0.6822s/iter; left time: 26697.2165s
	iters: 200, epoch: 6 | loss: 2.2996690
	speed: 0.3357s/iter; left time: 13103.1081s
	iters: 300, epoch: 6 | loss: 2.3020391
	speed: 0.3386s/iter; left time: 13183.1038s
	iters: 400, epoch: 6 | loss: 2.3029311
	speed: 0.3268s/iter; left time: 12690.4983s
Epoch: 6 cost time: 138.77207469940186
Epoch: 6, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.3014054
	speed: 0.6580s/iter; left time: 25478.7471s
	iters: 200, epoch: 7 | loss: 2.3012362
	speed: 0.3268s/iter; left time: 12623.2142s
	iters: 300, epoch: 7 | loss: 2.3015122
	speed: 0.3374s/iter; left time: 12998.3022s
	iters: 400, epoch: 7 | loss: 2.3039606
	speed: 0.3306s/iter; left time: 12701.2499s
Epoch: 7 cost time: 135.61985659599304
Epoch: 7, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.3019085
	speed: 0.6860s/iter; left time: 26280.3556s
	iters: 200, epoch: 8 | loss: 2.3082328
	speed: 0.3276s/iter; left time: 12516.1946s
	iters: 300, epoch: 8 | loss: 2.3018320
	speed: 0.3360s/iter; left time: 12805.3605s
	iters: 400, epoch: 8 | loss: 2.3014016
	speed: 0.3371s/iter; left time: 12812.8908s
Epoch: 8 cost time: 139.12253737449646
Epoch: 8, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.3005638
	speed: 0.6559s/iter; left time: 24858.1086s
	iters: 200, epoch: 9 | loss: 2.3048410
	speed: 0.3007s/iter; left time: 11365.0441s
	iters: 300, epoch: 9 | loss: 2.3062038
	speed: 0.2995s/iter; left time: 11288.8453s
	iters: 400, epoch: 9 | loss: 2.3028419
	speed: 0.3081s/iter; left time: 11584.3945s
Epoch: 9 cost time: 128.03854656219482
Epoch: 9, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 2.3001809
	speed: 0.6507s/iter; left time: 24389.1852s
	iters: 200, epoch: 10 | loss: 2.3043900
	speed: 0.2913s/iter; left time: 10889.0558s
	iters: 300, epoch: 10 | loss: 2.3000016
	speed: 0.3140s/iter; left time: 11705.9835s
	iters: 400, epoch: 10 | loss: 2.3028207
	speed: 0.3092s/iter; left time: 11497.1078s
Epoch: 10 cost time: 125.47056221961975
Epoch: 10, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 2.3022878
	speed: 0.5991s/iter; left time: 22211.0652s
	iters: 200, epoch: 11 | loss: 2.3035483
	speed: 0.2857s/iter; left time: 10561.8801s
	iters: 300, epoch: 11 | loss: 2.3032129
	speed: 0.3002s/iter; left time: 11068.0607s
	iters: 400, epoch: 11 | loss: 2.3057485
	speed: 0.3095s/iter; left time: 11382.2733s
Epoch: 11 cost time: 122.33834147453308
Epoch: 11, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 2.3040442
	speed: 0.5680s/iter; left time: 20823.4519s
	iters: 200, epoch: 12 | loss: 2.3072324
	speed: 0.3072s/iter; left time: 11231.6300s
	iters: 300, epoch: 12 | loss: 2.3015058
	speed: 0.3109s/iter; left time: 11336.5670s
	iters: 400, epoch: 12 | loss: 2.3044434
	speed: 0.2986s/iter; left time: 10854.9493s
Epoch: 12 cost time: 123.92478322982788
Epoch: 12, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 2.3000555
	speed: 0.5959s/iter; left time: 21597.3096s
	iters: 200, epoch: 13 | loss: 2.3044722
	speed: 0.3088s/iter; left time: 11161.3933s
	iters: 300, epoch: 13 | loss: 2.3040237
	speed: 0.2931s/iter; left time: 10566.3936s
	iters: 400, epoch: 13 | loss: 2.3037536
	speed: 0.2680s/iter; left time: 9634.8346s
Epoch: 13 cost time: 120.23698353767395
Epoch: 13, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 2.2983210
	speed: 0.5854s/iter; left time: 20975.9182s
	iters: 200, epoch: 14 | loss: 2.3015637
	speed: 0.2986s/iter; left time: 10668.7439s
	iters: 300, epoch: 14 | loss: 2.3049831
	speed: 0.2953s/iter; left time: 10521.0147s
	iters: 400, epoch: 14 | loss: 2.3025198
	speed: 0.2911s/iter; left time: 10344.4764s
Epoch: 14 cost time: 123.05230188369751
Epoch: 14, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 2.3008833
	speed: 0.6001s/iter; left time: 21255.0224s
	iters: 200, epoch: 15 | loss: 2.3064351
	speed: 0.3175s/iter; left time: 11214.1572s
	iters: 300, epoch: 15 | loss: 2.2985649
	speed: 0.2871s/iter; left time: 10111.8519s
	iters: 400, epoch: 15 | loss: 2.3032675
	speed: 0.2892s/iter; left time: 10155.3759s
Epoch: 15 cost time: 123.72593879699707
Epoch: 15, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 2.3024828
	speed: 0.6087s/iter; left time: 21309.7500s
	iters: 200, epoch: 16 | loss: 2.3028493
	speed: 0.2880s/iter; left time: 10054.1285s
	iters: 300, epoch: 16 | loss: 2.3032935
	speed: 0.2802s/iter; left time: 9751.8159s
	iters: 400, epoch: 16 | loss: 2.3015041
	speed: 0.3013s/iter; left time: 10456.4146s
Epoch: 16 cost time: 121.21568012237549
Epoch: 16, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.10004547521600728
model parameter : 462154
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         47                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1553729
	speed: 0.3100s/iter; left time: 12771.8942s
	iters: 200, epoch: 1 | loss: 0.2787449
	speed: 0.3045s/iter; left time: 12513.6898s
	iters: 300, epoch: 1 | loss: 0.2718597
	speed: 0.2916s/iter; left time: 11956.3725s
	iters: 400, epoch: 1 | loss: 0.2310863
	speed: 0.3207s/iter; left time: 13116.4926s
Epoch: 1 cost time: 127.0892539024353
Epoch: 1, Steps: 413 | Train Loss: 0.789 Vali Loss: 0.137 Vali Acc: 0.966 Test Loss: 0.137 Test Acc: 0.966
Validation loss decreased (inf --> -0.965892).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2902168
	speed: 0.6137s/iter; left time: 25032.2087s
	iters: 200, epoch: 2 | loss: 0.0583942
	speed: 0.2885s/iter; left time: 11737.5341s
	iters: 300, epoch: 2 | loss: 0.0401321
	speed: 0.3009s/iter; left time: 12211.0932s
	iters: 400, epoch: 2 | loss: 0.1918765
	speed: 0.3109s/iter; left time: 12587.9209s
Epoch: 2 cost time: 123.47500491142273
Epoch: 2, Steps: 413 | Train Loss: 0.135 Vali Loss: 0.062 Vali Acc: 0.982 Test Loss: 0.062 Test Acc: 0.982
Validation loss decreased (-0.965892 --> -0.982264).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0549698
	speed: 0.6056s/iter; left time: 24450.2843s
	iters: 200, epoch: 3 | loss: 0.1405175
	speed: 0.2961s/iter; left time: 11924.0408s
	iters: 300, epoch: 3 | loss: 0.0140959
	speed: 0.2989s/iter; left time: 12007.1952s
	iters: 400, epoch: 3 | loss: 0.0142339
	speed: 0.2927s/iter; left time: 11729.9358s
Epoch: 3 cost time: 122.97136664390564
Epoch: 3, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.053 Vali Acc: 0.983 Test Loss: 0.053 Test Acc: 0.983
Validation loss decreased (-0.982264 --> -0.983174).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0475403
	speed: 0.5998s/iter; left time: 23970.3604s
	iters: 200, epoch: 4 | loss: 0.0928714
	speed: 0.2985s/iter; left time: 11897.0694s
	iters: 300, epoch: 4 | loss: 0.0160472
	speed: 0.2800s/iter; left time: 11131.7303s
	iters: 400, epoch: 4 | loss: 0.0300354
	speed: 0.2770s/iter; left time: 10985.0257s
Epoch: 4 cost time: 119.30253648757935
Epoch: 4, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.040 Vali Acc: 0.988 Test Loss: 0.040 Test Acc: 0.988
Validation loss decreased (-0.983174 --> -0.988176).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0082128
	speed: 0.5989s/iter; left time: 23685.7470s
	iters: 200, epoch: 5 | loss: 0.0056987
	speed: 0.2926s/iter; left time: 11543.2780s
	iters: 300, epoch: 5 | loss: 0.0328508
	speed: 0.2918s/iter; left time: 11480.9648s
	iters: 400, epoch: 5 | loss: 0.0047493
	speed: 0.2844s/iter; left time: 11161.1553s
Epoch: 5 cost time: 121.12911081314087
Epoch: 5, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.080 Vali Acc: 0.975 Test Loss: 0.080 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0005935
	speed: 0.6190s/iter; left time: 24225.3494s
	iters: 200, epoch: 6 | loss: 0.0024862
	speed: 0.2873s/iter; left time: 11213.8996s
	iters: 300, epoch: 6 | loss: 0.0832395
	speed: 0.2896s/iter; left time: 11275.4136s
	iters: 400, epoch: 6 | loss: 0.0349088
	speed: 0.2886s/iter; left time: 11206.5010s
Epoch: 6 cost time: 120.83787941932678
Epoch: 6, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.039 Vali Acc: 0.990 Test Loss: 0.039 Test Acc: 0.990
Validation loss decreased (-0.988176 --> -0.989995).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0074893
	speed: 0.6075s/iter; left time: 23523.8214s
	iters: 200, epoch: 7 | loss: 0.0031348
	speed: 0.3063s/iter; left time: 11828.6431s
	iters: 300, epoch: 7 | loss: 0.0007841
	speed: 0.2968s/iter; left time: 11435.5520s
	iters: 400, epoch: 7 | loss: 0.0010902
	speed: 0.3016s/iter; left time: 11588.4301s
Epoch: 7 cost time: 125.3401894569397
Epoch: 7, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.057 Vali Acc: 0.982 Test Loss: 0.057 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0059858
	speed: 0.6115s/iter; left time: 23425.1900s
	iters: 200, epoch: 8 | loss: 0.0133267
	speed: 0.2862s/iter; left time: 10936.0749s
	iters: 300, epoch: 8 | loss: 0.1392202
	speed: 0.2899s/iter; left time: 11048.8052s
	iters: 400, epoch: 8 | loss: 0.0257117
	speed: 0.3081s/iter; left time: 11711.8769s
Epoch: 8 cost time: 122.83856296539307
Epoch: 8, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.040 Vali Acc: 0.987 Test Loss: 0.040 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0021212
	speed: 0.6028s/iter; left time: 22844.9898s
	iters: 200, epoch: 9 | loss: 0.0018068
	speed: 0.2990s/iter; left time: 11302.7929s
	iters: 300, epoch: 9 | loss: 0.0007773
	speed: 0.3082s/iter; left time: 11620.0426s
	iters: 400, epoch: 9 | loss: 0.0015409
	speed: 0.2998s/iter; left time: 11271.9672s
Epoch: 9 cost time: 124.47374033927917
Epoch: 9, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.058 Vali Acc: 0.984 Test Loss: 0.058 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0013983
	speed: 0.5974s/iter; left time: 22394.5897s
	iters: 200, epoch: 10 | loss: 0.0003838
	speed: 0.2856s/iter; left time: 10677.3015s
	iters: 300, epoch: 10 | loss: 0.0040441
	speed: 0.2973s/iter; left time: 11085.9682s
	iters: 400, epoch: 10 | loss: 0.0026939
	speed: 0.2968s/iter; left time: 11035.1033s
Epoch: 10 cost time: 121.23164367675781
Epoch: 10, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.075 Vali Acc: 0.979 Test Loss: 0.075 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0088868
	speed: 0.6024s/iter; left time: 22330.3234s
	iters: 200, epoch: 11 | loss: 0.0001330
	speed: 0.3037s/iter; left time: 11227.8515s
	iters: 300, epoch: 11 | loss: 0.0021874
	speed: 0.2939s/iter; left time: 10836.7765s
	iters: 400, epoch: 11 | loss: 0.0027661
	speed: 0.2852s/iter; left time: 10486.7881s
Epoch: 11 cost time: 121.93738961219788
Epoch: 11, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.058 Vali Acc: 0.983 Test Loss: 0.058 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0037446
	speed: 0.5989s/iter; left time: 21953.9547s
	iters: 200, epoch: 12 | loss: 0.0008878
	speed: 0.3029s/iter; left time: 11073.2127s
	iters: 300, epoch: 12 | loss: 0.0001293
	speed: 0.3041s/iter; left time: 11086.1153s
	iters: 400, epoch: 12 | loss: 0.0098579
	speed: 0.2965s/iter; left time: 10780.9865s
Epoch: 12 cost time: 125.1887149810791
Epoch: 12, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.044 Vali Acc: 0.985 Test Loss: 0.044 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0038147
	speed: 0.6212s/iter; left time: 22514.1990s
	iters: 200, epoch: 13 | loss: 0.0002011
	speed: 0.3152s/iter; left time: 11393.5624s
	iters: 300, epoch: 13 | loss: 0.0001826
	speed: 0.3063s/iter; left time: 11039.1894s
	iters: 400, epoch: 13 | loss: 0.0017097
	speed: 0.2975s/iter; left time: 10695.3471s
Epoch: 13 cost time: 127.21418261528015
Epoch: 13, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.067 Vali Acc: 0.981 Test Loss: 0.067 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0028332
	speed: 0.5902s/iter; left time: 21147.9907s
	iters: 200, epoch: 14 | loss: 0.6368278
	speed: 0.2998s/iter; left time: 10713.6125s
	iters: 300, epoch: 14 | loss: 0.0004529
	speed: 0.3119s/iter; left time: 11113.2624s
	iters: 400, epoch: 14 | loss: 0.0000432
	speed: 0.3105s/iter; left time: 11031.3216s
Epoch: 14 cost time: 125.3126277923584
Epoch: 14, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.058 Vali Acc: 0.986 Test Loss: 0.058 Test Acc: 0.986
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0328265
	speed: 0.6044s/iter; left time: 21408.5704s
	iters: 200, epoch: 15 | loss: 0.0000666
	speed: 0.3014s/iter; left time: 10643.8234s
	iters: 300, epoch: 15 | loss: 0.0000591
	speed: 0.3123s/iter; left time: 10999.9374s
	iters: 400, epoch: 15 | loss: 0.0002431
	speed: 0.3017s/iter; left time: 10594.2072s
Epoch: 15 cost time: 125.3806140422821
Epoch: 15, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.076 Vali Acc: 0.984 Test Loss: 0.076 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0002010
	speed: 0.6260s/iter; left time: 21913.5330s
	iters: 200, epoch: 16 | loss: 0.0061456
	speed: 0.2951s/iter; left time: 10301.2304s
	iters: 300, epoch: 16 | loss: 0.0002773
	speed: 0.2899s/iter; left time: 10091.4113s
	iters: 400, epoch: 16 | loss: 0.0152928
	speed: 0.2912s/iter; left time: 10105.1499s
Epoch: 16 cost time: 124.08493065834045
Epoch: 16, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.060 Vali Acc: 0.985 Test Loss: 0.060 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9899954524783993
model parameter : 265546
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         38                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.2714970
	speed: 0.3153s/iter; left time: 12990.2499s
	iters: 200, epoch: 1 | loss: 0.4206973
	speed: 0.3022s/iter; left time: 12422.1103s
	iters: 300, epoch: 1 | loss: 0.3076337
	speed: 0.3106s/iter; left time: 12735.5762s
	iters: 400, epoch: 1 | loss: 0.2434660
	speed: 0.3106s/iter; left time: 12703.7526s
Epoch: 1 cost time: 128.68119502067566
Epoch: 1, Steps: 413 | Train Loss: 0.847 Vali Loss: 0.147 Vali Acc: 0.965 Test Loss: 0.147 Test Acc: 0.965
Validation loss decreased (inf --> -0.964528).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2894152
	speed: 0.6146s/iter; left time: 25068.9307s
	iters: 200, epoch: 2 | loss: 0.0575364
	speed: 0.3049s/iter; left time: 12406.9016s
	iters: 300, epoch: 2 | loss: 0.0275356
	speed: 0.2913s/iter; left time: 11821.7934s
	iters: 400, epoch: 2 | loss: 0.1358917
	speed: 0.3136s/iter; left time: 12695.0284s
Epoch: 2 cost time: 125.73272490501404
Epoch: 2, Steps: 413 | Train Loss: 0.147 Vali Loss: 0.065 Vali Acc: 0.984 Test Loss: 0.065 Test Acc: 0.984
Validation loss decreased (-0.964528 --> -0.983628).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0440542
	speed: 0.6153s/iter; left time: 24842.8263s
	iters: 200, epoch: 3 | loss: 0.1336644
	speed: 0.3090s/iter; left time: 12443.2498s
	iters: 300, epoch: 3 | loss: 0.0098423
	speed: 0.3196s/iter; left time: 12839.9182s
	iters: 400, epoch: 3 | loss: 0.0083833
	speed: 0.3161s/iter; left time: 12666.5474s
Epoch: 3 cost time: 129.31270360946655
Epoch: 3, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.056 Vali Acc: 0.984 Test Loss: 0.056 Test Acc: 0.984
Validation loss decreased (-0.983628 --> -0.983628).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0381366
	speed: 0.5955s/iter; left time: 23798.6606s
	iters: 200, epoch: 4 | loss: 0.0259986
	speed: 0.2861s/iter; left time: 11406.0336s
	iters: 300, epoch: 4 | loss: 0.0050322
	speed: 0.3072s/iter; left time: 12216.1702s
	iters: 400, epoch: 4 | loss: 0.0478703
	speed: 0.3140s/iter; left time: 12451.9184s
Epoch: 4 cost time: 123.8006842136383
Epoch: 4, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.037 Vali Acc: 0.988 Test Loss: 0.037 Test Acc: 0.988
Validation loss decreased (-0.983628 --> -0.988176).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0104907
	speed: 0.6169s/iter; left time: 24396.9013s
	iters: 200, epoch: 5 | loss: 0.0032713
	speed: 0.3209s/iter; left time: 12660.6925s
	iters: 300, epoch: 5 | loss: 0.0194210
	speed: 0.3136s/iter; left time: 12340.9218s
	iters: 400, epoch: 5 | loss: 0.0019841
	speed: 0.2967s/iter; left time: 11644.4642s
Epoch: 5 cost time: 128.61490273475647
Epoch: 5, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.046 Vali Acc: 0.987 Test Loss: 0.046 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0007795
	speed: 0.5979s/iter; left time: 23398.8795s
	iters: 200, epoch: 6 | loss: 0.0007647
	speed: 0.2945s/iter; left time: 11496.8804s
	iters: 300, epoch: 6 | loss: 0.0093453
	speed: 0.3078s/iter; left time: 11982.6433s
	iters: 400, epoch: 6 | loss: 0.0191460
	speed: 0.2987s/iter; left time: 11601.4998s
Epoch: 6 cost time: 124.22654628753662
Epoch: 6, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.039 Vali Acc: 0.988 Test Loss: 0.039 Test Acc: 0.988
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0128258
	speed: 0.6412s/iter; left time: 24828.3791s
	iters: 200, epoch: 7 | loss: 0.0034843
	speed: 0.3255s/iter; left time: 12570.3564s
	iters: 300, epoch: 7 | loss: 0.0026471
	speed: 0.3071s/iter; left time: 11831.0377s
	iters: 400, epoch: 7 | loss: 0.0095024
	speed: 0.3093s/iter; left time: 11884.9734s
Epoch: 7 cost time: 130.75493931770325
Epoch: 7, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.041 Vali Acc: 0.985 Test Loss: 0.041 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0064880
	speed: 0.6115s/iter; left time: 23424.9537s
	iters: 200, epoch: 8 | loss: 0.0048113
	speed: 0.3119s/iter; left time: 11916.4519s
	iters: 300, epoch: 8 | loss: 0.0064657
	speed: 0.3071s/iter; left time: 11703.4126s
	iters: 400, epoch: 8 | loss: 0.0377292
	speed: 0.3234s/iter; left time: 12291.3266s
Epoch: 8 cost time: 128.48747992515564
Epoch: 8, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.041 Vali Acc: 0.987 Test Loss: 0.041 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0158322
	speed: 0.6252s/iter; left time: 23694.6699s
	iters: 200, epoch: 9 | loss: 0.0020160
	speed: 0.3057s/iter; left time: 11554.5659s
	iters: 300, epoch: 9 | loss: 0.1680905
	speed: 0.3154s/iter; left time: 11888.3014s
	iters: 400, epoch: 9 | loss: 0.0002856
	speed: 0.3222s/iter; left time: 12114.1786s
Epoch: 9 cost time: 128.9536736011505
Epoch: 9, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.080 Vali Acc: 0.972 Test Loss: 0.080 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.1547981
	speed: 0.6152s/iter; left time: 23061.6094s
	iters: 200, epoch: 10 | loss: 0.0004488
	speed: 0.3220s/iter; left time: 12038.3091s
	iters: 300, epoch: 10 | loss: 0.0172384
	speed: 0.3142s/iter; left time: 11713.5013s
	iters: 400, epoch: 10 | loss: 0.0127660
	speed: 0.2978s/iter; left time: 11075.1718s
Epoch: 10 cost time: 128.6082637310028
Epoch: 10, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.048 Vali Acc: 0.987 Test Loss: 0.048 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0001717
	speed: 0.6083s/iter; left time: 22549.2528s
	iters: 200, epoch: 11 | loss: 0.0006116
	speed: 0.3024s/iter; left time: 11179.0850s
	iters: 300, epoch: 11 | loss: 0.0044239
	speed: 0.3046s/iter; left time: 11229.8387s
	iters: 400, epoch: 11 | loss: 0.0023637
	speed: 0.3137s/iter; left time: 11535.8336s
Epoch: 11 cost time: 126.74769687652588
Epoch: 11, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.039 Vali Acc: 0.989 Test Loss: 0.039 Test Acc: 0.989
Validation loss decreased (-0.988176 --> -0.989086).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0042279
	speed: 0.6544s/iter; left time: 23988.2941s
	iters: 200, epoch: 12 | loss: 0.0003349
	speed: 0.2952s/iter; left time: 10793.0874s
	iters: 300, epoch: 12 | loss: 0.0021049
	speed: 0.3121s/iter; left time: 11378.8865s
	iters: 400, epoch: 12 | loss: 0.0000328
	speed: 0.3055s/iter; left time: 11107.6097s
Epoch: 12 cost time: 128.05269312858582
Epoch: 12, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0011328
	speed: 0.6283s/iter; left time: 22773.6809s
	iters: 200, epoch: 13 | loss: 0.0002142
	speed: 0.3059s/iter; left time: 11058.0579s
	iters: 300, epoch: 13 | loss: 0.0000340
	speed: 0.3154s/iter; left time: 11369.8509s
	iters: 400, epoch: 13 | loss: 0.0034092
	speed: 0.3299s/iter; left time: 11858.5145s
Epoch: 13 cost time: 130.8068814277649
Epoch: 13, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0012794
	speed: 0.6292s/iter; left time: 22544.8630s
	iters: 200, epoch: 14 | loss: 0.3726593
	speed: 0.3055s/iter; left time: 10917.3734s
	iters: 300, epoch: 14 | loss: 0.0023645
	speed: 0.2962s/iter; left time: 10553.5542s
	iters: 400, epoch: 14 | loss: 0.0016956
	speed: 0.3003s/iter; left time: 10670.6550s
Epoch: 14 cost time: 125.35024428367615
Epoch: 14, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.064 Vali Acc: 0.979 Test Loss: 0.064 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0002210
	speed: 0.6237s/iter; left time: 22089.4822s
	iters: 200, epoch: 15 | loss: 0.0008942
	speed: 0.3092s/iter; left time: 10921.2933s
	iters: 300, epoch: 15 | loss: 0.0014800
	speed: 0.2978s/iter; left time: 10487.8593s
	iters: 400, epoch: 15 | loss: 0.0124426
	speed: 0.2995s/iter; left time: 10517.0533s
Epoch: 15 cost time: 126.45460486412048
Epoch: 15, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.051 Vali Acc: 0.984 Test Loss: 0.051 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0001268
	speed: 0.6025s/iter; left time: 21091.4906s
	iters: 200, epoch: 16 | loss: 0.0004072
	speed: 0.2962s/iter; left time: 10339.8672s
	iters: 300, epoch: 16 | loss: 0.0038467
	speed: 0.2987s/iter; left time: 10395.3454s
	iters: 400, epoch: 16 | loss: 0.0000527
	speed: 0.2933s/iter; left time: 10177.9311s
Epoch: 16 cost time: 123.40872645378113
Epoch: 16, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.053 Vali Acc: 0.987 Test Loss: 0.053 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0001950
	speed: 0.6283s/iter; left time: 21736.1798s
	iters: 200, epoch: 17 | loss: 0.0009070
	speed: 0.3011s/iter; left time: 10385.3888s
	iters: 300, epoch: 17 | loss: 0.0000444
	speed: 0.2920s/iter; left time: 10043.5919s
	iters: 400, epoch: 17 | loss: 0.0003338
	speed: 0.2964s/iter; left time: 10162.8675s
Epoch: 17 cost time: 123.89591217041016
Epoch: 17, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.041 Vali Acc: 0.988 Test Loss: 0.041 Test Acc: 0.988
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0001568
	speed: 0.6187s/iter; left time: 21147.9956s
	iters: 200, epoch: 18 | loss: 0.0000083
	speed: 0.3079s/iter; left time: 10491.7155s
	iters: 300, epoch: 18 | loss: 0.0100056
	speed: 0.2974s/iter; left time: 10106.6892s
	iters: 400, epoch: 18 | loss: 0.0077113
	speed: 0.2954s/iter; left time: 10007.1658s
Epoch: 18 cost time: 124.97316265106201
Epoch: 18, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0043296
	speed: 0.6167s/iter; left time: 20824.2578s
	iters: 200, epoch: 19 | loss: 0.0013371
	speed: 0.3166s/iter; left time: 10658.6479s
	iters: 300, epoch: 19 | loss: 0.0006252
	speed: 0.3135s/iter; left time: 10522.2322s
	iters: 400, epoch: 19 | loss: 0.0011992
	speed: 0.3088s/iter; left time: 10334.1848s
Epoch: 19 cost time: 128.68187522888184
Epoch: 19, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.056 Vali Acc: 0.986 Test Loss: 0.056 Test Acc: 0.986
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0005290
	speed: 0.6098s/iter; left time: 20340.6739s
	iters: 200, epoch: 20 | loss: 0.0001679
	speed: 0.3202s/iter; left time: 10649.0554s
	iters: 300, epoch: 20 | loss: 0.0001959
	speed: 0.3210s/iter; left time: 10643.3601s
	iters: 400, epoch: 20 | loss: 0.0028904
	speed: 0.3045s/iter; left time: 10065.3199s
Epoch: 20 cost time: 129.02270030975342
Epoch: 20, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.060 Vali Acc: 0.984 Test Loss: 0.060 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0000163
	speed: 0.6267s/iter; left time: 20643.5085s
	iters: 200, epoch: 21 | loss: 0.0001101
	speed: 0.3029s/iter; left time: 9947.2443s
	iters: 300, epoch: 21 | loss: 0.0033176
	speed: 0.3047s/iter; left time: 9976.2594s
	iters: 400, epoch: 21 | loss: 0.0001391
	speed: 0.3185s/iter; left time: 10394.9318s
Epoch: 21 cost time: 127.83757853507996
Epoch: 21, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.056 Vali Acc: 0.986 Test Loss: 0.056 Test Acc: 0.986
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9890859481582538
model parameter : 265546
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         28                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.4640353
	speed: 0.3075s/iter; left time: 12669.3569s
	iters: 200, epoch: 1 | loss: 0.5814128
	speed: 0.2898s/iter; left time: 11911.7995s
	iters: 300, epoch: 1 | loss: 0.3878355
	speed: 0.3060s/iter; left time: 12548.3200s
	iters: 400, epoch: 1 | loss: 0.3314727
	speed: 0.3088s/iter; left time: 12630.2535s
Epoch: 1 cost time: 125.35294079780579
Epoch: 1, Steps: 413 | Train Loss: 0.937 Vali Loss: 0.182 Vali Acc: 0.957 Test Loss: 0.182 Test Acc: 0.957
Validation loss decreased (inf --> -0.957251).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3218067
	speed: 0.5879s/iter; left time: 23978.1390s
	iters: 200, epoch: 2 | loss: 0.0601609
	speed: 0.2954s/iter; left time: 12018.9952s
	iters: 300, epoch: 2 | loss: 0.0311238
	speed: 0.2777s/iter; left time: 11270.1964s
	iters: 400, epoch: 2 | loss: 0.0718093
	speed: 0.2877s/iter; left time: 11649.9731s
Epoch: 2 cost time: 119.60374736785889
Epoch: 2, Steps: 413 | Train Loss: 0.160 Vali Loss: 0.069 Vali Acc: 0.982 Test Loss: 0.069 Test Acc: 0.982
Validation loss decreased (-0.957251 --> -0.981809).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0615952
	speed: 0.6029s/iter; left time: 24341.6428s
	iters: 200, epoch: 3 | loss: 0.1238300
	speed: 0.2919s/iter; left time: 11756.2503s
	iters: 300, epoch: 3 | loss: 0.0136878
	speed: 0.2853s/iter; left time: 11461.6980s
	iters: 400, epoch: 3 | loss: 0.0653484
	speed: 0.3000s/iter; left time: 12021.5744s
Epoch: 3 cost time: 121.6196825504303
Epoch: 3, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.059 Vali Acc: 0.980 Test Loss: 0.059 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0141113
	speed: 0.6386s/iter; left time: 25519.5257s
	iters: 200, epoch: 4 | loss: 0.0745530
	speed: 0.2919s/iter; left time: 11634.9705s
	iters: 300, epoch: 4 | loss: 0.0033011
	speed: 0.2958s/iter; left time: 11759.9968s
	iters: 400, epoch: 4 | loss: 0.0425855
	speed: 0.2930s/iter; left time: 11619.3015s
Epoch: 4 cost time: 123.29415512084961
Epoch: 4, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.047 Vali Acc: 0.985 Test Loss: 0.047 Test Acc: 0.985
Validation loss decreased (-0.981809 --> -0.984538).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0097955
	speed: 0.5978s/iter; left time: 23642.2652s
	iters: 200, epoch: 5 | loss: 0.0125393
	speed: 0.3038s/iter; left time: 11983.3799s
	iters: 300, epoch: 5 | loss: 0.0576242
	speed: 0.2961s/iter; left time: 11650.6206s
	iters: 400, epoch: 5 | loss: 0.0092118
	speed: 0.2872s/iter; left time: 11273.4967s
Epoch: 5 cost time: 122.46004056930542
Epoch: 5, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.045 Vali Acc: 0.985 Test Loss: 0.045 Test Acc: 0.985
Validation loss decreased (-0.984538 --> -0.984993).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0022836
	speed: 0.6083s/iter; left time: 23805.6424s
	iters: 200, epoch: 6 | loss: 0.0003782
	speed: 0.2883s/iter; left time: 11252.2226s
	iters: 300, epoch: 6 | loss: 0.0280927
	speed: 0.2937s/iter; left time: 11435.5917s
	iters: 400, epoch: 6 | loss: 0.0079073
	speed: 0.2970s/iter; left time: 11534.8650s
Epoch: 6 cost time: 123.21095442771912
Epoch: 6, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.036 Vali Acc: 0.988 Test Loss: 0.036 Test Acc: 0.988
Validation loss decreased (-0.984993 --> -0.988176).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0041893
	speed: 0.5869s/iter; left time: 22726.6432s
	iters: 200, epoch: 7 | loss: 0.0411010
	speed: 0.2934s/iter; left time: 11331.1901s
	iters: 300, epoch: 7 | loss: 0.0008371
	speed: 0.3071s/iter; left time: 11829.2616s
	iters: 400, epoch: 7 | loss: 0.0012631
	speed: 0.2923s/iter; left time: 11231.0374s
Epoch: 7 cost time: 122.02473068237305
Epoch: 7, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.038 Vali Acc: 0.990 Test Loss: 0.038 Test Acc: 0.990
Validation loss decreased (-0.988176 --> -0.989540).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0003240
	speed: 0.5952s/iter; left time: 22800.5785s
	iters: 200, epoch: 8 | loss: 0.0059685
	speed: 0.3224s/iter; left time: 12318.9345s
	iters: 300, epoch: 8 | loss: 0.0017325
	speed: 0.3031s/iter; left time: 11552.0493s
	iters: 400, epoch: 8 | loss: 0.0690454
	speed: 0.2865s/iter; left time: 10889.7609s
Epoch: 8 cost time: 124.47910785675049
Epoch: 8, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.062 Vali Acc: 0.980 Test Loss: 0.062 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0126164
	speed: 0.5800s/iter; left time: 21981.3519s
	iters: 200, epoch: 9 | loss: 0.0284565
	speed: 0.3037s/iter; left time: 11478.3244s
	iters: 300, epoch: 9 | loss: 0.0015437
	speed: 0.3028s/iter; left time: 11413.4866s
	iters: 400, epoch: 9 | loss: 0.0022292
	speed: 0.2914s/iter; left time: 10954.6296s
Epoch: 9 cost time: 122.98000240325928
Epoch: 9, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0077898
	speed: 0.5965s/iter; left time: 22360.4050s
	iters: 200, epoch: 10 | loss: 0.0003147
	speed: 0.3002s/iter; left time: 11222.3204s
	iters: 300, epoch: 10 | loss: 0.0094406
	speed: 0.3034s/iter; left time: 11310.2133s
	iters: 400, epoch: 10 | loss: 0.4029311
	speed: 0.2967s/iter; left time: 11032.7262s
Epoch: 10 cost time: 124.37999176979065
Epoch: 10, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0228187
	speed: 0.5931s/iter; left time: 21985.8619s
	iters: 200, epoch: 11 | loss: 0.0013912
	speed: 0.2860s/iter; left time: 10574.3884s
	iters: 300, epoch: 11 | loss: 0.0138927
	speed: 0.2980s/iter; left time: 10986.9708s
	iters: 400, epoch: 11 | loss: 0.0023765
	speed: 0.3074s/iter; left time: 11302.3813s
Epoch: 11 cost time: 123.47106075286865
Epoch: 11, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.068 Vali Acc: 0.979 Test Loss: 0.068 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0686208
	speed: 0.5906s/iter; left time: 21648.4254s
	iters: 200, epoch: 12 | loss: 0.1164605
	speed: 0.2846s/iter; left time: 10404.5640s
	iters: 300, epoch: 12 | loss: 0.0002845
	speed: 0.3215s/iter; left time: 11720.7781s
	iters: 400, epoch: 12 | loss: 0.0702694
	speed: 0.3229s/iter; left time: 11739.5330s
Epoch: 12 cost time: 125.55681729316711
Epoch: 12, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.122 Vali Acc: 0.966 Test Loss: 0.122 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0283974
	speed: 0.6235s/iter; left time: 22599.7426s
	iters: 200, epoch: 13 | loss: 0.0056226
	speed: 0.3338s/iter; left time: 12066.9757s
	iters: 300, epoch: 13 | loss: 0.0001828
	speed: 0.3164s/iter; left time: 11403.2230s
	iters: 400, epoch: 13 | loss: 0.0045977
	speed: 0.3319s/iter; left time: 11930.1310s
Epoch: 13 cost time: 133.52699255943298
Epoch: 13, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.053 Vali Acc: 0.984 Test Loss: 0.053 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0060312
	speed: 0.6388s/iter; left time: 22890.2551s
	iters: 200, epoch: 14 | loss: 0.0110264
	speed: 0.3239s/iter; left time: 11572.9988s
	iters: 300, epoch: 14 | loss: 0.0007691
	speed: 0.3267s/iter; left time: 11639.5564s
	iters: 400, epoch: 14 | loss: 0.0006399
	speed: 0.3122s/iter; left time: 11094.3823s
Epoch: 14 cost time: 133.25402212142944
Epoch: 14, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.056 Vali Acc: 0.984 Test Loss: 0.056 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0120210
	speed: 0.6710s/iter; left time: 23765.3625s
	iters: 200, epoch: 15 | loss: 0.0009571
	speed: 0.3204s/iter; left time: 11317.8429s
	iters: 300, epoch: 15 | loss: 0.1017104
	speed: 0.3284s/iter; left time: 11564.1798s
	iters: 400, epoch: 15 | loss: 0.0218752
	speed: 0.3248s/iter; left time: 11406.4040s
Epoch: 15 cost time: 135.6810064315796
Epoch: 15, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.073 Vali Acc: 0.979 Test Loss: 0.073 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0002152
	speed: 0.6445s/iter; left time: 22559.9282s
	iters: 200, epoch: 16 | loss: 0.0000370
	speed: 0.3140s/iter; left time: 10960.4724s
	iters: 300, epoch: 16 | loss: 0.0080997
	speed: 0.3328s/iter; left time: 11583.2429s
	iters: 400, epoch: 16 | loss: 0.0027996
	speed: 0.3219s/iter; left time: 11173.1887s
Epoch: 16 cost time: 133.81433963775635
Epoch: 16, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0004581
	speed: 0.6636s/iter; left time: 22955.9017s
	iters: 200, epoch: 17 | loss: 0.0002298
	speed: 0.3366s/iter; left time: 11610.3364s
	iters: 300, epoch: 17 | loss: 0.0000053
	speed: 0.3170s/iter; left time: 10900.9291s
	iters: 400, epoch: 17 | loss: 0.0000253
	speed: 0.3210s/iter; left time: 11009.2094s
Epoch: 17 cost time: 135.55554580688477
Epoch: 17, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9895407003183265
model parameter : 265546
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.7368326
	speed: 0.3198s/iter; left time: 13174.4676s
	iters: 200, epoch: 1 | loss: 0.7574162
	speed: 0.3060s/iter; left time: 12577.8065s
	iters: 300, epoch: 1 | loss: 0.4168161
	speed: 0.3397s/iter; left time: 13928.2473s
	iters: 400, epoch: 1 | loss: 0.2865747
	speed: 0.3097s/iter; left time: 12668.3172s
Epoch: 1 cost time: 131.53863859176636
Epoch: 1, Steps: 413 | Train Loss: 1.075 Vali Loss: 0.201 Vali Acc: 0.952 Test Loss: 0.201 Test Acc: 0.952
Validation loss decreased (inf --> -0.952249).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2663592
	speed: 0.6198s/iter; left time: 25281.7945s
	iters: 200, epoch: 2 | loss: 0.0892162
	speed: 0.3222s/iter; left time: 13110.7876s
	iters: 300, epoch: 2 | loss: 0.0650764
	speed: 0.3024s/iter; left time: 12272.4319s
	iters: 400, epoch: 2 | loss: 0.1374188
	speed: 0.3071s/iter; left time: 12433.4131s
Epoch: 2 cost time: 128.6232304573059
Epoch: 2, Steps: 413 | Train Loss: 0.164 Vali Loss: 0.090 Vali Acc: 0.974 Test Loss: 0.090 Test Acc: 0.974
Validation loss decreased (-0.952249 --> -0.974078).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0390383
	speed: 0.5962s/iter; left time: 24069.7406s
	iters: 200, epoch: 3 | loss: 0.1033221
	speed: 0.2952s/iter; left time: 11889.3566s
	iters: 300, epoch: 3 | loss: 0.0350883
	speed: 0.2987s/iter; left time: 12000.1294s
	iters: 400, epoch: 3 | loss: 0.0133206
	speed: 0.3059s/iter; left time: 12259.8387s
Epoch: 3 cost time: 123.72779321670532
Epoch: 3, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.064 Vali Acc: 0.981 Test Loss: 0.064 Test Acc: 0.981
Validation loss decreased (-0.974078 --> -0.980900).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0194616
	speed: 0.6191s/iter; left time: 24740.9028s
	iters: 200, epoch: 4 | loss: 0.2002214
	speed: 0.2928s/iter; left time: 11670.4961s
	iters: 300, epoch: 4 | loss: 0.0066093
	speed: 0.2847s/iter; left time: 11321.6849s
	iters: 400, epoch: 4 | loss: 0.0626331
	speed: 0.3058s/iter; left time: 12130.2468s
Epoch: 4 cost time: 122.45945501327515
Epoch: 4, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.062 Vali Acc: 0.978 Test Loss: 0.062 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0108178
	speed: 0.6208s/iter; left time: 24551.4428s
	iters: 200, epoch: 5 | loss: 0.0054651
	speed: 0.2783s/iter; left time: 10978.0781s
	iters: 300, epoch: 5 | loss: 0.0355622
	speed: 0.2865s/iter; left time: 11272.6139s
	iters: 400, epoch: 5 | loss: 0.0075546
	speed: 0.3083s/iter; left time: 12101.7090s
Epoch: 5 cost time: 121.68345642089844
Epoch: 5, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.054 Vali Acc: 0.982 Test Loss: 0.054 Test Acc: 0.982
Validation loss decreased (-0.980900 --> -0.981809).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0152360
	speed: 0.6260s/iter; left time: 24499.3907s
	iters: 200, epoch: 6 | loss: 0.0007667
	speed: 0.2911s/iter; left time: 11364.2820s
	iters: 300, epoch: 6 | loss: 0.0153906
	speed: 0.3042s/iter; left time: 11842.8004s
	iters: 400, epoch: 6 | loss: 0.0492029
	speed: 0.2994s/iter; left time: 11628.9430s
Epoch: 6 cost time: 123.48611092567444
Epoch: 6, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.038 Vali Acc: 0.987 Test Loss: 0.038 Test Acc: 0.987
Validation loss decreased (-0.981809 --> -0.987267).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0084075
	speed: 0.5898s/iter; left time: 22840.1618s
	iters: 200, epoch: 7 | loss: 0.0018282
	speed: 0.2992s/iter; left time: 11554.6368s
	iters: 300, epoch: 7 | loss: 0.0091578
	speed: 0.3014s/iter; left time: 11609.3617s
	iters: 400, epoch: 7 | loss: 0.0054617
	speed: 0.2959s/iter; left time: 11368.9860s
Epoch: 7 cost time: 122.06611466407776
Epoch: 7, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.046 Vali Acc: 0.984 Test Loss: 0.046 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0025632
	speed: 0.6178s/iter; left time: 23668.6903s
	iters: 200, epoch: 8 | loss: 0.0061631
	speed: 0.3159s/iter; left time: 12071.6618s
	iters: 300, epoch: 8 | loss: 0.0004054
	speed: 0.2966s/iter; left time: 11301.8082s
	iters: 400, epoch: 8 | loss: 0.0693211
	speed: 0.2967s/iter; left time: 11276.9501s
Epoch: 8 cost time: 126.21585750579834
Epoch: 8, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.049 Vali Acc: 0.980 Test Loss: 0.049 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0027736
	speed: 0.6074s/iter; left time: 23019.7081s
	iters: 200, epoch: 9 | loss: 0.0107110
	speed: 0.2886s/iter; left time: 10908.6434s
	iters: 300, epoch: 9 | loss: 0.0052683
	speed: 0.2941s/iter; left time: 11085.6159s
	iters: 400, epoch: 9 | loss: 0.0018765
	speed: 0.3243s/iter; left time: 12192.7042s
Epoch: 9 cost time: 125.2470326423645
Epoch: 9, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.060 Vali Acc: 0.980 Test Loss: 0.060 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0270046
	speed: 0.6201s/iter; left time: 23241.9799s
	iters: 200, epoch: 10 | loss: 0.0022538
	speed: 0.3096s/iter; left time: 11574.6714s
	iters: 300, epoch: 10 | loss: 0.0038647
	speed: 0.3349s/iter; left time: 12488.2520s
	iters: 400, epoch: 10 | loss: 0.0011775
	speed: 0.3021s/iter; left time: 11233.8385s
Epoch: 10 cost time: 128.82262754440308
Epoch: 10, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.035 Vali Acc: 0.989 Test Loss: 0.035 Test Acc: 0.989
Validation loss decreased (-0.987267 --> -0.988631).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0010334
	speed: 0.5959s/iter; left time: 22091.4874s
	iters: 200, epoch: 11 | loss: 0.0006721
	speed: 0.3159s/iter; left time: 11679.7639s
	iters: 300, epoch: 11 | loss: 0.0071573
	speed: 0.2996s/iter; left time: 11045.9855s
	iters: 400, epoch: 11 | loss: 0.0018662
	speed: 0.2886s/iter; left time: 10611.4752s
Epoch: 11 cost time: 124.79988193511963
Epoch: 11, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.056 Vali Acc: 0.981 Test Loss: 0.056 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.2609544
	speed: 0.6373s/iter; left time: 23361.1242s
	iters: 200, epoch: 12 | loss: 0.0010721
	speed: 0.3164s/iter; left time: 11565.4639s
	iters: 300, epoch: 12 | loss: 0.0031856
	speed: 0.3102s/iter; left time: 11309.2719s
	iters: 400, epoch: 12 | loss: 0.0076342
	speed: 0.3125s/iter; left time: 11362.6365s
Epoch: 12 cost time: 132.19055771827698
Epoch: 12, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.039 Vali Acc: 0.985 Test Loss: 0.039 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0910232
	speed: 0.6251s/iter; left time: 22657.9955s
	iters: 200, epoch: 13 | loss: 0.0049335
	speed: 0.2984s/iter; left time: 10785.9295s
	iters: 300, epoch: 13 | loss: 0.0023036
	speed: 0.3100s/iter; left time: 11174.3891s
	iters: 400, epoch: 13 | loss: 0.0139992
	speed: 0.3117s/iter; left time: 11203.0027s
Epoch: 13 cost time: 125.64133358001709
Epoch: 13, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0001114
	speed: 0.6013s/iter; left time: 21546.9528s
	iters: 200, epoch: 14 | loss: 0.0307584
	speed: 0.3294s/iter; left time: 11770.6700s
	iters: 300, epoch: 14 | loss: 0.0001146
	speed: 0.3240s/iter; left time: 11544.2655s
	iters: 400, epoch: 14 | loss: 0.0000644
	speed: 0.3012s/iter; left time: 10703.0286s
Epoch: 14 cost time: 130.93068671226501
Epoch: 14, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.059 Vali Acc: 0.982 Test Loss: 0.059 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0018383
	speed: 0.6379s/iter; left time: 22594.0885s
	iters: 200, epoch: 15 | loss: 0.0002398
	speed: 0.3143s/iter; left time: 11101.8377s
	iters: 300, epoch: 15 | loss: 0.0000997
	speed: 0.2920s/iter; left time: 10282.2525s
	iters: 400, epoch: 15 | loss: 0.0022586
	speed: 0.2952s/iter; left time: 10365.4708s
Epoch: 15 cost time: 126.3373351097107
Epoch: 15, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.040 Vali Acc: 0.988 Test Loss: 0.040 Test Acc: 0.988
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000494
	speed: 0.6346s/iter; left time: 22213.1049s
	iters: 200, epoch: 16 | loss: 0.0001783
	speed: 0.3107s/iter; left time: 10844.5742s
	iters: 300, epoch: 16 | loss: 0.0033183
	speed: 0.3172s/iter; left time: 11039.8304s
	iters: 400, epoch: 16 | loss: 0.0000285
	speed: 0.3208s/iter; left time: 11132.6562s
Epoch: 16 cost time: 130.52485466003418
Epoch: 16, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0001869
	speed: 0.6110s/iter; left time: 21136.8703s
	iters: 200, epoch: 17 | loss: 0.0214586
	speed: 0.3046s/iter; left time: 10508.1298s
	iters: 300, epoch: 17 | loss: 0.0018354
	speed: 0.2924s/iter; left time: 10058.1775s
	iters: 400, epoch: 17 | loss: 0.0009931
	speed: 0.3042s/iter; left time: 10432.1595s
Epoch: 17 cost time: 124.50612759590149
Epoch: 17, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.056 Vali Acc: 0.984 Test Loss: 0.056 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0001029
	speed: 0.6193s/iter; left time: 21167.5578s
	iters: 200, epoch: 18 | loss: 0.0000125
	speed: 0.3119s/iter; left time: 10628.1610s
	iters: 300, epoch: 18 | loss: 0.0001178
	speed: 0.3163s/iter; left time: 10749.0176s
	iters: 400, epoch: 18 | loss: 0.0003581
	speed: 0.3105s/iter; left time: 10520.0999s
Epoch: 18 cost time: 128.2070083618164
Epoch: 18, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0035142
	speed: 0.6222s/iter; left time: 21009.3267s
	iters: 200, epoch: 19 | loss: 0.0021805
	speed: 0.3070s/iter; left time: 10335.0333s
	iters: 300, epoch: 19 | loss: 0.0000701
	speed: 0.3008s/iter; left time: 10096.0282s
	iters: 400, epoch: 19 | loss: 0.0000958
	speed: 0.3124s/iter; left time: 10455.0310s
Epoch: 19 cost time: 127.67555594444275
Epoch: 19, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.051 Vali Acc: 0.985 Test Loss: 0.051 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0673665
	speed: 0.6243s/iter; left time: 20821.8593s
	iters: 200, epoch: 20 | loss: 0.0000102
	speed: 0.3179s/iter; left time: 10572.6015s
	iters: 300, epoch: 20 | loss: 0.0009214
	speed: 0.3395s/iter; left time: 11256.3585s
	iters: 400, epoch: 20 | loss: 0.0096484
	speed: 0.2951s/iter; left time: 9755.4140s
Epoch: 20 cost time: 130.0947105884552
Epoch: 20, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.988631195998181
model parameter : 265546
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.1510618
	speed: 0.3543s/iter; left time: 14597.2231s
	iters: 200, epoch: 1 | loss: 1.4410203
	speed: 0.3166s/iter; left time: 13011.6437s
	iters: 300, epoch: 1 | loss: 0.6741012
	speed: 0.3186s/iter; left time: 13063.9948s
	iters: 400, epoch: 1 | loss: 0.5109332
	speed: 0.3354s/iter; left time: 13718.4227s
Epoch: 1 cost time: 136.86617350578308
Epoch: 1, Steps: 413 | Train Loss: 1.358 Vali Loss: 0.267 Vali Acc: 0.929 Test Loss: 0.267 Test Acc: 0.929
Validation loss decreased (inf --> -0.929056).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3803166
	speed: 0.6262s/iter; left time: 25540.6617s
	iters: 200, epoch: 2 | loss: 0.1046306
	speed: 0.3315s/iter; left time: 13488.8990s
	iters: 300, epoch: 2 | loss: 0.0542995
	speed: 0.3214s/iter; left time: 13046.7349s
	iters: 400, epoch: 2 | loss: 0.2313512
	speed: 0.3459s/iter; left time: 14006.5683s
Epoch: 2 cost time: 136.64597606658936
Epoch: 2, Steps: 413 | Train Loss: 0.214 Vali Loss: 0.104 Vali Acc: 0.964 Test Loss: 0.104 Test Acc: 0.964
Validation loss decreased (-0.929056 --> -0.963619).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1681514
	speed: 0.6474s/iter; left time: 26139.2217s
	iters: 200, epoch: 3 | loss: 0.0720485
	speed: 0.3158s/iter; left time: 12717.5487s
	iters: 300, epoch: 3 | loss: 0.0431182
	speed: 0.3131s/iter; left time: 12578.4141s
	iters: 400, epoch: 3 | loss: 0.0531934
	speed: 0.3216s/iter; left time: 12887.2353s
Epoch: 3 cost time: 131.01841473579407
Epoch: 3, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.083 Vali Acc: 0.972 Test Loss: 0.083 Test Acc: 0.972
Validation loss decreased (-0.963619 --> -0.972259).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0500657
	speed: 0.6181s/iter; left time: 24698.6956s
	iters: 200, epoch: 4 | loss: 0.0501165
	speed: 0.3319s/iter; left time: 13229.4777s
	iters: 300, epoch: 4 | loss: 0.0030290
	speed: 0.3359s/iter; left time: 13354.1285s
	iters: 400, epoch: 4 | loss: 0.0621321
	speed: 0.3141s/iter; left time: 12459.2751s
Epoch: 4 cost time: 132.76384472846985
Epoch: 4, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.077 Vali Acc: 0.975 Test Loss: 0.077 Test Acc: 0.975
Validation loss decreased (-0.972259 --> -0.974988).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0093177
	speed: 0.6819s/iter; left time: 26968.2893s
	iters: 200, epoch: 5 | loss: 0.0383880
	speed: 0.3044s/iter; left time: 12009.9911s
	iters: 300, epoch: 5 | loss: 0.0287662
	speed: 0.3234s/iter; left time: 12723.6114s
	iters: 400, epoch: 5 | loss: 0.0005616
	speed: 0.3317s/iter; left time: 13019.8457s
Epoch: 5 cost time: 136.05192255973816
Epoch: 5, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.094 Vali Acc: 0.969 Test Loss: 0.094 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0042314
	speed: 0.6514s/iter; left time: 25491.5485s
	iters: 200, epoch: 6 | loss: 0.0050176
	speed: 0.3314s/iter; left time: 12935.5826s
	iters: 300, epoch: 6 | loss: 0.0387361
	speed: 0.3224s/iter; left time: 12554.6759s
	iters: 400, epoch: 6 | loss: 0.0320755
	speed: 0.3502s/iter; left time: 13600.3405s
Epoch: 6 cost time: 139.76111936569214
Epoch: 6, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0004310
	speed: 0.6689s/iter; left time: 25902.5235s
	iters: 200, epoch: 7 | loss: 0.0052683
	speed: 0.3194s/iter; left time: 12336.6074s
	iters: 300, epoch: 7 | loss: 0.0191091
	speed: 0.3348s/iter; left time: 12897.7669s
	iters: 400, epoch: 7 | loss: 0.0065596
	speed: 0.3170s/iter; left time: 12180.4753s
Epoch: 7 cost time: 134.5572726726532
Epoch: 7, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.068 Vali Acc: 0.976 Test Loss: 0.068 Test Acc: 0.976
Validation loss decreased (-0.974988 --> -0.976352).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0036220
	speed: 0.6348s/iter; left time: 24320.9391s
	iters: 200, epoch: 8 | loss: 0.0069073
	speed: 0.3240s/iter; left time: 12378.8587s
	iters: 300, epoch: 8 | loss: 0.0054095
	speed: 0.3034s/iter; left time: 11562.8075s
	iters: 400, epoch: 8 | loss: 0.0390674
	speed: 0.3226s/iter; left time: 12262.8651s
Epoch: 8 cost time: 131.86836791038513
Epoch: 8, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.083 Vali Acc: 0.972 Test Loss: 0.083 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0022019
	speed: 0.6420s/iter; left time: 24328.6092s
	iters: 200, epoch: 9 | loss: 0.0218404
	speed: 0.3233s/iter; left time: 12218.0956s
	iters: 300, epoch: 9 | loss: 0.0007418
	speed: 0.3233s/iter; left time: 12185.5734s
	iters: 400, epoch: 9 | loss: 0.0107382
	speed: 0.3289s/iter; left time: 12364.7786s
Epoch: 9 cost time: 134.5464653968811
Epoch: 9, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0268747
	speed: 0.6524s/iter; left time: 24455.6188s
	iters: 200, epoch: 10 | loss: 0.0037227
	speed: 0.3042s/iter; left time: 11372.9406s
	iters: 300, epoch: 10 | loss: 0.0464887
	speed: 0.3031s/iter; left time: 11300.7286s
	iters: 400, epoch: 10 | loss: 0.0038279
	speed: 0.3047s/iter; left time: 11328.8129s
Epoch: 10 cost time: 127.44124674797058
Epoch: 10, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.068 Vali Acc: 0.978 Test Loss: 0.068 Test Acc: 0.978
Validation loss decreased (-0.976352 --> -0.977716).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0005233
	speed: 0.6178s/iter; left time: 22901.9590s
	iters: 200, epoch: 11 | loss: 0.0007624
	speed: 0.2885s/iter; left time: 10665.0807s
	iters: 300, epoch: 11 | loss: 0.0013611
	speed: 0.3157s/iter; left time: 11638.6987s
	iters: 400, epoch: 11 | loss: 0.0001632
	speed: 0.3196s/iter; left time: 11753.2958s
Epoch: 11 cost time: 127.56344103813171
Epoch: 11, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.076 Vali Acc: 0.975 Test Loss: 0.076 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0107093
	speed: 0.6068s/iter; left time: 22244.5720s
	iters: 200, epoch: 12 | loss: 0.0152471
	speed: 0.3187s/iter; left time: 11651.7827s
	iters: 300, epoch: 12 | loss: 0.0093312
	speed: 0.3201s/iter; left time: 11668.8823s
	iters: 400, epoch: 12 | loss: 0.0057454
	speed: 0.3018s/iter; left time: 10971.7749s
Epoch: 12 cost time: 129.35102605819702
Epoch: 12, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0057352
	speed: 0.5920s/iter; left time: 21457.2473s
	iters: 200, epoch: 13 | loss: 0.0131921
	speed: 0.3024s/iter; left time: 10929.0992s
	iters: 300, epoch: 13 | loss: 0.0018760
	speed: 0.3034s/iter; left time: 10937.7455s
	iters: 400, epoch: 13 | loss: 0.0167583
	speed: 0.3038s/iter; left time: 10920.3971s
Epoch: 13 cost time: 124.63555717468262
Epoch: 13, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0002263
	speed: 0.6096s/iter; left time: 21841.8036s
	iters: 200, epoch: 14 | loss: 0.0236988
	speed: 0.3144s/iter; left time: 11234.7262s
	iters: 300, epoch: 14 | loss: 0.0003669
	speed: 0.3112s/iter; left time: 11090.0427s
	iters: 400, epoch: 14 | loss: 0.0016794
	speed: 0.2824s/iter; left time: 10036.0058s
Epoch: 14 cost time: 125.19702768325806
Epoch: 14, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000090
	speed: 0.6300s/iter; left time: 22313.7147s
	iters: 200, epoch: 15 | loss: 0.0006456
	speed: 0.3027s/iter; left time: 10689.6971s
	iters: 300, epoch: 15 | loss: 0.0012635
	speed: 0.3138s/iter; left time: 11050.5971s
	iters: 400, epoch: 15 | loss: 0.0048562
	speed: 0.3364s/iter; left time: 11814.9153s
Epoch: 15 cost time: 131.90265417099
Epoch: 15, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.977716 --> -0.979990).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000435
	speed: 0.6056s/iter; left time: 21201.2455s
	iters: 200, epoch: 16 | loss: 0.0055579
	speed: 0.3158s/iter; left time: 11024.7029s
	iters: 300, epoch: 16 | loss: 0.0000572
	speed: 0.3132s/iter; left time: 10902.7964s
	iters: 400, epoch: 16 | loss: 0.0001984
	speed: 0.3112s/iter; left time: 10801.7183s
Epoch: 16 cost time: 128.17526936531067
Epoch: 16, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.130 Vali Acc: 0.972 Test Loss: 0.130 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0018509
	speed: 0.6056s/iter; left time: 20949.5280s
	iters: 200, epoch: 17 | loss: 0.0000064
	speed: 0.2899s/iter; left time: 9997.9209s
	iters: 300, epoch: 17 | loss: 0.0375713
	speed: 0.3220s/iter; left time: 11074.3671s
	iters: 400, epoch: 17 | loss: 0.0000172
	speed: 0.3142s/iter; left time: 10773.2399s
Epoch: 17 cost time: 126.89882326126099
Epoch: 17, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0010813
	speed: 0.6112s/iter; left time: 20892.1987s
	iters: 200, epoch: 18 | loss: 0.0001961
	speed: 0.3288s/iter; left time: 11203.9957s
	iters: 300, epoch: 18 | loss: 0.0002337
	speed: 0.3058s/iter; left time: 10391.4106s
	iters: 400, epoch: 18 | loss: 0.0000078
	speed: 0.3228s/iter; left time: 10937.0940s
Epoch: 18 cost time: 132.20366096496582
Epoch: 18, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0095579
	speed: 0.6129s/iter; left time: 20694.3034s
	iters: 200, epoch: 19 | loss: 0.0005043
	speed: 0.3049s/iter; left time: 10265.7593s
	iters: 300, epoch: 19 | loss: 0.0000096
	speed: 0.3172s/iter; left time: 10646.7659s
	iters: 400, epoch: 19 | loss: 0.0000421
	speed: 0.3009s/iter; left time: 10071.7170s
Epoch: 19 cost time: 126.70136880874634
Epoch: 19, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.979990 --> -0.982719).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0002904
	speed: 0.6004s/iter; left time: 20025.3772s
	iters: 200, epoch: 20 | loss: 0.0002099
	speed: 0.3145s/iter; left time: 10460.0133s
	iters: 300, epoch: 20 | loss: 0.0017662
	speed: 0.3166s/iter; left time: 10494.9679s
	iters: 400, epoch: 20 | loss: 0.0292495
	speed: 0.3112s/iter; left time: 10286.2388s
Epoch: 20 cost time: 128.17219853401184
Epoch: 20, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.073 Vali Acc: 0.984 Test Loss: 0.073 Test Acc: 0.984
Validation loss decreased (-0.982719 --> -0.983628).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0063516
	speed: 0.6198s/iter; left time: 20415.3078s
	iters: 200, epoch: 21 | loss: 0.0428357
	speed: 0.3114s/iter; left time: 10227.0966s
	iters: 300, epoch: 21 | loss: 0.3962338
	speed: 0.2916s/iter; left time: 9548.4427s
	iters: 400, epoch: 21 | loss: 0.0941762
	speed: 0.3061s/iter; left time: 9990.2218s
Epoch: 21 cost time: 126.43625831604004
Epoch: 21, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000420
	speed: 0.5964s/iter; left time: 19399.1430s
	iters: 200, epoch: 22 | loss: 0.0000910
	speed: 0.3043s/iter; left time: 9869.1132s
	iters: 300, epoch: 22 | loss: 0.0000399
	speed: 0.3016s/iter; left time: 9748.6785s
	iters: 400, epoch: 22 | loss: 0.0000003
	speed: 0.2892s/iter; left time: 9320.8920s
Epoch: 22 cost time: 122.52156257629395
Epoch: 22, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.052 Vali Acc: 0.985 Test Loss: 0.052 Test Acc: 0.985
Validation loss decreased (-0.983628 --> -0.985447).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0001058
	speed: 0.6265s/iter; left time: 20121.2380s
	iters: 200, epoch: 23 | loss: 0.0001958
	speed: 0.2924s/iter; left time: 9361.8846s
	iters: 300, epoch: 23 | loss: 0.0032977
	speed: 0.3095s/iter; left time: 9876.3360s
	iters: 400, epoch: 23 | loss: 0.0002137
	speed: 0.3028s/iter; left time: 9633.0779s
Epoch: 23 cost time: 126.47894263267517
Epoch: 23, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.064 Vali Acc: 0.985 Test Loss: 0.064 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0000849
	speed: 0.5795s/iter; left time: 18370.4176s
	iters: 200, epoch: 24 | loss: 0.0000512
	speed: 0.3076s/iter; left time: 9721.4694s
	iters: 300, epoch: 24 | loss: 0.0090952
	speed: 0.3074s/iter; left time: 9683.8818s
	iters: 400, epoch: 24 | loss: 0.0000027
	speed: 0.2994s/iter; left time: 9400.7059s
Epoch: 24 cost time: 125.45639657974243
Epoch: 24, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0000334
	speed: 0.6229s/iter; left time: 19490.3928s
	iters: 200, epoch: 25 | loss: 0.0000175
	speed: 0.3109s/iter; left time: 9696.4913s
	iters: 300, epoch: 25 | loss: 0.0000098
	speed: 0.2851s/iter; left time: 8864.3161s
	iters: 400, epoch: 25 | loss: 0.0000541
	speed: 0.2905s/iter; left time: 9001.7558s
Epoch: 25 cost time: 125.09859085083008
Epoch: 25, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0000426
	speed: 0.5944s/iter; left time: 18353.5397s
	iters: 200, epoch: 26 | loss: 0.0000007
	speed: 0.2830s/iter; left time: 8710.4988s
	iters: 300, epoch: 26 | loss: 0.0000749
	speed: 0.3067s/iter; left time: 9408.7291s
	iters: 400, epoch: 26 | loss: 0.0001373
	speed: 0.2995s/iter; left time: 9157.2987s
Epoch: 26 cost time: 121.99000549316406
Epoch: 26, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0001687
	speed: 0.6228s/iter; left time: 18973.0951s
	iters: 200, epoch: 27 | loss: 0.0002716
	speed: 0.2988s/iter; left time: 9070.9644s
	iters: 300, epoch: 27 | loss: 0.0027978
	speed: 0.2825s/iter; left time: 8548.0224s
	iters: 400, epoch: 27 | loss: 0.0000062
	speed: 0.3096s/iter; left time: 9337.9974s
Epoch: 27 cost time: 124.9667387008667
Epoch: 27, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.119 Vali Acc: 0.976 Test Loss: 0.119 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.2605649
	speed: 0.5864s/iter; left time: 17620.6251s
	iters: 200, epoch: 28 | loss: 0.0002145
	speed: 0.2884s/iter; left time: 8638.1830s
	iters: 300, epoch: 28 | loss: 0.0017491
	speed: 0.3437s/iter; left time: 10259.6346s
	iters: 400, epoch: 28 | loss: 0.0000006
	speed: 0.3164s/iter; left time: 9413.1983s
Epoch: 28 cost time: 127.00641202926636
Epoch: 28, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.082 Vali Acc: 0.982 Test Loss: 0.082 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0000097
	speed: 0.6459s/iter; left time: 19143.2936s
	iters: 200, epoch: 29 | loss: 0.0000007
	speed: 0.3092s/iter; left time: 9133.3677s
	iters: 300, epoch: 29 | loss: 0.0117159
	speed: 0.3335s/iter; left time: 9818.4298s
	iters: 400, epoch: 29 | loss: 0.0000358
	speed: 0.3227s/iter; left time: 9466.9353s
Epoch: 29 cost time: 133.51154971122742
Epoch: 29, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.088 Vali Acc: 0.982 Test Loss: 0.088 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0000034
	speed: 0.6166s/iter; left time: 18019.4079s
	iters: 200, epoch: 30 | loss: 0.0002665
	speed: 0.3290s/iter; left time: 9580.7076s
	iters: 300, epoch: 30 | loss: 0.0000007
	speed: 0.2989s/iter; left time: 8674.3482s
	iters: 400, epoch: 30 | loss: 0.0000897
	speed: 0.3206s/iter; left time: 9273.0630s
Epoch: 30 cost time: 132.49901032447815
Epoch: 30, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.093 Vali Acc: 0.979 Test Loss: 0.093 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0002235
	speed: 0.6633s/iter; left time: 19109.8691s
	iters: 200, epoch: 31 | loss: 0.0000256
	speed: 0.3245s/iter; left time: 9316.7576s
	iters: 300, epoch: 31 | loss: 0.0001605
	speed: 0.3324s/iter; left time: 9510.8425s
	iters: 400, epoch: 31 | loss: 0.0000137
	speed: 0.3237s/iter; left time: 9228.7402s
Epoch: 31 cost time: 135.35175919532776
Epoch: 31, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.110 Vali Acc: 0.981 Test Loss: 0.110 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0000003
	speed: 0.6291s/iter; left time: 17865.4225s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.3077s/iter; left time: 8706.3856s
	iters: 300, epoch: 32 | loss: 0.0498983
	speed: 0.3211s/iter; left time: 9055.6647s
	iters: 400, epoch: 32 | loss: 0.0000018
	speed: 0.3170s/iter; left time: 8906.5264s
Epoch: 32 cost time: 130.40806889533997
Epoch: 32, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.104 Vali Acc: 0.981 Test Loss: 0.104 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9854479308776717
model parameter : 265546
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.3204403
	speed: 0.3444s/iter; left time: 14191.3080s
	iters: 200, epoch: 1 | loss: 1.6981831
	speed: 0.3235s/iter; left time: 13297.9485s
	iters: 300, epoch: 1 | loss: 0.7776104
	speed: 0.3112s/iter; left time: 12759.6362s
	iters: 400, epoch: 1 | loss: 0.5477974
	speed: 0.3072s/iter; left time: 12563.1785s
Epoch: 1 cost time: 132.80961227416992
Epoch: 1, Steps: 413 | Train Loss: 1.479 Vali Loss: 0.316 Vali Acc: 0.911 Test Loss: 0.316 Test Acc: 0.911
Validation loss decreased (inf --> -0.911320).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3629299
	speed: 0.6107s/iter; left time: 24908.4880s
	iters: 200, epoch: 2 | loss: 0.0870712
	speed: 0.2935s/iter; left time: 11942.0963s
	iters: 300, epoch: 2 | loss: 0.0514463
	speed: 0.3164s/iter; left time: 12841.7188s
	iters: 400, epoch: 2 | loss: 0.4845948
	speed: 0.3090s/iter; left time: 12512.2154s
Epoch: 2 cost time: 126.9465799331665
Epoch: 2, Steps: 413 | Train Loss: 0.241 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
Validation loss decreased (-0.911320 --> -0.968166).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1020447
	speed: 0.6067s/iter; left time: 24494.7035s
	iters: 200, epoch: 3 | loss: 0.0882259
	speed: 0.3358s/iter; left time: 13522.4780s
	iters: 300, epoch: 3 | loss: 0.1047912
	speed: 0.3101s/iter; left time: 12459.8573s
	iters: 400, epoch: 3 | loss: 0.1023849
	speed: 0.2898s/iter; left time: 11615.5935s
Epoch: 3 cost time: 128.69110822677612
Epoch: 3, Steps: 413 | Train Loss: 0.112 Vali Loss: 0.079 Vali Acc: 0.975 Test Loss: 0.079 Test Acc: 0.975
Validation loss decreased (-0.968166 --> -0.975443).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0437451
	speed: 0.6172s/iter; left time: 24664.8825s
	iters: 200, epoch: 4 | loss: 0.2186192
	speed: 0.2995s/iter; left time: 11938.4568s
	iters: 300, epoch: 4 | loss: 0.0021221
	speed: 0.2954s/iter; left time: 11746.6512s
	iters: 400, epoch: 4 | loss: 0.1135865
	speed: 0.3155s/iter; left time: 12513.9719s
Epoch: 4 cost time: 126.5677342414856
Epoch: 4, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.083 Vali Acc: 0.972 Test Loss: 0.083 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0292881
	speed: 0.6076s/iter; left time: 24031.7533s
	iters: 200, epoch: 5 | loss: 0.0055967
	speed: 0.3100s/iter; left time: 12229.2009s
	iters: 300, epoch: 5 | loss: 0.0932912
	speed: 0.3202s/iter; left time: 12600.1525s
	iters: 400, epoch: 5 | loss: 0.0061543
	speed: 0.3045s/iter; left time: 11951.9730s
Epoch: 5 cost time: 128.30531978607178
Epoch: 5, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
Validation loss decreased (-0.975443 --> -0.975897).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0046657
	speed: 0.6198s/iter; left time: 24255.0972s
	iters: 200, epoch: 6 | loss: 0.0257244
	speed: 0.3084s/iter; left time: 12037.1601s
	iters: 300, epoch: 6 | loss: 0.0162802
	speed: 0.3140s/iter; left time: 12227.0462s
	iters: 400, epoch: 6 | loss: 0.1045710
	speed: 0.3071s/iter; left time: 11924.7998s
Epoch: 6 cost time: 127.29903030395508
Epoch: 6, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.082 Vali Acc: 0.974 Test Loss: 0.082 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0031365
	speed: 0.6268s/iter; left time: 24271.8975s
	iters: 200, epoch: 7 | loss: 0.0234544
	speed: 0.3184s/iter; left time: 12296.5393s
	iters: 300, epoch: 7 | loss: 0.0015124
	speed: 0.2960s/iter; left time: 11403.1046s
	iters: 400, epoch: 7 | loss: 0.0125914
	speed: 0.3268s/iter; left time: 12557.6972s
Epoch: 7 cost time: 130.91948533058167
Epoch: 7, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.071 Vali Acc: 0.979 Test Loss: 0.071 Test Acc: 0.979
Validation loss decreased (-0.975897 --> -0.979081).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0203575
	speed: 0.6193s/iter; left time: 23725.3969s
	iters: 200, epoch: 8 | loss: 0.0121770
	speed: 0.3068s/iter; left time: 11724.7277s
	iters: 300, epoch: 8 | loss: 0.0344507
	speed: 0.3366s/iter; left time: 12828.6222s
	iters: 400, epoch: 8 | loss: 0.0571864
	speed: 0.3134s/iter; left time: 11912.5540s
Epoch: 8 cost time: 129.65198588371277
Epoch: 8, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.078 Vali Acc: 0.979 Test Loss: 0.078 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0322520
	speed: 0.6336s/iter; left time: 24011.3862s
	iters: 200, epoch: 9 | loss: 0.0006356
	speed: 0.3131s/iter; left time: 11832.6150s
	iters: 300, epoch: 9 | loss: 0.0082744
	speed: 0.3105s/iter; left time: 11705.9567s
	iters: 400, epoch: 9 | loss: 0.0120086
	speed: 0.3309s/iter; left time: 12441.1883s
Epoch: 9 cost time: 132.55234813690186
Epoch: 9, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0028094
	speed: 0.6180s/iter; left time: 23165.6716s
	iters: 200, epoch: 10 | loss: 0.0056101
	speed: 0.3158s/iter; left time: 11806.0569s
	iters: 300, epoch: 10 | loss: 0.0095614
	speed: 0.3100s/iter; left time: 11557.2874s
	iters: 400, epoch: 10 | loss: 0.0078239
	speed: 0.3141s/iter; left time: 11680.7158s
Epoch: 10 cost time: 129.07337760925293
Epoch: 10, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0008597
	speed: 0.6120s/iter; left time: 22686.3660s
	iters: 200, epoch: 11 | loss: 0.0007017
	speed: 0.3325s/iter; left time: 12294.3867s
	iters: 300, epoch: 11 | loss: 0.0016915
	speed: 0.3190s/iter; left time: 11760.4124s
	iters: 400, epoch: 11 | loss: 0.0002183
	speed: 0.3100s/iter; left time: 11400.5565s
Epoch: 11 cost time: 131.69009113311768
Epoch: 11, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.062 Vali Acc: 0.980 Test Loss: 0.062 Test Acc: 0.980
Validation loss decreased (-0.979081 --> -0.979536).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0068029
	speed: 0.6493s/iter; left time: 23800.6557s
	iters: 200, epoch: 12 | loss: 0.0002366
	speed: 0.2976s/iter; left time: 10878.5733s
	iters: 300, epoch: 12 | loss: 0.0004445
	speed: 0.3200s/iter; left time: 11664.9516s
	iters: 400, epoch: 12 | loss: 0.0009561
	speed: 0.3110s/iter; left time: 11306.4067s
Epoch: 12 cost time: 129.27226161956787
Epoch: 12, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.060 Vali Acc: 0.978 Test Loss: 0.060 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0361659
	speed: 0.6307s/iter; left time: 22858.7472s
	iters: 200, epoch: 13 | loss: 0.0371945
	speed: 0.3185s/iter; left time: 11512.2806s
	iters: 300, epoch: 13 | loss: 0.0082022
	speed: 0.2969s/iter; left time: 10703.4163s
	iters: 400, epoch: 13 | loss: 0.0357042
	speed: 0.3192s/iter; left time: 11472.0588s
Epoch: 13 cost time: 131.29526901245117
Epoch: 13, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0007837
	speed: 0.6244s/iter; left time: 22373.3961s
	iters: 200, epoch: 14 | loss: 0.0016030
	speed: 0.3036s/iter; left time: 10847.5392s
	iters: 300, epoch: 14 | loss: 0.0003278
	speed: 0.3240s/iter; left time: 11545.4903s
	iters: 400, epoch: 14 | loss: 0.0005148
	speed: 0.3167s/iter; left time: 11254.1188s
Epoch: 14 cost time: 127.60900259017944
Epoch: 14, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0001317
	speed: 0.5731s/iter; left time: 20299.4197s
	iters: 200, epoch: 15 | loss: 0.0006384
	speed: 0.3012s/iter; left time: 10637.8502s
	iters: 300, epoch: 15 | loss: 0.0000108
	speed: 0.2935s/iter; left time: 10337.3496s
	iters: 400, epoch: 15 | loss: 0.0058972
	speed: 0.3072s/iter; left time: 10788.1801s
Epoch: 15 cost time: 123.71931838989258
Epoch: 15, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.134 Vali Acc: 0.974 Test Loss: 0.134 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000449
	speed: 0.6250s/iter; left time: 21880.3545s
	iters: 200, epoch: 16 | loss: 0.0837348
	speed: 0.2948s/iter; left time: 10288.9648s
	iters: 300, epoch: 16 | loss: 0.0789768
	speed: 0.3059s/iter; left time: 10646.1732s
	iters: 400, epoch: 16 | loss: 0.0006824
	speed: 0.3008s/iter; left time: 10441.1624s
Epoch: 16 cost time: 125.61906814575195
Epoch: 16, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
Validation loss decreased (-0.979536 --> -0.980900).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000241
	speed: 0.6099s/iter; left time: 21097.6205s
	iters: 200, epoch: 17 | loss: 0.0035418
	speed: 0.3092s/iter; left time: 10666.8023s
	iters: 300, epoch: 17 | loss: 0.0008974
	speed: 0.3098s/iter; left time: 10655.9381s
	iters: 400, epoch: 17 | loss: 0.0000015
	speed: 0.3227s/iter; left time: 11066.4804s
Epoch: 17 cost time: 130.21545839309692
Epoch: 17, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.069 Vali Acc: 0.982 Test Loss: 0.069 Test Acc: 0.982
Validation loss decreased (-0.980900 --> -0.982264).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.1504837
	speed: 0.6167s/iter; left time: 21078.5567s
	iters: 200, epoch: 18 | loss: 0.0000345
	speed: 0.3296s/iter; left time: 11234.4465s
	iters: 300, epoch: 18 | loss: 0.0000031
	speed: 0.3105s/iter; left time: 10551.9514s
	iters: 400, epoch: 18 | loss: 0.0003127
	speed: 0.3280s/iter; left time: 11111.5257s
Epoch: 18 cost time: 132.46456050872803
Epoch: 18, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.049 Vali Acc: 0.987 Test Loss: 0.049 Test Acc: 0.987
Validation loss decreased (-0.982264 --> -0.987266).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000355
	speed: 0.6287s/iter; left time: 21227.6915s
	iters: 200, epoch: 19 | loss: 0.0189260
	speed: 0.3056s/iter; left time: 10288.1146s
	iters: 300, epoch: 19 | loss: 0.0009808
	speed: 0.3052s/iter; left time: 10243.5489s
	iters: 400, epoch: 19 | loss: 0.0020218
	speed: 0.3107s/iter; left time: 10398.4655s
Epoch: 19 cost time: 126.66770482063293
Epoch: 19, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0033839
	speed: 0.6075s/iter; left time: 20261.3823s
	iters: 200, epoch: 20 | loss: 0.0000032
	speed: 0.3021s/iter; left time: 10046.5627s
	iters: 300, epoch: 20 | loss: 0.0010415
	speed: 0.3206s/iter; left time: 10629.0050s
	iters: 400, epoch: 20 | loss: 0.0025728
	speed: 0.2958s/iter; left time: 9776.2649s
Epoch: 20 cost time: 125.26394081115723
Epoch: 20, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000549
	speed: 0.5895s/iter; left time: 19419.6640s
	iters: 200, epoch: 21 | loss: 0.0351226
	speed: 0.3013s/iter; left time: 9896.1410s
	iters: 300, epoch: 21 | loss: 0.0000770
	speed: 0.2848s/iter; left time: 9326.0811s
	iters: 400, epoch: 21 | loss: 0.0001589
	speed: 0.3036s/iter; left time: 9909.2884s
Epoch: 21 cost time: 123.34098958969116
Epoch: 21, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.078 Vali Acc: 0.982 Test Loss: 0.078 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0014032
	speed: 0.6241s/iter; left time: 20301.5373s
	iters: 200, epoch: 22 | loss: 0.0000073
	speed: 0.2998s/iter; left time: 9720.9944s
	iters: 300, epoch: 22 | loss: 0.0001807
	speed: 0.3002s/iter; left time: 9706.3926s
	iters: 400, epoch: 22 | loss: 0.0000215
	speed: 0.3108s/iter; left time: 10016.6924s
Epoch: 22 cost time: 126.22822833061218
Epoch: 22, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0007442
	speed: 0.5912s/iter; left time: 18984.9105s
	iters: 200, epoch: 23 | loss: 0.0000046
	speed: 0.3129s/iter; left time: 10016.0904s
	iters: 300, epoch: 23 | loss: 0.0003397
	speed: 0.3006s/iter; left time: 9592.1905s
	iters: 400, epoch: 23 | loss: 0.0121826
	speed: 0.3019s/iter; left time: 9605.2094s
Epoch: 23 cost time: 126.20259046554565
Epoch: 23, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.064 Vali Acc: 0.982 Test Loss: 0.064 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0001505
	speed: 0.5992s/iter; left time: 18994.8335s
	iters: 200, epoch: 24 | loss: 0.0002281
	speed: 0.2989s/iter; left time: 9445.7097s
	iters: 300, epoch: 24 | loss: 0.0000031
	speed: 0.3083s/iter; left time: 9710.6927s
	iters: 400, epoch: 24 | loss: 0.0007691
	speed: 0.3028s/iter; left time: 9509.4685s
Epoch: 24 cost time: 124.75024271011353
Epoch: 24, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.061 Vali Acc: 0.986 Test Loss: 0.061 Test Acc: 0.986
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0000073
	speed: 0.6063s/iter; left time: 18971.7442s
	iters: 200, epoch: 25 | loss: 0.0000312
	speed: 0.3134s/iter; left time: 9774.0355s
	iters: 300, epoch: 25 | loss: 0.0000173
	speed: 0.2963s/iter; left time: 9212.7726s
	iters: 400, epoch: 25 | loss: 0.0164218
	speed: 0.3166s/iter; left time: 9810.9092s
Epoch: 25 cost time: 127.83340001106262
Epoch: 25, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.2713551
	speed: 0.6102s/iter; left time: 18841.5475s
	iters: 200, epoch: 26 | loss: 0.0018046
	speed: 0.3179s/iter; left time: 9782.8298s
	iters: 300, epoch: 26 | loss: 0.0003314
	speed: 0.2958s/iter; left time: 9073.4293s
	iters: 400, epoch: 26 | loss: 0.0000723
	speed: 0.2767s/iter; left time: 8460.4160s
Epoch: 26 cost time: 124.13928937911987
Epoch: 26, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0000002
	speed: 0.6161s/iter; left time: 18769.5503s
	iters: 200, epoch: 27 | loss: 0.0000038
	speed: 0.3136s/iter; left time: 9520.8562s
	iters: 300, epoch: 27 | loss: 0.0003825
	speed: 0.3234s/iter; left time: 9786.4106s
	iters: 400, epoch: 27 | loss: 0.0005886
	speed: 0.3171s/iter; left time: 9564.5307s
Epoch: 27 cost time: 131.124933719635
Epoch: 27, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.151 Vali Acc: 0.972 Test Loss: 0.151 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0000265
	speed: 0.5919s/iter; left time: 17787.0004s
	iters: 200, epoch: 28 | loss: 0.0000164
	speed: 0.3102s/iter; left time: 9289.0369s
	iters: 300, epoch: 28 | loss: 0.1484155
	speed: 0.2932s/iter; left time: 8752.3938s
	iters: 400, epoch: 28 | loss: 0.0000388
	speed: 0.3052s/iter; left time: 9080.2333s
Epoch: 28 cost time: 125.55847430229187
Epoch: 28, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.088 Vali Acc: 0.982 Test Loss: 0.088 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9872669395179627
model parameter : 265546
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.2104263
	speed: 0.2990s/iter; left time: 12319.3004s
	iters: 200, epoch: 1 | loss: 1.5133917
	speed: 0.2752s/iter; left time: 11311.2368s
	iters: 300, epoch: 1 | loss: 0.7811807
	speed: 0.2785s/iter; left time: 11419.6896s
	iters: 400, epoch: 1 | loss: 0.5216258
	speed: 0.2754s/iter; left time: 11263.5547s
Epoch: 1 cost time: 116.73158812522888
Epoch: 1, Steps: 413 | Train Loss: 1.459 Vali Loss: 0.316 Vali Acc: 0.910 Test Loss: 0.316 Test Acc: 0.910
Validation loss decreased (inf --> -0.910411).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3850875
	speed: 0.5599s/iter; left time: 22836.4086s
	iters: 200, epoch: 2 | loss: 0.1630191
	speed: 0.2850s/iter; left time: 11598.0284s
	iters: 300, epoch: 2 | loss: 0.0641436
	speed: 0.2746s/iter; left time: 11145.1582s
	iters: 400, epoch: 2 | loss: 0.4650434
	speed: 0.2705s/iter; left time: 10951.2205s
Epoch: 2 cost time: 115.4333188533783
Epoch: 2, Steps: 413 | Train Loss: 0.283 Vali Loss: 0.134 Vali Acc: 0.961 Test Loss: 0.134 Test Acc: 0.961
Validation loss decreased (-0.910411 --> -0.961345).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1481960
	speed: 0.5420s/iter; left time: 21884.3166s
	iters: 200, epoch: 3 | loss: 0.1683223
	speed: 0.2656s/iter; left time: 10696.7719s
	iters: 300, epoch: 3 | loss: 0.0546150
	speed: 0.2672s/iter; left time: 10734.9867s
	iters: 400, epoch: 3 | loss: 0.0373706
	speed: 0.2805s/iter; left time: 11239.0363s
Epoch: 3 cost time: 112.2574372291565
Epoch: 3, Steps: 413 | Train Loss: 0.133 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
Validation loss decreased (-0.961345 --> -0.969985).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0838821
	speed: 0.5608s/iter; left time: 22410.9858s
	iters: 200, epoch: 4 | loss: 0.1869396
	speed: 0.2686s/iter; left time: 10707.0485s
	iters: 300, epoch: 4 | loss: 0.0062661
	speed: 0.2913s/iter; left time: 11581.5081s
	iters: 400, epoch: 4 | loss: 0.1627406
	speed: 0.2791s/iter; left time: 11069.2922s
Epoch: 4 cost time: 115.37074184417725
Epoch: 4, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.079 Vali Acc: 0.975 Test Loss: 0.079 Test Acc: 0.975
Validation loss decreased (-0.969985 --> -0.974533).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0428661
	speed: 0.5413s/iter; left time: 21406.7045s
	iters: 200, epoch: 5 | loss: 0.0309823
	speed: 0.2742s/iter; left time: 10818.4616s
	iters: 300, epoch: 5 | loss: 0.2108010
	speed: 0.2708s/iter; left time: 10656.5658s
	iters: 400, epoch: 5 | loss: 0.0008563
	speed: 0.2887s/iter; left time: 11330.5516s
Epoch: 5 cost time: 114.76298069953918
Epoch: 5, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.106 Vali Acc: 0.966 Test Loss: 0.106 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0833308
	speed: 0.5961s/iter; left time: 23329.6500s
	iters: 200, epoch: 6 | loss: 0.0019536
	speed: 0.2708s/iter; left time: 10570.3607s
	iters: 300, epoch: 6 | loss: 0.0225940
	speed: 0.2884s/iter; left time: 11229.0410s
	iters: 400, epoch: 6 | loss: 0.0136434
	speed: 0.2826s/iter; left time: 10973.2877s
Epoch: 6 cost time: 117.35420322418213
Epoch: 6, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
Validation loss decreased (-0.974533 --> -0.977716).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0606930
	speed: 0.5603s/iter; left time: 21696.0890s
	iters: 200, epoch: 7 | loss: 0.0112691
	speed: 0.2978s/iter; left time: 11502.4908s
	iters: 300, epoch: 7 | loss: 0.0011873
	speed: 0.2799s/iter; left time: 10781.7749s
	iters: 400, epoch: 7 | loss: 0.0089089
	speed: 0.2674s/iter; left time: 10274.6432s
Epoch: 7 cost time: 117.39060401916504
Epoch: 7, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.084 Vali Acc: 0.975 Test Loss: 0.084 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0026430
	speed: 0.5506s/iter; left time: 21092.8650s
	iters: 200, epoch: 8 | loss: 0.0120287
	speed: 0.2700s/iter; left time: 10317.5791s
	iters: 300, epoch: 8 | loss: 0.0226936
	speed: 0.2852s/iter; left time: 10869.5475s
	iters: 400, epoch: 8 | loss: 0.0016519
	speed: 0.3007s/iter; left time: 11429.4832s
Epoch: 8 cost time: 117.25975751876831
Epoch: 8, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.084 Vali Acc: 0.974 Test Loss: 0.084 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0146715
	speed: 0.5609s/iter; left time: 21255.4880s
	iters: 200, epoch: 9 | loss: 0.0292068
	speed: 0.2845s/iter; left time: 10752.2104s
	iters: 300, epoch: 9 | loss: 0.2362553
	speed: 0.2933s/iter; left time: 11057.2066s
	iters: 400, epoch: 9 | loss: 0.0061959
	speed: 0.2705s/iter; left time: 10171.2613s
Epoch: 9 cost time: 115.87736940383911
Epoch: 9, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0019683
	speed: 0.5670s/iter; left time: 21252.3312s
	iters: 200, epoch: 10 | loss: 0.0133712
	speed: 0.2923s/iter; left time: 10928.6610s
	iters: 300, epoch: 10 | loss: 0.0270830
	speed: 0.2975s/iter; left time: 11091.2299s
	iters: 400, epoch: 10 | loss: 0.0104509
	speed: 0.2990s/iter; left time: 11117.5134s
Epoch: 10 cost time: 121.46052026748657
Epoch: 10, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0506788
	speed: 0.5762s/iter; left time: 21360.3639s
	iters: 200, epoch: 11 | loss: 0.0006754
	speed: 0.2951s/iter; left time: 10910.6557s
	iters: 300, epoch: 11 | loss: 0.0012753
	speed: 0.2850s/iter; left time: 10506.4793s
	iters: 400, epoch: 11 | loss: 0.0002368
	speed: 0.2883s/iter; left time: 10602.7771s
Epoch: 11 cost time: 121.58968114852905
Epoch: 11, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.076 Vali Acc: 0.982 Test Loss: 0.076 Test Acc: 0.982
Validation loss decreased (-0.977716 --> -0.981809).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0046463
	speed: 0.5836s/iter; left time: 21392.7751s
	iters: 200, epoch: 12 | loss: 0.0058100
	speed: 0.2915s/iter; left time: 10657.5252s
	iters: 300, epoch: 12 | loss: 0.0016921
	speed: 0.2706s/iter; left time: 9864.0348s
	iters: 400, epoch: 12 | loss: 0.0437376
	speed: 0.2775s/iter; left time: 10089.0341s
Epoch: 12 cost time: 118.08082318305969
Epoch: 12, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0097636
	speed: 0.6128s/iter; left time: 22210.0406s
	iters: 200, epoch: 13 | loss: 0.0009267
	speed: 0.2848s/iter; left time: 10293.7693s
	iters: 300, epoch: 13 | loss: 0.0001076
	speed: 0.2861s/iter; left time: 10311.5933s
	iters: 400, epoch: 13 | loss: 0.0065630
	speed: 0.2870s/iter; left time: 10315.7102s
Epoch: 13 cost time: 120.20720672607422
Epoch: 13, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0062921
	speed: 0.5690s/iter; left time: 20388.0913s
	iters: 200, epoch: 14 | loss: 0.0504645
	speed: 0.2830s/iter; left time: 10111.7856s
	iters: 300, epoch: 14 | loss: 0.0017615
	speed: 0.2724s/iter; left time: 9707.9210s
	iters: 400, epoch: 14 | loss: 0.0057007
	speed: 0.2765s/iter; left time: 9823.6052s
Epoch: 14 cost time: 114.55474376678467
Epoch: 14, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0123402
	speed: 0.5949s/iter; left time: 21069.5898s
	iters: 200, epoch: 15 | loss: 0.0004283
	speed: 0.2685s/iter; left time: 9482.0529s
	iters: 300, epoch: 15 | loss: 0.0007775
	speed: 0.2814s/iter; left time: 9909.3584s
	iters: 400, epoch: 15 | loss: 0.0051882
	speed: 0.2891s/iter; left time: 10152.7308s
Epoch: 15 cost time: 117.05867409706116
Epoch: 15, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0082206
	speed: 0.5342s/iter; left time: 18701.9084s
	iters: 200, epoch: 16 | loss: 0.0001322
	speed: 0.2856s/iter; left time: 9968.3961s
	iters: 300, epoch: 16 | loss: 0.0023369
	speed: 0.2649s/iter; left time: 9220.8875s
	iters: 400, epoch: 16 | loss: 0.0009047
	speed: 0.2646s/iter; left time: 9182.5909s
Epoch: 16 cost time: 112.00798964500427
Epoch: 16, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0003630
	speed: 0.5578s/iter; left time: 19296.2534s
	iters: 200, epoch: 17 | loss: 0.0107047
	speed: 0.2731s/iter; left time: 9418.3191s
	iters: 300, epoch: 17 | loss: 0.0001833
	speed: 0.3027s/iter; left time: 10410.7923s
	iters: 400, epoch: 17 | loss: 0.0000113
	speed: 0.2812s/iter; left time: 9643.7690s
Epoch: 17 cost time: 117.97342228889465
Epoch: 17, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0002613
	speed: 0.6013s/iter; left time: 20553.8020s
	iters: 200, epoch: 18 | loss: 0.0001070
	speed: 0.2822s/iter; left time: 9618.4687s
	iters: 300, epoch: 18 | loss: 0.0003542
	speed: 0.3016s/iter; left time: 10249.9837s
	iters: 400, epoch: 18 | loss: 0.0009288
	speed: 0.2844s/iter; left time: 9635.4355s
Epoch: 18 cost time: 120.67390179634094
Epoch: 18, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.158 Vali Acc: 0.971 Test Loss: 0.158 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0534635
	speed: 0.5409s/iter; left time: 18263.3286s
	iters: 200, epoch: 19 | loss: 0.0019166
	speed: 0.2866s/iter; left time: 9648.6480s
	iters: 300, epoch: 19 | loss: 0.0048491
	speed: 0.2928s/iter; left time: 9829.0546s
	iters: 400, epoch: 19 | loss: 0.0000044
	speed: 0.3096s/iter; left time: 10361.6204s
Epoch: 19 cost time: 122.19540691375732
Epoch: 19, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0002665
	speed: 0.5565s/iter; left time: 18560.4231s
	iters: 200, epoch: 20 | loss: 0.0000195
	speed: 0.2881s/iter; left time: 9582.1024s
	iters: 300, epoch: 20 | loss: 0.0109787
	speed: 0.2825s/iter; left time: 9367.2759s
	iters: 400, epoch: 20 | loss: 0.0028614
	speed: 0.2762s/iter; left time: 9130.4976s
Epoch: 20 cost time: 116.874027967453
Epoch: 20, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.118 Vali Acc: 0.978 Test Loss: 0.118 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0002106
	speed: 0.5789s/iter; left time: 19068.5644s
	iters: 200, epoch: 21 | loss: 0.0000641
	speed: 0.2866s/iter; left time: 9412.0541s
	iters: 300, epoch: 21 | loss: 0.0107528
	speed: 0.2601s/iter; left time: 8516.6638s
	iters: 400, epoch: 21 | loss: 0.0043036
	speed: 0.2741s/iter; left time: 8945.5729s
Epoch: 21 cost time: 116.32585024833679
Epoch: 21, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.110 Vali Acc: 0.979 Test Loss: 0.110 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9818099135970896
model parameter : 265546
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.1904778
	speed: 0.3056s/iter; left time: 12590.3323s
	iters: 200, epoch: 1 | loss: 1.6057543
	speed: 0.2985s/iter; left time: 12269.0191s
	iters: 300, epoch: 1 | loss: 0.7995939
	speed: 0.2825s/iter; left time: 11584.0304s
	iters: 400, epoch: 1 | loss: 0.5423431
	speed: 0.2892s/iter; left time: 11828.4119s
Epoch: 1 cost time: 122.06108498573303
Epoch: 1, Steps: 413 | Train Loss: 1.448 Vali Loss: 0.300 Vali Acc: 0.913 Test Loss: 0.300 Test Acc: 0.913
Validation loss decreased (inf --> -0.913139).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4040279
	speed: 0.5798s/iter; left time: 23649.2006s
	iters: 200, epoch: 2 | loss: 0.1952273
	speed: 0.2766s/iter; left time: 11253.0390s
	iters: 300, epoch: 2 | loss: 0.0412216
	speed: 0.2982s/iter; left time: 12104.8479s
	iters: 400, epoch: 2 | loss: 0.4167541
	speed: 0.2739s/iter; left time: 11088.1693s
Epoch: 2 cost time: 117.38518738746643
Epoch: 2, Steps: 413 | Train Loss: 0.269 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.913139 --> -0.973169).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1090358
	speed: 0.5649s/iter; left time: 22809.1740s
	iters: 200, epoch: 3 | loss: 0.1125475
	speed: 0.2962s/iter; left time: 11928.0034s
	iters: 300, epoch: 3 | loss: 0.0770754
	speed: 0.2927s/iter; left time: 11758.3383s
	iters: 400, epoch: 3 | loss: 0.0494032
	speed: 0.2939s/iter; left time: 11779.5351s
Epoch: 3 cost time: 122.21939063072205
Epoch: 3, Steps: 413 | Train Loss: 0.122 Vali Loss: 0.081 Vali Acc: 0.979 Test Loss: 0.081 Test Acc: 0.979
Validation loss decreased (-0.973169 --> -0.979081).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1483900
	speed: 0.5648s/iter; left time: 22571.2554s
	iters: 200, epoch: 4 | loss: 0.2352575
	speed: 0.2925s/iter; left time: 11659.8519s
	iters: 300, epoch: 4 | loss: 0.0051494
	speed: 0.2948s/iter; left time: 11720.4722s
	iters: 400, epoch: 4 | loss: 0.0722157
	speed: 0.2852s/iter; left time: 11311.7492s
Epoch: 4 cost time: 120.37590456008911
Epoch: 4, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.061 Vali Acc: 0.980 Test Loss: 0.061 Test Acc: 0.980
Validation loss decreased (-0.979081 --> -0.979536).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0537463
	speed: 0.5806s/iter; left time: 22962.9293s
	iters: 200, epoch: 5 | loss: 0.0402885
	speed: 0.2851s/iter; left time: 11245.4478s
	iters: 300, epoch: 5 | loss: 0.1741528
	speed: 0.3062s/iter; left time: 12046.7878s
	iters: 400, epoch: 5 | loss: 0.0008229
	speed: 0.2832s/iter; left time: 11115.7024s
Epoch: 5 cost time: 120.7136344909668
Epoch: 5, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.080 Vali Acc: 0.974 Test Loss: 0.080 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0056151
	speed: 0.5940s/iter; left time: 23248.1570s
	iters: 200, epoch: 6 | loss: 0.0020715
	speed: 0.2965s/iter; left time: 11572.8135s
	iters: 300, epoch: 6 | loss: 0.0581780
	speed: 0.2889s/iter; left time: 11249.6255s
	iters: 400, epoch: 6 | loss: 0.0406158
	speed: 0.2829s/iter; left time: 10985.4778s
Epoch: 6 cost time: 120.97379565238953
Epoch: 6, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0045301
	speed: 0.5519s/iter; left time: 21372.0442s
	iters: 200, epoch: 7 | loss: 0.0018529
	speed: 0.2776s/iter; left time: 10723.5168s
	iters: 300, epoch: 7 | loss: 0.0467790
	speed: 0.3005s/iter; left time: 11577.4163s
	iters: 400, epoch: 7 | loss: 0.0025449
	speed: 0.3070s/iter; left time: 11795.9772s
Epoch: 7 cost time: 122.29660201072693
Epoch: 7, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.073 Vali Acc: 0.979 Test Loss: 0.073 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0013368
	speed: 0.5601s/iter; left time: 21457.6999s
	iters: 200, epoch: 8 | loss: 0.0030790
	speed: 0.2940s/iter; left time: 11234.6816s
	iters: 300, epoch: 8 | loss: 0.0807907
	speed: 0.2953s/iter; left time: 11252.1371s
	iters: 400, epoch: 8 | loss: 0.0112776
	speed: 0.2965s/iter; left time: 11268.4165s
Epoch: 8 cost time: 120.63558411598206
Epoch: 8, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.057 Vali Acc: 0.980 Test Loss: 0.057 Test Acc: 0.980
Validation loss decreased (-0.979536 --> -0.979536).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0205457
	speed: 0.5812s/iter; left time: 22025.1184s
	iters: 200, epoch: 9 | loss: 0.0014499
	speed: 0.2717s/iter; left time: 10268.6475s
	iters: 300, epoch: 9 | loss: 0.0284751
	speed: 0.2728s/iter; left time: 10285.4581s
	iters: 400, epoch: 9 | loss: 0.0133055
	speed: 0.2976s/iter; left time: 11187.0033s
Epoch: 9 cost time: 118.56594586372375
Epoch: 9, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0008952
	speed: 0.5866s/iter; left time: 21989.0889s
	iters: 200, epoch: 10 | loss: 0.0021247
	speed: 0.3055s/iter; left time: 11420.5558s
	iters: 300, epoch: 10 | loss: 0.0215625
	speed: 0.2859s/iter; left time: 10658.9211s
	iters: 400, epoch: 10 | loss: 0.1009792
	speed: 0.2893s/iter; left time: 10758.7640s
Epoch: 10 cost time: 122.61402702331543
Epoch: 10, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.081 Vali Acc: 0.975 Test Loss: 0.081 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0322587
	speed: 0.5751s/iter; left time: 21319.2485s
	iters: 200, epoch: 11 | loss: 0.0003813
	speed: 0.3047s/iter; left time: 11266.0340s
	iters: 300, epoch: 11 | loss: 0.0125104
	speed: 0.2893s/iter; left time: 10668.3795s
	iters: 400, epoch: 11 | loss: 0.0008165
	speed: 0.2807s/iter; left time: 10322.0815s
Epoch: 11 cost time: 119.97574543952942
Epoch: 11, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979536 --> -0.980445).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.2464554
	speed: 0.5814s/iter; left time: 21312.8196s
	iters: 200, epoch: 12 | loss: 0.0613552
	speed: 0.2982s/iter; left time: 10900.1956s
	iters: 300, epoch: 12 | loss: 0.0773462
	speed: 0.3158s/iter; left time: 11511.9175s
	iters: 400, epoch: 12 | loss: 0.0002676
	speed: 0.2786s/iter; left time: 10130.3193s
Epoch: 12 cost time: 123.24931359291077
Epoch: 12, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0191254
	speed: 0.5733s/iter; left time: 20780.3709s
	iters: 200, epoch: 13 | loss: 0.0195316
	speed: 0.2842s/iter; left time: 10271.7290s
	iters: 300, epoch: 13 | loss: 0.0000525
	speed: 0.3038s/iter; left time: 10951.8481s
	iters: 400, epoch: 13 | loss: 0.0694657
	speed: 0.3024s/iter; left time: 10868.6507s
Epoch: 13 cost time: 122.4255096912384
Epoch: 13, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0075491
	speed: 0.5699s/iter; left time: 20419.6541s
	iters: 200, epoch: 14 | loss: 0.4920178
	speed: 0.2793s/iter; left time: 9981.1064s
	iters: 300, epoch: 14 | loss: 0.0002983
	speed: 0.3127s/iter; left time: 11142.4790s
	iters: 400, epoch: 14 | loss: 0.0007628
	speed: 0.3128s/iter; left time: 11113.6490s
Epoch: 14 cost time: 123.99084258079529
Epoch: 14, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.056 Vali Acc: 0.981 Test Loss: 0.056 Test Acc: 0.981
Validation loss decreased (-0.980445 --> -0.981355).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0036988
	speed: 0.5867s/iter; left time: 20780.6443s
	iters: 200, epoch: 15 | loss: 0.0008031
	speed: 0.2843s/iter; left time: 10042.8637s
	iters: 300, epoch: 15 | loss: 0.0000141
	speed: 0.2925s/iter; left time: 10299.8836s
	iters: 400, epoch: 15 | loss: 0.0025623
	speed: 0.3042s/iter; left time: 10681.9360s
Epoch: 15 cost time: 121.68775463104248
Epoch: 15, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.085 Vali Acc: 0.975 Test Loss: 0.085 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0088227
	speed: 0.5853s/iter; left time: 20488.3984s
	iters: 200, epoch: 16 | loss: 0.0064425
	speed: 0.2791s/iter; left time: 9742.6448s
	iters: 300, epoch: 16 | loss: 0.2686650
	speed: 0.3015s/iter; left time: 10495.3545s
	iters: 400, epoch: 16 | loss: 0.0076135
	speed: 0.3129s/iter; left time: 10859.3578s
Epoch: 16 cost time: 123.74040651321411
Epoch: 16, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0012996
	speed: 0.5724s/iter; left time: 19800.2781s
	iters: 200, epoch: 17 | loss: 0.0001915
	speed: 0.2986s/iter; left time: 10300.2374s
	iters: 300, epoch: 17 | loss: 0.0077441
	speed: 0.2900s/iter; left time: 9975.2743s
	iters: 400, epoch: 17 | loss: 0.0000576
	speed: 0.2924s/iter; left time: 10026.8868s
Epoch: 17 cost time: 120.73212718963623
Epoch: 17, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.094 Vali Acc: 0.982 Test Loss: 0.094 Test Acc: 0.982
Validation loss decreased (-0.981355 --> -0.982264).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0005764
	speed: 0.5902s/iter; left time: 20172.2049s
	iters: 200, epoch: 18 | loss: 0.0002360
	speed: 0.2780s/iter; left time: 9473.5933s
	iters: 300, epoch: 18 | loss: 0.0003150
	speed: 0.2909s/iter; left time: 9886.3957s
	iters: 400, epoch: 18 | loss: 0.0000508
	speed: 0.2963s/iter; left time: 10038.7969s
Epoch: 18 cost time: 119.62127804756165
Epoch: 18, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0009569
	speed: 0.6096s/iter; left time: 20582.9094s
	iters: 200, epoch: 19 | loss: 0.0070147
	speed: 0.2954s/iter; left time: 9946.1360s
	iters: 300, epoch: 19 | loss: 0.0000626
	speed: 0.2711s/iter; left time: 9099.3485s
	iters: 400, epoch: 19 | loss: 0.0000088
	speed: 0.2942s/iter; left time: 9847.1022s
Epoch: 19 cost time: 121.23117351531982
Epoch: 19, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.079 Vali Acc: 0.975 Test Loss: 0.079 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000263
	speed: 0.5914s/iter; left time: 19725.4796s
	iters: 200, epoch: 20 | loss: 0.0001495
	speed: 0.3001s/iter; left time: 9979.5670s
	iters: 300, epoch: 20 | loss: 0.0006918
	speed: 0.2905s/iter; left time: 9630.6637s
	iters: 400, epoch: 20 | loss: 0.0320627
	speed: 0.2937s/iter; left time: 9706.7546s
Epoch: 20 cost time: 122.24188303947449
Epoch: 20, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000481
	speed: 0.5797s/iter; left time: 19096.7332s
	iters: 200, epoch: 21 | loss: 0.0001130
	speed: 0.3136s/iter; left time: 10299.3861s
	iters: 300, epoch: 21 | loss: 0.0802250
	speed: 0.2877s/iter; left time: 9421.1479s
	iters: 400, epoch: 21 | loss: 0.0003300
	speed: 0.2994s/iter; left time: 9771.4050s
Epoch: 21 cost time: 124.60912537574768
Epoch: 21, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.062 Vali Acc: 0.982 Test Loss: 0.062 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0002336
	speed: 0.5910s/iter; left time: 19224.0426s
	iters: 200, epoch: 22 | loss: 0.0000249
	speed: 0.3038s/iter; left time: 9851.0527s
	iters: 300, epoch: 22 | loss: 0.3599720
	speed: 0.2780s/iter; left time: 8988.2731s
	iters: 400, epoch: 22 | loss: 0.0002299
	speed: 0.2831s/iter; left time: 9125.3235s
Epoch: 22 cost time: 120.60575580596924
Epoch: 22, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0000093
	speed: 0.5767s/iter; left time: 18521.3931s
	iters: 200, epoch: 23 | loss: 0.0000004
	speed: 0.2778s/iter; left time: 8893.3569s
	iters: 300, epoch: 23 | loss: 0.0006826
	speed: 0.2891s/iter; left time: 9225.3379s
	iters: 400, epoch: 23 | loss: 0.2219672
	speed: 0.2838s/iter; left time: 9027.7020s
Epoch: 23 cost time: 117.59195613861084
Epoch: 23, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.079 Vali Acc: 0.985 Test Loss: 0.079 Test Acc: 0.985
Validation loss decreased (-0.982264 --> -0.984538).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000075
	speed: 0.6034s/iter; left time: 19128.2134s
	iters: 200, epoch: 24 | loss: 0.0002100
	speed: 0.2951s/iter; left time: 9326.6120s
	iters: 300, epoch: 24 | loss: 0.0001404
	speed: 0.3096s/iter; left time: 9754.4005s
	iters: 400, epoch: 24 | loss: 0.0001264
	speed: 0.2952s/iter; left time: 9269.8979s
Epoch: 24 cost time: 124.76713061332703
Epoch: 24, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0008192
	speed: 0.5892s/iter; left time: 18435.0320s
	iters: 200, epoch: 25 | loss: 0.0000032
	speed: 0.2826s/iter; left time: 8812.6730s
	iters: 300, epoch: 25 | loss: 0.0085127
	speed: 0.2925s/iter; left time: 9093.9402s
	iters: 400, epoch: 25 | loss: 0.0172167
	speed: 0.2996s/iter; left time: 9283.4321s
Epoch: 25 cost time: 121.99168610572815
Epoch: 25, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.078 Vali Acc: 0.979 Test Loss: 0.078 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0053530
	speed: 0.5934s/iter; left time: 18320.4515s
	iters: 200, epoch: 26 | loss: 0.1714716
	speed: 0.3044s/iter; left time: 9367.2671s
	iters: 300, epoch: 26 | loss: 0.0006216
	speed: 0.3075s/iter; left time: 9432.6629s
	iters: 400, epoch: 26 | loss: 0.0000262
	speed: 0.3102s/iter; left time: 9485.0149s
Epoch: 26 cost time: 126.67285060882568
Epoch: 26, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.073 Vali Acc: 0.982 Test Loss: 0.073 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0000052
	speed: 0.5610s/iter; left time: 17090.0567s
	iters: 200, epoch: 27 | loss: 0.0002616
	speed: 0.2877s/iter; left time: 8735.6256s
	iters: 300, epoch: 27 | loss: 0.0000042
	speed: 0.3093s/iter; left time: 9361.7130s
	iters: 400, epoch: 27 | loss: 0.0000006
	speed: 0.3133s/iter; left time: 9451.5458s
Epoch: 27 cost time: 124.15922331809998
Epoch: 27, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0000247
	speed: 0.5873s/iter; left time: 17647.9559s
	iters: 200, epoch: 28 | loss: 0.0001311
	speed: 0.3137s/iter; left time: 9394.3912s
	iters: 300, epoch: 28 | loss: 0.0001754
	speed: 0.3068s/iter; left time: 9158.1085s
	iters: 400, epoch: 28 | loss: 0.0002106
	speed: 0.2864s/iter; left time: 8519.6266s
Epoch: 28 cost time: 126.29449892044067
Epoch: 28, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.116 Vali Acc: 0.972 Test Loss: 0.116 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0000301
	speed: 0.6078s/iter; left time: 18012.0865s
	iters: 200, epoch: 29 | loss: 0.0000067
	speed: 0.2960s/iter; left time: 8741.7078s
	iters: 300, epoch: 29 | loss: 0.0011429
	speed: 0.2960s/iter; left time: 8712.7486s
	iters: 400, epoch: 29 | loss: 0.0000178
	speed: 0.2898s/iter; left time: 8502.5164s
Epoch: 29 cost time: 124.13131546974182
Epoch: 29, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.070 Vali Acc: 0.985 Test Loss: 0.070 Test Acc: 0.985
Validation loss decreased (-0.984538 --> -0.984992).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.6034s/iter; left time: 17634.7031s
	iters: 200, epoch: 30 | loss: 0.0004302
	speed: 0.3115s/iter; left time: 9071.0615s
	iters: 300, epoch: 30 | loss: 0.0001112
	speed: 0.3044s/iter; left time: 8835.4563s
	iters: 400, epoch: 30 | loss: 0.0003797
	speed: 0.3012s/iter; left time: 8713.2734s
Epoch: 30 cost time: 126.69042778015137
Epoch: 30, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0000066
	speed: 0.6000s/iter; left time: 17286.2339s
	iters: 200, epoch: 31 | loss: 0.0000006
	speed: 0.3068s/iter; left time: 8808.6526s
	iters: 300, epoch: 31 | loss: 0.0001005
	speed: 0.3022s/iter; left time: 8647.3310s
	iters: 400, epoch: 31 | loss: 0.0000046
	speed: 0.3012s/iter; left time: 8586.4627s
Epoch: 31 cost time: 124.88095283508301
Epoch: 31, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0000004
	speed: 0.6148s/iter; left time: 17459.7975s
	iters: 200, epoch: 32 | loss: 0.0742930
	speed: 0.3003s/iter; left time: 8498.3719s
	iters: 300, epoch: 32 | loss: 0.0000063
	speed: 0.2942s/iter; left time: 8296.2310s
	iters: 400, epoch: 32 | loss: 0.0017153
	speed: 0.2996s/iter; left time: 8416.8154s
Epoch: 32 cost time: 126.41872954368591
Epoch: 32, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.077 Vali Acc: 0.979 Test Loss: 0.077 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.0000006
	speed: 0.5810s/iter; left time: 16259.0196s
	iters: 200, epoch: 33 | loss: 0.0000320
	speed: 0.3008s/iter; left time: 8388.6815s
	iters: 300, epoch: 33 | loss: 0.0000121
	speed: 0.2811s/iter; left time: 7809.6588s
	iters: 400, epoch: 33 | loss: 0.0877775
	speed: 0.2789s/iter; left time: 7721.3364s
Epoch: 33 cost time: 118.26982307434082
Epoch: 33, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.059 Vali Acc: 0.986 Test Loss: 0.059 Test Acc: 0.986
Validation loss decreased (-0.984992 --> -0.985902).  Saving model ...
	iters: 100, epoch: 34 | loss: 0.0000054
	speed: 0.5922s/iter; left time: 16328.4868s
	iters: 200, epoch: 34 | loss: 0.0000001
	speed: 0.2795s/iter; left time: 7679.1270s
	iters: 300, epoch: 34 | loss: 0.0000007
	speed: 0.2935s/iter; left time: 8033.9711s
	iters: 400, epoch: 34 | loss: 0.0000205
	speed: 0.3066s/iter; left time: 8362.4027s
Epoch: 34 cost time: 121.31697630882263
Epoch: 34, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.081 Vali Acc: 0.985 Test Loss: 0.081 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 0.0004080
	speed: 0.5774s/iter; left time: 15681.2128s
	iters: 200, epoch: 35 | loss: 0.0000027
	speed: 0.3102s/iter; left time: 8393.0716s
	iters: 300, epoch: 35 | loss: 0.0000228
	speed: 0.2738s/iter; left time: 7381.6134s
	iters: 400, epoch: 35 | loss: 0.0000024
	speed: 0.2863s/iter; left time: 7690.0262s
Epoch: 35 cost time: 120.68057250976562
Epoch: 35, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 36 | loss: 0.0003605
	speed: 0.5851s/iter; left time: 15650.2390s
	iters: 200, epoch: 36 | loss: 0.0000056
	speed: 0.2992s/iter; left time: 7972.6593s
	iters: 300, epoch: 36 | loss: 0.0143952
	speed: 0.3126s/iter; left time: 8299.0141s
	iters: 400, epoch: 36 | loss: 0.0000013
	speed: 0.2929s/iter; left time: 7747.1809s
Epoch: 36 cost time: 124.07840657234192
Epoch: 36, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.985 Test Loss: 0.075 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 37 | loss: 0.0000014
	speed: 0.5791s/iter; left time: 15248.2648s
	iters: 200, epoch: 37 | loss: 0.0020831
	speed: 0.2827s/iter; left time: 7417.3294s
	iters: 300, epoch: 37 | loss: 0.0000035
	speed: 0.3073s/iter; left time: 8030.4984s
	iters: 400, epoch: 37 | loss: 0.0000318
	speed: 0.3088s/iter; left time: 8039.9087s
Epoch: 37 cost time: 123.51913905143738
Epoch: 37, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.070 Vali Acc: 0.984 Test Loss: 0.070 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 38 | loss: 0.0000091
	speed: 0.5657s/iter; left time: 14663.3865s
	iters: 200, epoch: 38 | loss: 0.0002909
	speed: 0.3018s/iter; left time: 7793.7336s
	iters: 300, epoch: 38 | loss: 0.0024792
	speed: 0.2864s/iter; left time: 7365.3476s
	iters: 400, epoch: 38 | loss: 0.0000101
	speed: 0.2910s/iter; left time: 7454.1675s
Epoch: 38 cost time: 121.4313690662384
Epoch: 38, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.131 Vali Acc: 0.974 Test Loss: 0.131 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 39 | loss: 0.0144061
	speed: 0.5808s/iter; left time: 14814.7938s
	iters: 200, epoch: 39 | loss: 0.0000000
	speed: 0.2694s/iter; left time: 6844.1467s
	iters: 300, epoch: 39 | loss: 0.0000224
	speed: 0.2771s/iter; left time: 7011.4894s
	iters: 400, epoch: 39 | loss: 0.0000091
	speed: 0.2940s/iter; left time: 7410.6480s
Epoch: 39 cost time: 117.65275835990906
Epoch: 39, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 40 | loss: 0.0000001
	speed: 0.5830s/iter; left time: 14629.1435s
	iters: 200, epoch: 40 | loss: 0.0166235
	speed: 0.2912s/iter; left time: 7278.1443s
	iters: 300, epoch: 40 | loss: 0.0000095
	speed: 0.2905s/iter; left time: 7231.7730s
	iters: 400, epoch: 40 | loss: 0.0071964
	speed: 0.2847s/iter; left time: 7059.8375s
Epoch: 40 cost time: 119.88301706314087
Epoch: 40, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.155 Vali Acc: 0.973 Test Loss: 0.155 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 41 | loss: 0.0000020
	speed: 0.6039s/iter; left time: 14905.2616s
	iters: 200, epoch: 41 | loss: 0.0000000
	speed: 0.3017s/iter; left time: 7416.3390s
	iters: 300, epoch: 41 | loss: 0.0000057
	speed: 0.2814s/iter; left time: 6888.4203s
	iters: 400, epoch: 41 | loss: 0.0000027
	speed: 0.3070s/iter; left time: 7484.8816s
Epoch: 41 cost time: 124.4709370136261
Epoch: 41, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.979 Test Loss: 0.100 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 42 | loss: 0.0000002
	speed: 0.5736s/iter; left time: 13921.2544s
	iters: 200, epoch: 42 | loss: 0.0074301
	speed: 0.2878s/iter; left time: 6954.6503s
	iters: 300, epoch: 42 | loss: 0.0031947
	speed: 0.2895s/iter; left time: 6967.9774s
	iters: 400, epoch: 42 | loss: 0.0000016
	speed: 0.2975s/iter; left time: 7130.6592s
Epoch: 42 cost time: 120.65178680419922
Epoch: 42, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 43 | loss: 0.0009501
	speed: 0.6076s/iter; left time: 14493.8843s
	iters: 200, epoch: 43 | loss: 0.0030067
	speed: 0.2679s/iter; left time: 6364.6777s
	iters: 300, epoch: 43 | loss: 0.0000302
	speed: 0.2826s/iter; left time: 6686.0491s
	iters: 400, epoch: 43 | loss: 0.0000230
	speed: 0.2805s/iter; left time: 6606.6919s
Epoch: 43 cost time: 116.80302834510803
Epoch: 43, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.168 Vali Acc: 0.972 Test Loss: 0.168 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9859026830377444
model parameter : 265546
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.3017948
	speed: 0.3013s/iter; left time: 12414.6491s
	iters: 200, epoch: 1 | loss: 2.3051133
	speed: 0.2612s/iter; left time: 10735.5261s
	iters: 300, epoch: 1 | loss: 2.3051496
	speed: 0.2873s/iter; left time: 11779.4050s
	iters: 400, epoch: 1 | loss: 2.3046837
	speed: 0.2977s/iter; left time: 12178.1751s
Epoch: 1 cost time: 118.82917356491089
Epoch: 1, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (inf --> -0.099568).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3004429
	speed: 0.5907s/iter; left time: 24095.1313s
	iters: 200, epoch: 2 | loss: 2.3037117
	speed: 0.2845s/iter; left time: 11577.4608s
	iters: 300, epoch: 2 | loss: 2.3022945
	speed: 0.2978s/iter; left time: 12085.5000s
	iters: 400, epoch: 2 | loss: 2.3030696
	speed: 0.3122s/iter; left time: 12640.8604s
Epoch: 2 cost time: 124.046635389328
Epoch: 2, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.099568 --> -0.099568).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3019137
	speed: 0.5698s/iter; left time: 23004.9362s
	iters: 200, epoch: 3 | loss: 2.3027892
	speed: 0.2976s/iter; left time: 11984.2812s
	iters: 300, epoch: 3 | loss: 2.3032246
	speed: 0.2925s/iter; left time: 11752.7274s
	iters: 400, epoch: 3 | loss: 2.3032537
	speed: 0.2794s/iter; left time: 11196.7412s
Epoch: 3 cost time: 120.10992503166199
Epoch: 3, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.3021107
	speed: 0.5585s/iter; left time: 22317.5381s
	iters: 200, epoch: 4 | loss: 2.3029490
	speed: 0.2932s/iter; left time: 11686.5539s
	iters: 300, epoch: 4 | loss: 2.3033099
	speed: 0.2987s/iter; left time: 11876.8928s
	iters: 400, epoch: 4 | loss: 2.3032701
	speed: 0.3021s/iter; left time: 11983.5448s
Epoch: 4 cost time: 121.81368780136108
Epoch: 4, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.3019092
	speed: 0.5627s/iter; left time: 22255.7292s
	iters: 200, epoch: 5 | loss: 2.3029716
	speed: 0.2935s/iter; left time: 11577.7043s
	iters: 300, epoch: 5 | loss: 2.3025482
	speed: 0.2822s/iter; left time: 11104.5805s
	iters: 400, epoch: 5 | loss: 2.3024395
	speed: 0.2749s/iter; left time: 10790.9641s
Epoch: 5 cost time: 117.31311535835266
Epoch: 5, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.099568 --> -0.100022).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.3023562
	speed: 0.5805s/iter; left time: 22718.6186s
	iters: 200, epoch: 6 | loss: 2.3046794
	speed: 0.2983s/iter; left time: 11645.8171s
	iters: 300, epoch: 6 | loss: 2.3052051
	speed: 0.2847s/iter; left time: 11085.9397s
	iters: 400, epoch: 6 | loss: 2.3031318
	speed: 0.2973s/iter; left time: 11547.6181s
Epoch: 6 cost time: 122.85182118415833
Epoch: 6, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.3019142
	speed: 0.5720s/iter; left time: 22149.7502s
	iters: 200, epoch: 7 | loss: 2.3035126
	speed: 0.2958s/iter; left time: 11424.0945s
	iters: 300, epoch: 7 | loss: 2.3013170
	speed: 0.2781s/iter; left time: 10713.8988s
	iters: 400, epoch: 7 | loss: 2.3033988
	speed: 0.2887s/iter; left time: 11094.1034s
Epoch: 7 cost time: 119.39756965637207
Epoch: 7, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.3010855
	speed: 0.6023s/iter; left time: 23075.7595s
	iters: 200, epoch: 8 | loss: 2.3061643
	speed: 0.2875s/iter; left time: 10986.2336s
	iters: 300, epoch: 8 | loss: 2.3033571
	speed: 0.2859s/iter; left time: 10897.0337s
	iters: 400, epoch: 8 | loss: 2.3037739
	speed: 0.3105s/iter; left time: 11803.1923s
Epoch: 8 cost time: 124.46177339553833
Epoch: 8, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 2.3018434
	speed: 0.5833s/iter; left time: 22105.6453s
	iters: 200, epoch: 9 | loss: 2.3026509
	speed: 0.2782s/iter; left time: 10515.0183s
	iters: 300, epoch: 9 | loss: 2.3026824
	speed: 0.2867s/iter; left time: 10809.1506s
	iters: 400, epoch: 9 | loss: 2.3036427
	speed: 0.2955s/iter; left time: 11110.9406s
Epoch: 9 cost time: 118.75754928588867
Epoch: 9, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 2.3008034
	speed: 0.5660s/iter; left time: 21214.7506s
	iters: 200, epoch: 10 | loss: 2.3024015
	speed: 0.2984s/iter; left time: 11153.9588s
	iters: 300, epoch: 10 | loss: 2.3032982
	speed: 0.2975s/iter; left time: 11090.5848s
	iters: 400, epoch: 10 | loss: 2.3036766
	speed: 0.2992s/iter; left time: 11127.1993s
Epoch: 10 cost time: 121.33283257484436
Epoch: 10, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 2.2968650
	speed: 0.5751s/iter; left time: 21318.7958s
	iters: 200, epoch: 11 | loss: 2.3043356
	speed: 0.2802s/iter; left time: 10360.1577s
	iters: 300, epoch: 11 | loss: 2.3059096
	speed: 0.3133s/iter; left time: 11551.0169s
	iters: 400, epoch: 11 | loss: 2.3002625
	speed: 0.2979s/iter; left time: 10953.3072s
Epoch: 11 cost time: 121.84724760055542
Epoch: 11, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 12 | loss: 2.2974386
	speed: 0.5789s/iter; left time: 21222.8798s
	iters: 200, epoch: 12 | loss: 2.3055356
	speed: 0.3053s/iter; left time: 11160.5467s
	iters: 300, epoch: 12 | loss: 2.3031092
	speed: 0.2962s/iter; left time: 10799.6210s
	iters: 400, epoch: 12 | loss: 2.3036363
	speed: 0.2932s/iter; left time: 10658.7735s
Epoch: 12 cost time: 123.53709197044373
Epoch: 12, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 2.3087256
	speed: 0.5883s/iter; left time: 21323.1133s
	iters: 200, epoch: 13 | loss: 2.3023808
	speed: 0.2972s/iter; left time: 10742.4019s
	iters: 300, epoch: 13 | loss: 2.3018243
	speed: 0.3090s/iter; left time: 11138.7586s
	iters: 400, epoch: 13 | loss: 2.3009143
	speed: 0.2885s/iter; left time: 10371.6335s
Epoch: 13 cost time: 122.5450451374054
Epoch: 13, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 2.3031523
	speed: 0.5772s/iter; left time: 20683.9101s
	iters: 200, epoch: 14 | loss: 2.3019321
	speed: 0.3164s/iter; left time: 11303.8390s
	iters: 300, epoch: 14 | loss: 2.3029857
	speed: 0.2974s/iter; left time: 10596.7071s
	iters: 400, epoch: 14 | loss: 2.3019609
	speed: 0.2933s/iter; left time: 10422.1261s
Epoch: 14 cost time: 126.26951909065247
Epoch: 14, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 2.3045082
	speed: 0.6041s/iter; left time: 21397.5581s
	iters: 200, epoch: 15 | loss: 2.3056865
	speed: 0.2916s/iter; left time: 10297.9013s
	iters: 300, epoch: 15 | loss: 2.3047087
	speed: 0.3144s/iter; left time: 11072.2201s
	iters: 400, epoch: 15 | loss: 2.3034606
	speed: 0.2729s/iter; left time: 9582.9612s
Epoch: 15 cost time: 121.59153246879578
Epoch: 15, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 2.3012700
	speed: 0.5953s/iter; left time: 20839.1679s
	iters: 200, epoch: 16 | loss: 2.3036547
	speed: 0.2890s/iter; left time: 10086.6905s
	iters: 300, epoch: 16 | loss: 2.3012350
	speed: 0.2645s/iter; left time: 9207.0258s
	iters: 400, epoch: 16 | loss: 2.3042581
	speed: 0.2856s/iter; left time: 9911.5733s
Epoch: 16 cost time: 119.58486080169678
Epoch: 16, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 2.3024237
	speed: 0.6240s/iter; left time: 21586.2483s
	iters: 200, epoch: 17 | loss: 2.3027380
	speed: 0.2971s/iter; left time: 10249.3922s
	iters: 300, epoch: 17 | loss: 2.2998931
	speed: 0.3169s/iter; left time: 10899.3643s
	iters: 400, epoch: 17 | loss: 2.3024697
	speed: 0.2841s/iter; left time: 9741.5358s
Epoch: 17 cost time: 124.10917711257935
Epoch: 17, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 2.3010015
	speed: 0.5987s/iter; left time: 20462.5957s
	iters: 200, epoch: 18 | loss: 2.3078675
	speed: 0.2743s/iter; left time: 9348.9947s
	iters: 300, epoch: 18 | loss: 2.3060088
	speed: 0.2929s/iter; left time: 9953.9929s
	iters: 400, epoch: 18 | loss: 2.3037858
	speed: 0.3181s/iter; left time: 10776.8618s
Epoch: 18 cost time: 123.10484790802002
Epoch: 18, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 2.3069453
	speed: 0.5612s/iter; left time: 18948.6291s
	iters: 200, epoch: 19 | loss: 2.3050866
	speed: 0.3068s/iter; left time: 10329.1967s
	iters: 300, epoch: 19 | loss: 2.3032365
	speed: 0.3023s/iter; left time: 10147.7867s
	iters: 400, epoch: 19 | loss: 2.3055391
	speed: 0.2814s/iter; left time: 9417.7884s
Epoch: 19 cost time: 121.33577084541321
Epoch: 19, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 2.3029509
	speed: 0.5788s/iter; left time: 19306.5139s
	iters: 200, epoch: 20 | loss: 2.2979550
	speed: 0.2737s/iter; left time: 9103.0741s
	iters: 300, epoch: 20 | loss: 2.3016171
	speed: 0.2868s/iter; left time: 9507.2705s
	iters: 400, epoch: 20 | loss: 2.3035717
	speed: 0.2911s/iter; left time: 9620.6743s
Epoch: 20 cost time: 119.17109656333923
Epoch: 20, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 2.2996480
	speed: 0.6106s/iter; left time: 20114.0425s
	iters: 200, epoch: 21 | loss: 2.3033147
	speed: 0.2936s/iter; left time: 9643.7466s
	iters: 300, epoch: 21 | loss: 2.3026109
	speed: 0.2846s/iter; left time: 9317.1392s
	iters: 400, epoch: 21 | loss: 2.3020766
	speed: 0.3124s/iter; left time: 10196.2045s
Epoch: 21 cost time: 123.91494488716125
Epoch: 21, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.10004547521600728
model parameter : 265546
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         47                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df512_ma47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.2356036
	speed: 0.3126s/iter; left time: 12879.0963s
	iters: 200, epoch: 1 | loss: 0.3261687
	speed: 0.2844s/iter; left time: 11690.2836s
	iters: 300, epoch: 1 | loss: 0.2349108
	speed: 0.2906s/iter; left time: 11913.4601s
	iters: 400, epoch: 1 | loss: 0.1889490
	speed: 0.3260s/iter; left time: 13333.8650s
Epoch: 1 cost time: 125.66639423370361
Epoch: 1, Steps: 413 | Train Loss: 0.833 Vali Loss: 0.156 Vali Acc: 0.961 Test Loss: 0.156 Test Acc: 0.961
Validation loss decreased (inf --> -0.960890).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2341363
	speed: 0.5812s/iter; left time: 23706.7607s
	iters: 200, epoch: 2 | loss: 0.0291217
	speed: 0.2965s/iter; left time: 12062.4177s
	iters: 300, epoch: 2 | loss: 0.1744368
	speed: 0.2876s/iter; left time: 11673.9579s
	iters: 400, epoch: 2 | loss: 0.1225406
	speed: 0.2983s/iter; left time: 12075.8910s
Epoch: 2 cost time: 122.66300535202026
Epoch: 2, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.960890 --> -0.982719).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0768924
	speed: 0.5492s/iter; left time: 22175.9458s
	iters: 200, epoch: 3 | loss: 0.0570776
	speed: 0.3000s/iter; left time: 12083.0513s
	iters: 300, epoch: 3 | loss: 0.2299841
	speed: 0.2769s/iter; left time: 11125.9816s
	iters: 400, epoch: 3 | loss: 0.0875858
	speed: 0.2691s/iter; left time: 10783.6769s
Epoch: 3 cost time: 116.7628846168518
Epoch: 3, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.058 Vali Acc: 0.982 Test Loss: 0.058 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0242662
	speed: 0.5606s/iter; left time: 22401.5105s
	iters: 200, epoch: 4 | loss: 0.0529406
	speed: 0.2945s/iter; left time: 11739.7342s
	iters: 300, epoch: 4 | loss: 0.0153822
	speed: 0.2883s/iter; left time: 11465.0785s
	iters: 400, epoch: 4 | loss: 0.0197799
	speed: 0.2708s/iter; left time: 10739.9664s
Epoch: 4 cost time: 118.49827933311462
Epoch: 4, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.067 Vali Acc: 0.979 Test Loss: 0.067 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0769873
	speed: 0.5719s/iter; left time: 22619.7207s
	iters: 200, epoch: 5 | loss: 0.0745734
	speed: 0.2745s/iter; left time: 10827.7502s
	iters: 300, epoch: 5 | loss: 0.0021792
	speed: 0.2724s/iter; left time: 10718.3636s
	iters: 400, epoch: 5 | loss: 0.0045476
	speed: 0.2784s/iter; left time: 10927.1368s
Epoch: 5 cost time: 115.58309841156006
Epoch: 5, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.054 Vali Acc: 0.980 Test Loss: 0.054 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0032573
	speed: 0.6021s/iter; left time: 23563.0705s
	iters: 200, epoch: 6 | loss: 0.0046542
	speed: 0.2955s/iter; left time: 11533.4143s
	iters: 300, epoch: 6 | loss: 0.0595521
	speed: 0.3178s/iter; left time: 12373.8780s
	iters: 400, epoch: 6 | loss: 0.0140590
	speed: 0.2886s/iter; left time: 11208.6378s
Epoch: 6 cost time: 124.0850293636322
Epoch: 6, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.052 Vali Acc: 0.983 Test Loss: 0.052 Test Acc: 0.983
Validation loss decreased (-0.982719 --> -0.983174).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0091158
	speed: 0.5982s/iter; left time: 23162.5948s
	iters: 200, epoch: 7 | loss: 0.0290157
	speed: 0.3042s/iter; left time: 11747.3461s
	iters: 300, epoch: 7 | loss: 0.0118134
	speed: 0.2837s/iter; left time: 10928.0876s
	iters: 400, epoch: 7 | loss: 0.0003240
	speed: 0.2935s/iter; left time: 11277.5075s
Epoch: 7 cost time: 124.13346934318542
Epoch: 7, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.045 Vali Acc: 0.986 Test Loss: 0.045 Test Acc: 0.986
Validation loss decreased (-0.983174 --> -0.986357).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0002144
	speed: 0.6032s/iter; left time: 23107.0788s
	iters: 200, epoch: 8 | loss: 0.0014784
	speed: 0.2989s/iter; left time: 11420.9511s
	iters: 300, epoch: 8 | loss: 0.0806108
	speed: 0.2920s/iter; left time: 11129.0583s
	iters: 400, epoch: 8 | loss: 0.0034179
	speed: 0.3137s/iter; left time: 11922.5128s
Epoch: 8 cost time: 126.02325534820557
Epoch: 8, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.031 Vali Acc: 0.989 Test Loss: 0.031 Test Acc: 0.989
Validation loss decreased (-0.986357 --> -0.988631).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0004195
	speed: 0.5740s/iter; left time: 21751.3557s
	iters: 200, epoch: 9 | loss: 0.0218789
	speed: 0.3050s/iter; left time: 11526.4242s
	iters: 300, epoch: 9 | loss: 0.0045928
	speed: 0.2984s/iter; left time: 11250.3421s
	iters: 400, epoch: 9 | loss: 0.0171032
	speed: 0.2973s/iter; left time: 11177.8897s
Epoch: 9 cost time: 124.69508695602417
Epoch: 9, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.049 Vali Acc: 0.984 Test Loss: 0.049 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0018685
	speed: 0.5627s/iter; left time: 21093.4383s
	iters: 200, epoch: 10 | loss: 0.0567738
	speed: 0.3158s/iter; left time: 11805.3630s
	iters: 300, epoch: 10 | loss: 0.0111035
	speed: 0.2996s/iter; left time: 11170.7634s
	iters: 400, epoch: 10 | loss: 0.0038734
	speed: 0.2958s/iter; left time: 10998.7985s
Epoch: 10 cost time: 124.95715713500977
Epoch: 10, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.076 Vali Acc: 0.975 Test Loss: 0.076 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0030971
	speed: 0.5953s/iter; left time: 22067.0068s
	iters: 200, epoch: 11 | loss: 0.0001136
	speed: 0.3181s/iter; left time: 11761.6347s
	iters: 300, epoch: 11 | loss: 0.0195860
	speed: 0.3158s/iter; left time: 11642.6213s
	iters: 400, epoch: 11 | loss: 0.0038899
	speed: 0.2935s/iter; left time: 10794.0183s
Epoch: 11 cost time: 125.7602276802063
Epoch: 11, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0007700
	speed: 0.5968s/iter; left time: 21876.2939s
	iters: 200, epoch: 12 | loss: 0.0041210
	speed: 0.3074s/iter; left time: 11238.8822s
	iters: 300, epoch: 12 | loss: 0.0003512
	speed: 0.3010s/iter; left time: 10975.0761s
	iters: 400, epoch: 12 | loss: 0.0722618
	speed: 0.2725s/iter; left time: 9906.0222s
Epoch: 12 cost time: 123.38330340385437
Epoch: 12, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0006299
	speed: 0.6171s/iter; left time: 22365.2574s
	iters: 200, epoch: 13 | loss: 0.0005335
	speed: 0.2894s/iter; left time: 10460.7071s
	iters: 300, epoch: 13 | loss: 0.0656988
	speed: 0.3181s/iter; left time: 11466.0962s
	iters: 400, epoch: 13 | loss: 0.0003057
	speed: 0.3107s/iter; left time: 11169.7787s
Epoch: 13 cost time: 127.7502110004425
Epoch: 13, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0018358
	speed: 0.6096s/iter; left time: 21843.8355s
	iters: 200, epoch: 14 | loss: 0.0226134
	speed: 0.2878s/iter; left time: 10282.4940s
	iters: 300, epoch: 14 | loss: 0.0000143
	speed: 0.2933s/iter; left time: 10449.1245s
	iters: 400, epoch: 14 | loss: 0.0004460
	speed: 0.3041s/iter; left time: 10804.4002s
Epoch: 14 cost time: 124.760901927948
Epoch: 14, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.042 Vali Acc: 0.988 Test Loss: 0.042 Test Acc: 0.988
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0008717
	speed: 0.6071s/iter; left time: 21504.6221s
	iters: 200, epoch: 15 | loss: 0.0008335
	speed: 0.2837s/iter; left time: 10020.1476s
	iters: 300, epoch: 15 | loss: 0.0000205
	speed: 0.2999s/iter; left time: 10561.7718s
	iters: 400, epoch: 15 | loss: 0.0000590
	speed: 0.3106s/iter; left time: 10906.8783s
Epoch: 15 cost time: 125.00693655014038
Epoch: 15, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.049 Vali Acc: 0.985 Test Loss: 0.049 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0004349
	speed: 0.6022s/iter; left time: 21078.9547s
	iters: 200, epoch: 16 | loss: 0.0006122
	speed: 0.3132s/iter; left time: 10931.3923s
	iters: 300, epoch: 16 | loss: 0.0009732
	speed: 0.3041s/iter; left time: 10584.9149s
	iters: 400, epoch: 16 | loss: 0.0000664
	speed: 0.3080s/iter; left time: 10691.1604s
Epoch: 16 cost time: 127.66902470588684
Epoch: 16, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0100403
	speed: 0.5876s/iter; left time: 20325.6063s
	iters: 200, epoch: 17 | loss: 0.0002283
	speed: 0.2963s/iter; left time: 10220.7796s
	iters: 300, epoch: 17 | loss: 0.0049638
	speed: 0.2946s/iter; left time: 10132.1758s
	iters: 400, epoch: 17 | loss: 0.0070674
	speed: 0.2935s/iter; left time: 10063.4512s
Epoch: 17 cost time: 121.89943361282349
Epoch: 17, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0541670
	speed: 0.5795s/iter; left time: 19807.1799s
	iters: 200, epoch: 18 | loss: 0.0002646
	speed: 0.2935s/iter; left time: 10001.0085s
	iters: 300, epoch: 18 | loss: 0.0016484
	speed: 0.2997s/iter; left time: 10183.1491s
	iters: 400, epoch: 18 | loss: 0.0032315
	speed: 0.3012s/iter; left time: 10205.7671s
Epoch: 18 cost time: 123.33536314964294
Epoch: 18, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df512_ma47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.988631195998181
model parameter : 167242
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         38                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df512_ma38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.3798470
	speed: 0.3048s/iter; left time: 12559.0310s
	iters: 200, epoch: 1 | loss: 0.4487371
	speed: 0.2632s/iter; left time: 10819.2851s
	iters: 300, epoch: 1 | loss: 0.2533148
	speed: 0.2837s/iter; left time: 11633.4193s
	iters: 400, epoch: 1 | loss: 0.2357557
	speed: 0.2831s/iter; left time: 11578.3121s
Epoch: 1 cost time: 117.32203793525696
Epoch: 1, Steps: 413 | Train Loss: 0.890 Vali Loss: 0.163 Vali Acc: 0.964 Test Loss: 0.163 Test Acc: 0.964
Validation loss decreased (inf --> -0.964073).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2591180
	speed: 0.5851s/iter; left time: 23866.3479s
	iters: 200, epoch: 2 | loss: 0.0347125
	speed: 0.2896s/iter; left time: 11781.7540s
	iters: 300, epoch: 2 | loss: 0.1552558
	speed: 0.2878s/iter; left time: 11679.7971s
	iters: 400, epoch: 2 | loss: 0.0937239
	speed: 0.2632s/iter; left time: 10658.2899s
Epoch: 2 cost time: 118.90312027931213
Epoch: 2, Steps: 413 | Train Loss: 0.144 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.964073 --> -0.983174).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0902628
	speed: 0.5362s/iter; left time: 21648.4350s
	iters: 200, epoch: 3 | loss: 0.0806187
	speed: 0.2640s/iter; left time: 10630.7283s
	iters: 300, epoch: 3 | loss: 0.2713830
	speed: 0.2567s/iter; left time: 10311.1691s
	iters: 400, epoch: 3 | loss: 0.1000977
	speed: 0.2872s/iter; left time: 11508.1480s
Epoch: 3 cost time: 113.3306257724762
Epoch: 3, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.051 Vali Acc: 0.982 Test Loss: 0.051 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0289757
	speed: 0.5210s/iter; left time: 20818.3443s
	iters: 200, epoch: 4 | loss: 0.0104422
	speed: 0.2691s/iter; left time: 10728.1248s
	iters: 300, epoch: 4 | loss: 0.0329702
	speed: 0.2546s/iter; left time: 10121.5126s
	iters: 400, epoch: 4 | loss: 0.0311942
	speed: 0.2723s/iter; left time: 10798.9017s
Epoch: 4 cost time: 110.48912286758423
Epoch: 4, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.051 Vali Acc: 0.983 Test Loss: 0.051 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0372712
	speed: 0.5151s/iter; left time: 20369.9915s
	iters: 200, epoch: 5 | loss: 0.0497090
	speed: 0.2788s/iter; left time: 11000.2322s
	iters: 300, epoch: 5 | loss: 0.0048977
	speed: 0.2519s/iter; left time: 9911.5196s
	iters: 400, epoch: 5 | loss: 0.0220010
	speed: 0.2715s/iter; left time: 10657.3550s
Epoch: 5 cost time: 110.03186678886414
Epoch: 5, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.045 Vali Acc: 0.983 Test Loss: 0.045 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0011629
	speed: 0.4973s/iter; left time: 19461.8587s
	iters: 200, epoch: 6 | loss: 0.0066827
	speed: 0.2751s/iter; left time: 10740.3842s
	iters: 300, epoch: 6 | loss: 0.0122322
	speed: 0.2906s/iter; left time: 11316.2475s
	iters: 400, epoch: 6 | loss: 0.0441596
	speed: 0.2724s/iter; left time: 10577.1336s
Epoch: 6 cost time: 112.32219409942627
Epoch: 6, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.048 Vali Acc: 0.985 Test Loss: 0.048 Test Acc: 0.985
Validation loss decreased (-0.983174 --> -0.984538).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0030026
	speed: 0.5485s/iter; left time: 21238.5767s
	iters: 200, epoch: 7 | loss: 0.0015540
	speed: 0.2724s/iter; left time: 10521.5561s
	iters: 300, epoch: 7 | loss: 0.0015478
	speed: 0.2755s/iter; left time: 10613.5656s
	iters: 400, epoch: 7 | loss: 0.0017067
	speed: 0.2650s/iter; left time: 10180.7488s
Epoch: 7 cost time: 112.86698627471924
Epoch: 7, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.052 Vali Acc: 0.982 Test Loss: 0.052 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0001514
	speed: 0.5356s/iter; left time: 20517.8106s
	iters: 200, epoch: 8 | loss: 0.0080340
	speed: 0.2807s/iter; left time: 10725.9925s
	iters: 300, epoch: 8 | loss: 0.0017624
	speed: 0.2585s/iter; left time: 9851.1971s
	iters: 400, epoch: 8 | loss: 0.0222129
	speed: 0.2766s/iter; left time: 10514.7670s
Epoch: 8 cost time: 112.72332239151001
Epoch: 8, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.042 Vali Acc: 0.987 Test Loss: 0.042 Test Acc: 0.987
Validation loss decreased (-0.984538 --> -0.986812).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0001694
	speed: 0.5467s/iter; left time: 20719.0652s
	iters: 200, epoch: 9 | loss: 0.0127476
	speed: 0.2803s/iter; left time: 10594.4712s
	iters: 300, epoch: 9 | loss: 0.0064986
	speed: 0.2816s/iter; left time: 10616.3445s
	iters: 400, epoch: 9 | loss: 0.0460787
	speed: 0.2823s/iter; left time: 10612.4067s
Epoch: 9 cost time: 116.16117358207703
Epoch: 9, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.060 Vali Acc: 0.983 Test Loss: 0.060 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0004230
	speed: 0.5257s/iter; left time: 19706.9493s
	iters: 200, epoch: 10 | loss: 0.0141259
	speed: 0.2619s/iter; left time: 9789.4967s
	iters: 300, epoch: 10 | loss: 0.0009987
	speed: 0.2700s/iter; left time: 10066.5011s
	iters: 400, epoch: 10 | loss: 0.0003840
	speed: 0.2735s/iter; left time: 10168.5903s
Epoch: 10 cost time: 112.69106984138489
Epoch: 10, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.051 Vali Acc: 0.984 Test Loss: 0.051 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0001426
	speed: 0.5435s/iter; left time: 20149.2924s
	iters: 200, epoch: 11 | loss: 0.0000784
	speed: 0.2814s/iter; left time: 10404.4789s
	iters: 300, epoch: 11 | loss: 0.0054743
	speed: 0.2926s/iter; left time: 10789.3618s
	iters: 400, epoch: 11 | loss: 0.2051328
	speed: 0.2659s/iter; left time: 9777.0136s
Epoch: 11 cost time: 116.10124182701111
Epoch: 11, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.055 Vali Acc: 0.985 Test Loss: 0.055 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000751
	speed: 0.5261s/iter; left time: 19284.2045s
	iters: 200, epoch: 12 | loss: 0.0005959
	speed: 0.2579s/iter; left time: 9428.9257s
	iters: 300, epoch: 12 | loss: 0.0024449
	speed: 0.2638s/iter; left time: 9619.0985s
	iters: 400, epoch: 12 | loss: 0.0816761
	speed: 0.2644s/iter; left time: 9613.6014s
Epoch: 12 cost time: 107.70350503921509
Epoch: 12, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.052 Vali Acc: 0.987 Test Loss: 0.052 Test Acc: 0.987
Validation loss decreased (-0.986812 --> -0.987266).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000737
	speed: 0.5236s/iter; left time: 18978.2930s
	iters: 200, epoch: 13 | loss: 0.0001667
	speed: 0.2651s/iter; left time: 9582.9540s
	iters: 300, epoch: 13 | loss: 0.0043967
	speed: 0.2539s/iter; left time: 9152.7375s
	iters: 400, epoch: 13 | loss: 0.0000127
	speed: 0.2762s/iter; left time: 9927.8243s
Epoch: 13 cost time: 110.03484654426575
Epoch: 13, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.050 Vali Acc: 0.987 Test Loss: 0.050 Test Acc: 0.987
Validation loss decreased (-0.987266 --> -0.987266).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000809
	speed: 0.5262s/iter; left time: 18855.3688s
	iters: 200, epoch: 14 | loss: 0.0001342
	speed: 0.2724s/iter; left time: 9733.2443s
	iters: 300, epoch: 14 | loss: 0.0014623
	speed: 0.2773s/iter; left time: 9881.4598s
	iters: 400, epoch: 14 | loss: 0.0930822
	speed: 0.2617s/iter; left time: 9299.9891s
Epoch: 14 cost time: 112.16549396514893
Epoch: 14, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000462
	speed: 0.5206s/iter; left time: 18438.7181s
	iters: 200, epoch: 15 | loss: 0.0001555
	speed: 0.2611s/iter; left time: 9223.2706s
	iters: 300, epoch: 15 | loss: 0.0000030
	speed: 0.2637s/iter; left time: 9286.4557s
	iters: 400, epoch: 15 | loss: 0.0001465
	speed: 0.2649s/iter; left time: 9301.3966s
Epoch: 15 cost time: 109.40399074554443
Epoch: 15, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.089 Vali Acc: 0.979 Test Loss: 0.089 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0035114
	speed: 0.5391s/iter; left time: 18872.8323s
	iters: 200, epoch: 16 | loss: 0.0010104
	speed: 0.2766s/iter; left time: 9655.6357s
	iters: 300, epoch: 16 | loss: 0.0001626
	speed: 0.2753s/iter; left time: 9582.2542s
	iters: 400, epoch: 16 | loss: 0.0005321
	speed: 0.2771s/iter; left time: 9617.1260s
Epoch: 16 cost time: 115.25398087501526
Epoch: 16, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0019920
	speed: 0.5384s/iter; left time: 18623.8601s
	iters: 200, epoch: 17 | loss: 0.0000663
	speed: 0.2741s/iter; left time: 9453.9940s
	iters: 300, epoch: 17 | loss: 0.0162210
	speed: 0.2705s/iter; left time: 9304.6658s
	iters: 400, epoch: 17 | loss: 0.0000352
	speed: 0.2751s/iter; left time: 9433.8002s
Epoch: 17 cost time: 112.75268292427063
Epoch: 17, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.067 Vali Acc: 0.981 Test Loss: 0.067 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0018822
	speed: 0.5267s/iter; left time: 18002.1433s
	iters: 200, epoch: 18 | loss: 0.0004402
	speed: 0.2725s/iter; left time: 9286.0300s
	iters: 300, epoch: 18 | loss: 0.0083674
	speed: 0.2553s/iter; left time: 8674.4809s
	iters: 400, epoch: 18 | loss: 0.0000297
	speed: 0.2602s/iter; left time: 8816.5732s
Epoch: 18 cost time: 109.6748595237732
Epoch: 18, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.046 Vali Acc: 0.989 Test Loss: 0.046 Test Acc: 0.989
Validation loss decreased (-0.987266 --> -0.988631).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0003398
	speed: 0.5198s/iter; left time: 17553.1428s
	iters: 200, epoch: 19 | loss: 0.0013906
	speed: 0.2773s/iter; left time: 9336.9135s
	iters: 300, epoch: 19 | loss: 0.0000769
	speed: 0.2640s/iter; left time: 8861.2429s
	iters: 400, epoch: 19 | loss: 0.0092070
	speed: 0.2773s/iter; left time: 9279.8982s
Epoch: 19 cost time: 110.52105855941772
Epoch: 19, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.069 Vali Acc: 0.984 Test Loss: 0.069 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0002570
	speed: 0.5147s/iter; left time: 17168.8710s
	iters: 200, epoch: 20 | loss: 0.0000019
	speed: 0.2507s/iter; left time: 8336.2883s
	iters: 300, epoch: 20 | loss: 0.0027013
	speed: 0.2708s/iter; left time: 8976.4805s
	iters: 400, epoch: 20 | loss: 0.0001066
	speed: 0.2493s/iter; left time: 8241.6125s
Epoch: 20 cost time: 108.51902770996094
Epoch: 20, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0004382
	speed: 0.5223s/iter; left time: 17203.7961s
	iters: 200, epoch: 21 | loss: 0.0000161
	speed: 0.2759s/iter; left time: 9060.7836s
	iters: 300, epoch: 21 | loss: 0.0000122
	speed: 0.2631s/iter; left time: 8614.1695s
	iters: 400, epoch: 21 | loss: 0.0003860
	speed: 0.2737s/iter; left time: 8934.6024s
Epoch: 21 cost time: 110.23980355262756
Epoch: 21, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0000315
	speed: 0.5139s/iter; left time: 16716.9502s
	iters: 200, epoch: 22 | loss: 0.0004204
	speed: 0.2739s/iter; left time: 8881.2770s
	iters: 300, epoch: 22 | loss: 0.0000009
	speed: 0.2718s/iter; left time: 8788.1998s
	iters: 400, epoch: 22 | loss: 0.0000345
	speed: 0.2620s/iter; left time: 8443.5624s
Epoch: 22 cost time: 111.20285034179688
Epoch: 22, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0000471
	speed: 0.5209s/iter; left time: 16729.4650s
	iters: 200, epoch: 23 | loss: 0.0001970
	speed: 0.2762s/iter; left time: 8841.3921s
	iters: 300, epoch: 23 | loss: 0.0000281
	speed: 0.2558s/iter; left time: 8164.5003s
	iters: 400, epoch: 23 | loss: 0.0300277
	speed: 0.2830s/iter; left time: 9002.7566s
Epoch: 23 cost time: 112.04199242591858
Epoch: 23, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0001669
	speed: 0.5294s/iter; left time: 16783.7151s
	iters: 200, epoch: 24 | loss: 0.0000443
	speed: 0.2505s/iter; left time: 7915.3469s
	iters: 300, epoch: 24 | loss: 0.0002735
	speed: 0.2565s/iter; left time: 8081.6262s
	iters: 400, epoch: 24 | loss: 0.0018709
	speed: 0.2539s/iter; left time: 7972.2015s
Epoch: 24 cost time: 106.8851387500763
Epoch: 24, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0090659
	speed: 0.5285s/iter; left time: 16536.9826s
	iters: 200, epoch: 25 | loss: 0.0000250
	speed: 0.2770s/iter; left time: 8640.5527s
	iters: 300, epoch: 25 | loss: 0.0000001
	speed: 0.2785s/iter; left time: 8658.2693s
	iters: 400, epoch: 25 | loss: 0.0000256
	speed: 0.2736s/iter; left time: 8479.9986s
Epoch: 25 cost time: 113.75151658058167
Epoch: 25, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.061 Vali Acc: 0.984 Test Loss: 0.061 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0003137
	speed: 0.5411s/iter; left time: 16707.6072s
	iters: 200, epoch: 26 | loss: 0.0050315
	speed: 0.2656s/iter; left time: 8174.4532s
	iters: 300, epoch: 26 | loss: 0.0000017
	speed: 0.2573s/iter; left time: 7894.1706s
	iters: 400, epoch: 26 | loss: 0.0000093
	speed: 0.2518s/iter; left time: 7699.4656s
Epoch: 26 cost time: 109.47991561889648
Epoch: 26, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0000042
	speed: 0.5086s/iter; left time: 15493.3738s
	iters: 200, epoch: 27 | loss: 0.0000519
	speed: 0.2845s/iter; left time: 8639.7703s
	iters: 300, epoch: 27 | loss: 0.0000332
	speed: 0.2621s/iter; left time: 7932.6793s
	iters: 400, epoch: 27 | loss: 0.1051455
	speed: 0.2872s/iter; left time: 8663.8931s
Epoch: 27 cost time: 112.70986604690552
Epoch: 27, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0000291
	speed: 0.5380s/iter; left time: 16167.3572s
	iters: 200, epoch: 28 | loss: 0.0000007
	speed: 0.2617s/iter; left time: 7837.8603s
	iters: 300, epoch: 28 | loss: 0.0000018
	speed: 0.2841s/iter; left time: 8480.5037s
	iters: 400, epoch: 28 | loss: 0.2012919
	speed: 0.2698s/iter; left time: 8027.6801s
Epoch: 28 cost time: 114.11869263648987
Epoch: 28, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df512_ma38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.988631195998181
model parameter : 167242
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         28                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df512_ma28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.4653058
	speed: 0.2922s/iter; left time: 12037.7270s
	iters: 200, epoch: 1 | loss: 0.5835151
	speed: 0.2716s/iter; left time: 11161.6985s
	iters: 300, epoch: 1 | loss: 0.3484998
	speed: 0.2744s/iter; left time: 11252.1732s
	iters: 400, epoch: 1 | loss: 0.2633773
	speed: 0.2487s/iter; left time: 10173.4263s
Epoch: 1 cost time: 112.40990781784058
Epoch: 1, Steps: 413 | Train Loss: 0.977 Vali Loss: 0.193 Vali Acc: 0.960 Test Loss: 0.193 Test Acc: 0.960
Validation loss decreased (inf --> -0.960435).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3807879
	speed: 0.5208s/iter; left time: 21242.6330s
	iters: 200, epoch: 2 | loss: 0.0491885
	speed: 0.2684s/iter; left time: 10921.6513s
	iters: 300, epoch: 2 | loss: 0.2459513
	speed: 0.2763s/iter; left time: 11212.4455s
	iters: 400, epoch: 2 | loss: 0.2304417
	speed: 0.2792s/iter; left time: 11305.7183s
Epoch: 2 cost time: 112.19172072410583
Epoch: 2, Steps: 413 | Train Loss: 0.162 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.960435 --> -0.979990).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0529699
	speed: 0.5201s/iter; left time: 21000.2758s
	iters: 200, epoch: 3 | loss: 0.0700564
	speed: 0.2650s/iter; left time: 10673.1253s
	iters: 300, epoch: 3 | loss: 0.1984786
	speed: 0.2553s/iter; left time: 10258.6054s
	iters: 400, epoch: 3 | loss: 0.1217955
	speed: 0.2871s/iter; left time: 11507.3759s
Epoch: 3 cost time: 111.62003540992737
Epoch: 3, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.061 Vali Acc: 0.980 Test Loss: 0.061 Test Acc: 0.980
Validation loss decreased (-0.979990 --> -0.979990).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0303354
	speed: 0.5240s/iter; left time: 20938.2738s
	iters: 200, epoch: 4 | loss: 0.0271390
	speed: 0.2528s/iter; left time: 10078.3395s
	iters: 300, epoch: 4 | loss: 0.0396847
	speed: 0.2794s/iter; left time: 11110.9256s
	iters: 400, epoch: 4 | loss: 0.0485728
	speed: 0.2575s/iter; left time: 10213.3995s
Epoch: 4 cost time: 109.79777431488037
Epoch: 4, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.067 Vali Acc: 0.977 Test Loss: 0.067 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0271442
	speed: 0.5234s/iter; left time: 20700.4150s
	iters: 200, epoch: 5 | loss: 0.0235051
	speed: 0.2877s/iter; left time: 11349.2552s
	iters: 300, epoch: 5 | loss: 0.0028863
	speed: 0.2802s/iter; left time: 11025.5749s
	iters: 400, epoch: 5 | loss: 0.0122984
	speed: 0.2548s/iter; left time: 10001.7574s
Epoch: 5 cost time: 112.9952335357666
Epoch: 5, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.051 Vali Acc: 0.981 Test Loss: 0.051 Test Acc: 0.981
Validation loss decreased (-0.979990 --> -0.980900).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0031313
	speed: 0.5117s/iter; left time: 20026.4359s
	iters: 200, epoch: 6 | loss: 0.0044614
	speed: 0.2518s/iter; left time: 9830.7944s
	iters: 300, epoch: 6 | loss: 0.0305680
	speed: 0.2676s/iter; left time: 10419.0208s
	iters: 400, epoch: 6 | loss: 0.0110951
	speed: 0.2505s/iter; left time: 9729.4139s
Epoch: 6 cost time: 106.88526749610901
Epoch: 6, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.063 Vali Acc: 0.976 Test Loss: 0.063 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0025245
	speed: 0.5423s/iter; left time: 21000.6924s
	iters: 200, epoch: 7 | loss: 0.0031576
	speed: 0.2889s/iter; left time: 11158.2587s
	iters: 300, epoch: 7 | loss: 0.0006357
	speed: 0.2639s/iter; left time: 10167.7514s
	iters: 400, epoch: 7 | loss: 0.0072831
	speed: 0.2886s/iter; left time: 11090.2849s
Epoch: 7 cost time: 114.73129653930664
Epoch: 7, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.052 Vali Acc: 0.980 Test Loss: 0.052 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0002902
	speed: 0.5326s/iter; left time: 20402.2070s
	iters: 200, epoch: 8 | loss: 0.0027749
	speed: 0.2553s/iter; left time: 9755.3691s
	iters: 300, epoch: 8 | loss: 0.0626873
	speed: 0.2869s/iter; left time: 10932.3513s
	iters: 400, epoch: 8 | loss: 0.0316683
	speed: 0.2507s/iter; left time: 9527.8589s
Epoch: 8 cost time: 112.07336163520813
Epoch: 8, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.070 Vali Acc: 0.978 Test Loss: 0.070 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0003864
	speed: 0.5247s/iter; left time: 19883.3897s
	iters: 200, epoch: 9 | loss: 0.0006952
	speed: 0.2703s/iter; left time: 10217.1076s
	iters: 300, epoch: 9 | loss: 0.0090771
	speed: 0.2798s/iter; left time: 10547.9036s
	iters: 400, epoch: 9 | loss: 0.0026586
	speed: 0.2898s/iter; left time: 10894.7662s
Epoch: 9 cost time: 114.24290108680725
Epoch: 9, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.061 Vali Acc: 0.982 Test Loss: 0.061 Test Acc: 0.982
Validation loss decreased (-0.980900 --> -0.982264).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0001130
	speed: 0.5371s/iter; left time: 20134.1867s
	iters: 200, epoch: 10 | loss: 0.0018206
	speed: 0.2692s/iter; left time: 10063.9608s
	iters: 300, epoch: 10 | loss: 0.0075354
	speed: 0.2809s/iter; left time: 10474.9154s
	iters: 400, epoch: 10 | loss: 0.0037920
	speed: 0.2718s/iter; left time: 10104.8512s
Epoch: 10 cost time: 113.66918396949768
Epoch: 10, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0027488
	speed: 0.5461s/iter; left time: 20244.0752s
	iters: 200, epoch: 11 | loss: 0.0006391
	speed: 0.2855s/iter; left time: 10553.5262s
	iters: 300, epoch: 11 | loss: 0.0003665
	speed: 0.2612s/iter; left time: 9631.5852s
	iters: 400, epoch: 11 | loss: 0.0039222
	speed: 0.2670s/iter; left time: 9818.4210s
Epoch: 11 cost time: 113.49088788032532
Epoch: 11, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.120 Vali Acc: 0.963 Test Loss: 0.120 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0007308
	speed: 0.5352s/iter; left time: 19619.1411s
	iters: 200, epoch: 12 | loss: 0.0708380
	speed: 0.2868s/iter; left time: 10483.1227s
	iters: 300, epoch: 12 | loss: 0.0013557
	speed: 0.2818s/iter; left time: 10274.4536s
	iters: 400, epoch: 12 | loss: 0.0844462
	speed: 0.2736s/iter; left time: 9949.2369s
Epoch: 12 cost time: 115.29845690727234
Epoch: 12, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.070 Vali Acc: 0.976 Test Loss: 0.070 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0001270
	speed: 0.5105s/iter; left time: 18502.9237s
	iters: 200, epoch: 13 | loss: 0.0046005
	speed: 0.2842s/iter; left time: 10272.8630s
	iters: 300, epoch: 13 | loss: 0.0034088
	speed: 0.2702s/iter; left time: 9739.7495s
	iters: 400, epoch: 13 | loss: 0.0000028
	speed: 0.2747s/iter; left time: 9874.1962s
Epoch: 13 cost time: 112.24159860610962
Epoch: 13, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.065 Vali Acc: 0.982 Test Loss: 0.065 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0004822
	speed: 0.5435s/iter; left time: 19473.0677s
	iters: 200, epoch: 14 | loss: 0.0000243
	speed: 0.2746s/iter; left time: 9812.1917s
	iters: 300, epoch: 14 | loss: 0.0007947
	speed: 0.2773s/iter; left time: 9881.5882s
	iters: 400, epoch: 14 | loss: 0.0786482
	speed: 0.2703s/iter; left time: 9603.2697s
Epoch: 14 cost time: 114.64514470100403
Epoch: 14, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.059 Vali Acc: 0.984 Test Loss: 0.059 Test Acc: 0.984
Validation loss decreased (-0.982264 --> -0.983628).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0007992
	speed: 0.5306s/iter; left time: 18794.5885s
	iters: 200, epoch: 15 | loss: 0.0000477
	speed: 0.2798s/iter; left time: 9881.8603s
	iters: 300, epoch: 15 | loss: 0.0012843
	speed: 0.2718s/iter; left time: 9571.3678s
	iters: 400, epoch: 15 | loss: 0.0003683
	speed: 0.2793s/iter; left time: 9807.6346s
Epoch: 15 cost time: 113.11762189865112
Epoch: 15, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.082 Vali Acc: 0.975 Test Loss: 0.082 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000360
	speed: 0.5194s/iter; left time: 18182.9355s
	iters: 200, epoch: 16 | loss: 0.0002387
	speed: 0.2659s/iter; left time: 9282.2037s
	iters: 300, epoch: 16 | loss: 0.0202234
	speed: 0.2806s/iter; left time: 9767.6242s
	iters: 400, epoch: 16 | loss: 0.0762922
	speed: 0.2644s/iter; left time: 9176.0472s
Epoch: 16 cost time: 112.83726263046265
Epoch: 16, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0010558
	speed: 0.5327s/iter; left time: 18428.2857s
	iters: 200, epoch: 17 | loss: 0.0000462
	speed: 0.2723s/iter; left time: 9394.1640s
	iters: 300, epoch: 17 | loss: 0.0156109
	speed: 0.2604s/iter; left time: 8955.5509s
	iters: 400, epoch: 17 | loss: 0.0000089
	speed: 0.2656s/iter; left time: 9108.3882s
Epoch: 17 cost time: 109.97295069694519
Epoch: 17, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.063 Vali Acc: 0.984 Test Loss: 0.063 Test Acc: 0.984
Validation loss decreased (-0.983628 --> -0.984083).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0026276
	speed: 0.5283s/iter; left time: 18055.7313s
	iters: 200, epoch: 18 | loss: 0.0000425
	speed: 0.2662s/iter; left time: 9072.3905s
	iters: 300, epoch: 18 | loss: 0.0049719
	speed: 0.2571s/iter; left time: 8736.5758s
	iters: 400, epoch: 18 | loss: 0.0001495
	speed: 0.2770s/iter; left time: 9384.9081s
Epoch: 18 cost time: 112.25579881668091
Epoch: 18, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000458
	speed: 0.5243s/iter; left time: 17702.6988s
	iters: 200, epoch: 19 | loss: 0.0009891
	speed: 0.2609s/iter; left time: 8782.0785s
	iters: 300, epoch: 19 | loss: 0.0067516
	speed: 0.2844s/iter; left time: 9545.8541s
	iters: 400, epoch: 19 | loss: 0.0003236
	speed: 0.2676s/iter; left time: 8955.7366s
Epoch: 19 cost time: 113.43444848060608
Epoch: 19, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0002291
	speed: 0.5605s/iter; left time: 18694.1455s
	iters: 200, epoch: 20 | loss: 0.0003248
	speed: 0.2787s/iter; left time: 9268.2014s
	iters: 300, epoch: 20 | loss: 0.0000232
	speed: 0.2540s/iter; left time: 8421.3018s
	iters: 400, epoch: 20 | loss: 0.0336058
	speed: 0.2682s/iter; left time: 8863.5996s
Epoch: 20 cost time: 112.51185345649719
Epoch: 20, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0002702
	speed: 0.5253s/iter; left time: 17302.2676s
	iters: 200, epoch: 21 | loss: 0.0000092
	speed: 0.2616s/iter; left time: 8591.1579s
	iters: 300, epoch: 21 | loss: 0.0000196
	speed: 0.2801s/iter; left time: 9171.5599s
	iters: 400, epoch: 21 | loss: 0.0000174
	speed: 0.2827s/iter; left time: 9228.1287s
Epoch: 21 cost time: 114.29894351959229
Epoch: 21, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.069 Vali Acc: 0.986 Test Loss: 0.069 Test Acc: 0.986
Validation loss decreased (-0.984083 --> -0.985902).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0007353
	speed: 0.5474s/iter; left time: 17805.1636s
	iters: 200, epoch: 22 | loss: 0.2938012
	speed: 0.2894s/iter; left time: 9385.5064s
	iters: 300, epoch: 22 | loss: 0.0012479
	speed: 0.2760s/iter; left time: 8923.6406s
	iters: 400, epoch: 22 | loss: 0.0010458
	speed: 0.2909s/iter; left time: 9376.2326s
Epoch: 22 cost time: 117.14438247680664
Epoch: 22, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.054 Vali Acc: 0.985 Test Loss: 0.054 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0006028
	speed: 0.5297s/iter; left time: 17012.1666s
	iters: 200, epoch: 23 | loss: 0.0003010
	speed: 0.2680s/iter; left time: 8581.3623s
	iters: 300, epoch: 23 | loss: 0.0008648
	speed: 0.2817s/iter; left time: 8991.0734s
	iters: 400, epoch: 23 | loss: 0.0000020
	speed: 0.2685s/iter; left time: 8542.7591s
Epoch: 23 cost time: 113.95538592338562
Epoch: 23, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.047 Vali Acc: 0.989 Test Loss: 0.047 Test Acc: 0.989
Validation loss decreased (-0.985902 --> -0.988631).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000350
	speed: 0.5515s/iter; left time: 17484.3937s
	iters: 200, epoch: 24 | loss: 0.0000279
	speed: 0.2676s/iter; left time: 8455.3363s
	iters: 300, epoch: 24 | loss: 0.0001343
	speed: 0.2730s/iter; left time: 8601.1375s
	iters: 400, epoch: 24 | loss: 0.0451245
	speed: 0.2882s/iter; left time: 9051.1843s
Epoch: 24 cost time: 114.16693902015686
Epoch: 24, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.063 Vali Acc: 0.988 Test Loss: 0.063 Test Acc: 0.988
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0027150
	speed: 0.5314s/iter; left time: 16625.9150s
	iters: 200, epoch: 25 | loss: 0.0000594
	speed: 0.2637s/iter; left time: 8223.1941s
	iters: 300, epoch: 25 | loss: 0.0000002
	speed: 0.2927s/iter; left time: 9099.2672s
	iters: 400, epoch: 25 | loss: 0.0000987
	speed: 0.2545s/iter; left time: 7885.2724s
Epoch: 25 cost time: 112.4435966014862
Epoch: 25, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.070 Vali Acc: 0.985 Test Loss: 0.070 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0000144
	speed: 0.5368s/iter; left time: 16573.0586s
	iters: 200, epoch: 26 | loss: 0.0000065
	speed: 0.2794s/iter; left time: 8598.0272s
	iters: 300, epoch: 26 | loss: 0.0010229
	speed: 0.2662s/iter; left time: 8165.9204s
	iters: 400, epoch: 26 | loss: 0.0000076
	speed: 0.2841s/iter; left time: 8687.6772s
Epoch: 26 cost time: 113.88862085342407
Epoch: 26, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.985 Test Loss: 0.079 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0003964
	speed: 0.5488s/iter; left time: 16716.8974s
	iters: 200, epoch: 27 | loss: 0.0037292
	speed: 0.2686s/iter; left time: 8154.8206s
	iters: 300, epoch: 27 | loss: 0.0000075
	speed: 0.2799s/iter; left time: 8470.6189s
	iters: 400, epoch: 27 | loss: 0.0002321
	speed: 0.2616s/iter; left time: 7891.8469s
Epoch: 27 cost time: 113.48389339447021
Epoch: 27, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.125 Vali Acc: 0.974 Test Loss: 0.125 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0001002
	speed: 0.5450s/iter; left time: 16378.6515s
	iters: 200, epoch: 28 | loss: 0.0000486
	speed: 0.2822s/iter; left time: 8453.0294s
	iters: 300, epoch: 28 | loss: 0.0311652
	speed: 0.2626s/iter; left time: 7838.7925s
	iters: 400, epoch: 28 | loss: 0.0001119
	speed: 0.2804s/iter; left time: 8343.2360s
Epoch: 28 cost time: 114.61086964607239
Epoch: 28, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.058 Vali Acc: 0.987 Test Loss: 0.058 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0001351
	speed: 0.5508s/iter; left time: 16323.0949s
	iters: 200, epoch: 29 | loss: 0.0002635
	speed: 0.2634s/iter; left time: 7778.9695s
	iters: 300, epoch: 29 | loss: 0.0000002
	speed: 0.2722s/iter; left time: 8013.9270s
	iters: 400, epoch: 29 | loss: 0.0000159
	speed: 0.2636s/iter; left time: 7731.9835s
Epoch: 29 cost time: 111.89652752876282
Epoch: 29, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.061 Vali Acc: 0.987 Test Loss: 0.061 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0000555
	speed: 0.5315s/iter; left time: 15531.3139s
	iters: 200, epoch: 30 | loss: 0.0356909
	speed: 0.2658s/iter; left time: 7742.3694s
	iters: 300, epoch: 30 | loss: 0.0085622
	speed: 0.2656s/iter; left time: 7710.1397s
	iters: 400, epoch: 30 | loss: 0.0000010
	speed: 0.2642s/iter; left time: 7642.4982s
Epoch: 30 cost time: 110.67333030700684
Epoch: 30, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.064 Vali Acc: 0.986 Test Loss: 0.064 Test Acc: 0.986
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.1169130
	speed: 0.5065s/iter; left time: 14592.2649s
	iters: 200, epoch: 31 | loss: 0.0000480
	speed: 0.2667s/iter; left time: 7657.6751s
	iters: 300, epoch: 31 | loss: 0.0038769
	speed: 0.2807s/iter; left time: 8030.9916s
	iters: 400, epoch: 31 | loss: 0.0000106
	speed: 0.2757s/iter; left time: 7859.2641s
Epoch: 31 cost time: 112.20497441291809
Epoch: 31, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0007004
	speed: 0.5313s/iter; left time: 15088.1256s
	iters: 200, epoch: 32 | loss: 0.0000812
	speed: 0.2837s/iter; left time: 8028.4199s
	iters: 300, epoch: 32 | loss: 0.0004543
	speed: 0.2670s/iter; left time: 7528.5894s
	iters: 400, epoch: 32 | loss: 0.0000122
	speed: 0.2742s/iter; left time: 7704.4636s
Epoch: 32 cost time: 112.84078860282898
Epoch: 32, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.108 Vali Acc: 0.981 Test Loss: 0.108 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0000124
	speed: 0.5259s/iter; left time: 14718.6659s
	iters: 200, epoch: 33 | loss: 0.0035038
	speed: 0.2696s/iter; left time: 7517.5762s
	iters: 300, epoch: 33 | loss: 0.0021550
	speed: 0.2687s/iter; left time: 7464.6699s
	iters: 400, epoch: 33 | loss: 0.0000585
	speed: 0.2733s/iter; left time: 7567.1253s
Epoch: 33 cost time: 113.43075227737427
Epoch: 33, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.071 Vali Acc: 0.985 Test Loss: 0.071 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df512_ma28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.988631195998181
model parameter : 167242
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df512_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.6802593
	speed: 0.3015s/iter; left time: 12420.4604s
	iters: 200, epoch: 1 | loss: 0.8555413
	speed: 0.2789s/iter; left time: 11464.8758s
	iters: 300, epoch: 1 | loss: 0.5579444
	speed: 0.2820s/iter; left time: 11560.8875s
	iters: 400, epoch: 1 | loss: 0.3351817
	speed: 0.2560s/iter; left time: 10472.0740s
Epoch: 1 cost time: 115.61853981018066
Epoch: 1, Steps: 413 | Train Loss: 1.107 Vali Loss: 0.220 Vali Acc: 0.951 Test Loss: 0.220 Test Acc: 0.951
Validation loss decreased (inf --> -0.951339).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3169278
	speed: 0.5236s/iter; left time: 21358.4189s
	iters: 200, epoch: 2 | loss: 0.1178936
	speed: 0.2752s/iter; left time: 11196.3764s
	iters: 300, epoch: 2 | loss: 0.1363349
	speed: 0.2565s/iter; left time: 10409.6048s
	iters: 400, epoch: 2 | loss: 0.1825692
	speed: 0.2800s/iter; left time: 11335.3039s
Epoch: 2 cost time: 111.13958287239075
Epoch: 2, Steps: 413 | Train Loss: 0.162 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
Validation loss decreased (-0.951339 --> -0.969531).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0434782
	speed: 0.5399s/iter; left time: 21796.6129s
	iters: 200, epoch: 3 | loss: 0.0808195
	speed: 0.2763s/iter; left time: 11127.9669s
	iters: 300, epoch: 3 | loss: 0.1453620
	speed: 0.2911s/iter; left time: 11694.2294s
	iters: 400, epoch: 3 | loss: 0.0346477
	speed: 0.2659s/iter; left time: 10654.0047s
Epoch: 3 cost time: 116.08358764648438
Epoch: 3, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.061 Vali Acc: 0.980 Test Loss: 0.061 Test Acc: 0.980
Validation loss decreased (-0.969531 --> -0.980445).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0168277
	speed: 0.5430s/iter; left time: 21698.3502s
	iters: 200, epoch: 4 | loss: 0.0782847
	speed: 0.2846s/iter; left time: 11344.5991s
	iters: 300, epoch: 4 | loss: 0.0413087
	speed: 0.2579s/iter; left time: 10254.1040s
	iters: 400, epoch: 4 | loss: 0.0404834
	speed: 0.2779s/iter; left time: 11021.7450s
Epoch: 4 cost time: 113.30672860145569
Epoch: 4, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0270104
	speed: 0.5376s/iter; left time: 21262.7211s
	iters: 200, epoch: 5 | loss: 0.0019175
	speed: 0.2907s/iter; left time: 11468.8887s
	iters: 300, epoch: 5 | loss: 0.0192354
	speed: 0.2855s/iter; left time: 11234.3128s
	iters: 400, epoch: 5 | loss: 0.0284874
	speed: 0.2823s/iter; left time: 11079.8566s
Epoch: 5 cost time: 118.1710216999054
Epoch: 5, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.046 Vali Acc: 0.982 Test Loss: 0.046 Test Acc: 0.982
Validation loss decreased (-0.980445 --> -0.981809).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0006387
	speed: 0.5444s/iter; left time: 21306.8853s
	iters: 200, epoch: 6 | loss: 0.0054612
	speed: 0.2744s/iter; left time: 10710.2169s
	iters: 300, epoch: 6 | loss: 0.0058309
	speed: 0.2781s/iter; left time: 10829.8112s
	iters: 400, epoch: 6 | loss: 0.0227265
	speed: 0.2780s/iter; left time: 10797.9431s
Epoch: 6 cost time: 114.3581395149231
Epoch: 6, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.056 Vali Acc: 0.976 Test Loss: 0.056 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0015874
	speed: 0.5400s/iter; left time: 20910.0925s
	iters: 200, epoch: 7 | loss: 0.0025476
	speed: 0.2776s/iter; left time: 10723.4360s
	iters: 300, epoch: 7 | loss: 0.0005164
	speed: 0.2800s/iter; left time: 10786.2933s
	iters: 400, epoch: 7 | loss: 0.0027557
	speed: 0.2895s/iter; left time: 11125.1160s
Epoch: 7 cost time: 116.82856440544128
Epoch: 7, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0039003
	speed: 0.5207s/iter; left time: 19948.7744s
	iters: 200, epoch: 8 | loss: 0.0017049
	speed: 0.2682s/iter; left time: 10246.3844s
	iters: 300, epoch: 8 | loss: 0.0036301
	speed: 0.2990s/iter; left time: 11393.5428s
	iters: 400, epoch: 8 | loss: 0.0157500
	speed: 0.2605s/iter; left time: 9901.4680s
Epoch: 8 cost time: 112.76329898834229
Epoch: 8, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.053 Vali Acc: 0.980 Test Loss: 0.053 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0005586
	speed: 0.5384s/iter; left time: 20402.4124s
	iters: 200, epoch: 9 | loss: 0.0022705
	speed: 0.2647s/iter; left time: 10003.3269s
	iters: 300, epoch: 9 | loss: 0.0024184
	speed: 0.2390s/iter; left time: 9008.1555s
	iters: 400, epoch: 9 | loss: 0.0310501
	speed: 0.2669s/iter; left time: 10033.9338s
Epoch: 9 cost time: 107.18216109275818
Epoch: 9, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.130 Vali Acc: 0.966 Test Loss: 0.130 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0076711
	speed: 0.5461s/iter; left time: 20471.2352s
	iters: 200, epoch: 10 | loss: 0.0050562
	speed: 0.2762s/iter; left time: 10324.8422s
	iters: 300, epoch: 10 | loss: 0.0092654
	speed: 0.2889s/iter; left time: 10770.2747s
	iters: 400, epoch: 10 | loss: 0.0037365
	speed: 0.2888s/iter; left time: 10738.1935s
Epoch: 10 cost time: 117.06035947799683
Epoch: 10, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.050 Vali Acc: 0.981 Test Loss: 0.050 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0004936
	speed: 0.5383s/iter; left time: 19953.7207s
	iters: 200, epoch: 11 | loss: 0.0102801
	speed: 0.2594s/iter; left time: 9591.5136s
	iters: 300, epoch: 11 | loss: 0.0037939
	speed: 0.2720s/iter; left time: 10027.7714s
	iters: 400, epoch: 11 | loss: 0.0106338
	speed: 0.2636s/iter; left time: 9694.6476s
Epoch: 11 cost time: 112.80838108062744
Epoch: 11, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.155 Vali Acc: 0.956 Test Loss: 0.155 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0001395
	speed: 0.5284s/iter; left time: 19370.4766s
	iters: 200, epoch: 12 | loss: 0.0010869
	speed: 0.2859s/iter; left time: 10451.1957s
	iters: 300, epoch: 12 | loss: 0.0048230
	speed: 0.2751s/iter; left time: 10031.1171s
	iters: 400, epoch: 12 | loss: 0.0473035
	speed: 0.2756s/iter; left time: 10018.6666s
Epoch: 12 cost time: 113.11961793899536
Epoch: 12, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0010124
	speed: 0.5456s/iter; left time: 19775.5346s
	iters: 200, epoch: 13 | loss: 0.0177809
	speed: 0.2689s/iter; left time: 9720.8621s
	iters: 300, epoch: 13 | loss: 0.0024669
	speed: 0.2853s/iter; left time: 10285.3135s
	iters: 400, epoch: 13 | loss: 0.0003016
	speed: 0.2680s/iter; left time: 9633.3128s
Epoch: 13 cost time: 115.3402030467987
Epoch: 13, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0010173
	speed: 0.5358s/iter; left time: 19197.1942s
	iters: 200, epoch: 14 | loss: 0.0843171
	speed: 0.2558s/iter; left time: 9141.2435s
	iters: 300, epoch: 14 | loss: 0.0029605
	speed: 0.2530s/iter; left time: 9015.1098s
	iters: 400, epoch: 14 | loss: 0.0141861
	speed: 0.2936s/iter; left time: 10433.8767s
Epoch: 14 cost time: 110.45205497741699
Epoch: 14, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.060 Vali Acc: 0.979 Test Loss: 0.060 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0000623
	speed: 0.5570s/iter; left time: 19729.2222s
	iters: 200, epoch: 15 | loss: 0.0004172
	speed: 0.3012s/iter; left time: 10639.2965s
	iters: 300, epoch: 15 | loss: 0.0087764
	speed: 0.2871s/iter; left time: 10112.7551s
	iters: 400, epoch: 15 | loss: 0.0029007
	speed: 0.2664s/iter; left time: 9356.5896s
Epoch: 15 cost time: 118.86492991447449
Epoch: 15, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df512_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9818099135970896
model parameter : 167242
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df512_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.0416169
	speed: 0.2836s/iter; left time: 11683.8945s
	iters: 200, epoch: 1 | loss: 1.4546386
	speed: 0.2702s/iter; left time: 11106.9817s
	iters: 300, epoch: 1 | loss: 0.4889982
	speed: 0.2766s/iter; left time: 11339.8236s
	iters: 400, epoch: 1 | loss: 0.2652788
	speed: 0.2616s/iter; left time: 10701.0796s
Epoch: 1 cost time: 112.74954462051392
Epoch: 1, Steps: 413 | Train Loss: 1.347 Vali Loss: 0.267 Vali Acc: 0.927 Test Loss: 0.267 Test Acc: 0.927
Validation loss decreased (inf --> -0.926782).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3096809
	speed: 0.5398s/iter; left time: 22017.1935s
	iters: 200, epoch: 2 | loss: 0.0629215
	speed: 0.2529s/iter; left time: 10290.8387s
	iters: 300, epoch: 2 | loss: 0.2319323
	speed: 0.2663s/iter; left time: 10809.3201s
	iters: 400, epoch: 2 | loss: 0.2702100
	speed: 0.2560s/iter; left time: 10363.8432s
Epoch: 2 cost time: 109.32089948654175
Epoch: 2, Steps: 413 | Train Loss: 0.215 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
Validation loss decreased (-0.926782 --> -0.969530).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0504193
	speed: 0.5204s/iter; left time: 21011.4326s
	iters: 200, epoch: 3 | loss: 0.2163630
	speed: 0.2815s/iter; left time: 11336.1213s
	iters: 300, epoch: 3 | loss: 0.5629242
	speed: 0.2426s/iter; left time: 9745.3467s
	iters: 400, epoch: 3 | loss: 0.1092521
	speed: 0.2746s/iter; left time: 11006.0477s
Epoch: 3 cost time: 109.43434548377991
Epoch: 3, Steps: 413 | Train Loss: 0.091 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0611148
	speed: 0.4968s/iter; left time: 19853.8995s
	iters: 200, epoch: 4 | loss: 0.0760030
	speed: 0.2738s/iter; left time: 10914.4034s
	iters: 300, epoch: 4 | loss: 0.0494034
	speed: 0.2841s/iter; left time: 11295.6625s
	iters: 400, epoch: 4 | loss: 0.1639434
	speed: 0.2739s/iter; left time: 10863.2320s
Epoch: 4 cost time: 112.70054626464844
Epoch: 4, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.085 Vali Acc: 0.974 Test Loss: 0.085 Test Acc: 0.974
Validation loss decreased (-0.969530 --> -0.973624).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0343905
	speed: 0.5588s/iter; left time: 22100.4351s
	iters: 200, epoch: 5 | loss: 0.0329759
	speed: 0.2691s/iter; left time: 10615.0356s
	iters: 300, epoch: 5 | loss: 0.0253052
	speed: 0.2841s/iter; left time: 11179.1263s
	iters: 400, epoch: 5 | loss: 0.0060212
	speed: 0.2651s/iter; left time: 10405.8438s
Epoch: 5 cost time: 114.20270729064941
Epoch: 5, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.077 Vali Acc: 0.975 Test Loss: 0.077 Test Acc: 0.975
Validation loss decreased (-0.973624 --> -0.975443).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0092224
	speed: 0.5216s/iter; left time: 20413.1301s
	iters: 200, epoch: 6 | loss: 0.0023839
	speed: 0.2867s/iter; left time: 11192.6309s
	iters: 300, epoch: 6 | loss: 0.0145023
	speed: 0.2705s/iter; left time: 10532.0347s
	iters: 400, epoch: 6 | loss: 0.0278085
	speed: 0.2863s/iter; left time: 11120.1559s
Epoch: 6 cost time: 115.0226035118103
Epoch: 6, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.062 Vali Acc: 0.979 Test Loss: 0.062 Test Acc: 0.979
Validation loss decreased (-0.975443 --> -0.979081).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0088659
	speed: 0.5263s/iter; left time: 20378.7142s
	iters: 200, epoch: 7 | loss: 0.0026386
	speed: 0.2716s/iter; left time: 10490.1760s
	iters: 300, epoch: 7 | loss: 0.0017952
	speed: 0.2865s/iter; left time: 11036.2804s
	iters: 400, epoch: 7 | loss: 0.0164440
	speed: 0.2745s/iter; left time: 10547.5727s
Epoch: 7 cost time: 115.01008582115173
Epoch: 7, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979081 --> -0.980445).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0015171
	speed: 0.5373s/iter; left time: 20584.7854s
	iters: 200, epoch: 8 | loss: 0.0022697
	speed: 0.2673s/iter; left time: 10212.4087s
	iters: 300, epoch: 8 | loss: 0.0249104
	speed: 0.2695s/iter; left time: 10269.2637s
	iters: 400, epoch: 8 | loss: 0.0475414
	speed: 0.2664s/iter; left time: 10124.7584s
Epoch: 8 cost time: 110.99763536453247
Epoch: 8, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.059 Vali Acc: 0.980 Test Loss: 0.059 Test Acc: 0.980
Validation loss decreased (-0.980445 --> -0.980445).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0004431
	speed: 0.5463s/iter; left time: 20703.0520s
	iters: 200, epoch: 9 | loss: 0.0032125
	speed: 0.2858s/iter; left time: 10801.7843s
	iters: 300, epoch: 9 | loss: 0.0067966
	speed: 0.2564s/iter; left time: 9666.4247s
	iters: 400, epoch: 9 | loss: 0.0008908
	speed: 0.2784s/iter; left time: 10466.8154s
Epoch: 9 cost time: 113.61276340484619
Epoch: 9, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0087122
	speed: 0.5341s/iter; left time: 20018.5548s
	iters: 200, epoch: 10 | loss: 0.0098511
	speed: 0.2558s/iter; left time: 9562.7335s
	iters: 300, epoch: 10 | loss: 0.0016872
	speed: 0.2697s/iter; left time: 10056.7765s
	iters: 400, epoch: 10 | loss: 0.0014748
	speed: 0.2606s/iter; left time: 9688.8378s
Epoch: 10 cost time: 110.41921734809875
Epoch: 10, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.081 Vali Acc: 0.974 Test Loss: 0.081 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0011848
	speed: 0.5162s/iter; left time: 19137.0626s
	iters: 200, epoch: 11 | loss: 0.0000552
	speed: 0.2532s/iter; left time: 9362.6027s
	iters: 300, epoch: 11 | loss: 0.0005148
	speed: 0.2731s/iter; left time: 10070.1166s
	iters: 400, epoch: 11 | loss: 0.0110622
	speed: 0.2599s/iter; left time: 9558.4732s
Epoch: 11 cost time: 109.10086464881897
Epoch: 11, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0004196
	speed: 0.5457s/iter; left time: 20005.9234s
	iters: 200, epoch: 12 | loss: 0.3689064
	speed: 0.2498s/iter; left time: 9133.9104s
	iters: 300, epoch: 12 | loss: 0.0007150
	speed: 0.2693s/iter; left time: 9817.7808s
	iters: 400, epoch: 12 | loss: 0.0026942
	speed: 0.2752s/iter; left time: 10005.8037s
Epoch: 12 cost time: 110.56546449661255
Epoch: 12, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.061 Vali Acc: 0.979 Test Loss: 0.061 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0002392
	speed: 0.5406s/iter; left time: 19595.2927s
	iters: 200, epoch: 13 | loss: 0.1527496
	speed: 0.2554s/iter; left time: 9232.0383s
	iters: 300, epoch: 13 | loss: 0.0006451
	speed: 0.2981s/iter; left time: 10745.9911s
	iters: 400, epoch: 13 | loss: 0.0000627
	speed: 0.2596s/iter; left time: 9329.5509s
Epoch: 13 cost time: 113.25100564956665
Epoch: 13, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0037672
	speed: 0.5371s/iter; left time: 19243.9436s
	iters: 200, epoch: 14 | loss: 0.0006477
	speed: 0.2964s/iter; left time: 10590.1644s
	iters: 300, epoch: 14 | loss: 0.0001571
	speed: 0.2622s/iter; left time: 9341.0870s
	iters: 400, epoch: 14 | loss: 0.0469626
	speed: 0.2774s/iter; left time: 9857.9875s
Epoch: 14 cost time: 113.95236611366272
Epoch: 14, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.980445 --> -0.983173).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0005365
	speed: 0.5444s/iter; left time: 19280.3645s
	iters: 200, epoch: 15 | loss: 0.0035271
	speed: 0.2503s/iter; left time: 8840.0356s
	iters: 300, epoch: 15 | loss: 0.0025890
	speed: 0.2741s/iter; left time: 9654.8889s
	iters: 400, epoch: 15 | loss: 0.0792150
	speed: 0.2739s/iter; left time: 9619.0969s
Epoch: 15 cost time: 111.97866773605347
Epoch: 15, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000213
	speed: 0.5502s/iter; left time: 19261.7719s
	iters: 200, epoch: 16 | loss: 0.0003601
	speed: 0.2803s/iter; left time: 9785.3401s
	iters: 300, epoch: 16 | loss: 0.2959406
	speed: 0.2707s/iter; left time: 9420.4595s
	iters: 400, epoch: 16 | loss: 0.0012678
	speed: 0.2801s/iter; left time: 9719.5189s
Epoch: 16 cost time: 114.95691871643066
Epoch: 16, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0040812
	speed: 0.5500s/iter; left time: 19024.6803s
	iters: 200, epoch: 17 | loss: 0.0014683
	speed: 0.2752s/iter; left time: 9493.8415s
	iters: 300, epoch: 17 | loss: 0.0668187
	speed: 0.2748s/iter; left time: 9451.2378s
	iters: 400, epoch: 17 | loss: 0.0019792
	speed: 0.2697s/iter; left time: 9248.2040s
Epoch: 17 cost time: 114.0552909374237
Epoch: 17, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0010359
	speed: 0.5159s/iter; left time: 17633.0442s
	iters: 200, epoch: 18 | loss: 0.0032258
	speed: 0.2650s/iter; left time: 9031.1796s
	iters: 300, epoch: 18 | loss: 0.0000109
	speed: 0.2731s/iter; left time: 9280.9888s
	iters: 400, epoch: 18 | loss: 0.0176016
	speed: 0.2651s/iter; left time: 8981.2543s
Epoch: 18 cost time: 110.39385557174683
Epoch: 18, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000802
	speed: 0.5556s/iter; left time: 18760.0268s
	iters: 200, epoch: 19 | loss: 0.0758096
	speed: 0.2781s/iter; left time: 9363.0086s
	iters: 300, epoch: 19 | loss: 0.0145090
	speed: 0.2826s/iter; left time: 9486.7788s
	iters: 400, epoch: 19 | loss: 0.0396643
	speed: 0.2673s/iter; left time: 8944.7019s
Epoch: 19 cost time: 116.50622081756592
Epoch: 19, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0024411
	speed: 0.5349s/iter; left time: 17841.0367s
	iters: 200, epoch: 20 | loss: 0.0000039
	speed: 0.2763s/iter; left time: 9186.6772s
	iters: 300, epoch: 20 | loss: 0.0000054
	speed: 0.2452s/iter; left time: 8129.3325s
	iters: 400, epoch: 20 | loss: 0.0102784
	speed: 0.2682s/iter; left time: 8865.4172s
Epoch: 20 cost time: 109.09042167663574
Epoch: 20, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.1352408
	speed: 0.5462s/iter; left time: 17993.6727s
	iters: 200, epoch: 21 | loss: 0.0006797
	speed: 0.2776s/iter; left time: 9116.2681s
	iters: 300, epoch: 21 | loss: 0.0000131
	speed: 0.2917s/iter; left time: 9549.6302s
	iters: 400, epoch: 21 | loss: 0.0018185
	speed: 0.2801s/iter; left time: 9142.6430s
Epoch: 21 cost time: 117.73589754104614
Epoch: 21, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0007436
	speed: 0.5307s/iter; left time: 17263.7447s
	iters: 200, epoch: 22 | loss: 0.0043431
	speed: 0.2628s/iter; left time: 8521.6030s
	iters: 300, epoch: 22 | loss: 0.0004369
	speed: 0.2750s/iter; left time: 8889.6840s
	iters: 400, epoch: 22 | loss: 0.0000113
	speed: 0.2742s/iter; left time: 8836.1356s
Epoch: 22 cost time: 111.64065766334534
Epoch: 22, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.075 Vali Acc: 0.979 Test Loss: 0.075 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0001170
	speed: 0.5374s/iter; left time: 17257.0108s
	iters: 200, epoch: 23 | loss: 0.0000094
	speed: 0.2813s/iter; left time: 9006.3164s
	iters: 300, epoch: 23 | loss: 0.0730323
	speed: 0.2753s/iter; left time: 8785.9986s
	iters: 400, epoch: 23 | loss: 0.0000145
	speed: 0.2848s/iter; left time: 9061.0971s
Epoch: 23 cost time: 116.47134041786194
Epoch: 23, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0000084
	speed: 0.5664s/iter; left time: 17957.2700s
	iters: 200, epoch: 24 | loss: 0.0000397
	speed: 0.2728s/iter; left time: 8619.7065s
	iters: 300, epoch: 24 | loss: 0.0000005
	speed: 0.2738s/iter; left time: 8625.5722s
	iters: 400, epoch: 24 | loss: 0.3252229
	speed: 0.2580s/iter; left time: 8102.0259s
Epoch: 24 cost time: 112.87568426132202
Epoch: 24, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.076 Vali Acc: 0.982 Test Loss: 0.076 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df512_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9831741700773079
model parameter : 167242
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df512_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.2203741
	speed: 0.2780s/iter; left time: 11452.9286s
	iters: 200, epoch: 1 | loss: 1.6175290
	speed: 0.2488s/iter; left time: 10226.8496s
	iters: 300, epoch: 1 | loss: 0.4968913
	speed: 0.2702s/iter; left time: 11080.1257s
	iters: 400, epoch: 1 | loss: 0.3074545
	speed: 0.2569s/iter; left time: 10506.1052s
Epoch: 1 cost time: 109.07026791572571
Epoch: 1, Steps: 413 | Train Loss: 1.489 Vali Loss: 0.314 Vali Acc: 0.919 Test Loss: 0.314 Test Acc: 0.919
Validation loss decreased (inf --> -0.918596).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2242201
	speed: 0.5145s/iter; left time: 20984.2035s
	iters: 200, epoch: 2 | loss: 0.0491044
	speed: 0.2695s/iter; left time: 10964.1930s
	iters: 300, epoch: 2 | loss: 0.2736385
	speed: 0.2671s/iter; left time: 10841.6594s
	iters: 400, epoch: 2 | loss: 0.2084330
	speed: 0.2683s/iter; left time: 10862.2253s
Epoch: 2 cost time: 109.76041460037231
Epoch: 2, Steps: 413 | Train Loss: 0.253 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
Validation loss decreased (-0.918596 --> -0.967711).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0632195
	speed: 0.5073s/iter; left time: 20480.8364s
	iters: 200, epoch: 3 | loss: 0.1229867
	speed: 0.2583s/iter; left time: 10401.7004s
	iters: 300, epoch: 3 | loss: 0.2371216
	speed: 0.2594s/iter; left time: 10420.1877s
	iters: 400, epoch: 3 | loss: 0.1058632
	speed: 0.2532s/iter; left time: 10147.4475s
Epoch: 3 cost time: 106.2744710445404
Epoch: 3, Steps: 413 | Train Loss: 0.111 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
Validation loss decreased (-0.967711 --> -0.975442).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1923937
	speed: 0.5012s/iter; left time: 20029.8009s
	iters: 200, epoch: 4 | loss: 0.1130373
	speed: 0.2446s/iter; left time: 9750.9981s
	iters: 300, epoch: 4 | loss: 0.0260114
	speed: 0.2725s/iter; left time: 10833.5964s
	iters: 400, epoch: 4 | loss: 0.2480673
	speed: 0.2541s/iter; left time: 10079.4619s
Epoch: 4 cost time: 108.1283187866211
Epoch: 4, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.975442 --> -0.977262).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0476262
	speed: 0.5276s/iter; left time: 20864.6543s
	iters: 200, epoch: 5 | loss: 0.0797306
	speed: 0.2707s/iter; left time: 10677.1717s
	iters: 300, epoch: 5 | loss: 0.0031993
	speed: 0.2566s/iter; left time: 10095.1679s
	iters: 400, epoch: 5 | loss: 0.0450599
	speed: 0.2563s/iter; left time: 10059.2329s
Epoch: 5 cost time: 108.76656818389893
Epoch: 5, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.099 Vali Acc: 0.969 Test Loss: 0.099 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0025152
	speed: 0.4951s/iter; left time: 19374.9453s
	iters: 200, epoch: 6 | loss: 0.0029415
	speed: 0.2700s/iter; left time: 10540.7177s
	iters: 300, epoch: 6 | loss: 0.0063809
	speed: 0.2480s/iter; left time: 9655.2602s
	iters: 400, epoch: 6 | loss: 0.0403578
	speed: 0.2631s/iter; left time: 10219.2223s
Epoch: 6 cost time: 106.61523628234863
Epoch: 6, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.085 Vali Acc: 0.975 Test Loss: 0.085 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0011767
	speed: 0.5066s/iter; left time: 19616.2286s
	iters: 200, epoch: 7 | loss: 0.0042214
	speed: 0.2563s/iter; left time: 9897.1638s
	iters: 300, epoch: 7 | loss: 0.0009904
	speed: 0.2532s/iter; left time: 9754.1191s
	iters: 400, epoch: 7 | loss: 0.0632343
	speed: 0.2546s/iter; left time: 9781.3929s
Epoch: 7 cost time: 105.80401563644409
Epoch: 7, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.073 Vali Acc: 0.979 Test Loss: 0.073 Test Acc: 0.979
Validation loss decreased (-0.977262 --> -0.979081).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0034258
	speed: 0.4681s/iter; left time: 17933.0450s
	iters: 200, epoch: 8 | loss: 0.0017166
	speed: 0.2682s/iter; left time: 10247.5118s
	iters: 300, epoch: 8 | loss: 0.0049886
	speed: 0.2545s/iter; left time: 9699.4118s
	iters: 400, epoch: 8 | loss: 0.0636730
	speed: 0.2718s/iter; left time: 10329.4056s
Epoch: 8 cost time: 107.91551303863525
Epoch: 8, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.089 Vali Acc: 0.974 Test Loss: 0.089 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0191724
	speed: 0.5158s/iter; left time: 19547.0650s
	iters: 200, epoch: 9 | loss: 0.0078489
	speed: 0.2570s/iter; left time: 9713.9422s
	iters: 300, epoch: 9 | loss: 0.0008976
	speed: 0.2674s/iter; left time: 10079.0860s
	iters: 400, epoch: 9 | loss: 0.0052935
	speed: 0.2609s/iter; left time: 9808.5787s
Epoch: 9 cost time: 108.89755201339722
Epoch: 9, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.076 Vali Acc: 0.975 Test Loss: 0.076 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0036418
	speed: 0.5250s/iter; left time: 19680.0546s
	iters: 200, epoch: 10 | loss: 0.0058644
	speed: 0.2628s/iter; left time: 9823.6251s
	iters: 300, epoch: 10 | loss: 0.0027764
	speed: 0.2686s/iter; left time: 10015.2082s
	iters: 400, epoch: 10 | loss: 0.0006090
	speed: 0.2562s/iter; left time: 9528.2687s
Epoch: 10 cost time: 109.55877947807312
Epoch: 10, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0013312
	speed: 0.4849s/iter; left time: 17976.2525s
	iters: 200, epoch: 11 | loss: 0.0030920
	speed: 0.2729s/iter; left time: 10089.4047s
	iters: 300, epoch: 11 | loss: 0.0927249
	speed: 0.2582s/iter; left time: 9520.3290s
	iters: 400, epoch: 11 | loss: 0.0032645
	speed: 0.2731s/iter; left time: 10040.4519s
Epoch: 11 cost time: 107.68247580528259
Epoch: 11, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0017720
	speed: 0.5346s/iter; left time: 19596.0913s
	iters: 200, epoch: 12 | loss: 0.0029253
	speed: 0.2661s/iter; left time: 9727.7062s
	iters: 300, epoch: 12 | loss: 0.0096759
	speed: 0.2728s/iter; left time: 9946.7000s
	iters: 400, epoch: 12 | loss: 0.0003666
	speed: 0.2712s/iter; left time: 9859.0876s
Epoch: 12 cost time: 112.09772253036499
Epoch: 12, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.089 Vali Acc: 0.979 Test Loss: 0.089 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0037074
	speed: 0.5123s/iter; left time: 18569.9203s
	iters: 200, epoch: 13 | loss: 0.0000780
	speed: 0.2559s/iter; left time: 9249.8832s
	iters: 300, epoch: 13 | loss: 0.0062903
	speed: 0.2774s/iter; left time: 9999.0016s
	iters: 400, epoch: 13 | loss: 0.0000139
	speed: 0.2631s/iter; left time: 9457.6019s
Epoch: 13 cost time: 109.66032767295837
Epoch: 13, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.127 Vali Acc: 0.974 Test Loss: 0.127 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0000817
	speed: 0.5167s/iter; left time: 18516.1610s
	iters: 200, epoch: 14 | loss: 0.0022718
	speed: 0.2688s/iter; left time: 9605.0516s
	iters: 300, epoch: 14 | loss: 0.0001137
	speed: 0.2558s/iter; left time: 9115.2041s
	iters: 400, epoch: 14 | loss: 0.0069056
	speed: 0.2557s/iter; left time: 9084.0844s
Epoch: 14 cost time: 107.68100595474243
Epoch: 14, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.172 Vali Acc: 0.975 Test Loss: 0.172 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0019612
	speed: 0.5201s/iter; left time: 18422.6147s
	iters: 200, epoch: 15 | loss: 0.0074452
	speed: 0.2498s/iter; left time: 8824.3288s
	iters: 300, epoch: 15 | loss: 0.0153278
	speed: 0.2569s/iter; left time: 9046.1242s
	iters: 400, epoch: 15 | loss: 0.0001804
	speed: 0.2271s/iter; left time: 7975.4096s
Epoch: 15 cost time: 103.15309357643127
Epoch: 15, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
Validation loss decreased (-0.979081 --> -0.983173).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0002151
	speed: 0.4929s/iter; left time: 17253.1254s
	iters: 200, epoch: 16 | loss: 0.0094076
	speed: 0.2416s/iter; left time: 8433.3939s
	iters: 300, epoch: 16 | loss: 0.0005764
	speed: 0.2616s/iter; left time: 9105.1951s
	iters: 400, epoch: 16 | loss: 0.0001028
	speed: 0.2416s/iter; left time: 8385.7429s
Epoch: 16 cost time: 103.60526585578918
Epoch: 16, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0004133
	speed: 0.5122s/iter; left time: 17719.7664s
	iters: 200, epoch: 17 | loss: 0.0627276
	speed: 0.2444s/iter; left time: 8431.6036s
	iters: 300, epoch: 17 | loss: 0.1205348
	speed: 0.2693s/iter; left time: 9262.7937s
	iters: 400, epoch: 17 | loss: 0.0000273
	speed: 0.2496s/iter; left time: 8561.1448s
Epoch: 17 cost time: 105.76563239097595
Epoch: 17, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.095 Vali Acc: 0.982 Test Loss: 0.095 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0004565
	speed: 0.5098s/iter; left time: 17426.5128s
	iters: 200, epoch: 18 | loss: 0.0003483
	speed: 0.2575s/iter; left time: 8777.1179s
	iters: 300, epoch: 18 | loss: 0.0012558
	speed: 0.2835s/iter; left time: 9634.0622s
	iters: 400, epoch: 18 | loss: 0.0000017
	speed: 0.2607s/iter; left time: 8832.1112s
Epoch: 18 cost time: 109.83317422866821
Epoch: 18, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.080 Vali Acc: 0.979 Test Loss: 0.080 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000069
	speed: 0.5482s/iter; left time: 18510.3215s
	iters: 200, epoch: 19 | loss: 0.0469817
	speed: 0.2818s/iter; left time: 9486.2426s
	iters: 300, epoch: 19 | loss: 0.0006092
	speed: 0.2667s/iter; left time: 8953.0370s
	iters: 400, epoch: 19 | loss: 0.4381748
	speed: 0.2825s/iter; left time: 9453.0746s
Epoch: 19 cost time: 114.45366644859314
Epoch: 19, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.140 Vali Acc: 0.974 Test Loss: 0.140 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0040856
	speed: 0.5461s/iter; left time: 18213.4397s
	iters: 200, epoch: 20 | loss: 0.0000901
	speed: 0.2753s/iter; left time: 9154.1597s
	iters: 300, epoch: 20 | loss: 0.0002591
	speed: 0.2933s/iter; left time: 9724.7722s
	iters: 400, epoch: 20 | loss: 0.0000968
	speed: 0.2691s/iter; left time: 8894.8302s
Epoch: 20 cost time: 115.98679208755493
Epoch: 20, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.157 Vali Acc: 0.970 Test Loss: 0.157 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0000301
	speed: 0.5384s/iter; left time: 17733.9846s
	iters: 200, epoch: 21 | loss: 0.0000042
	speed: 0.2680s/iter; left time: 8800.2698s
	iters: 300, epoch: 21 | loss: 0.0000699
	speed: 0.2639s/iter; left time: 8639.1255s
	iters: 400, epoch: 21 | loss: 0.0075746
	speed: 0.2956s/iter; left time: 9647.9918s
Epoch: 21 cost time: 113.63624739646912
Epoch: 21, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0045012
	speed: 0.5227s/iter; left time: 17001.8174s
	iters: 200, epoch: 22 | loss: 0.0001201
	speed: 0.2837s/iter; left time: 9199.3063s
	iters: 300, epoch: 22 | loss: 0.0000308
	speed: 0.2744s/iter; left time: 8872.3273s
	iters: 400, epoch: 22 | loss: 0.0006244
	speed: 0.2720s/iter; left time: 8767.5941s
Epoch: 22 cost time: 114.17853665351868
Epoch: 22, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0455143
	speed: 0.5425s/iter; left time: 17420.8018s
	iters: 200, epoch: 23 | loss: 0.0000025
	speed: 0.2659s/iter; left time: 8513.7283s
	iters: 300, epoch: 23 | loss: 0.0008501
	speed: 0.2860s/iter; left time: 9128.2161s
	iters: 400, epoch: 23 | loss: 0.0001006
	speed: 0.2658s/iter; left time: 8457.5074s
Epoch: 23 cost time: 114.13834404945374
Epoch: 23, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.134 Vali Acc: 0.979 Test Loss: 0.134 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0000005
	speed: 0.5548s/iter; left time: 17588.9130s
	iters: 200, epoch: 24 | loss: 0.0000382
	speed: 0.2765s/iter; left time: 8736.5988s
	iters: 300, epoch: 24 | loss: 0.0001390
	speed: 0.2747s/iter; left time: 8654.9953s
	iters: 400, epoch: 24 | loss: 0.0061383
	speed: 0.2720s/iter; left time: 8542.7331s
Epoch: 24 cost time: 114.6177864074707
Epoch: 24, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0001791
	speed: 0.5254s/iter; left time: 16440.0761s
	iters: 200, epoch: 25 | loss: 0.0001004
	speed: 0.2662s/iter; left time: 8303.7205s
	iters: 300, epoch: 25 | loss: 0.0000084
	speed: 0.2520s/iter; left time: 7835.2180s
	iters: 400, epoch: 25 | loss: 0.0000014
	speed: 0.2850s/iter; left time: 8830.6004s
Epoch: 25 cost time: 110.64534449577332
Epoch: 25, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df512_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9831741700773079
model parameter : 167242
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df512_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.2232513
	speed: 0.2977s/iter; left time: 12266.9184s
	iters: 200, epoch: 1 | loss: 1.5184596
	speed: 0.2797s/iter; left time: 11495.1152s
	iters: 300, epoch: 1 | loss: 0.4440592
	speed: 0.2794s/iter; left time: 11456.5199s
	iters: 400, epoch: 1 | loss: 0.3665107
	speed: 0.2752s/iter; left time: 11257.2354s
Epoch: 1 cost time: 117.25583958625793
Epoch: 1, Steps: 413 | Train Loss: 1.479 Vali Loss: 0.332 Vali Acc: 0.910 Test Loss: 0.332 Test Acc: 0.910
Validation loss decreased (inf --> -0.909956).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3865853
	speed: 0.5589s/iter; left time: 22796.9834s
	iters: 200, epoch: 2 | loss: 0.0787749
	speed: 0.2893s/iter; left time: 11770.1013s
	iters: 300, epoch: 2 | loss: 0.3579286
	speed: 0.2542s/iter; left time: 10319.4677s
	iters: 400, epoch: 2 | loss: 0.1975850
	speed: 0.2579s/iter; left time: 10441.3110s
Epoch: 2 cost time: 112.02954339981079
Epoch: 2, Steps: 413 | Train Loss: 0.274 Vali Loss: 0.145 Vali Acc: 0.956 Test Loss: 0.145 Test Acc: 0.956
Validation loss decreased (-0.909956 --> -0.955888).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0496932
	speed: 0.5283s/iter; left time: 21330.6450s
	iters: 200, epoch: 3 | loss: 0.2487372
	speed: 0.2559s/iter; left time: 10306.4609s
	iters: 300, epoch: 3 | loss: 0.1967928
	speed: 0.2826s/iter; left time: 11351.7740s
	iters: 400, epoch: 3 | loss: 0.2878323
	speed: 0.2795s/iter; left time: 11200.3034s
Epoch: 3 cost time: 113.3380823135376
Epoch: 3, Steps: 413 | Train Loss: 0.120 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
Validation loss decreased (-0.955888 --> -0.970440).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2295650
	speed: 0.5387s/iter; left time: 21529.3987s
	iters: 200, epoch: 4 | loss: 0.1586111
	speed: 0.2814s/iter; left time: 11215.9576s
	iters: 300, epoch: 4 | loss: 0.0127370
	speed: 0.2751s/iter; left time: 10939.1239s
	iters: 400, epoch: 4 | loss: 0.1070613
	speed: 0.2748s/iter; left time: 10898.7505s
Epoch: 4 cost time: 114.22715473175049
Epoch: 4, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.062 Vali Acc: 0.982 Test Loss: 0.062 Test Acc: 0.982
Validation loss decreased (-0.970440 --> -0.981809).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1275579
	speed: 0.5269s/iter; left time: 20836.5403s
	iters: 200, epoch: 5 | loss: 0.0411481
	speed: 0.2804s/iter; left time: 11060.0973s
	iters: 300, epoch: 5 | loss: 0.0282144
	speed: 0.2688s/iter; left time: 10578.6762s
	iters: 400, epoch: 5 | loss: 0.0341860
	speed: 0.3075s/iter; left time: 12069.8287s
Epoch: 5 cost time: 116.23900556564331
Epoch: 5, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.095 Vali Acc: 0.969 Test Loss: 0.095 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0140378
	speed: 0.5606s/iter; left time: 21941.2128s
	iters: 200, epoch: 6 | loss: 0.0121166
	speed: 0.2741s/iter; left time: 10699.8796s
	iters: 300, epoch: 6 | loss: 0.0278725
	speed: 0.2934s/iter; left time: 11425.5674s
	iters: 400, epoch: 6 | loss: 0.0601434
	speed: 0.2933s/iter; left time: 11389.7980s
Epoch: 6 cost time: 119.60566926002502
Epoch: 6, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.088 Vali Acc: 0.971 Test Loss: 0.088 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0400671
	speed: 0.5630s/iter; left time: 21800.5308s
	iters: 200, epoch: 7 | loss: 0.0086323
	speed: 0.2888s/iter; left time: 11154.6504s
	iters: 300, epoch: 7 | loss: 0.0003703
	speed: 0.2653s/iter; left time: 10220.5803s
	iters: 400, epoch: 7 | loss: 0.0187061
	speed: 0.2775s/iter; left time: 10660.7073s
Epoch: 7 cost time: 115.45702815055847
Epoch: 7, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0007921
	speed: 0.5394s/iter; left time: 20664.5107s
	iters: 200, epoch: 8 | loss: 0.0468581
	speed: 0.2868s/iter; left time: 10960.3537s
	iters: 300, epoch: 8 | loss: 0.0073387
	speed: 0.2622s/iter; left time: 9991.7944s
	iters: 400, epoch: 8 | loss: 0.0172337
	speed: 0.2844s/iter; left time: 10810.9747s
Epoch: 8 cost time: 114.84828853607178
Epoch: 8, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.062 Vali Acc: 0.978 Test Loss: 0.062 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0153806
	speed: 0.5558s/iter; left time: 21061.4809s
	iters: 200, epoch: 9 | loss: 0.0006574
	speed: 0.2771s/iter; left time: 10472.2591s
	iters: 300, epoch: 9 | loss: 0.0021346
	speed: 0.2864s/iter; left time: 10796.8583s
	iters: 400, epoch: 9 | loss: 0.0009918
	speed: 0.2784s/iter; left time: 10466.6331s
Epoch: 9 cost time: 117.19245982170105
Epoch: 9, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.069 Vali Acc: 0.976 Test Loss: 0.069 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0404407
	speed: 0.5328s/iter; left time: 19971.7617s
	iters: 200, epoch: 10 | loss: 0.0125116
	speed: 0.2870s/iter; left time: 10729.6511s
	iters: 300, epoch: 10 | loss: 0.0041689
	speed: 0.2769s/iter; left time: 10325.3923s
	iters: 400, epoch: 10 | loss: 0.0016300
	speed: 0.2812s/iter; left time: 10456.5985s
Epoch: 10 cost time: 114.9693706035614
Epoch: 10, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0072528
	speed: 0.5449s/iter; left time: 20201.7969s
	iters: 200, epoch: 11 | loss: 0.0000696
	speed: 0.2776s/iter; left time: 10262.2829s
	iters: 300, epoch: 11 | loss: 0.0020869
	speed: 0.2741s/iter; left time: 10107.0280s
	iters: 400, epoch: 11 | loss: 0.0390357
	speed: 0.2859s/iter; left time: 10512.0609s
Epoch: 11 cost time: 116.15085935592651
Epoch: 11, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.075 Vali Acc: 0.974 Test Loss: 0.075 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0002922
	speed: 0.5544s/iter; left time: 20324.6957s
	iters: 200, epoch: 12 | loss: 0.2876692
	speed: 0.2747s/iter; left time: 10042.5899s
	iters: 300, epoch: 12 | loss: 0.0024896
	speed: 0.2888s/iter; left time: 10527.7062s
	iters: 400, epoch: 12 | loss: 0.0008073
	speed: 0.2833s/iter; left time: 10299.9810s
Epoch: 12 cost time: 118.05489230155945
Epoch: 12, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0013735
	speed: 0.5242s/iter; left time: 18998.8951s
	iters: 200, epoch: 13 | loss: 0.0031573
	speed: 0.2817s/iter; left time: 10183.7971s
	iters: 300, epoch: 13 | loss: 0.0053042
	speed: 0.2646s/iter; left time: 9537.9431s
	iters: 400, epoch: 13 | loss: 0.0002744
	speed: 0.2848s/iter; left time: 10237.5417s
Epoch: 13 cost time: 114.11941838264465
Epoch: 13, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.058 Vali Acc: 0.981 Test Loss: 0.058 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0199619
	speed: 0.5701s/iter; left time: 20426.2767s
	iters: 200, epoch: 14 | loss: 0.0026215
	speed: 0.2758s/iter; left time: 9854.3118s
	iters: 300, epoch: 14 | loss: 0.0005610
	speed: 0.2784s/iter; left time: 9921.6009s
	iters: 400, epoch: 14 | loss: 0.0229532
	speed: 0.2553s/iter; left time: 9069.7301s
Epoch: 14 cost time: 113.42827296257019
Epoch: 14, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.069 Vali Acc: 0.978 Test Loss: 0.069 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df512_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9818099135970896
model parameter : 167242
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df512_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.2225308
	speed: 0.2893s/iter; left time: 11919.9733s
	iters: 200, epoch: 1 | loss: 1.5447357
	speed: 0.2875s/iter; left time: 11817.6115s
	iters: 300, epoch: 1 | loss: 0.4572820
	speed: 0.2686s/iter; left time: 11011.9676s
	iters: 400, epoch: 1 | loss: 0.3011052
	speed: 0.2943s/iter; left time: 12035.7135s
Epoch: 1 cost time: 117.85516571998596
Epoch: 1, Steps: 413 | Train Loss: 1.460 Vali Loss: 0.323 Vali Acc: 0.906 Test Loss: 0.323 Test Acc: 0.906
Validation loss decreased (inf --> -0.906318).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3896066
	speed: 0.5559s/iter; left time: 22673.1626s
	iters: 200, epoch: 2 | loss: 0.0442850
	speed: 0.2787s/iter; left time: 11339.7048s
	iters: 300, epoch: 2 | loss: 0.3365119
	speed: 0.2880s/iter; left time: 11688.3493s
	iters: 400, epoch: 2 | loss: 0.1712357
	speed: 0.2729s/iter; left time: 11047.9658s
Epoch: 2 cost time: 117.42754077911377
Epoch: 2, Steps: 413 | Train Loss: 0.265 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
Validation loss decreased (-0.906318 --> -0.964983).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1193888
	speed: 0.5478s/iter; left time: 22116.8409s
	iters: 200, epoch: 3 | loss: 0.1730853
	speed: 0.2806s/iter; left time: 11302.1340s
	iters: 300, epoch: 3 | loss: 0.1655270
	speed: 0.2800s/iter; left time: 11249.6533s
	iters: 400, epoch: 3 | loss: 0.1941751
	speed: 0.2910s/iter; left time: 11660.0313s
Epoch: 3 cost time: 118.19245600700378
Epoch: 3, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.104 Vali Acc: 0.969 Test Loss: 0.104 Test Acc: 0.969
Validation loss decreased (-0.964983 --> -0.968621).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2882033
	speed: 0.5539s/iter; left time: 22134.9720s
	iters: 200, epoch: 4 | loss: 0.0276517
	speed: 0.2768s/iter; left time: 11032.0768s
	iters: 300, epoch: 4 | loss: 0.0415420
	speed: 0.2762s/iter; left time: 10981.4854s
	iters: 400, epoch: 4 | loss: 0.0612487
	speed: 0.2768s/iter; left time: 10978.3914s
Epoch: 4 cost time: 115.26557326316833
Epoch: 4, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.968621 --> -0.979990).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0521800
	speed: 0.5388s/iter; left time: 21309.9378s
	iters: 200, epoch: 5 | loss: 0.0373003
	speed: 0.2626s/iter; left time: 10358.0528s
	iters: 300, epoch: 5 | loss: 0.0168774
	speed: 0.2562s/iter; left time: 10079.4200s
	iters: 400, epoch: 5 | loss: 0.0160686
	speed: 0.2808s/iter; left time: 11020.2733s
Epoch: 5 cost time: 111.79088878631592
Epoch: 5, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0484656
	speed: 0.5264s/iter; left time: 20601.6853s
	iters: 200, epoch: 6 | loss: 0.0120115
	speed: 0.2647s/iter; left time: 10333.4190s
	iters: 300, epoch: 6 | loss: 0.0784865
	speed: 0.2706s/iter; left time: 10537.5348s
	iters: 400, epoch: 6 | loss: 0.0325653
	speed: 0.2692s/iter; left time: 10455.4342s
Epoch: 6 cost time: 111.14816808700562
Epoch: 6, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.095 Vali Acc: 0.969 Test Loss: 0.095 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0168580
	speed: 0.5251s/iter; left time: 20333.8609s
	iters: 200, epoch: 7 | loss: 0.0148901
	speed: 0.2591s/iter; left time: 10007.6115s
	iters: 300, epoch: 7 | loss: 0.0002745
	speed: 0.2831s/iter; left time: 10904.9557s
	iters: 400, epoch: 7 | loss: 0.0022182
	speed: 0.2652s/iter; left time: 10189.3684s
Epoch: 7 cost time: 113.36099290847778
Epoch: 7, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0054762
	speed: 0.5420s/iter; left time: 20764.2702s
	iters: 200, epoch: 8 | loss: 0.0069424
	speed: 0.2642s/iter; left time: 10095.7370s
	iters: 300, epoch: 8 | loss: 0.0033080
	speed: 0.2633s/iter; left time: 10032.9614s
	iters: 400, epoch: 8 | loss: 0.0100100
	speed: 0.2747s/iter; left time: 10441.6486s
Epoch: 8 cost time: 111.18553352355957
Epoch: 8, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0019406
	speed: 0.5460s/iter; left time: 20692.6517s
	iters: 200, epoch: 9 | loss: 0.0012578
	speed: 0.2821s/iter; left time: 10661.6943s
	iters: 300, epoch: 9 | loss: 0.0006657
	speed: 0.2680s/iter; left time: 10102.3582s
	iters: 400, epoch: 9 | loss: 0.0009316
	speed: 0.2797s/iter; left time: 10514.7731s
Epoch: 9 cost time: 114.7090265750885
Epoch: 9, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0009060
	speed: 0.5469s/iter; left time: 20499.8116s
	iters: 200, epoch: 10 | loss: 0.0214448
	speed: 0.2695s/iter; left time: 10075.7270s
	iters: 300, epoch: 10 | loss: 0.0095932
	speed: 0.2835s/iter; left time: 10570.7486s
	iters: 400, epoch: 10 | loss: 0.0006152
	speed: 0.2599s/iter; left time: 9665.8820s
Epoch: 10 cost time: 113.71677112579346
Epoch: 10, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.084 Vali Acc: 0.974 Test Loss: 0.084 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0001887
	speed: 0.5206s/iter; left time: 19297.7430s
	iters: 200, epoch: 11 | loss: 0.0148316
	speed: 0.2703s/iter; left time: 9993.4909s
	iters: 300, epoch: 11 | loss: 0.0410027
	speed: 0.2875s/iter; left time: 10599.6627s
	iters: 400, epoch: 11 | loss: 0.1497312
	speed: 0.2773s/iter; left time: 10198.0380s
Epoch: 11 cost time: 114.57864308357239
Epoch: 11, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0048941
	speed: 0.5339s/iter; left time: 19571.2676s
	iters: 200, epoch: 12 | loss: 0.0280579
	speed: 0.2779s/iter; left time: 10159.9837s
	iters: 300, epoch: 12 | loss: 0.0019347
	speed: 0.2628s/iter; left time: 9581.3030s
	iters: 400, epoch: 12 | loss: 0.0013505
	speed: 0.2621s/iter; left time: 9530.3844s
Epoch: 12 cost time: 109.89289116859436
Epoch: 12, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0000218
	speed: 0.5264s/iter; left time: 19080.0410s
	iters: 200, epoch: 13 | loss: 0.0001435
	speed: 0.2636s/iter; left time: 9527.7346s
	iters: 300, epoch: 13 | loss: 0.0011168
	speed: 0.2701s/iter; left time: 9737.5075s
	iters: 400, epoch: 13 | loss: 0.0000827
	speed: 0.2705s/iter; left time: 9723.8379s
Epoch: 13 cost time: 111.60191655158997
Epoch: 13, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0013390
	speed: 0.5177s/iter; left time: 18549.0168s
	iters: 200, epoch: 14 | loss: 0.0003003
	speed: 0.2597s/iter; left time: 9278.5617s
	iters: 300, epoch: 14 | loss: 0.0007319
	speed: 0.2524s/iter; left time: 8994.6870s
	iters: 400, epoch: 14 | loss: 0.3451618
	speed: 0.2341s/iter; left time: 8316.7347s
Epoch: 14 cost time: 104.36294865608215
Epoch: 14, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.101 Vali Acc: 0.972 Test Loss: 0.101 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df512_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9799909049567985
model parameter : 167242
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df512_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.3060350
	speed: 0.2640s/iter; left time: 10875.5497s
	iters: 200, epoch: 1 | loss: 2.3037078
	speed: 0.2563s/iter; left time: 10534.2677s
	iters: 300, epoch: 1 | loss: 2.3029857
	speed: 0.2400s/iter; left time: 9841.8397s
	iters: 400, epoch: 1 | loss: 2.3061900
	speed: 0.2694s/iter; left time: 11018.2469s
Epoch: 1 cost time: 106.2338354587555
Epoch: 1, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (inf --> -0.100022).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3032701
	speed: 0.5009s/iter; left time: 20428.8865s
	iters: 200, epoch: 2 | loss: 2.3022940
	speed: 0.2540s/iter; left time: 10334.6059s
	iters: 300, epoch: 2 | loss: 2.3021646
	speed: 0.2641s/iter; left time: 10721.1076s
	iters: 400, epoch: 2 | loss: 2.3054614
	speed: 0.2600s/iter; left time: 10525.6216s
Epoch: 2 cost time: 107.68649435043335
Epoch: 2, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3031754
	speed: 0.5057s/iter; left time: 20419.5978s
	iters: 200, epoch: 3 | loss: 2.3062863
	speed: 0.2502s/iter; left time: 10076.3487s
	iters: 300, epoch: 3 | loss: 2.2981281
	speed: 0.2646s/iter; left time: 10628.3710s
	iters: 400, epoch: 3 | loss: 2.3025177
	speed: 0.2428s/iter; left time: 9731.0755s
Epoch: 3 cost time: 105.31525468826294
Epoch: 3, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3005505
	speed: 0.4929s/iter; left time: 19697.1658s
	iters: 200, epoch: 4 | loss: 2.3024096
	speed: 0.2439s/iter; left time: 9723.5352s
	iters: 300, epoch: 4 | loss: 2.3016963
	speed: 0.2676s/iter; left time: 10642.1266s
	iters: 400, epoch: 4 | loss: 2.3055415
	speed: 0.2684s/iter; left time: 10646.4051s
Epoch: 4 cost time: 106.34024333953857
Epoch: 4, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.3023543
	speed: 0.4903s/iter; left time: 19391.9814s
	iters: 200, epoch: 5 | loss: 2.3028545
	speed: 0.2494s/iter; left time: 9837.5896s
	iters: 300, epoch: 5 | loss: 2.2999656
	speed: 0.2492s/iter; left time: 9805.3158s
	iters: 400, epoch: 5 | loss: 2.3009779
	speed: 0.2534s/iter; left time: 9946.9895s
Epoch: 5 cost time: 102.06795930862427
Epoch: 5, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.3000987
	speed: 0.4842s/iter; left time: 18949.9768s
	iters: 200, epoch: 6 | loss: 2.3048763
	speed: 0.2293s/iter; left time: 8949.6016s
	iters: 300, epoch: 6 | loss: 2.3021359
	speed: 0.2557s/iter; left time: 9954.8012s
	iters: 400, epoch: 6 | loss: 2.3048203
	speed: 0.2626s/iter; left time: 10198.1449s
Epoch: 6 cost time: 102.64804434776306
Epoch: 6, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.3043597
	speed: 0.5279s/iter; left time: 20442.9094s
	iters: 200, epoch: 7 | loss: 2.3013971
	speed: 0.2519s/iter; left time: 9730.7184s
	iters: 300, epoch: 7 | loss: 2.3051925
	speed: 0.2564s/iter; left time: 9876.3987s
	iters: 400, epoch: 7 | loss: 2.3015478
	speed: 0.2356s/iter; left time: 9051.7932s
Epoch: 7 cost time: 104.63818597793579
Epoch: 7, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.3017888
	speed: 0.4899s/iter; left time: 18767.4954s
	iters: 200, epoch: 8 | loss: 2.3060834
	speed: 0.2689s/iter; left time: 10273.9617s
	iters: 300, epoch: 8 | loss: 2.3071094
	speed: 0.2643s/iter; left time: 10073.5683s
	iters: 400, epoch: 8 | loss: 2.3028119
	speed: 0.2291s/iter; left time: 8709.1398s
Epoch: 8 cost time: 105.8692352771759
Epoch: 8, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.3036482
	speed: 0.4956s/iter; left time: 18782.4433s
	iters: 200, epoch: 9 | loss: 2.3028657
	speed: 0.2569s/iter; left time: 9711.6704s
	iters: 300, epoch: 9 | loss: 2.3021965
	speed: 0.2698s/iter; left time: 10171.9438s
	iters: 400, epoch: 9 | loss: 2.3041263
	speed: 0.2647s/iter; left time: 9951.2795s
Epoch: 9 cost time: 108.0736997127533
Epoch: 9, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 2.3006523
	speed: 0.4806s/iter; left time: 18013.6124s
	iters: 200, epoch: 10 | loss: 2.3063743
	speed: 0.2581s/iter; left time: 9649.2525s
	iters: 300, epoch: 10 | loss: 2.3021405
	speed: 0.2468s/iter; left time: 9201.9285s
	iters: 400, epoch: 10 | loss: 2.3041582
	speed: 0.2481s/iter; left time: 9226.0939s
Epoch: 10 cost time: 102.10667395591736
Epoch: 10, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 2.3017411
	speed: 0.4887s/iter; left time: 18116.9268s
	iters: 200, epoch: 11 | loss: 2.3092191
	speed: 0.2585s/iter; left time: 9558.3138s
	iters: 300, epoch: 11 | loss: 2.3009665
	speed: 0.2453s/iter; left time: 9045.6390s
	iters: 400, epoch: 11 | loss: 2.3053041
	speed: 0.2457s/iter; left time: 9035.0671s
Epoch: 11 cost time: 102.68514490127563
Epoch: 11, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 2.3029342
	speed: 0.4802s/iter; left time: 17603.7379s
	iters: 200, epoch: 12 | loss: 2.3024337
	speed: 0.2738s/iter; left time: 10009.7714s
	iters: 300, epoch: 12 | loss: 2.3028226
	speed: 0.2287s/iter; left time: 8338.6993s
	iters: 400, epoch: 12 | loss: 2.3040185
	speed: 0.2498s/iter; left time: 9083.4259s
Epoch: 12 cost time: 102.3884048461914
Epoch: 12, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 2.3054914
	speed: 0.4775s/iter; left time: 17306.0673s
	iters: 200, epoch: 13 | loss: 2.3042684
	speed: 0.2655s/iter; left time: 9595.2986s
	iters: 300, epoch: 13 | loss: 2.3008566
	speed: 0.2319s/iter; left time: 8360.0491s
	iters: 400, epoch: 13 | loss: 2.3026083
	speed: 0.2434s/iter; left time: 8749.7266s
Epoch: 13 cost time: 102.74084305763245
Epoch: 13, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 2.3021162
	speed: 0.4602s/iter; left time: 16490.1025s
	iters: 200, epoch: 14 | loss: 2.3019814
	speed: 0.2625s/iter; left time: 9380.6850s
	iters: 300, epoch: 14 | loss: 2.2983744
	speed: 0.2270s/iter; left time: 8089.3715s
	iters: 400, epoch: 14 | loss: 2.3030729
	speed: 0.2555s/iter; left time: 9077.3143s
Epoch: 14 cost time: 100.88264203071594
Epoch: 14, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 2.3007054
	speed: 0.5151s/iter; left time: 18242.5832s
	iters: 200, epoch: 15 | loss: 2.3039737
	speed: 0.2690s/iter; left time: 9501.2129s
	iters: 300, epoch: 15 | loss: 2.3139634
	speed: 0.2212s/iter; left time: 7790.0840s
	iters: 400, epoch: 15 | loss: 2.3045707
	speed: 0.2418s/iter; left time: 8490.0302s
Epoch: 15 cost time: 102.70365619659424
Epoch: 15, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 2.3031814
	speed: 0.4433s/iter; left time: 15519.0926s
	iters: 200, epoch: 16 | loss: 2.3041196
	speed: 0.2573s/iter; left time: 8979.6730s
	iters: 300, epoch: 16 | loss: 2.3017216
	speed: 0.2307s/iter; left time: 8030.6865s
	iters: 400, epoch: 16 | loss: 2.3051560
	speed: 0.2575s/iter; left time: 8937.3870s
Epoch: 16 cost time: 100.23823857307434
Epoch: 16, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 2.3025801
	speed: 0.5100s/iter; left time: 17642.1238s
	iters: 200, epoch: 17 | loss: 2.3047476
	speed: 0.2670s/iter; left time: 9209.0552s
	iters: 300, epoch: 17 | loss: 2.3052039
	speed: 0.2236s/iter; left time: 7690.6863s
	iters: 400, epoch: 17 | loss: 2.3035035
	speed: 0.2619s/iter; left time: 8981.2448s
Epoch: 17 cost time: 104.73939919471741
Epoch: 17, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 18 | loss: 2.3049693
	speed: 0.4899s/iter; left time: 16745.5508s
	iters: 200, epoch: 18 | loss: 2.3036535
	speed: 0.2610s/iter; left time: 8894.6722s
	iters: 300, epoch: 18 | loss: 2.3033810
	speed: 0.2559s/iter; left time: 8695.5666s
	iters: 400, epoch: 18 | loss: 2.3031061
	speed: 0.2641s/iter; left time: 8949.3819s
Epoch: 18 cost time: 106.81929230690002
Epoch: 18, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 2.3005729
	speed: 0.5011s/iter; left time: 16920.5302s
	iters: 200, epoch: 19 | loss: 2.3036144
	speed: 0.2427s/iter; left time: 8171.2331s
	iters: 300, epoch: 19 | loss: 2.3047194
	speed: 0.2483s/iter; left time: 8335.9541s
	iters: 400, epoch: 19 | loss: 2.3036299
	speed: 0.2605s/iter; left time: 8719.6734s
Epoch: 19 cost time: 105.34276127815247
Epoch: 19, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 2.3031662
	speed: 0.4819s/iter; left time: 16072.3520s
	iters: 200, epoch: 20 | loss: 2.3053696
	speed: 0.2638s/iter; left time: 8773.0378s
	iters: 300, epoch: 20 | loss: 2.3037326
	speed: 0.2713s/iter; left time: 8995.1092s
	iters: 400, epoch: 20 | loss: 2.3024278
	speed: 0.2787s/iter; left time: 9213.1195s
Epoch: 20 cost time: 110.71134042739868
Epoch: 20, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 2.3027978
	speed: 0.5059s/iter; left time: 16665.8630s
	iters: 200, epoch: 21 | loss: 2.3028107
	speed: 0.2675s/iter; left time: 8785.5422s
	iters: 300, epoch: 21 | loss: 2.3038533
	speed: 0.2296s/iter; left time: 7517.3451s
	iters: 400, epoch: 21 | loss: 2.3037305
	speed: 0.2769s/iter; left time: 9039.0896s
Epoch: 21 cost time: 107.11355447769165
Epoch: 21, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 2.3050592
	speed: 0.5544s/iter; left time: 18034.2466s
	iters: 200, epoch: 22 | loss: 2.3013692
	speed: 0.2660s/iter; left time: 8627.2385s
	iters: 300, epoch: 22 | loss: 2.3026063
	speed: 0.2634s/iter; left time: 8514.2909s
	iters: 400, epoch: 22 | loss: 2.3018456
	speed: 0.2691s/iter; left time: 8673.6037s
Epoch: 22 cost time: 112.50507974624634
Epoch: 22, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 2.3019257
	speed: 0.5461s/iter; left time: 17539.5111s
	iters: 200, epoch: 23 | loss: 2.3021383
	speed: 0.2775s/iter; left time: 8884.9392s
	iters: 300, epoch: 23 | loss: 2.3026059
	speed: 0.2849s/iter; left time: 9091.4617s
	iters: 400, epoch: 23 | loss: 2.3031683
	speed: 0.2473s/iter; left time: 7867.1905s
Epoch: 23 cost time: 113.68111944198608
Epoch: 23, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 2.3030486
	speed: 0.5339s/iter; left time: 16925.1856s
	iters: 200, epoch: 24 | loss: 2.3036623
	speed: 0.2854s/iter; left time: 9019.2930s
	iters: 300, epoch: 24 | loss: 2.3023462
	speed: 0.2809s/iter; left time: 8848.8937s
	iters: 400, epoch: 24 | loss: 2.3023696
	speed: 0.2803s/iter; left time: 8802.4693s
Epoch: 24 cost time: 116.64775466918945
Epoch: 24, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 2.3015749
	speed: 0.5443s/iter; left time: 17031.3654s
	iters: 200, epoch: 25 | loss: 2.3042681
	speed: 0.2724s/iter; left time: 8497.0118s
	iters: 300, epoch: 25 | loss: 2.3043485
	speed: 0.2551s/iter; left time: 7930.8336s
	iters: 400, epoch: 25 | loss: 2.3036005
	speed: 0.2773s/iter; left time: 8592.6904s
Epoch: 25 cost time: 111.54735994338989
Epoch: 25, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 2.3041983
	speed: 0.5365s/iter; left time: 16563.5530s
	iters: 200, epoch: 26 | loss: 2.3038211
	speed: 0.2768s/iter; left time: 8517.3262s
	iters: 300, epoch: 26 | loss: 2.3033168
	speed: 0.2865s/iter; left time: 8789.4711s
	iters: 400, epoch: 26 | loss: 2.3029513
	speed: 0.2627s/iter; left time: 8031.1262s
Epoch: 26 cost time: 115.66068959236145
Epoch: 26, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 2.3001058
	speed: 0.5163s/iter; left time: 15727.1576s
	iters: 200, epoch: 27 | loss: 2.3055439
	speed: 0.2816s/iter; left time: 8550.6757s
	iters: 300, epoch: 27 | loss: 2.2976766
	speed: 0.2734s/iter; left time: 8273.3173s
	iters: 400, epoch: 27 | loss: 2.3020787
	speed: 0.2876s/iter; left time: 8674.5513s
Epoch: 27 cost time: 113.45880341529846
Epoch: 27, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df512_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.10004547521600728
model parameter : 167242
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         47                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df256_ma47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.2669696
	speed: 0.2889s/iter; left time: 11902.9929s
	iters: 200, epoch: 1 | loss: 0.5131490
	speed: 0.2699s/iter; left time: 11093.2709s
	iters: 300, epoch: 1 | loss: 0.2044744
	speed: 0.2964s/iter; left time: 12151.7607s
	iters: 400, epoch: 1 | loss: 0.0733414
	speed: 0.2788s/iter; left time: 11404.1345s
Epoch: 1 cost time: 117.73285293579102
Epoch: 1, Steps: 413 | Train Loss: 0.863 Vali Loss: 0.180 Vali Acc: 0.956 Test Loss: 0.180 Test Acc: 0.956
Validation loss decreased (inf --> -0.956342).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1050824
	speed: 0.5407s/iter; left time: 22054.9110s
	iters: 200, epoch: 2 | loss: 0.5094267
	speed: 0.2850s/iter; left time: 11595.9596s
	iters: 300, epoch: 2 | loss: 0.0668005
	speed: 0.2659s/iter; left time: 10793.8434s
	iters: 400, epoch: 2 | loss: 0.0352164
	speed: 0.2804s/iter; left time: 11354.4914s
Epoch: 2 cost time: 114.03933715820312
Epoch: 2, Steps: 413 | Train Loss: 0.151 Vali Loss: 0.079 Vali Acc: 0.974 Test Loss: 0.079 Test Acc: 0.974
Validation loss decreased (-0.956342 --> -0.974078).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1517826
	speed: 0.5482s/iter; left time: 22132.0262s
	iters: 200, epoch: 3 | loss: 0.1096256
	speed: 0.2748s/iter; left time: 11067.5835s
	iters: 300, epoch: 3 | loss: 0.0292856
	speed: 0.2755s/iter; left time: 11066.4259s
	iters: 400, epoch: 3 | loss: 0.0511948
	speed: 0.2814s/iter; left time: 11277.4176s
Epoch: 3 cost time: 115.88131928443909
Epoch: 3, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.052 Vali Acc: 0.983 Test Loss: 0.052 Test Acc: 0.983
Validation loss decreased (-0.974078 --> -0.983174).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0062199
	speed: 0.5518s/iter; left time: 22052.0538s
	iters: 200, epoch: 4 | loss: 0.0158872
	speed: 0.2856s/iter; left time: 11383.8277s
	iters: 300, epoch: 4 | loss: 0.0073616
	speed: 0.2879s/iter; left time: 11446.5629s
	iters: 400, epoch: 4 | loss: 0.0047815
	speed: 0.2794s/iter; left time: 11081.5857s
Epoch: 4 cost time: 117.8550386428833
Epoch: 4, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.047 Vali Acc: 0.984 Test Loss: 0.047 Test Acc: 0.984
Validation loss decreased (-0.983174 --> -0.984083).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0029488
	speed: 0.5180s/iter; left time: 20485.7144s
	iters: 200, epoch: 5 | loss: 0.0106376
	speed: 0.2845s/iter; left time: 11224.9815s
	iters: 300, epoch: 5 | loss: 0.0053022
	speed: 0.2740s/iter; left time: 10782.1838s
	iters: 400, epoch: 5 | loss: 0.0059669
	speed: 0.2903s/iter; left time: 11392.6104s
Epoch: 5 cost time: 114.3163731098175
Epoch: 5, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.054 Vali Acc: 0.983 Test Loss: 0.054 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0231778
	speed: 0.5009s/iter; left time: 19601.9281s
	iters: 200, epoch: 6 | loss: 0.0032540
	speed: 0.2388s/iter; left time: 9321.8973s
	iters: 300, epoch: 6 | loss: 0.0081705
	speed: 0.2435s/iter; left time: 9480.3915s
	iters: 400, epoch: 6 | loss: 0.0030350
	speed: 0.2591s/iter; left time: 10060.9168s
Epoch: 6 cost time: 101.53405976295471
Epoch: 6, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.043 Vali Acc: 0.986 Test Loss: 0.043 Test Acc: 0.986
Validation loss decreased (-0.984083 --> -0.986357).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0008677
	speed: 0.5297s/iter; left time: 20509.7840s
	iters: 200, epoch: 7 | loss: 0.0024185
	speed: 0.2685s/iter; left time: 10369.6852s
	iters: 300, epoch: 7 | loss: 0.0012017
	speed: 0.2669s/iter; left time: 10283.4295s
	iters: 400, epoch: 7 | loss: 0.0020366
	speed: 0.2529s/iter; left time: 9717.0825s
Epoch: 7 cost time: 111.67393517494202
Epoch: 7, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.055 Vali Acc: 0.983 Test Loss: 0.055 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0368724
	speed: 0.5300s/iter; left time: 20303.8269s
	iters: 200, epoch: 8 | loss: 0.0002715
	speed: 0.2576s/iter; left time: 9843.4878s
	iters: 300, epoch: 8 | loss: 0.0037295
	speed: 0.2734s/iter; left time: 10421.0241s
	iters: 400, epoch: 8 | loss: 0.0044420
	speed: 0.2626s/iter; left time: 9983.1932s
Epoch: 8 cost time: 111.06994581222534
Epoch: 8, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.058 Vali Acc: 0.983 Test Loss: 0.058 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0453058
	speed: 0.5093s/iter; left time: 19302.5550s
	iters: 200, epoch: 9 | loss: 0.0473994
	speed: 0.2456s/iter; left time: 9281.5175s
	iters: 300, epoch: 9 | loss: 0.1093416
	speed: 0.2527s/iter; left time: 9525.5956s
	iters: 400, epoch: 9 | loss: 0.0128591
	speed: 0.2592s/iter; left time: 9744.5133s
Epoch: 9 cost time: 105.68408393859863
Epoch: 9, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.057 Vali Acc: 0.983 Test Loss: 0.057 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0003746
	speed: 0.5225s/iter; left time: 19583.8601s
	iters: 200, epoch: 10 | loss: 0.0129258
	speed: 0.2649s/iter; left time: 9902.6523s
	iters: 300, epoch: 10 | loss: 0.0012336
	speed: 0.2678s/iter; left time: 9986.2437s
	iters: 400, epoch: 10 | loss: 0.0017043
	speed: 0.2669s/iter; left time: 9922.7577s
Epoch: 10 cost time: 112.1553087234497
Epoch: 10, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.043 Vali Acc: 0.987 Test Loss: 0.043 Test Acc: 0.987
Validation loss decreased (-0.986357 --> -0.986812).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0003110
	speed: 0.5198s/iter; left time: 19269.6910s
	iters: 200, epoch: 11 | loss: 0.0007514
	speed: 0.2426s/iter; left time: 8968.9391s
	iters: 300, epoch: 11 | loss: 0.0004468
	speed: 0.2732s/iter; left time: 10072.4075s
	iters: 400, epoch: 11 | loss: 0.0000283
	speed: 0.2610s/iter; left time: 9598.5197s
Epoch: 11 cost time: 108.41699242591858
Epoch: 11, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.049 Vali Acc: 0.986 Test Loss: 0.049 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0004017
	speed: 0.5156s/iter; left time: 18899.1464s
	iters: 200, epoch: 12 | loss: 0.0005323
	speed: 0.2463s/iter; left time: 9003.0679s
	iters: 300, epoch: 12 | loss: 0.0012454
	speed: 0.2568s/iter; left time: 9361.5225s
	iters: 400, epoch: 12 | loss: 0.1168343
	speed: 0.2627s/iter; left time: 9551.5076s
Epoch: 12 cost time: 107.18286538124084
Epoch: 12, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.063 Vali Acc: 0.981 Test Loss: 0.063 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0003529
	speed: 0.5303s/iter; left time: 19219.0451s
	iters: 200, epoch: 13 | loss: 0.0008939
	speed: 0.2611s/iter; left time: 9437.9669s
	iters: 300, epoch: 13 | loss: 0.0032425
	speed: 0.2577s/iter; left time: 9287.5470s
	iters: 400, epoch: 13 | loss: 0.0021133
	speed: 0.2642s/iter; left time: 9496.4154s
Epoch: 13 cost time: 110.04208064079285
Epoch: 13, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.061 Vali Acc: 0.985 Test Loss: 0.061 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0014992
	speed: 0.4792s/iter; left time: 17169.3820s
	iters: 200, epoch: 14 | loss: 0.0001331
	speed: 0.2613s/iter; left time: 9338.1734s
	iters: 300, epoch: 14 | loss: 0.0021640
	speed: 0.2624s/iter; left time: 9348.0937s
	iters: 400, epoch: 14 | loss: 0.0006623
	speed: 0.2767s/iter; left time: 9831.5093s
Epoch: 14 cost time: 108.93884491920471
Epoch: 14, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000754
	speed: 0.5302s/iter; left time: 18780.5892s
	iters: 200, epoch: 15 | loss: 0.0000298
	speed: 0.2613s/iter; left time: 9229.7243s
	iters: 300, epoch: 15 | loss: 0.0005912
	speed: 0.2583s/iter; left time: 9098.2903s
	iters: 400, epoch: 15 | loss: 0.0000372
	speed: 0.2596s/iter; left time: 9115.3482s
Epoch: 15 cost time: 107.91750288009644
Epoch: 15, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000042
	speed: 0.5190s/iter; left time: 18169.0056s
	iters: 200, epoch: 16 | loss: 0.0000256
	speed: 0.2671s/iter; left time: 9322.2382s
	iters: 300, epoch: 16 | loss: 0.0003518
	speed: 0.2660s/iter; left time: 9260.1214s
	iters: 400, epoch: 16 | loss: 0.0000112
	speed: 0.2479s/iter; left time: 8603.5177s
Epoch: 16 cost time: 106.59192299842834
Epoch: 16, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0169180
	speed: 0.5391s/iter; left time: 18650.0984s
	iters: 200, epoch: 17 | loss: 0.0000038
	speed: 0.2790s/iter; left time: 9624.4073s
	iters: 300, epoch: 17 | loss: 0.0017262
	speed: 0.2736s/iter; left time: 9408.5705s
	iters: 400, epoch: 17 | loss: 0.0024472
	speed: 0.2608s/iter; left time: 8942.3062s
Epoch: 17 cost time: 112.5359058380127
Epoch: 17, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0001325
	speed: 0.5459s/iter; left time: 18660.2804s
	iters: 200, epoch: 18 | loss: 0.0005915
	speed: 0.2847s/iter; left time: 9702.3015s
	iters: 300, epoch: 18 | loss: 0.0000527
	speed: 0.2731s/iter; left time: 9281.3215s
	iters: 400, epoch: 18 | loss: 0.0000522
	speed: 0.2685s/iter; left time: 9097.8215s
Epoch: 18 cost time: 114.77640867233276
Epoch: 18, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.048 Vali Acc: 0.984 Test Loss: 0.048 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0013911
	speed: 0.5317s/iter; left time: 17955.5266s
	iters: 200, epoch: 19 | loss: 0.0263242
	speed: 0.2961s/iter; left time: 9970.1423s
	iters: 300, epoch: 19 | loss: 0.0000442
	speed: 0.2820s/iter; left time: 9465.1904s
	iters: 400, epoch: 19 | loss: 0.0084393
	speed: 0.2843s/iter; left time: 9513.5316s
Epoch: 19 cost time: 117.67788195610046
Epoch: 19, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.054 Vali Acc: 0.985 Test Loss: 0.054 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0001801
	speed: 0.5145s/iter; left time: 17159.9362s
	iters: 200, epoch: 20 | loss: 0.0013657
	speed: 0.2842s/iter; left time: 9449.2651s
	iters: 300, epoch: 20 | loss: 0.0061096
	speed: 0.2869s/iter; left time: 9512.8289s
	iters: 400, epoch: 20 | loss: 0.0002929
	speed: 0.2916s/iter; left time: 9637.3429s
Epoch: 20 cost time: 116.0360689163208
Epoch: 20, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df256_ma47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.98681218735789
model parameter : 118090
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         38                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df256_ma38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.3220347
	speed: 0.2709s/iter; left time: 11162.8031s
	iters: 200, epoch: 1 | loss: 0.5895104
	speed: 0.2654s/iter; left time: 10906.5011s
	iters: 300, epoch: 1 | loss: 0.2672144
	speed: 0.2745s/iter; left time: 11252.8190s
	iters: 400, epoch: 1 | loss: 0.0925989
	speed: 0.2930s/iter; left time: 11982.3704s
Epoch: 1 cost time: 113.97965383529663
Epoch: 1, Steps: 413 | Train Loss: 0.918 Vali Loss: 0.193 Vali Acc: 0.955 Test Loss: 0.193 Test Acc: 0.955
Validation loss decreased (inf --> -0.954978).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1352522
	speed: 0.5302s/iter; left time: 21623.8450s
	iters: 200, epoch: 2 | loss: 0.2664928
	speed: 0.2873s/iter; left time: 11689.5861s
	iters: 300, epoch: 2 | loss: 0.0534239
	speed: 0.2831s/iter; left time: 11488.7781s
	iters: 400, epoch: 2 | loss: 0.0313113
	speed: 0.2790s/iter; left time: 11295.9956s
Epoch: 2 cost time: 115.99838614463806
Epoch: 2, Steps: 413 | Train Loss: 0.159 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
Validation loss decreased (-0.954978 --> -0.975897).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1732666
	speed: 0.5188s/iter; left time: 20944.6768s
	iters: 200, epoch: 3 | loss: 0.1107494
	speed: 0.2543s/iter; left time: 10242.3510s
	iters: 300, epoch: 3 | loss: 0.0365149
	speed: 0.2898s/iter; left time: 11643.3441s
	iters: 400, epoch: 3 | loss: 0.0591396
	speed: 0.2844s/iter; left time: 11397.4757s
Epoch: 3 cost time: 114.0131585597992
Epoch: 3, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.058 Vali Acc: 0.982 Test Loss: 0.058 Test Acc: 0.982
Validation loss decreased (-0.975897 --> -0.982264).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0042968
	speed: 0.5325s/iter; left time: 21279.0969s
	iters: 200, epoch: 4 | loss: 0.0209843
	speed: 0.2709s/iter; left time: 10798.6213s
	iters: 300, epoch: 4 | loss: 0.0080612
	speed: 0.2967s/iter; left time: 11798.0927s
	iters: 400, epoch: 4 | loss: 0.0067299
	speed: 0.2808s/iter; left time: 11137.3388s
Epoch: 4 cost time: 116.38013291358948
Epoch: 4, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.045 Vali Acc: 0.985 Test Loss: 0.045 Test Acc: 0.985
Validation loss decreased (-0.982264 --> -0.984538).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0049166
	speed: 0.5297s/iter; left time: 20948.2243s
	iters: 200, epoch: 5 | loss: 0.0150279
	speed: 0.2561s/iter; left time: 10104.5316s
	iters: 300, epoch: 5 | loss: 0.0037026
	speed: 0.2748s/iter; left time: 10812.8558s
	iters: 400, epoch: 5 | loss: 0.0078479
	speed: 0.2879s/iter; left time: 11299.2612s
Epoch: 5 cost time: 113.92929530143738
Epoch: 5, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.063 Vali Acc: 0.977 Test Loss: 0.063 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0123349
	speed: 0.5504s/iter; left time: 21539.0304s
	iters: 200, epoch: 6 | loss: 0.0050486
	speed: 0.2549s/iter; left time: 9951.0237s
	iters: 300, epoch: 6 | loss: 0.0020353
	speed: 0.2849s/iter; left time: 11094.6187s
	iters: 400, epoch: 6 | loss: 0.0018942
	speed: 0.3024s/iter; left time: 11745.6137s
Epoch: 6 cost time: 117.13346314430237
Epoch: 6, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.060 Vali Acc: 0.980 Test Loss: 0.060 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0028831
	speed: 0.5284s/iter; left time: 20462.1483s
	iters: 200, epoch: 7 | loss: 0.0172685
	speed: 0.2607s/iter; left time: 10068.6628s
	iters: 300, epoch: 7 | loss: 0.0000833
	speed: 0.2937s/iter; left time: 11312.6210s
	iters: 400, epoch: 7 | loss: 0.0010131
	speed: 0.2784s/iter; left time: 10695.2301s
Epoch: 7 cost time: 112.25094556808472
Epoch: 7, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.059 Vali Acc: 0.980 Test Loss: 0.059 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0573316
	speed: 0.5212s/iter; left time: 19967.2045s
	iters: 200, epoch: 8 | loss: 0.0006470
	speed: 0.2625s/iter; left time: 10031.3636s
	iters: 300, epoch: 8 | loss: 0.0007282
	speed: 0.2991s/iter; left time: 11400.3092s
	iters: 400, epoch: 8 | loss: 0.0372946
	speed: 0.2820s/iter; left time: 10720.2986s
Epoch: 8 cost time: 114.40597343444824
Epoch: 8, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.049 Vali Acc: 0.986 Test Loss: 0.049 Test Acc: 0.986
Validation loss decreased (-0.984538 --> -0.986357).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0042981
	speed: 0.5275s/iter; left time: 19989.6025s
	iters: 200, epoch: 9 | loss: 0.0069831
	speed: 0.2789s/iter; left time: 10542.8675s
	iters: 300, epoch: 9 | loss: 0.0288368
	speed: 0.2919s/iter; left time: 11005.2939s
	iters: 400, epoch: 9 | loss: 0.0029708
	speed: 0.2650s/iter; left time: 9963.5244s
Epoch: 9 cost time: 114.99017190933228
Epoch: 9, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.050 Vali Acc: 0.982 Test Loss: 0.050 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000563
	speed: 0.5328s/iter; left time: 19970.0309s
	iters: 200, epoch: 10 | loss: 0.0022742
	speed: 0.2991s/iter; left time: 11183.0756s
	iters: 300, epoch: 10 | loss: 0.0023288
	speed: 0.2944s/iter; left time: 10976.4529s
	iters: 400, epoch: 10 | loss: 0.0001261
	speed: 0.2732s/iter; left time: 10158.8249s
Epoch: 10 cost time: 118.66761589050293
Epoch: 10, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.047 Vali Acc: 0.983 Test Loss: 0.047 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0001838
	speed: 0.5615s/iter; left time: 20815.1586s
	iters: 200, epoch: 11 | loss: 0.0886265
	speed: 0.2838s/iter; left time: 10493.0722s
	iters: 300, epoch: 11 | loss: 0.0004085
	speed: 0.2509s/iter; left time: 9250.4071s
	iters: 400, epoch: 11 | loss: 0.0000548
	speed: 0.2522s/iter; left time: 9274.2174s
Epoch: 11 cost time: 111.14406895637512
Epoch: 11, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.044 Vali Acc: 0.984 Test Loss: 0.044 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000240
	speed: 0.5237s/iter; left time: 19197.6573s
	iters: 200, epoch: 12 | loss: 0.0014402
	speed: 0.2689s/iter; left time: 9829.3080s
	iters: 300, epoch: 12 | loss: 0.0001196
	speed: 0.2507s/iter; left time: 9141.3179s
	iters: 400, epoch: 12 | loss: 0.0146773
	speed: 0.2836s/iter; left time: 10311.0195s
Epoch: 12 cost time: 110.62869954109192
Epoch: 12, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.056 Vali Acc: 0.980 Test Loss: 0.056 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000573
	speed: 0.5306s/iter; left time: 19232.2757s
	iters: 200, epoch: 13 | loss: 0.0001336
	speed: 0.2696s/iter; left time: 9746.3298s
	iters: 300, epoch: 13 | loss: 0.0048848
	speed: 0.2866s/iter; left time: 10331.6005s
	iters: 400, epoch: 13 | loss: 0.0003383
	speed: 0.2741s/iter; left time: 9852.0420s
Epoch: 13 cost time: 115.50649189949036
Epoch: 13, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.065 Vali Acc: 0.982 Test Loss: 0.065 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0110794
	speed: 0.5230s/iter; left time: 18740.1790s
	iters: 200, epoch: 14 | loss: 0.0330695
	speed: 0.2354s/iter; left time: 8412.2117s
	iters: 300, epoch: 14 | loss: 0.0020495
	speed: 0.2642s/iter; left time: 9415.2997s
	iters: 400, epoch: 14 | loss: 0.0037999
	speed: 0.2388s/iter; left time: 8486.1323s
Epoch: 14 cost time: 105.82412433624268
Epoch: 14, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.046 Vali Acc: 0.986 Test Loss: 0.046 Test Acc: 0.986
Validation loss decreased (-0.986357 --> -0.986357).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000441
	speed: 0.5573s/iter; left time: 19740.3420s
	iters: 200, epoch: 15 | loss: 0.0003807
	speed: 0.2745s/iter; left time: 9695.0532s
	iters: 300, epoch: 15 | loss: 0.0049266
	speed: 0.2663s/iter; left time: 9378.1889s
	iters: 400, epoch: 15 | loss: 0.0000215
	speed: 0.2705s/iter; left time: 9499.3671s
Epoch: 15 cost time: 113.48856806755066
Epoch: 15, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0001091
	speed: 0.5257s/iter; left time: 18403.0781s
	iters: 200, epoch: 16 | loss: 0.0000980
	speed: 0.2812s/iter; left time: 9816.8748s
	iters: 300, epoch: 16 | loss: 0.0315352
	speed: 0.2594s/iter; left time: 9027.8481s
	iters: 400, epoch: 16 | loss: 0.0002764
	speed: 0.2801s/iter; left time: 9722.1262s
Epoch: 16 cost time: 115.00700044631958
Epoch: 16, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.067 Vali Acc: 0.981 Test Loss: 0.067 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0014925
	speed: 0.5038s/iter; left time: 17427.1210s
	iters: 200, epoch: 17 | loss: 0.0004298
	speed: 0.2854s/iter; left time: 9844.7913s
	iters: 300, epoch: 17 | loss: 0.0001474
	speed: 0.2910s/iter; left time: 10007.0794s
	iters: 400, epoch: 17 | loss: 0.0001965
	speed: 0.2706s/iter; left time: 9280.1715s
Epoch: 17 cost time: 116.82920980453491
Epoch: 17, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0024041
	speed: 0.5306s/iter; left time: 18135.0908s
	iters: 200, epoch: 18 | loss: 0.0008628
	speed: 0.2874s/iter; left time: 9794.1569s
	iters: 300, epoch: 18 | loss: 0.0000098
	speed: 0.2902s/iter; left time: 9859.7039s
	iters: 400, epoch: 18 | loss: 0.0326116
	speed: 0.2575s/iter; left time: 8723.3384s
Epoch: 18 cost time: 114.61941361427307
Epoch: 18, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.060 Vali Acc: 0.986 Test Loss: 0.060 Test Acc: 0.986
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0025195
	speed: 0.5117s/iter; left time: 17279.4022s
	iters: 200, epoch: 19 | loss: 0.0000085
	speed: 0.2818s/iter; left time: 9487.1059s
	iters: 300, epoch: 19 | loss: 0.0000080
	speed: 0.2991s/iter; left time: 10039.8448s
	iters: 400, epoch: 19 | loss: 0.0020420
	speed: 0.2730s/iter; left time: 9136.5340s
Epoch: 19 cost time: 115.04379105567932
Epoch: 19, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.042 Vali Acc: 0.990 Test Loss: 0.042 Test Acc: 0.990
Validation loss decreased (-0.986357 --> -0.989995).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000045
	speed: 0.5375s/iter; left time: 17926.9577s
	iters: 200, epoch: 20 | loss: 0.0001303
	speed: 0.2793s/iter; left time: 9288.6612s
	iters: 300, epoch: 20 | loss: 0.0000602
	speed: 0.2716s/iter; left time: 9006.0550s
	iters: 400, epoch: 20 | loss: 0.0000181
	speed: 0.2773s/iter; left time: 9166.5984s
Epoch: 20 cost time: 113.88393878936768
Epoch: 20, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.042 Vali Acc: 0.989 Test Loss: 0.042 Test Acc: 0.989
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000054
	speed: 0.5086s/iter; left time: 16753.8952s
	iters: 200, epoch: 21 | loss: 0.0000651
	speed: 0.2810s/iter; left time: 9229.3169s
	iters: 300, epoch: 21 | loss: 0.0000160
	speed: 0.2994s/iter; left time: 9801.1340s
	iters: 400, epoch: 21 | loss: 0.0000123
	speed: 0.2871s/iter; left time: 9370.4911s
Epoch: 21 cost time: 116.7998743057251
Epoch: 21, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.062 Vali Acc: 0.985 Test Loss: 0.062 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000182
	speed: 0.5327s/iter; left time: 17326.6439s
	iters: 200, epoch: 22 | loss: 0.0000036
	speed: 0.2934s/iter; left time: 9515.0449s
	iters: 300, epoch: 22 | loss: 0.0001609
	speed: 0.2883s/iter; left time: 9321.6697s
	iters: 400, epoch: 22 | loss: 0.0065460
	speed: 0.2898s/iter; left time: 9340.2031s
Epoch: 22 cost time: 118.6962776184082
Epoch: 22, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.046 Vali Acc: 0.987 Test Loss: 0.046 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0102172
	speed: 0.5120s/iter; left time: 16442.3127s
	iters: 200, epoch: 23 | loss: 0.0000413
	speed: 0.2906s/iter; left time: 9303.5426s
	iters: 300, epoch: 23 | loss: 0.0028327
	speed: 0.2808s/iter; left time: 8961.5717s
	iters: 400, epoch: 23 | loss: 0.0252464
	speed: 0.2929s/iter; left time: 9318.7884s
Epoch: 23 cost time: 116.14942955970764
Epoch: 23, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.080 Vali Acc: 0.984 Test Loss: 0.080 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0237400
	speed: 0.5285s/iter; left time: 16753.6041s
	iters: 200, epoch: 24 | loss: 0.0002971
	speed: 0.2771s/iter; left time: 8757.7524s
	iters: 300, epoch: 24 | loss: 0.0011750
	speed: 0.2958s/iter; left time: 9318.6955s
	iters: 400, epoch: 24 | loss: 0.0085016
	speed: 0.2753s/iter; left time: 8645.5588s
Epoch: 24 cost time: 115.80760788917542
Epoch: 24, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0007480
	speed: 0.5174s/iter; left time: 16189.5413s
	iters: 200, epoch: 25 | loss: 0.0000085
	speed: 0.2749s/iter; left time: 8573.6968s
	iters: 300, epoch: 25 | loss: 0.0000064
	speed: 0.2844s/iter; left time: 8841.2845s
	iters: 400, epoch: 25 | loss: 0.0000056
	speed: 0.2644s/iter; left time: 8193.5063s
Epoch: 25 cost time: 113.80707716941833
Epoch: 25, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.982 Test Loss: 0.095 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0000144
	speed: 0.5341s/iter; left time: 16491.2649s
	iters: 200, epoch: 26 | loss: 0.0000007
	speed: 0.2843s/iter; left time: 8748.2996s
	iters: 300, epoch: 26 | loss: 0.0000769
	speed: 0.2915s/iter; left time: 8941.9951s
	iters: 400, epoch: 26 | loss: 0.0000033
	speed: 0.2809s/iter; left time: 8590.2012s
Epoch: 26 cost time: 117.57476782798767
Epoch: 26, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.059 Vali Acc: 0.984 Test Loss: 0.059 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0000155
	speed: 0.5249s/iter; left time: 15990.9538s
	iters: 200, epoch: 27 | loss: 0.0000359
	speed: 0.2927s/iter; left time: 8887.5489s
	iters: 300, epoch: 27 | loss: 0.0025718
	speed: 0.2634s/iter; left time: 7972.0174s
	iters: 400, epoch: 27 | loss: 0.0001093
	speed: 0.2750s/iter; left time: 8295.4463s
Epoch: 27 cost time: 113.63889789581299
Epoch: 27, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.982 Test Loss: 0.082 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0001731
	speed: 0.5435s/iter; left time: 16330.7977s
	iters: 200, epoch: 28 | loss: 0.0000416
	speed: 0.2973s/iter; left time: 8903.0980s
	iters: 300, epoch: 28 | loss: 0.0000585
	speed: 0.2594s/iter; left time: 7744.2787s
	iters: 400, epoch: 28 | loss: 0.2029802
	speed: 0.2594s/iter; left time: 7718.0162s
Epoch: 28 cost time: 114.74152994155884
Epoch: 28, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.064 Vali Acc: 0.984 Test Loss: 0.064 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0000531
	speed: 0.5215s/iter; left time: 15455.0305s
	iters: 200, epoch: 29 | loss: 0.0000342
	speed: 0.2909s/iter; left time: 8593.6554s
	iters: 300, epoch: 29 | loss: 0.0000004
	speed: 0.2845s/iter; left time: 8376.2866s
	iters: 400, epoch: 29 | loss: 0.0002828
	speed: 0.2843s/iter; left time: 8339.8072s
Epoch: 29 cost time: 116.66360831260681
Epoch: 29, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.121 Vali Acc: 0.972 Test Loss: 0.121 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df256_ma38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9899954524783993
model parameter : 118090
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         28                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df256_ma28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.5118766
	speed: 0.2775s/iter; left time: 11432.0777s
	iters: 200, epoch: 1 | loss: 0.8217117
	speed: 0.2998s/iter; left time: 12323.3935s
	iters: 300, epoch: 1 | loss: 0.3385663
	speed: 0.2859s/iter; left time: 11722.8437s
	iters: 400, epoch: 1 | loss: 0.1520815
	speed: 0.2875s/iter; left time: 11759.0893s
Epoch: 1 cost time: 119.10698771476746
Epoch: 1, Steps: 413 | Train Loss: 1.012 Vali Loss: 0.227 Vali Acc: 0.945 Test Loss: 0.227 Test Acc: 0.945
Validation loss decreased (inf --> -0.945427).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1334529
	speed: 0.5240s/iter; left time: 21374.7736s
	iters: 200, epoch: 2 | loss: 0.3114754
	speed: 0.2538s/iter; left time: 10328.3899s
	iters: 300, epoch: 2 | loss: 0.0511516
	speed: 0.2618s/iter; left time: 10627.8907s
	iters: 400, epoch: 2 | loss: 0.0309232
	speed: 0.2647s/iter; left time: 10718.0151s
Epoch: 2 cost time: 109.25899267196655
Epoch: 2, Steps: 413 | Train Loss: 0.171 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.945427 --> -0.980445).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1694370
	speed: 0.5551s/iter; left time: 22412.3890s
	iters: 200, epoch: 3 | loss: 0.0661701
	speed: 0.2471s/iter; left time: 9951.0727s
	iters: 300, epoch: 3 | loss: 0.0508858
	speed: 0.2742s/iter; left time: 11016.7921s
	iters: 400, epoch: 3 | loss: 0.0314908
	speed: 0.2708s/iter; left time: 10850.8359s
Epoch: 3 cost time: 112.04310584068298
Epoch: 3, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.053 Vali Acc: 0.984 Test Loss: 0.053 Test Acc: 0.984
Validation loss decreased (-0.980445 --> -0.984083).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0228005
	speed: 0.5592s/iter; left time: 22345.6388s
	iters: 200, epoch: 4 | loss: 0.0154318
	speed: 0.2704s/iter; left time: 10779.7152s
	iters: 300, epoch: 4 | loss: 0.0168119
	speed: 0.2673s/iter; left time: 10627.8139s
	iters: 400, epoch: 4 | loss: 0.0084133
	speed: 0.2592s/iter; left time: 10280.0684s
Epoch: 4 cost time: 112.94273853302002
Epoch: 4, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.040 Vali Acc: 0.985 Test Loss: 0.040 Test Acc: 0.985
Validation loss decreased (-0.984083 --> -0.984538).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0068669
	speed: 0.5462s/iter; left time: 21599.7374s
	iters: 200, epoch: 5 | loss: 0.0104611
	speed: 0.2860s/iter; left time: 11281.9080s
	iters: 300, epoch: 5 | loss: 0.0088038
	speed: 0.2864s/iter; left time: 11269.7514s
	iters: 400, epoch: 5 | loss: 0.0081692
	speed: 0.2491s/iter; left time: 9777.7325s
Epoch: 5 cost time: 113.32722687721252
Epoch: 5, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.054 Vali Acc: 0.979 Test Loss: 0.054 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0041683
	speed: 0.5446s/iter; left time: 21314.9733s
	iters: 200, epoch: 6 | loss: 0.0074630
	speed: 0.2867s/iter; left time: 11189.9375s
	iters: 300, epoch: 6 | loss: 0.0030788
	speed: 0.2854s/iter; left time: 11111.8324s
	iters: 400, epoch: 6 | loss: 0.0054785
	speed: 0.2560s/iter; left time: 9942.1659s
Epoch: 6 cost time: 114.29573583602905
Epoch: 6, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.046 Vali Acc: 0.985 Test Loss: 0.046 Test Acc: 0.985
Validation loss decreased (-0.984538 --> -0.985447).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0016146
	speed: 0.5259s/iter; left time: 20362.7451s
	iters: 200, epoch: 7 | loss: 0.0039268
	speed: 0.2862s/iter; left time: 11053.6382s
	iters: 300, epoch: 7 | loss: 0.0009078
	speed: 0.2808s/iter; left time: 10816.3062s
	iters: 400, epoch: 7 | loss: 0.0076774
	speed: 0.2566s/iter; left time: 9859.0990s
Epoch: 7 cost time: 113.2600588798523
Epoch: 7, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.045 Vali Acc: 0.985 Test Loss: 0.045 Test Acc: 0.985
Validation loss decreased (-0.985447 --> -0.985447).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0622723
	speed: 0.5408s/iter; left time: 20719.1414s
	iters: 200, epoch: 8 | loss: 0.0001342
	speed: 0.2988s/iter; left time: 11417.9545s
	iters: 300, epoch: 8 | loss: 0.0004724
	speed: 0.2880s/iter; left time: 10977.3793s
	iters: 400, epoch: 8 | loss: 0.0024610
	speed: 0.2527s/iter; left time: 9607.0216s
Epoch: 8 cost time: 114.89168763160706
Epoch: 8, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.040 Vali Acc: 0.987 Test Loss: 0.040 Test Acc: 0.987
Validation loss decreased (-0.985447 --> -0.986812).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0058203
	speed: 0.5287s/iter; left time: 20035.9029s
	iters: 200, epoch: 9 | loss: 0.0210449
	speed: 0.2923s/iter; left time: 11046.9168s
	iters: 300, epoch: 9 | loss: 0.0044243
	speed: 0.2955s/iter; left time: 11139.5422s
	iters: 400, epoch: 9 | loss: 0.0178576
	speed: 0.2728s/iter; left time: 10256.8950s
Epoch: 9 cost time: 116.26867890357971
Epoch: 9, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.044 Vali Acc: 0.986 Test Loss: 0.044 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0143538
	speed: 0.5309s/iter; left time: 19900.7761s
	iters: 200, epoch: 10 | loss: 0.0030698
	speed: 0.2988s/iter; left time: 11170.8812s
	iters: 300, epoch: 10 | loss: 0.0029008
	speed: 0.2634s/iter; left time: 9820.1491s
	iters: 400, epoch: 10 | loss: 0.0015258
	speed: 0.2606s/iter; left time: 9689.0502s
Epoch: 10 cost time: 113.3917350769043
Epoch: 10, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.030 Vali Acc: 0.990 Test Loss: 0.030 Test Acc: 0.990
Validation loss decreased (-0.986812 --> -0.989540).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000361
	speed: 0.5365s/iter; left time: 19888.3349s
	iters: 200, epoch: 11 | loss: 0.0002103
	speed: 0.2941s/iter; left time: 10874.0171s
	iters: 300, epoch: 11 | loss: 0.0008483
	speed: 0.2831s/iter; left time: 10439.3994s
	iters: 400, epoch: 11 | loss: 0.0001106
	speed: 0.2853s/iter; left time: 10489.8929s
Epoch: 11 cost time: 118.64203262329102
Epoch: 11, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.062 Vali Acc: 0.981 Test Loss: 0.062 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0002347
	speed: 0.5219s/iter; left time: 19130.1701s
	iters: 200, epoch: 12 | loss: 0.0064584
	speed: 0.2654s/iter; left time: 9703.8490s
	iters: 300, epoch: 12 | loss: 0.0016381
	speed: 0.2902s/iter; left time: 10581.8797s
	iters: 400, epoch: 12 | loss: 0.0056050
	speed: 0.2724s/iter; left time: 9902.9547s
Epoch: 12 cost time: 114.37682342529297
Epoch: 12, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0247826
	speed: 0.5396s/iter; left time: 19559.2845s
	iters: 200, epoch: 13 | loss: 0.0000788
	speed: 0.2675s/iter; left time: 9669.2438s
	iters: 300, epoch: 13 | loss: 0.0487140
	speed: 0.2843s/iter; left time: 10249.1255s
	iters: 400, epoch: 13 | loss: 0.0000694
	speed: 0.2623s/iter; left time: 9426.7736s
Epoch: 13 cost time: 113.00217151641846
Epoch: 13, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.048 Vali Acc: 0.985 Test Loss: 0.048 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000519
	speed: 0.5451s/iter; left time: 19533.1176s
	iters: 200, epoch: 14 | loss: 0.0000824
	speed: 0.2779s/iter; left time: 9928.7741s
	iters: 300, epoch: 14 | loss: 0.0038899
	speed: 0.2851s/iter; left time: 10158.2617s
	iters: 400, epoch: 14 | loss: 0.0030163
	speed: 0.2696s/iter; left time: 9578.0160s
Epoch: 14 cost time: 115.41146874427795
Epoch: 14, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.047 Vali Acc: 0.986 Test Loss: 0.047 Test Acc: 0.986
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0002793
	speed: 0.5511s/iter; left time: 19520.3702s
	iters: 200, epoch: 15 | loss: 0.0024589
	speed: 0.2773s/iter; left time: 9794.7796s
	iters: 300, epoch: 15 | loss: 0.0007875
	speed: 0.2893s/iter; left time: 10190.2949s
	iters: 400, epoch: 15 | loss: 0.0001973
	speed: 0.2451s/iter; left time: 8606.6522s
Epoch: 15 cost time: 113.2018678188324
Epoch: 15, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.048 Vali Acc: 0.985 Test Loss: 0.048 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000429
	speed: 0.5123s/iter; left time: 17934.1329s
	iters: 200, epoch: 16 | loss: 0.0080660
	speed: 0.2802s/iter; left time: 9779.7083s
	iters: 300, epoch: 16 | loss: 0.0007643
	speed: 0.2891s/iter; left time: 10062.8503s
	iters: 400, epoch: 16 | loss: 0.0000016
	speed: 0.2752s/iter; left time: 9552.3755s
Epoch: 16 cost time: 114.05952167510986
Epoch: 16, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.050 Vali Acc: 0.987 Test Loss: 0.050 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000062
	speed: 0.5199s/iter; left time: 17984.8779s
	iters: 200, epoch: 17 | loss: 0.0051687
	speed: 0.2649s/iter; left time: 9138.1738s
	iters: 300, epoch: 17 | loss: 0.0584278
	speed: 0.2896s/iter; left time: 9958.7309s
	iters: 400, epoch: 17 | loss: 0.0001293
	speed: 0.2852s/iter; left time: 9781.2799s
Epoch: 17 cost time: 115.70938873291016
Epoch: 17, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.033 Vali Acc: 0.989 Test Loss: 0.033 Test Acc: 0.989
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000041
	speed: 0.5355s/iter; left time: 18304.0224s
	iters: 200, epoch: 18 | loss: 0.0001329
	speed: 0.2617s/iter; left time: 8919.6597s
	iters: 300, epoch: 18 | loss: 0.0000577
	speed: 0.2926s/iter; left time: 9942.2239s
	iters: 400, epoch: 18 | loss: 0.0000060
	speed: 0.2857s/iter; left time: 9679.7698s
Epoch: 18 cost time: 116.18786978721619
Epoch: 18, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.038 Vali Acc: 0.988 Test Loss: 0.038 Test Acc: 0.988
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0090327
	speed: 0.5283s/iter; left time: 17840.0605s
	iters: 200, epoch: 19 | loss: 0.0000083
	speed: 0.2523s/iter; left time: 8495.6868s
	iters: 300, epoch: 19 | loss: 0.0000191
	speed: 0.2786s/iter; left time: 9350.9973s
	iters: 400, epoch: 19 | loss: 0.0005607
	speed: 0.2742s/iter; left time: 9176.6346s
Epoch: 19 cost time: 111.34563779830933
Epoch: 19, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0007300
	speed: 0.5459s/iter; left time: 18206.5232s
	iters: 200, epoch: 20 | loss: 0.0462109
	speed: 0.2559s/iter; left time: 8509.0232s
	iters: 300, epoch: 20 | loss: 0.0000919
	speed: 0.2736s/iter; left time: 9071.4014s
	iters: 400, epoch: 20 | loss: 0.0001393
	speed: 0.2454s/iter; left time: 8110.7776s
Epoch: 20 cost time: 108.55950832366943
Epoch: 20, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df256_ma28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9895407003183265
model parameter : 118090
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df256_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.7916664
	speed: 0.2865s/iter; left time: 11802.4512s
	iters: 200, epoch: 1 | loss: 1.0194314
	speed: 0.2692s/iter; left time: 11062.8627s
	iters: 300, epoch: 1 | loss: 0.5322756
	speed: 0.2630s/iter; left time: 10782.7527s
	iters: 400, epoch: 1 | loss: 0.1614014
	speed: 0.2835s/iter; left time: 11594.0588s
Epoch: 1 cost time: 113.53729152679443
Epoch: 1, Steps: 413 | Train Loss: 1.153 Vali Loss: 0.240 Vali Acc: 0.938 Test Loss: 0.240 Test Acc: 0.938
Validation loss decreased (inf --> -0.938151).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1507690
	speed: 0.5128s/iter; left time: 20916.8057s
	iters: 200, epoch: 2 | loss: 0.4402734
	speed: 0.2701s/iter; left time: 10990.8226s
	iters: 300, epoch: 2 | loss: 0.0799543
	speed: 0.2687s/iter; left time: 10904.1349s
	iters: 400, epoch: 2 | loss: 0.0158797
	speed: 0.2689s/iter; left time: 10886.9432s
Epoch: 2 cost time: 112.54544258117676
Epoch: 2, Steps: 413 | Train Loss: 0.180 Vali Loss: 0.093 Vali Acc: 0.971 Test Loss: 0.093 Test Acc: 0.971
Validation loss decreased (-0.938151 --> -0.971350).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3305441
	speed: 0.4800s/iter; left time: 19380.6632s
	iters: 200, epoch: 3 | loss: 0.0682160
	speed: 0.2616s/iter; left time: 10535.4288s
	iters: 300, epoch: 3 | loss: 0.0934675
	speed: 0.2543s/iter; left time: 10217.6474s
	iters: 400, epoch: 3 | loss: 0.0446620
	speed: 0.2748s/iter; left time: 11010.9036s
Epoch: 3 cost time: 107.74733901023865
Epoch: 3, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.068 Vali Acc: 0.979 Test Loss: 0.068 Test Acc: 0.979
Validation loss decreased (-0.971350 --> -0.978626).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0886939
	speed: 0.5276s/iter; left time: 21082.6370s
	iters: 200, epoch: 4 | loss: 0.0219437
	speed: 0.2692s/iter; left time: 10730.3821s
	iters: 300, epoch: 4 | loss: 0.0135513
	speed: 0.2749s/iter; left time: 10929.0250s
	iters: 400, epoch: 4 | loss: 0.0079609
	speed: 0.2774s/iter; left time: 11003.6229s
Epoch: 4 cost time: 113.63082075119019
Epoch: 4, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.064 Vali Acc: 0.975 Test Loss: 0.064 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0082028
	speed: 0.4909s/iter; left time: 19413.2832s
	iters: 200, epoch: 5 | loss: 0.0081609
	speed: 0.2574s/iter; left time: 10153.4005s
	iters: 300, epoch: 5 | loss: 0.0405497
	speed: 0.2693s/iter; left time: 10596.4236s
	iters: 400, epoch: 5 | loss: 0.0303650
	speed: 0.2870s/iter; left time: 11264.1971s
Epoch: 5 cost time: 111.20374917984009
Epoch: 5, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.066 Vali Acc: 0.978 Test Loss: 0.066 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0052158
	speed: 0.5301s/iter; left time: 20746.5099s
	iters: 200, epoch: 6 | loss: 0.0065603
	speed: 0.2742s/iter; left time: 10703.6741s
	iters: 300, epoch: 6 | loss: 0.0034849
	speed: 0.2785s/iter; left time: 10844.9749s
	iters: 400, epoch: 6 | loss: 0.0044006
	speed: 0.2682s/iter; left time: 10417.4983s
Epoch: 6 cost time: 114.2572455406189
Epoch: 6, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.050 Vali Acc: 0.985 Test Loss: 0.050 Test Acc: 0.985
Validation loss decreased (-0.978626 --> -0.984538).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0116082
	speed: 0.5423s/iter; left time: 21000.1116s
	iters: 200, epoch: 7 | loss: 0.0015486
	speed: 0.2679s/iter; left time: 10346.4541s
	iters: 300, epoch: 7 | loss: 0.0011057
	speed: 0.2840s/iter; left time: 10939.3469s
	iters: 400, epoch: 7 | loss: 0.0152904
	speed: 0.2634s/iter; left time: 10119.6469s
Epoch: 7 cost time: 113.09357833862305
Epoch: 7, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.060 Vali Acc: 0.980 Test Loss: 0.060 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0668579
	speed: 0.5110s/iter; left time: 19574.5371s
	iters: 200, epoch: 8 | loss: 0.0016222
	speed: 0.2748s/iter; left time: 10499.4228s
	iters: 300, epoch: 8 | loss: 0.0101785
	speed: 0.2560s/iter; left time: 9757.2611s
	iters: 400, epoch: 8 | loss: 0.0695175
	speed: 0.2754s/iter; left time: 10466.6718s
Epoch: 8 cost time: 110.79861116409302
Epoch: 8, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.056 Vali Acc: 0.980 Test Loss: 0.056 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0046059
	speed: 0.5312s/iter; left time: 20132.4356s
	iters: 200, epoch: 9 | loss: 0.0070001
	speed: 0.2666s/iter; left time: 10077.3928s
	iters: 300, epoch: 9 | loss: 0.0099599
	speed: 0.2673s/iter; left time: 10077.7073s
	iters: 400, epoch: 9 | loss: 0.0015109
	speed: 0.2614s/iter; left time: 9827.7688s
Epoch: 9 cost time: 110.99461698532104
Epoch: 9, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.050 Vali Acc: 0.985 Test Loss: 0.050 Test Acc: 0.985
Validation loss decreased (-0.984538 --> -0.984538).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0116965
	speed: 0.5199s/iter; left time: 19488.4593s
	iters: 200, epoch: 10 | loss: 0.0065175
	speed: 0.2595s/iter; left time: 9700.0877s
	iters: 300, epoch: 10 | loss: 0.0019309
	speed: 0.2852s/iter; left time: 10632.9983s
	iters: 400, epoch: 10 | loss: 0.0059863
	speed: 0.2545s/iter; left time: 9463.5192s
Epoch: 10 cost time: 110.61778354644775
Epoch: 10, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.077 Vali Acc: 0.974 Test Loss: 0.077 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000808
	speed: 0.5514s/iter; left time: 20441.0423s
	iters: 200, epoch: 11 | loss: 0.0010745
	speed: 0.2847s/iter; left time: 10525.6458s
	iters: 300, epoch: 11 | loss: 0.0002688
	speed: 0.2896s/iter; left time: 10678.1773s
	iters: 400, epoch: 11 | loss: 0.0003113
	speed: 0.2630s/iter; left time: 9669.2279s
Epoch: 11 cost time: 115.90385031700134
Epoch: 11, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.047 Vali Acc: 0.983 Test Loss: 0.047 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000753
	speed: 0.5306s/iter; left time: 19452.1513s
	iters: 200, epoch: 12 | loss: 0.0002120
	speed: 0.2837s/iter; left time: 10370.4608s
	iters: 300, epoch: 12 | loss: 0.0023322
	speed: 0.2830s/iter; left time: 10317.1463s
	iters: 400, epoch: 12 | loss: 0.0284840
	speed: 0.2776s/iter; left time: 10091.6972s
Epoch: 12 cost time: 115.08757209777832
Epoch: 12, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.051 Vali Acc: 0.985 Test Loss: 0.051 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0030854
	speed: 0.5204s/iter; left time: 18860.9943s
	iters: 200, epoch: 13 | loss: 0.0003941
	speed: 0.2519s/iter; left time: 9105.7349s
	iters: 300, epoch: 13 | loss: 0.0006700
	speed: 0.2875s/iter; left time: 10362.1522s
	iters: 400, epoch: 13 | loss: 0.0010016
	speed: 0.2733s/iter; left time: 9823.5129s
Epoch: 13 cost time: 110.51668930053711
Epoch: 13, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.075 Vali Acc: 0.982 Test Loss: 0.075 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000220
	speed: 0.5508s/iter; left time: 19734.5949s
	iters: 200, epoch: 14 | loss: 0.0001475
	speed: 0.2616s/iter; left time: 9347.9664s
	iters: 300, epoch: 14 | loss: 0.0012346
	speed: 0.2838s/iter; left time: 10110.8042s
	iters: 400, epoch: 14 | loss: 0.0151263
	speed: 0.2643s/iter; left time: 9392.2966s
Epoch: 14 cost time: 112.82921099662781
Epoch: 14, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.064 Vali Acc: 0.982 Test Loss: 0.064 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0015758
	speed: 0.5428s/iter; left time: 19224.4616s
	iters: 200, epoch: 15 | loss: 0.0001675
	speed: 0.2761s/iter; left time: 9751.2929s
	iters: 300, epoch: 15 | loss: 0.0015722
	speed: 0.2758s/iter; left time: 9714.4725s
	iters: 400, epoch: 15 | loss: 0.0046428
	speed: 0.2642s/iter; left time: 9277.2602s
Epoch: 15 cost time: 113.8691017627716
Epoch: 15, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0000130
	speed: 0.5320s/iter; left time: 18623.1254s
	iters: 200, epoch: 16 | loss: 0.0000224
	speed: 0.2570s/iter; left time: 8970.0893s
	iters: 300, epoch: 16 | loss: 0.0003988
	speed: 0.2856s/iter; left time: 9941.0039s
	iters: 400, epoch: 16 | loss: 0.0000023
	speed: 0.2495s/iter; left time: 8659.6097s
Epoch: 16 cost time: 110.78112459182739
Epoch: 16, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.043 Vali Acc: 0.987 Test Loss: 0.043 Test Acc: 0.987
Validation loss decreased (-0.984538 --> -0.987267).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000602
	speed: 0.5202s/iter; left time: 17996.6813s
	iters: 200, epoch: 17 | loss: 0.0000011
	speed: 0.2853s/iter; left time: 9841.1582s
	iters: 300, epoch: 17 | loss: 0.0067371
	speed: 0.2865s/iter; left time: 9852.6089s
	iters: 400, epoch: 17 | loss: 0.0010267
	speed: 0.2881s/iter; left time: 9878.9980s
Epoch: 17 cost time: 117.5842797756195
Epoch: 17, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.037 Vali Acc: 0.989 Test Loss: 0.037 Test Acc: 0.989
Validation loss decreased (-0.987267 --> -0.989086).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000025
	speed: 0.5332s/iter; left time: 18224.7896s
	iters: 200, epoch: 18 | loss: 0.0000060
	speed: 0.2727s/iter; left time: 9294.6076s
	iters: 300, epoch: 18 | loss: 0.0020842
	speed: 0.2773s/iter; left time: 9423.6121s
	iters: 400, epoch: 18 | loss: 0.0002784
	speed: 0.2819s/iter; left time: 9550.3820s
Epoch: 18 cost time: 114.23798489570618
Epoch: 18, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0015512
	speed: 0.5385s/iter; left time: 18182.3306s
	iters: 200, epoch: 19 | loss: 0.0000402
	speed: 0.2600s/iter; left time: 8751.9805s
	iters: 300, epoch: 19 | loss: 0.0000325
	speed: 0.2720s/iter; left time: 9131.8637s
	iters: 400, epoch: 19 | loss: 0.0030187
	speed: 0.2800s/iter; left time: 9370.8779s
Epoch: 19 cost time: 113.41482734680176
Epoch: 19, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.048 Vali Acc: 0.987 Test Loss: 0.048 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0201664
	speed: 0.5383s/iter; left time: 17955.7762s
	iters: 200, epoch: 20 | loss: 0.0005438
	speed: 0.2656s/iter; left time: 8833.1556s
	iters: 300, epoch: 20 | loss: 0.0072157
	speed: 0.2706s/iter; left time: 8971.6922s
	iters: 400, epoch: 20 | loss: 0.0000015
	speed: 0.2807s/iter; left time: 9277.4719s
Epoch: 20 cost time: 114.26561522483826
Epoch: 20, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.042 Vali Acc: 0.988 Test Loss: 0.042 Test Acc: 0.988
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000322
	speed: 0.5511s/iter; left time: 18153.5528s
	iters: 200, epoch: 21 | loss: 0.0001683
	speed: 0.2717s/iter; left time: 8923.6699s
	iters: 300, epoch: 21 | loss: 0.0002664
	speed: 0.2738s/iter; left time: 8963.5670s
	iters: 400, epoch: 21 | loss: 0.0000068
	speed: 0.2744s/iter; left time: 8958.0887s
Epoch: 21 cost time: 115.03179788589478
Epoch: 21, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.054 Vali Acc: 0.985 Test Loss: 0.054 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0759914
	speed: 0.5430s/iter; left time: 17662.7219s
	iters: 200, epoch: 22 | loss: 0.0001451
	speed: 0.2750s/iter; left time: 8917.0774s
	iters: 300, epoch: 22 | loss: 0.0001709
	speed: 0.2853s/iter; left time: 9222.9947s
	iters: 400, epoch: 22 | loss: 0.0146673
	speed: 0.2783s/iter; left time: 8970.0508s
Epoch: 22 cost time: 116.15488815307617
Epoch: 22, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.062 Vali Acc: 0.985 Test Loss: 0.062 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.1124887
	speed: 0.5166s/iter; left time: 16589.6371s
	iters: 200, epoch: 23 | loss: 0.0004278
	speed: 0.2848s/iter; left time: 9118.8989s
	iters: 300, epoch: 23 | loss: 0.0007748
	speed: 0.2723s/iter; left time: 8689.1409s
	iters: 400, epoch: 23 | loss: 0.0046931
	speed: 0.2749s/iter; left time: 8745.0487s
Epoch: 23 cost time: 114.90668082237244
Epoch: 23, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.047 Vali Acc: 0.986 Test Loss: 0.047 Test Acc: 0.986
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0000167
	speed: 0.5200s/iter; left time: 16483.5917s
	iters: 200, epoch: 24 | loss: 0.0074536
	speed: 0.2855s/iter; left time: 9022.2905s
	iters: 300, epoch: 24 | loss: 0.0000292
	speed: 0.2792s/iter; left time: 8795.5727s
	iters: 400, epoch: 24 | loss: 0.0811183
	speed: 0.2886s/iter; left time: 9062.5988s
Epoch: 24 cost time: 116.00551891326904
Epoch: 24, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.026 Vali Acc: 0.990 Test Loss: 0.026 Test Acc: 0.990
Validation loss decreased (-0.989086 --> -0.990450).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0000527
	speed: 0.5388s/iter; left time: 16857.2944s
	iters: 200, epoch: 25 | loss: 0.0000471
	speed: 0.2835s/iter; left time: 8840.9311s
	iters: 300, epoch: 25 | loss: 0.0000251
	speed: 0.2609s/iter; left time: 8112.4285s
	iters: 400, epoch: 25 | loss: 0.0003437
	speed: 0.2753s/iter; left time: 8532.4728s
Epoch: 25 cost time: 113.0227370262146
Epoch: 25, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.061 Vali Acc: 0.987 Test Loss: 0.061 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0000349
	speed: 0.5211s/iter; left time: 16089.5764s
	iters: 200, epoch: 26 | loss: 0.0000046
	speed: 0.2566s/iter; left time: 7896.7224s
	iters: 300, epoch: 26 | loss: 0.0010556
	speed: 0.2742s/iter; left time: 8411.5669s
	iters: 400, epoch: 26 | loss: 0.0000133
	speed: 0.2662s/iter; left time: 8139.3253s
Epoch: 26 cost time: 110.79570364952087
Epoch: 26, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.060 Vali Acc: 0.985 Test Loss: 0.060 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0000326
	speed: 0.5157s/iter; left time: 15710.2837s
	iters: 200, epoch: 27 | loss: 0.0000351
	speed: 0.2498s/iter; left time: 7584.2150s
	iters: 300, epoch: 27 | loss: 0.0000222
	speed: 0.2823s/iter; left time: 8542.2725s
	iters: 400, epoch: 27 | loss: 0.0000049
	speed: 0.2480s/iter; left time: 7479.9553s
Epoch: 27 cost time: 109.74127054214478
Epoch: 27, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0000247
	speed: 0.5257s/iter; left time: 15797.9031s
	iters: 200, epoch: 28 | loss: 0.0003814
	speed: 0.2683s/iter; left time: 8035.8106s
	iters: 300, epoch: 28 | loss: 0.0486510
	speed: 0.2645s/iter; left time: 7896.7959s
	iters: 400, epoch: 28 | loss: 0.0057570
	speed: 0.2506s/iter; left time: 7453.9108s
Epoch: 28 cost time: 108.43248796463013
Epoch: 28, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.087 Vali Acc: 0.984 Test Loss: 0.087 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0000001
	speed: 0.5038s/iter; left time: 14932.0742s
	iters: 200, epoch: 29 | loss: 0.0104336
	speed: 0.2610s/iter; left time: 7707.9468s
	iters: 300, epoch: 29 | loss: 0.0000115
	speed: 0.2329s/iter; left time: 6854.7402s
	iters: 400, epoch: 29 | loss: 0.0000761
	speed: 0.2548s/iter; left time: 7476.2788s
Epoch: 29 cost time: 102.89226603507996
Epoch: 29, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0019042
	speed: 0.5108s/iter; left time: 14928.6342s
	iters: 200, epoch: 30 | loss: 0.0019178
	speed: 0.2894s/iter; left time: 8429.1544s
	iters: 300, epoch: 30 | loss: 0.0000795
	speed: 0.2606s/iter; left time: 7563.6398s
	iters: 400, epoch: 30 | loss: 0.0000361
	speed: 0.2886s/iter; left time: 8347.2173s
Epoch: 30 cost time: 114.55917572975159
Epoch: 30, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.061 Vali Acc: 0.985 Test Loss: 0.061 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.0000017
	speed: 0.5315s/iter; left time: 15312.4097s
	iters: 200, epoch: 31 | loss: 0.0000059
	speed: 0.2695s/iter; left time: 7737.0969s
	iters: 300, epoch: 31 | loss: 0.0306408
	speed: 0.2401s/iter; left time: 6868.5348s
	iters: 400, epoch: 31 | loss: 0.0064937
	speed: 0.2646s/iter; left time: 7544.0727s
Epoch: 31 cost time: 109.30595660209656
Epoch: 31, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.063 Vali Acc: 0.985 Test Loss: 0.063 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.0000899
	speed: 0.5074s/iter; left time: 14409.1963s
	iters: 200, epoch: 32 | loss: 0.0000038
	speed: 0.2596s/iter; left time: 7347.3491s
	iters: 300, epoch: 32 | loss: 0.0067689
	speed: 0.2632s/iter; left time: 7420.3444s
	iters: 400, epoch: 32 | loss: 0.0024517
	speed: 0.2452s/iter; left time: 6889.3476s
Epoch: 32 cost time: 107.89110565185547
Epoch: 32, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.060 Vali Acc: 0.987 Test Loss: 0.060 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0000202
	speed: 0.5216s/iter; left time: 14597.8036s
	iters: 200, epoch: 33 | loss: 0.0000027
	speed: 0.2621s/iter; left time: 7308.8227s
	iters: 300, epoch: 33 | loss: 0.0005681
	speed: 0.2722s/iter; left time: 7561.9673s
	iters: 400, epoch: 33 | loss: 0.0000014
	speed: 0.2421s/iter; left time: 6703.1034s
Epoch: 33 cost time: 108.18393278121948
Epoch: 33, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.055 Vali Acc: 0.986 Test Loss: 0.055 Test Acc: 0.986
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.0021402
	speed: 0.5218s/iter; left time: 14386.7112s
	iters: 200, epoch: 34 | loss: 0.0001373
	speed: 0.2780s/iter; left time: 7637.6547s
	iters: 300, epoch: 34 | loss: 0.0004793
	speed: 0.2706s/iter; left time: 7407.0413s
	iters: 400, epoch: 34 | loss: 0.0000001
	speed: 0.2614s/iter; left time: 7129.5882s
Epoch: 34 cost time: 110.39308905601501
Epoch: 34, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.072 Vali Acc: 0.986 Test Loss: 0.072 Test Acc: 0.986
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df256_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.990450204638472
model parameter : 118090
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df256_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.0896468
	speed: 0.2990s/iter; left time: 12319.9473s
	iters: 200, epoch: 1 | loss: 1.5771250
	speed: 0.2512s/iter; left time: 10324.9804s
	iters: 300, epoch: 1 | loss: 0.8392187
	speed: 0.2609s/iter; left time: 10696.9722s
	iters: 400, epoch: 1 | loss: 0.2310340
	speed: 0.2402s/iter; left time: 9823.9337s
Epoch: 1 cost time: 108.87254023551941
Epoch: 1, Steps: 413 | Train Loss: 1.403 Vali Loss: 0.303 Vali Acc: 0.919 Test Loss: 0.303 Test Acc: 0.919
Validation loss decreased (inf --> -0.919051).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1158047
	speed: 0.5072s/iter; left time: 20687.4341s
	iters: 200, epoch: 2 | loss: 0.3775251
	speed: 0.2687s/iter; left time: 10932.1320s
	iters: 300, epoch: 2 | loss: 0.0569795
	speed: 0.2758s/iter; left time: 11193.4024s
	iters: 400, epoch: 2 | loss: 0.0170326
	speed: 0.2588s/iter; left time: 10478.1172s
Epoch: 2 cost time: 109.8330147266388
Epoch: 2, Steps: 413 | Train Loss: 0.219 Vali Loss: 0.108 Vali Acc: 0.966 Test Loss: 0.108 Test Acc: 0.966
Validation loss decreased (-0.919051 --> -0.966347).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1896603
	speed: 0.5313s/iter; left time: 21451.7118s
	iters: 200, epoch: 3 | loss: 0.0585942
	speed: 0.2730s/iter; left time: 10994.2562s
	iters: 300, epoch: 3 | loss: 0.0354653
	speed: 0.2418s/iter; left time: 9714.3178s
	iters: 400, epoch: 3 | loss: 0.0639654
	speed: 0.2500s/iter; left time: 10017.9018s
Epoch: 3 cost time: 106.60425233840942
Epoch: 3, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.081 Vali Acc: 0.974 Test Loss: 0.081 Test Acc: 0.974
Validation loss decreased (-0.966347 --> -0.973624).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0379148
	speed: 0.5101s/iter; left time: 20383.8004s
	iters: 200, epoch: 4 | loss: 0.0413109
	speed: 0.2637s/iter; left time: 10513.3702s
	iters: 300, epoch: 4 | loss: 0.0186897
	speed: 0.2859s/iter; left time: 11369.2944s
	iters: 400, epoch: 4 | loss: 0.0144850
	speed: 0.2633s/iter; left time: 10443.3487s
Epoch: 4 cost time: 112.89133834838867
Epoch: 4, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
Validation loss decreased (-0.973624 --> -0.975897).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0027981
	speed: 0.5288s/iter; left time: 20912.4556s
	iters: 200, epoch: 5 | loss: 0.0227219
	speed: 0.2829s/iter; left time: 11161.0575s
	iters: 300, epoch: 5 | loss: 0.0615263
	speed: 0.2558s/iter; left time: 10064.2071s
	iters: 400, epoch: 5 | loss: 0.0026231
	speed: 0.2781s/iter; left time: 10913.9154s
Epoch: 5 cost time: 111.34851670265198
Epoch: 5, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.090 Vali Acc: 0.971 Test Loss: 0.090 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0142078
	speed: 0.5180s/iter; left time: 20271.6030s
	iters: 200, epoch: 6 | loss: 0.0024568
	speed: 0.2857s/iter; left time: 11151.4967s
	iters: 300, epoch: 6 | loss: 0.0047190
	speed: 0.2695s/iter; left time: 10494.2521s
	iters: 400, epoch: 6 | loss: 0.0066520
	speed: 0.2713s/iter; left time: 10537.8504s
Epoch: 6 cost time: 113.76896238327026
Epoch: 6, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.101 Vali Acc: 0.967 Test Loss: 0.101 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0008179
	speed: 0.5457s/iter; left time: 21132.5807s
	iters: 200, epoch: 7 | loss: 0.0076237
	speed: 0.2686s/iter; left time: 10372.3661s
	iters: 300, epoch: 7 | loss: 0.0010743
	speed: 0.2494s/iter; left time: 9607.6354s
	iters: 400, epoch: 7 | loss: 0.0018908
	speed: 0.2809s/iter; left time: 10791.2318s
Epoch: 7 cost time: 113.75813579559326
Epoch: 7, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.069 Vali Acc: 0.978 Test Loss: 0.069 Test Acc: 0.978
Validation loss decreased (-0.975897 --> -0.977716).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1169171
	speed: 0.5191s/iter; left time: 19886.8450s
	iters: 200, epoch: 8 | loss: 0.0007450
	speed: 0.2773s/iter; left time: 10595.1193s
	iters: 300, epoch: 8 | loss: 0.0040023
	speed: 0.2817s/iter; left time: 10734.6871s
	iters: 400, epoch: 8 | loss: 0.0191891
	speed: 0.2835s/iter; left time: 10774.5151s
Epoch: 8 cost time: 116.64771699905396
Epoch: 8, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.055 Vali Acc: 0.983 Test Loss: 0.055 Test Acc: 0.983
Validation loss decreased (-0.977716 --> -0.982719).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0025052
	speed: 0.5410s/iter; left time: 20500.4281s
	iters: 200, epoch: 9 | loss: 0.0150908
	speed: 0.2744s/iter; left time: 10369.8720s
	iters: 300, epoch: 9 | loss: 0.0033797
	speed: 0.2408s/iter; left time: 9078.0706s
	iters: 400, epoch: 9 | loss: 0.0038174
	speed: 0.2631s/iter; left time: 9891.5640s
Epoch: 9 cost time: 110.50310921669006
Epoch: 9, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0343081
	speed: 0.5420s/iter; left time: 20317.4544s
	iters: 200, epoch: 10 | loss: 0.0004459
	speed: 0.2800s/iter; left time: 10468.6201s
	iters: 300, epoch: 10 | loss: 0.0026564
	speed: 0.2474s/iter; left time: 9223.3520s
	iters: 400, epoch: 10 | loss: 0.0010528
	speed: 0.2790s/iter; left time: 10373.1712s
Epoch: 10 cost time: 112.17113399505615
Epoch: 10, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0001355
	speed: 0.5427s/iter; left time: 20119.8311s
	iters: 200, epoch: 11 | loss: 0.0011146
	speed: 0.2788s/iter; left time: 10308.3662s
	iters: 300, epoch: 11 | loss: 0.0021797
	speed: 0.2869s/iter; left time: 10578.6216s
	iters: 400, epoch: 11 | loss: 0.0027717
	speed: 0.2813s/iter; left time: 10342.4750s
Epoch: 11 cost time: 118.70361590385437
Epoch: 11, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.074 Vali Acc: 0.979 Test Loss: 0.074 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0001069
	speed: 0.5479s/iter; left time: 20085.7611s
	iters: 200, epoch: 12 | loss: 0.0025376
	speed: 0.2564s/iter; left time: 9373.1725s
	iters: 300, epoch: 12 | loss: 0.0085861
	speed: 0.2567s/iter; left time: 9357.0364s
	iters: 400, epoch: 12 | loss: 0.0731061
	speed: 0.2490s/iter; left time: 9052.1267s
Epoch: 12 cost time: 108.80613589286804
Epoch: 12, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0035349
	speed: 0.5360s/iter; left time: 19429.0007s
	iters: 200, epoch: 13 | loss: 0.0007977
	speed: 0.2872s/iter; left time: 10381.2991s
	iters: 300, epoch: 13 | loss: 0.0013940
	speed: 0.2900s/iter; left time: 10452.6083s
	iters: 400, epoch: 13 | loss: 0.0042341
	speed: 0.2680s/iter; left time: 9633.9158s
Epoch: 13 cost time: 117.33843231201172
Epoch: 13, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.072 Vali Acc: 0.979 Test Loss: 0.072 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0004526
	speed: 0.5177s/iter; left time: 18550.9953s
	iters: 200, epoch: 14 | loss: 0.0014962
	speed: 0.2870s/iter; left time: 10255.2057s
	iters: 300, epoch: 14 | loss: 0.0003890
	speed: 0.2518s/iter; left time: 8973.6320s
	iters: 400, epoch: 14 | loss: 0.0011657
	speed: 0.2590s/iter; left time: 9203.2202s
Epoch: 14 cost time: 108.5215756893158
Epoch: 14, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0067329
	speed: 0.5420s/iter; left time: 19196.2844s
	iters: 200, epoch: 15 | loss: 0.0034728
	speed: 0.2896s/iter; left time: 10227.5279s
	iters: 300, epoch: 15 | loss: 0.0007483
	speed: 0.2592s/iter; left time: 9128.1933s
	iters: 400, epoch: 15 | loss: 0.0000236
	speed: 0.2843s/iter; left time: 9984.9075s
Epoch: 15 cost time: 114.45255494117737
Epoch: 15, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0000047
	speed: 0.5319s/iter; left time: 18618.3372s
	iters: 200, epoch: 16 | loss: 0.0009642
	speed: 0.2772s/iter; left time: 9677.4901s
	iters: 300, epoch: 16 | loss: 0.0000074
	speed: 0.2704s/iter; left time: 9412.1035s
	iters: 400, epoch: 16 | loss: 0.0000165
	speed: 0.2633s/iter; left time: 9138.2778s
Epoch: 16 cost time: 112.72542667388916
Epoch: 16, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.072 Vali Acc: 0.986 Test Loss: 0.072 Test Acc: 0.986
Validation loss decreased (-0.982719 --> -0.985902).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0263250
	speed: 0.5150s/iter; left time: 17816.1019s
	iters: 200, epoch: 17 | loss: 0.0000158
	speed: 0.2887s/iter; left time: 9957.0749s
	iters: 300, epoch: 17 | loss: 0.0004486
	speed: 0.2531s/iter; left time: 8705.7378s
	iters: 400, epoch: 17 | loss: 0.0208752
	speed: 0.2780s/iter; left time: 9533.4514s
Epoch: 17 cost time: 110.70877027511597
Epoch: 17, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000018
	speed: 0.5386s/iter; left time: 18410.1040s
	iters: 200, epoch: 18 | loss: 0.0002488
	speed: 0.2804s/iter; left time: 9556.9829s
	iters: 300, epoch: 18 | loss: 0.0001043
	speed: 0.2857s/iter; left time: 9708.8918s
	iters: 400, epoch: 18 | loss: 0.0000714
	speed: 0.2629s/iter; left time: 8907.6870s
Epoch: 18 cost time: 115.78941106796265
Epoch: 18, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.116 Vali Acc: 0.975 Test Loss: 0.116 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0004748
	speed: 0.4860s/iter; left time: 16409.8675s
	iters: 200, epoch: 19 | loss: 0.0000324
	speed: 0.2769s/iter; left time: 9323.7795s
	iters: 300, epoch: 19 | loss: 0.0001874
	speed: 0.2743s/iter; left time: 9207.8977s
	iters: 400, epoch: 19 | loss: 0.0130891
	speed: 0.2722s/iter; left time: 9108.2372s
Epoch: 19 cost time: 111.81606245040894
Epoch: 19, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.169 Vali Acc: 0.969 Test Loss: 0.169 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000604
	speed: 0.5393s/iter; left time: 17986.8926s
	iters: 200, epoch: 20 | loss: 0.0011349
	speed: 0.2868s/iter; left time: 9538.3312s
	iters: 300, epoch: 20 | loss: 0.0005679
	speed: 0.2899s/iter; left time: 9610.3848s
	iters: 400, epoch: 20 | loss: 0.0001701
	speed: 0.2630s/iter; left time: 8691.6779s
Epoch: 20 cost time: 113.85600566864014
Epoch: 20, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.075 Vali Acc: 0.976 Test Loss: 0.075 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0001945
	speed: 0.4943s/iter; left time: 16282.0435s
	iters: 200, epoch: 21 | loss: 0.0000471
	speed: 0.2863s/iter; left time: 9402.7037s
	iters: 300, epoch: 21 | loss: 0.0017200
	speed: 0.2678s/iter; left time: 8767.8847s
	iters: 400, epoch: 21 | loss: 0.0005229
	speed: 0.2934s/iter; left time: 9575.8649s
Epoch: 21 cost time: 112.9504644870758
Epoch: 21, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0006175
	speed: 0.4889s/iter; left time: 15903.4808s
	iters: 200, epoch: 22 | loss: 0.0000269
	speed: 0.2890s/iter; left time: 9372.5076s
	iters: 300, epoch: 22 | loss: 0.0000379
	speed: 0.2915s/iter; left time: 9423.9526s
	iters: 400, epoch: 22 | loss: 0.0000400
	speed: 0.2658s/iter; left time: 8567.4844s
Epoch: 22 cost time: 113.65492105484009
Epoch: 22, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0233313
	speed: 0.5169s/iter; left time: 16600.3282s
	iters: 200, epoch: 23 | loss: 0.0000912
	speed: 0.2914s/iter; left time: 9328.5679s
	iters: 300, epoch: 23 | loss: 0.0009909
	speed: 0.2849s/iter; left time: 9091.8675s
	iters: 400, epoch: 23 | loss: 0.0020328
	speed: 0.2700s/iter; left time: 8590.4725s
Epoch: 23 cost time: 113.79099535942078
Epoch: 23, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.2412890
	speed: 0.5068s/iter; left time: 16066.6909s
	iters: 200, epoch: 24 | loss: 0.0001008
	speed: 0.2952s/iter; left time: 9330.4514s
	iters: 300, epoch: 24 | loss: 0.0000318
	speed: 0.2739s/iter; left time: 8627.2383s
	iters: 400, epoch: 24 | loss: 0.0000030
	speed: 0.2880s/iter; left time: 9043.4867s
Epoch: 24 cost time: 116.13127255439758
Epoch: 24, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.068 Vali Acc: 0.981 Test Loss: 0.068 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0014405
	speed: 0.5215s/iter; left time: 16318.0119s
	iters: 200, epoch: 25 | loss: 0.0002131
	speed: 0.2780s/iter; left time: 8669.8883s
	iters: 300, epoch: 25 | loss: 0.0000018
	speed: 0.2544s/iter; left time: 7909.1464s
	iters: 400, epoch: 25 | loss: 0.0000320
	speed: 0.2766s/iter; left time: 8571.5488s
Epoch: 25 cost time: 111.68178367614746
Epoch: 25, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.070 Vali Acc: 0.985 Test Loss: 0.070 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0040733
	speed: 0.5061s/iter; left time: 15627.0969s
	iters: 200, epoch: 26 | loss: 0.0000008
	speed: 0.2905s/iter; left time: 8939.3570s
	iters: 300, epoch: 26 | loss: 0.0000110
	speed: 0.2908s/iter; left time: 8920.7593s
	iters: 400, epoch: 26 | loss: 0.0000219
	speed: 0.2961s/iter; left time: 9054.5703s
Epoch: 26 cost time: 119.97581481933594
Epoch: 26, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.124 Vali Acc: 0.978 Test Loss: 0.124 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df256_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9859026830377444
model parameter : 118090
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df256_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.1761553
	speed: 0.2803s/iter; left time: 11547.9643s
	iters: 200, epoch: 1 | loss: 1.8413954
	speed: 0.2625s/iter; left time: 10790.6413s
	iters: 300, epoch: 1 | loss: 0.8222864
	speed: 0.2749s/iter; left time: 11272.3769s
	iters: 400, epoch: 1 | loss: 0.1636939
	speed: 0.2610s/iter; left time: 10676.8274s
Epoch: 1 cost time: 111.77646255493164
Epoch: 1, Steps: 413 | Train Loss: 1.501 Vali Loss: 0.335 Vali Acc: 0.914 Test Loss: 0.335 Test Acc: 0.914
Validation loss decreased (inf --> -0.914048).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1301332
	speed: 0.5231s/iter; left time: 21335.4383s
	iters: 200, epoch: 2 | loss: 0.8214146
	speed: 0.2817s/iter; left time: 11462.8876s
	iters: 300, epoch: 2 | loss: 0.0622657
	speed: 0.2833s/iter; left time: 11498.7092s
	iters: 400, epoch: 2 | loss: 0.0345413
	speed: 0.2397s/iter; left time: 9704.6048s
Epoch: 2 cost time: 111.23843383789062
Epoch: 2, Steps: 413 | Train Loss: 0.263 Vali Loss: 0.137 Vali Acc: 0.955 Test Loss: 0.137 Test Acc: 0.955
Validation loss decreased (-0.914048 --> -0.954978).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3089359
	speed: 0.5024s/iter; left time: 20282.4199s
	iters: 200, epoch: 3 | loss: 0.1324660
	speed: 0.2771s/iter; left time: 11158.6228s
	iters: 300, epoch: 3 | loss: 0.0313054
	speed: 0.2488s/iter; left time: 9997.4174s
	iters: 400, epoch: 3 | loss: 0.0699697
	speed: 0.2756s/iter; left time: 11044.9866s
Epoch: 3 cost time: 108.323246717453
Epoch: 3, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.078 Vali Acc: 0.974 Test Loss: 0.078 Test Acc: 0.974
Validation loss decreased (-0.954978 --> -0.973624).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0192981
	speed: 0.5144s/iter; left time: 20557.4459s
	iters: 200, epoch: 4 | loss: 0.0210194
	speed: 0.2674s/iter; left time: 10659.1430s
	iters: 300, epoch: 4 | loss: 0.0414791
	speed: 0.2698s/iter; left time: 10726.6158s
	iters: 400, epoch: 4 | loss: 0.0192611
	speed: 0.2745s/iter; left time: 10887.8750s
Epoch: 4 cost time: 111.64265727996826
Epoch: 4, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.074 Vali Acc: 0.975 Test Loss: 0.074 Test Acc: 0.975
Validation loss decreased (-0.973624 --> -0.974533).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0098578
	speed: 0.5044s/iter; left time: 19947.1915s
	iters: 200, epoch: 5 | loss: 0.0247010
	speed: 0.2695s/iter; left time: 10633.2864s
	iters: 300, epoch: 5 | loss: 0.1161865
	speed: 0.2797s/iter; left time: 11004.1113s
	iters: 400, epoch: 5 | loss: 0.0126652
	speed: 0.2646s/iter; left time: 10385.8454s
Epoch: 5 cost time: 113.01417136192322
Epoch: 5, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0343200
	speed: 0.4932s/iter; left time: 19300.0732s
	iters: 200, epoch: 6 | loss: 0.0146997
	speed: 0.2605s/iter; left time: 10170.3570s
	iters: 300, epoch: 6 | loss: 0.0237461
	speed: 0.2527s/iter; left time: 9840.3771s
	iters: 400, epoch: 6 | loss: 0.0035215
	speed: 0.2730s/iter; left time: 10603.5260s
Epoch: 6 cost time: 108.00153827667236
Epoch: 6, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.076 Vali Acc: 0.972 Test Loss: 0.076 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0025979
	speed: 0.5387s/iter; left time: 20858.7920s
	iters: 200, epoch: 7 | loss: 0.0086636
	speed: 0.2852s/iter; left time: 11014.1450s
	iters: 300, epoch: 7 | loss: 0.0006058
	speed: 0.2771s/iter; left time: 10674.1687s
	iters: 400, epoch: 7 | loss: 0.0053178
	speed: 0.2692s/iter; left time: 10342.4558s
Epoch: 7 cost time: 116.1349549293518
Epoch: 7, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.067 Vali Acc: 0.977 Test Loss: 0.067 Test Acc: 0.977
Validation loss decreased (-0.974533 --> -0.977262).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0321199
	speed: 0.5022s/iter; left time: 19237.9609s
	iters: 200, epoch: 8 | loss: 0.0005067
	speed: 0.2555s/iter; left time: 9762.7279s
	iters: 300, epoch: 8 | loss: 0.0007460
	speed: 0.2833s/iter; left time: 10796.8336s
	iters: 400, epoch: 8 | loss: 0.0934416
	speed: 0.2745s/iter; left time: 10434.0932s
Epoch: 8 cost time: 113.31674265861511
Epoch: 8, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.103 Vali Acc: 0.969 Test Loss: 0.103 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0034811
	speed: 0.5476s/iter; left time: 20752.0465s
	iters: 200, epoch: 9 | loss: 0.0316541
	speed: 0.2677s/iter; left time: 10117.6894s
	iters: 300, epoch: 9 | loss: 0.0024191
	speed: 0.2741s/iter; left time: 10331.4636s
	iters: 400, epoch: 9 | loss: 0.0063812
	speed: 0.2466s/iter; left time: 9271.4316s
Epoch: 9 cost time: 110.95247387886047
Epoch: 9, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.074 Vali Acc: 0.975 Test Loss: 0.074 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0381513
	speed: 0.5710s/iter; left time: 21402.5298s
	iters: 200, epoch: 10 | loss: 0.0031257
	speed: 0.2606s/iter; left time: 9742.6931s
	iters: 300, epoch: 10 | loss: 0.0007075
	speed: 0.2616s/iter; left time: 9752.4444s
	iters: 400, epoch: 10 | loss: 0.0037966
	speed: 0.2371s/iter; left time: 8815.1068s
Epoch: 10 cost time: 110.71094703674316
Epoch: 10, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.085 Vali Acc: 0.972 Test Loss: 0.085 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0028796
	speed: 0.5541s/iter; left time: 20539.6780s
	iters: 200, epoch: 11 | loss: 0.0005161
	speed: 0.2810s/iter; left time: 10389.7809s
	iters: 300, epoch: 11 | loss: 0.0012978
	speed: 0.2778s/iter; left time: 10242.9236s
	iters: 400, epoch: 11 | loss: 0.0031172
	speed: 0.2717s/iter; left time: 9990.7742s
Epoch: 11 cost time: 115.17909049987793
Epoch: 11, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.074 Vali Acc: 0.975 Test Loss: 0.074 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0007600
	speed: 0.5100s/iter; left time: 18694.4443s
	iters: 200, epoch: 12 | loss: 0.0012431
	speed: 0.2678s/iter; left time: 9788.8432s
	iters: 300, epoch: 12 | loss: 0.0087493
	speed: 0.2682s/iter; left time: 9778.7428s
	iters: 400, epoch: 12 | loss: 0.3269950
	speed: 0.2526s/iter; left time: 9183.0122s
Epoch: 12 cost time: 110.1202962398529
Epoch: 12, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.087 Vali Acc: 0.971 Test Loss: 0.087 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0001088
	speed: 0.5212s/iter; left time: 18889.7671s
	iters: 200, epoch: 13 | loss: 0.0000176
	speed: 0.2819s/iter; left time: 10188.9203s
	iters: 300, epoch: 13 | loss: 0.0019941
	speed: 0.2750s/iter; left time: 9912.7552s
	iters: 400, epoch: 13 | loss: 0.0015729
	speed: 0.2958s/iter; left time: 10631.1917s
Epoch: 13 cost time: 115.979327917099
Epoch: 13, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.070 Vali Acc: 0.976 Test Loss: 0.070 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0000568
	speed: 0.5001s/iter; left time: 17917.7933s
	iters: 200, epoch: 14 | loss: 0.0000079
	speed: 0.2483s/iter; left time: 8872.9295s
	iters: 300, epoch: 14 | loss: 0.0007528
	speed: 0.2837s/iter; left time: 10107.9560s
	iters: 400, epoch: 14 | loss: 0.0001294
	speed: 0.2726s/iter; left time: 9686.9599s
Epoch: 14 cost time: 111.87530255317688
Epoch: 14, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.123 Vali Acc: 0.964 Test Loss: 0.123 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0005837
	speed: 0.5283s/iter; left time: 18711.6994s
	iters: 200, epoch: 15 | loss: 0.0002032
	speed: 0.2793s/iter; left time: 9863.5755s
	iters: 300, epoch: 15 | loss: 0.1621357
	speed: 0.2688s/iter; left time: 9466.4660s
	iters: 400, epoch: 15 | loss: 0.0000189
	speed: 0.2918s/iter; left time: 10247.8095s
Epoch: 15 cost time: 114.41560220718384
Epoch: 15, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0000103
	speed: 0.5406s/iter; left time: 18925.3342s
	iters: 200, epoch: 16 | loss: 0.0000029
	speed: 0.2714s/iter; left time: 9472.7562s
	iters: 300, epoch: 16 | loss: 0.0007721
	speed: 0.2397s/iter; left time: 8341.4506s
	iters: 400, epoch: 16 | loss: 0.0000038
	speed: 0.2785s/iter; left time: 9665.1004s
Epoch: 16 cost time: 109.59551405906677
Epoch: 16, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0007073
	speed: 0.5179s/iter; left time: 17914.1389s
	iters: 200, epoch: 17 | loss: 0.0018031
	speed: 0.2693s/iter; left time: 9289.3632s
	iters: 300, epoch: 17 | loss: 0.0015663
	speed: 0.2882s/iter; left time: 9913.0940s
	iters: 400, epoch: 17 | loss: 0.0009062
	speed: 0.2697s/iter; left time: 9247.3740s
Epoch: 17 cost time: 115.16461229324341
Epoch: 17, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df256_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.977262391996362
model parameter : 118090
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df256_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.1937118
	speed: 0.3145s/iter; left time: 12956.6166s
	iters: 200, epoch: 1 | loss: 1.9625469
	speed: 0.2829s/iter; left time: 11628.1934s
	iters: 300, epoch: 1 | loss: 0.7970283
	speed: 0.2841s/iter; left time: 11649.7817s
	iters: 400, epoch: 1 | loss: 0.2596620
	speed: 0.2675s/iter; left time: 10940.5287s
Epoch: 1 cost time: 118.34115815162659
Epoch: 1, Steps: 413 | Train Loss: 1.540 Vali Loss: 0.342 Vali Acc: 0.902 Test Loss: 0.342 Test Acc: 0.902
Validation loss decreased (inf --> -0.902225).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1081049
	speed: 0.5346s/iter; left time: 21803.7892s
	iters: 200, epoch: 2 | loss: 0.8444841
	speed: 0.2996s/iter; left time: 12190.1248s
	iters: 300, epoch: 2 | loss: 0.0808517
	speed: 0.2612s/iter; left time: 10601.1369s
	iters: 400, epoch: 2 | loss: 0.0324051
	speed: 0.2521s/iter; left time: 10205.4756s
Epoch: 2 cost time: 114.41325736045837
Epoch: 2, Steps: 413 | Train Loss: 0.277 Vali Loss: 0.146 Vali Acc: 0.956 Test Loss: 0.146 Test Acc: 0.956
Validation loss decreased (-0.902225 --> -0.956342).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2959398
	speed: 0.5251s/iter; left time: 21202.2867s
	iters: 200, epoch: 3 | loss: 0.1377525
	speed: 0.2849s/iter; left time: 11474.4311s
	iters: 300, epoch: 3 | loss: 0.0444716
	speed: 0.2921s/iter; left time: 11733.5229s
	iters: 400, epoch: 3 | loss: 0.0478183
	speed: 0.2371s/iter; left time: 9499.9218s
Epoch: 3 cost time: 112.47695899009705
Epoch: 3, Steps: 413 | Train Loss: 0.121 Vali Loss: 0.094 Vali Acc: 0.967 Test Loss: 0.094 Test Acc: 0.967
Validation loss decreased (-0.956342 --> -0.966802).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0339257
	speed: 0.5245s/iter; left time: 20960.9823s
	iters: 200, epoch: 4 | loss: 0.0411895
	speed: 0.2833s/iter; left time: 11291.1848s
	iters: 300, epoch: 4 | loss: 0.0157261
	speed: 0.2796s/iter; left time: 11117.8341s
	iters: 400, epoch: 4 | loss: 0.0135887
	speed: 0.2943s/iter; left time: 11673.5750s
Epoch: 4 cost time: 115.67891097068787
Epoch: 4, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.080 Vali Acc: 0.974 Test Loss: 0.080 Test Acc: 0.974
Validation loss decreased (-0.966802 --> -0.974078).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0346863
	speed: 0.5337s/iter; left time: 21105.8064s
	iters: 200, epoch: 5 | loss: 0.0132837
	speed: 0.2628s/iter; left time: 10367.6768s
	iters: 300, epoch: 5 | loss: 0.2853800
	speed: 0.2826s/iter; left time: 11120.8272s
	iters: 400, epoch: 5 | loss: 0.0117845
	speed: 0.2921s/iter; left time: 11465.0621s
Epoch: 5 cost time: 115.85685420036316
Epoch: 5, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0117075
	speed: 0.5492s/iter; left time: 21492.7570s
	iters: 200, epoch: 6 | loss: 0.0024643
	speed: 0.2682s/iter; left time: 10470.7023s
	iters: 300, epoch: 6 | loss: 0.0065011
	speed: 0.2844s/iter; left time: 11074.7663s
	iters: 400, epoch: 6 | loss: 0.0023641
	speed: 0.2954s/iter; left time: 11473.4743s
Epoch: 6 cost time: 116.8018913269043
Epoch: 6, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.067 Vali Acc: 0.979 Test Loss: 0.067 Test Acc: 0.979
Validation loss decreased (-0.974078 --> -0.978626).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0019206
	speed: 0.5509s/iter; left time: 21332.0417s
	iters: 200, epoch: 7 | loss: 0.0461184
	speed: 0.2637s/iter; left time: 10184.5111s
	iters: 300, epoch: 7 | loss: 0.0023565
	speed: 0.2598s/iter; left time: 10009.0590s
	iters: 400, epoch: 7 | loss: 0.0031987
	speed: 0.2922s/iter; left time: 11226.5578s
Epoch: 7 cost time: 113.59662055969238
Epoch: 7, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.081 Vali Acc: 0.975 Test Loss: 0.081 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0317363
	speed: 0.5280s/iter; left time: 20227.3334s
	iters: 200, epoch: 8 | loss: 0.0007321
	speed: 0.2528s/iter; left time: 9660.1350s
	iters: 300, epoch: 8 | loss: 0.0507039
	speed: 0.2830s/iter; left time: 10783.2973s
	iters: 400, epoch: 8 | loss: 0.2154858
	speed: 0.2564s/iter; left time: 9743.9552s
Epoch: 8 cost time: 111.80784702301025
Epoch: 8, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0024557
	speed: 0.5518s/iter; left time: 20912.0830s
	iters: 200, epoch: 9 | loss: 0.0039323
	speed: 0.2984s/iter; left time: 11277.0212s
	iters: 300, epoch: 9 | loss: 0.2062260
	speed: 0.2889s/iter; left time: 10890.8106s
	iters: 400, epoch: 9 | loss: 0.0899339
	speed: 0.2621s/iter; left time: 9853.3260s
Epoch: 9 cost time: 116.9180018901825
Epoch: 9, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.057 Vali Acc: 0.982 Test Loss: 0.057 Test Acc: 0.982
Validation loss decreased (-0.978626 --> -0.982264).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0252017
	speed: 0.5014s/iter; left time: 18794.0356s
	iters: 200, epoch: 10 | loss: 0.0034168
	speed: 0.2925s/iter; left time: 10934.1316s
	iters: 300, epoch: 10 | loss: 0.0047378
	speed: 0.2918s/iter; left time: 10879.7631s
	iters: 400, epoch: 10 | loss: 0.0003148
	speed: 0.2793s/iter; left time: 10386.9015s
Epoch: 10 cost time: 117.02558135986328
Epoch: 10, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0015976
	speed: 0.5336s/iter; left time: 19780.0581s
	iters: 200, epoch: 11 | loss: 0.0124763
	speed: 0.2761s/iter; left time: 10206.8028s
	iters: 300, epoch: 11 | loss: 0.0024376
	speed: 0.2904s/iter; left time: 10707.3319s
	iters: 400, epoch: 11 | loss: 0.0003212
	speed: 0.2949s/iter; left time: 10843.6535s
Epoch: 11 cost time: 118.9931914806366
Epoch: 11, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.090 Vali Acc: 0.979 Test Loss: 0.090 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0002327
	speed: 0.5098s/iter; left time: 18687.4856s
	iters: 200, epoch: 12 | loss: 0.0013193
	speed: 0.2710s/iter; left time: 9908.7581s
	iters: 300, epoch: 12 | loss: 0.0030669
	speed: 0.2637s/iter; left time: 9614.6692s
	iters: 400, epoch: 12 | loss: 0.0255756
	speed: 0.2917s/iter; left time: 10604.2863s
Epoch: 12 cost time: 113.04793953895569
Epoch: 12, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.088 Vali Acc: 0.974 Test Loss: 0.088 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0003985
	speed: 0.5433s/iter; left time: 19692.8710s
	iters: 200, epoch: 13 | loss: 0.0006033
	speed: 0.2706s/iter; left time: 9779.0639s
	iters: 300, epoch: 13 | loss: 0.0042390
	speed: 0.3039s/iter; left time: 10953.4343s
	iters: 400, epoch: 13 | loss: 0.0071918
	speed: 0.2811s/iter; left time: 10105.4418s
Epoch: 13 cost time: 118.38703083992004
Epoch: 13, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0069953
	speed: 0.5343s/iter; left time: 19145.0691s
	iters: 200, epoch: 14 | loss: 0.0105818
	speed: 0.3016s/iter; left time: 10776.7135s
	iters: 300, epoch: 14 | loss: 0.0008786
	speed: 0.2860s/iter; left time: 10192.2745s
	iters: 400, epoch: 14 | loss: 0.0009381
	speed: 0.2675s/iter; left time: 9504.6047s
Epoch: 14 cost time: 115.95122051239014
Epoch: 14, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000087
	speed: 0.5408s/iter; left time: 19154.9395s
	iters: 200, epoch: 15 | loss: 0.0003888
	speed: 0.2869s/iter; left time: 10133.3809s
	iters: 300, epoch: 15 | loss: 0.0028289
	speed: 0.2799s/iter; left time: 9856.5958s
	iters: 400, epoch: 15 | loss: 0.0000022
	speed: 0.2842s/iter; left time: 9980.8435s
Epoch: 15 cost time: 117.03909492492676
Epoch: 15, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.092 Vali Acc: 0.979 Test Loss: 0.092 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0000112
	speed: 0.5376s/iter; left time: 18819.4924s
	iters: 200, epoch: 16 | loss: 0.0000853
	speed: 0.2874s/iter; left time: 10032.8374s
	iters: 300, epoch: 16 | loss: 0.0019553
	speed: 0.2772s/iter; left time: 9646.9943s
	iters: 400, epoch: 16 | loss: 0.0000019
	speed: 0.2840s/iter; left time: 9857.0027s
Epoch: 16 cost time: 117.99279952049255
Epoch: 16, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0036542
	speed: 0.5498s/iter; left time: 19019.5813s
	iters: 200, epoch: 17 | loss: 0.0000877
	speed: 0.2858s/iter; left time: 9857.4991s
	iters: 300, epoch: 17 | loss: 0.0004909
	speed: 0.2869s/iter; left time: 9867.0180s
	iters: 400, epoch: 17 | loss: 0.0002962
	speed: 0.2798s/iter; left time: 9595.3865s
Epoch: 17 cost time: 118.69644784927368
Epoch: 17, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0000791
	speed: 0.5349s/iter; left time: 18284.3739s
	iters: 200, epoch: 18 | loss: 0.0011263
	speed: 0.2828s/iter; left time: 9638.4610s
	iters: 300, epoch: 18 | loss: 0.0081202
	speed: 0.2571s/iter; left time: 8735.4175s
	iters: 400, epoch: 18 | loss: 0.0005762
	speed: 0.2780s/iter; left time: 9417.1307s
Epoch: 18 cost time: 113.88336157798767
Epoch: 18, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0004123
	speed: 0.5325s/iter; left time: 17981.6809s
	iters: 200, epoch: 19 | loss: 0.0001623
	speed: 0.2976s/iter; left time: 10019.8303s
	iters: 300, epoch: 19 | loss: 0.0000336
	speed: 0.2920s/iter; left time: 9801.8870s
	iters: 400, epoch: 19 | loss: 0.0038426
	speed: 0.2687s/iter; left time: 8991.3914s
Epoch: 19 cost time: 117.08033895492554
Epoch: 19, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df256_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9822646657571623
model parameter : 118090
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df256_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.1815202
	speed: 0.2926s/iter; left time: 12055.7891s
	iters: 200, epoch: 1 | loss: 1.8851227
	speed: 0.2419s/iter; left time: 9942.6245s
	iters: 300, epoch: 1 | loss: 0.9440577
	speed: 0.2844s/iter; left time: 11660.4551s
	iters: 400, epoch: 1 | loss: 0.2715914
	speed: 0.2399s/iter; left time: 9811.1813s
Epoch: 1 cost time: 109.74258232116699
Epoch: 1, Steps: 413 | Train Loss: 1.510 Vali Loss: 0.335 Vali Acc: 0.910 Test Loss: 0.335 Test Acc: 0.910
Validation loss decreased (inf --> -0.909501).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0965462
	speed: 0.5524s/iter; left time: 22530.9223s
	iters: 200, epoch: 2 | loss: 0.8654106
	speed: 0.2857s/iter; left time: 11622.7667s
	iters: 300, epoch: 2 | loss: 0.0941361
	speed: 0.2831s/iter; left time: 11488.6453s
	iters: 400, epoch: 2 | loss: 0.0246697
	speed: 0.2608s/iter; left time: 10557.3106s
Epoch: 2 cost time: 115.11525845527649
Epoch: 2, Steps: 413 | Train Loss: 0.258 Vali Loss: 0.132 Vali Acc: 0.964 Test Loss: 0.132 Test Acc: 0.964
Validation loss decreased (-0.909501 --> -0.963619).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3301984
	speed: 0.5510s/iter; left time: 22244.8057s
	iters: 200, epoch: 3 | loss: 0.2159339
	speed: 0.2745s/iter; left time: 11053.6420s
	iters: 300, epoch: 3 | loss: 0.0659084
	speed: 0.2493s/iter; left time: 10017.1460s
	iters: 400, epoch: 3 | loss: 0.0753003
	speed: 0.2751s/iter; left time: 11024.8621s
Epoch: 3 cost time: 112.833242893219
Epoch: 3, Steps: 413 | Train Loss: 0.125 Vali Loss: 0.105 Vali Acc: 0.969 Test Loss: 0.105 Test Acc: 0.969
Validation loss decreased (-0.963619 --> -0.969076).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0112232
	speed: 0.5601s/iter; left time: 22382.2416s
	iters: 200, epoch: 4 | loss: 0.0537015
	speed: 0.2628s/iter; left time: 10476.7970s
	iters: 300, epoch: 4 | loss: 0.0435445
	speed: 0.2770s/iter; left time: 11013.9523s
	iters: 400, epoch: 4 | loss: 0.0051679
	speed: 0.2661s/iter; left time: 10554.3354s
Epoch: 4 cost time: 113.67384696006775
Epoch: 4, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
Validation loss decreased (-0.969076 --> -0.975897).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0085103
	speed: 0.5542s/iter; left time: 21917.3635s
	iters: 200, epoch: 5 | loss: 0.0144226
	speed: 0.2682s/iter; left time: 10579.9105s
	iters: 300, epoch: 5 | loss: 0.1677930
	speed: 0.2527s/iter; left time: 9943.3405s
	iters: 400, epoch: 5 | loss: 0.0078468
	speed: 0.2603s/iter; left time: 10215.7709s
Epoch: 5 cost time: 110.5992796421051
Epoch: 5, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0183382
	speed: 0.5758s/iter; left time: 22533.7068s
	iters: 200, epoch: 6 | loss: 0.0030564
	speed: 0.2733s/iter; left time: 10667.9927s
	iters: 300, epoch: 6 | loss: 0.0136069
	speed: 0.2916s/iter; left time: 11355.0762s
	iters: 400, epoch: 6 | loss: 0.0032801
	speed: 0.2585s/iter; left time: 10037.7789s
Epoch: 6 cost time: 116.52453994750977
Epoch: 6, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0039635
	speed: 0.5500s/iter; left time: 21297.2496s
	iters: 200, epoch: 7 | loss: 0.0034155
	speed: 0.2785s/iter; left time: 10755.2366s
	iters: 300, epoch: 7 | loss: 0.0016814
	speed: 0.2593s/iter; left time: 9990.8604s
	iters: 400, epoch: 7 | loss: 0.0041965
	speed: 0.2889s/iter; left time: 11099.7254s
Epoch: 7 cost time: 116.00356006622314
Epoch: 7, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.091 Vali Acc: 0.972 Test Loss: 0.091 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0057132
	speed: 0.5501s/iter; left time: 21075.7003s
	iters: 200, epoch: 8 | loss: 0.0005503
	speed: 0.2884s/iter; left time: 11019.6386s
	iters: 300, epoch: 8 | loss: 0.0112642
	speed: 0.2927s/iter; left time: 11153.1663s
	iters: 400, epoch: 8 | loss: 0.0201889
	speed: 0.2873s/iter; left time: 10919.7225s
Epoch: 8 cost time: 118.13950991630554
Epoch: 8, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0022816
	speed: 0.5165s/iter; left time: 19573.9057s
	iters: 200, epoch: 9 | loss: 0.0044505
	speed: 0.2757s/iter; left time: 10422.1060s
	iters: 300, epoch: 9 | loss: 0.0932175
	speed: 0.2595s/iter; left time: 9781.2601s
	iters: 400, epoch: 9 | loss: 0.1391202
	speed: 0.2705s/iter; left time: 10168.8354s
Epoch: 9 cost time: 111.678218126297
Epoch: 9, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.088 Vali Acc: 0.972 Test Loss: 0.088 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0521398
	speed: 0.5395s/iter; left time: 20223.5004s
	iters: 200, epoch: 10 | loss: 0.0014265
	speed: 0.2735s/iter; left time: 10222.9909s
	iters: 300, epoch: 10 | loss: 0.0041130
	speed: 0.2678s/iter; left time: 9985.4518s
	iters: 400, epoch: 10 | loss: 0.0030030
	speed: 0.2846s/iter; left time: 10583.4702s
Epoch: 10 cost time: 115.029949426651
Epoch: 10, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0013281
	speed: 0.5278s/iter; left time: 19566.4047s
	iters: 200, epoch: 11 | loss: 0.0050750
	speed: 0.2619s/iter; left time: 9681.4911s
	iters: 300, epoch: 11 | loss: 0.0001337
	speed: 0.2931s/iter; left time: 10805.8563s
	iters: 400, epoch: 11 | loss: 0.0021569
	speed: 0.2791s/iter; left time: 10262.7718s
Epoch: 11 cost time: 115.0160002708435
Epoch: 11, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
Validation loss decreased (-0.975897 --> -0.976352).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0008080
	speed: 0.5255s/iter; left time: 19264.3673s
	iters: 200, epoch: 12 | loss: 0.0109811
	speed: 0.3022s/iter; left time: 11046.4686s
	iters: 300, epoch: 12 | loss: 0.0093988
	speed: 0.2994s/iter; left time: 10916.8351s
	iters: 400, epoch: 12 | loss: 0.0043504
	speed: 0.2686s/iter; left time: 9764.0427s
Epoch: 12 cost time: 119.22924661636353
Epoch: 12, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976352 --> -0.977261).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000298
	speed: 0.5768s/iter; left time: 20905.7483s
	iters: 200, epoch: 13 | loss: 0.0001081
	speed: 0.2582s/iter; left time: 9332.3532s
	iters: 300, epoch: 13 | loss: 0.0156098
	speed: 0.2454s/iter; left time: 8845.0643s
	iters: 400, epoch: 13 | loss: 0.0023329
	speed: 0.2858s/iter; left time: 10271.5781s
Epoch: 13 cost time: 113.0844624042511
Epoch: 13, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.151 Vali Acc: 0.968 Test Loss: 0.151 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0010781
	speed: 0.5329s/iter; left time: 19093.2230s
	iters: 200, epoch: 14 | loss: 0.0000612
	speed: 0.2823s/iter; left time: 10087.2181s
	iters: 300, epoch: 14 | loss: 0.0007807
	speed: 0.2927s/iter; left time: 10429.8278s
	iters: 400, epoch: 14 | loss: 0.0018286
	speed: 0.2903s/iter; left time: 10315.2282s
Epoch: 14 cost time: 116.01242852210999
Epoch: 14, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0029087
	speed: 0.5277s/iter; left time: 18691.0003s
	iters: 200, epoch: 15 | loss: 0.0058006
	speed: 0.2803s/iter; left time: 9899.4898s
	iters: 300, epoch: 15 | loss: 0.0524337
	speed: 0.2873s/iter; left time: 10117.9122s
	iters: 400, epoch: 15 | loss: 0.0001852
	speed: 0.2786s/iter; left time: 9783.3595s
Epoch: 15 cost time: 115.76397466659546
Epoch: 15, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000607
	speed: 0.5188s/iter; left time: 18160.0144s
	iters: 200, epoch: 16 | loss: 0.0002577
	speed: 0.2766s/iter; left time: 9653.5134s
	iters: 300, epoch: 16 | loss: 0.0108848
	speed: 0.2931s/iter; left time: 10203.1925s
	iters: 400, epoch: 16 | loss: 0.0000028
	speed: 0.2582s/iter; left time: 8960.2117s
Epoch: 16 cost time: 115.9404079914093
Epoch: 16, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0003931
	speed: 0.5544s/iter; left time: 19178.5775s
	iters: 200, epoch: 17 | loss: 0.0000061
	speed: 0.2676s/iter; left time: 9229.9349s
	iters: 300, epoch: 17 | loss: 0.0088190
	speed: 0.2728s/iter; left time: 9382.0582s
	iters: 400, epoch: 17 | loss: 0.0007188
	speed: 0.2919s/iter; left time: 10010.8033s
Epoch: 17 cost time: 114.54921746253967
Epoch: 17, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0002105
	speed: 0.5202s/iter; left time: 17780.0703s
	iters: 200, epoch: 18 | loss: 0.0051875
	speed: 0.2829s/iter; left time: 9641.7485s
	iters: 300, epoch: 18 | loss: 0.0004118
	speed: 0.2868s/iter; left time: 9746.1529s
	iters: 400, epoch: 18 | loss: 0.0148990
	speed: 0.2868s/iter; left time: 9717.9673s
Epoch: 18 cost time: 116.09384274482727
Epoch: 18, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0667225
	speed: 0.5394s/iter; left time: 18214.3539s
	iters: 200, epoch: 19 | loss: 0.0005371
	speed: 0.2863s/iter; left time: 9638.3592s
	iters: 300, epoch: 19 | loss: 0.0000599
	speed: 0.2755s/iter; left time: 9246.4467s
	iters: 400, epoch: 19 | loss: 0.0031676
	speed: 0.2782s/iter; left time: 9311.4077s
Epoch: 19 cost time: 116.58364248275757
Epoch: 19, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.103 Vali Acc: 0.978 Test Loss: 0.103 Test Acc: 0.978
Validation loss decreased (-0.977261 --> -0.977716).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000249
	speed: 0.5531s/iter; left time: 18448.1941s
	iters: 200, epoch: 20 | loss: 0.0013618
	speed: 0.2809s/iter; left time: 9339.5162s
	iters: 300, epoch: 20 | loss: 0.1006813
	speed: 0.2920s/iter; left time: 9682.2722s
	iters: 400, epoch: 20 | loss: 0.0000527
	speed: 0.2887s/iter; left time: 9541.7024s
Epoch: 20 cost time: 119.9032850265503
Epoch: 20, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.977716 --> -0.979535).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000393
	speed: 0.5271s/iter; left time: 17363.4225s
	iters: 200, epoch: 21 | loss: 0.0183600
	speed: 0.2802s/iter; left time: 9200.6032s
	iters: 300, epoch: 21 | loss: 0.0000276
	speed: 0.2797s/iter; left time: 9156.1838s
	iters: 400, epoch: 21 | loss: 0.0008733
	speed: 0.2811s/iter; left time: 9175.5892s
Epoch: 21 cost time: 114.9075334072113
Epoch: 21, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.979535 --> -0.982719).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0000022
	speed: 0.5323s/iter; left time: 17315.1204s
	iters: 200, epoch: 22 | loss: 0.0000101
	speed: 0.2976s/iter; left time: 9650.6855s
	iters: 300, epoch: 22 | loss: 0.0008338
	speed: 0.2981s/iter; left time: 9636.4938s
	iters: 400, epoch: 22 | loss: 0.0000260
	speed: 0.2749s/iter; left time: 8859.8041s
Epoch: 22 cost time: 115.78499484062195
Epoch: 22, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0003661
	speed: 0.5465s/iter; left time: 17550.6315s
	iters: 200, epoch: 23 | loss: 0.0000309
	speed: 0.2740s/iter; left time: 8770.9507s
	iters: 300, epoch: 23 | loss: 0.0001273
	speed: 0.2661s/iter; left time: 8493.2557s
	iters: 400, epoch: 23 | loss: 0.2024652
	speed: 0.2898s/iter; left time: 9220.6111s
Epoch: 23 cost time: 116.31725740432739
Epoch: 23, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0000186
	speed: 0.5122s/iter; left time: 16238.2964s
	iters: 200, epoch: 24 | loss: 0.0000089
	speed: 0.2831s/iter; left time: 8946.8171s
	iters: 300, epoch: 24 | loss: 0.0011394
	speed: 0.2828s/iter; left time: 8910.3228s
	iters: 400, epoch: 24 | loss: 0.0000908
	speed: 0.2741s/iter; left time: 8608.0449s
Epoch: 24 cost time: 115.10281205177307
Epoch: 24, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.149 Vali Acc: 0.969 Test Loss: 0.149 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0393704
	speed: 0.5579s/iter; left time: 17456.8106s
	iters: 200, epoch: 25 | loss: 0.0459923
	speed: 0.2727s/iter; left time: 8503.7404s
	iters: 300, epoch: 25 | loss: 0.0000020
	speed: 0.2883s/iter; left time: 8962.6898s
	iters: 400, epoch: 25 | loss: 0.0000146
	speed: 0.2528s/iter; left time: 7833.5957s
Epoch: 25 cost time: 111.87709379196167
Epoch: 25, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0007913
	speed: 0.5545s/iter; left time: 17119.6986s
	iters: 200, epoch: 26 | loss: 0.0000001
	speed: 0.3085s/iter; left time: 9493.9033s
	iters: 300, epoch: 26 | loss: 0.0001033
	speed: 0.2638s/iter; left time: 8093.8467s
	iters: 400, epoch: 26 | loss: 0.0187312
	speed: 0.3079s/iter; left time: 9414.6222s
Epoch: 26 cost time: 122.55877375602722
Epoch: 26, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0000861
	speed: 0.5320s/iter; left time: 16207.4370s
	iters: 200, epoch: 27 | loss: 0.0000006
	speed: 0.2730s/iter; left time: 8288.1237s
	iters: 300, epoch: 27 | loss: 0.0000048
	speed: 0.2943s/iter; left time: 8905.2457s
	iters: 400, epoch: 27 | loss: 0.0000010
	speed: 0.2688s/iter; left time: 8108.3608s
Epoch: 27 cost time: 115.79096841812134
Epoch: 27, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0002440
	speed: 0.5642s/iter; left time: 16955.2902s
	iters: 200, epoch: 28 | loss: 0.0013027
	speed: 0.2840s/iter; left time: 8505.7755s
	iters: 300, epoch: 28 | loss: 0.0002923
	speed: 0.2957s/iter; left time: 8826.1613s
	iters: 400, epoch: 28 | loss: 0.0000079
	speed: 0.2782s/iter; left time: 8277.5008s
Epoch: 28 cost time: 118.82779908180237
Epoch: 28, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.146 Vali Acc: 0.974 Test Loss: 0.146 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0000310
	speed: 0.5601s/iter; left time: 16598.2386s
	iters: 200, epoch: 29 | loss: 0.0007401
	speed: 0.2431s/iter; left time: 7179.4320s
	iters: 300, epoch: 29 | loss: 0.0000009
	speed: 0.2630s/iter; left time: 7742.8172s
	iters: 400, epoch: 29 | loss: 0.0000002
	speed: 0.2927s/iter; left time: 8585.7893s
Epoch: 29 cost time: 113.58289813995361
Epoch: 29, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.108 Vali Acc: 0.979 Test Loss: 0.108 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.3018537
	speed: 0.5171s/iter; left time: 15110.6076s
	iters: 200, epoch: 30 | loss: 0.0010393
	speed: 0.2921s/iter; left time: 8508.2497s
	iters: 300, epoch: 30 | loss: 0.0102264
	speed: 0.2935s/iter; left time: 8519.3482s
	iters: 400, epoch: 30 | loss: 0.6278446
	speed: 0.2915s/iter; left time: 8431.8661s
Epoch: 30 cost time: 116.14536499977112
Epoch: 30, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.133 Vali Acc: 0.974 Test Loss: 0.133 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0000580
	speed: 0.5582s/iter; left time: 16082.0738s
	iters: 200, epoch: 31 | loss: 0.1122802
	speed: 0.2919s/iter; left time: 8381.6635s
	iters: 300, epoch: 31 | loss: 0.0001244
	speed: 0.2603s/iter; left time: 7447.3968s
	iters: 400, epoch: 31 | loss: 0.0573133
	speed: 0.2631s/iter; left time: 7502.6050s
Epoch: 31 cost time: 116.01243877410889
Epoch: 31, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.170 Vali Acc: 0.965 Test Loss: 0.170 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df256_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9827194179172352
model parameter : 118090
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df256_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.3024018
	speed: 0.2704s/iter; left time: 11139.0887s
	iters: 200, epoch: 1 | loss: 2.3028605
	speed: 0.2901s/iter; left time: 11924.6925s
	iters: 300, epoch: 1 | loss: 2.3019481
	speed: 0.2619s/iter; left time: 10739.6369s
	iters: 400, epoch: 1 | loss: 2.2966805
	speed: 0.2817s/iter; left time: 11520.2031s
Epoch: 1 cost time: 114.24056053161621
Epoch: 1, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (inf --> -0.100022).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2999487
	speed: 0.5491s/iter; left time: 22398.5224s
	iters: 200, epoch: 2 | loss: 2.3014202
	speed: 0.2611s/iter; left time: 10625.6413s
	iters: 300, epoch: 2 | loss: 2.2989812
	speed: 0.2893s/iter; left time: 11743.8977s
	iters: 400, epoch: 2 | loss: 2.3033004
	speed: 0.2596s/iter; left time: 10511.7729s
Epoch: 2 cost time: 112.78745722770691
Epoch: 2, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3017700
	speed: 0.5402s/iter; left time: 21809.9751s
	iters: 200, epoch: 3 | loss: 2.3028896
	speed: 0.2776s/iter; left time: 11180.4246s
	iters: 300, epoch: 3 | loss: 2.3002288
	speed: 0.2722s/iter; left time: 10933.7961s
	iters: 400, epoch: 3 | loss: 2.3013330
	speed: 0.2862s/iter; left time: 11468.6607s
Epoch: 3 cost time: 117.06316614151001
Epoch: 3, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3032091
	speed: 0.5038s/iter; left time: 20132.1887s
	iters: 200, epoch: 4 | loss: 2.2992527
	speed: 0.2804s/iter; left time: 11176.3275s
	iters: 300, epoch: 4 | loss: 2.3026628
	speed: 0.2512s/iter; left time: 9988.0840s
	iters: 400, epoch: 4 | loss: 2.3047228
	speed: 0.2800s/iter; left time: 11103.5872s
Epoch: 4 cost time: 109.69763922691345
Epoch: 4, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.3008330
	speed: 0.5232s/iter; left time: 20691.6286s
	iters: 200, epoch: 5 | loss: 2.3080010
	speed: 0.2576s/iter; left time: 10160.7980s
	iters: 300, epoch: 5 | loss: 2.3028080
	speed: 0.2760s/iter; left time: 10859.1623s
	iters: 400, epoch: 5 | loss: 2.3013437
	speed: 0.2824s/iter; left time: 11084.5114s
Epoch: 5 cost time: 112.93849730491638
Epoch: 5, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.3005385
	speed: 0.5183s/iter; left time: 20283.7880s
	iters: 200, epoch: 6 | loss: 2.3048663
	speed: 0.2832s/iter; left time: 11055.4931s
	iters: 300, epoch: 6 | loss: 2.3036342
	speed: 0.2576s/iter; left time: 10029.0084s
	iters: 400, epoch: 6 | loss: 2.3023791
	speed: 0.2206s/iter; left time: 8568.2214s
Epoch: 6 cost time: 107.32269024848938
Epoch: 6, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 2.3056791
	speed: 0.5434s/iter; left time: 21041.6779s
	iters: 200, epoch: 7 | loss: 2.3023748
	speed: 0.2793s/iter; left time: 10786.3101s
	iters: 300, epoch: 7 | loss: 2.3010097
	speed: 0.2649s/iter; left time: 10206.2213s
	iters: 400, epoch: 7 | loss: 2.3011756
	speed: 0.2847s/iter; left time: 10938.7100s
Epoch: 7 cost time: 113.66553974151611
Epoch: 7, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 2.3024101
	speed: 0.5307s/iter; left time: 20331.4325s
	iters: 200, epoch: 8 | loss: 2.2973258
	speed: 0.2780s/iter; left time: 10620.8841s
	iters: 300, epoch: 8 | loss: 2.3034298
	speed: 0.2786s/iter; left time: 10617.1859s
	iters: 400, epoch: 8 | loss: 2.3027132
	speed: 0.2871s/iter; left time: 10913.3086s
Epoch: 8 cost time: 116.90785670280457
Epoch: 8, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 2.3037128
	speed: 0.5138s/iter; left time: 19472.0939s
	iters: 200, epoch: 9 | loss: 2.3021691
	speed: 0.2710s/iter; left time: 10244.7232s
	iters: 300, epoch: 9 | loss: 2.3028333
	speed: 0.2877s/iter; left time: 10845.1775s
	iters: 400, epoch: 9 | loss: 2.3027887
	speed: 0.2348s/iter; left time: 8827.7565s
Epoch: 9 cost time: 108.81069207191467
Epoch: 9, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 2.3047369
	speed: 0.5076s/iter; left time: 19026.8981s
	iters: 200, epoch: 10 | loss: 2.3033283
	speed: 0.2804s/iter; left time: 10483.7903s
	iters: 300, epoch: 10 | loss: 2.3046930
	speed: 0.2581s/iter; left time: 9621.2050s
	iters: 400, epoch: 10 | loss: 2.3050711
	speed: 0.2479s/iter; left time: 9218.3327s
Epoch: 10 cost time: 108.30738425254822
Epoch: 10, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 2.2990434
	speed: 0.4953s/iter; left time: 18361.6782s
	iters: 200, epoch: 11 | loss: 2.3040204
	speed: 0.2624s/iter; left time: 9700.6646s
	iters: 300, epoch: 11 | loss: 2.3022535
	speed: 0.2520s/iter; left time: 9289.7154s
	iters: 400, epoch: 11 | loss: 2.3024373
	speed: 0.2864s/iter; left time: 10532.7433s
Epoch: 11 cost time: 108.841561794281
Epoch: 11, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 2.3035994
	speed: 0.5063s/iter; left time: 18560.7232s
	iters: 200, epoch: 12 | loss: 2.3040645
	speed: 0.2565s/iter; left time: 9377.0086s
	iters: 300, epoch: 12 | loss: 2.3061721
	speed: 0.2780s/iter; left time: 10136.4885s
	iters: 400, epoch: 12 | loss: 2.3021846
	speed: 0.2473s/iter; left time: 8991.3958s
Epoch: 12 cost time: 108.92857694625854
Epoch: 12, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 2.3020079
	speed: 0.4901s/iter; left time: 17764.0367s
	iters: 200, epoch: 13 | loss: 2.2975059
	speed: 0.2398s/iter; left time: 8669.0396s
	iters: 300, epoch: 13 | loss: 2.3044519
	speed: 0.2731s/iter; left time: 9844.6052s
	iters: 400, epoch: 13 | loss: 2.3003521
	speed: 0.2519s/iter; left time: 9052.8393s
Epoch: 13 cost time: 104.51908993721008
Epoch: 13, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 2.3029206
	speed: 0.4648s/iter; left time: 16653.4023s
	iters: 200, epoch: 14 | loss: 2.3028381
	speed: 0.2729s/iter; left time: 9751.6079s
	iters: 300, epoch: 14 | loss: 2.3040555
	speed: 0.2589s/iter; left time: 9226.4431s
	iters: 400, epoch: 14 | loss: 2.3031344
	speed: 0.2818s/iter; left time: 10013.0103s
Epoch: 14 cost time: 107.96741461753845
Epoch: 14, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df256_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.10004547521600728
model parameter : 118090
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         47                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df128_ma47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.3753165
	speed: 0.2785s/iter; left time: 11476.3077s
	iters: 200, epoch: 1 | loss: 0.8480915
	speed: 0.2749s/iter; left time: 11299.3905s
	iters: 300, epoch: 1 | loss: 0.3140861
	speed: 0.2669s/iter; left time: 10944.5256s
	iters: 400, epoch: 1 | loss: 0.2610223
	speed: 0.2669s/iter; left time: 10915.3119s
Epoch: 1 cost time: 111.88904643058777
Epoch: 1, Steps: 413 | Train Loss: 0.861 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (inf --> -0.957706).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0914663
	speed: 0.4759s/iter; left time: 19411.5832s
	iters: 200, epoch: 2 | loss: 0.1356339
	speed: 0.2569s/iter; left time: 10450.9865s
	iters: 300, epoch: 2 | loss: 0.1939256
	speed: 0.2697s/iter; left time: 10946.6636s
	iters: 400, epoch: 2 | loss: 0.0450557
	speed: 0.2734s/iter; left time: 11071.1671s
Epoch: 2 cost time: 109.73975276947021
Epoch: 2, Steps: 413 | Train Loss: 0.140 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.957706 --> -0.979990).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1274914
	speed: 0.5006s/iter; left time: 20213.2695s
	iters: 200, epoch: 3 | loss: 0.0186328
	speed: 0.2607s/iter; left time: 10500.4705s
	iters: 300, epoch: 3 | loss: 0.0068723
	speed: 0.2652s/iter; left time: 10653.7574s
	iters: 400, epoch: 3 | loss: 0.0101742
	speed: 0.2682s/iter; left time: 10749.6353s
Epoch: 3 cost time: 107.88313364982605
Epoch: 3, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
Validation loss decreased (-0.979990 --> -0.980445).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0220066
	speed: 0.5092s/iter; left time: 20348.4513s
	iters: 200, epoch: 4 | loss: 0.0296905
	speed: 0.2732s/iter; left time: 10890.5225s
	iters: 300, epoch: 4 | loss: 0.1088860
	speed: 0.2681s/iter; left time: 10660.2917s
	iters: 400, epoch: 4 | loss: 0.0219977
	speed: 0.2720s/iter; left time: 10787.3260s
Epoch: 4 cost time: 109.99172639846802
Epoch: 4, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.062 Vali Acc: 0.980 Test Loss: 0.062 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0117164
	speed: 0.5186s/iter; left time: 20508.4428s
	iters: 200, epoch: 5 | loss: 0.0239296
	speed: 0.2552s/iter; left time: 10066.9932s
	iters: 300, epoch: 5 | loss: 0.0035865
	speed: 0.2757s/iter; left time: 10848.5642s
	iters: 400, epoch: 5 | loss: 0.0013670
	speed: 0.2414s/iter; left time: 9475.9396s
Epoch: 5 cost time: 107.86966466903687
Epoch: 5, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.040 Vali Acc: 0.987 Test Loss: 0.040 Test Acc: 0.987
Validation loss decreased (-0.980445 --> -0.987267).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0018674
	speed: 0.4991s/iter; left time: 19533.2350s
	iters: 200, epoch: 6 | loss: 0.0052192
	speed: 0.2740s/iter; left time: 10696.3568s
	iters: 300, epoch: 6 | loss: 0.0028639
	speed: 0.2715s/iter; left time: 10571.7879s
	iters: 400, epoch: 6 | loss: 0.0057186
	speed: 0.2545s/iter; left time: 9884.0223s
Epoch: 6 cost time: 107.29083919525146
Epoch: 6, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.049 Vali Acc: 0.984 Test Loss: 0.049 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0051046
	speed: 0.5208s/iter; left time: 20165.2719s
	iters: 200, epoch: 7 | loss: 0.0005830
	speed: 0.2574s/iter; left time: 9942.8543s
	iters: 300, epoch: 7 | loss: 0.0196289
	speed: 0.2858s/iter; left time: 11009.1901s
	iters: 400, epoch: 7 | loss: 0.0878571
	speed: 0.2373s/iter; left time: 9118.2889s
Epoch: 7 cost time: 108.32701396942139
Epoch: 7, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.046 Vali Acc: 0.986 Test Loss: 0.046 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0016044
	speed: 0.5037s/iter; left time: 19297.4765s
	iters: 200, epoch: 8 | loss: 0.0009292
	speed: 0.2568s/iter; left time: 9811.1702s
	iters: 300, epoch: 8 | loss: 0.0024703
	speed: 0.2422s/iter; left time: 9229.3040s
	iters: 400, epoch: 8 | loss: 0.0022869
	speed: 0.2336s/iter; left time: 8880.8202s
Epoch: 8 cost time: 101.0496153831482
Epoch: 8, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.046 Vali Acc: 0.986 Test Loss: 0.046 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0002886
	speed: 0.5314s/iter; left time: 20137.3418s
	iters: 200, epoch: 9 | loss: 0.0166585
	speed: 0.2762s/iter; left time: 10440.0960s
	iters: 300, epoch: 9 | loss: 0.0262409
	speed: 0.2486s/iter; left time: 9371.1571s
	iters: 400, epoch: 9 | loss: 0.0002367
	speed: 0.2756s/iter; left time: 10363.2109s
Epoch: 9 cost time: 111.4921064376831
Epoch: 9, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.060 Vali Acc: 0.982 Test Loss: 0.060 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0007970
	speed: 0.5037s/iter; left time: 18881.9028s
	iters: 200, epoch: 10 | loss: 0.0198963
	speed: 0.2811s/iter; left time: 10507.9246s
	iters: 300, epoch: 10 | loss: 0.0102900
	speed: 0.2536s/iter; left time: 9455.0552s
	iters: 400, epoch: 10 | loss: 0.0108278
	speed: 0.2659s/iter; left time: 9887.2335s
Epoch: 10 cost time: 109.26973390579224
Epoch: 10, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.050 Vali Acc: 0.981 Test Loss: 0.050 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0003200
	speed: 0.5106s/iter; left time: 18927.1328s
	iters: 200, epoch: 11 | loss: 0.0043470
	speed: 0.2596s/iter; left time: 9597.9766s
	iters: 300, epoch: 11 | loss: 0.0307298
	speed: 0.2734s/iter; left time: 10081.9979s
	iters: 400, epoch: 11 | loss: 0.0032805
	speed: 0.2538s/iter; left time: 9332.4028s
Epoch: 11 cost time: 109.57715821266174
Epoch: 11, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.054 Vali Acc: 0.985 Test Loss: 0.054 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0031415
	speed: 0.5137s/iter; left time: 18832.8516s
	iters: 200, epoch: 12 | loss: 0.0000759
	speed: 0.2483s/iter; left time: 9076.7554s
	iters: 300, epoch: 12 | loss: 0.0272049
	speed: 0.2680s/iter; left time: 9769.0824s
	iters: 400, epoch: 12 | loss: 0.0003190
	speed: 0.2540s/iter; left time: 9235.3447s
Epoch: 12 cost time: 106.97108769416809
Epoch: 12, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.055 Vali Acc: 0.984 Test Loss: 0.055 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0063204
	speed: 0.5123s/iter; left time: 18568.4633s
	iters: 200, epoch: 13 | loss: 0.0007764
	speed: 0.2653s/iter; left time: 9590.4299s
	iters: 300, epoch: 13 | loss: 0.0074940
	speed: 0.2885s/iter; left time: 10399.6373s
	iters: 400, epoch: 13 | loss: 0.0000683
	speed: 0.2473s/iter; left time: 8890.0138s
Epoch: 13 cost time: 109.86477732658386
Epoch: 13, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0001244
	speed: 0.5311s/iter; left time: 19031.5191s
	iters: 200, epoch: 14 | loss: 0.0000072
	speed: 0.2785s/iter; left time: 9950.9674s
	iters: 300, epoch: 14 | loss: 0.0008786
	speed: 0.2414s/iter; left time: 8599.9251s
	iters: 400, epoch: 14 | loss: 0.0542994
	speed: 0.2571s/iter; left time: 9136.8885s
Epoch: 14 cost time: 106.88960099220276
Epoch: 14, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.048 Vali Acc: 0.985 Test Loss: 0.048 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0002038
	speed: 0.4750s/iter; left time: 16824.7453s
	iters: 200, epoch: 15 | loss: 0.0000118
	speed: 0.2269s/iter; left time: 8012.5406s
	iters: 300, epoch: 15 | loss: 0.0000757
	speed: 0.2706s/iter; left time: 9528.9395s
	iters: 400, epoch: 15 | loss: 0.0046001
	speed: 0.2643s/iter; left time: 9282.0921s
Epoch: 15 cost time: 106.30490398406982
Epoch: 15, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.045 Vali Acc: 0.987 Test Loss: 0.045 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df128_ma47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9872669395179627
model parameter : 93514
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         38                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df128_ma38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.4322200
	speed: 0.2864s/iter; left time: 11801.3043s
	iters: 200, epoch: 1 | loss: 0.7993005
	speed: 0.2603s/iter; left time: 10697.4531s
	iters: 300, epoch: 1 | loss: 0.3013183
	speed: 0.2537s/iter; left time: 10402.2979s
	iters: 400, epoch: 1 | loss: 0.3262429
	speed: 0.2422s/iter; left time: 9907.1311s
Epoch: 1 cost time: 107.4574089050293
Epoch: 1, Steps: 413 | Train Loss: 0.919 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (inf --> -0.957706).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1023672
	speed: 0.4831s/iter; left time: 19704.4972s
	iters: 200, epoch: 2 | loss: 0.1302552
	speed: 0.2492s/iter; left time: 10141.1040s
	iters: 300, epoch: 2 | loss: 0.1935852
	speed: 0.2746s/iter; left time: 11146.0499s
	iters: 400, epoch: 2 | loss: 0.0373887
	speed: 0.2447s/iter; left time: 9907.2315s
Epoch: 2 cost time: 107.36965441703796
Epoch: 2, Steps: 413 | Train Loss: 0.153 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
Validation loss decreased (-0.957706 --> -0.977716).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0909944
	speed: 0.4771s/iter; left time: 19263.9315s
	iters: 200, epoch: 3 | loss: 0.0148711
	speed: 0.2760s/iter; left time: 11117.6402s
	iters: 300, epoch: 3 | loss: 0.0109260
	speed: 0.2438s/iter; left time: 9795.3848s
	iters: 400, epoch: 3 | loss: 0.0098790
	speed: 0.2724s/iter; left time: 10917.7573s
Epoch: 3 cost time: 105.86192655563354
Epoch: 3, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.063 Vali Acc: 0.977 Test Loss: 0.063 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0248205
	speed: 0.4710s/iter; left time: 18821.8620s
	iters: 200, epoch: 4 | loss: 0.0198124
	speed: 0.2519s/iter; left time: 10043.2279s
	iters: 300, epoch: 4 | loss: 0.0527001
	speed: 0.2487s/iter; left time: 9887.0216s
	iters: 400, epoch: 4 | loss: 0.0246983
	speed: 0.2514s/iter; left time: 9969.6313s
Epoch: 4 cost time: 103.60157132148743
Epoch: 4, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.050 Vali Acc: 0.983 Test Loss: 0.050 Test Acc: 0.983
Validation loss decreased (-0.977716 --> -0.983174).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0120033
	speed: 0.4876s/iter; left time: 19285.6563s
	iters: 200, epoch: 5 | loss: 0.0262247
	speed: 0.2360s/iter; left time: 9310.5014s
	iters: 300, epoch: 5 | loss: 0.0014164
	speed: 0.2712s/iter; left time: 10670.2317s
	iters: 400, epoch: 5 | loss: 0.0006087
	speed: 0.2389s/iter; left time: 9377.2052s
Epoch: 5 cost time: 103.79352068901062
Epoch: 5, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.037 Vali Acc: 0.986 Test Loss: 0.037 Test Acc: 0.986
Validation loss decreased (-0.983174 --> -0.986357).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0026242
	speed: 0.4784s/iter; left time: 18722.8700s
	iters: 200, epoch: 6 | loss: 0.0031972
	speed: 0.2460s/iter; left time: 9601.9438s
	iters: 300, epoch: 6 | loss: 0.0060335
	speed: 0.2605s/iter; left time: 10141.0068s
	iters: 400, epoch: 6 | loss: 0.0047253
	speed: 0.2639s/iter; left time: 10249.4669s
Epoch: 6 cost time: 104.63002729415894
Epoch: 6, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.037 Vali Acc: 0.990 Test Loss: 0.037 Test Acc: 0.990
Validation loss decreased (-0.986357 --> -0.989540).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0035958
	speed: 0.4969s/iter; left time: 19239.6977s
	iters: 200, epoch: 7 | loss: 0.0017704
	speed: 0.2775s/iter; left time: 10719.1905s
	iters: 300, epoch: 7 | loss: 0.0033044
	speed: 0.2683s/iter; left time: 10335.6831s
	iters: 400, epoch: 7 | loss: 0.0115965
	speed: 0.2761s/iter; left time: 10608.1742s
Epoch: 7 cost time: 111.31193804740906
Epoch: 7, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.045 Vali Acc: 0.985 Test Loss: 0.045 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0016034
	speed: 0.5317s/iter; left time: 20370.5191s
	iters: 200, epoch: 8 | loss: 0.0014128
	speed: 0.2437s/iter; left time: 9312.4156s
	iters: 300, epoch: 8 | loss: 0.0006749
	speed: 0.2411s/iter; left time: 9188.9922s
	iters: 400, epoch: 8 | loss: 0.0092589
	speed: 0.2871s/iter; left time: 10911.7011s
Epoch: 8 cost time: 108.86894488334656
Epoch: 8, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0026610
	speed: 0.5384s/iter; left time: 20405.1042s
	iters: 200, epoch: 9 | loss: 0.0039364
	speed: 0.2798s/iter; left time: 10574.4850s
	iters: 300, epoch: 9 | loss: 0.0010065
	speed: 0.2753s/iter; left time: 10378.0392s
	iters: 400, epoch: 9 | loss: 0.0002297
	speed: 0.2748s/iter; left time: 10330.7024s
Epoch: 9 cost time: 116.3419497013092
Epoch: 9, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.080 Vali Acc: 0.975 Test Loss: 0.080 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0002953
	speed: 0.5382s/iter; left time: 20172.9084s
	iters: 200, epoch: 10 | loss: 0.0015028
	speed: 0.2747s/iter; left time: 10269.9651s
	iters: 300, epoch: 10 | loss: 0.0089151
	speed: 0.2409s/iter; left time: 8981.5614s
	iters: 400, epoch: 10 | loss: 0.0190114
	speed: 0.2820s/iter; left time: 10484.9791s
Epoch: 10 cost time: 110.31374311447144
Epoch: 10, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0016749
	speed: 0.5151s/iter; left time: 19094.1250s
	iters: 200, epoch: 11 | loss: 0.0024645
	speed: 0.2608s/iter; left time: 9643.7588s
	iters: 300, epoch: 11 | loss: 0.0018665
	speed: 0.2703s/iter; left time: 9967.7875s
	iters: 400, epoch: 11 | loss: 0.0132748
	speed: 0.2540s/iter; left time: 9338.7163s
Epoch: 11 cost time: 110.31213068962097
Epoch: 11, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0003042
	speed: 0.5327s/iter; left time: 19528.0089s
	iters: 200, epoch: 12 | loss: 0.0007844
	speed: 0.2749s/iter; left time: 10050.6325s
	iters: 300, epoch: 12 | loss: 0.2880470
	speed: 0.2474s/iter; left time: 9018.3549s
	iters: 400, epoch: 12 | loss: 0.0000354
	speed: 0.2912s/iter; left time: 10587.8318s
Epoch: 12 cost time: 112.49129581451416
Epoch: 12, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.049 Vali Acc: 0.984 Test Loss: 0.049 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0007491
	speed: 0.6273s/iter; left time: 22736.4380s
	iters: 200, epoch: 13 | loss: 0.0008767
	speed: 0.2989s/iter; left time: 10803.7010s
	iters: 300, epoch: 13 | loss: 0.0249932
	speed: 0.2937s/iter; left time: 10585.2331s
	iters: 400, epoch: 13 | loss: 0.0003345
	speed: 0.3014s/iter; left time: 10834.9029s
Epoch: 13 cost time: 123.67131614685059
Epoch: 13, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.048 Vali Acc: 0.986 Test Loss: 0.048 Test Acc: 0.986
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000259
	speed: 0.6267s/iter; left time: 22455.1321s
	iters: 200, epoch: 14 | loss: 0.0000269
	speed: 0.2976s/iter; left time: 10634.6134s
	iters: 300, epoch: 14 | loss: 0.0000066
	speed: 0.2984s/iter; left time: 10633.0242s
	iters: 400, epoch: 14 | loss: 0.0011389
	speed: 0.2888s/iter; left time: 10262.4142s
Epoch: 14 cost time: 122.15560674667358
Epoch: 14, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.044 Vali Acc: 0.986 Test Loss: 0.044 Test Acc: 0.986
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0001949
	speed: 0.6108s/iter; left time: 21633.9638s
	iters: 200, epoch: 15 | loss: 0.0000850
	speed: 0.2823s/iter; left time: 9970.5143s
	iters: 300, epoch: 15 | loss: 0.0000391
	speed: 0.2871s/iter; left time: 10111.5077s
	iters: 400, epoch: 15 | loss: 0.0116958
	speed: 0.3109s/iter; left time: 10917.4993s
Epoch: 15 cost time: 121.33971333503723
Epoch: 15, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0024681
	speed: 0.6441s/iter; left time: 22546.9020s
	iters: 200, epoch: 16 | loss: 0.0010527
	speed: 0.3094s/iter; left time: 10799.1458s
	iters: 300, epoch: 16 | loss: 0.0005606
	speed: 0.2750s/iter; left time: 9570.7421s
	iters: 400, epoch: 16 | loss: 0.0005977
	speed: 0.2742s/iter; left time: 9515.2658s
Epoch: 16 cost time: 120.86084461212158
Epoch: 16, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.092 Vali Acc: 0.982 Test Loss: 0.092 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df128_ma38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9895407003183265
model parameter : 93514
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         28                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df128_ma28_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.5455527
	speed: 0.2879s/iter; left time: 11860.4347s
	iters: 200, epoch: 1 | loss: 0.9388222
	speed: 0.2715s/iter; left time: 11158.1290s
	iters: 300, epoch: 1 | loss: 0.3601103
	speed: 0.2708s/iter; left time: 11104.5941s
	iters: 400, epoch: 1 | loss: 0.3599916
	speed: 0.2759s/iter; left time: 11282.9140s
Epoch: 1 cost time: 114.56709027290344
Epoch: 1, Steps: 413 | Train Loss: 1.016 Vali Loss: 0.223 Vali Acc: 0.948 Test Loss: 0.223 Test Acc: 0.948
Validation loss decreased (inf --> -0.948156).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1313684
	speed: 0.5882s/iter; left time: 23990.4929s
	iters: 200, epoch: 2 | loss: 0.1388363
	speed: 0.2722s/iter; left time: 11073.8589s
	iters: 300, epoch: 2 | loss: 0.1074919
	speed: 0.2697s/iter; left time: 10945.5764s
	iters: 400, epoch: 2 | loss: 0.0242921
	speed: 0.2828s/iter; left time: 11448.3737s
Epoch: 2 cost time: 114.44503903388977
Epoch: 2, Steps: 413 | Train Loss: 0.170 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.948156 --> -0.979535).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0471872
	speed: 0.5464s/iter; left time: 22059.0519s
	iters: 200, epoch: 3 | loss: 0.0188709
	speed: 0.2711s/iter; left time: 10917.2949s
	iters: 300, epoch: 3 | loss: 0.0379559
	speed: 0.2711s/iter; left time: 10891.2499s
	iters: 400, epoch: 3 | loss: 0.0123598
	speed: 0.2729s/iter; left time: 10937.6089s
Epoch: 3 cost time: 111.64440822601318
Epoch: 3, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.055 Vali Acc: 0.984 Test Loss: 0.055 Test Acc: 0.984
Validation loss decreased (-0.979535 --> -0.983628).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0089485
	speed: 0.5899s/iter; left time: 23574.3858s
	iters: 200, epoch: 4 | loss: 0.0103534
	speed: 0.2810s/iter; left time: 11202.0630s
	iters: 300, epoch: 4 | loss: 0.0408123
	speed: 0.2842s/iter; left time: 11299.5581s
	iters: 400, epoch: 4 | loss: 0.0282171
	speed: 0.2849s/iter; left time: 11300.9446s
Epoch: 4 cost time: 117.12166285514832
Epoch: 4, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.064 Vali Acc: 0.975 Test Loss: 0.064 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0187333
	speed: 0.5554s/iter; left time: 21964.7239s
	iters: 200, epoch: 5 | loss: 0.0382816
	speed: 0.2622s/iter; left time: 10342.7897s
	iters: 300, epoch: 5 | loss: 0.0014361
	speed: 0.2745s/iter; left time: 10800.3840s
	iters: 400, epoch: 5 | loss: 0.0006556
	speed: 0.2773s/iter; left time: 10882.1728s
Epoch: 5 cost time: 111.20250272750854
Epoch: 5, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.042 Vali Acc: 0.985 Test Loss: 0.042 Test Acc: 0.985
Validation loss decreased (-0.983628 --> -0.985448).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0013195
	speed: 0.5822s/iter; left time: 22786.4504s
	iters: 200, epoch: 6 | loss: 0.0192387
	speed: 0.2786s/iter; left time: 10873.8001s
	iters: 300, epoch: 6 | loss: 0.0058928
	speed: 0.2808s/iter; left time: 10933.5166s
	iters: 400, epoch: 6 | loss: 0.0031988
	speed: 0.2833s/iter; left time: 11000.9297s
Epoch: 6 cost time: 115.85149550437927
Epoch: 6, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.043 Vali Acc: 0.985 Test Loss: 0.043 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0084276
	speed: 0.5587s/iter; left time: 21636.2157s
	iters: 200, epoch: 7 | loss: 0.0008666
	speed: 0.2671s/iter; left time: 10316.5958s
	iters: 300, epoch: 7 | loss: 0.0040627
	speed: 0.2789s/iter; left time: 10743.3268s
	iters: 400, epoch: 7 | loss: 0.0034898
	speed: 0.2800s/iter; left time: 10757.8434s
Epoch: 7 cost time: 113.09036159515381
Epoch: 7, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.036 Vali Acc: 0.987 Test Loss: 0.036 Test Acc: 0.987
Validation loss decreased (-0.985448 --> -0.987267).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0018175
	speed: 0.5757s/iter; left time: 22053.2413s
	iters: 200, epoch: 8 | loss: 0.0088303
	speed: 0.2713s/iter; left time: 10365.2199s
	iters: 300, epoch: 8 | loss: 0.0013168
	speed: 0.2824s/iter; left time: 10761.2266s
	iters: 400, epoch: 8 | loss: 0.0228165
	speed: 0.2849s/iter; left time: 10828.2643s
Epoch: 8 cost time: 114.66228818893433
Epoch: 8, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.036 Vali Acc: 0.986 Test Loss: 0.036 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0002143
	speed: 0.5628s/iter; left time: 21329.4714s
	iters: 200, epoch: 9 | loss: 0.0027167
	speed: 0.2896s/iter; left time: 10944.2239s
	iters: 300, epoch: 9 | loss: 0.0008134
	speed: 0.2840s/iter; left time: 10705.4239s
	iters: 400, epoch: 9 | loss: 0.0028662
	speed: 0.2647s/iter; left time: 9952.6479s
Epoch: 9 cost time: 114.53151106834412
Epoch: 9, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.046 Vali Acc: 0.988 Test Loss: 0.046 Test Acc: 0.988
Validation loss decreased (-0.987267 --> -0.987721).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0016111
	speed: 0.5448s/iter; left time: 20421.8202s
	iters: 200, epoch: 10 | loss: 0.0096835
	speed: 0.2832s/iter; left time: 10586.7644s
	iters: 300, epoch: 10 | loss: 0.0566871
	speed: 0.2620s/iter; left time: 9768.2486s
	iters: 400, epoch: 10 | loss: 0.0022597
	speed: 0.2622s/iter; left time: 9750.4628s
Epoch: 10 cost time: 110.9811065196991
Epoch: 10, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0007692
	speed: 0.5786s/iter; left time: 21450.1515s
	iters: 200, epoch: 11 | loss: 0.0004084
	speed: 0.2771s/iter; left time: 10244.4808s
	iters: 300, epoch: 11 | loss: 0.0104351
	speed: 0.2702s/iter; left time: 9963.9847s
	iters: 400, epoch: 11 | loss: 0.0056518
	speed: 0.2699s/iter; left time: 9925.2524s
Epoch: 11 cost time: 113.58407139778137
Epoch: 11, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.054 Vali Acc: 0.982 Test Loss: 0.054 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0160955
	speed: 0.5696s/iter; left time: 20879.2651s
	iters: 200, epoch: 12 | loss: 0.0114611
	speed: 0.2651s/iter; left time: 9691.0380s
	iters: 300, epoch: 12 | loss: 0.0060501
	speed: 0.2673s/iter; left time: 9745.5183s
	iters: 400, epoch: 12 | loss: 0.0003151
	speed: 0.2788s/iter; left time: 10135.5936s
Epoch: 12 cost time: 112.81621551513672
Epoch: 12, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.052 Vali Acc: 0.987 Test Loss: 0.052 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0038941
	speed: 0.5560s/iter; left time: 20151.2113s
	iters: 200, epoch: 13 | loss: 0.0172671
	speed: 0.2604s/iter; left time: 9412.8335s
	iters: 300, epoch: 13 | loss: 0.0011941
	speed: 0.2793s/iter; left time: 10068.0190s
	iters: 400, epoch: 13 | loss: 0.0005038
	speed: 0.2801s/iter; left time: 10067.9425s
Epoch: 13 cost time: 111.97429037094116
Epoch: 13, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.051 Vali Acc: 0.985 Test Loss: 0.051 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000246
	speed: 0.5600s/iter; left time: 20065.7930s
	iters: 200, epoch: 14 | loss: 0.0002489
	speed: 0.2730s/iter; left time: 9756.3212s
	iters: 300, epoch: 14 | loss: 0.0004694
	speed: 0.2594s/iter; left time: 9242.4541s
	iters: 400, epoch: 14 | loss: 0.0259227
	speed: 0.2648s/iter; left time: 9408.4200s
Epoch: 14 cost time: 110.73223805427551
Epoch: 14, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.066 Vali Acc: 0.982 Test Loss: 0.066 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0004550
	speed: 0.5266s/iter; left time: 18651.6546s
	iters: 200, epoch: 15 | loss: 0.0000151
	speed: 0.2565s/iter; left time: 9060.2179s
	iters: 300, epoch: 15 | loss: 0.0000139
	speed: 0.2565s/iter; left time: 9033.5761s
	iters: 400, epoch: 15 | loss: 0.0337739
	speed: 0.2613s/iter; left time: 9177.6728s
Epoch: 15 cost time: 106.91170954704285
Epoch: 15, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.052 Vali Acc: 0.984 Test Loss: 0.052 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0002467
	speed: 0.5528s/iter; left time: 19351.5826s
	iters: 200, epoch: 16 | loss: 0.0003506
	speed: 0.2680s/iter; left time: 9354.3790s
	iters: 300, epoch: 16 | loss: 0.0008663
	speed: 0.2703s/iter; left time: 9408.9680s
	iters: 400, epoch: 16 | loss: 0.0002063
	speed: 0.2679s/iter; left time: 9298.2302s
Epoch: 16 cost time: 111.26095747947693
Epoch: 16, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0004870
	speed: 0.5182s/iter; left time: 17925.7557s
	iters: 200, epoch: 17 | loss: 0.0020136
	speed: 0.2545s/iter; left time: 8777.1565s
	iters: 300, epoch: 17 | loss: 0.0000028
	speed: 0.2635s/iter; left time: 9064.0331s
	iters: 400, epoch: 17 | loss: 0.0000064
	speed: 0.2680s/iter; left time: 9191.2236s
Epoch: 17 cost time: 107.78825211524963
Epoch: 17, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.975 Test Loss: 0.080 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0004492
	speed: 0.5339s/iter; left time: 18247.6932s
	iters: 200, epoch: 18 | loss: 0.0008955
	speed: 0.2623s/iter; left time: 8940.8527s
	iters: 300, epoch: 18 | loss: 0.0044769
	speed: 0.2559s/iter; left time: 8697.0124s
	iters: 400, epoch: 18 | loss: 0.0000909
	speed: 0.2618s/iter; left time: 8870.4857s
Epoch: 18 cost time: 107.01348924636841
Epoch: 18, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.067 Vali Acc: 0.982 Test Loss: 0.067 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000750
	speed: 0.5498s/iter; left time: 18564.3773s
	iters: 200, epoch: 19 | loss: 0.0026694
	speed: 0.2942s/iter; left time: 9906.0634s
	iters: 300, epoch: 19 | loss: 0.0000448
	speed: 0.2984s/iter; left time: 10015.9318s
	iters: 400, epoch: 19 | loss: 0.0000021
	speed: 0.2929s/iter; left time: 9802.3701s
Epoch: 19 cost time: 120.58371233940125
Epoch: 19, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df128_ma28_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9877216916780355
model parameter : 93514
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         19                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df128_ma19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.6947451
	speed: 0.2771s/iter; left time: 11417.9874s
	iters: 200, epoch: 1 | loss: 1.0467546
	speed: 0.2546s/iter; left time: 10464.2743s
	iters: 300, epoch: 1 | loss: 0.3858632
	speed: 0.2520s/iter; left time: 10331.5292s
	iters: 400, epoch: 1 | loss: 0.4529867
	speed: 0.2576s/iter; left time: 10537.6635s
Epoch: 1 cost time: 107.87206864356995
Epoch: 1, Steps: 413 | Train Loss: 1.156 Vali Loss: 0.246 Vali Acc: 0.942 Test Loss: 0.246 Test Acc: 0.942
Validation loss decreased (inf --> -0.941789).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1395833
	speed: 0.5374s/iter; left time: 21918.6790s
	iters: 200, epoch: 2 | loss: 0.1277950
	speed: 0.2574s/iter; left time: 10473.2228s
	iters: 300, epoch: 2 | loss: 0.1525284
	speed: 0.2665s/iter; left time: 10815.3044s
	iters: 400, epoch: 2 | loss: 0.0380832
	speed: 0.2709s/iter; left time: 10966.4475s
Epoch: 2 cost time: 110.26366877555847
Epoch: 2, Steps: 413 | Train Loss: 0.186 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
Validation loss decreased (-0.941789 --> -0.974988).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1114168
	speed: 0.5432s/iter; left time: 21933.1096s
	iters: 200, epoch: 3 | loss: 0.0248183
	speed: 0.2611s/iter; left time: 10515.7029s
	iters: 300, epoch: 3 | loss: 0.0364758
	speed: 0.2593s/iter; left time: 10419.3036s
	iters: 400, epoch: 3 | loss: 0.0114384
	speed: 0.2615s/iter; left time: 10478.9570s
Epoch: 3 cost time: 108.56950545310974
Epoch: 3, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.074 Vali Acc: 0.976 Test Loss: 0.074 Test Acc: 0.976
Validation loss decreased (-0.974988 --> -0.975897).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0348517
	speed: 0.5352s/iter; left time: 21389.0148s
	iters: 200, epoch: 4 | loss: 0.0290784
	speed: 0.2588s/iter; left time: 10317.5099s
	iters: 300, epoch: 4 | loss: 0.0712207
	speed: 0.2533s/iter; left time: 10070.1883s
	iters: 400, epoch: 4 | loss: 0.1208438
	speed: 0.2663s/iter; left time: 10561.7952s
Epoch: 4 cost time: 108.2312068939209
Epoch: 4, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.081 Vali Acc: 0.971 Test Loss: 0.081 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0220924
	speed: 0.5086s/iter; left time: 20113.2103s
	iters: 200, epoch: 5 | loss: 0.0510438
	speed: 0.2632s/iter; left time: 10383.3423s
	iters: 300, epoch: 5 | loss: 0.0028888
	speed: 0.2689s/iter; left time: 10579.5143s
	iters: 400, epoch: 5 | loss: 0.0013457
	speed: 0.2773s/iter; left time: 10884.6258s
Epoch: 5 cost time: 110.0725769996643
Epoch: 5, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.053 Vali Acc: 0.982 Test Loss: 0.053 Test Acc: 0.982
Validation loss decreased (-0.975897 --> -0.982264).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0041078
	speed: 0.5573s/iter; left time: 21808.7734s
	iters: 200, epoch: 6 | loss: 0.0392769
	speed: 0.2594s/iter; left time: 10127.8099s
	iters: 300, epoch: 6 | loss: 0.0029389
	speed: 0.2651s/iter; left time: 10320.2980s
	iters: 400, epoch: 6 | loss: 0.0068439
	speed: 0.2595s/iter; left time: 10078.8256s
Epoch: 6 cost time: 109.3359432220459
Epoch: 6, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.066 Vali Acc: 0.976 Test Loss: 0.066 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0230021
	speed: 0.5316s/iter; left time: 20586.8378s
	iters: 200, epoch: 7 | loss: 0.0061754
	speed: 0.2657s/iter; left time: 10262.9038s
	iters: 300, epoch: 7 | loss: 0.0025272
	speed: 0.2648s/iter; left time: 10201.6240s
	iters: 400, epoch: 7 | loss: 0.0036274
	speed: 0.2615s/iter; left time: 10046.9961s
Epoch: 7 cost time: 109.13212776184082
Epoch: 7, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.086 Vali Acc: 0.967 Test Loss: 0.086 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0122936
	speed: 0.5165s/iter; left time: 19787.4684s
	iters: 200, epoch: 8 | loss: 0.0265169
	speed: 0.2590s/iter; left time: 9898.3004s
	iters: 300, epoch: 8 | loss: 0.0005616
	speed: 0.2600s/iter; left time: 9909.9697s
	iters: 400, epoch: 8 | loss: 0.0202518
	speed: 0.2598s/iter; left time: 9876.7792s
Epoch: 8 cost time: 107.34263300895691
Epoch: 8, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.049 Vali Acc: 0.985 Test Loss: 0.049 Test Acc: 0.985
Validation loss decreased (-0.982264 --> -0.984993).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0004202
	speed: 0.5304s/iter; left time: 20098.9246s
	iters: 200, epoch: 9 | loss: 0.0076063
	speed: 0.2692s/iter; left time: 10173.8039s
	iters: 300, epoch: 9 | loss: 0.0073866
	speed: 0.2731s/iter; left time: 10296.8518s
	iters: 400, epoch: 9 | loss: 0.0002859
	speed: 0.2748s/iter; left time: 10330.8701s
Epoch: 9 cost time: 112.83225011825562
Epoch: 9, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.069 Vali Acc: 0.978 Test Loss: 0.069 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0028512
	speed: 0.5721s/iter; left time: 21443.5613s
	iters: 200, epoch: 10 | loss: 0.0534678
	speed: 0.2670s/iter; left time: 9980.7820s
	iters: 300, epoch: 10 | loss: 0.0013885
	speed: 0.2553s/iter; left time: 9516.8184s
	iters: 400, epoch: 10 | loss: 0.0022300
	speed: 0.2591s/iter; left time: 9632.5528s
Epoch: 10 cost time: 109.92556047439575
Epoch: 10, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.074 Vali Acc: 0.979 Test Loss: 0.074 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0372865
	speed: 0.5308s/iter; left time: 19676.9402s
	iters: 200, epoch: 11 | loss: 0.0001882
	speed: 0.2628s/iter; left time: 9715.0466s
	iters: 300, epoch: 11 | loss: 0.0002835
	speed: 0.2744s/iter; left time: 10118.2870s
	iters: 400, epoch: 11 | loss: 0.0007435
	speed: 0.2645s/iter; left time: 9727.0357s
Epoch: 11 cost time: 110.3599317073822
Epoch: 11, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.070 Vali Acc: 0.978 Test Loss: 0.070 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0059885
	speed: 0.5428s/iter; left time: 19897.2940s
	iters: 200, epoch: 12 | loss: 0.0015454
	speed: 0.2645s/iter; left time: 9670.7488s
	iters: 300, epoch: 12 | loss: 0.0006877
	speed: 0.2670s/iter; left time: 9734.6468s
	iters: 400, epoch: 12 | loss: 0.0008544
	speed: 0.2761s/iter; left time: 10036.7513s
Epoch: 12 cost time: 111.64129877090454
Epoch: 12, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.075 Vali Acc: 0.975 Test Loss: 0.075 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0077158
	speed: 0.5436s/iter; left time: 19703.4452s
	iters: 200, epoch: 13 | loss: 0.0088171
	speed: 0.2675s/iter; left time: 9669.7530s
	iters: 300, epoch: 13 | loss: 0.0161593
	speed: 0.2649s/iter; left time: 9548.0448s
	iters: 400, epoch: 13 | loss: 0.0013396
	speed: 0.2620s/iter; left time: 9418.5598s
Epoch: 13 cost time: 109.52253413200378
Epoch: 13, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0005556
	speed: 0.5221s/iter; left time: 18706.2965s
	iters: 200, epoch: 14 | loss: 0.0000575
	speed: 0.2632s/iter; left time: 9404.7492s
	iters: 300, epoch: 14 | loss: 0.0002357
	speed: 0.2638s/iter; left time: 9401.0400s
	iters: 400, epoch: 14 | loss: 0.0003573
	speed: 0.2719s/iter; left time: 9660.4632s
Epoch: 14 cost time: 109.49292635917664
Epoch: 14, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.044 Vali Acc: 0.984 Test Loss: 0.044 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0003172
	speed: 0.5383s/iter; left time: 19064.8330s
	iters: 200, epoch: 15 | loss: 0.0007660
	speed: 0.2699s/iter; left time: 9533.0974s
	iters: 300, epoch: 15 | loss: 0.0001771
	speed: 0.2732s/iter; left time: 9620.3111s
	iters: 400, epoch: 15 | loss: 0.0006217
	speed: 0.2649s/iter; left time: 9304.3471s
Epoch: 15 cost time: 111.3073341846466
Epoch: 15, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.062 Vali Acc: 0.982 Test Loss: 0.062 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0058262
	speed: 0.5279s/iter; left time: 18478.4832s
	iters: 200, epoch: 16 | loss: 0.0002579
	speed: 0.2688s/iter; left time: 9381.7979s
	iters: 300, epoch: 16 | loss: 0.0006957
	speed: 0.2679s/iter; left time: 9324.5516s
	iters: 400, epoch: 16 | loss: 0.0001067
	speed: 0.2647s/iter; left time: 9185.0563s
Epoch: 16 cost time: 110.80072450637817
Epoch: 16, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.050 Vali Acc: 0.984 Test Loss: 0.050 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0004065
	speed: 0.5484s/iter; left time: 18970.2892s
	iters: 200, epoch: 17 | loss: 0.0002354
	speed: 0.2753s/iter; left time: 9494.2544s
	iters: 300, epoch: 17 | loss: 0.0000042
	speed: 0.2730s/iter; left time: 9388.8279s
	iters: 400, epoch: 17 | loss: 0.1350847
	speed: 0.2588s/iter; left time: 8874.0932s
Epoch: 17 cost time: 111.50515866279602
Epoch: 17, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0014967
	speed: 0.5371s/iter; left time: 18359.0129s
	iters: 200, epoch: 18 | loss: 0.0003329
	speed: 0.2637s/iter; left time: 8986.9801s
	iters: 300, epoch: 18 | loss: 0.0003717
	speed: 0.2680s/iter; left time: 9107.8665s
	iters: 400, epoch: 18 | loss: 0.0000288
	speed: 0.2606s/iter; left time: 8830.6453s
Epoch: 18 cost time: 109.5620527267456
Epoch: 18, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df128_ma19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.984993178717599
model parameter : 93514
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         10                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df128_ma10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.0542507
	speed: 0.2957s/iter; left time: 12183.6546s
	iters: 200, epoch: 1 | loss: 1.6563420
	speed: 0.2796s/iter; left time: 11492.8174s
	iters: 300, epoch: 1 | loss: 0.6023559
	speed: 0.2832s/iter; left time: 11612.1095s
	iters: 400, epoch: 1 | loss: 0.4507369
	speed: 0.2898s/iter; left time: 11853.7816s
Epoch: 1 cost time: 118.7777967453003
Epoch: 1, Steps: 413 | Train Loss: 1.419 Vali Loss: 0.290 Vali Acc: 0.935 Test Loss: 0.290 Test Acc: 0.935
Validation loss decreased (inf --> -0.934513).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1370959
	speed: 0.5520s/iter; left time: 22516.7577s
	iters: 200, epoch: 2 | loss: 0.2611824
	speed: 0.2831s/iter; left time: 11518.6272s
	iters: 300, epoch: 2 | loss: 0.2069909
	speed: 0.2890s/iter; left time: 11731.5075s
	iters: 400, epoch: 2 | loss: 0.0402125
	speed: 0.2826s/iter; left time: 11443.7900s
Epoch: 2 cost time: 116.30353260040283
Epoch: 2, Steps: 413 | Train Loss: 0.226 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
Validation loss decreased (-0.934513 --> -0.964528).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0716492
	speed: 0.5459s/iter; left time: 22041.6001s
	iters: 200, epoch: 3 | loss: 0.0678687
	speed: 0.2655s/iter; left time: 10694.0711s
	iters: 300, epoch: 3 | loss: 0.0574021
	speed: 0.2914s/iter; left time: 11705.1236s
	iters: 400, epoch: 3 | loss: 0.0393076
	speed: 0.2932s/iter; left time: 11751.2681s
Epoch: 3 cost time: 115.8356614112854
Epoch: 3, Steps: 413 | Train Loss: 0.090 Vali Loss: 0.104 Vali Acc: 0.967 Test Loss: 0.104 Test Acc: 0.967
Validation loss decreased (-0.964528 --> -0.966802).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0172406
	speed: 0.5791s/iter; left time: 23140.7496s
	iters: 200, epoch: 4 | loss: 0.0743051
	speed: 0.2885s/iter; left time: 11500.6396s
	iters: 300, epoch: 4 | loss: 0.1921921
	speed: 0.2696s/iter; left time: 10719.3598s
	iters: 400, epoch: 4 | loss: 0.0575159
	speed: 0.2780s/iter; left time: 11026.0848s
Epoch: 4 cost time: 116.28180837631226
Epoch: 4, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.090 Vali Acc: 0.972 Test Loss: 0.090 Test Acc: 0.972
Validation loss decreased (-0.966802 --> -0.971804).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0561094
	speed: 0.5549s/iter; left time: 21945.4866s
	iters: 200, epoch: 5 | loss: 0.0999060
	speed: 0.2799s/iter; left time: 11042.8854s
	iters: 300, epoch: 5 | loss: 0.0593129
	speed: 0.2854s/iter; left time: 11229.3441s
	iters: 400, epoch: 5 | loss: 0.0017436
	speed: 0.2872s/iter; left time: 11270.5133s
Epoch: 5 cost time: 116.47117257118225
Epoch: 5, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.079 Vali Acc: 0.970 Test Loss: 0.079 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0080806
	speed: 0.5704s/iter; left time: 22322.6007s
	iters: 200, epoch: 6 | loss: 0.0725991
	speed: 0.2805s/iter; left time: 10950.6961s
	iters: 300, epoch: 6 | loss: 0.0373484
	speed: 0.2869s/iter; left time: 11172.6801s
	iters: 400, epoch: 6 | loss: 0.0563248
	speed: 0.2899s/iter; left time: 11259.8906s
Epoch: 6 cost time: 118.17733716964722
Epoch: 6, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.069 Vali Acc: 0.979 Test Loss: 0.069 Test Acc: 0.979
Validation loss decreased (-0.971804 --> -0.978626).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0082896
	speed: 0.5460s/iter; left time: 21142.4753s
	iters: 200, epoch: 7 | loss: 0.0034152
	speed: 0.2557s/iter; left time: 9875.8495s
	iters: 300, epoch: 7 | loss: 0.0013827
	speed: 0.2656s/iter; left time: 10232.3354s
	iters: 400, epoch: 7 | loss: 0.0066132
	speed: 0.2829s/iter; left time: 10870.1747s
Epoch: 7 cost time: 110.31944036483765
Epoch: 7, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0034673
	speed: 0.5828s/iter; left time: 22327.5112s
	iters: 200, epoch: 8 | loss: 0.0019119
	speed: 0.2914s/iter; left time: 11135.2263s
	iters: 300, epoch: 8 | loss: 0.0074417
	speed: 0.2906s/iter; left time: 11075.1018s
	iters: 400, epoch: 8 | loss: 0.0092097
	speed: 0.2766s/iter; left time: 10511.8634s
Epoch: 8 cost time: 118.35172367095947
Epoch: 8, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0008669
	speed: 0.5562s/iter; left time: 21078.4700s
	iters: 200, epoch: 9 | loss: 0.0042356
	speed: 0.2751s/iter; left time: 10399.3429s
	iters: 300, epoch: 9 | loss: 0.0001590
	speed: 0.2913s/iter; left time: 10979.9071s
	iters: 400, epoch: 9 | loss: 0.0002164
	speed: 0.2970s/iter; left time: 11166.8027s
Epoch: 9 cost time: 118.20792937278748
Epoch: 9, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0061597
	speed: 0.5615s/iter; left time: 21047.5050s
	iters: 200, epoch: 10 | loss: 0.0190417
	speed: 0.2870s/iter; left time: 10729.5893s
	iters: 300, epoch: 10 | loss: 0.0053217
	speed: 0.2913s/iter; left time: 10860.8199s
	iters: 400, epoch: 10 | loss: 0.0009466
	speed: 0.2948s/iter; left time: 10960.0362s
Epoch: 10 cost time: 118.20736813545227
Epoch: 10, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.097 Vali Acc: 0.967 Test Loss: 0.097 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0002106
	speed: 0.5549s/iter; left time: 20570.5874s
	iters: 200, epoch: 11 | loss: 0.0024348
	speed: 0.2908s/iter; left time: 10750.6507s
	iters: 300, epoch: 11 | loss: 0.0120246
	speed: 0.2826s/iter; left time: 10418.9671s
	iters: 400, epoch: 11 | loss: 0.0046928
	speed: 0.2736s/iter; left time: 10061.9398s
Epoch: 11 cost time: 116.46162295341492
Epoch: 11, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0004425
	speed: 0.5398s/iter; left time: 19789.2845s
	iters: 200, epoch: 12 | loss: 0.0002395
	speed: 0.2774s/iter; left time: 10139.6960s
	iters: 300, epoch: 12 | loss: 0.0029195
	speed: 0.2971s/iter; left time: 10830.5519s
	iters: 400, epoch: 12 | loss: 0.0035466
	speed: 0.2927s/iter; left time: 10640.2930s
Epoch: 12 cost time: 118.87389159202576
Epoch: 12, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.087 Vali Acc: 0.975 Test Loss: 0.087 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0024361
	speed: 0.5453s/iter; left time: 19762.5878s
	iters: 200, epoch: 13 | loss: 0.0497617
	speed: 0.2751s/iter; left time: 9944.4993s
	iters: 300, epoch: 13 | loss: 0.3563185
	speed: 0.2806s/iter; left time: 10112.9563s
	iters: 400, epoch: 13 | loss: 0.0238657
	speed: 0.2613s/iter; left time: 9391.4944s
Epoch: 13 cost time: 112.82528138160706
Epoch: 13, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.116 Vali Acc: 0.974 Test Loss: 0.116 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0123674
	speed: 0.5385s/iter; left time: 19294.2140s
	iters: 200, epoch: 14 | loss: 0.0003117
	speed: 0.2917s/iter; left time: 10424.3678s
	iters: 300, epoch: 14 | loss: 0.0000227
	speed: 0.2829s/iter; left time: 10080.0480s
	iters: 400, epoch: 14 | loss: 0.1129515
	speed: 0.2620s/iter; left time: 9309.0074s
Epoch: 14 cost time: 115.66054558753967
Epoch: 14, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0000750
	speed: 0.5560s/iter; left time: 19691.3230s
	iters: 200, epoch: 15 | loss: 0.0002652
	speed: 0.2681s/iter; left time: 9467.7878s
	iters: 300, epoch: 15 | loss: 0.0002326
	speed: 0.2819s/iter; left time: 9928.4690s
	iters: 400, epoch: 15 | loss: 0.0008385
	speed: 0.2866s/iter; left time: 10063.6554s
Epoch: 15 cost time: 114.66015934944153
Epoch: 15, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0004290
	speed: 0.5718s/iter; left time: 20016.0381s
	iters: 200, epoch: 16 | loss: 0.0020338
	speed: 0.2804s/iter; left time: 9789.0110s
	iters: 300, epoch: 16 | loss: 0.0927134
	speed: 0.2796s/iter; left time: 9732.5481s
	iters: 400, epoch: 16 | loss: 0.0117150
	speed: 0.2713s/iter; left time: 9416.3384s
Epoch: 16 cost time: 115.10171580314636
Epoch: 16, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.125 Vali Acc: 0.971 Test Loss: 0.125 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df128_ma10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9786266484765803
model parameter : 93514
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df128_ma5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.1924562
	speed: 0.3009s/iter; left time: 12398.6810s
	iters: 200, epoch: 1 | loss: 1.8096948
	speed: 0.2726s/iter; left time: 11202.7906s
	iters: 300, epoch: 1 | loss: 0.6022394
	speed: 0.2703s/iter; left time: 11084.3289s
	iters: 400, epoch: 1 | loss: 0.5880023
	speed: 0.2688s/iter; left time: 10995.1008s
Epoch: 1 cost time: 114.93068718910217
Epoch: 1, Steps: 413 | Train Loss: 1.520 Vali Loss: 0.356 Vali Acc: 0.905 Test Loss: 0.356 Test Acc: 0.905
Validation loss decreased (inf --> -0.904953).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2302208
	speed: 0.5401s/iter; left time: 22028.2670s
	iters: 200, epoch: 2 | loss: 0.1523154
	speed: 0.2817s/iter; left time: 11460.5790s
	iters: 300, epoch: 2 | loss: 0.3931113
	speed: 0.2745s/iter; left time: 11141.8710s
	iters: 400, epoch: 2 | loss: 0.0819652
	speed: 0.2769s/iter; left time: 11210.6505s
Epoch: 2 cost time: 114.35375332832336
Epoch: 2, Steps: 413 | Train Loss: 0.281 Vali Loss: 0.144 Vali Acc: 0.959 Test Loss: 0.144 Test Acc: 0.959
Validation loss decreased (-0.904953 --> -0.959071).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2533046
	speed: 0.5515s/iter; left time: 22265.7387s
	iters: 200, epoch: 3 | loss: 0.0727635
	speed: 0.2592s/iter; left time: 10439.1934s
	iters: 300, epoch: 3 | loss: 0.0386213
	speed: 0.2635s/iter; left time: 10587.8196s
	iters: 400, epoch: 3 | loss: 0.0600148
	speed: 0.2645s/iter; left time: 10599.4845s
Epoch: 3 cost time: 108.47693252563477
Epoch: 3, Steps: 413 | Train Loss: 0.118 Vali Loss: 0.112 Vali Acc: 0.964 Test Loss: 0.112 Test Acc: 0.964
Validation loss decreased (-0.959071 --> -0.964073).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0192571
	speed: 0.5307s/iter; left time: 21206.0603s
	iters: 200, epoch: 4 | loss: 0.0987712
	speed: 0.2637s/iter; left time: 10510.8269s
	iters: 300, epoch: 4 | loss: 0.3166461
	speed: 0.2755s/iter; left time: 10953.3665s
	iters: 400, epoch: 4 | loss: 0.0631009
	speed: 0.2732s/iter; left time: 10836.7907s
Epoch: 4 cost time: 111.7099997997284
Epoch: 4, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.114 Vali Acc: 0.963 Test Loss: 0.114 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0764671
	speed: 0.5307s/iter; left time: 20989.0576s
	iters: 200, epoch: 5 | loss: 0.0510150
	speed: 0.2562s/iter; left time: 10107.7472s
	iters: 300, epoch: 5 | loss: 0.0150322
	speed: 0.2630s/iter; left time: 10349.0521s
	iters: 400, epoch: 5 | loss: 0.0028506
	speed: 0.2726s/iter; left time: 10699.2820s
Epoch: 5 cost time: 109.46682834625244
Epoch: 5, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.074 Vali Acc: 0.975 Test Loss: 0.074 Test Acc: 0.975
Validation loss decreased (-0.964073 --> -0.974533).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0069902
	speed: 0.5462s/iter; left time: 21377.7876s
	iters: 200, epoch: 6 | loss: 0.0122147
	speed: 0.2498s/iter; left time: 9750.0723s
	iters: 300, epoch: 6 | loss: 0.0196254
	speed: 0.2607s/iter; left time: 10150.7722s
	iters: 400, epoch: 6 | loss: 0.0019876
	speed: 0.2624s/iter; left time: 10191.9812s
Epoch: 6 cost time: 108.04017782211304
Epoch: 6, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.068 Vali Acc: 0.978 Test Loss: 0.068 Test Acc: 0.978
Validation loss decreased (-0.974533 --> -0.977716).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0167980
	speed: 0.5242s/iter; left time: 20299.7691s
	iters: 200, epoch: 7 | loss: 0.1900716
	speed: 0.2698s/iter; left time: 10421.4590s
	iters: 300, epoch: 7 | loss: 0.0073914
	speed: 0.2713s/iter; left time: 10449.9861s
	iters: 400, epoch: 7 | loss: 0.0226476
	speed: 0.2634s/iter; left time: 10120.4176s
Epoch: 7 cost time: 111.27846479415894
Epoch: 7, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.100 Vali Acc: 0.972 Test Loss: 0.100 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0061148
	speed: 0.5489s/iter; left time: 21026.8812s
	iters: 200, epoch: 8 | loss: 0.0019378
	speed: 0.2733s/iter; left time: 10442.4758s
	iters: 300, epoch: 8 | loss: 0.0002662
	speed: 0.2867s/iter; left time: 10925.3120s
	iters: 400, epoch: 8 | loss: 0.0470782
	speed: 0.2837s/iter; left time: 10783.8195s
Epoch: 8 cost time: 116.35953450202942
Epoch: 8, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0009030
	speed: 0.5757s/iter; left time: 21818.3161s
	iters: 200, epoch: 9 | loss: 0.0024313
	speed: 0.3056s/iter; left time: 11552.5663s
	iters: 300, epoch: 9 | loss: 0.0019281
	speed: 0.2817s/iter; left time: 10620.3483s
	iters: 400, epoch: 9 | loss: 0.0000619
	speed: 0.2784s/iter; left time: 10466.2206s
Epoch: 9 cost time: 118.87619638442993
Epoch: 9, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0008619
	speed: 0.5519s/iter; left time: 20686.8195s
	iters: 200, epoch: 10 | loss: 0.0329585
	speed: 0.2907s/iter; left time: 10867.9355s
	iters: 300, epoch: 10 | loss: 0.0507825
	speed: 0.2801s/iter; left time: 10441.5684s
	iters: 400, epoch: 10 | loss: 0.0016809
	speed: 0.2636s/iter; left time: 9801.2711s
Epoch: 10 cost time: 115.13342905044556
Epoch: 10, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.096 Vali Acc: 0.974 Test Loss: 0.096 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0031796
	speed: 0.5679s/iter; left time: 21051.4949s
	iters: 200, epoch: 11 | loss: 0.0554928
	speed: 0.2881s/iter; left time: 10651.9616s
	iters: 300, epoch: 11 | loss: 0.0081274
	speed: 0.2816s/iter; left time: 10382.3884s
	iters: 400, epoch: 11 | loss: 0.0192965
	speed: 0.2706s/iter; left time: 9951.0988s
Epoch: 11 cost time: 117.8535623550415
Epoch: 11, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0027395
	speed: 0.5608s/iter; left time: 20556.1869s
	iters: 200, epoch: 12 | loss: 0.0219634
	speed: 0.2870s/iter; left time: 10492.6698s
	iters: 300, epoch: 12 | loss: 0.0028625
	speed: 0.2795s/iter; left time: 10191.0477s
	iters: 400, epoch: 12 | loss: 0.0003346
	speed: 0.2694s/iter; left time: 9795.6979s
Epoch: 12 cost time: 115.64581060409546
Epoch: 12, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
Validation loss decreased (-0.977716 --> -0.980900).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0159482
	speed: 0.5738s/iter; left time: 20798.6747s
	iters: 200, epoch: 13 | loss: 0.0022480
	speed: 0.2834s/iter; left time: 10242.2282s
	iters: 300, epoch: 13 | loss: 0.1964394
	speed: 0.2857s/iter; left time: 10299.2238s
	iters: 400, epoch: 13 | loss: 0.1664068
	speed: 0.2876s/iter; left time: 10339.4267s
Epoch: 13 cost time: 118.85247492790222
Epoch: 13, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0004626
	speed: 0.5661s/iter; left time: 20285.7617s
	iters: 200, epoch: 14 | loss: 0.0088880
	speed: 0.2835s/iter; left time: 10130.6324s
	iters: 300, epoch: 14 | loss: 0.0004537
	speed: 0.2944s/iter; left time: 10488.9115s
	iters: 400, epoch: 14 | loss: 0.0160637
	speed: 0.2882s/iter; left time: 10240.9606s
Epoch: 14 cost time: 118.74168825149536
Epoch: 14, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0221007
	speed: 0.5625s/iter; left time: 19923.3370s
	iters: 200, epoch: 15 | loss: 0.0352496
	speed: 0.2889s/iter; left time: 10204.0596s
	iters: 300, epoch: 15 | loss: 0.0060805
	speed: 0.2856s/iter; left time: 10058.1946s
	iters: 400, epoch: 15 | loss: 0.0784155
	speed: 0.2884s/iter; left time: 10127.0506s
Epoch: 15 cost time: 118.47370648384094
Epoch: 15, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0015364
	speed: 0.5189s/iter; left time: 18164.5685s
	iters: 200, epoch: 16 | loss: 0.0034964
	speed: 0.2950s/iter; left time: 10295.7763s
	iters: 300, epoch: 16 | loss: 0.0041299
	speed: 0.2905s/iter; left time: 10111.8360s
	iters: 400, epoch: 16 | loss: 0.0453634
	speed: 0.2894s/iter; left time: 10043.4167s
Epoch: 16 cost time: 117.69849014282227
Epoch: 16, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0005674
	speed: 0.5288s/iter; left time: 18293.7057s
	iters: 200, epoch: 17 | loss: 0.0041181
	speed: 0.2880s/iter; left time: 9935.3920s
	iters: 300, epoch: 17 | loss: 0.0000846
	speed: 0.2995s/iter; left time: 10300.2333s
	iters: 400, epoch: 17 | loss: 0.1531794
	speed: 0.2958s/iter; left time: 10144.8372s
Epoch: 17 cost time: 119.89578223228455
Epoch: 17, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0513286
	speed: 0.5654s/iter; left time: 19326.1857s
	iters: 200, epoch: 18 | loss: 0.0130375
	speed: 0.2784s/iter; left time: 9488.8016s
	iters: 300, epoch: 18 | loss: 0.0056453
	speed: 0.2853s/iter; left time: 9694.3199s
	iters: 400, epoch: 18 | loss: 0.0001080
	speed: 0.2910s/iter; left time: 9859.6439s
Epoch: 18 cost time: 117.29582643508911
Epoch: 18, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.089 Vali Acc: 0.981 Test Loss: 0.089 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0001562
	speed: 0.5547s/iter; left time: 18731.3479s
	iters: 200, epoch: 19 | loss: 0.0000137
	speed: 0.2789s/iter; left time: 9389.6134s
	iters: 300, epoch: 19 | loss: 0.4797604
	speed: 0.2894s/iter; left time: 9714.0664s
	iters: 400, epoch: 19 | loss: 0.0000986
	speed: 0.2904s/iter; left time: 9718.6254s
Epoch: 19 cost time: 117.00618052482605
Epoch: 19, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0200873
	speed: 0.5715s/iter; left time: 19061.9151s
	iters: 200, epoch: 20 | loss: 0.0027855
	speed: 0.2640s/iter; left time: 8780.6482s
	iters: 300, epoch: 20 | loss: 0.0001595
	speed: 0.2751s/iter; left time: 9120.6440s
	iters: 400, epoch: 20 | loss: 0.0001316
	speed: 0.2903s/iter; left time: 9596.8364s
Epoch: 20 cost time: 115.22053742408752
Epoch: 20, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000037
	speed: 0.5571s/iter; left time: 18352.5533s
	iters: 200, epoch: 21 | loss: 0.0022914
	speed: 0.2831s/iter; left time: 9297.2729s
	iters: 300, epoch: 21 | loss: 0.0001399
	speed: 0.2766s/iter; left time: 9056.5734s
	iters: 400, epoch: 21 | loss: 0.0000203
	speed: 0.2923s/iter; left time: 9539.7988s
Epoch: 21 cost time: 116.30835556983948
Epoch: 21, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0003598
	speed: 0.5704s/iter; left time: 18552.5785s
	iters: 200, epoch: 22 | loss: 0.1866898
	speed: 0.2746s/iter; left time: 8903.5447s
	iters: 300, epoch: 22 | loss: 0.0092963
	speed: 0.2737s/iter; left time: 8846.7030s
	iters: 400, epoch: 22 | loss: 0.1008407
	speed: 0.2660s/iter; left time: 8573.0419s
Epoch: 22 cost time: 113.88179516792297
Epoch: 22, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df128_ma5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9809004092769441
model parameter : 93514
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df128_ma3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.2174249
	speed: 0.2837s/iter; left time: 11688.4062s
	iters: 200, epoch: 1 | loss: 1.7476933
	speed: 0.2594s/iter; left time: 10661.3583s
	iters: 300, epoch: 1 | loss: 0.5952509
	speed: 0.2603s/iter; left time: 10671.9827s
	iters: 400, epoch: 1 | loss: 0.5002989
	speed: 0.2611s/iter; left time: 10680.8101s
Epoch: 1 cost time: 110.18380355834961
Epoch: 1, Steps: 413 | Train Loss: 1.517 Vali Loss: 0.333 Vali Acc: 0.907 Test Loss: 0.333 Test Acc: 0.907
Validation loss decreased (inf --> -0.906772).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2246026
	speed: 0.5605s/iter; left time: 22863.0890s
	iters: 200, epoch: 2 | loss: 0.1575236
	speed: 0.2501s/iter; left time: 10176.0317s
	iters: 300, epoch: 2 | loss: 0.2071819
	speed: 0.2508s/iter; left time: 10178.1246s
	iters: 400, epoch: 2 | loss: 0.0620238
	speed: 0.2529s/iter; left time: 10239.5838s
Epoch: 2 cost time: 106.92696261405945
Epoch: 2, Steps: 413 | Train Loss: 0.273 Vali Loss: 0.140 Vali Acc: 0.963 Test Loss: 0.140 Test Acc: 0.963
Validation loss decreased (-0.906772 --> -0.962709).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0782340
	speed: 0.5320s/iter; left time: 21477.6521s
	iters: 200, epoch: 3 | loss: 0.1373462
	speed: 0.2601s/iter; left time: 10475.0750s
	iters: 300, epoch: 3 | loss: 0.0282125
	speed: 0.2517s/iter; left time: 10112.1727s
	iters: 400, epoch: 3 | loss: 0.1169798
	speed: 0.2663s/iter; left time: 10672.4746s
Epoch: 3 cost time: 108.52487325668335
Epoch: 3, Steps: 413 | Train Loss: 0.126 Vali Loss: 0.101 Vali Acc: 0.969 Test Loss: 0.101 Test Acc: 0.969
Validation loss decreased (-0.962709 --> -0.968621).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0267610
	speed: 0.5047s/iter; left time: 20168.8478s
	iters: 200, epoch: 4 | loss: 0.0935899
	speed: 0.2618s/iter; left time: 10436.9579s
	iters: 300, epoch: 4 | loss: 0.1516573
	speed: 0.2763s/iter; left time: 10987.3562s
	iters: 400, epoch: 4 | loss: 0.1095028
	speed: 0.2721s/iter; left time: 10791.7976s
Epoch: 4 cost time: 109.37979221343994
Epoch: 4, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.108 Vali Acc: 0.963 Test Loss: 0.108 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0351800
	speed: 0.5003s/iter; left time: 19787.0603s
	iters: 200, epoch: 5 | loss: 0.0732931
	speed: 0.2688s/iter; left time: 10604.5437s
	iters: 300, epoch: 5 | loss: 0.0080644
	speed: 0.2741s/iter; left time: 10786.8540s
	iters: 400, epoch: 5 | loss: 0.0047385
	speed: 0.2598s/iter; left time: 10198.3858s
Epoch: 5 cost time: 108.62319827079773
Epoch: 5, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
Validation loss decreased (-0.968621 --> -0.983174).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0079980
	speed: 0.5347s/iter; left time: 20927.7089s
	iters: 200, epoch: 6 | loss: 0.0197766
	speed: 0.2750s/iter; left time: 10733.1568s
	iters: 300, epoch: 6 | loss: 0.1174859
	speed: 0.2746s/iter; left time: 10693.3703s
	iters: 400, epoch: 6 | loss: 0.0398680
	speed: 0.2639s/iter; left time: 10248.8654s
Epoch: 6 cost time: 112.06753420829773
Epoch: 6, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.061 Vali Acc: 0.982 Test Loss: 0.061 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0565038
	speed: 0.5324s/iter; left time: 20616.1626s
	iters: 200, epoch: 7 | loss: 0.0157463
	speed: 0.2726s/iter; left time: 10529.1814s
	iters: 300, epoch: 7 | loss: 0.0166106
	speed: 0.2651s/iter; left time: 10213.5016s
	iters: 400, epoch: 7 | loss: 0.0135083
	speed: 0.2559s/iter; left time: 9834.1326s
Epoch: 7 cost time: 109.8744478225708
Epoch: 7, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.080 Vali Acc: 0.975 Test Loss: 0.080 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0130200
	speed: 0.5032s/iter; left time: 19279.0813s
	iters: 200, epoch: 8 | loss: 0.0261087
	speed: 0.2628s/iter; left time: 10043.4171s
	iters: 300, epoch: 8 | loss: 0.0078490
	speed: 0.2778s/iter; left time: 10585.7920s
	iters: 400, epoch: 8 | loss: 0.0116613
	speed: 0.2646s/iter; left time: 10058.9807s
Epoch: 8 cost time: 109.03025317192078
Epoch: 8, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0027178
	speed: 0.5080s/iter; left time: 19253.0325s
	iters: 200, epoch: 9 | loss: 0.0079488
	speed: 0.2701s/iter; left time: 10210.8293s
	iters: 300, epoch: 9 | loss: 0.0014174
	speed: 0.2729s/iter; left time: 10287.6396s
	iters: 400, epoch: 9 | loss: 0.0014540
	speed: 0.2461s/iter; left time: 9251.9715s
Epoch: 9 cost time: 108.44367694854736
Epoch: 9, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.092 Vali Acc: 0.971 Test Loss: 0.092 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0002406
	speed: 0.5062s/iter; left time: 18975.6877s
	iters: 200, epoch: 10 | loss: 0.0063057
	speed: 0.2787s/iter; left time: 10418.1894s
	iters: 300, epoch: 10 | loss: 0.0190580
	speed: 0.2632s/iter; left time: 9814.0171s
	iters: 400, epoch: 10 | loss: 0.0097994
	speed: 0.2508s/iter; left time: 9326.6446s
Epoch: 10 cost time: 108.78265714645386
Epoch: 10, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.086 Vali Acc: 0.975 Test Loss: 0.086 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0444593
	speed: 0.5332s/iter; left time: 19766.4331s
	iters: 200, epoch: 11 | loss: 0.0001379
	speed: 0.2788s/iter; left time: 10308.5710s
	iters: 300, epoch: 11 | loss: 0.1542280
	speed: 0.2730s/iter; left time: 10065.2565s
	iters: 400, epoch: 11 | loss: 0.0015551
	speed: 0.2535s/iter; left time: 9321.6338s
Epoch: 11 cost time: 111.13643789291382
Epoch: 11, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0014274
	speed: 0.5373s/iter; left time: 19695.4900s
	iters: 200, epoch: 12 | loss: 0.0067945
	speed: 0.2691s/iter; left time: 9836.7449s
	iters: 300, epoch: 12 | loss: 0.0005054
	speed: 0.2527s/iter; left time: 9211.1874s
	iters: 400, epoch: 12 | loss: 0.0266443
	speed: 0.2519s/iter; left time: 9160.0336s
Epoch: 12 cost time: 108.99739575386047
Epoch: 12, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0063118
	speed: 0.5384s/iter; left time: 19512.6941s
	iters: 200, epoch: 13 | loss: 0.1223907
	speed: 0.2687s/iter; left time: 9712.5493s
	iters: 300, epoch: 13 | loss: 0.1142662
	speed: 0.2597s/iter; left time: 9361.7718s
	iters: 400, epoch: 13 | loss: 0.0017608
	speed: 0.2643s/iter; left time: 9501.5094s
Epoch: 13 cost time: 110.59759092330933
Epoch: 13, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0007402
	speed: 0.5273s/iter; left time: 18894.7188s
	iters: 200, epoch: 14 | loss: 0.0000377
	speed: 0.2620s/iter; left time: 9361.8811s
	iters: 300, epoch: 14 | loss: 0.0000893
	speed: 0.2476s/iter; left time: 8822.9572s
	iters: 400, epoch: 14 | loss: 0.0064288
	speed: 0.2519s/iter; left time: 8950.8726s
Epoch: 14 cost time: 106.19659399986267
Epoch: 14, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.110 Vali Acc: 0.974 Test Loss: 0.110 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0081751
	speed: 0.5334s/iter; left time: 18892.9326s
	iters: 200, epoch: 15 | loss: 0.0010532
	speed: 0.2620s/iter; left time: 9253.6571s
	iters: 300, epoch: 15 | loss: 0.0000616
	speed: 0.2616s/iter; left time: 9211.7914s
	iters: 400, epoch: 15 | loss: 0.0006593
	speed: 0.2620s/iter; left time: 9202.2308s
Epoch: 15 cost time: 109.23925995826721
Epoch: 15, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df128_ma3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9831741700773079
model parameter : 93514
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         2                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df128_ma2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.1747129
	speed: 0.2640s/iter; left time: 10877.1994s
	iters: 200, epoch: 1 | loss: 1.7596177
	speed: 0.2569s/iter; left time: 10559.6789s
	iters: 300, epoch: 1 | loss: 0.5296935
	speed: 0.2485s/iter; left time: 10188.2451s
	iters: 400, epoch: 1 | loss: 0.4172364
	speed: 0.2655s/iter; left time: 10858.3831s
Epoch: 1 cost time: 107.17265105247498
Epoch: 1, Steps: 413 | Train Loss: 1.508 Vali Loss: 0.315 Vali Acc: 0.911 Test Loss: 0.315 Test Acc: 0.911
Validation loss decreased (inf --> -0.910865).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2566031
	speed: 0.5204s/iter; left time: 21224.9853s
	iters: 200, epoch: 2 | loss: 0.1681823
	speed: 0.2569s/iter; left time: 10451.6506s
	iters: 300, epoch: 2 | loss: 0.1730969
	speed: 0.2648s/iter; left time: 10746.7953s
	iters: 400, epoch: 2 | loss: 0.0711630
	speed: 0.2699s/iter; left time: 10925.9489s
Epoch: 2 cost time: 108.50390529632568
Epoch: 2, Steps: 413 | Train Loss: 0.261 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
Validation loss decreased (-0.910865 --> -0.969076).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0512768
	speed: 0.5289s/iter; left time: 21354.8380s
	iters: 200, epoch: 3 | loss: 0.0652818
	speed: 0.2670s/iter; left time: 10752.3055s
	iters: 300, epoch: 3 | loss: 0.0164994
	speed: 0.2502s/iter; left time: 10050.2147s
	iters: 400, epoch: 3 | loss: 0.1279588
	speed: 0.2480s/iter; left time: 9936.7652s
Epoch: 3 cost time: 107.29042482376099
Epoch: 3, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
Validation loss decreased (-0.969076 --> -0.969985).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0238664
	speed: 0.5327s/iter; left time: 21289.7149s
	iters: 200, epoch: 4 | loss: 0.1438538
	speed: 0.2465s/iter; left time: 9824.9076s
	iters: 300, epoch: 4 | loss: 0.2911228
	speed: 0.2372s/iter; left time: 9431.3627s
	iters: 400, epoch: 4 | loss: 0.0385051
	speed: 0.2756s/iter; left time: 10931.2894s
Epoch: 4 cost time: 106.79319095611572
Epoch: 4, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.080 Vali Acc: 0.976 Test Loss: 0.080 Test Acc: 0.976
Validation loss decreased (-0.969985 --> -0.975897).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0370127
	speed: 0.5267s/iter; left time: 20830.6387s
	iters: 200, epoch: 5 | loss: 0.0951743
	speed: 0.2586s/iter; left time: 10203.3611s
	iters: 300, epoch: 5 | loss: 0.0215819
	speed: 0.2741s/iter; left time: 10786.2789s
	iters: 400, epoch: 5 | loss: 0.0033387
	speed: 0.2604s/iter; left time: 10220.0141s
Epoch: 5 cost time: 109.25961303710938
Epoch: 5, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.975897 --> -0.983174).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0123155
	speed: 0.5314s/iter; left time: 20798.5837s
	iters: 200, epoch: 6 | loss: 0.0270929
	speed: 0.2689s/iter; left time: 10495.3483s
	iters: 300, epoch: 6 | loss: 0.0137834
	speed: 0.2545s/iter; left time: 9909.2899s
	iters: 400, epoch: 6 | loss: 0.0281701
	speed: 0.2602s/iter; left time: 10104.4960s
Epoch: 6 cost time: 109.26003241539001
Epoch: 6, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0493515
	speed: 0.5275s/iter; left time: 20426.6327s
	iters: 200, epoch: 7 | loss: 0.0086423
	speed: 0.2635s/iter; left time: 10178.4172s
	iters: 300, epoch: 7 | loss: 0.1996963
	speed: 0.2758s/iter; left time: 10624.6785s
	iters: 400, epoch: 7 | loss: 0.0183796
	speed: 0.2714s/iter; left time: 10428.3814s
Epoch: 7 cost time: 110.57213115692139
Epoch: 7, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.083 Vali Acc: 0.975 Test Loss: 0.083 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0118994
	speed: 0.4954s/iter; left time: 18979.8341s
	iters: 200, epoch: 8 | loss: 0.0064433
	speed: 0.2725s/iter; left time: 10411.8443s
	iters: 300, epoch: 8 | loss: 0.0025387
	speed: 0.2653s/iter; left time: 10109.6175s
	iters: 400, epoch: 8 | loss: 0.0538748
	speed: 0.2521s/iter; left time: 9582.6715s
Epoch: 8 cost time: 108.24480724334717
Epoch: 8, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.075 Vali Acc: 0.979 Test Loss: 0.075 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0011361
	speed: 0.5344s/iter; left time: 20250.6452s
	iters: 200, epoch: 9 | loss: 0.0014321
	speed: 0.2702s/iter; left time: 10210.9176s
	iters: 300, epoch: 9 | loss: 0.0026067
	speed: 0.2566s/iter; left time: 9671.1664s
	iters: 400, epoch: 9 | loss: 0.0023669
	speed: 0.2705s/iter; left time: 10171.8405s
Epoch: 9 cost time: 111.958261013031
Epoch: 9, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0003384
	speed: 0.5364s/iter; left time: 20106.4360s
	iters: 200, epoch: 10 | loss: 0.0012908
	speed: 0.2527s/iter; left time: 9447.9394s
	iters: 300, epoch: 10 | loss: 0.0097554
	speed: 0.2665s/iter; left time: 9937.7372s
	iters: 400, epoch: 10 | loss: 0.0012033
	speed: 0.2645s/iter; left time: 9834.8885s
Epoch: 10 cost time: 108.48489475250244
Epoch: 10, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0345486
	speed: 0.5214s/iter; left time: 19328.0309s
	iters: 200, epoch: 11 | loss: 0.0001992
	speed: 0.2664s/iter; left time: 9850.5793s
	iters: 300, epoch: 11 | loss: 0.0056981
	speed: 0.2633s/iter; left time: 9709.2320s
	iters: 400, epoch: 11 | loss: 0.0022473
	speed: 0.2682s/iter; left time: 9862.3341s
Epoch: 11 cost time: 109.9575867652893
Epoch: 11, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0024247
	speed: 0.5316s/iter; left time: 19488.1676s
	iters: 200, epoch: 12 | loss: 0.0000791
	speed: 0.2529s/iter; left time: 9244.8441s
	iters: 300, epoch: 12 | loss: 0.0049796
	speed: 0.2625s/iter; left time: 9569.2747s
	iters: 400, epoch: 12 | loss: 0.2151736
	speed: 0.2703s/iter; left time: 9828.2956s
Epoch: 12 cost time: 108.55036282539368
Epoch: 12, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0007418
	speed: 0.5041s/iter; left time: 18271.9305s
	iters: 200, epoch: 13 | loss: 0.0581965
	speed: 0.2651s/iter; left time: 9581.0823s
	iters: 300, epoch: 13 | loss: 0.0052077
	speed: 0.2783s/iter; left time: 10031.8356s
	iters: 400, epoch: 13 | loss: 0.0012371
	speed: 0.2622s/iter; left time: 9423.9116s
Epoch: 13 cost time: 108.8171660900116
Epoch: 13, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.116 Vali Acc: 0.967 Test Loss: 0.116 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0001714
	speed: 0.5149s/iter; left time: 18451.4167s
	iters: 200, epoch: 14 | loss: 0.0331954
	speed: 0.2713s/iter; left time: 9694.9869s
	iters: 300, epoch: 14 | loss: 0.1676623
	speed: 0.2540s/iter; left time: 9051.2960s
	iters: 400, epoch: 14 | loss: 0.0100907
	speed: 0.2493s/iter; left time: 8858.6004s
Epoch: 14 cost time: 107.467600107193
Epoch: 14, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0008447
	speed: 0.5306s/iter; left time: 18792.6062s
	iters: 200, epoch: 15 | loss: 0.0049722
	speed: 0.2425s/iter; left time: 8565.2110s
	iters: 300, epoch: 15 | loss: 0.0013734
	speed: 0.2599s/iter; left time: 9153.1209s
	iters: 400, epoch: 15 | loss: 0.0003745
	speed: 0.2760s/iter; left time: 9692.6727s
Epoch: 15 cost time: 107.72602343559265
Epoch: 15, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.142 Vali Acc: 0.972 Test Loss: 0.142 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df128_ma2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9831741700773079
model parameter : 93514
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1                   Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
fourier enhanced block used!
modes=32, index=[1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 26, 28, 31, 32, 34, 36, 37, 38, 39, 41, 42, 43, 44]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
 fourier enhanced cross attention used!
modes_q=23, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
modes_kv=32, index_kv=[0, 1, 2, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 26, 28, 30, 34, 36, 38, 39, 40, 42, 44, 45]
>>>>>>>start training : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df128_ma1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 2.3064890
	speed: 0.3005s/iter; left time: 12381.6885s
	iters: 200, epoch: 1 | loss: 2.2998362
	speed: 0.2808s/iter; left time: 11543.1321s
	iters: 300, epoch: 1 | loss: 2.2989869
	speed: 0.2663s/iter; left time: 10917.2336s
	iters: 400, epoch: 1 | loss: 2.2999499
	speed: 0.2899s/iter; left time: 11855.3135s
Epoch: 1 cost time: 117.37800621986389
Epoch: 1, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (inf --> -0.100022).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3051620
	speed: 0.5480s/iter; left time: 22352.7021s
	iters: 200, epoch: 2 | loss: 2.3000150
	speed: 0.2915s/iter; left time: 11859.5099s
	iters: 300, epoch: 2 | loss: 2.3017604
	speed: 0.2756s/iter; left time: 11188.0104s
	iters: 400, epoch: 2 | loss: 2.3012173
	speed: 0.2959s/iter; left time: 11982.1205s
Epoch: 2 cost time: 118.90260314941406
Epoch: 2, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3035140
	speed: 0.5645s/iter; left time: 22791.0298s
	iters: 200, epoch: 3 | loss: 2.3060927
	speed: 0.3013s/iter; left time: 12134.4521s
	iters: 300, epoch: 3 | loss: 2.3030765
	speed: 0.2931s/iter; left time: 11774.2944s
	iters: 400, epoch: 3 | loss: 2.3018997
	speed: 0.2603s/iter; left time: 10433.5185s
Epoch: 3 cost time: 117.29344391822815
Epoch: 3, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3037965
	speed: 0.5531s/iter; left time: 22103.7614s
	iters: 200, epoch: 4 | loss: 2.3042870
	speed: 0.2755s/iter; left time: 10982.6566s
	iters: 300, epoch: 4 | loss: 2.3024533
	speed: 0.2818s/iter; left time: 11204.8481s
	iters: 400, epoch: 4 | loss: 2.3015335
	speed: 0.2856s/iter; left time: 11328.9239s
Epoch: 4 cost time: 116.48027324676514
Epoch: 4, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.3029220
	speed: 0.5568s/iter; left time: 22019.4203s
	iters: 200, epoch: 5 | loss: 2.3052552
	speed: 0.2871s/iter; left time: 11324.0509s
	iters: 300, epoch: 5 | loss: 2.3029618
	speed: 0.2724s/iter; left time: 10717.0856s
	iters: 400, epoch: 5 | loss: 2.3027894
	speed: 0.2935s/iter; left time: 11518.6088s
Epoch: 5 cost time: 117.37596583366394
Epoch: 5, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2996356
	speed: 0.5660s/iter; left time: 22150.6268s
	iters: 200, epoch: 6 | loss: 2.3036337
	speed: 0.2913s/iter; left time: 11369.4260s
	iters: 300, epoch: 6 | loss: 2.2994273
	speed: 0.2698s/iter; left time: 10506.1282s
	iters: 400, epoch: 6 | loss: 2.3021486
	speed: 0.2787s/iter; left time: 10824.4279s
Epoch: 6 cost time: 117.59413957595825
Epoch: 6, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
Validation loss decreased (-0.100022 --> -0.100022).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.3010535
	speed: 0.5624s/iter; left time: 21775.9075s
	iters: 200, epoch: 7 | loss: 2.3006186
	speed: 0.2896s/iter; left time: 11184.4162s
	iters: 300, epoch: 7 | loss: 2.3042533
	speed: 0.2739s/iter; left time: 10553.1415s
	iters: 400, epoch: 7 | loss: 2.3028636
	speed: 0.2912s/iter; left time: 11189.3783s
Epoch: 7 cost time: 118.11793327331543
Epoch: 7, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.3037782
	speed: 0.5561s/iter; left time: 21303.9723s
	iters: 200, epoch: 8 | loss: 2.3004825
	speed: 0.2868s/iter; left time: 10957.3986s
	iters: 300, epoch: 8 | loss: 2.3012555
	speed: 0.2885s/iter; left time: 10995.8006s
	iters: 400, epoch: 8 | loss: 2.3012030
	speed: 0.2826s/iter; left time: 10740.0263s
Epoch: 8 cost time: 117.12864375114441
Epoch: 8, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.3011577
	speed: 0.5795s/iter; left time: 21960.5706s
	iters: 200, epoch: 9 | loss: 2.3017857
	speed: 0.2834s/iter; left time: 10710.6854s
	iters: 300, epoch: 9 | loss: 2.3014977
	speed: 0.2867s/iter; left time: 10808.4624s
	iters: 400, epoch: 9 | loss: 2.3054435
	speed: 0.2731s/iter; left time: 10269.4670s
Epoch: 9 cost time: 117.09707927703857
Epoch: 9, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 2.3053820
	speed: 0.5716s/iter; left time: 21426.4139s
	iters: 200, epoch: 10 | loss: 2.3040142
	speed: 0.2683s/iter; left time: 10028.9793s
	iters: 300, epoch: 10 | loss: 2.3038392
	speed: 0.2744s/iter; left time: 10230.6656s
	iters: 400, epoch: 10 | loss: 2.3025465
	speed: 0.2792s/iter; left time: 10383.5509s
Epoch: 10 cost time: 115.2523148059845
Epoch: 10, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 2.3034091
	speed: 0.5454s/iter; left time: 20217.8298s
	iters: 200, epoch: 11 | loss: 2.3002827
	speed: 0.2886s/iter; left time: 10671.5170s
	iters: 300, epoch: 11 | loss: 2.3057282
	speed: 0.2808s/iter; left time: 10352.3918s
	iters: 400, epoch: 11 | loss: 2.3040614
	speed: 0.2877s/iter; left time: 10580.3442s
Epoch: 11 cost time: 118.87286734580994
Epoch: 11, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 2.3051827
	speed: 0.5491s/iter; left time: 20127.9034s
	iters: 200, epoch: 12 | loss: 2.2983592
	speed: 0.2776s/iter; left time: 10147.1636s
	iters: 300, epoch: 12 | loss: 2.3021970
	speed: 0.2786s/iter; left time: 10156.0280s
	iters: 400, epoch: 12 | loss: 2.3042367
	speed: 0.2768s/iter; left time: 10062.5447s
Epoch: 12 cost time: 114.04895210266113
Epoch: 12, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 2.3034952
	speed: 0.5656s/iter; left time: 20500.5182s
	iters: 200, epoch: 13 | loss: 2.3029709
	speed: 0.2808s/iter; left time: 10149.6824s
	iters: 300, epoch: 13 | loss: 2.3031836
	speed: 0.3013s/iter; left time: 10859.7039s
	iters: 400, epoch: 13 | loss: 2.3040783
	speed: 0.2707s/iter; left time: 9731.4611s
Epoch: 13 cost time: 117.32823061943054
Epoch: 13, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 2.3025134
	speed: 0.5700s/iter; left time: 20424.3679s
	iters: 200, epoch: 14 | loss: 2.3053484
	speed: 0.2713s/iter; left time: 9694.6268s
	iters: 300, epoch: 14 | loss: 2.3017824
	speed: 0.2755s/iter; left time: 9817.3985s
	iters: 400, epoch: 14 | loss: 2.3040056
	speed: 0.3046s/iter; left time: 10821.7125s
Epoch: 14 cost time: 119.21319699287415
Epoch: 14, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 2.3015914
	speed: 0.5544s/iter; left time: 19637.0738s
	iters: 200, epoch: 15 | loss: 2.3042407
	speed: 0.3036s/iter; left time: 10721.2648s
	iters: 300, epoch: 15 | loss: 2.3022227
	speed: 0.2911s/iter; left time: 10252.8940s
	iters: 400, epoch: 15 | loss: 2.3044481
	speed: 0.2828s/iter; left time: 9931.2897s
Epoch: 15 cost time: 119.64761638641357
Epoch: 15, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 2.3054876
	speed: 0.5462s/iter; left time: 19120.6824s
	iters: 200, epoch: 16 | loss: 2.3037772
	speed: 0.2688s/iter; left time: 9381.4496s
	iters: 300, epoch: 16 | loss: 2.3066847
	speed: 0.2973s/iter; left time: 10349.5299s
	iters: 400, epoch: 16 | loss: 2.3046591
	speed: 0.2864s/iter; left time: 9939.7647s
Epoch: 16 cost time: 115.39530110359192
Epoch: 16, Steps: 413 | Train Loss: 2.303 Vali Loss: 2.303 Vali Acc: 0.100 Test Loss: 2.303 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_FEDformer_UEA_ftM_sl93_ll0_pl0_dm32_nh8_el2_dl1_df128_ma1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.10004547521600728
model parameter : 93514
model size : 1.60MB
