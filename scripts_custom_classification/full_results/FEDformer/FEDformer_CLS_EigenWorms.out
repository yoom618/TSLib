Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         8992                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma8992_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 721.136741399765
Epoch: 1, Steps: 32 | Train Loss: 49.088 Vali Loss: 134.793 Vali Acc: 0.221 Test Loss: 134.793 Test Acc: 0.221
Validation loss decreased (inf --> -0.220026).  Saving model ...
Epoch: 2 cost time: 825.0947058200836
Epoch: 2, Steps: 32 | Train Loss: 54.502 Vali Loss: 136.654 Vali Acc: 0.298 Test Loss: 136.654 Test Acc: 0.298
Validation loss decreased (-0.220026 --> -0.296343).  Saving model ...
Epoch: 3 cost time: 887.0841512680054
Epoch: 3, Steps: 32 | Train Loss: 36.159 Vali Loss: 268.678 Vali Acc: 0.473 Test Loss: 268.678 Test Acc: 0.473
Validation loss decreased (-0.296343 --> -0.470596).  Saving model ...
Epoch: 4 cost time: 897.1008014678955
Epoch: 4, Steps: 32 | Train Loss: 29.318 Vali Loss: 269.922 Vali Acc: 0.389 Test Loss: 269.922 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 877.5711534023285
Epoch: 5, Steps: 32 | Train Loss: 95.508 Vali Loss: 370.152 Vali Acc: 0.534 Test Loss: 370.152 Test Acc: 0.534
Validation loss decreased (-0.470596 --> -0.530650).  Saving model ...
Epoch: 6 cost time: 929.4950559139252
Epoch: 6, Steps: 32 | Train Loss: 18.476 Vali Loss: 351.264 Vali Acc: 0.473 Test Loss: 351.264 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 904.5395538806915
Epoch: 7, Steps: 32 | Train Loss: 67.981 Vali Loss: 453.498 Vali Acc: 0.519 Test Loss: 453.498 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 924.2836339473724
Epoch: 8, Steps: 32 | Train Loss: 24.783 Vali Loss: 407.959 Vali Acc: 0.397 Test Loss: 407.959 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 915.7329208850861
Epoch: 9, Steps: 32 | Train Loss: 26.491 Vali Loss: 400.162 Vali Acc: 0.435 Test Loss: 400.162 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 916.4679937362671
Epoch: 10, Steps: 32 | Train Loss: 10.596 Vali Loss: 552.209 Vali Acc: 0.389 Test Loss: 552.209 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 924.3480582237244
Epoch: 11, Steps: 32 | Train Loss: 2.983 Vali Loss: 553.434 Vali Acc: 0.481 Test Loss: 553.434 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 928.1962428092957
Epoch: 12, Steps: 32 | Train Loss: 2.986 Vali Loss: 556.728 Vali Acc: 0.519 Test Loss: 556.728 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 922.7682263851166
Epoch: 13, Steps: 32 | Train Loss: 13.451 Vali Loss: 496.324 Vali Acc: 0.389 Test Loss: 496.324 Test Acc: 0.389
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 926.1806230545044
Epoch: 14, Steps: 32 | Train Loss: 5.913 Vali Loss: 464.876 Vali Acc: 0.359 Test Loss: 464.876 Test Acc: 0.359
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 922.1467399597168
Epoch: 15, Steps: 32 | Train Loss: 10.164 Vali Loss: 930.584 Vali Acc: 0.359 Test Loss: 930.584 Test Acc: 0.359
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma8992_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 62850565
model size : 310.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         7194                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma7194_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 591.2335793972015
Epoch: 1, Steps: 32 | Train Loss: 45.000 Vali Loss: 72.865 Vali Acc: 0.481 Test Loss: 72.865 Test Acc: 0.481
Validation loss decreased (inf --> -0.480187).  Saving model ...
Epoch: 2 cost time: 672.4163794517517
Epoch: 2, Steps: 32 | Train Loss: 38.788 Vali Loss: 130.517 Vali Acc: 0.328 Test Loss: 130.517 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 707.3058955669403
Epoch: 3, Steps: 32 | Train Loss: 54.125 Vali Loss: 195.897 Vali Acc: 0.489 Test Loss: 195.897 Test Acc: 0.489
Validation loss decreased (-0.480187 --> -0.486591).  Saving model ...
Epoch: 4 cost time: 716.2239079475403
Epoch: 4, Steps: 32 | Train Loss: 29.588 Vali Loss: 239.608 Vali Acc: 0.298 Test Loss: 239.608 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 732.1011362075806
Epoch: 5, Steps: 32 | Train Loss: 37.708 Vali Loss: 328.236 Vali Acc: 0.275 Test Loss: 328.236 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 722.309296131134
Epoch: 6, Steps: 32 | Train Loss: 42.043 Vali Loss: 352.695 Vali Acc: 0.328 Test Loss: 352.695 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 726.0481610298157
Epoch: 7, Steps: 32 | Train Loss: 44.102 Vali Loss: 434.077 Vali Acc: 0.328 Test Loss: 434.077 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 732.5909795761108
Epoch: 8, Steps: 32 | Train Loss: 50.431 Vali Loss: 470.425 Vali Acc: 0.511 Test Loss: 470.425 Test Acc: 0.511
Validation loss decreased (-0.486591 --> -0.506746).  Saving model ...
Epoch: 9 cost time: 742.6620955467224
Epoch: 9, Steps: 32 | Train Loss: 10.558 Vali Loss: 444.396 Vali Acc: 0.511 Test Loss: 444.396 Test Acc: 0.511
Validation loss decreased (-0.506746 --> -0.507006).  Saving model ...
Epoch: 10 cost time: 735.6338634490967
Epoch: 10, Steps: 32 | Train Loss: 26.439 Vali Loss: 571.617 Vali Acc: 0.405 Test Loss: 571.617 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 731.2628216743469
Epoch: 11, Steps: 32 | Train Loss: 38.569 Vali Loss: 817.498 Vali Acc: 0.489 Test Loss: 817.498 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 749.0254571437836
Epoch: 12, Steps: 32 | Train Loss: 17.620 Vali Loss: 449.127 Vali Acc: 0.473 Test Loss: 449.127 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 734.4549164772034
Epoch: 13, Steps: 32 | Train Loss: 25.004 Vali Loss: 765.578 Vali Acc: 0.443 Test Loss: 765.578 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 742.7532875537872
Epoch: 14, Steps: 32 | Train Loss: 7.614 Vali Loss: 936.839 Vali Acc: 0.481 Test Loss: 936.839 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 746.3907532691956
Epoch: 15, Steps: 32 | Train Loss: 34.584 Vali Loss: 646.168 Vali Acc: 0.481 Test Loss: 646.168 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 737.2084345817566
Epoch: 16, Steps: 32 | Train Loss: 49.044 Vali Loss: 632.971 Vali Acc: 0.519 Test Loss: 632.971 Test Acc: 0.519
Validation loss decreased (-0.507006 --> -0.512754).  Saving model ...
Epoch: 17 cost time: 733.3867712020874
Epoch: 17, Steps: 32 | Train Loss: 69.045 Vali Loss: 1015.218 Vali Acc: 0.267 Test Loss: 1015.218 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 742.5460751056671
Epoch: 18, Steps: 32 | Train Loss: 23.389 Vali Loss: 813.883 Vali Acc: 0.427 Test Loss: 813.883 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 745.24218916893
Epoch: 19, Steps: 32 | Train Loss: 19.254 Vali Loss: 879.469 Vali Acc: 0.427 Test Loss: 879.469 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 750.5707077980042
Epoch: 20, Steps: 32 | Train Loss: 22.656 Vali Loss: 1236.427 Vali Acc: 0.496 Test Loss: 1236.427 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 741.4558489322662
Epoch: 21, Steps: 32 | Train Loss: 21.650 Vali Loss: 992.451 Vali Acc: 0.481 Test Loss: 992.451 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 748.9938611984253
Epoch: 22, Steps: 32 | Train Loss: 4.559 Vali Loss: 910.549 Vali Acc: 0.359 Test Loss: 910.549 Test Acc: 0.359
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 748.1740508079529
Epoch: 23, Steps: 32 | Train Loss: 3.650 Vali Loss: 953.366 Vali Acc: 0.489 Test Loss: 953.366 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 749.2065787315369
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 1036.815 Vali Acc: 0.504 Test Loss: 1036.815 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 746.577550649643
Epoch: 25, Steps: 32 | Train Loss: 8.460 Vali Loss: 903.657 Vali Acc: 0.382 Test Loss: 903.657 Test Acc: 0.382
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 749.9034638404846
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 1015.900 Vali Acc: 0.481 Test Loss: 1015.900 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma7194_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 62850565
model size : 310.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5396                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma5396_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 460.702481508255
Epoch: 1, Steps: 32 | Train Loss: 46.385 Vali Loss: 66.219 Vali Acc: 0.511 Test Loss: 66.219 Test Acc: 0.511
Validation loss decreased (inf --> -0.510788).  Saving model ...
Epoch: 2 cost time: 536.0018558502197
Epoch: 2, Steps: 32 | Train Loss: 38.911 Vali Loss: 212.099 Vali Acc: 0.214 Test Loss: 212.099 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 537.2298805713654
Epoch: 3, Steps: 32 | Train Loss: 43.782 Vali Loss: 99.863 Vali Acc: 0.527 Test Loss: 99.863 Test Acc: 0.527
Validation loss decreased (-0.510788 --> -0.525719).  Saving model ...
Epoch: 4 cost time: 552.8053894042969
Epoch: 4, Steps: 32 | Train Loss: 21.016 Vali Loss: 231.408 Vali Acc: 0.420 Test Loss: 231.408 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 552.0679993629456
Epoch: 5, Steps: 32 | Train Loss: 30.546 Vali Loss: 341.006 Vali Acc: 0.389 Test Loss: 341.006 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 548.1556854248047
Epoch: 6, Steps: 32 | Train Loss: 36.517 Vali Loss: 338.590 Vali Acc: 0.511 Test Loss: 338.590 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 553.6072072982788
Epoch: 7, Steps: 32 | Train Loss: 43.545 Vali Loss: 469.549 Vali Acc: 0.542 Test Loss: 469.549 Test Acc: 0.542
Validation loss decreased (-0.525719 --> -0.537289).  Saving model ...
Epoch: 8 cost time: 564.8021261692047
Epoch: 8, Steps: 32 | Train Loss: 25.049 Vali Loss: 381.387 Vali Acc: 0.443 Test Loss: 381.387 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 562.752189874649
Epoch: 9, Steps: 32 | Train Loss: 25.979 Vali Loss: 545.881 Vali Acc: 0.519 Test Loss: 545.881 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 566.5130486488342
Epoch: 10, Steps: 32 | Train Loss: 18.162 Vali Loss: 371.143 Vali Acc: 0.473 Test Loss: 371.143 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 559.8583853244781
Epoch: 11, Steps: 32 | Train Loss: 39.201 Vali Loss: 415.721 Vali Acc: 0.344 Test Loss: 415.721 Test Acc: 0.344
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 565.791158914566
Epoch: 12, Steps: 32 | Train Loss: 37.117 Vali Loss: 642.602 Vali Acc: 0.519 Test Loss: 642.602 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 569.2596116065979
Epoch: 13, Steps: 32 | Train Loss: 9.513 Vali Loss: 602.557 Vali Acc: 0.496 Test Loss: 602.557 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 566.9185943603516
Epoch: 14, Steps: 32 | Train Loss: 9.924 Vali Loss: 537.126 Vali Acc: 0.374 Test Loss: 537.126 Test Acc: 0.374
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 565.5431480407715
Epoch: 15, Steps: 32 | Train Loss: 16.956 Vali Loss: 819.782 Vali Acc: 0.382 Test Loss: 819.782 Test Acc: 0.382
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 560.9708778858185
Epoch: 16, Steps: 32 | Train Loss: 23.262 Vali Loss: 700.794 Vali Acc: 0.328 Test Loss: 700.794 Test Acc: 0.328
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 568.472766160965
Epoch: 17, Steps: 32 | Train Loss: 28.602 Vali Loss: 630.720 Vali Acc: 0.412 Test Loss: 630.720 Test Acc: 0.412
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma5396_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 62850565
model size : 310.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3597                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma3597_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 327.9384870529175
Epoch: 1, Steps: 32 | Train Loss: 73.953 Vali Loss: 106.469 Vali Acc: 0.221 Test Loss: 106.469 Test Acc: 0.221
Validation loss decreased (inf --> -0.220309).  Saving model ...
Epoch: 2 cost time: 353.06749963760376
Epoch: 2, Steps: 32 | Train Loss: 57.924 Vali Loss: 161.743 Vali Acc: 0.282 Test Loss: 161.743 Test Acc: 0.282
Validation loss decreased (-0.220309 --> -0.280825).  Saving model ...
Epoch: 3 cost time: 374.5450053215027
Epoch: 3, Steps: 32 | Train Loss: 34.290 Vali Loss: 349.417 Vali Acc: 0.450 Test Loss: 349.417 Test Acc: 0.450
Validation loss decreased (-0.280825 --> -0.446888).  Saving model ...
Epoch: 4 cost time: 378.20623779296875
Epoch: 4, Steps: 32 | Train Loss: 43.575 Vali Loss: 196.359 Vali Acc: 0.336 Test Loss: 196.359 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 381.27120089530945
Epoch: 5, Steps: 32 | Train Loss: 48.847 Vali Loss: 292.647 Vali Acc: 0.237 Test Loss: 292.647 Test Acc: 0.237
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 382.24542212486267
Epoch: 6, Steps: 32 | Train Loss: 29.781 Vali Loss: 338.219 Vali Acc: 0.282 Test Loss: 338.219 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 386.90492248535156
Epoch: 7, Steps: 32 | Train Loss: 38.934 Vali Loss: 223.768 Vali Acc: 0.534 Test Loss: 223.768 Test Acc: 0.534
Validation loss decreased (-0.446888 --> -0.532113).  Saving model ...
Epoch: 8 cost time: 386.92146944999695
Epoch: 8, Steps: 32 | Train Loss: 19.941 Vali Loss: 457.708 Vali Acc: 0.321 Test Loss: 457.708 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 386.9812216758728
Epoch: 9, Steps: 32 | Train Loss: 25.711 Vali Loss: 317.019 Vali Acc: 0.511 Test Loss: 317.019 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 390.7227487564087
Epoch: 10, Steps: 32 | Train Loss: 16.672 Vali Loss: 400.036 Vali Acc: 0.519 Test Loss: 400.036 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 391.74426913261414
Epoch: 11, Steps: 32 | Train Loss: 20.021 Vali Loss: 630.220 Vali Acc: 0.542 Test Loss: 630.220 Test Acc: 0.542
Validation loss decreased (-0.532113 --> -0.535683).  Saving model ...
Epoch: 12 cost time: 387.60061287879944
Epoch: 12, Steps: 32 | Train Loss: 30.313 Vali Loss: 577.482 Vali Acc: 0.542 Test Loss: 577.482 Test Acc: 0.542
Validation loss decreased (-0.535683 --> -0.536210).  Saving model ...
Epoch: 13 cost time: 390.12684988975525
Epoch: 13, Steps: 32 | Train Loss: 5.260 Vali Loss: 484.416 Vali Acc: 0.481 Test Loss: 484.416 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 385.96844935417175
Epoch: 14, Steps: 32 | Train Loss: 30.754 Vali Loss: 457.821 Vali Acc: 0.504 Test Loss: 457.821 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 393.59260725975037
Epoch: 15, Steps: 32 | Train Loss: 7.424 Vali Loss: 786.836 Vali Acc: 0.489 Test Loss: 786.836 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 392.17309951782227
Epoch: 16, Steps: 32 | Train Loss: 7.757 Vali Loss: 515.486 Vali Acc: 0.412 Test Loss: 515.486 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 387.49040150642395
Epoch: 17, Steps: 32 | Train Loss: 31.878 Vali Loss: 1009.710 Vali Acc: 0.290 Test Loss: 1009.710 Test Acc: 0.290
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 386.21448588371277
Epoch: 18, Steps: 32 | Train Loss: 60.976 Vali Loss: 659.805 Vali Acc: 0.427 Test Loss: 659.805 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 393.7054271697998
Epoch: 19, Steps: 32 | Train Loss: 6.318 Vali Loss: 770.734 Vali Acc: 0.511 Test Loss: 770.734 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 395.2298593521118
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 943.553 Vali Acc: 0.550 Test Loss: 943.553 Test Acc: 0.550
Validation loss decreased (-0.536210 --> -0.540183).  Saving model ...
Epoch: 21 cost time: 396.9952754974365
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 937.086 Vali Acc: 0.550 Test Loss: 937.086 Test Acc: 0.550
Validation loss decreased (-0.540183 --> -0.540247).  Saving model ...
Epoch: 22 cost time: 397.4316327571869
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 894.194 Vali Acc: 0.511 Test Loss: 894.194 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 398.9344856739044
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 893.230 Vali Acc: 0.511 Test Loss: 893.230 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 399.51076650619507
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 893.194 Vali Acc: 0.511 Test Loss: 893.194 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 400.50321340560913
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 893.193 Vali Acc: 0.511 Test Loss: 893.193 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 399.9838058948517
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 893.193 Vali Acc: 0.511 Test Loss: 893.193 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 400.9303574562073
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 893.193 Vali Acc: 0.511 Test Loss: 893.193 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 400.83384561538696
Epoch: 28, Steps: 32 | Train Loss: 0.000 Vali Loss: 893.193 Vali Acc: 0.511 Test Loss: 893.193 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 400.4731903076172
Epoch: 29, Steps: 32 | Train Loss: 0.000 Vali Loss: 893.193 Vali Acc: 0.511 Test Loss: 893.193 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 400.86791229248047
Epoch: 30, Steps: 32 | Train Loss: 0.000 Vali Loss: 893.193 Vali Acc: 0.511 Test Loss: 893.193 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 400.0293538570404
Epoch: 31, Steps: 32 | Train Loss: 0.000 Vali Loss: 893.193 Vali Acc: 0.511 Test Loss: 893.193 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma3597_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 62850565
model size : 310.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1799                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 184.97908735275269
Epoch: 1, Steps: 32 | Train Loss: 64.808 Vali Loss: 139.061 Vali Acc: 0.198 Test Loss: 139.061 Test Acc: 0.198
Validation loss decreased (inf --> -0.197083).  Saving model ...
Epoch: 2 cost time: 197.51756811141968
Epoch: 2, Steps: 32 | Train Loss: 42.924 Vali Loss: 118.089 Vali Acc: 0.282 Test Loss: 118.089 Test Acc: 0.282
Validation loss decreased (-0.197083 --> -0.281262).  Saving model ...
Epoch: 3 cost time: 208.19452810287476
Epoch: 3, Steps: 32 | Train Loss: 52.166 Vali Loss: 362.744 Vali Acc: 0.443 Test Loss: 362.744 Test Acc: 0.443
Validation loss decreased (-0.281262 --> -0.439121).  Saving model ...
Epoch: 4 cost time: 210.96842670440674
Epoch: 4, Steps: 32 | Train Loss: 66.131 Vali Loss: 235.968 Vali Acc: 0.496 Test Loss: 235.968 Test Acc: 0.496
Validation loss decreased (-0.439121 --> -0.493824).  Saving model ...
Epoch: 5 cost time: 212.333997964859
Epoch: 5, Steps: 32 | Train Loss: 28.266 Vali Loss: 284.909 Vali Acc: 0.496 Test Loss: 284.909 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 212.41534066200256
Epoch: 6, Steps: 32 | Train Loss: 27.475 Vali Loss: 289.983 Vali Acc: 0.359 Test Loss: 289.983 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 211.84928703308105
Epoch: 7, Steps: 32 | Train Loss: 49.782 Vali Loss: 271.174 Vali Acc: 0.412 Test Loss: 271.174 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 214.78103876113892
Epoch: 8, Steps: 32 | Train Loss: 19.466 Vali Loss: 406.913 Vali Acc: 0.443 Test Loss: 406.913 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 211.04536771774292
Epoch: 9, Steps: 32 | Train Loss: 56.775 Vali Loss: 377.037 Vali Acc: 0.405 Test Loss: 377.037 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 213.79120302200317
Epoch: 10, Steps: 32 | Train Loss: 46.237 Vali Loss: 530.773 Vali Acc: 0.519 Test Loss: 530.773 Test Acc: 0.519
Validation loss decreased (-0.493824 --> -0.513776).  Saving model ...
Epoch: 11 cost time: 216.44604420661926
Epoch: 11, Steps: 32 | Train Loss: 11.556 Vali Loss: 555.422 Vali Acc: 0.496 Test Loss: 555.422 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 215.08183026313782
Epoch: 12, Steps: 32 | Train Loss: 14.953 Vali Loss: 545.432 Vali Acc: 0.458 Test Loss: 545.432 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 214.5906801223755
Epoch: 13, Steps: 32 | Train Loss: 24.979 Vali Loss: 836.440 Vali Acc: 0.313 Test Loss: 836.440 Test Acc: 0.313
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 214.87636375427246
Epoch: 14, Steps: 32 | Train Loss: 26.272 Vali Loss: 532.097 Vali Acc: 0.435 Test Loss: 532.097 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 218.74344897270203
Epoch: 15, Steps: 32 | Train Loss: 5.986 Vali Loss: 829.526 Vali Acc: 0.511 Test Loss: 829.526 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 214.49599957466125
Epoch: 16, Steps: 32 | Train Loss: 35.669 Vali Loss: 875.977 Vali Acc: 0.519 Test Loss: 875.977 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 217.5282964706421
Epoch: 17, Steps: 32 | Train Loss: 9.851 Vali Loss: 1026.258 Vali Acc: 0.504 Test Loss: 1026.258 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 216.47039103507996
Epoch: 18, Steps: 32 | Train Loss: 17.320 Vali Loss: 603.856 Vali Acc: 0.519 Test Loss: 603.856 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 216.97262811660767
Epoch: 19, Steps: 32 | Train Loss: 13.070 Vali Loss: 618.168 Vali Acc: 0.473 Test Loss: 618.168 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 217.39876914024353
Epoch: 20, Steps: 32 | Train Loss: 0.744 Vali Loss: 675.555 Vali Acc: 0.496 Test Loss: 675.555 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 62850565
model size : 310.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 100.03720998764038
Epoch: 1, Steps: 32 | Train Loss: 42.556 Vali Loss: 96.875 Vali Acc: 0.489 Test Loss: 96.875 Test Acc: 0.489
Validation loss decreased (inf --> -0.487581).  Saving model ...
Epoch: 2 cost time: 113.3393611907959
Epoch: 2, Steps: 32 | Train Loss: 50.888 Vali Loss: 127.579 Vali Acc: 0.252 Test Loss: 127.579 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 115.59990525245667
Epoch: 3, Steps: 32 | Train Loss: 26.319 Vali Loss: 150.211 Vali Acc: 0.366 Test Loss: 150.211 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 114.5424702167511
Epoch: 4, Steps: 32 | Train Loss: 56.297 Vali Loss: 242.672 Vali Acc: 0.473 Test Loss: 242.672 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 116.11536979675293
Epoch: 5, Steps: 32 | Train Loss: 49.063 Vali Loss: 279.753 Vali Acc: 0.458 Test Loss: 279.753 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 118.29543709754944
Epoch: 6, Steps: 32 | Train Loss: 20.007 Vali Loss: 252.042 Vali Acc: 0.405 Test Loss: 252.042 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 118.85032629966736
Epoch: 7, Steps: 32 | Train Loss: 8.371 Vali Loss: 322.420 Vali Acc: 0.305 Test Loss: 322.420 Test Acc: 0.305
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 118.01217842102051
Epoch: 8, Steps: 32 | Train Loss: 35.117 Vali Loss: 488.482 Vali Acc: 0.374 Test Loss: 488.482 Test Acc: 0.374
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 120.38121294975281
Epoch: 9, Steps: 32 | Train Loss: 8.263 Vali Loss: 418.293 Vali Acc: 0.420 Test Loss: 418.293 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 119.52808427810669
Epoch: 10, Steps: 32 | Train Loss: 6.130 Vali Loss: 539.514 Vali Acc: 0.351 Test Loss: 539.514 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 119.31963014602661
Epoch: 11, Steps: 32 | Train Loss: 25.282 Vali Loss: 541.591 Vali Acc: 0.405 Test Loss: 541.591 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 62850565
model size : 310.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         540                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma540_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 76.41747045516968
Epoch: 1, Steps: 32 | Train Loss: 48.700 Vali Loss: 104.809 Vali Acc: 0.466 Test Loss: 104.809 Test Acc: 0.466
Validation loss decreased (inf --> -0.464601).  Saving model ...
Epoch: 2 cost time: 81.67862796783447
Epoch: 2, Steps: 32 | Train Loss: 53.340 Vali Loss: 177.800 Vali Acc: 0.298 Test Loss: 177.800 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 82.344477891922
Epoch: 3, Steps: 32 | Train Loss: 55.546 Vali Loss: 150.210 Vali Acc: 0.481 Test Loss: 150.210 Test Acc: 0.481
Validation loss decreased (-0.464601 --> -0.479414).  Saving model ...
Epoch: 4 cost time: 86.40017509460449
Epoch: 4, Steps: 32 | Train Loss: 15.578 Vali Loss: 134.540 Vali Acc: 0.496 Test Loss: 134.540 Test Acc: 0.496
Validation loss decreased (-0.479414 --> -0.494838).  Saving model ...
Epoch: 5 cost time: 84.99014902114868
Epoch: 5, Steps: 32 | Train Loss: 22.632 Vali Loss: 324.460 Vali Acc: 0.504 Test Loss: 324.460 Test Acc: 0.504
Validation loss decreased (-0.494838 --> -0.500572).  Saving model ...
Epoch: 6 cost time: 85.53188896179199
Epoch: 6, Steps: 32 | Train Loss: 29.635 Vali Loss: 214.923 Vali Acc: 0.420 Test Loss: 214.923 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 86.73417210578918
Epoch: 7, Steps: 32 | Train Loss: 6.115 Vali Loss: 277.568 Vali Acc: 0.481 Test Loss: 277.568 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 86.45847678184509
Epoch: 8, Steps: 32 | Train Loss: 6.846 Vali Loss: 339.027 Vali Acc: 0.351 Test Loss: 339.027 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 86.39836716651917
Epoch: 9, Steps: 32 | Train Loss: 70.481 Vali Loss: 539.226 Vali Acc: 0.252 Test Loss: 539.226 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 85.39744567871094
Epoch: 10, Steps: 32 | Train Loss: 45.902 Vali Loss: 353.679 Vali Acc: 0.366 Test Loss: 353.679 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 85.62993097305298
Epoch: 11, Steps: 32 | Train Loss: 53.560 Vali Loss: 464.282 Vali Acc: 0.427 Test Loss: 464.282 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 86.25130009651184
Epoch: 12, Steps: 32 | Train Loss: 33.864 Vali Loss: 549.436 Vali Acc: 0.412 Test Loss: 549.436 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 86.62732577323914
Epoch: 13, Steps: 32 | Train Loss: 3.661 Vali Loss: 490.585 Vali Acc: 0.450 Test Loss: 490.585 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 87.01842069625854
Epoch: 14, Steps: 32 | Train Loss: 2.541 Vali Loss: 497.415 Vali Acc: 0.351 Test Loss: 497.415 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 86.6147301197052
Epoch: 15, Steps: 32 | Train Loss: 9.547 Vali Loss: 912.761 Vali Acc: 0.305 Test Loss: 912.761 Test Acc: 0.305
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma540_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 62850565
model size : 310.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 63.6435763835907
Epoch: 1, Steps: 32 | Train Loss: 58.785 Vali Loss: 81.425 Vali Acc: 0.466 Test Loss: 81.425 Test Acc: 0.466
Validation loss decreased (inf --> -0.464835).  Saving model ...
Epoch: 2 cost time: 66.51602387428284
Epoch: 2, Steps: 32 | Train Loss: 43.258 Vali Loss: 87.285 Vali Acc: 0.328 Test Loss: 87.285 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 68.05314469337463
Epoch: 3, Steps: 32 | Train Loss: 25.976 Vali Loss: 209.103 Vali Acc: 0.443 Test Loss: 209.103 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 69.46520328521729
Epoch: 4, Steps: 32 | Train Loss: 21.475 Vali Loss: 252.337 Vali Acc: 0.489 Test Loss: 252.337 Test Acc: 0.489
Validation loss decreased (-0.464835 --> -0.486026).  Saving model ...
Epoch: 5 cost time: 68.81383466720581
Epoch: 5, Steps: 32 | Train Loss: 34.137 Vali Loss: 224.899 Vali Acc: 0.405 Test Loss: 224.899 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 70.05067300796509
Epoch: 6, Steps: 32 | Train Loss: 47.960 Vali Loss: 219.716 Vali Acc: 0.397 Test Loss: 219.716 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 70.00539302825928
Epoch: 7, Steps: 32 | Train Loss: 19.698 Vali Loss: 265.245 Vali Acc: 0.382 Test Loss: 265.245 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 70.58203434944153
Epoch: 8, Steps: 32 | Train Loss: 26.466 Vali Loss: 386.809 Vali Acc: 0.397 Test Loss: 386.809 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 69.13258147239685
Epoch: 9, Steps: 32 | Train Loss: 41.257 Vali Loss: 368.382 Vali Acc: 0.466 Test Loss: 368.382 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 68.96238255500793
Epoch: 10, Steps: 32 | Train Loss: 30.320 Vali Loss: 445.858 Vali Acc: 0.344 Test Loss: 445.858 Test Acc: 0.344
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 68.92805218696594
Epoch: 11, Steps: 32 | Train Loss: 68.164 Vali Loss: 585.911 Vali Acc: 0.473 Test Loss: 585.911 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 69.69702458381653
Epoch: 12, Steps: 32 | Train Loss: 11.729 Vali Loss: 662.531 Vali Acc: 0.466 Test Loss: 662.531 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 70.40107464790344
Epoch: 13, Steps: 32 | Train Loss: 7.410 Vali Loss: 556.697 Vali Acc: 0.359 Test Loss: 556.697 Test Acc: 0.359
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 69.915114402771
Epoch: 14, Steps: 32 | Train Loss: 28.116 Vali Loss: 451.650 Vali Acc: 0.450 Test Loss: 451.650 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 62850565
model size : 310.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 51.579222679138184
Epoch: 1, Steps: 32 | Train Loss: 46.367 Vali Loss: 80.530 Vali Acc: 0.458 Test Loss: 80.530 Test Acc: 0.458
Validation loss decreased (inf --> -0.457210).  Saving model ...
Epoch: 2 cost time: 51.979695320129395
Epoch: 2, Steps: 32 | Train Loss: 56.939 Vali Loss: 93.874 Vali Acc: 0.412 Test Loss: 93.874 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 53.042044162750244
Epoch: 3, Steps: 32 | Train Loss: 41.446 Vali Loss: 173.899 Vali Acc: 0.496 Test Loss: 173.899 Test Acc: 0.496
Validation loss decreased (-0.457210 --> -0.494444).  Saving model ...
Epoch: 4 cost time: 53.44483971595764
Epoch: 4, Steps: 32 | Train Loss: 42.404 Vali Loss: 149.870 Vali Acc: 0.496 Test Loss: 149.870 Test Acc: 0.496
Validation loss decreased (-0.494444 --> -0.494685).  Saving model ...
Epoch: 5 cost time: 53.354490518569946
Epoch: 5, Steps: 32 | Train Loss: 48.655 Vali Loss: 281.624 Vali Acc: 0.298 Test Loss: 281.624 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 53.48122000694275
Epoch: 6, Steps: 32 | Train Loss: 33.327 Vali Loss: 318.309 Vali Acc: 0.511 Test Loss: 318.309 Test Acc: 0.511
Validation loss decreased (-0.494685 --> -0.508267).  Saving model ...
Epoch: 7 cost time: 53.794734716415405
Epoch: 7, Steps: 32 | Train Loss: 15.343 Vali Loss: 280.284 Vali Acc: 0.527 Test Loss: 280.284 Test Acc: 0.527
Validation loss decreased (-0.508267 --> -0.523915).  Saving model ...
Epoch: 8 cost time: 54.18866801261902
Epoch: 8, Steps: 32 | Train Loss: 19.619 Vali Loss: 315.367 Vali Acc: 0.450 Test Loss: 315.367 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 53.86162781715393
Epoch: 9, Steps: 32 | Train Loss: 30.841 Vali Loss: 344.932 Vali Acc: 0.496 Test Loss: 344.932 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 53.93373727798462
Epoch: 10, Steps: 32 | Train Loss: 28.996 Vali Loss: 528.691 Vali Acc: 0.473 Test Loss: 528.691 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 54.32763361930847
Epoch: 11, Steps: 32 | Train Loss: 28.291 Vali Loss: 349.044 Vali Acc: 0.397 Test Loss: 349.044 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 54.128748655319214
Epoch: 12, Steps: 32 | Train Loss: 56.577 Vali Loss: 357.427 Vali Acc: 0.450 Test Loss: 357.427 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 54.38252329826355
Epoch: 13, Steps: 32 | Train Loss: 34.675 Vali Loss: 488.764 Vali Acc: 0.405 Test Loss: 488.764 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 54.684650897979736
Epoch: 14, Steps: 32 | Train Loss: 12.178 Vali Loss: 511.739 Vali Acc: 0.382 Test Loss: 511.739 Test Acc: 0.382
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 54.97373127937317
Epoch: 15, Steps: 32 | Train Loss: 3.629 Vali Loss: 621.067 Vali Acc: 0.305 Test Loss: 621.067 Test Acc: 0.305
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 54.35578680038452
Epoch: 16, Steps: 32 | Train Loss: 17.965 Vali Loss: 524.060 Vali Acc: 0.489 Test Loss: 524.060 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 54.46552109718323
Epoch: 17, Steps: 32 | Train Loss: 3.633 Vali Loss: 378.111 Vali Acc: 0.458 Test Loss: 378.111 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 62850565
model size : 310.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 45.60635280609131
Epoch: 1, Steps: 32 | Train Loss: 49.325 Vali Loss: 51.750 Vali Acc: 0.450 Test Loss: 51.750 Test Acc: 0.450
Validation loss decreased (inf --> -0.449864).  Saving model ...
Epoch: 2 cost time: 44.57222390174866
Epoch: 2, Steps: 32 | Train Loss: 38.361 Vali Loss: 92.262 Vali Acc: 0.542 Test Loss: 92.262 Test Acc: 0.542
Validation loss decreased (-0.449864 --> -0.541062).  Saving model ...
Epoch: 3 cost time: 44.90830063819885
Epoch: 3, Steps: 32 | Train Loss: 52.566 Vali Loss: 184.851 Vali Acc: 0.534 Test Loss: 184.851 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 44.91331911087036
Epoch: 4, Steps: 32 | Train Loss: 42.220 Vali Loss: 100.352 Vali Acc: 0.435 Test Loss: 100.352 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 45.45834994316101
Epoch: 5, Steps: 32 | Train Loss: 40.197 Vali Loss: 153.620 Vali Acc: 0.511 Test Loss: 153.620 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 45.694260358810425
Epoch: 6, Steps: 32 | Train Loss: 36.953 Vali Loss: 292.337 Vali Acc: 0.504 Test Loss: 292.337 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 45.253692388534546
Epoch: 7, Steps: 32 | Train Loss: 34.803 Vali Loss: 406.328 Vali Acc: 0.305 Test Loss: 406.328 Test Acc: 0.305
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 44.985570430755615
Epoch: 8, Steps: 32 | Train Loss: 42.048 Vali Loss: 357.161 Vali Acc: 0.481 Test Loss: 357.161 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 45.6199631690979
Epoch: 9, Steps: 32 | Train Loss: 28.352 Vali Loss: 369.019 Vali Acc: 0.420 Test Loss: 369.019 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 45.38513493537903
Epoch: 10, Steps: 32 | Train Loss: 46.914 Vali Loss: 426.166 Vali Acc: 0.290 Test Loss: 426.166 Test Acc: 0.290
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 45.18209743499756
Epoch: 11, Steps: 32 | Train Loss: 22.916 Vali Loss: 704.921 Vali Acc: 0.511 Test Loss: 704.921 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 45.25316143035889
Epoch: 12, Steps: 32 | Train Loss: 12.293 Vali Loss: 392.719 Vali Acc: 0.412 Test Loss: 392.719 Test Acc: 0.412
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df2048_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 62850565
model size : 310.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         8992                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma8992_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 724.8150293827057
Epoch: 1, Steps: 32 | Train Loss: 63.308 Vali Loss: 86.919 Vali Acc: 0.359 Test Loss: 86.919 Test Acc: 0.359
Validation loss decreased (inf --> -0.357909).  Saving model ...
Epoch: 2 cost time: 890.8492298126221
Epoch: 2, Steps: 32 | Train Loss: 33.214 Vali Loss: 106.734 Vali Acc: 0.496 Test Loss: 106.734 Test Acc: 0.496
Validation loss decreased (-0.357909 --> -0.495116).  Saving model ...
Epoch: 3 cost time: 870.9125382900238
Epoch: 3, Steps: 32 | Train Loss: 58.083 Vali Loss: 267.539 Vali Acc: 0.511 Test Loss: 267.539 Test Acc: 0.511
Validation loss decreased (-0.495116 --> -0.508775).  Saving model ...
Epoch: 4 cost time: 907.7001602649689
Epoch: 4, Steps: 32 | Train Loss: 28.464 Vali Loss: 240.829 Vali Acc: 0.420 Test Loss: 240.829 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 889.024425983429
Epoch: 5, Steps: 32 | Train Loss: 53.216 Vali Loss: 288.593 Vali Acc: 0.534 Test Loss: 288.593 Test Acc: 0.534
Validation loss decreased (-0.508775 --> -0.531465).  Saving model ...
Epoch: 6 cost time: 914.9210624694824
Epoch: 6, Steps: 32 | Train Loss: 13.809 Vali Loss: 312.192 Vali Acc: 0.397 Test Loss: 312.192 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 904.9713368415833
Epoch: 7, Steps: 32 | Train Loss: 43.945 Vali Loss: 350.522 Vali Acc: 0.328 Test Loss: 350.522 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 914.5343198776245
Epoch: 8, Steps: 32 | Train Loss: 15.248 Vali Loss: 361.453 Vali Acc: 0.527 Test Loss: 361.453 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 920.351366519928
Epoch: 9, Steps: 32 | Train Loss: 9.628 Vali Loss: 466.030 Vali Acc: 0.527 Test Loss: 466.030 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 918.8612897396088
Epoch: 10, Steps: 32 | Train Loss: 20.985 Vali Loss: 510.507 Vali Acc: 0.519 Test Loss: 510.507 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 921.0757167339325
Epoch: 11, Steps: 32 | Train Loss: 16.552 Vali Loss: 749.824 Vali Acc: 0.511 Test Loss: 749.824 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 934.6151072978973
Epoch: 12, Steps: 32 | Train Loss: 11.337 Vali Loss: 530.503 Vali Acc: 0.489 Test Loss: 530.503 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 922.1153256893158
Epoch: 13, Steps: 32 | Train Loss: 2.758 Vali Loss: 511.336 Vali Acc: 0.435 Test Loss: 511.336 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 919.6802151203156
Epoch: 14, Steps: 32 | Train Loss: 21.846 Vali Loss: 534.337 Vali Acc: 0.473 Test Loss: 534.337 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 921.5624611377716
Epoch: 15, Steps: 32 | Train Loss: 26.383 Vali Loss: 872.428 Vali Acc: 0.168 Test Loss: 872.428 Test Acc: 0.168
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma8992_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 59704837
model size : 298.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         7194                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma7194_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 589.5568764209747
Epoch: 1, Steps: 32 | Train Loss: 71.225 Vali Loss: 149.306 Vali Acc: 0.466 Test Loss: 149.306 Test Acc: 0.466
Validation loss decreased (inf --> -0.464156).  Saving model ...
Epoch: 2 cost time: 688.1296730041504
Epoch: 2, Steps: 32 | Train Loss: 84.677 Vali Loss: 130.988 Vali Acc: 0.443 Test Loss: 130.988 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 722.9704642295837
Epoch: 3, Steps: 32 | Train Loss: 30.204 Vali Loss: 99.717 Vali Acc: 0.557 Test Loss: 99.717 Test Acc: 0.557
Validation loss decreased (-0.464156 --> -0.556255).  Saving model ...
Epoch: 4 cost time: 750.8176429271698
Epoch: 4, Steps: 32 | Train Loss: 17.894 Vali Loss: 183.910 Vali Acc: 0.313 Test Loss: 183.910 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 726.0796625614166
Epoch: 5, Steps: 32 | Train Loss: 24.586 Vali Loss: 210.157 Vali Acc: 0.481 Test Loss: 210.157 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 734.1899271011353
Epoch: 6, Steps: 32 | Train Loss: 20.920 Vali Loss: 312.360 Vali Acc: 0.382 Test Loss: 312.360 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 730.9549250602722
Epoch: 7, Steps: 32 | Train Loss: 50.928 Vali Loss: 487.551 Vali Acc: 0.511 Test Loss: 487.551 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 744.6125016212463
Epoch: 8, Steps: 32 | Train Loss: 21.087 Vali Loss: 255.866 Vali Acc: 0.443 Test Loss: 255.866 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 735.3857703208923
Epoch: 9, Steps: 32 | Train Loss: 37.460 Vali Loss: 791.098 Vali Acc: 0.504 Test Loss: 791.098 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 739.054399728775
Epoch: 10, Steps: 32 | Train Loss: 39.849 Vali Loss: 420.913 Vali Acc: 0.534 Test Loss: 420.913 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 752.5022675991058
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 459.229 Vali Acc: 0.389 Test Loss: 459.229 Test Acc: 0.389
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 735.2734768390656
Epoch: 12, Steps: 32 | Train Loss: 14.515 Vali Loss: 641.276 Vali Acc: 0.542 Test Loss: 641.276 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 733.4447529315948
Epoch: 13, Steps: 32 | Train Loss: 47.071 Vali Loss: 580.412 Vali Acc: 0.359 Test Loss: 580.412 Test Acc: 0.359
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma7194_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 59704837
model size : 298.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5396                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma5396_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 454.8032419681549
Epoch: 1, Steps: 32 | Train Loss: 50.622 Vali Loss: 80.571 Vali Acc: 0.115 Test Loss: 80.571 Test Acc: 0.115
Validation loss decreased (inf --> -0.113698).  Saving model ...
Epoch: 2 cost time: 537.0538370609283
Epoch: 2, Steps: 32 | Train Loss: 44.101 Vali Loss: 141.005 Vali Acc: 0.458 Test Loss: 141.005 Test Acc: 0.458
Validation loss decreased (-0.113698 --> -0.456605).  Saving model ...
Epoch: 3 cost time: 530.9277362823486
Epoch: 3, Steps: 32 | Train Loss: 43.909 Vali Loss: 210.187 Vali Acc: 0.481 Test Loss: 210.187 Test Acc: 0.481
Validation loss decreased (-0.456605 --> -0.478814).  Saving model ...
Epoch: 4 cost time: 545.2694675922394
Epoch: 4, Steps: 32 | Train Loss: 35.233 Vali Loss: 213.609 Vali Acc: 0.366 Test Loss: 213.609 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 557.221715927124
Epoch: 5, Steps: 32 | Train Loss: 26.251 Vali Loss: 465.794 Vali Acc: 0.458 Test Loss: 465.794 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 549.6989612579346
Epoch: 6, Steps: 32 | Train Loss: 38.731 Vali Loss: 352.436 Vali Acc: 0.534 Test Loss: 352.436 Test Acc: 0.534
Validation loss decreased (-0.478814 --> -0.530827).  Saving model ...
Epoch: 7 cost time: 559.8159790039062
Epoch: 7, Steps: 32 | Train Loss: 11.983 Vali Loss: 393.157 Vali Acc: 0.237 Test Loss: 393.157 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 564.8811647891998
Epoch: 8, Steps: 32 | Train Loss: 24.142 Vali Loss: 368.362 Vali Acc: 0.374 Test Loss: 368.362 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 560.3394358158112
Epoch: 9, Steps: 32 | Train Loss: 20.236 Vali Loss: 510.499 Vali Acc: 0.496 Test Loss: 510.499 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 551.9722151756287
Epoch: 10, Steps: 32 | Train Loss: 71.682 Vali Loss: 456.641 Vali Acc: 0.481 Test Loss: 456.641 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 563.9721374511719
Epoch: 11, Steps: 32 | Train Loss: 4.600 Vali Loss: 392.836 Vali Acc: 0.466 Test Loss: 392.836 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 561.7461612224579
Epoch: 12, Steps: 32 | Train Loss: 29.608 Vali Loss: 637.481 Vali Acc: 0.496 Test Loss: 637.481 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 563.3575930595398
Epoch: 13, Steps: 32 | Train Loss: 18.406 Vali Loss: 536.989 Vali Acc: 0.550 Test Loss: 536.989 Test Acc: 0.550
Validation loss decreased (-0.530827 --> -0.544248).  Saving model ...
Epoch: 14 cost time: 555.3231773376465
Epoch: 14, Steps: 32 | Train Loss: 85.693 Vali Loss: 560.082 Vali Acc: 0.405 Test Loss: 560.082 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 551.4822735786438
Epoch: 15, Steps: 32 | Train Loss: 124.093 Vali Loss: 382.246 Vali Acc: 0.412 Test Loss: 382.246 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 568.2178180217743
Epoch: 16, Steps: 32 | Train Loss: 8.901 Vali Loss: 619.303 Vali Acc: 0.466 Test Loss: 619.303 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 560.4748256206512
Epoch: 17, Steps: 32 | Train Loss: 19.325 Vali Loss: 867.686 Vali Acc: 0.534 Test Loss: 867.686 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 565.5548226833344
Epoch: 18, Steps: 32 | Train Loss: 28.448 Vali Loss: 993.758 Vali Acc: 0.473 Test Loss: 993.758 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 560.3166465759277
Epoch: 19, Steps: 32 | Train Loss: 23.345 Vali Loss: 874.101 Vali Acc: 0.466 Test Loss: 874.101 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 569.2619488239288
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 1041.139 Vali Acc: 0.481 Test Loss: 1041.139 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 567.5401804447174
Epoch: 21, Steps: 32 | Train Loss: 0.421 Vali Loss: 958.037 Vali Acc: 0.504 Test Loss: 958.037 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 569.1893916130066
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 961.244 Vali Acc: 0.504 Test Loss: 961.244 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 569.0791735649109
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 961.382 Vali Acc: 0.504 Test Loss: 961.382 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma5396_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 59704837
model size : 298.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3597                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma3597_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 321.18142890930176
Epoch: 1, Steps: 32 | Train Loss: 63.432 Vali Loss: 55.758 Vali Acc: 0.511 Test Loss: 55.758 Test Acc: 0.511
Validation loss decreased (inf --> -0.510893).  Saving model ...
Epoch: 2 cost time: 349.4702558517456
Epoch: 2, Steps: 32 | Train Loss: 37.966 Vali Loss: 138.306 Vali Acc: 0.427 Test Loss: 138.306 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 365.7406566143036
Epoch: 3, Steps: 32 | Train Loss: 47.458 Vali Loss: 181.521 Vali Acc: 0.504 Test Loss: 181.521 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 372.5021822452545
Epoch: 4, Steps: 32 | Train Loss: 44.929 Vali Loss: 179.857 Vali Acc: 0.420 Test Loss: 179.857 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 380.5045733451843
Epoch: 5, Steps: 32 | Train Loss: 28.659 Vali Loss: 382.076 Vali Acc: 0.260 Test Loss: 382.076 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 373.8939354419708
Epoch: 6, Steps: 32 | Train Loss: 44.368 Vali Loss: 414.363 Vali Acc: 0.237 Test Loss: 414.363 Test Acc: 0.237
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 378.4567222595215
Epoch: 7, Steps: 32 | Train Loss: 36.327 Vali Loss: 403.685 Vali Acc: 0.542 Test Loss: 403.685 Test Acc: 0.542
Validation loss decreased (-0.510893 --> -0.537948).  Saving model ...
Epoch: 8 cost time: 386.93046712875366
Epoch: 8, Steps: 32 | Train Loss: 9.297 Vali Loss: 508.260 Vali Acc: 0.366 Test Loss: 508.260 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 385.7285170555115
Epoch: 9, Steps: 32 | Train Loss: 10.499 Vali Loss: 460.099 Vali Acc: 0.382 Test Loss: 460.099 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 379.43828654289246
Epoch: 10, Steps: 32 | Train Loss: 35.080 Vali Loss: 624.722 Vali Acc: 0.481 Test Loss: 624.722 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 379.00661540031433
Epoch: 11, Steps: 32 | Train Loss: 41.549 Vali Loss: 687.688 Vali Acc: 0.496 Test Loss: 687.688 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 382.9667444229126
Epoch: 12, Steps: 32 | Train Loss: 19.958 Vali Loss: 493.133 Vali Acc: 0.519 Test Loss: 493.133 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 385.34265899658203
Epoch: 13, Steps: 32 | Train Loss: 10.702 Vali Loss: 499.639 Vali Acc: 0.443 Test Loss: 499.639 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 380.3691523075104
Epoch: 14, Steps: 32 | Train Loss: 28.657 Vali Loss: 1029.428 Vali Acc: 0.489 Test Loss: 1029.428 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 378.79033279418945
Epoch: 15, Steps: 32 | Train Loss: 62.591 Vali Loss: 518.003 Vali Acc: 0.473 Test Loss: 518.003 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 388.0268998146057
Epoch: 16, Steps: 32 | Train Loss: 15.527 Vali Loss: 869.012 Vali Acc: 0.435 Test Loss: 869.012 Test Acc: 0.435
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 391.1024479866028
Epoch: 17, Steps: 32 | Train Loss: 0.973 Vali Loss: 996.805 Vali Acc: 0.435 Test Loss: 996.805 Test Acc: 0.435
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma3597_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 59704837
model size : 298.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1799                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 171.12828016281128
Epoch: 1, Steps: 32 | Train Loss: 42.030 Vali Loss: 71.574 Vali Acc: 0.443 Test Loss: 71.574 Test Acc: 0.443
Validation loss decreased (inf --> -0.442032).  Saving model ...
Epoch: 2 cost time: 198.43172645568848
Epoch: 2, Steps: 32 | Train Loss: 29.422 Vali Loss: 76.966 Vali Acc: 0.427 Test Loss: 76.966 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 201.6571500301361
Epoch: 3, Steps: 32 | Train Loss: 38.778 Vali Loss: 118.045 Vali Acc: 0.519 Test Loss: 118.045 Test Acc: 0.519
Validation loss decreased (-0.442032 --> -0.517904).  Saving model ...
Epoch: 4 cost time: 198.29636359214783
Epoch: 4, Steps: 32 | Train Loss: 32.269 Vali Loss: 155.794 Vali Acc: 0.427 Test Loss: 155.794 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 206.37671852111816
Epoch: 5, Steps: 32 | Train Loss: 18.243 Vali Loss: 289.073 Vali Acc: 0.267 Test Loss: 289.073 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 203.83469700813293
Epoch: 6, Steps: 32 | Train Loss: 40.101 Vali Loss: 283.967 Vali Acc: 0.481 Test Loss: 283.967 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 201.59949350357056
Epoch: 7, Steps: 32 | Train Loss: 92.758 Vali Loss: 360.391 Vali Acc: 0.557 Test Loss: 360.391 Test Acc: 0.557
Validation loss decreased (-0.517904 --> -0.553648).  Saving model ...
Epoch: 8 cost time: 206.27350616455078
Epoch: 8, Steps: 32 | Train Loss: 39.610 Vali Loss: 436.530 Vali Acc: 0.427 Test Loss: 436.530 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 210.03781962394714
Epoch: 9, Steps: 32 | Train Loss: 5.333 Vali Loss: 338.580 Vali Acc: 0.450 Test Loss: 338.580 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 205.31852626800537
Epoch: 10, Steps: 32 | Train Loss: 56.708 Vali Loss: 587.714 Vali Acc: 0.534 Test Loss: 587.714 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 207.8519926071167
Epoch: 11, Steps: 32 | Train Loss: 17.567 Vali Loss: 646.681 Vali Acc: 0.466 Test Loss: 646.681 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 208.9565703868866
Epoch: 12, Steps: 32 | Train Loss: 29.627 Vali Loss: 415.883 Vali Acc: 0.443 Test Loss: 415.883 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 209.10021257400513
Epoch: 13, Steps: 32 | Train Loss: 15.207 Vali Loss: 813.004 Vali Acc: 0.496 Test Loss: 813.004 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 207.10377407073975
Epoch: 14, Steps: 32 | Train Loss: 14.817 Vali Loss: 436.277 Vali Acc: 0.450 Test Loss: 436.277 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 208.45193004608154
Epoch: 15, Steps: 32 | Train Loss: 19.294 Vali Loss: 481.169 Vali Acc: 0.328 Test Loss: 481.169 Test Acc: 0.328
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 209.09886360168457
Epoch: 16, Steps: 32 | Train Loss: 5.455 Vali Loss: 580.692 Vali Acc: 0.427 Test Loss: 580.692 Test Acc: 0.427
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 210.29184770584106
Epoch: 17, Steps: 32 | Train Loss: 1.234 Vali Loss: 762.488 Vali Acc: 0.450 Test Loss: 762.488 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 59704837
model size : 298.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 92.5971941947937
Epoch: 1, Steps: 32 | Train Loss: 48.128 Vali Loss: 67.808 Vali Acc: 0.458 Test Loss: 67.808 Test Acc: 0.458
Validation loss decreased (inf --> -0.457337).  Saving model ...
Epoch: 2 cost time: 105.93289160728455
Epoch: 2, Steps: 32 | Train Loss: 34.341 Vali Loss: 129.833 Vali Acc: 0.412 Test Loss: 129.833 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 107.3399567604065
Epoch: 3, Steps: 32 | Train Loss: 55.521 Vali Loss: 310.617 Vali Acc: 0.496 Test Loss: 310.617 Test Acc: 0.496
Validation loss decreased (-0.457337 --> -0.493077).  Saving model ...
Epoch: 4 cost time: 109.94496178627014
Epoch: 4, Steps: 32 | Train Loss: 40.986 Vali Loss: 177.311 Vali Acc: 0.481 Test Loss: 177.311 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 110.53955554962158
Epoch: 5, Steps: 32 | Train Loss: 36.957 Vali Loss: 375.939 Vali Acc: 0.351 Test Loss: 375.939 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 112.27658772468567
Epoch: 6, Steps: 32 | Train Loss: 13.065 Vali Loss: 153.149 Vali Acc: 0.534 Test Loss: 153.149 Test Acc: 0.534
Validation loss decreased (-0.493077 --> -0.532820).  Saving model ...
Epoch: 7 cost time: 110.31653642654419
Epoch: 7, Steps: 32 | Train Loss: 41.643 Vali Loss: 339.722 Vali Acc: 0.527 Test Loss: 339.722 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 112.44217157363892
Epoch: 8, Steps: 32 | Train Loss: 29.033 Vali Loss: 367.204 Vali Acc: 0.298 Test Loss: 367.204 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 111.09042358398438
Epoch: 9, Steps: 32 | Train Loss: 41.872 Vali Loss: 627.526 Vali Acc: 0.466 Test Loss: 627.526 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 112.51185274124146
Epoch: 10, Steps: 32 | Train Loss: 21.667 Vali Loss: 495.190 Vali Acc: 0.450 Test Loss: 495.190 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 112.87340044975281
Epoch: 11, Steps: 32 | Train Loss: 11.208 Vali Loss: 392.762 Vali Acc: 0.511 Test Loss: 392.762 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 113.68600988388062
Epoch: 12, Steps: 32 | Train Loss: 7.809 Vali Loss: 478.306 Vali Acc: 0.458 Test Loss: 478.306 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 111.56615614891052
Epoch: 13, Steps: 32 | Train Loss: 19.345 Vali Loss: 797.872 Vali Acc: 0.534 Test Loss: 797.872 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 113.41561841964722
Epoch: 14, Steps: 32 | Train Loss: 18.578 Vali Loss: 489.285 Vali Acc: 0.557 Test Loss: 489.285 Test Acc: 0.557
Validation loss decreased (-0.532820 --> -0.552359).  Saving model ...
Epoch: 15 cost time: 112.46631455421448
Epoch: 15, Steps: 32 | Train Loss: 9.493 Vali Loss: 585.563 Vali Acc: 0.511 Test Loss: 585.563 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 113.02314186096191
Epoch: 16, Steps: 32 | Train Loss: 25.839 Vali Loss: 654.688 Vali Acc: 0.481 Test Loss: 654.688 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 113.67192840576172
Epoch: 17, Steps: 32 | Train Loss: 15.701 Vali Loss: 841.146 Vali Acc: 0.519 Test Loss: 841.146 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 112.5999493598938
Epoch: 18, Steps: 32 | Train Loss: 18.228 Vali Loss: 733.296 Vali Acc: 0.450 Test Loss: 733.296 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 111.72533178329468
Epoch: 19, Steps: 32 | Train Loss: 43.138 Vali Loss: 1038.314 Vali Acc: 0.260 Test Loss: 1038.314 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 111.95184540748596
Epoch: 20, Steps: 32 | Train Loss: 27.492 Vali Loss: 816.714 Vali Acc: 0.481 Test Loss: 816.714 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 111.85528588294983
Epoch: 21, Steps: 32 | Train Loss: 32.575 Vali Loss: 924.690 Vali Acc: 0.504 Test Loss: 924.690 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 112.6035590171814
Epoch: 22, Steps: 32 | Train Loss: 29.557 Vali Loss: 1247.964 Vali Acc: 0.511 Test Loss: 1247.964 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 113.02375888824463
Epoch: 23, Steps: 32 | Train Loss: 16.411 Vali Loss: 880.912 Vali Acc: 0.473 Test Loss: 880.912 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 113.77687096595764
Epoch: 24, Steps: 32 | Train Loss: 6.614 Vali Loss: 864.105 Vali Acc: 0.382 Test Loss: 864.105 Test Acc: 0.382
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 59704837
model size : 298.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         540                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma540_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 68.16687083244324
Epoch: 1, Steps: 32 | Train Loss: 39.170 Vali Loss: 35.631 Vali Acc: 0.374 Test Loss: 35.631 Test Acc: 0.374
Validation loss decreased (inf --> -0.373689).  Saving model ...
Epoch: 2 cost time: 75.61596941947937
Epoch: 2, Steps: 32 | Train Loss: 42.784 Vali Loss: 103.910 Vali Acc: 0.481 Test Loss: 103.910 Test Acc: 0.481
Validation loss decreased (-0.373689 --> -0.479877).  Saving model ...
Epoch: 3 cost time: 76.56563687324524
Epoch: 3, Steps: 32 | Train Loss: 33.045 Vali Loss: 273.545 Vali Acc: 0.450 Test Loss: 273.545 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 77.99294400215149
Epoch: 4, Steps: 32 | Train Loss: 38.097 Vali Loss: 194.561 Vali Acc: 0.328 Test Loss: 194.561 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 79.59596395492554
Epoch: 5, Steps: 32 | Train Loss: 17.042 Vali Loss: 468.599 Vali Acc: 0.450 Test Loss: 468.599 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 79.07590556144714
Epoch: 6, Steps: 32 | Train Loss: 36.259 Vali Loss: 389.770 Vali Acc: 0.313 Test Loss: 389.770 Test Acc: 0.313
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 78.30281972885132
Epoch: 7, Steps: 32 | Train Loss: 54.576 Vali Loss: 296.329 Vali Acc: 0.435 Test Loss: 296.329 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 79.00815153121948
Epoch: 8, Steps: 32 | Train Loss: 32.230 Vali Loss: 331.552 Vali Acc: 0.427 Test Loss: 331.552 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 80.08179926872253
Epoch: 9, Steps: 32 | Train Loss: 40.279 Vali Loss: 428.616 Vali Acc: 0.458 Test Loss: 428.616 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 80.7406051158905
Epoch: 10, Steps: 32 | Train Loss: 8.659 Vali Loss: 634.303 Vali Acc: 0.481 Test Loss: 634.303 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 80.36425709724426
Epoch: 11, Steps: 32 | Train Loss: 14.543 Vali Loss: 614.455 Vali Acc: 0.527 Test Loss: 614.455 Test Acc: 0.527
Validation loss decreased (-0.479877 --> -0.520573).  Saving model ...
Epoch: 12 cost time: 79.95530462265015
Epoch: 12, Steps: 32 | Train Loss: 3.298 Vali Loss: 547.727 Vali Acc: 0.542 Test Loss: 547.727 Test Acc: 0.542
Validation loss decreased (-0.520573 --> -0.536507).  Saving model ...
Epoch: 13 cost time: 80.93963813781738
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 720.802 Vali Acc: 0.496 Test Loss: 720.802 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 81.16132855415344
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 728.669 Vali Acc: 0.489 Test Loss: 728.669 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 81.21226811408997
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 728.963 Vali Acc: 0.489 Test Loss: 728.963 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 81.04901123046875
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 728.974 Vali Acc: 0.489 Test Loss: 728.974 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 81.37738919258118
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 728.974 Vali Acc: 0.489 Test Loss: 728.974 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 80.92903113365173
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 728.974 Vali Acc: 0.489 Test Loss: 728.974 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 81.1696424484253
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 728.974 Vali Acc: 0.489 Test Loss: 728.974 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 80.97485661506653
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 728.974 Vali Acc: 0.489 Test Loss: 728.974 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 81.01556253433228
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 728.974 Vali Acc: 0.489 Test Loss: 728.974 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 81.06737661361694
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 728.974 Vali Acc: 0.489 Test Loss: 728.974 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma540_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 59704837
model size : 298.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 56.40716004371643
Epoch: 1, Steps: 32 | Train Loss: 42.998 Vali Loss: 64.505 Vali Acc: 0.366 Test Loss: 64.505 Test Acc: 0.366
Validation loss decreased (inf --> -0.365767).  Saving model ...
Epoch: 2 cost time: 60.63099431991577
Epoch: 2, Steps: 32 | Train Loss: 48.259 Vali Loss: 132.938 Vali Acc: 0.511 Test Loss: 132.938 Test Acc: 0.511
Validation loss decreased (-0.365767 --> -0.510121).  Saving model ...
Epoch: 3 cost time: 61.54166889190674
Epoch: 3, Steps: 32 | Train Loss: 51.383 Vali Loss: 290.603 Vali Acc: 0.496 Test Loss: 290.603 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 63.18765568733215
Epoch: 4, Steps: 32 | Train Loss: 52.502 Vali Loss: 284.431 Vali Acc: 0.374 Test Loss: 284.431 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 64.10540461540222
Epoch: 5, Steps: 32 | Train Loss: 10.473 Vali Loss: 228.639 Vali Acc: 0.443 Test Loss: 228.639 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 63.379788398742676
Epoch: 6, Steps: 32 | Train Loss: 21.374 Vali Loss: 349.961 Vali Acc: 0.519 Test Loss: 349.961 Test Acc: 0.519
Validation loss decreased (-0.510121 --> -0.515584).  Saving model ...
Epoch: 7 cost time: 63.20314598083496
Epoch: 7, Steps: 32 | Train Loss: 22.992 Vali Loss: 210.125 Vali Acc: 0.382 Test Loss: 210.125 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 63.758880853652954
Epoch: 8, Steps: 32 | Train Loss: 18.476 Vali Loss: 322.072 Vali Acc: 0.366 Test Loss: 322.072 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 63.82407474517822
Epoch: 9, Steps: 32 | Train Loss: 19.672 Vali Loss: 890.445 Vali Acc: 0.466 Test Loss: 890.445 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 63.680715560913086
Epoch: 10, Steps: 32 | Train Loss: 22.720 Vali Loss: 602.204 Vali Acc: 0.496 Test Loss: 602.204 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 63.96837878227234
Epoch: 11, Steps: 32 | Train Loss: 20.202 Vali Loss: 431.498 Vali Acc: 0.389 Test Loss: 431.498 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 63.165090799331665
Epoch: 12, Steps: 32 | Train Loss: 48.551 Vali Loss: 695.808 Vali Acc: 0.489 Test Loss: 695.808 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 62.98323607444763
Epoch: 13, Steps: 32 | Train Loss: 65.613 Vali Loss: 492.763 Vali Acc: 0.420 Test Loss: 492.763 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 64.29807806015015
Epoch: 14, Steps: 32 | Train Loss: 10.441 Vali Loss: 612.417 Vali Acc: 0.389 Test Loss: 612.417 Test Acc: 0.389
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 64.43881607055664
Epoch: 15, Steps: 32 | Train Loss: 1.879 Vali Loss: 1021.917 Vali Acc: 0.504 Test Loss: 1021.917 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 64.52072787284851
Epoch: 16, Steps: 32 | Train Loss: 12.576 Vali Loss: 747.860 Vali Acc: 0.412 Test Loss: 747.860 Test Acc: 0.412
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 59704837
model size : 298.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 45.23269033432007
Epoch: 1, Steps: 32 | Train Loss: 37.311 Vali Loss: 69.057 Vali Acc: 0.389 Test Loss: 69.057 Test Acc: 0.389
Validation loss decreased (inf --> -0.388622).  Saving model ...
Epoch: 2 cost time: 46.76725912094116
Epoch: 2, Steps: 32 | Train Loss: 33.886 Vali Loss: 88.172 Vali Acc: 0.435 Test Loss: 88.172 Test Acc: 0.435
Validation loss decreased (-0.388622 --> -0.434233).  Saving model ...
Epoch: 3 cost time: 46.22145986557007
Epoch: 3, Steps: 32 | Train Loss: 49.365 Vali Loss: 239.173 Vali Acc: 0.466 Test Loss: 239.173 Test Acc: 0.466
Validation loss decreased (-0.434233 --> -0.463257).  Saving model ...
Epoch: 4 cost time: 47.21094608306885
Epoch: 4, Steps: 32 | Train Loss: 44.734 Vali Loss: 189.144 Vali Acc: 0.374 Test Loss: 189.144 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 47.83593511581421
Epoch: 5, Steps: 32 | Train Loss: 18.791 Vali Loss: 377.690 Vali Acc: 0.473 Test Loss: 377.690 Test Acc: 0.473
Validation loss decreased (-0.463257 --> -0.469506).  Saving model ...
Epoch: 6 cost time: 47.4251024723053
Epoch: 6, Steps: 32 | Train Loss: 40.820 Vali Loss: 144.447 Vali Acc: 0.435 Test Loss: 144.447 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 47.501558780670166
Epoch: 7, Steps: 32 | Train Loss: 31.547 Vali Loss: 314.502 Vali Acc: 0.489 Test Loss: 314.502 Test Acc: 0.489
Validation loss decreased (-0.469506 --> -0.485405).  Saving model ...
Epoch: 8 cost time: 47.45582175254822
Epoch: 8, Steps: 32 | Train Loss: 33.787 Vali Loss: 380.704 Vali Acc: 0.527 Test Loss: 380.704 Test Acc: 0.527
Validation loss decreased (-0.485405 --> -0.522911).  Saving model ...
Epoch: 9 cost time: 47.66285252571106
Epoch: 9, Steps: 32 | Train Loss: 7.702 Vali Loss: 335.341 Vali Acc: 0.496 Test Loss: 335.341 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 48.26317477226257
Epoch: 10, Steps: 32 | Train Loss: 2.866 Vali Loss: 492.874 Vali Acc: 0.252 Test Loss: 492.874 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 47.83558702468872
Epoch: 11, Steps: 32 | Train Loss: 5.055 Vali Loss: 370.950 Vali Acc: 0.412 Test Loss: 370.950 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 47.98040533065796
Epoch: 12, Steps: 32 | Train Loss: 4.375 Vali Loss: 420.256 Vali Acc: 0.489 Test Loss: 420.256 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 47.90321660041809
Epoch: 13, Steps: 32 | Train Loss: 15.557 Vali Loss: 546.083 Vali Acc: 0.511 Test Loss: 546.083 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 48.21738123893738
Epoch: 14, Steps: 32 | Train Loss: 14.886 Vali Loss: 443.387 Vali Acc: 0.374 Test Loss: 443.387 Test Acc: 0.374
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 47.77512550354004
Epoch: 15, Steps: 32 | Train Loss: 25.714 Vali Loss: 426.524 Vali Acc: 0.351 Test Loss: 426.524 Test Acc: 0.351
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 47.675315141677856
Epoch: 16, Steps: 32 | Train Loss: 44.287 Vali Loss: 732.373 Vali Acc: 0.435 Test Loss: 732.373 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 47.61989760398865
Epoch: 17, Steps: 32 | Train Loss: 74.205 Vali Loss: 692.799 Vali Acc: 0.305 Test Loss: 692.799 Test Acc: 0.305
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 47.85379719734192
Epoch: 18, Steps: 32 | Train Loss: 44.923 Vali Loss: 696.333 Vali Acc: 0.473 Test Loss: 696.333 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 59704837
model size : 298.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 38.87274146080017
Epoch: 1, Steps: 32 | Train Loss: 28.016 Vali Loss: 71.474 Vali Acc: 0.321 Test Loss: 71.474 Test Acc: 0.321
Validation loss decreased (inf --> -0.319896).  Saving model ...
Epoch: 2 cost time: 39.289896726608276
Epoch: 2, Steps: 32 | Train Loss: 36.411 Vali Loss: 77.227 Vali Acc: 0.481 Test Loss: 77.227 Test Acc: 0.481
Validation loss decreased (-0.319896 --> -0.480144).  Saving model ...
Epoch: 3 cost time: 39.45859670639038
Epoch: 3, Steps: 32 | Train Loss: 40.817 Vali Loss: 195.277 Vali Acc: 0.466 Test Loss: 195.277 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 39.64874219894409
Epoch: 4, Steps: 32 | Train Loss: 33.788 Vali Loss: 140.359 Vali Acc: 0.450 Test Loss: 140.359 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 39.70125699043274
Epoch: 5, Steps: 32 | Train Loss: 36.172 Vali Loss: 189.097 Vali Acc: 0.405 Test Loss: 189.097 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 39.60710263252258
Epoch: 6, Steps: 32 | Train Loss: 25.821 Vali Loss: 108.147 Vali Acc: 0.557 Test Loss: 108.147 Test Acc: 0.557
Validation loss decreased (-0.480144 --> -0.556170).  Saving model ...
Epoch: 7 cost time: 39.724929094314575
Epoch: 7, Steps: 32 | Train Loss: 11.479 Vali Loss: 145.794 Vali Acc: 0.473 Test Loss: 145.794 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 39.45467138290405
Epoch: 8, Steps: 32 | Train Loss: 57.157 Vali Loss: 322.686 Vali Acc: 0.328 Test Loss: 322.686 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 39.93948030471802
Epoch: 9, Steps: 32 | Train Loss: 19.363 Vali Loss: 233.494 Vali Acc: 0.534 Test Loss: 233.494 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 39.68185901641846
Epoch: 10, Steps: 32 | Train Loss: 37.408 Vali Loss: 330.945 Vali Acc: 0.321 Test Loss: 330.945 Test Acc: 0.321
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 39.80543351173401
Epoch: 11, Steps: 32 | Train Loss: 5.830 Vali Loss: 247.839 Vali Acc: 0.565 Test Loss: 247.839 Test Acc: 0.565
Validation loss decreased (-0.556170 --> -0.562407).  Saving model ...
Epoch: 12 cost time: 39.77861666679382
Epoch: 12, Steps: 32 | Train Loss: 5.998 Vali Loss: 223.889 Vali Acc: 0.450 Test Loss: 223.889 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 39.87774419784546
Epoch: 13, Steps: 32 | Train Loss: 2.006 Vali Loss: 164.276 Vali Acc: 0.580 Test Loss: 164.276 Test Acc: 0.580
Validation loss decreased (-0.562407 --> -0.578510).  Saving model ...
Epoch: 14 cost time: 39.76968002319336
Epoch: 14, Steps: 32 | Train Loss: 7.353 Vali Loss: 284.204 Vali Acc: 0.496 Test Loss: 284.204 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 39.69884634017944
Epoch: 15, Steps: 32 | Train Loss: 8.134 Vali Loss: 281.365 Vali Acc: 0.519 Test Loss: 281.365 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 40.0419499874115
Epoch: 16, Steps: 32 | Train Loss: 26.298 Vali Loss: 441.997 Vali Acc: 0.481 Test Loss: 441.997 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 39.59091925621033
Epoch: 17, Steps: 32 | Train Loss: 63.979 Vali Loss: 529.250 Vali Acc: 0.496 Test Loss: 529.250 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 39.53123950958252
Epoch: 18, Steps: 32 | Train Loss: 140.222 Vali Loss: 872.393 Vali Acc: 0.336 Test Loss: 872.393 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 39.46994233131409
Epoch: 19, Steps: 32 | Train Loss: 61.116 Vali Loss: 359.342 Vali Acc: 0.519 Test Loss: 359.342 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 39.88539242744446
Epoch: 20, Steps: 32 | Train Loss: 33.008 Vali Loss: 539.622 Vali Acc: 0.573 Test Loss: 539.622 Test Acc: 0.573
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 40.02486872673035
Epoch: 21, Steps: 32 | Train Loss: 3.161 Vali Loss: 486.180 Vali Acc: 0.565 Test Loss: 486.180 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 39.90683388710022
Epoch: 22, Steps: 32 | Train Loss: 23.870 Vali Loss: 751.309 Vali Acc: 0.382 Test Loss: 751.309 Test Acc: 0.382
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 39.671448945999146
Epoch: 23, Steps: 32 | Train Loss: 93.396 Vali Loss: 845.787 Vali Acc: 0.496 Test Loss: 845.787 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df1024_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 59704837
model size : 298.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         8992                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df512_ma8992_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 728.8118839263916
Epoch: 1, Steps: 32 | Train Loss: 38.131 Vali Loss: 102.165 Vali Acc: 0.450 Test Loss: 102.165 Test Acc: 0.450
Validation loss decreased (inf --> -0.449360).  Saving model ...
Epoch: 2 cost time: 824.1997625827789
Epoch: 2, Steps: 32 | Train Loss: 30.585 Vali Loss: 89.419 Vali Acc: 0.282 Test Loss: 89.419 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 886.2872684001923
Epoch: 3, Steps: 32 | Train Loss: 37.879 Vali Loss: 171.825 Vali Acc: 0.374 Test Loss: 171.825 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 879.7530546188354
Epoch: 4, Steps: 32 | Train Loss: 44.972 Vali Loss: 266.577 Vali Acc: 0.527 Test Loss: 266.577 Test Acc: 0.527
Validation loss decreased (-0.449360 --> -0.524052).  Saving model ...
Epoch: 5 cost time: 913.1002862453461
Epoch: 5, Steps: 32 | Train Loss: 23.031 Vali Loss: 208.743 Vali Acc: 0.550 Test Loss: 208.743 Test Acc: 0.550
Validation loss decreased (-0.524052 --> -0.547531).  Saving model ...
Epoch: 6 cost time: 882.61372590065
Epoch: 6, Steps: 32 | Train Loss: 41.360 Vali Loss: 422.652 Vali Acc: 0.351 Test Loss: 422.652 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 904.2120532989502
Epoch: 7, Steps: 32 | Train Loss: 38.063 Vali Loss: 310.408 Vali Acc: 0.359 Test Loss: 310.408 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 898.4635853767395
Epoch: 8, Steps: 32 | Train Loss: 38.537 Vali Loss: 356.817 Vali Acc: 0.542 Test Loss: 356.817 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 915.403660774231
Epoch: 9, Steps: 32 | Train Loss: 19.516 Vali Loss: 330.599 Vali Acc: 0.534 Test Loss: 330.599 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 930.1852095127106
Epoch: 10, Steps: 32 | Train Loss: 6.856 Vali Loss: 562.879 Vali Acc: 0.344 Test Loss: 562.879 Test Acc: 0.344
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 899.9585249423981
Epoch: 11, Steps: 32 | Train Loss: 44.989 Vali Loss: 755.285 Vali Acc: 0.496 Test Loss: 755.285 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 907.8028724193573
Epoch: 12, Steps: 32 | Train Loss: 25.934 Vali Loss: 630.659 Vali Acc: 0.519 Test Loss: 630.659 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 901.6937007904053
Epoch: 13, Steps: 32 | Train Loss: 34.266 Vali Loss: 544.935 Vali Acc: 0.527 Test Loss: 544.935 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 918.761155128479
Epoch: 14, Steps: 32 | Train Loss: 11.680 Vali Loss: 626.630 Vali Acc: 0.412 Test Loss: 626.630 Test Acc: 0.412
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 907.2179870605469
Epoch: 15, Steps: 32 | Train Loss: 22.096 Vali Loss: 697.779 Vali Acc: 0.504 Test Loss: 697.779 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df512_ma8992_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 58131973
model size : 292.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         7194                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df512_ma7194_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 580.7279334068298
Epoch: 1, Steps: 32 | Train Loss: 32.542 Vali Loss: 76.841 Vali Acc: 0.496 Test Loss: 76.841 Test Acc: 0.496
Validation loss decreased (inf --> -0.495415).  Saving model ...
Epoch: 2 cost time: 691.190511226654
Epoch: 2, Steps: 32 | Train Loss: 40.107 Vali Loss: 50.458 Vali Acc: 0.534 Test Loss: 50.458 Test Acc: 0.534
Validation loss decreased (-0.495415 --> -0.533847).  Saving model ...
Epoch: 3 cost time: 707.9818570613861
Epoch: 3, Steps: 32 | Train Loss: 31.656 Vali Loss: 128.815 Vali Acc: 0.382 Test Loss: 128.815 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 720.0973422527313
Epoch: 4, Steps: 32 | Train Loss: 57.551 Vali Loss: 160.375 Vali Acc: 0.527 Test Loss: 160.375 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 725.490882396698
Epoch: 5, Steps: 32 | Train Loss: 23.318 Vali Loss: 225.703 Vali Acc: 0.412 Test Loss: 225.703 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 733.2632749080658
Epoch: 6, Steps: 32 | Train Loss: 16.671 Vali Loss: 343.540 Vali Acc: 0.511 Test Loss: 343.540 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 734.4726300239563
Epoch: 7, Steps: 32 | Train Loss: 8.016 Vali Loss: 247.779 Vali Acc: 0.504 Test Loss: 247.779 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 736.7659318447113
Epoch: 8, Steps: 32 | Train Loss: 6.874 Vali Loss: 366.019 Vali Acc: 0.511 Test Loss: 366.019 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 727.4051733016968
Epoch: 9, Steps: 32 | Train Loss: 16.927 Vali Loss: 297.626 Vali Acc: 0.542 Test Loss: 297.626 Test Acc: 0.542
Validation loss decreased (-0.533847 --> -0.539008).  Saving model ...
Epoch: 10 cost time: 738.6445937156677
Epoch: 10, Steps: 32 | Train Loss: 19.593 Vali Loss: 413.622 Vali Acc: 0.206 Test Loss: 413.622 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 727.162903547287
Epoch: 11, Steps: 32 | Train Loss: 48.807 Vali Loss: 710.617 Vali Acc: 0.511 Test Loss: 710.617 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 725.4285752773285
Epoch: 12, Steps: 32 | Train Loss: 77.713 Vali Loss: 753.346 Vali Acc: 0.366 Test Loss: 753.346 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 732.8870658874512
Epoch: 13, Steps: 32 | Train Loss: 26.108 Vali Loss: 640.168 Vali Acc: 0.481 Test Loss: 640.168 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 738.3773813247681
Epoch: 14, Steps: 32 | Train Loss: 22.743 Vali Loss: 611.459 Vali Acc: 0.359 Test Loss: 611.459 Test Acc: 0.359
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 740.6774168014526
Epoch: 15, Steps: 32 | Train Loss: 9.440 Vali Loss: 814.394 Vali Acc: 0.344 Test Loss: 814.394 Test Acc: 0.344
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 735.0581378936768
Epoch: 16, Steps: 32 | Train Loss: 41.374 Vali Loss: 780.841 Vali Acc: 0.473 Test Loss: 780.841 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 736.3732664585114
Epoch: 17, Steps: 32 | Train Loss: 37.501 Vali Loss: 880.259 Vali Acc: 0.427 Test Loss: 880.259 Test Acc: 0.427
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 744.446671962738
Epoch: 18, Steps: 32 | Train Loss: 15.406 Vali Loss: 493.247 Vali Acc: 0.542 Test Loss: 493.247 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 740.9110240936279
Epoch: 19, Steps: 32 | Train Loss: 9.522 Vali Loss: 696.016 Vali Acc: 0.412 Test Loss: 696.016 Test Acc: 0.412
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df512_ma7194_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 58131973
model size : 292.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5396                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df512_ma5396_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 442.403201341629
Epoch: 1, Steps: 32 | Train Loss: 47.873 Vali Loss: 106.086 Vali Acc: 0.473 Test Loss: 106.086 Test Acc: 0.473
Validation loss decreased (inf --> -0.472222).  Saving model ...
Epoch: 2 cost time: 517.8367445468903
Epoch: 2, Steps: 32 | Train Loss: 54.176 Vali Loss: 108.611 Vali Acc: 0.198 Test Loss: 108.611 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 547.3226850032806
Epoch: 3, Steps: 32 | Train Loss: 44.264 Vali Loss: 154.005 Vali Acc: 0.290 Test Loss: 154.005 Test Acc: 0.290
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 548.0284550189972
Epoch: 4, Steps: 32 | Train Loss: 35.906 Vali Loss: 303.452 Vali Acc: 0.489 Test Loss: 303.452 Test Acc: 0.489
Validation loss decreased (-0.472222 --> -0.485515).  Saving model ...
Epoch: 5 cost time: 541.6223289966583
Epoch: 5, Steps: 32 | Train Loss: 43.485 Vali Loss: 285.327 Vali Acc: 0.565 Test Loss: 285.327 Test Acc: 0.565
Validation loss decreased (-0.485515 --> -0.562032).  Saving model ...
Epoch: 6 cost time: 549.1344330310822
Epoch: 6, Steps: 32 | Train Loss: 53.961 Vali Loss: 275.989 Vali Acc: 0.489 Test Loss: 275.989 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 552.3533561229706
Epoch: 7, Steps: 32 | Train Loss: 45.991 Vali Loss: 431.641 Vali Acc: 0.305 Test Loss: 431.641 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 557.6914687156677
Epoch: 8, Steps: 32 | Train Loss: 20.972 Vali Loss: 423.678 Vali Acc: 0.458 Test Loss: 423.678 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 552.8864233493805
Epoch: 9, Steps: 32 | Train Loss: 19.365 Vali Loss: 651.599 Vali Acc: 0.206 Test Loss: 651.599 Test Acc: 0.206
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 560.9254262447357
Epoch: 10, Steps: 32 | Train Loss: 24.481 Vali Loss: 400.454 Vali Acc: 0.420 Test Loss: 400.454 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 564.2319719791412
Epoch: 11, Steps: 32 | Train Loss: 6.508 Vali Loss: 564.535 Vali Acc: 0.527 Test Loss: 564.535 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 558.4538028240204
Epoch: 12, Steps: 32 | Train Loss: 21.317 Vali Loss: 787.041 Vali Acc: 0.527 Test Loss: 787.041 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 557.3969738483429
Epoch: 13, Steps: 32 | Train Loss: 15.627 Vali Loss: 554.564 Vali Acc: 0.305 Test Loss: 554.564 Test Acc: 0.305
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 562.9572336673737
Epoch: 14, Steps: 32 | Train Loss: 7.733 Vali Loss: 637.435 Vali Acc: 0.511 Test Loss: 637.435 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 558.6425457000732
Epoch: 15, Steps: 32 | Train Loss: 18.612 Vali Loss: 612.500 Vali Acc: 0.298 Test Loss: 612.500 Test Acc: 0.298
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df512_ma5396_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 58131973
model size : 292.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3597                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df512_ma3597_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 310.341605424881
Epoch: 1, Steps: 32 | Train Loss: 33.339 Vali Loss: 57.362 Vali Acc: 0.282 Test Loss: 57.362 Test Acc: 0.282
Validation loss decreased (inf --> -0.281869).  Saving model ...
Epoch: 2 cost time: 346.2928922176361
Epoch: 2, Steps: 32 | Train Loss: 55.192 Vali Loss: 96.157 Vali Acc: 0.321 Test Loss: 96.157 Test Acc: 0.321
Validation loss decreased (-0.281869 --> -0.319649).  Saving model ...
Epoch: 3 cost time: 368.7263126373291
Epoch: 3, Steps: 32 | Train Loss: 19.471 Vali Loss: 121.391 Vali Acc: 0.466 Test Loss: 121.391 Test Acc: 0.466
Validation loss decreased (-0.319649 --> -0.464435).  Saving model ...
Epoch: 4 cost time: 370.4292359352112
Epoch: 4, Steps: 32 | Train Loss: 39.386 Vali Loss: 317.385 Vali Acc: 0.473 Test Loss: 317.385 Test Acc: 0.473
Validation loss decreased (-0.464435 --> -0.470109).  Saving model ...
Epoch: 5 cost time: 366.76425552368164
Epoch: 5, Steps: 32 | Train Loss: 46.074 Vali Loss: 224.924 Vali Acc: 0.481 Test Loss: 224.924 Test Acc: 0.481
Validation loss decreased (-0.470109 --> -0.478667).  Saving model ...
Epoch: 6 cost time: 375.31312918663025
Epoch: 6, Steps: 32 | Train Loss: 23.420 Vali Loss: 375.001 Vali Acc: 0.244 Test Loss: 375.001 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 375.6820640563965
Epoch: 7, Steps: 32 | Train Loss: 52.651 Vali Loss: 365.328 Vali Acc: 0.473 Test Loss: 365.328 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 380.81403064727783
Epoch: 8, Steps: 32 | Train Loss: 14.524 Vali Loss: 301.187 Vali Acc: 0.519 Test Loss: 301.187 Test Acc: 0.519
Validation loss decreased (-0.478667 --> -0.516072).  Saving model ...
Epoch: 9 cost time: 382.8037860393524
Epoch: 9, Steps: 32 | Train Loss: 15.348 Vali Loss: 398.217 Vali Acc: 0.466 Test Loss: 398.217 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 377.05570936203003
Epoch: 10, Steps: 32 | Train Loss: 18.318 Vali Loss: 459.115 Vali Acc: 0.481 Test Loss: 459.115 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 377.76444602012634
Epoch: 11, Steps: 32 | Train Loss: 26.400 Vali Loss: 507.947 Vali Acc: 0.275 Test Loss: 507.947 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 379.76518535614014
Epoch: 12, Steps: 32 | Train Loss: 13.282 Vali Loss: 473.748 Vali Acc: 0.481 Test Loss: 473.748 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 379.50818705558777
Epoch: 13, Steps: 32 | Train Loss: 25.943 Vali Loss: 488.197 Vali Acc: 0.473 Test Loss: 488.197 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 379.2627968788147
Epoch: 14, Steps: 32 | Train Loss: 42.252 Vali Loss: 565.199 Vali Acc: 0.504 Test Loss: 565.199 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 381.8715076446533
Epoch: 15, Steps: 32 | Train Loss: 7.913 Vali Loss: 562.953 Vali Acc: 0.420 Test Loss: 562.953 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 382.15124130249023
Epoch: 16, Steps: 32 | Train Loss: 7.602 Vali Loss: 514.726 Vali Acc: 0.443 Test Loss: 514.726 Test Acc: 0.443
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 382.57424235343933
Epoch: 17, Steps: 32 | Train Loss: 4.158 Vali Loss: 717.810 Vali Acc: 0.511 Test Loss: 717.810 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 383.6447985172272
Epoch: 18, Steps: 32 | Train Loss: 15.734 Vali Loss: 569.242 Vali Acc: 0.481 Test Loss: 569.242 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df512_ma3597_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 58131973
model size : 292.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1799                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df512_ma1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 163.07314944267273
Epoch: 1, Steps: 32 | Train Loss: 30.667 Vali Loss: 23.132 Vali Acc: 0.344 Test Loss: 23.132 Test Acc: 0.344
Validation loss decreased (inf --> -0.343280).  Saving model ...
Epoch: 2 cost time: 192.51117587089539
Epoch: 2, Steps: 32 | Train Loss: 25.155 Vali Loss: 55.684 Vali Acc: 0.519 Test Loss: 55.684 Test Acc: 0.519
Validation loss decreased (-0.343280 --> -0.518527).  Saving model ...
Epoch: 3 cost time: 195.6865611076355
Epoch: 3, Steps: 32 | Train Loss: 39.639 Vali Loss: 142.556 Vali Acc: 0.519 Test Loss: 142.556 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 199.24004650115967
Epoch: 4, Steps: 32 | Train Loss: 23.047 Vali Loss: 221.977 Vali Acc: 0.542 Test Loss: 221.977 Test Acc: 0.542
Validation loss decreased (-0.518527 --> -0.539765).  Saving model ...
Epoch: 5 cost time: 198.58634233474731
Epoch: 5, Steps: 32 | Train Loss: 26.795 Vali Loss: 244.618 Vali Acc: 0.336 Test Loss: 244.618 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 199.6953408718109
Epoch: 6, Steps: 32 | Train Loss: 44.854 Vali Loss: 266.559 Vali Acc: 0.519 Test Loss: 266.559 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 202.63890719413757
Epoch: 7, Steps: 32 | Train Loss: 22.525 Vali Loss: 346.025 Vali Acc: 0.519 Test Loss: 346.025 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 202.69053196907043
Epoch: 8, Steps: 32 | Train Loss: 40.698 Vali Loss: 352.651 Vali Acc: 0.290 Test Loss: 352.651 Test Acc: 0.290
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 202.46386742591858
Epoch: 9, Steps: 32 | Train Loss: 68.442 Vali Loss: 452.225 Vali Acc: 0.450 Test Loss: 452.225 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 206.4705047607422
Epoch: 10, Steps: 32 | Train Loss: 10.386 Vali Loss: 524.916 Vali Acc: 0.290 Test Loss: 524.916 Test Acc: 0.290
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 202.7881202697754
Epoch: 11, Steps: 32 | Train Loss: 22.309 Vali Loss: 796.220 Vali Acc: 0.382 Test Loss: 796.220 Test Acc: 0.382
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 204.08479475975037
Epoch: 12, Steps: 32 | Train Loss: 35.317 Vali Loss: 650.112 Vali Acc: 0.504 Test Loss: 650.112 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 204.92516469955444
Epoch: 13, Steps: 32 | Train Loss: 7.690 Vali Loss: 555.295 Vali Acc: 0.466 Test Loss: 555.295 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 205.26824140548706
Epoch: 14, Steps: 32 | Train Loss: 13.204 Vali Loss: 757.567 Vali Acc: 0.489 Test Loss: 757.567 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df512_ma1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 58131973
model size : 292.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df512_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 89.71439862251282
Epoch: 1, Steps: 32 | Train Loss: 38.120 Vali Loss: 65.982 Vali Acc: 0.275 Test Loss: 65.982 Test Acc: 0.275
Validation loss decreased (inf --> -0.274149).  Saving model ...
Epoch: 2 cost time: 107.01240968704224
Epoch: 2, Steps: 32 | Train Loss: 23.774 Vali Loss: 64.751 Vali Acc: 0.511 Test Loss: 64.751 Test Acc: 0.511
Validation loss decreased (-0.274149 --> -0.510803).  Saving model ...
Epoch: 3 cost time: 102.4750292301178
Epoch: 3, Steps: 32 | Train Loss: 43.929 Vali Loss: 199.596 Vali Acc: 0.344 Test Loss: 199.596 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 106.02223634719849
Epoch: 4, Steps: 32 | Train Loss: 28.312 Vali Loss: 113.006 Vali Acc: 0.504 Test Loss: 113.006 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 107.46188807487488
Epoch: 5, Steps: 32 | Train Loss: 37.784 Vali Loss: 394.465 Vali Acc: 0.504 Test Loss: 394.465 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 106.57688689231873
Epoch: 6, Steps: 32 | Train Loss: 56.395 Vali Loss: 271.776 Vali Acc: 0.542 Test Loss: 271.776 Test Acc: 0.542
Validation loss decreased (-0.510803 --> -0.539267).  Saving model ...
Epoch: 7 cost time: 107.9881911277771
Epoch: 7, Steps: 32 | Train Loss: 10.688 Vali Loss: 368.649 Vali Acc: 0.527 Test Loss: 368.649 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 110.36724066734314
Epoch: 8, Steps: 32 | Train Loss: 19.840 Vali Loss: 513.627 Vali Acc: 0.511 Test Loss: 513.627 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 108.47534537315369
Epoch: 9, Steps: 32 | Train Loss: 20.657 Vali Loss: 395.863 Vali Acc: 0.466 Test Loss: 395.863 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 108.45792770385742
Epoch: 10, Steps: 32 | Train Loss: 46.663 Vali Loss: 409.227 Vali Acc: 0.519 Test Loss: 409.227 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 108.41193103790283
Epoch: 11, Steps: 32 | Train Loss: 23.904 Vali Loss: 650.450 Vali Acc: 0.481 Test Loss: 650.450 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 109.7364194393158
Epoch: 12, Steps: 32 | Train Loss: 6.752 Vali Loss: 799.744 Vali Acc: 0.489 Test Loss: 799.744 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 108.88230681419373
Epoch: 13, Steps: 32 | Train Loss: 31.504 Vali Loss: 699.855 Vali Acc: 0.359 Test Loss: 699.855 Test Acc: 0.359
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 109.12427234649658
Epoch: 14, Steps: 32 | Train Loss: 23.105 Vali Loss: 555.317 Vali Acc: 0.458 Test Loss: 555.317 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 110.80098009109497
Epoch: 15, Steps: 32 | Train Loss: 24.843 Vali Loss: 834.183 Vali Acc: 0.282 Test Loss: 834.183 Test Acc: 0.282
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 109.08693385124207
Epoch: 16, Steps: 32 | Train Loss: 15.188 Vali Loss: 859.472 Vali Acc: 0.298 Test Loss: 859.472 Test Acc: 0.298
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df512_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 58131973
model size : 292.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         540                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df512_ma540_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 64.36542248725891
Epoch: 1, Steps: 32 | Train Loss: 29.509 Vali Loss: 45.034 Vali Acc: 0.382 Test Loss: 45.034 Test Acc: 0.382
Validation loss decreased (inf --> -0.381229).  Saving model ...
Epoch: 2 cost time: 72.49060106277466
Epoch: 2, Steps: 32 | Train Loss: 36.000 Vali Loss: 106.522 Vali Acc: 0.489 Test Loss: 106.522 Test Acc: 0.489
Validation loss decreased (-0.381229 --> -0.487484).  Saving model ...
Epoch: 3 cost time: 75.179274559021
Epoch: 3, Steps: 32 | Train Loss: 23.960 Vali Loss: 127.862 Vali Acc: 0.282 Test Loss: 127.862 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 76.84323906898499
Epoch: 4, Steps: 32 | Train Loss: 20.916 Vali Loss: 134.620 Vali Acc: 0.496 Test Loss: 134.620 Test Acc: 0.496
Validation loss decreased (-0.487484 --> -0.494837).  Saving model ...
Epoch: 5 cost time: 76.13097929954529
Epoch: 5, Steps: 32 | Train Loss: 21.836 Vali Loss: 201.768 Vali Acc: 0.473 Test Loss: 201.768 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 75.46237182617188
Epoch: 6, Steps: 32 | Train Loss: 44.732 Vali Loss: 371.220 Vali Acc: 0.366 Test Loss: 371.220 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 76.85526919364929
Epoch: 7, Steps: 32 | Train Loss: 28.561 Vali Loss: 317.246 Vali Acc: 0.397 Test Loss: 317.246 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 76.15399718284607
Epoch: 8, Steps: 32 | Train Loss: 28.518 Vali Loss: 291.955 Vali Acc: 0.427 Test Loss: 291.955 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 75.65828394889832
Epoch: 9, Steps: 32 | Train Loss: 92.637 Vali Loss: 732.509 Vali Acc: 0.290 Test Loss: 732.509 Test Acc: 0.290
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 76.52952218055725
Epoch: 10, Steps: 32 | Train Loss: 34.457 Vali Loss: 725.893 Vali Acc: 0.290 Test Loss: 725.893 Test Acc: 0.290
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 76.27496075630188
Epoch: 11, Steps: 32 | Train Loss: 48.467 Vali Loss: 520.877 Vali Acc: 0.366 Test Loss: 520.877 Test Acc: 0.366
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 77.55499124526978
Epoch: 12, Steps: 32 | Train Loss: 6.315 Vali Loss: 656.260 Vali Acc: 0.511 Test Loss: 656.260 Test Acc: 0.511
Validation loss decreased (-0.494837 --> -0.504888).  Saving model ...
Epoch: 13 cost time: 77.19738602638245
Epoch: 13, Steps: 32 | Train Loss: 3.980 Vali Loss: 575.330 Vali Acc: 0.450 Test Loss: 575.330 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 77.7348530292511
Epoch: 14, Steps: 32 | Train Loss: 1.806 Vali Loss: 696.317 Vali Acc: 0.443 Test Loss: 696.317 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 77.71726775169373
Epoch: 15, Steps: 32 | Train Loss: 3.067 Vali Loss: 488.879 Vali Acc: 0.328 Test Loss: 488.879 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 77.8017840385437
Epoch: 16, Steps: 32 | Train Loss: 2.971 Vali Loss: 726.018 Vali Acc: 0.496 Test Loss: 726.018 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 77.98557138442993
Epoch: 17, Steps: 32 | Train Loss: 1.126 Vali Loss: 505.647 Vali Acc: 0.351 Test Loss: 505.647 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 77.25326132774353
Epoch: 18, Steps: 32 | Train Loss: 16.160 Vali Loss: 700.834 Vali Acc: 0.504 Test Loss: 700.834 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 77.41106820106506
Epoch: 19, Steps: 32 | Train Loss: 23.074 Vali Loss: 842.372 Vali Acc: 0.458 Test Loss: 842.372 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 77.64860653877258
Epoch: 20, Steps: 32 | Train Loss: 4.742 Vali Loss: 757.238 Vali Acc: 0.351 Test Loss: 757.238 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 77.65062284469604
Epoch: 21, Steps: 32 | Train Loss: 10.106 Vali Loss: 689.487 Vali Acc: 0.458 Test Loss: 689.487 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 77.06058239936829
Epoch: 22, Steps: 32 | Train Loss: 29.654 Vali Loss: 983.917 Vali Acc: 0.397 Test Loss: 983.917 Test Acc: 0.397
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df512_ma540_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 58131973
model size : 292.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df512_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 52.9874792098999
Epoch: 1, Steps: 32 | Train Loss: 29.909 Vali Loss: 74.614 Vali Acc: 0.473 Test Loss: 74.614 Test Acc: 0.473
Validation loss decreased (inf --> -0.472536).  Saving model ...
Epoch: 2 cost time: 58.77739667892456
Epoch: 2, Steps: 32 | Train Loss: 34.300 Vali Loss: 140.922 Vali Acc: 0.458 Test Loss: 140.922 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 58.334818601608276
Epoch: 3, Steps: 32 | Train Loss: 60.989 Vali Loss: 137.379 Vali Acc: 0.527 Test Loss: 137.379 Test Acc: 0.527
Validation loss decreased (-0.472536 --> -0.525344).  Saving model ...
Epoch: 4 cost time: 59.43593907356262
Epoch: 4, Steps: 32 | Train Loss: 49.968 Vali Loss: 160.887 Vali Acc: 0.351 Test Loss: 160.887 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 60.893176317214966
Epoch: 5, Steps: 32 | Train Loss: 35.178 Vali Loss: 269.761 Vali Acc: 0.336 Test Loss: 269.761 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 60.55393981933594
Epoch: 6, Steps: 32 | Train Loss: 36.683 Vali Loss: 296.804 Vali Acc: 0.458 Test Loss: 296.804 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 61.33738684654236
Epoch: 7, Steps: 32 | Train Loss: 14.325 Vali Loss: 299.422 Vali Acc: 0.412 Test Loss: 299.422 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 60.87206983566284
Epoch: 8, Steps: 32 | Train Loss: 38.237 Vali Loss: 309.134 Vali Acc: 0.458 Test Loss: 309.134 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 61.3304967880249
Epoch: 9, Steps: 32 | Train Loss: 42.565 Vali Loss: 496.493 Vali Acc: 0.450 Test Loss: 496.493 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 61.163172483444214
Epoch: 10, Steps: 32 | Train Loss: 33.148 Vali Loss: 428.934 Vali Acc: 0.366 Test Loss: 428.934 Test Acc: 0.366
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 60.92143750190735
Epoch: 11, Steps: 32 | Train Loss: 26.898 Vali Loss: 470.217 Vali Acc: 0.450 Test Loss: 470.217 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 61.621746301651
Epoch: 12, Steps: 32 | Train Loss: 14.873 Vali Loss: 858.485 Vali Acc: 0.496 Test Loss: 858.485 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 61.109023094177246
Epoch: 13, Steps: 32 | Train Loss: 29.290 Vali Loss: 767.544 Vali Acc: 0.435 Test Loss: 767.544 Test Acc: 0.435
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df512_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 58131973
model size : 292.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df512_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 41.94556760787964
Epoch: 1, Steps: 32 | Train Loss: 25.567 Vali Loss: 74.940 Vali Acc: 0.443 Test Loss: 74.940 Test Acc: 0.443
Validation loss decreased (inf --> -0.441999).  Saving model ...
Epoch: 2 cost time: 43.055338859558105
Epoch: 2, Steps: 32 | Train Loss: 53.569 Vali Loss: 52.375 Vali Acc: 0.534 Test Loss: 52.375 Test Acc: 0.534
Validation loss decreased (-0.441999 --> -0.533827).  Saving model ...
Epoch: 3 cost time: 44.2368278503418
Epoch: 3, Steps: 32 | Train Loss: 32.255 Vali Loss: 90.368 Vali Acc: 0.496 Test Loss: 90.368 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 44.68456721305847
Epoch: 4, Steps: 32 | Train Loss: 40.193 Vali Loss: 219.630 Vali Acc: 0.511 Test Loss: 219.630 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 44.59511184692383
Epoch: 5, Steps: 32 | Train Loss: 67.404 Vali Loss: 160.782 Vali Acc: 0.435 Test Loss: 160.782 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 44.86804151535034
Epoch: 6, Steps: 32 | Train Loss: 61.979 Vali Loss: 291.400 Vali Acc: 0.420 Test Loss: 291.400 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 45.03008699417114
Epoch: 7, Steps: 32 | Train Loss: 47.396 Vali Loss: 295.224 Vali Acc: 0.550 Test Loss: 295.224 Test Acc: 0.550
Validation loss decreased (-0.533827 --> -0.546666).  Saving model ...
Epoch: 8 cost time: 44.88989233970642
Epoch: 8, Steps: 32 | Train Loss: 28.725 Vali Loss: 299.219 Vali Acc: 0.573 Test Loss: 299.219 Test Acc: 0.573
Validation loss decreased (-0.546666 --> -0.569527).  Saving model ...
Epoch: 9 cost time: 45.188329219818115
Epoch: 9, Steps: 32 | Train Loss: 12.701 Vali Loss: 244.841 Vali Acc: 0.481 Test Loss: 244.841 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 45.06962561607361
Epoch: 10, Steps: 32 | Train Loss: 18.681 Vali Loss: 397.103 Vali Acc: 0.527 Test Loss: 397.103 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 45.00016760826111
Epoch: 11, Steps: 32 | Train Loss: 13.317 Vali Loss: 500.132 Vali Acc: 0.519 Test Loss: 500.132 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 45.14038825035095
Epoch: 12, Steps: 32 | Train Loss: 14.546 Vali Loss: 781.920 Vali Acc: 0.489 Test Loss: 781.920 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 45.197160720825195
Epoch: 13, Steps: 32 | Train Loss: 17.013 Vali Loss: 410.797 Vali Acc: 0.504 Test Loss: 410.797 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 45.138585567474365
Epoch: 14, Steps: 32 | Train Loss: 10.995 Vali Loss: 504.313 Vali Acc: 0.450 Test Loss: 504.313 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 45.102739095687866
Epoch: 15, Steps: 32 | Train Loss: 19.618 Vali Loss: 343.500 Vali Acc: 0.458 Test Loss: 343.500 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 45.21350383758545
Epoch: 16, Steps: 32 | Train Loss: 38.700 Vali Loss: 519.399 Vali Acc: 0.443 Test Loss: 519.399 Test Acc: 0.443
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 45.208924293518066
Epoch: 17, Steps: 32 | Train Loss: 4.473 Vali Loss: 465.282 Vali Acc: 0.489 Test Loss: 465.282 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 45.541046142578125
Epoch: 18, Steps: 32 | Train Loss: 25.209 Vali Loss: 788.041 Vali Acc: 0.504 Test Loss: 788.041 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df512_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 58131973
model size : 292.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df512_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 36.09742188453674
Epoch: 1, Steps: 32 | Train Loss: 26.208 Vali Loss: 42.273 Vali Acc: 0.511 Test Loss: 42.273 Test Acc: 0.511
Validation loss decreased (inf --> -0.511028).  Saving model ...
Epoch: 2 cost time: 36.475388288497925
Epoch: 2, Steps: 32 | Train Loss: 36.391 Vali Loss: 66.803 Vali Acc: 0.359 Test Loss: 66.803 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 36.69219493865967
Epoch: 3, Steps: 32 | Train Loss: 42.504 Vali Loss: 89.904 Vali Acc: 0.550 Test Loss: 89.904 Test Acc: 0.550
Validation loss decreased (-0.511028 --> -0.548719).  Saving model ...
Epoch: 4 cost time: 37.225319623947144
Epoch: 4, Steps: 32 | Train Loss: 25.212 Vali Loss: 105.019 Vali Acc: 0.473 Test Loss: 105.019 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 36.94251871109009
Epoch: 5, Steps: 32 | Train Loss: 28.878 Vali Loss: 198.033 Vali Acc: 0.427 Test Loss: 198.033 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 37.16263508796692
Epoch: 6, Steps: 32 | Train Loss: 22.123 Vali Loss: 404.926 Vali Acc: 0.420 Test Loss: 404.926 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 37.28349184989929
Epoch: 7, Steps: 32 | Train Loss: 25.988 Vali Loss: 178.767 Vali Acc: 0.557 Test Loss: 178.767 Test Acc: 0.557
Validation loss decreased (-0.548719 --> -0.555464).  Saving model ...
Epoch: 8 cost time: 37.306357622146606
Epoch: 8, Steps: 32 | Train Loss: 29.358 Vali Loss: 231.035 Vali Acc: 0.557 Test Loss: 231.035 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 37.380279541015625
Epoch: 9, Steps: 32 | Train Loss: 29.749 Vali Loss: 304.687 Vali Acc: 0.466 Test Loss: 304.687 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 37.41355609893799
Epoch: 10, Steps: 32 | Train Loss: 10.873 Vali Loss: 490.835 Vali Acc: 0.405 Test Loss: 490.835 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 37.311320304870605
Epoch: 11, Steps: 32 | Train Loss: 32.457 Vali Loss: 310.749 Vali Acc: 0.420 Test Loss: 310.749 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 37.345805644989014
Epoch: 12, Steps: 32 | Train Loss: 52.909 Vali Loss: 416.300 Vali Acc: 0.519 Test Loss: 416.300 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 37.38997840881348
Epoch: 13, Steps: 32 | Train Loss: 45.010 Vali Loss: 537.702 Vali Acc: 0.489 Test Loss: 537.702 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 37.52510046958923
Epoch: 14, Steps: 32 | Train Loss: 2.691 Vali Loss: 487.019 Vali Acc: 0.511 Test Loss: 487.019 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 37.51718473434448
Epoch: 15, Steps: 32 | Train Loss: 25.348 Vali Loss: 395.555 Vali Acc: 0.489 Test Loss: 395.555 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 37.32773518562317
Epoch: 16, Steps: 32 | Train Loss: 13.344 Vali Loss: 393.604 Vali Acc: 0.397 Test Loss: 393.604 Test Acc: 0.397
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 37.44377303123474
Epoch: 17, Steps: 32 | Train Loss: 16.875 Vali Loss: 485.545 Vali Acc: 0.397 Test Loss: 485.545 Test Acc: 0.397
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df512_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 58131973
model size : 292.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         8992                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df256_ma8992_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 710.8304440975189
Epoch: 1, Steps: 32 | Train Loss: 49.515 Vali Loss: 140.571 Vali Acc: 0.214 Test Loss: 140.571 Test Acc: 0.214
Validation loss decreased (inf --> -0.212335).  Saving model ...
Epoch: 2 cost time: 844.9214165210724
Epoch: 2, Steps: 32 | Train Loss: 29.179 Vali Loss: 109.697 Vali Acc: 0.496 Test Loss: 109.697 Test Acc: 0.496
Validation loss decreased (-0.212335 --> -0.495086).  Saving model ...
Epoch: 3 cost time: 871.5061385631561
Epoch: 3, Steps: 32 | Train Loss: 39.795 Vali Loss: 140.838 Vali Acc: 0.351 Test Loss: 140.838 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 864.1028046607971
Epoch: 4, Steps: 32 | Train Loss: 76.764 Vali Loss: 346.960 Vali Acc: 0.198 Test Loss: 346.960 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 893.9464249610901
Epoch: 5, Steps: 32 | Train Loss: 41.331 Vali Loss: 164.101 Vali Acc: 0.405 Test Loss: 164.101 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 895.3725295066833
Epoch: 6, Steps: 32 | Train Loss: 13.221 Vali Loss: 354.367 Vali Acc: 0.450 Test Loss: 354.367 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 888.7375929355621
Epoch: 7, Steps: 32 | Train Loss: 42.084 Vali Loss: 453.203 Vali Acc: 0.504 Test Loss: 453.203 Test Acc: 0.504
Validation loss decreased (-0.495086 --> -0.499285).  Saving model ...
Epoch: 8 cost time: 906.7588930130005
Epoch: 8, Steps: 32 | Train Loss: 14.016 Vali Loss: 280.165 Vali Acc: 0.595 Test Loss: 280.165 Test Acc: 0.595
Validation loss decreased (-0.499285 --> -0.592618).  Saving model ...
Epoch: 9 cost time: 890.6629719734192
Epoch: 9, Steps: 32 | Train Loss: 40.874 Vali Loss: 347.855 Vali Acc: 0.565 Test Loss: 347.855 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 906.2222139835358
Epoch: 10, Steps: 32 | Train Loss: 12.643 Vali Loss: 374.010 Vali Acc: 0.382 Test Loss: 374.010 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 908.3030097484589
Epoch: 11, Steps: 32 | Train Loss: 7.331 Vali Loss: 305.741 Vali Acc: 0.534 Test Loss: 305.741 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 903.3278393745422
Epoch: 12, Steps: 32 | Train Loss: 11.324 Vali Loss: 352.277 Vali Acc: 0.511 Test Loss: 352.277 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 902.3057491779327
Epoch: 13, Steps: 32 | Train Loss: 32.172 Vali Loss: 649.279 Vali Acc: 0.527 Test Loss: 649.279 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 911.6003785133362
Epoch: 14, Steps: 32 | Train Loss: 47.876 Vali Loss: 705.264 Vali Acc: 0.534 Test Loss: 705.264 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 911.8700966835022
Epoch: 15, Steps: 32 | Train Loss: 49.095 Vali Loss: 1034.217 Vali Acc: 0.511 Test Loss: 1034.217 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 902.6798615455627
Epoch: 16, Steps: 32 | Train Loss: 44.699 Vali Loss: 673.730 Vali Acc: 0.458 Test Loss: 673.730 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 909.2652087211609
Epoch: 17, Steps: 32 | Train Loss: 51.018 Vali Loss: 682.435 Vali Acc: 0.550 Test Loss: 682.435 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 914.0085883140564
Epoch: 18, Steps: 32 | Train Loss: 37.820 Vali Loss: 939.292 Vali Acc: 0.542 Test Loss: 939.292 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df256_ma8992_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 57345541
model size : 289.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         7194                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df256_ma7194_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 582.6900420188904
Epoch: 1, Steps: 32 | Train Loss: 55.365 Vali Loss: 82.246 Vali Acc: 0.214 Test Loss: 82.246 Test Acc: 0.214
Validation loss decreased (inf --> -0.212918).  Saving model ...
Epoch: 2 cost time: 687.606388092041
Epoch: 2, Steps: 32 | Train Loss: 27.790 Vali Loss: 75.709 Vali Acc: 0.313 Test Loss: 75.709 Test Acc: 0.313
Validation loss decreased (-0.212918 --> -0.312220).  Saving model ...
Epoch: 3 cost time: 694.0604581832886
Epoch: 3, Steps: 32 | Train Loss: 47.297 Vali Loss: 142.490 Vali Acc: 0.588 Test Loss: 142.490 Test Acc: 0.588
Validation loss decreased (-0.312220 --> -0.586361).  Saving model ...
Epoch: 4 cost time: 714.0689771175385
Epoch: 4, Steps: 32 | Train Loss: 44.271 Vali Loss: 187.584 Vali Acc: 0.328 Test Loss: 187.584 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 728.1535151004791
Epoch: 5, Steps: 32 | Train Loss: 28.568 Vali Loss: 363.505 Vali Acc: 0.298 Test Loss: 363.505 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 720.1270370483398
Epoch: 6, Steps: 32 | Train Loss: 37.395 Vali Loss: 201.867 Vali Acc: 0.588 Test Loss: 201.867 Test Acc: 0.588
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 725.7609877586365
Epoch: 7, Steps: 32 | Train Loss: 29.440 Vali Loss: 329.130 Vali Acc: 0.435 Test Loss: 329.130 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 730.625518321991
Epoch: 8, Steps: 32 | Train Loss: 15.285 Vali Loss: 435.246 Vali Acc: 0.382 Test Loss: 435.246 Test Acc: 0.382
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 752.1748571395874
Epoch: 9, Steps: 32 | Train Loss: 6.580 Vali Loss: 264.725 Vali Acc: 0.450 Test Loss: 264.725 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 750.2009944915771
Epoch: 10, Steps: 32 | Train Loss: 0.000 Vali Loss: 357.269 Vali Acc: 0.542 Test Loss: 357.269 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 739.8461358547211
Epoch: 11, Steps: 32 | Train Loss: 5.105 Vali Loss: 412.394 Vali Acc: 0.534 Test Loss: 412.394 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 728.9756636619568
Epoch: 12, Steps: 32 | Train Loss: 28.072 Vali Loss: 606.153 Vali Acc: 0.359 Test Loss: 606.153 Test Acc: 0.359
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 727.4428942203522
Epoch: 13, Steps: 32 | Train Loss: 52.877 Vali Loss: 738.297 Vali Acc: 0.443 Test Loss: 738.297 Test Acc: 0.443
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df256_ma7194_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 57345541
model size : 289.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5396                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df256_ma5396_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 453.724497795105
Epoch: 1, Steps: 32 | Train Loss: 47.051 Vali Loss: 95.549 Vali Acc: 0.176 Test Loss: 95.549 Test Acc: 0.176
Validation loss decreased (inf --> -0.174617).  Saving model ...
Epoch: 2 cost time: 531.205667257309
Epoch: 2, Steps: 32 | Train Loss: 33.422 Vali Loss: 112.036 Vali Acc: 0.321 Test Loss: 112.036 Test Acc: 0.321
Validation loss decreased (-0.174617 --> -0.319490).  Saving model ...
Epoch: 3 cost time: 528.699066400528
Epoch: 3, Steps: 32 | Train Loss: 47.117 Vali Loss: 239.775 Vali Acc: 0.214 Test Loss: 239.775 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 535.1650428771973
Epoch: 4, Steps: 32 | Train Loss: 56.600 Vali Loss: 185.716 Vali Acc: 0.382 Test Loss: 185.716 Test Acc: 0.382
Validation loss decreased (-0.319490 --> -0.379822).  Saving model ...
Epoch: 5 cost time: 554.5890748500824
Epoch: 5, Steps: 32 | Train Loss: 25.462 Vali Loss: 413.117 Vali Acc: 0.267 Test Loss: 413.117 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 548.7723422050476
Epoch: 6, Steps: 32 | Train Loss: 54.007 Vali Loss: 481.347 Vali Acc: 0.496 Test Loss: 481.347 Test Acc: 0.496
Validation loss decreased (-0.379822 --> -0.491370).  Saving model ...
Epoch: 7 cost time: 555.7777750492096
Epoch: 7, Steps: 32 | Train Loss: 39.967 Vali Loss: 300.018 Vali Acc: 0.435 Test Loss: 300.018 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 565.5971164703369
Epoch: 8, Steps: 32 | Train Loss: 11.638 Vali Loss: 342.778 Vali Acc: 0.550 Test Loss: 342.778 Test Acc: 0.550
Validation loss decreased (-0.491370 --> -0.546191).  Saving model ...
Epoch: 9 cost time: 562.5632529258728
Epoch: 9, Steps: 32 | Train Loss: 14.094 Vali Loss: 361.623 Vali Acc: 0.573 Test Loss: 361.623 Test Acc: 0.573
Validation loss decreased (-0.546191 --> -0.568903).  Saving model ...
Epoch: 10 cost time: 556.1971573829651
Epoch: 10, Steps: 32 | Train Loss: 40.835 Vali Loss: 375.919 Vali Acc: 0.389 Test Loss: 375.919 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 562.5354011058807
Epoch: 11, Steps: 32 | Train Loss: 17.307 Vali Loss: 369.911 Vali Acc: 0.489 Test Loss: 369.911 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 563.1503298282623
Epoch: 12, Steps: 32 | Train Loss: 12.403 Vali Loss: 344.859 Vali Acc: 0.511 Test Loss: 344.859 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 563.9476373195648
Epoch: 13, Steps: 32 | Train Loss: 19.922 Vali Loss: 512.237 Vali Acc: 0.496 Test Loss: 512.237 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 559.1227180957794
Epoch: 14, Steps: 32 | Train Loss: 17.161 Vali Loss: 504.510 Vali Acc: 0.359 Test Loss: 504.510 Test Acc: 0.359
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 559.3157646656036
Epoch: 15, Steps: 32 | Train Loss: 25.647 Vali Loss: 534.428 Vali Acc: 0.336 Test Loss: 534.428 Test Acc: 0.336
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 563.7382845878601
Epoch: 16, Steps: 32 | Train Loss: 4.103 Vali Loss: 543.685 Vali Acc: 0.374 Test Loss: 543.685 Test Acc: 0.374
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 561.1604042053223
Epoch: 17, Steps: 32 | Train Loss: 14.992 Vali Loss: 953.292 Vali Acc: 0.298 Test Loss: 953.292 Test Acc: 0.298
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 566.3397483825684
Epoch: 18, Steps: 32 | Train Loss: 14.553 Vali Loss: 603.045 Vali Acc: 0.534 Test Loss: 603.045 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 560.4136397838593
Epoch: 19, Steps: 32 | Train Loss: 10.486 Vali Loss: 630.302 Vali Acc: 0.412 Test Loss: 630.302 Test Acc: 0.412
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df256_ma5396_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 57345541
model size : 289.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3597                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df256_ma3597_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 304.7035493850708
Epoch: 1, Steps: 32 | Train Loss: 49.221 Vali Loss: 138.590 Vali Acc: 0.221 Test Loss: 138.590 Test Acc: 0.221
Validation loss decreased (inf --> -0.219988).  Saving model ...
Epoch: 2 cost time: 359.5101549625397
Epoch: 2, Steps: 32 | Train Loss: 37.240 Vali Loss: 77.141 Vali Acc: 0.504 Test Loss: 77.141 Test Acc: 0.504
Validation loss decreased (-0.219988 --> -0.503045).  Saving model ...
Epoch: 3 cost time: 362.0918879508972
Epoch: 3, Steps: 32 | Train Loss: 56.272 Vali Loss: 113.612 Vali Acc: 0.443 Test Loss: 113.612 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 366.913428068161
Epoch: 4, Steps: 32 | Train Loss: 37.808 Vali Loss: 201.171 Vali Acc: 0.252 Test Loss: 201.171 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 373.1761178970337
Epoch: 5, Steps: 32 | Train Loss: 24.408 Vali Loss: 284.138 Vali Acc: 0.412 Test Loss: 284.138 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 373.42339873313904
Epoch: 6, Steps: 32 | Train Loss: 40.521 Vali Loss: 403.482 Vali Acc: 0.260 Test Loss: 403.482 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 383.12818002700806
Epoch: 7, Steps: 32 | Train Loss: 8.413 Vali Loss: 244.896 Vali Acc: 0.450 Test Loss: 244.896 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 378.5967924594879
Epoch: 8, Steps: 32 | Train Loss: 12.006 Vali Loss: 231.254 Vali Acc: 0.458 Test Loss: 231.254 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 384.89445877075195
Epoch: 9, Steps: 32 | Train Loss: 7.448 Vali Loss: 333.826 Vali Acc: 0.534 Test Loss: 333.826 Test Acc: 0.534
Validation loss decreased (-0.503045 --> -0.531013).  Saving model ...
Epoch: 10 cost time: 375.9426703453064
Epoch: 10, Steps: 32 | Train Loss: 19.098 Vali Loss: 521.282 Vali Acc: 0.221 Test Loss: 521.282 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 377.8586175441742
Epoch: 11, Steps: 32 | Train Loss: 18.838 Vali Loss: 557.026 Vali Acc: 0.359 Test Loss: 557.026 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 373.0901463031769
Epoch: 12, Steps: 32 | Train Loss: 54.566 Vali Loss: 719.228 Vali Acc: 0.550 Test Loss: 719.228 Test Acc: 0.550
Validation loss decreased (-0.531013 --> -0.542426).  Saving model ...
Epoch: 13 cost time: 380.26998376846313
Epoch: 13, Steps: 32 | Train Loss: 26.610 Vali Loss: 539.862 Vali Acc: 0.450 Test Loss: 539.862 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 378.0827534198761
Epoch: 14, Steps: 32 | Train Loss: 14.479 Vali Loss: 793.737 Vali Acc: 0.473 Test Loss: 793.737 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 379.54045271873474
Epoch: 15, Steps: 32 | Train Loss: 24.877 Vali Loss: 732.337 Vali Acc: 0.496 Test Loss: 732.337 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 382.33174085617065
Epoch: 16, Steps: 32 | Train Loss: 4.438 Vali Loss: 597.601 Vali Acc: 0.542 Test Loss: 597.601 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 383.28407764434814
Epoch: 17, Steps: 32 | Train Loss: 2.779 Vali Loss: 712.213 Vali Acc: 0.550 Test Loss: 712.213 Test Acc: 0.550
Validation loss decreased (-0.542426 --> -0.542496).  Saving model ...
Epoch: 18 cost time: 383.91312742233276
Epoch: 18, Steps: 32 | Train Loss: 5.805 Vali Loss: 760.741 Vali Acc: 0.519 Test Loss: 760.741 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 384.1675899028778
Epoch: 19, Steps: 32 | Train Loss: 0.500 Vali Loss: 992.015 Vali Acc: 0.313 Test Loss: 992.015 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 383.0919442176819
Epoch: 20, Steps: 32 | Train Loss: 4.620 Vali Loss: 558.537 Vali Acc: 0.389 Test Loss: 558.537 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 383.92871928215027
Epoch: 21, Steps: 32 | Train Loss: 2.009 Vali Loss: 704.431 Vali Acc: 0.557 Test Loss: 704.431 Test Acc: 0.557
Validation loss decreased (-0.542496 --> -0.550208).  Saving model ...
Epoch: 22 cost time: 384.7077555656433
Epoch: 22, Steps: 32 | Train Loss: 3.344 Vali Loss: 555.410 Vali Acc: 0.519 Test Loss: 555.410 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 384.0231559276581
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 646.474 Vali Acc: 0.519 Test Loss: 646.474 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 385.1580424308777
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 650.386 Vali Acc: 0.519 Test Loss: 650.386 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 384.806095123291
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 650.528 Vali Acc: 0.519 Test Loss: 650.528 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 384.71850776672363
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 650.533 Vali Acc: 0.519 Test Loss: 650.533 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 385.032751083374
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 650.533 Vali Acc: 0.519 Test Loss: 650.533 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 383.4788360595703
Epoch: 28, Steps: 32 | Train Loss: 0.000 Vali Loss: 650.533 Vali Acc: 0.519 Test Loss: 650.533 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 383.94113993644714
Epoch: 29, Steps: 32 | Train Loss: 0.000 Vali Loss: 650.533 Vali Acc: 0.519 Test Loss: 650.533 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 385.67843866348267
Epoch: 30, Steps: 32 | Train Loss: 0.000 Vali Loss: 650.533 Vali Acc: 0.519 Test Loss: 650.533 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 383.13955783843994
Epoch: 31, Steps: 32 | Train Loss: 0.000 Vali Loss: 650.533 Vali Acc: 0.519 Test Loss: 650.533 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df256_ma3597_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 57345541
model size : 289.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1799                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df256_ma1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 165.40390825271606
Epoch: 1, Steps: 32 | Train Loss: 44.194 Vali Loss: 159.291 Vali Acc: 0.183 Test Loss: 159.291 Test Acc: 0.183
Validation loss decreased (inf --> -0.181613).  Saving model ...
Epoch: 2 cost time: 189.1114146709442
Epoch: 2, Steps: 32 | Train Loss: 39.091 Vali Loss: 135.776 Vali Acc: 0.237 Test Loss: 135.776 Test Acc: 0.237
Validation loss decreased (-0.181613 --> -0.235283).  Saving model ...
Epoch: 3 cost time: 194.92817449569702
Epoch: 3, Steps: 32 | Train Loss: 40.099 Vali Loss: 232.527 Vali Acc: 0.534 Test Loss: 232.527 Test Acc: 0.534
Validation loss decreased (-0.235283 --> -0.532026).  Saving model ...
Epoch: 4 cost time: 200.31463146209717
Epoch: 4, Steps: 32 | Train Loss: 24.596 Vali Loss: 201.446 Vali Acc: 0.466 Test Loss: 201.446 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 195.60300087928772
Epoch: 5, Steps: 32 | Train Loss: 55.771 Vali Loss: 296.914 Vali Acc: 0.481 Test Loss: 296.914 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 199.49065518379211
Epoch: 6, Steps: 32 | Train Loss: 65.917 Vali Loss: 452.393 Vali Acc: 0.496 Test Loss: 452.393 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 201.52857446670532
Epoch: 7, Steps: 32 | Train Loss: 67.399 Vali Loss: 392.990 Vali Acc: 0.519 Test Loss: 392.990 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 205.77480244636536
Epoch: 8, Steps: 32 | Train Loss: 19.952 Vali Loss: 566.490 Vali Acc: 0.412 Test Loss: 566.490 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 207.82300758361816
Epoch: 9, Steps: 32 | Train Loss: 11.110 Vali Loss: 384.111 Vali Acc: 0.534 Test Loss: 384.111 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 205.28452825546265
Epoch: 10, Steps: 32 | Train Loss: 1.326 Vali Loss: 473.145 Vali Acc: 0.496 Test Loss: 473.145 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 205.4296476840973
Epoch: 11, Steps: 32 | Train Loss: 15.923 Vali Loss: 515.745 Vali Acc: 0.458 Test Loss: 515.745 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 205.38908123970032
Epoch: 12, Steps: 32 | Train Loss: 23.033 Vali Loss: 459.297 Vali Acc: 0.511 Test Loss: 459.297 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 206.93481826782227
Epoch: 13, Steps: 32 | Train Loss: 9.202 Vali Loss: 331.137 Vali Acc: 0.405 Test Loss: 331.137 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df256_ma1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 57345541
model size : 289.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df256_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 86.51437592506409
Epoch: 1, Steps: 32 | Train Loss: 42.634 Vali Loss: 133.796 Vali Acc: 0.191 Test Loss: 133.796 Test Acc: 0.191
Validation loss decreased (inf --> -0.189502).  Saving model ...
Epoch: 2 cost time: 104.08145880699158
Epoch: 2, Steps: 32 | Train Loss: 37.376 Vali Loss: 167.282 Vali Acc: 0.450 Test Loss: 167.282 Test Acc: 0.450
Validation loss decreased (-0.189502 --> -0.448709).  Saving model ...
Epoch: 3 cost time: 100.28594589233398
Epoch: 3, Steps: 32 | Train Loss: 63.079 Vali Loss: 230.129 Vali Acc: 0.481 Test Loss: 230.129 Test Acc: 0.481
Validation loss decreased (-0.448709 --> -0.478615).  Saving model ...
Epoch: 4 cost time: 104.82712602615356
Epoch: 4, Steps: 32 | Train Loss: 37.429 Vali Loss: 201.576 Vali Acc: 0.527 Test Loss: 201.576 Test Acc: 0.527
Validation loss decreased (-0.478615 --> -0.524702).  Saving model ...
Epoch: 5 cost time: 108.23851609230042
Epoch: 5, Steps: 32 | Train Loss: 15.224 Vali Loss: 251.320 Vali Acc: 0.550 Test Loss: 251.320 Test Acc: 0.550
Validation loss decreased (-0.524702 --> -0.547105).  Saving model ...
Epoch: 6 cost time: 107.85787105560303
Epoch: 6, Steps: 32 | Train Loss: 25.984 Vali Loss: 361.616 Vali Acc: 0.504 Test Loss: 361.616 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 107.81664490699768
Epoch: 7, Steps: 32 | Train Loss: 36.595 Vali Loss: 440.856 Vali Acc: 0.481 Test Loss: 440.856 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 106.45794558525085
Epoch: 8, Steps: 32 | Train Loss: 48.623 Vali Loss: 435.494 Vali Acc: 0.489 Test Loss: 435.494 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 108.15470504760742
Epoch: 9, Steps: 32 | Train Loss: 30.362 Vali Loss: 314.263 Vali Acc: 0.557 Test Loss: 314.263 Test Acc: 0.557
Validation loss decreased (-0.547105 --> -0.554109).  Saving model ...
Epoch: 10 cost time: 109.44243264198303
Epoch: 10, Steps: 32 | Train Loss: 7.872 Vali Loss: 433.861 Vali Acc: 0.527 Test Loss: 433.861 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 108.14413523674011
Epoch: 11, Steps: 32 | Train Loss: 29.698 Vali Loss: 635.894 Vali Acc: 0.534 Test Loss: 635.894 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 108.42151665687561
Epoch: 12, Steps: 32 | Train Loss: 23.551 Vali Loss: 496.226 Vali Acc: 0.504 Test Loss: 496.226 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 109.20003819465637
Epoch: 13, Steps: 32 | Train Loss: 13.565 Vali Loss: 433.829 Vali Acc: 0.435 Test Loss: 433.829 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 108.69217324256897
Epoch: 14, Steps: 32 | Train Loss: 23.543 Vali Loss: 642.717 Vali Acc: 0.496 Test Loss: 642.717 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 109.16118216514587
Epoch: 15, Steps: 32 | Train Loss: 13.348 Vali Loss: 750.364 Vali Acc: 0.504 Test Loss: 750.364 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 109.08242630958557
Epoch: 16, Steps: 32 | Train Loss: 8.642 Vali Loss: 798.103 Vali Acc: 0.481 Test Loss: 798.103 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 109.38658618927002
Epoch: 17, Steps: 32 | Train Loss: 20.278 Vali Loss: 611.469 Vali Acc: 0.534 Test Loss: 611.469 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 110.04568433761597
Epoch: 18, Steps: 32 | Train Loss: 8.805 Vali Loss: 639.025 Vali Acc: 0.481 Test Loss: 639.025 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 109.42228269577026
Epoch: 19, Steps: 32 | Train Loss: 6.597 Vali Loss: 561.855 Vali Acc: 0.405 Test Loss: 561.855 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df256_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 57345541
model size : 289.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         540                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df256_ma540_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 63.00111150741577
Epoch: 1, Steps: 32 | Train Loss: 45.130 Vali Loss: 111.044 Vali Acc: 0.237 Test Loss: 111.044 Test Acc: 0.237
Validation loss decreased (inf --> -0.235531).  Saving model ...
Epoch: 2 cost time: 73.18440175056458
Epoch: 2, Steps: 32 | Train Loss: 44.531 Vali Loss: 188.991 Vali Acc: 0.244 Test Loss: 188.991 Test Acc: 0.244
Validation loss decreased (-0.235531 --> -0.242385).  Saving model ...
Epoch: 3 cost time: 72.49694108963013
Epoch: 3, Steps: 32 | Train Loss: 44.260 Vali Loss: 218.424 Vali Acc: 0.275 Test Loss: 218.424 Test Acc: 0.275
Validation loss decreased (-0.242385 --> -0.272625).  Saving model ...
Epoch: 4 cost time: 73.63002729415894
Epoch: 4, Steps: 32 | Train Loss: 47.992 Vali Loss: 332.063 Vali Acc: 0.290 Test Loss: 332.063 Test Acc: 0.290
Validation loss decreased (-0.272625 --> -0.286756).  Saving model ...
Epoch: 5 cost time: 75.21222019195557
Epoch: 5, Steps: 32 | Train Loss: 40.866 Vali Loss: 459.153 Vali Acc: 0.534 Test Loss: 459.153 Test Acc: 0.534
Validation loss decreased (-0.286756 --> -0.529760).  Saving model ...
Epoch: 6 cost time: 75.70713901519775
Epoch: 6, Steps: 32 | Train Loss: 30.994 Vali Loss: 331.092 Vali Acc: 0.313 Test Loss: 331.092 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 74.94684958457947
Epoch: 7, Steps: 32 | Train Loss: 41.355 Vali Loss: 422.673 Vali Acc: 0.450 Test Loss: 422.673 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 76.75560736656189
Epoch: 8, Steps: 32 | Train Loss: 11.302 Vali Loss: 549.568 Vali Acc: 0.519 Test Loss: 549.568 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 76.18748998641968
Epoch: 9, Steps: 32 | Train Loss: 34.461 Vali Loss: 544.303 Vali Acc: 0.519 Test Loss: 544.303 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 76.4118185043335
Epoch: 10, Steps: 32 | Train Loss: 23.686 Vali Loss: 803.497 Vali Acc: 0.496 Test Loss: 803.497 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 76.24194097518921
Epoch: 11, Steps: 32 | Train Loss: 52.438 Vali Loss: 614.323 Vali Acc: 0.481 Test Loss: 614.323 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 77.29392528533936
Epoch: 12, Steps: 32 | Train Loss: 7.877 Vali Loss: 649.982 Vali Acc: 0.374 Test Loss: 649.982 Test Acc: 0.374
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 76.93781423568726
Epoch: 13, Steps: 32 | Train Loss: 9.511 Vali Loss: 491.542 Vali Acc: 0.542 Test Loss: 491.542 Test Acc: 0.542
Validation loss decreased (-0.529760 --> -0.537069).  Saving model ...
Epoch: 14 cost time: 76.77031302452087
Epoch: 14, Steps: 32 | Train Loss: 12.540 Vali Loss: 519.091 Vali Acc: 0.458 Test Loss: 519.091 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 76.21251225471497
Epoch: 15, Steps: 32 | Train Loss: 23.754 Vali Loss: 681.040 Vali Acc: 0.435 Test Loss: 681.040 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 76.79270148277283
Epoch: 16, Steps: 32 | Train Loss: 21.461 Vali Loss: 723.573 Vali Acc: 0.374 Test Loss: 723.573 Test Acc: 0.374
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 75.6964099407196
Epoch: 17, Steps: 32 | Train Loss: 18.192 Vali Loss: 740.536 Vali Acc: 0.344 Test Loss: 740.536 Test Acc: 0.344
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 76.53790640830994
Epoch: 18, Steps: 32 | Train Loss: 63.360 Vali Loss: 1261.464 Vali Acc: 0.450 Test Loss: 1261.464 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 76.85950565338135
Epoch: 19, Steps: 32 | Train Loss: 19.410 Vali Loss: 1007.778 Vali Acc: 0.405 Test Loss: 1007.778 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 76.97428274154663
Epoch: 20, Steps: 32 | Train Loss: 0.518 Vali Loss: 1259.425 Vali Acc: 0.496 Test Loss: 1259.425 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 77.49474954605103
Epoch: 21, Steps: 32 | Train Loss: 1.050 Vali Loss: 1147.985 Vali Acc: 0.511 Test Loss: 1147.985 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 77.20874857902527
Epoch: 22, Steps: 32 | Train Loss: 2.127 Vali Loss: 878.977 Vali Acc: 0.336 Test Loss: 878.977 Test Acc: 0.336
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 76.84520864486694
Epoch: 23, Steps: 32 | Train Loss: 11.914 Vali Loss: 1090.356 Vali Acc: 0.519 Test Loss: 1090.356 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df256_ma540_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 57345541
model size : 289.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df256_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 51.975189447402954
Epoch: 1, Steps: 32 | Train Loss: 28.204 Vali Loss: 48.270 Vali Acc: 0.450 Test Loss: 48.270 Test Acc: 0.450
Validation loss decreased (inf --> -0.449899).  Saving model ...
Epoch: 2 cost time: 57.81967353820801
Epoch: 2, Steps: 32 | Train Loss: 40.681 Vali Loss: 117.427 Vali Acc: 0.321 Test Loss: 117.427 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 58.35311961174011
Epoch: 3, Steps: 32 | Train Loss: 50.123 Vali Loss: 156.181 Vali Acc: 0.427 Test Loss: 156.181 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 60.17042279243469
Epoch: 4, Steps: 32 | Train Loss: 20.564 Vali Loss: 157.844 Vali Acc: 0.458 Test Loss: 157.844 Test Acc: 0.458
Validation loss decreased (-0.449899 --> -0.456437).  Saving model ...
Epoch: 5 cost time: 59.99111008644104
Epoch: 5, Steps: 32 | Train Loss: 26.430 Vali Loss: 279.897 Vali Acc: 0.443 Test Loss: 279.897 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 59.83951544761658
Epoch: 6, Steps: 32 | Train Loss: 48.241 Vali Loss: 394.286 Vali Acc: 0.473 Test Loss: 394.286 Test Acc: 0.473
Validation loss decreased (-0.456437 --> -0.469340).  Saving model ...
Epoch: 7 cost time: 59.70276093482971
Epoch: 7, Steps: 32 | Train Loss: 24.648 Vali Loss: 332.241 Vali Acc: 0.397 Test Loss: 332.241 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 60.00748157501221
Epoch: 8, Steps: 32 | Train Loss: 32.936 Vali Loss: 328.230 Vali Acc: 0.443 Test Loss: 328.230 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 60.70543313026428
Epoch: 9, Steps: 32 | Train Loss: 12.763 Vali Loss: 398.541 Vali Acc: 0.481 Test Loss: 398.541 Test Acc: 0.481
Validation loss decreased (-0.469340 --> -0.476931).  Saving model ...
Epoch: 10 cost time: 60.32945680618286
Epoch: 10, Steps: 32 | Train Loss: 8.259 Vali Loss: 704.211 Vali Acc: 0.496 Test Loss: 704.211 Test Acc: 0.496
Validation loss decreased (-0.476931 --> -0.489141).  Saving model ...
Epoch: 11 cost time: 60.18616962432861
Epoch: 11, Steps: 32 | Train Loss: 18.457 Vali Loss: 514.621 Vali Acc: 0.427 Test Loss: 514.621 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 61.21983623504639
Epoch: 12, Steps: 32 | Train Loss: 9.558 Vali Loss: 413.066 Vali Acc: 0.527 Test Loss: 413.066 Test Acc: 0.527
Validation loss decreased (-0.489141 --> -0.522587).  Saving model ...
Epoch: 13 cost time: 60.81051778793335
Epoch: 13, Steps: 32 | Train Loss: 6.961 Vali Loss: 379.433 Vali Acc: 0.534 Test Loss: 379.433 Test Acc: 0.534
Validation loss decreased (-0.522587 --> -0.530557).  Saving model ...
Epoch: 14 cost time: 60.27812147140503
Epoch: 14, Steps: 32 | Train Loss: 3.229 Vali Loss: 699.298 Vali Acc: 0.504 Test Loss: 699.298 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 61.16468024253845
Epoch: 15, Steps: 32 | Train Loss: 17.266 Vali Loss: 614.032 Vali Acc: 0.481 Test Loss: 614.032 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 60.65489077568054
Epoch: 16, Steps: 32 | Train Loss: 14.932 Vali Loss: 477.213 Vali Acc: 0.496 Test Loss: 477.213 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 60.16691517829895
Epoch: 17, Steps: 32 | Train Loss: 47.035 Vali Loss: 567.552 Vali Acc: 0.473 Test Loss: 567.552 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 60.49297618865967
Epoch: 18, Steps: 32 | Train Loss: 15.321 Vali Loss: 863.822 Vali Acc: 0.496 Test Loss: 863.822 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 60.319899559020996
Epoch: 19, Steps: 32 | Train Loss: 28.008 Vali Loss: 956.606 Vali Acc: 0.504 Test Loss: 956.606 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 60.407628536224365
Epoch: 20, Steps: 32 | Train Loss: 53.373 Vali Loss: 1461.346 Vali Acc: 0.489 Test Loss: 1461.346 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 60.62501287460327
Epoch: 21, Steps: 32 | Train Loss: 45.145 Vali Loss: 942.268 Vali Acc: 0.527 Test Loss: 942.268 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 60.44814729690552
Epoch: 22, Steps: 32 | Train Loss: 26.304 Vali Loss: 996.134 Vali Acc: 0.481 Test Loss: 996.134 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 61.09841823577881
Epoch: 23, Steps: 32 | Train Loss: 2.746 Vali Loss: 997.528 Vali Acc: 0.458 Test Loss: 997.528 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df256_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 57345541
model size : 289.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df256_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 40.85316872596741
Epoch: 1, Steps: 32 | Train Loss: 39.055 Vali Loss: 35.115 Vali Acc: 0.359 Test Loss: 35.115 Test Acc: 0.359
Validation loss decreased (inf --> -0.358427).  Saving model ...
Epoch: 2 cost time: 42.173473834991455
Epoch: 2, Steps: 32 | Train Loss: 45.612 Vali Loss: 54.630 Vali Acc: 0.412 Test Loss: 54.630 Test Acc: 0.412
Validation loss decreased (-0.358427 --> -0.411667).  Saving model ...
Epoch: 3 cost time: 43.503138303756714
Epoch: 3, Steps: 32 | Train Loss: 42.016 Vali Loss: 125.751 Vali Acc: 0.527 Test Loss: 125.751 Test Acc: 0.527
Validation loss decreased (-0.411667 --> -0.525460).  Saving model ...
Epoch: 4 cost time: 43.08111548423767
Epoch: 4, Steps: 32 | Train Loss: 52.726 Vali Loss: 194.494 Vali Acc: 0.527 Test Loss: 194.494 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 44.324928522109985
Epoch: 5, Steps: 32 | Train Loss: 20.998 Vali Loss: 112.595 Vali Acc: 0.580 Test Loss: 112.595 Test Acc: 0.580
Validation loss decreased (-0.525460 --> -0.579027).  Saving model ...
Epoch: 6 cost time: 43.80782103538513
Epoch: 6, Steps: 32 | Train Loss: 37.734 Vali Loss: 242.473 Vali Acc: 0.450 Test Loss: 242.473 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 43.624903202056885
Epoch: 7, Steps: 32 | Train Loss: 99.003 Vali Loss: 239.509 Vali Acc: 0.504 Test Loss: 239.509 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 44.16002798080444
Epoch: 8, Steps: 32 | Train Loss: 30.398 Vali Loss: 253.363 Vali Acc: 0.527 Test Loss: 253.363 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 44.455201148986816
Epoch: 9, Steps: 32 | Train Loss: 4.878 Vali Loss: 401.336 Vali Acc: 0.565 Test Loss: 401.336 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 44.49879288673401
Epoch: 10, Steps: 32 | Train Loss: 18.429 Vali Loss: 308.675 Vali Acc: 0.580 Test Loss: 308.675 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 44.38606572151184
Epoch: 11, Steps: 32 | Train Loss: 10.070 Vali Loss: 294.151 Vali Acc: 0.481 Test Loss: 294.151 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 44.314373254776
Epoch: 12, Steps: 32 | Train Loss: 8.735 Vali Loss: 629.045 Vali Acc: 0.527 Test Loss: 629.045 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 44.24898099899292
Epoch: 13, Steps: 32 | Train Loss: 26.893 Vali Loss: 801.319 Vali Acc: 0.496 Test Loss: 801.319 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 44.331830739974976
Epoch: 14, Steps: 32 | Train Loss: 17.399 Vali Loss: 507.675 Vali Acc: 0.427 Test Loss: 507.675 Test Acc: 0.427
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 44.58146834373474
Epoch: 15, Steps: 32 | Train Loss: 8.626 Vali Loss: 437.103 Vali Acc: 0.435 Test Loss: 437.103 Test Acc: 0.435
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df256_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 57345541
model size : 289.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df256_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 35.22100067138672
Epoch: 1, Steps: 32 | Train Loss: 29.597 Vali Loss: 13.426 Vali Acc: 0.443 Test Loss: 13.426 Test Acc: 0.443
Validation loss decreased (inf --> -0.442614).  Saving model ...
Epoch: 2 cost time: 35.52705407142639
Epoch: 2, Steps: 32 | Train Loss: 33.462 Vali Loss: 78.059 Vali Acc: 0.229 Test Loss: 78.059 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 36.26712489128113
Epoch: 3, Steps: 32 | Train Loss: 41.928 Vali Loss: 83.921 Vali Acc: 0.565 Test Loss: 83.921 Test Acc: 0.565
Validation loss decreased (-0.442614 --> -0.564046).  Saving model ...
Epoch: 4 cost time: 36.034292459487915
Epoch: 4, Steps: 32 | Train Loss: 66.534 Vali Loss: 186.705 Vali Acc: 0.336 Test Loss: 186.705 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 36.03331899642944
Epoch: 5, Steps: 32 | Train Loss: 57.242 Vali Loss: 186.902 Vali Acc: 0.466 Test Loss: 186.902 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 35.99992537498474
Epoch: 6, Steps: 32 | Train Loss: 67.247 Vali Loss: 303.334 Vali Acc: 0.565 Test Loss: 303.334 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 36.50206184387207
Epoch: 7, Steps: 32 | Train Loss: 21.617 Vali Loss: 178.845 Vali Acc: 0.534 Test Loss: 178.845 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 36.24764275550842
Epoch: 8, Steps: 32 | Train Loss: 10.117 Vali Loss: 234.556 Vali Acc: 0.435 Test Loss: 234.556 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 36.47896885871887
Epoch: 9, Steps: 32 | Train Loss: 32.078 Vali Loss: 262.824 Vali Acc: 0.527 Test Loss: 262.824 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 36.42760896682739
Epoch: 10, Steps: 32 | Train Loss: 24.034 Vali Loss: 428.930 Vali Acc: 0.374 Test Loss: 428.930 Test Acc: 0.374
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 36.49473547935486
Epoch: 11, Steps: 32 | Train Loss: 9.381 Vali Loss: 403.040 Vali Acc: 0.496 Test Loss: 403.040 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 36.50999903678894
Epoch: 12, Steps: 32 | Train Loss: 4.237 Vali Loss: 387.277 Vali Acc: 0.427 Test Loss: 387.277 Test Acc: 0.427
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 36.411083936691284
Epoch: 13, Steps: 32 | Train Loss: 12.119 Vali Loss: 355.395 Vali Acc: 0.466 Test Loss: 355.395 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df256_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 57345541
model size : 289.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         8992                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df128_ma8992_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 719.8292143344879
Epoch: 1, Steps: 32 | Train Loss: 61.644 Vali Loss: 99.573 Vali Acc: 0.198 Test Loss: 99.573 Test Acc: 0.198
Validation loss decreased (inf --> -0.197478).  Saving model ...
Epoch: 2 cost time: 852.6559476852417
Epoch: 2, Steps: 32 | Train Loss: 49.461 Vali Loss: 117.927 Vali Acc: 0.328 Test Loss: 117.927 Test Acc: 0.328
Validation loss decreased (-0.197478 --> -0.327065).  Saving model ...
Epoch: 3 cost time: 882.7475006580353
Epoch: 3, Steps: 32 | Train Loss: 56.877 Vali Loss: 250.955 Vali Acc: 0.504 Test Loss: 250.955 Test Acc: 0.504
Validation loss decreased (-0.327065 --> -0.501307).  Saving model ...
Epoch: 4 cost time: 881.5999121665955
Epoch: 4, Steps: 32 | Train Loss: 44.481 Vali Loss: 222.657 Vali Acc: 0.282 Test Loss: 222.657 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 887.8379333019257
Epoch: 5, Steps: 32 | Train Loss: 17.846 Vali Loss: 263.376 Vali Acc: 0.389 Test Loss: 263.376 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 891.9332160949707
Epoch: 6, Steps: 32 | Train Loss: 32.391 Vali Loss: 302.159 Vali Acc: 0.550 Test Loss: 302.159 Test Acc: 0.550
Validation loss decreased (-0.501307 --> -0.546597).  Saving model ...
Epoch: 7 cost time: 912.7063388824463
Epoch: 7, Steps: 32 | Train Loss: 18.702 Vali Loss: 286.116 Vali Acc: 0.359 Test Loss: 286.116 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 915.5503051280975
Epoch: 8, Steps: 32 | Train Loss: 16.023 Vali Loss: 315.373 Vali Acc: 0.542 Test Loss: 315.373 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 915.1839954853058
Epoch: 9, Steps: 32 | Train Loss: 7.036 Vali Loss: 376.154 Vali Acc: 0.466 Test Loss: 376.154 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 925.6285681724548
Epoch: 10, Steps: 32 | Train Loss: 8.823 Vali Loss: 398.431 Vali Acc: 0.527 Test Loss: 398.431 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 910.6230289936066
Epoch: 11, Steps: 32 | Train Loss: 11.122 Vali Loss: 468.965 Vali Acc: 0.542 Test Loss: 468.965 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 921.425543308258
Epoch: 12, Steps: 32 | Train Loss: 8.421 Vali Loss: 554.256 Vali Acc: 0.435 Test Loss: 554.256 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 910.9491910934448
Epoch: 13, Steps: 32 | Train Loss: 24.994 Vali Loss: 450.158 Vali Acc: 0.397 Test Loss: 450.158 Test Acc: 0.397
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 923.211225271225
Epoch: 14, Steps: 32 | Train Loss: 7.468 Vali Loss: 561.958 Vali Acc: 0.542 Test Loss: 561.958 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 921.1643419265747
Epoch: 15, Steps: 32 | Train Loss: 7.752 Vali Loss: 593.597 Vali Acc: 0.534 Test Loss: 593.597 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 924.3340182304382
Epoch: 16, Steps: 32 | Train Loss: 6.925 Vali Loss: 498.020 Vali Acc: 0.466 Test Loss: 498.020 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df128_ma8992_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 56952325
model size : 287.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         7194                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df128_ma7194_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 577.3568758964539
Epoch: 1, Steps: 32 | Train Loss: 49.522 Vali Loss: 71.872 Vali Acc: 0.527 Test Loss: 71.872 Test Acc: 0.527
Validation loss decreased (inf --> -0.525999).  Saving model ...
Epoch: 2 cost time: 688.1633920669556
Epoch: 2, Steps: 32 | Train Loss: 28.774 Vali Loss: 77.974 Vali Acc: 0.458 Test Loss: 77.974 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 716.8500258922577
Epoch: 3, Steps: 32 | Train Loss: 56.984 Vali Loss: 176.768 Vali Acc: 0.183 Test Loss: 176.768 Test Acc: 0.183
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 698.9459745883942
Epoch: 4, Steps: 32 | Train Loss: 36.350 Vali Loss: 139.615 Vali Acc: 0.351 Test Loss: 139.615 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 723.3880114555359
Epoch: 5, Steps: 32 | Train Loss: 12.271 Vali Loss: 160.734 Vali Acc: 0.527 Test Loss: 160.734 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 726.3519108295441
Epoch: 6, Steps: 32 | Train Loss: 30.251 Vali Loss: 263.989 Vali Acc: 0.397 Test Loss: 263.989 Test Acc: 0.397
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 716.3667178153992
Epoch: 7, Steps: 32 | Train Loss: 39.933 Vali Loss: 297.669 Vali Acc: 0.427 Test Loss: 297.669 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 732.1805429458618
Epoch: 8, Steps: 32 | Train Loss: 27.055 Vali Loss: 476.859 Vali Acc: 0.328 Test Loss: 476.859 Test Acc: 0.328
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 727.2616782188416
Epoch: 9, Steps: 32 | Train Loss: 32.793 Vali Loss: 729.050 Vali Acc: 0.282 Test Loss: 729.050 Test Acc: 0.282
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 731.3408584594727
Epoch: 10, Steps: 32 | Train Loss: 20.516 Vali Loss: 412.797 Vali Acc: 0.420 Test Loss: 412.797 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 741.3029954433441
Epoch: 11, Steps: 32 | Train Loss: 27.611 Vali Loss: 381.987 Vali Acc: 0.496 Test Loss: 381.987 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df128_ma7194_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 56952325
model size : 287.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5396                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df128_ma5396_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 445.1216595172882
Epoch: 1, Steps: 32 | Train Loss: 52.248 Vali Loss: 75.471 Vali Acc: 0.450 Test Loss: 75.471 Test Acc: 0.450
Validation loss decreased (inf --> -0.449627).  Saving model ...
Epoch: 2 cost time: 521.8889167308807
Epoch: 2, Steps: 32 | Train Loss: 48.903 Vali Loss: 138.931 Vali Acc: 0.214 Test Loss: 138.931 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 530.48095536232
Epoch: 3, Steps: 32 | Train Loss: 33.604 Vali Loss: 130.196 Vali Acc: 0.534 Test Loss: 130.196 Test Acc: 0.534
Validation loss decreased (-0.449627 --> -0.533049).  Saving model ...
Epoch: 4 cost time: 560.0621268749237
Epoch: 4, Steps: 32 | Train Loss: 9.796 Vali Loss: 154.977 Vali Acc: 0.321 Test Loss: 154.977 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 545.3502724170685
Epoch: 5, Steps: 32 | Train Loss: 26.298 Vali Loss: 212.899 Vali Acc: 0.458 Test Loss: 212.899 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 545.6800711154938
Epoch: 6, Steps: 32 | Train Loss: 60.343 Vali Loss: 228.554 Vali Acc: 0.443 Test Loss: 228.554 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 548.810971736908
Epoch: 7, Steps: 32 | Train Loss: 41.614 Vali Loss: 325.795 Vali Acc: 0.305 Test Loss: 325.795 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 550.3015263080597
Epoch: 8, Steps: 32 | Train Loss: 23.253 Vali Loss: 519.567 Vali Acc: 0.519 Test Loss: 519.567 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 558.2419719696045
Epoch: 9, Steps: 32 | Train Loss: 31.572 Vali Loss: 624.654 Vali Acc: 0.221 Test Loss: 624.654 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 551.9300317764282
Epoch: 10, Steps: 32 | Train Loss: 37.280 Vali Loss: 826.326 Vali Acc: 0.504 Test Loss: 826.326 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 551.1049451828003
Epoch: 11, Steps: 32 | Train Loss: 83.914 Vali Loss: 546.020 Vali Acc: 0.519 Test Loss: 546.020 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 564.2326455116272
Epoch: 12, Steps: 32 | Train Loss: 36.046 Vali Loss: 574.036 Vali Acc: 0.466 Test Loss: 574.036 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 566.4774899482727
Epoch: 13, Steps: 32 | Train Loss: 6.353 Vali Loss: 548.409 Vali Acc: 0.527 Test Loss: 548.409 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df128_ma5396_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 56952325
model size : 287.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3597                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df128_ma3597_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 313.79427433013916
Epoch: 1, Steps: 32 | Train Loss: 58.070 Vali Loss: 71.039 Vali Acc: 0.244 Test Loss: 71.039 Test Acc: 0.244
Validation loss decreased (inf --> -0.243564).  Saving model ...
Epoch: 2 cost time: 349.88551092147827
Epoch: 2, Steps: 32 | Train Loss: 27.259 Vali Loss: 93.545 Vali Acc: 0.252 Test Loss: 93.545 Test Acc: 0.252
Validation loss decreased (-0.243564 --> -0.250973).  Saving model ...
Epoch: 3 cost time: 359.62333393096924
Epoch: 3, Steps: 32 | Train Loss: 53.851 Vali Loss: 93.872 Vali Acc: 0.267 Test Loss: 93.872 Test Acc: 0.267
Validation loss decreased (-0.250973 --> -0.266237).  Saving model ...
Epoch: 4 cost time: 363.84992957115173
Epoch: 4, Steps: 32 | Train Loss: 58.646 Vali Loss: 152.384 Vali Acc: 0.450 Test Loss: 152.384 Test Acc: 0.450
Validation loss decreased (-0.266237 --> -0.448858).  Saving model ...
Epoch: 5 cost time: 366.5735909938812
Epoch: 5, Steps: 32 | Train Loss: 37.911 Vali Loss: 179.775 Vali Acc: 0.511 Test Loss: 179.775 Test Acc: 0.511
Validation loss decreased (-0.448858 --> -0.509653).  Saving model ...
Epoch: 6 cost time: 378.0808193683624
Epoch: 6, Steps: 32 | Train Loss: 28.058 Vali Loss: 281.560 Vali Acc: 0.511 Test Loss: 281.560 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 374.68952441215515
Epoch: 7, Steps: 32 | Train Loss: 43.648 Vali Loss: 311.583 Vali Acc: 0.534 Test Loss: 311.583 Test Acc: 0.534
Validation loss decreased (-0.509653 --> -0.531235).  Saving model ...
Epoch: 8 cost time: 379.24864864349365
Epoch: 8, Steps: 32 | Train Loss: 15.675 Vali Loss: 260.285 Vali Acc: 0.511 Test Loss: 260.285 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 381.07438588142395
Epoch: 9, Steps: 32 | Train Loss: 11.399 Vali Loss: 357.158 Vali Acc: 0.450 Test Loss: 357.158 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 380.91304421424866
Epoch: 10, Steps: 32 | Train Loss: 19.278 Vali Loss: 453.661 Vali Acc: 0.519 Test Loss: 453.661 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 383.61475253105164
Epoch: 11, Steps: 32 | Train Loss: 3.661 Vali Loss: 501.487 Vali Acc: 0.542 Test Loss: 501.487 Test Acc: 0.542
Validation loss decreased (-0.531235 --> -0.536970).  Saving model ...
Epoch: 12 cost time: 383.1395432949066
Epoch: 12, Steps: 32 | Train Loss: 11.233 Vali Loss: 565.008 Vali Acc: 0.527 Test Loss: 565.008 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 381.94578552246094
Epoch: 13, Steps: 32 | Train Loss: 10.190 Vali Loss: 701.857 Vali Acc: 0.542 Test Loss: 701.857 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 380.065452337265
Epoch: 14, Steps: 32 | Train Loss: 54.635 Vali Loss: 571.844 Vali Acc: 0.511 Test Loss: 571.844 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 378.4408538341522
Epoch: 15, Steps: 32 | Train Loss: 21.076 Vali Loss: 579.655 Vali Acc: 0.527 Test Loss: 579.655 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 379.9752371311188
Epoch: 16, Steps: 32 | Train Loss: 13.441 Vali Loss: 761.977 Vali Acc: 0.427 Test Loss: 761.977 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 381.75955748558044
Epoch: 17, Steps: 32 | Train Loss: 18.836 Vali Loss: 579.282 Vali Acc: 0.489 Test Loss: 579.282 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 384.2181022167206
Epoch: 18, Steps: 32 | Train Loss: 9.600 Vali Loss: 706.431 Vali Acc: 0.496 Test Loss: 706.431 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 384.4149911403656
Epoch: 19, Steps: 32 | Train Loss: 10.570 Vali Loss: 816.415 Vali Acc: 0.496 Test Loss: 816.415 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 382.504070520401
Epoch: 20, Steps: 32 | Train Loss: 0.694 Vali Loss: 841.099 Vali Acc: 0.489 Test Loss: 841.099 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 382.15810537338257
Epoch: 21, Steps: 32 | Train Loss: 14.794 Vali Loss: 798.613 Vali Acc: 0.298 Test Loss: 798.613 Test Acc: 0.298
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df128_ma3597_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 56952325
model size : 287.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1799                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df128_ma1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 165.10712003707886
Epoch: 1, Steps: 32 | Train Loss: 47.015 Vali Loss: 104.630 Vali Acc: 0.229 Test Loss: 104.630 Test Acc: 0.229
Validation loss decreased (inf --> -0.227961).  Saving model ...
Epoch: 2 cost time: 190.47251296043396
Epoch: 2, Steps: 32 | Train Loss: 51.288 Vali Loss: 73.545 Vali Acc: 0.359 Test Loss: 73.545 Test Acc: 0.359
Validation loss decreased (-0.227961 --> -0.358043).  Saving model ...
Epoch: 3 cost time: 192.3526473045349
Epoch: 3, Steps: 32 | Train Loss: 70.916 Vali Loss: 276.446 Vali Acc: 0.489 Test Loss: 276.446 Test Acc: 0.489
Validation loss decreased (-0.358043 --> -0.485785).  Saving model ...
Epoch: 4 cost time: 197.5675549507141
Epoch: 4, Steps: 32 | Train Loss: 50.295 Vali Loss: 159.012 Vali Acc: 0.519 Test Loss: 159.012 Test Acc: 0.519
Validation loss decreased (-0.485785 --> -0.517494).  Saving model ...
Epoch: 5 cost time: 201.58726835250854
Epoch: 5, Steps: 32 | Train Loss: 27.193 Vali Loss: 321.845 Vali Acc: 0.534 Test Loss: 321.845 Test Acc: 0.534
Validation loss decreased (-0.517494 --> -0.531133).  Saving model ...
Epoch: 6 cost time: 200.77569794654846
Epoch: 6, Steps: 32 | Train Loss: 34.257 Vali Loss: 295.231 Vali Acc: 0.534 Test Loss: 295.231 Test Acc: 0.534
Validation loss decreased (-0.531133 --> -0.531399).  Saving model ...
Epoch: 7 cost time: 204.24757766723633
Epoch: 7, Steps: 32 | Train Loss: 28.095 Vali Loss: 439.476 Vali Acc: 0.511 Test Loss: 439.476 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 203.05451107025146
Epoch: 8, Steps: 32 | Train Loss: 39.119 Vali Loss: 629.874 Vali Acc: 0.473 Test Loss: 629.874 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 206.16482591629028
Epoch: 9, Steps: 32 | Train Loss: 25.504 Vali Loss: 561.441 Vali Acc: 0.511 Test Loss: 561.441 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 205.23538208007812
Epoch: 10, Steps: 32 | Train Loss: 36.764 Vali Loss: 817.701 Vali Acc: 0.519 Test Loss: 817.701 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 205.9994330406189
Epoch: 11, Steps: 32 | Train Loss: 18.271 Vali Loss: 476.041 Vali Acc: 0.527 Test Loss: 476.041 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 206.09095525741577
Epoch: 12, Steps: 32 | Train Loss: 6.341 Vali Loss: 610.981 Vali Acc: 0.519 Test Loss: 610.981 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 208.35361790657043
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 553.446 Vali Acc: 0.504 Test Loss: 553.446 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 208.44648504257202
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 552.595 Vali Acc: 0.504 Test Loss: 552.595 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 207.66380333900452
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 552.564 Vali Acc: 0.504 Test Loss: 552.564 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 206.8134639263153
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 552.563 Vali Acc: 0.504 Test Loss: 552.563 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df128_ma1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 56952325
model size : 287.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df128_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 86.57116079330444
Epoch: 1, Steps: 32 | Train Loss: 37.438 Vali Loss: 74.977 Vali Acc: 0.466 Test Loss: 74.977 Test Acc: 0.466
Validation loss decreased (inf --> -0.464899).  Saving model ...
Epoch: 2 cost time: 96.26218271255493
Epoch: 2, Steps: 32 | Train Loss: 76.434 Vali Loss: 64.922 Vali Acc: 0.412 Test Loss: 64.922 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 104.75520348548889
Epoch: 3, Steps: 32 | Train Loss: 33.459 Vali Loss: 124.441 Vali Acc: 0.435 Test Loss: 124.441 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 107.79395627975464
Epoch: 4, Steps: 32 | Train Loss: 22.569 Vali Loss: 205.034 Vali Acc: 0.359 Test Loss: 205.034 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 106.89379072189331
Epoch: 5, Steps: 32 | Train Loss: 29.828 Vali Loss: 261.362 Vali Acc: 0.420 Test Loss: 261.362 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 107.60037446022034
Epoch: 6, Steps: 32 | Train Loss: 10.960 Vali Loss: 398.406 Vali Acc: 0.481 Test Loss: 398.406 Test Acc: 0.481
Validation loss decreased (-0.464899 --> -0.476932).  Saving model ...
Epoch: 7 cost time: 107.5191376209259
Epoch: 7, Steps: 32 | Train Loss: 45.102 Vali Loss: 491.222 Vali Acc: 0.374 Test Loss: 491.222 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 108.94145274162292
Epoch: 8, Steps: 32 | Train Loss: 16.962 Vali Loss: 569.562 Vali Acc: 0.527 Test Loss: 569.562 Test Acc: 0.527
Validation loss decreased (-0.476932 --> -0.521022).  Saving model ...
Epoch: 9 cost time: 108.64124703407288
Epoch: 9, Steps: 32 | Train Loss: 19.372 Vali Loss: 376.194 Vali Acc: 0.412 Test Loss: 376.194 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 111.00351691246033
Epoch: 10, Steps: 32 | Train Loss: 7.167 Vali Loss: 739.837 Vali Acc: 0.511 Test Loss: 739.837 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 109.1808853149414
Epoch: 11, Steps: 32 | Train Loss: 10.936 Vali Loss: 444.195 Vali Acc: 0.473 Test Loss: 444.195 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 109.61310315132141
Epoch: 12, Steps: 32 | Train Loss: 6.213 Vali Loss: 728.007 Vali Acc: 0.496 Test Loss: 728.007 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 107.50642156600952
Epoch: 13, Steps: 32 | Train Loss: 36.608 Vali Loss: 609.743 Vali Acc: 0.336 Test Loss: 609.743 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 107.69359612464905
Epoch: 14, Steps: 32 | Train Loss: 31.752 Vali Loss: 656.828 Vali Acc: 0.473 Test Loss: 656.828 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 109.25606393814087
Epoch: 15, Steps: 32 | Train Loss: 23.364 Vali Loss: 594.856 Vali Acc: 0.511 Test Loss: 594.856 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 109.20371770858765
Epoch: 16, Steps: 32 | Train Loss: 22.380 Vali Loss: 605.012 Vali Acc: 0.397 Test Loss: 605.012 Test Acc: 0.397
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 109.07099962234497
Epoch: 17, Steps: 32 | Train Loss: 84.308 Vali Loss: 661.121 Vali Acc: 0.374 Test Loss: 661.121 Test Acc: 0.374
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 108.81242752075195
Epoch: 18, Steps: 32 | Train Loss: 7.923 Vali Loss: 1003.202 Vali Acc: 0.511 Test Loss: 1003.202 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df128_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 56952325
model size : 287.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         540                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df128_ma540_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 63.0337917804718
Epoch: 1, Steps: 32 | Train Loss: 33.526 Vali Loss: 70.114 Vali Acc: 0.504 Test Loss: 70.114 Test Acc: 0.504
Validation loss decreased (inf --> -0.503116).  Saving model ...
Epoch: 2 cost time: 71.67718148231506
Epoch: 2, Steps: 32 | Train Loss: 61.851 Vali Loss: 70.608 Vali Acc: 0.336 Test Loss: 70.608 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 74.42174911499023
Epoch: 3, Steps: 32 | Train Loss: 47.984 Vali Loss: 82.396 Vali Acc: 0.443 Test Loss: 82.396 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 75.64422345161438
Epoch: 4, Steps: 32 | Train Loss: 33.428 Vali Loss: 183.905 Vali Acc: 0.527 Test Loss: 183.905 Test Acc: 0.527
Validation loss decreased (-0.503116 --> -0.524879).  Saving model ...
Epoch: 5 cost time: 75.66401314735413
Epoch: 5, Steps: 32 | Train Loss: 12.287 Vali Loss: 269.251 Vali Acc: 0.519 Test Loss: 269.251 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 76.34448456764221
Epoch: 6, Steps: 32 | Train Loss: 30.113 Vali Loss: 364.532 Vali Acc: 0.427 Test Loss: 364.532 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 75.79323029518127
Epoch: 7, Steps: 32 | Train Loss: 65.948 Vali Loss: 430.037 Vali Acc: 0.481 Test Loss: 430.037 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 76.76711201667786
Epoch: 8, Steps: 32 | Train Loss: 28.454 Vali Loss: 426.341 Vali Acc: 0.542 Test Loss: 426.341 Test Acc: 0.542
Validation loss decreased (-0.524879 --> -0.537721).  Saving model ...
Epoch: 9 cost time: 77.06707239151001
Epoch: 9, Steps: 32 | Train Loss: 19.074 Vali Loss: 407.316 Vali Acc: 0.519 Test Loss: 407.316 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 77.54828453063965
Epoch: 10, Steps: 32 | Train Loss: 6.161 Vali Loss: 903.442 Vali Acc: 0.519 Test Loss: 903.442 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 76.51281952857971
Epoch: 11, Steps: 32 | Train Loss: 62.390 Vali Loss: 450.073 Vali Acc: 0.504 Test Loss: 450.073 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 77.44936323165894
Epoch: 12, Steps: 32 | Train Loss: 3.674 Vali Loss: 460.551 Vali Acc: 0.458 Test Loss: 460.551 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 77.73339676856995
Epoch: 13, Steps: 32 | Train Loss: 4.089 Vali Loss: 508.622 Vali Acc: 0.427 Test Loss: 508.622 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 77.06395077705383
Epoch: 14, Steps: 32 | Train Loss: 17.374 Vali Loss: 572.889 Vali Acc: 0.443 Test Loss: 572.889 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 76.99902296066284
Epoch: 15, Steps: 32 | Train Loss: 8.594 Vali Loss: 1037.268 Vali Acc: 0.519 Test Loss: 1037.268 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 76.99891209602356
Epoch: 16, Steps: 32 | Train Loss: 24.287 Vali Loss: 1257.315 Vali Acc: 0.519 Test Loss: 1257.315 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 76.19618940353394
Epoch: 17, Steps: 32 | Train Loss: 25.825 Vali Loss: 1085.309 Vali Acc: 0.481 Test Loss: 1085.309 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 76.87357020378113
Epoch: 18, Steps: 32 | Train Loss: 35.087 Vali Loss: 821.661 Vali Acc: 0.473 Test Loss: 821.661 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df128_ma540_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 56952325
model size : 287.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df128_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 51.762150287628174
Epoch: 1, Steps: 32 | Train Loss: 40.620 Vali Loss: 72.870 Vali Acc: 0.466 Test Loss: 72.870 Test Acc: 0.466
Validation loss decreased (inf --> -0.464920).  Saving model ...
Epoch: 2 cost time: 57.30898451805115
Epoch: 2, Steps: 32 | Train Loss: 38.579 Vali Loss: 206.160 Vali Acc: 0.206 Test Loss: 206.160 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 59.69573736190796
Epoch: 3, Steps: 32 | Train Loss: 38.081 Vali Loss: 68.500 Vali Acc: 0.489 Test Loss: 68.500 Test Acc: 0.489
Validation loss decreased (-0.464920 --> -0.487865).  Saving model ...
Epoch: 4 cost time: 58.871094942092896
Epoch: 4, Steps: 32 | Train Loss: 20.382 Vali Loss: 273.206 Vali Acc: 0.511 Test Loss: 273.206 Test Acc: 0.511
Validation loss decreased (-0.487865 --> -0.508718).  Saving model ...
Epoch: 5 cost time: 60.17972421646118
Epoch: 5, Steps: 32 | Train Loss: 27.277 Vali Loss: 152.703 Vali Acc: 0.473 Test Loss: 152.703 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 59.54303002357483
Epoch: 6, Steps: 32 | Train Loss: 26.056 Vali Loss: 175.853 Vali Acc: 0.473 Test Loss: 175.853 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 60.46963858604431
Epoch: 7, Steps: 32 | Train Loss: 30.690 Vali Loss: 472.849 Vali Acc: 0.481 Test Loss: 472.849 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 60.49154090881348
Epoch: 8, Steps: 32 | Train Loss: 27.348 Vali Loss: 523.138 Vali Acc: 0.420 Test Loss: 523.138 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 60.11970353126526
Epoch: 9, Steps: 32 | Train Loss: 15.881 Vali Loss: 405.476 Vali Acc: 0.511 Test Loss: 405.476 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 60.62317180633545
Epoch: 10, Steps: 32 | Train Loss: 14.832 Vali Loss: 502.702 Vali Acc: 0.519 Test Loss: 502.702 Test Acc: 0.519
Validation loss decreased (-0.508718 --> -0.514057).  Saving model ...
Epoch: 11 cost time: 59.96071672439575
Epoch: 11, Steps: 32 | Train Loss: 34.412 Vali Loss: 606.981 Vali Acc: 0.504 Test Loss: 606.981 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 60.4508113861084
Epoch: 12, Steps: 32 | Train Loss: 12.453 Vali Loss: 517.628 Vali Acc: 0.458 Test Loss: 517.628 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 60.829174518585205
Epoch: 13, Steps: 32 | Train Loss: 6.247 Vali Loss: 436.540 Vali Acc: 0.458 Test Loss: 436.540 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 60.79856729507446
Epoch: 14, Steps: 32 | Train Loss: 35.064 Vali Loss: 545.481 Vali Acc: 0.290 Test Loss: 545.481 Test Acc: 0.290
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 61.23027300834656
Epoch: 15, Steps: 32 | Train Loss: 9.477 Vali Loss: 1070.350 Vali Acc: 0.511 Test Loss: 1070.350 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 60.90749502182007
Epoch: 16, Steps: 32 | Train Loss: 18.771 Vali Loss: 639.663 Vali Acc: 0.435 Test Loss: 639.663 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 60.473658084869385
Epoch: 17, Steps: 32 | Train Loss: 54.799 Vali Loss: 627.374 Vali Acc: 0.382 Test Loss: 627.374 Test Acc: 0.382
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 60.86357545852661
Epoch: 18, Steps: 32 | Train Loss: 9.707 Vali Loss: 628.412 Vali Acc: 0.542 Test Loss: 628.412 Test Acc: 0.542
Validation loss decreased (-0.514057 --> -0.535701).  Saving model ...
Epoch: 19 cost time: 61.01748728752136
Epoch: 19, Steps: 32 | Train Loss: 0.561 Vali Loss: 1039.104 Vali Acc: 0.519 Test Loss: 1039.104 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 61.06944537162781
Epoch: 20, Steps: 32 | Train Loss: 5.872 Vali Loss: 1017.905 Vali Acc: 0.519 Test Loss: 1017.905 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 60.89471387863159
Epoch: 21, Steps: 32 | Train Loss: 6.779 Vali Loss: 824.053 Vali Acc: 0.382 Test Loss: 824.053 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 60.746174812316895
Epoch: 22, Steps: 32 | Train Loss: 8.064 Vali Loss: 781.312 Vali Acc: 0.481 Test Loss: 781.312 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 61.196988582611084
Epoch: 23, Steps: 32 | Train Loss: 4.276 Vali Loss: 901.643 Vali Acc: 0.496 Test Loss: 901.643 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 60.80160307884216
Epoch: 24, Steps: 32 | Train Loss: 15.369 Vali Loss: 693.974 Vali Acc: 0.458 Test Loss: 693.974 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 61.18428134918213
Epoch: 25, Steps: 32 | Train Loss: 1.649 Vali Loss: 594.170 Vali Acc: 0.359 Test Loss: 594.170 Test Acc: 0.359
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 60.84660744667053
Epoch: 26, Steps: 32 | Train Loss: 14.110 Vali Loss: 814.382 Vali Acc: 0.359 Test Loss: 814.382 Test Acc: 0.359
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 61.44667959213257
Epoch: 27, Steps: 32 | Train Loss: 0.846 Vali Loss: 1031.294 Vali Acc: 0.504 Test Loss: 1031.294 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 61.11195182800293
Epoch: 28, Steps: 32 | Train Loss: 9.159 Vali Loss: 968.034 Vali Acc: 0.466 Test Loss: 968.034 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df128_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 56952325
model size : 287.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df128_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 40.81442475318909
Epoch: 1, Steps: 32 | Train Loss: 52.987 Vali Loss: 74.105 Vali Acc: 0.252 Test Loss: 74.105 Test Acc: 0.252
Validation loss decreased (inf --> -0.251167).  Saving model ...
Epoch: 2 cost time: 42.366694688797
Epoch: 2, Steps: 32 | Train Loss: 42.455 Vali Loss: 83.874 Vali Acc: 0.458 Test Loss: 83.874 Test Acc: 0.458
Validation loss decreased (-0.251167 --> -0.457177).  Saving model ...
Epoch: 3 cost time: 43.3201208114624
Epoch: 3, Steps: 32 | Train Loss: 55.056 Vali Loss: 135.269 Vali Acc: 0.527 Test Loss: 135.269 Test Acc: 0.527
Validation loss decreased (-0.457177 --> -0.525365).  Saving model ...
Epoch: 4 cost time: 43.736000061035156
Epoch: 4, Steps: 32 | Train Loss: 29.865 Vali Loss: 124.507 Vali Acc: 0.504 Test Loss: 124.507 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 43.67707300186157
Epoch: 5, Steps: 32 | Train Loss: 40.747 Vali Loss: 373.265 Vali Acc: 0.366 Test Loss: 373.265 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 43.82596135139465
Epoch: 6, Steps: 32 | Train Loss: 48.837 Vali Loss: 487.556 Vali Acc: 0.489 Test Loss: 487.556 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 43.78914141654968
Epoch: 7, Steps: 32 | Train Loss: 55.577 Vali Loss: 301.927 Vali Acc: 0.550 Test Loss: 301.927 Test Acc: 0.550
Validation loss decreased (-0.525365 --> -0.546599).  Saving model ...
Epoch: 8 cost time: 43.59171676635742
Epoch: 8, Steps: 32 | Train Loss: 17.283 Vali Loss: 486.446 Vali Acc: 0.511 Test Loss: 486.446 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 44.210904598236084
Epoch: 9, Steps: 32 | Train Loss: 11.724 Vali Loss: 268.180 Vali Acc: 0.473 Test Loss: 268.180 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 44.38127660751343
Epoch: 10, Steps: 32 | Train Loss: 14.849 Vali Loss: 391.863 Vali Acc: 0.519 Test Loss: 391.863 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 44.57771110534668
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 335.605 Vali Acc: 0.542 Test Loss: 335.605 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 44.49273109436035
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 333.983 Vali Acc: 0.542 Test Loss: 333.983 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 44.31105899810791
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 333.923 Vali Acc: 0.542 Test Loss: 333.923 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 44.53881120681763
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 333.920 Vali Acc: 0.542 Test Loss: 333.920 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 44.525559186935425
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 333.920 Vali Acc: 0.542 Test Loss: 333.920 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 44.65049505233765
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 333.920 Vali Acc: 0.542 Test Loss: 333.920 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 44.38328719139099
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 333.920 Vali Acc: 0.542 Test Loss: 333.920 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df128_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 56952325
model size : 287.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df128_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 34.89570879936218
Epoch: 1, Steps: 32 | Train Loss: 46.350 Vali Loss: 85.052 Vali Acc: 0.298 Test Loss: 85.052 Test Acc: 0.298
Validation loss decreased (inf --> -0.296859).  Saving model ...
Epoch: 2 cost time: 35.333070516586304
Epoch: 2, Steps: 32 | Train Loss: 78.339 Vali Loss: 269.698 Vali Acc: 0.344 Test Loss: 269.698 Test Acc: 0.344
Validation loss decreased (-0.296859 --> -0.340814).  Saving model ...
Epoch: 3 cost time: 35.26504111289978
Epoch: 3, Steps: 32 | Train Loss: 67.843 Vali Loss: 203.111 Vali Acc: 0.481 Test Loss: 203.111 Test Acc: 0.481
Validation loss decreased (-0.340814 --> -0.478885).  Saving model ...
Epoch: 4 cost time: 35.57481336593628
Epoch: 4, Steps: 32 | Train Loss: 35.771 Vali Loss: 223.098 Vali Acc: 0.519 Test Loss: 223.098 Test Acc: 0.519
Validation loss decreased (-0.478885 --> -0.516853).  Saving model ...
Epoch: 5 cost time: 35.95496129989624
Epoch: 5, Steps: 32 | Train Loss: 29.623 Vali Loss: 106.955 Vali Acc: 0.496 Test Loss: 106.955 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 36.191843032836914
Epoch: 6, Steps: 32 | Train Loss: 14.440 Vali Loss: 120.088 Vali Acc: 0.565 Test Loss: 120.088 Test Acc: 0.565
Validation loss decreased (-0.516853 --> -0.563685).  Saving model ...
Epoch: 7 cost time: 35.665313482284546
Epoch: 7, Steps: 32 | Train Loss: 44.787 Vali Loss: 146.888 Vali Acc: 0.519 Test Loss: 146.888 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 36.19717979431152
Epoch: 8, Steps: 32 | Train Loss: 18.029 Vali Loss: 421.005 Vali Acc: 0.321 Test Loss: 421.005 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 36.12977886199951
Epoch: 9, Steps: 32 | Train Loss: 28.938 Vali Loss: 334.778 Vali Acc: 0.527 Test Loss: 334.778 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 36.335736989974976
Epoch: 10, Steps: 32 | Train Loss: 15.284 Vali Loss: 371.996 Vali Acc: 0.489 Test Loss: 371.996 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 36.21091961860657
Epoch: 11, Steps: 32 | Train Loss: 12.345 Vali Loss: 434.653 Vali Acc: 0.412 Test Loss: 434.653 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 36.269044637680054
Epoch: 12, Steps: 32 | Train Loss: 22.564 Vali Loss: 481.774 Vali Acc: 0.504 Test Loss: 481.774 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 36.0546088218689
Epoch: 13, Steps: 32 | Train Loss: 22.098 Vali Loss: 709.643 Vali Acc: 0.496 Test Loss: 709.643 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 36.16883420944214
Epoch: 14, Steps: 32 | Train Loss: 19.519 Vali Loss: 493.649 Vali Acc: 0.405 Test Loss: 493.649 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 36.335442543029785
Epoch: 15, Steps: 32 | Train Loss: 2.969 Vali Loss: 408.355 Vali Acc: 0.527 Test Loss: 408.355 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 36.124218702316284
Epoch: 16, Steps: 32 | Train Loss: 6.543 Vali Loss: 421.909 Vali Acc: 0.496 Test Loss: 421.909 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl1_df128_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 56952325
model size : 287.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         8992                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma8992_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 356.4602723121643
Epoch: 1, Steps: 32 | Train Loss: 20.969 Vali Loss: 98.614 Vali Acc: 0.176 Test Loss: 98.614 Test Acc: 0.176
Validation loss decreased (inf --> -0.174586).  Saving model ...
Epoch: 2 cost time: 405.3711304664612
Epoch: 2, Steps: 32 | Train Loss: 29.391 Vali Loss: 48.733 Vali Acc: 0.336 Test Loss: 48.733 Test Acc: 0.336
Validation loss decreased (-0.174586 --> -0.335391).  Saving model ...
Epoch: 3 cost time: 437.07274293899536
Epoch: 3, Steps: 32 | Train Loss: 20.208 Vali Loss: 125.011 Vali Acc: 0.412 Test Loss: 125.011 Test Acc: 0.412
Validation loss decreased (-0.335391 --> -0.410964).  Saving model ...
Epoch: 4 cost time: 448.91715812683105
Epoch: 4, Steps: 32 | Train Loss: 20.784 Vali Loss: 98.890 Vali Acc: 0.412 Test Loss: 98.890 Test Acc: 0.412
Validation loss decreased (-0.410964 --> -0.411225).  Saving model ...
Epoch: 5 cost time: 454.83772921562195
Epoch: 5, Steps: 32 | Train Loss: 23.913 Vali Loss: 236.396 Vali Acc: 0.519 Test Loss: 236.396 Test Acc: 0.519
Validation loss decreased (-0.411225 --> -0.516720).  Saving model ...
Epoch: 6 cost time: 451.1911041736603
Epoch: 6, Steps: 32 | Train Loss: 35.773 Vali Loss: 156.646 Vali Acc: 0.504 Test Loss: 156.646 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 463.498722076416
Epoch: 7, Steps: 32 | Train Loss: 13.436 Vali Loss: 164.678 Vali Acc: 0.489 Test Loss: 164.678 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 458.7241532802582
Epoch: 8, Steps: 32 | Train Loss: 8.683 Vali Loss: 258.274 Vali Acc: 0.511 Test Loss: 258.274 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 458.4224417209625
Epoch: 9, Steps: 32 | Train Loss: 12.447 Vali Loss: 235.783 Vali Acc: 0.450 Test Loss: 235.783 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 465.751181602478
Epoch: 10, Steps: 32 | Train Loss: 4.789 Vali Loss: 278.988 Vali Acc: 0.504 Test Loss: 278.988 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 455.6341691017151
Epoch: 11, Steps: 32 | Train Loss: 16.770 Vali Loss: 273.159 Vali Acc: 0.405 Test Loss: 273.159 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 460.6498761177063
Epoch: 12, Steps: 32 | Train Loss: 19.149 Vali Loss: 301.823 Vali Acc: 0.466 Test Loss: 301.823 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 457.4833436012268
Epoch: 13, Steps: 32 | Train Loss: 23.096 Vali Loss: 516.608 Vali Acc: 0.504 Test Loss: 516.608 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 454.04870891571045
Epoch: 14, Steps: 32 | Train Loss: 31.261 Vali Loss: 337.257 Vali Acc: 0.443 Test Loss: 337.257 Test Acc: 0.443
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 457.82301783561707
Epoch: 15, Steps: 32 | Train Loss: 12.337 Vali Loss: 362.538 Vali Acc: 0.443 Test Loss: 362.538 Test Acc: 0.443
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma8992_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 28803845
model size : 145.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         7194                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma7194_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 289.07925271987915
Epoch: 1, Steps: 32 | Train Loss: 20.552 Vali Loss: 38.551 Vali Acc: 0.282 Test Loss: 38.551 Test Acc: 0.282
Validation loss decreased (inf --> -0.282057).  Saving model ...
Epoch: 2 cost time: 323.4347038269043
Epoch: 2, Steps: 32 | Train Loss: 22.816 Vali Loss: 82.920 Vali Acc: 0.450 Test Loss: 82.920 Test Acc: 0.450
Validation loss decreased (-0.282057 --> -0.449552).  Saving model ...
Epoch: 3 cost time: 350.6077024936676
Epoch: 3, Steps: 32 | Train Loss: 29.309 Vali Loss: 117.902 Vali Acc: 0.511 Test Loss: 117.902 Test Acc: 0.511
Validation loss decreased (-0.449552 --> -0.510271).  Saving model ...
Epoch: 4 cost time: 370.32570815086365
Epoch: 4, Steps: 32 | Train Loss: 17.906 Vali Loss: 131.849 Vali Acc: 0.458 Test Loss: 131.849 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 360.676726102829
Epoch: 5, Steps: 32 | Train Loss: 20.588 Vali Loss: 139.251 Vali Acc: 0.519 Test Loss: 139.251 Test Acc: 0.519
Validation loss decreased (-0.510271 --> -0.517691).  Saving model ...
Epoch: 6 cost time: 364.9129467010498
Epoch: 6, Steps: 32 | Train Loss: 12.317 Vali Loss: 166.595 Vali Acc: 0.427 Test Loss: 166.595 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 367.0790662765503
Epoch: 7, Steps: 32 | Train Loss: 21.328 Vali Loss: 225.206 Vali Acc: 0.542 Test Loss: 225.206 Test Acc: 0.542
Validation loss decreased (-0.517691 --> -0.539733).  Saving model ...
Epoch: 8 cost time: 366.844908952713
Epoch: 8, Steps: 32 | Train Loss: 19.671 Vali Loss: 208.475 Vali Acc: 0.427 Test Loss: 208.475 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 371.15256214141846
Epoch: 9, Steps: 32 | Train Loss: 3.594 Vali Loss: 208.823 Vali Acc: 0.511 Test Loss: 208.823 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 371.9555244445801
Epoch: 10, Steps: 32 | Train Loss: 13.623 Vali Loss: 336.866 Vali Acc: 0.489 Test Loss: 336.866 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 370.99158000946045
Epoch: 11, Steps: 32 | Train Loss: 4.202 Vali Loss: 238.252 Vali Acc: 0.473 Test Loss: 238.252 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 365.6934380531311
Epoch: 12, Steps: 32 | Train Loss: 25.024 Vali Loss: 355.410 Vali Acc: 0.527 Test Loss: 355.410 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 363.96738481521606
Epoch: 13, Steps: 32 | Train Loss: 38.028 Vali Loss: 284.740 Vali Acc: 0.504 Test Loss: 284.740 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 370.0409986972809
Epoch: 14, Steps: 32 | Train Loss: 26.037 Vali Loss: 291.512 Vali Acc: 0.466 Test Loss: 291.512 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 371.78872084617615
Epoch: 15, Steps: 32 | Train Loss: 8.710 Vali Loss: 304.560 Vali Acc: 0.550 Test Loss: 304.560 Test Acc: 0.550
Validation loss decreased (-0.539733 --> -0.546573).  Saving model ...
Epoch: 16 cost time: 373.7788770198822
Epoch: 16, Steps: 32 | Train Loss: 3.447 Vali Loss: 439.765 Vali Acc: 0.534 Test Loss: 439.765 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 374.28481459617615
Epoch: 17, Steps: 32 | Train Loss: 6.621 Vali Loss: 386.669 Vali Acc: 0.534 Test Loss: 386.669 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 374.9831876754761
Epoch: 18, Steps: 32 | Train Loss: 8.547 Vali Loss: 414.817 Vali Acc: 0.496 Test Loss: 414.817 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 374.73351073265076
Epoch: 19, Steps: 32 | Train Loss: 9.911 Vali Loss: 365.795 Vali Acc: 0.458 Test Loss: 365.795 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 376.90824913978577
Epoch: 20, Steps: 32 | Train Loss: 0.664 Vali Loss: 587.326 Vali Acc: 0.519 Test Loss: 587.326 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 373.56669211387634
Epoch: 21, Steps: 32 | Train Loss: 8.065 Vali Loss: 362.203 Vali Acc: 0.481 Test Loss: 362.203 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 376.2181055545807
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 449.770 Vali Acc: 0.511 Test Loss: 449.770 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 375.9477217197418
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 454.198 Vali Acc: 0.511 Test Loss: 454.198 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 376.81133103370667
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 454.357 Vali Acc: 0.511 Test Loss: 454.357 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 376.87099504470825
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 454.363 Vali Acc: 0.511 Test Loss: 454.363 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma7194_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 28803845
model size : 145.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5396                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma5396_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 222.49399590492249
Epoch: 1, Steps: 32 | Train Loss: 16.376 Vali Loss: 14.136 Vali Acc: 0.344 Test Loss: 14.136 Test Acc: 0.344
Validation loss decreased (inf --> -0.343370).  Saving model ...
Epoch: 2 cost time: 255.85370659828186
Epoch: 2, Steps: 32 | Train Loss: 16.233 Vali Loss: 71.537 Vali Acc: 0.473 Test Loss: 71.537 Test Acc: 0.473
Validation loss decreased (-0.343370 --> -0.472567).  Saving model ...
Epoch: 3 cost time: 266.5955584049225
Epoch: 3, Steps: 32 | Train Loss: 32.932 Vali Loss: 160.696 Vali Acc: 0.282 Test Loss: 160.696 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 274.5716550350189
Epoch: 4, Steps: 32 | Train Loss: 30.788 Vali Loss: 134.539 Vali Acc: 0.450 Test Loss: 134.539 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 278.13354325294495
Epoch: 5, Steps: 32 | Train Loss: 28.734 Vali Loss: 153.382 Vali Acc: 0.489 Test Loss: 153.382 Test Acc: 0.489
Validation loss decreased (-0.472567 --> -0.487016).  Saving model ...
Epoch: 6 cost time: 275.71335649490356
Epoch: 6, Steps: 32 | Train Loss: 20.995 Vali Loss: 177.708 Vali Acc: 0.344 Test Loss: 177.708 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 277.56182956695557
Epoch: 7, Steps: 32 | Train Loss: 20.068 Vali Loss: 170.752 Vali Acc: 0.397 Test Loss: 170.752 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 285.0614290237427
Epoch: 8, Steps: 32 | Train Loss: 4.841 Vali Loss: 187.491 Vali Acc: 0.519 Test Loss: 187.491 Test Acc: 0.519
Validation loss decreased (-0.487016 --> -0.517209).  Saving model ...
Epoch: 9 cost time: 285.79483556747437
Epoch: 9, Steps: 32 | Train Loss: 2.965 Vali Loss: 172.066 Vali Acc: 0.511 Test Loss: 172.066 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 285.330358505249
Epoch: 10, Steps: 32 | Train Loss: 3.527 Vali Loss: 198.331 Vali Acc: 0.344 Test Loss: 198.331 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 285.61467599868774
Epoch: 11, Steps: 32 | Train Loss: 4.262 Vali Loss: 209.160 Vali Acc: 0.550 Test Loss: 209.160 Test Acc: 0.550
Validation loss decreased (-0.517209 --> -0.547527).  Saving model ...
Epoch: 12 cost time: 285.95073795318604
Epoch: 12, Steps: 32 | Train Loss: 3.247 Vali Loss: 177.856 Vali Acc: 0.435 Test Loss: 177.856 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 284.844633102417
Epoch: 13, Steps: 32 | Train Loss: 2.904 Vali Loss: 274.478 Vali Acc: 0.519 Test Loss: 274.478 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 279.96826219558716
Epoch: 14, Steps: 32 | Train Loss: 11.284 Vali Loss: 316.352 Vali Acc: 0.336 Test Loss: 316.352 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 283.44353580474854
Epoch: 15, Steps: 32 | Train Loss: 16.192 Vali Loss: 316.278 Vali Acc: 0.496 Test Loss: 316.278 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 278.60569763183594
Epoch: 16, Steps: 32 | Train Loss: 31.597 Vali Loss: 456.977 Vali Acc: 0.489 Test Loss: 456.977 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 281.3533248901367
Epoch: 17, Steps: 32 | Train Loss: 34.292 Vali Loss: 328.655 Vali Acc: 0.489 Test Loss: 328.655 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 283.4462580680847
Epoch: 18, Steps: 32 | Train Loss: 12.532 Vali Loss: 416.066 Vali Acc: 0.397 Test Loss: 416.066 Test Acc: 0.397
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 280.28440022468567
Epoch: 19, Steps: 32 | Train Loss: 28.025 Vali Loss: 440.877 Vali Acc: 0.359 Test Loss: 440.877 Test Acc: 0.359
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 286.13697576522827
Epoch: 20, Steps: 32 | Train Loss: 5.020 Vali Loss: 545.235 Vali Acc: 0.458 Test Loss: 545.235 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 281.85853099823
Epoch: 21, Steps: 32 | Train Loss: 16.414 Vali Loss: 525.996 Vali Acc: 0.397 Test Loss: 525.996 Test Acc: 0.397
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma5396_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 28803845
model size : 145.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3597                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma3597_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 156.27091312408447
Epoch: 1, Steps: 32 | Train Loss: 15.722 Vali Loss: 39.867 Vali Acc: 0.183 Test Loss: 39.867 Test Acc: 0.183
Validation loss decreased (inf --> -0.182807).  Saving model ...
Epoch: 2 cost time: 175.1226909160614
Epoch: 2, Steps: 32 | Train Loss: 22.370 Vali Loss: 86.824 Vali Acc: 0.466 Test Loss: 86.824 Test Acc: 0.466
Validation loss decreased (-0.182807 --> -0.464781).  Saving model ...
Epoch: 3 cost time: 183.590265750885
Epoch: 3, Steps: 32 | Train Loss: 23.689 Vali Loss: 64.277 Vali Acc: 0.557 Test Loss: 64.277 Test Acc: 0.557
Validation loss decreased (-0.464781 --> -0.556609).  Saving model ...
Epoch: 4 cost time: 191.4236512184143
Epoch: 4, Steps: 32 | Train Loss: 15.643 Vali Loss: 109.279 Vali Acc: 0.580 Test Loss: 109.279 Test Acc: 0.580
Validation loss decreased (-0.556609 --> -0.579060).  Saving model ...
Epoch: 5 cost time: 189.48754930496216
Epoch: 5, Steps: 32 | Train Loss: 24.367 Vali Loss: 128.028 Vali Acc: 0.458 Test Loss: 128.028 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 193.74997758865356
Epoch: 6, Steps: 32 | Train Loss: 16.525 Vali Loss: 125.979 Vali Acc: 0.427 Test Loss: 125.979 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 192.66200375556946
Epoch: 7, Steps: 32 | Train Loss: 19.665 Vali Loss: 129.051 Vali Acc: 0.534 Test Loss: 129.051 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 193.96574020385742
Epoch: 8, Steps: 32 | Train Loss: 14.762 Vali Loss: 124.956 Vali Acc: 0.420 Test Loss: 124.956 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 194.6858847141266
Epoch: 9, Steps: 32 | Train Loss: 11.482 Vali Loss: 142.653 Vali Acc: 0.458 Test Loss: 142.653 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 196.33789825439453
Epoch: 10, Steps: 32 | Train Loss: 1.469 Vali Loss: 184.648 Vali Acc: 0.527 Test Loss: 184.648 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 196.41592502593994
Epoch: 11, Steps: 32 | Train Loss: 2.262 Vali Loss: 143.844 Vali Acc: 0.550 Test Loss: 143.844 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 194.62090706825256
Epoch: 12, Steps: 32 | Train Loss: 2.749 Vali Loss: 151.993 Vali Acc: 0.519 Test Loss: 151.993 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 195.76969408988953
Epoch: 13, Steps: 32 | Train Loss: 4.722 Vali Loss: 292.005 Vali Acc: 0.496 Test Loss: 292.005 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 195.5366930961609
Epoch: 14, Steps: 32 | Train Loss: 2.473 Vali Loss: 207.578 Vali Acc: 0.511 Test Loss: 207.578 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma3597_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 28803845
model size : 145.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1799                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 78.09075975418091
Epoch: 1, Steps: 32 | Train Loss: 15.249 Vali Loss: 60.926 Vali Acc: 0.160 Test Loss: 60.926 Test Acc: 0.160
Validation loss decreased (inf --> -0.159696).  Saving model ...
Epoch: 2 cost time: 90.0070903301239
Epoch: 2, Steps: 32 | Train Loss: 16.903 Vali Loss: 76.743 Vali Acc: 0.473 Test Loss: 76.743 Test Acc: 0.473
Validation loss decreased (-0.159696 --> -0.472515).  Saving model ...
Epoch: 3 cost time: 99.45463967323303
Epoch: 3, Steps: 32 | Train Loss: 13.090 Vali Loss: 68.495 Vali Acc: 0.511 Test Loss: 68.495 Test Acc: 0.511
Validation loss decreased (-0.472515 --> -0.510765).  Saving model ...
Epoch: 4 cost time: 99.28157186508179
Epoch: 4, Steps: 32 | Train Loss: 15.710 Vali Loss: 131.388 Vali Acc: 0.466 Test Loss: 131.388 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 97.2760877609253
Epoch: 5, Steps: 32 | Train Loss: 32.267 Vali Loss: 160.239 Vali Acc: 0.534 Test Loss: 160.239 Test Acc: 0.534
Validation loss decreased (-0.510765 --> -0.532749).  Saving model ...
Epoch: 6 cost time: 100.40452075004578
Epoch: 6, Steps: 32 | Train Loss: 19.774 Vali Loss: 198.013 Vali Acc: 0.481 Test Loss: 198.013 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 98.47844552993774
Epoch: 7, Steps: 32 | Train Loss: 13.614 Vali Loss: 181.682 Vali Acc: 0.427 Test Loss: 181.682 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 99.75910758972168
Epoch: 8, Steps: 32 | Train Loss: 14.668 Vali Loss: 174.218 Vali Acc: 0.366 Test Loss: 174.218 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 99.92130088806152
Epoch: 9, Steps: 32 | Train Loss: 8.297 Vali Loss: 208.636 Vali Acc: 0.504 Test Loss: 208.636 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 99.5901267528534
Epoch: 10, Steps: 32 | Train Loss: 24.042 Vali Loss: 229.676 Vali Acc: 0.519 Test Loss: 229.676 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 101.10061812400818
Epoch: 11, Steps: 32 | Train Loss: 7.546 Vali Loss: 221.362 Vali Acc: 0.450 Test Loss: 221.362 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 98.63738942146301
Epoch: 12, Steps: 32 | Train Loss: 21.880 Vali Loss: 228.597 Vali Acc: 0.450 Test Loss: 228.597 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 100.0915138721466
Epoch: 13, Steps: 32 | Train Loss: 16.397 Vali Loss: 229.452 Vali Acc: 0.473 Test Loss: 229.452 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 102.08525705337524
Epoch: 14, Steps: 32 | Train Loss: 2.128 Vali Loss: 326.275 Vali Acc: 0.435 Test Loss: 326.275 Test Acc: 0.435
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 101.38469409942627
Epoch: 15, Steps: 32 | Train Loss: 0.832 Vali Loss: 288.808 Vali Acc: 0.557 Test Loss: 288.808 Test Acc: 0.557
Validation loss decreased (-0.532749 --> -0.554364).  Saving model ...
Epoch: 16 cost time: 101.33839583396912
Epoch: 16, Steps: 32 | Train Loss: 3.819 Vali Loss: 328.741 Vali Acc: 0.405 Test Loss: 328.741 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 100.40067148208618
Epoch: 17, Steps: 32 | Train Loss: 12.472 Vali Loss: 620.143 Vali Acc: 0.511 Test Loss: 620.143 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 100.86165595054626
Epoch: 18, Steps: 32 | Train Loss: 3.913 Vali Loss: 357.910 Vali Acc: 0.405 Test Loss: 357.910 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 100.70912384986877
Epoch: 19, Steps: 32 | Train Loss: 20.959 Vali Loss: 357.330 Vali Acc: 0.489 Test Loss: 357.330 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 100.84129309654236
Epoch: 20, Steps: 32 | Train Loss: 7.475 Vali Loss: 370.593 Vali Acc: 0.420 Test Loss: 370.593 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 102.25783109664917
Epoch: 21, Steps: 32 | Train Loss: 0.045 Vali Loss: 477.713 Vali Acc: 0.542 Test Loss: 477.713 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 102.39098191261292
Epoch: 22, Steps: 32 | Train Loss: 3.546 Vali Loss: 534.896 Vali Acc: 0.443 Test Loss: 534.896 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 101.70897769927979
Epoch: 23, Steps: 32 | Train Loss: 0.036 Vali Loss: 504.553 Vali Acc: 0.534 Test Loss: 504.553 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 102.67755818367004
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 543.492 Vali Acc: 0.489 Test Loss: 543.492 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 101.19039034843445
Epoch: 25, Steps: 32 | Train Loss: 9.454 Vali Loss: 385.551 Vali Acc: 0.389 Test Loss: 385.551 Test Acc: 0.389
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 28803845
model size : 145.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 48.53977823257446
Epoch: 1, Steps: 32 | Train Loss: 15.371 Vali Loss: 15.307 Vali Acc: 0.359 Test Loss: 15.307 Test Acc: 0.359
Validation loss decreased (inf --> -0.358626).  Saving model ...
Epoch: 2 cost time: 56.143685817718506
Epoch: 2, Steps: 32 | Train Loss: 14.150 Vali Loss: 40.568 Vali Acc: 0.511 Test Loss: 40.568 Test Acc: 0.511
Validation loss decreased (-0.358626 --> -0.511045).  Saving model ...
Epoch: 3 cost time: 58.25979566574097
Epoch: 3, Steps: 32 | Train Loss: 12.497 Vali Loss: 58.340 Vali Acc: 0.489 Test Loss: 58.340 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 58.34758424758911
Epoch: 4, Steps: 32 | Train Loss: 11.486 Vali Loss: 103.763 Vali Acc: 0.496 Test Loss: 103.763 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 59.64373469352722
Epoch: 5, Steps: 32 | Train Loss: 34.975 Vali Loss: 125.681 Vali Acc: 0.519 Test Loss: 125.681 Test Acc: 0.519
Validation loss decreased (-0.511045 --> -0.517827).  Saving model ...
Epoch: 6 cost time: 59.08072543144226
Epoch: 6, Steps: 32 | Train Loss: 21.020 Vali Loss: 107.297 Vali Acc: 0.412 Test Loss: 107.297 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 60.45401978492737
Epoch: 7, Steps: 32 | Train Loss: 3.831 Vali Loss: 173.868 Vali Acc: 0.427 Test Loss: 173.868 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 59.99959635734558
Epoch: 8, Steps: 32 | Train Loss: 9.447 Vali Loss: 209.552 Vali Acc: 0.496 Test Loss: 209.552 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 60.45789980888367
Epoch: 9, Steps: 32 | Train Loss: 9.928 Vali Loss: 234.441 Vali Acc: 0.305 Test Loss: 234.441 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 59.78489589691162
Epoch: 10, Steps: 32 | Train Loss: 13.524 Vali Loss: 190.566 Vali Acc: 0.458 Test Loss: 190.566 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 60.28898096084595
Epoch: 11, Steps: 32 | Train Loss: 1.607 Vali Loss: 406.927 Vali Acc: 0.473 Test Loss: 406.927 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 60.185869455337524
Epoch: 12, Steps: 32 | Train Loss: 6.371 Vali Loss: 267.210 Vali Acc: 0.534 Test Loss: 267.210 Test Acc: 0.534
Validation loss decreased (-0.517827 --> -0.531679).  Saving model ...
Epoch: 13 cost time: 59.930315017700195
Epoch: 13, Steps: 32 | Train Loss: 25.071 Vali Loss: 438.052 Vali Acc: 0.496 Test Loss: 438.052 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 59.29175114631653
Epoch: 14, Steps: 32 | Train Loss: 30.469 Vali Loss: 458.164 Vali Acc: 0.496 Test Loss: 458.164 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 59.57632637023926
Epoch: 15, Steps: 32 | Train Loss: 14.119 Vali Loss: 413.870 Vali Acc: 0.511 Test Loss: 413.870 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 60.00583004951477
Epoch: 16, Steps: 32 | Train Loss: 14.678 Vali Loss: 524.683 Vali Acc: 0.511 Test Loss: 524.683 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 59.202123165130615
Epoch: 17, Steps: 32 | Train Loss: 48.181 Vali Loss: 566.841 Vali Acc: 0.366 Test Loss: 566.841 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 59.69557738304138
Epoch: 18, Steps: 32 | Train Loss: 19.173 Vali Loss: 390.078 Vali Acc: 0.473 Test Loss: 390.078 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 59.87504553794861
Epoch: 19, Steps: 32 | Train Loss: 7.946 Vali Loss: 394.039 Vali Acc: 0.351 Test Loss: 394.039 Test Acc: 0.351
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 60.363558769226074
Epoch: 20, Steps: 32 | Train Loss: 1.635 Vali Loss: 563.434 Vali Acc: 0.496 Test Loss: 563.434 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 60.15534424781799
Epoch: 21, Steps: 32 | Train Loss: 4.282 Vali Loss: 484.311 Vali Acc: 0.458 Test Loss: 484.311 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 59.85538053512573
Epoch: 22, Steps: 32 | Train Loss: 1.268 Vali Loss: 496.823 Vali Acc: 0.511 Test Loss: 496.823 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 28803845
model size : 145.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         540                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma540_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 37.308024168014526
Epoch: 1, Steps: 32 | Train Loss: 13.906 Vali Loss: 58.464 Vali Acc: 0.282 Test Loss: 58.464 Test Acc: 0.282
Validation loss decreased (inf --> -0.281858).  Saving model ...
Epoch: 2 cost time: 40.05125427246094
Epoch: 2, Steps: 32 | Train Loss: 23.864 Vali Loss: 57.925 Vali Acc: 0.321 Test Loss: 57.925 Test Acc: 0.321
Validation loss decreased (-0.281858 --> -0.320031).  Saving model ...
Epoch: 3 cost time: 42.296717405319214
Epoch: 3, Steps: 32 | Train Loss: 17.912 Vali Loss: 81.264 Vali Acc: 0.473 Test Loss: 81.264 Test Acc: 0.473
Validation loss decreased (-0.320031 --> -0.472470).  Saving model ...
Epoch: 4 cost time: 43.5466411113739
Epoch: 4, Steps: 32 | Train Loss: 14.929 Vali Loss: 89.864 Vali Acc: 0.443 Test Loss: 89.864 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 44.37006711959839
Epoch: 5, Steps: 32 | Train Loss: 5.702 Vali Loss: 119.342 Vali Acc: 0.489 Test Loss: 119.342 Test Acc: 0.489
Validation loss decreased (-0.472470 --> -0.487356).  Saving model ...
Epoch: 6 cost time: 43.7450737953186
Epoch: 6, Steps: 32 | Train Loss: 5.303 Vali Loss: 137.632 Vali Acc: 0.458 Test Loss: 137.632 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 43.371405363082886
Epoch: 7, Steps: 32 | Train Loss: 29.627 Vali Loss: 140.617 Vali Acc: 0.412 Test Loss: 140.617 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 43.675586223602295
Epoch: 8, Steps: 32 | Train Loss: 15.597 Vali Loss: 279.488 Vali Acc: 0.481 Test Loss: 279.488 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 44.17884278297424
Epoch: 9, Steps: 32 | Train Loss: 9.879 Vali Loss: 215.376 Vali Acc: 0.481 Test Loss: 215.376 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 43.859747886657715
Epoch: 10, Steps: 32 | Train Loss: 8.359 Vali Loss: 217.676 Vali Acc: 0.443 Test Loss: 217.676 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 44.227216958999634
Epoch: 11, Steps: 32 | Train Loss: 7.988 Vali Loss: 202.130 Vali Acc: 0.443 Test Loss: 202.130 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 44.21722078323364
Epoch: 12, Steps: 32 | Train Loss: 0.768 Vali Loss: 330.031 Vali Acc: 0.473 Test Loss: 330.031 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 44.0705451965332
Epoch: 13, Steps: 32 | Train Loss: 8.124 Vali Loss: 457.482 Vali Acc: 0.443 Test Loss: 457.482 Test Acc: 0.443
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 44.120356798172
Epoch: 14, Steps: 32 | Train Loss: 6.129 Vali Loss: 357.872 Vali Acc: 0.443 Test Loss: 357.872 Test Acc: 0.443
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 44.36039161682129
Epoch: 15, Steps: 32 | Train Loss: 0.344 Vali Loss: 208.436 Vali Acc: 0.397 Test Loss: 208.436 Test Acc: 0.397
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma540_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 28803845
model size : 145.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 32.268481731414795
Epoch: 1, Steps: 32 | Train Loss: 21.623 Vali Loss: 32.104 Vali Acc: 0.260 Test Loss: 32.104 Test Acc: 0.260
Validation loss decreased (inf --> -0.259221).  Saving model ...
Epoch: 2 cost time: 34.096832275390625
Epoch: 2, Steps: 32 | Train Loss: 14.832 Vali Loss: 67.696 Vali Acc: 0.443 Test Loss: 67.696 Test Acc: 0.443
Validation loss decreased (-0.259221 --> -0.442071).  Saving model ...
Epoch: 3 cost time: 34.64543700218201
Epoch: 3, Steps: 32 | Train Loss: 24.484 Vali Loss: 141.045 Vali Acc: 0.481 Test Loss: 141.045 Test Acc: 0.481
Validation loss decreased (-0.442071 --> -0.479506).  Saving model ...
Epoch: 4 cost time: 35.697041749954224
Epoch: 4, Steps: 32 | Train Loss: 14.820 Vali Loss: 80.581 Vali Acc: 0.382 Test Loss: 80.581 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 35.48577857017517
Epoch: 5, Steps: 32 | Train Loss: 21.129 Vali Loss: 131.180 Vali Acc: 0.473 Test Loss: 131.180 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 35.79272985458374
Epoch: 6, Steps: 32 | Train Loss: 12.646 Vali Loss: 191.502 Vali Acc: 0.466 Test Loss: 191.502 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 36.24701547622681
Epoch: 7, Steps: 32 | Train Loss: 11.592 Vali Loss: 255.354 Vali Acc: 0.290 Test Loss: 255.354 Test Acc: 0.290
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 35.62658500671387
Epoch: 8, Steps: 32 | Train Loss: 21.343 Vali Loss: 299.388 Vali Acc: 0.496 Test Loss: 299.388 Test Acc: 0.496
Validation loss decreased (-0.479506 --> -0.493189).  Saving model ...
Epoch: 9 cost time: 35.849273681640625
Epoch: 9, Steps: 32 | Train Loss: 12.331 Vali Loss: 204.287 Vali Acc: 0.412 Test Loss: 204.287 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 35.64970064163208
Epoch: 10, Steps: 32 | Train Loss: 4.691 Vali Loss: 294.763 Vali Acc: 0.466 Test Loss: 294.763 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 36.396883487701416
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 214.337 Vali Acc: 0.481 Test Loss: 214.337 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 36.1284396648407
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 211.864 Vali Acc: 0.489 Test Loss: 211.864 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 35.91716694831848
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 211.773 Vali Acc: 0.489 Test Loss: 211.773 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 36.2727837562561
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 211.770 Vali Acc: 0.489 Test Loss: 211.770 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 36.18230199813843
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 211.769 Vali Acc: 0.489 Test Loss: 211.769 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 36.09317111968994
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 211.769 Vali Acc: 0.489 Test Loss: 211.769 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 36.010300159454346
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 211.769 Vali Acc: 0.489 Test Loss: 211.769 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 36.096874475479126
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 211.769 Vali Acc: 0.489 Test Loss: 211.769 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4961832061068702
model parameter : 28803845
model size : 145.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 26.651520490646362
Epoch: 1, Steps: 32 | Train Loss: 11.528 Vali Loss: 55.861 Vali Acc: 0.198 Test Loss: 55.861 Test Acc: 0.198
Validation loss decreased (inf --> -0.197915).  Saving model ...
Epoch: 2 cost time: 26.386173725128174
Epoch: 2, Steps: 32 | Train Loss: 25.010 Vali Loss: 67.195 Vali Acc: 0.305 Test Loss: 67.195 Test Acc: 0.305
Validation loss decreased (-0.197915 --> -0.304672).  Saving model ...
Epoch: 3 cost time: 27.173967599868774
Epoch: 3, Steps: 32 | Train Loss: 27.414 Vali Loss: 66.058 Vali Acc: 0.511 Test Loss: 66.058 Test Acc: 0.511
Validation loss decreased (-0.304672 --> -0.510790).  Saving model ...
Epoch: 4 cost time: 27.54840064048767
Epoch: 4, Steps: 32 | Train Loss: 17.606 Vali Loss: 80.331 Vali Acc: 0.565 Test Loss: 80.331 Test Acc: 0.565
Validation loss decreased (-0.510790 --> -0.564082).  Saving model ...
Epoch: 5 cost time: 27.77881145477295
Epoch: 5, Steps: 32 | Train Loss: 2.464 Vali Loss: 138.012 Vali Acc: 0.359 Test Loss: 138.012 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 27.452072381973267
Epoch: 6, Steps: 32 | Train Loss: 24.462 Vali Loss: 106.882 Vali Acc: 0.427 Test Loss: 106.882 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 27.58060312271118
Epoch: 7, Steps: 32 | Train Loss: 17.399 Vali Loss: 116.986 Vali Acc: 0.397 Test Loss: 116.986 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 27.80064821243286
Epoch: 8, Steps: 32 | Train Loss: 23.575 Vali Loss: 202.577 Vali Acc: 0.427 Test Loss: 202.577 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 27.605960845947266
Epoch: 9, Steps: 32 | Train Loss: 34.858 Vali Loss: 347.000 Vali Acc: 0.496 Test Loss: 347.000 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 28.010764122009277
Epoch: 10, Steps: 32 | Train Loss: 12.769 Vali Loss: 259.023 Vali Acc: 0.489 Test Loss: 259.023 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 27.68934440612793
Epoch: 11, Steps: 32 | Train Loss: 8.216 Vali Loss: 198.523 Vali Acc: 0.450 Test Loss: 198.523 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 27.87070631980896
Epoch: 12, Steps: 32 | Train Loss: 10.473 Vali Loss: 271.255 Vali Acc: 0.473 Test Loss: 271.255 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 27.819634914398193
Epoch: 13, Steps: 32 | Train Loss: 8.465 Vali Loss: 279.135 Vali Acc: 0.511 Test Loss: 279.135 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 27.7471764087677
Epoch: 14, Steps: 32 | Train Loss: 7.126 Vali Loss: 210.994 Vali Acc: 0.496 Test Loss: 210.994 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 28803845
model size : 145.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 23.690453052520752
Epoch: 1, Steps: 32 | Train Loss: 13.032 Vali Loss: 35.968 Vali Acc: 0.328 Test Loss: 35.968 Test Acc: 0.328
Validation loss decreased (inf --> -0.327885).  Saving model ...
Epoch: 2 cost time: 22.982362985610962
Epoch: 2, Steps: 32 | Train Loss: 24.216 Vali Loss: 53.848 Vali Acc: 0.366 Test Loss: 53.848 Test Acc: 0.366
Validation loss decreased (-0.327885 --> -0.365874).  Saving model ...
Epoch: 3 cost time: 23.451639890670776
Epoch: 3, Steps: 32 | Train Loss: 29.405 Vali Loss: 65.042 Vali Acc: 0.504 Test Loss: 65.042 Test Acc: 0.504
Validation loss decreased (-0.365874 --> -0.503166).  Saving model ...
Epoch: 4 cost time: 23.456347703933716
Epoch: 4, Steps: 32 | Train Loss: 6.154 Vali Loss: 92.126 Vali Acc: 0.481 Test Loss: 92.126 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 23.815152883529663
Epoch: 5, Steps: 32 | Train Loss: 13.793 Vali Loss: 69.154 Vali Acc: 0.496 Test Loss: 69.154 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 23.57027554512024
Epoch: 6, Steps: 32 | Train Loss: 32.755 Vali Loss: 114.597 Vali Acc: 0.412 Test Loss: 114.597 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 23.649771690368652
Epoch: 7, Steps: 32 | Train Loss: 22.269 Vali Loss: 189.688 Vali Acc: 0.435 Test Loss: 189.688 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 23.941213369369507
Epoch: 8, Steps: 32 | Train Loss: 5.072 Vali Loss: 78.365 Vali Acc: 0.519 Test Loss: 78.365 Test Acc: 0.519
Validation loss decreased (-0.503166 --> -0.518300).  Saving model ...
Epoch: 9 cost time: 23.662678718566895
Epoch: 9, Steps: 32 | Train Loss: 9.633 Vali Loss: 118.898 Vali Acc: 0.466 Test Loss: 118.898 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 23.866340160369873
Epoch: 10, Steps: 32 | Train Loss: 12.921 Vali Loss: 124.090 Vali Acc: 0.542 Test Loss: 124.090 Test Acc: 0.542
Validation loss decreased (-0.518300 --> -0.540744).  Saving model ...
Epoch: 11 cost time: 23.86136221885681
Epoch: 11, Steps: 32 | Train Loss: 6.509 Vali Loss: 120.088 Vali Acc: 0.397 Test Loss: 120.088 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 23.61602020263672
Epoch: 12, Steps: 32 | Train Loss: 8.050 Vali Loss: 91.375 Vali Acc: 0.504 Test Loss: 91.375 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 23.868034601211548
Epoch: 13, Steps: 32 | Train Loss: 2.172 Vali Loss: 323.971 Vali Acc: 0.351 Test Loss: 323.971 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 23.771921634674072
Epoch: 14, Steps: 32 | Train Loss: 6.689 Vali Loss: 258.584 Vali Acc: 0.496 Test Loss: 258.584 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 23.722029209136963
Epoch: 15, Steps: 32 | Train Loss: 10.804 Vali Loss: 274.811 Vali Acc: 0.496 Test Loss: 274.811 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 23.71356773376465
Epoch: 16, Steps: 32 | Train Loss: 6.697 Vali Loss: 264.386 Vali Acc: 0.366 Test Loss: 264.386 Test Acc: 0.366
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 23.769739151000977
Epoch: 17, Steps: 32 | Train Loss: 24.879 Vali Loss: 254.867 Vali Acc: 0.443 Test Loss: 254.867 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 23.692850351333618
Epoch: 18, Steps: 32 | Train Loss: 12.791 Vali Loss: 334.053 Vali Acc: 0.427 Test Loss: 334.053 Test Acc: 0.427
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 23.79663920402527
Epoch: 19, Steps: 32 | Train Loss: 10.323 Vali Loss: 272.000 Vali Acc: 0.405 Test Loss: 272.000 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 23.85892105102539
Epoch: 20, Steps: 32 | Train Loss: 4.188 Vali Loss: 318.388 Vali Acc: 0.473 Test Loss: 318.388 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df2048_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 28803845
model size : 145.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         8992                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma8992_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 352.1205036640167
Epoch: 1, Steps: 32 | Train Loss: 21.120 Vali Loss: 33.502 Vali Acc: 0.260 Test Loss: 33.502 Test Acc: 0.260
Validation loss decreased (inf --> -0.259207).  Saving model ...
Epoch: 2 cost time: 396.5245051383972
Epoch: 2, Steps: 32 | Train Loss: 23.885 Vali Loss: 45.529 Vali Acc: 0.496 Test Loss: 45.529 Test Acc: 0.496
Validation loss decreased (-0.259207 --> -0.495728).  Saving model ...
Epoch: 3 cost time: 445.42378067970276
Epoch: 3, Steps: 32 | Train Loss: 22.658 Vali Loss: 102.528 Vali Acc: 0.405 Test Loss: 102.528 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 422.47100281715393
Epoch: 4, Steps: 32 | Train Loss: 37.588 Vali Loss: 221.376 Vali Acc: 0.282 Test Loss: 221.376 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 447.78212785720825
Epoch: 5, Steps: 32 | Train Loss: 26.568 Vali Loss: 186.343 Vali Acc: 0.351 Test Loss: 186.343 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 456.7469439506531
Epoch: 6, Steps: 32 | Train Loss: 18.193 Vali Loss: 194.589 Vali Acc: 0.519 Test Loss: 194.589 Test Acc: 0.519
Validation loss decreased (-0.495728 --> -0.517138).  Saving model ...
Epoch: 7 cost time: 456.57873940467834
Epoch: 7, Steps: 32 | Train Loss: 4.788 Vali Loss: 267.935 Vali Acc: 0.519 Test Loss: 267.935 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 450.85267639160156
Epoch: 8, Steps: 32 | Train Loss: 16.010 Vali Loss: 158.921 Vali Acc: 0.427 Test Loss: 158.921 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 456.89033246040344
Epoch: 9, Steps: 32 | Train Loss: 14.225 Vali Loss: 234.657 Vali Acc: 0.504 Test Loss: 234.657 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 459.6139359474182
Epoch: 10, Steps: 32 | Train Loss: 6.896 Vali Loss: 206.043 Vali Acc: 0.550 Test Loss: 206.043 Test Acc: 0.550
Validation loss decreased (-0.517138 --> -0.547558).  Saving model ...
Epoch: 11 cost time: 463.54901146888733
Epoch: 11, Steps: 32 | Train Loss: 1.035 Vali Loss: 339.980 Vali Acc: 0.542 Test Loss: 339.980 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 462.7098562717438
Epoch: 12, Steps: 32 | Train Loss: 2.784 Vali Loss: 259.282 Vali Acc: 0.466 Test Loss: 259.282 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 461.4388630390167
Epoch: 13, Steps: 32 | Train Loss: 5.245 Vali Loss: 231.514 Vali Acc: 0.519 Test Loss: 231.514 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 457.40747141838074
Epoch: 14, Steps: 32 | Train Loss: 16.725 Vali Loss: 296.934 Vali Acc: 0.458 Test Loss: 296.934 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 459.6638720035553
Epoch: 15, Steps: 32 | Train Loss: 16.908 Vali Loss: 400.332 Vali Acc: 0.450 Test Loss: 400.332 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 463.1847982406616
Epoch: 16, Steps: 32 | Train Loss: 3.942 Vali Loss: 306.664 Vali Acc: 0.443 Test Loss: 306.664 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 463.0326843261719
Epoch: 17, Steps: 32 | Train Loss: 0.110 Vali Loss: 340.575 Vali Acc: 0.466 Test Loss: 340.575 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 463.9369306564331
Epoch: 18, Steps: 32 | Train Loss: 0.341 Vali Loss: 333.843 Vali Acc: 0.427 Test Loss: 333.843 Test Acc: 0.427
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 466.3030905723572
Epoch: 19, Steps: 32 | Train Loss: 0.750 Vali Loss: 320.644 Vali Acc: 0.382 Test Loss: 320.644 Test Acc: 0.382
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 464.3627390861511
Epoch: 20, Steps: 32 | Train Loss: 1.788 Vali Loss: 369.685 Vali Acc: 0.489 Test Loss: 369.685 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma8992_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 27230981
model size : 139.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         7194                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma7194_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 283.40777134895325
Epoch: 1, Steps: 32 | Train Loss: 17.648 Vali Loss: 27.848 Vali Acc: 0.344 Test Loss: 27.848 Test Acc: 0.344
Validation loss decreased (inf --> -0.343233).  Saving model ...
Epoch: 2 cost time: 323.3445358276367
Epoch: 2, Steps: 32 | Train Loss: 16.007 Vali Loss: 50.269 Vali Acc: 0.481 Test Loss: 50.269 Test Acc: 0.481
Validation loss decreased (-0.343233 --> -0.480413).  Saving model ...
Epoch: 3 cost time: 352.5172643661499
Epoch: 3, Steps: 32 | Train Loss: 16.327 Vali Loss: 149.422 Vali Acc: 0.382 Test Loss: 149.422 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 352.1152174472809
Epoch: 4, Steps: 32 | Train Loss: 34.041 Vali Loss: 111.939 Vali Acc: 0.382 Test Loss: 111.939 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 366.5617151260376
Epoch: 5, Steps: 32 | Train Loss: 11.176 Vali Loss: 126.750 Vali Acc: 0.458 Test Loss: 126.750 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 358.39293599128723
Epoch: 6, Steps: 32 | Train Loss: 38.909 Vali Loss: 194.309 Vali Acc: 0.489 Test Loss: 194.309 Test Acc: 0.489
Validation loss decreased (-0.480413 --> -0.486607).  Saving model ...
Epoch: 7 cost time: 361.82881569862366
Epoch: 7, Steps: 32 | Train Loss: 32.914 Vali Loss: 223.378 Vali Acc: 0.496 Test Loss: 223.378 Test Acc: 0.496
Validation loss decreased (-0.486607 --> -0.493949).  Saving model ...
Epoch: 8 cost time: 371.22859740257263
Epoch: 8, Steps: 32 | Train Loss: 14.578 Vali Loss: 255.254 Vali Acc: 0.321 Test Loss: 255.254 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 365.74911403656006
Epoch: 9, Steps: 32 | Train Loss: 15.534 Vali Loss: 270.641 Vali Acc: 0.489 Test Loss: 270.641 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 370.52275252342224
Epoch: 10, Steps: 32 | Train Loss: 3.833 Vali Loss: 259.775 Vali Acc: 0.527 Test Loss: 259.775 Test Acc: 0.527
Validation loss decreased (-0.493949 --> -0.524120).  Saving model ...
Epoch: 11 cost time: 360.7954685688019
Epoch: 11, Steps: 32 | Train Loss: 12.573 Vali Loss: 306.707 Vali Acc: 0.519 Test Loss: 306.707 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 367.40609192848206
Epoch: 12, Steps: 32 | Train Loss: 11.206 Vali Loss: 273.064 Vali Acc: 0.534 Test Loss: 273.064 Test Acc: 0.534
Validation loss decreased (-0.524120 --> -0.531621).  Saving model ...
Epoch: 13 cost time: 372.70666337013245
Epoch: 13, Steps: 32 | Train Loss: 4.131 Vali Loss: 247.504 Vali Acc: 0.550 Test Loss: 247.504 Test Acc: 0.550
Validation loss decreased (-0.531621 --> -0.547143).  Saving model ...
Epoch: 14 cost time: 367.5334949493408
Epoch: 14, Steps: 32 | Train Loss: 3.814 Vali Loss: 407.719 Vali Acc: 0.527 Test Loss: 407.719 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 368.616313457489
Epoch: 15, Steps: 32 | Train Loss: 8.996 Vali Loss: 321.040 Vali Acc: 0.458 Test Loss: 321.040 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 373.27483797073364
Epoch: 16, Steps: 32 | Train Loss: 1.019 Vali Loss: 249.315 Vali Acc: 0.550 Test Loss: 249.315 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 375.8310778141022
Epoch: 17, Steps: 32 | Train Loss: 0.163 Vali Loss: 276.918 Vali Acc: 0.527 Test Loss: 276.918 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 371.2353699207306
Epoch: 18, Steps: 32 | Train Loss: 1.962 Vali Loss: 497.731 Vali Acc: 0.336 Test Loss: 497.731 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 367.5069890022278
Epoch: 19, Steps: 32 | Train Loss: 20.167 Vali Loss: 320.295 Vali Acc: 0.435 Test Loss: 320.295 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 369.1106688976288
Epoch: 20, Steps: 32 | Train Loss: 8.232 Vali Loss: 419.090 Vali Acc: 0.435 Test Loss: 419.090 Test Acc: 0.435
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 370.8279507160187
Epoch: 21, Steps: 32 | Train Loss: 6.503 Vali Loss: 516.083 Vali Acc: 0.550 Test Loss: 516.083 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 368.12319922447205
Epoch: 22, Steps: 32 | Train Loss: 12.878 Vali Loss: 520.520 Vali Acc: 0.420 Test Loss: 520.520 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 362.0794997215271
Epoch: 23, Steps: 32 | Train Loss: 31.314 Vali Loss: 822.441 Vali Acc: 0.229 Test Loss: 822.441 Test Acc: 0.229
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma7194_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 27230981
model size : 139.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5396                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma5396_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 217.3678436279297
Epoch: 1, Steps: 32 | Train Loss: 26.228 Vali Loss: 62.540 Vali Acc: 0.191 Test Loss: 62.540 Test Acc: 0.191
Validation loss decreased (inf --> -0.190214).  Saving model ...
Epoch: 2 cost time: 254.47187280654907
Epoch: 2, Steps: 32 | Train Loss: 20.308 Vali Loss: 83.616 Vali Acc: 0.466 Test Loss: 83.616 Test Acc: 0.466
Validation loss decreased (-0.190214 --> -0.464813).  Saving model ...
Epoch: 3 cost time: 262.41751194000244
Epoch: 3, Steps: 32 | Train Loss: 41.316 Vali Loss: 93.309 Vali Acc: 0.282 Test Loss: 93.309 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 269.9214086532593
Epoch: 4, Steps: 32 | Train Loss: 31.270 Vali Loss: 119.420 Vali Acc: 0.366 Test Loss: 119.420 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 275.02575492858887
Epoch: 5, Steps: 32 | Train Loss: 48.668 Vali Loss: 127.484 Vali Acc: 0.366 Test Loss: 127.484 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 276.24577832221985
Epoch: 6, Steps: 32 | Train Loss: 15.318 Vali Loss: 194.198 Vali Acc: 0.366 Test Loss: 194.198 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 277.1481945514679
Epoch: 7, Steps: 32 | Train Loss: 27.319 Vali Loss: 273.662 Vali Acc: 0.511 Test Loss: 273.662 Test Acc: 0.511
Validation loss decreased (-0.464813 --> -0.508714).  Saving model ...
Epoch: 8 cost time: 278.6187403202057
Epoch: 8, Steps: 32 | Train Loss: 17.032 Vali Loss: 205.741 Vali Acc: 0.420 Test Loss: 205.741 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 280.37994956970215
Epoch: 9, Steps: 32 | Train Loss: 7.949 Vali Loss: 253.498 Vali Acc: 0.336 Test Loss: 253.498 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 280.5624339580536
Epoch: 10, Steps: 32 | Train Loss: 13.466 Vali Loss: 378.791 Vali Acc: 0.275 Test Loss: 378.791 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 278.399295091629
Epoch: 11, Steps: 32 | Train Loss: 18.277 Vali Loss: 324.279 Vali Acc: 0.328 Test Loss: 324.279 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 282.0566077232361
Epoch: 12, Steps: 32 | Train Loss: 4.308 Vali Loss: 231.134 Vali Acc: 0.527 Test Loss: 231.134 Test Acc: 0.527
Validation loss decreased (-0.508714 --> -0.524406).  Saving model ...
Epoch: 13 cost time: 281.4565658569336
Epoch: 13, Steps: 32 | Train Loss: 4.152 Vali Loss: 277.377 Vali Acc: 0.351 Test Loss: 277.377 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 283.36270236968994
Epoch: 14, Steps: 32 | Train Loss: 1.925 Vali Loss: 258.541 Vali Acc: 0.435 Test Loss: 258.541 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 281.83022117614746
Epoch: 15, Steps: 32 | Train Loss: 4.391 Vali Loss: 295.740 Vali Acc: 0.504 Test Loss: 295.740 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 280.39591789245605
Epoch: 16, Steps: 32 | Train Loss: 15.044 Vali Loss: 379.448 Vali Acc: 0.458 Test Loss: 379.448 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 284.85709404945374
Epoch: 17, Steps: 32 | Train Loss: 4.857 Vali Loss: 334.926 Vali Acc: 0.443 Test Loss: 334.926 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 281.17956590652466
Epoch: 18, Steps: 32 | Train Loss: 4.171 Vali Loss: 463.806 Vali Acc: 0.305 Test Loss: 463.806 Test Acc: 0.305
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 279.8316924571991
Epoch: 19, Steps: 32 | Train Loss: 16.561 Vali Loss: 340.611 Vali Acc: 0.481 Test Loss: 340.611 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 279.75554943084717
Epoch: 20, Steps: 32 | Train Loss: 19.462 Vali Loss: 606.836 Vali Acc: 0.450 Test Loss: 606.836 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 280.7805881500244
Epoch: 21, Steps: 32 | Train Loss: 30.890 Vali Loss: 343.615 Vali Acc: 0.504 Test Loss: 343.615 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 279.91643238067627
Epoch: 22, Steps: 32 | Train Loss: 6.036 Vali Loss: 504.537 Vali Acc: 0.366 Test Loss: 504.537 Test Acc: 0.366
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma5396_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 27230981
model size : 139.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3597                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma3597_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 150.26410603523254
Epoch: 1, Steps: 32 | Train Loss: 16.895 Vali Loss: 32.121 Vali Acc: 0.260 Test Loss: 32.121 Test Acc: 0.260
Validation loss decreased (inf --> -0.259221).  Saving model ...
Epoch: 2 cost time: 167.01966428756714
Epoch: 2, Steps: 32 | Train Loss: 18.442 Vali Loss: 41.604 Vali Acc: 0.504 Test Loss: 41.604 Test Acc: 0.504
Validation loss decreased (-0.259221 --> -0.503401).  Saving model ...
Epoch: 3 cost time: 183.90969109535217
Epoch: 3, Steps: 32 | Train Loss: 9.328 Vali Loss: 74.704 Vali Acc: 0.389 Test Loss: 74.704 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 180.83498430252075
Epoch: 4, Steps: 32 | Train Loss: 30.256 Vali Loss: 82.055 Vali Acc: 0.519 Test Loss: 82.055 Test Acc: 0.519
Validation loss decreased (-0.503401 --> -0.518263).  Saving model ...
Epoch: 5 cost time: 188.73695516586304
Epoch: 5, Steps: 32 | Train Loss: 16.846 Vali Loss: 102.587 Vali Acc: 0.351 Test Loss: 102.587 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 193.80292081832886
Epoch: 6, Steps: 32 | Train Loss: 15.043 Vali Loss: 147.974 Vali Acc: 0.481 Test Loss: 147.974 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 190.2229197025299
Epoch: 7, Steps: 32 | Train Loss: 15.852 Vali Loss: 138.143 Vali Acc: 0.374 Test Loss: 138.143 Test Acc: 0.374
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 190.7830662727356
Epoch: 8, Steps: 32 | Train Loss: 11.795 Vali Loss: 272.362 Vali Acc: 0.443 Test Loss: 272.362 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 188.83844113349915
Epoch: 9, Steps: 32 | Train Loss: 25.868 Vali Loss: 259.312 Vali Acc: 0.412 Test Loss: 259.312 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 191.45098662376404
Epoch: 10, Steps: 32 | Train Loss: 10.182 Vali Loss: 321.786 Vali Acc: 0.511 Test Loss: 321.786 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 193.61158156394958
Epoch: 11, Steps: 32 | Train Loss: 4.797 Vali Loss: 239.578 Vali Acc: 0.496 Test Loss: 239.578 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 193.7108335494995
Epoch: 12, Steps: 32 | Train Loss: 3.024 Vali Loss: 178.030 Vali Acc: 0.466 Test Loss: 178.030 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 190.17522597312927
Epoch: 13, Steps: 32 | Train Loss: 12.555 Vali Loss: 336.675 Vali Acc: 0.519 Test Loss: 336.675 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 191.58029460906982
Epoch: 14, Steps: 32 | Train Loss: 13.936 Vali Loss: 330.578 Vali Acc: 0.557 Test Loss: 330.578 Test Acc: 0.557
Validation loss decreased (-0.518263 --> -0.553946).  Saving model ...
Epoch: 15 cost time: 192.28338742256165
Epoch: 15, Steps: 32 | Train Loss: 3.335 Vali Loss: 311.972 Vali Acc: 0.382 Test Loss: 311.972 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 192.84070801734924
Epoch: 16, Steps: 32 | Train Loss: 3.490 Vali Loss: 430.047 Vali Acc: 0.534 Test Loss: 430.047 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 192.71038842201233
Epoch: 17, Steps: 32 | Train Loss: 7.917 Vali Loss: 461.735 Vali Acc: 0.542 Test Loss: 461.735 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 191.85614728927612
Epoch: 18, Steps: 32 | Train Loss: 21.026 Vali Loss: 494.723 Vali Acc: 0.405 Test Loss: 494.723 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 191.55753016471863
Epoch: 19, Steps: 32 | Train Loss: 16.013 Vali Loss: 657.735 Vali Acc: 0.260 Test Loss: 657.735 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 189.57980847358704
Epoch: 20, Steps: 32 | Train Loss: 30.315 Vali Loss: 574.503 Vali Acc: 0.229 Test Loss: 574.503 Test Acc: 0.229
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 193.96223616600037
Epoch: 21, Steps: 32 | Train Loss: 2.767 Vali Loss: 595.402 Vali Acc: 0.450 Test Loss: 595.402 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 191.54000091552734
Epoch: 22, Steps: 32 | Train Loss: 27.865 Vali Loss: 608.026 Vali Acc: 0.420 Test Loss: 608.026 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 193.75680899620056
Epoch: 23, Steps: 32 | Train Loss: 10.502 Vali Loss: 585.993 Vali Acc: 0.374 Test Loss: 585.993 Test Acc: 0.374
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 194.00087523460388
Epoch: 24, Steps: 32 | Train Loss: 3.854 Vali Loss: 650.309 Vali Acc: 0.450 Test Loss: 650.309 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma3597_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 27230981
model size : 139.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1799                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 73.25733780860901
Epoch: 1, Steps: 32 | Train Loss: 21.076 Vali Loss: 21.281 Vali Acc: 0.458 Test Loss: 21.281 Test Acc: 0.458
Validation loss decreased (inf --> -0.457802).  Saving model ...
Epoch: 2 cost time: 87.4174313545227
Epoch: 2, Steps: 32 | Train Loss: 22.376 Vali Loss: 32.711 Vali Acc: 0.427 Test Loss: 32.711 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 88.8394787311554
Epoch: 3, Steps: 32 | Train Loss: 26.583 Vali Loss: 140.799 Vali Acc: 0.458 Test Loss: 140.799 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 95.92261099815369
Epoch: 4, Steps: 32 | Train Loss: 13.946 Vali Loss: 88.110 Vali Acc: 0.473 Test Loss: 88.110 Test Acc: 0.473
Validation loss decreased (-0.457802 --> -0.472401).  Saving model ...
Epoch: 5 cost time: 96.24465584754944
Epoch: 5, Steps: 32 | Train Loss: 18.035 Vali Loss: 125.832 Vali Acc: 0.511 Test Loss: 125.832 Test Acc: 0.511
Validation loss decreased (-0.472401 --> -0.510192).  Saving model ...
Epoch: 6 cost time: 96.32386565208435
Epoch: 6, Steps: 32 | Train Loss: 19.217 Vali Loss: 164.405 Vali Acc: 0.473 Test Loss: 164.405 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 95.66386318206787
Epoch: 7, Steps: 32 | Train Loss: 21.647 Vali Loss: 312.168 Vali Acc: 0.252 Test Loss: 312.168 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 95.2781355381012
Epoch: 8, Steps: 32 | Train Loss: 74.452 Vali Loss: 320.956 Vali Acc: 0.473 Test Loss: 320.956 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 96.71132588386536
Epoch: 9, Steps: 32 | Train Loss: 17.378 Vali Loss: 216.336 Vali Acc: 0.450 Test Loss: 216.336 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 98.8978762626648
Epoch: 10, Steps: 32 | Train Loss: 2.974 Vali Loss: 219.004 Vali Acc: 0.374 Test Loss: 219.004 Test Acc: 0.374
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 96.88625502586365
Epoch: 11, Steps: 32 | Train Loss: 8.004 Vali Loss: 304.135 Vali Acc: 0.511 Test Loss: 304.135 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 98.06709623336792
Epoch: 12, Steps: 32 | Train Loss: 8.830 Vali Loss: 217.154 Vali Acc: 0.412 Test Loss: 217.154 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 99.7099061012268
Epoch: 13, Steps: 32 | Train Loss: 3.639 Vali Loss: 257.820 Vali Acc: 0.489 Test Loss: 257.820 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 98.32492399215698
Epoch: 14, Steps: 32 | Train Loss: 3.429 Vali Loss: 311.052 Vali Acc: 0.496 Test Loss: 311.052 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 97.98498940467834
Epoch: 15, Steps: 32 | Train Loss: 11.111 Vali Loss: 318.904 Vali Acc: 0.458 Test Loss: 318.904 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 27230981
model size : 139.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 45.916709423065186
Epoch: 1, Steps: 32 | Train Loss: 18.056 Vali Loss: 22.395 Vali Acc: 0.313 Test Loss: 22.395 Test Acc: 0.313
Validation loss decreased (inf --> -0.312753).  Saving model ...
Epoch: 2 cost time: 54.63845086097717
Epoch: 2, Steps: 32 | Train Loss: 18.511 Vali Loss: 111.456 Vali Acc: 0.458 Test Loss: 111.456 Test Acc: 0.458
Validation loss decreased (-0.312753 --> -0.456901).  Saving model ...
Epoch: 3 cost time: 53.313886404037476
Epoch: 3, Steps: 32 | Train Loss: 31.616 Vali Loss: 174.069 Vali Acc: 0.473 Test Loss: 174.069 Test Acc: 0.473
Validation loss decreased (-0.456901 --> -0.471542).  Saving model ...
Epoch: 4 cost time: 55.15807127952576
Epoch: 4, Steps: 32 | Train Loss: 25.990 Vali Loss: 111.526 Vali Acc: 0.389 Test Loss: 111.526 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 57.97770094871521
Epoch: 5, Steps: 32 | Train Loss: 26.016 Vali Loss: 99.713 Vali Acc: 0.542 Test Loss: 99.713 Test Acc: 0.542
Validation loss decreased (-0.471542 --> -0.540988).  Saving model ...
Epoch: 6 cost time: 57.80348205566406
Epoch: 6, Steps: 32 | Train Loss: 8.918 Vali Loss: 167.985 Vali Acc: 0.534 Test Loss: 167.985 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 56.68309497833252
Epoch: 7, Steps: 32 | Train Loss: 5.595 Vali Loss: 138.714 Vali Acc: 0.359 Test Loss: 138.714 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 56.103522300720215
Epoch: 8, Steps: 32 | Train Loss: 30.529 Vali Loss: 332.543 Vali Acc: 0.489 Test Loss: 332.543 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 56.07171082496643
Epoch: 9, Steps: 32 | Train Loss: 43.533 Vali Loss: 314.780 Vali Acc: 0.504 Test Loss: 314.780 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 57.791144132614136
Epoch: 10, Steps: 32 | Train Loss: 2.734 Vali Loss: 268.494 Vali Acc: 0.504 Test Loss: 268.494 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 57.638946533203125
Epoch: 11, Steps: 32 | Train Loss: 2.972 Vali Loss: 170.272 Vali Acc: 0.519 Test Loss: 170.272 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 57.619142055511475
Epoch: 12, Steps: 32 | Train Loss: 11.005 Vali Loss: 222.271 Vali Acc: 0.466 Test Loss: 222.271 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 57.493250608444214
Epoch: 13, Steps: 32 | Train Loss: 5.126 Vali Loss: 228.816 Vali Acc: 0.336 Test Loss: 228.816 Test Acc: 0.336
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 57.8856086730957
Epoch: 14, Steps: 32 | Train Loss: 0.643 Vali Loss: 212.472 Vali Acc: 0.389 Test Loss: 212.472 Test Acc: 0.389
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 57.66888236999512
Epoch: 15, Steps: 32 | Train Loss: 12.819 Vali Loss: 613.767 Vali Acc: 0.496 Test Loss: 613.767 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 27230981
model size : 139.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         540                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma540_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 35.01662588119507
Epoch: 1, Steps: 32 | Train Loss: 18.108 Vali Loss: 24.712 Vali Acc: 0.420 Test Loss: 24.712 Test Acc: 0.420
Validation loss decreased (inf --> -0.419600).  Saving model ...
Epoch: 2 cost time: 37.71455478668213
Epoch: 2, Steps: 32 | Train Loss: 18.702 Vali Loss: 58.362 Vali Acc: 0.260 Test Loss: 58.362 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 40.034889459609985
Epoch: 3, Steps: 32 | Train Loss: 23.562 Vali Loss: 148.486 Vali Acc: 0.466 Test Loss: 148.486 Test Acc: 0.466
Validation loss decreased (-0.419600 --> -0.464164).  Saving model ...
Epoch: 4 cost time: 40.339428424835205
Epoch: 4, Steps: 32 | Train Loss: 22.773 Vali Loss: 137.889 Vali Acc: 0.481 Test Loss: 137.889 Test Acc: 0.481
Validation loss decreased (-0.464164 --> -0.479537).  Saving model ...
Epoch: 5 cost time: 40.623650789260864
Epoch: 5, Steps: 32 | Train Loss: 30.251 Vali Loss: 121.183 Vali Acc: 0.427 Test Loss: 121.183 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 40.24465537071228
Epoch: 6, Steps: 32 | Train Loss: 26.819 Vali Loss: 202.781 Vali Acc: 0.534 Test Loss: 202.781 Test Acc: 0.534
Validation loss decreased (-0.479537 --> -0.532323).  Saving model ...
Epoch: 7 cost time: 40.726889848709106
Epoch: 7, Steps: 32 | Train Loss: 16.132 Vali Loss: 171.884 Vali Acc: 0.496 Test Loss: 171.884 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 41.39277791976929
Epoch: 8, Steps: 32 | Train Loss: 1.798 Vali Loss: 284.030 Vali Acc: 0.527 Test Loss: 284.030 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 41.38928008079529
Epoch: 9, Steps: 32 | Train Loss: 0.469 Vali Loss: 181.428 Vali Acc: 0.489 Test Loss: 181.428 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 41.44611382484436
Epoch: 10, Steps: 32 | Train Loss: 6.037 Vali Loss: 196.197 Vali Acc: 0.466 Test Loss: 196.197 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 41.02781438827515
Epoch: 11, Steps: 32 | Train Loss: 5.423 Vali Loss: 308.312 Vali Acc: 0.405 Test Loss: 308.312 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 41.184314250946045
Epoch: 12, Steps: 32 | Train Loss: 12.637 Vali Loss: 325.477 Vali Acc: 0.412 Test Loss: 325.477 Test Acc: 0.412
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 41.26855778694153
Epoch: 13, Steps: 32 | Train Loss: 6.007 Vali Loss: 413.748 Vali Acc: 0.489 Test Loss: 413.748 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 40.78604793548584
Epoch: 14, Steps: 32 | Train Loss: 9.619 Vali Loss: 350.079 Vali Acc: 0.305 Test Loss: 350.079 Test Acc: 0.305
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 40.98630118370056
Epoch: 15, Steps: 32 | Train Loss: 13.513 Vali Loss: 375.661 Vali Acc: 0.305 Test Loss: 375.661 Test Acc: 0.305
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 41.417479038238525
Epoch: 16, Steps: 32 | Train Loss: 17.889 Vali Loss: 352.253 Vali Acc: 0.344 Test Loss: 352.253 Test Acc: 0.344
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma540_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 27230981
model size : 139.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 29.537166833877563
Epoch: 1, Steps: 32 | Train Loss: 17.050 Vali Loss: 23.394 Vali Acc: 0.305 Test Loss: 23.394 Test Acc: 0.305
Validation loss decreased (inf --> -0.305110).  Saving model ...
Epoch: 2 cost time: 31.448994159698486
Epoch: 2, Steps: 32 | Train Loss: 21.313 Vali Loss: 30.197 Vali Acc: 0.504 Test Loss: 30.197 Test Acc: 0.504
Validation loss decreased (-0.305110 --> -0.503515).  Saving model ...
Epoch: 3 cost time: 32.12143874168396
Epoch: 3, Steps: 32 | Train Loss: 14.030 Vali Loss: 98.553 Vali Acc: 0.427 Test Loss: 98.553 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 33.14985632896423
Epoch: 4, Steps: 32 | Train Loss: 8.626 Vali Loss: 61.075 Vali Acc: 0.412 Test Loss: 61.075 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 32.79352116584778
Epoch: 5, Steps: 32 | Train Loss: 18.694 Vali Loss: 161.628 Vali Acc: 0.489 Test Loss: 161.628 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 32.89753603935242
Epoch: 6, Steps: 32 | Train Loss: 14.510 Vali Loss: 174.687 Vali Acc: 0.534 Test Loss: 174.687 Test Acc: 0.534
Validation loss decreased (-0.503515 --> -0.532604).  Saving model ...
Epoch: 7 cost time: 33.19930362701416
Epoch: 7, Steps: 32 | Train Loss: 12.730 Vali Loss: 164.206 Vali Acc: 0.511 Test Loss: 164.206 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 33.431509494781494
Epoch: 8, Steps: 32 | Train Loss: 13.247 Vali Loss: 244.918 Vali Acc: 0.481 Test Loss: 244.918 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 33.29480528831482
Epoch: 9, Steps: 32 | Train Loss: 3.611 Vali Loss: 264.611 Vali Acc: 0.473 Test Loss: 264.611 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 33.085007190704346
Epoch: 10, Steps: 32 | Train Loss: 25.995 Vali Loss: 177.011 Vali Acc: 0.473 Test Loss: 177.011 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 33.2439444065094
Epoch: 11, Steps: 32 | Train Loss: 13.282 Vali Loss: 229.172 Vali Acc: 0.511 Test Loss: 229.172 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 33.325793743133545
Epoch: 12, Steps: 32 | Train Loss: 6.853 Vali Loss: 178.543 Vali Acc: 0.374 Test Loss: 178.543 Test Acc: 0.374
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 33.44787406921387
Epoch: 13, Steps: 32 | Train Loss: 1.058 Vali Loss: 253.382 Vali Acc: 0.405 Test Loss: 253.382 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 33.46423292160034
Epoch: 14, Steps: 32 | Train Loss: 3.868 Vali Loss: 298.106 Vali Acc: 0.435 Test Loss: 298.106 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 33.453895568847656
Epoch: 15, Steps: 32 | Train Loss: 1.615 Vali Loss: 255.017 Vali Acc: 0.458 Test Loss: 255.017 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 33.37686514854431
Epoch: 16, Steps: 32 | Train Loss: 0.265 Vali Loss: 286.224 Vali Acc: 0.435 Test Loss: 286.224 Test Acc: 0.435
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 27230981
model size : 139.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 24.11177968978882
Epoch: 1, Steps: 32 | Train Loss: 15.882 Vali Loss: 29.082 Vali Acc: 0.305 Test Loss: 29.082 Test Acc: 0.305
Validation loss decreased (inf --> -0.305053).  Saving model ...
Epoch: 2 cost time: 23.872089862823486
Epoch: 2, Steps: 32 | Train Loss: 26.302 Vali Loss: 45.408 Vali Acc: 0.366 Test Loss: 45.408 Test Acc: 0.366
Validation loss decreased (-0.305053 --> -0.365958).  Saving model ...
Epoch: 3 cost time: 24.891972303390503
Epoch: 3, Steps: 32 | Train Loss: 11.443 Vali Loss: 39.836 Vali Acc: 0.550 Test Loss: 39.836 Test Acc: 0.550
Validation loss decreased (-0.365958 --> -0.549220).  Saving model ...
Epoch: 4 cost time: 25.298869132995605
Epoch: 4, Steps: 32 | Train Loss: 12.921 Vali Loss: 64.669 Vali Acc: 0.397 Test Loss: 64.669 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 25.018469095230103
Epoch: 5, Steps: 32 | Train Loss: 18.614 Vali Loss: 104.075 Vali Acc: 0.435 Test Loss: 104.075 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 25.122779607772827
Epoch: 6, Steps: 32 | Train Loss: 26.821 Vali Loss: 65.353 Vali Acc: 0.519 Test Loss: 65.353 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 25.496352672576904
Epoch: 7, Steps: 32 | Train Loss: 7.045 Vali Loss: 125.514 Vali Acc: 0.427 Test Loss: 125.514 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 24.85757350921631
Epoch: 8, Steps: 32 | Train Loss: 11.975 Vali Loss: 268.561 Vali Acc: 0.496 Test Loss: 268.561 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 25.234986543655396
Epoch: 9, Steps: 32 | Train Loss: 25.992 Vali Loss: 181.295 Vali Acc: 0.496 Test Loss: 181.295 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 25.231832027435303
Epoch: 10, Steps: 32 | Train Loss: 6.074 Vali Loss: 144.136 Vali Acc: 0.534 Test Loss: 144.136 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 25.29919719696045
Epoch: 11, Steps: 32 | Train Loss: 4.518 Vali Loss: 153.202 Vali Acc: 0.527 Test Loss: 153.202 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 25.215312004089355
Epoch: 12, Steps: 32 | Train Loss: 6.776 Vali Loss: 162.392 Vali Acc: 0.443 Test Loss: 162.392 Test Acc: 0.443
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 25.210626125335693
Epoch: 13, Steps: 32 | Train Loss: 9.077 Vali Loss: 208.802 Vali Acc: 0.481 Test Loss: 208.802 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 27230981
model size : 139.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 21.22322368621826
Epoch: 1, Steps: 32 | Train Loss: 15.773 Vali Loss: 34.597 Vali Acc: 0.321 Test Loss: 34.597 Test Acc: 0.321
Validation loss decreased (inf --> -0.320265).  Saving model ...
Epoch: 2 cost time: 20.733747243881226
Epoch: 2, Steps: 32 | Train Loss: 20.780 Vali Loss: 17.080 Vali Acc: 0.466 Test Loss: 17.080 Test Acc: 0.466
Validation loss decreased (-0.320265 --> -0.465478).  Saving model ...
Epoch: 3 cost time: 21.052138328552246
Epoch: 3, Steps: 32 | Train Loss: 13.361 Vali Loss: 77.910 Vali Acc: 0.450 Test Loss: 77.910 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 21.195098161697388
Epoch: 4, Steps: 32 | Train Loss: 11.956 Vali Loss: 70.979 Vali Acc: 0.573 Test Loss: 70.979 Test Acc: 0.573
Validation loss decreased (-0.465478 --> -0.571809).  Saving model ...
Epoch: 5 cost time: 21.172885417938232
Epoch: 5, Steps: 32 | Train Loss: 14.571 Vali Loss: 104.294 Vali Acc: 0.519 Test Loss: 104.294 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 21.046451807022095
Epoch: 6, Steps: 32 | Train Loss: 9.506 Vali Loss: 103.700 Vali Acc: 0.389 Test Loss: 103.700 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 21.383103847503662
Epoch: 7, Steps: 32 | Train Loss: 4.157 Vali Loss: 89.579 Vali Acc: 0.573 Test Loss: 89.579 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 21.39779257774353
Epoch: 8, Steps: 32 | Train Loss: 11.539 Vali Loss: 88.097 Vali Acc: 0.557 Test Loss: 88.097 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 21.091177701950073
Epoch: 9, Steps: 32 | Train Loss: 12.441 Vali Loss: 161.127 Vali Acc: 0.504 Test Loss: 161.127 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 21.13881778717041
Epoch: 10, Steps: 32 | Train Loss: 12.223 Vali Loss: 197.836 Vali Acc: 0.298 Test Loss: 197.836 Test Acc: 0.298
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 21.280306816101074
Epoch: 11, Steps: 32 | Train Loss: 8.974 Vali Loss: 322.985 Vali Acc: 0.481 Test Loss: 322.985 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 21.134002208709717
Epoch: 12, Steps: 32 | Train Loss: 16.110 Vali Loss: 249.467 Vali Acc: 0.366 Test Loss: 249.467 Test Acc: 0.366
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 21.079179763793945
Epoch: 13, Steps: 32 | Train Loss: 22.174 Vali Loss: 419.011 Vali Acc: 0.260 Test Loss: 419.011 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 21.107313871383667
Epoch: 14, Steps: 32 | Train Loss: 8.275 Vali Loss: 210.741 Vali Acc: 0.527 Test Loss: 210.741 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df1024_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 27230981
model size : 139.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         8992                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df512_ma8992_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 354.40057349205017
Epoch: 1, Steps: 32 | Train Loss: 32.177 Vali Loss: 56.067 Vali Acc: 0.244 Test Loss: 56.067 Test Acc: 0.244
Validation loss decreased (inf --> -0.243714).  Saving model ...
Epoch: 2 cost time: 396.0626564025879
Epoch: 2, Steps: 32 | Train Loss: 39.366 Vali Loss: 77.181 Vali Acc: 0.450 Test Loss: 77.181 Test Acc: 0.450
Validation loss decreased (-0.243714 --> -0.449610).  Saving model ...
Epoch: 3 cost time: 434.19310665130615
Epoch: 3, Steps: 32 | Train Loss: 33.828 Vali Loss: 105.271 Vali Acc: 0.313 Test Loss: 105.271 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 441.92265462875366
Epoch: 4, Steps: 32 | Train Loss: 17.743 Vali Loss: 110.930 Vali Acc: 0.481 Test Loss: 110.930 Test Acc: 0.481
Validation loss decreased (-0.449610 --> -0.479807).  Saving model ...
Epoch: 5 cost time: 442.747074842453
Epoch: 5, Steps: 32 | Train Loss: 13.645 Vali Loss: 163.162 Vali Acc: 0.527 Test Loss: 163.162 Test Acc: 0.527
Validation loss decreased (-0.479807 --> -0.525086).  Saving model ...
Epoch: 6 cost time: 450.2093119621277
Epoch: 6, Steps: 32 | Train Loss: 21.455 Vali Loss: 158.305 Vali Acc: 0.519 Test Loss: 158.305 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 445.7426369190216
Epoch: 7, Steps: 32 | Train Loss: 18.754 Vali Loss: 190.827 Vali Acc: 0.489 Test Loss: 190.827 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 445.3394410610199
Epoch: 8, Steps: 32 | Train Loss: 23.372 Vali Loss: 411.813 Vali Acc: 0.290 Test Loss: 411.813 Test Acc: 0.290
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 455.6614954471588
Epoch: 9, Steps: 32 | Train Loss: 11.989 Vali Loss: 170.716 Vali Acc: 0.473 Test Loss: 170.716 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 456.0608780384064
Epoch: 10, Steps: 32 | Train Loss: 4.159 Vali Loss: 287.417 Vali Acc: 0.557 Test Loss: 287.417 Test Acc: 0.557
Validation loss decreased (-0.525086 --> -0.554378).  Saving model ...
Epoch: 11 cost time: 455.51748991012573
Epoch: 11, Steps: 32 | Train Loss: 7.579 Vali Loss: 304.564 Vali Acc: 0.527 Test Loss: 304.564 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 457.964706659317
Epoch: 12, Steps: 32 | Train Loss: 4.141 Vali Loss: 301.887 Vali Acc: 0.496 Test Loss: 301.887 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 462.62589263916016
Epoch: 13, Steps: 32 | Train Loss: 0.377 Vali Loss: 381.179 Vali Acc: 0.511 Test Loss: 381.179 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 457.95270705223083
Epoch: 14, Steps: 32 | Train Loss: 2.062 Vali Loss: 287.729 Vali Acc: 0.527 Test Loss: 287.729 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 460.32185983657837
Epoch: 15, Steps: 32 | Train Loss: 2.620 Vali Loss: 240.282 Vali Acc: 0.412 Test Loss: 240.282 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 458.65920972824097
Epoch: 16, Steps: 32 | Train Loss: 9.502 Vali Loss: 246.567 Vali Acc: 0.489 Test Loss: 246.567 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 455.24701857566833
Epoch: 17, Steps: 32 | Train Loss: 13.126 Vali Loss: 373.295 Vali Acc: 0.504 Test Loss: 373.295 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 451.3496959209442
Epoch: 18, Steps: 32 | Train Loss: 35.975 Vali Loss: 357.620 Vali Acc: 0.420 Test Loss: 357.620 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 459.27621483802795
Epoch: 19, Steps: 32 | Train Loss: 4.830 Vali Loss: 358.570 Vali Acc: 0.489 Test Loss: 358.570 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 458.1828863620758
Epoch: 20, Steps: 32 | Train Loss: 5.603 Vali Loss: 772.727 Vali Acc: 0.489 Test Loss: 772.727 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df512_ma8992_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 26444549
model size : 136.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         7194                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df512_ma7194_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 282.37722158432007
Epoch: 1, Steps: 32 | Train Loss: 16.316 Vali Loss: 26.204 Vali Acc: 0.481 Test Loss: 26.204 Test Acc: 0.481
Validation loss decreased (inf --> -0.480654).  Saving model ...
Epoch: 2 cost time: 328.2836229801178
Epoch: 2, Steps: 32 | Train Loss: 26.891 Vali Loss: 49.663 Vali Acc: 0.519 Test Loss: 49.663 Test Acc: 0.519
Validation loss decreased (-0.480654 --> -0.518587).  Saving model ...
Epoch: 3 cost time: 340.62006187438965
Epoch: 3, Steps: 32 | Train Loss: 36.127 Vali Loss: 111.520 Vali Acc: 0.198 Test Loss: 111.520 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 352.816526889801
Epoch: 4, Steps: 32 | Train Loss: 28.189 Vali Loss: 129.518 Vali Acc: 0.534 Test Loss: 129.518 Test Acc: 0.534
Validation loss decreased (-0.518587 --> -0.533056).  Saving model ...
Epoch: 5 cost time: 353.0399193763733
Epoch: 5, Steps: 32 | Train Loss: 20.895 Vali Loss: 150.022 Vali Acc: 0.542 Test Loss: 150.022 Test Acc: 0.542
Validation loss decreased (-0.533056 --> -0.540485).  Saving model ...
Epoch: 6 cost time: 364.40780901908875
Epoch: 6, Steps: 32 | Train Loss: 16.722 Vali Loss: 149.723 Vali Acc: 0.412 Test Loss: 149.723 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 363.15775299072266
Epoch: 7, Steps: 32 | Train Loss: 13.342 Vali Loss: 365.074 Vali Acc: 0.481 Test Loss: 365.074 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 357.0821723937988
Epoch: 8, Steps: 32 | Train Loss: 23.700 Vali Loss: 292.789 Vali Acc: 0.542 Test Loss: 292.789 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 368.0180170536041
Epoch: 9, Steps: 32 | Train Loss: 7.660 Vali Loss: 253.450 Vali Acc: 0.557 Test Loss: 253.450 Test Acc: 0.557
Validation loss decreased (-0.540485 --> -0.554717).  Saving model ...
Epoch: 10 cost time: 365.7644760608673
Epoch: 10, Steps: 32 | Train Loss: 12.237 Vali Loss: 328.569 Vali Acc: 0.519 Test Loss: 328.569 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 370.80927443504333
Epoch: 11, Steps: 32 | Train Loss: 5.222 Vali Loss: 208.917 Vali Acc: 0.565 Test Loss: 208.917 Test Acc: 0.565
Validation loss decreased (-0.554717 --> -0.562796).  Saving model ...
Epoch: 12 cost time: 371.5282666683197
Epoch: 12, Steps: 32 | Train Loss: 1.536 Vali Loss: 214.089 Vali Acc: 0.412 Test Loss: 214.089 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 367.5740542411804
Epoch: 13, Steps: 32 | Train Loss: 5.524 Vali Loss: 209.348 Vali Acc: 0.397 Test Loss: 209.348 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 369.6345636844635
Epoch: 14, Steps: 32 | Train Loss: 2.567 Vali Loss: 396.849 Vali Acc: 0.359 Test Loss: 396.849 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 364.5212597846985
Epoch: 15, Steps: 32 | Train Loss: 10.502 Vali Loss: 631.919 Vali Acc: 0.504 Test Loss: 631.919 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 368.1579575538635
Epoch: 16, Steps: 32 | Train Loss: 17.777 Vali Loss: 280.503 Vali Acc: 0.496 Test Loss: 280.503 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 367.33516359329224
Epoch: 17, Steps: 32 | Train Loss: 7.022 Vali Loss: 340.850 Vali Acc: 0.473 Test Loss: 340.850 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 365.95219373703003
Epoch: 18, Steps: 32 | Train Loss: 10.506 Vali Loss: 463.013 Vali Acc: 0.511 Test Loss: 463.013 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 368.30853390693665
Epoch: 19, Steps: 32 | Train Loss: 7.996 Vali Loss: 429.689 Vali Acc: 0.359 Test Loss: 429.689 Test Acc: 0.359
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 363.8733251094818
Epoch: 20, Steps: 32 | Train Loss: 18.529 Vali Loss: 451.104 Vali Acc: 0.435 Test Loss: 451.104 Test Acc: 0.435
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 365.4192898273468
Epoch: 21, Steps: 32 | Train Loss: 40.752 Vali Loss: 558.787 Vali Acc: 0.412 Test Loss: 558.787 Test Acc: 0.412
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df512_ma7194_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 26444549
model size : 136.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5396                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df512_ma5396_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 217.08806991577148
Epoch: 1, Steps: 32 | Train Loss: 26.823 Vali Loss: 41.087 Vali Acc: 0.420 Test Loss: 41.087 Test Acc: 0.420
Validation loss decreased (inf --> -0.419436).  Saving model ...
Epoch: 2 cost time: 253.49586391448975
Epoch: 2, Steps: 32 | Train Loss: 27.018 Vali Loss: 39.569 Vali Acc: 0.374 Test Loss: 39.569 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 276.23200821876526
Epoch: 3, Steps: 32 | Train Loss: 17.447 Vali Loss: 65.962 Vali Acc: 0.420 Test Loss: 65.962 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 281.03636622428894
Epoch: 4, Steps: 32 | Train Loss: 11.906 Vali Loss: 119.601 Vali Acc: 0.511 Test Loss: 119.601 Test Acc: 0.511
Validation loss decreased (-0.419436 --> -0.510254).  Saving model ...
Epoch: 5 cost time: 271.55441093444824
Epoch: 5, Steps: 32 | Train Loss: 16.591 Vali Loss: 120.199 Vali Acc: 0.374 Test Loss: 120.199 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 275.02807688713074
Epoch: 6, Steps: 32 | Train Loss: 9.129 Vali Loss: 206.050 Vali Acc: 0.191 Test Loss: 206.050 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 273.5706133842468
Epoch: 7, Steps: 32 | Train Loss: 28.835 Vali Loss: 187.797 Vali Acc: 0.443 Test Loss: 187.797 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 277.14727783203125
Epoch: 8, Steps: 32 | Train Loss: 19.562 Vali Loss: 255.897 Vali Acc: 0.366 Test Loss: 255.897 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 277.781587600708
Epoch: 9, Steps: 32 | Train Loss: 24.792 Vali Loss: 284.972 Vali Acc: 0.481 Test Loss: 284.972 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 281.15173292160034
Epoch: 10, Steps: 32 | Train Loss: 9.007 Vali Loss: 241.072 Vali Acc: 0.466 Test Loss: 241.072 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 282.1548683643341
Epoch: 11, Steps: 32 | Train Loss: 1.835 Vali Loss: 306.142 Vali Acc: 0.489 Test Loss: 306.142 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 282.72932171821594
Epoch: 12, Steps: 32 | Train Loss: 1.930 Vali Loss: 249.227 Vali Acc: 0.359 Test Loss: 249.227 Test Acc: 0.359
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 277.54730319976807
Epoch: 13, Steps: 32 | Train Loss: 12.213 Vali Loss: 401.915 Vali Acc: 0.527 Test Loss: 401.915 Test Acc: 0.527
Validation loss decreased (-0.510254 --> -0.522698).  Saving model ...
Epoch: 14 cost time: 278.4393606185913
Epoch: 14, Steps: 32 | Train Loss: 11.541 Vali Loss: 293.043 Vali Acc: 0.427 Test Loss: 293.043 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 281.740047454834
Epoch: 15, Steps: 32 | Train Loss: 2.983 Vali Loss: 311.779 Vali Acc: 0.504 Test Loss: 311.779 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 282.2316930294037
Epoch: 16, Steps: 32 | Train Loss: 4.629 Vali Loss: 341.654 Vali Acc: 0.496 Test Loss: 341.654 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 280.4131941795349
Epoch: 17, Steps: 32 | Train Loss: 3.469 Vali Loss: 372.282 Vali Acc: 0.504 Test Loss: 372.282 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 282.4772789478302
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 365.252 Vali Acc: 0.519 Test Loss: 365.252 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 281.2929971218109
Epoch: 19, Steps: 32 | Train Loss: 4.104 Vali Loss: 362.321 Vali Acc: 0.351 Test Loss: 362.321 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 279.71645975112915
Epoch: 20, Steps: 32 | Train Loss: 11.364 Vali Loss: 347.823 Vali Acc: 0.496 Test Loss: 347.823 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 279.7575788497925
Epoch: 21, Steps: 32 | Train Loss: 6.840 Vali Loss: 546.044 Vali Acc: 0.328 Test Loss: 546.044 Test Acc: 0.328
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 277.3823592662811
Epoch: 22, Steps: 32 | Train Loss: 11.173 Vali Loss: 477.467 Vali Acc: 0.374 Test Loss: 477.467 Test Acc: 0.374
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 280.08215951919556
Epoch: 23, Steps: 32 | Train Loss: 4.601 Vali Loss: 491.438 Vali Acc: 0.382 Test Loss: 491.438 Test Acc: 0.382
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df512_ma5396_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 26444549
model size : 136.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3597                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df512_ma3597_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 147.86183547973633
Epoch: 1, Steps: 32 | Train Loss: 22.660 Vali Loss: 47.093 Vali Acc: 0.252 Test Loss: 47.093 Test Acc: 0.252
Validation loss decreased (inf --> -0.251437).  Saving model ...
Epoch: 2 cost time: 172.7081961631775
Epoch: 2, Steps: 32 | Train Loss: 17.218 Vali Loss: 25.465 Vali Acc: 0.496 Test Loss: 25.465 Test Acc: 0.496
Validation loss decreased (-0.251437 --> -0.495929).  Saving model ...
Epoch: 3 cost time: 177.59334588050842
Epoch: 3, Steps: 32 | Train Loss: 25.989 Vali Loss: 50.533 Vali Acc: 0.496 Test Loss: 50.533 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 187.89331603050232
Epoch: 4, Steps: 32 | Train Loss: 10.459 Vali Loss: 121.363 Vali Acc: 0.511 Test Loss: 121.363 Test Acc: 0.511
Validation loss decreased (-0.495929 --> -0.510237).  Saving model ...
Epoch: 5 cost time: 194.1047236919403
Epoch: 5, Steps: 32 | Train Loss: 7.469 Vali Loss: 135.126 Vali Acc: 0.511 Test Loss: 135.126 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 191.2691032886505
Epoch: 6, Steps: 32 | Train Loss: 11.545 Vali Loss: 199.018 Vali Acc: 0.504 Test Loss: 199.018 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 186.81832218170166
Epoch: 7, Steps: 32 | Train Loss: 25.813 Vali Loss: 145.090 Vali Acc: 0.336 Test Loss: 145.090 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 189.88496327400208
Epoch: 8, Steps: 32 | Train Loss: 10.751 Vali Loss: 173.622 Vali Acc: 0.573 Test Loss: 173.622 Test Acc: 0.573
Validation loss decreased (-0.510237 --> -0.570783).  Saving model ...
Epoch: 9 cost time: 192.34446597099304
Epoch: 9, Steps: 32 | Train Loss: 3.438 Vali Loss: 259.257 Vali Acc: 0.542 Test Loss: 259.257 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 191.7492334842682
Epoch: 10, Steps: 32 | Train Loss: 12.613 Vali Loss: 154.126 Vali Acc: 0.427 Test Loss: 154.126 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 192.7238221168518
Epoch: 11, Steps: 32 | Train Loss: 11.908 Vali Loss: 165.962 Vali Acc: 0.412 Test Loss: 165.962 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 190.94516587257385
Epoch: 12, Steps: 32 | Train Loss: 12.815 Vali Loss: 269.089 Vali Acc: 0.420 Test Loss: 269.089 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 190.82874846458435
Epoch: 13, Steps: 32 | Train Loss: 25.367 Vali Loss: 221.311 Vali Acc: 0.511 Test Loss: 221.311 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 191.69419145584106
Epoch: 14, Steps: 32 | Train Loss: 37.620 Vali Loss: 305.624 Vali Acc: 0.443 Test Loss: 305.624 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 193.5167112350464
Epoch: 15, Steps: 32 | Train Loss: 2.247 Vali Loss: 307.030 Vali Acc: 0.511 Test Loss: 307.030 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 194.81346225738525
Epoch: 16, Steps: 32 | Train Loss: 2.539 Vali Loss: 320.477 Vali Acc: 0.550 Test Loss: 320.477 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 193.85626792907715
Epoch: 17, Steps: 32 | Train Loss: 11.075 Vali Loss: 402.954 Vali Acc: 0.496 Test Loss: 402.954 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 191.89881110191345
Epoch: 18, Steps: 32 | Train Loss: 17.641 Vali Loss: 386.380 Vali Acc: 0.542 Test Loss: 386.380 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df512_ma3597_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 26444549
model size : 136.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1799                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df512_ma1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 72.96865344047546
Epoch: 1, Steps: 32 | Train Loss: 17.929 Vali Loss: 52.478 Vali Acc: 0.183 Test Loss: 52.478 Test Acc: 0.183
Validation loss decreased (inf --> -0.182681).  Saving model ...
Epoch: 2 cost time: 82.65153431892395
Epoch: 2, Steps: 32 | Train Loss: 31.776 Vali Loss: 110.753 Vali Acc: 0.191 Test Loss: 110.753 Test Acc: 0.191
Validation loss decreased (-0.182681 --> -0.189732).  Saving model ...
Epoch: 3 cost time: 86.2023913860321
Epoch: 3, Steps: 32 | Train Loss: 46.210 Vali Loss: 160.639 Vali Acc: 0.504 Test Loss: 160.639 Test Acc: 0.504
Validation loss decreased (-0.189732 --> -0.502210).  Saving model ...
Epoch: 4 cost time: 96.29452204704285
Epoch: 4, Steps: 32 | Train Loss: 11.199 Vali Loss: 98.952 Vali Acc: 0.389 Test Loss: 98.952 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 95.67987489700317
Epoch: 5, Steps: 32 | Train Loss: 31.497 Vali Loss: 163.331 Vali Acc: 0.328 Test Loss: 163.331 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 97.16600322723389
Epoch: 6, Steps: 32 | Train Loss: 11.194 Vali Loss: 132.939 Vali Acc: 0.313 Test Loss: 132.939 Test Acc: 0.313
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 96.26579785346985
Epoch: 7, Steps: 32 | Train Loss: 8.199 Vali Loss: 177.932 Vali Acc: 0.489 Test Loss: 177.932 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 94.20517992973328
Epoch: 8, Steps: 32 | Train Loss: 16.437 Vali Loss: 192.969 Vali Acc: 0.458 Test Loss: 192.969 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 95.87567830085754
Epoch: 9, Steps: 32 | Train Loss: 16.212 Vali Loss: 215.881 Vali Acc: 0.427 Test Loss: 215.881 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 95.46093320846558
Epoch: 10, Steps: 32 | Train Loss: 16.352 Vali Loss: 164.462 Vali Acc: 0.427 Test Loss: 164.462 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 96.31194519996643
Epoch: 11, Steps: 32 | Train Loss: 11.181 Vali Loss: 361.714 Vali Acc: 0.504 Test Loss: 361.714 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 99.4081244468689
Epoch: 12, Steps: 32 | Train Loss: 7.634 Vali Loss: 183.950 Vali Acc: 0.496 Test Loss: 183.950 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 97.50986289978027
Epoch: 13, Steps: 32 | Train Loss: 1.232 Vali Loss: 246.202 Vali Acc: 0.550 Test Loss: 246.202 Test Acc: 0.550
Validation loss decreased (-0.502210 --> -0.547156).  Saving model ...
Epoch: 14 cost time: 96.61832118034363
Epoch: 14, Steps: 32 | Train Loss: 7.766 Vali Loss: 231.388 Vali Acc: 0.542 Test Loss: 231.388 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 97.02800917625427
Epoch: 15, Steps: 32 | Train Loss: 2.951 Vali Loss: 165.480 Vali Acc: 0.481 Test Loss: 165.480 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 97.4368965625763
Epoch: 16, Steps: 32 | Train Loss: 3.812 Vali Loss: 240.542 Vali Acc: 0.527 Test Loss: 240.542 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 97.66839981079102
Epoch: 17, Steps: 32 | Train Loss: 1.132 Vali Loss: 220.880 Vali Acc: 0.435 Test Loss: 220.880 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 95.80177760124207
Epoch: 18, Steps: 32 | Train Loss: 17.767 Vali Loss: 371.149 Vali Acc: 0.511 Test Loss: 371.149 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 95.94727277755737
Epoch: 19, Steps: 32 | Train Loss: 14.486 Vali Loss: 413.050 Vali Acc: 0.527 Test Loss: 413.050 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 97.5384829044342
Epoch: 20, Steps: 32 | Train Loss: 7.936 Vali Loss: 412.920 Vali Acc: 0.298 Test Loss: 412.920 Test Acc: 0.298
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 96.92496395111084
Epoch: 21, Steps: 32 | Train Loss: 6.761 Vali Loss: 399.201 Vali Acc: 0.397 Test Loss: 399.201 Test Acc: 0.397
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 97.11315631866455
Epoch: 22, Steps: 32 | Train Loss: 17.749 Vali Loss: 318.688 Vali Acc: 0.527 Test Loss: 318.688 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 97.47043204307556
Epoch: 23, Steps: 32 | Train Loss: 20.524 Vali Loss: 476.862 Vali Acc: 0.481 Test Loss: 476.862 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df512_ma1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 26444549
model size : 136.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df512_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 44.63882565498352
Epoch: 1, Steps: 32 | Train Loss: 21.342 Vali Loss: 34.958 Vali Acc: 0.374 Test Loss: 34.958 Test Acc: 0.374
Validation loss decreased (inf --> -0.373696).  Saving model ...
Epoch: 2 cost time: 50.989185094833374
Epoch: 2, Steps: 32 | Train Loss: 25.510 Vali Loss: 59.225 Vali Acc: 0.382 Test Loss: 59.225 Test Acc: 0.382
Validation loss decreased (-0.373696 --> -0.381087).  Saving model ...
Epoch: 3 cost time: 52.408931016922
Epoch: 3, Steps: 32 | Train Loss: 23.132 Vali Loss: 98.246 Vali Acc: 0.397 Test Loss: 98.246 Test Acc: 0.397
Validation loss decreased (-0.381087 --> -0.395964).  Saving model ...
Epoch: 4 cost time: 55.68702840805054
Epoch: 4, Steps: 32 | Train Loss: 21.542 Vali Loss: 95.020 Vali Acc: 0.374 Test Loss: 95.020 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 54.281564712524414
Epoch: 5, Steps: 32 | Train Loss: 26.651 Vali Loss: 233.368 Vali Acc: 0.496 Test Loss: 233.368 Test Acc: 0.496
Validation loss decreased (-0.395964 --> -0.493850).  Saving model ...
Epoch: 6 cost time: 55.49680519104004
Epoch: 6, Steps: 32 | Train Loss: 25.370 Vali Loss: 108.776 Vali Acc: 0.443 Test Loss: 108.776 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 56.649662733078
Epoch: 7, Steps: 32 | Train Loss: 4.021 Vali Loss: 155.678 Vali Acc: 0.519 Test Loss: 155.678 Test Acc: 0.519
Validation loss decreased (-0.493850 --> -0.517527).  Saving model ...
Epoch: 8 cost time: 56.86293172836304
Epoch: 8, Steps: 32 | Train Loss: 17.295 Vali Loss: 184.164 Vali Acc: 0.473 Test Loss: 184.164 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 56.97751975059509
Epoch: 9, Steps: 32 | Train Loss: 2.746 Vali Loss: 319.182 Vali Acc: 0.504 Test Loss: 319.182 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 56.210384130477905
Epoch: 10, Steps: 32 | Train Loss: 11.930 Vali Loss: 259.837 Vali Acc: 0.542 Test Loss: 259.837 Test Acc: 0.542
Validation loss decreased (-0.517527 --> -0.539386).  Saving model ...
Epoch: 11 cost time: 56.16959810256958
Epoch: 11, Steps: 32 | Train Loss: 9.589 Vali Loss: 271.232 Vali Acc: 0.550 Test Loss: 271.232 Test Acc: 0.550
Validation loss decreased (-0.539386 --> -0.546906).  Saving model ...
Epoch: 12 cost time: 56.12134766578674
Epoch: 12, Steps: 32 | Train Loss: 7.941 Vali Loss: 270.269 Vali Acc: 0.489 Test Loss: 270.269 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 55.959571838378906
Epoch: 13, Steps: 32 | Train Loss: 7.022 Vali Loss: 360.939 Vali Acc: 0.290 Test Loss: 360.939 Test Acc: 0.290
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 56.88138198852539
Epoch: 14, Steps: 32 | Train Loss: 21.411 Vali Loss: 241.449 Vali Acc: 0.527 Test Loss: 241.449 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 56.85069441795349
Epoch: 15, Steps: 32 | Train Loss: 12.563 Vali Loss: 375.245 Vali Acc: 0.496 Test Loss: 375.245 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 56.278172731399536
Epoch: 16, Steps: 32 | Train Loss: 17.892 Vali Loss: 352.826 Vali Acc: 0.290 Test Loss: 352.826 Test Acc: 0.290
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 56.51794242858887
Epoch: 17, Steps: 32 | Train Loss: 8.941 Vali Loss: 414.094 Vali Acc: 0.511 Test Loss: 414.094 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 56.297775745391846
Epoch: 18, Steps: 32 | Train Loss: 4.239 Vali Loss: 346.027 Vali Acc: 0.427 Test Loss: 346.027 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 55.743149757385254
Epoch: 19, Steps: 32 | Train Loss: 15.453 Vali Loss: 671.196 Vali Acc: 0.489 Test Loss: 671.196 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 55.77291297912598
Epoch: 20, Steps: 32 | Train Loss: 35.999 Vali Loss: 292.673 Vali Acc: 0.412 Test Loss: 292.673 Test Acc: 0.412
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 56.27825427055359
Epoch: 21, Steps: 32 | Train Loss: 10.529 Vali Loss: 395.950 Vali Acc: 0.443 Test Loss: 395.950 Test Acc: 0.443
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df512_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 26444549
model size : 136.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         540                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df512_ma540_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 33.259785413742065
Epoch: 1, Steps: 32 | Train Loss: 11.602 Vali Loss: 32.423 Vali Acc: 0.298 Test Loss: 32.423 Test Acc: 0.298
Validation loss decreased (inf --> -0.297386).  Saving model ...
Epoch: 2 cost time: 38.46621346473694
Epoch: 2, Steps: 32 | Train Loss: 13.400 Vali Loss: 45.636 Vali Acc: 0.397 Test Loss: 45.636 Test Acc: 0.397
Validation loss decreased (-0.297386 --> -0.396490).  Saving model ...
Epoch: 3 cost time: 38.94914150238037
Epoch: 3, Steps: 32 | Train Loss: 25.729 Vali Loss: 91.116 Vali Acc: 0.504 Test Loss: 91.116 Test Acc: 0.504
Validation loss decreased (-0.396490 --> -0.502906).  Saving model ...
Epoch: 4 cost time: 39.26587462425232
Epoch: 4, Steps: 32 | Train Loss: 18.526 Vali Loss: 112.741 Vali Acc: 0.496 Test Loss: 112.741 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 39.423513650894165
Epoch: 5, Steps: 32 | Train Loss: 21.660 Vali Loss: 82.119 Vali Acc: 0.366 Test Loss: 82.119 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 39.5328004360199
Epoch: 6, Steps: 32 | Train Loss: 7.970 Vali Loss: 163.342 Vali Acc: 0.481 Test Loss: 163.342 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 39.46066498756409
Epoch: 7, Steps: 32 | Train Loss: 25.814 Vali Loss: 225.504 Vali Acc: 0.275 Test Loss: 225.504 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 39.5714168548584
Epoch: 8, Steps: 32 | Train Loss: 11.016 Vali Loss: 227.498 Vali Acc: 0.519 Test Loss: 227.498 Test Acc: 0.519
Validation loss decreased (-0.502906 --> -0.516809).  Saving model ...
Epoch: 9 cost time: 39.600390911102295
Epoch: 9, Steps: 32 | Train Loss: 7.014 Vali Loss: 275.912 Vali Acc: 0.443 Test Loss: 275.912 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 39.95625638961792
Epoch: 10, Steps: 32 | Train Loss: 15.070 Vali Loss: 143.310 Vali Acc: 0.489 Test Loss: 143.310 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 40.32588291168213
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 239.391 Vali Acc: 0.511 Test Loss: 239.391 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 39.83371567726135
Epoch: 12, Steps: 32 | Train Loss: 1.296 Vali Loss: 220.301 Vali Acc: 0.489 Test Loss: 220.301 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 40.207414388656616
Epoch: 13, Steps: 32 | Train Loss: 0.087 Vali Loss: 239.758 Vali Acc: 0.481 Test Loss: 239.758 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 39.76396584510803
Epoch: 14, Steps: 32 | Train Loss: 7.965 Vali Loss: 338.678 Vali Acc: 0.511 Test Loss: 338.678 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 40.015421628952026
Epoch: 15, Steps: 32 | Train Loss: 5.717 Vali Loss: 261.131 Vali Acc: 0.382 Test Loss: 261.131 Test Acc: 0.382
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 40.14504647254944
Epoch: 16, Steps: 32 | Train Loss: 4.557 Vali Loss: 249.108 Vali Acc: 0.443 Test Loss: 249.108 Test Acc: 0.443
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 39.59448051452637
Epoch: 17, Steps: 32 | Train Loss: 8.675 Vali Loss: 297.537 Vali Acc: 0.443 Test Loss: 297.537 Test Acc: 0.443
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 39.82162594795227
Epoch: 18, Steps: 32 | Train Loss: 6.444 Vali Loss: 573.708 Vali Acc: 0.351 Test Loss: 573.708 Test Acc: 0.351
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df512_ma540_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 26444549
model size : 136.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df512_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 27.99215078353882
Epoch: 1, Steps: 32 | Train Loss: 23.596 Vali Loss: 41.221 Vali Acc: 0.221 Test Loss: 41.221 Test Acc: 0.221
Validation loss decreased (inf --> -0.220962).  Saving model ...
Epoch: 2 cost time: 29.890079498291016
Epoch: 2, Steps: 32 | Train Loss: 26.048 Vali Loss: 57.048 Vali Acc: 0.511 Test Loss: 57.048 Test Acc: 0.511
Validation loss decreased (-0.220962 --> -0.510880).  Saving model ...
Epoch: 3 cost time: 30.491565942764282
Epoch: 3, Steps: 32 | Train Loss: 32.226 Vali Loss: 171.202 Vali Acc: 0.198 Test Loss: 171.202 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 32.00755524635315
Epoch: 4, Steps: 32 | Train Loss: 8.422 Vali Loss: 69.556 Vali Acc: 0.374 Test Loss: 69.556 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 31.531586170196533
Epoch: 5, Steps: 32 | Train Loss: 19.991 Vali Loss: 158.908 Vali Acc: 0.450 Test Loss: 158.908 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 31.316887378692627
Epoch: 6, Steps: 32 | Train Loss: 35.741 Vali Loss: 140.981 Vali Acc: 0.328 Test Loss: 140.981 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 31.926359176635742
Epoch: 7, Steps: 32 | Train Loss: 13.654 Vali Loss: 191.519 Vali Acc: 0.397 Test Loss: 191.519 Test Acc: 0.397
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 32.163400650024414
Epoch: 8, Steps: 32 | Train Loss: 7.783 Vali Loss: 193.258 Vali Acc: 0.397 Test Loss: 193.258 Test Acc: 0.397
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 32.16412329673767
Epoch: 9, Steps: 32 | Train Loss: 4.583 Vali Loss: 229.570 Vali Acc: 0.489 Test Loss: 229.570 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 32.08753514289856
Epoch: 10, Steps: 32 | Train Loss: 2.467 Vali Loss: 183.362 Vali Acc: 0.458 Test Loss: 183.362 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 32.05640959739685
Epoch: 11, Steps: 32 | Train Loss: 2.327 Vali Loss: 160.986 Vali Acc: 0.458 Test Loss: 160.986 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 32.230228662490845
Epoch: 12, Steps: 32 | Train Loss: 1.567 Vali Loss: 215.672 Vali Acc: 0.496 Test Loss: 215.672 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df512_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 26444549
model size : 136.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df512_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 22.833542346954346
Epoch: 1, Steps: 32 | Train Loss: 19.016 Vali Loss: 44.116 Vali Acc: 0.252 Test Loss: 44.116 Test Acc: 0.252
Validation loss decreased (inf --> -0.251467).  Saving model ...
Epoch: 2 cost time: 22.791456699371338
Epoch: 2, Steps: 32 | Train Loss: 11.282 Vali Loss: 36.403 Vali Acc: 0.359 Test Loss: 36.403 Test Acc: 0.359
Validation loss decreased (-0.251467 --> -0.358415).  Saving model ...
Epoch: 3 cost time: 23.173799753189087
Epoch: 3, Steps: 32 | Train Loss: 23.629 Vali Loss: 38.170 Vali Acc: 0.450 Test Loss: 38.170 Test Acc: 0.450
Validation loss decreased (-0.358415 --> -0.450000).  Saving model ...
Epoch: 4 cost time: 23.32608914375305
Epoch: 4, Steps: 32 | Train Loss: 35.881 Vali Loss: 122.371 Vali Acc: 0.290 Test Loss: 122.371 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 23.563355684280396
Epoch: 5, Steps: 32 | Train Loss: 18.177 Vali Loss: 83.496 Vali Acc: 0.511 Test Loss: 83.496 Test Acc: 0.511
Validation loss decreased (-0.450000 --> -0.510615).  Saving model ...
Epoch: 6 cost time: 23.68896460533142
Epoch: 6, Steps: 32 | Train Loss: 15.384 Vali Loss: 93.314 Vali Acc: 0.511 Test Loss: 93.314 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 23.972450017929077
Epoch: 7, Steps: 32 | Train Loss: 8.210 Vali Loss: 100.807 Vali Acc: 0.557 Test Loss: 100.807 Test Acc: 0.557
Validation loss decreased (-0.510615 --> -0.556244).  Saving model ...
Epoch: 8 cost time: 23.67103123664856
Epoch: 8, Steps: 32 | Train Loss: 15.965 Vali Loss: 151.722 Vali Acc: 0.542 Test Loss: 151.722 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 23.91958498954773
Epoch: 9, Steps: 32 | Train Loss: 13.738 Vali Loss: 139.929 Vali Acc: 0.557 Test Loss: 139.929 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 24.000169277191162
Epoch: 10, Steps: 32 | Train Loss: 3.663 Vali Loss: 218.314 Vali Acc: 0.534 Test Loss: 218.314 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 24.01938557624817
Epoch: 11, Steps: 32 | Train Loss: 6.479 Vali Loss: 235.711 Vali Acc: 0.534 Test Loss: 235.711 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 24.207374334335327
Epoch: 12, Steps: 32 | Train Loss: 2.926 Vali Loss: 148.284 Vali Acc: 0.481 Test Loss: 148.284 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 24.173754930496216
Epoch: 13, Steps: 32 | Train Loss: 5.662 Vali Loss: 189.326 Vali Acc: 0.496 Test Loss: 189.326 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 23.97966742515564
Epoch: 14, Steps: 32 | Train Loss: 1.568 Vali Loss: 205.331 Vali Acc: 0.443 Test Loss: 205.331 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 24.06731104850769
Epoch: 15, Steps: 32 | Train Loss: 3.761 Vali Loss: 209.790 Vali Acc: 0.382 Test Loss: 209.790 Test Acc: 0.382
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 24.065086603164673
Epoch: 16, Steps: 32 | Train Loss: 1.865 Vali Loss: 215.553 Vali Acc: 0.443 Test Loss: 215.553 Test Acc: 0.443
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 24.036690950393677
Epoch: 17, Steps: 32 | Train Loss: 10.492 Vali Loss: 218.206 Vali Acc: 0.504 Test Loss: 218.206 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df512_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 26444549
model size : 136.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df512_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 20.058884859085083
Epoch: 1, Steps: 32 | Train Loss: 17.645 Vali Loss: 60.340 Vali Acc: 0.237 Test Loss: 60.340 Test Acc: 0.237
Validation loss decreased (inf --> -0.236038).  Saving model ...
Epoch: 2 cost time: 19.45439887046814
Epoch: 2, Steps: 32 | Train Loss: 30.912 Vali Loss: 56.088 Vali Acc: 0.275 Test Loss: 56.088 Test Acc: 0.275
Validation loss decreased (-0.236038 --> -0.274248).  Saving model ...
Epoch: 3 cost time: 19.517358541488647
Epoch: 3, Steps: 32 | Train Loss: 30.033 Vali Loss: 50.403 Vali Acc: 0.389 Test Loss: 50.403 Test Acc: 0.389
Validation loss decreased (-0.274248 --> -0.388809).  Saving model ...
Epoch: 4 cost time: 20.053964376449585
Epoch: 4, Steps: 32 | Train Loss: 18.433 Vali Loss: 59.659 Vali Acc: 0.519 Test Loss: 59.659 Test Acc: 0.519
Validation loss decreased (-0.388809 --> -0.518487).  Saving model ...
Epoch: 5 cost time: 19.77924919128418
Epoch: 5, Steps: 32 | Train Loss: 15.726 Vali Loss: 82.270 Vali Acc: 0.565 Test Loss: 82.270 Test Acc: 0.565
Validation loss decreased (-0.518487 --> -0.564063).  Saving model ...
Epoch: 6 cost time: 19.938359022140503
Epoch: 6, Steps: 32 | Train Loss: 10.108 Vali Loss: 63.637 Vali Acc: 0.550 Test Loss: 63.637 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 19.980871438980103
Epoch: 7, Steps: 32 | Train Loss: 9.150 Vali Loss: 67.042 Vali Acc: 0.588 Test Loss: 67.042 Test Acc: 0.588
Validation loss decreased (-0.564063 --> -0.587116).  Saving model ...
Epoch: 8 cost time: 20.264638662338257
Epoch: 8, Steps: 32 | Train Loss: 7.873 Vali Loss: 90.303 Vali Acc: 0.527 Test Loss: 90.303 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 20.07440495491028
Epoch: 9, Steps: 32 | Train Loss: 4.223 Vali Loss: 189.577 Vali Acc: 0.481 Test Loss: 189.577 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 20.074145555496216
Epoch: 10, Steps: 32 | Train Loss: 8.569 Vali Loss: 226.611 Vali Acc: 0.321 Test Loss: 226.611 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 20.014560222625732
Epoch: 11, Steps: 32 | Train Loss: 29.652 Vali Loss: 186.188 Vali Acc: 0.328 Test Loss: 186.188 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 20.00439143180847
Epoch: 12, Steps: 32 | Train Loss: 16.876 Vali Loss: 136.787 Vali Acc: 0.519 Test Loss: 136.787 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 20.399218559265137
Epoch: 13, Steps: 32 | Train Loss: 5.099 Vali Loss: 111.757 Vali Acc: 0.504 Test Loss: 111.757 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 20.122368097305298
Epoch: 14, Steps: 32 | Train Loss: 0.318 Vali Loss: 187.409 Vali Acc: 0.427 Test Loss: 187.409 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 20.247932195663452
Epoch: 15, Steps: 32 | Train Loss: 24.481 Vali Loss: 227.905 Vali Acc: 0.496 Test Loss: 227.905 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 20.005584239959717
Epoch: 16, Steps: 32 | Train Loss: 16.157 Vali Loss: 123.889 Vali Acc: 0.534 Test Loss: 123.889 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 20.073974132537842
Epoch: 17, Steps: 32 | Train Loss: 2.133 Vali Loss: 279.369 Vali Acc: 0.473 Test Loss: 279.369 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df512_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 26444549
model size : 136.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         8992                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df256_ma8992_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 350.8805501461029
Epoch: 1, Steps: 32 | Train Loss: 17.873 Vali Loss: 28.598 Vali Acc: 0.305 Test Loss: 28.598 Test Acc: 0.305
Validation loss decreased (inf --> -0.305058).  Saving model ...
Epoch: 2 cost time: 401.3015639781952
Epoch: 2, Steps: 32 | Train Loss: 40.788 Vali Loss: 60.073 Vali Acc: 0.412 Test Loss: 60.073 Test Acc: 0.412
Validation loss decreased (-0.305058 --> -0.411613).  Saving model ...
Epoch: 3 cost time: 437.671089887619
Epoch: 3, Steps: 32 | Train Loss: 19.990 Vali Loss: 140.252 Vali Acc: 0.267 Test Loss: 140.252 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 435.9412293434143
Epoch: 4, Steps: 32 | Train Loss: 30.012 Vali Loss: 130.446 Vali Acc: 0.542 Test Loss: 130.446 Test Acc: 0.542
Validation loss decreased (-0.411613 --> -0.540680).  Saving model ...
Epoch: 5 cost time: 457.4604239463806
Epoch: 5, Steps: 32 | Train Loss: 8.443 Vali Loss: 106.513 Vali Acc: 0.351 Test Loss: 106.513 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 446.53888463974
Epoch: 6, Steps: 32 | Train Loss: 7.796 Vali Loss: 187.579 Vali Acc: 0.511 Test Loss: 187.579 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 449.02736163139343
Epoch: 7, Steps: 32 | Train Loss: 24.497 Vali Loss: 176.407 Vali Acc: 0.534 Test Loss: 176.407 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 457.8457067012787
Epoch: 8, Steps: 32 | Train Loss: 17.599 Vali Loss: 191.667 Vali Acc: 0.382 Test Loss: 191.667 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 454.84383511543274
Epoch: 9, Steps: 32 | Train Loss: 8.471 Vali Loss: 294.203 Vali Acc: 0.496 Test Loss: 294.203 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 456.0284662246704
Epoch: 10, Steps: 32 | Train Loss: 9.214 Vali Loss: 199.818 Vali Acc: 0.519 Test Loss: 199.818 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 460.1721525192261
Epoch: 11, Steps: 32 | Train Loss: 1.522 Vali Loss: 283.735 Vali Acc: 0.489 Test Loss: 283.735 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 456.46369194984436
Epoch: 12, Steps: 32 | Train Loss: 1.867 Vali Loss: 345.317 Vali Acc: 0.527 Test Loss: 345.317 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 454.0375895500183
Epoch: 13, Steps: 32 | Train Loss: 13.981 Vali Loss: 286.008 Vali Acc: 0.458 Test Loss: 286.008 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 454.20572423934937
Epoch: 14, Steps: 32 | Train Loss: 15.724 Vali Loss: 440.137 Vali Acc: 0.527 Test Loss: 440.137 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df256_ma8992_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 26051333
model size : 134.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         7194                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df256_ma7194_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 284.5631878376007
Epoch: 1, Steps: 32 | Train Loss: 19.739 Vali Loss: 30.452 Vali Acc: 0.313 Test Loss: 30.452 Test Acc: 0.313
Validation loss decreased (inf --> -0.312673).  Saving model ...
Epoch: 2 cost time: 331.22105503082275
Epoch: 2, Steps: 32 | Train Loss: 31.173 Vali Loss: 96.131 Vali Acc: 0.267 Test Loss: 96.131 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 354.79574155807495
Epoch: 3, Steps: 32 | Train Loss: 25.190 Vali Loss: 69.701 Vali Acc: 0.443 Test Loss: 69.701 Test Acc: 0.443
Validation loss decreased (-0.312673 --> -0.442051).  Saving model ...
Epoch: 4 cost time: 362.7542550563812
Epoch: 4, Steps: 32 | Train Loss: 25.499 Vali Loss: 106.851 Vali Acc: 0.458 Test Loss: 106.851 Test Acc: 0.458
Validation loss decreased (-0.442051 --> -0.456947).  Saving model ...
Epoch: 5 cost time: 365.2648949623108
Epoch: 5, Steps: 32 | Train Loss: 20.238 Vali Loss: 230.593 Vali Acc: 0.260 Test Loss: 230.593 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 354.6890060901642
Epoch: 6, Steps: 32 | Train Loss: 31.758 Vali Loss: 171.203 Vali Acc: 0.542 Test Loss: 171.203 Test Acc: 0.542
Validation loss decreased (-0.456947 --> -0.540273).  Saving model ...
Epoch: 7 cost time: 370.9949584007263
Epoch: 7, Steps: 32 | Train Loss: 3.109 Vali Loss: 215.173 Vali Acc: 0.305 Test Loss: 215.173 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 372.4015100002289
Epoch: 8, Steps: 32 | Train Loss: 8.266 Vali Loss: 179.910 Vali Acc: 0.519 Test Loss: 179.910 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 362.7719783782959
Epoch: 9, Steps: 32 | Train Loss: 18.348 Vali Loss: 277.129 Vali Acc: 0.557 Test Loss: 277.129 Test Acc: 0.557
Validation loss decreased (-0.540273 --> -0.554481).  Saving model ...
Epoch: 10 cost time: 368.8743271827698
Epoch: 10, Steps: 32 | Train Loss: 2.194 Vali Loss: 203.471 Vali Acc: 0.382 Test Loss: 203.471 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 365.592276096344
Epoch: 11, Steps: 32 | Train Loss: 12.862 Vali Loss: 143.835 Vali Acc: 0.595 Test Loss: 143.835 Test Acc: 0.595
Validation loss decreased (-0.554481 --> -0.593982).  Saving model ...
Epoch: 12 cost time: 372.80012941360474
Epoch: 12, Steps: 32 | Train Loss: 2.642 Vali Loss: 172.530 Vali Acc: 0.550 Test Loss: 172.530 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 368.0370788574219
Epoch: 13, Steps: 32 | Train Loss: 5.290 Vali Loss: 195.365 Vali Acc: 0.489 Test Loss: 195.365 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 372.95138454437256
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 201.702 Vali Acc: 0.511 Test Loss: 201.702 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 367.87002301216125
Epoch: 15, Steps: 32 | Train Loss: 17.745 Vali Loss: 277.377 Vali Acc: 0.405 Test Loss: 277.377 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 362.7677526473999
Epoch: 16, Steps: 32 | Train Loss: 25.739 Vali Loss: 307.354 Vali Acc: 0.489 Test Loss: 307.354 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 370.65996861457825
Epoch: 17, Steps: 32 | Train Loss: 3.609 Vali Loss: 302.473 Vali Acc: 0.519 Test Loss: 302.473 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 370.453387260437
Epoch: 18, Steps: 32 | Train Loss: 1.688 Vali Loss: 364.323 Vali Acc: 0.542 Test Loss: 364.323 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 369.73728108406067
Epoch: 19, Steps: 32 | Train Loss: 4.647 Vali Loss: 442.351 Vali Acc: 0.565 Test Loss: 442.351 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 370.1672627925873
Epoch: 20, Steps: 32 | Train Loss: 1.798 Vali Loss: 404.194 Vali Acc: 0.550 Test Loss: 404.194 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 371.5125114917755
Epoch: 21, Steps: 32 | Train Loss: 2.668 Vali Loss: 284.574 Vali Acc: 0.427 Test Loss: 284.574 Test Acc: 0.427
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df256_ma7194_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 26051333
model size : 134.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5396                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df256_ma5396_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 220.15405821800232
Epoch: 1, Steps: 32 | Train Loss: 27.281 Vali Loss: 57.089 Vali Acc: 0.229 Test Loss: 57.089 Test Acc: 0.229
Validation loss decreased (inf --> -0.228437).  Saving model ...
Epoch: 2 cost time: 256.17362904548645
Epoch: 2, Steps: 32 | Train Loss: 22.535 Vali Loss: 69.073 Vali Acc: 0.214 Test Loss: 69.073 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 271.13716888427734
Epoch: 3, Steps: 32 | Train Loss: 22.646 Vali Loss: 51.536 Vali Acc: 0.328 Test Loss: 51.536 Test Acc: 0.328
Validation loss decreased (-0.228437 --> -0.327729).  Saving model ...
Epoch: 4 cost time: 278.94072818756104
Epoch: 4, Steps: 32 | Train Loss: 16.168 Vali Loss: 107.858 Vali Acc: 0.282 Test Loss: 107.858 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 272.7644157409668
Epoch: 5, Steps: 32 | Train Loss: 13.788 Vali Loss: 99.543 Vali Acc: 0.275 Test Loss: 99.543 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 270.48196625709534
Epoch: 6, Steps: 32 | Train Loss: 22.007 Vali Loss: 170.374 Vali Acc: 0.527 Test Loss: 170.374 Test Acc: 0.527
Validation loss decreased (-0.327729 --> -0.525014).  Saving model ...
Epoch: 7 cost time: 269.69521617889404
Epoch: 7, Steps: 32 | Train Loss: 21.492 Vali Loss: 149.537 Vali Acc: 0.527 Test Loss: 149.537 Test Acc: 0.527
Validation loss decreased (-0.525014 --> -0.525222).  Saving model ...
Epoch: 8 cost time: 280.3535625934601
Epoch: 8, Steps: 32 | Train Loss: 13.511 Vali Loss: 241.545 Vali Acc: 0.298 Test Loss: 241.545 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 283.3185751438141
Epoch: 9, Steps: 32 | Train Loss: 2.624 Vali Loss: 206.410 Vali Acc: 0.435 Test Loss: 206.410 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 274.3140518665314
Epoch: 10, Steps: 32 | Train Loss: 15.887 Vali Loss: 284.254 Vali Acc: 0.366 Test Loss: 284.254 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 279.8507933616638
Epoch: 11, Steps: 32 | Train Loss: 5.003 Vali Loss: 198.909 Vali Acc: 0.405 Test Loss: 198.909 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 279.46426463127136
Epoch: 12, Steps: 32 | Train Loss: 4.810 Vali Loss: 246.431 Vali Acc: 0.382 Test Loss: 246.431 Test Acc: 0.382
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 281.46524930000305
Epoch: 13, Steps: 32 | Train Loss: 3.591 Vali Loss: 302.746 Vali Acc: 0.504 Test Loss: 302.746 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 281.0439577102661
Epoch: 14, Steps: 32 | Train Loss: 1.861 Vali Loss: 376.070 Vali Acc: 0.534 Test Loss: 376.070 Test Acc: 0.534
Validation loss decreased (-0.525222 --> -0.530590).  Saving model ...
Epoch: 15 cost time: 276.88159942626953
Epoch: 15, Steps: 32 | Train Loss: 12.976 Vali Loss: 359.616 Vali Acc: 0.466 Test Loss: 359.616 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 280.4531280994415
Epoch: 16, Steps: 32 | Train Loss: 7.423 Vali Loss: 507.853 Vali Acc: 0.504 Test Loss: 507.853 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 281.4803605079651
Epoch: 17, Steps: 32 | Train Loss: 8.314 Vali Loss: 265.341 Vali Acc: 0.382 Test Loss: 265.341 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 279.8667652606964
Epoch: 18, Steps: 32 | Train Loss: 4.085 Vali Loss: 319.336 Vali Acc: 0.435 Test Loss: 319.336 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 281.88473987579346
Epoch: 19, Steps: 32 | Train Loss: 1.958 Vali Loss: 325.796 Vali Acc: 0.466 Test Loss: 325.796 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 281.9816963672638
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 319.781 Vali Acc: 0.481 Test Loss: 319.781 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 282.58234548568726
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 319.598 Vali Acc: 0.481 Test Loss: 319.598 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 284.88448762893677
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 319.591 Vali Acc: 0.481 Test Loss: 319.591 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 283.16547989845276
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 319.591 Vali Acc: 0.481 Test Loss: 319.591 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 283.1370949745178
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 319.591 Vali Acc: 0.481 Test Loss: 319.591 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df256_ma5396_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 26051333
model size : 134.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3597                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df256_ma3597_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 148.94035983085632
Epoch: 1, Steps: 32 | Train Loss: 19.515 Vali Loss: 40.165 Vali Acc: 0.275 Test Loss: 40.165 Test Acc: 0.275
Validation loss decreased (inf --> -0.274408).  Saving model ...
Epoch: 2 cost time: 171.49283576011658
Epoch: 2, Steps: 32 | Train Loss: 44.293 Vali Loss: 62.978 Vali Acc: 0.252 Test Loss: 62.978 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 185.57845449447632
Epoch: 3, Steps: 32 | Train Loss: 10.338 Vali Loss: 155.693 Vali Acc: 0.191 Test Loss: 155.693 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 181.99210453033447
Epoch: 4, Steps: 32 | Train Loss: 30.393 Vali Loss: 65.105 Vali Acc: 0.435 Test Loss: 65.105 Test Acc: 0.435
Validation loss decreased (-0.274408 --> -0.434463).  Saving model ...
Epoch: 5 cost time: 188.52393913269043
Epoch: 5, Steps: 32 | Train Loss: 21.589 Vali Loss: 128.641 Vali Acc: 0.519 Test Loss: 128.641 Test Acc: 0.519
Validation loss decreased (-0.434463 --> -0.517798).  Saving model ...
Epoch: 6 cost time: 182.12347865104675
Epoch: 6, Steps: 32 | Train Loss: 30.178 Vali Loss: 124.126 Vali Acc: 0.359 Test Loss: 124.126 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 190.5500144958496
Epoch: 7, Steps: 32 | Train Loss: 13.823 Vali Loss: 124.038 Vali Acc: 0.458 Test Loss: 124.038 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 190.45516729354858
Epoch: 8, Steps: 32 | Train Loss: 5.007 Vali Loss: 161.350 Vali Acc: 0.405 Test Loss: 161.350 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 188.55383682250977
Epoch: 9, Steps: 32 | Train Loss: 4.727 Vali Loss: 219.565 Vali Acc: 0.481 Test Loss: 219.565 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 189.49290943145752
Epoch: 10, Steps: 32 | Train Loss: 17.136 Vali Loss: 163.006 Vali Acc: 0.496 Test Loss: 163.006 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 193.37295484542847
Epoch: 11, Steps: 32 | Train Loss: 9.687 Vali Loss: 309.458 Vali Acc: 0.290 Test Loss: 309.458 Test Acc: 0.290
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 192.58541893959045
Epoch: 12, Steps: 32 | Train Loss: 6.742 Vali Loss: 280.143 Vali Acc: 0.397 Test Loss: 280.143 Test Acc: 0.397
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 189.3686876296997
Epoch: 13, Steps: 32 | Train Loss: 13.111 Vali Loss: 333.826 Vali Acc: 0.458 Test Loss: 333.826 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 190.52286624908447
Epoch: 14, Steps: 32 | Train Loss: 0.518 Vali Loss: 380.113 Vali Acc: 0.496 Test Loss: 380.113 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 187.6917896270752
Epoch: 15, Steps: 32 | Train Loss: 9.052 Vali Loss: 322.108 Vali Acc: 0.450 Test Loss: 322.108 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df256_ma3597_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 26051333
model size : 134.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1799                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df256_ma1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 73.07443380355835
Epoch: 1, Steps: 32 | Train Loss: 21.847 Vali Loss: 20.274 Vali Acc: 0.504 Test Loss: 20.274 Test Acc: 0.504
Validation loss decreased (inf --> -0.503614).  Saving model ...
Epoch: 2 cost time: 80.94164681434631
Epoch: 2, Steps: 32 | Train Loss: 19.875 Vali Loss: 45.755 Vali Acc: 0.275 Test Loss: 45.755 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 91.49006533622742
Epoch: 3, Steps: 32 | Train Loss: 18.894 Vali Loss: 47.477 Vali Acc: 0.397 Test Loss: 47.477 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 94.03015756607056
Epoch: 4, Steps: 32 | Train Loss: 20.478 Vali Loss: 98.843 Vali Acc: 0.435 Test Loss: 98.843 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 91.39257335662842
Epoch: 5, Steps: 32 | Train Loss: 36.916 Vali Loss: 126.767 Vali Acc: 0.427 Test Loss: 126.767 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 94.39968061447144
Epoch: 6, Steps: 32 | Train Loss: 7.983 Vali Loss: 135.947 Vali Acc: 0.511 Test Loss: 135.947 Test Acc: 0.511
Validation loss decreased (-0.503614 --> -0.510091).  Saving model ...
Epoch: 7 cost time: 95.98054075241089
Epoch: 7, Steps: 32 | Train Loss: 5.485 Vali Loss: 182.326 Vali Acc: 0.557 Test Loss: 182.326 Test Acc: 0.557
Validation loss decreased (-0.510091 --> -0.555429).  Saving model ...
Epoch: 8 cost time: 95.32283043861389
Epoch: 8, Steps: 32 | Train Loss: 7.275 Vali Loss: 194.038 Vali Acc: 0.511 Test Loss: 194.038 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 97.70017838478088
Epoch: 9, Steps: 32 | Train Loss: 2.499 Vali Loss: 245.036 Vali Acc: 0.489 Test Loss: 245.036 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 95.84024238586426
Epoch: 10, Steps: 32 | Train Loss: 7.125 Vali Loss: 139.326 Vali Acc: 0.542 Test Loss: 139.326 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 94.75029039382935
Epoch: 11, Steps: 32 | Train Loss: 20.660 Vali Loss: 236.431 Vali Acc: 0.511 Test Loss: 236.431 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 95.59679508209229
Epoch: 12, Steps: 32 | Train Loss: 9.570 Vali Loss: 228.504 Vali Acc: 0.534 Test Loss: 228.504 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 97.66116857528687
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 247.759 Vali Acc: 0.527 Test Loss: 247.759 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 97.25723934173584
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 248.829 Vali Acc: 0.527 Test Loss: 248.829 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 97.5094518661499
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 248.870 Vali Acc: 0.527 Test Loss: 248.870 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 97.88846325874329
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 248.871 Vali Acc: 0.527 Test Loss: 248.871 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 97.79748964309692
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 248.871 Vali Acc: 0.527 Test Loss: 248.871 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df256_ma1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 26051333
model size : 134.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df256_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 43.92835855484009
Epoch: 1, Steps: 32 | Train Loss: 26.014 Vali Loss: 48.170 Vali Acc: 0.504 Test Loss: 48.170 Test Acc: 0.504
Validation loss decreased (inf --> -0.503335).  Saving model ...
Epoch: 2 cost time: 49.269288301467896
Epoch: 2, Steps: 32 | Train Loss: 23.776 Vali Loss: 42.754 Vali Acc: 0.321 Test Loss: 42.754 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 54.8259220123291
Epoch: 3, Steps: 32 | Train Loss: 9.138 Vali Loss: 42.164 Vali Acc: 0.420 Test Loss: 42.164 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 54.08007192611694
Epoch: 4, Steps: 32 | Train Loss: 17.007 Vali Loss: 155.822 Vali Acc: 0.496 Test Loss: 155.822 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 54.39407205581665
Epoch: 5, Steps: 32 | Train Loss: 12.478 Vali Loss: 209.521 Vali Acc: 0.336 Test Loss: 209.521 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 54.34720587730408
Epoch: 6, Steps: 32 | Train Loss: 33.978 Vali Loss: 232.597 Vali Acc: 0.473 Test Loss: 232.597 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 54.00731611251831
Epoch: 7, Steps: 32 | Train Loss: 15.811 Vali Loss: 192.114 Vali Acc: 0.527 Test Loss: 192.114 Test Acc: 0.527
Validation loss decreased (-0.503335 --> -0.524796).  Saving model ...
Epoch: 8 cost time: 55.09501576423645
Epoch: 8, Steps: 32 | Train Loss: 6.600 Vali Loss: 134.873 Vali Acc: 0.481 Test Loss: 134.873 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 56.22264313697815
Epoch: 9, Steps: 32 | Train Loss: 7.444 Vali Loss: 297.067 Vali Acc: 0.519 Test Loss: 297.067 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 55.767658948898315
Epoch: 10, Steps: 32 | Train Loss: 10.387 Vali Loss: 175.489 Vali Acc: 0.420 Test Loss: 175.489 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 56.60315442085266
Epoch: 11, Steps: 32 | Train Loss: 11.583 Vali Loss: 179.767 Vali Acc: 0.412 Test Loss: 179.767 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 55.891273975372314
Epoch: 12, Steps: 32 | Train Loss: 11.023 Vali Loss: 176.454 Vali Acc: 0.435 Test Loss: 176.454 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 56.46736931800842
Epoch: 13, Steps: 32 | Train Loss: 8.594 Vali Loss: 263.191 Vali Acc: 0.504 Test Loss: 263.191 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 56.44495368003845
Epoch: 14, Steps: 32 | Train Loss: 5.907 Vali Loss: 502.543 Vali Acc: 0.527 Test Loss: 502.543 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 55.130030155181885
Epoch: 15, Steps: 32 | Train Loss: 37.863 Vali Loss: 269.227 Vali Acc: 0.321 Test Loss: 269.227 Test Acc: 0.321
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 54.87439584732056
Epoch: 16, Steps: 32 | Train Loss: 17.386 Vali Loss: 357.386 Vali Acc: 0.374 Test Loss: 357.386 Test Acc: 0.374
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 56.10274791717529
Epoch: 17, Steps: 32 | Train Loss: 5.209 Vali Loss: 386.759 Vali Acc: 0.511 Test Loss: 386.759 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df256_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 26051333
model size : 134.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         540                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df256_ma540_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 32.83599853515625
Epoch: 1, Steps: 32 | Train Loss: 21.728 Vali Loss: 56.311 Vali Acc: 0.458 Test Loss: 56.311 Test Acc: 0.458
Validation loss decreased (inf --> -0.457452).  Saving model ...
Epoch: 2 cost time: 36.8733651638031
Epoch: 2, Steps: 32 | Train Loss: 29.509 Vali Loss: 47.189 Vali Acc: 0.282 Test Loss: 47.189 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 38.47792673110962
Epoch: 3, Steps: 32 | Train Loss: 18.435 Vali Loss: 64.587 Vali Acc: 0.321 Test Loss: 64.587 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 38.91461253166199
Epoch: 4, Steps: 32 | Train Loss: 8.161 Vali Loss: 96.977 Vali Acc: 0.496 Test Loss: 96.977 Test Acc: 0.496
Validation loss decreased (-0.457452 --> -0.495213).  Saving model ...
Epoch: 5 cost time: 38.838793992996216
Epoch: 5, Steps: 32 | Train Loss: 10.949 Vali Loss: 102.607 Vali Acc: 0.427 Test Loss: 102.607 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 39.315208196640015
Epoch: 6, Steps: 32 | Train Loss: 9.770 Vali Loss: 204.400 Vali Acc: 0.504 Test Loss: 204.400 Test Acc: 0.504
Validation loss decreased (-0.495213 --> -0.501773).  Saving model ...
Epoch: 7 cost time: 38.560335874557495
Epoch: 7, Steps: 32 | Train Loss: 16.139 Vali Loss: 97.860 Vali Acc: 0.427 Test Loss: 97.860 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 38.680875062942505
Epoch: 8, Steps: 32 | Train Loss: 21.536 Vali Loss: 191.593 Vali Acc: 0.313 Test Loss: 191.593 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 39.152942180633545
Epoch: 9, Steps: 32 | Train Loss: 15.087 Vali Loss: 120.058 Vali Acc: 0.489 Test Loss: 120.058 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 39.70306158065796
Epoch: 10, Steps: 32 | Train Loss: 0.389 Vali Loss: 211.755 Vali Acc: 0.397 Test Loss: 211.755 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 39.457645416259766
Epoch: 11, Steps: 32 | Train Loss: 1.147 Vali Loss: 241.718 Vali Acc: 0.550 Test Loss: 241.718 Test Acc: 0.550
Validation loss decreased (-0.501773 --> -0.547201).  Saving model ...
Epoch: 12 cost time: 39.458768129348755
Epoch: 12, Steps: 32 | Train Loss: 11.922 Vali Loss: 198.154 Vali Acc: 0.458 Test Loss: 198.154 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 38.757131814956665
Epoch: 13, Steps: 32 | Train Loss: 14.903 Vali Loss: 289.487 Vali Acc: 0.389 Test Loss: 289.487 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 39.53563356399536
Epoch: 14, Steps: 32 | Train Loss: 12.449 Vali Loss: 329.674 Vali Acc: 0.290 Test Loss: 329.674 Test Acc: 0.290
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 39.31964421272278
Epoch: 15, Steps: 32 | Train Loss: 39.992 Vali Loss: 406.570 Vali Acc: 0.344 Test Loss: 406.570 Test Acc: 0.344
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 39.27391481399536
Epoch: 16, Steps: 32 | Train Loss: 7.124 Vali Loss: 426.239 Vali Acc: 0.443 Test Loss: 426.239 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 39.724804162979126
Epoch: 17, Steps: 32 | Train Loss: 0.066 Vali Loss: 369.580 Vali Acc: 0.527 Test Loss: 369.580 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 39.74259328842163
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 325.871 Vali Acc: 0.511 Test Loss: 325.871 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 39.75589990615845
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 324.490 Vali Acc: 0.511 Test Loss: 324.490 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 39.82543587684631
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 324.441 Vali Acc: 0.511 Test Loss: 324.441 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 39.71031475067139
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 324.440 Vali Acc: 0.511 Test Loss: 324.440 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df256_ma540_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 26051333
model size : 134.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df256_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 27.26711392402649
Epoch: 1, Steps: 32 | Train Loss: 20.358 Vali Loss: 47.112 Vali Acc: 0.443 Test Loss: 47.112 Test Acc: 0.443
Validation loss decreased (inf --> -0.442277).  Saving model ...
Epoch: 2 cost time: 29.23487615585327
Epoch: 2, Steps: 32 | Train Loss: 43.259 Vali Loss: 45.364 Vali Acc: 0.321 Test Loss: 45.364 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 30.941080808639526
Epoch: 3, Steps: 32 | Train Loss: 12.760 Vali Loss: 71.936 Vali Acc: 0.321 Test Loss: 71.936 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 30.90262007713318
Epoch: 4, Steps: 32 | Train Loss: 18.039 Vali Loss: 77.408 Vali Acc: 0.313 Test Loss: 77.408 Test Acc: 0.313
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 30.745184183120728
Epoch: 5, Steps: 32 | Train Loss: 30.525 Vali Loss: 94.853 Vali Acc: 0.366 Test Loss: 94.853 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 30.9085636138916
Epoch: 6, Steps: 32 | Train Loss: 11.396 Vali Loss: 174.506 Vali Acc: 0.496 Test Loss: 174.506 Test Acc: 0.496
Validation loss decreased (-0.442277 --> -0.494438).  Saving model ...
Epoch: 7 cost time: 30.872633695602417
Epoch: 7, Steps: 32 | Train Loss: 14.961 Vali Loss: 256.082 Vali Acc: 0.504 Test Loss: 256.082 Test Acc: 0.504
Validation loss decreased (-0.494438 --> -0.501256).  Saving model ...
Epoch: 8 cost time: 31.023818016052246
Epoch: 8, Steps: 32 | Train Loss: 20.807 Vali Loss: 203.949 Vali Acc: 0.496 Test Loss: 203.949 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 31.19545602798462
Epoch: 9, Steps: 32 | Train Loss: 14.475 Vali Loss: 174.416 Vali Acc: 0.382 Test Loss: 174.416 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 31.044973373413086
Epoch: 10, Steps: 32 | Train Loss: 35.179 Vali Loss: 205.035 Vali Acc: 0.328 Test Loss: 205.035 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 31.27467679977417
Epoch: 11, Steps: 32 | Train Loss: 7.230 Vali Loss: 260.999 Vali Acc: 0.397 Test Loss: 260.999 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 31.310966968536377
Epoch: 12, Steps: 32 | Train Loss: 7.991 Vali Loss: 258.303 Vali Acc: 0.473 Test Loss: 258.303 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 31.60937261581421
Epoch: 13, Steps: 32 | Train Loss: 3.903 Vali Loss: 191.221 Vali Acc: 0.481 Test Loss: 191.221 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 31.720826387405396
Epoch: 14, Steps: 32 | Train Loss: 0.670 Vali Loss: 279.152 Vali Acc: 0.466 Test Loss: 279.152 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 31.41945505142212
Epoch: 15, Steps: 32 | Train Loss: 14.241 Vali Loss: 346.322 Vali Acc: 0.397 Test Loss: 346.322 Test Acc: 0.397
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 31.49075198173523
Epoch: 16, Steps: 32 | Train Loss: 2.730 Vali Loss: 237.636 Vali Acc: 0.374 Test Loss: 237.636 Test Acc: 0.374
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 31.615139722824097
Epoch: 17, Steps: 32 | Train Loss: 3.011 Vali Loss: 297.043 Vali Acc: 0.443 Test Loss: 297.043 Test Acc: 0.443
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df256_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 26051333
model size : 134.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df256_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 22.250709533691406
Epoch: 1, Steps: 32 | Train Loss: 21.901 Vali Loss: 28.735 Vali Acc: 0.466 Test Loss: 28.735 Test Acc: 0.466
Validation loss decreased (inf --> -0.465362).  Saving model ...
Epoch: 2 cost time: 21.91647505760193
Epoch: 2, Steps: 32 | Train Loss: 31.458 Vali Loss: 63.919 Vali Acc: 0.275 Test Loss: 63.919 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 22.51257038116455
Epoch: 3, Steps: 32 | Train Loss: 29.329 Vali Loss: 49.806 Vali Acc: 0.397 Test Loss: 49.806 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 23.268564462661743
Epoch: 4, Steps: 32 | Train Loss: 8.553 Vali Loss: 55.763 Vali Acc: 0.534 Test Loss: 55.763 Test Acc: 0.534
Validation loss decreased (-0.465362 --> -0.533794).  Saving model ...
Epoch: 5 cost time: 23.541700839996338
Epoch: 5, Steps: 32 | Train Loss: 8.436 Vali Loss: 67.459 Vali Acc: 0.382 Test Loss: 67.459 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 23.314140558242798
Epoch: 6, Steps: 32 | Train Loss: 7.593 Vali Loss: 82.120 Vali Acc: 0.527 Test Loss: 82.120 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 23.166501998901367
Epoch: 7, Steps: 32 | Train Loss: 8.659 Vali Loss: 80.706 Vali Acc: 0.473 Test Loss: 80.706 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 23.024972915649414
Epoch: 8, Steps: 32 | Train Loss: 13.116 Vali Loss: 123.548 Vali Acc: 0.435 Test Loss: 123.548 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 23.57005548477173
Epoch: 9, Steps: 32 | Train Loss: 6.382 Vali Loss: 158.645 Vali Acc: 0.458 Test Loss: 158.645 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 23.355973958969116
Epoch: 10, Steps: 32 | Train Loss: 6.421 Vali Loss: 184.275 Vali Acc: 0.450 Test Loss: 184.275 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 23.18464732170105
Epoch: 11, Steps: 32 | Train Loss: 14.423 Vali Loss: 134.272 Vali Acc: 0.504 Test Loss: 134.272 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 23.173656225204468
Epoch: 12, Steps: 32 | Train Loss: 8.422 Vali Loss: 188.328 Vali Acc: 0.504 Test Loss: 188.328 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 23.147858381271362
Epoch: 13, Steps: 32 | Train Loss: 24.209 Vali Loss: 404.103 Vali Acc: 0.458 Test Loss: 404.103 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 23.36569046974182
Epoch: 14, Steps: 32 | Train Loss: 14.702 Vali Loss: 372.776 Vali Acc: 0.382 Test Loss: 372.776 Test Acc: 0.382
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df256_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 26051333
model size : 134.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df256_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 19.45784306526184
Epoch: 1, Steps: 32 | Train Loss: 16.453 Vali Loss: 29.469 Vali Acc: 0.443 Test Loss: 29.469 Test Acc: 0.443
Validation loss decreased (inf --> -0.442453).  Saving model ...
Epoch: 2 cost time: 18.49836492538452
Epoch: 2, Steps: 32 | Train Loss: 19.888 Vali Loss: 24.279 Vali Acc: 0.611 Test Loss: 24.279 Test Acc: 0.611
Validation loss decreased (-0.442453 --> -0.610444).  Saving model ...
Epoch: 3 cost time: 19.07573103904724
Epoch: 3, Steps: 32 | Train Loss: 19.503 Vali Loss: 72.974 Vali Acc: 0.366 Test Loss: 72.974 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 18.99731206893921
Epoch: 4, Steps: 32 | Train Loss: 21.788 Vali Loss: 90.412 Vali Acc: 0.511 Test Loss: 90.412 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 19.420434951782227
Epoch: 5, Steps: 32 | Train Loss: 8.766 Vali Loss: 54.924 Vali Acc: 0.534 Test Loss: 54.924 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 19.364166498184204
Epoch: 6, Steps: 32 | Train Loss: 14.602 Vali Loss: 60.599 Vali Acc: 0.595 Test Loss: 60.599 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 19.33539319038391
Epoch: 7, Steps: 32 | Train Loss: 6.656 Vali Loss: 125.189 Vali Acc: 0.595 Test Loss: 125.189 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 19.19040274620056
Epoch: 8, Steps: 32 | Train Loss: 21.229 Vali Loss: 166.603 Vali Acc: 0.443 Test Loss: 166.603 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 19.3293616771698
Epoch: 9, Steps: 32 | Train Loss: 6.798 Vali Loss: 97.697 Vali Acc: 0.634 Test Loss: 97.697 Test Acc: 0.634
Validation loss decreased (-0.610444 --> -0.632611).  Saving model ...
Epoch: 10 cost time: 19.27323889732361
Epoch: 10, Steps: 32 | Train Loss: 32.481 Vali Loss: 170.619 Vali Acc: 0.389 Test Loss: 170.619 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 19.450008630752563
Epoch: 11, Steps: 32 | Train Loss: 16.004 Vali Loss: 376.087 Vali Acc: 0.405 Test Loss: 376.087 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 19.452234506607056
Epoch: 12, Steps: 32 | Train Loss: 1.200 Vali Loss: 147.625 Vali Acc: 0.519 Test Loss: 147.625 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 19.409032821655273
Epoch: 13, Steps: 32 | Train Loss: 0.083 Vali Loss: 163.409 Vali Acc: 0.550 Test Loss: 163.409 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 19.32866382598877
Epoch: 14, Steps: 32 | Train Loss: 10.683 Vali Loss: 258.014 Vali Acc: 0.489 Test Loss: 258.014 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 19.675841569900513
Epoch: 15, Steps: 32 | Train Loss: 3.720 Vali Loss: 160.585 Vali Acc: 0.496 Test Loss: 160.585 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 19.347841262817383
Epoch: 16, Steps: 32 | Train Loss: 11.387 Vali Loss: 210.917 Vali Acc: 0.626 Test Loss: 210.917 Test Acc: 0.626
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 19.425913333892822
Epoch: 17, Steps: 32 | Train Loss: 17.541 Vali Loss: 317.449 Vali Acc: 0.344 Test Loss: 317.449 Test Acc: 0.344
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 19.237107753753662
Epoch: 18, Steps: 32 | Train Loss: 10.951 Vali Loss: 209.829 Vali Acc: 0.534 Test Loss: 209.829 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 19.469371795654297
Epoch: 19, Steps: 32 | Train Loss: 2.103 Vali Loss: 328.837 Vali Acc: 0.374 Test Loss: 328.837 Test Acc: 0.374
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df256_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6335877862595419
model parameter : 26051333
model size : 134.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         8992                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df128_ma8992_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 348.6409454345703
Epoch: 1, Steps: 32 | Train Loss: 28.706 Vali Loss: 48.445 Vali Acc: 0.229 Test Loss: 48.445 Test Acc: 0.229
Validation loss decreased (inf --> -0.228523).  Saving model ...
Epoch: 2 cost time: 409.580796957016
Epoch: 2, Steps: 32 | Train Loss: 28.214 Vali Loss: 72.536 Vali Acc: 0.229 Test Loss: 72.536 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 434.34529757499695
Epoch: 3, Steps: 32 | Train Loss: 9.038 Vali Loss: 53.142 Vali Acc: 0.435 Test Loss: 53.142 Test Acc: 0.435
Validation loss decreased (-0.228523 --> -0.434583).  Saving model ...
Epoch: 4 cost time: 446.55465817451477
Epoch: 4, Steps: 32 | Train Loss: 9.980 Vali Loss: 140.833 Vali Acc: 0.466 Test Loss: 140.833 Test Acc: 0.466
Validation loss decreased (-0.434583 --> -0.464241).  Saving model ...
Epoch: 5 cost time: 449.31995916366577
Epoch: 5, Steps: 32 | Train Loss: 29.695 Vali Loss: 132.574 Vali Acc: 0.504 Test Loss: 132.574 Test Acc: 0.504
Validation loss decreased (-0.464241 --> -0.502491).  Saving model ...
Epoch: 6 cost time: 443.70758533477783
Epoch: 6, Steps: 32 | Train Loss: 16.079 Vali Loss: 137.687 Vali Acc: 0.420 Test Loss: 137.687 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 461.7808940410614
Epoch: 7, Steps: 32 | Train Loss: 14.716 Vali Loss: 181.551 Vali Acc: 0.366 Test Loss: 181.551 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 451.2322885990143
Epoch: 8, Steps: 32 | Train Loss: 20.669 Vali Loss: 268.979 Vali Acc: 0.481 Test Loss: 268.979 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 448.0679655075073
Epoch: 9, Steps: 32 | Train Loss: 11.170 Vali Loss: 230.340 Vali Acc: 0.511 Test Loss: 230.340 Test Acc: 0.511
Validation loss decreased (-0.502491 --> -0.509147).  Saving model ...
Epoch: 10 cost time: 456.2464864253998
Epoch: 10, Steps: 32 | Train Loss: 4.518 Vali Loss: 181.045 Vali Acc: 0.565 Test Loss: 181.045 Test Acc: 0.565
Validation loss decreased (-0.509147 --> -0.563075).  Saving model ...
Epoch: 11 cost time: 458.9131774902344
Epoch: 11, Steps: 32 | Train Loss: 2.795 Vali Loss: 350.963 Vali Acc: 0.511 Test Loss: 350.963 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 449.95208191871643
Epoch: 12, Steps: 32 | Train Loss: 6.999 Vali Loss: 257.351 Vali Acc: 0.489 Test Loss: 257.351 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 455.780419588089
Epoch: 13, Steps: 32 | Train Loss: 4.457 Vali Loss: 252.993 Vali Acc: 0.435 Test Loss: 252.993 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 457.8244397640228
Epoch: 14, Steps: 32 | Train Loss: 7.115 Vali Loss: 213.225 Vali Acc: 0.496 Test Loss: 213.225 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 457.60676288604736
Epoch: 15, Steps: 32 | Train Loss: 13.174 Vali Loss: 432.809 Vali Acc: 0.511 Test Loss: 432.809 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 451.183833360672
Epoch: 16, Steps: 32 | Train Loss: 14.957 Vali Loss: 307.541 Vali Acc: 0.519 Test Loss: 307.541 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 458.02863240242004
Epoch: 17, Steps: 32 | Train Loss: 16.701 Vali Loss: 492.077 Vali Acc: 0.511 Test Loss: 492.077 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 454.0958607196808
Epoch: 18, Steps: 32 | Train Loss: 7.052 Vali Loss: 334.600 Vali Acc: 0.458 Test Loss: 334.600 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 453.0996928215027
Epoch: 19, Steps: 32 | Train Loss: 10.630 Vali Loss: 345.432 Vali Acc: 0.412 Test Loss: 345.432 Test Acc: 0.412
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 449.8429343700409
Epoch: 20, Steps: 32 | Train Loss: 17.262 Vali Loss: 361.485 Vali Acc: 0.328 Test Loss: 361.485 Test Acc: 0.328
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df128_ma8992_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 25854725
model size : 133.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         7194                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df128_ma7194_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 286.21654987335205
Epoch: 1, Steps: 32 | Train Loss: 20.149 Vali Loss: 34.283 Vali Acc: 0.237 Test Loss: 34.283 Test Acc: 0.237
Validation loss decreased (inf --> -0.236298).  Saving model ...
Epoch: 2 cost time: 346.83414006233215
Epoch: 2, Steps: 32 | Train Loss: 20.694 Vali Loss: 91.756 Vali Acc: 0.160 Test Loss: 91.756 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 327.83758640289307
Epoch: 3, Steps: 32 | Train Loss: 14.108 Vali Loss: 92.824 Vali Acc: 0.214 Test Loss: 92.824 Test Acc: 0.214
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 336.1927824020386
Epoch: 4, Steps: 32 | Train Loss: 45.379 Vali Loss: 106.158 Vali Acc: 0.489 Test Loss: 106.158 Test Acc: 0.489
Validation loss decreased (-0.236298 --> -0.487488).  Saving model ...
Epoch: 5 cost time: 361.99219822883606
Epoch: 5, Steps: 32 | Train Loss: 7.328 Vali Loss: 88.677 Vali Acc: 0.565 Test Loss: 88.677 Test Acc: 0.565
Validation loss decreased (-0.487488 --> -0.563999).  Saving model ...
Epoch: 6 cost time: 362.72729659080505
Epoch: 6, Steps: 32 | Train Loss: 8.767 Vali Loss: 255.849 Vali Acc: 0.496 Test Loss: 255.849 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 359.83380579948425
Epoch: 7, Steps: 32 | Train Loss: 15.295 Vali Loss: 164.844 Vali Acc: 0.542 Test Loss: 164.844 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 366.0831813812256
Epoch: 8, Steps: 32 | Train Loss: 14.398 Vali Loss: 240.114 Vali Acc: 0.565 Test Loss: 240.114 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 360.7953929901123
Epoch: 9, Steps: 32 | Train Loss: 19.599 Vali Loss: 268.248 Vali Acc: 0.496 Test Loss: 268.248 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 356.7200975418091
Epoch: 10, Steps: 32 | Train Loss: 27.338 Vali Loss: 249.150 Vali Acc: 0.557 Test Loss: 249.150 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 363.4480547904968
Epoch: 11, Steps: 32 | Train Loss: 4.224 Vali Loss: 222.656 Vali Acc: 0.511 Test Loss: 222.656 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 366.0693416595459
Epoch: 12, Steps: 32 | Train Loss: 9.777 Vali Loss: 227.441 Vali Acc: 0.458 Test Loss: 227.441 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 365.75460481643677
Epoch: 13, Steps: 32 | Train Loss: 6.123 Vali Loss: 334.273 Vali Acc: 0.443 Test Loss: 334.273 Test Acc: 0.443
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 366.9608807563782
Epoch: 14, Steps: 32 | Train Loss: 8.246 Vali Loss: 408.495 Vali Acc: 0.504 Test Loss: 408.495 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 366.7034537792206
Epoch: 15, Steps: 32 | Train Loss: 9.785 Vali Loss: 314.854 Vali Acc: 0.527 Test Loss: 314.854 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df128_ma7194_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 25854725
model size : 133.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5396                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df128_ma5396_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 214.14522528648376
Epoch: 1, Steps: 32 | Train Loss: 24.052 Vali Loss: 48.597 Vali Acc: 0.237 Test Loss: 48.597 Test Acc: 0.237
Validation loss decreased (inf --> -0.236155).  Saving model ...
Epoch: 2 cost time: 262.45203018188477
Epoch: 2, Steps: 32 | Train Loss: 16.649 Vali Loss: 65.190 Vali Acc: 0.252 Test Loss: 65.190 Test Acc: 0.252
Validation loss decreased (-0.236155 --> -0.251257).  Saving model ...
Epoch: 3 cost time: 260.60612773895264
Epoch: 3, Steps: 32 | Train Loss: 21.202 Vali Loss: 121.020 Vali Acc: 0.176 Test Loss: 121.020 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 256.9068236351013
Epoch: 4, Steps: 32 | Train Loss: 26.513 Vali Loss: 138.579 Vali Acc: 0.527 Test Loss: 138.579 Test Acc: 0.527
Validation loss decreased (-0.251257 --> -0.525332).  Saving model ...
Epoch: 5 cost time: 276.24120140075684
Epoch: 5, Steps: 32 | Train Loss: 17.725 Vali Loss: 133.817 Vali Acc: 0.458 Test Loss: 133.817 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 276.24683904647827
Epoch: 6, Steps: 32 | Train Loss: 7.823 Vali Loss: 114.651 Vali Acc: 0.435 Test Loss: 114.651 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 274.9665949344635
Epoch: 7, Steps: 32 | Train Loss: 19.437 Vali Loss: 195.779 Vali Acc: 0.466 Test Loss: 195.779 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 273.4658896923065
Epoch: 8, Steps: 32 | Train Loss: 22.372 Vali Loss: 268.690 Vali Acc: 0.519 Test Loss: 268.690 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 274.657105922699
Epoch: 9, Steps: 32 | Train Loss: 12.209 Vali Loss: 210.510 Vali Acc: 0.282 Test Loss: 210.510 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 274.2844295501709
Epoch: 10, Steps: 32 | Train Loss: 14.616 Vali Loss: 224.417 Vali Acc: 0.336 Test Loss: 224.417 Test Acc: 0.336
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 278.22815561294556
Epoch: 11, Steps: 32 | Train Loss: 2.771 Vali Loss: 244.472 Vali Acc: 0.557 Test Loss: 244.472 Test Acc: 0.557
Validation loss decreased (-0.525332 --> -0.554807).  Saving model ...
Epoch: 12 cost time: 271.37738490104675
Epoch: 12, Steps: 32 | Train Loss: 15.451 Vali Loss: 243.961 Vali Acc: 0.435 Test Loss: 243.961 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 275.1737816333771
Epoch: 13, Steps: 32 | Train Loss: 13.922 Vali Loss: 428.878 Vali Acc: 0.527 Test Loss: 428.878 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 274.3649182319641
Epoch: 14, Steps: 32 | Train Loss: 14.991 Vali Loss: 302.366 Vali Acc: 0.389 Test Loss: 302.366 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 278.23861813545227
Epoch: 15, Steps: 32 | Train Loss: 6.540 Vali Loss: 353.950 Vali Acc: 0.580 Test Loss: 353.950 Test Acc: 0.580
Validation loss decreased (-0.554807 --> -0.576613).  Saving model ...
Epoch: 16 cost time: 280.4615249633789
Epoch: 16, Steps: 32 | Train Loss: 4.695 Vali Loss: 258.767 Vali Acc: 0.443 Test Loss: 258.767 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 278.99212670326233
Epoch: 17, Steps: 32 | Train Loss: 4.253 Vali Loss: 333.967 Vali Acc: 0.550 Test Loss: 333.967 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 282.421537399292
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 392.920 Vali Acc: 0.527 Test Loss: 392.920 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 280.1664083003998
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 396.553 Vali Acc: 0.519 Test Loss: 396.553 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 279.7624616622925
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 396.687 Vali Acc: 0.519 Test Loss: 396.687 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 279.922292470932
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 396.692 Vali Acc: 0.519 Test Loss: 396.692 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 280.4314503669739
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 396.692 Vali Acc: 0.519 Test Loss: 396.692 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 280.6649076938629
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 396.692 Vali Acc: 0.519 Test Loss: 396.692 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 280.8371624946594
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 396.692 Vali Acc: 0.519 Test Loss: 396.692 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 279.5780351161957
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 396.692 Vali Acc: 0.519 Test Loss: 396.692 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df128_ma5396_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 25854725
model size : 133.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3597                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df128_ma3597_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 148.16878032684326
Epoch: 1, Steps: 32 | Train Loss: 22.724 Vali Loss: 40.602 Vali Acc: 0.244 Test Loss: 40.602 Test Acc: 0.244
Validation loss decreased (inf --> -0.243869).  Saving model ...
Epoch: 2 cost time: 174.74672603607178
Epoch: 2, Steps: 32 | Train Loss: 33.629 Vali Loss: 116.814 Vali Acc: 0.260 Test Loss: 116.814 Test Acc: 0.260
Validation loss decreased (-0.243869 --> -0.258374).  Saving model ...
Epoch: 3 cost time: 182.3670072555542
Epoch: 3, Steps: 32 | Train Loss: 20.001 Vali Loss: 112.208 Vali Acc: 0.244 Test Loss: 112.208 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 184.3193802833557
Epoch: 4, Steps: 32 | Train Loss: 23.836 Vali Loss: 136.161 Vali Acc: 0.481 Test Loss: 136.161 Test Acc: 0.481
Validation loss decreased (-0.258374 --> -0.479554).  Saving model ...
Epoch: 5 cost time: 184.52288150787354
Epoch: 5, Steps: 32 | Train Loss: 10.868 Vali Loss: 122.813 Vali Acc: 0.504 Test Loss: 122.813 Test Acc: 0.504
Validation loss decreased (-0.479554 --> -0.502589).  Saving model ...
Epoch: 6 cost time: 187.29780173301697
Epoch: 6, Steps: 32 | Train Loss: 13.526 Vali Loss: 136.763 Vali Acc: 0.359 Test Loss: 136.763 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 187.99460411071777
Epoch: 7, Steps: 32 | Train Loss: 5.870 Vali Loss: 316.100 Vali Acc: 0.496 Test Loss: 316.100 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 188.01828789710999
Epoch: 8, Steps: 32 | Train Loss: 14.280 Vali Loss: 161.462 Vali Acc: 0.550 Test Loss: 161.462 Test Acc: 0.550
Validation loss decreased (-0.502589 --> -0.548004).  Saving model ...
Epoch: 9 cost time: 188.31088042259216
Epoch: 9, Steps: 32 | Train Loss: 3.035 Vali Loss: 207.908 Vali Acc: 0.466 Test Loss: 207.908 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 188.7501997947693
Epoch: 10, Steps: 32 | Train Loss: 9.949 Vali Loss: 297.098 Vali Acc: 0.527 Test Loss: 297.098 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 189.90212750434875
Epoch: 11, Steps: 32 | Train Loss: 8.113 Vali Loss: 146.797 Vali Acc: 0.473 Test Loss: 146.797 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 188.39149856567383
Epoch: 12, Steps: 32 | Train Loss: 7.597 Vali Loss: 267.072 Vali Acc: 0.550 Test Loss: 267.072 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 189.9753885269165
Epoch: 13, Steps: 32 | Train Loss: 18.103 Vali Loss: 404.951 Vali Acc: 0.519 Test Loss: 404.951 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 189.8872299194336
Epoch: 14, Steps: 32 | Train Loss: 17.717 Vali Loss: 284.511 Vali Acc: 0.344 Test Loss: 284.511 Test Acc: 0.344
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 190.81501841545105
Epoch: 15, Steps: 32 | Train Loss: 15.382 Vali Loss: 337.353 Vali Acc: 0.527 Test Loss: 337.353 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 193.0513551235199
Epoch: 16, Steps: 32 | Train Loss: 4.823 Vali Loss: 396.458 Vali Acc: 0.550 Test Loss: 396.458 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 190.07672595977783
Epoch: 17, Steps: 32 | Train Loss: 6.048 Vali Loss: 400.310 Vali Acc: 0.511 Test Loss: 400.310 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 190.3569679260254
Epoch: 18, Steps: 32 | Train Loss: 9.654 Vali Loss: 520.474 Vali Acc: 0.542 Test Loss: 520.474 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df128_ma3597_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 25854725
model size : 133.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1799                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df128_ma1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 73.1400318145752
Epoch: 1, Steps: 32 | Train Loss: 23.193 Vali Loss: 17.810 Vali Acc: 0.496 Test Loss: 17.810 Test Acc: 0.496
Validation loss decreased (inf --> -0.496005).  Saving model ...
Epoch: 2 cost time: 82.42726707458496
Epoch: 2, Steps: 32 | Train Loss: 17.855 Vali Loss: 71.362 Vali Acc: 0.267 Test Loss: 71.362 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 89.76169300079346
Epoch: 3, Steps: 32 | Train Loss: 15.078 Vali Loss: 52.505 Vali Acc: 0.313 Test Loss: 52.505 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 89.26681685447693
Epoch: 4, Steps: 32 | Train Loss: 48.018 Vali Loss: 183.349 Vali Acc: 0.496 Test Loss: 183.349 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 91.0338864326477
Epoch: 5, Steps: 32 | Train Loss: 39.008 Vali Loss: 133.387 Vali Acc: 0.550 Test Loss: 133.387 Test Acc: 0.550
Validation loss decreased (-0.496005 --> -0.548284).  Saving model ...
Epoch: 6 cost time: 93.96467065811157
Epoch: 6, Steps: 32 | Train Loss: 9.228 Vali Loss: 209.662 Vali Acc: 0.534 Test Loss: 209.662 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 93.31687426567078
Epoch: 7, Steps: 32 | Train Loss: 15.307 Vali Loss: 201.179 Vali Acc: 0.550 Test Loss: 201.179 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 94.60551881790161
Epoch: 8, Steps: 32 | Train Loss: 11.216 Vali Loss: 202.666 Vali Acc: 0.557 Test Loss: 202.666 Test Acc: 0.557
Validation loss decreased (-0.548284 --> -0.555225).  Saving model ...
Epoch: 9 cost time: 96.13793706893921
Epoch: 9, Steps: 32 | Train Loss: 4.505 Vali Loss: 199.290 Vali Acc: 0.534 Test Loss: 199.290 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 97.14791560173035
Epoch: 10, Steps: 32 | Train Loss: 0.978 Vali Loss: 262.860 Vali Acc: 0.519 Test Loss: 262.860 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 94.90705990791321
Epoch: 11, Steps: 32 | Train Loss: 6.457 Vali Loss: 244.962 Vali Acc: 0.458 Test Loss: 244.962 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 96.06840324401855
Epoch: 12, Steps: 32 | Train Loss: 9.651 Vali Loss: 311.379 Vali Acc: 0.511 Test Loss: 311.379 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 96.90656733512878
Epoch: 13, Steps: 32 | Train Loss: 5.021 Vali Loss: 387.990 Vali Acc: 0.550 Test Loss: 387.990 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 97.34565567970276
Epoch: 14, Steps: 32 | Train Loss: 3.736 Vali Loss: 249.615 Vali Acc: 0.481 Test Loss: 249.615 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 96.74445533752441
Epoch: 15, Steps: 32 | Train Loss: 4.548 Vali Loss: 248.779 Vali Acc: 0.534 Test Loss: 248.779 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 95.32234811782837
Epoch: 16, Steps: 32 | Train Loss: 4.738 Vali Loss: 393.876 Vali Acc: 0.511 Test Loss: 393.876 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 97.3747341632843
Epoch: 17, Steps: 32 | Train Loss: 1.429 Vali Loss: 330.283 Vali Acc: 0.481 Test Loss: 330.283 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 96.79849338531494
Epoch: 18, Steps: 32 | Train Loss: 4.284 Vali Loss: 233.356 Vali Acc: 0.496 Test Loss: 233.356 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df128_ma1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 25854725
model size : 133.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df128_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 43.28906178474426
Epoch: 1, Steps: 32 | Train Loss: 30.355 Vali Loss: 56.557 Vali Acc: 0.206 Test Loss: 56.557 Test Acc: 0.206
Validation loss decreased (inf --> -0.205541).  Saving model ...
Epoch: 2 cost time: 49.67831015586853
Epoch: 2, Steps: 32 | Train Loss: 50.382 Vali Loss: 60.337 Vali Acc: 0.313 Test Loss: 60.337 Test Acc: 0.313
Validation loss decreased (-0.205541 --> -0.312374).  Saving model ...
Epoch: 3 cost time: 53.05638790130615
Epoch: 3, Steps: 32 | Train Loss: 15.621 Vali Loss: 54.991 Vali Acc: 0.435 Test Loss: 54.991 Test Acc: 0.435
Validation loss decreased (-0.312374 --> -0.434565).  Saving model ...
Epoch: 4 cost time: 54.62304329872131
Epoch: 4, Steps: 32 | Train Loss: 10.417 Vali Loss: 131.741 Vali Acc: 0.511 Test Loss: 131.741 Test Acc: 0.511
Validation loss decreased (-0.434565 --> -0.510133).  Saving model ...
Epoch: 5 cost time: 53.84070181846619
Epoch: 5, Steps: 32 | Train Loss: 13.957 Vali Loss: 169.622 Vali Acc: 0.519 Test Loss: 169.622 Test Acc: 0.519
Validation loss decreased (-0.510133 --> -0.517388).  Saving model ...
Epoch: 6 cost time: 54.95193099975586
Epoch: 6, Steps: 32 | Train Loss: 18.866 Vali Loss: 152.260 Vali Acc: 0.305 Test Loss: 152.260 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 54.01668405532837
Epoch: 7, Steps: 32 | Train Loss: 12.579 Vali Loss: 217.296 Vali Acc: 0.519 Test Loss: 217.296 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 53.23789858818054
Epoch: 8, Steps: 32 | Train Loss: 19.352 Vali Loss: 245.589 Vali Acc: 0.504 Test Loss: 245.589 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 54.88167715072632
Epoch: 9, Steps: 32 | Train Loss: 17.280 Vali Loss: 143.685 Vali Acc: 0.427 Test Loss: 143.685 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 54.85870146751404
Epoch: 10, Steps: 32 | Train Loss: 12.336 Vali Loss: 216.676 Vali Acc: 0.489 Test Loss: 216.676 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 55.95983672142029
Epoch: 11, Steps: 32 | Train Loss: 5.573 Vali Loss: 366.965 Vali Acc: 0.519 Test Loss: 366.965 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 55.473607301712036
Epoch: 12, Steps: 32 | Train Loss: 14.280 Vali Loss: 255.778 Vali Acc: 0.504 Test Loss: 255.778 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 55.52079677581787
Epoch: 13, Steps: 32 | Train Loss: 4.119 Vali Loss: 255.718 Vali Acc: 0.298 Test Loss: 255.718 Test Acc: 0.298
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 55.5628662109375
Epoch: 14, Steps: 32 | Train Loss: 2.289 Vali Loss: 363.070 Vali Acc: 0.519 Test Loss: 363.070 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 55.47108268737793
Epoch: 15, Steps: 32 | Train Loss: 6.668 Vali Loss: 624.692 Vali Acc: 0.489 Test Loss: 624.692 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df128_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 25854725
model size : 133.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         540                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df128_ma540_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 32.95472073554993
Epoch: 1, Steps: 32 | Train Loss: 22.781 Vali Loss: 35.331 Vali Acc: 0.374 Test Loss: 35.331 Test Acc: 0.374
Validation loss decreased (inf --> -0.373692).  Saving model ...
Epoch: 2 cost time: 35.50906276702881
Epoch: 2, Steps: 32 | Train Loss: 49.919 Vali Loss: 86.173 Vali Acc: 0.466 Test Loss: 86.173 Test Acc: 0.466
Validation loss decreased (-0.373692 --> -0.464787).  Saving model ...
Epoch: 3 cost time: 37.45114040374756
Epoch: 3, Steps: 32 | Train Loss: 15.779 Vali Loss: 38.725 Vali Acc: 0.481 Test Loss: 38.725 Test Acc: 0.481
Validation loss decreased (-0.464787 --> -0.480529).  Saving model ...
Epoch: 4 cost time: 39.43347668647766
Epoch: 4, Steps: 32 | Train Loss: 11.233 Vali Loss: 66.050 Vali Acc: 0.397 Test Loss: 66.050 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 38.43937349319458
Epoch: 5, Steps: 32 | Train Loss: 17.660 Vali Loss: 110.301 Vali Acc: 0.519 Test Loss: 110.301 Test Acc: 0.519
Validation loss decreased (-0.480529 --> -0.517981).  Saving model ...
Epoch: 6 cost time: 38.07398581504822
Epoch: 6, Steps: 32 | Train Loss: 20.613 Vali Loss: 115.949 Vali Acc: 0.397 Test Loss: 115.949 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 38.98252248764038
Epoch: 7, Steps: 32 | Train Loss: 9.778 Vali Loss: 205.323 Vali Acc: 0.450 Test Loss: 205.323 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 38.626420736312866
Epoch: 8, Steps: 32 | Train Loss: 19.220 Vali Loss: 250.524 Vali Acc: 0.366 Test Loss: 250.524 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 39.00088286399841
Epoch: 9, Steps: 32 | Train Loss: 10.245 Vali Loss: 232.800 Vali Acc: 0.519 Test Loss: 232.800 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 39.03817391395569
Epoch: 10, Steps: 32 | Train Loss: 8.635 Vali Loss: 240.133 Vali Acc: 0.527 Test Loss: 240.133 Test Acc: 0.527
Validation loss decreased (-0.517981 --> -0.524316).  Saving model ...
Epoch: 11 cost time: 39.05620551109314
Epoch: 11, Steps: 32 | Train Loss: 2.725 Vali Loss: 311.088 Vali Acc: 0.466 Test Loss: 311.088 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 39.515135765075684
Epoch: 12, Steps: 32 | Train Loss: 1.510 Vali Loss: 303.500 Vali Acc: 0.511 Test Loss: 303.500 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 39.52529501914978
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 323.641 Vali Acc: 0.473 Test Loss: 323.641 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 39.6584312915802
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 324.505 Vali Acc: 0.473 Test Loss: 324.505 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 39.494332790374756
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 324.537 Vali Acc: 0.473 Test Loss: 324.537 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 39.665669679641724
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 324.538 Vali Acc: 0.473 Test Loss: 324.538 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 39.82657313346863
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 324.538 Vali Acc: 0.473 Test Loss: 324.538 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 39.72611117362976
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 324.538 Vali Acc: 0.473 Test Loss: 324.538 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 39.70199465751648
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 324.538 Vali Acc: 0.473 Test Loss: 324.538 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 39.60618758201599
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 324.538 Vali Acc: 0.473 Test Loss: 324.538 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df128_ma540_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 25854725
model size : 133.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df128_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 27.136120080947876
Epoch: 1, Steps: 32 | Train Loss: 23.785 Vali Loss: 23.784 Vali Acc: 0.458 Test Loss: 23.784 Test Acc: 0.458
Validation loss decreased (inf --> -0.457777).  Saving model ...
Epoch: 2 cost time: 28.457316637039185
Epoch: 2, Steps: 32 | Train Loss: 11.326 Vali Loss: 67.610 Vali Acc: 0.229 Test Loss: 67.610 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 30.264023542404175
Epoch: 3, Steps: 32 | Train Loss: 9.744 Vali Loss: 53.110 Vali Acc: 0.466 Test Loss: 53.110 Test Acc: 0.466
Validation loss decreased (-0.457777 --> -0.465118).  Saving model ...
Epoch: 4 cost time: 29.697603702545166
Epoch: 4, Steps: 32 | Train Loss: 16.416 Vali Loss: 108.607 Vali Acc: 0.511 Test Loss: 108.607 Test Acc: 0.511
Validation loss decreased (-0.465118 --> -0.510364).  Saving model ...
Epoch: 5 cost time: 30.45151424407959
Epoch: 5, Steps: 32 | Train Loss: 15.508 Vali Loss: 138.801 Vali Acc: 0.466 Test Loss: 138.801 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 30.575758457183838
Epoch: 6, Steps: 32 | Train Loss: 21.067 Vali Loss: 105.783 Vali Acc: 0.534 Test Loss: 105.783 Test Acc: 0.534
Validation loss decreased (-0.510364 --> -0.533293).  Saving model ...
Epoch: 7 cost time: 30.459518909454346
Epoch: 7, Steps: 32 | Train Loss: 22.340 Vali Loss: 144.358 Vali Acc: 0.565 Test Loss: 144.358 Test Acc: 0.565
Validation loss decreased (-0.533293 --> -0.563442).  Saving model ...
Epoch: 8 cost time: 30.736323595046997
Epoch: 8, Steps: 32 | Train Loss: 17.505 Vali Loss: 486.878 Vali Acc: 0.481 Test Loss: 486.878 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 30.796615600585938
Epoch: 9, Steps: 32 | Train Loss: 20.549 Vali Loss: 344.180 Vali Acc: 0.435 Test Loss: 344.180 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 31.187599658966064
Epoch: 10, Steps: 32 | Train Loss: 4.910 Vali Loss: 308.634 Vali Acc: 0.496 Test Loss: 308.634 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 31.101996421813965
Epoch: 11, Steps: 32 | Train Loss: 11.597 Vali Loss: 427.584 Vali Acc: 0.496 Test Loss: 427.584 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 31.444528102874756
Epoch: 12, Steps: 32 | Train Loss: 5.235 Vali Loss: 332.178 Vali Acc: 0.489 Test Loss: 332.178 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 31.15236520767212
Epoch: 13, Steps: 32 | Train Loss: 7.036 Vali Loss: 379.519 Vali Acc: 0.511 Test Loss: 379.519 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 31.155994176864624
Epoch: 14, Steps: 32 | Train Loss: 13.377 Vali Loss: 197.217 Vali Acc: 0.443 Test Loss: 197.217 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 31.56204390525818
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 277.434 Vali Acc: 0.374 Test Loss: 277.434 Test Acc: 0.374
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 31.30077052116394
Epoch: 16, Steps: 32 | Train Loss: 0.376 Vali Loss: 281.902 Vali Acc: 0.435 Test Loss: 281.902 Test Acc: 0.435
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 31.37956714630127
Epoch: 17, Steps: 32 | Train Loss: 1.833 Vali Loss: 405.878 Vali Acc: 0.481 Test Loss: 405.878 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df128_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 25854725
model size : 133.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df128_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 21.89127492904663
Epoch: 1, Steps: 32 | Train Loss: 18.916 Vali Loss: 20.853 Vali Acc: 0.267 Test Loss: 20.853 Test Acc: 0.267
Validation loss decreased (inf --> -0.266967).  Saving model ...
Epoch: 2 cost time: 21.598652601242065
Epoch: 2, Steps: 32 | Train Loss: 9.422 Vali Loss: 34.987 Vali Acc: 0.290 Test Loss: 34.987 Test Acc: 0.290
Validation loss decreased (-0.266967 --> -0.289726).  Saving model ...
Epoch: 3 cost time: 22.34877300262451
Epoch: 3, Steps: 32 | Train Loss: 12.133 Vali Loss: 89.511 Vali Acc: 0.267 Test Loss: 89.511 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 22.32841157913208
Epoch: 4, Steps: 32 | Train Loss: 26.332 Vali Loss: 84.277 Vali Acc: 0.557 Test Loss: 84.277 Test Acc: 0.557
Validation loss decreased (-0.289726 --> -0.556409).  Saving model ...
Epoch: 5 cost time: 22.685672521591187
Epoch: 5, Steps: 32 | Train Loss: 8.981 Vali Loss: 112.911 Vali Acc: 0.542 Test Loss: 112.911 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 23.085959911346436
Epoch: 6, Steps: 32 | Train Loss: 9.051 Vali Loss: 134.999 Vali Acc: 0.496 Test Loss: 134.999 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 23.215022802352905
Epoch: 7, Steps: 32 | Train Loss: 7.747 Vali Loss: 91.374 Vali Acc: 0.489 Test Loss: 91.374 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 22.97098708152771
Epoch: 8, Steps: 32 | Train Loss: 12.475 Vali Loss: 74.717 Vali Acc: 0.450 Test Loss: 74.717 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 23.046831607818604
Epoch: 9, Steps: 32 | Train Loss: 10.136 Vali Loss: 161.721 Vali Acc: 0.527 Test Loss: 161.721 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 23.220521688461304
Epoch: 10, Steps: 32 | Train Loss: 15.635 Vali Loss: 314.049 Vali Acc: 0.496 Test Loss: 314.049 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 22.950599670410156
Epoch: 11, Steps: 32 | Train Loss: 14.974 Vali Loss: 207.172 Vali Acc: 0.489 Test Loss: 207.172 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 23.05020833015442
Epoch: 12, Steps: 32 | Train Loss: 16.309 Vali Loss: 154.878 Vali Acc: 0.458 Test Loss: 154.878 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 23.136544466018677
Epoch: 13, Steps: 32 | Train Loss: 7.670 Vali Loss: 207.148 Vali Acc: 0.527 Test Loss: 207.148 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 23.24320387840271
Epoch: 14, Steps: 32 | Train Loss: 9.595 Vali Loss: 197.051 Vali Acc: 0.519 Test Loss: 197.051 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df128_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 25854725
model size : 133.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df128_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 19.2960205078125
Epoch: 1, Steps: 32 | Train Loss: 23.582 Vali Loss: 9.295 Vali Acc: 0.473 Test Loss: 9.295 Test Acc: 0.473
Validation loss decreased (inf --> -0.473189).  Saving model ...
Epoch: 2 cost time: 18.262676000595093
Epoch: 2, Steps: 32 | Train Loss: 27.176 Vali Loss: 75.380 Vali Acc: 0.275 Test Loss: 75.380 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 18.60729432106018
Epoch: 3, Steps: 32 | Train Loss: 26.357 Vali Loss: 28.888 Vali Acc: 0.420 Test Loss: 28.888 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 19.058858633041382
Epoch: 4, Steps: 32 | Train Loss: 10.268 Vali Loss: 51.045 Vali Acc: 0.389 Test Loss: 51.045 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 18.92666220664978
Epoch: 5, Steps: 32 | Train Loss: 8.012 Vali Loss: 87.646 Vali Acc: 0.473 Test Loss: 87.646 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 18.90828013420105
Epoch: 6, Steps: 32 | Train Loss: 19.084 Vali Loss: 59.815 Vali Acc: 0.450 Test Loss: 59.815 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 18.88845944404602
Epoch: 7, Steps: 32 | Train Loss: 22.960 Vali Loss: 180.572 Vali Acc: 0.359 Test Loss: 180.572 Test Acc: 0.359
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 18.904641151428223
Epoch: 8, Steps: 32 | Train Loss: 19.918 Vali Loss: 158.860 Vali Acc: 0.489 Test Loss: 158.860 Test Acc: 0.489
Validation loss decreased (-0.473189 --> -0.486961).  Saving model ...
Epoch: 9 cost time: 19.377176523208618
Epoch: 9, Steps: 32 | Train Loss: 6.194 Vali Loss: 84.207 Vali Acc: 0.550 Test Loss: 84.207 Test Acc: 0.550
Validation loss decreased (-0.486961 --> -0.548776).  Saving model ...
Epoch: 10 cost time: 19.24733257293701
Epoch: 10, Steps: 32 | Train Loss: 3.592 Vali Loss: 150.903 Vali Acc: 0.519 Test Loss: 150.903 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 19.37531876564026
Epoch: 11, Steps: 32 | Train Loss: 7.882 Vali Loss: 148.357 Vali Acc: 0.534 Test Loss: 148.357 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 19.37253212928772
Epoch: 12, Steps: 32 | Train Loss: 16.670 Vali Loss: 240.806 Vali Acc: 0.328 Test Loss: 240.806 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 18.948267698287964
Epoch: 13, Steps: 32 | Train Loss: 15.034 Vali Loss: 309.139 Vali Acc: 0.511 Test Loss: 309.139 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 19.369580268859863
Epoch: 14, Steps: 32 | Train Loss: 18.818 Vali Loss: 304.855 Vali Acc: 0.511 Test Loss: 304.855 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 19.066482305526733
Epoch: 15, Steps: 32 | Train Loss: 7.900 Vali Loss: 193.762 Vali Acc: 0.489 Test Loss: 193.762 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 19.03959584236145
Epoch: 16, Steps: 32 | Train Loss: 0.597 Vali Loss: 212.405 Vali Acc: 0.504 Test Loss: 212.405 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 19.31008005142212
Epoch: 17, Steps: 32 | Train Loss: 1.487 Vali Loss: 348.438 Vali Acc: 0.489 Test Loss: 348.438 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 19.055094957351685
Epoch: 18, Steps: 32 | Train Loss: 2.836 Vali Loss: 182.871 Vali Acc: 0.504 Test Loss: 182.871 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 19.34372091293335
Epoch: 19, Steps: 32 | Train Loss: 0.371 Vali Loss: 205.496 Vali Acc: 0.534 Test Loss: 205.496 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl1_df128_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 25854725
model size : 133.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         8992                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma8992_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 177.05097699165344
Epoch: 1, Steps: 32 | Train Loss: 11.192 Vali Loss: 14.620 Vali Acc: 0.321 Test Loss: 14.620 Test Acc: 0.321
Validation loss decreased (inf --> -0.320464).  Saving model ...
Epoch: 2 cost time: 198.55094575881958
Epoch: 2, Steps: 32 | Train Loss: 14.777 Vali Loss: 48.309 Vali Acc: 0.237 Test Loss: 48.309 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 219.45784831047058
Epoch: 3, Steps: 32 | Train Loss: 13.429 Vali Loss: 36.455 Vali Acc: 0.336 Test Loss: 36.455 Test Acc: 0.336
Validation loss decreased (-0.320464 --> -0.335513).  Saving model ...
Epoch: 4 cost time: 233.3909592628479
Epoch: 4, Steps: 32 | Train Loss: 10.348 Vali Loss: 55.774 Vali Acc: 0.427 Test Loss: 55.774 Test Acc: 0.427
Validation loss decreased (-0.335513 --> -0.426923).  Saving model ...
Epoch: 5 cost time: 228.23438954353333
Epoch: 5, Steps: 32 | Train Loss: 12.350 Vali Loss: 58.841 Vali Acc: 0.504 Test Loss: 58.841 Test Acc: 0.504
Validation loss decreased (-0.426923 --> -0.503228).  Saving model ...
Epoch: 6 cost time: 233.3964660167694
Epoch: 6, Steps: 32 | Train Loss: 2.280 Vali Loss: 81.966 Vali Acc: 0.489 Test Loss: 81.966 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 221.22254705429077
Epoch: 7, Steps: 32 | Train Loss: 27.505 Vali Loss: 69.563 Vali Acc: 0.443 Test Loss: 69.563 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 225.61020803451538
Epoch: 8, Steps: 32 | Train Loss: 8.455 Vali Loss: 98.295 Vali Acc: 0.527 Test Loss: 98.295 Test Acc: 0.527
Validation loss decreased (-0.503228 --> -0.525735).  Saving model ...
Epoch: 9 cost time: 233.4943926334381
Epoch: 9, Steps: 32 | Train Loss: 2.842 Vali Loss: 180.155 Vali Acc: 0.527 Test Loss: 180.155 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 229.89328718185425
Epoch: 10, Steps: 32 | Train Loss: 3.007 Vali Loss: 125.192 Vali Acc: 0.405 Test Loss: 125.192 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 227.43922972679138
Epoch: 11, Steps: 32 | Train Loss: 9.044 Vali Loss: 201.438 Vali Acc: 0.504 Test Loss: 201.438 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 224.87787318229675
Epoch: 12, Steps: 32 | Train Loss: 16.574 Vali Loss: 138.523 Vali Acc: 0.397 Test Loss: 138.523 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 231.23393750190735
Epoch: 13, Steps: 32 | Train Loss: 3.093 Vali Loss: 205.234 Vali Acc: 0.466 Test Loss: 205.234 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 233.360933303833
Epoch: 14, Steps: 32 | Train Loss: 1.762 Vali Loss: 247.797 Vali Acc: 0.504 Test Loss: 247.797 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 233.06605434417725
Epoch: 15, Steps: 32 | Train Loss: 1.153 Vali Loss: 236.185 Vali Acc: 0.542 Test Loss: 236.185 Test Acc: 0.542
Validation loss decreased (-0.525735 --> -0.539623).  Saving model ...
Epoch: 16 cost time: 231.49205946922302
Epoch: 16, Steps: 32 | Train Loss: 1.299 Vali Loss: 144.713 Vali Acc: 0.450 Test Loss: 144.713 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 233.61077785491943
Epoch: 17, Steps: 32 | Train Loss: 2.745 Vali Loss: 208.445 Vali Acc: 0.443 Test Loss: 208.445 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 233.6533772945404
Epoch: 18, Steps: 32 | Train Loss: 3.211 Vali Loss: 185.982 Vali Acc: 0.366 Test Loss: 185.982 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 230.52232217788696
Epoch: 19, Steps: 32 | Train Loss: 10.003 Vali Loss: 290.352 Vali Acc: 0.481 Test Loss: 290.352 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 228.147141456604
Epoch: 20, Steps: 32 | Train Loss: 11.384 Vali Loss: 375.529 Vali Acc: 0.519 Test Loss: 375.529 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 231.90703868865967
Epoch: 21, Steps: 32 | Train Loss: 8.102 Vali Loss: 218.741 Vali Acc: 0.511 Test Loss: 218.741 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 232.4337408542633
Epoch: 22, Steps: 32 | Train Loss: 3.417 Vali Loss: 230.413 Vali Acc: 0.405 Test Loss: 230.413 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 233.62845277786255
Epoch: 23, Steps: 32 | Train Loss: 3.919 Vali Loss: 250.927 Vali Acc: 0.420 Test Loss: 250.927 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 235.11827039718628
Epoch: 24, Steps: 32 | Train Loss: 2.199 Vali Loss: 223.977 Vali Acc: 0.458 Test Loss: 223.977 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 234.02054142951965
Epoch: 25, Steps: 32 | Train Loss: 10.073 Vali Loss: 214.686 Vali Acc: 0.573 Test Loss: 214.686 Test Acc: 0.573
Validation loss decreased (-0.539623 --> -0.570372).  Saving model ...
Epoch: 26 cost time: 234.73060369491577
Epoch: 26, Steps: 32 | Train Loss: 0.956 Vali Loss: 265.370 Vali Acc: 0.412 Test Loss: 265.370 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 231.8131377696991
Epoch: 27, Steps: 32 | Train Loss: 2.266 Vali Loss: 385.509 Vali Acc: 0.389 Test Loss: 385.509 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 232.366046667099
Epoch: 28, Steps: 32 | Train Loss: 4.598 Vali Loss: 313.415 Vali Acc: 0.473 Test Loss: 313.415 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 232.28584480285645
Epoch: 29, Steps: 32 | Train Loss: 1.846 Vali Loss: 493.347 Vali Acc: 0.504 Test Loss: 493.347 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 231.51360726356506
Epoch: 30, Steps: 32 | Train Loss: 4.113 Vali Loss: 506.952 Vali Acc: 0.550 Test Loss: 506.952 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 232.54126405715942
Epoch: 31, Steps: 32 | Train Loss: 1.291 Vali Loss: 354.709 Vali Acc: 0.366 Test Loss: 354.709 Test Acc: 0.366
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 233.28338885307312
Epoch: 32, Steps: 32 | Train Loss: 0.808 Vali Loss: 333.092 Vali Acc: 0.397 Test Loss: 333.092 Test Acc: 0.397
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 231.3859486579895
Epoch: 33, Steps: 32 | Train Loss: 4.084 Vali Loss: 633.726 Vali Acc: 0.519 Test Loss: 633.726 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 231.4064953327179
Epoch: 34, Steps: 32 | Train Loss: 7.122 Vali Loss: 290.555 Vali Acc: 0.397 Test Loss: 290.555 Test Acc: 0.397
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 230.83895182609558
Epoch: 35, Steps: 32 | Train Loss: 0.146 Vali Loss: 510.388 Vali Acc: 0.511 Test Loss: 510.388 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma8992_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 13746565
model size : 70.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         7194                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma7194_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 143.76996612548828
Epoch: 1, Steps: 32 | Train Loss: 11.237 Vali Loss: 21.641 Vali Acc: 0.435 Test Loss: 21.641 Test Acc: 0.435
Validation loss decreased (inf --> -0.434898).  Saving model ...
Epoch: 2 cost time: 155.7468249797821
Epoch: 2, Steps: 32 | Train Loss: 8.180 Vali Loss: 20.718 Vali Acc: 0.427 Test Loss: 20.718 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 168.52297234535217
Epoch: 3, Steps: 32 | Train Loss: 19.472 Vali Loss: 45.266 Vali Acc: 0.328 Test Loss: 45.266 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 176.83758187294006
Epoch: 4, Steps: 32 | Train Loss: 15.765 Vali Loss: 64.283 Vali Acc: 0.427 Test Loss: 64.283 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 183.32522439956665
Epoch: 5, Steps: 32 | Train Loss: 6.849 Vali Loss: 68.172 Vali Acc: 0.511 Test Loss: 68.172 Test Acc: 0.511
Validation loss decreased (-0.434898 --> -0.510769).  Saving model ...
Epoch: 6 cost time: 184.14186549186707
Epoch: 6, Steps: 32 | Train Loss: 7.642 Vali Loss: 95.389 Vali Acc: 0.565 Test Loss: 95.389 Test Acc: 0.565
Validation loss decreased (-0.510769 --> -0.563932).  Saving model ...
Epoch: 7 cost time: 190.23224353790283
Epoch: 7, Steps: 32 | Train Loss: 4.826 Vali Loss: 102.056 Vali Acc: 0.519 Test Loss: 102.056 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 188.23603224754333
Epoch: 8, Steps: 32 | Train Loss: 3.730 Vali Loss: 106.388 Vali Acc: 0.557 Test Loss: 106.388 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 187.0176432132721
Epoch: 9, Steps: 32 | Train Loss: 5.953 Vali Loss: 104.617 Vali Acc: 0.489 Test Loss: 104.617 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 188.40081334114075
Epoch: 10, Steps: 32 | Train Loss: 6.406 Vali Loss: 131.250 Vali Acc: 0.511 Test Loss: 131.250 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 189.41766333580017
Epoch: 11, Steps: 32 | Train Loss: 1.732 Vali Loss: 109.122 Vali Acc: 0.336 Test Loss: 109.122 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 187.59720826148987
Epoch: 12, Steps: 32 | Train Loss: 15.288 Vali Loss: 132.555 Vali Acc: 0.382 Test Loss: 132.555 Test Acc: 0.382
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 187.3223614692688
Epoch: 13, Steps: 32 | Train Loss: 7.949 Vali Loss: 160.846 Vali Acc: 0.489 Test Loss: 160.846 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 190.30984210968018
Epoch: 14, Steps: 32 | Train Loss: 1.891 Vali Loss: 171.835 Vali Acc: 0.374 Test Loss: 171.835 Test Acc: 0.374
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 188.81390762329102
Epoch: 15, Steps: 32 | Train Loss: 1.308 Vali Loss: 165.737 Vali Acc: 0.427 Test Loss: 165.737 Test Acc: 0.427
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 191.20891094207764
Epoch: 16, Steps: 32 | Train Loss: 0.608 Vali Loss: 215.396 Vali Acc: 0.435 Test Loss: 215.396 Test Acc: 0.435
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma7194_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 13746565
model size : 70.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5396                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma5396_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 99.48165106773376
Epoch: 1, Steps: 32 | Train Loss: 12.940 Vali Loss: 13.374 Vali Acc: 0.244 Test Loss: 13.374 Test Acc: 0.244
Validation loss decreased (inf --> -0.244141).  Saving model ...
Epoch: 2 cost time: 110.10565733909607
Epoch: 2, Steps: 32 | Train Loss: 7.653 Vali Loss: 43.319 Vali Acc: 0.275 Test Loss: 43.319 Test Acc: 0.275
Validation loss decreased (-0.244141 --> -0.274376).  Saving model ...
Epoch: 3 cost time: 126.4559760093689
Epoch: 3, Steps: 32 | Train Loss: 12.508 Vali Loss: 72.527 Vali Acc: 0.321 Test Loss: 72.527 Test Acc: 0.321
Validation loss decreased (-0.274376 --> -0.319885).  Saving model ...
Epoch: 4 cost time: 130.14926886558533
Epoch: 4, Steps: 32 | Train Loss: 15.632 Vali Loss: 112.962 Vali Acc: 0.237 Test Loss: 112.962 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 133.28436827659607
Epoch: 5, Steps: 32 | Train Loss: 12.349 Vali Loss: 72.591 Vali Acc: 0.542 Test Loss: 72.591 Test Acc: 0.542
Validation loss decreased (-0.319885 --> -0.541259).  Saving model ...
Epoch: 6 cost time: 135.8519880771637
Epoch: 6, Steps: 32 | Train Loss: 7.209 Vali Loss: 79.591 Vali Acc: 0.550 Test Loss: 79.591 Test Acc: 0.550
Validation loss decreased (-0.541259 --> -0.548822).  Saving model ...
Epoch: 7 cost time: 136.73064017295837
Epoch: 7, Steps: 32 | Train Loss: 2.656 Vali Loss: 139.630 Vali Acc: 0.298 Test Loss: 139.630 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 133.13996171951294
Epoch: 8, Steps: 32 | Train Loss: 7.323 Vali Loss: 72.087 Vali Acc: 0.397 Test Loss: 72.087 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 135.37625217437744
Epoch: 9, Steps: 32 | Train Loss: 0.766 Vali Loss: 86.867 Vali Acc: 0.443 Test Loss: 86.867 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 136.7112216949463
Epoch: 10, Steps: 32 | Train Loss: 2.963 Vali Loss: 91.423 Vali Acc: 0.550 Test Loss: 91.423 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 135.05480217933655
Epoch: 11, Steps: 32 | Train Loss: 1.700 Vali Loss: 115.661 Vali Acc: 0.450 Test Loss: 115.661 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 132.31543374061584
Epoch: 12, Steps: 32 | Train Loss: 12.106 Vali Loss: 269.957 Vali Acc: 0.290 Test Loss: 269.957 Test Acc: 0.290
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 135.6032383441925
Epoch: 13, Steps: 32 | Train Loss: 9.248 Vali Loss: 123.136 Vali Acc: 0.557 Test Loss: 123.136 Test Acc: 0.557
Validation loss decreased (-0.548822 --> -0.556021).  Saving model ...
Epoch: 14 cost time: 136.05483269691467
Epoch: 14, Steps: 32 | Train Loss: 1.979 Vali Loss: 129.575 Vali Acc: 0.389 Test Loss: 129.575 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 133.13457012176514
Epoch: 15, Steps: 32 | Train Loss: 6.393 Vali Loss: 239.331 Vali Acc: 0.321 Test Loss: 239.331 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 135.25617361068726
Epoch: 16, Steps: 32 | Train Loss: 10.431 Vali Loss: 257.035 Vali Acc: 0.489 Test Loss: 257.035 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 136.23134088516235
Epoch: 17, Steps: 32 | Train Loss: 7.555 Vali Loss: 156.239 Vali Acc: 0.435 Test Loss: 156.239 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 136.92861652374268
Epoch: 18, Steps: 32 | Train Loss: 2.553 Vali Loss: 179.323 Vali Acc: 0.412 Test Loss: 179.323 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 134.6780834197998
Epoch: 19, Steps: 32 | Train Loss: 4.298 Vali Loss: 236.431 Vali Acc: 0.366 Test Loss: 236.431 Test Acc: 0.366
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 135.2757089138031
Epoch: 20, Steps: 32 | Train Loss: 11.697 Vali Loss: 269.492 Vali Acc: 0.313 Test Loss: 269.492 Test Acc: 0.313
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 135.9738485813141
Epoch: 21, Steps: 32 | Train Loss: 6.348 Vali Loss: 259.403 Vali Acc: 0.405 Test Loss: 259.403 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 136.4418535232544
Epoch: 22, Steps: 32 | Train Loss: 1.282 Vali Loss: 186.467 Vali Acc: 0.458 Test Loss: 186.467 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 136.92349863052368
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 187.669 Vali Acc: 0.443 Test Loss: 187.669 Test Acc: 0.443
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma5396_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 13746565
model size : 70.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3597                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma3597_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 69.98647356033325
Epoch: 1, Steps: 32 | Train Loss: 13.681 Vali Loss: 24.275 Vali Acc: 0.160 Test Loss: 24.275 Test Acc: 0.160
Validation loss decreased (inf --> -0.160063).  Saving model ...
Epoch: 2 cost time: 77.39992380142212
Epoch: 2, Steps: 32 | Train Loss: 6.046 Vali Loss: 13.228 Vali Acc: 0.511 Test Loss: 13.228 Test Acc: 0.511
Validation loss decreased (-0.160063 --> -0.511318).  Saving model ...
Epoch: 3 cost time: 83.54324412345886
Epoch: 3, Steps: 32 | Train Loss: 7.891 Vali Loss: 41.618 Vali Acc: 0.489 Test Loss: 41.618 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 92.71108675003052
Epoch: 4, Steps: 32 | Train Loss: 7.466 Vali Loss: 50.405 Vali Acc: 0.351 Test Loss: 50.405 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 90.30933499336243
Epoch: 5, Steps: 32 | Train Loss: 8.980 Vali Loss: 61.522 Vali Acc: 0.427 Test Loss: 61.522 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 92.02388858795166
Epoch: 6, Steps: 32 | Train Loss: 7.906 Vali Loss: 114.236 Vali Acc: 0.489 Test Loss: 114.236 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 91.81470608711243
Epoch: 7, Steps: 32 | Train Loss: 17.268 Vali Loss: 70.536 Vali Acc: 0.412 Test Loss: 70.536 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 93.43085837364197
Epoch: 8, Steps: 32 | Train Loss: 4.278 Vali Loss: 104.994 Vali Acc: 0.527 Test Loss: 104.994 Test Acc: 0.527
Validation loss decreased (-0.511318 --> -0.525668).  Saving model ...
Epoch: 9 cost time: 91.98373746871948
Epoch: 9, Steps: 32 | Train Loss: 3.545 Vali Loss: 95.230 Vali Acc: 0.504 Test Loss: 95.230 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 95.44713711738586
Epoch: 10, Steps: 32 | Train Loss: 3.310 Vali Loss: 109.883 Vali Acc: 0.382 Test Loss: 109.883 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 92.87320613861084
Epoch: 11, Steps: 32 | Train Loss: 8.309 Vali Loss: 127.472 Vali Acc: 0.420 Test Loss: 127.472 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 94.38097620010376
Epoch: 12, Steps: 32 | Train Loss: 3.078 Vali Loss: 194.029 Vali Acc: 0.534 Test Loss: 194.029 Test Acc: 0.534
Validation loss decreased (-0.525668 --> -0.532411).  Saving model ...
Epoch: 13 cost time: 92.70981097221375
Epoch: 13, Steps: 32 | Train Loss: 3.053 Vali Loss: 260.463 Vali Acc: 0.534 Test Loss: 260.463 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 93.60866284370422
Epoch: 14, Steps: 32 | Train Loss: 11.715 Vali Loss: 150.275 Vali Acc: 0.496 Test Loss: 150.275 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 93.58157420158386
Epoch: 15, Steps: 32 | Train Loss: 7.205 Vali Loss: 163.697 Vali Acc: 0.443 Test Loss: 163.697 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 94.21522641181946
Epoch: 16, Steps: 32 | Train Loss: 5.168 Vali Loss: 142.396 Vali Acc: 0.534 Test Loss: 142.396 Test Acc: 0.534
Validation loss decreased (-0.532411 --> -0.532927).  Saving model ...
Epoch: 17 cost time: 95.214195728302
Epoch: 17, Steps: 32 | Train Loss: 5.039 Vali Loss: 149.196 Vali Acc: 0.397 Test Loss: 149.196 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 95.03606081008911
Epoch: 18, Steps: 32 | Train Loss: 0.975 Vali Loss: 241.640 Vali Acc: 0.366 Test Loss: 241.640 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 94.29447150230408
Epoch: 19, Steps: 32 | Train Loss: 3.343 Vali Loss: 149.048 Vali Acc: 0.473 Test Loss: 149.048 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 95.04312825202942
Epoch: 20, Steps: 32 | Train Loss: 1.592 Vali Loss: 269.115 Vali Acc: 0.244 Test Loss: 269.115 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 93.49502539634705
Epoch: 21, Steps: 32 | Train Loss: 3.134 Vali Loss: 217.468 Vali Acc: 0.366 Test Loss: 217.468 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 94.66975402832031
Epoch: 22, Steps: 32 | Train Loss: 4.163 Vali Loss: 153.259 Vali Acc: 0.466 Test Loss: 153.259 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 93.57471084594727
Epoch: 23, Steps: 32 | Train Loss: 7.614 Vali Loss: 215.890 Vali Acc: 0.489 Test Loss: 215.890 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 93.52993488311768
Epoch: 24, Steps: 32 | Train Loss: 8.277 Vali Loss: 254.853 Vali Acc: 0.298 Test Loss: 254.853 Test Acc: 0.298
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 93.60665369033813
Epoch: 25, Steps: 32 | Train Loss: 8.552 Vali Loss: 352.767 Vali Acc: 0.275 Test Loss: 352.767 Test Acc: 0.275
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 93.64739441871643
Epoch: 26, Steps: 32 | Train Loss: 0.663 Vali Loss: 221.308 Vali Acc: 0.481 Test Loss: 221.308 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma3597_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 13746565
model size : 70.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1799                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 41.252750873565674
Epoch: 1, Steps: 32 | Train Loss: 10.762 Vali Loss: 22.355 Vali Acc: 0.168 Test Loss: 22.355 Test Acc: 0.168
Validation loss decreased (inf --> -0.167715).  Saving model ...
Epoch: 2 cost time: 43.752105474472046
Epoch: 2, Steps: 32 | Train Loss: 6.525 Vali Loss: 15.374 Vali Acc: 0.496 Test Loss: 15.374 Test Acc: 0.496
Validation loss decreased (-0.167715 --> -0.496029).  Saving model ...
Epoch: 3 cost time: 49.61396837234497
Epoch: 3, Steps: 32 | Train Loss: 6.369 Vali Loss: 24.325 Vali Acc: 0.412 Test Loss: 24.325 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 51.06102013587952
Epoch: 4, Steps: 32 | Train Loss: 10.242 Vali Loss: 60.933 Vali Acc: 0.450 Test Loss: 60.933 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 51.63350963592529
Epoch: 5, Steps: 32 | Train Loss: 17.447 Vali Loss: 91.980 Vali Acc: 0.328 Test Loss: 91.980 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 51.90271043777466
Epoch: 6, Steps: 32 | Train Loss: 8.150 Vali Loss: 116.548 Vali Acc: 0.504 Test Loss: 116.548 Test Acc: 0.504
Validation loss decreased (-0.496029 --> -0.502651).  Saving model ...
Epoch: 7 cost time: 52.27376389503479
Epoch: 7, Steps: 32 | Train Loss: 6.893 Vali Loss: 113.243 Vali Acc: 0.550 Test Loss: 113.243 Test Acc: 0.550
Validation loss decreased (-0.502651 --> -0.548486).  Saving model ...
Epoch: 8 cost time: 54.031291246414185
Epoch: 8, Steps: 32 | Train Loss: 2.187 Vali Loss: 164.359 Vali Acc: 0.527 Test Loss: 164.359 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 53.43903088569641
Epoch: 9, Steps: 32 | Train Loss: 0.459 Vali Loss: 109.150 Vali Acc: 0.511 Test Loss: 109.150 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 53.63456416130066
Epoch: 10, Steps: 32 | Train Loss: 3.941 Vali Loss: 107.934 Vali Acc: 0.550 Test Loss: 107.934 Test Acc: 0.550
Validation loss decreased (-0.548486 --> -0.548539).  Saving model ...
Epoch: 11 cost time: 53.32769203186035
Epoch: 11, Steps: 32 | Train Loss: 5.981 Vali Loss: 93.322 Vali Acc: 0.511 Test Loss: 93.322 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 53.41425156593323
Epoch: 12, Steps: 32 | Train Loss: 0.305 Vali Loss: 175.082 Vali Acc: 0.519 Test Loss: 175.082 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 53.030715227127075
Epoch: 13, Steps: 32 | Train Loss: 5.946 Vali Loss: 113.303 Vali Acc: 0.458 Test Loss: 113.303 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 53.078994274139404
Epoch: 14, Steps: 32 | Train Loss: 3.016 Vali Loss: 132.300 Vali Acc: 0.466 Test Loss: 132.300 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 52.61893939971924
Epoch: 15, Steps: 32 | Train Loss: 11.646 Vali Loss: 148.730 Vali Acc: 0.504 Test Loss: 148.730 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 52.386658906936646
Epoch: 16, Steps: 32 | Train Loss: 9.645 Vali Loss: 144.256 Vali Acc: 0.466 Test Loss: 144.256 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 53.37927293777466
Epoch: 17, Steps: 32 | Train Loss: 5.459 Vali Loss: 207.141 Vali Acc: 0.496 Test Loss: 207.141 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 52.26810431480408
Epoch: 18, Steps: 32 | Train Loss: 10.865 Vali Loss: 155.313 Vali Acc: 0.458 Test Loss: 155.313 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 53.69724082946777
Epoch: 19, Steps: 32 | Train Loss: 0.796 Vali Loss: 246.556 Vali Acc: 0.206 Test Loss: 246.556 Test Acc: 0.206
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 52.632628202438354
Epoch: 20, Steps: 32 | Train Loss: 32.347 Vali Loss: 239.771 Vali Acc: 0.496 Test Loss: 239.771 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 13746565
model size : 70.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 27.467179775238037
Epoch: 1, Steps: 32 | Train Loss: 13.481 Vali Loss: 8.748 Vali Acc: 0.450 Test Loss: 8.748 Test Acc: 0.450
Validation loss decreased (inf --> -0.450294).  Saving model ...
Epoch: 2 cost time: 27.929885864257812
Epoch: 2, Steps: 32 | Train Loss: 5.293 Vali Loss: 15.646 Vali Acc: 0.489 Test Loss: 15.646 Test Acc: 0.489
Validation loss decreased (-0.450294 --> -0.488393).  Saving model ...
Epoch: 3 cost time: 31.4223051071167
Epoch: 3, Steps: 32 | Train Loss: 9.781 Vali Loss: 49.282 Vali Acc: 0.466 Test Loss: 49.282 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 32.234631061553955
Epoch: 4, Steps: 32 | Train Loss: 11.297 Vali Loss: 77.395 Vali Acc: 0.382 Test Loss: 77.395 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 32.773547887802124
Epoch: 5, Steps: 32 | Train Loss: 11.339 Vali Loss: 64.416 Vali Acc: 0.450 Test Loss: 64.416 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 31.724507808685303
Epoch: 6, Steps: 32 | Train Loss: 11.677 Vali Loss: 113.408 Vali Acc: 0.466 Test Loss: 113.408 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 32.455925703048706
Epoch: 7, Steps: 32 | Train Loss: 10.297 Vali Loss: 154.595 Vali Acc: 0.405 Test Loss: 154.595 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 32.579774379730225
Epoch: 8, Steps: 32 | Train Loss: 5.969 Vali Loss: 114.056 Vali Acc: 0.565 Test Loss: 114.056 Test Acc: 0.565
Validation loss decreased (-0.488393 --> -0.563745).  Saving model ...
Epoch: 9 cost time: 33.048903942108154
Epoch: 9, Steps: 32 | Train Loss: 1.417 Vali Loss: 168.880 Vali Acc: 0.496 Test Loss: 168.880 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 32.531723499298096
Epoch: 10, Steps: 32 | Train Loss: 7.358 Vali Loss: 176.776 Vali Acc: 0.534 Test Loss: 176.776 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 32.39579105377197
Epoch: 11, Steps: 32 | Train Loss: 8.580 Vali Loss: 209.927 Vali Acc: 0.504 Test Loss: 209.927 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 33.12552523612976
Epoch: 12, Steps: 32 | Train Loss: 1.321 Vali Loss: 136.261 Vali Acc: 0.466 Test Loss: 136.261 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 32.90600061416626
Epoch: 13, Steps: 32 | Train Loss: 4.322 Vali Loss: 136.505 Vali Acc: 0.427 Test Loss: 136.505 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 32.44524645805359
Epoch: 14, Steps: 32 | Train Loss: 2.769 Vali Loss: 170.642 Vali Acc: 0.290 Test Loss: 170.642 Test Acc: 0.290
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 32.80271124839783
Epoch: 15, Steps: 32 | Train Loss: 3.766 Vali Loss: 152.311 Vali Acc: 0.366 Test Loss: 152.311 Test Acc: 0.366
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 32.561452865600586
Epoch: 16, Steps: 32 | Train Loss: 10.432 Vali Loss: 273.334 Vali Acc: 0.527 Test Loss: 273.334 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 32.6909818649292
Epoch: 17, Steps: 32 | Train Loss: 3.146 Vali Loss: 228.349 Vali Acc: 0.511 Test Loss: 228.349 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 32.96720337867737
Epoch: 18, Steps: 32 | Train Loss: 8.324 Vali Loss: 144.958 Vali Acc: 0.450 Test Loss: 144.958 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 13746565
model size : 70.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         540                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma540_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 21.961875438690186
Epoch: 1, Steps: 32 | Train Loss: 10.047 Vali Loss: 15.010 Vali Acc: 0.267 Test Loss: 15.010 Test Acc: 0.267
Validation loss decreased (inf --> -0.267025).  Saving model ...
Epoch: 2 cost time: 22.336120128631592
Epoch: 2, Steps: 32 | Train Loss: 4.314 Vali Loss: 27.304 Vali Acc: 0.336 Test Loss: 27.304 Test Acc: 0.336
Validation loss decreased (-0.267025 --> -0.335605).  Saving model ...
Epoch: 3 cost time: 23.622808933258057
Epoch: 3, Steps: 32 | Train Loss: 13.071 Vali Loss: 49.728 Vali Acc: 0.427 Test Loss: 49.728 Test Acc: 0.427
Validation loss decreased (-0.335605 --> -0.426984).  Saving model ...
Epoch: 4 cost time: 24.13677215576172
Epoch: 4, Steps: 32 | Train Loss: 23.189 Vali Loss: 120.374 Vali Acc: 0.290 Test Loss: 120.374 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 24.47191548347473
Epoch: 5, Steps: 32 | Train Loss: 20.623 Vali Loss: 100.062 Vali Acc: 0.489 Test Loss: 100.062 Test Acc: 0.489
Validation loss decreased (-0.426984 --> -0.487549).  Saving model ...
Epoch: 6 cost time: 24.726460456848145
Epoch: 6, Steps: 32 | Train Loss: 8.313 Vali Loss: 97.209 Vali Acc: 0.321 Test Loss: 97.209 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 24.621259450912476
Epoch: 7, Steps: 32 | Train Loss: 8.040 Vali Loss: 124.922 Vali Acc: 0.374 Test Loss: 124.922 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 24.69898557662964
Epoch: 8, Steps: 32 | Train Loss: 2.407 Vali Loss: 122.328 Vali Acc: 0.389 Test Loss: 122.328 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 24.383814811706543
Epoch: 9, Steps: 32 | Train Loss: 4.938 Vali Loss: 113.912 Vali Acc: 0.481 Test Loss: 113.912 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 24.656701803207397
Epoch: 10, Steps: 32 | Train Loss: 4.912 Vali Loss: 146.666 Vali Acc: 0.435 Test Loss: 146.666 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 24.696797370910645
Epoch: 11, Steps: 32 | Train Loss: 1.117 Vali Loss: 130.836 Vali Acc: 0.405 Test Loss: 130.836 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 24.75155997276306
Epoch: 12, Steps: 32 | Train Loss: 3.578 Vali Loss: 154.158 Vali Acc: 0.344 Test Loss: 154.158 Test Acc: 0.344
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 24.516485452651978
Epoch: 13, Steps: 32 | Train Loss: 13.097 Vali Loss: 163.560 Vali Acc: 0.496 Test Loss: 163.560 Test Acc: 0.496
Validation loss decreased (-0.487549 --> -0.494548).  Saving model ...
Epoch: 14 cost time: 24.991347789764404
Epoch: 14, Steps: 32 | Train Loss: 6.223 Vali Loss: 189.465 Vali Acc: 0.450 Test Loss: 189.465 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 24.58476161956787
Epoch: 15, Steps: 32 | Train Loss: 3.546 Vali Loss: 185.079 Vali Acc: 0.412 Test Loss: 185.079 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 24.688355445861816
Epoch: 16, Steps: 32 | Train Loss: 1.052 Vali Loss: 176.681 Vali Acc: 0.458 Test Loss: 176.681 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 24.58928394317627
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 178.856 Vali Acc: 0.489 Test Loss: 178.856 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 25.043224811553955
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 179.050 Vali Acc: 0.489 Test Loss: 179.050 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 24.928919076919556
Epoch: 19, Steps: 32 | Train Loss: 0.440 Vali Loss: 177.707 Vali Acc: 0.450 Test Loss: 177.707 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 24.94386315345764
Epoch: 20, Steps: 32 | Train Loss: 2.099 Vali Loss: 179.819 Vali Acc: 0.427 Test Loss: 179.819 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 24.65535807609558
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 181.876 Vali Acc: 0.427 Test Loss: 181.876 Test Acc: 0.427
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 24.82013511657715
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 181.955 Vali Acc: 0.427 Test Loss: 181.955 Test Acc: 0.427
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 24.641196727752686
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 181.958 Vali Acc: 0.427 Test Loss: 181.958 Test Acc: 0.427
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma540_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4961832061068702
model parameter : 13746565
model size : 70.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 19.378938674926758
Epoch: 1, Steps: 32 | Train Loss: 15.613 Vali Loss: 13.853 Vali Acc: 0.473 Test Loss: 13.853 Test Acc: 0.473
Validation loss decreased (inf --> -0.473144).  Saving model ...
Epoch: 2 cost time: 18.535293579101562
Epoch: 2, Steps: 32 | Train Loss: 7.222 Vali Loss: 22.270 Vali Acc: 0.443 Test Loss: 22.270 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 19.85756540298462
Epoch: 3, Steps: 32 | Train Loss: 7.953 Vali Loss: 45.968 Vali Acc: 0.473 Test Loss: 45.968 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 20.18398356437683
Epoch: 4, Steps: 32 | Train Loss: 8.319 Vali Loss: 67.444 Vali Acc: 0.435 Test Loss: 67.444 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 20.334348440170288
Epoch: 5, Steps: 32 | Train Loss: 6.897 Vali Loss: 80.706 Vali Acc: 0.427 Test Loss: 80.706 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 20.230925798416138
Epoch: 6, Steps: 32 | Train Loss: 10.209 Vali Loss: 63.281 Vali Acc: 0.397 Test Loss: 63.281 Test Acc: 0.397
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 20.774747133255005
Epoch: 7, Steps: 32 | Train Loss: 7.671 Vali Loss: 88.614 Vali Acc: 0.481 Test Loss: 88.614 Test Acc: 0.481
Validation loss decreased (-0.473144 --> -0.480030).  Saving model ...
Epoch: 8 cost time: 20.854023933410645
Epoch: 8, Steps: 32 | Train Loss: 1.800 Vali Loss: 128.459 Vali Acc: 0.489 Test Loss: 128.459 Test Acc: 0.489
Validation loss decreased (-0.480030 --> -0.487265).  Saving model ...
Epoch: 9 cost time: 20.65861201286316
Epoch: 9, Steps: 32 | Train Loss: 0.000 Vali Loss: 93.483 Vali Acc: 0.435 Test Loss: 93.483 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 20.392329931259155
Epoch: 10, Steps: 32 | Train Loss: 0.000 Vali Loss: 92.381 Vali Acc: 0.427 Test Loss: 92.381 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 20.676077365875244
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 92.343 Vali Acc: 0.427 Test Loss: 92.343 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 20.315457582473755
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 92.342 Vali Acc: 0.427 Test Loss: 92.342 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 20.74447727203369
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 92.342 Vali Acc: 0.427 Test Loss: 92.342 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 20.425180912017822
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 92.344 Vali Acc: 0.427 Test Loss: 92.344 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 20.735042095184326
Epoch: 15, Steps: 32 | Train Loss: 0.198 Vali Loss: 114.671 Vali Acc: 0.321 Test Loss: 114.671 Test Acc: 0.321
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 20.37282681465149
Epoch: 16, Steps: 32 | Train Loss: 11.059 Vali Loss: 207.449 Vali Acc: 0.443 Test Loss: 207.449 Test Acc: 0.443
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 20.2780864238739
Epoch: 17, Steps: 32 | Train Loss: 25.166 Vali Loss: 269.447 Vali Acc: 0.282 Test Loss: 269.447 Test Acc: 0.282
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 20.35302996635437
Epoch: 18, Steps: 32 | Train Loss: 45.859 Vali Loss: 139.272 Vali Acc: 0.458 Test Loss: 139.272 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 13746565
model size : 70.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 16.639500379562378
Epoch: 1, Steps: 32 | Train Loss: 12.038 Vali Loss: 15.093 Vali Acc: 0.489 Test Loss: 15.093 Test Acc: 0.489
Validation loss decreased (inf --> -0.488399).  Saving model ...
Epoch: 2 cost time: 15.525191068649292
Epoch: 2, Steps: 32 | Train Loss: 12.387 Vali Loss: 29.427 Vali Acc: 0.405 Test Loss: 29.427 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 16.018033742904663
Epoch: 3, Steps: 32 | Train Loss: 10.161 Vali Loss: 22.541 Vali Acc: 0.511 Test Loss: 22.541 Test Acc: 0.511
Validation loss decreased (-0.488399 --> -0.511225).  Saving model ...
Epoch: 4 cost time: 16.023560285568237
Epoch: 4, Steps: 32 | Train Loss: 7.947 Vali Loss: 39.484 Vali Acc: 0.496 Test Loss: 39.484 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 16.723036527633667
Epoch: 5, Steps: 32 | Train Loss: 2.001 Vali Loss: 67.015 Vali Acc: 0.359 Test Loss: 67.015 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 16.25565791130066
Epoch: 6, Steps: 32 | Train Loss: 6.843 Vali Loss: 56.124 Vali Acc: 0.519 Test Loss: 56.124 Test Acc: 0.519
Validation loss decreased (-0.511225 --> -0.518523).  Saving model ...
Epoch: 7 cost time: 16.713145971298218
Epoch: 7, Steps: 32 | Train Loss: 12.467 Vali Loss: 68.125 Vali Acc: 0.473 Test Loss: 68.125 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 16.27506995201111
Epoch: 8, Steps: 32 | Train Loss: 5.712 Vali Loss: 74.751 Vali Acc: 0.443 Test Loss: 74.751 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 17.02353549003601
Epoch: 9, Steps: 32 | Train Loss: 8.202 Vali Loss: 154.454 Vali Acc: 0.466 Test Loss: 154.454 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 16.31463885307312
Epoch: 10, Steps: 32 | Train Loss: 14.638 Vali Loss: 81.816 Vali Acc: 0.435 Test Loss: 81.816 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 16.551796674728394
Epoch: 11, Steps: 32 | Train Loss: 0.524 Vali Loss: 154.412 Vali Acc: 0.511 Test Loss: 154.412 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 16.7215576171875
Epoch: 12, Steps: 32 | Train Loss: 4.534 Vali Loss: 111.955 Vali Acc: 0.511 Test Loss: 111.955 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 16.555038452148438
Epoch: 13, Steps: 32 | Train Loss: 2.749 Vali Loss: 76.622 Vali Acc: 0.496 Test Loss: 76.622 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 16.919965028762817
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 123.876 Vali Acc: 0.458 Test Loss: 123.876 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 16.443875551223755
Epoch: 15, Steps: 32 | Train Loss: 1.356 Vali Loss: 113.051 Vali Acc: 0.420 Test Loss: 113.051 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 16.701489448547363
Epoch: 16, Steps: 32 | Train Loss: 2.423 Vali Loss: 135.075 Vali Acc: 0.382 Test Loss: 135.075 Test Acc: 0.382
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 13746565
model size : 70.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.980425596237183
Epoch: 1, Steps: 32 | Train Loss: 9.553 Vali Loss: 9.413 Vali Acc: 0.336 Test Loss: 9.413 Test Acc: 0.336
Validation loss decreased (inf --> -0.335784).  Saving model ...
Epoch: 2 cost time: 14.316906213760376
Epoch: 2, Steps: 32 | Train Loss: 9.183 Vali Loss: 19.020 Vali Acc: 0.473 Test Loss: 19.020 Test Acc: 0.473
Validation loss decreased (-0.335784 --> -0.473092).  Saving model ...
Epoch: 3 cost time: 14.185248851776123
Epoch: 3, Steps: 32 | Train Loss: 10.011 Vali Loss: 9.459 Vali Acc: 0.580 Test Loss: 9.459 Test Acc: 0.580
Validation loss decreased (-0.473092 --> -0.580058).  Saving model ...
Epoch: 4 cost time: 14.548231840133667
Epoch: 4, Steps: 32 | Train Loss: 10.424 Vali Loss: 25.831 Vali Acc: 0.588 Test Loss: 25.831 Test Acc: 0.588
Validation loss decreased (-0.580058 --> -0.587528).  Saving model ...
Epoch: 5 cost time: 14.743676662445068
Epoch: 5, Steps: 32 | Train Loss: 5.979 Vali Loss: 44.810 Vali Acc: 0.557 Test Loss: 44.810 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 14.672306299209595
Epoch: 6, Steps: 32 | Train Loss: 4.253 Vali Loss: 27.184 Vali Acc: 0.573 Test Loss: 27.184 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 14.90303373336792
Epoch: 7, Steps: 32 | Train Loss: 5.854 Vali Loss: 52.724 Vali Acc: 0.473 Test Loss: 52.724 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 14.819006443023682
Epoch: 8, Steps: 32 | Train Loss: 4.940 Vali Loss: 56.333 Vali Acc: 0.550 Test Loss: 56.333 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 14.90123724937439
Epoch: 9, Steps: 32 | Train Loss: 13.376 Vali Loss: 63.455 Vali Acc: 0.435 Test Loss: 63.455 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 14.826253890991211
Epoch: 10, Steps: 32 | Train Loss: 3.466 Vali Loss: 78.477 Vali Acc: 0.397 Test Loss: 78.477 Test Acc: 0.397
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 14.884071826934814
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 63.915 Vali Acc: 0.489 Test Loss: 63.915 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 14.472662210464478
Epoch: 12, Steps: 32 | Train Loss: 2.490 Vali Loss: 120.452 Vali Acc: 0.519 Test Loss: 120.452 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 14.705526351928711
Epoch: 13, Steps: 32 | Train Loss: 0.689 Vali Loss: 70.162 Vali Acc: 0.443 Test Loss: 70.162 Test Acc: 0.443
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 14.328400611877441
Epoch: 14, Steps: 32 | Train Loss: 1.572 Vali Loss: 143.969 Vali Acc: 0.305 Test Loss: 143.969 Test Acc: 0.305
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df2048_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 13746565
model size : 70.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         8992                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma8992_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 176.73090815544128
Epoch: 1, Steps: 32 | Train Loss: 12.836 Vali Loss: 15.869 Vali Acc: 0.420 Test Loss: 15.869 Test Acc: 0.420
Validation loss decreased (inf --> -0.419689).  Saving model ...
Epoch: 2 cost time: 189.61187601089478
Epoch: 2, Steps: 32 | Train Loss: 17.348 Vali Loss: 17.674 Vali Acc: 0.550 Test Loss: 17.674 Test Acc: 0.550
Validation loss decreased (-0.419689 --> -0.549442).  Saving model ...
Epoch: 3 cost time: 214.4291272163391
Epoch: 3, Steps: 32 | Train Loss: 9.568 Vali Loss: 42.030 Vali Acc: 0.534 Test Loss: 42.030 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 220.36136984825134
Epoch: 4, Steps: 32 | Train Loss: 9.854 Vali Loss: 40.818 Vali Acc: 0.450 Test Loss: 40.818 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 224.50250124931335
Epoch: 5, Steps: 32 | Train Loss: 4.832 Vali Loss: 62.195 Vali Acc: 0.473 Test Loss: 62.195 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 221.04484796524048
Epoch: 6, Steps: 32 | Train Loss: 11.695 Vali Loss: 103.436 Vali Acc: 0.511 Test Loss: 103.436 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 223.46489191055298
Epoch: 7, Steps: 32 | Train Loss: 8.212 Vali Loss: 75.303 Vali Acc: 0.519 Test Loss: 75.303 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 226.54086065292358
Epoch: 8, Steps: 32 | Train Loss: 6.492 Vali Loss: 142.175 Vali Acc: 0.527 Test Loss: 142.175 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 223.84658336639404
Epoch: 9, Steps: 32 | Train Loss: 10.136 Vali Loss: 185.948 Vali Acc: 0.473 Test Loss: 185.948 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 221.41562938690186
Epoch: 10, Steps: 32 | Train Loss: 20.358 Vali Loss: 94.560 Vali Acc: 0.519 Test Loss: 94.560 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 226.98726511001587
Epoch: 11, Steps: 32 | Train Loss: 4.663 Vali Loss: 188.826 Vali Acc: 0.542 Test Loss: 188.826 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 228.4848930835724
Epoch: 12, Steps: 32 | Train Loss: 6.308 Vali Loss: 188.029 Vali Acc: 0.305 Test Loss: 188.029 Test Acc: 0.305
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma8992_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 12960133
model size : 67.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         7194                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma7194_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 141.89282703399658
Epoch: 1, Steps: 32 | Train Loss: 9.723 Vali Loss: 22.433 Vali Acc: 0.153 Test Loss: 22.433 Test Acc: 0.153
Validation loss decreased (inf --> -0.152447).  Saving model ...
Epoch: 2 cost time: 150.00521302223206
Epoch: 2, Steps: 32 | Train Loss: 10.312 Vali Loss: 28.344 Vali Acc: 0.328 Test Loss: 28.344 Test Acc: 0.328
Validation loss decreased (-0.152447 --> -0.327961).  Saving model ...
Epoch: 3 cost time: 170.1751720905304
Epoch: 3, Steps: 32 | Train Loss: 7.269 Vali Loss: 40.434 Vali Acc: 0.389 Test Loss: 40.434 Test Acc: 0.389
Validation loss decreased (-0.327961 --> -0.388909).  Saving model ...
Epoch: 4 cost time: 184.1472156047821
Epoch: 4, Steps: 32 | Train Loss: 7.211 Vali Loss: 50.158 Vali Acc: 0.557 Test Loss: 50.158 Test Acc: 0.557
Validation loss decreased (-0.388909 --> -0.556750).  Saving model ...
Epoch: 5 cost time: 175.72718811035156
Epoch: 5, Steps: 32 | Train Loss: 8.753 Vali Loss: 158.813 Vali Acc: 0.504 Test Loss: 158.813 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 179.5693483352661
Epoch: 6, Steps: 32 | Train Loss: 16.513 Vali Loss: 85.453 Vali Acc: 0.519 Test Loss: 85.453 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 182.13484477996826
Epoch: 7, Steps: 32 | Train Loss: 6.036 Vali Loss: 132.375 Vali Acc: 0.511 Test Loss: 132.375 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 181.10496020317078
Epoch: 8, Steps: 32 | Train Loss: 8.026 Vali Loss: 64.661 Vali Acc: 0.496 Test Loss: 64.661 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 185.22778367996216
Epoch: 9, Steps: 32 | Train Loss: 1.153 Vali Loss: 79.512 Vali Acc: 0.573 Test Loss: 79.512 Test Acc: 0.573
Validation loss decreased (-0.556750 --> -0.571724).  Saving model ...
Epoch: 10 cost time: 185.73069643974304
Epoch: 10, Steps: 32 | Train Loss: 1.733 Vali Loss: 78.000 Vali Acc: 0.450 Test Loss: 78.000 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 183.89042496681213
Epoch: 11, Steps: 32 | Train Loss: 0.702 Vali Loss: 81.052 Vali Acc: 0.450 Test Loss: 81.052 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 184.314297914505
Epoch: 12, Steps: 32 | Train Loss: 3.361 Vali Loss: 146.635 Vali Acc: 0.565 Test Loss: 146.635 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 183.67363166809082
Epoch: 13, Steps: 32 | Train Loss: 16.524 Vali Loss: 172.796 Vali Acc: 0.542 Test Loss: 172.796 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 183.60523414611816
Epoch: 14, Steps: 32 | Train Loss: 6.394 Vali Loss: 113.930 Vali Acc: 0.389 Test Loss: 113.930 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 182.01882338523865
Epoch: 15, Steps: 32 | Train Loss: 6.847 Vali Loss: 159.508 Vali Acc: 0.527 Test Loss: 159.508 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 187.4618353843689
Epoch: 16, Steps: 32 | Train Loss: 1.410 Vali Loss: 207.017 Vali Acc: 0.496 Test Loss: 207.017 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 185.90782570838928
Epoch: 17, Steps: 32 | Train Loss: 4.975 Vali Loss: 216.112 Vali Acc: 0.359 Test Loss: 216.112 Test Acc: 0.359
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 183.9264693260193
Epoch: 18, Steps: 32 | Train Loss: 4.493 Vali Loss: 237.914 Vali Acc: 0.420 Test Loss: 237.914 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 183.32573103904724
Epoch: 19, Steps: 32 | Train Loss: 20.234 Vali Loss: 273.987 Vali Acc: 0.229 Test Loss: 273.987 Test Acc: 0.229
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma7194_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 12960133
model size : 67.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5396                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma5396_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 95.56827735900879
Epoch: 1, Steps: 32 | Train Loss: 12.974 Vali Loss: 7.565 Vali Acc: 0.489 Test Loss: 7.565 Test Acc: 0.489
Validation loss decreased (inf --> -0.488474).  Saving model ...
Epoch: 2 cost time: 99.7475233078003
Epoch: 2, Steps: 32 | Train Loss: 4.872 Vali Loss: 31.323 Vali Acc: 0.435 Test Loss: 31.323 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 127.57132863998413
Epoch: 3, Steps: 32 | Train Loss: 7.719 Vali Loss: 60.581 Vali Acc: 0.420 Test Loss: 60.581 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 124.94287395477295
Epoch: 4, Steps: 32 | Train Loss: 21.116 Vali Loss: 72.490 Vali Acc: 0.282 Test Loss: 72.490 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 122.3628408908844
Epoch: 5, Steps: 32 | Train Loss: 19.803 Vali Loss: 70.723 Vali Acc: 0.542 Test Loss: 70.723 Test Acc: 0.542
Validation loss decreased (-0.488474 --> -0.541277).  Saving model ...
Epoch: 6 cost time: 129.784508228302
Epoch: 6, Steps: 32 | Train Loss: 9.590 Vali Loss: 70.367 Vali Acc: 0.481 Test Loss: 70.367 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 130.51495742797852
Epoch: 7, Steps: 32 | Train Loss: 0.797 Vali Loss: 89.514 Vali Acc: 0.473 Test Loss: 89.514 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 130.2399549484253
Epoch: 8, Steps: 32 | Train Loss: 2.250 Vali Loss: 79.813 Vali Acc: 0.466 Test Loss: 79.813 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 131.11446142196655
Epoch: 9, Steps: 32 | Train Loss: 1.969 Vali Loss: 92.155 Vali Acc: 0.450 Test Loss: 92.155 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 132.52141880989075
Epoch: 10, Steps: 32 | Train Loss: 5.189 Vali Loss: 88.654 Vali Acc: 0.466 Test Loss: 88.654 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 131.8910322189331
Epoch: 11, Steps: 32 | Train Loss: 3.442 Vali Loss: 85.709 Vali Acc: 0.527 Test Loss: 85.709 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 129.57457447052002
Epoch: 12, Steps: 32 | Train Loss: 4.496 Vali Loss: 127.417 Vali Acc: 0.504 Test Loss: 127.417 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 130.45936822891235
Epoch: 13, Steps: 32 | Train Loss: 5.378 Vali Loss: 157.736 Vali Acc: 0.420 Test Loss: 157.736 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 130.0143072605133
Epoch: 14, Steps: 32 | Train Loss: 7.024 Vali Loss: 200.155 Vali Acc: 0.511 Test Loss: 200.155 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 130.7460196018219
Epoch: 15, Steps: 32 | Train Loss: 9.437 Vali Loss: 165.296 Vali Acc: 0.359 Test Loss: 165.296 Test Acc: 0.359
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma5396_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 12960133
model size : 67.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3597                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma3597_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 67.81533455848694
Epoch: 1, Steps: 32 | Train Loss: 11.827 Vali Loss: 45.454 Vali Acc: 0.168 Test Loss: 45.454 Test Acc: 0.168
Validation loss decreased (inf --> -0.167484).  Saving model ...
Epoch: 2 cost time: 78.51110696792603
Epoch: 2, Steps: 32 | Train Loss: 29.144 Vali Loss: 42.018 Vali Acc: 0.206 Test Loss: 42.018 Test Acc: 0.206
Validation loss decreased (-0.167484 --> -0.205687).  Saving model ...
Epoch: 3 cost time: 84.93505430221558
Epoch: 3, Steps: 32 | Train Loss: 16.856 Vali Loss: 52.062 Vali Acc: 0.252 Test Loss: 52.062 Test Acc: 0.252
Validation loss decreased (-0.205687 --> -0.251388).  Saving model ...
Epoch: 4 cost time: 89.21292042732239
Epoch: 4, Steps: 32 | Train Loss: 10.958 Vali Loss: 51.831 Vali Acc: 0.542 Test Loss: 51.831 Test Acc: 0.542
Validation loss decreased (-0.251388 --> -0.541466).  Saving model ...
Epoch: 5 cost time: 93.21479606628418
Epoch: 5, Steps: 32 | Train Loss: 3.291 Vali Loss: 67.491 Vali Acc: 0.534 Test Loss: 67.491 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 93.54147839546204
Epoch: 6, Steps: 32 | Train Loss: 6.920 Vali Loss: 57.662 Vali Acc: 0.565 Test Loss: 57.662 Test Acc: 0.565
Validation loss decreased (-0.541466 --> -0.564309).  Saving model ...
Epoch: 7 cost time: 91.95053029060364
Epoch: 7, Steps: 32 | Train Loss: 3.319 Vali Loss: 81.481 Vali Acc: 0.580 Test Loss: 81.481 Test Acc: 0.580
Validation loss decreased (-0.564309 --> -0.579338).  Saving model ...
Epoch: 8 cost time: 93.87810444831848
Epoch: 8, Steps: 32 | Train Loss: 5.352 Vali Loss: 72.732 Vali Acc: 0.550 Test Loss: 72.732 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 94.00379514694214
Epoch: 9, Steps: 32 | Train Loss: 3.109 Vali Loss: 101.074 Vali Acc: 0.534 Test Loss: 101.074 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 93.7577908039093
Epoch: 10, Steps: 32 | Train Loss: 4.300 Vali Loss: 84.437 Vali Acc: 0.397 Test Loss: 84.437 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 91.84735488891602
Epoch: 11, Steps: 32 | Train Loss: 1.102 Vali Loss: 115.899 Vali Acc: 0.351 Test Loss: 115.899 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 92.17776536941528
Epoch: 12, Steps: 32 | Train Loss: 6.749 Vali Loss: 135.926 Vali Acc: 0.534 Test Loss: 135.926 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 92.24846005439758
Epoch: 13, Steps: 32 | Train Loss: 7.223 Vali Loss: 125.669 Vali Acc: 0.466 Test Loss: 125.669 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 92.9500994682312
Epoch: 14, Steps: 32 | Train Loss: 3.142 Vali Loss: 152.140 Vali Acc: 0.511 Test Loss: 152.140 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 91.29328799247742
Epoch: 15, Steps: 32 | Train Loss: 10.282 Vali Loss: 164.715 Vali Acc: 0.473 Test Loss: 164.715 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 91.56613898277283
Epoch: 16, Steps: 32 | Train Loss: 4.232 Vali Loss: 165.552 Vali Acc: 0.557 Test Loss: 165.552 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 91.56174540519714
Epoch: 17, Steps: 32 | Train Loss: 16.281 Vali Loss: 229.667 Vali Acc: 0.466 Test Loss: 229.667 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma3597_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 12960133
model size : 67.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1799                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 39.36549472808838
Epoch: 1, Steps: 32 | Train Loss: 10.761 Vali Loss: 9.630 Vali Acc: 0.397 Test Loss: 9.630 Test Acc: 0.397
Validation loss decreased (inf --> -0.396850).  Saving model ...
Epoch: 2 cost time: 43.94365835189819
Epoch: 2, Steps: 32 | Train Loss: 15.471 Vali Loss: 26.446 Vali Acc: 0.260 Test Loss: 26.446 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 52.13810420036316
Epoch: 3, Steps: 32 | Train Loss: 6.643 Vali Loss: 45.379 Vali Acc: 0.305 Test Loss: 45.379 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 50.523818492889404
Epoch: 4, Steps: 32 | Train Loss: 7.689 Vali Loss: 36.091 Vali Acc: 0.527 Test Loss: 36.091 Test Acc: 0.527
Validation loss decreased (-0.396850 --> -0.526357).  Saving model ...
Epoch: 5 cost time: 51.73943209648132
Epoch: 5, Steps: 32 | Train Loss: 3.861 Vali Loss: 68.388 Vali Acc: 0.496 Test Loss: 68.388 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 50.709152936935425
Epoch: 6, Steps: 32 | Train Loss: 8.240 Vali Loss: 77.884 Vali Acc: 0.542 Test Loss: 77.884 Test Acc: 0.542
Validation loss decreased (-0.526357 --> -0.541206).  Saving model ...
Epoch: 7 cost time: 50.295578479766846
Epoch: 7, Steps: 32 | Train Loss: 8.861 Vali Loss: 104.243 Vali Acc: 0.527 Test Loss: 104.243 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 49.95409798622131
Epoch: 8, Steps: 32 | Train Loss: 10.320 Vali Loss: 107.948 Vali Acc: 0.527 Test Loss: 107.948 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 51.351929903030396
Epoch: 9, Steps: 32 | Train Loss: 3.031 Vali Loss: 69.280 Vali Acc: 0.504 Test Loss: 69.280 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 50.76212430000305
Epoch: 10, Steps: 32 | Train Loss: 4.236 Vali Loss: 91.171 Vali Acc: 0.542 Test Loss: 91.171 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 51.66150403022766
Epoch: 11, Steps: 32 | Train Loss: 0.001 Vali Loss: 130.722 Vali Acc: 0.504 Test Loss: 130.722 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 51.835893630981445
Epoch: 12, Steps: 32 | Train Loss: 4.637 Vali Loss: 242.722 Vali Acc: 0.504 Test Loss: 242.722 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 51.868162870407104
Epoch: 13, Steps: 32 | Train Loss: 0.816 Vali Loss: 143.235 Vali Acc: 0.473 Test Loss: 143.235 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 50.954835176467896
Epoch: 14, Steps: 32 | Train Loss: 7.184 Vali Loss: 121.379 Vali Acc: 0.527 Test Loss: 121.379 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 51.94765043258667
Epoch: 15, Steps: 32 | Train Loss: 1.402 Vali Loss: 216.596 Vali Acc: 0.511 Test Loss: 216.596 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 50.6925253868103
Epoch: 16, Steps: 32 | Train Loss: 9.404 Vali Loss: 201.405 Vali Acc: 0.496 Test Loss: 201.405 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 12960133
model size : 67.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 25.52497625350952
Epoch: 1, Steps: 32 | Train Loss: 9.712 Vali Loss: 13.363 Vali Acc: 0.305 Test Loss: 13.363 Test Acc: 0.305
Validation loss decreased (inf --> -0.305210).  Saving model ...
Epoch: 2 cost time: 27.119673490524292
Epoch: 2, Steps: 32 | Train Loss: 13.413 Vali Loss: 21.613 Vali Acc: 0.244 Test Loss: 21.613 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 29.762691020965576
Epoch: 3, Steps: 32 | Train Loss: 5.096 Vali Loss: 22.517 Vali Acc: 0.519 Test Loss: 22.517 Test Acc: 0.519
Validation loss decreased (-0.305210 --> -0.518859).  Saving model ...
Epoch: 4 cost time: 30.244977951049805
Epoch: 4, Steps: 32 | Train Loss: 3.742 Vali Loss: 42.110 Vali Acc: 0.466 Test Loss: 42.110 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 30.371352910995483
Epoch: 5, Steps: 32 | Train Loss: 5.882 Vali Loss: 80.355 Vali Acc: 0.511 Test Loss: 80.355 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 30.890861749649048
Epoch: 6, Steps: 32 | Train Loss: 4.499 Vali Loss: 153.531 Vali Acc: 0.473 Test Loss: 153.531 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 30.370192289352417
Epoch: 7, Steps: 32 | Train Loss: 8.295 Vali Loss: 157.709 Vali Acc: 0.496 Test Loss: 157.709 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 30.865720510482788
Epoch: 8, Steps: 32 | Train Loss: 4.357 Vali Loss: 186.044 Vali Acc: 0.496 Test Loss: 186.044 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 31.943317413330078
Epoch: 9, Steps: 32 | Train Loss: 9.928 Vali Loss: 137.208 Vali Acc: 0.534 Test Loss: 137.208 Test Acc: 0.534
Validation loss decreased (-0.518859 --> -0.532979).  Saving model ...
Epoch: 10 cost time: 30.502152919769287
Epoch: 10, Steps: 32 | Train Loss: 8.130 Vali Loss: 88.361 Vali Acc: 0.504 Test Loss: 88.361 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 30.881913900375366
Epoch: 11, Steps: 32 | Train Loss: 3.223 Vali Loss: 178.993 Vali Acc: 0.496 Test Loss: 178.993 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 30.64689302444458
Epoch: 12, Steps: 32 | Train Loss: 4.853 Vali Loss: 156.534 Vali Acc: 0.450 Test Loss: 156.534 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 30.675793647766113
Epoch: 13, Steps: 32 | Train Loss: 2.365 Vali Loss: 240.060 Vali Acc: 0.542 Test Loss: 240.060 Test Acc: 0.542
Validation loss decreased (-0.532979 --> -0.539584).  Saving model ...
Epoch: 14 cost time: 30.54374408721924
Epoch: 14, Steps: 32 | Train Loss: 7.832 Vali Loss: 190.800 Vali Acc: 0.450 Test Loss: 190.800 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 30.589354753494263
Epoch: 15, Steps: 32 | Train Loss: 7.241 Vali Loss: 147.200 Vali Acc: 0.473 Test Loss: 147.200 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 31.10145664215088
Epoch: 16, Steps: 32 | Train Loss: 8.546 Vali Loss: 143.622 Vali Acc: 0.458 Test Loss: 143.622 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 31.04901909828186
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 169.967 Vali Acc: 0.519 Test Loss: 169.967 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 31.542980909347534
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 171.073 Vali Acc: 0.511 Test Loss: 171.073 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 30.997717142105103
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 171.114 Vali Acc: 0.511 Test Loss: 171.114 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 31.15650725364685
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 171.116 Vali Acc: 0.511 Test Loss: 171.116 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 31.189751625061035
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 171.116 Vali Acc: 0.511 Test Loss: 171.116 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 31.234115600585938
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 171.116 Vali Acc: 0.511 Test Loss: 171.116 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 31.002782821655273
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 171.116 Vali Acc: 0.511 Test Loss: 171.116 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 12960133
model size : 67.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         540                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma540_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 19.606809377670288
Epoch: 1, Steps: 32 | Train Loss: 7.060 Vali Loss: 31.994 Vali Acc: 0.237 Test Loss: 31.994 Test Acc: 0.237
Validation loss decreased (inf --> -0.236321).  Saving model ...
Epoch: 2 cost time: 19.800235986709595
Epoch: 2, Steps: 32 | Train Loss: 12.527 Vali Loss: 23.101 Vali Acc: 0.496 Test Loss: 23.101 Test Acc: 0.496
Validation loss decreased (-0.236321 --> -0.495952).  Saving model ...
Epoch: 3 cost time: 22.433109045028687
Epoch: 3, Steps: 32 | Train Loss: 5.089 Vali Loss: 33.228 Vali Acc: 0.405 Test Loss: 33.228 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 22.247370719909668
Epoch: 4, Steps: 32 | Train Loss: 5.131 Vali Loss: 47.414 Vali Acc: 0.336 Test Loss: 47.414 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 22.396411657333374
Epoch: 5, Steps: 32 | Train Loss: 17.817 Vali Loss: 88.841 Vali Acc: 0.489 Test Loss: 88.841 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 22.43700098991394
Epoch: 6, Steps: 32 | Train Loss: 15.850 Vali Loss: 118.347 Vali Acc: 0.382 Test Loss: 118.347 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 22.420825242996216
Epoch: 7, Steps: 32 | Train Loss: 9.345 Vali Loss: 161.277 Vali Acc: 0.466 Test Loss: 161.277 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 22.537588119506836
Epoch: 8, Steps: 32 | Train Loss: 6.073 Vali Loss: 146.743 Vali Acc: 0.450 Test Loss: 146.743 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 22.2703640460968
Epoch: 9, Steps: 32 | Train Loss: 13.550 Vali Loss: 138.823 Vali Acc: 0.511 Test Loss: 138.823 Test Acc: 0.511
Validation loss decreased (-0.495952 --> -0.510062).  Saving model ...
Epoch: 10 cost time: 22.692615270614624
Epoch: 10, Steps: 32 | Train Loss: 1.129 Vali Loss: 141.736 Vali Acc: 0.511 Test Loss: 141.736 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 22.747743368148804
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 139.853 Vali Acc: 0.504 Test Loss: 139.853 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 22.94592308998108
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 139.781 Vali Acc: 0.504 Test Loss: 139.781 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 22.752944707870483
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 139.778 Vali Acc: 0.504 Test Loss: 139.778 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 23.01221990585327
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 139.778 Vali Acc: 0.504 Test Loss: 139.778 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 22.98103094100952
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 139.778 Vali Acc: 0.504 Test Loss: 139.778 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 22.760152339935303
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 139.778 Vali Acc: 0.504 Test Loss: 139.778 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 22.960933208465576
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 139.778 Vali Acc: 0.504 Test Loss: 139.778 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 23.068198442459106
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 139.778 Vali Acc: 0.504 Test Loss: 139.778 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 23.089694023132324
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 139.778 Vali Acc: 0.504 Test Loss: 139.778 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma540_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 12960133
model size : 67.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 16.90115189552307
Epoch: 1, Steps: 32 | Train Loss: 13.961 Vali Loss: 13.478 Vali Acc: 0.282 Test Loss: 13.478 Test Acc: 0.282
Validation loss decreased (inf --> -0.282308).  Saving model ...
Epoch: 2 cost time: 16.649704456329346
Epoch: 2, Steps: 32 | Train Loss: 12.287 Vali Loss: 42.881 Vali Acc: 0.168 Test Loss: 42.881 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 18.256805658340454
Epoch: 3, Steps: 32 | Train Loss: 10.529 Vali Loss: 25.794 Vali Acc: 0.382 Test Loss: 25.794 Test Acc: 0.382
Validation loss decreased (-0.282308 --> -0.381421).  Saving model ...
Epoch: 4 cost time: 17.956876277923584
Epoch: 4, Steps: 32 | Train Loss: 9.765 Vali Loss: 51.184 Vali Acc: 0.458 Test Loss: 51.184 Test Acc: 0.458
Validation loss decreased (-0.381421 --> -0.457503).  Saving model ...
Epoch: 5 cost time: 18.10919213294983
Epoch: 5, Steps: 32 | Train Loss: 7.885 Vali Loss: 46.929 Vali Acc: 0.481 Test Loss: 46.929 Test Acc: 0.481
Validation loss decreased (-0.457503 --> -0.480447).  Saving model ...
Epoch: 6 cost time: 18.148733615875244
Epoch: 6, Steps: 32 | Train Loss: 7.282 Vali Loss: 71.307 Vali Acc: 0.504 Test Loss: 71.307 Test Acc: 0.504
Validation loss decreased (-0.480447 --> -0.503104).  Saving model ...
Epoch: 7 cost time: 18.452537059783936
Epoch: 7, Steps: 32 | Train Loss: 2.219 Vali Loss: 93.043 Vali Acc: 0.519 Test Loss: 93.043 Test Acc: 0.519
Validation loss decreased (-0.503104 --> -0.518154).  Saving model ...
Epoch: 8 cost time: 18.655427932739258
Epoch: 8, Steps: 32 | Train Loss: 2.148 Vali Loss: 148.705 Vali Acc: 0.481 Test Loss: 148.705 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 18.65926170349121
Epoch: 9, Steps: 32 | Train Loss: 3.478 Vali Loss: 78.774 Vali Acc: 0.443 Test Loss: 78.774 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 18.493991374969482
Epoch: 10, Steps: 32 | Train Loss: 4.977 Vali Loss: 85.815 Vali Acc: 0.466 Test Loss: 85.815 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 18.602511882781982
Epoch: 11, Steps: 32 | Train Loss: 2.286 Vali Loss: 114.334 Vali Acc: 0.519 Test Loss: 114.334 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 18.507426023483276
Epoch: 12, Steps: 32 | Train Loss: 2.819 Vali Loss: 172.073 Vali Acc: 0.496 Test Loss: 172.073 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 18.344980001449585
Epoch: 13, Steps: 32 | Train Loss: 4.216 Vali Loss: 87.467 Vali Acc: 0.450 Test Loss: 87.467 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 18.83969020843506
Epoch: 14, Steps: 32 | Train Loss: 0.672 Vali Loss: 85.081 Vali Acc: 0.458 Test Loss: 85.081 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 18.51807188987732
Epoch: 15, Steps: 32 | Train Loss: 5.112 Vali Loss: 177.925 Vali Acc: 0.473 Test Loss: 177.925 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 18.229926586151123
Epoch: 16, Steps: 32 | Train Loss: 15.423 Vali Loss: 191.711 Vali Acc: 0.481 Test Loss: 191.711 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 18.366207122802734
Epoch: 17, Steps: 32 | Train Loss: 11.105 Vali Loss: 301.899 Vali Acc: 0.458 Test Loss: 301.899 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 12960133
model size : 67.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.833264350891113
Epoch: 1, Steps: 32 | Train Loss: 8.316 Vali Loss: 22.524 Vali Acc: 0.260 Test Loss: 22.524 Test Acc: 0.260
Validation loss decreased (inf --> -0.259317).  Saving model ...
Epoch: 2 cost time: 13.473042249679565
Epoch: 2, Steps: 32 | Train Loss: 17.205 Vali Loss: 34.011 Vali Acc: 0.496 Test Loss: 34.011 Test Acc: 0.496
Validation loss decreased (-0.259317 --> -0.495843).  Saving model ...
Epoch: 3 cost time: 14.259613752365112
Epoch: 3, Steps: 32 | Train Loss: 12.674 Vali Loss: 43.020 Vali Acc: 0.511 Test Loss: 43.020 Test Acc: 0.511
Validation loss decreased (-0.495843 --> -0.511020).  Saving model ...
Epoch: 4 cost time: 14.224281787872314
Epoch: 4, Steps: 32 | Train Loss: 14.470 Vali Loss: 43.682 Vali Acc: 0.557 Test Loss: 43.682 Test Acc: 0.557
Validation loss decreased (-0.511020 --> -0.556815).  Saving model ...
Epoch: 5 cost time: 14.619978189468384
Epoch: 5, Steps: 32 | Train Loss: 6.188 Vali Loss: 67.944 Vali Acc: 0.450 Test Loss: 67.944 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 14.536222696304321
Epoch: 6, Steps: 32 | Train Loss: 4.381 Vali Loss: 90.247 Vali Acc: 0.481 Test Loss: 90.247 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 14.883457899093628
Epoch: 7, Steps: 32 | Train Loss: 9.373 Vali Loss: 116.200 Vali Acc: 0.511 Test Loss: 116.200 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 14.581389427185059
Epoch: 8, Steps: 32 | Train Loss: 3.977 Vali Loss: 59.831 Vali Acc: 0.435 Test Loss: 59.831 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 14.815442085266113
Epoch: 9, Steps: 32 | Train Loss: 2.679 Vali Loss: 55.617 Vali Acc: 0.496 Test Loss: 55.617 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 14.775663137435913
Epoch: 10, Steps: 32 | Train Loss: 1.203 Vali Loss: 47.642 Vali Acc: 0.504 Test Loss: 47.642 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 14.582822799682617
Epoch: 11, Steps: 32 | Train Loss: 1.864 Vali Loss: 114.085 Vali Acc: 0.405 Test Loss: 114.085 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 14.60032606124878
Epoch: 12, Steps: 32 | Train Loss: 4.670 Vali Loss: 88.924 Vali Acc: 0.542 Test Loss: 88.924 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 14.682824850082397
Epoch: 13, Steps: 32 | Train Loss: 3.074 Vali Loss: 68.127 Vali Acc: 0.527 Test Loss: 68.127 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 15.190167903900146
Epoch: 14, Steps: 32 | Train Loss: 0.045 Vali Loss: 117.838 Vali Acc: 0.504 Test Loss: 117.838 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 12960133
model size : 67.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.841722249984741
Epoch: 1, Steps: 32 | Train Loss: 6.355 Vali Loss: 29.201 Vali Acc: 0.198 Test Loss: 29.201 Test Acc: 0.198
Validation loss decreased (inf --> -0.198181).  Saving model ...
Epoch: 2 cost time: 12.751338005065918
Epoch: 2, Steps: 32 | Train Loss: 8.005 Vali Loss: 20.805 Vali Acc: 0.511 Test Loss: 20.805 Test Acc: 0.511
Validation loss decreased (-0.198181 --> -0.511242).  Saving model ...
Epoch: 3 cost time: 12.752161264419556
Epoch: 3, Steps: 32 | Train Loss: 7.947 Vali Loss: 27.763 Vali Acc: 0.427 Test Loss: 27.763 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.942168235778809
Epoch: 4, Steps: 32 | Train Loss: 5.825 Vali Loss: 55.923 Vali Acc: 0.511 Test Loss: 55.923 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 12.808387279510498
Epoch: 5, Steps: 32 | Train Loss: 9.953 Vali Loss: 90.100 Vali Acc: 0.389 Test Loss: 90.100 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 12.698702812194824
Epoch: 6, Steps: 32 | Train Loss: 26.412 Vali Loss: 136.883 Vali Acc: 0.489 Test Loss: 136.883 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 13.013735294342041
Epoch: 7, Steps: 32 | Train Loss: 19.922 Vali Loss: 74.549 Vali Acc: 0.534 Test Loss: 74.549 Test Acc: 0.534
Validation loss decreased (-0.511242 --> -0.533606).  Saving model ...
Epoch: 8 cost time: 12.795875549316406
Epoch: 8, Steps: 32 | Train Loss: 7.856 Vali Loss: 171.509 Vali Acc: 0.489 Test Loss: 171.509 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.915719747543335
Epoch: 9, Steps: 32 | Train Loss: 11.116 Vali Loss: 77.350 Vali Acc: 0.473 Test Loss: 77.350 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 13.051246166229248
Epoch: 10, Steps: 32 | Train Loss: 1.478 Vali Loss: 58.656 Vali Acc: 0.573 Test Loss: 58.656 Test Acc: 0.573
Validation loss decreased (-0.533606 --> -0.571933).  Saving model ...
Epoch: 11 cost time: 12.882349967956543
Epoch: 11, Steps: 32 | Train Loss: 0.338 Vali Loss: 102.287 Vali Acc: 0.542 Test Loss: 102.287 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 12.729105472564697
Epoch: 12, Steps: 32 | Train Loss: 0.025 Vali Loss: 69.018 Vali Acc: 0.504 Test Loss: 69.018 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 12.686368465423584
Epoch: 13, Steps: 32 | Train Loss: 1.229 Vali Loss: 66.202 Vali Acc: 0.489 Test Loss: 66.202 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 12.594187021255493
Epoch: 14, Steps: 32 | Train Loss: 0.367 Vali Loss: 160.555 Vali Acc: 0.534 Test Loss: 160.555 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 12.560781002044678
Epoch: 15, Steps: 32 | Train Loss: 3.892 Vali Loss: 92.120 Vali Acc: 0.504 Test Loss: 92.120 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 13.006576776504517
Epoch: 16, Steps: 32 | Train Loss: 0.574 Vali Loss: 75.745 Vali Acc: 0.481 Test Loss: 75.745 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 12.394894361495972
Epoch: 17, Steps: 32 | Train Loss: 1.772 Vali Loss: 86.311 Vali Acc: 0.504 Test Loss: 86.311 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 12.652235269546509
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 90.181 Vali Acc: 0.466 Test Loss: 90.181 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 13.057065725326538
Epoch: 19, Steps: 32 | Train Loss: 0.397 Vali Loss: 75.096 Vali Acc: 0.466 Test Loss: 75.096 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 12.87752628326416
Epoch: 20, Steps: 32 | Train Loss: 0.412 Vali Loss: 82.709 Vali Acc: 0.473 Test Loss: 82.709 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df1024_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 12960133
model size : 67.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         8992                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df512_ma8992_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 174.32049894332886
Epoch: 1, Steps: 32 | Train Loss: 8.883 Vali Loss: 33.193 Vali Acc: 0.382 Test Loss: 33.193 Test Acc: 0.382
Validation loss decreased (inf --> -0.381347).  Saving model ...
Epoch: 2 cost time: 183.9561059474945
Epoch: 2, Steps: 32 | Train Loss: 11.144 Vali Loss: 29.281 Vali Acc: 0.344 Test Loss: 29.281 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 206.87295579910278
Epoch: 3, Steps: 32 | Train Loss: 11.557 Vali Loss: 33.903 Vali Acc: 0.504 Test Loss: 33.903 Test Acc: 0.504
Validation loss decreased (-0.381347 --> -0.503478).  Saving model ...
Epoch: 4 cost time: 221.6934413909912
Epoch: 4, Steps: 32 | Train Loss: 8.114 Vali Loss: 56.189 Vali Acc: 0.496 Test Loss: 56.189 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 221.41638684272766
Epoch: 5, Steps: 32 | Train Loss: 2.630 Vali Loss: 55.407 Vali Acc: 0.275 Test Loss: 55.407 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 223.9211709499359
Epoch: 6, Steps: 32 | Train Loss: 5.854 Vali Loss: 108.881 Vali Acc: 0.344 Test Loss: 108.881 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 221.9504086971283
Epoch: 7, Steps: 32 | Train Loss: 8.097 Vali Loss: 71.871 Vali Acc: 0.466 Test Loss: 71.871 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 220.84146189689636
Epoch: 8, Steps: 32 | Train Loss: 8.265 Vali Loss: 72.040 Vali Acc: 0.427 Test Loss: 72.040 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 224.83892798423767
Epoch: 9, Steps: 32 | Train Loss: 4.723 Vali Loss: 161.562 Vali Acc: 0.305 Test Loss: 161.562 Test Acc: 0.305
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 223.27447652816772
Epoch: 10, Steps: 32 | Train Loss: 7.525 Vali Loss: 92.850 Vali Acc: 0.397 Test Loss: 92.850 Test Acc: 0.397
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 223.54803848266602
Epoch: 11, Steps: 32 | Train Loss: 9.815 Vali Loss: 216.110 Vali Acc: 0.473 Test Loss: 216.110 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 225.33787727355957
Epoch: 12, Steps: 32 | Train Loss: 7.613 Vali Loss: 115.000 Vali Acc: 0.489 Test Loss: 115.000 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 224.64670777320862
Epoch: 13, Steps: 32 | Train Loss: 10.915 Vali Loss: 203.028 Vali Acc: 0.473 Test Loss: 203.028 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df512_ma8992_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 12566917
model size : 65.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         7194                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df512_ma7194_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 140.56742215156555
Epoch: 1, Steps: 32 | Train Loss: 10.657 Vali Loss: 34.381 Vali Acc: 0.435 Test Loss: 34.381 Test Acc: 0.435
Validation loss decreased (inf --> -0.434771).  Saving model ...
Epoch: 2 cost time: 146.9839746952057
Epoch: 2, Steps: 32 | Train Loss: 6.816 Vali Loss: 34.325 Vali Acc: 0.191 Test Loss: 34.325 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 173.86081647872925
Epoch: 3, Steps: 32 | Train Loss: 7.739 Vali Loss: 38.743 Vali Acc: 0.328 Test Loss: 38.743 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 178.08474230766296
Epoch: 4, Steps: 32 | Train Loss: 16.038 Vali Loss: 36.060 Vali Acc: 0.519 Test Loss: 36.060 Test Acc: 0.519
Validation loss decreased (-0.434771 --> -0.518723).  Saving model ...
Epoch: 5 cost time: 177.52546286582947
Epoch: 5, Steps: 32 | Train Loss: 5.977 Vali Loss: 87.856 Vali Acc: 0.519 Test Loss: 87.856 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 180.81664657592773
Epoch: 6, Steps: 32 | Train Loss: 5.202 Vali Loss: 98.073 Vali Acc: 0.458 Test Loss: 98.073 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 175.62753558158875
Epoch: 7, Steps: 32 | Train Loss: 14.632 Vali Loss: 103.221 Vali Acc: 0.496 Test Loss: 103.221 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 180.7628562450409
Epoch: 8, Steps: 32 | Train Loss: 5.374 Vali Loss: 133.309 Vali Acc: 0.534 Test Loss: 133.309 Test Acc: 0.534
Validation loss decreased (-0.518723 --> -0.533018).  Saving model ...
Epoch: 9 cost time: 180.67089343070984
Epoch: 9, Steps: 32 | Train Loss: 2.925 Vali Loss: 117.766 Vali Acc: 0.527 Test Loss: 117.766 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 182.53971004486084
Epoch: 10, Steps: 32 | Train Loss: 1.645 Vali Loss: 112.902 Vali Acc: 0.519 Test Loss: 112.902 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 182.3757667541504
Epoch: 11, Steps: 32 | Train Loss: 2.678 Vali Loss: 153.151 Vali Acc: 0.511 Test Loss: 153.151 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 178.18761444091797
Epoch: 12, Steps: 32 | Train Loss: 13.870 Vali Loss: 95.049 Vali Acc: 0.580 Test Loss: 95.049 Test Acc: 0.580
Validation loss decreased (-0.533018 --> -0.579202).  Saving model ...
Epoch: 13 cost time: 179.26430988311768
Epoch: 13, Steps: 32 | Train Loss: 24.164 Vali Loss: 102.537 Vali Acc: 0.420 Test Loss: 102.537 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 183.2518494129181
Epoch: 14, Steps: 32 | Train Loss: 1.160 Vali Loss: 126.101 Vali Acc: 0.466 Test Loss: 126.101 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 182.68813753128052
Epoch: 15, Steps: 32 | Train Loss: 7.252 Vali Loss: 342.747 Vali Acc: 0.321 Test Loss: 342.747 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 182.11309838294983
Epoch: 16, Steps: 32 | Train Loss: 16.898 Vali Loss: 220.826 Vali Acc: 0.557 Test Loss: 220.826 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 181.73069858551025
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 166.165 Vali Acc: 0.542 Test Loss: 166.165 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 182.63800477981567
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 164.330 Vali Acc: 0.542 Test Loss: 164.330 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 184.83841681480408
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 164.154 Vali Acc: 0.542 Test Loss: 164.154 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 184.76232886314392
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 164.148 Vali Acc: 0.542 Test Loss: 164.148 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 185.94353008270264
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 164.147 Vali Acc: 0.542 Test Loss: 164.147 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 184.61124205589294
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 164.147 Vali Acc: 0.542 Test Loss: 164.147 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df512_ma7194_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 12566917
model size : 65.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5396                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df512_ma5396_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 94.30287504196167
Epoch: 1, Steps: 32 | Train Loss: 10.898 Vali Loss: 16.337 Vali Acc: 0.214 Test Loss: 16.337 Test Acc: 0.214
Validation loss decreased (inf --> -0.213577).  Saving model ...
Epoch: 2 cost time: 104.48235273361206
Epoch: 2, Steps: 32 | Train Loss: 11.335 Vali Loss: 17.553 Vali Acc: 0.290 Test Loss: 17.553 Test Acc: 0.290
Validation loss decreased (-0.213577 --> -0.289901).  Saving model ...
Epoch: 3 cost time: 126.97607898712158
Epoch: 3, Steps: 32 | Train Loss: 8.821 Vali Loss: 37.040 Vali Acc: 0.504 Test Loss: 37.040 Test Acc: 0.504
Validation loss decreased (-0.289901 --> -0.503446).  Saving model ...
Epoch: 4 cost time: 126.95058917999268
Epoch: 4, Steps: 32 | Train Loss: 9.039 Vali Loss: 69.232 Vali Acc: 0.481 Test Loss: 69.232 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 130.98276901245117
Epoch: 5, Steps: 32 | Train Loss: 5.972 Vali Loss: 64.623 Vali Acc: 0.527 Test Loss: 64.623 Test Acc: 0.527
Validation loss decreased (-0.503446 --> -0.526071).  Saving model ...
Epoch: 6 cost time: 130.4692940711975
Epoch: 6, Steps: 32 | Train Loss: 8.174 Vali Loss: 51.687 Vali Acc: 0.450 Test Loss: 51.687 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 129.70291256904602
Epoch: 7, Steps: 32 | Train Loss: 17.291 Vali Loss: 114.570 Vali Acc: 0.511 Test Loss: 114.570 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 131.41951441764832
Epoch: 8, Steps: 32 | Train Loss: 4.745 Vali Loss: 82.717 Vali Acc: 0.458 Test Loss: 82.717 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 129.813072681427
Epoch: 9, Steps: 32 | Train Loss: 2.748 Vali Loss: 106.396 Vali Acc: 0.534 Test Loss: 106.396 Test Acc: 0.534
Validation loss decreased (-0.526071 --> -0.533287).  Saving model ...
Epoch: 10 cost time: 129.9201078414917
Epoch: 10, Steps: 32 | Train Loss: 1.727 Vali Loss: 103.595 Vali Acc: 0.496 Test Loss: 103.595 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 127.98075985908508
Epoch: 11, Steps: 32 | Train Loss: 7.863 Vali Loss: 121.674 Vali Acc: 0.573 Test Loss: 121.674 Test Acc: 0.573
Validation loss decreased (-0.533287 --> -0.571302).  Saving model ...
Epoch: 12 cost time: 128.60731053352356
Epoch: 12, Steps: 32 | Train Loss: 7.191 Vali Loss: 117.458 Vali Acc: 0.427 Test Loss: 117.458 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 131.2867374420166
Epoch: 13, Steps: 32 | Train Loss: 5.018 Vali Loss: 139.950 Vali Acc: 0.489 Test Loss: 139.950 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 129.4132423400879
Epoch: 14, Steps: 32 | Train Loss: 6.621 Vali Loss: 129.024 Vali Acc: 0.534 Test Loss: 129.024 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 130.6860671043396
Epoch: 15, Steps: 32 | Train Loss: 3.915 Vali Loss: 124.579 Vali Acc: 0.458 Test Loss: 124.579 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 132.26397681236267
Epoch: 16, Steps: 32 | Train Loss: 3.593 Vali Loss: 197.483 Vali Acc: 0.412 Test Loss: 197.483 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 127.67034792900085
Epoch: 17, Steps: 32 | Train Loss: 10.113 Vali Loss: 170.115 Vali Acc: 0.473 Test Loss: 170.115 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 130.6631577014923
Epoch: 18, Steps: 32 | Train Loss: 3.270 Vali Loss: 202.560 Vali Acc: 0.412 Test Loss: 202.560 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 130.9015018939972
Epoch: 19, Steps: 32 | Train Loss: 0.001 Vali Loss: 249.814 Vali Acc: 0.328 Test Loss: 249.814 Test Acc: 0.328
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 130.09803295135498
Epoch: 20, Steps: 32 | Train Loss: 6.154 Vali Loss: 187.652 Vali Acc: 0.420 Test Loss: 187.652 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 130.10786747932434
Epoch: 21, Steps: 32 | Train Loss: 0.715 Vali Loss: 296.555 Vali Acc: 0.366 Test Loss: 296.555 Test Acc: 0.366
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df512_ma5396_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 12566917
model size : 65.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3597                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df512_ma3597_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 66.47502255439758
Epoch: 1, Steps: 32 | Train Loss: 10.414 Vali Loss: 13.781 Vali Acc: 0.214 Test Loss: 13.781 Test Acc: 0.214
Validation loss decreased (inf --> -0.213603).  Saving model ...
Epoch: 2 cost time: 77.82901239395142
Epoch: 2, Steps: 32 | Train Loss: 20.279 Vali Loss: 48.764 Vali Acc: 0.458 Test Loss: 48.764 Test Acc: 0.458
Validation loss decreased (-0.213603 --> -0.457528).  Saving model ...
Epoch: 3 cost time: 83.79794406890869
Epoch: 3, Steps: 32 | Train Loss: 12.861 Vali Loss: 88.047 Vali Acc: 0.481 Test Loss: 88.047 Test Acc: 0.481
Validation loss decreased (-0.457528 --> -0.480036).  Saving model ...
Epoch: 4 cost time: 88.82488584518433
Epoch: 4, Steps: 32 | Train Loss: 10.686 Vali Loss: 47.317 Vali Acc: 0.420 Test Loss: 47.317 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 88.84628582000732
Epoch: 5, Steps: 32 | Train Loss: 8.041 Vali Loss: 51.879 Vali Acc: 0.473 Test Loss: 51.879 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 86.7105929851532
Epoch: 6, Steps: 32 | Train Loss: 14.654 Vali Loss: 97.312 Vali Acc: 0.496 Test Loss: 97.312 Test Acc: 0.496
Validation loss decreased (-0.480036 --> -0.495210).  Saving model ...
Epoch: 7 cost time: 88.09828019142151
Epoch: 7, Steps: 32 | Train Loss: 14.656 Vali Loss: 86.710 Vali Acc: 0.481 Test Loss: 86.710 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 91.06212902069092
Epoch: 8, Steps: 32 | Train Loss: 1.835 Vali Loss: 96.056 Vali Acc: 0.450 Test Loss: 96.056 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 90.38266277313232
Epoch: 9, Steps: 32 | Train Loss: 2.849 Vali Loss: 97.743 Vali Acc: 0.573 Test Loss: 97.743 Test Acc: 0.573
Validation loss decreased (-0.495210 --> -0.571542).  Saving model ...
Epoch: 10 cost time: 91.43095898628235
Epoch: 10, Steps: 32 | Train Loss: 2.544 Vali Loss: 127.147 Vali Acc: 0.489 Test Loss: 127.147 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 92.15649342536926
Epoch: 11, Steps: 32 | Train Loss: 2.306 Vali Loss: 110.434 Vali Acc: 0.557 Test Loss: 110.434 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 91.06362247467041
Epoch: 12, Steps: 32 | Train Loss: 3.341 Vali Loss: 98.239 Vali Acc: 0.344 Test Loss: 98.239 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 90.23812508583069
Epoch: 13, Steps: 32 | Train Loss: 4.043 Vali Loss: 88.417 Vali Acc: 0.389 Test Loss: 88.417 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 89.64936518669128
Epoch: 14, Steps: 32 | Train Loss: 8.587 Vali Loss: 126.708 Vali Acc: 0.496 Test Loss: 126.708 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 92.14378786087036
Epoch: 15, Steps: 32 | Train Loss: 4.918 Vali Loss: 123.312 Vali Acc: 0.504 Test Loss: 123.312 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 91.87942385673523
Epoch: 16, Steps: 32 | Train Loss: 1.228 Vali Loss: 215.054 Vali Acc: 0.542 Test Loss: 215.054 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 91.42059350013733
Epoch: 17, Steps: 32 | Train Loss: 4.350 Vali Loss: 126.895 Vali Acc: 0.542 Test Loss: 126.895 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 90.88340783119202
Epoch: 18, Steps: 32 | Train Loss: 2.407 Vali Loss: 205.221 Vali Acc: 0.550 Test Loss: 205.221 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 90.79814767837524
Epoch: 19, Steps: 32 | Train Loss: 3.505 Vali Loss: 223.323 Vali Acc: 0.534 Test Loss: 223.323 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df512_ma3597_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 12566917
model size : 65.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1799                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df512_ma1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 37.978307247161865
Epoch: 1, Steps: 32 | Train Loss: 8.803 Vali Loss: 19.379 Vali Acc: 0.290 Test Loss: 19.379 Test Acc: 0.290
Validation loss decreased (inf --> -0.289883).  Saving model ...
Epoch: 2 cost time: 41.13047981262207
Epoch: 2, Steps: 32 | Train Loss: 11.383 Vali Loss: 48.456 Vali Acc: 0.221 Test Loss: 48.456 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 46.93181800842285
Epoch: 3, Steps: 32 | Train Loss: 19.839 Vali Loss: 36.772 Vali Acc: 0.550 Test Loss: 36.772 Test Acc: 0.550
Validation loss decreased (-0.289883 --> -0.549251).  Saving model ...
Epoch: 4 cost time: 49.18914771080017
Epoch: 4, Steps: 32 | Train Loss: 9.194 Vali Loss: 40.528 Vali Acc: 0.481 Test Loss: 40.528 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 48.86922550201416
Epoch: 5, Steps: 32 | Train Loss: 5.608 Vali Loss: 68.608 Vali Acc: 0.519 Test Loss: 68.608 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 49.28789949417114
Epoch: 6, Steps: 32 | Train Loss: 2.589 Vali Loss: 97.587 Vali Acc: 0.527 Test Loss: 97.587 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 49.51517462730408
Epoch: 7, Steps: 32 | Train Loss: 16.395 Vali Loss: 110.819 Vali Acc: 0.519 Test Loss: 110.819 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 49.42518758773804
Epoch: 8, Steps: 32 | Train Loss: 8.282 Vali Loss: 128.977 Vali Acc: 0.328 Test Loss: 128.977 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 49.40026569366455
Epoch: 9, Steps: 32 | Train Loss: 5.392 Vali Loss: 108.406 Vali Acc: 0.580 Test Loss: 108.406 Test Acc: 0.580
Validation loss decreased (-0.549251 --> -0.579069).  Saving model ...
Epoch: 10 cost time: 51.327950954437256
Epoch: 10, Steps: 32 | Train Loss: 0.291 Vali Loss: 81.532 Vali Acc: 0.504 Test Loss: 81.532 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 50.3890061378479
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 83.318 Vali Acc: 0.489 Test Loss: 83.318 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 50.618430376052856
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 92.900 Vali Acc: 0.534 Test Loss: 92.900 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 50.72089242935181
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 95.751 Vali Acc: 0.527 Test Loss: 95.751 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 50.627031087875366
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 95.864 Vali Acc: 0.527 Test Loss: 95.864 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 50.354777574539185
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 95.868 Vali Acc: 0.527 Test Loss: 95.868 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 50.97168326377869
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 95.868 Vali Acc: 0.527 Test Loss: 95.868 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 51.01256227493286
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 95.868 Vali Acc: 0.527 Test Loss: 95.868 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 50.67663884162903
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 95.868 Vali Acc: 0.527 Test Loss: 95.868 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 50.963810443878174
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 95.868 Vali Acc: 0.527 Test Loss: 95.868 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df512_ma1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 12566917
model size : 65.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df512_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 24.244239330291748
Epoch: 1, Steps: 32 | Train Loss: 8.329 Vali Loss: 23.067 Vali Acc: 0.458 Test Loss: 23.067 Test Acc: 0.458
Validation loss decreased (inf --> -0.457785).  Saving model ...
Epoch: 2 cost time: 25.306675672531128
Epoch: 2, Steps: 32 | Train Loss: 9.548 Vali Loss: 36.085 Vali Acc: 0.275 Test Loss: 36.085 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 27.47810411453247
Epoch: 3, Steps: 32 | Train Loss: 10.265 Vali Loss: 48.868 Vali Acc: 0.534 Test Loss: 48.868 Test Acc: 0.534
Validation loss decreased (-0.457785 --> -0.533862).  Saving model ...
Epoch: 4 cost time: 30.06704878807068
Epoch: 4, Steps: 32 | Train Loss: 5.289 Vali Loss: 51.957 Vali Acc: 0.511 Test Loss: 51.957 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 30.539360523223877
Epoch: 5, Steps: 32 | Train Loss: 2.110 Vali Loss: 64.542 Vali Acc: 0.550 Test Loss: 64.542 Test Acc: 0.550
Validation loss decreased (-0.533862 --> -0.548973).  Saving model ...
Epoch: 6 cost time: 29.095451593399048
Epoch: 6, Steps: 32 | Train Loss: 5.229 Vali Loss: 132.878 Vali Acc: 0.504 Test Loss: 132.878 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 30.16546106338501
Epoch: 7, Steps: 32 | Train Loss: 6.524 Vali Loss: 67.712 Vali Acc: 0.466 Test Loss: 67.712 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 29.642339944839478
Epoch: 8, Steps: 32 | Train Loss: 7.571 Vali Loss: 160.377 Vali Acc: 0.450 Test Loss: 160.377 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 30.272432565689087
Epoch: 9, Steps: 32 | Train Loss: 8.779 Vali Loss: 109.128 Vali Acc: 0.565 Test Loss: 109.128 Test Acc: 0.565
Validation loss decreased (-0.548973 --> -0.563794).  Saving model ...
Epoch: 10 cost time: 29.452448844909668
Epoch: 10, Steps: 32 | Train Loss: 4.733 Vali Loss: 150.512 Vali Acc: 0.542 Test Loss: 150.512 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 29.83053493499756
Epoch: 11, Steps: 32 | Train Loss: 8.102 Vali Loss: 120.328 Vali Acc: 0.573 Test Loss: 120.328 Test Acc: 0.573
Validation loss decreased (-0.563794 --> -0.571316).  Saving model ...
Epoch: 12 cost time: 30.04535412788391
Epoch: 12, Steps: 32 | Train Loss: 1.705 Vali Loss: 103.525 Vali Acc: 0.527 Test Loss: 103.525 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 30.078348875045776
Epoch: 13, Steps: 32 | Train Loss: 0.997 Vali Loss: 171.824 Vali Acc: 0.527 Test Loss: 171.824 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 30.355615377426147
Epoch: 14, Steps: 32 | Train Loss: 1.764 Vali Loss: 165.695 Vali Acc: 0.542 Test Loss: 165.695 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 30.43818688392639
Epoch: 15, Steps: 32 | Train Loss: 7.252 Vali Loss: 166.027 Vali Acc: 0.427 Test Loss: 166.027 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 29.01726245880127
Epoch: 16, Steps: 32 | Train Loss: 10.209 Vali Loss: 199.530 Vali Acc: 0.527 Test Loss: 199.530 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 29.747490644454956
Epoch: 17, Steps: 32 | Train Loss: 13.909 Vali Loss: 131.124 Vali Acc: 0.458 Test Loss: 131.124 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 29.987170696258545
Epoch: 18, Steps: 32 | Train Loss: 12.952 Vali Loss: 231.752 Vali Acc: 0.489 Test Loss: 231.752 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 30.49229145050049
Epoch: 19, Steps: 32 | Train Loss: 1.806 Vali Loss: 176.959 Vali Acc: 0.336 Test Loss: 176.959 Test Acc: 0.336
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 30.22907018661499
Epoch: 20, Steps: 32 | Train Loss: 2.262 Vali Loss: 226.917 Vali Acc: 0.489 Test Loss: 226.917 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 30.134223461151123
Epoch: 21, Steps: 32 | Train Loss: 4.971 Vali Loss: 220.515 Vali Acc: 0.458 Test Loss: 220.515 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df512_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 12566917
model size : 65.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         540                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df512_ma540_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 18.957093715667725
Epoch: 1, Steps: 32 | Train Loss: 7.123 Vali Loss: 17.908 Vali Acc: 0.473 Test Loss: 17.908 Test Acc: 0.473
Validation loss decreased (inf --> -0.473103).  Saving model ...
Epoch: 2 cost time: 18.58507251739502
Epoch: 2, Steps: 32 | Train Loss: 5.568 Vali Loss: 14.672 Vali Acc: 0.389 Test Loss: 14.672 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 20.275434494018555
Epoch: 3, Steps: 32 | Train Loss: 7.680 Vali Loss: 33.575 Vali Acc: 0.420 Test Loss: 33.575 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 21.32153582572937
Epoch: 4, Steps: 32 | Train Loss: 8.082 Vali Loss: 65.263 Vali Acc: 0.511 Test Loss: 65.263 Test Acc: 0.511
Validation loss decreased (-0.473103 --> -0.510798).  Saving model ...
Epoch: 5 cost time: 21.824124574661255
Epoch: 5, Steps: 32 | Train Loss: 4.105 Vali Loss: 48.331 Vali Acc: 0.412 Test Loss: 48.331 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 21.497019290924072
Epoch: 6, Steps: 32 | Train Loss: 15.783 Vali Loss: 104.495 Vali Acc: 0.359 Test Loss: 104.495 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 21.585896015167236
Epoch: 7, Steps: 32 | Train Loss: 6.202 Vali Loss: 121.243 Vali Acc: 0.519 Test Loss: 121.243 Test Acc: 0.519
Validation loss decreased (-0.510798 --> -0.517872).  Saving model ...
Epoch: 8 cost time: 21.312614917755127
Epoch: 8, Steps: 32 | Train Loss: 6.757 Vali Loss: 198.039 Vali Acc: 0.504 Test Loss: 198.039 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 21.478577613830566
Epoch: 9, Steps: 32 | Train Loss: 9.688 Vali Loss: 120.854 Vali Acc: 0.382 Test Loss: 120.854 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 21.57035994529724
Epoch: 10, Steps: 32 | Train Loss: 2.457 Vali Loss: 127.405 Vali Acc: 0.351 Test Loss: 127.405 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 22.053557872772217
Epoch: 11, Steps: 32 | Train Loss: 0.628 Vali Loss: 119.196 Vali Acc: 0.504 Test Loss: 119.196 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 22.057940006256104
Epoch: 12, Steps: 32 | Train Loss: 0.376 Vali Loss: 176.861 Vali Acc: 0.504 Test Loss: 176.861 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 22.06145167350769
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 184.886 Vali Acc: 0.504 Test Loss: 184.886 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 22.055350065231323
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 185.186 Vali Acc: 0.504 Test Loss: 185.186 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 22.2525475025177
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 185.197 Vali Acc: 0.504 Test Loss: 185.197 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 21.93171238899231
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 185.198 Vali Acc: 0.504 Test Loss: 185.198 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 21.831835985183716
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 185.198 Vali Acc: 0.504 Test Loss: 185.198 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df512_ma540_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 12566917
model size : 65.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df512_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 16.719938039779663
Epoch: 1, Steps: 32 | Train Loss: 8.664 Vali Loss: 14.921 Vali Acc: 0.458 Test Loss: 14.921 Test Acc: 0.458
Validation loss decreased (inf --> -0.457866).  Saving model ...
Epoch: 2 cost time: 15.770155906677246
Epoch: 2, Steps: 32 | Train Loss: 6.175 Vali Loss: 22.946 Vali Acc: 0.298 Test Loss: 22.946 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 16.94400906562805
Epoch: 3, Steps: 32 | Train Loss: 5.349 Vali Loss: 25.030 Vali Acc: 0.275 Test Loss: 25.030 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 16.76706075668335
Epoch: 4, Steps: 32 | Train Loss: 10.019 Vali Loss: 71.089 Vali Acc: 0.443 Test Loss: 71.089 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 17.70899724960327
Epoch: 5, Steps: 32 | Train Loss: 11.684 Vali Loss: 46.265 Vali Acc: 0.328 Test Loss: 46.265 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 17.604523420333862
Epoch: 6, Steps: 32 | Train Loss: 2.678 Vali Loss: 80.784 Vali Acc: 0.450 Test Loss: 80.784 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 17.589738130569458
Epoch: 7, Steps: 32 | Train Loss: 9.134 Vali Loss: 65.252 Vali Acc: 0.565 Test Loss: 65.252 Test Acc: 0.565
Validation loss decreased (-0.457866 --> -0.564233).  Saving model ...
Epoch: 8 cost time: 17.64063858985901
Epoch: 8, Steps: 32 | Train Loss: 5.582 Vali Loss: 202.204 Vali Acc: 0.496 Test Loss: 202.204 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 17.587944507598877
Epoch: 9, Steps: 32 | Train Loss: 8.238 Vali Loss: 130.457 Vali Acc: 0.511 Test Loss: 130.457 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 17.45531153678894
Epoch: 10, Steps: 32 | Train Loss: 1.714 Vali Loss: 147.208 Vali Acc: 0.511 Test Loss: 147.208 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 18.058762073516846
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 98.343 Vali Acc: 0.466 Test Loss: 98.343 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 17.490554094314575
Epoch: 12, Steps: 32 | Train Loss: 3.935 Vali Loss: 150.371 Vali Acc: 0.527 Test Loss: 150.371 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 17.393174409866333
Epoch: 13, Steps: 32 | Train Loss: 6.082 Vali Loss: 200.052 Vali Acc: 0.504 Test Loss: 200.052 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 17.480775833129883
Epoch: 14, Steps: 32 | Train Loss: 5.423 Vali Loss: 100.629 Vali Acc: 0.382 Test Loss: 100.629 Test Acc: 0.382
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 17.657371759414673
Epoch: 15, Steps: 32 | Train Loss: 3.275 Vali Loss: 150.881 Vali Acc: 0.443 Test Loss: 150.881 Test Acc: 0.443
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 17.939796924591064
Epoch: 16, Steps: 32 | Train Loss: 2.233 Vali Loss: 172.644 Vali Acc: 0.511 Test Loss: 172.644 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 18.008769750595093
Epoch: 17, Steps: 32 | Train Loss: 0.124 Vali Loss: 137.279 Vali Acc: 0.374 Test Loss: 137.279 Test Acc: 0.374
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df512_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 12566917
model size : 65.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df512_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.824461936950684
Epoch: 1, Steps: 32 | Train Loss: 6.124 Vali Loss: 15.109 Vali Acc: 0.328 Test Loss: 15.109 Test Acc: 0.328
Validation loss decreased (inf --> -0.328093).  Saving model ...
Epoch: 2 cost time: 13.483189821243286
Epoch: 2, Steps: 32 | Train Loss: 10.432 Vali Loss: 19.860 Vali Acc: 0.519 Test Loss: 19.860 Test Acc: 0.519
Validation loss decreased (-0.328093 --> -0.518885).  Saving model ...
Epoch: 3 cost time: 13.368197202682495
Epoch: 3, Steps: 32 | Train Loss: 9.078 Vali Loss: 22.993 Vali Acc: 0.580 Test Loss: 22.993 Test Acc: 0.580
Validation loss decreased (-0.518885 --> -0.579923).  Saving model ...
Epoch: 4 cost time: 13.941240787506104
Epoch: 4, Steps: 32 | Train Loss: 9.070 Vali Loss: 38.386 Vali Acc: 0.542 Test Loss: 38.386 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.871628522872925
Epoch: 5, Steps: 32 | Train Loss: 8.745 Vali Loss: 37.928 Vali Acc: 0.427 Test Loss: 37.928 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 13.54173731803894
Epoch: 6, Steps: 32 | Train Loss: 11.560 Vali Loss: 130.498 Vali Acc: 0.473 Test Loss: 130.498 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 13.933501482009888
Epoch: 7, Steps: 32 | Train Loss: 6.315 Vali Loss: 46.025 Vali Acc: 0.534 Test Loss: 46.025 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 14.222495794296265
Epoch: 8, Steps: 32 | Train Loss: 3.359 Vali Loss: 48.106 Vali Acc: 0.504 Test Loss: 48.106 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 13.838855743408203
Epoch: 9, Steps: 32 | Train Loss: 5.668 Vali Loss: 35.176 Vali Acc: 0.550 Test Loss: 35.176 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 14.169974088668823
Epoch: 10, Steps: 32 | Train Loss: 1.024 Vali Loss: 85.241 Vali Acc: 0.550 Test Loss: 85.241 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 13.991043090820312
Epoch: 11, Steps: 32 | Train Loss: 2.980 Vali Loss: 90.658 Vali Acc: 0.504 Test Loss: 90.658 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 13.894201517105103
Epoch: 12, Steps: 32 | Train Loss: 7.408 Vali Loss: 262.736 Vali Acc: 0.221 Test Loss: 262.736 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 14.090863704681396
Epoch: 13, Steps: 32 | Train Loss: 10.017 Vali Loss: 94.474 Vali Acc: 0.534 Test Loss: 94.474 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df512_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 12566917
model size : 65.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df512_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.99857497215271
Epoch: 1, Steps: 32 | Train Loss: 7.352 Vali Loss: 5.986 Vali Acc: 0.420 Test Loss: 5.986 Test Acc: 0.420
Validation loss decreased (inf --> -0.419787).  Saving model ...
Epoch: 2 cost time: 11.77527642250061
Epoch: 2, Steps: 32 | Train Loss: 12.081 Vali Loss: 43.477 Vali Acc: 0.481 Test Loss: 43.477 Test Acc: 0.481
Validation loss decreased (-0.419787 --> -0.480481).  Saving model ...
Epoch: 3 cost time: 11.968332290649414
Epoch: 3, Steps: 32 | Train Loss: 8.658 Vali Loss: 25.217 Vali Acc: 0.565 Test Loss: 25.217 Test Acc: 0.565
Validation loss decreased (-0.480481 --> -0.564633).  Saving model ...
Epoch: 4 cost time: 12.198253631591797
Epoch: 4, Steps: 32 | Train Loss: 10.693 Vali Loss: 35.301 Vali Acc: 0.504 Test Loss: 35.301 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.807161092758179
Epoch: 5, Steps: 32 | Train Loss: 7.306 Vali Loss: 47.361 Vali Acc: 0.405 Test Loss: 47.361 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.221410989761353
Epoch: 6, Steps: 32 | Train Loss: 7.645 Vali Loss: 48.014 Vali Acc: 0.534 Test Loss: 48.014 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 12.020145177841187
Epoch: 7, Steps: 32 | Train Loss: 10.631 Vali Loss: 101.336 Vali Acc: 0.427 Test Loss: 101.336 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 12.114483118057251
Epoch: 8, Steps: 32 | Train Loss: 8.991 Vali Loss: 47.826 Vali Acc: 0.550 Test Loss: 47.826 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 11.719468832015991
Epoch: 9, Steps: 32 | Train Loss: 2.919 Vali Loss: 57.724 Vali Acc: 0.557 Test Loss: 57.724 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 12.256953239440918
Epoch: 10, Steps: 32 | Train Loss: 6.322 Vali Loss: 78.797 Vali Acc: 0.359 Test Loss: 78.797 Test Acc: 0.359
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 11.670872211456299
Epoch: 11, Steps: 32 | Train Loss: 7.208 Vali Loss: 123.709 Vali Acc: 0.351 Test Loss: 123.709 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 12.318479299545288
Epoch: 12, Steps: 32 | Train Loss: 0.484 Vali Loss: 99.377 Vali Acc: 0.550 Test Loss: 99.377 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 11.964587211608887
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 103.897 Vali Acc: 0.550 Test Loss: 103.897 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df512_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 12566917
model size : 65.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         8992                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df256_ma8992_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 172.39663672447205
Epoch: 1, Steps: 32 | Train Loss: 14.018 Vali Loss: 19.632 Vali Acc: 0.237 Test Loss: 19.632 Test Acc: 0.237
Validation loss decreased (inf --> -0.236445).  Saving model ...
Epoch: 2 cost time: 195.54569721221924
Epoch: 2, Steps: 32 | Train Loss: 8.391 Vali Loss: 20.966 Vali Acc: 0.252 Test Loss: 20.966 Test Acc: 0.252
Validation loss decreased (-0.236445 --> -0.251699).  Saving model ...
Epoch: 3 cost time: 209.87675380706787
Epoch: 3, Steps: 32 | Train Loss: 8.073 Vali Loss: 53.452 Vali Acc: 0.183 Test Loss: 53.452 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 216.5099618434906
Epoch: 4, Steps: 32 | Train Loss: 12.784 Vali Loss: 35.084 Vali Acc: 0.496 Test Loss: 35.084 Test Acc: 0.496
Validation loss decreased (-0.251699 --> -0.495832).  Saving model ...
Epoch: 5 cost time: 217.18226623535156
Epoch: 5, Steps: 32 | Train Loss: 3.921 Vali Loss: 46.281 Vali Acc: 0.534 Test Loss: 46.281 Test Acc: 0.534
Validation loss decreased (-0.495832 --> -0.533888).  Saving model ...
Epoch: 6 cost time: 223.57264709472656
Epoch: 6, Steps: 32 | Train Loss: 6.036 Vali Loss: 59.044 Vali Acc: 0.496 Test Loss: 59.044 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 224.069082736969
Epoch: 7, Steps: 32 | Train Loss: 11.637 Vali Loss: 115.436 Vali Acc: 0.527 Test Loss: 115.436 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 228.9212610721588
Epoch: 8, Steps: 32 | Train Loss: 8.326 Vali Loss: 132.168 Vali Acc: 0.504 Test Loss: 132.168 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 227.59711289405823
Epoch: 9, Steps: 32 | Train Loss: 1.997 Vali Loss: 97.531 Vali Acc: 0.534 Test Loss: 97.531 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 227.12294173240662
Epoch: 10, Steps: 32 | Train Loss: 3.016 Vali Loss: 162.492 Vali Acc: 0.511 Test Loss: 162.492 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 226.56392526626587
Epoch: 11, Steps: 32 | Train Loss: 6.134 Vali Loss: 103.656 Vali Acc: 0.450 Test Loss: 103.656 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 227.33099126815796
Epoch: 12, Steps: 32 | Train Loss: 3.735 Vali Loss: 187.864 Vali Acc: 0.504 Test Loss: 187.864 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 225.1864013671875
Epoch: 13, Steps: 32 | Train Loss: 3.314 Vali Loss: 162.124 Vali Acc: 0.557 Test Loss: 162.124 Test Acc: 0.557
Validation loss decreased (-0.533888 --> -0.555631).  Saving model ...
Epoch: 14 cost time: 226.40415000915527
Epoch: 14, Steps: 32 | Train Loss: 4.641 Vali Loss: 116.474 Vali Acc: 0.550 Test Loss: 116.474 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 226.85697174072266
Epoch: 15, Steps: 32 | Train Loss: 1.880 Vali Loss: 183.917 Vali Acc: 0.534 Test Loss: 183.917 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 228.09288001060486
Epoch: 16, Steps: 32 | Train Loss: 3.870 Vali Loss: 199.175 Vali Acc: 0.298 Test Loss: 199.175 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 225.83520531654358
Epoch: 17, Steps: 32 | Train Loss: 7.466 Vali Loss: 140.417 Vali Acc: 0.534 Test Loss: 140.417 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 228.10875725746155
Epoch: 18, Steps: 32 | Train Loss: 8.414 Vali Loss: 141.245 Vali Acc: 0.489 Test Loss: 141.245 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 225.03703260421753
Epoch: 19, Steps: 32 | Train Loss: 6.225 Vali Loss: 151.264 Vali Acc: 0.504 Test Loss: 151.264 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 225.44252228736877
Epoch: 20, Steps: 32 | Train Loss: 3.244 Vali Loss: 189.947 Vali Acc: 0.542 Test Loss: 189.947 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 227.60155820846558
Epoch: 21, Steps: 32 | Train Loss: 5.228 Vali Loss: 280.882 Vali Acc: 0.489 Test Loss: 280.882 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 226.25445461273193
Epoch: 22, Steps: 32 | Train Loss: 12.029 Vali Loss: 292.672 Vali Acc: 0.397 Test Loss: 292.672 Test Acc: 0.397
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 225.24771070480347
Epoch: 23, Steps: 32 | Train Loss: 15.207 Vali Loss: 261.080 Vali Acc: 0.542 Test Loss: 261.080 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df256_ma8992_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 12370309
model size : 64.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         7194                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df256_ma7194_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 139.87669444084167
Epoch: 1, Steps: 32 | Train Loss: 12.725 Vali Loss: 31.453 Vali Acc: 0.221 Test Loss: 31.453 Test Acc: 0.221
Validation loss decreased (inf --> -0.221060).  Saving model ...
Epoch: 2 cost time: 150.41922903060913
Epoch: 2, Steps: 32 | Train Loss: 16.541 Vali Loss: 33.871 Vali Acc: 0.153 Test Loss: 33.871 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 167.9631233215332
Epoch: 3, Steps: 32 | Train Loss: 8.139 Vali Loss: 34.184 Vali Acc: 0.496 Test Loss: 34.184 Test Acc: 0.496
Validation loss decreased (-0.221060 --> -0.495841).  Saving model ...
Epoch: 4 cost time: 184.5547206401825
Epoch: 4, Steps: 32 | Train Loss: 4.063 Vali Loss: 37.634 Vali Acc: 0.374 Test Loss: 37.634 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 177.19869256019592
Epoch: 5, Steps: 32 | Train Loss: 6.098 Vali Loss: 90.114 Vali Acc: 0.542 Test Loss: 90.114 Test Acc: 0.542
Validation loss decreased (-0.495841 --> -0.541084).  Saving model ...
Epoch: 6 cost time: 183.55578899383545
Epoch: 6, Steps: 32 | Train Loss: 6.507 Vali Loss: 52.961 Vali Acc: 0.557 Test Loss: 52.961 Test Acc: 0.557
Validation loss decreased (-0.541084 --> -0.556722).  Saving model ...
Epoch: 7 cost time: 184.27387928962708
Epoch: 7, Steps: 32 | Train Loss: 4.983 Vali Loss: 74.012 Vali Acc: 0.450 Test Loss: 74.012 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 178.54834055900574
Epoch: 8, Steps: 32 | Train Loss: 7.565 Vali Loss: 106.990 Vali Acc: 0.580 Test Loss: 106.990 Test Acc: 0.580
Validation loss decreased (-0.556722 --> -0.579083).  Saving model ...
Epoch: 9 cost time: 185.20600152015686
Epoch: 9, Steps: 32 | Train Loss: 2.012 Vali Loss: 99.945 Vali Acc: 0.504 Test Loss: 99.945 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 178.5544309616089
Epoch: 10, Steps: 32 | Train Loss: 4.817 Vali Loss: 75.538 Vali Acc: 0.466 Test Loss: 75.538 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 182.8139820098877
Epoch: 11, Steps: 32 | Train Loss: 3.993 Vali Loss: 103.340 Vali Acc: 0.443 Test Loss: 103.340 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 181.9019742012024
Epoch: 12, Steps: 32 | Train Loss: 8.373 Vali Loss: 71.160 Vali Acc: 0.603 Test Loss: 71.160 Test Acc: 0.603
Validation loss decreased (-0.579083 --> -0.602342).  Saving model ...
Epoch: 13 cost time: 181.6483597755432
Epoch: 13, Steps: 32 | Train Loss: 6.219 Vali Loss: 179.982 Vali Acc: 0.542 Test Loss: 179.982 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 182.7192735671997
Epoch: 14, Steps: 32 | Train Loss: 4.090 Vali Loss: 178.552 Vali Acc: 0.542 Test Loss: 178.552 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 176.25341701507568
Epoch: 15, Steps: 32 | Train Loss: 16.876 Vali Loss: 239.464 Vali Acc: 0.450 Test Loss: 239.464 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 182.2593014240265
Epoch: 16, Steps: 32 | Train Loss: 9.342 Vali Loss: 149.476 Vali Acc: 0.534 Test Loss: 149.476 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 179.12067365646362
Epoch: 17, Steps: 32 | Train Loss: 4.949 Vali Loss: 131.051 Vali Acc: 0.489 Test Loss: 131.051 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 183.0099105834961
Epoch: 18, Steps: 32 | Train Loss: 0.210 Vali Loss: 191.293 Vali Acc: 0.443 Test Loss: 191.293 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 180.4925413131714
Epoch: 19, Steps: 32 | Train Loss: 2.751 Vali Loss: 156.925 Vali Acc: 0.511 Test Loss: 156.925 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 182.57150721549988
Epoch: 20, Steps: 32 | Train Loss: 5.898 Vali Loss: 230.539 Vali Acc: 0.557 Test Loss: 230.539 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 184.50522565841675
Epoch: 21, Steps: 32 | Train Loss: 2.742 Vali Loss: 152.320 Vali Acc: 0.534 Test Loss: 152.320 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 181.19648361206055
Epoch: 22, Steps: 32 | Train Loss: 3.664 Vali Loss: 173.350 Vali Acc: 0.550 Test Loss: 173.350 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df256_ma7194_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 12370309
model size : 64.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5396                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df256_ma5396_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 93.76935601234436
Epoch: 1, Steps: 32 | Train Loss: 11.717 Vali Loss: 27.032 Vali Acc: 0.214 Test Loss: 27.032 Test Acc: 0.214
Validation loss decreased (inf --> -0.213470).  Saving model ...
Epoch: 2 cost time: 108.8879554271698
Epoch: 2, Steps: 32 | Train Loss: 20.998 Vali Loss: 26.265 Vali Acc: 0.237 Test Loss: 26.265 Test Acc: 0.237
Validation loss decreased (-0.213470 --> -0.236379).  Saving model ...
Epoch: 3 cost time: 130.30387926101685
Epoch: 3, Steps: 32 | Train Loss: 7.337 Vali Loss: 31.613 Vali Acc: 0.405 Test Loss: 31.613 Test Acc: 0.405
Validation loss decreased (-0.236379 --> -0.404264).  Saving model ...
Epoch: 4 cost time: 125.4885847568512
Epoch: 4, Steps: 32 | Train Loss: 7.211 Vali Loss: 57.403 Vali Acc: 0.290 Test Loss: 57.403 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 123.91956830024719
Epoch: 5, Steps: 32 | Train Loss: 11.495 Vali Loss: 59.846 Vali Acc: 0.534 Test Loss: 59.846 Test Acc: 0.534
Validation loss decreased (-0.404264 --> -0.533753).  Saving model ...
Epoch: 6 cost time: 128.1972463130951
Epoch: 6, Steps: 32 | Train Loss: 4.563 Vali Loss: 85.064 Vali Acc: 0.305 Test Loss: 85.064 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 131.21761417388916
Epoch: 7, Steps: 32 | Train Loss: 6.798 Vali Loss: 77.775 Vali Acc: 0.481 Test Loss: 77.775 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 129.88893175125122
Epoch: 8, Steps: 32 | Train Loss: 6.995 Vali Loss: 91.255 Vali Acc: 0.542 Test Loss: 91.255 Test Acc: 0.542
Validation loss decreased (-0.533753 --> -0.541072).  Saving model ...
Epoch: 9 cost time: 126.17740964889526
Epoch: 9, Steps: 32 | Train Loss: 18.289 Vali Loss: 118.072 Vali Acc: 0.405 Test Loss: 118.072 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 130.15348267555237
Epoch: 10, Steps: 32 | Train Loss: 7.522 Vali Loss: 112.906 Vali Acc: 0.489 Test Loss: 112.906 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 132.3216814994812
Epoch: 11, Steps: 32 | Train Loss: 3.881 Vali Loss: 83.581 Vali Acc: 0.550 Test Loss: 83.581 Test Acc: 0.550
Validation loss decreased (-0.541072 --> -0.548783).  Saving model ...
Epoch: 12 cost time: 133.21160459518433
Epoch: 12, Steps: 32 | Train Loss: 0.196 Vali Loss: 269.031 Vali Acc: 0.504 Test Loss: 269.031 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 127.20733428001404
Epoch: 13, Steps: 32 | Train Loss: 14.549 Vali Loss: 236.605 Vali Acc: 0.519 Test Loss: 236.605 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 132.35924410820007
Epoch: 14, Steps: 32 | Train Loss: 2.203 Vali Loss: 173.163 Vali Acc: 0.542 Test Loss: 173.163 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 127.95662641525269
Epoch: 15, Steps: 32 | Train Loss: 5.967 Vali Loss: 220.705 Vali Acc: 0.534 Test Loss: 220.705 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 130.3091652393341
Epoch: 16, Steps: 32 | Train Loss: 5.493 Vali Loss: 181.666 Vali Acc: 0.290 Test Loss: 181.666 Test Acc: 0.290
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 129.1652946472168
Epoch: 17, Steps: 32 | Train Loss: 7.350 Vali Loss: 161.134 Vali Acc: 0.481 Test Loss: 161.134 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 131.0621531009674
Epoch: 18, Steps: 32 | Train Loss: 2.072 Vali Loss: 263.846 Vali Acc: 0.527 Test Loss: 263.846 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 132.3470332622528
Epoch: 19, Steps: 32 | Train Loss: 6.539 Vali Loss: 203.550 Vali Acc: 0.450 Test Loss: 203.550 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 131.44307565689087
Epoch: 20, Steps: 32 | Train Loss: 3.484 Vali Loss: 307.837 Vali Acc: 0.313 Test Loss: 307.837 Test Acc: 0.313
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 129.63933944702148
Epoch: 21, Steps: 32 | Train Loss: 3.479 Vali Loss: 257.033 Vali Acc: 0.427 Test Loss: 257.033 Test Acc: 0.427
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df256_ma5396_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 12370309
model size : 64.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3597                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df256_ma3597_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 66.70758247375488
Epoch: 1, Steps: 32 | Train Loss: 13.778 Vali Loss: 45.704 Vali Acc: 0.191 Test Loss: 45.704 Test Acc: 0.191
Validation loss decreased (inf --> -0.190383).  Saving model ...
Epoch: 2 cost time: 71.93536067008972
Epoch: 2, Steps: 32 | Train Loss: 13.689 Vali Loss: 22.980 Vali Acc: 0.290 Test Loss: 22.980 Test Acc: 0.290
Validation loss decreased (-0.190383 --> -0.289847).  Saving model ...
Epoch: 3 cost time: 84.93987345695496
Epoch: 3, Steps: 32 | Train Loss: 10.849 Vali Loss: 59.928 Vali Acc: 0.290 Test Loss: 59.928 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 84.69602608680725
Epoch: 4, Steps: 32 | Train Loss: 11.410 Vali Loss: 35.519 Vali Acc: 0.504 Test Loss: 35.519 Test Acc: 0.504
Validation loss decreased (-0.289847 --> -0.503462).  Saving model ...
Epoch: 5 cost time: 88.79277062416077
Epoch: 5, Steps: 32 | Train Loss: 5.362 Vali Loss: 65.118 Vali Acc: 0.458 Test Loss: 65.118 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 92.96444368362427
Epoch: 6, Steps: 32 | Train Loss: 3.628 Vali Loss: 46.990 Vali Acc: 0.481 Test Loss: 46.990 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 91.07380986213684
Epoch: 7, Steps: 32 | Train Loss: 2.263 Vali Loss: 59.636 Vali Acc: 0.405 Test Loss: 59.636 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 92.08702206611633
Epoch: 8, Steps: 32 | Train Loss: 8.546 Vali Loss: 87.967 Vali Acc: 0.458 Test Loss: 87.967 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 91.88934087753296
Epoch: 9, Steps: 32 | Train Loss: 0.404 Vali Loss: 79.697 Vali Acc: 0.519 Test Loss: 79.697 Test Acc: 0.519
Validation loss decreased (-0.503462 --> -0.518287).  Saving model ...
Epoch: 10 cost time: 91.16785049438477
Epoch: 10, Steps: 32 | Train Loss: 1.002 Vali Loss: 67.719 Vali Acc: 0.466 Test Loss: 67.719 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 90.07083678245544
Epoch: 11, Steps: 32 | Train Loss: 3.689 Vali Loss: 92.900 Vali Acc: 0.527 Test Loss: 92.900 Test Acc: 0.527
Validation loss decreased (-0.518287 --> -0.525789).  Saving model ...
Epoch: 12 cost time: 91.2088131904602
Epoch: 12, Steps: 32 | Train Loss: 1.960 Vali Loss: 97.704 Vali Acc: 0.565 Test Loss: 97.704 Test Acc: 0.565
Validation loss decreased (-0.525789 --> -0.563908).  Saving model ...
Epoch: 13 cost time: 89.87255334854126
Epoch: 13, Steps: 32 | Train Loss: 9.892 Vali Loss: 110.871 Vali Acc: 0.351 Test Loss: 110.871 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 90.11309123039246
Epoch: 14, Steps: 32 | Train Loss: 7.830 Vali Loss: 189.436 Vali Acc: 0.344 Test Loss: 189.436 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 89.25063252449036
Epoch: 15, Steps: 32 | Train Loss: 12.694 Vali Loss: 179.125 Vali Acc: 0.351 Test Loss: 179.125 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 90.54056787490845
Epoch: 16, Steps: 32 | Train Loss: 7.856 Vali Loss: 174.344 Vali Acc: 0.328 Test Loss: 174.344 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 90.50548386573792
Epoch: 17, Steps: 32 | Train Loss: 9.037 Vali Loss: 183.371 Vali Acc: 0.527 Test Loss: 183.371 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 91.88174891471863
Epoch: 18, Steps: 32 | Train Loss: 5.596 Vali Loss: 262.063 Vali Acc: 0.557 Test Loss: 262.063 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 91.7277352809906
Epoch: 19, Steps: 32 | Train Loss: 6.746 Vali Loss: 133.876 Vali Acc: 0.443 Test Loss: 133.876 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 91.31660914421082
Epoch: 20, Steps: 32 | Train Loss: 2.820 Vali Loss: 222.127 Vali Acc: 0.534 Test Loss: 222.127 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 91.44573068618774
Epoch: 21, Steps: 32 | Train Loss: 9.081 Vali Loss: 167.340 Vali Acc: 0.427 Test Loss: 167.340 Test Acc: 0.427
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 91.48805665969849
Epoch: 22, Steps: 32 | Train Loss: 0.907 Vali Loss: 157.692 Vali Acc: 0.412 Test Loss: 157.692 Test Acc: 0.412
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df256_ma3597_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 12370309
model size : 64.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1799                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df256_ma1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 38.07571220397949
Epoch: 1, Steps: 32 | Train Loss: 13.212 Vali Loss: 12.761 Vali Acc: 0.198 Test Loss: 12.761 Test Acc: 0.198
Validation loss decreased (inf --> -0.198346).  Saving model ...
Epoch: 2 cost time: 41.353527307510376
Epoch: 2, Steps: 32 | Train Loss: 11.951 Vali Loss: 16.494 Vali Acc: 0.366 Test Loss: 16.494 Test Acc: 0.366
Validation loss decreased (-0.198346 --> -0.366247).  Saving model ...
Epoch: 3 cost time: 47.67633867263794
Epoch: 3, Steps: 32 | Train Loss: 7.886 Vali Loss: 44.592 Vali Acc: 0.405 Test Loss: 44.592 Test Acc: 0.405
Validation loss decreased (-0.366247 --> -0.404134).  Saving model ...
Epoch: 4 cost time: 46.870139598846436
Epoch: 4, Steps: 32 | Train Loss: 13.234 Vali Loss: 63.188 Vali Acc: 0.496 Test Loss: 63.188 Test Acc: 0.496
Validation loss decreased (-0.404134 --> -0.495551).  Saving model ...
Epoch: 5 cost time: 49.387417793273926
Epoch: 5, Steps: 32 | Train Loss: 9.024 Vali Loss: 86.911 Vali Acc: 0.481 Test Loss: 86.911 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 49.54085326194763
Epoch: 6, Steps: 32 | Train Loss: 21.948 Vali Loss: 91.915 Vali Acc: 0.321 Test Loss: 91.915 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 48.646307945251465
Epoch: 7, Steps: 32 | Train Loss: 6.539 Vali Loss: 88.466 Vali Acc: 0.573 Test Loss: 88.466 Test Acc: 0.573
Validation loss decreased (-0.495551 --> -0.571634).  Saving model ...
Epoch: 8 cost time: 49.72180390357971
Epoch: 8, Steps: 32 | Train Loss: 2.279 Vali Loss: 89.553 Vali Acc: 0.412 Test Loss: 89.553 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 50.516178131103516
Epoch: 9, Steps: 32 | Train Loss: 2.584 Vali Loss: 99.550 Vali Acc: 0.550 Test Loss: 99.550 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 49.24658274650574
Epoch: 10, Steps: 32 | Train Loss: 4.010 Vali Loss: 80.968 Vali Acc: 0.511 Test Loss: 80.968 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 51.13057208061218
Epoch: 11, Steps: 32 | Train Loss: 5.568 Vali Loss: 119.713 Vali Acc: 0.565 Test Loss: 119.713 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 51.02827048301697
Epoch: 12, Steps: 32 | Train Loss: 0.655 Vali Loss: 91.168 Vali Acc: 0.420 Test Loss: 91.168 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 49.32835149765015
Epoch: 13, Steps: 32 | Train Loss: 6.511 Vali Loss: 111.359 Vali Acc: 0.481 Test Loss: 111.359 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 50.379836320877075
Epoch: 14, Steps: 32 | Train Loss: 13.781 Vali Loss: 132.758 Vali Acc: 0.374 Test Loss: 132.758 Test Acc: 0.374
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 49.636186599731445
Epoch: 15, Steps: 32 | Train Loss: 11.697 Vali Loss: 167.223 Vali Acc: 0.427 Test Loss: 167.223 Test Acc: 0.427
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 49.1672146320343
Epoch: 16, Steps: 32 | Train Loss: 8.106 Vali Loss: 201.335 Vali Acc: 0.504 Test Loss: 201.335 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 50.30259084701538
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 174.235 Vali Acc: 0.481 Test Loss: 174.235 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df256_ma1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 12370309
model size : 64.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df256_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 23.941309690475464
Epoch: 1, Steps: 32 | Train Loss: 12.600 Vali Loss: 50.350 Vali Acc: 0.290 Test Loss: 50.350 Test Acc: 0.290
Validation loss decreased (inf --> -0.289573).  Saving model ...
Epoch: 2 cost time: 25.646458625793457
Epoch: 2, Steps: 32 | Train Loss: 27.009 Vali Loss: 29.245 Vali Acc: 0.298 Test Loss: 29.245 Test Acc: 0.298
Validation loss decreased (-0.289573 --> -0.297417).  Saving model ...
Epoch: 3 cost time: 28.888100147247314
Epoch: 3, Steps: 32 | Train Loss: 5.127 Vali Loss: 31.934 Vali Acc: 0.466 Test Loss: 31.934 Test Acc: 0.466
Validation loss decreased (-0.297417 --> -0.465330).  Saving model ...
Epoch: 4 cost time: 28.546818256378174
Epoch: 4, Steps: 32 | Train Loss: 10.169 Vali Loss: 28.779 Vali Acc: 0.443 Test Loss: 28.779 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 29.892108917236328
Epoch: 5, Steps: 32 | Train Loss: 11.772 Vali Loss: 47.755 Vali Acc: 0.550 Test Loss: 47.755 Test Acc: 0.550
Validation loss decreased (-0.465330 --> -0.549141).  Saving model ...
Epoch: 6 cost time: 30.349618673324585
Epoch: 6, Steps: 32 | Train Loss: 5.075 Vali Loss: 93.177 Vali Acc: 0.527 Test Loss: 93.177 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 29.279017448425293
Epoch: 7, Steps: 32 | Train Loss: 5.366 Vali Loss: 78.007 Vali Acc: 0.519 Test Loss: 78.007 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 29.695118188858032
Epoch: 8, Steps: 32 | Train Loss: 3.046 Vali Loss: 55.276 Vali Acc: 0.573 Test Loss: 55.276 Test Acc: 0.573
Validation loss decreased (-0.549141 --> -0.571966).  Saving model ...
Epoch: 9 cost time: 29.568979263305664
Epoch: 9, Steps: 32 | Train Loss: 6.772 Vali Loss: 129.931 Vali Acc: 0.496 Test Loss: 129.931 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 29.923138856887817
Epoch: 10, Steps: 32 | Train Loss: 13.150 Vali Loss: 128.899 Vali Acc: 0.550 Test Loss: 128.899 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 30.090867280960083
Epoch: 11, Steps: 32 | Train Loss: 9.419 Vali Loss: 153.330 Vali Acc: 0.359 Test Loss: 153.330 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 30.047468900680542
Epoch: 12, Steps: 32 | Train Loss: 2.821 Vali Loss: 115.930 Vali Acc: 0.489 Test Loss: 115.930 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 29.920663118362427
Epoch: 13, Steps: 32 | Train Loss: 1.261 Vali Loss: 134.383 Vali Acc: 0.511 Test Loss: 134.383 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 30.104717016220093
Epoch: 14, Steps: 32 | Train Loss: 3.709 Vali Loss: 129.858 Vali Acc: 0.458 Test Loss: 129.858 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 29.803884983062744
Epoch: 15, Steps: 32 | Train Loss: 4.657 Vali Loss: 139.211 Vali Acc: 0.542 Test Loss: 139.211 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 30.0139102935791
Epoch: 16, Steps: 32 | Train Loss: 0.235 Vali Loss: 177.762 Vali Acc: 0.557 Test Loss: 177.762 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 30.041531562805176
Epoch: 17, Steps: 32 | Train Loss: 0.081 Vali Loss: 160.148 Vali Acc: 0.397 Test Loss: 160.148 Test Acc: 0.397
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 30.02145552635193
Epoch: 18, Steps: 32 | Train Loss: 2.899 Vali Loss: 173.520 Vali Acc: 0.481 Test Loss: 173.520 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df256_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 12370309
model size : 64.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         540                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df256_ma540_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 18.557564973831177
Epoch: 1, Steps: 32 | Train Loss: 15.851 Vali Loss: 13.849 Vali Acc: 0.260 Test Loss: 13.849 Test Acc: 0.260
Validation loss decreased (inf --> -0.259403).  Saving model ...
Epoch: 2 cost time: 18.412822246551514
Epoch: 2, Steps: 32 | Train Loss: 8.360 Vali Loss: 24.860 Vali Acc: 0.489 Test Loss: 24.860 Test Acc: 0.489
Validation loss decreased (-0.259403 --> -0.488301).  Saving model ...
Epoch: 3 cost time: 20.20022439956665
Epoch: 3, Steps: 32 | Train Loss: 5.780 Vali Loss: 46.488 Vali Acc: 0.496 Test Loss: 46.488 Test Acc: 0.496
Validation loss decreased (-0.488301 --> -0.495718).  Saving model ...
Epoch: 4 cost time: 20.746546983718872
Epoch: 4, Steps: 32 | Train Loss: 12.086 Vali Loss: 30.593 Vali Acc: 0.504 Test Loss: 30.593 Test Acc: 0.504
Validation loss decreased (-0.495718 --> -0.503511).  Saving model ...
Epoch: 5 cost time: 20.973485708236694
Epoch: 5, Steps: 32 | Train Loss: 3.740 Vali Loss: 73.143 Vali Acc: 0.504 Test Loss: 73.143 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 21.43281364440918
Epoch: 6, Steps: 32 | Train Loss: 8.599 Vali Loss: 77.638 Vali Acc: 0.511 Test Loss: 77.638 Test Acc: 0.511
Validation loss decreased (-0.503511 --> -0.510674).  Saving model ...
Epoch: 7 cost time: 21.278721570968628
Epoch: 7, Steps: 32 | Train Loss: 7.314 Vali Loss: 81.845 Vali Acc: 0.504 Test Loss: 81.845 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 21.522711515426636
Epoch: 8, Steps: 32 | Train Loss: 2.371 Vali Loss: 103.635 Vali Acc: 0.511 Test Loss: 103.635 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 21.47866439819336
Epoch: 9, Steps: 32 | Train Loss: 1.105 Vali Loss: 79.593 Vali Acc: 0.481 Test Loss: 79.593 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 21.556289434432983
Epoch: 10, Steps: 32 | Train Loss: 0.825 Vali Loss: 97.702 Vali Acc: 0.496 Test Loss: 97.702 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 21.283888578414917
Epoch: 11, Steps: 32 | Train Loss: 4.007 Vali Loss: 119.144 Vali Acc: 0.458 Test Loss: 119.144 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 21.390960216522217
Epoch: 12, Steps: 32 | Train Loss: 7.161 Vali Loss: 189.471 Vali Acc: 0.489 Test Loss: 189.471 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 20.831936836242676
Epoch: 13, Steps: 32 | Train Loss: 14.316 Vali Loss: 125.425 Vali Acc: 0.496 Test Loss: 125.425 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 21.40074610710144
Epoch: 14, Steps: 32 | Train Loss: 3.718 Vali Loss: 133.848 Vali Acc: 0.527 Test Loss: 133.848 Test Acc: 0.527
Validation loss decreased (-0.510674 --> -0.525379).  Saving model ...
Epoch: 15 cost time: 21.41684126853943
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 178.950 Vali Acc: 0.519 Test Loss: 178.950 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 21.487174034118652
Epoch: 16, Steps: 32 | Train Loss: 0.038 Vali Loss: 177.263 Vali Acc: 0.527 Test Loss: 177.263 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 21.79767370223999
Epoch: 17, Steps: 32 | Train Loss: 0.100 Vali Loss: 177.378 Vali Acc: 0.527 Test Loss: 177.378 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 21.59707760810852
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 179.211 Vali Acc: 0.527 Test Loss: 179.211 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 21.294727087020874
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 179.289 Vali Acc: 0.527 Test Loss: 179.289 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 21.45013666152954
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 179.292 Vali Acc: 0.527 Test Loss: 179.292 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 21.660255432128906
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 179.292 Vali Acc: 0.527 Test Loss: 179.292 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 21.586132287979126
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 179.292 Vali Acc: 0.527 Test Loss: 179.292 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 21.708449840545654
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 179.292 Vali Acc: 0.527 Test Loss: 179.292 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 21.82432246208191
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 179.292 Vali Acc: 0.527 Test Loss: 179.292 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df256_ma540_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 12370309
model size : 64.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df256_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.832587242126465
Epoch: 1, Steps: 32 | Train Loss: 14.359 Vali Loss: 28.169 Vali Acc: 0.130 Test Loss: 28.169 Test Acc: 0.130
Validation loss decreased (inf --> -0.129489).  Saving model ...
Epoch: 2 cost time: 15.162336349487305
Epoch: 2, Steps: 32 | Train Loss: 11.696 Vali Loss: 22.397 Vali Acc: 0.504 Test Loss: 22.397 Test Acc: 0.504
Validation loss decreased (-0.129489 --> -0.503593).  Saving model ...
Epoch: 3 cost time: 16.431037425994873
Epoch: 3, Steps: 32 | Train Loss: 7.587 Vali Loss: 46.239 Vali Acc: 0.466 Test Loss: 46.239 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 16.710559129714966
Epoch: 4, Steps: 32 | Train Loss: 11.028 Vali Loss: 41.788 Vali Acc: 0.466 Test Loss: 41.788 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 17.63133454322815
Epoch: 5, Steps: 32 | Train Loss: 2.934 Vali Loss: 39.879 Vali Acc: 0.542 Test Loss: 39.879 Test Acc: 0.542
Validation loss decreased (-0.503593 --> -0.541586).  Saving model ...
Epoch: 6 cost time: 17.22133493423462
Epoch: 6, Steps: 32 | Train Loss: 6.348 Vali Loss: 70.611 Vali Acc: 0.534 Test Loss: 70.611 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 17.278175592422485
Epoch: 7, Steps: 32 | Train Loss: 6.153 Vali Loss: 86.444 Vali Acc: 0.527 Test Loss: 86.444 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 17.57359743118286
Epoch: 8, Steps: 32 | Train Loss: 3.648 Vali Loss: 170.914 Vali Acc: 0.458 Test Loss: 170.914 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 17.174851655960083
Epoch: 9, Steps: 32 | Train Loss: 3.601 Vali Loss: 145.548 Vali Acc: 0.489 Test Loss: 145.548 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 17.400469541549683
Epoch: 10, Steps: 32 | Train Loss: 3.483 Vali Loss: 71.307 Vali Acc: 0.435 Test Loss: 71.307 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 17.172217845916748
Epoch: 11, Steps: 32 | Train Loss: 4.042 Vali Loss: 134.922 Vali Acc: 0.298 Test Loss: 134.922 Test Acc: 0.298
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 17.4140362739563
Epoch: 12, Steps: 32 | Train Loss: 8.675 Vali Loss: 186.341 Vali Acc: 0.420 Test Loss: 186.341 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 17.3502459526062
Epoch: 13, Steps: 32 | Train Loss: 6.773 Vali Loss: 265.321 Vali Acc: 0.496 Test Loss: 265.321 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 17.46039628982544
Epoch: 14, Steps: 32 | Train Loss: 4.538 Vali Loss: 157.696 Vali Acc: 0.489 Test Loss: 157.696 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 17.433912992477417
Epoch: 15, Steps: 32 | Train Loss: 2.047 Vali Loss: 203.362 Vali Acc: 0.496 Test Loss: 203.362 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df256_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 12370309
model size : 64.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df256_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.907056331634521
Epoch: 1, Steps: 32 | Train Loss: 16.221 Vali Loss: 7.723 Vali Acc: 0.359 Test Loss: 7.723 Test Acc: 0.359
Validation loss decreased (inf --> -0.358701).  Saving model ...
Epoch: 2 cost time: 12.45435619354248
Epoch: 2, Steps: 32 | Train Loss: 10.741 Vali Loss: 21.540 Vali Acc: 0.450 Test Loss: 21.540 Test Acc: 0.450
Validation loss decreased (-0.358701 --> -0.450166).  Saving model ...
Epoch: 3 cost time: 13.107479095458984
Epoch: 3, Steps: 32 | Train Loss: 8.446 Vali Loss: 31.737 Vali Acc: 0.511 Test Loss: 31.737 Test Acc: 0.511
Validation loss decreased (-0.450166 --> -0.511133).  Saving model ...
Epoch: 4 cost time: 13.539004564285278
Epoch: 4, Steps: 32 | Train Loss: 10.508 Vali Loss: 17.660 Vali Acc: 0.557 Test Loss: 17.660 Test Acc: 0.557
Validation loss decreased (-0.511133 --> -0.557075).  Saving model ...
Epoch: 5 cost time: 13.268577575683594
Epoch: 5, Steps: 32 | Train Loss: 6.910 Vali Loss: 35.977 Vali Acc: 0.527 Test Loss: 35.977 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.827096223831177
Epoch: 6, Steps: 32 | Train Loss: 6.697 Vali Loss: 56.588 Vali Acc: 0.427 Test Loss: 56.588 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 13.644447088241577
Epoch: 7, Steps: 32 | Train Loss: 2.988 Vali Loss: 68.509 Vali Acc: 0.389 Test Loss: 68.509 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 13.834869146347046
Epoch: 8, Steps: 32 | Train Loss: 4.047 Vali Loss: 71.130 Vali Acc: 0.443 Test Loss: 71.130 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 13.672743797302246
Epoch: 9, Steps: 32 | Train Loss: 9.300 Vali Loss: 93.619 Vali Acc: 0.519 Test Loss: 93.619 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 13.958783864974976
Epoch: 10, Steps: 32 | Train Loss: 2.799 Vali Loss: 124.497 Vali Acc: 0.527 Test Loss: 124.497 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 13.673871994018555
Epoch: 11, Steps: 32 | Train Loss: 3.452 Vali Loss: 62.508 Vali Acc: 0.466 Test Loss: 62.508 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 13.996355056762695
Epoch: 12, Steps: 32 | Train Loss: 2.258 Vali Loss: 74.709 Vali Acc: 0.595 Test Loss: 74.709 Test Acc: 0.595
Validation loss decreased (-0.557075 --> -0.594673).  Saving model ...
Epoch: 13 cost time: 13.540303468704224
Epoch: 13, Steps: 32 | Train Loss: 0.354 Vali Loss: 69.543 Vali Acc: 0.573 Test Loss: 69.543 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 13.89350962638855
Epoch: 14, Steps: 32 | Train Loss: 3.009 Vali Loss: 137.760 Vali Acc: 0.527 Test Loss: 137.760 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 13.745318174362183
Epoch: 15, Steps: 32 | Train Loss: 2.547 Vali Loss: 225.000 Vali Acc: 0.511 Test Loss: 225.000 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 14.131376504898071
Epoch: 16, Steps: 32 | Train Loss: 3.670 Vali Loss: 234.346 Vali Acc: 0.496 Test Loss: 234.346 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 13.766615629196167
Epoch: 17, Steps: 32 | Train Loss: 4.061 Vali Loss: 108.154 Vali Acc: 0.511 Test Loss: 108.154 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 14.203736066818237
Epoch: 18, Steps: 32 | Train Loss: 6.714 Vali Loss: 103.013 Vali Acc: 0.504 Test Loss: 103.013 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 13.571195125579834
Epoch: 19, Steps: 32 | Train Loss: 2.942 Vali Loss: 166.791 Vali Acc: 0.527 Test Loss: 166.791 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 13.962878704071045
Epoch: 20, Steps: 32 | Train Loss: 2.488 Vali Loss: 193.988 Vali Acc: 0.481 Test Loss: 193.988 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 13.361316919326782
Epoch: 21, Steps: 32 | Train Loss: 9.288 Vali Loss: 317.103 Vali Acc: 0.473 Test Loss: 317.103 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 13.888033151626587
Epoch: 22, Steps: 32 | Train Loss: 7.474 Vali Loss: 143.992 Vali Acc: 0.466 Test Loss: 143.992 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df256_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 12370309
model size : 64.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df256_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.273440599441528
Epoch: 1, Steps: 32 | Train Loss: 13.303 Vali Loss: 24.335 Vali Acc: 0.282 Test Loss: 24.335 Test Acc: 0.282
Validation loss decreased (inf --> -0.282199).  Saving model ...
Epoch: 2 cost time: 11.725396156311035
Epoch: 2, Steps: 32 | Train Loss: 13.590 Vali Loss: 6.440 Vali Acc: 0.557 Test Loss: 6.440 Test Acc: 0.557
Validation loss decreased (-0.282199 --> -0.557188).  Saving model ...
Epoch: 3 cost time: 12.246907949447632
Epoch: 3, Steps: 32 | Train Loss: 8.963 Vali Loss: 29.785 Vali Acc: 0.458 Test Loss: 29.785 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.08123779296875
Epoch: 4, Steps: 32 | Train Loss: 6.812 Vali Loss: 35.122 Vali Acc: 0.496 Test Loss: 35.122 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 12.44414210319519
Epoch: 5, Steps: 32 | Train Loss: 5.870 Vali Loss: 73.994 Vali Acc: 0.511 Test Loss: 73.994 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 12.103726863861084
Epoch: 6, Steps: 32 | Train Loss: 6.274 Vali Loss: 74.623 Vali Acc: 0.534 Test Loss: 74.623 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 11.936969518661499
Epoch: 7, Steps: 32 | Train Loss: 8.354 Vali Loss: 63.462 Vali Acc: 0.534 Test Loss: 63.462 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 11.625444650650024
Epoch: 8, Steps: 32 | Train Loss: 2.146 Vali Loss: 31.287 Vali Acc: 0.565 Test Loss: 31.287 Test Acc: 0.565
Validation loss decreased (-0.557188 --> -0.564573).  Saving model ...
Epoch: 9 cost time: 11.908474922180176
Epoch: 9, Steps: 32 | Train Loss: 2.946 Vali Loss: 47.060 Vali Acc: 0.504 Test Loss: 47.060 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 12.037242889404297
Epoch: 10, Steps: 32 | Train Loss: 3.586 Vali Loss: 116.294 Vali Acc: 0.290 Test Loss: 116.294 Test Acc: 0.290
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 12.070777654647827
Epoch: 11, Steps: 32 | Train Loss: 17.071 Vali Loss: 51.031 Vali Acc: 0.511 Test Loss: 51.031 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 11.603169679641724
Epoch: 12, Steps: 32 | Train Loss: 9.045 Vali Loss: 86.922 Vali Acc: 0.573 Test Loss: 86.922 Test Acc: 0.573
Validation loss decreased (-0.564573 --> -0.571650).  Saving model ...
Epoch: 13 cost time: 12.342211246490479
Epoch: 13, Steps: 32 | Train Loss: 0.861 Vali Loss: 101.525 Vali Acc: 0.595 Test Loss: 101.525 Test Acc: 0.595
Validation loss decreased (-0.571650 --> -0.594405).  Saving model ...
Epoch: 14 cost time: 11.897468566894531
Epoch: 14, Steps: 32 | Train Loss: 2.451 Vali Loss: 74.402 Vali Acc: 0.496 Test Loss: 74.402 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 11.633952856063843
Epoch: 15, Steps: 32 | Train Loss: 0.430 Vali Loss: 102.281 Vali Acc: 0.511 Test Loss: 102.281 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 11.79194688796997
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 86.787 Vali Acc: 0.466 Test Loss: 86.787 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 11.753634691238403
Epoch: 17, Steps: 32 | Train Loss: 7.477 Vali Loss: 97.984 Vali Acc: 0.466 Test Loss: 97.984 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 11.731573820114136
Epoch: 18, Steps: 32 | Train Loss: 23.675 Vali Loss: 228.182 Vali Acc: 0.542 Test Loss: 228.182 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 11.845696210861206
Epoch: 19, Steps: 32 | Train Loss: 3.237 Vali Loss: 180.002 Vali Acc: 0.511 Test Loss: 180.002 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 11.890174627304077
Epoch: 20, Steps: 32 | Train Loss: 3.256 Vali Loss: 261.893 Vali Acc: 0.534 Test Loss: 261.893 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 11.510112047195435
Epoch: 21, Steps: 32 | Train Loss: 7.210 Vali Loss: 226.154 Vali Acc: 0.534 Test Loss: 226.154 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 12.395111560821533
Epoch: 22, Steps: 32 | Train Loss: 0.809 Vali Loss: 112.159 Vali Acc: 0.489 Test Loss: 112.159 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 11.943609476089478
Epoch: 23, Steps: 32 | Train Loss: 0.008 Vali Loss: 189.459 Vali Acc: 0.527 Test Loss: 189.459 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df256_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 12370309
model size : 64.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         8992                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df128_ma8992_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 174.54879331588745
Epoch: 1, Steps: 32 | Train Loss: 14.128 Vali Loss: 20.827 Vali Acc: 0.282 Test Loss: 20.827 Test Acc: 0.282
Validation loss decreased (inf --> -0.282234).  Saving model ...
Epoch: 2 cost time: 188.5951042175293
Epoch: 2, Steps: 32 | Train Loss: 13.259 Vali Loss: 24.360 Vali Acc: 0.344 Test Loss: 24.360 Test Acc: 0.344
Validation loss decreased (-0.282234 --> -0.343268).  Saving model ...
Epoch: 3 cost time: 209.25508522987366
Epoch: 3, Steps: 32 | Train Loss: 9.259 Vali Loss: 42.903 Vali Acc: 0.496 Test Loss: 42.903 Test Acc: 0.496
Validation loss decreased (-0.343268 --> -0.495754).  Saving model ...
Epoch: 4 cost time: 211.22514605522156
Epoch: 4, Steps: 32 | Train Loss: 7.056 Vali Loss: 40.561 Vali Acc: 0.504 Test Loss: 40.561 Test Acc: 0.504
Validation loss decreased (-0.495754 --> -0.503411).  Saving model ...
Epoch: 5 cost time: 229.20679450035095
Epoch: 5, Steps: 32 | Train Loss: 5.784 Vali Loss: 63.038 Vali Acc: 0.336 Test Loss: 63.038 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 226.25730514526367
Epoch: 6, Steps: 32 | Train Loss: 15.997 Vali Loss: 139.997 Vali Acc: 0.260 Test Loss: 139.997 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 219.37644600868225
Epoch: 7, Steps: 32 | Train Loss: 25.938 Vali Loss: 79.465 Vali Acc: 0.450 Test Loss: 79.465 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 229.17471480369568
Epoch: 8, Steps: 32 | Train Loss: 3.387 Vali Loss: 72.038 Vali Acc: 0.511 Test Loss: 72.038 Test Acc: 0.511
Validation loss decreased (-0.503411 --> -0.510730).  Saving model ...
Epoch: 9 cost time: 231.81408190727234
Epoch: 9, Steps: 32 | Train Loss: 0.904 Vali Loss: 108.360 Vali Acc: 0.366 Test Loss: 108.360 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 221.87762999534607
Epoch: 10, Steps: 32 | Train Loss: 11.715 Vali Loss: 139.627 Vali Acc: 0.534 Test Loss: 139.627 Test Acc: 0.534
Validation loss decreased (-0.510730 --> -0.532955).  Saving model ...
Epoch: 11 cost time: 221.33336353302002
Epoch: 11, Steps: 32 | Train Loss: 13.629 Vali Loss: 183.094 Vali Acc: 0.321 Test Loss: 183.094 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 226.4729118347168
Epoch: 12, Steps: 32 | Train Loss: 9.334 Vali Loss: 113.612 Vali Acc: 0.519 Test Loss: 113.612 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 228.43191719055176
Epoch: 13, Steps: 32 | Train Loss: 0.310 Vali Loss: 225.088 Vali Acc: 0.519 Test Loss: 225.088 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 227.52543377876282
Epoch: 14, Steps: 32 | Train Loss: 3.372 Vali Loss: 116.307 Vali Acc: 0.466 Test Loss: 116.307 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 233.87029838562012
Epoch: 15, Steps: 32 | Train Loss: 0.034 Vali Loss: 196.092 Vali Acc: 0.511 Test Loss: 196.092 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 227.08965945243835
Epoch: 16, Steps: 32 | Train Loss: 7.728 Vali Loss: 172.025 Vali Acc: 0.412 Test Loss: 172.025 Test Acc: 0.412
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 226.5351686477661
Epoch: 17, Steps: 32 | Train Loss: 8.302 Vali Loss: 184.062 Vali Acc: 0.412 Test Loss: 184.062 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 229.00171375274658
Epoch: 18, Steps: 32 | Train Loss: 7.852 Vali Loss: 203.318 Vali Acc: 0.550 Test Loss: 203.318 Test Acc: 0.550
Validation loss decreased (-0.532955 --> -0.547585).  Saving model ...
Epoch: 19 cost time: 227.81573724746704
Epoch: 19, Steps: 32 | Train Loss: 0.445 Vali Loss: 271.133 Vali Acc: 0.450 Test Loss: 271.133 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 227.44384360313416
Epoch: 20, Steps: 32 | Train Loss: 17.205 Vali Loss: 231.147 Vali Acc: 0.519 Test Loss: 231.147 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 229.29423928260803
Epoch: 21, Steps: 32 | Train Loss: 1.784 Vali Loss: 190.075 Vali Acc: 0.550 Test Loss: 190.075 Test Acc: 0.550
Validation loss decreased (-0.547585 --> -0.547718).  Saving model ...
Epoch: 22 cost time: 228.8095943927765
Epoch: 22, Steps: 32 | Train Loss: 4.289 Vali Loss: 184.327 Vali Acc: 0.588 Test Loss: 184.327 Test Acc: 0.588
Validation loss decreased (-0.547718 --> -0.585943).  Saving model ...
Epoch: 23 cost time: 230.26955699920654
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 275.633 Vali Acc: 0.557 Test Loss: 275.633 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 229.13623356819153
Epoch: 24, Steps: 32 | Train Loss: 1.155 Vali Loss: 243.674 Vali Acc: 0.588 Test Loss: 243.674 Test Acc: 0.588
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 231.01779651641846
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 302.026 Vali Acc: 0.557 Test Loss: 302.026 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 229.22649788856506
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 304.271 Vali Acc: 0.557 Test Loss: 304.271 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 229.5978181362152
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 304.351 Vali Acc: 0.557 Test Loss: 304.351 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 228.34382963180542
Epoch: 28, Steps: 32 | Train Loss: 0.000 Vali Loss: 304.207 Vali Acc: 0.557 Test Loss: 304.207 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 229.02766728401184
Epoch: 29, Steps: 32 | Train Loss: 0.000 Vali Loss: 304.181 Vali Acc: 0.557 Test Loss: 304.181 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 230.44717741012573
Epoch: 30, Steps: 32 | Train Loss: 0.000 Vali Loss: 304.181 Vali Acc: 0.557 Test Loss: 304.181 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 230.0025656223297
Epoch: 31, Steps: 32 | Train Loss: 0.000 Vali Loss: 304.181 Vali Acc: 0.557 Test Loss: 304.181 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 230.27495527267456
Epoch: 32, Steps: 32 | Train Loss: 0.000 Vali Loss: 304.181 Vali Acc: 0.557 Test Loss: 304.181 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df128_ma8992_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 12272005
model size : 64.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         7194                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df128_ma7194_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 140.7366292476654
Epoch: 1, Steps: 32 | Train Loss: 14.941 Vali Loss: 10.686 Vali Acc: 0.527 Test Loss: 10.686 Test Acc: 0.527
Validation loss decreased (inf --> -0.526611).  Saving model ...
Epoch: 2 cost time: 147.67795133590698
Epoch: 2, Steps: 32 | Train Loss: 9.662 Vali Loss: 17.319 Vali Acc: 0.466 Test Loss: 17.319 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 170.9189112186432
Epoch: 3, Steps: 32 | Train Loss: 8.807 Vali Loss: 29.665 Vali Acc: 0.550 Test Loss: 29.665 Test Acc: 0.550
Validation loss decreased (-0.526611 --> -0.549322).  Saving model ...
Epoch: 4 cost time: 164.87183594703674
Epoch: 4, Steps: 32 | Train Loss: 13.568 Vali Loss: 81.767 Vali Acc: 0.542 Test Loss: 81.767 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 175.4749960899353
Epoch: 5, Steps: 32 | Train Loss: 13.764 Vali Loss: 71.713 Vali Acc: 0.557 Test Loss: 71.713 Test Acc: 0.557
Validation loss decreased (-0.549322 --> -0.556535).  Saving model ...
Epoch: 6 cost time: 179.65805506706238
Epoch: 6, Steps: 32 | Train Loss: 5.660 Vali Loss: 73.344 Vali Acc: 0.313 Test Loss: 73.344 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 175.4837327003479
Epoch: 7, Steps: 32 | Train Loss: 7.850 Vali Loss: 64.044 Vali Acc: 0.573 Test Loss: 64.044 Test Acc: 0.573
Validation loss decreased (-0.556535 --> -0.571879).  Saving model ...
Epoch: 8 cost time: 183.6624195575714
Epoch: 8, Steps: 32 | Train Loss: 1.009 Vali Loss: 80.753 Vali Acc: 0.534 Test Loss: 80.753 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 184.11131882667542
Epoch: 9, Steps: 32 | Train Loss: 0.662 Vali Loss: 70.366 Vali Acc: 0.550 Test Loss: 70.366 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 186.58172512054443
Epoch: 10, Steps: 32 | Train Loss: 2.734 Vali Loss: 88.324 Vali Acc: 0.351 Test Loss: 88.324 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 180.96670818328857
Epoch: 11, Steps: 32 | Train Loss: 7.594 Vali Loss: 115.708 Vali Acc: 0.527 Test Loss: 115.708 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 188.09120988845825
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 84.382 Vali Acc: 0.542 Test Loss: 84.382 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 186.21859073638916
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 83.289 Vali Acc: 0.542 Test Loss: 83.289 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 186.64654111862183
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 83.249 Vali Acc: 0.542 Test Loss: 83.249 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 185.44023489952087
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 83.247 Vali Acc: 0.542 Test Loss: 83.247 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 187.7561390399933
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 83.247 Vali Acc: 0.542 Test Loss: 83.247 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 186.69305872917175
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 83.247 Vali Acc: 0.542 Test Loss: 83.247 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df128_ma7194_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 12272005
model size : 64.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5396                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df128_ma5396_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 94.43766665458679
Epoch: 1, Steps: 32 | Train Loss: 13.314 Vali Loss: 18.611 Vali Acc: 0.458 Test Loss: 18.611 Test Acc: 0.458
Validation loss decreased (inf --> -0.457829).  Saving model ...
Epoch: 2 cost time: 104.3667585849762
Epoch: 2, Steps: 32 | Train Loss: 12.497 Vali Loss: 28.855 Vali Acc: 0.511 Test Loss: 28.855 Test Acc: 0.511
Validation loss decreased (-0.457829 --> -0.511162).  Saving model ...
Epoch: 3 cost time: 117.05105495452881
Epoch: 3, Steps: 32 | Train Loss: 4.862 Vali Loss: 25.110 Vali Acc: 0.405 Test Loss: 25.110 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 121.59344816207886
Epoch: 4, Steps: 32 | Train Loss: 11.087 Vali Loss: 63.105 Vali Acc: 0.252 Test Loss: 63.105 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 127.02407574653625
Epoch: 5, Steps: 32 | Train Loss: 12.184 Vali Loss: 64.508 Vali Acc: 0.328 Test Loss: 64.508 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 129.60342502593994
Epoch: 6, Steps: 32 | Train Loss: 12.434 Vali Loss: 65.990 Vali Acc: 0.542 Test Loss: 65.990 Test Acc: 0.542
Validation loss decreased (-0.511162 --> -0.541325).  Saving model ...
Epoch: 7 cost time: 133.4954125881195
Epoch: 7, Steps: 32 | Train Loss: 3.466 Vali Loss: 97.972 Vali Acc: 0.359 Test Loss: 97.972 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 128.7383692264557
Epoch: 8, Steps: 32 | Train Loss: 4.166 Vali Loss: 130.275 Vali Acc: 0.519 Test Loss: 130.275 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 128.65657353401184
Epoch: 9, Steps: 32 | Train Loss: 7.255 Vali Loss: 71.347 Vali Acc: 0.397 Test Loss: 71.347 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 133.15079355239868
Epoch: 10, Steps: 32 | Train Loss: 0.533 Vali Loss: 85.464 Vali Acc: 0.511 Test Loss: 85.464 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 139.04849410057068
Epoch: 11, Steps: 32 | Train Loss: 1.068 Vali Loss: 107.764 Vali Acc: 0.397 Test Loss: 107.764 Test Acc: 0.397
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 130.32328271865845
Epoch: 12, Steps: 32 | Train Loss: 2.356 Vali Loss: 107.854 Vali Acc: 0.427 Test Loss: 107.854 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 131.40583729743958
Epoch: 13, Steps: 32 | Train Loss: 2.591 Vali Loss: 180.261 Vali Acc: 0.374 Test Loss: 180.261 Test Acc: 0.374
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 132.0696907043457
Epoch: 14, Steps: 32 | Train Loss: 3.282 Vali Loss: 129.237 Vali Acc: 0.519 Test Loss: 129.237 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 130.628408908844
Epoch: 15, Steps: 32 | Train Loss: 2.015 Vali Loss: 164.114 Vali Acc: 0.351 Test Loss: 164.114 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 130.09932827949524
Epoch: 16, Steps: 32 | Train Loss: 3.327 Vali Loss: 135.215 Vali Acc: 0.359 Test Loss: 135.215 Test Acc: 0.359
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df128_ma5396_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 12272005
model size : 64.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3597                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df128_ma3597_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 68.09157538414001
Epoch: 1, Steps: 32 | Train Loss: 16.209 Vali Loss: 26.928 Vali Acc: 0.214 Test Loss: 26.928 Test Acc: 0.214
Validation loss decreased (inf --> -0.213471).  Saving model ...
Epoch: 2 cost time: 74.40346503257751
Epoch: 2, Steps: 32 | Train Loss: 11.492 Vali Loss: 13.511 Vali Acc: 0.420 Test Loss: 13.511 Test Acc: 0.420
Validation loss decreased (-0.213471 --> -0.419712).  Saving model ...
Epoch: 3 cost time: 82.56570959091187
Epoch: 3, Steps: 32 | Train Loss: 8.075 Vali Loss: 38.599 Vali Acc: 0.252 Test Loss: 38.599 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 85.38793325424194
Epoch: 4, Steps: 32 | Train Loss: 10.644 Vali Loss: 31.624 Vali Acc: 0.351 Test Loss: 31.624 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 89.47337913513184
Epoch: 5, Steps: 32 | Train Loss: 3.734 Vali Loss: 70.201 Vali Acc: 0.542 Test Loss: 70.201 Test Acc: 0.542
Validation loss decreased (-0.419712 --> -0.541283).  Saving model ...
Epoch: 6 cost time: 91.55606126785278
Epoch: 6, Steps: 32 | Train Loss: 12.334 Vali Loss: 56.665 Vali Acc: 0.473 Test Loss: 56.665 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 92.00245451927185
Epoch: 7, Steps: 32 | Train Loss: 2.842 Vali Loss: 131.873 Vali Acc: 0.511 Test Loss: 131.873 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 92.3139591217041
Epoch: 8, Steps: 32 | Train Loss: 5.061 Vali Loss: 69.240 Vali Acc: 0.466 Test Loss: 69.240 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 90.69077610969543
Epoch: 9, Steps: 32 | Train Loss: 5.344 Vali Loss: 84.008 Vali Acc: 0.275 Test Loss: 84.008 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 94.18494892120361
Epoch: 10, Steps: 32 | Train Loss: 5.058 Vali Loss: 111.480 Vali Acc: 0.527 Test Loss: 111.480 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 93.72488403320312
Epoch: 11, Steps: 32 | Train Loss: 4.937 Vali Loss: 146.496 Vali Acc: 0.511 Test Loss: 146.496 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 93.650794506073
Epoch: 12, Steps: 32 | Train Loss: 0.662 Vali Loss: 129.980 Vali Acc: 0.588 Test Loss: 129.980 Test Acc: 0.588
Validation loss decreased (-0.541283 --> -0.586486).  Saving model ...
Epoch: 13 cost time: 91.9998824596405
Epoch: 13, Steps: 32 | Train Loss: 3.687 Vali Loss: 132.187 Vali Acc: 0.550 Test Loss: 132.187 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 94.587482213974
Epoch: 14, Steps: 32 | Train Loss: 0.743 Vali Loss: 95.460 Vali Acc: 0.527 Test Loss: 95.460 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 94.13056564331055
Epoch: 15, Steps: 32 | Train Loss: 0.907 Vali Loss: 165.077 Vali Acc: 0.511 Test Loss: 165.077 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 90.4756588935852
Epoch: 16, Steps: 32 | Train Loss: 11.175 Vali Loss: 150.526 Vali Acc: 0.397 Test Loss: 150.526 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 93.67277073860168
Epoch: 17, Steps: 32 | Train Loss: 7.701 Vali Loss: 166.994 Vali Acc: 0.359 Test Loss: 166.994 Test Acc: 0.359
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 94.08339262008667
Epoch: 18, Steps: 32 | Train Loss: 4.605 Vali Loss: 233.433 Vali Acc: 0.313 Test Loss: 233.433 Test Acc: 0.313
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 92.71544599533081
Epoch: 19, Steps: 32 | Train Loss: 1.477 Vali Loss: 147.397 Vali Acc: 0.344 Test Loss: 147.397 Test Acc: 0.344
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 92.99084877967834
Epoch: 20, Steps: 32 | Train Loss: 3.258 Vali Loss: 194.840 Vali Acc: 0.397 Test Loss: 194.840 Test Acc: 0.397
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 95.37838912010193
Epoch: 21, Steps: 32 | Train Loss: 2.579 Vali Loss: 166.895 Vali Acc: 0.344 Test Loss: 166.895 Test Acc: 0.344
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 94.6536865234375
Epoch: 22, Steps: 32 | Train Loss: 1.248 Vali Loss: 208.677 Vali Acc: 0.458 Test Loss: 208.677 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df128_ma3597_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 12272005
model size : 64.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1799                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df128_ma1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 40.30585241317749
Epoch: 1, Steps: 32 | Train Loss: 12.063 Vali Loss: 36.125 Vali Acc: 0.099 Test Loss: 36.125 Test Acc: 0.099
Validation loss decreased (inf --> -0.098875).  Saving model ...
Epoch: 2 cost time: 40.827879667282104
Epoch: 2, Steps: 32 | Train Loss: 7.865 Vali Loss: 22.073 Vali Acc: 0.382 Test Loss: 22.073 Test Acc: 0.382
Validation loss decreased (-0.098875 --> -0.381459).  Saving model ...
Epoch: 3 cost time: 45.98247480392456
Epoch: 3, Steps: 32 | Train Loss: 10.857 Vali Loss: 44.771 Vali Acc: 0.344 Test Loss: 44.771 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 49.2467257976532
Epoch: 4, Steps: 32 | Train Loss: 11.063 Vali Loss: 42.970 Vali Acc: 0.481 Test Loss: 42.970 Test Acc: 0.481
Validation loss decreased (-0.381459 --> -0.480486).  Saving model ...
Epoch: 5 cost time: 50.682708740234375
Epoch: 5, Steps: 32 | Train Loss: 12.833 Vali Loss: 83.443 Vali Acc: 0.573 Test Loss: 83.443 Test Acc: 0.573
Validation loss decreased (-0.480486 --> -0.571685).  Saving model ...
Epoch: 6 cost time: 51.08600616455078
Epoch: 6, Steps: 32 | Train Loss: 7.022 Vali Loss: 81.828 Vali Acc: 0.397 Test Loss: 81.828 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 51.66184139251709
Epoch: 7, Steps: 32 | Train Loss: 3.769 Vali Loss: 63.944 Vali Acc: 0.565 Test Loss: 63.944 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 53.1748480796814
Epoch: 8, Steps: 32 | Train Loss: 0.485 Vali Loss: 123.380 Vali Acc: 0.496 Test Loss: 123.380 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 50.60540175437927
Epoch: 9, Steps: 32 | Train Loss: 4.391 Vali Loss: 49.313 Vali Acc: 0.565 Test Loss: 49.313 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 51.4617280960083
Epoch: 10, Steps: 32 | Train Loss: 2.069 Vali Loss: 113.095 Vali Acc: 0.534 Test Loss: 113.095 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 51.66947150230408
Epoch: 11, Steps: 32 | Train Loss: 2.911 Vali Loss: 135.955 Vali Acc: 0.534 Test Loss: 135.955 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 51.22453951835632
Epoch: 12, Steps: 32 | Train Loss: 10.525 Vali Loss: 121.855 Vali Acc: 0.481 Test Loss: 121.855 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 51.34221696853638
Epoch: 13, Steps: 32 | Train Loss: 10.383 Vali Loss: 118.997 Vali Acc: 0.573 Test Loss: 118.997 Test Acc: 0.573
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 52.17608642578125
Epoch: 14, Steps: 32 | Train Loss: 6.547 Vali Loss: 222.423 Vali Acc: 0.534 Test Loss: 222.423 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 53.38882660865784
Epoch: 15, Steps: 32 | Train Loss: 1.561 Vali Loss: 160.838 Vali Acc: 0.542 Test Loss: 160.838 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df128_ma1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 12272005
model size : 64.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df128_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 26.04503870010376
Epoch: 1, Steps: 32 | Train Loss: 18.263 Vali Loss: 33.782 Vali Acc: 0.221 Test Loss: 33.782 Test Acc: 0.221
Validation loss decreased (inf --> -0.221036).  Saving model ...
Epoch: 2 cost time: 26.615612745285034
Epoch: 2, Steps: 32 | Train Loss: 11.459 Vali Loss: 31.156 Vali Acc: 0.397 Test Loss: 31.156 Test Acc: 0.397
Validation loss decreased (-0.221036 --> -0.396635).  Saving model ...
Epoch: 3 cost time: 27.874340057373047
Epoch: 3, Steps: 32 | Train Loss: 11.893 Vali Loss: 32.956 Vali Acc: 0.443 Test Loss: 32.956 Test Acc: 0.443
Validation loss decreased (-0.396635 --> -0.442419).  Saving model ...
Epoch: 4 cost time: 30.840490102767944
Epoch: 4, Steps: 32 | Train Loss: 15.924 Vali Loss: 55.300 Vali Acc: 0.511 Test Loss: 55.300 Test Acc: 0.511
Validation loss decreased (-0.442419 --> -0.510897).  Saving model ...
Epoch: 5 cost time: 31.199798345565796
Epoch: 5, Steps: 32 | Train Loss: 5.277 Vali Loss: 111.354 Vali Acc: 0.527 Test Loss: 111.354 Test Acc: 0.527
Validation loss decreased (-0.510897 --> -0.525604).  Saving model ...
Epoch: 6 cost time: 31.26409912109375
Epoch: 6, Steps: 32 | Train Loss: 5.277 Vali Loss: 94.713 Vali Acc: 0.527 Test Loss: 94.713 Test Acc: 0.527
Validation loss decreased (-0.525604 --> -0.525770).  Saving model ...
Epoch: 7 cost time: 30.987983226776123
Epoch: 7, Steps: 32 | Train Loss: 8.369 Vali Loss: 79.758 Vali Acc: 0.420 Test Loss: 79.758 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 31.602919816970825
Epoch: 8, Steps: 32 | Train Loss: 2.446 Vali Loss: 106.741 Vali Acc: 0.550 Test Loss: 106.741 Test Acc: 0.550
Validation loss decreased (-0.525770 --> -0.548551).  Saving model ...
Epoch: 9 cost time: 30.695673942565918
Epoch: 9, Steps: 32 | Train Loss: 3.706 Vali Loss: 107.731 Vali Acc: 0.427 Test Loss: 107.731 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 29.95417070388794
Epoch: 10, Steps: 32 | Train Loss: 19.579 Vali Loss: 93.348 Vali Acc: 0.389 Test Loss: 93.348 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 31.976039171218872
Epoch: 11, Steps: 32 | Train Loss: 6.147 Vali Loss: 135.750 Vali Acc: 0.550 Test Loss: 135.750 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 31.239107370376587
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 136.531 Vali Acc: 0.542 Test Loss: 136.531 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 31.673813581466675
Epoch: 13, Steps: 32 | Train Loss: 0.049 Vali Loss: 139.888 Vali Acc: 0.527 Test Loss: 139.888 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 32.24842095375061
Epoch: 14, Steps: 32 | Train Loss: 0.301 Vali Loss: 135.208 Vali Acc: 0.550 Test Loss: 135.208 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 31.33693528175354
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 136.114 Vali Acc: 0.550 Test Loss: 136.114 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 32.126030683517456
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 136.163 Vali Acc: 0.550 Test Loss: 136.163 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 31.57507872581482
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 136.163 Vali Acc: 0.550 Test Loss: 136.163 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 31.563154697418213
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 136.163 Vali Acc: 0.550 Test Loss: 136.163 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df128_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 12272005
model size : 64.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         540                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df128_ma540_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 20.550570726394653
Epoch: 1, Steps: 32 | Train Loss: 16.645 Vali Loss: 23.040 Vali Acc: 0.237 Test Loss: 23.040 Test Acc: 0.237
Validation loss decreased (inf --> -0.236411).  Saving model ...
Epoch: 2 cost time: 19.55658507347107
Epoch: 2, Steps: 32 | Train Loss: 7.369 Vali Loss: 31.663 Vali Acc: 0.489 Test Loss: 31.663 Test Acc: 0.489
Validation loss decreased (-0.236411 --> -0.488233).  Saving model ...
Epoch: 3 cost time: 21.572000980377197
Epoch: 3, Steps: 32 | Train Loss: 6.309 Vali Loss: 27.220 Vali Acc: 0.313 Test Loss: 27.220 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 22.678064584732056
Epoch: 4, Steps: 32 | Train Loss: 2.720 Vali Loss: 28.848 Vali Acc: 0.420 Test Loss: 28.848 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 22.714956998825073
Epoch: 5, Steps: 32 | Train Loss: 5.067 Vali Loss: 77.618 Vali Acc: 0.481 Test Loss: 77.618 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 22.746583223342896
Epoch: 6, Steps: 32 | Train Loss: 4.585 Vali Loss: 63.932 Vali Acc: 0.412 Test Loss: 63.932 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 22.7939510345459
Epoch: 7, Steps: 32 | Train Loss: 5.221 Vali Loss: 61.543 Vali Acc: 0.519 Test Loss: 61.543 Test Acc: 0.519
Validation loss decreased (-0.488233 --> -0.518469).  Saving model ...
Epoch: 8 cost time: 23.240086793899536
Epoch: 8, Steps: 32 | Train Loss: 8.162 Vali Loss: 103.981 Vali Acc: 0.473 Test Loss: 103.981 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 22.26471519470215
Epoch: 9, Steps: 32 | Train Loss: 7.307 Vali Loss: 116.879 Vali Acc: 0.496 Test Loss: 116.879 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 23.112598419189453
Epoch: 10, Steps: 32 | Train Loss: 1.529 Vali Loss: 100.976 Vali Acc: 0.519 Test Loss: 100.976 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 23.15263342857361
Epoch: 11, Steps: 32 | Train Loss: 5.035 Vali Loss: 117.974 Vali Acc: 0.496 Test Loss: 117.974 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 22.672646522521973
Epoch: 12, Steps: 32 | Train Loss: 2.115 Vali Loss: 145.552 Vali Acc: 0.519 Test Loss: 145.552 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 22.791966199874878
Epoch: 13, Steps: 32 | Train Loss: 0.617 Vali Loss: 167.389 Vali Acc: 0.466 Test Loss: 167.389 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 23.014362335205078
Epoch: 14, Steps: 32 | Train Loss: 3.835 Vali Loss: 205.919 Vali Acc: 0.527 Test Loss: 205.919 Test Acc: 0.527
Validation loss decreased (-0.518469 --> -0.524658).  Saving model ...
Epoch: 15 cost time: 22.9791579246521
Epoch: 15, Steps: 32 | Train Loss: 3.409 Vali Loss: 131.516 Vali Acc: 0.458 Test Loss: 131.516 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 22.657643795013428
Epoch: 16, Steps: 32 | Train Loss: 2.198 Vali Loss: 199.887 Vali Acc: 0.519 Test Loss: 199.887 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 23.365408420562744
Epoch: 17, Steps: 32 | Train Loss: 0.586 Vali Loss: 186.972 Vali Acc: 0.519 Test Loss: 186.972 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 23.116238832473755
Epoch: 18, Steps: 32 | Train Loss: 0.631 Vali Loss: 171.702 Vali Acc: 0.397 Test Loss: 171.702 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 22.677631616592407
Epoch: 19, Steps: 32 | Train Loss: 0.745 Vali Loss: 148.422 Vali Acc: 0.443 Test Loss: 148.422 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 23.311498880386353
Epoch: 20, Steps: 32 | Train Loss: 1.196 Vali Loss: 181.639 Vali Acc: 0.374 Test Loss: 181.639 Test Acc: 0.374
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 23.345268964767456
Epoch: 21, Steps: 32 | Train Loss: 2.648 Vali Loss: 211.638 Vali Acc: 0.511 Test Loss: 211.638 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 22.8996102809906
Epoch: 22, Steps: 32 | Train Loss: 4.179 Vali Loss: 278.033 Vali Acc: 0.504 Test Loss: 278.033 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 22.921653509140015
Epoch: 23, Steps: 32 | Train Loss: 0.935 Vali Loss: 350.018 Vali Acc: 0.504 Test Loss: 350.018 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 23.61776876449585
Epoch: 24, Steps: 32 | Train Loss: 4.591 Vali Loss: 370.475 Vali Acc: 0.504 Test Loss: 370.475 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df128_ma540_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 12272005
model size : 64.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df128_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 18.311145067214966
Epoch: 1, Steps: 32 | Train Loss: 15.324 Vali Loss: 15.460 Vali Acc: 0.267 Test Loss: 15.460 Test Acc: 0.267
Validation loss decreased (inf --> -0.267021).  Saving model ...
Epoch: 2 cost time: 16.808242559432983
Epoch: 2, Steps: 32 | Train Loss: 9.364 Vali Loss: 31.392 Vali Acc: 0.489 Test Loss: 31.392 Test Acc: 0.489
Validation loss decreased (-0.267021 --> -0.488236).  Saving model ...
Epoch: 3 cost time: 18.59110403060913
Epoch: 3, Steps: 32 | Train Loss: 5.811 Vali Loss: 17.367 Vali Acc: 0.473 Test Loss: 17.367 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 18.85316562652588
Epoch: 4, Steps: 32 | Train Loss: 14.008 Vali Loss: 54.821 Vali Acc: 0.481 Test Loss: 54.821 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 19.40274667739868
Epoch: 5, Steps: 32 | Train Loss: 4.847 Vali Loss: 48.357 Vali Acc: 0.504 Test Loss: 48.357 Test Acc: 0.504
Validation loss decreased (-0.488236 --> -0.503333).  Saving model ...
Epoch: 6 cost time: 19.293157815933228
Epoch: 6, Steps: 32 | Train Loss: 3.004 Vali Loss: 63.790 Vali Acc: 0.427 Test Loss: 63.790 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 19.764156579971313
Epoch: 7, Steps: 32 | Train Loss: 5.656 Vali Loss: 102.082 Vali Acc: 0.374 Test Loss: 102.082 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 20.170552492141724
Epoch: 8, Steps: 32 | Train Loss: 2.997 Vali Loss: 91.670 Vali Acc: 0.519 Test Loss: 91.670 Test Acc: 0.519
Validation loss decreased (-0.503333 --> -0.518167).  Saving model ...
Epoch: 9 cost time: 19.302327394485474
Epoch: 9, Steps: 32 | Train Loss: 0.160 Vali Loss: 116.929 Vali Acc: 0.527 Test Loss: 116.929 Test Acc: 0.527
Validation loss decreased (-0.518167 --> -0.525548).  Saving model ...
Epoch: 10 cost time: 19.261553287506104
Epoch: 10, Steps: 32 | Train Loss: 5.531 Vali Loss: 155.040 Vali Acc: 0.504 Test Loss: 155.040 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 19.933420658111572
Epoch: 11, Steps: 32 | Train Loss: 3.989 Vali Loss: 138.296 Vali Acc: 0.420 Test Loss: 138.296 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 19.291643142700195
Epoch: 12, Steps: 32 | Train Loss: 18.820 Vali Loss: 111.220 Vali Acc: 0.397 Test Loss: 111.220 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 20.034708976745605
Epoch: 13, Steps: 32 | Train Loss: 8.766 Vali Loss: 142.928 Vali Acc: 0.466 Test Loss: 142.928 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 18.744075775146484
Epoch: 14, Steps: 32 | Train Loss: 11.844 Vali Loss: 154.110 Vali Acc: 0.527 Test Loss: 154.110 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 20.082124710083008
Epoch: 15, Steps: 32 | Train Loss: 5.999 Vali Loss: 290.780 Vali Acc: 0.489 Test Loss: 290.780 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 19.535823583602905
Epoch: 16, Steps: 32 | Train Loss: 5.013 Vali Loss: 168.600 Vali Acc: 0.496 Test Loss: 168.600 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 18.66242003440857
Epoch: 17, Steps: 32 | Train Loss: 5.947 Vali Loss: 454.614 Vali Acc: 0.458 Test Loss: 454.614 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 19.067580223083496
Epoch: 18, Steps: 32 | Train Loss: 4.292 Vali Loss: 338.719 Vali Acc: 0.489 Test Loss: 338.719 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 19.919826984405518
Epoch: 19, Steps: 32 | Train Loss: 1.037 Vali Loss: 356.792 Vali Acc: 0.489 Test Loss: 356.792 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df128_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 12272005
model size : 64.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df128_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.485844373703003
Epoch: 1, Steps: 32 | Train Loss: 11.436 Vali Loss: 33.472 Vali Acc: 0.252 Test Loss: 33.472 Test Acc: 0.252
Validation loss decreased (inf --> -0.251574).  Saving model ...
Epoch: 2 cost time: 13.71190333366394
Epoch: 2, Steps: 32 | Train Loss: 9.865 Vali Loss: 26.361 Vali Acc: 0.206 Test Loss: 26.361 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.755218029022217
Epoch: 3, Steps: 32 | Train Loss: 12.212 Vali Loss: 51.113 Vali Acc: 0.267 Test Loss: 51.113 Test Acc: 0.267
Validation loss decreased (-0.251574 --> -0.266664).  Saving model ...
Epoch: 4 cost time: 15.501059532165527
Epoch: 4, Steps: 32 | Train Loss: 13.394 Vali Loss: 19.201 Vali Acc: 0.519 Test Loss: 19.201 Test Acc: 0.519
Validation loss decreased (-0.266664 --> -0.518892).  Saving model ...
Epoch: 5 cost time: 15.871487140655518
Epoch: 5, Steps: 32 | Train Loss: 5.003 Vali Loss: 61.583 Vali Acc: 0.443 Test Loss: 61.583 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 15.54099988937378
Epoch: 6, Steps: 32 | Train Loss: 12.977 Vali Loss: 69.810 Vali Acc: 0.282 Test Loss: 69.810 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 15.325647830963135
Epoch: 7, Steps: 32 | Train Loss: 10.723 Vali Loss: 64.797 Vali Acc: 0.489 Test Loss: 64.797 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 17.085170030593872
Epoch: 8, Steps: 32 | Train Loss: 3.901 Vali Loss: 65.724 Vali Acc: 0.519 Test Loss: 65.724 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 16.571470975875854
Epoch: 9, Steps: 32 | Train Loss: 2.455 Vali Loss: 48.218 Vali Acc: 0.565 Test Loss: 48.218 Test Acc: 0.565
Validation loss decreased (-0.518892 --> -0.564403).  Saving model ...
Epoch: 10 cost time: 15.637421369552612
Epoch: 10, Steps: 32 | Train Loss: 6.940 Vali Loss: 58.237 Vali Acc: 0.542 Test Loss: 58.237 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 15.919388055801392
Epoch: 11, Steps: 32 | Train Loss: 13.131 Vali Loss: 67.819 Vali Acc: 0.527 Test Loss: 67.819 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 15.912487268447876
Epoch: 12, Steps: 32 | Train Loss: 11.815 Vali Loss: 60.378 Vali Acc: 0.527 Test Loss: 60.378 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 16.252686738967896
Epoch: 13, Steps: 32 | Train Loss: 4.352 Vali Loss: 232.535 Vali Acc: 0.496 Test Loss: 232.535 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 16.551100730895996
Epoch: 14, Steps: 32 | Train Loss: 2.758 Vali Loss: 106.300 Vali Acc: 0.542 Test Loss: 106.300 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 15.244445323944092
Epoch: 15, Steps: 32 | Train Loss: 1.346 Vali Loss: 191.187 Vali Acc: 0.527 Test Loss: 191.187 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 16.510728359222412
Epoch: 16, Steps: 32 | Train Loss: 2.337 Vali Loss: 121.760 Vali Acc: 0.511 Test Loss: 121.760 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 16.288005113601685
Epoch: 17, Steps: 32 | Train Loss: 2.922 Vali Loss: 190.882 Vali Acc: 0.489 Test Loss: 190.882 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 16.200026035308838
Epoch: 18, Steps: 32 | Train Loss: 3.058 Vali Loss: 145.742 Vali Acc: 0.527 Test Loss: 145.742 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 16.76723051071167
Epoch: 19, Steps: 32 | Train Loss: 2.402 Vali Loss: 102.326 Vali Acc: 0.504 Test Loss: 102.326 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df128_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 12272005
model size : 64.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df128_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 17.50599503517151
Epoch: 1, Steps: 32 | Train Loss: 12.497 Vali Loss: 16.322 Vali Acc: 0.328 Test Loss: 16.322 Test Acc: 0.328
Validation loss decreased (inf --> -0.328081).  Saving model ...
Epoch: 2 cost time: 14.785232305526733
Epoch: 2, Steps: 32 | Train Loss: 14.071 Vali Loss: 19.121 Vali Acc: 0.435 Test Loss: 19.121 Test Acc: 0.435
Validation loss decreased (-0.328081 --> -0.434923).  Saving model ...
Epoch: 3 cost time: 13.676757335662842
Epoch: 3, Steps: 32 | Train Loss: 13.027 Vali Loss: 28.144 Vali Acc: 0.282 Test Loss: 28.144 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.495846271514893
Epoch: 4, Steps: 32 | Train Loss: 9.724 Vali Loss: 37.093 Vali Acc: 0.504 Test Loss: 37.093 Test Acc: 0.504
Validation loss decreased (-0.434923 --> -0.503446).  Saving model ...
Epoch: 5 cost time: 13.739417791366577
Epoch: 5, Steps: 32 | Train Loss: 8.122 Vali Loss: 84.683 Vali Acc: 0.527 Test Loss: 84.683 Test Acc: 0.527
Validation loss decreased (-0.503446 --> -0.525871).  Saving model ...
Epoch: 6 cost time: 13.848562479019165
Epoch: 6, Steps: 32 | Train Loss: 8.406 Vali Loss: 78.795 Vali Acc: 0.336 Test Loss: 78.795 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 14.559773206710815
Epoch: 7, Steps: 32 | Train Loss: 14.187 Vali Loss: 62.019 Vali Acc: 0.565 Test Loss: 62.019 Test Acc: 0.565
Validation loss decreased (-0.525871 --> -0.564265).  Saving model ...
Epoch: 8 cost time: 13.690063238143921
Epoch: 8, Steps: 32 | Train Loss: 4.481 Vali Loss: 55.065 Vali Acc: 0.435 Test Loss: 55.065 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 13.569273471832275
Epoch: 9, Steps: 32 | Train Loss: 4.662 Vali Loss: 81.790 Vali Acc: 0.412 Test Loss: 81.790 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 14.310559749603271
Epoch: 10, Steps: 32 | Train Loss: 3.555 Vali Loss: 73.668 Vali Acc: 0.473 Test Loss: 73.668 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 13.701239585876465
Epoch: 11, Steps: 32 | Train Loss: 1.581 Vali Loss: 98.827 Vali Acc: 0.542 Test Loss: 98.827 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 13.896716356277466
Epoch: 12, Steps: 32 | Train Loss: 7.113 Vali Loss: 147.675 Vali Acc: 0.542 Test Loss: 147.675 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 13.659372091293335
Epoch: 13, Steps: 32 | Train Loss: 6.240 Vali Loss: 58.659 Vali Acc: 0.603 Test Loss: 58.659 Test Acc: 0.603
Validation loss decreased (-0.564265 --> -0.602467).  Saving model ...
Epoch: 14 cost time: 13.977984428405762
Epoch: 14, Steps: 32 | Train Loss: 3.857 Vali Loss: 81.703 Vali Acc: 0.573 Test Loss: 81.703 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 13.2992525100708
Epoch: 15, Steps: 32 | Train Loss: 9.520 Vali Loss: 132.565 Vali Acc: 0.565 Test Loss: 132.565 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 13.924448251724243
Epoch: 16, Steps: 32 | Train Loss: 4.867 Vali Loss: 97.155 Vali Acc: 0.527 Test Loss: 97.155 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 14.631929397583008
Epoch: 17, Steps: 32 | Train Loss: 1.943 Vali Loss: 179.972 Vali Acc: 0.527 Test Loss: 179.972 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 14.348065614700317
Epoch: 18, Steps: 32 | Train Loss: 7.581 Vali Loss: 80.942 Vali Acc: 0.626 Test Loss: 80.942 Test Acc: 0.626
Validation loss decreased (-0.602467 --> -0.625145).  Saving model ...
Epoch: 19 cost time: 13.11270809173584
Epoch: 19, Steps: 32 | Train Loss: 9.544 Vali Loss: 84.426 Vali Acc: 0.580 Test Loss: 84.426 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 14.079116106033325
Epoch: 20, Steps: 32 | Train Loss: 1.811 Vali Loss: 139.395 Vali Acc: 0.519 Test Loss: 139.395 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 14.200228452682495
Epoch: 21, Steps: 32 | Train Loss: 3.517 Vali Loss: 142.569 Vali Acc: 0.519 Test Loss: 142.569 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 13.761363983154297
Epoch: 22, Steps: 32 | Train Loss: 1.340 Vali Loss: 148.120 Vali Acc: 0.519 Test Loss: 148.120 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 13.988038301467896
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 147.446 Vali Acc: 0.519 Test Loss: 147.446 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 13.825098514556885
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 147.422 Vali Acc: 0.519 Test Loss: 147.422 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 14.43932294845581
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 147.421 Vali Acc: 0.519 Test Loss: 147.421 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 13.85791563987732
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 147.421 Vali Acc: 0.519 Test Loss: 147.421 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 13.352209568023682
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 147.421 Vali Acc: 0.519 Test Loss: 147.421 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 13.429506063461304
Epoch: 28, Steps: 32 | Train Loss: 0.000 Vali Loss: 147.421 Vali Acc: 0.519 Test Loss: 147.421 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl1_df128_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6259541984732825
model parameter : 12272005
model size : 64.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         8992                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma8992_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 85.66244506835938
Epoch: 1, Steps: 32 | Train Loss: 7.642 Vali Loss: 6.403 Vali Acc: 0.420 Test Loss: 6.403 Test Acc: 0.420
Validation loss decreased (inf --> -0.419783).  Saving model ...
Epoch: 2 cost time: 87.06780910491943
Epoch: 2, Steps: 32 | Train Loss: 6.788 Vali Loss: 27.855 Vali Acc: 0.260 Test Loss: 27.855 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 97.54513502120972
Epoch: 3, Steps: 32 | Train Loss: 6.079 Vali Loss: 23.921 Vali Acc: 0.359 Test Loss: 23.921 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 109.61354088783264
Epoch: 4, Steps: 32 | Train Loss: 5.340 Vali Loss: 32.490 Vali Acc: 0.458 Test Loss: 32.490 Test Acc: 0.458
Validation loss decreased (-0.419783 --> -0.457690).  Saving model ...
Epoch: 5 cost time: 116.37594532966614
Epoch: 5, Steps: 32 | Train Loss: 5.424 Vali Loss: 41.185 Vali Acc: 0.496 Test Loss: 41.185 Test Acc: 0.496
Validation loss decreased (-0.457690 --> -0.495771).  Saving model ...
Epoch: 6 cost time: 116.61601209640503
Epoch: 6, Steps: 32 | Train Loss: 6.447 Vali Loss: 45.145 Vali Acc: 0.397 Test Loss: 45.145 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 117.80262613296509
Epoch: 7, Steps: 32 | Train Loss: 1.544 Vali Loss: 60.970 Vali Acc: 0.328 Test Loss: 60.970 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 112.68151664733887
Epoch: 8, Steps: 32 | Train Loss: 5.074 Vali Loss: 61.363 Vali Acc: 0.458 Test Loss: 61.363 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 119.24549150466919
Epoch: 9, Steps: 32 | Train Loss: 6.600 Vali Loss: 53.977 Vali Acc: 0.527 Test Loss: 53.977 Test Acc: 0.527
Validation loss decreased (-0.495771 --> -0.526178).  Saving model ...
Epoch: 10 cost time: 119.7023572921753
Epoch: 10, Steps: 32 | Train Loss: 2.427 Vali Loss: 96.777 Vali Acc: 0.511 Test Loss: 96.777 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 114.68180799484253
Epoch: 11, Steps: 32 | Train Loss: 5.053 Vali Loss: 94.124 Vali Acc: 0.542 Test Loss: 94.124 Test Acc: 0.542
Validation loss decreased (-0.526178 --> -0.541043).  Saving model ...
Epoch: 12 cost time: 119.58031368255615
Epoch: 12, Steps: 32 | Train Loss: 5.050 Vali Loss: 93.024 Vali Acc: 0.397 Test Loss: 93.024 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 119.01898503303528
Epoch: 13, Steps: 32 | Train Loss: 1.621 Vali Loss: 86.057 Vali Acc: 0.557 Test Loss: 86.057 Test Acc: 0.557
Validation loss decreased (-0.541043 --> -0.556391).  Saving model ...
Epoch: 14 cost time: 115.04827761650085
Epoch: 14, Steps: 32 | Train Loss: 0.955 Vali Loss: 96.078 Vali Acc: 0.504 Test Loss: 96.078 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 117.58985567092896
Epoch: 15, Steps: 32 | Train Loss: 4.833 Vali Loss: 123.473 Vali Acc: 0.496 Test Loss: 123.473 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 113.86731457710266
Epoch: 16, Steps: 32 | Train Loss: 2.447 Vali Loss: 107.201 Vali Acc: 0.550 Test Loss: 107.201 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 117.45201086997986
Epoch: 17, Steps: 32 | Train Loss: 1.149 Vali Loss: 91.013 Vali Acc: 0.458 Test Loss: 91.013 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 118.05723786354065
Epoch: 18, Steps: 32 | Train Loss: 0.234 Vali Loss: 109.383 Vali Acc: 0.534 Test Loss: 109.383 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 115.37599086761475
Epoch: 19, Steps: 32 | Train Loss: 0.873 Vali Loss: 211.216 Vali Acc: 0.519 Test Loss: 211.216 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 117.32855820655823
Epoch: 20, Steps: 32 | Train Loss: 7.817 Vali Loss: 121.799 Vali Acc: 0.519 Test Loss: 121.799 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 116.88206386566162
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 132.854 Vali Acc: 0.519 Test Loss: 132.854 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 117.33277821540833
Epoch: 22, Steps: 32 | Train Loss: 1.533 Vali Loss: 129.932 Vali Acc: 0.366 Test Loss: 129.932 Test Acc: 0.366
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 117.98604106903076
Epoch: 23, Steps: 32 | Train Loss: 0.280 Vali Loss: 121.234 Vali Acc: 0.527 Test Loss: 121.234 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma8992_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 6709445
model size : 34.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         7194                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma7194_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 70.88603067398071
Epoch: 1, Steps: 32 | Train Loss: 7.656 Vali Loss: 11.064 Vali Acc: 0.458 Test Loss: 11.064 Test Acc: 0.458
Validation loss decreased (inf --> -0.457905).  Saving model ...
Epoch: 2 cost time: 70.50224137306213
Epoch: 2, Steps: 32 | Train Loss: 5.047 Vali Loss: 16.095 Vali Acc: 0.252 Test Loss: 16.095 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 79.285808801651
Epoch: 3, Steps: 32 | Train Loss: 4.306 Vali Loss: 30.563 Vali Acc: 0.481 Test Loss: 30.563 Test Acc: 0.481
Validation loss decreased (-0.457905 --> -0.480610).  Saving model ...
Epoch: 4 cost time: 89.15589714050293
Epoch: 4, Steps: 32 | Train Loss: 6.785 Vali Loss: 34.823 Vali Acc: 0.527 Test Loss: 34.823 Test Acc: 0.527
Validation loss decreased (-0.480610 --> -0.526369).  Saving model ...
Epoch: 5 cost time: 96.33775687217712
Epoch: 5, Steps: 32 | Train Loss: 3.203 Vali Loss: 33.839 Vali Acc: 0.496 Test Loss: 33.839 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 94.68141150474548
Epoch: 6, Steps: 32 | Train Loss: 6.427 Vali Loss: 53.617 Vali Acc: 0.450 Test Loss: 53.617 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 97.8271837234497
Epoch: 7, Steps: 32 | Train Loss: 3.219 Vali Loss: 53.654 Vali Acc: 0.527 Test Loss: 53.654 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 95.04372930526733
Epoch: 8, Steps: 32 | Train Loss: 4.154 Vali Loss: 65.274 Vali Acc: 0.496 Test Loss: 65.274 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 97.5984263420105
Epoch: 9, Steps: 32 | Train Loss: 1.969 Vali Loss: 106.882 Vali Acc: 0.504 Test Loss: 106.882 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 98.53318548202515
Epoch: 10, Steps: 32 | Train Loss: 0.846 Vali Loss: 95.282 Vali Acc: 0.504 Test Loss: 95.282 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 92.42417502403259
Epoch: 11, Steps: 32 | Train Loss: 1.413 Vali Loss: 88.645 Vali Acc: 0.298 Test Loss: 88.645 Test Acc: 0.298
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 96.37197852134705
Epoch: 12, Steps: 32 | Train Loss: 7.110 Vali Loss: 59.614 Vali Acc: 0.366 Test Loss: 59.614 Test Acc: 0.366
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 97.26019358634949
Epoch: 13, Steps: 32 | Train Loss: 2.518 Vali Loss: 86.784 Vali Acc: 0.405 Test Loss: 86.784 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 96.40737462043762
Epoch: 14, Steps: 32 | Train Loss: 3.659 Vali Loss: 86.395 Vali Acc: 0.489 Test Loss: 86.395 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma7194_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 6709445
model size : 34.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5396                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma5396_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 54.986247062683105
Epoch: 1, Steps: 32 | Train Loss: 6.475 Vali Loss: 15.221 Vali Acc: 0.427 Test Loss: 15.221 Test Acc: 0.427
Validation loss decreased (inf --> -0.427329).  Saving model ...
Epoch: 2 cost time: 55.59078049659729
Epoch: 2, Steps: 32 | Train Loss: 5.327 Vali Loss: 28.585 Vali Acc: 0.244 Test Loss: 28.585 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 65.72376728057861
Epoch: 3, Steps: 32 | Train Loss: 4.613 Vali Loss: 18.222 Vali Acc: 0.542 Test Loss: 18.222 Test Acc: 0.542
Validation loss decreased (-0.427329 --> -0.541803).  Saving model ...
Epoch: 4 cost time: 74.47071933746338
Epoch: 4, Steps: 32 | Train Loss: 3.232 Vali Loss: 27.887 Vali Acc: 0.466 Test Loss: 27.887 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 72.24433326721191
Epoch: 5, Steps: 32 | Train Loss: 4.208 Vali Loss: 34.462 Vali Acc: 0.435 Test Loss: 34.462 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 76.50190377235413
Epoch: 6, Steps: 32 | Train Loss: 2.826 Vali Loss: 59.147 Vali Acc: 0.489 Test Loss: 59.147 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 72.53418684005737
Epoch: 7, Steps: 32 | Train Loss: 5.513 Vali Loss: 43.293 Vali Acc: 0.550 Test Loss: 43.293 Test Acc: 0.550
Validation loss decreased (-0.541803 --> -0.549185).  Saving model ...
Epoch: 8 cost time: 74.58044600486755
Epoch: 8, Steps: 32 | Train Loss: 3.008 Vali Loss: 69.440 Vali Acc: 0.557 Test Loss: 69.440 Test Acc: 0.557
Validation loss decreased (-0.549185 --> -0.556558).  Saving model ...
Epoch: 9 cost time: 74.99723196029663
Epoch: 9, Steps: 32 | Train Loss: 1.586 Vali Loss: 102.079 Vali Acc: 0.504 Test Loss: 102.079 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 77.55507707595825
Epoch: 10, Steps: 32 | Train Loss: 1.619 Vali Loss: 59.411 Vali Acc: 0.496 Test Loss: 59.411 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 78.3543393611908
Epoch: 11, Steps: 32 | Train Loss: 1.078 Vali Loss: 47.726 Vali Acc: 0.412 Test Loss: 47.726 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 77.5182478427887
Epoch: 12, Steps: 32 | Train Loss: 0.304 Vali Loss: 48.433 Vali Acc: 0.527 Test Loss: 48.433 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 74.77852034568787
Epoch: 13, Steps: 32 | Train Loss: 1.944 Vali Loss: 49.869 Vali Acc: 0.565 Test Loss: 49.869 Test Acc: 0.565
Validation loss decreased (-0.556558 --> -0.564387).  Saving model ...
Epoch: 14 cost time: 77.17267084121704
Epoch: 14, Steps: 32 | Train Loss: 2.218 Vali Loss: 98.893 Vali Acc: 0.382 Test Loss: 98.893 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 74.64526009559631
Epoch: 15, Steps: 32 | Train Loss: 3.039 Vali Loss: 80.579 Vali Acc: 0.542 Test Loss: 80.579 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 74.144202709198
Epoch: 16, Steps: 32 | Train Loss: 4.191 Vali Loss: 109.871 Vali Acc: 0.489 Test Loss: 109.871 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 75.10367631912231
Epoch: 17, Steps: 32 | Train Loss: 5.905 Vali Loss: 117.032 Vali Acc: 0.557 Test Loss: 117.032 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 75.38352847099304
Epoch: 18, Steps: 32 | Train Loss: 2.168 Vali Loss: 100.600 Vali Acc: 0.519 Test Loss: 100.600 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 75.49335169792175
Epoch: 19, Steps: 32 | Train Loss: 4.108 Vali Loss: 148.766 Vali Acc: 0.519 Test Loss: 148.766 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 76.29083681106567
Epoch: 20, Steps: 32 | Train Loss: 3.195 Vali Loss: 135.022 Vali Acc: 0.382 Test Loss: 135.022 Test Acc: 0.382
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 77.57993721961975
Epoch: 21, Steps: 32 | Train Loss: 0.493 Vali Loss: 120.470 Vali Acc: 0.550 Test Loss: 120.470 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 76.9933488368988
Epoch: 22, Steps: 32 | Train Loss: 0.160 Vali Loss: 132.958 Vali Acc: 0.534 Test Loss: 132.958 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 76.56660795211792
Epoch: 23, Steps: 32 | Train Loss: 0.604 Vali Loss: 107.482 Vali Acc: 0.481 Test Loss: 107.482 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma5396_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 6709445
model size : 34.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3597                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma3597_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 42.527058839797974
Epoch: 1, Steps: 32 | Train Loss: 6.007 Vali Loss: 11.279 Vali Acc: 0.466 Test Loss: 11.279 Test Acc: 0.466
Validation loss decreased (inf --> -0.465536).  Saving model ...
Epoch: 2 cost time: 42.28459358215332
Epoch: 2, Steps: 32 | Train Loss: 3.327 Vali Loss: 33.450 Vali Acc: 0.229 Test Loss: 33.450 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 45.79002285003662
Epoch: 3, Steps: 32 | Train Loss: 8.522 Vali Loss: 28.227 Vali Acc: 0.489 Test Loss: 28.227 Test Acc: 0.489
Validation loss decreased (-0.465536 --> -0.488267).  Saving model ...
Epoch: 4 cost time: 50.31657004356384
Epoch: 4, Steps: 32 | Train Loss: 10.497 Vali Loss: 41.352 Vali Acc: 0.511 Test Loss: 41.352 Test Acc: 0.511
Validation loss decreased (-0.488267 --> -0.511037).  Saving model ...
Epoch: 5 cost time: 54.00621199607849
Epoch: 5, Steps: 32 | Train Loss: 5.454 Vali Loss: 65.015 Vali Acc: 0.519 Test Loss: 65.015 Test Acc: 0.519
Validation loss decreased (-0.511037 --> -0.518434).  Saving model ...
Epoch: 6 cost time: 55.531545877456665
Epoch: 6, Steps: 32 | Train Loss: 4.583 Vali Loss: 60.960 Vali Acc: 0.534 Test Loss: 60.960 Test Acc: 0.534
Validation loss decreased (-0.518434 --> -0.533742).  Saving model ...
Epoch: 7 cost time: 53.88474202156067
Epoch: 7, Steps: 32 | Train Loss: 3.909 Vali Loss: 49.573 Vali Acc: 0.443 Test Loss: 49.573 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 54.5253746509552
Epoch: 8, Steps: 32 | Train Loss: 2.066 Vali Loss: 36.316 Vali Acc: 0.466 Test Loss: 36.316 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 55.14810609817505
Epoch: 9, Steps: 32 | Train Loss: 0.913 Vali Loss: 37.271 Vali Acc: 0.481 Test Loss: 37.271 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 54.67774200439453
Epoch: 10, Steps: 32 | Train Loss: 1.143 Vali Loss: 73.060 Vali Acc: 0.443 Test Loss: 73.060 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 56.32252049446106
Epoch: 11, Steps: 32 | Train Loss: 1.395 Vali Loss: 46.828 Vali Acc: 0.435 Test Loss: 46.828 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 54.7382378578186
Epoch: 12, Steps: 32 | Train Loss: 1.616 Vali Loss: 69.383 Vali Acc: 0.466 Test Loss: 69.383 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 55.10799837112427
Epoch: 13, Steps: 32 | Train Loss: 4.108 Vali Loss: 77.058 Vali Acc: 0.511 Test Loss: 77.058 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 53.842130184173584
Epoch: 14, Steps: 32 | Train Loss: 3.022 Vali Loss: 64.794 Vali Acc: 0.481 Test Loss: 64.794 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 54.31178140640259
Epoch: 15, Steps: 32 | Train Loss: 1.840 Vali Loss: 71.631 Vali Acc: 0.382 Test Loss: 71.631 Test Acc: 0.382
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 54.492087841033936
Epoch: 16, Steps: 32 | Train Loss: 2.747 Vali Loss: 63.042 Vali Acc: 0.557 Test Loss: 63.042 Test Acc: 0.557
Validation loss decreased (-0.533742 --> -0.556621).  Saving model ...
Epoch: 17 cost time: 55.65646553039551
Epoch: 17, Steps: 32 | Train Loss: 3.508 Vali Loss: 90.517 Vali Acc: 0.527 Test Loss: 90.517 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 55.286245346069336
Epoch: 18, Steps: 32 | Train Loss: 1.327 Vali Loss: 154.254 Vali Acc: 0.504 Test Loss: 154.254 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 53.41907858848572
Epoch: 19, Steps: 32 | Train Loss: 3.573 Vali Loss: 120.248 Vali Acc: 0.481 Test Loss: 120.248 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 54.67666530609131
Epoch: 20, Steps: 32 | Train Loss: 1.144 Vali Loss: 99.766 Vali Acc: 0.382 Test Loss: 99.766 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 54.519043922424316
Epoch: 21, Steps: 32 | Train Loss: 0.633 Vali Loss: 105.404 Vali Acc: 0.458 Test Loss: 105.404 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 54.05219793319702
Epoch: 22, Steps: 32 | Train Loss: 1.302 Vali Loss: 157.865 Vali Acc: 0.534 Test Loss: 157.865 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 54.827789545059204
Epoch: 23, Steps: 32 | Train Loss: 1.222 Vali Loss: 131.814 Vali Acc: 0.519 Test Loss: 131.814 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 55.27807903289795
Epoch: 24, Steps: 32 | Train Loss: 0.513 Vali Loss: 115.107 Vali Acc: 0.466 Test Loss: 115.107 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 54.048057317733765
Epoch: 25, Steps: 32 | Train Loss: 0.255 Vali Loss: 172.013 Vali Acc: 0.466 Test Loss: 172.013 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 54.41219139099121
Epoch: 26, Steps: 32 | Train Loss: 5.146 Vali Loss: 161.410 Vali Acc: 0.489 Test Loss: 161.410 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma3597_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 6709445
model size : 34.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1799                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 27.568732500076294
Epoch: 1, Steps: 32 | Train Loss: 6.782 Vali Loss: 7.053 Vali Acc: 0.458 Test Loss: 7.053 Test Acc: 0.458
Validation loss decreased (inf --> -0.457945).  Saving model ...
Epoch: 2 cost time: 26.665846586227417
Epoch: 2, Steps: 32 | Train Loss: 5.906 Vali Loss: 26.873 Vali Acc: 0.267 Test Loss: 26.873 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 29.939541816711426
Epoch: 3, Steps: 32 | Train Loss: 4.601 Vali Loss: 12.938 Vali Acc: 0.496 Test Loss: 12.938 Test Acc: 0.496
Validation loss decreased (-0.457945 --> -0.496054).  Saving model ...
Epoch: 4 cost time: 31.327435970306396
Epoch: 4, Steps: 32 | Train Loss: 2.655 Vali Loss: 33.566 Vali Acc: 0.519 Test Loss: 33.566 Test Acc: 0.519
Validation loss decreased (-0.496054 --> -0.518748).  Saving model ...
Epoch: 5 cost time: 33.211737632751465
Epoch: 5, Steps: 32 | Train Loss: 3.707 Vali Loss: 53.960 Vali Acc: 0.466 Test Loss: 53.960 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 33.293493032455444
Epoch: 6, Steps: 32 | Train Loss: 4.073 Vali Loss: 44.820 Vali Acc: 0.420 Test Loss: 44.820 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 31.409810066223145
Epoch: 7, Steps: 32 | Train Loss: 9.092 Vali Loss: 51.750 Vali Acc: 0.344 Test Loss: 51.750 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 32.12498497962952
Epoch: 8, Steps: 32 | Train Loss: 3.620 Vali Loss: 69.358 Vali Acc: 0.504 Test Loss: 69.358 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 32.95869755744934
Epoch: 9, Steps: 32 | Train Loss: 2.903 Vali Loss: 92.934 Vali Acc: 0.511 Test Loss: 92.934 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 32.782416582107544
Epoch: 10, Steps: 32 | Train Loss: 2.656 Vali Loss: 104.712 Vali Acc: 0.519 Test Loss: 104.712 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 32.191508531570435
Epoch: 11, Steps: 32 | Train Loss: 3.879 Vali Loss: 84.625 Vali Acc: 0.344 Test Loss: 84.625 Test Acc: 0.344
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 32.38872981071472
Epoch: 12, Steps: 32 | Train Loss: 2.931 Vali Loss: 87.128 Vali Acc: 0.466 Test Loss: 87.128 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 32.507691621780396
Epoch: 13, Steps: 32 | Train Loss: 1.860 Vali Loss: 81.253 Vali Acc: 0.420 Test Loss: 81.253 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 32.699737787246704
Epoch: 14, Steps: 32 | Train Loss: 1.093 Vali Loss: 61.817 Vali Acc: 0.374 Test Loss: 61.817 Test Acc: 0.374
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 6709445
model size : 34.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 20.23291325569153
Epoch: 1, Steps: 32 | Train Loss: 5.849 Vali Loss: 6.404 Vali Acc: 0.328 Test Loss: 6.404 Test Acc: 0.328
Validation loss decreased (inf --> -0.328180).  Saving model ...
Epoch: 2 cost time: 19.27701497077942
Epoch: 2, Steps: 32 | Train Loss: 2.900 Vali Loss: 29.277 Vali Acc: 0.206 Test Loss: 29.277 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 19.715407609939575
Epoch: 3, Steps: 32 | Train Loss: 6.646 Vali Loss: 31.350 Vali Acc: 0.550 Test Loss: 31.350 Test Acc: 0.550
Validation loss decreased (-0.328180 --> -0.549305).  Saving model ...
Epoch: 4 cost time: 21.723461151123047
Epoch: 4, Steps: 32 | Train Loss: 5.976 Vali Loss: 21.019 Vali Acc: 0.412 Test Loss: 21.019 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 21.87497067451477
Epoch: 5, Steps: 32 | Train Loss: 1.775 Vali Loss: 28.105 Vali Acc: 0.565 Test Loss: 28.105 Test Acc: 0.565
Validation loss decreased (-0.549305 --> -0.564604).  Saving model ...
Epoch: 6 cost time: 22.507441759109497
Epoch: 6, Steps: 32 | Train Loss: 0.165 Vali Loss: 33.819 Vali Acc: 0.344 Test Loss: 33.819 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 22.84303569793701
Epoch: 7, Steps: 32 | Train Loss: 1.195 Vali Loss: 35.375 Vali Acc: 0.458 Test Loss: 35.375 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 22.40277886390686
Epoch: 8, Steps: 32 | Train Loss: 2.431 Vali Loss: 37.713 Vali Acc: 0.519 Test Loss: 37.713 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 22.56728506088257
Epoch: 9, Steps: 32 | Train Loss: 1.400 Vali Loss: 65.491 Vali Acc: 0.557 Test Loss: 65.491 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 22.434791088104248
Epoch: 10, Steps: 32 | Train Loss: 3.625 Vali Loss: 46.669 Vali Acc: 0.504 Test Loss: 46.669 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 22.208497762680054
Epoch: 11, Steps: 32 | Train Loss: 6.498 Vali Loss: 79.963 Vali Acc: 0.275 Test Loss: 79.963 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 22.38481044769287
Epoch: 12, Steps: 32 | Train Loss: 7.846 Vali Loss: 69.370 Vali Acc: 0.420 Test Loss: 69.370 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 22.027735471725464
Epoch: 13, Steps: 32 | Train Loss: 2.031 Vali Loss: 139.419 Vali Acc: 0.504 Test Loss: 139.419 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 21.92927885055542
Epoch: 14, Steps: 32 | Train Loss: 4.219 Vali Loss: 67.154 Vali Acc: 0.412 Test Loss: 67.154 Test Acc: 0.412
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 22.422504663467407
Epoch: 15, Steps: 32 | Train Loss: 1.147 Vali Loss: 68.047 Vali Acc: 0.450 Test Loss: 68.047 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 6709445
model size : 34.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         540                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma540_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 18.31795072555542
Epoch: 1, Steps: 32 | Train Loss: 5.749 Vali Loss: 8.547 Vali Acc: 0.496 Test Loss: 8.547 Test Acc: 0.496
Validation loss decreased (inf --> -0.496098).  Saving model ...
Epoch: 2 cost time: 16.21637511253357
Epoch: 2, Steps: 32 | Train Loss: 3.847 Vali Loss: 30.276 Vali Acc: 0.389 Test Loss: 30.276 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 17.57760524749756
Epoch: 3, Steps: 32 | Train Loss: 7.415 Vali Loss: 20.334 Vali Acc: 0.282 Test Loss: 20.334 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 18.662245273590088
Epoch: 4, Steps: 32 | Train Loss: 4.005 Vali Loss: 29.308 Vali Acc: 0.489 Test Loss: 29.308 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 18.26086664199829
Epoch: 5, Steps: 32 | Train Loss: 2.062 Vali Loss: 23.110 Vali Acc: 0.550 Test Loss: 23.110 Test Acc: 0.550
Validation loss decreased (-0.496098 --> -0.549387).  Saving model ...
Epoch: 6 cost time: 18.84056854248047
Epoch: 6, Steps: 32 | Train Loss: 2.353 Vali Loss: 38.335 Vali Acc: 0.519 Test Loss: 38.335 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 18.640586376190186
Epoch: 7, Steps: 32 | Train Loss: 2.030 Vali Loss: 35.746 Vali Acc: 0.359 Test Loss: 35.746 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 18.78512740135193
Epoch: 8, Steps: 32 | Train Loss: 3.320 Vali Loss: 74.859 Vali Acc: 0.511 Test Loss: 74.859 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 18.67911195755005
Epoch: 9, Steps: 32 | Train Loss: 2.128 Vali Loss: 54.354 Vali Acc: 0.359 Test Loss: 54.354 Test Acc: 0.359
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 18.41218328475952
Epoch: 10, Steps: 32 | Train Loss: 3.078 Vali Loss: 106.207 Vali Acc: 0.466 Test Loss: 106.207 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 17.64393186569214
Epoch: 11, Steps: 32 | Train Loss: 6.197 Vali Loss: 72.428 Vali Acc: 0.366 Test Loss: 72.428 Test Acc: 0.366
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 18.260674953460693
Epoch: 12, Steps: 32 | Train Loss: 8.435 Vali Loss: 78.454 Vali Acc: 0.473 Test Loss: 78.454 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 18.011857509613037
Epoch: 13, Steps: 32 | Train Loss: 0.990 Vali Loss: 80.396 Vali Acc: 0.496 Test Loss: 80.396 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 17.421167612075806
Epoch: 14, Steps: 32 | Train Loss: 2.406 Vali Loss: 90.620 Vali Acc: 0.336 Test Loss: 90.620 Test Acc: 0.336
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 18.17060899734497
Epoch: 15, Steps: 32 | Train Loss: 4.661 Vali Loss: 78.813 Vali Acc: 0.420 Test Loss: 78.813 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma540_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 6709445
model size : 34.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 16.797118425369263
Epoch: 1, Steps: 32 | Train Loss: 6.115 Vali Loss: 7.041 Vali Acc: 0.290 Test Loss: 7.041 Test Acc: 0.290
Validation loss decreased (inf --> -0.290006).  Saving model ...
Epoch: 2 cost time: 15.650522708892822
Epoch: 2, Steps: 32 | Train Loss: 5.780 Vali Loss: 32.210 Vali Acc: 0.450 Test Loss: 32.210 Test Acc: 0.450
Validation loss decreased (-0.290006 --> -0.450060).  Saving model ...
Epoch: 3 cost time: 16.17891764640808
Epoch: 3, Steps: 32 | Train Loss: 4.826 Vali Loss: 36.769 Vali Acc: 0.366 Test Loss: 36.769 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 16.737868785858154
Epoch: 4, Steps: 32 | Train Loss: 3.517 Vali Loss: 25.571 Vali Acc: 0.366 Test Loss: 25.571 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 16.695638418197632
Epoch: 5, Steps: 32 | Train Loss: 1.110 Vali Loss: 26.616 Vali Acc: 0.443 Test Loss: 26.616 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 16.407850742340088
Epoch: 6, Steps: 32 | Train Loss: 2.495 Vali Loss: 48.972 Vali Acc: 0.427 Test Loss: 48.972 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 17.289414405822754
Epoch: 7, Steps: 32 | Train Loss: 3.977 Vali Loss: 32.814 Vali Acc: 0.420 Test Loss: 32.814 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 16.645397424697876
Epoch: 8, Steps: 32 | Train Loss: 4.710 Vali Loss: 57.908 Vali Acc: 0.534 Test Loss: 57.908 Test Acc: 0.534
Validation loss decreased (-0.450060 --> -0.533772).  Saving model ...
Epoch: 9 cost time: 16.917027235031128
Epoch: 9, Steps: 32 | Train Loss: 0.784 Vali Loss: 55.565 Vali Acc: 0.344 Test Loss: 55.565 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 16.536198616027832
Epoch: 10, Steps: 32 | Train Loss: 1.622 Vali Loss: 62.425 Vali Acc: 0.412 Test Loss: 62.425 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 16.709638357162476
Epoch: 11, Steps: 32 | Train Loss: 5.804 Vali Loss: 50.001 Vali Acc: 0.450 Test Loss: 50.001 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 16.84893012046814
Epoch: 12, Steps: 32 | Train Loss: 3.088 Vali Loss: 62.042 Vali Acc: 0.534 Test Loss: 62.042 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 16.167078733444214
Epoch: 13, Steps: 32 | Train Loss: 4.606 Vali Loss: 126.581 Vali Acc: 0.427 Test Loss: 126.581 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 16.669450759887695
Epoch: 14, Steps: 32 | Train Loss: 10.569 Vali Loss: 112.655 Vali Acc: 0.511 Test Loss: 112.655 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 16.270652532577515
Epoch: 15, Steps: 32 | Train Loss: 3.631 Vali Loss: 59.414 Vali Acc: 0.412 Test Loss: 59.414 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 16.23626160621643
Epoch: 16, Steps: 32 | Train Loss: 6.892 Vali Loss: 84.043 Vali Acc: 0.435 Test Loss: 84.043 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 16.8938570022583
Epoch: 17, Steps: 32 | Train Loss: 2.209 Vali Loss: 100.936 Vali Acc: 0.504 Test Loss: 100.936 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 17.016595363616943
Epoch: 18, Steps: 32 | Train Loss: 2.549 Vali Loss: 91.128 Vali Acc: 0.489 Test Loss: 91.128 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 6709445
model size : 34.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 16.378988027572632
Epoch: 1, Steps: 32 | Train Loss: 7.350 Vali Loss: 12.164 Vali Acc: 0.412 Test Loss: 12.164 Test Acc: 0.412
Validation loss decreased (inf --> -0.412092).  Saving model ...
Epoch: 2 cost time: 14.20697808265686
Epoch: 2, Steps: 32 | Train Loss: 9.852 Vali Loss: 20.505 Vali Acc: 0.290 Test Loss: 20.505 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.55931043624878
Epoch: 3, Steps: 32 | Train Loss: 4.932 Vali Loss: 16.432 Vali Acc: 0.519 Test Loss: 16.432 Test Acc: 0.519
Validation loss decreased (-0.412092 --> -0.518920).  Saving model ...
Epoch: 4 cost time: 14.574204921722412
Epoch: 4, Steps: 32 | Train Loss: 3.599 Vali Loss: 23.686 Vali Acc: 0.557 Test Loss: 23.686 Test Acc: 0.557
Validation loss decreased (-0.518920 --> -0.557015).  Saving model ...
Epoch: 5 cost time: 14.581919193267822
Epoch: 5, Steps: 32 | Train Loss: 1.749 Vali Loss: 15.443 Vali Acc: 0.511 Test Loss: 15.443 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 14.755826950073242
Epoch: 6, Steps: 32 | Train Loss: 1.500 Vali Loss: 26.019 Vali Acc: 0.458 Test Loss: 26.019 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 14.505391359329224
Epoch: 7, Steps: 32 | Train Loss: 2.205 Vali Loss: 44.568 Vali Acc: 0.427 Test Loss: 44.568 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 14.94887638092041
Epoch: 8, Steps: 32 | Train Loss: 2.933 Vali Loss: 75.835 Vali Acc: 0.481 Test Loss: 75.835 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 14.595476865768433
Epoch: 9, Steps: 32 | Train Loss: 1.468 Vali Loss: 26.071 Vali Acc: 0.550 Test Loss: 26.071 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 15.013125658035278
Epoch: 10, Steps: 32 | Train Loss: 0.596 Vali Loss: 39.745 Vali Acc: 0.481 Test Loss: 39.745 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 14.610069274902344
Epoch: 11, Steps: 32 | Train Loss: 1.041 Vali Loss: 36.846 Vali Acc: 0.382 Test Loss: 36.846 Test Acc: 0.382
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 14.486385822296143
Epoch: 12, Steps: 32 | Train Loss: 2.078 Vali Loss: 47.944 Vali Acc: 0.519 Test Loss: 47.944 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 14.515020847320557
Epoch: 13, Steps: 32 | Train Loss: 0.886 Vali Loss: 57.814 Vali Acc: 0.450 Test Loss: 57.814 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 14.6768319606781
Epoch: 14, Steps: 32 | Train Loss: 1.599 Vali Loss: 65.370 Vali Acc: 0.504 Test Loss: 65.370 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 6709445
model size : 34.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.229581594467163
Epoch: 1, Steps: 32 | Train Loss: 6.260 Vali Loss: 7.798 Vali Acc: 0.435 Test Loss: 7.798 Test Acc: 0.435
Validation loss decreased (inf --> -0.435037).  Saving model ...
Epoch: 2 cost time: 12.761237859725952
Epoch: 2, Steps: 32 | Train Loss: 5.394 Vali Loss: 20.527 Vali Acc: 0.427 Test Loss: 20.527 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.83971643447876
Epoch: 3, Steps: 32 | Train Loss: 5.700 Vali Loss: 16.245 Vali Acc: 0.565 Test Loss: 16.245 Test Acc: 0.565
Validation loss decreased (-0.435037 --> -0.564723).  Saving model ...
Epoch: 4 cost time: 13.534874200820923
Epoch: 4, Steps: 32 | Train Loss: 3.258 Vali Loss: 7.414 Vali Acc: 0.580 Test Loss: 7.414 Test Acc: 0.580
Validation loss decreased (-0.564723 --> -0.580079).  Saving model ...
Epoch: 5 cost time: 13.657810926437378
Epoch: 5, Steps: 32 | Train Loss: 4.522 Vali Loss: 33.955 Vali Acc: 0.305 Test Loss: 33.955 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.889224290847778
Epoch: 6, Steps: 32 | Train Loss: 2.296 Vali Loss: 26.742 Vali Acc: 0.588 Test Loss: 26.742 Test Acc: 0.588
Validation loss decreased (-0.580079 --> -0.587519).  Saving model ...
Epoch: 7 cost time: 13.853866338729858
Epoch: 7, Steps: 32 | Train Loss: 7.240 Vali Loss: 33.960 Vali Acc: 0.397 Test Loss: 33.960 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 13.501223087310791
Epoch: 8, Steps: 32 | Train Loss: 4.102 Vali Loss: 37.036 Vali Acc: 0.511 Test Loss: 37.036 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 13.476061344146729
Epoch: 9, Steps: 32 | Train Loss: 3.655 Vali Loss: 51.350 Vali Acc: 0.458 Test Loss: 51.350 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 13.573439121246338
Epoch: 10, Steps: 32 | Train Loss: 1.425 Vali Loss: 40.057 Vali Acc: 0.443 Test Loss: 40.057 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 13.712294340133667
Epoch: 11, Steps: 32 | Train Loss: 0.931 Vali Loss: 41.309 Vali Acc: 0.527 Test Loss: 41.309 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 13.367929697036743
Epoch: 12, Steps: 32 | Train Loss: 0.585 Vali Loss: 46.181 Vali Acc: 0.527 Test Loss: 46.181 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 13.760274648666382
Epoch: 13, Steps: 32 | Train Loss: 0.916 Vali Loss: 39.322 Vali Acc: 0.573 Test Loss: 39.322 Test Acc: 0.573
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 13.372578144073486
Epoch: 14, Steps: 32 | Train Loss: 1.834 Vali Loss: 42.749 Vali Acc: 0.450 Test Loss: 42.749 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 13.937776327133179
Epoch: 15, Steps: 32 | Train Loss: 0.776 Vali Loss: 84.261 Vali Acc: 0.321 Test Loss: 84.261 Test Acc: 0.321
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 14.346813201904297
Epoch: 16, Steps: 32 | Train Loss: 1.159 Vali Loss: 58.115 Vali Acc: 0.511 Test Loss: 58.115 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df2048_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 6709445
model size : 34.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         8992                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma8992_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 81.09642624855042
Epoch: 1, Steps: 32 | Train Loss: 6.048 Vali Loss: 12.455 Vali Acc: 0.206 Test Loss: 12.455 Test Acc: 0.206
Validation loss decreased (inf --> -0.205982).  Saving model ...
Epoch: 2 cost time: 82.2646861076355
Epoch: 2, Steps: 32 | Train Loss: 4.472 Vali Loss: 14.749 Vali Acc: 0.344 Test Loss: 14.749 Test Acc: 0.344
Validation loss decreased (-0.205982 --> -0.343364).  Saving model ...
Epoch: 3 cost time: 94.83708167076111
Epoch: 3, Steps: 32 | Train Loss: 3.612 Vali Loss: 24.823 Vali Acc: 0.298 Test Loss: 24.823 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 106.68009066581726
Epoch: 4, Steps: 32 | Train Loss: 1.969 Vali Loss: 23.590 Vali Acc: 0.412 Test Loss: 23.590 Test Acc: 0.412
Validation loss decreased (-0.343364 --> -0.411978).  Saving model ...
Epoch: 5 cost time: 106.35186219215393
Epoch: 5, Steps: 32 | Train Loss: 4.309 Vali Loss: 33.754 Vali Acc: 0.382 Test Loss: 33.754 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 108.43807697296143
Epoch: 6, Steps: 32 | Train Loss: 4.832 Vali Loss: 42.641 Vali Acc: 0.542 Test Loss: 42.641 Test Acc: 0.542
Validation loss decreased (-0.411978 --> -0.541558).  Saving model ...
Epoch: 7 cost time: 109.76771807670593
Epoch: 7, Steps: 32 | Train Loss: 3.496 Vali Loss: 41.066 Vali Acc: 0.489 Test Loss: 41.066 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 115.17158555984497
Epoch: 8, Steps: 32 | Train Loss: 4.743 Vali Loss: 53.358 Vali Acc: 0.305 Test Loss: 53.358 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 113.76112008094788
Epoch: 9, Steps: 32 | Train Loss: 3.112 Vali Loss: 56.676 Vali Acc: 0.519 Test Loss: 56.676 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 114.07226610183716
Epoch: 10, Steps: 32 | Train Loss: 0.421 Vali Loss: 76.048 Vali Acc: 0.527 Test Loss: 76.048 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 113.31234788894653
Epoch: 11, Steps: 32 | Train Loss: 3.897 Vali Loss: 68.050 Vali Acc: 0.496 Test Loss: 68.050 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 111.9643657207489
Epoch: 12, Steps: 32 | Train Loss: 3.616 Vali Loss: 56.572 Vali Acc: 0.534 Test Loss: 56.572 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 113.44635891914368
Epoch: 13, Steps: 32 | Train Loss: 2.218 Vali Loss: 82.149 Vali Acc: 0.534 Test Loss: 82.149 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 115.23650312423706
Epoch: 14, Steps: 32 | Train Loss: 1.135 Vali Loss: 76.336 Vali Acc: 0.450 Test Loss: 76.336 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 114.95040965080261
Epoch: 15, Steps: 32 | Train Loss: 1.803 Vali Loss: 87.181 Vali Acc: 0.427 Test Loss: 87.181 Test Acc: 0.427
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 115.50014543533325
Epoch: 16, Steps: 32 | Train Loss: 1.003 Vali Loss: 81.908 Vali Acc: 0.427 Test Loss: 81.908 Test Acc: 0.427
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma8992_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 6316229
model size : 32.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         7194                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma7194_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 67.84793758392334
Epoch: 1, Steps: 32 | Train Loss: 7.779 Vali Loss: 10.861 Vali Acc: 0.191 Test Loss: 10.861 Test Acc: 0.191
Validation loss decreased (inf --> -0.190731).  Saving model ...
Epoch: 2 cost time: 68.5966055393219
Epoch: 2, Steps: 32 | Train Loss: 6.455 Vali Loss: 14.904 Vali Acc: 0.344 Test Loss: 14.904 Test Acc: 0.344
Validation loss decreased (-0.190731 --> -0.343362).  Saving model ...
Epoch: 3 cost time: 80.5269045829773
Epoch: 3, Steps: 32 | Train Loss: 4.602 Vali Loss: 32.012 Vali Acc: 0.473 Test Loss: 32.012 Test Acc: 0.473
Validation loss decreased (-0.343362 --> -0.472962).  Saving model ...
Epoch: 4 cost time: 82.71558928489685
Epoch: 4, Steps: 32 | Train Loss: 7.667 Vali Loss: 47.548 Vali Acc: 0.221 Test Loss: 47.548 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 90.32626461982727
Epoch: 5, Steps: 32 | Train Loss: 2.374 Vali Loss: 44.820 Vali Acc: 0.527 Test Loss: 44.820 Test Acc: 0.527
Validation loss decreased (-0.472962 --> -0.526269).  Saving model ...
Epoch: 6 cost time: 93.04374432563782
Epoch: 6, Steps: 32 | Train Loss: 5.566 Vali Loss: 45.911 Vali Acc: 0.496 Test Loss: 45.911 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 92.12316536903381
Epoch: 7, Steps: 32 | Train Loss: 2.905 Vali Loss: 55.840 Vali Acc: 0.489 Test Loss: 55.840 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 94.74795842170715
Epoch: 8, Steps: 32 | Train Loss: 5.386 Vali Loss: 41.191 Vali Acc: 0.557 Test Loss: 41.191 Test Acc: 0.557
Validation loss decreased (-0.526269 --> -0.556840).  Saving model ...
Epoch: 9 cost time: 93.55472660064697
Epoch: 9, Steps: 32 | Train Loss: 1.274 Vali Loss: 53.084 Vali Acc: 0.542 Test Loss: 53.084 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 94.76712822914124
Epoch: 10, Steps: 32 | Train Loss: 0.000 Vali Loss: 58.001 Vali Acc: 0.550 Test Loss: 58.001 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 93.17127442359924
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 58.458 Vali Acc: 0.542 Test Loss: 58.458 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 94.95367765426636
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 58.475 Vali Acc: 0.542 Test Loss: 58.475 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 95.56187200546265
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 58.459 Vali Acc: 0.542 Test Loss: 58.459 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 94.48628115653992
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 58.457 Vali Acc: 0.542 Test Loss: 58.457 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 94.21730422973633
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 58.457 Vali Acc: 0.542 Test Loss: 58.457 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 94.23256468772888
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 58.080 Vali Acc: 0.542 Test Loss: 58.080 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 95.16829061508179
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 58.075 Vali Acc: 0.542 Test Loss: 58.075 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 94.89585900306702
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 58.127 Vali Acc: 0.542 Test Loss: 58.127 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma7194_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 6316229
model size : 32.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5396                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma5396_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 53.46401357650757
Epoch: 1, Steps: 32 | Train Loss: 5.854 Vali Loss: 10.284 Vali Acc: 0.313 Test Loss: 10.284 Test Acc: 0.313
Validation loss decreased (inf --> -0.312874).  Saving model ...
Epoch: 2 cost time: 54.53613471984863
Epoch: 2, Steps: 32 | Train Loss: 8.200 Vali Loss: 29.372 Vali Acc: 0.206 Test Loss: 29.372 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 63.77423024177551
Epoch: 3, Steps: 32 | Train Loss: 3.773 Vali Loss: 34.520 Vali Acc: 0.504 Test Loss: 34.520 Test Acc: 0.504
Validation loss decreased (-0.312874 --> -0.503472).  Saving model ...
Epoch: 4 cost time: 70.46189761161804
Epoch: 4, Steps: 32 | Train Loss: 2.859 Vali Loss: 46.580 Vali Acc: 0.252 Test Loss: 46.580 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 71.14213466644287
Epoch: 5, Steps: 32 | Train Loss: 7.680 Vali Loss: 42.223 Vali Acc: 0.534 Test Loss: 42.223 Test Acc: 0.534
Validation loss decreased (-0.503472 --> -0.533929).  Saving model ...
Epoch: 6 cost time: 71.44928550720215
Epoch: 6, Steps: 32 | Train Loss: 1.155 Vali Loss: 39.792 Vali Acc: 0.519 Test Loss: 39.792 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 75.58155107498169
Epoch: 7, Steps: 32 | Train Loss: 2.214 Vali Loss: 42.493 Vali Acc: 0.420 Test Loss: 42.493 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 75.79932117462158
Epoch: 8, Steps: 32 | Train Loss: 1.397 Vali Loss: 60.005 Vali Acc: 0.519 Test Loss: 60.005 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 71.89384150505066
Epoch: 9, Steps: 32 | Train Loss: 2.462 Vali Loss: 60.206 Vali Acc: 0.298 Test Loss: 60.206 Test Acc: 0.298
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 73.24846744537354
Epoch: 10, Steps: 32 | Train Loss: 3.946 Vali Loss: 69.927 Vali Acc: 0.504 Test Loss: 69.927 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 73.529700756073
Epoch: 11, Steps: 32 | Train Loss: 0.381 Vali Loss: 70.157 Vali Acc: 0.534 Test Loss: 70.157 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 70.94869184494019
Epoch: 12, Steps: 32 | Train Loss: 5.342 Vali Loss: 76.973 Vali Acc: 0.527 Test Loss: 76.973 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 71.92882537841797
Epoch: 13, Steps: 32 | Train Loss: 8.206 Vali Loss: 97.419 Vali Acc: 0.511 Test Loss: 97.419 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 72.32685112953186
Epoch: 14, Steps: 32 | Train Loss: 3.113 Vali Loss: 132.342 Vali Acc: 0.534 Test Loss: 132.342 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 73.33136582374573
Epoch: 15, Steps: 32 | Train Loss: 1.059 Vali Loss: 70.393 Vali Acc: 0.473 Test Loss: 70.393 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma5396_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 6316229
model size : 32.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3597                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma3597_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 38.43309211730957
Epoch: 1, Steps: 32 | Train Loss: 6.156 Vali Loss: 10.539 Vali Acc: 0.244 Test Loss: 10.539 Test Acc: 0.244
Validation loss decreased (inf --> -0.244169).  Saving model ...
Epoch: 2 cost time: 39.55312538146973
Epoch: 2, Steps: 32 | Train Loss: 4.291 Vali Loss: 13.093 Vali Acc: 0.344 Test Loss: 13.093 Test Acc: 0.344
Validation loss decreased (-0.244169 --> -0.343381).  Saving model ...
Epoch: 3 cost time: 43.87566900253296
Epoch: 3, Steps: 32 | Train Loss: 2.635 Vali Loss: 29.274 Vali Acc: 0.450 Test Loss: 29.274 Test Acc: 0.450
Validation loss decreased (-0.343381 --> -0.450089).  Saving model ...
Epoch: 4 cost time: 48.2597131729126
Epoch: 4, Steps: 32 | Train Loss: 3.632 Vali Loss: 22.197 Vali Acc: 0.534 Test Loss: 22.197 Test Acc: 0.534
Validation loss decreased (-0.450089 --> -0.534129).  Saving model ...
Epoch: 5 cost time: 50.65264916419983
Epoch: 5, Steps: 32 | Train Loss: 2.423 Vali Loss: 31.804 Vali Acc: 0.550 Test Loss: 31.804 Test Acc: 0.550
Validation loss decreased (-0.534129 --> -0.549300).  Saving model ...
Epoch: 6 cost time: 51.13460373878479
Epoch: 6, Steps: 32 | Train Loss: 4.376 Vali Loss: 27.763 Vali Acc: 0.504 Test Loss: 27.763 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 50.396421909332275
Epoch: 7, Steps: 32 | Train Loss: 1.769 Vali Loss: 37.262 Vali Acc: 0.565 Test Loss: 37.262 Test Acc: 0.565
Validation loss decreased (-0.549300 --> -0.564513).  Saving model ...
Epoch: 8 cost time: 53.47108268737793
Epoch: 8, Steps: 32 | Train Loss: 0.000 Vali Loss: 34.143 Vali Acc: 0.542 Test Loss: 34.143 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 53.62435555458069
Epoch: 9, Steps: 32 | Train Loss: 0.000 Vali Loss: 34.807 Vali Acc: 0.550 Test Loss: 34.807 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 53.39325213432312
Epoch: 10, Steps: 32 | Train Loss: 0.000 Vali Loss: 34.833 Vali Acc: 0.550 Test Loss: 34.833 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 52.260703325271606
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 34.834 Vali Acc: 0.550 Test Loss: 34.834 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 52.82372283935547
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 34.834 Vali Acc: 0.550 Test Loss: 34.834 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 53.026031255722046
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 34.834 Vali Acc: 0.550 Test Loss: 34.834 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 52.95516109466553
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 34.834 Vali Acc: 0.550 Test Loss: 34.834 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 53.051575660705566
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 34.834 Vali Acc: 0.550 Test Loss: 34.834 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 52.63389039039612
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 34.834 Vali Acc: 0.550 Test Loss: 34.834 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 53.14012813568115
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 34.834 Vali Acc: 0.550 Test Loss: 34.834 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma3597_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 6316229
model size : 32.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1799                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 24.215797185897827
Epoch: 1, Steps: 32 | Train Loss: 6.322 Vali Loss: 14.442 Vali Acc: 0.237 Test Loss: 14.442 Test Acc: 0.237
Validation loss decreased (inf --> -0.236497).  Saving model ...
Epoch: 2 cost time: 24.13182806968689
Epoch: 2, Steps: 32 | Train Loss: 9.133 Vali Loss: 18.439 Vali Acc: 0.427 Test Loss: 18.439 Test Acc: 0.427
Validation loss decreased (-0.236497 --> -0.427297).  Saving model ...
Epoch: 3 cost time: 26.4805326461792
Epoch: 3, Steps: 32 | Train Loss: 3.872 Vali Loss: 24.598 Vali Acc: 0.504 Test Loss: 24.598 Test Acc: 0.504
Validation loss decreased (-0.427297 --> -0.503571).  Saving model ...
Epoch: 4 cost time: 29.324920654296875
Epoch: 4, Steps: 32 | Train Loss: 5.245 Vali Loss: 16.665 Vali Acc: 0.458 Test Loss: 16.665 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 29.428802967071533
Epoch: 5, Steps: 32 | Train Loss: 2.284 Vali Loss: 32.882 Vali Acc: 0.504 Test Loss: 32.882 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 30.725093364715576
Epoch: 6, Steps: 32 | Train Loss: 3.501 Vali Loss: 37.830 Vali Acc: 0.511 Test Loss: 37.830 Test Acc: 0.511
Validation loss decreased (-0.503571 --> -0.511072).  Saving model ...
Epoch: 7 cost time: 30.52269196510315
Epoch: 7, Steps: 32 | Train Loss: 3.756 Vali Loss: 54.219 Vali Acc: 0.511 Test Loss: 54.219 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 30.492858409881592
Epoch: 8, Steps: 32 | Train Loss: 4.949 Vali Loss: 32.594 Vali Acc: 0.458 Test Loss: 32.594 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 30.46866726875305
Epoch: 9, Steps: 32 | Train Loss: 0.654 Vali Loss: 47.763 Vali Acc: 0.366 Test Loss: 47.763 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 30.009043216705322
Epoch: 10, Steps: 32 | Train Loss: 5.013 Vali Loss: 51.931 Vali Acc: 0.504 Test Loss: 51.931 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 30.328126668930054
Epoch: 11, Steps: 32 | Train Loss: 0.700 Vali Loss: 71.053 Vali Acc: 0.321 Test Loss: 71.053 Test Acc: 0.321
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 30.17031955718994
Epoch: 12, Steps: 32 | Train Loss: 1.776 Vali Loss: 72.341 Vali Acc: 0.382 Test Loss: 72.341 Test Acc: 0.382
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 30.348485708236694
Epoch: 13, Steps: 32 | Train Loss: 1.050 Vali Loss: 86.039 Vali Acc: 0.550 Test Loss: 86.039 Test Acc: 0.550
Validation loss decreased (-0.511072 --> -0.548758).  Saving model ...
Epoch: 14 cost time: 30.40765929222107
Epoch: 14, Steps: 32 | Train Loss: 1.433 Vali Loss: 95.826 Vali Acc: 0.504 Test Loss: 95.826 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 30.213948249816895
Epoch: 15, Steps: 32 | Train Loss: 2.567 Vali Loss: 106.065 Vali Acc: 0.489 Test Loss: 106.065 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 30.517611980438232
Epoch: 16, Steps: 32 | Train Loss: 2.869 Vali Loss: 55.843 Vali Acc: 0.397 Test Loss: 55.843 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 30.56999182701111
Epoch: 17, Steps: 32 | Train Loss: 0.224 Vali Loss: 108.121 Vali Acc: 0.504 Test Loss: 108.121 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 30.445291996002197
Epoch: 18, Steps: 32 | Train Loss: 6.397 Vali Loss: 105.301 Vali Acc: 0.496 Test Loss: 105.301 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 30.63424277305603
Epoch: 19, Steps: 32 | Train Loss: 1.848 Vali Loss: 79.595 Vali Acc: 0.351 Test Loss: 79.595 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 30.902849674224854
Epoch: 20, Steps: 32 | Train Loss: 1.884 Vali Loss: 98.232 Vali Acc: 0.489 Test Loss: 98.232 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 30.272470951080322
Epoch: 21, Steps: 32 | Train Loss: 0.211 Vali Loss: 73.499 Vali Acc: 0.405 Test Loss: 73.499 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 30.948360204696655
Epoch: 22, Steps: 32 | Train Loss: 1.204 Vali Loss: 139.888 Vali Acc: 0.420 Test Loss: 139.888 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 30.87404441833496
Epoch: 23, Steps: 32 | Train Loss: 0.090 Vali Loss: 100.909 Vali Acc: 0.450 Test Loss: 100.909 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 6316229
model size : 32.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 18.267970323562622
Epoch: 1, Steps: 32 | Train Loss: 5.235 Vali Loss: 8.615 Vali Acc: 0.244 Test Loss: 8.615 Test Acc: 0.244
Validation loss decreased (inf --> -0.244189).  Saving model ...
Epoch: 2 cost time: 17.157760858535767
Epoch: 2, Steps: 32 | Train Loss: 4.279 Vali Loss: 15.263 Vali Acc: 0.305 Test Loss: 15.263 Test Acc: 0.305
Validation loss decreased (-0.244189 --> -0.305191).  Saving model ...
Epoch: 3 cost time: 17.66089415550232
Epoch: 3, Steps: 32 | Train Loss: 4.109 Vali Loss: 22.242 Vali Acc: 0.496 Test Loss: 22.242 Test Acc: 0.496
Validation loss decreased (-0.305191 --> -0.495961).  Saving model ...
Epoch: 4 cost time: 18.804620265960693
Epoch: 4, Steps: 32 | Train Loss: 3.700 Vali Loss: 31.508 Vali Acc: 0.374 Test Loss: 31.508 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 19.72515869140625
Epoch: 5, Steps: 32 | Train Loss: 5.695 Vali Loss: 36.781 Vali Acc: 0.305 Test Loss: 36.781 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 19.942117929458618
Epoch: 6, Steps: 32 | Train Loss: 3.910 Vali Loss: 65.278 Vali Acc: 0.511 Test Loss: 65.278 Test Acc: 0.511
Validation loss decreased (-0.495961 --> -0.510798).  Saving model ...
Epoch: 7 cost time: 19.542190551757812
Epoch: 7, Steps: 32 | Train Loss: 4.014 Vali Loss: 63.538 Vali Acc: 0.450 Test Loss: 63.538 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 20.476179838180542
Epoch: 8, Steps: 32 | Train Loss: 4.001 Vali Loss: 44.122 Vali Acc: 0.511 Test Loss: 44.122 Test Acc: 0.511
Validation loss decreased (-0.510798 --> -0.511009).  Saving model ...
Epoch: 9 cost time: 20.190358638763428
Epoch: 9, Steps: 32 | Train Loss: 0.414 Vali Loss: 59.208 Vali Acc: 0.450 Test Loss: 59.208 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 20.082568407058716
Epoch: 10, Steps: 32 | Train Loss: 1.476 Vali Loss: 68.272 Vali Acc: 0.542 Test Loss: 68.272 Test Acc: 0.542
Validation loss decreased (-0.511009 --> -0.541302).  Saving model ...
Epoch: 11 cost time: 20.330124378204346
Epoch: 11, Steps: 32 | Train Loss: 0.553 Vali Loss: 71.539 Vali Acc: 0.542 Test Loss: 71.539 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 20.115906238555908
Epoch: 12, Steps: 32 | Train Loss: 0.905 Vali Loss: 47.302 Vali Acc: 0.496 Test Loss: 47.302 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 19.527857542037964
Epoch: 13, Steps: 32 | Train Loss: 6.043 Vali Loss: 45.072 Vali Acc: 0.458 Test Loss: 45.072 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 19.678611278533936
Epoch: 14, Steps: 32 | Train Loss: 15.111 Vali Loss: 73.495 Vali Acc: 0.489 Test Loss: 73.495 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 19.65825629234314
Epoch: 15, Steps: 32 | Train Loss: 1.479 Vali Loss: 102.313 Vali Acc: 0.519 Test Loss: 102.313 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 20.201487064361572
Epoch: 16, Steps: 32 | Train Loss: 8.167 Vali Loss: 185.017 Vali Acc: 0.489 Test Loss: 185.017 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 20.500183820724487
Epoch: 17, Steps: 32 | Train Loss: 8.743 Vali Loss: 86.621 Vali Acc: 0.504 Test Loss: 86.621 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 20.189874410629272
Epoch: 18, Steps: 32 | Train Loss: 0.145 Vali Loss: 78.331 Vali Acc: 0.412 Test Loss: 78.331 Test Acc: 0.412
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 19.925941467285156
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 78.440 Vali Acc: 0.420 Test Loss: 78.440 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 19.638333082199097
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 78.448 Vali Acc: 0.420 Test Loss: 78.448 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 6316229
model size : 32.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         540                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma540_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 16.112261533737183
Epoch: 1, Steps: 32 | Train Loss: 6.203 Vali Loss: 6.215 Vali Acc: 0.290 Test Loss: 6.215 Test Acc: 0.290
Validation loss decreased (inf --> -0.290014).  Saving model ...
Epoch: 2 cost time: 14.433588743209839
Epoch: 2, Steps: 32 | Train Loss: 3.335 Vali Loss: 13.897 Vali Acc: 0.489 Test Loss: 13.897 Test Acc: 0.489
Validation loss decreased (-0.290014 --> -0.488411).  Saving model ...
Epoch: 3 cost time: 15.523281574249268
Epoch: 3, Steps: 32 | Train Loss: 8.919 Vali Loss: 34.691 Vali Acc: 0.435 Test Loss: 34.691 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 15.420234441757202
Epoch: 4, Steps: 32 | Train Loss: 5.455 Vali Loss: 20.913 Vali Acc: 0.405 Test Loss: 20.913 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 15.667760848999023
Epoch: 5, Steps: 32 | Train Loss: 2.295 Vali Loss: 28.801 Vali Acc: 0.412 Test Loss: 28.801 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 16.448214054107666
Epoch: 6, Steps: 32 | Train Loss: 0.167 Vali Loss: 22.892 Vali Acc: 0.519 Test Loss: 22.892 Test Acc: 0.519
Validation loss decreased (-0.488411 --> -0.518855).  Saving model ...
Epoch: 7 cost time: 16.722299337387085
Epoch: 7, Steps: 32 | Train Loss: 0.000 Vali Loss: 20.789 Vali Acc: 0.504 Test Loss: 20.789 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 16.748127698898315
Epoch: 8, Steps: 32 | Train Loss: 0.829 Vali Loss: 61.262 Vali Acc: 0.374 Test Loss: 61.262 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 16.268835306167603
Epoch: 9, Steps: 32 | Train Loss: 4.290 Vali Loss: 67.950 Vali Acc: 0.397 Test Loss: 67.950 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 16.244566917419434
Epoch: 10, Steps: 32 | Train Loss: 5.688 Vali Loss: 79.024 Vali Acc: 0.427 Test Loss: 79.024 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 16.053486585617065
Epoch: 11, Steps: 32 | Train Loss: 10.542 Vali Loss: 91.247 Vali Acc: 0.290 Test Loss: 91.247 Test Acc: 0.290
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 16.308719635009766
Epoch: 12, Steps: 32 | Train Loss: 2.028 Vali Loss: 86.137 Vali Acc: 0.382 Test Loss: 86.137 Test Acc: 0.382
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 16.165465831756592
Epoch: 13, Steps: 32 | Train Loss: 4.725 Vali Loss: 98.862 Vali Acc: 0.458 Test Loss: 98.862 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 16.105850219726562
Epoch: 14, Steps: 32 | Train Loss: 2.355 Vali Loss: 97.495 Vali Acc: 0.405 Test Loss: 97.495 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 16.357971906661987
Epoch: 15, Steps: 32 | Train Loss: 0.898 Vali Loss: 98.275 Vali Acc: 0.534 Test Loss: 98.275 Test Acc: 0.534
Validation loss decreased (-0.518855 --> -0.533368).  Saving model ...
Epoch: 16 cost time: 16.28032684326172
Epoch: 16, Steps: 32 | Train Loss: 0.880 Vali Loss: 87.011 Vali Acc: 0.489 Test Loss: 87.011 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 16.58626079559326
Epoch: 17, Steps: 32 | Train Loss: 0.981 Vali Loss: 68.284 Vali Acc: 0.466 Test Loss: 68.284 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 16.05206847190857
Epoch: 18, Steps: 32 | Train Loss: 1.423 Vali Loss: 163.796 Vali Acc: 0.489 Test Loss: 163.796 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 16.013103008270264
Epoch: 19, Steps: 32 | Train Loss: 1.143 Vali Loss: 154.871 Vali Acc: 0.359 Test Loss: 154.871 Test Acc: 0.359
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 16.305028200149536
Epoch: 20, Steps: 32 | Train Loss: 1.219 Vali Loss: 111.035 Vali Acc: 0.450 Test Loss: 111.035 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 16.303914546966553
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 128.304 Vali Acc: 0.450 Test Loss: 128.304 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 16.91819715499878
Epoch: 22, Steps: 32 | Train Loss: 0.094 Vali Loss: 113.466 Vali Acc: 0.282 Test Loss: 113.466 Test Acc: 0.282
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 16.387563705444336
Epoch: 23, Steps: 32 | Train Loss: 1.473 Vali Loss: 117.393 Vali Acc: 0.435 Test Loss: 117.393 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 16.95682191848755
Epoch: 24, Steps: 32 | Train Loss: 1.046 Vali Loss: 101.248 Vali Acc: 0.412 Test Loss: 101.248 Test Acc: 0.412
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 16.929733991622925
Epoch: 25, Steps: 32 | Train Loss: 0.205 Vali Loss: 166.966 Vali Acc: 0.458 Test Loss: 166.966 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma540_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 6316229
model size : 32.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.27297067642212
Epoch: 1, Steps: 32 | Train Loss: 6.675 Vali Loss: 11.483 Vali Acc: 0.237 Test Loss: 11.483 Test Acc: 0.237
Validation loss decreased (inf --> -0.236526).  Saving model ...
Epoch: 2 cost time: 13.566003322601318
Epoch: 2, Steps: 32 | Train Loss: 3.966 Vali Loss: 9.981 Vali Acc: 0.489 Test Loss: 9.981 Test Acc: 0.489
Validation loss decreased (-0.236526 --> -0.488450).  Saving model ...
Epoch: 3 cost time: 13.68803882598877
Epoch: 3, Steps: 32 | Train Loss: 2.109 Vali Loss: 34.569 Vali Acc: 0.458 Test Loss: 34.569 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 14.168739795684814
Epoch: 4, Steps: 32 | Train Loss: 7.240 Vali Loss: 25.777 Vali Acc: 0.504 Test Loss: 25.777 Test Acc: 0.504
Validation loss decreased (-0.488450 --> -0.503559).  Saving model ...
Epoch: 5 cost time: 13.865524768829346
Epoch: 5, Steps: 32 | Train Loss: 2.378 Vali Loss: 46.674 Vali Acc: 0.466 Test Loss: 46.674 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.381425857543945
Epoch: 6, Steps: 32 | Train Loss: 2.690 Vali Loss: 44.850 Vali Acc: 0.412 Test Loss: 44.850 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 13.890897035598755
Epoch: 7, Steps: 32 | Train Loss: 3.097 Vali Loss: 33.167 Vali Acc: 0.405 Test Loss: 33.167 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 14.460733652114868
Epoch: 8, Steps: 32 | Train Loss: 0.905 Vali Loss: 53.385 Vali Acc: 0.435 Test Loss: 53.385 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 14.223706245422363
Epoch: 9, Steps: 32 | Train Loss: 8.476 Vali Loss: 75.514 Vali Acc: 0.351 Test Loss: 75.514 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 13.640438318252563
Epoch: 10, Steps: 32 | Train Loss: 5.018 Vali Loss: 59.369 Vali Acc: 0.496 Test Loss: 59.369 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 13.959112644195557
Epoch: 11, Steps: 32 | Train Loss: 1.526 Vali Loss: 47.810 Vali Acc: 0.405 Test Loss: 47.810 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 14.186962604522705
Epoch: 12, Steps: 32 | Train Loss: 4.005 Vali Loss: 80.380 Vali Acc: 0.305 Test Loss: 80.380 Test Acc: 0.305
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 14.403601884841919
Epoch: 13, Steps: 32 | Train Loss: 1.476 Vali Loss: 103.995 Vali Acc: 0.351 Test Loss: 103.995 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 14.424367904663086
Epoch: 14, Steps: 32 | Train Loss: 2.320 Vali Loss: 63.234 Vali Acc: 0.458 Test Loss: 63.234 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 6316229
model size : 32.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.224014043807983
Epoch: 1, Steps: 32 | Train Loss: 6.587 Vali Loss: 8.620 Vali Acc: 0.267 Test Loss: 8.620 Test Acc: 0.267
Validation loss decreased (inf --> -0.267089).  Saving model ...
Epoch: 2 cost time: 12.451148271560669
Epoch: 2, Steps: 32 | Train Loss: 2.930 Vali Loss: 8.354 Vali Acc: 0.458 Test Loss: 8.354 Test Acc: 0.458
Validation loss decreased (-0.267089 --> -0.457932).  Saving model ...
Epoch: 3 cost time: 12.531241178512573
Epoch: 3, Steps: 32 | Train Loss: 3.166 Vali Loss: 13.362 Vali Acc: 0.534 Test Loss: 13.362 Test Acc: 0.534
Validation loss decreased (-0.457932 --> -0.534218).  Saving model ...
Epoch: 4 cost time: 12.70997953414917
Epoch: 4, Steps: 32 | Train Loss: 3.867 Vali Loss: 23.310 Vali Acc: 0.313 Test Loss: 23.310 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.064021825790405
Epoch: 5, Steps: 32 | Train Loss: 1.895 Vali Loss: 17.708 Vali Acc: 0.450 Test Loss: 17.708 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 13.278777122497559
Epoch: 6, Steps: 32 | Train Loss: 5.319 Vali Loss: 53.735 Vali Acc: 0.473 Test Loss: 53.735 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 13.747501850128174
Epoch: 7, Steps: 32 | Train Loss: 7.921 Vali Loss: 32.145 Vali Acc: 0.496 Test Loss: 32.145 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 13.730124473571777
Epoch: 8, Steps: 32 | Train Loss: 1.482 Vali Loss: 32.206 Vali Acc: 0.511 Test Loss: 32.206 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 13.765610694885254
Epoch: 9, Steps: 32 | Train Loss: 1.450 Vali Loss: 57.085 Vali Acc: 0.466 Test Loss: 57.085 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 14.341382265090942
Epoch: 10, Steps: 32 | Train Loss: 0.791 Vali Loss: 49.559 Vali Acc: 0.473 Test Loss: 49.559 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 13.735894441604614
Epoch: 11, Steps: 32 | Train Loss: 0.599 Vali Loss: 63.595 Vali Acc: 0.496 Test Loss: 63.595 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 13.557162284851074
Epoch: 12, Steps: 32 | Train Loss: 3.094 Vali Loss: 51.143 Vali Acc: 0.527 Test Loss: 51.143 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 13.982529640197754
Epoch: 13, Steps: 32 | Train Loss: 2.426 Vali Loss: 115.851 Vali Acc: 0.267 Test Loss: 115.851 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 6316229
model size : 32.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.179091453552246
Epoch: 1, Steps: 32 | Train Loss: 4.340 Vali Loss: 3.682 Vali Acc: 0.405 Test Loss: 3.682 Test Acc: 0.405
Validation loss decreased (inf --> -0.404543).  Saving model ...
Epoch: 2 cost time: 12.080693006515503
Epoch: 2, Steps: 32 | Train Loss: 5.241 Vali Loss: 5.501 Vali Acc: 0.527 Test Loss: 5.501 Test Acc: 0.527
Validation loss decreased (-0.404543 --> -0.526663).  Saving model ...
Epoch: 3 cost time: 12.531948804855347
Epoch: 3, Steps: 32 | Train Loss: 3.353 Vali Loss: 15.806 Vali Acc: 0.534 Test Loss: 15.806 Test Acc: 0.534
Validation loss decreased (-0.526663 --> -0.534193).  Saving model ...
Epoch: 4 cost time: 12.125412702560425
Epoch: 4, Steps: 32 | Train Loss: 7.159 Vali Loss: 26.253 Vali Acc: 0.427 Test Loss: 26.253 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.89097285270691
Epoch: 5, Steps: 32 | Train Loss: 1.249 Vali Loss: 28.057 Vali Acc: 0.489 Test Loss: 28.057 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 13.116161108016968
Epoch: 6, Steps: 32 | Train Loss: 1.008 Vali Loss: 18.920 Vali Acc: 0.534 Test Loss: 18.920 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 12.661872148513794
Epoch: 7, Steps: 32 | Train Loss: 2.219 Vali Loss: 16.903 Vali Acc: 0.496 Test Loss: 16.903 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 12.369096040725708
Epoch: 8, Steps: 32 | Train Loss: 0.276 Vali Loss: 21.722 Vali Acc: 0.435 Test Loss: 21.722 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 12.932716846466064
Epoch: 9, Steps: 32 | Train Loss: 3.734 Vali Loss: 51.553 Vali Acc: 0.359 Test Loss: 51.553 Test Acc: 0.359
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 12.88074779510498
Epoch: 10, Steps: 32 | Train Loss: 6.555 Vali Loss: 46.278 Vali Acc: 0.382 Test Loss: 46.278 Test Acc: 0.382
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 12.61361312866211
Epoch: 11, Steps: 32 | Train Loss: 4.845 Vali Loss: 60.085 Vali Acc: 0.389 Test Loss: 60.085 Test Acc: 0.389
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 11.933293581008911
Epoch: 12, Steps: 32 | Train Loss: 1.569 Vali Loss: 59.273 Vali Acc: 0.458 Test Loss: 59.273 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 11.827454805374146
Epoch: 13, Steps: 32 | Train Loss: 0.703 Vali Loss: 61.145 Vali Acc: 0.435 Test Loss: 61.145 Test Acc: 0.435
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df1024_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 6316229
model size : 32.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         8992                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df512_ma8992_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 81.46237516403198
Epoch: 1, Steps: 32 | Train Loss: 5.282 Vali Loss: 10.104 Vali Acc: 0.267 Test Loss: 10.104 Test Acc: 0.267
Validation loss decreased (inf --> -0.267075).  Saving model ...
Epoch: 2 cost time: 80.47522926330566
Epoch: 2, Steps: 32 | Train Loss: 6.179 Vali Loss: 16.208 Vali Acc: 0.473 Test Loss: 16.208 Test Acc: 0.473
Validation loss decreased (-0.267075 --> -0.473120).  Saving model ...
Epoch: 3 cost time: 96.74872779846191
Epoch: 3, Steps: 32 | Train Loss: 5.519 Vali Loss: 23.806 Vali Acc: 0.298 Test Loss: 23.806 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 99.76944255828857
Epoch: 4, Steps: 32 | Train Loss: 5.807 Vali Loss: 33.509 Vali Acc: 0.237 Test Loss: 33.509 Test Acc: 0.237
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 99.56137704849243
Epoch: 5, Steps: 32 | Train Loss: 10.227 Vali Loss: 24.377 Vali Acc: 0.519 Test Loss: 24.377 Test Acc: 0.519
Validation loss decreased (-0.473120 --> -0.518840).  Saving model ...
Epoch: 6 cost time: 112.81279230117798
Epoch: 6, Steps: 32 | Train Loss: 3.229 Vali Loss: 31.532 Vali Acc: 0.527 Test Loss: 31.532 Test Acc: 0.527
Validation loss decreased (-0.518840 --> -0.526402).  Saving model ...
Epoch: 7 cost time: 115.01921033859253
Epoch: 7, Steps: 32 | Train Loss: 1.524 Vali Loss: 32.911 Vali Acc: 0.534 Test Loss: 32.911 Test Acc: 0.534
Validation loss decreased (-0.526402 --> -0.534022).  Saving model ...
Epoch: 8 cost time: 114.96117329597473
Epoch: 8, Steps: 32 | Train Loss: 1.525 Vali Loss: 35.605 Vali Acc: 0.534 Test Loss: 35.605 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 109.06802773475647
Epoch: 9, Steps: 32 | Train Loss: 1.974 Vali Loss: 70.869 Vali Acc: 0.527 Test Loss: 70.869 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 111.38649272918701
Epoch: 10, Steps: 32 | Train Loss: 3.270 Vali Loss: 73.781 Vali Acc: 0.450 Test Loss: 73.781 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 113.96014547348022
Epoch: 11, Steps: 32 | Train Loss: 3.602 Vali Loss: 71.466 Vali Acc: 0.534 Test Loss: 71.466 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 113.34567189216614
Epoch: 12, Steps: 32 | Train Loss: 3.585 Vali Loss: 88.121 Vali Acc: 0.527 Test Loss: 88.121 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 115.4961953163147
Epoch: 13, Steps: 32 | Train Loss: 9.912 Vali Loss: 74.983 Vali Acc: 0.496 Test Loss: 74.983 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 113.22920417785645
Epoch: 14, Steps: 32 | Train Loss: 10.478 Vali Loss: 77.224 Vali Acc: 0.527 Test Loss: 77.224 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 113.1258659362793
Epoch: 15, Steps: 32 | Train Loss: 1.062 Vali Loss: 117.983 Vali Acc: 0.420 Test Loss: 117.983 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 113.63062572479248
Epoch: 16, Steps: 32 | Train Loss: 0.278 Vali Loss: 121.982 Vali Acc: 0.496 Test Loss: 121.982 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 113.00409078598022
Epoch: 17, Steps: 32 | Train Loss: 1.967 Vali Loss: 73.265 Vali Acc: 0.511 Test Loss: 73.265 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df512_ma8992_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 6119621
model size : 32.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         7194                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df512_ma7194_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 67.05301642417908
Epoch: 1, Steps: 32 | Train Loss: 5.591 Vali Loss: 13.318 Vali Acc: 0.275 Test Loss: 13.318 Test Acc: 0.275
Validation loss decreased (inf --> -0.274676).  Saving model ...
Epoch: 2 cost time: 68.03766465187073
Epoch: 2, Steps: 32 | Train Loss: 5.442 Vali Loss: 20.933 Vali Acc: 0.328 Test Loss: 20.933 Test Acc: 0.328
Validation loss decreased (-0.274676 --> -0.328035).  Saving model ...
Epoch: 3 cost time: 76.85421991348267
Epoch: 3, Steps: 32 | Train Loss: 7.520 Vali Loss: 19.243 Vali Acc: 0.298 Test Loss: 19.243 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 86.01114392280579
Epoch: 4, Steps: 32 | Train Loss: 3.818 Vali Loss: 23.552 Vali Acc: 0.366 Test Loss: 23.552 Test Acc: 0.366
Validation loss decreased (-0.328035 --> -0.366177).  Saving model ...
Epoch: 5 cost time: 94.36755967140198
Epoch: 5, Steps: 32 | Train Loss: 1.193 Vali Loss: 32.311 Vali Acc: 0.344 Test Loss: 32.311 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 88.74187684059143
Epoch: 6, Steps: 32 | Train Loss: 7.410 Vali Loss: 36.659 Vali Acc: 0.496 Test Loss: 36.659 Test Acc: 0.496
Validation loss decreased (-0.366177 --> -0.495817).  Saving model ...
Epoch: 7 cost time: 88.7970495223999
Epoch: 7, Steps: 32 | Train Loss: 3.050 Vali Loss: 54.071 Vali Acc: 0.534 Test Loss: 54.071 Test Acc: 0.534
Validation loss decreased (-0.495817 --> -0.533810).  Saving model ...
Epoch: 8 cost time: 93.70088839530945
Epoch: 8, Steps: 32 | Train Loss: 1.565 Vali Loss: 37.787 Vali Acc: 0.397 Test Loss: 37.787 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 90.97295880317688
Epoch: 9, Steps: 32 | Train Loss: 1.688 Vali Loss: 38.368 Vali Acc: 0.450 Test Loss: 38.368 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 91.39684104919434
Epoch: 10, Steps: 32 | Train Loss: 5.176 Vali Loss: 53.056 Vali Acc: 0.389 Test Loss: 53.056 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 90.08747458457947
Epoch: 11, Steps: 32 | Train Loss: 3.523 Vali Loss: 59.042 Vali Acc: 0.504 Test Loss: 59.042 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 91.54316687583923
Epoch: 12, Steps: 32 | Train Loss: 2.699 Vali Loss: 82.059 Vali Acc: 0.519 Test Loss: 82.059 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 94.2909882068634
Epoch: 13, Steps: 32 | Train Loss: 0.846 Vali Loss: 81.184 Vali Acc: 0.542 Test Loss: 81.184 Test Acc: 0.542
Validation loss decreased (-0.533810 --> -0.541173).  Saving model ...
Epoch: 14 cost time: 95.16261649131775
Epoch: 14, Steps: 32 | Train Loss: 0.217 Vali Loss: 66.479 Vali Acc: 0.496 Test Loss: 66.479 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 90.71999883651733
Epoch: 15, Steps: 32 | Train Loss: 2.703 Vali Loss: 100.949 Vali Acc: 0.298 Test Loss: 100.949 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 93.06428360939026
Epoch: 16, Steps: 32 | Train Loss: 1.609 Vali Loss: 88.665 Vali Acc: 0.389 Test Loss: 88.665 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 91.3059515953064
Epoch: 17, Steps: 32 | Train Loss: 1.097 Vali Loss: 74.541 Vali Acc: 0.359 Test Loss: 74.541 Test Acc: 0.359
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 89.98991537094116
Epoch: 18, Steps: 32 | Train Loss: 7.166 Vali Loss: 78.318 Vali Acc: 0.504 Test Loss: 78.318 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 93.97376036643982
Epoch: 19, Steps: 32 | Train Loss: 8.437 Vali Loss: 120.549 Vali Acc: 0.389 Test Loss: 120.549 Test Acc: 0.389
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 92.0235288143158
Epoch: 20, Steps: 32 | Train Loss: 1.739 Vali Loss: 87.180 Vali Acc: 0.443 Test Loss: 87.180 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 89.95434212684631
Epoch: 21, Steps: 32 | Train Loss: 7.623 Vali Loss: 107.401 Vali Acc: 0.351 Test Loss: 107.401 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 92.97147345542908
Epoch: 22, Steps: 32 | Train Loss: 2.311 Vali Loss: 199.780 Vali Acc: 0.313 Test Loss: 199.780 Test Acc: 0.313
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 92.5117700099945
Epoch: 23, Steps: 32 | Train Loss: 1.013 Vali Loss: 148.102 Vali Acc: 0.557 Test Loss: 148.102 Test Acc: 0.557
Validation loss decreased (-0.541173 --> -0.555771).  Saving model ...
Epoch: 24 cost time: 91.44838261604309
Epoch: 24, Steps: 32 | Train Loss: 1.435 Vali Loss: 104.378 Vali Acc: 0.458 Test Loss: 104.378 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 92.16122770309448
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 161.813 Vali Acc: 0.534 Test Loss: 161.813 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 93.1903600692749
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 165.450 Vali Acc: 0.534 Test Loss: 165.450 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 92.62215042114258
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 165.581 Vali Acc: 0.534 Test Loss: 165.581 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 92.68841290473938
Epoch: 28, Steps: 32 | Train Loss: 0.000 Vali Loss: 165.586 Vali Acc: 0.534 Test Loss: 165.586 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 92.39164876937866
Epoch: 29, Steps: 32 | Train Loss: 0.000 Vali Loss: 165.586 Vali Acc: 0.534 Test Loss: 165.586 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 91.84987950325012
Epoch: 30, Steps: 32 | Train Loss: 0.000 Vali Loss: 165.586 Vali Acc: 0.534 Test Loss: 165.586 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 93.7414653301239
Epoch: 31, Steps: 32 | Train Loss: 0.000 Vali Loss: 165.586 Vali Acc: 0.534 Test Loss: 165.586 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 91.97387504577637
Epoch: 32, Steps: 32 | Train Loss: 0.000 Vali Loss: 165.586 Vali Acc: 0.534 Test Loss: 165.586 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 92.87020325660706
Epoch: 33, Steps: 32 | Train Loss: 0.000 Vali Loss: 165.586 Vali Acc: 0.534 Test Loss: 165.586 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df512_ma7194_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 6119621
model size : 32.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5396                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df512_ma5396_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 52.17243313789368
Epoch: 1, Steps: 32 | Train Loss: 6.323 Vali Loss: 14.271 Vali Acc: 0.198 Test Loss: 14.271 Test Acc: 0.198
Validation loss decreased (inf --> -0.198331).  Saving model ...
Epoch: 2 cost time: 51.74625301361084
Epoch: 2, Steps: 32 | Train Loss: 5.750 Vali Loss: 16.393 Vali Acc: 0.473 Test Loss: 16.393 Test Acc: 0.473
Validation loss decreased (-0.198331 --> -0.473119).  Saving model ...
Epoch: 3 cost time: 57.188077211380005
Epoch: 3, Steps: 32 | Train Loss: 2.941 Vali Loss: 21.355 Vali Acc: 0.321 Test Loss: 21.355 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 64.06741189956665
Epoch: 4, Steps: 32 | Train Loss: 6.027 Vali Loss: 15.973 Vali Acc: 0.374 Test Loss: 15.973 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 67.9965455532074
Epoch: 5, Steps: 32 | Train Loss: 5.708 Vali Loss: 45.815 Vali Acc: 0.275 Test Loss: 45.815 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 69.75882172584534
Epoch: 6, Steps: 32 | Train Loss: 4.333 Vali Loss: 25.659 Vali Acc: 0.519 Test Loss: 25.659 Test Acc: 0.519
Validation loss decreased (-0.473119 --> -0.518827).  Saving model ...
Epoch: 7 cost time: 71.67245316505432
Epoch: 7, Steps: 32 | Train Loss: 1.650 Vali Loss: 40.279 Vali Acc: 0.573 Test Loss: 40.279 Test Acc: 0.573
Validation loss decreased (-0.518827 --> -0.572116).  Saving model ...
Epoch: 8 cost time: 70.65036177635193
Epoch: 8, Steps: 32 | Train Loss: 3.597 Vali Loss: 75.969 Vali Acc: 0.489 Test Loss: 75.969 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 72.75559449195862
Epoch: 9, Steps: 32 | Train Loss: 1.430 Vali Loss: 53.156 Vali Acc: 0.519 Test Loss: 53.156 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 69.40505075454712
Epoch: 10, Steps: 32 | Train Loss: 2.789 Vali Loss: 82.545 Vali Acc: 0.527 Test Loss: 82.545 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 68.16251111030579
Epoch: 11, Steps: 32 | Train Loss: 12.220 Vali Loss: 80.088 Vali Acc: 0.351 Test Loss: 80.088 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 67.87519526481628
Epoch: 12, Steps: 32 | Train Loss: 5.075 Vali Loss: 106.000 Vali Acc: 0.489 Test Loss: 106.000 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 68.21975636482239
Epoch: 13, Steps: 32 | Train Loss: 1.252 Vali Loss: 71.997 Vali Acc: 0.389 Test Loss: 71.997 Test Acc: 0.389
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 70.10726284980774
Epoch: 14, Steps: 32 | Train Loss: 1.995 Vali Loss: 85.196 Vali Acc: 0.481 Test Loss: 85.196 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 71.45040917396545
Epoch: 15, Steps: 32 | Train Loss: 3.020 Vali Loss: 90.061 Vali Acc: 0.458 Test Loss: 90.061 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 71.54888463020325
Epoch: 16, Steps: 32 | Train Loss: 1.828 Vali Loss: 107.153 Vali Acc: 0.504 Test Loss: 107.153 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 70.95131516456604
Epoch: 17, Steps: 32 | Train Loss: 1.780 Vali Loss: 86.589 Vali Acc: 0.397 Test Loss: 86.589 Test Acc: 0.397
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df512_ma5396_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 6119621
model size : 32.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3597                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df512_ma3597_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 37.94360971450806
Epoch: 1, Steps: 32 | Train Loss: 5.197 Vali Loss: 16.780 Vali Acc: 0.221 Test Loss: 16.780 Test Acc: 0.221
Validation loss decreased (inf --> -0.221206).  Saving model ...
Epoch: 2 cost time: 37.27629256248474
Epoch: 2, Steps: 32 | Train Loss: 5.406 Vali Loss: 17.897 Vali Acc: 0.282 Test Loss: 17.897 Test Acc: 0.282
Validation loss decreased (-0.221206 --> -0.282264).  Saving model ...
Epoch: 3 cost time: 40.435248613357544
Epoch: 3, Steps: 32 | Train Loss: 2.269 Vali Loss: 20.481 Vali Acc: 0.221 Test Loss: 20.481 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 45.508885622024536
Epoch: 4, Steps: 32 | Train Loss: 6.335 Vali Loss: 18.518 Vali Acc: 0.344 Test Loss: 18.518 Test Acc: 0.344
Validation loss decreased (-0.282264 --> -0.343326).  Saving model ...
Epoch: 5 cost time: 48.58629536628723
Epoch: 5, Steps: 32 | Train Loss: 3.281 Vali Loss: 25.242 Vali Acc: 0.427 Test Loss: 25.242 Test Acc: 0.427
Validation loss decreased (-0.343326 --> -0.427228).  Saving model ...
Epoch: 6 cost time: 50.52606701850891
Epoch: 6, Steps: 32 | Train Loss: 2.931 Vali Loss: 33.344 Vali Acc: 0.458 Test Loss: 33.344 Test Acc: 0.458
Validation loss decreased (-0.427228 --> -0.457682).  Saving model ...
Epoch: 7 cost time: 49.684792280197144
Epoch: 7, Steps: 32 | Train Loss: 3.443 Vali Loss: 57.648 Vali Acc: 0.260 Test Loss: 57.648 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 48.784202337265015
Epoch: 8, Steps: 32 | Train Loss: 2.819 Vali Loss: 44.397 Vali Acc: 0.458 Test Loss: 44.397 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 51.14732766151428
Epoch: 9, Steps: 32 | Train Loss: 1.906 Vali Loss: 42.003 Vali Acc: 0.420 Test Loss: 42.003 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 50.98967504501343
Epoch: 10, Steps: 32 | Train Loss: 1.716 Vali Loss: 94.989 Vali Acc: 0.481 Test Loss: 94.989 Test Acc: 0.481
Validation loss decreased (-0.457682 --> -0.479966).  Saving model ...
Epoch: 11 cost time: 48.96022129058838
Epoch: 11, Steps: 32 | Train Loss: 5.613 Vali Loss: 83.162 Vali Acc: 0.489 Test Loss: 83.162 Test Acc: 0.489
Validation loss decreased (-0.479966 --> -0.487718).  Saving model ...
Epoch: 12 cost time: 47.74276375770569
Epoch: 12, Steps: 32 | Train Loss: 3.700 Vali Loss: 97.403 Vali Acc: 0.397 Test Loss: 97.403 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 50.30390667915344
Epoch: 13, Steps: 32 | Train Loss: 2.980 Vali Loss: 116.636 Vali Acc: 0.519 Test Loss: 116.636 Test Acc: 0.519
Validation loss decreased (-0.487718 --> -0.517918).  Saving model ...
Epoch: 14 cost time: 49.22818684577942
Epoch: 14, Steps: 32 | Train Loss: 6.651 Vali Loss: 121.900 Vali Acc: 0.496 Test Loss: 121.900 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 50.05682682991028
Epoch: 15, Steps: 32 | Train Loss: 1.417 Vali Loss: 111.572 Vali Acc: 0.351 Test Loss: 111.572 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 51.139812707901
Epoch: 16, Steps: 32 | Train Loss: 0.556 Vali Loss: 92.251 Vali Acc: 0.374 Test Loss: 92.251 Test Acc: 0.374
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 50.36818242073059
Epoch: 17, Steps: 32 | Train Loss: 0.129 Vali Loss: 83.912 Vali Acc: 0.435 Test Loss: 83.912 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 49.91523885726929
Epoch: 18, Steps: 32 | Train Loss: 0.417 Vali Loss: 89.373 Vali Acc: 0.382 Test Loss: 89.373 Test Acc: 0.382
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 50.36602425575256
Epoch: 19, Steps: 32 | Train Loss: 1.006 Vali Loss: 101.795 Vali Acc: 0.550 Test Loss: 101.795 Test Acc: 0.550
Validation loss decreased (-0.517918 --> -0.548600).  Saving model ...
Epoch: 20 cost time: 50.01130771636963
Epoch: 20, Steps: 32 | Train Loss: 0.581 Vali Loss: 122.723 Vali Acc: 0.511 Test Loss: 122.723 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 49.96150183677673
Epoch: 21, Steps: 32 | Train Loss: 3.210 Vali Loss: 110.790 Vali Acc: 0.412 Test Loss: 110.790 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 49.86715841293335
Epoch: 22, Steps: 32 | Train Loss: 3.218 Vali Loss: 106.337 Vali Acc: 0.473 Test Loss: 106.337 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 49.51468014717102
Epoch: 23, Steps: 32 | Train Loss: 5.972 Vali Loss: 201.777 Vali Acc: 0.397 Test Loss: 201.777 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 49.40272760391235
Epoch: 24, Steps: 32 | Train Loss: 3.307 Vali Loss: 104.471 Vali Acc: 0.504 Test Loss: 104.471 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 50.730767250061035
Epoch: 25, Steps: 32 | Train Loss: 2.487 Vali Loss: 166.212 Vali Acc: 0.489 Test Loss: 166.212 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 49.4281861782074
Epoch: 26, Steps: 32 | Train Loss: 3.031 Vali Loss: 122.655 Vali Acc: 0.427 Test Loss: 122.655 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 49.083998680114746
Epoch: 27, Steps: 32 | Train Loss: 1.165 Vali Loss: 140.780 Vali Acc: 0.534 Test Loss: 140.780 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 50.5704402923584
Epoch: 28, Steps: 32 | Train Loss: 0.036 Vali Loss: 219.071 Vali Acc: 0.519 Test Loss: 219.071 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 50.22148895263672
Epoch: 29, Steps: 32 | Train Loss: 0.945 Vali Loss: 149.637 Vali Acc: 0.550 Test Loss: 149.637 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df512_ma3597_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 6119621
model size : 32.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1799                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df512_ma1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 23.257251739501953
Epoch: 1, Steps: 32 | Train Loss: 6.109 Vali Loss: 8.763 Vali Acc: 0.252 Test Loss: 8.763 Test Acc: 0.252
Validation loss decreased (inf --> -0.251821).  Saving model ...
Epoch: 2 cost time: 22.965949296951294
Epoch: 2, Steps: 32 | Train Loss: 6.208 Vali Loss: 22.901 Vali Acc: 0.336 Test Loss: 22.901 Test Acc: 0.336
Validation loss decreased (-0.251821 --> -0.335649).  Saving model ...
Epoch: 3 cost time: 25.85346794128418
Epoch: 3, Steps: 32 | Train Loss: 5.056 Vali Loss: 21.859 Vali Acc: 0.481 Test Loss: 21.859 Test Acc: 0.481
Validation loss decreased (-0.335649 --> -0.480697).  Saving model ...
Epoch: 4 cost time: 27.546303272247314
Epoch: 4, Steps: 32 | Train Loss: 8.124 Vali Loss: 32.051 Vali Acc: 0.519 Test Loss: 32.051 Test Acc: 0.519
Validation loss decreased (-0.480697 --> -0.518763).  Saving model ...
Epoch: 5 cost time: 29.354567766189575
Epoch: 5, Steps: 32 | Train Loss: 5.121 Vali Loss: 35.735 Vali Acc: 0.366 Test Loss: 35.735 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 29.332802295684814
Epoch: 6, Steps: 32 | Train Loss: 4.091 Vali Loss: 43.708 Vali Acc: 0.550 Test Loss: 43.708 Test Acc: 0.550
Validation loss decreased (-0.518763 --> -0.549181).  Saving model ...
Epoch: 7 cost time: 28.823221683502197
Epoch: 7, Steps: 32 | Train Loss: 4.267 Vali Loss: 47.686 Vali Acc: 0.374 Test Loss: 47.686 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 29.93785285949707
Epoch: 8, Steps: 32 | Train Loss: 2.494 Vali Loss: 38.579 Vali Acc: 0.359 Test Loss: 38.579 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 29.809539556503296
Epoch: 9, Steps: 32 | Train Loss: 1.254 Vali Loss: 49.184 Vali Acc: 0.435 Test Loss: 49.184 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 29.980643272399902
Epoch: 10, Steps: 32 | Train Loss: 0.388 Vali Loss: 52.233 Vali Acc: 0.496 Test Loss: 52.233 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 29.62727189064026
Epoch: 11, Steps: 32 | Train Loss: 1.096 Vali Loss: 57.594 Vali Acc: 0.496 Test Loss: 57.594 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 29.066572189331055
Epoch: 12, Steps: 32 | Train Loss: 4.133 Vali Loss: 72.759 Vali Acc: 0.420 Test Loss: 72.759 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 28.994604349136353
Epoch: 13, Steps: 32 | Train Loss: 2.592 Vali Loss: 92.225 Vali Acc: 0.511 Test Loss: 92.225 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 28.646962881088257
Epoch: 14, Steps: 32 | Train Loss: 2.043 Vali Loss: 190.280 Vali Acc: 0.496 Test Loss: 190.280 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 29.438135147094727
Epoch: 15, Steps: 32 | Train Loss: 4.054 Vali Loss: 99.332 Vali Acc: 0.344 Test Loss: 99.332 Test Acc: 0.344
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 28.837703704833984
Epoch: 16, Steps: 32 | Train Loss: 3.880 Vali Loss: 93.177 Vali Acc: 0.496 Test Loss: 93.177 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df512_ma1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 6119621
model size : 32.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df512_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 17.29640483856201
Epoch: 1, Steps: 32 | Train Loss: 4.808 Vali Loss: 7.496 Vali Acc: 0.267 Test Loss: 7.496 Test Acc: 0.267
Validation loss decreased (inf --> -0.267101).  Saving model ...
Epoch: 2 cost time: 15.472532272338867
Epoch: 2, Steps: 32 | Train Loss: 3.353 Vali Loss: 13.932 Vali Acc: 0.420 Test Loss: 13.932 Test Acc: 0.420
Validation loss decreased (-0.267101 --> -0.419708).  Saving model ...
Epoch: 3 cost time: 16.42947506904602
Epoch: 3, Steps: 32 | Train Loss: 6.339 Vali Loss: 14.229 Vali Acc: 0.443 Test Loss: 14.229 Test Acc: 0.443
Validation loss decreased (-0.419708 --> -0.442606).  Saving model ...
Epoch: 4 cost time: 17.90570592880249
Epoch: 4, Steps: 32 | Train Loss: 3.450 Vali Loss: 24.193 Vali Acc: 0.351 Test Loss: 24.193 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 18.634656190872192
Epoch: 5, Steps: 32 | Train Loss: 2.855 Vali Loss: 25.040 Vali Acc: 0.450 Test Loss: 25.040 Test Acc: 0.450
Validation loss decreased (-0.442606 --> -0.450131).  Saving model ...
Epoch: 6 cost time: 19.336204528808594
Epoch: 6, Steps: 32 | Train Loss: 0.096 Vali Loss: 31.635 Vali Acc: 0.420 Test Loss: 31.635 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 17.755573749542236
Epoch: 7, Steps: 32 | Train Loss: 2.671 Vali Loss: 37.239 Vali Acc: 0.519 Test Loss: 37.239 Test Acc: 0.519
Validation loss decreased (-0.450131 --> -0.518712).  Saving model ...
Epoch: 8 cost time: 18.685556173324585
Epoch: 8, Steps: 32 | Train Loss: 5.794 Vali Loss: 32.968 Vali Acc: 0.466 Test Loss: 32.968 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 19.05050492286682
Epoch: 9, Steps: 32 | Train Loss: 3.841 Vali Loss: 63.707 Vali Acc: 0.504 Test Loss: 63.707 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 19.07100558280945
Epoch: 10, Steps: 32 | Train Loss: 1.216 Vali Loss: 57.774 Vali Acc: 0.550 Test Loss: 57.774 Test Acc: 0.550
Validation loss decreased (-0.518712 --> -0.549041).  Saving model ...
Epoch: 11 cost time: 18.542709589004517
Epoch: 11, Steps: 32 | Train Loss: 0.906 Vali Loss: 58.167 Vali Acc: 0.550 Test Loss: 58.167 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 18.785722255706787
Epoch: 12, Steps: 32 | Train Loss: 0.773 Vali Loss: 35.952 Vali Acc: 0.519 Test Loss: 35.952 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 18.79045820236206
Epoch: 13, Steps: 32 | Train Loss: 0.469 Vali Loss: 59.064 Vali Acc: 0.565 Test Loss: 59.064 Test Acc: 0.565
Validation loss decreased (-0.549041 --> -0.564295).  Saving model ...
Epoch: 14 cost time: 18.471025705337524
Epoch: 14, Steps: 32 | Train Loss: 1.709 Vali Loss: 35.356 Vali Acc: 0.527 Test Loss: 35.356 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 18.900106191635132
Epoch: 15, Steps: 32 | Train Loss: 0.961 Vali Loss: 42.041 Vali Acc: 0.511 Test Loss: 42.041 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 18.230138540267944
Epoch: 16, Steps: 32 | Train Loss: 4.433 Vali Loss: 113.222 Vali Acc: 0.542 Test Loss: 113.222 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 18.854439735412598
Epoch: 17, Steps: 32 | Train Loss: 3.831 Vali Loss: 109.291 Vali Acc: 0.435 Test Loss: 109.291 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 18.39076018333435
Epoch: 18, Steps: 32 | Train Loss: 3.923 Vali Loss: 75.857 Vali Acc: 0.450 Test Loss: 75.857 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 19.286386013031006
Epoch: 19, Steps: 32 | Train Loss: 0.983 Vali Loss: 82.288 Vali Acc: 0.458 Test Loss: 82.288 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 19.640093326568604
Epoch: 20, Steps: 32 | Train Loss: 0.126 Vali Loss: 74.150 Vali Acc: 0.374 Test Loss: 74.150 Test Acc: 0.374
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 18.890308618545532
Epoch: 21, Steps: 32 | Train Loss: 1.906 Vali Loss: 67.113 Vali Acc: 0.489 Test Loss: 67.113 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 18.82603693008423
Epoch: 22, Steps: 32 | Train Loss: 0.646 Vali Loss: 88.978 Vali Acc: 0.489 Test Loss: 88.978 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 19.14662528038025
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 90.521 Vali Acc: 0.496 Test Loss: 90.521 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df512_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 6119621
model size : 32.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         540                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df512_ma540_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.417545080184937
Epoch: 1, Steps: 32 | Train Loss: 6.380 Vali Loss: 8.885 Vali Acc: 0.260 Test Loss: 8.885 Test Acc: 0.260
Validation loss decreased (inf --> -0.259453).  Saving model ...
Epoch: 2 cost time: 13.163670778274536
Epoch: 2, Steps: 32 | Train Loss: 3.667 Vali Loss: 12.163 Vali Acc: 0.260 Test Loss: 12.163 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.91573715209961
Epoch: 3, Steps: 32 | Train Loss: 3.726 Vali Loss: 26.885 Vali Acc: 0.351 Test Loss: 26.885 Test Acc: 0.351
Validation loss decreased (-0.259453 --> -0.350876).  Saving model ...
Epoch: 4 cost time: 14.14110517501831
Epoch: 4, Steps: 32 | Train Loss: 4.761 Vali Loss: 18.309 Vali Acc: 0.412 Test Loss: 18.309 Test Acc: 0.412
Validation loss decreased (-0.350876 --> -0.412031).  Saving model ...
Epoch: 5 cost time: 14.923288822174072
Epoch: 5, Steps: 32 | Train Loss: 3.329 Vali Loss: 52.823 Vali Acc: 0.252 Test Loss: 52.823 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 14.803245067596436
Epoch: 6, Steps: 32 | Train Loss: 11.959 Vali Loss: 54.735 Vali Acc: 0.298 Test Loss: 54.735 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 15.220141410827637
Epoch: 7, Steps: 32 | Train Loss: 3.759 Vali Loss: 35.645 Vali Acc: 0.427 Test Loss: 35.645 Test Acc: 0.427
Validation loss decreased (-0.412031 --> -0.427124).  Saving model ...
Epoch: 8 cost time: 15.076058387756348
Epoch: 8, Steps: 32 | Train Loss: 1.881 Vali Loss: 53.941 Vali Acc: 0.450 Test Loss: 53.941 Test Acc: 0.450
Validation loss decreased (-0.427124 --> -0.449842).  Saving model ...
Epoch: 9 cost time: 15.203535318374634
Epoch: 9, Steps: 32 | Train Loss: 0.399 Vali Loss: 90.978 Vali Acc: 0.489 Test Loss: 90.978 Test Acc: 0.489
Validation loss decreased (-0.449842 --> -0.487640).  Saving model ...
Epoch: 10 cost time: 15.54656195640564
Epoch: 10, Steps: 32 | Train Loss: 0.367 Vali Loss: 69.527 Vali Acc: 0.435 Test Loss: 69.527 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 15.995603561401367
Epoch: 11, Steps: 32 | Train Loss: 0.691 Vali Loss: 66.125 Vali Acc: 0.481 Test Loss: 66.125 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 15.446786880493164
Epoch: 12, Steps: 32 | Train Loss: 2.618 Vali Loss: 107.934 Vali Acc: 0.519 Test Loss: 107.934 Test Acc: 0.519
Validation loss decreased (-0.487640 --> -0.518005).  Saving model ...
Epoch: 13 cost time: 16.100409746170044
Epoch: 13, Steps: 32 | Train Loss: 1.255 Vali Loss: 88.658 Vali Acc: 0.489 Test Loss: 88.658 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 15.950156927108765
Epoch: 14, Steps: 32 | Train Loss: 1.506 Vali Loss: 165.321 Vali Acc: 0.473 Test Loss: 165.321 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 16.069782972335815
Epoch: 15, Steps: 32 | Train Loss: 8.394 Vali Loss: 109.768 Vali Acc: 0.450 Test Loss: 109.768 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 15.840112924575806
Epoch: 16, Steps: 32 | Train Loss: 0.787 Vali Loss: 98.829 Vali Acc: 0.443 Test Loss: 98.829 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 15.860923528671265
Epoch: 17, Steps: 32 | Train Loss: 2.653 Vali Loss: 129.714 Vali Acc: 0.450 Test Loss: 129.714 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 15.258991479873657
Epoch: 18, Steps: 32 | Train Loss: 6.334 Vali Loss: 89.601 Vali Acc: 0.481 Test Loss: 89.601 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 15.30557370185852
Epoch: 19, Steps: 32 | Train Loss: 1.085 Vali Loss: 99.759 Vali Acc: 0.473 Test Loss: 99.759 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 15.465498685836792
Epoch: 20, Steps: 32 | Train Loss: 1.152 Vali Loss: 97.352 Vali Acc: 0.481 Test Loss: 97.352 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 15.171968460083008
Epoch: 21, Steps: 32 | Train Loss: 0.377 Vali Loss: 76.964 Vali Acc: 0.443 Test Loss: 76.964 Test Acc: 0.443
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 14.793920040130615
Epoch: 22, Steps: 32 | Train Loss: 0.423 Vali Loss: 97.630 Vali Acc: 0.458 Test Loss: 97.630 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df512_ma540_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 6119621
model size : 32.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df512_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.861412286758423
Epoch: 1, Steps: 32 | Train Loss: 4.682 Vali Loss: 14.850 Vali Acc: 0.206 Test Loss: 14.850 Test Acc: 0.206
Validation loss decreased (inf --> -0.205958).  Saving model ...
Epoch: 2 cost time: 11.81277847290039
Epoch: 2, Steps: 32 | Train Loss: 5.723 Vali Loss: 11.070 Vali Acc: 0.435 Test Loss: 11.070 Test Acc: 0.435
Validation loss decreased (-0.205958 --> -0.435004).  Saving model ...
Epoch: 3 cost time: 12.66730284690857
Epoch: 3, Steps: 32 | Train Loss: 2.926 Vali Loss: 21.509 Vali Acc: 0.366 Test Loss: 21.509 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.073012351989746
Epoch: 4, Steps: 32 | Train Loss: 4.717 Vali Loss: 22.776 Vali Acc: 0.351 Test Loss: 22.776 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 13.510957717895508
Epoch: 5, Steps: 32 | Train Loss: 7.598 Vali Loss: 52.448 Vali Acc: 0.336 Test Loss: 52.448 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 13.172768115997314
Epoch: 6, Steps: 32 | Train Loss: 8.489 Vali Loss: 43.567 Vali Acc: 0.450 Test Loss: 43.567 Test Acc: 0.450
Validation loss decreased (-0.435004 --> -0.449946).  Saving model ...
Epoch: 7 cost time: 13.047809362411499
Epoch: 7, Steps: 32 | Train Loss: 2.930 Vali Loss: 51.703 Vali Acc: 0.504 Test Loss: 51.703 Test Acc: 0.504
Validation loss decreased (-0.449946 --> -0.503300).  Saving model ...
Epoch: 8 cost time: 13.763586521148682
Epoch: 8, Steps: 32 | Train Loss: 1.643 Vali Loss: 45.026 Vali Acc: 0.550 Test Loss: 45.026 Test Acc: 0.550
Validation loss decreased (-0.503300 --> -0.549168).  Saving model ...
Epoch: 9 cost time: 13.664116144180298
Epoch: 9, Steps: 32 | Train Loss: 1.175 Vali Loss: 61.591 Vali Acc: 0.496 Test Loss: 61.591 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 14.321269750595093
Epoch: 10, Steps: 32 | Train Loss: 0.791 Vali Loss: 68.520 Vali Acc: 0.542 Test Loss: 68.520 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 13.940311431884766
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 60.307 Vali Acc: 0.519 Test Loss: 60.307 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 13.597391366958618
Epoch: 12, Steps: 32 | Train Loss: 0.825 Vali Loss: 64.764 Vali Acc: 0.473 Test Loss: 64.764 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 13.233311891555786
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 58.881 Vali Acc: 0.504 Test Loss: 58.881 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 13.48685598373413
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 58.681 Vali Acc: 0.496 Test Loss: 58.681 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 13.380036354064941
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 58.674 Vali Acc: 0.496 Test Loss: 58.674 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 12.925487041473389
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 58.673 Vali Acc: 0.496 Test Loss: 58.673 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 13.132513761520386
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 58.673 Vali Acc: 0.496 Test Loss: 58.673 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 13.22969937324524
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 58.673 Vali Acc: 0.496 Test Loss: 58.673 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df512_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 6119621
model size : 32.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df512_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.936452150344849
Epoch: 1, Steps: 32 | Train Loss: 4.654 Vali Loss: 6.881 Vali Acc: 0.443 Test Loss: 6.881 Test Acc: 0.443
Validation loss decreased (inf --> -0.442679).  Saving model ...
Epoch: 2 cost time: 11.770240306854248
Epoch: 2, Steps: 32 | Train Loss: 4.604 Vali Loss: 22.441 Vali Acc: 0.313 Test Loss: 22.441 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.968631505966187
Epoch: 3, Steps: 32 | Train Loss: 6.618 Vali Loss: 10.079 Vali Acc: 0.481 Test Loss: 10.079 Test Acc: 0.481
Validation loss decreased (-0.442679 --> -0.480815).  Saving model ...
Epoch: 4 cost time: 11.77628755569458
Epoch: 4, Steps: 32 | Train Loss: 2.852 Vali Loss: 14.405 Vali Acc: 0.550 Test Loss: 14.405 Test Acc: 0.550
Validation loss decreased (-0.480815 --> -0.549474).  Saving model ...
Epoch: 5 cost time: 12.026664733886719
Epoch: 5, Steps: 32 | Train Loss: 5.221 Vali Loss: 25.899 Vali Acc: 0.374 Test Loss: 25.899 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.411794424057007
Epoch: 6, Steps: 32 | Train Loss: 4.655 Vali Loss: 21.825 Vali Acc: 0.527 Test Loss: 21.825 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 11.751654148101807
Epoch: 7, Steps: 32 | Train Loss: 1.312 Vali Loss: 39.252 Vali Acc: 0.542 Test Loss: 39.252 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 11.778079509735107
Epoch: 8, Steps: 32 | Train Loss: 2.265 Vali Loss: 27.863 Vali Acc: 0.473 Test Loss: 27.863 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 12.065853595733643
Epoch: 9, Steps: 32 | Train Loss: 1.061 Vali Loss: 34.094 Vali Acc: 0.420 Test Loss: 34.094 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 12.040212392807007
Epoch: 10, Steps: 32 | Train Loss: 16.133 Vali Loss: 27.742 Vali Acc: 0.504 Test Loss: 27.742 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 11.697879314422607
Epoch: 11, Steps: 32 | Train Loss: 8.847 Vali Loss: 68.014 Vali Acc: 0.511 Test Loss: 68.014 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 11.71841287612915
Epoch: 12, Steps: 32 | Train Loss: 6.026 Vali Loss: 54.727 Vali Acc: 0.519 Test Loss: 54.727 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 11.805623054504395
Epoch: 13, Steps: 32 | Train Loss: 5.414 Vali Loss: 43.551 Vali Acc: 0.405 Test Loss: 43.551 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 11.796077489852905
Epoch: 14, Steps: 32 | Train Loss: 0.651 Vali Loss: 80.053 Vali Acc: 0.481 Test Loss: 80.053 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df512_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 6119621
model size : 32.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df512_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.955162763595581
Epoch: 1, Steps: 32 | Train Loss: 4.718 Vali Loss: 2.466 Vali Acc: 0.550 Test Loss: 2.466 Test Acc: 0.550
Validation loss decreased (inf --> -0.549594).  Saving model ...
Epoch: 2 cost time: 11.624525308609009
Epoch: 2, Steps: 32 | Train Loss: 2.859 Vali Loss: 5.671 Vali Acc: 0.443 Test Loss: 5.671 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.127119779586792
Epoch: 3, Steps: 32 | Train Loss: 6.679 Vali Loss: 24.637 Vali Acc: 0.397 Test Loss: 24.637 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.65096402168274
Epoch: 4, Steps: 32 | Train Loss: 6.034 Vali Loss: 22.207 Vali Acc: 0.496 Test Loss: 22.207 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 11.039179563522339
Epoch: 5, Steps: 32 | Train Loss: 5.483 Vali Loss: 54.912 Vali Acc: 0.206 Test Loss: 54.912 Test Acc: 0.206
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 10.992027521133423
Epoch: 6, Steps: 32 | Train Loss: 9.710 Vali Loss: 29.898 Vali Acc: 0.550 Test Loss: 29.898 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 10.858237266540527
Epoch: 7, Steps: 32 | Train Loss: 1.797 Vali Loss: 26.917 Vali Acc: 0.473 Test Loss: 26.917 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 11.462177038192749
Epoch: 8, Steps: 32 | Train Loss: 0.250 Vali Loss: 26.772 Vali Acc: 0.527 Test Loss: 26.772 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 11.115450382232666
Epoch: 9, Steps: 32 | Train Loss: 1.888 Vali Loss: 32.293 Vali Acc: 0.534 Test Loss: 32.293 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 11.459903717041016
Epoch: 10, Steps: 32 | Train Loss: 1.076 Vali Loss: 34.905 Vali Acc: 0.565 Test Loss: 34.905 Test Acc: 0.565
Validation loss decreased (-0.549594 --> -0.564536).  Saving model ...
Epoch: 11 cost time: 11.524885416030884
Epoch: 11, Steps: 32 | Train Loss: 1.524 Vali Loss: 38.845 Vali Acc: 0.557 Test Loss: 38.845 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 11.247138023376465
Epoch: 12, Steps: 32 | Train Loss: 0.534 Vali Loss: 27.315 Vali Acc: 0.542 Test Loss: 27.315 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 11.441033840179443
Epoch: 13, Steps: 32 | Train Loss: 0.001 Vali Loss: 35.353 Vali Acc: 0.504 Test Loss: 35.353 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 11.78830862045288
Epoch: 14, Steps: 32 | Train Loss: 2.735 Vali Loss: 79.533 Vali Acc: 0.504 Test Loss: 79.533 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 11.58141827583313
Epoch: 15, Steps: 32 | Train Loss: 0.617 Vali Loss: 53.394 Vali Acc: 0.519 Test Loss: 53.394 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 11.054699659347534
Epoch: 16, Steps: 32 | Train Loss: 3.657 Vali Loss: 68.138 Vali Acc: 0.481 Test Loss: 68.138 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 11.346753597259521
Epoch: 17, Steps: 32 | Train Loss: 1.837 Vali Loss: 42.255 Vali Acc: 0.458 Test Loss: 42.255 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 11.246740102767944
Epoch: 18, Steps: 32 | Train Loss: 6.942 Vali Loss: 37.721 Vali Acc: 0.534 Test Loss: 37.721 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 11.517688512802124
Epoch: 19, Steps: 32 | Train Loss: 2.725 Vali Loss: 42.746 Vali Acc: 0.588 Test Loss: 42.746 Test Acc: 0.588
Validation loss decreased (-0.564536 --> -0.587359).  Saving model ...
Epoch: 20 cost time: 11.807736873626709
Epoch: 20, Steps: 32 | Train Loss: 1.136 Vali Loss: 70.519 Vali Acc: 0.458 Test Loss: 70.519 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 10.685715675354004
Epoch: 21, Steps: 32 | Train Loss: 0.712 Vali Loss: 72.320 Vali Acc: 0.557 Test Loss: 72.320 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 11.332541465759277
Epoch: 22, Steps: 32 | Train Loss: 3.671 Vali Loss: 121.282 Vali Acc: 0.496 Test Loss: 121.282 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 10.936229944229126
Epoch: 23, Steps: 32 | Train Loss: 10.421 Vali Loss: 45.757 Vali Acc: 0.504 Test Loss: 45.757 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 11.302815198898315
Epoch: 24, Steps: 32 | Train Loss: 1.322 Vali Loss: 46.134 Vali Acc: 0.504 Test Loss: 46.134 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 11.523555994033813
Epoch: 25, Steps: 32 | Train Loss: 1.811 Vali Loss: 133.926 Vali Acc: 0.511 Test Loss: 133.926 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 10.518715381622314
Epoch: 26, Steps: 32 | Train Loss: 1.614 Vali Loss: 86.022 Vali Acc: 0.534 Test Loss: 86.022 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 11.42771601676941
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 45.804 Vali Acc: 0.550 Test Loss: 45.804 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 10.797718048095703
Epoch: 28, Steps: 32 | Train Loss: 0.000 Vali Loss: 48.073 Vali Acc: 0.542 Test Loss: 48.073 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 11.284263134002686
Epoch: 29, Steps: 32 | Train Loss: 0.000 Vali Loss: 48.164 Vali Acc: 0.542 Test Loss: 48.164 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df512_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 6119621
model size : 32.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         8992                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df256_ma8992_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 80.22771883010864
Epoch: 1, Steps: 32 | Train Loss: 6.663 Vali Loss: 13.537 Vali Acc: 0.298 Test Loss: 13.537 Test Acc: 0.298
Validation loss decreased (inf --> -0.297575).  Saving model ...
Epoch: 2 cost time: 80.16073632240295
Epoch: 2, Steps: 32 | Train Loss: 3.491 Vali Loss: 11.365 Vali Acc: 0.489 Test Loss: 11.365 Test Acc: 0.489
Validation loss decreased (-0.297575 --> -0.488436).  Saving model ...
Epoch: 3 cost time: 89.84504437446594
Epoch: 3, Steps: 32 | Train Loss: 10.694 Vali Loss: 29.006 Vali Acc: 0.229 Test Loss: 29.006 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 95.05295610427856
Epoch: 4, Steps: 32 | Train Loss: 3.135 Vali Loss: 21.454 Vali Acc: 0.473 Test Loss: 21.454 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 107.78391218185425
Epoch: 5, Steps: 32 | Train Loss: 4.045 Vali Loss: 30.340 Vali Acc: 0.489 Test Loss: 30.340 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 105.09397864341736
Epoch: 6, Steps: 32 | Train Loss: 5.439 Vali Loss: 45.923 Vali Acc: 0.534 Test Loss: 45.923 Test Acc: 0.534
Validation loss decreased (-0.488436 --> -0.533892).  Saving model ...
Epoch: 7 cost time: 112.8142580986023
Epoch: 7, Steps: 32 | Train Loss: 4.632 Vali Loss: 51.114 Vali Acc: 0.366 Test Loss: 51.114 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 107.08297443389893
Epoch: 8, Steps: 32 | Train Loss: 6.974 Vali Loss: 58.280 Vali Acc: 0.511 Test Loss: 58.280 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 108.96545767784119
Epoch: 9, Steps: 32 | Train Loss: 5.183 Vali Loss: 77.608 Vali Acc: 0.321 Test Loss: 77.608 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 109.02819156646729
Epoch: 10, Steps: 32 | Train Loss: 3.812 Vali Loss: 77.245 Vali Acc: 0.374 Test Loss: 77.245 Test Acc: 0.374
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 110.66152596473694
Epoch: 11, Steps: 32 | Train Loss: 4.542 Vali Loss: 119.284 Vali Acc: 0.527 Test Loss: 119.284 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 115.58888936042786
Epoch: 12, Steps: 32 | Train Loss: 8.919 Vali Loss: 91.507 Vali Acc: 0.496 Test Loss: 91.507 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 111.65942668914795
Epoch: 13, Steps: 32 | Train Loss: 1.158 Vali Loss: 93.634 Vali Acc: 0.527 Test Loss: 93.634 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 110.78352308273315
Epoch: 14, Steps: 32 | Train Loss: 0.849 Vali Loss: 114.433 Vali Acc: 0.542 Test Loss: 114.433 Test Acc: 0.542
Validation loss decreased (-0.533892 --> -0.540840).  Saving model ...
Epoch: 15 cost time: 111.13595223426819
Epoch: 15, Steps: 32 | Train Loss: 0.175 Vali Loss: 72.285 Vali Acc: 0.412 Test Loss: 72.285 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 110.24911284446716
Epoch: 16, Steps: 32 | Train Loss: 0.581 Vali Loss: 96.637 Vali Acc: 0.443 Test Loss: 96.637 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 111.55005407333374
Epoch: 17, Steps: 32 | Train Loss: 1.582 Vali Loss: 92.019 Vali Acc: 0.527 Test Loss: 92.019 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 111.83055996894836
Epoch: 18, Steps: 32 | Train Loss: 1.432 Vali Loss: 117.314 Vali Acc: 0.542 Test Loss: 117.314 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 115.33632445335388
Epoch: 19, Steps: 32 | Train Loss: 0.011 Vali Loss: 94.067 Vali Acc: 0.458 Test Loss: 94.067 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 112.97015881538391
Epoch: 20, Steps: 32 | Train Loss: 0.298 Vali Loss: 93.657 Vali Acc: 0.519 Test Loss: 93.657 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 112.09606409072876
Epoch: 21, Steps: 32 | Train Loss: 0.569 Vali Loss: 95.705 Vali Acc: 0.489 Test Loss: 95.705 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 111.1496376991272
Epoch: 22, Steps: 32 | Train Loss: 0.615 Vali Loss: 102.547 Vali Acc: 0.511 Test Loss: 102.547 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 112.65442562103271
Epoch: 23, Steps: 32 | Train Loss: 0.637 Vali Loss: 101.369 Vali Acc: 0.527 Test Loss: 101.369 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 109.75565242767334
Epoch: 24, Steps: 32 | Train Loss: 0.621 Vali Loss: 112.551 Vali Acc: 0.542 Test Loss: 112.551 Test Acc: 0.542
Validation loss decreased (-0.540840 --> -0.540859).  Saving model ...
Epoch: 25 cost time: 111.583913564682
Epoch: 25, Steps: 32 | Train Loss: 0.739 Vali Loss: 100.456 Vali Acc: 0.504 Test Loss: 100.456 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 111.54431128501892
Epoch: 26, Steps: 32 | Train Loss: 1.165 Vali Loss: 141.767 Vali Acc: 0.542 Test Loss: 141.767 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 111.24750113487244
Epoch: 27, Steps: 32 | Train Loss: 0.010 Vali Loss: 144.516 Vali Acc: 0.542 Test Loss: 144.516 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 110.46215581893921
Epoch: 28, Steps: 32 | Train Loss: 6.661 Vali Loss: 148.622 Vali Acc: 0.466 Test Loss: 148.622 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 110.2252140045166
Epoch: 29, Steps: 32 | Train Loss: 2.162 Vali Loss: 118.992 Vali Acc: 0.511 Test Loss: 118.992 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 113.97397685050964
Epoch: 30, Steps: 32 | Train Loss: 0.000 Vali Loss: 126.457 Vali Acc: 0.511 Test Loss: 126.457 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 111.36383175849915
Epoch: 31, Steps: 32 | Train Loss: 0.149 Vali Loss: 167.607 Vali Acc: 0.519 Test Loss: 167.607 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 112.12853932380676
Epoch: 32, Steps: 32 | Train Loss: 1.404 Vali Loss: 160.170 Vali Acc: 0.458 Test Loss: 160.170 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 111.2256727218628
Epoch: 33, Steps: 32 | Train Loss: 2.094 Vali Loss: 180.445 Vali Acc: 0.534 Test Loss: 180.445 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 110.7261552810669
Epoch: 34, Steps: 32 | Train Loss: 3.040 Vali Loss: 134.508 Vali Acc: 0.473 Test Loss: 134.508 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df256_ma8992_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 6021317
model size : 31.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         7194                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df256_ma7194_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 65.6327874660492
Epoch: 1, Steps: 32 | Train Loss: 7.881 Vali Loss: 10.649 Vali Acc: 0.313 Test Loss: 10.649 Test Acc: 0.313
Validation loss decreased (inf --> -0.312871).  Saving model ...
Epoch: 2 cost time: 65.1218569278717
Epoch: 2, Steps: 32 | Train Loss: 3.281 Vali Loss: 15.463 Vali Acc: 0.282 Test Loss: 15.463 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 72.25572919845581
Epoch: 3, Steps: 32 | Train Loss: 5.346 Vali Loss: 24.628 Vali Acc: 0.519 Test Loss: 24.628 Test Acc: 0.519
Validation loss decreased (-0.312871 --> -0.518838).  Saving model ...
Epoch: 4 cost time: 76.13315963745117
Epoch: 4, Steps: 32 | Train Loss: 4.299 Vali Loss: 35.977 Vali Acc: 0.542 Test Loss: 35.977 Test Acc: 0.542
Validation loss decreased (-0.518838 --> -0.541625).  Saving model ...
Epoch: 5 cost time: 86.31637740135193
Epoch: 5, Steps: 32 | Train Loss: 5.922 Vali Loss: 55.402 Vali Acc: 0.328 Test Loss: 55.402 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 83.29667091369629
Epoch: 6, Steps: 32 | Train Loss: 6.888 Vali Loss: 43.730 Vali Acc: 0.321 Test Loss: 43.730 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 87.72717928886414
Epoch: 7, Steps: 32 | Train Loss: 5.903 Vali Loss: 57.982 Vali Acc: 0.550 Test Loss: 57.982 Test Acc: 0.550
Validation loss decreased (-0.541625 --> -0.549039).  Saving model ...
Epoch: 8 cost time: 87.33875250816345
Epoch: 8, Steps: 32 | Train Loss: 4.928 Vali Loss: 69.063 Vali Acc: 0.573 Test Loss: 69.063 Test Acc: 0.573
Validation loss decreased (-0.549039 --> -0.571828).  Saving model ...
Epoch: 9 cost time: 90.18354606628418
Epoch: 9, Steps: 32 | Train Loss: 1.173 Vali Loss: 69.647 Vali Acc: 0.519 Test Loss: 69.647 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 90.23491501808167
Epoch: 10, Steps: 32 | Train Loss: 2.134 Vali Loss: 62.099 Vali Acc: 0.328 Test Loss: 62.099 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 88.71011924743652
Epoch: 11, Steps: 32 | Train Loss: 1.100 Vali Loss: 107.670 Vali Acc: 0.527 Test Loss: 107.670 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 89.77080392837524
Epoch: 12, Steps: 32 | Train Loss: 0.899 Vali Loss: 66.866 Vali Acc: 0.489 Test Loss: 66.866 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 89.98365998268127
Epoch: 13, Steps: 32 | Train Loss: 2.921 Vali Loss: 51.700 Vali Acc: 0.511 Test Loss: 51.700 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 91.40244841575623
Epoch: 14, Steps: 32 | Train Loss: 3.250 Vali Loss: 99.254 Vali Acc: 0.427 Test Loss: 99.254 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 89.77072429656982
Epoch: 15, Steps: 32 | Train Loss: 0.267 Vali Loss: 66.106 Vali Acc: 0.527 Test Loss: 66.106 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 90.46291446685791
Epoch: 16, Steps: 32 | Train Loss: 0.019 Vali Loss: 67.430 Vali Acc: 0.427 Test Loss: 67.430 Test Acc: 0.427
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 91.56212973594666
Epoch: 17, Steps: 32 | Train Loss: 1.007 Vali Loss: 98.692 Vali Acc: 0.557 Test Loss: 98.692 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 89.86510348320007
Epoch: 18, Steps: 32 | Train Loss: 1.045 Vali Loss: 84.829 Vali Acc: 0.557 Test Loss: 84.829 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df256_ma7194_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 6021317
model size : 31.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5396                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df256_ma5396_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 52.11922883987427
Epoch: 1, Steps: 32 | Train Loss: 7.372 Vali Loss: 18.167 Vali Acc: 0.221 Test Loss: 18.167 Test Acc: 0.221
Validation loss decreased (inf --> -0.221192).  Saving model ...
Epoch: 2 cost time: 51.37169146537781
Epoch: 2, Steps: 32 | Train Loss: 4.968 Vali Loss: 15.424 Vali Acc: 0.481 Test Loss: 15.424 Test Acc: 0.481
Validation loss decreased (-0.221192 --> -0.480762).  Saving model ...
Epoch: 3 cost time: 54.90856432914734
Epoch: 3, Steps: 32 | Train Loss: 7.723 Vali Loss: 18.958 Vali Acc: 0.481 Test Loss: 18.958 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 64.24288392066956
Epoch: 4, Steps: 32 | Train Loss: 4.077 Vali Loss: 28.188 Vali Acc: 0.260 Test Loss: 28.188 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 67.1567223072052
Epoch: 5, Steps: 32 | Train Loss: 5.125 Vali Loss: 23.614 Vali Acc: 0.489 Test Loss: 23.614 Test Acc: 0.489
Validation loss decreased (-0.480762 --> -0.488313).  Saving model ...
Epoch: 6 cost time: 69.45087599754333
Epoch: 6, Steps: 32 | Train Loss: 5.675 Vali Loss: 48.599 Vali Acc: 0.489 Test Loss: 48.599 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 69.823166847229
Epoch: 7, Steps: 32 | Train Loss: 4.543 Vali Loss: 46.940 Vali Acc: 0.473 Test Loss: 46.940 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 73.24854898452759
Epoch: 8, Steps: 32 | Train Loss: 0.219 Vali Loss: 45.492 Vali Acc: 0.542 Test Loss: 45.492 Test Acc: 0.542
Validation loss decreased (-0.488313 --> -0.541530).  Saving model ...
Epoch: 9 cost time: 73.58297276496887
Epoch: 9, Steps: 32 | Train Loss: 1.538 Vali Loss: 51.837 Vali Acc: 0.542 Test Loss: 51.837 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 67.34748911857605
Epoch: 10, Steps: 32 | Train Loss: 3.898 Vali Loss: 97.961 Vali Acc: 0.435 Test Loss: 97.961 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 68.52374076843262
Epoch: 11, Steps: 32 | Train Loss: 4.174 Vali Loss: 80.347 Vali Acc: 0.496 Test Loss: 80.347 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 68.56859111785889
Epoch: 12, Steps: 32 | Train Loss: 1.936 Vali Loss: 88.522 Vali Acc: 0.481 Test Loss: 88.522 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 69.72570967674255
Epoch: 13, Steps: 32 | Train Loss: 9.491 Vali Loss: 89.139 Vali Acc: 0.427 Test Loss: 89.139 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 70.86731386184692
Epoch: 14, Steps: 32 | Train Loss: 2.508 Vali Loss: 75.000 Vali Acc: 0.519 Test Loss: 75.000 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 69.58390641212463
Epoch: 15, Steps: 32 | Train Loss: 1.305 Vali Loss: 88.524 Vali Acc: 0.435 Test Loss: 88.524 Test Acc: 0.435
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 69.5616672039032
Epoch: 16, Steps: 32 | Train Loss: 0.449 Vali Loss: 86.448 Vali Acc: 0.489 Test Loss: 86.448 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 70.87781596183777
Epoch: 17, Steps: 32 | Train Loss: 0.712 Vali Loss: 103.575 Vali Acc: 0.550 Test Loss: 103.575 Test Acc: 0.550
Validation loss decreased (-0.541530 --> -0.548583).  Saving model ...
Epoch: 18 cost time: 70.67866921424866
Epoch: 18, Steps: 32 | Train Loss: 0.589 Vali Loss: 104.735 Vali Acc: 0.550 Test Loss: 104.735 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 71.72365689277649
Epoch: 19, Steps: 32 | Train Loss: 2.314 Vali Loss: 159.410 Vali Acc: 0.534 Test Loss: 159.410 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 69.79785108566284
Epoch: 20, Steps: 32 | Train Loss: 0.813 Vali Loss: 84.794 Vali Acc: 0.405 Test Loss: 84.794 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 69.06804084777832
Epoch: 21, Steps: 32 | Train Loss: 4.089 Vali Loss: 84.302 Vali Acc: 0.481 Test Loss: 84.302 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 70.36572623252869
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.881 Vali Acc: 0.557 Test Loss: 105.881 Test Acc: 0.557
Validation loss decreased (-0.548583 --> -0.556193).  Saving model ...
Epoch: 23 cost time: 69.28699946403503
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 106.759 Vali Acc: 0.557 Test Loss: 106.759 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 68.36990547180176
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 106.775 Vali Acc: 0.557 Test Loss: 106.775 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 69.43700051307678
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 106.775 Vali Acc: 0.557 Test Loss: 106.775 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 70.24935936927795
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 106.775 Vali Acc: 0.557 Test Loss: 106.775 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 69.10361313819885
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 106.775 Vali Acc: 0.557 Test Loss: 106.775 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 69.3271074295044
Epoch: 28, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.654 Vali Acc: 0.557 Test Loss: 105.654 Test Acc: 0.557
Validation loss decreased (-0.556193 --> -0.556195).  Saving model ...
Epoch: 29 cost time: 69.89925742149353
Epoch: 29, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.593 Vali Acc: 0.557 Test Loss: 105.593 Test Acc: 0.557
Validation loss decreased (-0.556195 --> -0.556196).  Saving model ...
Epoch: 30 cost time: 67.9839038848877
Epoch: 30, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.591 Vali Acc: 0.557 Test Loss: 105.591 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 31 cost time: 69.3751528263092
Epoch: 31, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.590 Vali Acc: 0.557 Test Loss: 105.590 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 32 cost time: 69.28987050056458
Epoch: 32, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.590 Vali Acc: 0.557 Test Loss: 105.590 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 33 cost time: 69.18354916572571
Epoch: 33, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.584 Vali Acc: 0.557 Test Loss: 105.584 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 34 cost time: 69.28974175453186
Epoch: 34, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.582 Vali Acc: 0.557 Test Loss: 105.582 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 35 cost time: 69.83725261688232
Epoch: 35, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.582 Vali Acc: 0.557 Test Loss: 105.582 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 36 cost time: 69.6567223072052
Epoch: 36, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.582 Vali Acc: 0.557 Test Loss: 105.582 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 37 cost time: 68.51442790031433
Epoch: 37, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.578 Vali Acc: 0.557 Test Loss: 105.578 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 38 cost time: 68.81791090965271
Epoch: 38, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.578 Vali Acc: 0.557 Test Loss: 105.578 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 39 cost time: 70.33220314979553
Epoch: 39, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.578 Vali Acc: 0.557 Test Loss: 105.578 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 40 cost time: 68.6704466342926
Epoch: 40, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.578 Vali Acc: 0.557 Test Loss: 105.578 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 41 cost time: 69.35605430603027
Epoch: 41, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.578 Vali Acc: 0.557 Test Loss: 105.578 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 42 cost time: 68.8179132938385
Epoch: 42, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.578 Vali Acc: 0.557 Test Loss: 105.578 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 43 cost time: 69.78542232513428
Epoch: 43, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.578 Vali Acc: 0.557 Test Loss: 105.578 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 44 cost time: 69.61247611045837
Epoch: 44, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.578 Vali Acc: 0.557 Test Loss: 105.578 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 45 cost time: 69.81067323684692
Epoch: 45, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.578 Vali Acc: 0.557 Test Loss: 105.578 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 46 cost time: 68.46709418296814
Epoch: 46, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.578 Vali Acc: 0.557 Test Loss: 105.578 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 47 cost time: 68.6944408416748
Epoch: 47, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.578 Vali Acc: 0.557 Test Loss: 105.578 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 48 cost time: 69.58756589889526
Epoch: 48, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.578 Vali Acc: 0.557 Test Loss: 105.578 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 49 cost time: 69.64532017707825
Epoch: 49, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.571 Vali Acc: 0.557 Test Loss: 105.571 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 50 cost time: 69.26675844192505
Epoch: 50, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.568 Vali Acc: 0.557 Test Loss: 105.568 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 51 cost time: 69.68191337585449
Epoch: 51, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.568 Vali Acc: 0.557 Test Loss: 105.568 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 52 cost time: 69.6404447555542
Epoch: 52, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.568 Vali Acc: 0.557 Test Loss: 105.568 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 53 cost time: 68.92217683792114
Epoch: 53, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.568 Vali Acc: 0.557 Test Loss: 105.568 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 54 cost time: 68.4632215499878
Epoch: 54, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.568 Vali Acc: 0.557 Test Loss: 105.568 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 55 cost time: 69.86260461807251
Epoch: 55, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.568 Vali Acc: 0.557 Test Loss: 105.568 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 56 cost time: 69.45938420295715
Epoch: 56, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.568 Vali Acc: 0.557 Test Loss: 105.568 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 57 cost time: 68.46370482444763
Epoch: 57, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.568 Vali Acc: 0.557 Test Loss: 105.568 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 58 cost time: 69.63428044319153
Epoch: 58, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.568 Vali Acc: 0.557 Test Loss: 105.568 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 59 cost time: 69.01527237892151
Epoch: 59, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.568 Vali Acc: 0.557 Test Loss: 105.568 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 60 cost time: 68.74108791351318
Epoch: 60, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.568 Vali Acc: 0.557 Test Loss: 105.568 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 61 cost time: 69.84424901008606
Epoch: 61, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.568 Vali Acc: 0.557 Test Loss: 105.568 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 62 cost time: 69.89142632484436
Epoch: 62, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.568 Vali Acc: 0.557 Test Loss: 105.568 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 63 cost time: 68.96397924423218
Epoch: 63, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.568 Vali Acc: 0.557 Test Loss: 105.568 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 64 cost time: 70.04941987991333
Epoch: 64, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.568 Vali Acc: 0.557 Test Loss: 105.568 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 65 cost time: 67.66919565200806
Epoch: 65, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.568 Vali Acc: 0.557 Test Loss: 105.568 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 69.33536434173584
Epoch: 66, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.568 Vali Acc: 0.557 Test Loss: 105.568 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 68.85014653205872
Epoch: 67, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.568 Vali Acc: 0.557 Test Loss: 105.568 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 69.138925075531
Epoch: 68, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.568 Vali Acc: 0.557 Test Loss: 105.568 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 69.93897557258606
Epoch: 69, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.568 Vali Acc: 0.557 Test Loss: 105.568 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 69.60549092292786
Epoch: 70, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.568 Vali Acc: 0.557 Test Loss: 105.568 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 70.30046057701111
Epoch: 71, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.568 Vali Acc: 0.557 Test Loss: 105.568 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 72 cost time: 67.59219813346863
Epoch: 72, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.568 Vali Acc: 0.557 Test Loss: 105.568 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 73 cost time: 68.20433330535889
Epoch: 73, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.568 Vali Acc: 0.557 Test Loss: 105.568 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 74 cost time: 69.1895842552185
Epoch: 74, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.568 Vali Acc: 0.557 Test Loss: 105.568 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 75 cost time: 68.98699235916138
Epoch: 75, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.568 Vali Acc: 0.557 Test Loss: 105.568 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 76 cost time: 69.32954621315002
Epoch: 76, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.568 Vali Acc: 0.557 Test Loss: 105.568 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 77 cost time: 68.9875636100769
Epoch: 77, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.568 Vali Acc: 0.557 Test Loss: 105.568 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 78 cost time: 68.67321443557739
Epoch: 78, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.568 Vali Acc: 0.557 Test Loss: 105.568 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 79 cost time: 68.61076521873474
Epoch: 79, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.567 Vali Acc: 0.557 Test Loss: 105.567 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 80 cost time: 69.50287175178528
Epoch: 80, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.567 Vali Acc: 0.557 Test Loss: 105.567 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 81 cost time: 69.22402238845825
Epoch: 81, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.567 Vali Acc: 0.557 Test Loss: 105.567 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 82 cost time: 69.21499395370483
Epoch: 82, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.567 Vali Acc: 0.557 Test Loss: 105.567 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 83 cost time: 68.7774121761322
Epoch: 83, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.567 Vali Acc: 0.557 Test Loss: 105.567 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 84 cost time: 68.60766458511353
Epoch: 84, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.567 Vali Acc: 0.557 Test Loss: 105.567 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 85 cost time: 69.64856386184692
Epoch: 85, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.567 Vali Acc: 0.557 Test Loss: 105.567 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 86 cost time: 70.0100040435791
Epoch: 86, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.567 Vali Acc: 0.557 Test Loss: 105.567 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 87 cost time: 70.01286196708679
Epoch: 87, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.567 Vali Acc: 0.557 Test Loss: 105.567 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 88 cost time: 71.11223459243774
Epoch: 88, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.567 Vali Acc: 0.557 Test Loss: 105.567 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 89 cost time: 68.89543890953064
Epoch: 89, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.567 Vali Acc: 0.557 Test Loss: 105.567 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 70.53532671928406
Epoch: 90, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.567 Vali Acc: 0.557 Test Loss: 105.567 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 67.8215799331665
Epoch: 91, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.567 Vali Acc: 0.557 Test Loss: 105.567 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 92 cost time: 67.79756498336792
Epoch: 92, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.567 Vali Acc: 0.557 Test Loss: 105.567 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 93 cost time: 69.84686231613159
Epoch: 93, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.567 Vali Acc: 0.557 Test Loss: 105.567 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 94 cost time: 69.58129930496216
Epoch: 94, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.567 Vali Acc: 0.557 Test Loss: 105.567 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 95 cost time: 69.64929342269897
Epoch: 95, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.567 Vali Acc: 0.557 Test Loss: 105.567 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 69.55572319030762
Epoch: 96, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.567 Vali Acc: 0.557 Test Loss: 105.567 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 97 cost time: 70.3621175289154
Epoch: 97, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.567 Vali Acc: 0.557 Test Loss: 105.567 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 69.1967282295227
Epoch: 98, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.567 Vali Acc: 0.557 Test Loss: 105.567 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 99 cost time: 70.7479875087738
Epoch: 99, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.567 Vali Acc: 0.557 Test Loss: 105.567 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
Epoch: 100 cost time: 69.35333204269409
Epoch: 100, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.567 Vali Acc: 0.557 Test Loss: 105.567 Test Acc: 0.557
Validation loss decreased (-0.556196 --> -0.556196).  Saving model ...
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df256_ma5396_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 6021317
model size : 31.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3597                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df256_ma3597_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 36.442631006240845
Epoch: 1, Steps: 32 | Train Loss: 7.196 Vali Loss: 15.641 Vali Acc: 0.351 Test Loss: 15.641 Test Acc: 0.351
Validation loss decreased (inf --> -0.350989).  Saving model ...
Epoch: 2 cost time: 35.7993745803833
Epoch: 2, Steps: 32 | Train Loss: 4.488 Vali Loss: 22.150 Vali Acc: 0.221 Test Loss: 22.150 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 39.76208305358887
Epoch: 3, Steps: 32 | Train Loss: 4.235 Vali Loss: 13.742 Vali Acc: 0.511 Test Loss: 13.742 Test Acc: 0.511
Validation loss decreased (-0.350989 --> -0.511313).  Saving model ...
Epoch: 4 cost time: 42.126461029052734
Epoch: 4, Steps: 32 | Train Loss: 3.211 Vali Loss: 20.876 Vali Acc: 0.504 Test Loss: 20.876 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 46.38489627838135
Epoch: 5, Steps: 32 | Train Loss: 2.290 Vali Loss: 42.609 Vali Acc: 0.328 Test Loss: 42.609 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 46.48389720916748
Epoch: 6, Steps: 32 | Train Loss: 4.019 Vali Loss: 47.606 Vali Acc: 0.519 Test Loss: 47.606 Test Acc: 0.519
Validation loss decreased (-0.511313 --> -0.518608).  Saving model ...
Epoch: 7 cost time: 47.40431761741638
Epoch: 7, Steps: 32 | Train Loss: 5.311 Vali Loss: 59.780 Vali Acc: 0.496 Test Loss: 59.780 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 50.93045139312744
Epoch: 8, Steps: 32 | Train Loss: 5.365 Vali Loss: 54.555 Vali Acc: 0.443 Test Loss: 54.555 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 47.983829736709595
Epoch: 9, Steps: 32 | Train Loss: 1.958 Vali Loss: 101.814 Vali Acc: 0.519 Test Loss: 101.814 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 47.66637110710144
Epoch: 10, Steps: 32 | Train Loss: 1.820 Vali Loss: 114.705 Vali Acc: 0.519 Test Loss: 114.705 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 48.69384026527405
Epoch: 11, Steps: 32 | Train Loss: 4.758 Vali Loss: 69.475 Vali Acc: 0.412 Test Loss: 69.475 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 47.98980665206909
Epoch: 12, Steps: 32 | Train Loss: 2.891 Vali Loss: 69.053 Vali Acc: 0.412 Test Loss: 69.053 Test Acc: 0.412
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 48.52019166946411
Epoch: 13, Steps: 32 | Train Loss: 0.504 Vali Loss: 100.885 Vali Acc: 0.534 Test Loss: 100.885 Test Acc: 0.534
Validation loss decreased (-0.518608 --> -0.533342).  Saving model ...
Epoch: 14 cost time: 48.99651551246643
Epoch: 14, Steps: 32 | Train Loss: 0.343 Vali Loss: 100.434 Vali Acc: 0.550 Test Loss: 100.434 Test Acc: 0.550
Validation loss decreased (-0.533342 --> -0.548614).  Saving model ...
Epoch: 15 cost time: 49.34421181678772
Epoch: 15, Steps: 32 | Train Loss: 0.375 Vali Loss: 103.590 Vali Acc: 0.534 Test Loss: 103.590 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 48.600385427474976
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 108.722 Vali Acc: 0.534 Test Loss: 108.722 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 49.12305521965027
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 108.914 Vali Acc: 0.534 Test Loss: 108.914 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 49.04583382606506
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 108.921 Vali Acc: 0.534 Test Loss: 108.921 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 48.564791202545166
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 108.921 Vali Acc: 0.534 Test Loss: 108.921 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 48.25483822822571
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 108.921 Vali Acc: 0.534 Test Loss: 108.921 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 49.52122092247009
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 108.921 Vali Acc: 0.534 Test Loss: 108.921 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 48.98951029777527
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 108.921 Vali Acc: 0.534 Test Loss: 108.921 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 48.59730625152588
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 108.921 Vali Acc: 0.534 Test Loss: 108.921 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 47.75348520278931
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 108.921 Vali Acc: 0.534 Test Loss: 108.921 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df256_ma3597_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 6021317
model size : 31.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1799                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df256_ma1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 22.208925247192383
Epoch: 1, Steps: 32 | Train Loss: 8.652 Vali Loss: 13.939 Vali Acc: 0.473 Test Loss: 13.939 Test Acc: 0.473
Validation loss decreased (inf --> -0.473143).  Saving model ...
Epoch: 2 cost time: 21.791438579559326
Epoch: 2, Steps: 32 | Train Loss: 8.563 Vali Loss: 16.720 Vali Acc: 0.504 Test Loss: 16.720 Test Acc: 0.504
Validation loss decreased (-0.473143 --> -0.503650).  Saving model ...
Epoch: 3 cost time: 23.071732759475708
Epoch: 3, Steps: 32 | Train Loss: 10.539 Vali Loss: 19.050 Vali Acc: 0.496 Test Loss: 19.050 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 28.69979739189148
Epoch: 4, Steps: 32 | Train Loss: 4.396 Vali Loss: 33.335 Vali Acc: 0.321 Test Loss: 33.335 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 27.988568544387817
Epoch: 5, Steps: 32 | Train Loss: 3.491 Vali Loss: 26.192 Vali Acc: 0.496 Test Loss: 26.192 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 28.685502767562866
Epoch: 6, Steps: 32 | Train Loss: 2.268 Vali Loss: 42.166 Vali Acc: 0.504 Test Loss: 42.166 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 28.221387147903442
Epoch: 7, Steps: 32 | Train Loss: 0.451 Vali Loss: 51.795 Vali Acc: 0.496 Test Loss: 51.795 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 28.49320912361145
Epoch: 8, Steps: 32 | Train Loss: 1.660 Vali Loss: 35.657 Vali Acc: 0.443 Test Loss: 35.657 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 29.82835364341736
Epoch: 9, Steps: 32 | Train Loss: 0.501 Vali Loss: 40.875 Vali Acc: 0.420 Test Loss: 40.875 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 29.240328073501587
Epoch: 10, Steps: 32 | Train Loss: 1.897 Vali Loss: 62.625 Vali Acc: 0.366 Test Loss: 62.625 Test Acc: 0.366
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 28.772350549697876
Epoch: 11, Steps: 32 | Train Loss: 4.299 Vali Loss: 68.295 Vali Acc: 0.443 Test Loss: 68.295 Test Acc: 0.443
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 29.270265102386475
Epoch: 12, Steps: 32 | Train Loss: 1.743 Vali Loss: 63.730 Vali Acc: 0.420 Test Loss: 63.730 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df256_ma1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 6021317
model size : 31.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df256_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.504549980163574
Epoch: 1, Steps: 32 | Train Loss: 7.612 Vali Loss: 16.006 Vali Acc: 0.206 Test Loss: 16.006 Test Acc: 0.206
Validation loss decreased (inf --> -0.205947).  Saving model ...
Epoch: 2 cost time: 14.452418327331543
Epoch: 2, Steps: 32 | Train Loss: 3.444 Vali Loss: 6.595 Vali Acc: 0.397 Test Loss: 6.595 Test Acc: 0.397
Validation loss decreased (-0.205947 --> -0.396881).  Saving model ...
Epoch: 3 cost time: 15.287533044815063
Epoch: 3, Steps: 32 | Train Loss: 2.659 Vali Loss: 13.662 Vali Acc: 0.496 Test Loss: 13.662 Test Acc: 0.496
Validation loss decreased (-0.396881 --> -0.496047).  Saving model ...
Epoch: 4 cost time: 16.00457739830017
Epoch: 4, Steps: 32 | Train Loss: 3.390 Vali Loss: 24.026 Vali Acc: 0.458 Test Loss: 24.026 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 17.53032398223877
Epoch: 5, Steps: 32 | Train Loss: 3.750 Vali Loss: 30.183 Vali Acc: 0.519 Test Loss: 30.183 Test Acc: 0.519
Validation loss decreased (-0.496047 --> -0.518782).  Saving model ...
Epoch: 6 cost time: 17.20622444152832
Epoch: 6, Steps: 32 | Train Loss: 3.697 Vali Loss: 52.937 Vali Acc: 0.397 Test Loss: 52.937 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 17.269127368927002
Epoch: 7, Steps: 32 | Train Loss: 1.776 Vali Loss: 50.464 Vali Acc: 0.443 Test Loss: 50.464 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 17.13286542892456
Epoch: 8, Steps: 32 | Train Loss: 1.801 Vali Loss: 39.100 Vali Acc: 0.397 Test Loss: 39.100 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 17.70340657234192
Epoch: 9, Steps: 32 | Train Loss: 2.750 Vali Loss: 47.755 Vali Acc: 0.427 Test Loss: 47.755 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 17.601147651672363
Epoch: 10, Steps: 32 | Train Loss: 0.802 Vali Loss: 62.759 Vali Acc: 0.504 Test Loss: 62.759 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 17.50377368927002
Epoch: 11, Steps: 32 | Train Loss: 2.690 Vali Loss: 67.007 Vali Acc: 0.542 Test Loss: 67.007 Test Acc: 0.542
Validation loss decreased (-0.518782 --> -0.541315).  Saving model ...
Epoch: 12 cost time: 17.596019506454468
Epoch: 12, Steps: 32 | Train Loss: 4.299 Vali Loss: 54.522 Vali Acc: 0.366 Test Loss: 54.522 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 18.208064794540405
Epoch: 13, Steps: 32 | Train Loss: 2.342 Vali Loss: 93.957 Vali Acc: 0.542 Test Loss: 93.957 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 17.841711044311523
Epoch: 14, Steps: 32 | Train Loss: 0.987 Vali Loss: 75.697 Vali Acc: 0.504 Test Loss: 75.697 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 17.65970540046692
Epoch: 15, Steps: 32 | Train Loss: 2.051 Vali Loss: 147.548 Vali Acc: 0.504 Test Loss: 147.548 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 17.56427812576294
Epoch: 16, Steps: 32 | Train Loss: 0.262 Vali Loss: 89.240 Vali Acc: 0.481 Test Loss: 89.240 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 17.488787174224854
Epoch: 17, Steps: 32 | Train Loss: 0.693 Vali Loss: 65.039 Vali Acc: 0.466 Test Loss: 65.039 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 17.397042751312256
Epoch: 18, Steps: 32 | Train Loss: 0.481 Vali Loss: 92.855 Vali Acc: 0.527 Test Loss: 92.855 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 17.425556659698486
Epoch: 19, Steps: 32 | Train Loss: 1.409 Vali Loss: 83.515 Vali Acc: 0.504 Test Loss: 83.515 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 17.44189167022705
Epoch: 20, Steps: 32 | Train Loss: 2.987 Vali Loss: 107.674 Vali Acc: 0.534 Test Loss: 107.674 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 17.483036041259766
Epoch: 21, Steps: 32 | Train Loss: 0.099 Vali Loss: 94.965 Vali Acc: 0.557 Test Loss: 94.965 Test Acc: 0.557
Validation loss decreased (-0.541315 --> -0.556302).  Saving model ...
Epoch: 22 cost time: 17.698938846588135
Epoch: 22, Steps: 32 | Train Loss: 0.389 Vali Loss: 103.505 Vali Acc: 0.527 Test Loss: 103.505 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 17.5746967792511
Epoch: 23, Steps: 32 | Train Loss: 0.106 Vali Loss: 140.983 Vali Acc: 0.458 Test Loss: 140.983 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 17.581204175949097
Epoch: 24, Steps: 32 | Train Loss: 1.728 Vali Loss: 103.627 Vali Acc: 0.519 Test Loss: 103.627 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 17.2162823677063
Epoch: 25, Steps: 32 | Train Loss: 3.819 Vali Loss: 81.645 Vali Acc: 0.458 Test Loss: 81.645 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 17.330947875976562
Epoch: 26, Steps: 32 | Train Loss: 2.891 Vali Loss: 108.340 Vali Acc: 0.443 Test Loss: 108.340 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 17.441264152526855
Epoch: 27, Steps: 32 | Train Loss: 2.414 Vali Loss: 126.354 Vali Acc: 0.550 Test Loss: 126.354 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 17.313333988189697
Epoch: 28, Steps: 32 | Train Loss: 2.958 Vali Loss: 82.144 Vali Acc: 0.511 Test Loss: 82.144 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 17.536869525909424
Epoch: 29, Steps: 32 | Train Loss: 0.282 Vali Loss: 143.911 Vali Acc: 0.511 Test Loss: 143.911 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 17.522107124328613
Epoch: 30, Steps: 32 | Train Loss: 3.438 Vali Loss: 113.400 Vali Acc: 0.511 Test Loss: 113.400 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 17.855413913726807
Epoch: 31, Steps: 32 | Train Loss: 0.881 Vali Loss: 125.036 Vali Acc: 0.527 Test Loss: 125.036 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df256_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 6021317
model size : 31.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         540                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df256_ma540_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.327221870422363
Epoch: 1, Steps: 32 | Train Loss: 5.965 Vali Loss: 7.299 Vali Acc: 0.443 Test Loss: 7.299 Test Acc: 0.443
Validation loss decreased (inf --> -0.442675).  Saving model ...
Epoch: 2 cost time: 12.553685188293457
Epoch: 2, Steps: 32 | Train Loss: 4.403 Vali Loss: 22.067 Vali Acc: 0.466 Test Loss: 22.067 Test Acc: 0.466
Validation loss decreased (-0.442675 --> -0.465428).  Saving model ...
Epoch: 3 cost time: 12.742452383041382
Epoch: 3, Steps: 32 | Train Loss: 5.026 Vali Loss: 18.976 Vali Acc: 0.550 Test Loss: 18.976 Test Acc: 0.550
Validation loss decreased (-0.465428 --> -0.549429).  Saving model ...
Epoch: 4 cost time: 13.646078109741211
Epoch: 4, Steps: 32 | Train Loss: 2.097 Vali Loss: 27.614 Vali Acc: 0.542 Test Loss: 27.614 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.378790140151978
Epoch: 5, Steps: 32 | Train Loss: 3.845 Vali Loss: 25.621 Vali Acc: 0.481 Test Loss: 25.621 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 13.610590934753418
Epoch: 6, Steps: 32 | Train Loss: 2.432 Vali Loss: 36.024 Vali Acc: 0.473 Test Loss: 36.024 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 13.996200323104858
Epoch: 7, Steps: 32 | Train Loss: 1.979 Vali Loss: 43.797 Vali Acc: 0.504 Test Loss: 43.797 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 13.846429824829102
Epoch: 8, Steps: 32 | Train Loss: 6.452 Vali Loss: 41.732 Vali Acc: 0.489 Test Loss: 41.732 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 14.738084554672241
Epoch: 9, Steps: 32 | Train Loss: 1.160 Vali Loss: 66.442 Vali Acc: 0.504 Test Loss: 66.442 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 14.880943775177002
Epoch: 10, Steps: 32 | Train Loss: 3.838 Vali Loss: 60.291 Vali Acc: 0.481 Test Loss: 60.291 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 14.121185541152954
Epoch: 11, Steps: 32 | Train Loss: 3.478 Vali Loss: 75.792 Vali Acc: 0.511 Test Loss: 75.792 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 13.973033905029297
Epoch: 12, Steps: 32 | Train Loss: 3.117 Vali Loss: 106.571 Vali Acc: 0.427 Test Loss: 106.571 Test Acc: 0.427
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 14.127626657485962
Epoch: 13, Steps: 32 | Train Loss: 1.808 Vali Loss: 78.106 Vali Acc: 0.489 Test Loss: 78.106 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df256_ma540_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 6021317
model size : 31.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df256_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.381393432617188
Epoch: 1, Steps: 32 | Train Loss: 7.112 Vali Loss: 7.516 Vali Acc: 0.481 Test Loss: 7.516 Test Acc: 0.481
Validation loss decreased (inf --> -0.480841).  Saving model ...
Epoch: 2 cost time: 11.380184888839722
Epoch: 2, Steps: 32 | Train Loss: 3.884 Vali Loss: 20.341 Vali Acc: 0.450 Test Loss: 20.341 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.545350790023804
Epoch: 3, Steps: 32 | Train Loss: 7.407 Vali Loss: 22.162 Vali Acc: 0.496 Test Loss: 22.162 Test Acc: 0.496
Validation loss decreased (-0.480841 --> -0.495962).  Saving model ...
Epoch: 4 cost time: 12.223353862762451
Epoch: 4, Steps: 32 | Train Loss: 4.526 Vali Loss: 20.215 Vali Acc: 0.450 Test Loss: 20.215 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.529629945755005
Epoch: 5, Steps: 32 | Train Loss: 1.957 Vali Loss: 23.892 Vali Acc: 0.412 Test Loss: 23.892 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.268388509750366
Epoch: 6, Steps: 32 | Train Loss: 2.571 Vali Loss: 22.955 Vali Acc: 0.458 Test Loss: 22.955 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 13.05203628540039
Epoch: 7, Steps: 32 | Train Loss: 2.773 Vali Loss: 36.965 Vali Acc: 0.450 Test Loss: 36.965 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 12.076405763626099
Epoch: 8, Steps: 32 | Train Loss: 1.633 Vali Loss: 49.051 Vali Acc: 0.397 Test Loss: 49.051 Test Acc: 0.397
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 12.235657930374146
Epoch: 9, Steps: 32 | Train Loss: 2.234 Vali Loss: 47.308 Vali Acc: 0.420 Test Loss: 47.308 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 12.407268047332764
Epoch: 10, Steps: 32 | Train Loss: 2.276 Vali Loss: 59.242 Vali Acc: 0.450 Test Loss: 59.242 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 12.39314079284668
Epoch: 11, Steps: 32 | Train Loss: 2.084 Vali Loss: 46.578 Vali Acc: 0.489 Test Loss: 46.578 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 12.569687366485596
Epoch: 12, Steps: 32 | Train Loss: 1.076 Vali Loss: 59.073 Vali Acc: 0.527 Test Loss: 59.073 Test Acc: 0.527
Validation loss decreased (-0.495962 --> -0.526127).  Saving model ...
Epoch: 13 cost time: 12.062734603881836
Epoch: 13, Steps: 32 | Train Loss: 4.409 Vali Loss: 74.945 Vali Acc: 0.481 Test Loss: 74.945 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 12.170457363128662
Epoch: 14, Steps: 32 | Train Loss: 2.873 Vali Loss: 103.186 Vali Acc: 0.504 Test Loss: 103.186 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 12.313661098480225
Epoch: 15, Steps: 32 | Train Loss: 1.890 Vali Loss: 109.974 Vali Acc: 0.443 Test Loss: 109.974 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 12.145870923995972
Epoch: 16, Steps: 32 | Train Loss: 0.868 Vali Loss: 66.783 Vali Acc: 0.450 Test Loss: 66.783 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 12.554642677307129
Epoch: 17, Steps: 32 | Train Loss: 0.535 Vali Loss: 64.345 Vali Acc: 0.481 Test Loss: 64.345 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 13.281988859176636
Epoch: 18, Steps: 32 | Train Loss: 2.934 Vali Loss: 141.544 Vali Acc: 0.466 Test Loss: 141.544 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 12.62502646446228
Epoch: 19, Steps: 32 | Train Loss: 1.962 Vali Loss: 110.401 Vali Acc: 0.420 Test Loss: 110.401 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 12.355164289474487
Epoch: 20, Steps: 32 | Train Loss: 3.781 Vali Loss: 99.786 Vali Acc: 0.458 Test Loss: 99.786 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 12.446939706802368
Epoch: 21, Steps: 32 | Train Loss: 3.054 Vali Loss: 79.838 Vali Acc: 0.466 Test Loss: 79.838 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 12.445272207260132
Epoch: 22, Steps: 32 | Train Loss: 5.142 Vali Loss: 167.742 Vali Acc: 0.275 Test Loss: 167.742 Test Acc: 0.275
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df256_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 6021317
model size : 31.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df256_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.801509380340576
Epoch: 1, Steps: 32 | Train Loss: 5.689 Vali Loss: 4.871 Vali Acc: 0.443 Test Loss: 4.871 Test Acc: 0.443
Validation loss decreased (inf --> -0.442699).  Saving model ...
Epoch: 2 cost time: 12.477631330490112
Epoch: 2, Steps: 32 | Train Loss: 6.251 Vali Loss: 25.945 Vali Acc: 0.458 Test Loss: 25.945 Test Acc: 0.458
Validation loss decreased (-0.442699 --> -0.457756).  Saving model ...
Epoch: 3 cost time: 10.844873905181885
Epoch: 3, Steps: 32 | Train Loss: 4.854 Vali Loss: 19.379 Vali Acc: 0.473 Test Loss: 19.379 Test Acc: 0.473
Validation loss decreased (-0.457756 --> -0.473089).  Saving model ...
Epoch: 4 cost time: 11.606330156326294
Epoch: 4, Steps: 32 | Train Loss: 3.025 Vali Loss: 13.412 Vali Acc: 0.427 Test Loss: 13.412 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.053887128829956
Epoch: 5, Steps: 32 | Train Loss: 11.372 Vali Loss: 26.161 Vali Acc: 0.328 Test Loss: 26.161 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.71610403060913
Epoch: 6, Steps: 32 | Train Loss: 3.489 Vali Loss: 21.320 Vali Acc: 0.466 Test Loss: 21.320 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 11.48924994468689
Epoch: 7, Steps: 32 | Train Loss: 5.511 Vali Loss: 48.736 Vali Acc: 0.412 Test Loss: 48.736 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 10.817163467407227
Epoch: 8, Steps: 32 | Train Loss: 2.559 Vali Loss: 51.117 Vali Acc: 0.466 Test Loss: 51.117 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 10.653442144393921
Epoch: 9, Steps: 32 | Train Loss: 4.822 Vali Loss: 64.166 Vali Acc: 0.351 Test Loss: 64.166 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 10.996708631515503
Epoch: 10, Steps: 32 | Train Loss: 4.894 Vali Loss: 49.258 Vali Acc: 0.473 Test Loss: 49.258 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 10.973430395126343
Epoch: 11, Steps: 32 | Train Loss: 3.642 Vali Loss: 36.593 Vali Acc: 0.527 Test Loss: 36.593 Test Acc: 0.527
Validation loss decreased (-0.473089 --> -0.526352).  Saving model ...
Epoch: 12 cost time: 10.868131160736084
Epoch: 12, Steps: 32 | Train Loss: 1.786 Vali Loss: 38.676 Vali Acc: 0.557 Test Loss: 38.676 Test Acc: 0.557
Validation loss decreased (-0.526352 --> -0.556865).  Saving model ...
Epoch: 13 cost time: 11.222904920578003
Epoch: 13, Steps: 32 | Train Loss: 0.563 Vali Loss: 43.252 Vali Acc: 0.542 Test Loss: 43.252 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 10.651444673538208
Epoch: 14, Steps: 32 | Train Loss: 0.582 Vali Loss: 36.775 Vali Acc: 0.580 Test Loss: 36.775 Test Acc: 0.580
Validation loss decreased (-0.556865 --> -0.579785).  Saving model ...
Epoch: 15 cost time: 11.085538625717163
Epoch: 15, Steps: 32 | Train Loss: 1.139 Vali Loss: 58.080 Vali Acc: 0.382 Test Loss: 58.080 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 11.504624366760254
Epoch: 16, Steps: 32 | Train Loss: 0.452 Vali Loss: 69.913 Vali Acc: 0.550 Test Loss: 69.913 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 10.98811149597168
Epoch: 17, Steps: 32 | Train Loss: 4.466 Vali Loss: 47.131 Vali Acc: 0.527 Test Loss: 47.131 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 12.218313455581665
Epoch: 18, Steps: 32 | Train Loss: 0.174 Vali Loss: 54.255 Vali Acc: 0.542 Test Loss: 54.255 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 11.957577466964722
Epoch: 19, Steps: 32 | Train Loss: 1.233 Vali Loss: 58.739 Vali Acc: 0.550 Test Loss: 58.739 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 12.27987551689148
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.583 Vali Acc: 0.527 Test Loss: 67.583 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 11.511237621307373
Epoch: 21, Steps: 32 | Train Loss: 0.096 Vali Loss: 131.280 Vali Acc: 0.412 Test Loss: 131.280 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 10.604049444198608
Epoch: 22, Steps: 32 | Train Loss: 4.718 Vali Loss: 106.091 Vali Acc: 0.321 Test Loss: 106.091 Test Acc: 0.321
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 11.109838724136353
Epoch: 23, Steps: 32 | Train Loss: 0.412 Vali Loss: 92.804 Vali Acc: 0.511 Test Loss: 92.804 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 10.985577583312988
Epoch: 24, Steps: 32 | Train Loss: 0.273 Vali Loss: 68.060 Vali Acc: 0.550 Test Loss: 68.060 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df256_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 6021317
model size : 31.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df256_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.351002216339111
Epoch: 1, Steps: 32 | Train Loss: 4.905 Vali Loss: 8.760 Vali Acc: 0.366 Test Loss: 8.760 Test Acc: 0.366
Validation loss decreased (inf --> -0.366325).  Saving model ...
Epoch: 2 cost time: 11.017073154449463
Epoch: 2, Steps: 32 | Train Loss: 6.052 Vali Loss: 14.653 Vali Acc: 0.443 Test Loss: 14.653 Test Acc: 0.443
Validation loss decreased (-0.366325 --> -0.442602).  Saving model ...
Epoch: 3 cost time: 11.364922761917114
Epoch: 3, Steps: 32 | Train Loss: 3.315 Vali Loss: 9.254 Vali Acc: 0.534 Test Loss: 9.254 Test Acc: 0.534
Validation loss decreased (-0.442602 --> -0.534259).  Saving model ...
Epoch: 4 cost time: 11.46901798248291
Epoch: 4, Steps: 32 | Train Loss: 2.024 Vali Loss: 18.393 Vali Acc: 0.504 Test Loss: 18.393 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.864062547683716
Epoch: 5, Steps: 32 | Train Loss: 2.058 Vali Loss: 20.061 Vali Acc: 0.282 Test Loss: 20.061 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.047078132629395
Epoch: 6, Steps: 32 | Train Loss: 3.857 Vali Loss: 25.553 Vali Acc: 0.328 Test Loss: 25.553 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 11.721636295318604
Epoch: 7, Steps: 32 | Train Loss: 3.704 Vali Loss: 21.516 Vali Acc: 0.565 Test Loss: 21.516 Test Acc: 0.565
Validation loss decreased (-0.534259 --> -0.564670).  Saving model ...
Epoch: 8 cost time: 12.521971225738525
Epoch: 8, Steps: 32 | Train Loss: 0.820 Vali Loss: 28.280 Vali Acc: 0.534 Test Loss: 28.280 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.759945154190063
Epoch: 9, Steps: 32 | Train Loss: 2.714 Vali Loss: 57.394 Vali Acc: 0.374 Test Loss: 57.394 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.52966833114624
Epoch: 10, Steps: 32 | Train Loss: 8.394 Vali Loss: 65.048 Vali Acc: 0.397 Test Loss: 65.048 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 11.778101921081543
Epoch: 11, Steps: 32 | Train Loss: 8.296 Vali Loss: 70.416 Vali Acc: 0.527 Test Loss: 70.416 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 11.294653415679932
Epoch: 12, Steps: 32 | Train Loss: 3.322 Vali Loss: 52.274 Vali Acc: 0.443 Test Loss: 52.274 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 11.233439922332764
Epoch: 13, Steps: 32 | Train Loss: 1.104 Vali Loss: 50.516 Vali Acc: 0.473 Test Loss: 50.516 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 11.143394708633423
Epoch: 14, Steps: 32 | Train Loss: 1.730 Vali Loss: 75.228 Vali Acc: 0.527 Test Loss: 75.228 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 11.27443552017212
Epoch: 15, Steps: 32 | Train Loss: 2.174 Vali Loss: 48.578 Vali Acc: 0.534 Test Loss: 48.578 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 11.341130495071411
Epoch: 16, Steps: 32 | Train Loss: 6.973 Vali Loss: 52.873 Vali Acc: 0.542 Test Loss: 52.873 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 11.471786499023438
Epoch: 17, Steps: 32 | Train Loss: 2.393 Vali Loss: 48.259 Vali Acc: 0.580 Test Loss: 48.259 Test Acc: 0.580
Validation loss decreased (-0.564670 --> -0.579670).  Saving model ...
Epoch: 18 cost time: 10.913707256317139
Epoch: 18, Steps: 32 | Train Loss: 0.887 Vali Loss: 96.232 Vali Acc: 0.565 Test Loss: 96.232 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 10.529808282852173
Epoch: 19, Steps: 32 | Train Loss: 1.534 Vali Loss: 136.798 Vali Acc: 0.511 Test Loss: 136.798 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 11.177345514297485
Epoch: 20, Steps: 32 | Train Loss: 1.832 Vali Loss: 65.512 Vali Acc: 0.527 Test Loss: 65.512 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 11.363360404968262
Epoch: 21, Steps: 32 | Train Loss: 0.479 Vali Loss: 92.181 Vali Acc: 0.573 Test Loss: 92.181 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 12.04944109916687
Epoch: 22, Steps: 32 | Train Loss: 1.247 Vali Loss: 106.134 Vali Acc: 0.565 Test Loss: 106.134 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 10.989153623580933
Epoch: 23, Steps: 32 | Train Loss: 2.687 Vali Loss: 47.831 Vali Acc: 0.527 Test Loss: 47.831 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 11.70943570137024
Epoch: 24, Steps: 32 | Train Loss: 0.469 Vali Loss: 44.679 Vali Acc: 0.542 Test Loss: 44.679 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 12.010751724243164
Epoch: 25, Steps: 32 | Train Loss: 1.226 Vali Loss: 39.865 Vali Acc: 0.557 Test Loss: 39.865 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 12.423054218292236
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 61.550 Vali Acc: 0.427 Test Loss: 61.550 Test Acc: 0.427
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 11.926885604858398
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 74.553 Vali Acc: 0.573 Test Loss: 74.553 Test Acc: 0.573
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df256_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 6021317
model size : 31.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         8992                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df128_ma8992_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 79.86014676094055
Epoch: 1, Steps: 32 | Train Loss: 6.692 Vali Loss: 12.601 Vali Acc: 0.351 Test Loss: 12.601 Test Acc: 0.351
Validation loss decreased (inf --> -0.351019).  Saving model ...
Epoch: 2 cost time: 81.23301601409912
Epoch: 2, Steps: 32 | Train Loss: 10.045 Vali Loss: 13.029 Vali Acc: 0.511 Test Loss: 13.029 Test Acc: 0.511
Validation loss decreased (-0.351019 --> -0.511320).  Saving model ...
Epoch: 3 cost time: 92.66967034339905
Epoch: 3, Steps: 32 | Train Loss: 4.207 Vali Loss: 23.204 Vali Acc: 0.481 Test Loss: 23.204 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 104.21369338035583
Epoch: 4, Steps: 32 | Train Loss: 5.938 Vali Loss: 30.914 Vali Acc: 0.534 Test Loss: 30.914 Test Acc: 0.534
Validation loss decreased (-0.511320 --> -0.534042).  Saving model ...
Epoch: 5 cost time: 110.19174671173096
Epoch: 5, Steps: 32 | Train Loss: 5.611 Vali Loss: 35.077 Vali Acc: 0.466 Test Loss: 35.077 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 104.80824851989746
Epoch: 6, Steps: 32 | Train Loss: 7.105 Vali Loss: 53.772 Vali Acc: 0.290 Test Loss: 53.772 Test Acc: 0.290
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 105.83643460273743
Epoch: 7, Steps: 32 | Train Loss: 5.958 Vali Loss: 45.839 Vali Acc: 0.565 Test Loss: 45.839 Test Acc: 0.565
Validation loss decreased (-0.534042 --> -0.564427).  Saving model ...
Epoch: 8 cost time: 109.74969577789307
Epoch: 8, Steps: 32 | Train Loss: 3.372 Vali Loss: 104.840 Vali Acc: 0.267 Test Loss: 104.840 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 109.95521211624146
Epoch: 9, Steps: 32 | Train Loss: 7.839 Vali Loss: 63.309 Vali Acc: 0.351 Test Loss: 63.309 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 111.24656295776367
Epoch: 10, Steps: 32 | Train Loss: 1.151 Vali Loss: 58.741 Vali Acc: 0.557 Test Loss: 58.741 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 115.65818643569946
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 59.969 Vali Acc: 0.527 Test Loss: 59.969 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 117.33212566375732
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 61.559 Vali Acc: 0.527 Test Loss: 61.559 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 114.29007053375244
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 61.620 Vali Acc: 0.527 Test Loss: 61.620 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 113.40705680847168
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 61.622 Vali Acc: 0.527 Test Loss: 61.622 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 115.82103776931763
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 61.622 Vali Acc: 0.527 Test Loss: 61.622 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 114.45553874969482
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 61.622 Vali Acc: 0.527 Test Loss: 61.622 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 114.58588361740112
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 61.622 Vali Acc: 0.527 Test Loss: 61.622 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df128_ma8992_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 5972165
model size : 31.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         7194                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df128_ma7194_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 65.65030574798584
Epoch: 1, Steps: 32 | Train Loss: 6.305 Vali Loss: 10.161 Vali Acc: 0.244 Test Loss: 10.161 Test Acc: 0.244
Validation loss decreased (inf --> -0.244173).  Saving model ...
Epoch: 2 cost time: 66.78745722770691
Epoch: 2, Steps: 32 | Train Loss: 4.694 Vali Loss: 22.934 Vali Acc: 0.214 Test Loss: 22.934 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 74.27417588233948
Epoch: 3, Steps: 32 | Train Loss: 9.464 Vali Loss: 22.802 Vali Acc: 0.191 Test Loss: 22.802 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 80.74873852729797
Epoch: 4, Steps: 32 | Train Loss: 4.314 Vali Loss: 20.440 Vali Acc: 0.382 Test Loss: 20.440 Test Acc: 0.382
Validation loss decreased (-0.244173 --> -0.381475).  Saving model ...
Epoch: 5 cost time: 83.7212746143341
Epoch: 5, Steps: 32 | Train Loss: 7.034 Vali Loss: 26.943 Vali Acc: 0.496 Test Loss: 26.943 Test Acc: 0.496
Validation loss decreased (-0.381475 --> -0.495914).  Saving model ...
Epoch: 6 cost time: 93.2528600692749
Epoch: 6, Steps: 32 | Train Loss: 4.488 Vali Loss: 41.767 Vali Acc: 0.504 Test Loss: 41.767 Test Acc: 0.504
Validation loss decreased (-0.495914 --> -0.503399).  Saving model ...
Epoch: 7 cost time: 95.81987071037292
Epoch: 7, Steps: 32 | Train Loss: 2.419 Vali Loss: 49.332 Vali Acc: 0.405 Test Loss: 49.332 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 93.22418880462646
Epoch: 8, Steps: 32 | Train Loss: 1.290 Vali Loss: 73.498 Vali Acc: 0.313 Test Loss: 73.498 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 92.94866371154785
Epoch: 9, Steps: 32 | Train Loss: 2.103 Vali Loss: 49.803 Vali Acc: 0.504 Test Loss: 49.803 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 94.38251566886902
Epoch: 10, Steps: 32 | Train Loss: 0.129 Vali Loss: 52.135 Vali Acc: 0.489 Test Loss: 52.135 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 96.14735651016235
Epoch: 11, Steps: 32 | Train Loss: 0.696 Vali Loss: 50.654 Vali Acc: 0.489 Test Loss: 50.654 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 97.24961113929749
Epoch: 12, Steps: 32 | Train Loss: 0.108 Vali Loss: 84.866 Vali Acc: 0.542 Test Loss: 84.866 Test Acc: 0.542
Validation loss decreased (-0.503399 --> -0.541136).  Saving model ...
Epoch: 13 cost time: 93.10590696334839
Epoch: 13, Steps: 32 | Train Loss: 0.414 Vali Loss: 52.107 Vali Acc: 0.542 Test Loss: 52.107 Test Acc: 0.542
Validation loss decreased (-0.541136 --> -0.541464).  Saving model ...
Epoch: 14 cost time: 90.95283460617065
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 52.887 Vali Acc: 0.565 Test Loss: 52.887 Test Acc: 0.565
Validation loss decreased (-0.541464 --> -0.564357).  Saving model ...
Epoch: 15 cost time: 91.20754885673523
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 52.927 Vali Acc: 0.580 Test Loss: 52.927 Test Acc: 0.580
Validation loss decreased (-0.564357 --> -0.579623).  Saving model ...
Epoch: 16 cost time: 91.31929564476013
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 52.929 Vali Acc: 0.580 Test Loss: 52.929 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 91.64614701271057
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 52.929 Vali Acc: 0.580 Test Loss: 52.929 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 92.21835207939148
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 52.929 Vali Acc: 0.580 Test Loss: 52.929 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 93.33464884757996
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 52.929 Vali Acc: 0.580 Test Loss: 52.929 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 91.99377584457397
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 52.929 Vali Acc: 0.580 Test Loss: 52.929 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 92.92364192008972
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 52.929 Vali Acc: 0.580 Test Loss: 52.929 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 91.5331859588623
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 52.929 Vali Acc: 0.580 Test Loss: 52.929 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 92.11934089660645
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 52.929 Vali Acc: 0.580 Test Loss: 52.929 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 92.62973237037659
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 52.929 Vali Acc: 0.580 Test Loss: 52.929 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 91.8036561012268
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 52.929 Vali Acc: 0.580 Test Loss: 52.929 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df128_ma7194_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 5972165
model size : 31.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5396                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df128_ma5396_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 51.63420057296753
Epoch: 1, Steps: 32 | Train Loss: 5.730 Vali Loss: 7.216 Vali Acc: 0.473 Test Loss: 7.216 Test Acc: 0.473
Validation loss decreased (inf --> -0.473210).  Saving model ...
Epoch: 2 cost time: 50.49639391899109
Epoch: 2, Steps: 32 | Train Loss: 3.347 Vali Loss: 14.766 Vali Acc: 0.328 Test Loss: 14.766 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 55.87368106842041
Epoch: 3, Steps: 32 | Train Loss: 6.062 Vali Loss: 23.450 Vali Acc: 0.260 Test Loss: 23.450 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 66.40127635002136
Epoch: 4, Steps: 32 | Train Loss: 3.689 Vali Loss: 17.701 Vali Acc: 0.511 Test Loss: 17.701 Test Acc: 0.511
Validation loss decreased (-0.473210 --> -0.511273).  Saving model ...
Epoch: 5 cost time: 68.83314418792725
Epoch: 5, Steps: 32 | Train Loss: 1.551 Vali Loss: 39.776 Vali Acc: 0.443 Test Loss: 39.776 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 67.11261630058289
Epoch: 6, Steps: 32 | Train Loss: 4.529 Vali Loss: 44.837 Vali Acc: 0.557 Test Loss: 44.837 Test Acc: 0.557
Validation loss decreased (-0.511273 --> -0.556804).  Saving model ...
Epoch: 7 cost time: 68.75428891181946
Epoch: 7, Steps: 32 | Train Loss: 3.042 Vali Loss: 56.248 Vali Acc: 0.519 Test Loss: 56.248 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 71.07724905014038
Epoch: 8, Steps: 32 | Train Loss: 2.971 Vali Loss: 46.234 Vali Acc: 0.534 Test Loss: 46.234 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 70.09380745887756
Epoch: 9, Steps: 32 | Train Loss: 3.457 Vali Loss: 80.923 Vali Acc: 0.244 Test Loss: 80.923 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 68.31272721290588
Epoch: 10, Steps: 32 | Train Loss: 7.153 Vali Loss: 48.961 Vali Acc: 0.397 Test Loss: 48.961 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 70.15659785270691
Epoch: 11, Steps: 32 | Train Loss: 3.601 Vali Loss: 54.061 Vali Acc: 0.527 Test Loss: 54.061 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 68.92024874687195
Epoch: 12, Steps: 32 | Train Loss: 2.555 Vali Loss: 58.483 Vali Acc: 0.573 Test Loss: 58.483 Test Acc: 0.573
Validation loss decreased (-0.556804 --> -0.571934).  Saving model ...
Epoch: 13 cost time: 70.92831492424011
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 51.053 Vali Acc: 0.519 Test Loss: 51.053 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 70.70530986785889
Epoch: 14, Steps: 32 | Train Loss: 0.237 Vali Loss: 49.256 Vali Acc: 0.542 Test Loss: 49.256 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 71.15816712379456
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 49.227 Vali Acc: 0.550 Test Loss: 49.227 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 72.76853656768799
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 49.239 Vali Acc: 0.550 Test Loss: 49.239 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 72.57144284248352
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 49.237 Vali Acc: 0.550 Test Loss: 49.237 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 72.74247694015503
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 49.230 Vali Acc: 0.550 Test Loss: 49.230 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 72.40741515159607
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 49.228 Vali Acc: 0.550 Test Loss: 49.228 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 72.1076922416687
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 49.228 Vali Acc: 0.550 Test Loss: 49.228 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 73.88817095756531
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 49.228 Vali Acc: 0.550 Test Loss: 49.228 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 72.20222353935242
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 49.228 Vali Acc: 0.550 Test Loss: 49.228 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df128_ma5396_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 5972165
model size : 31.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3597                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df128_ma3597_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 38.18635869026184
Epoch: 1, Steps: 32 | Train Loss: 6.833 Vali Loss: 14.422 Vali Acc: 0.435 Test Loss: 14.422 Test Acc: 0.435
Validation loss decreased (inf --> -0.434970).  Saving model ...
Epoch: 2 cost time: 37.31283116340637
Epoch: 2, Steps: 32 | Train Loss: 5.630 Vali Loss: 18.801 Vali Acc: 0.229 Test Loss: 18.801 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 39.696372985839844
Epoch: 3, Steps: 32 | Train Loss: 9.092 Vali Loss: 18.240 Vali Acc: 0.412 Test Loss: 18.240 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 45.397730112075806
Epoch: 4, Steps: 32 | Train Loss: 4.797 Vali Loss: 47.698 Vali Acc: 0.458 Test Loss: 47.698 Test Acc: 0.458
Validation loss decreased (-0.434970 --> -0.457538).  Saving model ...
Epoch: 5 cost time: 46.85558485984802
Epoch: 5, Steps: 32 | Train Loss: 7.058 Vali Loss: 31.613 Vali Acc: 0.527 Test Loss: 31.613 Test Acc: 0.527
Validation loss decreased (-0.457538 --> -0.526401).  Saving model ...
Epoch: 6 cost time: 49.8230676651001
Epoch: 6, Steps: 32 | Train Loss: 2.531 Vali Loss: 31.744 Vali Acc: 0.534 Test Loss: 31.744 Test Acc: 0.534
Validation loss decreased (-0.526401 --> -0.534034).  Saving model ...
Epoch: 7 cost time: 50.00999069213867
Epoch: 7, Steps: 32 | Train Loss: 3.853 Vali Loss: 56.180 Vali Acc: 0.496 Test Loss: 56.180 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 51.90245509147644
Epoch: 8, Steps: 32 | Train Loss: 1.730 Vali Loss: 52.705 Vali Acc: 0.359 Test Loss: 52.705 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 53.571404218673706
Epoch: 9, Steps: 32 | Train Loss: 2.120 Vali Loss: 58.596 Vali Acc: 0.550 Test Loss: 58.596 Test Acc: 0.550
Validation loss decreased (-0.534034 --> -0.549032).  Saving model ...
Epoch: 10 cost time: 50.11608028411865
Epoch: 10, Steps: 32 | Train Loss: 5.213 Vali Loss: 87.837 Vali Acc: 0.435 Test Loss: 87.837 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 51.29740118980408
Epoch: 11, Steps: 32 | Train Loss: 2.750 Vali Loss: 64.329 Vali Acc: 0.443 Test Loss: 64.329 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 50.622488021850586
Epoch: 12, Steps: 32 | Train Loss: 0.696 Vali Loss: 71.254 Vali Acc: 0.481 Test Loss: 71.254 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 51.21547222137451
Epoch: 13, Steps: 32 | Train Loss: 2.481 Vali Loss: 63.878 Vali Acc: 0.466 Test Loss: 63.878 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 51.352947473526
Epoch: 14, Steps: 32 | Train Loss: 0.055 Vali Loss: 68.673 Vali Acc: 0.389 Test Loss: 68.673 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 50.51201152801514
Epoch: 15, Steps: 32 | Train Loss: 0.508 Vali Loss: 99.891 Vali Acc: 0.534 Test Loss: 99.891 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 50.25109100341797
Epoch: 16, Steps: 32 | Train Loss: 1.482 Vali Loss: 102.059 Vali Acc: 0.542 Test Loss: 102.059 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 51.33045148849487
Epoch: 17, Steps: 32 | Train Loss: 0.552 Vali Loss: 85.550 Vali Acc: 0.450 Test Loss: 85.550 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 51.11579704284668
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 106.980 Vali Acc: 0.542 Test Loss: 106.980 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 50.33034563064575
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 103.884 Vali Acc: 0.542 Test Loss: 103.884 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df128_ma3597_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 5972165
model size : 31.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1799                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df128_ma1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 23.73744535446167
Epoch: 1, Steps: 32 | Train Loss: 5.536 Vali Loss: 2.728 Vali Acc: 0.504 Test Loss: 2.728 Test Acc: 0.504
Validation loss decreased (inf --> -0.503790).  Saving model ...
Epoch: 2 cost time: 22.827595949172974
Epoch: 2, Steps: 32 | Train Loss: 2.968 Vali Loss: 6.446 Vali Acc: 0.405 Test Loss: 6.446 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 24.755722999572754
Epoch: 3, Steps: 32 | Train Loss: 6.736 Vali Loss: 19.636 Vali Acc: 0.282 Test Loss: 19.636 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 27.95198154449463
Epoch: 4, Steps: 32 | Train Loss: 9.934 Vali Loss: 39.737 Vali Acc: 0.160 Test Loss: 39.737 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 28.82038402557373
Epoch: 5, Steps: 32 | Train Loss: 12.288 Vali Loss: 47.555 Vali Acc: 0.496 Test Loss: 47.555 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 28.936811685562134
Epoch: 6, Steps: 32 | Train Loss: 4.680 Vali Loss: 51.454 Vali Acc: 0.519 Test Loss: 51.454 Test Acc: 0.519
Validation loss decreased (-0.503790 --> -0.518569).  Saving model ...
Epoch: 7 cost time: 30.064366579055786
Epoch: 7, Steps: 32 | Train Loss: 2.399 Vali Loss: 50.918 Vali Acc: 0.595 Test Loss: 50.918 Test Acc: 0.595
Validation loss decreased (-0.518569 --> -0.594911).  Saving model ...
Epoch: 8 cost time: 29.07553791999817
Epoch: 8, Steps: 32 | Train Loss: 1.901 Vali Loss: 43.515 Vali Acc: 0.511 Test Loss: 43.515 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 30.0307137966156
Epoch: 9, Steps: 32 | Train Loss: 2.399 Vali Loss: 48.065 Vali Acc: 0.557 Test Loss: 48.065 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 30.778002500534058
Epoch: 10, Steps: 32 | Train Loss: 0.564 Vali Loss: 46.472 Vali Acc: 0.473 Test Loss: 46.472 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 29.845369577407837
Epoch: 11, Steps: 32 | Train Loss: 1.134 Vali Loss: 56.272 Vali Acc: 0.542 Test Loss: 56.272 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 29.728360176086426
Epoch: 12, Steps: 32 | Train Loss: 2.247 Vali Loss: 81.075 Vali Acc: 0.489 Test Loss: 81.075 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 30.706854343414307
Epoch: 13, Steps: 32 | Train Loss: 3.342 Vali Loss: 83.705 Vali Acc: 0.435 Test Loss: 83.705 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 29.50750470161438
Epoch: 14, Steps: 32 | Train Loss: 4.023 Vali Loss: 65.466 Vali Acc: 0.504 Test Loss: 65.466 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 29.951494455337524
Epoch: 15, Steps: 32 | Train Loss: 0.976 Vali Loss: 62.715 Vali Acc: 0.550 Test Loss: 62.715 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 29.12379789352417
Epoch: 16, Steps: 32 | Train Loss: 1.201 Vali Loss: 64.641 Vali Acc: 0.527 Test Loss: 64.641 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 29.519245147705078
Epoch: 17, Steps: 32 | Train Loss: 0.949 Vali Loss: 68.467 Vali Acc: 0.511 Test Loss: 68.467 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df128_ma1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 5972165
model size : 31.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df128_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 16.038659811019897
Epoch: 1, Steps: 32 | Train Loss: 5.661 Vali Loss: 6.123 Vali Acc: 0.359 Test Loss: 6.123 Test Acc: 0.359
Validation loss decreased (inf --> -0.358717).  Saving model ...
Epoch: 2 cost time: 14.768299579620361
Epoch: 2, Steps: 32 | Train Loss: 2.285 Vali Loss: 6.069 Vali Acc: 0.427 Test Loss: 6.069 Test Acc: 0.427
Validation loss decreased (-0.358717 --> -0.427420).  Saving model ...
Epoch: 3 cost time: 15.077052593231201
Epoch: 3, Steps: 32 | Train Loss: 3.565 Vali Loss: 13.176 Vali Acc: 0.504 Test Loss: 13.176 Test Acc: 0.504
Validation loss decreased (-0.427420 --> -0.503685).  Saving model ...
Epoch: 4 cost time: 17.156126976013184
Epoch: 4, Steps: 32 | Train Loss: 6.673 Vali Loss: 28.680 Vali Acc: 0.511 Test Loss: 28.680 Test Acc: 0.511
Validation loss decreased (-0.503685 --> -0.511164).  Saving model ...
Epoch: 5 cost time: 18.148775339126587
Epoch: 5, Steps: 32 | Train Loss: 4.225 Vali Loss: 55.682 Vali Acc: 0.504 Test Loss: 55.682 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 18.589650630950928
Epoch: 6, Steps: 32 | Train Loss: 14.492 Vali Loss: 36.688 Vali Acc: 0.321 Test Loss: 36.688 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 19.970593214035034
Epoch: 7, Steps: 32 | Train Loss: 2.760 Vali Loss: 72.577 Vali Acc: 0.511 Test Loss: 72.577 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 18.79326605796814
Epoch: 8, Steps: 32 | Train Loss: 1.139 Vali Loss: 32.505 Vali Acc: 0.573 Test Loss: 32.505 Test Acc: 0.573
Validation loss decreased (-0.511164 --> -0.572194).  Saving model ...
Epoch: 9 cost time: 18.809818744659424
Epoch: 9, Steps: 32 | Train Loss: 0.001 Vali Loss: 28.578 Vali Acc: 0.481 Test Loss: 28.578 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 18.262637615203857
Epoch: 10, Steps: 32 | Train Loss: 3.032 Vali Loss: 32.825 Vali Acc: 0.534 Test Loss: 32.825 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 18.86162829399109
Epoch: 11, Steps: 32 | Train Loss: 0.265 Vali Loss: 67.407 Vali Acc: 0.534 Test Loss: 67.407 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 18.656305074691772
Epoch: 12, Steps: 32 | Train Loss: 1.684 Vali Loss: 74.216 Vali Acc: 0.527 Test Loss: 74.216 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 18.75887179374695
Epoch: 13, Steps: 32 | Train Loss: 2.565 Vali Loss: 53.350 Vali Acc: 0.542 Test Loss: 53.350 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 19.12783408164978
Epoch: 14, Steps: 32 | Train Loss: 1.143 Vali Loss: 56.824 Vali Acc: 0.534 Test Loss: 56.824 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 18.534657955169678
Epoch: 15, Steps: 32 | Train Loss: 0.788 Vali Loss: 56.708 Vali Acc: 0.557 Test Loss: 56.708 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 17.983013153076172
Epoch: 16, Steps: 32 | Train Loss: 2.070 Vali Loss: 61.124 Vali Acc: 0.443 Test Loss: 61.124 Test Acc: 0.443
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 18.61935257911682
Epoch: 17, Steps: 32 | Train Loss: 1.490 Vali Loss: 66.591 Vali Acc: 0.565 Test Loss: 66.591 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 18.46900486946106
Epoch: 18, Steps: 32 | Train Loss: 3.638 Vali Loss: 59.220 Vali Acc: 0.405 Test Loss: 59.220 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df128_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 5972165
model size : 31.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         540                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df128_ma540_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.168599128723145
Epoch: 1, Steps: 32 | Train Loss: 4.105 Vali Loss: 4.805 Vali Acc: 0.481 Test Loss: 4.805 Test Acc: 0.481
Validation loss decreased (inf --> -0.480868).  Saving model ...
Epoch: 2 cost time: 12.802821159362793
Epoch: 2, Steps: 32 | Train Loss: 4.647 Vali Loss: 13.159 Vali Acc: 0.489 Test Loss: 13.159 Test Acc: 0.489
Validation loss decreased (-0.480868 --> -0.488418).  Saving model ...
Epoch: 3 cost time: 13.335912466049194
Epoch: 3, Steps: 32 | Train Loss: 2.758 Vali Loss: 22.045 Vali Acc: 0.450 Test Loss: 22.045 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 14.920787334442139
Epoch: 4, Steps: 32 | Train Loss: 4.851 Vali Loss: 27.001 Vali Acc: 0.412 Test Loss: 27.001 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 15.125441789627075
Epoch: 5, Steps: 32 | Train Loss: 5.250 Vali Loss: 39.935 Vali Acc: 0.481 Test Loss: 39.935 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 14.76521372795105
Epoch: 6, Steps: 32 | Train Loss: 1.803 Vali Loss: 46.378 Vali Acc: 0.511 Test Loss: 46.378 Test Acc: 0.511
Validation loss decreased (-0.488418 --> -0.510987).  Saving model ...
Epoch: 7 cost time: 14.82049822807312
Epoch: 7, Steps: 32 | Train Loss: 5.063 Vali Loss: 57.520 Vali Acc: 0.504 Test Loss: 57.520 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 14.90768575668335
Epoch: 8, Steps: 32 | Train Loss: 2.954 Vali Loss: 38.537 Vali Acc: 0.496 Test Loss: 38.537 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 14.970895528793335
Epoch: 9, Steps: 32 | Train Loss: 2.480 Vali Loss: 50.597 Vali Acc: 0.473 Test Loss: 50.597 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 15.070913791656494
Epoch: 10, Steps: 32 | Train Loss: 2.267 Vali Loss: 73.286 Vali Acc: 0.473 Test Loss: 73.286 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 14.632046461105347
Epoch: 11, Steps: 32 | Train Loss: 0.628 Vali Loss: 83.617 Vali Acc: 0.511 Test Loss: 83.617 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 14.191588640213013
Epoch: 12, Steps: 32 | Train Loss: 4.303 Vali Loss: 132.240 Vali Acc: 0.504 Test Loss: 132.240 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 14.725748777389526
Epoch: 13, Steps: 32 | Train Loss: 3.422 Vali Loss: 73.790 Vali Acc: 0.496 Test Loss: 73.790 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 15.304937601089478
Epoch: 14, Steps: 32 | Train Loss: 1.198 Vali Loss: 61.716 Vali Acc: 0.473 Test Loss: 61.716 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 14.998293161392212
Epoch: 15, Steps: 32 | Train Loss: 1.006 Vali Loss: 97.371 Vali Acc: 0.527 Test Loss: 97.371 Test Acc: 0.527
Validation loss decreased (-0.510987 --> -0.525744).  Saving model ...
Epoch: 16 cost time: 14.552975177764893
Epoch: 16, Steps: 32 | Train Loss: 2.656 Vali Loss: 146.275 Vali Acc: 0.496 Test Loss: 146.275 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 15.345680475234985
Epoch: 17, Steps: 32 | Train Loss: 0.986 Vali Loss: 59.769 Vali Acc: 0.481 Test Loss: 59.769 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 15.456063032150269
Epoch: 18, Steps: 32 | Train Loss: 0.168 Vali Loss: 83.032 Vali Acc: 0.458 Test Loss: 83.032 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 15.143648147583008
Epoch: 19, Steps: 32 | Train Loss: 0.177 Vali Loss: 79.928 Vali Acc: 0.473 Test Loss: 79.928 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 15.031721353530884
Epoch: 20, Steps: 32 | Train Loss: 0.132 Vali Loss: 159.163 Vali Acc: 0.504 Test Loss: 159.163 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 15.539579391479492
Epoch: 21, Steps: 32 | Train Loss: 1.581 Vali Loss: 70.755 Vali Acc: 0.511 Test Loss: 70.755 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 15.718816995620728
Epoch: 22, Steps: 32 | Train Loss: 0.073 Vali Loss: 95.981 Vali Acc: 0.489 Test Loss: 95.981 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 15.363955974578857
Epoch: 23, Steps: 32 | Train Loss: 2.676 Vali Loss: 82.368 Vali Acc: 0.443 Test Loss: 82.368 Test Acc: 0.443
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 15.75082802772522
Epoch: 24, Steps: 32 | Train Loss: 1.051 Vali Loss: 89.970 Vali Acc: 0.473 Test Loss: 89.970 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 15.448007345199585
Epoch: 25, Steps: 32 | Train Loss: 1.256 Vali Loss: 126.695 Vali Acc: 0.420 Test Loss: 126.695 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df128_ma540_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 5972165
model size : 31.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df128_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.391170740127563
Epoch: 1, Steps: 32 | Train Loss: 4.915 Vali Loss: 13.986 Vali Acc: 0.229 Test Loss: 13.986 Test Acc: 0.229
Validation loss decreased (inf --> -0.228868).  Saving model ...
Epoch: 2 cost time: 11.942965507507324
Epoch: 2, Steps: 32 | Train Loss: 4.500 Vali Loss: 6.188 Vali Acc: 0.405 Test Loss: 6.188 Test Acc: 0.405
Validation loss decreased (-0.228868 --> -0.404518).  Saving model ...
Epoch: 3 cost time: 11.788174152374268
Epoch: 3, Steps: 32 | Train Loss: 5.889 Vali Loss: 10.965 Vali Acc: 0.458 Test Loss: 10.965 Test Acc: 0.458
Validation loss decreased (-0.404518 --> -0.457906).  Saving model ...
Epoch: 4 cost time: 12.115613222122192
Epoch: 4, Steps: 32 | Train Loss: 2.945 Vali Loss: 26.258 Vali Acc: 0.511 Test Loss: 26.258 Test Acc: 0.511
Validation loss decreased (-0.457906 --> -0.511188).  Saving model ...
Epoch: 5 cost time: 13.225482940673828
Epoch: 5, Steps: 32 | Train Loss: 5.946 Vali Loss: 30.308 Vali Acc: 0.511 Test Loss: 30.308 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.02192497253418
Epoch: 6, Steps: 32 | Train Loss: 4.016 Vali Loss: 24.121 Vali Acc: 0.412 Test Loss: 24.121 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 12.970439434051514
Epoch: 7, Steps: 32 | Train Loss: 3.916 Vali Loss: 33.108 Vali Acc: 0.420 Test Loss: 33.108 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 12.778470039367676
Epoch: 8, Steps: 32 | Train Loss: 2.584 Vali Loss: 46.213 Vali Acc: 0.397 Test Loss: 46.213 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 13.223548650741577
Epoch: 9, Steps: 32 | Train Loss: 2.754 Vali Loss: 94.598 Vali Acc: 0.489 Test Loss: 94.598 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 12.923237800598145
Epoch: 10, Steps: 32 | Train Loss: 1.585 Vali Loss: 75.136 Vali Acc: 0.443 Test Loss: 75.136 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 13.13144564628601
Epoch: 11, Steps: 32 | Train Loss: 1.427 Vali Loss: 53.061 Vali Acc: 0.443 Test Loss: 53.061 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 13.151286125183105
Epoch: 12, Steps: 32 | Train Loss: 0.155 Vali Loss: 60.269 Vali Acc: 0.504 Test Loss: 60.269 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 12.80892038345337
Epoch: 13, Steps: 32 | Train Loss: 2.657 Vali Loss: 67.617 Vali Acc: 0.496 Test Loss: 67.617 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 13.00215744972229
Epoch: 14, Steps: 32 | Train Loss: 0.095 Vali Loss: 38.116 Vali Acc: 0.473 Test Loss: 38.116 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df128_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 5972165
model size : 31.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df128_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.536632776260376
Epoch: 1, Steps: 32 | Train Loss: 5.531 Vali Loss: 4.943 Vali Acc: 0.466 Test Loss: 4.943 Test Acc: 0.466
Validation loss decreased (inf --> -0.465599).  Saving model ...
Epoch: 2 cost time: 11.35438323020935
Epoch: 2, Steps: 32 | Train Loss: 4.227 Vali Loss: 6.520 Vali Acc: 0.458 Test Loss: 6.520 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.136533975601196
Epoch: 3, Steps: 32 | Train Loss: 4.239 Vali Loss: 11.510 Vali Acc: 0.519 Test Loss: 11.510 Test Acc: 0.519
Validation loss decreased (-0.465599 --> -0.518969).  Saving model ...
Epoch: 4 cost time: 12.415539026260376
Epoch: 4, Steps: 32 | Train Loss: 8.927 Vali Loss: 33.490 Vali Acc: 0.496 Test Loss: 33.490 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.544850826263428
Epoch: 5, Steps: 32 | Train Loss: 7.688 Vali Loss: 26.354 Vali Acc: 0.473 Test Loss: 26.354 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 13.180712699890137
Epoch: 6, Steps: 32 | Train Loss: 2.357 Vali Loss: 34.469 Vali Acc: 0.565 Test Loss: 34.469 Test Acc: 0.565
Validation loss decreased (-0.518969 --> -0.564541).  Saving model ...
Epoch: 7 cost time: 12.405367851257324
Epoch: 7, Steps: 32 | Train Loss: 1.546 Vali Loss: 35.302 Vali Acc: 0.374 Test Loss: 35.302 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 12.731168270111084
Epoch: 8, Steps: 32 | Train Loss: 3.355 Vali Loss: 28.532 Vali Acc: 0.542 Test Loss: 28.532 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 12.51619267463684
Epoch: 9, Steps: 32 | Train Loss: 0.263 Vali Loss: 26.148 Vali Acc: 0.542 Test Loss: 26.148 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 12.466241121292114
Epoch: 10, Steps: 32 | Train Loss: 1.787 Vali Loss: 57.800 Vali Acc: 0.519 Test Loss: 57.800 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 12.658270359039307
Epoch: 11, Steps: 32 | Train Loss: 0.001 Vali Loss: 35.509 Vali Acc: 0.534 Test Loss: 35.509 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 11.841779947280884
Epoch: 12, Steps: 32 | Train Loss: 1.480 Vali Loss: 64.918 Vali Acc: 0.519 Test Loss: 64.918 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 13.661231517791748
Epoch: 13, Steps: 32 | Train Loss: 2.109 Vali Loss: 63.555 Vali Acc: 0.511 Test Loss: 63.555 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 12.331162452697754
Epoch: 14, Steps: 32 | Train Loss: 2.007 Vali Loss: 48.191 Vali Acc: 0.405 Test Loss: 48.191 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 12.684227466583252
Epoch: 15, Steps: 32 | Train Loss: 3.948 Vali Loss: 76.881 Vali Acc: 0.527 Test Loss: 76.881 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 12.530002117156982
Epoch: 16, Steps: 32 | Train Loss: 1.338 Vali Loss: 63.190 Vali Acc: 0.427 Test Loss: 63.190 Test Acc: 0.427
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df128_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 5972165
model size : 31.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df128_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.271594762802124
Epoch: 1, Steps: 32 | Train Loss: 4.513 Vali Loss: 5.914 Vali Acc: 0.527 Test Loss: 5.914 Test Acc: 0.527
Validation loss decreased (inf --> -0.526658).  Saving model ...
Epoch: 2 cost time: 13.346619844436646
Epoch: 2, Steps: 32 | Train Loss: 2.846 Vali Loss: 4.675 Vali Acc: 0.519 Test Loss: 4.675 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.10031533241272
Epoch: 3, Steps: 32 | Train Loss: 3.330 Vali Loss: 15.063 Vali Acc: 0.450 Test Loss: 15.063 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.633462190628052
Epoch: 4, Steps: 32 | Train Loss: 3.686 Vali Loss: 9.095 Vali Acc: 0.504 Test Loss: 9.095 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 12.621774196624756
Epoch: 5, Steps: 32 | Train Loss: 1.543 Vali Loss: 21.844 Vali Acc: 0.427 Test Loss: 21.844 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 12.245144844055176
Epoch: 6, Steps: 32 | Train Loss: 4.237 Vali Loss: 27.885 Vali Acc: 0.534 Test Loss: 27.885 Test Acc: 0.534
Validation loss decreased (-0.526658 --> -0.534072).  Saving model ...
Epoch: 7 cost time: 12.341636896133423
Epoch: 7, Steps: 32 | Train Loss: 4.755 Vali Loss: 31.863 Vali Acc: 0.534 Test Loss: 31.863 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 12.35809874534607
Epoch: 8, Steps: 32 | Train Loss: 4.336 Vali Loss: 45.243 Vali Acc: 0.344 Test Loss: 45.243 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 11.753598928451538
Epoch: 9, Steps: 32 | Train Loss: 3.202 Vali Loss: 45.416 Vali Acc: 0.458 Test Loss: 45.416 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 12.222710847854614
Epoch: 10, Steps: 32 | Train Loss: 1.793 Vali Loss: 26.119 Vali Acc: 0.626 Test Loss: 26.119 Test Acc: 0.626
Validation loss decreased (-0.534072 --> -0.625693).  Saving model ...
Epoch: 11 cost time: 11.996186971664429
Epoch: 11, Steps: 32 | Train Loss: 0.042 Vali Loss: 37.782 Vali Acc: 0.573 Test Loss: 37.782 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 12.238532304763794
Epoch: 12, Steps: 32 | Train Loss: 1.588 Vali Loss: 51.799 Vali Acc: 0.527 Test Loss: 51.799 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 11.843849420547485
Epoch: 13, Steps: 32 | Train Loss: 1.645 Vali Loss: 31.461 Vali Acc: 0.542 Test Loss: 31.461 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 12.717912673950195
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 47.925 Vali Acc: 0.550 Test Loss: 47.925 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 12.187056303024292
Epoch: 15, Steps: 32 | Train Loss: 0.385 Vali Loss: 33.984 Vali Acc: 0.626 Test Loss: 33.984 Test Acc: 0.626
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 11.5008544921875
Epoch: 16, Steps: 32 | Train Loss: 0.781 Vali Loss: 68.561 Vali Acc: 0.527 Test Loss: 68.561 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 11.816534519195557
Epoch: 17, Steps: 32 | Train Loss: 1.104 Vali Loss: 32.840 Vali Acc: 0.412 Test Loss: 32.840 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 12.148022413253784
Epoch: 18, Steps: 32 | Train Loss: 0.329 Vali Loss: 63.424 Vali Acc: 0.534 Test Loss: 63.424 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 11.544079065322876
Epoch: 19, Steps: 32 | Train Loss: 0.441 Vali Loss: 140.927 Vali Acc: 0.489 Test Loss: 140.927 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 11.815597772598267
Epoch: 20, Steps: 32 | Train Loss: 8.941 Vali Loss: 83.461 Vali Acc: 0.550 Test Loss: 83.461 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl1_df128_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6259541984732825
model parameter : 5972165
model size : 31.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         8992                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma8992_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 47.50923752784729
Epoch: 1, Steps: 32 | Train Loss: 4.052 Vali Loss: 10.972 Vali Acc: 0.450 Test Loss: 10.972 Test Acc: 0.450
Validation loss decreased (inf --> -0.450272).  Saving model ...
Epoch: 2 cost time: 47.580740451812744
Epoch: 2, Steps: 32 | Train Loss: 4.950 Vali Loss: 8.721 Vali Acc: 0.221 Test Loss: 8.721 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 47.83811140060425
Epoch: 3, Steps: 32 | Train Loss: 1.615 Vali Loss: 10.023 Vali Acc: 0.534 Test Loss: 10.023 Test Acc: 0.534
Validation loss decreased (-0.450272 --> -0.534251).  Saving model ...
Epoch: 4 cost time: 54.07687497138977
Epoch: 4, Steps: 32 | Train Loss: 2.365 Vali Loss: 14.441 Vali Acc: 0.511 Test Loss: 14.441 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 56.79721140861511
Epoch: 5, Steps: 32 | Train Loss: 1.088 Vali Loss: 23.184 Vali Acc: 0.382 Test Loss: 23.184 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 56.23420310020447
Epoch: 6, Steps: 32 | Train Loss: 0.928 Vali Loss: 20.846 Vali Acc: 0.504 Test Loss: 20.846 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 62.001200675964355
Epoch: 7, Steps: 32 | Train Loss: 0.858 Vali Loss: 27.832 Vali Acc: 0.397 Test Loss: 27.832 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 61.155110597610474
Epoch: 8, Steps: 32 | Train Loss: 1.758 Vali Loss: 28.037 Vali Acc: 0.481 Test Loss: 28.037 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 65.88066482543945
Epoch: 9, Steps: 32 | Train Loss: 1.321 Vali Loss: 28.020 Vali Acc: 0.527 Test Loss: 28.020 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 67.6915647983551
Epoch: 10, Steps: 32 | Train Loss: 2.008 Vali Loss: 31.370 Vali Acc: 0.420 Test Loss: 31.370 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 63.022600412368774
Epoch: 11, Steps: 32 | Train Loss: 0.840 Vali Loss: 41.629 Vali Acc: 0.496 Test Loss: 41.629 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 63.3097083568573
Epoch: 12, Steps: 32 | Train Loss: 1.832 Vali Loss: 29.848 Vali Acc: 0.435 Test Loss: 29.848 Test Acc: 0.435
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 64.0526053905487
Epoch: 13, Steps: 32 | Train Loss: 1.890 Vali Loss: 42.662 Vali Acc: 0.366 Test Loss: 42.662 Test Acc: 0.366
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma8992_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 3313765
model size : 17.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         7194                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma7194_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 40.11037731170654
Epoch: 1, Steps: 32 | Train Loss: 3.938 Vali Loss: 7.706 Vali Acc: 0.450 Test Loss: 7.706 Test Acc: 0.450
Validation loss decreased (inf --> -0.450305).  Saving model ...
Epoch: 2 cost time: 40.033403635025024
Epoch: 2, Steps: 32 | Train Loss: 3.402 Vali Loss: 7.429 Vali Acc: 0.351 Test Loss: 7.429 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 39.69917416572571
Epoch: 3, Steps: 32 | Train Loss: 1.401 Vali Loss: 5.832 Vali Acc: 0.481 Test Loss: 5.832 Test Acc: 0.481
Validation loss decreased (-0.450305 --> -0.480858).  Saving model ...
Epoch: 4 cost time: 43.90385556221008
Epoch: 4, Steps: 32 | Train Loss: 1.405 Vali Loss: 14.674 Vali Acc: 0.473 Test Loss: 14.674 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 47.292863845825195
Epoch: 5, Steps: 32 | Train Loss: 1.023 Vali Loss: 14.205 Vali Acc: 0.466 Test Loss: 14.205 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 46.87130427360535
Epoch: 6, Steps: 32 | Train Loss: 1.851 Vali Loss: 26.201 Vali Acc: 0.221 Test Loss: 26.201 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 49.1895751953125
Epoch: 7, Steps: 32 | Train Loss: 2.370 Vali Loss: 28.641 Vali Acc: 0.374 Test Loss: 28.641 Test Acc: 0.374
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 53.95131993293762
Epoch: 8, Steps: 32 | Train Loss: 1.818 Vali Loss: 23.148 Vali Acc: 0.389 Test Loss: 23.148 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 53.535659074783325
Epoch: 9, Steps: 32 | Train Loss: 1.299 Vali Loss: 37.753 Vali Acc: 0.527 Test Loss: 37.753 Test Acc: 0.527
Validation loss decreased (-0.480858 --> -0.526340).  Saving model ...
Epoch: 10 cost time: 52.306195974349976
Epoch: 10, Steps: 32 | Train Loss: 3.835 Vali Loss: 46.237 Vali Acc: 0.473 Test Loss: 46.237 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 52.35703921318054
Epoch: 11, Steps: 32 | Train Loss: 3.418 Vali Loss: 38.575 Vali Acc: 0.328 Test Loss: 38.575 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 53.38456845283508
Epoch: 12, Steps: 32 | Train Loss: 0.555 Vali Loss: 45.002 Vali Acc: 0.328 Test Loss: 45.002 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 53.477588176727295
Epoch: 13, Steps: 32 | Train Loss: 1.095 Vali Loss: 43.658 Vali Acc: 0.504 Test Loss: 43.658 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 51.757352113723755
Epoch: 14, Steps: 32 | Train Loss: 0.731 Vali Loss: 39.249 Vali Acc: 0.565 Test Loss: 39.249 Test Acc: 0.565
Validation loss decreased (-0.526340 --> -0.564493).  Saving model ...
Epoch: 15 cost time: 54.86239695549011
Epoch: 15, Steps: 32 | Train Loss: 0.526 Vali Loss: 43.959 Vali Acc: 0.511 Test Loss: 43.959 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 54.47048211097717
Epoch: 16, Steps: 32 | Train Loss: 0.175 Vali Loss: 54.222 Vali Acc: 0.542 Test Loss: 54.222 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 54.29477834701538
Epoch: 17, Steps: 32 | Train Loss: 1.106 Vali Loss: 54.926 Vali Acc: 0.534 Test Loss: 54.926 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 53.46242904663086
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 51.129 Vali Acc: 0.527 Test Loss: 51.129 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 53.6664605140686
Epoch: 19, Steps: 32 | Train Loss: 0.334 Vali Loss: 50.031 Vali Acc: 0.443 Test Loss: 50.031 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 55.950074672698975
Epoch: 20, Steps: 32 | Train Loss: 1.366 Vali Loss: 39.639 Vali Acc: 0.534 Test Loss: 39.639 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 54.25580286979675
Epoch: 21, Steps: 32 | Train Loss: 1.369 Vali Loss: 59.462 Vali Acc: 0.473 Test Loss: 59.462 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 55.6014301776886
Epoch: 22, Steps: 32 | Train Loss: 0.731 Vali Loss: 48.426 Vali Acc: 0.542 Test Loss: 48.426 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 56.90964460372925
Epoch: 23, Steps: 32 | Train Loss: 0.872 Vali Loss: 62.380 Vali Acc: 0.557 Test Loss: 62.380 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 55.51032733917236
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 66.023 Vali Acc: 0.534 Test Loss: 66.023 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma7194_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 3313765
model size : 17.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         5396                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma5396_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 36.22967338562012
Epoch: 1, Steps: 32 | Train Loss: 3.430 Vali Loss: 6.377 Vali Acc: 0.443 Test Loss: 6.377 Test Acc: 0.443
Validation loss decreased (inf --> -0.442684).  Saving model ...
Epoch: 2 cost time: 35.6798632144928
Epoch: 2, Steps: 32 | Train Loss: 3.752 Vali Loss: 11.701 Vali Acc: 0.397 Test Loss: 11.701 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 35.09695339202881
Epoch: 3, Steps: 32 | Train Loss: 2.358 Vali Loss: 12.291 Vali Acc: 0.328 Test Loss: 12.291 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 38.36215019226074
Epoch: 4, Steps: 32 | Train Loss: 2.067 Vali Loss: 12.026 Vali Acc: 0.366 Test Loss: 12.026 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 41.44409203529358
Epoch: 5, Steps: 32 | Train Loss: 1.915 Vali Loss: 23.191 Vali Acc: 0.328 Test Loss: 23.191 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 41.71355867385864
Epoch: 6, Steps: 32 | Train Loss: 2.590 Vali Loss: 17.359 Vali Acc: 0.534 Test Loss: 17.359 Test Acc: 0.534
Validation loss decreased (-0.442684 --> -0.534178).  Saving model ...
Epoch: 7 cost time: 45.204761028289795
Epoch: 7, Steps: 32 | Train Loss: 1.381 Vali Loss: 32.672 Vali Acc: 0.550 Test Loss: 32.672 Test Acc: 0.550
Validation loss decreased (-0.534178 --> -0.549292).  Saving model ...
Epoch: 8 cost time: 45.5536847114563
Epoch: 8, Steps: 32 | Train Loss: 3.416 Vali Loss: 25.480 Vali Acc: 0.580 Test Loss: 25.480 Test Acc: 0.580
Validation loss decreased (-0.549292 --> -0.579898).  Saving model ...
Epoch: 9 cost time: 46.25940561294556
Epoch: 9, Steps: 32 | Train Loss: 0.966 Vali Loss: 33.006 Vali Acc: 0.450 Test Loss: 33.006 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 47.364742040634155
Epoch: 10, Steps: 32 | Train Loss: 0.776 Vali Loss: 39.098 Vali Acc: 0.519 Test Loss: 39.098 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 47.496190786361694
Epoch: 11, Steps: 32 | Train Loss: 0.384 Vali Loss: 39.379 Vali Acc: 0.412 Test Loss: 39.379 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 45.92192530632019
Epoch: 12, Steps: 32 | Train Loss: 0.985 Vali Loss: 32.263 Vali Acc: 0.374 Test Loss: 32.263 Test Acc: 0.374
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 47.42013454437256
Epoch: 13, Steps: 32 | Train Loss: 0.482 Vali Loss: 41.345 Vali Acc: 0.489 Test Loss: 41.345 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 46.118908405303955
Epoch: 14, Steps: 32 | Train Loss: 0.867 Vali Loss: 58.690 Vali Acc: 0.389 Test Loss: 58.690 Test Acc: 0.389
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 47.142520904541016
Epoch: 15, Steps: 32 | Train Loss: 1.328 Vali Loss: 36.998 Vali Acc: 0.519 Test Loss: 36.998 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 46.98699617385864
Epoch: 16, Steps: 32 | Train Loss: 0.273 Vali Loss: 62.445 Vali Acc: 0.519 Test Loss: 62.445 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 45.63700294494629
Epoch: 17, Steps: 32 | Train Loss: 1.342 Vali Loss: 49.114 Vali Acc: 0.519 Test Loss: 49.114 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 47.73669409751892
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 41.502 Vali Acc: 0.542 Test Loss: 41.502 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma5396_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 3313765
model size : 17.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         3597                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma3597_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 28.72664499282837
Epoch: 1, Steps: 32 | Train Loss: 3.196 Vali Loss: 5.093 Vali Acc: 0.351 Test Loss: 5.093 Test Acc: 0.351
Validation loss decreased (inf --> -0.351094).  Saving model ...
Epoch: 2 cost time: 27.20592188835144
Epoch: 2, Steps: 32 | Train Loss: 3.518 Vali Loss: 8.203 Vali Acc: 0.458 Test Loss: 8.203 Test Acc: 0.458
Validation loss decreased (-0.351094 --> -0.457933).  Saving model ...
Epoch: 3 cost time: 27.539424896240234
Epoch: 3, Steps: 32 | Train Loss: 1.068 Vali Loss: 9.412 Vali Acc: 0.519 Test Loss: 9.412 Test Acc: 0.519
Validation loss decreased (-0.457933 --> -0.518990).  Saving model ...
Epoch: 4 cost time: 29.43841552734375
Epoch: 4, Steps: 32 | Train Loss: 1.727 Vali Loss: 13.683 Vali Acc: 0.305 Test Loss: 13.683 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 30.079386234283447
Epoch: 5, Steps: 32 | Train Loss: 2.782 Vali Loss: 20.370 Vali Acc: 0.382 Test Loss: 20.370 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 32.31510305404663
Epoch: 6, Steps: 32 | Train Loss: 2.489 Vali Loss: 27.038 Vali Acc: 0.458 Test Loss: 27.038 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 33.015852212905884
Epoch: 7, Steps: 32 | Train Loss: 4.246 Vali Loss: 24.135 Vali Acc: 0.420 Test Loss: 24.135 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 33.90719223022461
Epoch: 8, Steps: 32 | Train Loss: 1.156 Vali Loss: 30.154 Vali Acc: 0.519 Test Loss: 30.154 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 34.45905065536499
Epoch: 9, Steps: 32 | Train Loss: 1.372 Vali Loss: 29.837 Vali Acc: 0.527 Test Loss: 29.837 Test Acc: 0.527
Validation loss decreased (-0.518990 --> -0.526419).  Saving model ...
Epoch: 10 cost time: 34.32819938659668
Epoch: 10, Steps: 32 | Train Loss: 1.940 Vali Loss: 37.320 Vali Acc: 0.489 Test Loss: 37.320 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 36.59500455856323
Epoch: 11, Steps: 32 | Train Loss: 0.392 Vali Loss: 35.476 Vali Acc: 0.435 Test Loss: 35.476 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 33.54775810241699
Epoch: 12, Steps: 32 | Train Loss: 2.738 Vali Loss: 36.600 Vali Acc: 0.267 Test Loss: 36.600 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 35.549816846847534
Epoch: 13, Steps: 32 | Train Loss: 0.314 Vali Loss: 43.179 Vali Acc: 0.473 Test Loss: 43.179 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 36.40988802909851
Epoch: 14, Steps: 32 | Train Loss: 0.721 Vali Loss: 58.737 Vali Acc: 0.511 Test Loss: 58.737 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 35.9681441783905
Epoch: 15, Steps: 32 | Train Loss: 1.128 Vali Loss: 44.170 Vali Acc: 0.473 Test Loss: 44.170 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 36.78599834442139
Epoch: 16, Steps: 32 | Train Loss: 0.247 Vali Loss: 48.647 Vali Acc: 0.351 Test Loss: 48.647 Test Acc: 0.351
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 35.582387924194336
Epoch: 17, Steps: 32 | Train Loss: 1.504 Vali Loss: 48.188 Vali Acc: 0.504 Test Loss: 48.188 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 35.8484845161438
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 34.662 Vali Acc: 0.473 Test Loss: 34.662 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 36.086902141571045
Epoch: 19, Steps: 32 | Train Loss: 0.092 Vali Loss: 46.206 Vali Acc: 0.466 Test Loss: 46.206 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma3597_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 3313765
model size : 17.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         1799                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 25.768806219100952
Epoch: 1, Steps: 32 | Train Loss: 3.149 Vali Loss: 4.421 Vali Acc: 0.160 Test Loss: 4.421 Test Acc: 0.160
Validation loss decreased (inf --> -0.160261).  Saving model ...
Epoch: 2 cost time: 22.747395753860474
Epoch: 2, Steps: 32 | Train Loss: 2.005 Vali Loss: 5.266 Vali Acc: 0.511 Test Loss: 5.266 Test Acc: 0.511
Validation loss decreased (-0.160261 --> -0.511398).  Saving model ...
Epoch: 3 cost time: 22.997299432754517
Epoch: 3, Steps: 32 | Train Loss: 1.749 Vali Loss: 8.921 Vali Acc: 0.359 Test Loss: 8.921 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 24.069148063659668
Epoch: 4, Steps: 32 | Train Loss: 1.235 Vali Loss: 13.442 Vali Acc: 0.511 Test Loss: 13.442 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 25.483681440353394
Epoch: 5, Steps: 32 | Train Loss: 2.501 Vali Loss: 12.266 Vali Acc: 0.435 Test Loss: 12.266 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 25.287431240081787
Epoch: 6, Steps: 32 | Train Loss: 0.560 Vali Loss: 21.785 Vali Acc: 0.504 Test Loss: 21.785 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 24.63848042488098
Epoch: 7, Steps: 32 | Train Loss: 1.833 Vali Loss: 20.445 Vali Acc: 0.435 Test Loss: 20.445 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 25.53825092315674
Epoch: 8, Steps: 32 | Train Loss: 0.721 Vali Loss: 22.107 Vali Acc: 0.527 Test Loss: 22.107 Test Acc: 0.527
Validation loss decreased (-0.511398 --> -0.526496).  Saving model ...
Epoch: 9 cost time: 24.706501722335815
Epoch: 9, Steps: 32 | Train Loss: 3.289 Vali Loss: 57.350 Vali Acc: 0.511 Test Loss: 57.350 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 25.194415807724
Epoch: 10, Steps: 32 | Train Loss: 3.293 Vali Loss: 35.404 Vali Acc: 0.450 Test Loss: 35.404 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 26.85666799545288
Epoch: 11, Steps: 32 | Train Loss: 0.910 Vali Loss: 38.496 Vali Acc: 0.496 Test Loss: 38.496 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 25.86662197113037
Epoch: 12, Steps: 32 | Train Loss: 0.755 Vali Loss: 35.813 Vali Acc: 0.397 Test Loss: 35.813 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 25.67711353302002
Epoch: 13, Steps: 32 | Train Loss: 0.256 Vali Loss: 55.102 Vali Acc: 0.496 Test Loss: 55.102 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 25.15256929397583
Epoch: 14, Steps: 32 | Train Loss: 0.315 Vali Loss: 33.492 Vali Acc: 0.450 Test Loss: 33.492 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 25.13972759246826
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 36.429 Vali Acc: 0.466 Test Loss: 36.429 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 25.418114185333252
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 36.561 Vali Acc: 0.473 Test Loss: 36.561 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 26.148355722427368
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 36.567 Vali Acc: 0.473 Test Loss: 36.567 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 25.196396350860596
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 36.568 Vali Acc: 0.473 Test Loss: 36.568 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 3313765
model size : 17.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 23.945653915405273
Epoch: 1, Steps: 32 | Train Loss: 3.290 Vali Loss: 7.374 Vali Acc: 0.435 Test Loss: 7.374 Test Acc: 0.435
Validation loss decreased (inf --> -0.435041).  Saving model ...
Epoch: 2 cost time: 19.901699781417847
Epoch: 2, Steps: 32 | Train Loss: 2.018 Vali Loss: 6.003 Vali Acc: 0.443 Test Loss: 6.003 Test Acc: 0.443
Validation loss decreased (-0.435041 --> -0.442688).  Saving model ...
Epoch: 3 cost time: 19.19788694381714
Epoch: 3, Steps: 32 | Train Loss: 3.047 Vali Loss: 10.027 Vali Acc: 0.511 Test Loss: 10.027 Test Acc: 0.511
Validation loss decreased (-0.442688 --> -0.511350).  Saving model ...
Epoch: 4 cost time: 20.81172776222229
Epoch: 4, Steps: 32 | Train Loss: 1.480 Vali Loss: 10.878 Vali Acc: 0.489 Test Loss: 10.878 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 21.239524602890015
Epoch: 5, Steps: 32 | Train Loss: 1.228 Vali Loss: 10.773 Vali Acc: 0.481 Test Loss: 10.773 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 22.81859540939331
Epoch: 6, Steps: 32 | Train Loss: 0.814 Vali Loss: 14.804 Vali Acc: 0.450 Test Loss: 14.804 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 20.948928833007812
Epoch: 7, Steps: 32 | Train Loss: 3.819 Vali Loss: 26.969 Vali Acc: 0.359 Test Loss: 26.969 Test Acc: 0.359
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 21.05895757675171
Epoch: 8, Steps: 32 | Train Loss: 2.021 Vali Loss: 20.273 Vali Acc: 0.504 Test Loss: 20.273 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 21.421758890151978
Epoch: 9, Steps: 32 | Train Loss: 0.938 Vali Loss: 25.255 Vali Acc: 0.443 Test Loss: 25.255 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 21.127103567123413
Epoch: 10, Steps: 32 | Train Loss: 0.356 Vali Loss: 22.177 Vali Acc: 0.519 Test Loss: 22.177 Test Acc: 0.519
Validation loss decreased (-0.511350 --> -0.518862).  Saving model ...
Epoch: 11 cost time: 20.675081729888916
Epoch: 11, Steps: 32 | Train Loss: 1.336 Vali Loss: 46.047 Vali Acc: 0.519 Test Loss: 46.047 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 22.036231756210327
Epoch: 12, Steps: 32 | Train Loss: 1.062 Vali Loss: 44.216 Vali Acc: 0.481 Test Loss: 44.216 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 21.117998361587524
Epoch: 13, Steps: 32 | Train Loss: 1.525 Vali Loss: 25.600 Vali Acc: 0.420 Test Loss: 25.600 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 24.416786670684814
Epoch: 14, Steps: 32 | Train Loss: 0.967 Vali Loss: 63.501 Vali Acc: 0.496 Test Loss: 63.501 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 22.812365770339966
Epoch: 15, Steps: 32 | Train Loss: 1.647 Vali Loss: 42.994 Vali Acc: 0.527 Test Loss: 42.994 Test Acc: 0.527
Validation loss decreased (-0.518862 --> -0.526288).  Saving model ...
Epoch: 16 cost time: 21.480337619781494
Epoch: 16, Steps: 32 | Train Loss: 0.463 Vali Loss: 39.506 Vali Acc: 0.466 Test Loss: 39.506 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 21.1315815448761
Epoch: 17, Steps: 32 | Train Loss: 1.151 Vali Loss: 46.023 Vali Acc: 0.458 Test Loss: 46.023 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 21.87638211250305
Epoch: 18, Steps: 32 | Train Loss: 1.695 Vali Loss: 55.249 Vali Acc: 0.527 Test Loss: 55.249 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 22.321025848388672
Epoch: 19, Steps: 32 | Train Loss: 0.483 Vali Loss: 60.068 Vali Acc: 0.481 Test Loss: 60.068 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 24.40723180770874
Epoch: 20, Steps: 32 | Train Loss: 2.073 Vali Loss: 43.811 Vali Acc: 0.450 Test Loss: 43.811 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 23.678542852401733
Epoch: 21, Steps: 32 | Train Loss: 0.372 Vali Loss: 73.852 Vali Acc: 0.481 Test Loss: 73.852 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 23.697414875030518
Epoch: 22, Steps: 32 | Train Loss: 2.894 Vali Loss: 52.914 Vali Acc: 0.359 Test Loss: 52.914 Test Acc: 0.359
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 22.14701533317566
Epoch: 23, Steps: 32 | Train Loss: 2.240 Vali Loss: 51.022 Vali Acc: 0.435 Test Loss: 51.022 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 21.506678342819214
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 53.232 Vali Acc: 0.481 Test Loss: 53.232 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 21.624462842941284
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 65.046 Vali Acc: 0.511 Test Loss: 65.046 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 3313765
model size : 17.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         540                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma540_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 23.846286058425903
Epoch: 1, Steps: 32 | Train Loss: 3.552 Vali Loss: 8.262 Vali Acc: 0.450 Test Loss: 8.262 Test Acc: 0.450
Validation loss decreased (inf --> -0.450299).  Saving model ...
Epoch: 2 cost time: 20.48346495628357
Epoch: 2, Steps: 32 | Train Loss: 3.628 Vali Loss: 12.684 Vali Acc: 0.481 Test Loss: 12.684 Test Acc: 0.481
Validation loss decreased (-0.450299 --> -0.480789).  Saving model ...
Epoch: 3 cost time: 21.14832091331482
Epoch: 3, Steps: 32 | Train Loss: 2.585 Vali Loss: 11.674 Vali Acc: 0.542 Test Loss: 11.674 Test Acc: 0.542
Validation loss decreased (-0.480789 --> -0.541868).  Saving model ...
Epoch: 4 cost time: 20.02056908607483
Epoch: 4, Steps: 32 | Train Loss: 2.085 Vali Loss: 18.205 Vali Acc: 0.473 Test Loss: 18.205 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 20.806999683380127
Epoch: 5, Steps: 32 | Train Loss: 1.359 Vali Loss: 20.720 Vali Acc: 0.534 Test Loss: 20.720 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 20.48492670059204
Epoch: 6, Steps: 32 | Train Loss: 1.299 Vali Loss: 21.277 Vali Acc: 0.473 Test Loss: 21.277 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 21.29698085784912
Epoch: 7, Steps: 32 | Train Loss: 0.432 Vali Loss: 27.357 Vali Acc: 0.504 Test Loss: 27.357 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 19.478188514709473
Epoch: 8, Steps: 32 | Train Loss: 1.205 Vali Loss: 22.982 Vali Acc: 0.336 Test Loss: 22.982 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 22.017138719558716
Epoch: 9, Steps: 32 | Train Loss: 1.675 Vali Loss: 28.691 Vali Acc: 0.443 Test Loss: 28.691 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 21.344217538833618
Epoch: 10, Steps: 32 | Train Loss: 0.861 Vali Loss: 23.715 Vali Acc: 0.504 Test Loss: 23.715 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 22.94596028327942
Epoch: 11, Steps: 32 | Train Loss: 0.629 Vali Loss: 32.333 Vali Acc: 0.466 Test Loss: 32.333 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 21.812009811401367
Epoch: 12, Steps: 32 | Train Loss: 1.469 Vali Loss: 30.259 Vali Acc: 0.412 Test Loss: 30.259 Test Acc: 0.412
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 20.25316309928894
Epoch: 13, Steps: 32 | Train Loss: 0.928 Vali Loss: 30.311 Vali Acc: 0.489 Test Loss: 30.311 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma540_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 3313765
model size : 17.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 23.40876340866089
Epoch: 1, Steps: 32 | Train Loss: 3.910 Vali Loss: 7.181 Vali Acc: 0.443 Test Loss: 7.181 Test Acc: 0.443
Validation loss decreased (inf --> -0.442676).  Saving model ...
Epoch: 2 cost time: 20.532843112945557
Epoch: 2, Steps: 32 | Train Loss: 1.814 Vali Loss: 8.726 Vali Acc: 0.458 Test Loss: 8.726 Test Acc: 0.458
Validation loss decreased (-0.442676 --> -0.457928).  Saving model ...
Epoch: 3 cost time: 20.190548181533813
Epoch: 3, Steps: 32 | Train Loss: 1.791 Vali Loss: 8.920 Vali Acc: 0.427 Test Loss: 8.920 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 19.961417198181152
Epoch: 4, Steps: 32 | Train Loss: 1.652 Vali Loss: 16.069 Vali Acc: 0.466 Test Loss: 16.069 Test Acc: 0.466
Validation loss decreased (-0.457928 --> -0.465488).  Saving model ...
Epoch: 5 cost time: 21.536344051361084
Epoch: 5, Steps: 32 | Train Loss: 0.721 Vali Loss: 15.189 Vali Acc: 0.435 Test Loss: 15.189 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 22.223540544509888
Epoch: 6, Steps: 32 | Train Loss: 1.447 Vali Loss: 16.820 Vali Acc: 0.374 Test Loss: 16.820 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 23.40200972557068
Epoch: 7, Steps: 32 | Train Loss: 0.600 Vali Loss: 29.635 Vali Acc: 0.511 Test Loss: 29.635 Test Acc: 0.511
Validation loss decreased (-0.465488 --> -0.511154).  Saving model ...
Epoch: 8 cost time: 21.03555178642273
Epoch: 8, Steps: 32 | Train Loss: 1.154 Vali Loss: 26.475 Vali Acc: 0.321 Test Loss: 26.475 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 21.18576955795288
Epoch: 9, Steps: 32 | Train Loss: 0.741 Vali Loss: 45.767 Vali Acc: 0.489 Test Loss: 45.767 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 19.485880374908447
Epoch: 10, Steps: 32 | Train Loss: 1.055 Vali Loss: 19.971 Vali Acc: 0.435 Test Loss: 19.971 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 20.519834280014038
Epoch: 11, Steps: 32 | Train Loss: 0.470 Vali Loss: 31.080 Vali Acc: 0.496 Test Loss: 31.080 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 19.686017274856567
Epoch: 12, Steps: 32 | Train Loss: 0.128 Vali Loss: 29.490 Vali Acc: 0.420 Test Loss: 29.490 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 22.237234830856323
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 34.560 Vali Acc: 0.481 Test Loss: 34.560 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 22.183441638946533
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 32.851 Vali Acc: 0.473 Test Loss: 32.851 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 20.859825134277344
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 32.753 Vali Acc: 0.473 Test Loss: 32.753 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 20.099380493164062
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 32.749 Vali Acc: 0.473 Test Loss: 32.749 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 21.42905831336975
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 32.748 Vali Acc: 0.473 Test Loss: 32.748 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 3313765
model size : 17.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 23.164881706237793
Epoch: 1, Steps: 32 | Train Loss: 3.436 Vali Loss: 8.367 Vali Acc: 0.420 Test Loss: 8.367 Test Acc: 0.420
Validation loss decreased (inf --> -0.419764).  Saving model ...
Epoch: 2 cost time: 19.952689170837402
Epoch: 2, Steps: 32 | Train Loss: 2.002 Vali Loss: 5.184 Vali Acc: 0.412 Test Loss: 5.184 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 20.381847381591797
Epoch: 3, Steps: 32 | Train Loss: 1.190 Vali Loss: 10.717 Vali Acc: 0.435 Test Loss: 10.717 Test Acc: 0.435
Validation loss decreased (-0.419764 --> -0.435007).  Saving model ...
Epoch: 4 cost time: 21.106800317764282
Epoch: 4, Steps: 32 | Train Loss: 3.424 Vali Loss: 18.620 Vali Acc: 0.489 Test Loss: 18.620 Test Acc: 0.489
Validation loss decreased (-0.435007 --> -0.488363).  Saving model ...
Epoch: 5 cost time: 20.92664623260498
Epoch: 5, Steps: 32 | Train Loss: 3.613 Vali Loss: 20.777 Vali Acc: 0.489 Test Loss: 20.777 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 19.20767831802368
Epoch: 6, Steps: 32 | Train Loss: 2.854 Vali Loss: 16.380 Vali Acc: 0.405 Test Loss: 16.380 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 19.959262371063232
Epoch: 7, Steps: 32 | Train Loss: 1.156 Vali Loss: 18.800 Vali Acc: 0.511 Test Loss: 18.800 Test Acc: 0.511
Validation loss decreased (-0.488363 --> -0.511262).  Saving model ...
Epoch: 8 cost time: 18.664621591567993
Epoch: 8, Steps: 32 | Train Loss: 0.461 Vali Loss: 9.913 Vali Acc: 0.489 Test Loss: 9.913 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 20.35942029953003
Epoch: 9, Steps: 32 | Train Loss: 0.151 Vali Loss: 32.825 Vali Acc: 0.496 Test Loss: 32.825 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 21.19765853881836
Epoch: 10, Steps: 32 | Train Loss: 2.430 Vali Loss: 24.803 Vali Acc: 0.351 Test Loss: 24.803 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 21.43935799598694
Epoch: 11, Steps: 32 | Train Loss: 0.664 Vali Loss: 17.783 Vali Acc: 0.511 Test Loss: 17.783 Test Acc: 0.511
Validation loss decreased (-0.511262 --> -0.511273).  Saving model ...
Epoch: 12 cost time: 20.43737816810608
Epoch: 12, Steps: 32 | Train Loss: 1.151 Vali Loss: 36.765 Vali Acc: 0.496 Test Loss: 36.765 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 19.45350956916809
Epoch: 13, Steps: 32 | Train Loss: 0.226 Vali Loss: 20.084 Vali Acc: 0.427 Test Loss: 20.084 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 19.842517137527466
Epoch: 14, Steps: 32 | Train Loss: 0.221 Vali Loss: 35.678 Vali Acc: 0.489 Test Loss: 35.678 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 20.77098321914673
Epoch: 15, Steps: 32 | Train Loss: 1.147 Vali Loss: 31.162 Vali Acc: 0.542 Test Loss: 31.162 Test Acc: 0.542
Validation loss decreased (-0.511273 --> -0.541673).  Saving model ...
Epoch: 16 cost time: 22.194849967956543
Epoch: 16, Steps: 32 | Train Loss: 1.090 Vali Loss: 52.136 Vali Acc: 0.527 Test Loss: 52.136 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 22.73971724510193
Epoch: 17, Steps: 32 | Train Loss: 1.887 Vali Loss: 56.355 Vali Acc: 0.511 Test Loss: 56.355 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 22.372820138931274
Epoch: 18, Steps: 32 | Train Loss: 0.105 Vali Loss: 52.858 Vali Acc: 0.527 Test Loss: 52.858 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 21.400190591812134
Epoch: 19, Steps: 32 | Train Loss: 0.156 Vali Loss: 40.122 Vali Acc: 0.542 Test Loss: 40.122 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 21.04058599472046
Epoch: 20, Steps: 32 | Train Loss: 0.218 Vali Loss: 37.954 Vali Acc: 0.443 Test Loss: 37.954 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 18.94805645942688
Epoch: 21, Steps: 32 | Train Loss: 2.091 Vali Loss: 32.600 Vali Acc: 0.481 Test Loss: 32.600 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 19.692298650741577
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 47.359 Vali Acc: 0.466 Test Loss: 47.359 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 19.2026207447052
Epoch: 23, Steps: 32 | Train Loss: 0.710 Vali Loss: 35.913 Vali Acc: 0.542 Test Loss: 35.913 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 21.449764251708984
Epoch: 24, Steps: 32 | Train Loss: 0.039 Vali Loss: 41.086 Vali Acc: 0.481 Test Loss: 41.086 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 21.87006378173828
Epoch: 25, Steps: 32 | Train Loss: 0.146 Vali Loss: 46.091 Vali Acc: 0.473 Test Loss: 46.091 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 3313765
model size : 17.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 21.076225519180298
Epoch: 1, Steps: 32 | Train Loss: 3.035 Vali Loss: 4.449 Vali Acc: 0.458 Test Loss: 4.449 Test Acc: 0.458
Validation loss decreased (inf --> -0.457971).  Saving model ...
Epoch: 2 cost time: 19.48288321495056
Epoch: 2, Steps: 32 | Train Loss: 2.248 Vali Loss: 6.167 Vali Acc: 0.351 Test Loss: 6.167 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 19.411045789718628
Epoch: 3, Steps: 32 | Train Loss: 1.569 Vali Loss: 7.255 Vali Acc: 0.389 Test Loss: 7.255 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 19.738027572631836
Epoch: 4, Steps: 32 | Train Loss: 1.999 Vali Loss: 7.052 Vali Acc: 0.550 Test Loss: 7.052 Test Acc: 0.550
Validation loss decreased (-0.457971 --> -0.549548).  Saving model ...
Epoch: 5 cost time: 18.67530632019043
Epoch: 5, Steps: 32 | Train Loss: 1.475 Vali Loss: 12.705 Vali Acc: 0.527 Test Loss: 12.705 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 18.519684553146362
Epoch: 6, Steps: 32 | Train Loss: 3.032 Vali Loss: 25.645 Vali Acc: 0.305 Test Loss: 25.645 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 18.919605493545532
Epoch: 7, Steps: 32 | Train Loss: 1.500 Vali Loss: 22.135 Vali Acc: 0.527 Test Loss: 22.135 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 17.896798849105835
Epoch: 8, Steps: 32 | Train Loss: 1.679 Vali Loss: 23.656 Vali Acc: 0.519 Test Loss: 23.656 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 18.598734140396118
Epoch: 9, Steps: 32 | Train Loss: 1.796 Vali Loss: 12.156 Vali Acc: 0.481 Test Loss: 12.156 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 19.205423593521118
Epoch: 10, Steps: 32 | Train Loss: 1.147 Vali Loss: 15.613 Vali Acc: 0.550 Test Loss: 15.613 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 18.910396575927734
Epoch: 11, Steps: 32 | Train Loss: 1.333 Vali Loss: 23.526 Vali Acc: 0.511 Test Loss: 23.526 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 18.776041507720947
Epoch: 12, Steps: 32 | Train Loss: 2.083 Vali Loss: 38.745 Vali Acc: 0.481 Test Loss: 38.745 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 17.489391088485718
Epoch: 13, Steps: 32 | Train Loss: 0.976 Vali Loss: 21.339 Vali Acc: 0.481 Test Loss: 21.339 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 18.092160940170288
Epoch: 14, Steps: 32 | Train Loss: 0.201 Vali Loss: 32.456 Vali Acc: 0.405 Test Loss: 32.456 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df2048_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 3313765
model size : 17.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         8992                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma8992_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 50.56754755973816
Epoch: 1, Steps: 32 | Train Loss: 3.882 Vali Loss: 6.051 Vali Acc: 0.275 Test Loss: 6.051 Test Acc: 0.275
Validation loss decreased (inf --> -0.274749).  Saving model ...
Epoch: 2 cost time: 50.19636297225952
Epoch: 2, Steps: 32 | Train Loss: 3.095 Vali Loss: 6.346 Vali Acc: 0.267 Test Loss: 6.346 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 50.489078998565674
Epoch: 3, Steps: 32 | Train Loss: 3.655 Vali Loss: 12.290 Vali Acc: 0.489 Test Loss: 12.290 Test Acc: 0.489
Validation loss decreased (-0.274749 --> -0.488427).  Saving model ...
Epoch: 4 cost time: 54.653430461883545
Epoch: 4, Steps: 32 | Train Loss: 1.978 Vali Loss: 16.843 Vali Acc: 0.534 Test Loss: 16.843 Test Acc: 0.534
Validation loss decreased (-0.488427 --> -0.534183).  Saving model ...
Epoch: 5 cost time: 56.79103398323059
Epoch: 5, Steps: 32 | Train Loss: 1.969 Vali Loss: 23.990 Vali Acc: 0.504 Test Loss: 23.990 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 63.36849522590637
Epoch: 6, Steps: 32 | Train Loss: 1.933 Vali Loss: 21.173 Vali Acc: 0.542 Test Loss: 21.173 Test Acc: 0.542
Validation loss decreased (-0.534183 --> -0.541773).  Saving model ...
Epoch: 7 cost time: 66.14515256881714
Epoch: 7, Steps: 32 | Train Loss: 1.580 Vali Loss: 23.232 Vali Acc: 0.542 Test Loss: 23.232 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 68.27067041397095
Epoch: 8, Steps: 32 | Train Loss: 1.497 Vali Loss: 28.898 Vali Acc: 0.420 Test Loss: 28.898 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 69.35492324829102
Epoch: 9, Steps: 32 | Train Loss: 1.928 Vali Loss: 37.991 Vali Acc: 0.504 Test Loss: 37.991 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 65.67821764945984
Epoch: 10, Steps: 32 | Train Loss: 4.157 Vali Loss: 61.059 Vali Acc: 0.496 Test Loss: 61.059 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 68.9715313911438
Epoch: 11, Steps: 32 | Train Loss: 0.780 Vali Loss: 29.810 Vali Acc: 0.550 Test Loss: 29.810 Test Acc: 0.550
Validation loss decreased (-0.541773 --> -0.549320).  Saving model ...
Epoch: 12 cost time: 68.59277296066284
Epoch: 12, Steps: 32 | Train Loss: 1.180 Vali Loss: 39.694 Vali Acc: 0.527 Test Loss: 39.694 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 69.87589025497437
Epoch: 13, Steps: 32 | Train Loss: 0.538 Vali Loss: 46.533 Vali Acc: 0.336 Test Loss: 46.533 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 66.4921658039093
Epoch: 14, Steps: 32 | Train Loss: 1.669 Vali Loss: 66.515 Vali Acc: 0.504 Test Loss: 66.515 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 66.59277629852295
Epoch: 15, Steps: 32 | Train Loss: 0.753 Vali Loss: 66.335 Vali Acc: 0.542 Test Loss: 66.335 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 68.55061888694763
Epoch: 16, Steps: 32 | Train Loss: 1.021 Vali Loss: 74.603 Vali Acc: 0.519 Test Loss: 74.603 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 66.62458109855652
Epoch: 17, Steps: 32 | Train Loss: 0.793 Vali Loss: 89.242 Vali Acc: 0.511 Test Loss: 89.242 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 67.20916700363159
Epoch: 18, Steps: 32 | Train Loss: 0.712 Vali Loss: 55.148 Vali Acc: 0.282 Test Loss: 55.148 Test Acc: 0.282
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 68.01493835449219
Epoch: 19, Steps: 32 | Train Loss: 0.233 Vali Loss: 47.748 Vali Acc: 0.405 Test Loss: 47.748 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 66.06451535224915
Epoch: 20, Steps: 32 | Train Loss: 0.432 Vali Loss: 51.316 Vali Acc: 0.351 Test Loss: 51.316 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 67.18500351905823
Epoch: 21, Steps: 32 | Train Loss: 1.022 Vali Loss: 64.799 Vali Acc: 0.290 Test Loss: 64.799 Test Acc: 0.290
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma8992_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 3117157
model size : 16.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         7194                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma7194_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 42.7739417552948
Epoch: 1, Steps: 32 | Train Loss: 4.226 Vali Loss: 6.384 Vali Acc: 0.267 Test Loss: 6.384 Test Acc: 0.267
Validation loss decreased (inf --> -0.267112).  Saving model ...
Epoch: 2 cost time: 41.7579779624939
Epoch: 2, Steps: 32 | Train Loss: 4.342 Vali Loss: 7.366 Vali Acc: 0.260 Test Loss: 7.366 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 42.73968434333801
Epoch: 3, Steps: 32 | Train Loss: 2.356 Vali Loss: 9.491 Vali Acc: 0.305 Test Loss: 9.491 Test Acc: 0.305
Validation loss decreased (-0.267112 --> -0.305249).  Saving model ...
Epoch: 4 cost time: 45.16410183906555
Epoch: 4, Steps: 32 | Train Loss: 0.820 Vali Loss: 16.422 Vali Acc: 0.496 Test Loss: 16.422 Test Acc: 0.496
Validation loss decreased (-0.305249 --> -0.496019).  Saving model ...
Epoch: 5 cost time: 47.69103693962097
Epoch: 5, Steps: 32 | Train Loss: 2.824 Vali Loss: 15.281 Vali Acc: 0.374 Test Loss: 15.281 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 52.636778354644775
Epoch: 6, Steps: 32 | Train Loss: 4.237 Vali Loss: 31.503 Vali Acc: 0.496 Test Loss: 31.503 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 54.11937737464905
Epoch: 7, Steps: 32 | Train Loss: 3.500 Vali Loss: 22.644 Vali Acc: 0.397 Test Loss: 22.644 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 55.180331230163574
Epoch: 8, Steps: 32 | Train Loss: 2.304 Vali Loss: 32.659 Vali Acc: 0.496 Test Loss: 32.659 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 59.8763427734375
Epoch: 9, Steps: 32 | Train Loss: 0.865 Vali Loss: 27.586 Vali Acc: 0.519 Test Loss: 27.586 Test Acc: 0.519
Validation loss decreased (-0.496019 --> -0.518808).  Saving model ...
Epoch: 10 cost time: 54.205204248428345
Epoch: 10, Steps: 32 | Train Loss: 1.772 Vali Loss: 26.442 Vali Acc: 0.405 Test Loss: 26.442 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 57.35960412025452
Epoch: 11, Steps: 32 | Train Loss: 2.737 Vali Loss: 33.076 Vali Acc: 0.389 Test Loss: 33.076 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 55.12912106513977
Epoch: 12, Steps: 32 | Train Loss: 1.940 Vali Loss: 36.783 Vali Acc: 0.359 Test Loss: 36.783 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 56.041741371154785
Epoch: 13, Steps: 32 | Train Loss: 1.148 Vali Loss: 39.470 Vali Acc: 0.427 Test Loss: 39.470 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 56.41242980957031
Epoch: 14, Steps: 32 | Train Loss: 2.736 Vali Loss: 39.767 Vali Acc: 0.374 Test Loss: 39.767 Test Acc: 0.374
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 59.615620374679565
Epoch: 15, Steps: 32 | Train Loss: 0.833 Vali Loss: 30.661 Vali Acc: 0.534 Test Loss: 30.661 Test Acc: 0.534
Validation loss decreased (-0.518808 --> -0.534045).  Saving model ...
Epoch: 16 cost time: 54.520182609558105
Epoch: 16, Steps: 32 | Train Loss: 1.047 Vali Loss: 45.501 Vali Acc: 0.534 Test Loss: 45.501 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 56.55158233642578
Epoch: 17, Steps: 32 | Train Loss: 0.954 Vali Loss: 34.765 Vali Acc: 0.527 Test Loss: 34.765 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 57.191834449768066
Epoch: 18, Steps: 32 | Train Loss: 1.573 Vali Loss: 55.183 Vali Acc: 0.557 Test Loss: 55.183 Test Acc: 0.557
Validation loss decreased (-0.534045 --> -0.556700).  Saving model ...
Epoch: 19 cost time: 56.578251123428345
Epoch: 19, Steps: 32 | Train Loss: 0.746 Vali Loss: 39.386 Vali Acc: 0.542 Test Loss: 39.386 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 57.04870247840881
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.827 Vali Acc: 0.496 Test Loss: 37.827 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 56.68424344062805
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.815 Vali Acc: 0.496 Test Loss: 37.815 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 55.53424596786499
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.833 Vali Acc: 0.496 Test Loss: 37.833 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 55.638006925582886
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.834 Vali Acc: 0.496 Test Loss: 37.834 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 56.6186089515686
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.828 Vali Acc: 0.496 Test Loss: 37.828 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 56.15992760658264
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.961 Vali Acc: 0.496 Test Loss: 37.961 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 56.46150851249695
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 38.254 Vali Acc: 0.504 Test Loss: 38.254 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 56.3068368434906
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.209 Vali Acc: 0.511 Test Loss: 37.209 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 55.94107913970947
Epoch: 28, Steps: 32 | Train Loss: 0.000 Vali Loss: 36.919 Vali Acc: 0.511 Test Loss: 36.919 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma7194_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 3117157
model size : 16.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         5396                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma5396_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 37.57463479042053
Epoch: 1, Steps: 32 | Train Loss: 3.762 Vali Loss: 4.896 Vali Acc: 0.107 Test Loss: 4.896 Test Acc: 0.107
Validation loss decreased (inf --> -0.106821).  Saving model ...
Epoch: 2 cost time: 35.153127908706665
Epoch: 2, Steps: 32 | Train Loss: 2.645 Vali Loss: 6.253 Vali Acc: 0.260 Test Loss: 6.253 Test Acc: 0.260
Validation loss decreased (-0.106821 --> -0.259479).  Saving model ...
Epoch: 3 cost time: 36.61233329772949
Epoch: 3, Steps: 32 | Train Loss: 2.096 Vali Loss: 16.242 Vali Acc: 0.160 Test Loss: 16.242 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 37.51196765899658
Epoch: 4, Steps: 32 | Train Loss: 4.861 Vali Loss: 24.580 Vali Acc: 0.221 Test Loss: 24.580 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 40.94226908683777
Epoch: 5, Steps: 32 | Train Loss: 1.236 Vali Loss: 14.683 Vali Acc: 0.405 Test Loss: 14.683 Test Acc: 0.405
Validation loss decreased (-0.259479 --> -0.404433).  Saving model ...
Epoch: 6 cost time: 46.283952713012695
Epoch: 6, Steps: 32 | Train Loss: 0.565 Vali Loss: 22.539 Vali Acc: 0.351 Test Loss: 22.539 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 45.64164900779724
Epoch: 7, Steps: 32 | Train Loss: 1.354 Vali Loss: 29.704 Vali Acc: 0.496 Test Loss: 29.704 Test Acc: 0.496
Validation loss decreased (-0.404433 --> -0.495886).  Saving model ...
Epoch: 8 cost time: 46.472919940948486
Epoch: 8, Steps: 32 | Train Loss: 0.289 Vali Loss: 26.092 Vali Acc: 0.336 Test Loss: 26.092 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 46.68875312805176
Epoch: 9, Steps: 32 | Train Loss: 2.078 Vali Loss: 32.058 Vali Acc: 0.435 Test Loss: 32.058 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 47.39322900772095
Epoch: 10, Steps: 32 | Train Loss: 1.234 Vali Loss: 38.852 Vali Acc: 0.443 Test Loss: 38.852 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 47.674214363098145
Epoch: 11, Steps: 32 | Train Loss: 0.805 Vali Loss: 28.278 Vali Acc: 0.458 Test Loss: 28.278 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 45.18317365646362
Epoch: 12, Steps: 32 | Train Loss: 2.211 Vali Loss: 44.652 Vali Acc: 0.420 Test Loss: 44.652 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 45.492223501205444
Epoch: 13, Steps: 32 | Train Loss: 2.611 Vali Loss: 58.600 Vali Acc: 0.481 Test Loss: 58.600 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 47.82828736305237
Epoch: 14, Steps: 32 | Train Loss: 0.415 Vali Loss: 37.677 Vali Acc: 0.359 Test Loss: 37.677 Test Acc: 0.359
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 46.45219922065735
Epoch: 15, Steps: 32 | Train Loss: 0.866 Vali Loss: 54.240 Vali Acc: 0.511 Test Loss: 54.240 Test Acc: 0.511
Validation loss decreased (-0.495886 --> -0.510908).  Saving model ...
Epoch: 16 cost time: 47.30835700035095
Epoch: 16, Steps: 32 | Train Loss: 0.025 Vali Loss: 45.333 Vali Acc: 0.511 Test Loss: 45.333 Test Acc: 0.511
Validation loss decreased (-0.510908 --> -0.510997).  Saving model ...
Epoch: 17 cost time: 47.879082679748535
Epoch: 17, Steps: 32 | Train Loss: 0.471 Vali Loss: 34.541 Vali Acc: 0.420 Test Loss: 34.541 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 47.078081369400024
Epoch: 18, Steps: 32 | Train Loss: 0.138 Vali Loss: 35.027 Vali Acc: 0.359 Test Loss: 35.027 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 45.94181561470032
Epoch: 19, Steps: 32 | Train Loss: 0.939 Vali Loss: 61.897 Vali Acc: 0.527 Test Loss: 61.897 Test Acc: 0.527
Validation loss decreased (-0.510997 --> -0.526099).  Saving model ...
Epoch: 20 cost time: 45.52477264404297
Epoch: 20, Steps: 32 | Train Loss: 1.768 Vali Loss: 78.178 Vali Acc: 0.511 Test Loss: 78.178 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 46.82293915748596
Epoch: 21, Steps: 32 | Train Loss: 1.628 Vali Loss: 52.224 Vali Acc: 0.473 Test Loss: 52.224 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 47.27248215675354
Epoch: 22, Steps: 32 | Train Loss: 0.082 Vali Loss: 50.075 Vali Acc: 0.466 Test Loss: 50.075 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 47.31820559501648
Epoch: 23, Steps: 32 | Train Loss: 2.498 Vali Loss: 42.138 Vali Acc: 0.466 Test Loss: 42.138 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 45.931625843048096
Epoch: 24, Steps: 32 | Train Loss: 2.093 Vali Loss: 64.149 Vali Acc: 0.527 Test Loss: 64.149 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 47.187467098236084
Epoch: 25, Steps: 32 | Train Loss: 0.893 Vali Loss: 96.201 Vali Acc: 0.344 Test Loss: 96.201 Test Acc: 0.344
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 46.61550235748291
Epoch: 26, Steps: 32 | Train Loss: 3.460 Vali Loss: 65.566 Vali Acc: 0.450 Test Loss: 65.566 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 46.232614517211914
Epoch: 27, Steps: 32 | Train Loss: 0.372 Vali Loss: 61.473 Vali Acc: 0.496 Test Loss: 61.473 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 46.37109446525574
Epoch: 28, Steps: 32 | Train Loss: 0.010 Vali Loss: 56.395 Vali Acc: 0.511 Test Loss: 56.395 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 46.043903827667236
Epoch: 29, Steps: 32 | Train Loss: 0.342 Vali Loss: 81.544 Vali Acc: 0.557 Test Loss: 81.544 Test Acc: 0.557
Validation loss decreased (-0.526099 --> -0.556436).  Saving model ...
Epoch: 30 cost time: 46.1948766708374
Epoch: 30, Steps: 32 | Train Loss: 0.314 Vali Loss: 80.038 Vali Acc: 0.496 Test Loss: 80.038 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 48.00613975524902
Epoch: 31, Steps: 32 | Train Loss: 0.340 Vali Loss: 83.617 Vali Acc: 0.557 Test Loss: 83.617 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 47.02996015548706
Epoch: 32, Steps: 32 | Train Loss: 0.000 Vali Loss: 75.021 Vali Acc: 0.557 Test Loss: 75.021 Test Acc: 0.557
Validation loss decreased (-0.556436 --> -0.556502).  Saving model ...
Epoch: 33 cost time: 46.721959352493286
Epoch: 33, Steps: 32 | Train Loss: 0.000 Vali Loss: 82.396 Vali Acc: 0.565 Test Loss: 82.396 Test Acc: 0.565
Validation loss decreased (-0.556502 --> -0.564062).  Saving model ...
Epoch: 34 cost time: 47.50004458427429
Epoch: 34, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.391 Vali Acc: 0.450 Test Loss: 67.391 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 47.2961859703064
Epoch: 35, Steps: 32 | Train Loss: 0.217 Vali Loss: 68.876 Vali Acc: 0.542 Test Loss: 68.876 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 47.37527894973755
Epoch: 36, Steps: 32 | Train Loss: 0.002 Vali Loss: 95.946 Vali Acc: 0.565 Test Loss: 95.946 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 46.60617971420288
Epoch: 37, Steps: 32 | Train Loss: 0.524 Vali Loss: 98.300 Vali Acc: 0.565 Test Loss: 98.300 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 47.04873466491699
Epoch: 38, Steps: 32 | Train Loss: 0.596 Vali Loss: 65.380 Vali Acc: 0.420 Test Loss: 65.380 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 48.112091302871704
Epoch: 39, Steps: 32 | Train Loss: 0.889 Vali Loss: 122.853 Vali Acc: 0.511 Test Loss: 122.853 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 46.98754668235779
Epoch: 40, Steps: 32 | Train Loss: 0.474 Vali Loss: 84.825 Vali Acc: 0.573 Test Loss: 84.825 Test Acc: 0.573
Validation loss decreased (-0.564062 --> -0.571671).  Saving model ...
Epoch: 41 cost time: 46.49946451187134
Epoch: 41, Steps: 32 | Train Loss: 0.399 Vali Loss: 65.525 Vali Acc: 0.557 Test Loss: 65.525 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 46.59883427619934
Epoch: 42, Steps: 32 | Train Loss: 0.274 Vali Loss: 80.176 Vali Acc: 0.481 Test Loss: 80.176 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 45.86565113067627
Epoch: 43, Steps: 32 | Train Loss: 4.237 Vali Loss: 82.971 Vali Acc: 0.580 Test Loss: 82.971 Test Acc: 0.580
Validation loss decreased (-0.571671 --> -0.579323).  Saving model ...
Epoch: 44 cost time: 46.28074884414673
Epoch: 44, Steps: 32 | Train Loss: 0.454 Vali Loss: 93.223 Vali Acc: 0.489 Test Loss: 93.223 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 46.52142000198364
Epoch: 45, Steps: 32 | Train Loss: 0.005 Vali Loss: 138.011 Vali Acc: 0.557 Test Loss: 138.011 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 46.2427031993866
Epoch: 46, Steps: 32 | Train Loss: 0.492 Vali Loss: 158.386 Vali Acc: 0.519 Test Loss: 158.386 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 46.033607482910156
Epoch: 47, Steps: 32 | Train Loss: 2.797 Vali Loss: 74.003 Vali Acc: 0.519 Test Loss: 74.003 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 46.68681716918945
Epoch: 48, Steps: 32 | Train Loss: 0.233 Vali Loss: 88.166 Vali Acc: 0.450 Test Loss: 88.166 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 47.11631369590759
Epoch: 49, Steps: 32 | Train Loss: 0.180 Vali Loss: 125.059 Vali Acc: 0.481 Test Loss: 125.059 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 46.03504514694214
Epoch: 50, Steps: 32 | Train Loss: 0.148 Vali Loss: 160.513 Vali Acc: 0.527 Test Loss: 160.513 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 46.411275148391724
Epoch: 51, Steps: 32 | Train Loss: 0.011 Vali Loss: 118.944 Vali Acc: 0.519 Test Loss: 118.944 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 47.24629044532776
Epoch: 52, Steps: 32 | Train Loss: 0.089 Vali Loss: 99.783 Vali Acc: 0.473 Test Loss: 99.783 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 46.73880982398987
Epoch: 53, Steps: 32 | Train Loss: 1.349 Vali Loss: 103.207 Vali Acc: 0.466 Test Loss: 103.207 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma5396_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 3117157
model size : 16.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         3597                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma3597_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 33.78744459152222
Epoch: 1, Steps: 32 | Train Loss: 3.395 Vali Loss: 3.847 Vali Acc: 0.290 Test Loss: 3.847 Test Acc: 0.290
Validation loss decreased (inf --> -0.290038).  Saving model ...
Epoch: 2 cost time: 29.156781435012817
Epoch: 2, Steps: 32 | Train Loss: 3.208 Vali Loss: 7.891 Vali Acc: 0.328 Test Loss: 7.891 Test Acc: 0.328
Validation loss decreased (-0.290038 --> -0.328165).  Saving model ...
Epoch: 3 cost time: 29.900072813034058
Epoch: 3, Steps: 32 | Train Loss: 1.442 Vali Loss: 8.591 Vali Acc: 0.458 Test Loss: 8.591 Test Acc: 0.458
Validation loss decreased (-0.328165 --> -0.457929).  Saving model ...
Epoch: 4 cost time: 31.537291765213013
Epoch: 4, Steps: 32 | Train Loss: 1.515 Vali Loss: 13.328 Vali Acc: 0.504 Test Loss: 13.328 Test Acc: 0.504
Validation loss decreased (-0.457929 --> -0.503684).  Saving model ...
Epoch: 5 cost time: 30.795520544052124
Epoch: 5, Steps: 32 | Train Loss: 1.330 Vali Loss: 16.577 Vali Acc: 0.519 Test Loss: 16.577 Test Acc: 0.519
Validation loss decreased (-0.503684 --> -0.518918).  Saving model ...
Epoch: 6 cost time: 30.213741302490234
Epoch: 6, Steps: 32 | Train Loss: 1.785 Vali Loss: 19.116 Vali Acc: 0.489 Test Loss: 19.116 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 33.503580808639526
Epoch: 7, Steps: 32 | Train Loss: 3.025 Vali Loss: 13.780 Vali Acc: 0.511 Test Loss: 13.780 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 36.645758390426636
Epoch: 8, Steps: 32 | Train Loss: 1.052 Vali Loss: 18.443 Vali Acc: 0.557 Test Loss: 18.443 Test Acc: 0.557
Validation loss decreased (-0.518918 --> -0.557067).  Saving model ...
Epoch: 9 cost time: 37.157007694244385
Epoch: 9, Steps: 32 | Train Loss: 0.000 Vali Loss: 16.610 Vali Acc: 0.534 Test Loss: 16.610 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 36.95825815200806
Epoch: 10, Steps: 32 | Train Loss: 0.000 Vali Loss: 16.682 Vali Acc: 0.527 Test Loss: 16.682 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 35.866697549819946
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 16.685 Vali Acc: 0.519 Test Loss: 16.685 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 36.11391639709473
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 16.685 Vali Acc: 0.519 Test Loss: 16.685 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 38.01933002471924
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 16.685 Vali Acc: 0.519 Test Loss: 16.685 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 36.137720823287964
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 16.685 Vali Acc: 0.519 Test Loss: 16.685 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 36.93174386024475
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 16.685 Vali Acc: 0.519 Test Loss: 16.685 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 37.59792137145996
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 16.685 Vali Acc: 0.519 Test Loss: 16.685 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 37.237515687942505
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 16.685 Vali Acc: 0.519 Test Loss: 16.685 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 36.40732216835022
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 16.685 Vali Acc: 0.519 Test Loss: 16.685 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma3597_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 3117157
model size : 16.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         1799                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 28.29868793487549
Epoch: 1, Steps: 32 | Train Loss: 3.450 Vali Loss: 5.047 Vali Acc: 0.389 Test Loss: 5.047 Test Acc: 0.389
Validation loss decreased (inf --> -0.389263).  Saving model ...
Epoch: 2 cost time: 24.967723846435547
Epoch: 2, Steps: 32 | Train Loss: 3.124 Vali Loss: 5.997 Vali Acc: 0.351 Test Loss: 5.997 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 25.02911376953125
Epoch: 3, Steps: 32 | Train Loss: 2.736 Vali Loss: 6.498 Vali Acc: 0.412 Test Loss: 6.498 Test Acc: 0.412
Validation loss decreased (-0.389263 --> -0.412149).  Saving model ...
Epoch: 4 cost time: 24.90764880180359
Epoch: 4, Steps: 32 | Train Loss: 0.453 Vali Loss: 22.275 Vali Acc: 0.473 Test Loss: 22.275 Test Acc: 0.473
Validation loss decreased (-0.412149 --> -0.473060).  Saving model ...
Epoch: 5 cost time: 24.043580293655396
Epoch: 5, Steps: 32 | Train Loss: 2.341 Vali Loss: 20.774 Vali Acc: 0.534 Test Loss: 20.774 Test Acc: 0.534
Validation loss decreased (-0.473060 --> -0.534143).  Saving model ...
Epoch: 6 cost time: 25.704991340637207
Epoch: 6, Steps: 32 | Train Loss: 2.281 Vali Loss: 27.428 Vali Acc: 0.504 Test Loss: 27.428 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 27.841470956802368
Epoch: 7, Steps: 32 | Train Loss: 1.239 Vali Loss: 28.131 Vali Acc: 0.504 Test Loss: 28.131 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 26.864309549331665
Epoch: 8, Steps: 32 | Train Loss: 0.414 Vali Loss: 25.716 Vali Acc: 0.496 Test Loss: 25.716 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 27.873109340667725
Epoch: 9, Steps: 32 | Train Loss: 3.785 Vali Loss: 44.481 Vali Acc: 0.489 Test Loss: 44.481 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 25.511043310165405
Epoch: 10, Steps: 32 | Train Loss: 0.973 Vali Loss: 39.386 Vali Acc: 0.496 Test Loss: 39.386 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 27.113905429840088
Epoch: 11, Steps: 32 | Train Loss: 1.362 Vali Loss: 29.830 Vali Acc: 0.496 Test Loss: 29.830 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 26.508262634277344
Epoch: 12, Steps: 32 | Train Loss: 0.288 Vali Loss: 34.007 Vali Acc: 0.466 Test Loss: 34.007 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 27.111047983169556
Epoch: 13, Steps: 32 | Train Loss: 1.325 Vali Loss: 66.204 Vali Acc: 0.511 Test Loss: 66.204 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 26.81883144378662
Epoch: 14, Steps: 32 | Train Loss: 1.189 Vali Loss: 41.201 Vali Acc: 0.511 Test Loss: 41.201 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 28.2250497341156
Epoch: 15, Steps: 32 | Train Loss: 0.085 Vali Loss: 51.004 Vali Acc: 0.473 Test Loss: 51.004 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 3117157
model size : 16.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 21.589174509048462
Epoch: 1, Steps: 32 | Train Loss: 3.626 Vali Loss: 3.765 Vali Acc: 0.351 Test Loss: 3.765 Test Acc: 0.351
Validation loss decreased (inf --> -0.351107).  Saving model ...
Epoch: 2 cost time: 19.95738983154297
Epoch: 2, Steps: 32 | Train Loss: 3.778 Vali Loss: 7.316 Vali Acc: 0.321 Test Loss: 7.316 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 20.06406807899475
Epoch: 3, Steps: 32 | Train Loss: 2.160 Vali Loss: 10.482 Vali Acc: 0.519 Test Loss: 10.482 Test Acc: 0.519
Validation loss decreased (-0.351107 --> -0.518979).  Saving model ...
Epoch: 4 cost time: 21.43696689605713
Epoch: 4, Steps: 32 | Train Loss: 0.822 Vali Loss: 18.442 Vali Acc: 0.504 Test Loss: 18.442 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 21.886507749557495
Epoch: 5, Steps: 32 | Train Loss: 1.408 Vali Loss: 9.579 Vali Acc: 0.519 Test Loss: 9.579 Test Acc: 0.519
Validation loss decreased (-0.518979 --> -0.518988).  Saving model ...
Epoch: 6 cost time: 23.201149225234985
Epoch: 6, Steps: 32 | Train Loss: 0.268 Vali Loss: 29.610 Vali Acc: 0.496 Test Loss: 29.610 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 21.495192050933838
Epoch: 7, Steps: 32 | Train Loss: 1.484 Vali Loss: 19.257 Vali Acc: 0.504 Test Loss: 19.257 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 21.842185974121094
Epoch: 8, Steps: 32 | Train Loss: 0.320 Vali Loss: 27.160 Vali Acc: 0.489 Test Loss: 27.160 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 22.213152170181274
Epoch: 9, Steps: 32 | Train Loss: 0.648 Vali Loss: 21.328 Vali Acc: 0.473 Test Loss: 21.328 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 22.0907039642334
Epoch: 10, Steps: 32 | Train Loss: 0.747 Vali Loss: 24.803 Vali Acc: 0.511 Test Loss: 24.803 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 22.29334282875061
Epoch: 11, Steps: 32 | Train Loss: 1.964 Vali Loss: 65.974 Vali Acc: 0.481 Test Loss: 65.974 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 23.12169075012207
Epoch: 12, Steps: 32 | Train Loss: 1.781 Vali Loss: 49.110 Vali Acc: 0.496 Test Loss: 49.110 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 23.999197959899902
Epoch: 13, Steps: 32 | Train Loss: 2.179 Vali Loss: 74.571 Vali Acc: 0.466 Test Loss: 74.571 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 23.50461459159851
Epoch: 14, Steps: 32 | Train Loss: 3.209 Vali Loss: 39.327 Vali Acc: 0.466 Test Loss: 39.327 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 21.7661292552948
Epoch: 15, Steps: 32 | Train Loss: 2.291 Vali Loss: 42.389 Vali Acc: 0.382 Test Loss: 42.389 Test Acc: 0.382
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 3117157
model size : 16.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         540                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma540_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 23.72012162208557
Epoch: 1, Steps: 32 | Train Loss: 3.216 Vali Loss: 2.830 Vali Acc: 0.443 Test Loss: 2.830 Test Acc: 0.443
Validation loss decreased (inf --> -0.442720).  Saving model ...
Epoch: 2 cost time: 20.112985849380493
Epoch: 2, Steps: 32 | Train Loss: 3.136 Vali Loss: 9.224 Vali Acc: 0.206 Test Loss: 9.224 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 18.86469602584839
Epoch: 3, Steps: 32 | Train Loss: 2.492 Vali Loss: 8.954 Vali Acc: 0.527 Test Loss: 8.954 Test Acc: 0.527
Validation loss decreased (-0.442720 --> -0.526628).  Saving model ...
Epoch: 4 cost time: 20.563263416290283
Epoch: 4, Steps: 32 | Train Loss: 1.539 Vali Loss: 26.750 Vali Acc: 0.458 Test Loss: 26.750 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 23.162832975387573
Epoch: 5, Steps: 32 | Train Loss: 0.640 Vali Loss: 14.809 Vali Acc: 0.466 Test Loss: 14.809 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 21.235228538513184
Epoch: 6, Steps: 32 | Train Loss: 0.475 Vali Loss: 19.475 Vali Acc: 0.450 Test Loss: 19.475 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 20.938679218292236
Epoch: 7, Steps: 32 | Train Loss: 1.071 Vali Loss: 14.645 Vali Acc: 0.412 Test Loss: 14.645 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 24.251758337020874
Epoch: 8, Steps: 32 | Train Loss: 0.658 Vali Loss: 21.718 Vali Acc: 0.489 Test Loss: 21.718 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 22.025399923324585
Epoch: 9, Steps: 32 | Train Loss: 2.108 Vali Loss: 27.540 Vali Acc: 0.519 Test Loss: 27.540 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 22.943363666534424
Epoch: 10, Steps: 32 | Train Loss: 0.504 Vali Loss: 25.125 Vali Acc: 0.458 Test Loss: 25.125 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 20.52238416671753
Epoch: 11, Steps: 32 | Train Loss: 0.718 Vali Loss: 30.608 Vali Acc: 0.481 Test Loss: 30.608 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 20.970462799072266
Epoch: 12, Steps: 32 | Train Loss: 0.734 Vali Loss: 22.926 Vali Acc: 0.527 Test Loss: 22.926 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 21.094072818756104
Epoch: 13, Steps: 32 | Train Loss: 0.543 Vali Loss: 23.565 Vali Acc: 0.427 Test Loss: 23.565 Test Acc: 0.427
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma540_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 3117157
model size : 16.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 25.99429750442505
Epoch: 1, Steps: 32 | Train Loss: 2.894 Vali Loss: 4.790 Vali Acc: 0.466 Test Loss: 4.790 Test Acc: 0.466
Validation loss decreased (inf --> -0.465601).  Saving model ...
Epoch: 2 cost time: 22.9357488155365
Epoch: 2, Steps: 32 | Train Loss: 3.205 Vali Loss: 8.560 Vali Acc: 0.229 Test Loss: 8.560 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 24.420965909957886
Epoch: 3, Steps: 32 | Train Loss: 2.391 Vali Loss: 11.251 Vali Acc: 0.542 Test Loss: 11.251 Test Acc: 0.542
Validation loss decreased (-0.465601 --> -0.541872).  Saving model ...
Epoch: 4 cost time: 22.321778297424316
Epoch: 4, Steps: 32 | Train Loss: 0.913 Vali Loss: 23.264 Vali Acc: 0.504 Test Loss: 23.264 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 21.096171140670776
Epoch: 5, Steps: 32 | Train Loss: 1.155 Vali Loss: 15.357 Vali Acc: 0.481 Test Loss: 15.357 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 21.456332683563232
Epoch: 6, Steps: 32 | Train Loss: 0.643 Vali Loss: 23.802 Vali Acc: 0.489 Test Loss: 23.802 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 20.45486545562744
Epoch: 7, Steps: 32 | Train Loss: 2.524 Vali Loss: 17.163 Vali Acc: 0.427 Test Loss: 17.163 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 19.84639811515808
Epoch: 8, Steps: 32 | Train Loss: 1.534 Vali Loss: 25.672 Vali Acc: 0.397 Test Loss: 25.672 Test Acc: 0.397
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 23.231377124786377
Epoch: 9, Steps: 32 | Train Loss: 1.682 Vali Loss: 56.146 Vali Acc: 0.504 Test Loss: 56.146 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 21.99314832687378
Epoch: 10, Steps: 32 | Train Loss: 1.619 Vali Loss: 44.717 Vali Acc: 0.504 Test Loss: 44.717 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 21.476975202560425
Epoch: 11, Steps: 32 | Train Loss: 0.327 Vali Loss: 47.956 Vali Acc: 0.481 Test Loss: 47.956 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 22.506556749343872
Epoch: 12, Steps: 32 | Train Loss: 1.018 Vali Loss: 54.687 Vali Acc: 0.481 Test Loss: 54.687 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 21.293550968170166
Epoch: 13, Steps: 32 | Train Loss: 0.407 Vali Loss: 35.260 Vali Acc: 0.473 Test Loss: 35.260 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 3117157
model size : 16.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 22.841181993484497
Epoch: 1, Steps: 32 | Train Loss: 3.111 Vali Loss: 4.429 Vali Acc: 0.359 Test Loss: 4.429 Test Acc: 0.359
Validation loss decreased (inf --> -0.358734).  Saving model ...
Epoch: 2 cost time: 21.054038524627686
Epoch: 2, Steps: 32 | Train Loss: 2.946 Vali Loss: 7.305 Vali Acc: 0.382 Test Loss: 7.305 Test Acc: 0.382
Validation loss decreased (-0.358734 --> -0.381606).  Saving model ...
Epoch: 3 cost time: 21.423660039901733
Epoch: 3, Steps: 32 | Train Loss: 1.099 Vali Loss: 5.301 Vali Acc: 0.489 Test Loss: 5.301 Test Acc: 0.489
Validation loss decreased (-0.381606 --> -0.488497).  Saving model ...
Epoch: 4 cost time: 21.052128553390503
Epoch: 4, Steps: 32 | Train Loss: 1.290 Vali Loss: 11.674 Vali Acc: 0.573 Test Loss: 11.674 Test Acc: 0.573
Validation loss decreased (-0.488497 --> -0.572402).  Saving model ...
Epoch: 5 cost time: 21.109710931777954
Epoch: 5, Steps: 32 | Train Loss: 2.344 Vali Loss: 26.899 Vali Acc: 0.481 Test Loss: 26.899 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 22.11277413368225
Epoch: 6, Steps: 32 | Train Loss: 3.045 Vali Loss: 17.070 Vali Acc: 0.527 Test Loss: 17.070 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 24.89191460609436
Epoch: 7, Steps: 32 | Train Loss: 1.052 Vali Loss: 19.696 Vali Acc: 0.511 Test Loss: 19.696 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 22.992046356201172
Epoch: 8, Steps: 32 | Train Loss: 1.193 Vali Loss: 9.876 Vali Acc: 0.580 Test Loss: 9.876 Test Acc: 0.580
Validation loss decreased (-0.572402 --> -0.580054).  Saving model ...
Epoch: 9 cost time: 24.500761032104492
Epoch: 9, Steps: 32 | Train Loss: 1.884 Vali Loss: 30.979 Vali Acc: 0.481 Test Loss: 30.979 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 21.357243299484253
Epoch: 10, Steps: 32 | Train Loss: 2.123 Vali Loss: 13.689 Vali Acc: 0.534 Test Loss: 13.689 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 25.07252860069275
Epoch: 11, Steps: 32 | Train Loss: 0.037 Vali Loss: 21.196 Vali Acc: 0.573 Test Loss: 21.196 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 24.29012441635132
Epoch: 12, Steps: 32 | Train Loss: 0.425 Vali Loss: 18.041 Vali Acc: 0.489 Test Loss: 18.041 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 22.054065465927124
Epoch: 13, Steps: 32 | Train Loss: 0.063 Vali Loss: 22.724 Vali Acc: 0.534 Test Loss: 22.724 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 21.81763458251953
Epoch: 14, Steps: 32 | Train Loss: 0.165 Vali Loss: 33.750 Vali Acc: 0.435 Test Loss: 33.750 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 23.4122793674469
Epoch: 15, Steps: 32 | Train Loss: 0.122 Vali Loss: 48.315 Vali Acc: 0.519 Test Loss: 48.315 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 20.837347745895386
Epoch: 16, Steps: 32 | Train Loss: 1.689 Vali Loss: 27.520 Vali Acc: 0.450 Test Loss: 27.520 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 24.459420680999756
Epoch: 17, Steps: 32 | Train Loss: 1.307 Vali Loss: 34.861 Vali Acc: 0.534 Test Loss: 34.861 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 23.307228565216064
Epoch: 18, Steps: 32 | Train Loss: 0.732 Vali Loss: 36.103 Vali Acc: 0.534 Test Loss: 36.103 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 3117157
model size : 16.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 28.53435444831848
Epoch: 1, Steps: 32 | Train Loss: 2.833 Vali Loss: 4.273 Vali Acc: 0.298 Test Loss: 4.273 Test Acc: 0.298
Validation loss decreased (inf --> -0.297667).  Saving model ...
Epoch: 2 cost time: 24.20781135559082
Epoch: 2, Steps: 32 | Train Loss: 2.681 Vali Loss: 9.461 Vali Acc: 0.481 Test Loss: 9.461 Test Acc: 0.481
Validation loss decreased (-0.297667 --> -0.480821).  Saving model ...
Epoch: 3 cost time: 22.57033896446228
Epoch: 3, Steps: 32 | Train Loss: 3.350 Vali Loss: 2.992 Vali Acc: 0.527 Test Loss: 2.992 Test Acc: 0.527
Validation loss decreased (-0.480821 --> -0.526688).  Saving model ...
Epoch: 4 cost time: 22.95070481300354
Epoch: 4, Steps: 32 | Train Loss: 0.746 Vali Loss: 8.122 Vali Acc: 0.504 Test Loss: 8.122 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 22.210525512695312
Epoch: 5, Steps: 32 | Train Loss: 1.224 Vali Loss: 13.753 Vali Acc: 0.504 Test Loss: 13.753 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 20.872482299804688
Epoch: 6, Steps: 32 | Train Loss: 1.242 Vali Loss: 6.725 Vali Acc: 0.580 Test Loss: 6.725 Test Acc: 0.580
Validation loss decreased (-0.526688 --> -0.580085).  Saving model ...
Epoch: 7 cost time: 23.562843322753906
Epoch: 7, Steps: 32 | Train Loss: 1.029 Vali Loss: 11.877 Vali Acc: 0.458 Test Loss: 11.877 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 22.323339462280273
Epoch: 8, Steps: 32 | Train Loss: 0.418 Vali Loss: 14.982 Vali Acc: 0.366 Test Loss: 14.982 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 22.986191034317017
Epoch: 9, Steps: 32 | Train Loss: 0.658 Vali Loss: 21.351 Vali Acc: 0.534 Test Loss: 21.351 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 25.178500413894653
Epoch: 10, Steps: 32 | Train Loss: 0.732 Vali Loss: 25.686 Vali Acc: 0.382 Test Loss: 25.686 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 25.549172163009644
Epoch: 11, Steps: 32 | Train Loss: 2.776 Vali Loss: 27.826 Vali Acc: 0.542 Test Loss: 27.826 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 23.31362223625183
Epoch: 12, Steps: 32 | Train Loss: 3.103 Vali Loss: 32.573 Vali Acc: 0.534 Test Loss: 32.573 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 20.792341470718384
Epoch: 13, Steps: 32 | Train Loss: 1.502 Vali Loss: 30.459 Vali Acc: 0.557 Test Loss: 30.459 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 20.862659454345703
Epoch: 14, Steps: 32 | Train Loss: 0.913 Vali Loss: 14.089 Vali Acc: 0.565 Test Loss: 14.089 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 23.548484325408936
Epoch: 15, Steps: 32 | Train Loss: 0.268 Vali Loss: 18.980 Vali Acc: 0.557 Test Loss: 18.980 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 24.049875259399414
Epoch: 16, Steps: 32 | Train Loss: 0.745 Vali Loss: 26.678 Vali Acc: 0.527 Test Loss: 26.678 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df1024_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 3117157
model size : 16.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         8992                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df512_ma8992_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 50.0330331325531
Epoch: 1, Steps: 32 | Train Loss: 4.579 Vali Loss: 6.286 Vali Acc: 0.221 Test Loss: 6.286 Test Acc: 0.221
Validation loss decreased (inf --> -0.221311).  Saving model ...
Epoch: 2 cost time: 49.041149854660034
Epoch: 2, Steps: 32 | Train Loss: 2.577 Vali Loss: 10.711 Vali Acc: 0.244 Test Loss: 10.711 Test Acc: 0.244
Validation loss decreased (-0.221311 --> -0.244168).  Saving model ...
Epoch: 3 cost time: 50.67203760147095
Epoch: 3, Steps: 32 | Train Loss: 1.759 Vali Loss: 12.123 Vali Acc: 0.534 Test Loss: 12.123 Test Acc: 0.534
Validation loss decreased (-0.244168 --> -0.534230).  Saving model ...
Epoch: 4 cost time: 53.47590136528015
Epoch: 4, Steps: 32 | Train Loss: 4.472 Vali Loss: 9.703 Vali Acc: 0.511 Test Loss: 9.703 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 59.79052758216858
Epoch: 5, Steps: 32 | Train Loss: 3.297 Vali Loss: 13.236 Vali Acc: 0.573 Test Loss: 13.236 Test Acc: 0.573
Validation loss decreased (-0.534230 --> -0.572387).  Saving model ...
Epoch: 6 cost time: 63.810389041900635
Epoch: 6, Steps: 32 | Train Loss: 0.746 Vali Loss: 25.917 Vali Acc: 0.389 Test Loss: 25.917 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 62.06559896469116
Epoch: 7, Steps: 32 | Train Loss: 0.417 Vali Loss: 27.185 Vali Acc: 0.481 Test Loss: 27.185 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 65.22573709487915
Epoch: 8, Steps: 32 | Train Loss: 0.679 Vali Loss: 24.640 Vali Acc: 0.519 Test Loss: 24.640 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 66.45500111579895
Epoch: 9, Steps: 32 | Train Loss: 0.452 Vali Loss: 44.705 Vali Acc: 0.366 Test Loss: 44.705 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 66.44149899482727
Epoch: 10, Steps: 32 | Train Loss: 0.527 Vali Loss: 25.711 Vali Acc: 0.550 Test Loss: 25.711 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 67.44849896430969
Epoch: 11, Steps: 32 | Train Loss: 2.082 Vali Loss: 40.929 Vali Acc: 0.321 Test Loss: 40.929 Test Acc: 0.321
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 65.29191660881042
Epoch: 12, Steps: 32 | Train Loss: 2.564 Vali Loss: 42.069 Vali Acc: 0.557 Test Loss: 42.069 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 67.6656265258789
Epoch: 13, Steps: 32 | Train Loss: 1.339 Vali Loss: 43.171 Vali Acc: 0.519 Test Loss: 43.171 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 66.52836656570435
Epoch: 14, Steps: 32 | Train Loss: 0.637 Vali Loss: 37.025 Vali Acc: 0.435 Test Loss: 37.025 Test Acc: 0.435
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 70.36216044425964
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 39.206 Vali Acc: 0.466 Test Loss: 39.206 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df512_ma8992_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 3018853
model size : 15.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         7194                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df512_ma7194_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 43.88767051696777
Epoch: 1, Steps: 32 | Train Loss: 4.231 Vali Loss: 6.990 Vali Acc: 0.130 Test Loss: 6.990 Test Acc: 0.130
Validation loss decreased (inf --> -0.129701).  Saving model ...
Epoch: 2 cost time: 43.329994201660156
Epoch: 2, Steps: 32 | Train Loss: 3.504 Vali Loss: 7.472 Vali Acc: 0.305 Test Loss: 7.472 Test Acc: 0.305
Validation loss decreased (-0.129701 --> -0.305269).  Saving model ...
Epoch: 3 cost time: 43.416728258132935
Epoch: 3, Steps: 32 | Train Loss: 1.496 Vali Loss: 6.137 Vali Acc: 0.489 Test Loss: 6.137 Test Acc: 0.489
Validation loss decreased (-0.305269 --> -0.488488).  Saving model ...
Epoch: 4 cost time: 44.85915279388428
Epoch: 4, Steps: 32 | Train Loss: 2.786 Vali Loss: 16.957 Vali Acc: 0.489 Test Loss: 16.957 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 48.6745707988739
Epoch: 5, Steps: 32 | Train Loss: 1.816 Vali Loss: 14.083 Vali Acc: 0.397 Test Loss: 14.083 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 51.80726718902588
Epoch: 6, Steps: 32 | Train Loss: 0.727 Vali Loss: 16.291 Vali Acc: 0.473 Test Loss: 16.291 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 55.37699890136719
Epoch: 7, Steps: 32 | Train Loss: 0.635 Vali Loss: 16.202 Vali Acc: 0.389 Test Loss: 16.202 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 57.55939507484436
Epoch: 8, Steps: 32 | Train Loss: 1.202 Vali Loss: 26.266 Vali Acc: 0.435 Test Loss: 26.266 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 59.20097827911377
Epoch: 9, Steps: 32 | Train Loss: 0.232 Vali Loss: 23.736 Vali Acc: 0.588 Test Loss: 23.736 Test Acc: 0.588
Validation loss decreased (-0.488488 --> -0.587549).  Saving model ...
Epoch: 10 cost time: 60.834283113479614
Epoch: 10, Steps: 32 | Train Loss: 0.130 Vali Loss: 31.081 Vali Acc: 0.427 Test Loss: 31.081 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 57.72264814376831
Epoch: 11, Steps: 32 | Train Loss: 1.509 Vali Loss: 37.550 Vali Acc: 0.588 Test Loss: 37.550 Test Acc: 0.588
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 55.643309593200684
Epoch: 12, Steps: 32 | Train Loss: 0.754 Vali Loss: 29.814 Vali Acc: 0.504 Test Loss: 29.814 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 59.56977868080139
Epoch: 13, Steps: 32 | Train Loss: 1.782 Vali Loss: 36.956 Vali Acc: 0.420 Test Loss: 36.956 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 58.190370321273804
Epoch: 14, Steps: 32 | Train Loss: 1.129 Vali Loss: 49.844 Vali Acc: 0.534 Test Loss: 49.844 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 59.6345636844635
Epoch: 15, Steps: 32 | Train Loss: 0.918 Vali Loss: 41.931 Vali Acc: 0.542 Test Loss: 41.931 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 60.115565061569214
Epoch: 16, Steps: 32 | Train Loss: 1.840 Vali Loss: 54.021 Vali Acc: 0.405 Test Loss: 54.021 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 56.908817291259766
Epoch: 17, Steps: 32 | Train Loss: 2.283 Vali Loss: 50.083 Vali Acc: 0.557 Test Loss: 50.083 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 58.177674293518066
Epoch: 18, Steps: 32 | Train Loss: 3.478 Vali Loss: 50.168 Vali Acc: 0.389 Test Loss: 50.168 Test Acc: 0.389
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 58.05100226402283
Epoch: 19, Steps: 32 | Train Loss: 3.057 Vali Loss: 47.400 Vali Acc: 0.504 Test Loss: 47.400 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df512_ma7194_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 3018853
model size : 15.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         5396                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df512_ma5396_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 37.68984913825989
Epoch: 1, Steps: 32 | Train Loss: 3.530 Vali Loss: 4.803 Vali Acc: 0.221 Test Loss: 4.803 Test Acc: 0.221
Validation loss decreased (inf --> -0.221326).  Saving model ...
Epoch: 2 cost time: 35.69123554229736
Epoch: 2, Steps: 32 | Train Loss: 2.295 Vali Loss: 8.049 Vali Acc: 0.405 Test Loss: 8.049 Test Acc: 0.405
Validation loss decreased (-0.221326 --> -0.404500).  Saving model ...
Epoch: 3 cost time: 37.99994397163391
Epoch: 3, Steps: 32 | Train Loss: 2.226 Vali Loss: 10.028 Vali Acc: 0.244 Test Loss: 10.028 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 38.837355613708496
Epoch: 4, Steps: 32 | Train Loss: 2.088 Vali Loss: 12.357 Vali Acc: 0.405 Test Loss: 12.357 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 42.96857500076294
Epoch: 5, Steps: 32 | Train Loss: 2.777 Vali Loss: 18.157 Vali Acc: 0.282 Test Loss: 18.157 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 44.24739336967468
Epoch: 6, Steps: 32 | Train Loss: 0.240 Vali Loss: 16.636 Vali Acc: 0.443 Test Loss: 16.636 Test Acc: 0.443
Validation loss decreased (-0.404500 --> -0.442582).  Saving model ...
Epoch: 7 cost time: 45.8599112033844
Epoch: 7, Steps: 32 | Train Loss: 0.747 Vali Loss: 26.706 Vali Acc: 0.527 Test Loss: 26.706 Test Acc: 0.527
Validation loss decreased (-0.442582 --> -0.526450).  Saving model ...
Epoch: 8 cost time: 48.28304886817932
Epoch: 8, Steps: 32 | Train Loss: 0.759 Vali Loss: 34.072 Vali Acc: 0.527 Test Loss: 34.072 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 46.258166790008545
Epoch: 9, Steps: 32 | Train Loss: 3.491 Vali Loss: 34.485 Vali Acc: 0.267 Test Loss: 34.485 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 47.46552515029907
Epoch: 10, Steps: 32 | Train Loss: 2.570 Vali Loss: 53.708 Vali Acc: 0.542 Test Loss: 53.708 Test Acc: 0.542
Validation loss decreased (-0.526450 --> -0.541448).  Saving model ...
Epoch: 11 cost time: 45.78843426704407
Epoch: 11, Steps: 32 | Train Loss: 1.275 Vali Loss: 35.100 Vali Acc: 0.412 Test Loss: 35.100 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 47.94063353538513
Epoch: 12, Steps: 32 | Train Loss: 1.678 Vali Loss: 33.944 Vali Acc: 0.534 Test Loss: 33.944 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 46.351004123687744
Epoch: 13, Steps: 32 | Train Loss: 1.419 Vali Loss: 29.713 Vali Acc: 0.450 Test Loss: 29.713 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 47.752264738082886
Epoch: 14, Steps: 32 | Train Loss: 0.197 Vali Loss: 37.158 Vali Acc: 0.550 Test Loss: 37.158 Test Acc: 0.550
Validation loss decreased (-0.541448 --> -0.549247).  Saving model ...
Epoch: 15 cost time: 47.8684287071228
Epoch: 15, Steps: 32 | Train Loss: 0.153 Vali Loss: 52.610 Vali Acc: 0.550 Test Loss: 52.610 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 47.74448919296265
Epoch: 16, Steps: 32 | Train Loss: 0.307 Vali Loss: 47.718 Vali Acc: 0.336 Test Loss: 47.718 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 47.40384554862976
Epoch: 17, Steps: 32 | Train Loss: 1.187 Vali Loss: 60.905 Vali Acc: 0.527 Test Loss: 60.905 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 47.69122648239136
Epoch: 18, Steps: 32 | Train Loss: 0.145 Vali Loss: 39.151 Vali Acc: 0.542 Test Loss: 39.151 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 47.22392225265503
Epoch: 19, Steps: 32 | Train Loss: 0.058 Vali Loss: 59.892 Vali Acc: 0.473 Test Loss: 59.892 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 46.66192317008972
Epoch: 20, Steps: 32 | Train Loss: 0.673 Vali Loss: 39.010 Vali Acc: 0.443 Test Loss: 39.010 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 46.178366899490356
Epoch: 21, Steps: 32 | Train Loss: 0.050 Vali Loss: 47.674 Vali Acc: 0.366 Test Loss: 47.674 Test Acc: 0.366
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 47.21215891838074
Epoch: 22, Steps: 32 | Train Loss: 1.370 Vali Loss: 84.883 Vali Acc: 0.221 Test Loss: 84.883 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 46.836676836013794
Epoch: 23, Steps: 32 | Train Loss: 1.526 Vali Loss: 67.213 Vali Acc: 0.481 Test Loss: 67.213 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 47.680283546447754
Epoch: 24, Steps: 32 | Train Loss: 0.001 Vali Loss: 74.231 Vali Acc: 0.435 Test Loss: 74.231 Test Acc: 0.435
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df512_ma5396_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 3018853
model size : 15.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         3597                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df512_ma3597_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 33.16895771026611
Epoch: 1, Steps: 32 | Train Loss: 4.392 Vali Loss: 6.310 Vali Acc: 0.176 Test Loss: 6.310 Test Acc: 0.176
Validation loss decreased (inf --> -0.175509).  Saving model ...
Epoch: 2 cost time: 29.678368091583252
Epoch: 2, Steps: 32 | Train Loss: 2.425 Vali Loss: 12.191 Vali Acc: 0.244 Test Loss: 12.191 Test Acc: 0.244
Validation loss decreased (-0.175509 --> -0.244153).  Saving model ...
Epoch: 3 cost time: 28.45263910293579
Epoch: 3, Steps: 32 | Train Loss: 2.671 Vali Loss: 19.126 Vali Acc: 0.504 Test Loss: 19.126 Test Acc: 0.504
Validation loss decreased (-0.244153 --> -0.503626).  Saving model ...
Epoch: 4 cost time: 31.183990716934204
Epoch: 4, Steps: 32 | Train Loss: 5.295 Vali Loss: 14.219 Vali Acc: 0.443 Test Loss: 14.219 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 32.11763334274292
Epoch: 5, Steps: 32 | Train Loss: 0.949 Vali Loss: 13.260 Vali Acc: 0.550 Test Loss: 13.260 Test Acc: 0.550
Validation loss decreased (-0.503626 --> -0.549486).  Saving model ...
Epoch: 6 cost time: 33.363903284072876
Epoch: 6, Steps: 32 | Train Loss: 0.583 Vali Loss: 27.300 Vali Acc: 0.527 Test Loss: 27.300 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 35.776516914367676
Epoch: 7, Steps: 32 | Train Loss: 0.451 Vali Loss: 14.433 Vali Acc: 0.496 Test Loss: 14.433 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 35.1526460647583
Epoch: 8, Steps: 32 | Train Loss: 0.000 Vali Loss: 15.120 Vali Acc: 0.511 Test Loss: 15.120 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 34.676883935928345
Epoch: 9, Steps: 32 | Train Loss: 0.000 Vali Loss: 15.170 Vali Acc: 0.496 Test Loss: 15.170 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 35.77272272109985
Epoch: 10, Steps: 32 | Train Loss: 0.000 Vali Loss: 15.176 Vali Acc: 0.496 Test Loss: 15.176 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 36.69212603569031
Epoch: 11, Steps: 32 | Train Loss: 0.000 Vali Loss: 15.169 Vali Acc: 0.489 Test Loss: 15.169 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 37.15799570083618
Epoch: 12, Steps: 32 | Train Loss: 0.000 Vali Loss: 15.170 Vali Acc: 0.489 Test Loss: 15.170 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 38.80701208114624
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 15.167 Vali Acc: 0.489 Test Loss: 15.167 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 39.5569224357605
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 15.172 Vali Acc: 0.489 Test Loss: 15.172 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 40.94955897331238
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 15.231 Vali Acc: 0.489 Test Loss: 15.231 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df512_ma3597_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 3018853
model size : 15.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         1799                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df512_ma1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 27.28790831565857
Epoch: 1, Steps: 32 | Train Loss: 3.312 Vali Loss: 3.770 Vali Acc: 0.305 Test Loss: 3.770 Test Acc: 0.305
Validation loss decreased (inf --> -0.305306).  Saving model ...
Epoch: 2 cost time: 24.09947156906128
Epoch: 2, Steps: 32 | Train Loss: 2.870 Vali Loss: 8.192 Vali Acc: 0.496 Test Loss: 8.192 Test Acc: 0.496
Validation loss decreased (-0.305306 --> -0.496101).  Saving model ...
Epoch: 3 cost time: 23.65683889389038
Epoch: 3, Steps: 32 | Train Loss: 2.028 Vali Loss: 9.060 Vali Acc: 0.527 Test Loss: 9.060 Test Acc: 0.527
Validation loss decreased (-0.496101 --> -0.526627).  Saving model ...
Epoch: 4 cost time: 23.79442834854126
Epoch: 4, Steps: 32 | Train Loss: 2.572 Vali Loss: 13.264 Vali Acc: 0.534 Test Loss: 13.264 Test Acc: 0.534
Validation loss decreased (-0.526627 --> -0.534219).  Saving model ...
Epoch: 5 cost time: 23.73515272140503
Epoch: 5, Steps: 32 | Train Loss: 0.972 Vali Loss: 12.779 Vali Acc: 0.481 Test Loss: 12.779 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 24.00988245010376
Epoch: 6, Steps: 32 | Train Loss: 1.706 Vali Loss: 16.428 Vali Acc: 0.519 Test Loss: 16.428 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 26.171204090118408
Epoch: 7, Steps: 32 | Train Loss: 0.538 Vali Loss: 25.660 Vali Acc: 0.496 Test Loss: 25.660 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 24.799559354782104
Epoch: 8, Steps: 32 | Train Loss: 1.192 Vali Loss: 26.634 Vali Acc: 0.260 Test Loss: 26.634 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 25.057450771331787
Epoch: 9, Steps: 32 | Train Loss: 0.918 Vali Loss: 27.938 Vali Acc: 0.321 Test Loss: 27.938 Test Acc: 0.321
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 25.237070560455322
Epoch: 10, Steps: 32 | Train Loss: 2.581 Vali Loss: 46.416 Vali Acc: 0.504 Test Loss: 46.416 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 26.007978200912476
Epoch: 11, Steps: 32 | Train Loss: 1.590 Vali Loss: 35.160 Vali Acc: 0.511 Test Loss: 35.160 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 28.96673893928528
Epoch: 12, Steps: 32 | Train Loss: 1.061 Vali Loss: 31.081 Vali Acc: 0.557 Test Loss: 31.081 Test Acc: 0.557
Validation loss decreased (-0.534219 --> -0.556941).  Saving model ...
Epoch: 13 cost time: 24.977978944778442
Epoch: 13, Steps: 32 | Train Loss: 0.363 Vali Loss: 38.139 Vali Acc: 0.580 Test Loss: 38.139 Test Acc: 0.580
Validation loss decreased (-0.556941 --> -0.579771).  Saving model ...
Epoch: 14 cost time: 24.237562894821167
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.750 Vali Acc: 0.588 Test Loss: 29.750 Test Acc: 0.588
Validation loss decreased (-0.579771 --> -0.587489).  Saving model ...
Epoch: 15 cost time: 25.91203808784485
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.542 Vali Acc: 0.588 Test Loss: 29.542 Test Acc: 0.588
Validation loss decreased (-0.587489 --> -0.587491).  Saving model ...
Epoch: 16 cost time: 26.871038913726807
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.533 Vali Acc: 0.588 Test Loss: 29.533 Test Acc: 0.588
Validation loss decreased (-0.587491 --> -0.587491).  Saving model ...
Epoch: 17 cost time: 25.24352264404297
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.526 Vali Acc: 0.588 Test Loss: 29.526 Test Acc: 0.588
Validation loss decreased (-0.587491 --> -0.587491).  Saving model ...
Epoch: 18 cost time: 27.308935165405273
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.522 Vali Acc: 0.588 Test Loss: 29.522 Test Acc: 0.588
Validation loss decreased (-0.587491 --> -0.587491).  Saving model ...
Epoch: 19 cost time: 27.42767906188965
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.507 Vali Acc: 0.588 Test Loss: 29.507 Test Acc: 0.588
Validation loss decreased (-0.587491 --> -0.587491).  Saving model ...
Epoch: 20 cost time: 27.539580583572388
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.503 Vali Acc: 0.588 Test Loss: 29.503 Test Acc: 0.588
Validation loss decreased (-0.587491 --> -0.587491).  Saving model ...
Epoch: 21 cost time: 27.163876056671143
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.491 Vali Acc: 0.588 Test Loss: 29.491 Test Acc: 0.588
Validation loss decreased (-0.587491 --> -0.587491).  Saving model ...
Epoch: 22 cost time: 27.707200050354004
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.486 Vali Acc: 0.588 Test Loss: 29.486 Test Acc: 0.588
Validation loss decreased (-0.587491 --> -0.587491).  Saving model ...
Epoch: 23 cost time: 27.192208290100098
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.486 Vali Acc: 0.588 Test Loss: 29.486 Test Acc: 0.588
Validation loss decreased (-0.587491 --> -0.587491).  Saving model ...
Epoch: 24 cost time: 27.58823013305664
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.485 Vali Acc: 0.588 Test Loss: 29.485 Test Acc: 0.588
Validation loss decreased (-0.587491 --> -0.587491).  Saving model ...
Epoch: 25 cost time: 37.50426721572876
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.476 Vali Acc: 0.588 Test Loss: 29.476 Test Acc: 0.588
Validation loss decreased (-0.587491 --> -0.587491).  Saving model ...
Epoch: 26 cost time: 27.342909336090088
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.472 Vali Acc: 0.588 Test Loss: 29.472 Test Acc: 0.588
Validation loss decreased (-0.587491 --> -0.587492).  Saving model ...
Epoch: 27 cost time: 26.165442943572998
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.470 Vali Acc: 0.588 Test Loss: 29.470 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 28 cost time: 25.489675998687744
Epoch: 28, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.470 Vali Acc: 0.588 Test Loss: 29.470 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 29 cost time: 23.030245780944824
Epoch: 29, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.470 Vali Acc: 0.588 Test Loss: 29.470 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 30 cost time: 26.67305016517639
Epoch: 30, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.470 Vali Acc: 0.588 Test Loss: 29.470 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 31 cost time: 28.56656265258789
Epoch: 31, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.470 Vali Acc: 0.588 Test Loss: 29.470 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 32 cost time: 26.005656957626343
Epoch: 32, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.469 Vali Acc: 0.588 Test Loss: 29.469 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 33 cost time: 26.08095622062683
Epoch: 33, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.455 Vali Acc: 0.588 Test Loss: 29.455 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 34 cost time: 27.06055498123169
Epoch: 34, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.455 Vali Acc: 0.588 Test Loss: 29.455 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 35 cost time: 29.637858390808105
Epoch: 35, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.455 Vali Acc: 0.588 Test Loss: 29.455 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 36 cost time: 28.46431279182434
Epoch: 36, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.455 Vali Acc: 0.588 Test Loss: 29.455 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 37 cost time: 27.36979603767395
Epoch: 37, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.455 Vali Acc: 0.588 Test Loss: 29.455 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 38 cost time: 27.39026141166687
Epoch: 38, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.455 Vali Acc: 0.588 Test Loss: 29.455 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 39 cost time: 27.432108402252197
Epoch: 39, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.455 Vali Acc: 0.588 Test Loss: 29.455 Test Acc: 0.588
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 27.315021276474
Epoch: 40, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.455 Vali Acc: 0.588 Test Loss: 29.455 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 41 cost time: 24.52507448196411
Epoch: 41, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.454 Vali Acc: 0.588 Test Loss: 29.454 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 42 cost time: 24.840277671813965
Epoch: 42, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.453 Vali Acc: 0.588 Test Loss: 29.453 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 43 cost time: 27.725335597991943
Epoch: 43, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.452 Vali Acc: 0.588 Test Loss: 29.452 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 44 cost time: 27.716830253601074
Epoch: 44, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.452 Vali Acc: 0.588 Test Loss: 29.452 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 45 cost time: 27.249170780181885
Epoch: 45, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.452 Vali Acc: 0.588 Test Loss: 29.452 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 46 cost time: 27.068194150924683
Epoch: 46, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.452 Vali Acc: 0.588 Test Loss: 29.452 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 47 cost time: 27.897019863128662
Epoch: 47, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.452 Vali Acc: 0.588 Test Loss: 29.452 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 48 cost time: 28.201056241989136
Epoch: 48, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.452 Vali Acc: 0.588 Test Loss: 29.452 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 49 cost time: 28.74360990524292
Epoch: 49, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.450 Vali Acc: 0.588 Test Loss: 29.450 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 50 cost time: 24.43080496788025
Epoch: 50, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.450 Vali Acc: 0.588 Test Loss: 29.450 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 51 cost time: 25.99017357826233
Epoch: 51, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.450 Vali Acc: 0.588 Test Loss: 29.450 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 52 cost time: 25.59487295150757
Epoch: 52, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.450 Vali Acc: 0.588 Test Loss: 29.450 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 53 cost time: 28.692599296569824
Epoch: 53, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.450 Vali Acc: 0.588 Test Loss: 29.450 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 54 cost time: 28.031081676483154
Epoch: 54, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.450 Vali Acc: 0.588 Test Loss: 29.450 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 55 cost time: 28.44698214530945
Epoch: 55, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.450 Vali Acc: 0.588 Test Loss: 29.450 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 56 cost time: 27.973244428634644
Epoch: 56, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.450 Vali Acc: 0.588 Test Loss: 29.450 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 57 cost time: 29.062625408172607
Epoch: 57, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.448 Vali Acc: 0.588 Test Loss: 29.448 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 58 cost time: 28.395489931106567
Epoch: 58, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.443 Vali Acc: 0.588 Test Loss: 29.443 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 59 cost time: 26.522589683532715
Epoch: 59, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.443 Vali Acc: 0.588 Test Loss: 29.443 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 60 cost time: 25.378321170806885
Epoch: 60, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.443 Vali Acc: 0.588 Test Loss: 29.443 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 61 cost time: 26.19260859489441
Epoch: 61, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.442 Vali Acc: 0.588 Test Loss: 29.442 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 62 cost time: 25.668296098709106
Epoch: 62, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.442 Vali Acc: 0.588 Test Loss: 29.442 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 63 cost time: 25.675182104110718
Epoch: 63, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.442 Vali Acc: 0.588 Test Loss: 29.442 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 64 cost time: 26.95052194595337
Epoch: 64, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.441 Vali Acc: 0.588 Test Loss: 29.441 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 65 cost time: 28.617217779159546
Epoch: 65, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.441 Vali Acc: 0.588 Test Loss: 29.441 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 66 cost time: 27.732845306396484
Epoch: 66, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.441 Vali Acc: 0.588 Test Loss: 29.441 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 67 cost time: 28.252970218658447
Epoch: 67, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.441 Vali Acc: 0.588 Test Loss: 29.441 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 68 cost time: 27.45502257347107
Epoch: 68, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.440 Vali Acc: 0.588 Test Loss: 29.440 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 69 cost time: 26.50859236717224
Epoch: 69, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.440 Vali Acc: 0.588 Test Loss: 29.440 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 70 cost time: 29.07506537437439
Epoch: 70, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.440 Vali Acc: 0.588 Test Loss: 29.440 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 71 cost time: 27.174076318740845
Epoch: 71, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.440 Vali Acc: 0.588 Test Loss: 29.440 Test Acc: 0.588
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 28.053740739822388
Epoch: 72, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.440 Vali Acc: 0.588 Test Loss: 29.440 Test Acc: 0.588
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 28.27294397354126
Epoch: 73, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.440 Vali Acc: 0.588 Test Loss: 29.440 Test Acc: 0.588
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 24.97999858856201
Epoch: 74, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.440 Vali Acc: 0.588 Test Loss: 29.440 Test Acc: 0.588
Validation loss decreased (-0.587492 --> -0.587492).  Saving model ...
Epoch: 75 cost time: 26.003742694854736
Epoch: 75, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.416 Vali Acc: 0.580 Test Loss: 29.416 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 28.02154278755188
Epoch: 76, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.415 Vali Acc: 0.580 Test Loss: 29.415 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 25.709595680236816
Epoch: 77, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.415 Vali Acc: 0.580 Test Loss: 29.415 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 26.171274423599243
Epoch: 78, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.415 Vali Acc: 0.580 Test Loss: 29.415 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 28.248319149017334
Epoch: 79, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.415 Vali Acc: 0.580 Test Loss: 29.415 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 25.58419442176819
Epoch: 80, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.415 Vali Acc: 0.580 Test Loss: 29.415 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 30.490859508514404
Epoch: 81, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.415 Vali Acc: 0.580 Test Loss: 29.415 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 82 cost time: 27.4011070728302
Epoch: 82, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.415 Vali Acc: 0.580 Test Loss: 29.415 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 83 cost time: 25.64368772506714
Epoch: 83, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.415 Vali Acc: 0.580 Test Loss: 29.415 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 84 cost time: 26.073873043060303
Epoch: 84, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.415 Vali Acc: 0.580 Test Loss: 29.415 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df512_ma1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 3018853
model size : 15.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df512_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 27.709356784820557
Epoch: 1, Steps: 32 | Train Loss: 3.727 Vali Loss: 3.796 Vali Acc: 0.252 Test Loss: 3.796 Test Acc: 0.252
Validation loss decreased (inf --> -0.251870).  Saving model ...
Epoch: 2 cost time: 25.75327730178833
Epoch: 2, Steps: 32 | Train Loss: 2.001 Vali Loss: 6.697 Vali Acc: 0.321 Test Loss: 6.697 Test Acc: 0.321
Validation loss decreased (-0.251870 --> -0.320544).  Saving model ...
Epoch: 3 cost time: 23.576345205307007
Epoch: 3, Steps: 32 | Train Loss: 1.941 Vali Loss: 7.662 Vali Acc: 0.534 Test Loss: 7.662 Test Acc: 0.534
Validation loss decreased (-0.320544 --> -0.534275).  Saving model ...
Epoch: 4 cost time: 24.273468494415283
Epoch: 4, Steps: 32 | Train Loss: 1.483 Vali Loss: 18.324 Vali Acc: 0.427 Test Loss: 18.324 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 27.380554676055908
Epoch: 5, Steps: 32 | Train Loss: 3.055 Vali Loss: 17.207 Vali Acc: 0.374 Test Loss: 17.207 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 26.729419231414795
Epoch: 6, Steps: 32 | Train Loss: 1.049 Vali Loss: 25.644 Vali Acc: 0.527 Test Loss: 25.644 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 25.014463424682617
Epoch: 7, Steps: 32 | Train Loss: 1.773 Vali Loss: 16.031 Vali Acc: 0.511 Test Loss: 16.031 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 24.915597438812256
Epoch: 8, Steps: 32 | Train Loss: 0.601 Vali Loss: 36.356 Vali Acc: 0.542 Test Loss: 36.356 Test Acc: 0.542
Validation loss decreased (-0.534275 --> -0.541621).  Saving model ...
Epoch: 9 cost time: 24.624801874160767
Epoch: 9, Steps: 32 | Train Loss: 0.708 Vali Loss: 33.002 Vali Acc: 0.519 Test Loss: 33.002 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 23.289862155914307
Epoch: 10, Steps: 32 | Train Loss: 0.676 Vali Loss: 32.762 Vali Acc: 0.504 Test Loss: 32.762 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 25.058199644088745
Epoch: 11, Steps: 32 | Train Loss: 0.692 Vali Loss: 24.194 Vali Acc: 0.489 Test Loss: 24.194 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 24.466476917266846
Epoch: 12, Steps: 32 | Train Loss: 0.400 Vali Loss: 32.873 Vali Acc: 0.496 Test Loss: 32.873 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 25.174744367599487
Epoch: 13, Steps: 32 | Train Loss: 0.457 Vali Loss: 26.695 Vali Acc: 0.504 Test Loss: 26.695 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 23.030620574951172
Epoch: 14, Steps: 32 | Train Loss: 0.734 Vali Loss: 37.729 Vali Acc: 0.511 Test Loss: 37.729 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 24.126537084579468
Epoch: 15, Steps: 32 | Train Loss: 0.683 Vali Loss: 26.777 Vali Acc: 0.550 Test Loss: 26.777 Test Acc: 0.550
Validation loss decreased (-0.541621 --> -0.549351).  Saving model ...
Epoch: 16 cost time: 25.744008541107178
Epoch: 16, Steps: 32 | Train Loss: 0.880 Vali Loss: 51.242 Vali Acc: 0.573 Test Loss: 51.242 Test Acc: 0.573
Validation loss decreased (-0.549351 --> -0.572007).  Saving model ...
Epoch: 17 cost time: 26.41118597984314
Epoch: 17, Steps: 32 | Train Loss: 1.563 Vali Loss: 61.081 Vali Acc: 0.527 Test Loss: 61.081 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 27.121761322021484
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 56.825 Vali Acc: 0.519 Test Loss: 56.825 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 28.0257728099823
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 56.414 Vali Acc: 0.527 Test Loss: 56.414 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 26.750027656555176
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 56.399 Vali Acc: 0.527 Test Loss: 56.399 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 25.063190460205078
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 56.399 Vali Acc: 0.527 Test Loss: 56.399 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 22.9435772895813
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 56.399 Vali Acc: 0.527 Test Loss: 56.399 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 27.474568367004395
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 56.399 Vali Acc: 0.527 Test Loss: 56.399 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 23.043556690216064
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 56.399 Vali Acc: 0.527 Test Loss: 56.399 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 27.260528564453125
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 56.399 Vali Acc: 0.527 Test Loss: 56.399 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 27.973393440246582
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 56.399 Vali Acc: 0.527 Test Loss: 56.399 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df512_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 3018853
model size : 15.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         540                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df512_ma540_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 28.09887170791626
Epoch: 1, Steps: 32 | Train Loss: 3.393 Vali Loss: 3.058 Vali Acc: 0.275 Test Loss: 3.058 Test Acc: 0.275
Validation loss decreased (inf --> -0.274779).  Saving model ...
Epoch: 2 cost time: 24.451700925827026
Epoch: 2, Steps: 32 | Train Loss: 1.744 Vali Loss: 6.095 Vali Acc: 0.321 Test Loss: 6.095 Test Acc: 0.321
Validation loss decreased (-0.274779 --> -0.320550).  Saving model ...
Epoch: 3 cost time: 25.212230682373047
Epoch: 3, Steps: 32 | Train Loss: 1.437 Vali Loss: 14.240 Vali Acc: 0.473 Test Loss: 14.240 Test Acc: 0.473
Validation loss decreased (-0.320550 --> -0.473140).  Saving model ...
Epoch: 4 cost time: 25.80824613571167
Epoch: 4, Steps: 32 | Train Loss: 2.836 Vali Loss: 14.961 Vali Acc: 0.496 Test Loss: 14.961 Test Acc: 0.496
Validation loss decreased (-0.473140 --> -0.496034).  Saving model ...
Epoch: 5 cost time: 22.91757082939148
Epoch: 5, Steps: 32 | Train Loss: 0.876 Vali Loss: 11.831 Vali Acc: 0.527 Test Loss: 11.831 Test Acc: 0.527
Validation loss decreased (-0.496034 --> -0.526599).  Saving model ...
Epoch: 6 cost time: 24.585744619369507
Epoch: 6, Steps: 32 | Train Loss: 2.003 Vali Loss: 30.058 Vali Acc: 0.489 Test Loss: 30.058 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 25.881587028503418
Epoch: 7, Steps: 32 | Train Loss: 2.308 Vali Loss: 20.797 Vali Acc: 0.519 Test Loss: 20.797 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 24.719914197921753
Epoch: 8, Steps: 32 | Train Loss: 1.356 Vali Loss: 17.446 Vali Acc: 0.496 Test Loss: 17.446 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 25.88022232055664
Epoch: 9, Steps: 32 | Train Loss: 1.125 Vali Loss: 38.650 Vali Acc: 0.542 Test Loss: 38.650 Test Acc: 0.542
Validation loss decreased (-0.526599 --> -0.541598).  Saving model ...
Epoch: 10 cost time: 23.758922815322876
Epoch: 10, Steps: 32 | Train Loss: 0.316 Vali Loss: 35.330 Vali Acc: 0.504 Test Loss: 35.330 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 24.19007182121277
Epoch: 11, Steps: 32 | Train Loss: 0.821 Vali Loss: 40.353 Vali Acc: 0.504 Test Loss: 40.353 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 26.555997848510742
Epoch: 12, Steps: 32 | Train Loss: 0.035 Vali Loss: 30.266 Vali Acc: 0.504 Test Loss: 30.266 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 28.62897539138794
Epoch: 13, Steps: 32 | Train Loss: 0.785 Vali Loss: 34.095 Vali Acc: 0.458 Test Loss: 34.095 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 27.848827123641968
Epoch: 14, Steps: 32 | Train Loss: 0.150 Vali Loss: 40.092 Vali Acc: 0.527 Test Loss: 40.092 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 22.980849027633667
Epoch: 15, Steps: 32 | Train Loss: 0.427 Vali Loss: 43.417 Vali Acc: 0.481 Test Loss: 43.417 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 21.658327102661133
Epoch: 16, Steps: 32 | Train Loss: 0.765 Vali Loss: 32.645 Vali Acc: 0.511 Test Loss: 32.645 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 23.75303030014038
Epoch: 17, Steps: 32 | Train Loss: 0.607 Vali Loss: 32.639 Vali Acc: 0.511 Test Loss: 32.639 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 22.10522437095642
Epoch: 18, Steps: 32 | Train Loss: 0.218 Vali Loss: 32.254 Vali Acc: 0.466 Test Loss: 32.254 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 23.014564275741577
Epoch: 19, Steps: 32 | Train Loss: 1.596 Vali Loss: 40.687 Vali Acc: 0.542 Test Loss: 40.687 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df512_ma540_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 3018853
model size : 15.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df512_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 28.5446994304657
Epoch: 1, Steps: 32 | Train Loss: 2.969 Vali Loss: 3.338 Vali Acc: 0.321 Test Loss: 3.338 Test Acc: 0.321
Validation loss decreased (inf --> -0.320577).  Saving model ...
Epoch: 2 cost time: 22.5514018535614
Epoch: 2, Steps: 32 | Train Loss: 2.114 Vali Loss: 6.922 Vali Acc: 0.466 Test Loss: 6.922 Test Acc: 0.466
Validation loss decreased (-0.320577 --> -0.465580).  Saving model ...
Epoch: 3 cost time: 25.246363401412964
Epoch: 3, Steps: 32 | Train Loss: 1.490 Vali Loss: 7.697 Vali Acc: 0.366 Test Loss: 7.697 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 24.910751581192017
Epoch: 4, Steps: 32 | Train Loss: 1.811 Vali Loss: 12.796 Vali Acc: 0.351 Test Loss: 12.796 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 23.301476001739502
Epoch: 5, Steps: 32 | Train Loss: 3.187 Vali Loss: 8.997 Vali Acc: 0.534 Test Loss: 8.997 Test Acc: 0.534
Validation loss decreased (-0.465580 --> -0.534261).  Saving model ...
Epoch: 6 cost time: 23.61399745941162
Epoch: 6, Steps: 32 | Train Loss: 2.224 Vali Loss: 29.524 Vali Acc: 0.504 Test Loss: 29.524 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 21.599074840545654
Epoch: 7, Steps: 32 | Train Loss: 1.112 Vali Loss: 28.454 Vali Acc: 0.496 Test Loss: 28.454 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 20.512226104736328
Epoch: 8, Steps: 32 | Train Loss: 0.206 Vali Loss: 26.433 Vali Acc: 0.443 Test Loss: 26.433 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 21.101593255996704
Epoch: 9, Steps: 32 | Train Loss: 0.203 Vali Loss: 34.135 Vali Acc: 0.466 Test Loss: 34.135 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 21.157716035842896
Epoch: 10, Steps: 32 | Train Loss: 1.729 Vali Loss: 21.333 Vali Acc: 0.450 Test Loss: 21.333 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 23.684016704559326
Epoch: 11, Steps: 32 | Train Loss: 0.975 Vali Loss: 59.974 Vali Acc: 0.496 Test Loss: 59.974 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 24.159156322479248
Epoch: 12, Steps: 32 | Train Loss: 2.151 Vali Loss: 36.119 Vali Acc: 0.443 Test Loss: 36.119 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 21.325677394866943
Epoch: 13, Steps: 32 | Train Loss: 1.231 Vali Loss: 44.397 Vali Acc: 0.489 Test Loss: 44.397 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 21.062793970108032
Epoch: 14, Steps: 32 | Train Loss: 0.506 Vali Loss: 74.607 Vali Acc: 0.473 Test Loss: 74.607 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 21.60452914237976
Epoch: 15, Steps: 32 | Train Loss: 1.540 Vali Loss: 64.457 Vali Acc: 0.504 Test Loss: 64.457 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df512_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 3018853
model size : 15.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df512_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 28.002769231796265
Epoch: 1, Steps: 32 | Train Loss: 3.284 Vali Loss: 2.316 Vali Acc: 0.450 Test Loss: 2.316 Test Acc: 0.450
Validation loss decreased (inf --> -0.450359).  Saving model ...
Epoch: 2 cost time: 24.04140329360962
Epoch: 2, Steps: 32 | Train Loss: 2.255 Vali Loss: 4.529 Vali Acc: 0.557 Test Loss: 4.529 Test Acc: 0.557
Validation loss decreased (-0.450359 --> -0.557207).  Saving model ...
Epoch: 3 cost time: 23.67165756225586
Epoch: 3, Steps: 32 | Train Loss: 2.076 Vali Loss: 9.829 Vali Acc: 0.420 Test Loss: 9.829 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 20.107539176940918
Epoch: 4, Steps: 32 | Train Loss: 3.169 Vali Loss: 11.836 Vali Acc: 0.519 Test Loss: 11.836 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 21.861656427383423
Epoch: 5, Steps: 32 | Train Loss: 1.534 Vali Loss: 5.520 Vali Acc: 0.519 Test Loss: 5.520 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 24.510868787765503
Epoch: 6, Steps: 32 | Train Loss: 0.116 Vali Loss: 14.671 Vali Acc: 0.550 Test Loss: 14.671 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 26.823075771331787
Epoch: 7, Steps: 32 | Train Loss: 0.113 Vali Loss: 11.680 Vali Acc: 0.511 Test Loss: 11.680 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 27.30692768096924
Epoch: 8, Steps: 32 | Train Loss: 0.439 Vali Loss: 9.424 Vali Acc: 0.534 Test Loss: 9.424 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 25.926483392715454
Epoch: 9, Steps: 32 | Train Loss: 0.648 Vali Loss: 19.339 Vali Acc: 0.481 Test Loss: 19.339 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 24.928040742874146
Epoch: 10, Steps: 32 | Train Loss: 4.772 Vali Loss: 23.967 Vali Acc: 0.496 Test Loss: 23.967 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 24.260316848754883
Epoch: 11, Steps: 32 | Train Loss: 2.058 Vali Loss: 27.240 Vali Acc: 0.496 Test Loss: 27.240 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 27.00388479232788
Epoch: 12, Steps: 32 | Train Loss: 1.163 Vali Loss: 23.910 Vali Acc: 0.573 Test Loss: 23.910 Test Acc: 0.573
Validation loss decreased (-0.557207 --> -0.572280).  Saving model ...
Epoch: 13 cost time: 27.40483593940735
Epoch: 13, Steps: 32 | Train Loss: 1.925 Vali Loss: 24.948 Vali Acc: 0.504 Test Loss: 24.948 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 22.992694854736328
Epoch: 14, Steps: 32 | Train Loss: 0.343 Vali Loss: 27.325 Vali Acc: 0.534 Test Loss: 27.325 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 24.457313776016235
Epoch: 15, Steps: 32 | Train Loss: 0.027 Vali Loss: 31.342 Vali Acc: 0.573 Test Loss: 31.342 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 21.336665630340576
Epoch: 16, Steps: 32 | Train Loss: 0.657 Vali Loss: 68.592 Vali Acc: 0.481 Test Loss: 68.592 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 23.48153853416443
Epoch: 17, Steps: 32 | Train Loss: 0.831 Vali Loss: 30.505 Vali Acc: 0.534 Test Loss: 30.505 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 26.07886028289795
Epoch: 18, Steps: 32 | Train Loss: 0.499 Vali Loss: 29.418 Vali Acc: 0.519 Test Loss: 29.418 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 26.37088179588318
Epoch: 19, Steps: 32 | Train Loss: 2.222 Vali Loss: 67.803 Vali Acc: 0.489 Test Loss: 67.803 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 24.975356101989746
Epoch: 20, Steps: 32 | Train Loss: 0.875 Vali Loss: 44.642 Vali Acc: 0.511 Test Loss: 44.642 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 24.217244625091553
Epoch: 21, Steps: 32 | Train Loss: 0.340 Vali Loss: 78.601 Vali Acc: 0.496 Test Loss: 78.601 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 22.099581718444824
Epoch: 22, Steps: 32 | Train Loss: 3.006 Vali Loss: 64.212 Vali Acc: 0.511 Test Loss: 64.212 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df512_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 3018853
model size : 15.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df512_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 30.43670916557312
Epoch: 1, Steps: 32 | Train Loss: 3.124 Vali Loss: 2.122 Vali Acc: 0.366 Test Loss: 2.122 Test Acc: 0.366
Validation loss decreased (inf --> -0.366391).  Saving model ...
Epoch: 2 cost time: 24.848012447357178
Epoch: 2, Steps: 32 | Train Loss: 1.230 Vali Loss: 2.116 Vali Acc: 0.519 Test Loss: 2.116 Test Acc: 0.519
Validation loss decreased (-0.366391 --> -0.519063).  Saving model ...
Epoch: 3 cost time: 24.482487440109253
Epoch: 3, Steps: 32 | Train Loss: 1.358 Vali Loss: 6.262 Vali Acc: 0.397 Test Loss: 6.262 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 22.676902294158936
Epoch: 4, Steps: 32 | Train Loss: 2.263 Vali Loss: 9.939 Vali Acc: 0.397 Test Loss: 9.939 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 26.534262895584106
Epoch: 5, Steps: 32 | Train Loss: 1.832 Vali Loss: 7.185 Vali Acc: 0.527 Test Loss: 7.185 Test Acc: 0.527
Validation loss decreased (-0.519063 --> -0.526646).  Saving model ...
Epoch: 6 cost time: 28.848778247833252
Epoch: 6, Steps: 32 | Train Loss: 0.765 Vali Loss: 12.412 Vali Acc: 0.542 Test Loss: 12.412 Test Acc: 0.542
Validation loss decreased (-0.526646 --> -0.541861).  Saving model ...
Epoch: 7 cost time: 25.42041325569153
Epoch: 7, Steps: 32 | Train Loss: 0.673 Vali Loss: 18.823 Vali Acc: 0.496 Test Loss: 18.823 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 24.800997018814087
Epoch: 8, Steps: 32 | Train Loss: 2.837 Vali Loss: 13.173 Vali Acc: 0.573 Test Loss: 13.173 Test Acc: 0.573
Validation loss decreased (-0.541861 --> -0.572387).  Saving model ...
Epoch: 9 cost time: 26.093329906463623
Epoch: 9, Steps: 32 | Train Loss: 0.466 Vali Loss: 24.392 Vali Acc: 0.489 Test Loss: 24.392 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 25.820470333099365
Epoch: 10, Steps: 32 | Train Loss: 0.210 Vali Loss: 29.449 Vali Acc: 0.504 Test Loss: 29.449 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 27.195463180541992
Epoch: 11, Steps: 32 | Train Loss: 0.854 Vali Loss: 17.256 Vali Acc: 0.588 Test Loss: 17.256 Test Acc: 0.588
Validation loss decreased (-0.572387 --> -0.587614).  Saving model ...
Epoch: 12 cost time: 24.208001613616943
Epoch: 12, Steps: 32 | Train Loss: 0.215 Vali Loss: 20.284 Vali Acc: 0.466 Test Loss: 20.284 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 22.284286499023438
Epoch: 13, Steps: 32 | Train Loss: 0.878 Vali Loss: 26.390 Vali Acc: 0.504 Test Loss: 26.390 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 22.76843571662903
Epoch: 14, Steps: 32 | Train Loss: 0.497 Vali Loss: 25.061 Vali Acc: 0.580 Test Loss: 25.061 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 24.142192125320435
Epoch: 15, Steps: 32 | Train Loss: 0.686 Vali Loss: 22.863 Vali Acc: 0.557 Test Loss: 22.863 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 23.773041486740112
Epoch: 16, Steps: 32 | Train Loss: 2.867 Vali Loss: 39.739 Vali Acc: 0.504 Test Loss: 39.739 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 25.07581377029419
Epoch: 17, Steps: 32 | Train Loss: 0.907 Vali Loss: 40.374 Vali Acc: 0.489 Test Loss: 40.374 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 24.41040015220642
Epoch: 18, Steps: 32 | Train Loss: 1.071 Vali Loss: 24.500 Vali Acc: 0.458 Test Loss: 24.500 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 25.204368591308594
Epoch: 19, Steps: 32 | Train Loss: 3.706 Vali Loss: 78.411 Vali Acc: 0.481 Test Loss: 78.411 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 22.142956733703613
Epoch: 20, Steps: 32 | Train Loss: 3.248 Vali Loss: 22.580 Vali Acc: 0.527 Test Loss: 22.580 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 23.6641206741333
Epoch: 21, Steps: 32 | Train Loss: 2.750 Vali Loss: 37.702 Vali Acc: 0.443 Test Loss: 37.702 Test Acc: 0.443
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df512_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 3018853
model size : 15.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         8992                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df256_ma8992_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 52.81947684288025
Epoch: 1, Steps: 32 | Train Loss: 2.728 Vali Loss: 3.475 Vali Acc: 0.412 Test Loss: 3.475 Test Acc: 0.412
Validation loss decreased (inf --> -0.412179).  Saving model ...
Epoch: 2 cost time: 51.852853298187256
Epoch: 2, Steps: 32 | Train Loss: 1.657 Vali Loss: 8.588 Vali Acc: 0.298 Test Loss: 8.588 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 54.20401072502136
Epoch: 3, Steps: 32 | Train Loss: 2.317 Vali Loss: 6.258 Vali Acc: 0.420 Test Loss: 6.258 Test Acc: 0.420
Validation loss decreased (-0.412179 --> -0.419785).  Saving model ...
Epoch: 4 cost time: 55.169169187545776
Epoch: 4, Steps: 32 | Train Loss: 1.761 Vali Loss: 13.128 Vali Acc: 0.450 Test Loss: 13.128 Test Acc: 0.450
Validation loss decreased (-0.419785 --> -0.450250).  Saving model ...
Epoch: 5 cost time: 58.511932373046875
Epoch: 5, Steps: 32 | Train Loss: 2.256 Vali Loss: 25.652 Vali Acc: 0.496 Test Loss: 25.652 Test Acc: 0.496
Validation loss decreased (-0.450250 --> -0.495927).  Saving model ...
Epoch: 6 cost time: 61.483320236206055
Epoch: 6, Steps: 32 | Train Loss: 2.520 Vali Loss: 24.480 Vali Acc: 0.511 Test Loss: 24.480 Test Acc: 0.511
Validation loss decreased (-0.495927 --> -0.511206).  Saving model ...
Epoch: 7 cost time: 65.37297987937927
Epoch: 7, Steps: 32 | Train Loss: 1.049 Vali Loss: 21.666 Vali Acc: 0.382 Test Loss: 21.666 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 67.2251136302948
Epoch: 8, Steps: 32 | Train Loss: 0.636 Vali Loss: 23.682 Vali Acc: 0.573 Test Loss: 23.682 Test Acc: 0.573
Validation loss decreased (-0.511206 --> -0.572282).  Saving model ...
Epoch: 9 cost time: 66.44495987892151
Epoch: 9, Steps: 32 | Train Loss: 0.869 Vali Loss: 39.611 Vali Acc: 0.534 Test Loss: 39.611 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 66.33972978591919
Epoch: 10, Steps: 32 | Train Loss: 2.336 Vali Loss: 25.215 Vali Acc: 0.473 Test Loss: 25.215 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 68.22452974319458
Epoch: 11, Steps: 32 | Train Loss: 2.358 Vali Loss: 36.455 Vali Acc: 0.557 Test Loss: 36.455 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 70.2388014793396
Epoch: 12, Steps: 32 | Train Loss: 0.851 Vali Loss: 61.861 Vali Acc: 0.435 Test Loss: 61.861 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 68.87797355651855
Epoch: 13, Steps: 32 | Train Loss: 1.778 Vali Loss: 35.994 Vali Acc: 0.534 Test Loss: 35.994 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 70.2720890045166
Epoch: 14, Steps: 32 | Train Loss: 0.269 Vali Loss: 57.931 Vali Acc: 0.504 Test Loss: 57.931 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 73.63888835906982
Epoch: 15, Steps: 32 | Train Loss: 0.188 Vali Loss: 60.393 Vali Acc: 0.511 Test Loss: 60.393 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 73.08635997772217
Epoch: 16, Steps: 32 | Train Loss: 0.049 Vali Loss: 49.060 Vali Acc: 0.534 Test Loss: 49.060 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 69.21632075309753
Epoch: 17, Steps: 32 | Train Loss: 0.491 Vali Loss: 42.889 Vali Acc: 0.519 Test Loss: 42.889 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 71.88273739814758
Epoch: 18, Steps: 32 | Train Loss: 0.496 Vali Loss: 47.228 Vali Acc: 0.504 Test Loss: 47.228 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df256_ma8992_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 2969701
model size : 15.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         7194                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df256_ma7194_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 44.01824688911438
Epoch: 1, Steps: 32 | Train Loss: 2.786 Vali Loss: 4.700 Vali Acc: 0.481 Test Loss: 4.700 Test Acc: 0.481
Validation loss decreased (inf --> -0.480869).  Saving model ...
Epoch: 2 cost time: 43.47967290878296
Epoch: 2, Steps: 32 | Train Loss: 1.869 Vali Loss: 7.311 Vali Acc: 0.382 Test Loss: 7.311 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 42.36706805229187
Epoch: 3, Steps: 32 | Train Loss: 1.977 Vali Loss: 10.006 Vali Acc: 0.359 Test Loss: 10.006 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 42.89180254936218
Epoch: 4, Steps: 32 | Train Loss: 4.466 Vali Loss: 18.095 Vali Acc: 0.252 Test Loss: 18.095 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 53.390953540802
Epoch: 5, Steps: 32 | Train Loss: 1.027 Vali Loss: 15.516 Vali Acc: 0.374 Test Loss: 15.516 Test Acc: 0.374
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 52.602715492248535
Epoch: 6, Steps: 32 | Train Loss: 2.531 Vali Loss: 22.769 Vali Acc: 0.565 Test Loss: 22.769 Test Acc: 0.565
Validation loss decreased (-0.480869 --> -0.564658).  Saving model ...
Epoch: 7 cost time: 58.6630117893219
Epoch: 7, Steps: 32 | Train Loss: 1.093 Vali Loss: 35.785 Vali Acc: 0.511 Test Loss: 35.785 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 55.474074840545654
Epoch: 8, Steps: 32 | Train Loss: 2.892 Vali Loss: 58.219 Vali Acc: 0.237 Test Loss: 58.219 Test Acc: 0.237
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 54.00206637382507
Epoch: 9, Steps: 32 | Train Loss: 3.908 Vali Loss: 30.775 Vali Acc: 0.580 Test Loss: 30.775 Test Acc: 0.580
Validation loss decreased (-0.564658 --> -0.579845).  Saving model ...
Epoch: 10 cost time: 54.89113092422485
Epoch: 10, Steps: 32 | Train Loss: 3.206 Vali Loss: 31.821 Vali Acc: 0.466 Test Loss: 31.821 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 55.505884408950806
Epoch: 11, Steps: 32 | Train Loss: 5.397 Vali Loss: 27.965 Vali Acc: 0.511 Test Loss: 27.965 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 58.57698082923889
Epoch: 12, Steps: 32 | Train Loss: 0.993 Vali Loss: 44.830 Vali Acc: 0.565 Test Loss: 44.830 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 59.11628246307373
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 30.401 Vali Acc: 0.588 Test Loss: 30.401 Test Acc: 0.588
Validation loss decreased (-0.579845 --> -0.587482).  Saving model ...
Epoch: 14 cost time: 58.72429895401001
Epoch: 14, Steps: 32 | Train Loss: 0.382 Vali Loss: 47.496 Vali Acc: 0.542 Test Loss: 47.496 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 60.54886603355408
Epoch: 15, Steps: 32 | Train Loss: 0.254 Vali Loss: 31.235 Vali Acc: 0.603 Test Loss: 31.235 Test Acc: 0.603
Validation loss decreased (-0.587482 --> -0.602741).  Saving model ...
Epoch: 16 cost time: 58.92089915275574
Epoch: 16, Steps: 32 | Train Loss: 0.255 Vali Loss: 26.318 Vali Acc: 0.557 Test Loss: 26.318 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 57.59778618812561
Epoch: 17, Steps: 32 | Train Loss: 0.186 Vali Loss: 32.220 Vali Acc: 0.618 Test Loss: 32.220 Test Acc: 0.618
Validation loss decreased (-0.602741 --> -0.617998).  Saving model ...
Epoch: 18 cost time: 59.320168018341064
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 25.908 Vali Acc: 0.542 Test Loss: 25.908 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 56.94306778907776
Epoch: 19, Steps: 32 | Train Loss: 0.269 Vali Loss: 26.886 Vali Acc: 0.573 Test Loss: 26.886 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 57.70027780532837
Epoch: 20, Steps: 32 | Train Loss: 0.233 Vali Loss: 47.990 Vali Acc: 0.595 Test Loss: 47.990 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 60.91826820373535
Epoch: 21, Steps: 32 | Train Loss: 0.388 Vali Loss: 26.875 Vali Acc: 0.519 Test Loss: 26.875 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 57.92673897743225
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 57.681 Vali Acc: 0.298 Test Loss: 57.681 Test Acc: 0.298
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 58.55987524986267
Epoch: 23, Steps: 32 | Train Loss: 0.762 Vali Loss: 67.165 Vali Acc: 0.275 Test Loss: 67.165 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 58.07904672622681
Epoch: 24, Steps: 32 | Train Loss: 0.223 Vali Loss: 51.372 Vali Acc: 0.542 Test Loss: 51.372 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 56.045814037323
Epoch: 25, Steps: 32 | Train Loss: 3.032 Vali Loss: 38.802 Vali Acc: 0.473 Test Loss: 38.802 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 55.53202772140503
Epoch: 26, Steps: 32 | Train Loss: 3.053 Vali Loss: 44.007 Vali Acc: 0.489 Test Loss: 44.007 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 57.16530752182007
Epoch: 27, Steps: 32 | Train Loss: 1.185 Vali Loss: 69.694 Vali Acc: 0.550 Test Loss: 69.694 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df256_ma7194_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6183206106870229
model parameter : 2969701
model size : 15.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         5396                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df256_ma5396_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 39.07444500923157
Epoch: 1, Steps: 32 | Train Loss: 2.771 Vali Loss: 5.356 Vali Acc: 0.450 Test Loss: 5.356 Test Acc: 0.450
Validation loss decreased (inf --> -0.450328).  Saving model ...
Epoch: 2 cost time: 35.20836782455444
Epoch: 2, Steps: 32 | Train Loss: 1.954 Vali Loss: 7.685 Vali Acc: 0.382 Test Loss: 7.685 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 35.416115283966064
Epoch: 3, Steps: 32 | Train Loss: 3.062 Vali Loss: 10.152 Vali Acc: 0.481 Test Loss: 10.152 Test Acc: 0.481
Validation loss decreased (-0.450328 --> -0.480815).  Saving model ...
Epoch: 4 cost time: 41.385075092315674
Epoch: 4, Steps: 32 | Train Loss: 4.657 Vali Loss: 11.687 Vali Acc: 0.534 Test Loss: 11.687 Test Acc: 0.534
Validation loss decreased (-0.480815 --> -0.534234).  Saving model ...
Epoch: 5 cost time: 44.86387348175049
Epoch: 5, Steps: 32 | Train Loss: 1.324 Vali Loss: 20.562 Vali Acc: 0.504 Test Loss: 20.562 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 44.09926915168762
Epoch: 6, Steps: 32 | Train Loss: 1.108 Vali Loss: 16.880 Vali Acc: 0.427 Test Loss: 16.880 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 44.49619793891907
Epoch: 7, Steps: 32 | Train Loss: 0.358 Vali Loss: 16.744 Vali Acc: 0.473 Test Loss: 16.744 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 44.65546989440918
Epoch: 8, Steps: 32 | Train Loss: 0.346 Vali Loss: 22.483 Vali Acc: 0.260 Test Loss: 22.483 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 46.87128758430481
Epoch: 9, Steps: 32 | Train Loss: 0.459 Vali Loss: 37.033 Vali Acc: 0.504 Test Loss: 37.033 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 45.17648720741272
Epoch: 10, Steps: 32 | Train Loss: 2.565 Vali Loss: 29.931 Vali Acc: 0.282 Test Loss: 29.931 Test Acc: 0.282
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 47.573596477508545
Epoch: 11, Steps: 32 | Train Loss: 4.393 Vali Loss: 32.462 Vali Acc: 0.504 Test Loss: 32.462 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 46.933627128601074
Epoch: 12, Steps: 32 | Train Loss: 2.302 Vali Loss: 33.330 Vali Acc: 0.504 Test Loss: 33.330 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 49.02931761741638
Epoch: 13, Steps: 32 | Train Loss: 1.070 Vali Loss: 39.084 Vali Acc: 0.420 Test Loss: 39.084 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 47.32127857208252
Epoch: 14, Steps: 32 | Train Loss: 0.586 Vali Loss: 48.708 Vali Acc: 0.374 Test Loss: 48.708 Test Acc: 0.374
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df256_ma5396_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 2969701
model size : 15.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         3597                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df256_ma3597_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 34.87493920326233
Epoch: 1, Steps: 32 | Train Loss: 2.775 Vali Loss: 5.137 Vali Acc: 0.504 Test Loss: 5.137 Test Acc: 0.504
Validation loss decreased (inf --> -0.503765).  Saving model ...
Epoch: 2 cost time: 32.0128915309906
Epoch: 2, Steps: 32 | Train Loss: 1.966 Vali Loss: 7.753 Vali Acc: 0.481 Test Loss: 7.753 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 29.643553495407104
Epoch: 3, Steps: 32 | Train Loss: 2.064 Vali Loss: 10.575 Vali Acc: 0.366 Test Loss: 10.575 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 29.85199999809265
Epoch: 4, Steps: 32 | Train Loss: 1.078 Vali Loss: 14.953 Vali Acc: 0.275 Test Loss: 14.953 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 31.750385522842407
Epoch: 5, Steps: 32 | Train Loss: 1.584 Vali Loss: 8.972 Vali Acc: 0.527 Test Loss: 8.972 Test Acc: 0.527
Validation loss decreased (-0.503765 --> -0.526628).  Saving model ...
Epoch: 6 cost time: 32.347084283828735
Epoch: 6, Steps: 32 | Train Loss: 0.428 Vali Loss: 9.906 Vali Acc: 0.565 Test Loss: 9.906 Test Acc: 0.565
Validation loss decreased (-0.526628 --> -0.564786).  Saving model ...
Epoch: 7 cost time: 34.478026390075684
Epoch: 7, Steps: 32 | Train Loss: 0.365 Vali Loss: 17.944 Vali Acc: 0.473 Test Loss: 17.944 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 34.75007653236389
Epoch: 8, Steps: 32 | Train Loss: 0.961 Vali Loss: 21.346 Vali Acc: 0.519 Test Loss: 21.346 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 35.92202687263489
Epoch: 9, Steps: 32 | Train Loss: 1.790 Vali Loss: 28.215 Vali Acc: 0.420 Test Loss: 28.215 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 37.38513660430908
Epoch: 10, Steps: 32 | Train Loss: 1.344 Vali Loss: 22.511 Vali Acc: 0.344 Test Loss: 22.511 Test Acc: 0.344
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 35.88145637512207
Epoch: 11, Steps: 32 | Train Loss: 4.228 Vali Loss: 50.454 Vali Acc: 0.527 Test Loss: 50.454 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 38.69317555427551
Epoch: 12, Steps: 32 | Train Loss: 2.009 Vali Loss: 28.060 Vali Acc: 0.458 Test Loss: 28.060 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 36.59662413597107
Epoch: 13, Steps: 32 | Train Loss: 0.324 Vali Loss: 40.856 Vali Acc: 0.504 Test Loss: 40.856 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 37.926960468292236
Epoch: 14, Steps: 32 | Train Loss: 2.781 Vali Loss: 38.745 Vali Acc: 0.550 Test Loss: 38.745 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 39.463337659835815
Epoch: 15, Steps: 32 | Train Loss: 0.082 Vali Loss: 55.610 Vali Acc: 0.519 Test Loss: 55.610 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 39.489508867263794
Epoch: 16, Steps: 32 | Train Loss: 0.132 Vali Loss: 37.869 Vali Acc: 0.550 Test Loss: 37.869 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df256_ma3597_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 2969701
model size : 15.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         1799                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df256_ma1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 25.914655208587646
Epoch: 1, Steps: 32 | Train Loss: 2.648 Vali Loss: 3.554 Vali Acc: 0.252 Test Loss: 3.554 Test Acc: 0.252
Validation loss decreased (inf --> -0.251873).  Saving model ...
Epoch: 2 cost time: 21.813571453094482
Epoch: 2, Steps: 32 | Train Loss: 1.416 Vali Loss: 5.471 Vali Acc: 0.382 Test Loss: 5.471 Test Acc: 0.382
Validation loss decreased (-0.251873 --> -0.381625).  Saving model ...
Epoch: 3 cost time: 21.04999852180481
Epoch: 3, Steps: 32 | Train Loss: 1.973 Vali Loss: 10.712 Vali Acc: 0.534 Test Loss: 10.712 Test Acc: 0.534
Validation loss decreased (-0.381625 --> -0.534244).  Saving model ...
Epoch: 4 cost time: 22.446208238601685
Epoch: 4, Steps: 32 | Train Loss: 2.112 Vali Loss: 11.555 Vali Acc: 0.527 Test Loss: 11.555 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 22.689935207366943
Epoch: 5, Steps: 32 | Train Loss: 2.008 Vali Loss: 13.297 Vali Acc: 0.496 Test Loss: 13.297 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 27.962160110473633
Epoch: 6, Steps: 32 | Train Loss: 0.213 Vali Loss: 13.137 Vali Acc: 0.420 Test Loss: 13.137 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 26.27892017364502
Epoch: 7, Steps: 32 | Train Loss: 0.057 Vali Loss: 17.717 Vali Acc: 0.504 Test Loss: 17.717 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 26.12397599220276
Epoch: 8, Steps: 32 | Train Loss: 0.672 Vali Loss: 19.679 Vali Acc: 0.527 Test Loss: 19.679 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 23.892038583755493
Epoch: 9, Steps: 32 | Train Loss: 0.031 Vali Loss: 18.610 Vali Acc: 0.496 Test Loss: 18.610 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 23.52447271347046
Epoch: 10, Steps: 32 | Train Loss: 1.716 Vali Loss: 32.113 Vali Acc: 0.511 Test Loss: 32.113 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 26.482620239257812
Epoch: 11, Steps: 32 | Train Loss: 4.362 Vali Loss: 30.173 Vali Acc: 0.435 Test Loss: 30.173 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 25.645353317260742
Epoch: 12, Steps: 32 | Train Loss: 8.227 Vali Loss: 40.108 Vali Acc: 0.527 Test Loss: 40.108 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 28.167146921157837
Epoch: 13, Steps: 32 | Train Loss: 0.737 Vali Loss: 47.514 Vali Acc: 0.504 Test Loss: 47.514 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df256_ma1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 2969701
model size : 15.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df256_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 27.233002185821533
Epoch: 1, Steps: 32 | Train Loss: 2.566 Vali Loss: 4.160 Vali Acc: 0.534 Test Loss: 4.160 Test Acc: 0.534
Validation loss decreased (inf --> -0.534310).  Saving model ...
Epoch: 2 cost time: 24.720699071884155
Epoch: 2, Steps: 32 | Train Loss: 3.415 Vali Loss: 4.091 Vali Acc: 0.481 Test Loss: 4.091 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 25.263237953186035
Epoch: 3, Steps: 32 | Train Loss: 2.091 Vali Loss: 5.634 Vali Acc: 0.542 Test Loss: 5.634 Test Acc: 0.542
Validation loss decreased (-0.534310 --> -0.541928).  Saving model ...
Epoch: 4 cost time: 24.85181736946106
Epoch: 4, Steps: 32 | Train Loss: 1.366 Vali Loss: 10.581 Vali Acc: 0.366 Test Loss: 10.581 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 23.138612747192383
Epoch: 5, Steps: 32 | Train Loss: 1.210 Vali Loss: 10.793 Vali Acc: 0.511 Test Loss: 10.793 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 23.471699237823486
Epoch: 6, Steps: 32 | Train Loss: 1.418 Vali Loss: 25.039 Vali Acc: 0.519 Test Loss: 25.039 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 23.145885944366455
Epoch: 7, Steps: 32 | Train Loss: 1.125 Vali Loss: 27.490 Vali Acc: 0.527 Test Loss: 27.490 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 25.44030237197876
Epoch: 8, Steps: 32 | Train Loss: 5.947 Vali Loss: 37.586 Vali Acc: 0.542 Test Loss: 37.586 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 24.55558753013611
Epoch: 9, Steps: 32 | Train Loss: 0.707 Vali Loss: 46.628 Vali Acc: 0.496 Test Loss: 46.628 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 24.245420932769775
Epoch: 10, Steps: 32 | Train Loss: 2.490 Vali Loss: 38.264 Vali Acc: 0.366 Test Loss: 38.264 Test Acc: 0.366
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 25.536879062652588
Epoch: 11, Steps: 32 | Train Loss: 1.231 Vali Loss: 33.011 Vali Acc: 0.557 Test Loss: 33.011 Test Acc: 0.557
Validation loss decreased (-0.541928 --> -0.556922).  Saving model ...
Epoch: 12 cost time: 23.813779830932617
Epoch: 12, Steps: 32 | Train Loss: 0.675 Vali Loss: 53.369 Vali Acc: 0.527 Test Loss: 53.369 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 24.450964212417603
Epoch: 13, Steps: 32 | Train Loss: 0.495 Vali Loss: 47.018 Vali Acc: 0.565 Test Loss: 47.018 Test Acc: 0.565
Validation loss decreased (-0.556922 --> -0.564415).  Saving model ...
Epoch: 14 cost time: 22.60033369064331
Epoch: 14, Steps: 32 | Train Loss: 1.158 Vali Loss: 41.843 Vali Acc: 0.489 Test Loss: 41.843 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 23.153335332870483
Epoch: 15, Steps: 32 | Train Loss: 0.613 Vali Loss: 38.758 Vali Acc: 0.519 Test Loss: 38.758 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 24.164175748825073
Epoch: 16, Steps: 32 | Train Loss: 0.229 Vali Loss: 49.092 Vali Acc: 0.435 Test Loss: 49.092 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 25.085615396499634
Epoch: 17, Steps: 32 | Train Loss: 0.688 Vali Loss: 41.577 Vali Acc: 0.435 Test Loss: 41.577 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 25.712284088134766
Epoch: 18, Steps: 32 | Train Loss: 0.328 Vali Loss: 33.447 Vali Acc: 0.527 Test Loss: 33.447 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 24.138421773910522
Epoch: 19, Steps: 32 | Train Loss: 0.501 Vali Loss: 40.138 Vali Acc: 0.458 Test Loss: 40.138 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 24.02130913734436
Epoch: 20, Steps: 32 | Train Loss: 0.181 Vali Loss: 71.304 Vali Acc: 0.534 Test Loss: 71.304 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 28.10346293449402
Epoch: 21, Steps: 32 | Train Loss: 1.239 Vali Loss: 59.764 Vali Acc: 0.542 Test Loss: 59.764 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 27.263846397399902
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 58.647 Vali Acc: 0.534 Test Loss: 58.647 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 27.48890709877014
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 58.732 Vali Acc: 0.534 Test Loss: 58.732 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df256_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 2969701
model size : 15.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         540                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df256_ma540_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 24.270768880844116
Epoch: 1, Steps: 32 | Train Loss: 2.808 Vali Loss: 2.173 Vali Acc: 0.473 Test Loss: 2.173 Test Acc: 0.473
Validation loss decreased (inf --> -0.473261).  Saving model ...
Epoch: 2 cost time: 22.884393215179443
Epoch: 2, Steps: 32 | Train Loss: 3.154 Vali Loss: 4.693 Vali Acc: 0.397 Test Loss: 4.693 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 20.711094617843628
Epoch: 3, Steps: 32 | Train Loss: 2.263 Vali Loss: 6.547 Vali Acc: 0.496 Test Loss: 6.547 Test Acc: 0.496
Validation loss decreased (-0.473261 --> -0.496118).  Saving model ...
Epoch: 4 cost time: 22.283453464508057
Epoch: 4, Steps: 32 | Train Loss: 1.324 Vali Loss: 9.912 Vali Acc: 0.420 Test Loss: 9.912 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 20.5771324634552
Epoch: 5, Steps: 32 | Train Loss: 1.739 Vali Loss: 32.285 Vali Acc: 0.450 Test Loss: 32.285 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 21.28004264831543
Epoch: 6, Steps: 32 | Train Loss: 1.805 Vali Loss: 20.632 Vali Acc: 0.496 Test Loss: 20.632 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 19.976145267486572
Epoch: 7, Steps: 32 | Train Loss: 1.260 Vali Loss: 25.771 Vali Acc: 0.504 Test Loss: 25.771 Test Acc: 0.504
Validation loss decreased (-0.496118 --> -0.503559).  Saving model ...
Epoch: 8 cost time: 19.932334899902344
Epoch: 8, Steps: 32 | Train Loss: 0.772 Vali Loss: 35.842 Vali Acc: 0.473 Test Loss: 35.842 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 21.31738257408142
Epoch: 9, Steps: 32 | Train Loss: 0.409 Vali Loss: 34.372 Vali Acc: 0.511 Test Loss: 34.372 Test Acc: 0.511
Validation loss decreased (-0.503559 --> -0.511107).  Saving model ...
Epoch: 10 cost time: 20.356038331985474
Epoch: 10, Steps: 32 | Train Loss: 1.631 Vali Loss: 24.531 Vali Acc: 0.359 Test Loss: 24.531 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 17.768137454986572
Epoch: 11, Steps: 32 | Train Loss: 1.839 Vali Loss: 50.601 Vali Acc: 0.496 Test Loss: 50.601 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 19.680073976516724
Epoch: 12, Steps: 32 | Train Loss: 2.473 Vali Loss: 40.245 Vali Acc: 0.466 Test Loss: 40.245 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 19.900404453277588
Epoch: 13, Steps: 32 | Train Loss: 1.465 Vali Loss: 37.878 Vali Acc: 0.473 Test Loss: 37.878 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 20.869226694107056
Epoch: 14, Steps: 32 | Train Loss: 0.907 Vali Loss: 29.400 Vali Acc: 0.489 Test Loss: 29.400 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 22.847935438156128
Epoch: 15, Steps: 32 | Train Loss: 0.348 Vali Loss: 51.038 Vali Acc: 0.504 Test Loss: 51.038 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 22.643760204315186
Epoch: 16, Steps: 32 | Train Loss: 0.443 Vali Loss: 75.342 Vali Acc: 0.519 Test Loss: 75.342 Test Acc: 0.519
Validation loss decreased (-0.511107 --> -0.518331).  Saving model ...
Epoch: 17 cost time: 21.322689533233643
Epoch: 17, Steps: 32 | Train Loss: 0.182 Vali Loss: 39.417 Vali Acc: 0.359 Test Loss: 39.417 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 19.442660808563232
Epoch: 18, Steps: 32 | Train Loss: 0.020 Vali Loss: 58.543 Vali Acc: 0.511 Test Loss: 58.543 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 19.635190963745117
Epoch: 19, Steps: 32 | Train Loss: 0.092 Vali Loss: 70.434 Vali Acc: 0.504 Test Loss: 70.434 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 19.39585018157959
Epoch: 20, Steps: 32 | Train Loss: 0.306 Vali Loss: 39.617 Vali Acc: 0.366 Test Loss: 39.617 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 20.34718656539917
Epoch: 21, Steps: 32 | Train Loss: 0.434 Vali Loss: 75.122 Vali Acc: 0.496 Test Loss: 75.122 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 21.860135316848755
Epoch: 22, Steps: 32 | Train Loss: 0.453 Vali Loss: 80.278 Vali Acc: 0.466 Test Loss: 80.278 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 21.91819190979004
Epoch: 23, Steps: 32 | Train Loss: 1.822 Vali Loss: 73.633 Vali Acc: 0.466 Test Loss: 73.633 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 20.70238161087036
Epoch: 24, Steps: 32 | Train Loss: 2.133 Vali Loss: 70.061 Vali Acc: 0.450 Test Loss: 70.061 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 20.035805702209473
Epoch: 25, Steps: 32 | Train Loss: 0.447 Vali Loss: 51.739 Vali Acc: 0.389 Test Loss: 51.739 Test Acc: 0.389
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 19.39665412902832
Epoch: 26, Steps: 32 | Train Loss: 1.239 Vali Loss: 111.582 Vali Acc: 0.504 Test Loss: 111.582 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df256_ma540_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 2969701
model size : 15.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df256_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 27.86757755279541
Epoch: 1, Steps: 32 | Train Loss: 2.719 Vali Loss: 3.862 Vali Acc: 0.473 Test Loss: 3.862 Test Acc: 0.473
Validation loss decreased (inf --> -0.473244).  Saving model ...
Epoch: 2 cost time: 23.832552671432495
Epoch: 2, Steps: 32 | Train Loss: 1.733 Vali Loss: 4.728 Vali Acc: 0.466 Test Loss: 4.728 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 24.205528736114502
Epoch: 3, Steps: 32 | Train Loss: 1.033 Vali Loss: 10.278 Vali Acc: 0.489 Test Loss: 10.278 Test Acc: 0.489
Validation loss decreased (-0.473244 --> -0.488447).  Saving model ...
Epoch: 4 cost time: 24.12199091911316
Epoch: 4, Steps: 32 | Train Loss: 2.210 Vali Loss: 10.567 Vali Acc: 0.481 Test Loss: 10.567 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 25.104469299316406
Epoch: 5, Steps: 32 | Train Loss: 2.361 Vali Loss: 11.594 Vali Acc: 0.450 Test Loss: 11.594 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 28.68536949157715
Epoch: 6, Steps: 32 | Train Loss: 1.231 Vali Loss: 22.457 Vali Acc: 0.504 Test Loss: 22.457 Test Acc: 0.504
Validation loss decreased (-0.488447 --> -0.503592).  Saving model ...
Epoch: 7 cost time: 26.28486132621765
Epoch: 7, Steps: 32 | Train Loss: 2.663 Vali Loss: 17.269 Vali Acc: 0.534 Test Loss: 17.269 Test Acc: 0.534
Validation loss decreased (-0.503592 --> -0.534178).  Saving model ...
Epoch: 8 cost time: 26.055569887161255
Epoch: 8, Steps: 32 | Train Loss: 1.101 Vali Loss: 17.769 Vali Acc: 0.489 Test Loss: 17.769 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 25.388447761535645
Epoch: 9, Steps: 32 | Train Loss: 0.562 Vali Loss: 40.291 Vali Acc: 0.481 Test Loss: 40.291 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 24.77296471595764
Epoch: 10, Steps: 32 | Train Loss: 3.576 Vali Loss: 31.182 Vali Acc: 0.481 Test Loss: 31.182 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 27.896931886672974
Epoch: 11, Steps: 32 | Train Loss: 1.202 Vali Loss: 39.026 Vali Acc: 0.473 Test Loss: 39.026 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 24.348506450653076
Epoch: 12, Steps: 32 | Train Loss: 1.741 Vali Loss: 42.835 Vali Acc: 0.489 Test Loss: 42.835 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 27.199023485183716
Epoch: 13, Steps: 32 | Train Loss: 0.380 Vali Loss: 61.221 Vali Acc: 0.496 Test Loss: 61.221 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 26.877907514572144
Epoch: 14, Steps: 32 | Train Loss: 0.004 Vali Loss: 25.809 Vali Acc: 0.504 Test Loss: 25.809 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 23.485607385635376
Epoch: 15, Steps: 32 | Train Loss: 0.075 Vali Loss: 48.842 Vali Acc: 0.504 Test Loss: 48.842 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 25.45298147201538
Epoch: 16, Steps: 32 | Train Loss: 0.114 Vali Loss: 25.654 Vali Acc: 0.527 Test Loss: 25.654 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 24.696428060531616
Epoch: 17, Steps: 32 | Train Loss: 0.152 Vali Loss: 45.268 Vali Acc: 0.511 Test Loss: 45.268 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df256_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 2969701
model size : 15.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df256_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 25.09231162071228
Epoch: 1, Steps: 32 | Train Loss: 2.727 Vali Loss: 4.617 Vali Acc: 0.458 Test Loss: 4.617 Test Acc: 0.458
Validation loss decreased (inf --> -0.457969).  Saving model ...
Epoch: 2 cost time: 22.871765613555908
Epoch: 2, Steps: 32 | Train Loss: 2.112 Vali Loss: 7.863 Vali Acc: 0.466 Test Loss: 7.863 Test Acc: 0.466
Validation loss decreased (-0.457969 --> -0.465570).  Saving model ...
Epoch: 3 cost time: 22.7377610206604
Epoch: 3, Steps: 32 | Train Loss: 1.714 Vali Loss: 5.062 Vali Acc: 0.550 Test Loss: 5.062 Test Acc: 0.550
Validation loss decreased (-0.465570 --> -0.549568).  Saving model ...
Epoch: 4 cost time: 26.77387809753418
Epoch: 4, Steps: 32 | Train Loss: 1.621 Vali Loss: 7.308 Vali Acc: 0.534 Test Loss: 7.308 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 25.104564428329468
Epoch: 5, Steps: 32 | Train Loss: 1.287 Vali Loss: 12.075 Vali Acc: 0.511 Test Loss: 12.075 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 26.011053562164307
Epoch: 6, Steps: 32 | Train Loss: 0.486 Vali Loss: 8.819 Vali Acc: 0.573 Test Loss: 8.819 Test Acc: 0.573
Validation loss decreased (-0.549568 --> -0.572431).  Saving model ...
Epoch: 7 cost time: 21.138205766677856
Epoch: 7, Steps: 32 | Train Loss: 0.257 Vali Loss: 12.539 Vali Acc: 0.527 Test Loss: 12.539 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 21.6570463180542
Epoch: 8, Steps: 32 | Train Loss: 0.295 Vali Loss: 7.369 Vali Acc: 0.565 Test Loss: 7.369 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 24.62154221534729
Epoch: 9, Steps: 32 | Train Loss: 0.346 Vali Loss: 18.688 Vali Acc: 0.542 Test Loss: 18.688 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 23.9866464138031
Epoch: 10, Steps: 32 | Train Loss: 1.530 Vali Loss: 16.554 Vali Acc: 0.481 Test Loss: 16.554 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 25.188093662261963
Epoch: 11, Steps: 32 | Train Loss: 2.132 Vali Loss: 20.921 Vali Acc: 0.565 Test Loss: 20.921 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 24.231106281280518
Epoch: 12, Steps: 32 | Train Loss: 1.690 Vali Loss: 32.284 Vali Acc: 0.527 Test Loss: 32.284 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 22.92670464515686
Epoch: 13, Steps: 32 | Train Loss: 0.694 Vali Loss: 28.389 Vali Acc: 0.557 Test Loss: 28.389 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 23.367809295654297
Epoch: 14, Steps: 32 | Train Loss: 0.233 Vali Loss: 33.250 Vali Acc: 0.534 Test Loss: 33.250 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 24.552211046218872
Epoch: 15, Steps: 32 | Train Loss: 1.375 Vali Loss: 22.974 Vali Acc: 0.580 Test Loss: 22.974 Test Acc: 0.580
Validation loss decreased (-0.572431 --> -0.579923).  Saving model ...
Epoch: 16 cost time: 23.30502414703369
Epoch: 16, Steps: 32 | Train Loss: 0.972 Vali Loss: 34.046 Vali Acc: 0.527 Test Loss: 34.046 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 27.936087608337402
Epoch: 17, Steps: 32 | Train Loss: 0.926 Vali Loss: 52.425 Vali Acc: 0.511 Test Loss: 52.425 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 22.23264479637146
Epoch: 18, Steps: 32 | Train Loss: 0.580 Vali Loss: 44.205 Vali Acc: 0.534 Test Loss: 44.205 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 20.377928018569946
Epoch: 19, Steps: 32 | Train Loss: 3.747 Vali Loss: 43.441 Vali Acc: 0.519 Test Loss: 43.441 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 24.880743503570557
Epoch: 20, Steps: 32 | Train Loss: 1.408 Vali Loss: 53.260 Vali Acc: 0.511 Test Loss: 53.260 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 24.746556758880615
Epoch: 21, Steps: 32 | Train Loss: 0.003 Vali Loss: 42.671 Vali Acc: 0.504 Test Loss: 42.671 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 27.757754802703857
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 43.375 Vali Acc: 0.511 Test Loss: 43.375 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 22.339402675628662
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 43.401 Vali Acc: 0.511 Test Loss: 43.401 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 23.821187496185303
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 43.402 Vali Acc: 0.511 Test Loss: 43.402 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 26.425130605697632
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 43.402 Vali Acc: 0.511 Test Loss: 43.402 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df256_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 2969701
model size : 15.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df256_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 22.512545824050903
Epoch: 1, Steps: 32 | Train Loss: 2.475 Vali Loss: 3.288 Vali Acc: 0.473 Test Loss: 3.288 Test Acc: 0.473
Validation loss decreased (inf --> -0.473250).  Saving model ...
Epoch: 2 cost time: 19.06701397895813
Epoch: 2, Steps: 32 | Train Loss: 1.585 Vali Loss: 4.974 Vali Acc: 0.496 Test Loss: 4.974 Test Acc: 0.496
Validation loss decreased (-0.473250 --> -0.496133).  Saving model ...
Epoch: 3 cost time: 17.886953115463257
Epoch: 3, Steps: 32 | Train Loss: 3.347 Vali Loss: 4.482 Vali Acc: 0.542 Test Loss: 4.482 Test Acc: 0.542
Validation loss decreased (-0.496133 --> -0.541940).  Saving model ...
Epoch: 4 cost time: 18.106539726257324
Epoch: 4, Steps: 32 | Train Loss: 1.923 Vali Loss: 11.237 Vali Acc: 0.374 Test Loss: 11.237 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 19.216467142105103
Epoch: 5, Steps: 32 | Train Loss: 1.894 Vali Loss: 11.278 Vali Acc: 0.496 Test Loss: 11.278 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 20.914284467697144
Epoch: 6, Steps: 32 | Train Loss: 0.827 Vali Loss: 14.477 Vali Acc: 0.405 Test Loss: 14.477 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 24.601934909820557
Epoch: 7, Steps: 32 | Train Loss: 0.850 Vali Loss: 8.808 Vali Acc: 0.420 Test Loss: 8.808 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 21.211925506591797
Epoch: 8, Steps: 32 | Train Loss: 1.547 Vali Loss: 13.932 Vali Acc: 0.427 Test Loss: 13.932 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 21.35634684562683
Epoch: 9, Steps: 32 | Train Loss: 1.358 Vali Loss: 22.420 Vali Acc: 0.534 Test Loss: 22.420 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 18.864503145217896
Epoch: 10, Steps: 32 | Train Loss: 0.495 Vali Loss: 17.172 Vali Acc: 0.496 Test Loss: 17.172 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 19.50624990463257
Epoch: 11, Steps: 32 | Train Loss: 1.664 Vali Loss: 14.725 Vali Acc: 0.458 Test Loss: 14.725 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 17.871445417404175
Epoch: 12, Steps: 32 | Train Loss: 0.958 Vali Loss: 19.683 Vali Acc: 0.466 Test Loss: 19.683 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 18.44021725654602
Epoch: 13, Steps: 32 | Train Loss: 0.519 Vali Loss: 12.619 Vali Acc: 0.588 Test Loss: 12.619 Test Acc: 0.588
Validation loss decreased (-0.541940 --> -0.587660).  Saving model ...
Epoch: 14 cost time: 18.256159782409668
Epoch: 14, Steps: 32 | Train Loss: 0.122 Vali Loss: 27.495 Vali Acc: 0.550 Test Loss: 27.495 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 19.765658617019653
Epoch: 15, Steps: 32 | Train Loss: 0.347 Vali Loss: 21.768 Vali Acc: 0.527 Test Loss: 21.768 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 18.96737051010132
Epoch: 16, Steps: 32 | Train Loss: 1.174 Vali Loss: 26.776 Vali Acc: 0.519 Test Loss: 26.776 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 18.533558130264282
Epoch: 17, Steps: 32 | Train Loss: 0.018 Vali Loss: 32.380 Vali Acc: 0.511 Test Loss: 32.380 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 24.38411283493042
Epoch: 18, Steps: 32 | Train Loss: 4.578 Vali Loss: 27.025 Vali Acc: 0.565 Test Loss: 27.025 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 26.219549894332886
Epoch: 19, Steps: 32 | Train Loss: 1.902 Vali Loss: 21.903 Vali Acc: 0.527 Test Loss: 21.903 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 23.232527017593384
Epoch: 20, Steps: 32 | Train Loss: 1.279 Vali Loss: 37.517 Vali Acc: 0.534 Test Loss: 37.517 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 24.716018438339233
Epoch: 21, Steps: 32 | Train Loss: 0.552 Vali Loss: 39.275 Vali Acc: 0.496 Test Loss: 39.275 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 24.775691270828247
Epoch: 22, Steps: 32 | Train Loss: 1.186 Vali Loss: 33.460 Vali Acc: 0.504 Test Loss: 33.460 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 24.204236268997192
Epoch: 23, Steps: 32 | Train Loss: 0.629 Vali Loss: 31.622 Vali Acc: 0.511 Test Loss: 31.622 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df256_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 2969701
model size : 15.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         8992                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df128_ma8992_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 52.038334608078
Epoch: 1, Steps: 32 | Train Loss: 2.983 Vali Loss: 4.948 Vali Acc: 0.221 Test Loss: 4.948 Test Acc: 0.221
Validation loss decreased (inf --> -0.221325).  Saving model ...
Epoch: 2 cost time: 53.001158475875854
Epoch: 2, Steps: 32 | Train Loss: 3.201 Vali Loss: 13.601 Vali Acc: 0.504 Test Loss: 13.601 Test Acc: 0.504
Validation loss decreased (-0.221325 --> -0.503681).  Saving model ...
Epoch: 3 cost time: 51.431681394577026
Epoch: 3, Steps: 32 | Train Loss: 4.263 Vali Loss: 13.403 Vali Acc: 0.267 Test Loss: 13.403 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 53.565322160720825
Epoch: 4, Steps: 32 | Train Loss: 2.027 Vali Loss: 11.634 Vali Acc: 0.550 Test Loss: 11.634 Test Acc: 0.550
Validation loss decreased (-0.503681 --> -0.549502).  Saving model ...
Epoch: 5 cost time: 55.181987285614014
Epoch: 5, Steps: 32 | Train Loss: 3.272 Vali Loss: 32.503 Vali Acc: 0.489 Test Loss: 32.503 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 60.58553385734558
Epoch: 6, Steps: 32 | Train Loss: 3.797 Vali Loss: 19.619 Vali Acc: 0.534 Test Loss: 19.619 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 61.59538006782532
Epoch: 7, Steps: 32 | Train Loss: 1.280 Vali Loss: 20.622 Vali Acc: 0.511 Test Loss: 20.622 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 65.74748539924622
Epoch: 8, Steps: 32 | Train Loss: 0.646 Vali Loss: 28.807 Vali Acc: 0.527 Test Loss: 28.807 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 68.27130842208862
Epoch: 9, Steps: 32 | Train Loss: 1.434 Vali Loss: 30.575 Vali Acc: 0.573 Test Loss: 30.575 Test Acc: 0.573
Validation loss decreased (-0.549502 --> -0.572213).  Saving model ...
Epoch: 10 cost time: 71.5263876914978
Epoch: 10, Steps: 32 | Train Loss: 1.183 Vali Loss: 32.646 Vali Acc: 0.435 Test Loss: 32.646 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 70.56218552589417
Epoch: 11, Steps: 32 | Train Loss: 0.543 Vali Loss: 22.809 Vali Acc: 0.519 Test Loss: 22.809 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 70.8368570804596
Epoch: 12, Steps: 32 | Train Loss: 0.108 Vali Loss: 23.131 Vali Acc: 0.458 Test Loss: 23.131 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 71.96696877479553
Epoch: 13, Steps: 32 | Train Loss: 0.559 Vali Loss: 24.518 Vali Acc: 0.473 Test Loss: 24.518 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 67.27437829971313
Epoch: 14, Steps: 32 | Train Loss: 0.775 Vali Loss: 39.308 Vali Acc: 0.282 Test Loss: 39.308 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 68.31119418144226
Epoch: 15, Steps: 32 | Train Loss: 1.186 Vali Loss: 35.369 Vali Acc: 0.580 Test Loss: 35.369 Test Acc: 0.580
Validation loss decreased (-0.572213 --> -0.579799).  Saving model ...
Epoch: 16 cost time: 68.45823359489441
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 29.265 Vali Acc: 0.427 Test Loss: 29.265 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 69.93304967880249
Epoch: 17, Steps: 32 | Train Loss: 3.421 Vali Loss: 44.386 Vali Acc: 0.389 Test Loss: 44.386 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 66.88241338729858
Epoch: 18, Steps: 32 | Train Loss: 9.267 Vali Loss: 83.212 Vali Acc: 0.519 Test Loss: 83.212 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 67.97792387008667
Epoch: 19, Steps: 32 | Train Loss: 4.277 Vali Loss: 76.712 Vali Acc: 0.550 Test Loss: 76.712 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 69.27743363380432
Epoch: 20, Steps: 32 | Train Loss: 0.212 Vali Loss: 49.615 Vali Acc: 0.336 Test Loss: 49.615 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 63.650418519973755
Epoch: 21, Steps: 32 | Train Loss: 3.336 Vali Loss: 83.840 Vali Acc: 0.237 Test Loss: 83.840 Test Acc: 0.237
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 66.05641388893127
Epoch: 22, Steps: 32 | Train Loss: 3.499 Vali Loss: 78.992 Vali Acc: 0.405 Test Loss: 78.992 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 68.65753436088562
Epoch: 23, Steps: 32 | Train Loss: 4.288 Vali Loss: 73.503 Vali Acc: 0.611 Test Loss: 73.503 Test Acc: 0.611
Validation loss decreased (-0.579799 --> -0.609952).  Saving model ...
Epoch: 24 cost time: 67.51958274841309
Epoch: 24, Steps: 32 | Train Loss: 0.980 Vali Loss: 63.910 Vali Acc: 0.420 Test Loss: 63.910 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 69.81860017776489
Epoch: 25, Steps: 32 | Train Loss: 0.005 Vali Loss: 72.851 Vali Acc: 0.397 Test Loss: 72.851 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 68.58056378364563
Epoch: 26, Steps: 32 | Train Loss: 0.001 Vali Loss: 85.320 Vali Acc: 0.573 Test Loss: 85.320 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 65.87209844589233
Epoch: 27, Steps: 32 | Train Loss: 0.682 Vali Loss: 61.726 Vali Acc: 0.534 Test Loss: 61.726 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 67.0551540851593
Epoch: 28, Steps: 32 | Train Loss: 0.374 Vali Loss: 66.702 Vali Acc: 0.565 Test Loss: 66.702 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 68.11656713485718
Epoch: 29, Steps: 32 | Train Loss: 0.000 Vali Loss: 63.453 Vali Acc: 0.496 Test Loss: 63.453 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 71.06468176841736
Epoch: 30, Steps: 32 | Train Loss: 0.000 Vali Loss: 63.916 Vali Acc: 0.489 Test Loss: 63.916 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 69.54873061180115
Epoch: 31, Steps: 32 | Train Loss: 0.000 Vali Loss: 63.933 Vali Acc: 0.489 Test Loss: 63.933 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 68.4260778427124
Epoch: 32, Steps: 32 | Train Loss: 0.000 Vali Loss: 63.934 Vali Acc: 0.489 Test Loss: 63.934 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 68.32157683372498
Epoch: 33, Steps: 32 | Train Loss: 0.029 Vali Loss: 103.651 Vali Acc: 0.550 Test Loss: 103.651 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df128_ma8992_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6106870229007634
model parameter : 2945125
model size : 15.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         7194                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df128_ma7194_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 43.5523521900177
Epoch: 1, Steps: 32 | Train Loss: 3.242 Vali Loss: 8.826 Vali Acc: 0.229 Test Loss: 8.826 Test Acc: 0.229
Validation loss decreased (inf --> -0.228919).  Saving model ...
Epoch: 2 cost time: 43.66022491455078
Epoch: 2, Steps: 32 | Train Loss: 2.254 Vali Loss: 7.832 Vali Acc: 0.527 Test Loss: 7.832 Test Acc: 0.527
Validation loss decreased (-0.228919 --> -0.526639).  Saving model ...
Epoch: 3 cost time: 43.889562368392944
Epoch: 3, Steps: 32 | Train Loss: 2.084 Vali Loss: 12.199 Vali Acc: 0.351 Test Loss: 12.199 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 45.03398585319519
Epoch: 4, Steps: 32 | Train Loss: 2.202 Vali Loss: 14.960 Vali Acc: 0.252 Test Loss: 14.960 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 43.92940974235535
Epoch: 5, Steps: 32 | Train Loss: 1.487 Vali Loss: 16.371 Vali Acc: 0.565 Test Loss: 16.371 Test Acc: 0.565
Validation loss decreased (-0.526639 --> -0.564722).  Saving model ...
Epoch: 6 cost time: 51.85719919204712
Epoch: 6, Steps: 32 | Train Loss: 1.444 Vali Loss: 24.827 Vali Acc: 0.237 Test Loss: 24.827 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 51.48345351219177
Epoch: 7, Steps: 32 | Train Loss: 3.557 Vali Loss: 21.296 Vali Acc: 0.466 Test Loss: 21.296 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 54.91075277328491
Epoch: 8, Steps: 32 | Train Loss: 2.136 Vali Loss: 24.986 Vali Acc: 0.359 Test Loss: 24.986 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 54.480836629867554
Epoch: 9, Steps: 32 | Train Loss: 1.245 Vali Loss: 30.158 Vali Acc: 0.542 Test Loss: 30.158 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 56.33586287498474
Epoch: 10, Steps: 32 | Train Loss: 1.952 Vali Loss: 57.415 Vali Acc: 0.519 Test Loss: 57.415 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 54.19387650489807
Epoch: 11, Steps: 32 | Train Loss: 2.227 Vali Loss: 39.301 Vali Acc: 0.542 Test Loss: 39.301 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 60.062164068222046
Epoch: 12, Steps: 32 | Train Loss: 0.176 Vali Loss: 26.597 Vali Acc: 0.489 Test Loss: 26.597 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 58.4128155708313
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 27.679 Vali Acc: 0.496 Test Loss: 27.679 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 59.57553219795227
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 27.721 Vali Acc: 0.496 Test Loss: 27.721 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 58.55625295639038
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 27.722 Vali Acc: 0.496 Test Loss: 27.722 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df128_ma7194_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 2945125
model size : 15.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         5396                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df128_ma5396_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 39.94946098327637
Epoch: 1, Steps: 32 | Train Loss: 3.138 Vali Loss: 5.131 Vali Acc: 0.229 Test Loss: 5.131 Test Acc: 0.229
Validation loss decreased (inf --> -0.228956).  Saving model ...
Epoch: 2 cost time: 36.72055983543396
Epoch: 2, Steps: 32 | Train Loss: 2.242 Vali Loss: 6.748 Vali Acc: 0.405 Test Loss: 6.748 Test Acc: 0.405
Validation loss decreased (-0.228956 --> -0.404513).  Saving model ...
Epoch: 3 cost time: 36.31185746192932
Epoch: 3, Steps: 32 | Train Loss: 3.494 Vali Loss: 12.056 Vali Acc: 0.290 Test Loss: 12.056 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 37.361729860305786
Epoch: 4, Steps: 32 | Train Loss: 1.360 Vali Loss: 11.376 Vali Acc: 0.542 Test Loss: 11.376 Test Acc: 0.542
Validation loss decreased (-0.404513 --> -0.541871).  Saving model ...
Epoch: 5 cost time: 39.62027287483215
Epoch: 5, Steps: 32 | Train Loss: 0.580 Vali Loss: 10.347 Vali Acc: 0.573 Test Loss: 10.347 Test Acc: 0.573
Validation loss decreased (-0.541871 --> -0.572416).  Saving model ...
Epoch: 6 cost time: 43.92806792259216
Epoch: 6, Steps: 32 | Train Loss: 1.226 Vali Loss: 15.921 Vali Acc: 0.542 Test Loss: 15.921 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 43.73057007789612
Epoch: 7, Steps: 32 | Train Loss: 2.362 Vali Loss: 16.115 Vali Acc: 0.420 Test Loss: 16.115 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 45.05797219276428
Epoch: 8, Steps: 32 | Train Loss: 1.175 Vali Loss: 27.335 Vali Acc: 0.328 Test Loss: 27.335 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 46.46395492553711
Epoch: 9, Steps: 32 | Train Loss: 0.512 Vali Loss: 30.180 Vali Acc: 0.527 Test Loss: 30.180 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 46.63055372238159
Epoch: 10, Steps: 32 | Train Loss: 0.347 Vali Loss: 41.451 Vali Acc: 0.344 Test Loss: 41.451 Test Acc: 0.344
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 47.08073377609253
Epoch: 11, Steps: 32 | Train Loss: 2.315 Vali Loss: 22.954 Vali Acc: 0.427 Test Loss: 22.954 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 48.498377561569214
Epoch: 12, Steps: 32 | Train Loss: 3.046 Vali Loss: 31.779 Vali Acc: 0.496 Test Loss: 31.779 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 46.85124325752258
Epoch: 13, Steps: 32 | Train Loss: 1.415 Vali Loss: 44.480 Vali Acc: 0.458 Test Loss: 44.480 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 47.26303291320801
Epoch: 14, Steps: 32 | Train Loss: 4.989 Vali Loss: 41.139 Vali Acc: 0.366 Test Loss: 41.139 Test Acc: 0.366
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 49.57131552696228
Epoch: 15, Steps: 32 | Train Loss: 1.207 Vali Loss: 66.301 Vali Acc: 0.214 Test Loss: 66.301 Test Acc: 0.214
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df128_ma5396_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 2945125
model size : 15.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         3597                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df128_ma3597_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 32.72454524040222
Epoch: 1, Steps: 32 | Train Loss: 3.064 Vali Loss: 3.167 Vali Acc: 0.412 Test Loss: 3.167 Test Acc: 0.412
Validation loss decreased (inf --> -0.412182).  Saving model ...
Epoch: 2 cost time: 30.18646264076233
Epoch: 2, Steps: 32 | Train Loss: 1.494 Vali Loss: 5.477 Vali Acc: 0.298 Test Loss: 5.477 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 29.885319471359253
Epoch: 3, Steps: 32 | Train Loss: 1.566 Vali Loss: 13.710 Vali Acc: 0.511 Test Loss: 13.710 Test Acc: 0.511
Validation loss decreased (-0.412182 --> -0.511313).  Saving model ...
Epoch: 4 cost time: 30.159094095230103
Epoch: 4, Steps: 32 | Train Loss: 3.195 Vali Loss: 10.032 Vali Acc: 0.389 Test Loss: 10.032 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 29.100701808929443
Epoch: 5, Steps: 32 | Train Loss: 2.241 Vali Loss: 11.599 Vali Acc: 0.527 Test Loss: 11.599 Test Acc: 0.527
Validation loss decreased (-0.511313 --> -0.526602).  Saving model ...
Epoch: 6 cost time: 31.25672149658203
Epoch: 6, Steps: 32 | Train Loss: 1.831 Vali Loss: 9.610 Vali Acc: 0.489 Test Loss: 9.610 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 32.44995999336243
Epoch: 7, Steps: 32 | Train Loss: 0.596 Vali Loss: 13.462 Vali Acc: 0.580 Test Loss: 13.462 Test Acc: 0.580
Validation loss decreased (-0.526602 --> -0.580018).  Saving model ...
Epoch: 8 cost time: 35.036401987075806
Epoch: 8, Steps: 32 | Train Loss: 0.490 Vali Loss: 26.208 Vali Acc: 0.344 Test Loss: 26.208 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 35.81532549858093
Epoch: 9, Steps: 32 | Train Loss: 3.772 Vali Loss: 16.022 Vali Acc: 0.450 Test Loss: 16.022 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 35.773956298828125
Epoch: 10, Steps: 32 | Train Loss: 1.196 Vali Loss: 25.795 Vali Acc: 0.351 Test Loss: 25.795 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 36.16868782043457
Epoch: 11, Steps: 32 | Train Loss: 0.687 Vali Loss: 33.012 Vali Acc: 0.573 Test Loss: 33.012 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 39.09978199005127
Epoch: 12, Steps: 32 | Train Loss: 1.113 Vali Loss: 30.358 Vali Acc: 0.458 Test Loss: 30.358 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 37.586058616638184
Epoch: 13, Steps: 32 | Train Loss: 0.929 Vali Loss: 24.423 Vali Acc: 0.496 Test Loss: 24.423 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 34.28857445716858
Epoch: 14, Steps: 32 | Train Loss: 1.893 Vali Loss: 42.475 Vali Acc: 0.290 Test Loss: 42.475 Test Acc: 0.290
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 37.604963541030884
Epoch: 15, Steps: 32 | Train Loss: 2.593 Vali Loss: 67.273 Vali Acc: 0.527 Test Loss: 67.273 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 37.82679486274719
Epoch: 16, Steps: 32 | Train Loss: 3.442 Vali Loss: 64.219 Vali Acc: 0.527 Test Loss: 64.219 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 36.069091796875
Epoch: 17, Steps: 32 | Train Loss: 0.587 Vali Loss: 37.612 Vali Acc: 0.534 Test Loss: 37.612 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df128_ma3597_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 2945125
model size : 15.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         1799                Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df128_ma1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 27.525632858276367
Epoch: 1, Steps: 32 | Train Loss: 3.168 Vali Loss: 5.370 Vali Acc: 0.237 Test Loss: 5.370 Test Acc: 0.237
Validation loss decreased (inf --> -0.236588).  Saving model ...
Epoch: 2 cost time: 22.840436458587646
Epoch: 2, Steps: 32 | Train Loss: 1.898 Vali Loss: 5.780 Vali Acc: 0.443 Test Loss: 5.780 Test Acc: 0.443
Validation loss decreased (-0.236588 --> -0.442690).  Saving model ...
Epoch: 3 cost time: 21.871524333953857
Epoch: 3, Steps: 32 | Train Loss: 2.563 Vali Loss: 10.987 Vali Acc: 0.504 Test Loss: 10.987 Test Acc: 0.504
Validation loss decreased (-0.442690 --> -0.503707).  Saving model ...
Epoch: 4 cost time: 23.868595361709595
Epoch: 4, Steps: 32 | Train Loss: 0.788 Vali Loss: 10.263 Vali Acc: 0.473 Test Loss: 10.263 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 26.315361261367798
Epoch: 5, Steps: 32 | Train Loss: 0.977 Vali Loss: 17.247 Vali Acc: 0.519 Test Loss: 17.247 Test Acc: 0.519
Validation loss decreased (-0.503707 --> -0.518911).  Saving model ...
Epoch: 6 cost time: 26.70862340927124
Epoch: 6, Steps: 32 | Train Loss: 0.372 Vali Loss: 18.866 Vali Acc: 0.344 Test Loss: 18.866 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 25.168076992034912
Epoch: 7, Steps: 32 | Train Loss: 0.996 Vali Loss: 22.544 Vali Acc: 0.550 Test Loss: 22.544 Test Acc: 0.550
Validation loss decreased (-0.518911 --> -0.549393).  Saving model ...
Epoch: 8 cost time: 25.228437900543213
Epoch: 8, Steps: 32 | Train Loss: 1.590 Vali Loss: 19.159 Vali Acc: 0.351 Test Loss: 19.159 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 25.15788221359253
Epoch: 9, Steps: 32 | Train Loss: 2.104 Vali Loss: 24.876 Vali Acc: 0.275 Test Loss: 24.876 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 23.867735385894775
Epoch: 10, Steps: 32 | Train Loss: 2.313 Vali Loss: 42.229 Vali Acc: 0.443 Test Loss: 42.229 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 24.80227541923523
Epoch: 11, Steps: 32 | Train Loss: 4.115 Vali Loss: 38.699 Vali Acc: 0.359 Test Loss: 38.699 Test Acc: 0.359
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 25.631778955459595
Epoch: 12, Steps: 32 | Train Loss: 3.493 Vali Loss: 38.346 Vali Acc: 0.565 Test Loss: 38.346 Test Acc: 0.565
Validation loss decreased (-0.549393 --> -0.564502).  Saving model ...
Epoch: 13 cost time: 26.063847303390503
Epoch: 13, Steps: 32 | Train Loss: 0.066 Vali Loss: 37.372 Vali Acc: 0.534 Test Loss: 37.372 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 24.386499404907227
Epoch: 14, Steps: 32 | Train Loss: 0.094 Vali Loss: 62.196 Vali Acc: 0.527 Test Loss: 62.196 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 24.42806363105774
Epoch: 15, Steps: 32 | Train Loss: 0.397 Vali Loss: 51.582 Vali Acc: 0.466 Test Loss: 51.582 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 24.63526463508606
Epoch: 16, Steps: 32 | Train Loss: 0.209 Vali Loss: 47.301 Vali Acc: 0.519 Test Loss: 47.301 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 24.13153862953186
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 51.485 Vali Acc: 0.527 Test Loss: 51.485 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 25.024186372756958
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 51.775 Vali Acc: 0.527 Test Loss: 51.775 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 25.773972511291504
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 51.794 Vali Acc: 0.527 Test Loss: 51.794 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 24.879873514175415
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 51.795 Vali Acc: 0.527 Test Loss: 51.795 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 24.87300705909729
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 51.796 Vali Acc: 0.527 Test Loss: 51.796 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 24.746859312057495
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 51.800 Vali Acc: 0.527 Test Loss: 51.800 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df128_ma1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 2945125
model size : 15.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         900                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df128_ma900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 30.254058122634888
Epoch: 1, Steps: 32 | Train Loss: 2.784 Vali Loss: 6.184 Vali Acc: 0.221 Test Loss: 6.184 Test Acc: 0.221
Validation loss decreased (inf --> -0.221312).  Saving model ...
Epoch: 2 cost time: 25.033175706863403
Epoch: 2, Steps: 32 | Train Loss: 2.509 Vali Loss: 10.960 Vali Acc: 0.489 Test Loss: 10.960 Test Acc: 0.489
Validation loss decreased (-0.221312 --> -0.488440).  Saving model ...
Epoch: 3 cost time: 24.548661708831787
Epoch: 3, Steps: 32 | Train Loss: 2.337 Vali Loss: 6.599 Vali Acc: 0.519 Test Loss: 6.599 Test Acc: 0.519
Validation loss decreased (-0.488440 --> -0.519018).  Saving model ...
Epoch: 4 cost time: 24.021727800369263
Epoch: 4, Steps: 32 | Train Loss: 1.475 Vali Loss: 8.099 Vali Acc: 0.405 Test Loss: 8.099 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 21.810620546340942
Epoch: 5, Steps: 32 | Train Loss: 2.459 Vali Loss: 16.233 Vali Acc: 0.466 Test Loss: 16.233 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 24.000251054763794
Epoch: 6, Steps: 32 | Train Loss: 0.681 Vali Loss: 22.274 Vali Acc: 0.344 Test Loss: 22.274 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 24.217816829681396
Epoch: 7, Steps: 32 | Train Loss: 3.321 Vali Loss: 23.768 Vali Acc: 0.542 Test Loss: 23.768 Test Acc: 0.542
Validation loss decreased (-0.519018 --> -0.541747).  Saving model ...
Epoch: 8 cost time: 25.6675546169281
Epoch: 8, Steps: 32 | Train Loss: 1.127 Vali Loss: 32.687 Vali Acc: 0.527 Test Loss: 32.687 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 24.916018962860107
Epoch: 9, Steps: 32 | Train Loss: 0.591 Vali Loss: 18.319 Vali Acc: 0.473 Test Loss: 18.319 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 24.280975818634033
Epoch: 10, Steps: 32 | Train Loss: 0.371 Vali Loss: 26.604 Vali Acc: 0.389 Test Loss: 26.604 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 24.699902772903442
Epoch: 11, Steps: 32 | Train Loss: 0.212 Vali Loss: 26.465 Vali Acc: 0.427 Test Loss: 26.465 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 23.28433871269226
Epoch: 12, Steps: 32 | Train Loss: 2.451 Vali Loss: 29.668 Vali Acc: 0.481 Test Loss: 29.668 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 25.5473210811615
Epoch: 13, Steps: 32 | Train Loss: 0.641 Vali Loss: 38.952 Vali Acc: 0.466 Test Loss: 38.952 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 23.983405351638794
Epoch: 14, Steps: 32 | Train Loss: 0.538 Vali Loss: 34.496 Vali Acc: 0.397 Test Loss: 34.496 Test Acc: 0.397
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 26.01566481590271
Epoch: 15, Steps: 32 | Train Loss: 0.454 Vali Loss: 32.616 Vali Acc: 0.565 Test Loss: 32.616 Test Acc: 0.565
Validation loss decreased (-0.541747 --> -0.564559).  Saving model ...
Epoch: 16 cost time: 25.251988649368286
Epoch: 16, Steps: 32 | Train Loss: 0.620 Vali Loss: 41.886 Vali Acc: 0.511 Test Loss: 41.886 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 24.72012233734131
Epoch: 17, Steps: 32 | Train Loss: 0.425 Vali Loss: 34.499 Vali Acc: 0.420 Test Loss: 34.499 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 25.63022208213806
Epoch: 18, Steps: 32 | Train Loss: 1.356 Vali Loss: 34.015 Vali Acc: 0.489 Test Loss: 34.015 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 23.28437852859497
Epoch: 19, Steps: 32 | Train Loss: 1.873 Vali Loss: 31.098 Vali Acc: 0.489 Test Loss: 31.098 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 23.626592874526978
Epoch: 20, Steps: 32 | Train Loss: 0.058 Vali Loss: 36.912 Vali Acc: 0.412 Test Loss: 36.912 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 24.79400396347046
Epoch: 21, Steps: 32 | Train Loss: 0.009 Vali Loss: 47.428 Vali Acc: 0.481 Test Loss: 47.428 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 23.138182640075684
Epoch: 22, Steps: 32 | Train Loss: 0.444 Vali Loss: 67.709 Vali Acc: 0.504 Test Loss: 67.709 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 25.366089582443237
Epoch: 23, Steps: 32 | Train Loss: 0.289 Vali Loss: 44.001 Vali Acc: 0.489 Test Loss: 44.001 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 24.8380126953125
Epoch: 24, Steps: 32 | Train Loss: 0.278 Vali Loss: 81.077 Vali Acc: 0.519 Test Loss: 81.077 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 24.776861429214478
Epoch: 25, Steps: 32 | Train Loss: 0.502 Vali Loss: 68.936 Vali Acc: 0.511 Test Loss: 68.936 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df128_ma900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 2945125
model size : 15.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         540                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df128_ma540_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 23.92425012588501
Epoch: 1, Steps: 32 | Train Loss: 2.737 Vali Loss: 6.444 Vali Acc: 0.176 Test Loss: 6.444 Test Acc: 0.176
Validation loss decreased (inf --> -0.175508).  Saving model ...
Epoch: 2 cost time: 22.841768503189087
Epoch: 2, Steps: 32 | Train Loss: 2.533 Vali Loss: 7.270 Vali Acc: 0.504 Test Loss: 7.270 Test Acc: 0.504
Validation loss decreased (-0.175508 --> -0.503744).  Saving model ...
Epoch: 3 cost time: 22.87920379638672
Epoch: 3, Steps: 32 | Train Loss: 1.786 Vali Loss: 7.481 Vali Acc: 0.405 Test Loss: 7.481 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 24.36111617088318
Epoch: 4, Steps: 32 | Train Loss: 1.768 Vali Loss: 11.931 Vali Acc: 0.481 Test Loss: 11.931 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 24.503190279006958
Epoch: 5, Steps: 32 | Train Loss: 1.784 Vali Loss: 20.025 Vali Acc: 0.496 Test Loss: 20.025 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 24.855521202087402
Epoch: 6, Steps: 32 | Train Loss: 1.454 Vali Loss: 11.230 Vali Acc: 0.496 Test Loss: 11.230 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 24.75514578819275
Epoch: 7, Steps: 32 | Train Loss: 1.769 Vali Loss: 19.673 Vali Acc: 0.420 Test Loss: 19.673 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 19.899909257888794
Epoch: 8, Steps: 32 | Train Loss: 0.233 Vali Loss: 28.427 Vali Acc: 0.321 Test Loss: 28.427 Test Acc: 0.321
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 21.743700981140137
Epoch: 9, Steps: 32 | Train Loss: 0.429 Vali Loss: 27.212 Vali Acc: 0.489 Test Loss: 27.212 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 20.146693468093872
Epoch: 10, Steps: 32 | Train Loss: 0.718 Vali Loss: 42.573 Vali Acc: 0.519 Test Loss: 42.573 Test Acc: 0.519
Validation loss decreased (-0.503744 --> -0.518658).  Saving model ...
Epoch: 11 cost time: 23.62469220161438
Epoch: 11, Steps: 32 | Train Loss: 2.037 Vali Loss: 35.407 Vali Acc: 0.397 Test Loss: 35.407 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 22.3745596408844
Epoch: 12, Steps: 32 | Train Loss: 2.058 Vali Loss: 48.593 Vali Acc: 0.504 Test Loss: 48.593 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 24.348716259002686
Epoch: 13, Steps: 32 | Train Loss: 3.233 Vali Loss: 28.071 Vali Acc: 0.481 Test Loss: 28.071 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 23.393563508987427
Epoch: 14, Steps: 32 | Train Loss: 1.078 Vali Loss: 40.197 Vali Acc: 0.527 Test Loss: 40.197 Test Acc: 0.527
Validation loss decreased (-0.518658 --> -0.526316).  Saving model ...
Epoch: 15 cost time: 24.734225273132324
Epoch: 15, Steps: 32 | Train Loss: 0.284 Vali Loss: 30.058 Vali Acc: 0.481 Test Loss: 30.058 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 22.097067832946777
Epoch: 16, Steps: 32 | Train Loss: 1.112 Vali Loss: 34.794 Vali Acc: 0.481 Test Loss: 34.794 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 23.687222003936768
Epoch: 17, Steps: 32 | Train Loss: 1.839 Vali Loss: 34.703 Vali Acc: 0.511 Test Loss: 34.703 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 21.81108522415161
Epoch: 18, Steps: 32 | Train Loss: 0.856 Vali Loss: 32.223 Vali Acc: 0.443 Test Loss: 32.223 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 25.03690242767334
Epoch: 19, Steps: 32 | Train Loss: 0.004 Vali Loss: 48.899 Vali Acc: 0.511 Test Loss: 48.899 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 23.596644163131714
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 49.907 Vali Acc: 0.511 Test Loss: 49.907 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 22.28334140777588
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 49.926 Vali Acc: 0.511 Test Loss: 49.926 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 22.401753187179565
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 49.919 Vali Acc: 0.511 Test Loss: 49.919 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 21.770309925079346
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 49.917 Vali Acc: 0.511 Test Loss: 49.917 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 23.099257469177246
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 49.913 Vali Acc: 0.511 Test Loss: 49.913 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df128_ma540_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 2945125
model size : 15.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         360                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df128_ma360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 24.153961181640625
Epoch: 1, Steps: 32 | Train Loss: 2.721 Vali Loss: 2.947 Vali Acc: 0.305 Test Loss: 2.947 Test Acc: 0.305
Validation loss decreased (inf --> -0.305314).  Saving model ...
Epoch: 2 cost time: 23.258912563323975
Epoch: 2, Steps: 32 | Train Loss: 2.769 Vali Loss: 5.866 Vali Acc: 0.504 Test Loss: 5.866 Test Acc: 0.504
Validation loss decreased (-0.305314 --> -0.503758).  Saving model ...
Epoch: 3 cost time: 21.210850954055786
Epoch: 3, Steps: 32 | Train Loss: 2.732 Vali Loss: 8.551 Vali Acc: 0.542 Test Loss: 8.551 Test Acc: 0.542
Validation loss decreased (-0.503758 --> -0.541899).  Saving model ...
Epoch: 4 cost time: 21.886595487594604
Epoch: 4, Steps: 32 | Train Loss: 1.034 Vali Loss: 6.974 Vali Acc: 0.443 Test Loss: 6.974 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 20.080546617507935
Epoch: 5, Steps: 32 | Train Loss: 2.507 Vali Loss: 17.414 Vali Acc: 0.511 Test Loss: 17.414 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 20.226632833480835
Epoch: 6, Steps: 32 | Train Loss: 3.850 Vali Loss: 21.011 Vali Acc: 0.298 Test Loss: 21.011 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 20.284544944763184
Epoch: 7, Steps: 32 | Train Loss: 2.995 Vali Loss: 42.615 Vali Acc: 0.496 Test Loss: 42.615 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 21.324644804000854
Epoch: 8, Steps: 32 | Train Loss: 2.405 Vali Loss: 20.470 Vali Acc: 0.580 Test Loss: 20.470 Test Acc: 0.580
Validation loss decreased (-0.541899 --> -0.579948).  Saving model ...
Epoch: 9 cost time: 21.339130878448486
Epoch: 9, Steps: 32 | Train Loss: 0.447 Vali Loss: 21.742 Vali Acc: 0.405 Test Loss: 21.742 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 21.82317352294922
Epoch: 10, Steps: 32 | Train Loss: 0.561 Vali Loss: 20.609 Vali Acc: 0.573 Test Loss: 20.609 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 22.296737909317017
Epoch: 11, Steps: 32 | Train Loss: 0.718 Vali Loss: 19.335 Vali Acc: 0.435 Test Loss: 19.335 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 24.07339835166931
Epoch: 12, Steps: 32 | Train Loss: 0.841 Vali Loss: 25.200 Vali Acc: 0.435 Test Loss: 25.200 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 19.554964303970337
Epoch: 13, Steps: 32 | Train Loss: 0.000 Vali Loss: 25.794 Vali Acc: 0.412 Test Loss: 25.794 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 22.223275184631348
Epoch: 14, Steps: 32 | Train Loss: 0.000 Vali Loss: 26.031 Vali Acc: 0.427 Test Loss: 26.031 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 21.167752981185913
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 26.102 Vali Acc: 0.427 Test Loss: 26.102 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 20.24649953842163
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 26.105 Vali Acc: 0.427 Test Loss: 26.105 Test Acc: 0.427
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 25.519578218460083
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 26.105 Vali Acc: 0.427 Test Loss: 26.105 Test Acc: 0.427
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 27.233583450317383
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 26.105 Vali Acc: 0.427 Test Loss: 26.105 Test Acc: 0.427
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df128_ma360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 2945125
model size : 15.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         180                 Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df128_ma180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 26.60884380340576
Epoch: 1, Steps: 32 | Train Loss: 2.589 Vali Loss: 3.528 Vali Acc: 0.321 Test Loss: 3.528 Test Acc: 0.321
Validation loss decreased (inf --> -0.320575).  Saving model ...
Epoch: 2 cost time: 23.664121389389038
Epoch: 2, Steps: 32 | Train Loss: 2.436 Vali Loss: 3.123 Vali Acc: 0.527 Test Loss: 3.123 Test Acc: 0.527
Validation loss decreased (-0.320575 --> -0.526686).  Saving model ...
Epoch: 3 cost time: 21.711583852767944
Epoch: 3, Steps: 32 | Train Loss: 2.650 Vali Loss: 8.238 Vali Acc: 0.519 Test Loss: 8.238 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 18.75318741798401
Epoch: 4, Steps: 32 | Train Loss: 2.134 Vali Loss: 8.664 Vali Acc: 0.290 Test Loss: 8.664 Test Acc: 0.290
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 20.664753198623657
Epoch: 5, Steps: 32 | Train Loss: 1.934 Vali Loss: 11.564 Vali Acc: 0.542 Test Loss: 11.564 Test Acc: 0.542
Validation loss decreased (-0.526686 --> -0.541869).  Saving model ...
Epoch: 6 cost time: 19.857389211654663
Epoch: 6, Steps: 32 | Train Loss: 1.062 Vali Loss: 11.694 Vali Acc: 0.481 Test Loss: 11.694 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 21.187797784805298
Epoch: 7, Steps: 32 | Train Loss: 0.717 Vali Loss: 11.188 Vali Acc: 0.504 Test Loss: 11.188 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 20.230822801589966
Epoch: 8, Steps: 32 | Train Loss: 1.144 Vali Loss: 21.048 Vali Acc: 0.504 Test Loss: 21.048 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 20.88871431350708
Epoch: 9, Steps: 32 | Train Loss: 0.985 Vali Loss: 21.151 Vali Acc: 0.405 Test Loss: 21.151 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 20.448269367218018
Epoch: 10, Steps: 32 | Train Loss: 1.565 Vali Loss: 40.557 Vali Acc: 0.504 Test Loss: 40.557 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 21.574273347854614
Epoch: 11, Steps: 32 | Train Loss: 2.885 Vali Loss: 26.392 Vali Acc: 0.473 Test Loss: 26.392 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 20.255590200424194
Epoch: 12, Steps: 32 | Train Loss: 0.732 Vali Loss: 18.496 Vali Acc: 0.534 Test Loss: 18.496 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 19.084997415542603
Epoch: 13, Steps: 32 | Train Loss: 0.220 Vali Loss: 25.561 Vali Acc: 0.489 Test Loss: 25.561 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 20.221402883529663
Epoch: 14, Steps: 32 | Train Loss: 0.575 Vali Loss: 23.803 Vali Acc: 0.542 Test Loss: 23.803 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 20.788908004760742
Epoch: 15, Steps: 32 | Train Loss: 1.857 Vali Loss: 18.456 Vali Acc: 0.489 Test Loss: 18.456 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df128_ma180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 2945125
model size : 15.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              FEDformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         90                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
fourier enhanced block used!
modes=32, index=[98, 385, 778, 955, 1290, 1679, 2130, 2789, 2889, 3796, 4047, 4051, 4214, 4241, 4447, 4629, 4869, 4971, 5215, 5256, 5353, 5778, 6055, 6671, 7347, 7858, 7970, 8074, 8092, 8179, 8201, 8234]
fourier enhanced block used!
modes=32, index=[15, 65, 198, 383, 640, 683, 761, 1112, 1127, 1222, 1466, 1553, 1573, 1587, 1591, 1862, 2011, 2432, 2701, 3127, 3185, 3194, 3304, 3319, 3554, 3835, 3958, 4223, 4228, 4308, 4345, 4389]
 fourier enhanced cross attention used!
modes_q=32, index_q=[242, 575, 614, 876, 955, 1095, 1205, 1254, 1417, 1423, 1731, 1737, 1780, 1959, 1972, 2144, 2197, 2266, 2279, 2342, 2350, 2422, 2443, 2542, 2593, 2794, 3591, 3804, 3812, 3879, 4051, 4359]
modes_kv=32, index_kv=[101, 388, 673, 851, 1162, 1484, 1598, 1834, 1915, 2009, 2232, 2497, 2499, 2868, 3151, 3710, 3823, 4358, 4993, 5111, 5683, 5878, 6065, 6611, 6777, 7103, 7360, 7451, 7563, 7815, 8310, 8809]
>>>>>>>start training : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df128_ma90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 22.880106687545776
Epoch: 1, Steps: 32 | Train Loss: 2.529 Vali Loss: 2.241 Vali Acc: 0.481 Test Loss: 2.241 Test Acc: 0.481
Validation loss decreased (inf --> -0.480894).  Saving model ...
Epoch: 2 cost time: 17.5695960521698
Epoch: 2, Steps: 32 | Train Loss: 3.563 Vali Loss: 3.378 Vali Acc: 0.489 Test Loss: 3.378 Test Acc: 0.489
Validation loss decreased (-0.480894 --> -0.488516).  Saving model ...
Epoch: 3 cost time: 19.436205863952637
Epoch: 3, Steps: 32 | Train Loss: 4.175 Vali Loss: 7.743 Vali Acc: 0.366 Test Loss: 7.743 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 21.219817399978638
Epoch: 4, Steps: 32 | Train Loss: 5.570 Vali Loss: 6.428 Vali Acc: 0.473 Test Loss: 6.428 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 20.875308752059937
Epoch: 5, Steps: 32 | Train Loss: 1.484 Vali Loss: 6.328 Vali Acc: 0.542 Test Loss: 6.328 Test Acc: 0.542
Validation loss decreased (-0.488516 --> -0.541921).  Saving model ...
Epoch: 6 cost time: 19.80948233604431
Epoch: 6, Steps: 32 | Train Loss: 2.205 Vali Loss: 13.886 Vali Acc: 0.511 Test Loss: 13.886 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 18.46378183364868
Epoch: 7, Steps: 32 | Train Loss: 2.483 Vali Loss: 11.274 Vali Acc: 0.550 Test Loss: 11.274 Test Acc: 0.550
Validation loss decreased (-0.541921 --> -0.549506).  Saving model ...
Epoch: 8 cost time: 21.75146245956421
Epoch: 8, Steps: 32 | Train Loss: 2.397 Vali Loss: 11.612 Vali Acc: 0.458 Test Loss: 11.612 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 21.867446184158325
Epoch: 9, Steps: 32 | Train Loss: 0.272 Vali Loss: 8.839 Vali Acc: 0.542 Test Loss: 8.839 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 20.734333753585815
Epoch: 10, Steps: 32 | Train Loss: 0.358 Vali Loss: 8.535 Vali Acc: 0.595 Test Loss: 8.535 Test Acc: 0.595
Validation loss decreased (-0.549506 --> -0.595334).  Saving model ...
Epoch: 11 cost time: 19.024375677108765
Epoch: 11, Steps: 32 | Train Loss: 1.131 Vali Loss: 8.473 Vali Acc: 0.565 Test Loss: 8.473 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 18.763208389282227
Epoch: 12, Steps: 32 | Train Loss: 0.716 Vali Loss: 12.268 Vali Acc: 0.565 Test Loss: 12.268 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 20.9562931060791
Epoch: 13, Steps: 32 | Train Loss: 0.254 Vali Loss: 12.265 Vali Acc: 0.580 Test Loss: 12.265 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 20.485530138015747
Epoch: 14, Steps: 32 | Train Loss: 0.062 Vali Loss: 22.046 Vali Acc: 0.473 Test Loss: 22.046 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 21.105252265930176
Epoch: 15, Steps: 32 | Train Loss: 2.309 Vali Loss: 17.090 Vali Acc: 0.504 Test Loss: 17.090 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 19.633992433547974
Epoch: 16, Steps: 32 | Train Loss: 4.222 Vali Loss: 18.437 Vali Acc: 0.557 Test Loss: 18.437 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 21.438937425613403
Epoch: 17, Steps: 32 | Train Loss: 0.907 Vali Loss: 30.408 Vali Acc: 0.450 Test Loss: 30.408 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 20.964017868041992
Epoch: 18, Steps: 32 | Train Loss: 0.448 Vali Loss: 18.959 Vali Acc: 0.504 Test Loss: 18.959 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 20.2444486618042
Epoch: 19, Steps: 32 | Train Loss: 0.148 Vali Loss: 18.300 Vali Acc: 0.511 Test Loss: 18.300 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 20.051217555999756
Epoch: 20, Steps: 32 | Train Loss: 0.712 Vali Loss: 22.807 Vali Acc: 0.542 Test Loss: 22.807 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_FEDformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl1_df128_ma90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 2945125
model size : 15.65MB
